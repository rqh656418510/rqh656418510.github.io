"use strict";var CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};ColorThief.prototype.getColor=function(t,r){return this.getPalette(t,5,r)[0]},ColorThief.prototype.getPalette=function(t,r,n){(void 0===r||r<2||256<r)&&(r=10),(void 0===n||n<1)&&(n=10);for(var e,o,a,i,t=new CanvasImage(t),u=t.getImageData().data,c=t.getPixelCount(),s=[],f=0;f<c;f+=n)o=u[0+(e=4*f)],a=u[1+e],i=u[2+e],125<=u[3+e]&&(250<o&&250<a&&250<i||s.push([o,a,i]));r=MMCQ.quantize(s,r),r=r?r.palette():null;return t.removeCanvas(),r},ColorThief.prototype.getColorFromUrl=function(r,n,e){sourceImage=document.createElement("img");var o=this;sourceImage.addEventListener("load",function(){var t=o.getPalette(sourceImage,5,e)[0];n(t,r)}),sourceImage.src=r},ColorThief.prototype.getImageData=function(t,n){xhr=new XMLHttpRequest,xhr.open("GET",t,!0),xhr.responseType="arraybuffer",xhr.onload=function(t){if(200==this.status){uInt8Array=new Uint8Array(this.response),r=uInt8Array.length,binaryString=new Array(r);for(var r=0;r<uInt8Array.length;r++)binaryString[r]=String.fromCharCode(uInt8Array[r]);data=binaryString.join(""),base64=window.btoa(data),n("data:image/png;base64,"+base64)}},xhr.send()},ColorThief.prototype.getColorAsync=function(t,r,n){var e=this;this.getImageData(t,function(t){sourceImage=document.createElement("img"),sourceImage.addEventListener("load",function(){var t=e.getPalette(sourceImage,5,n)[0];r(t,this)}),sourceImage.src=t})};var pv=pv||{map:function(t,n){var e={};return n?t.map(function(t,r){return e.index=r,n.call(e,t)}):t.slice()},naturalOrder:function(t,r){return t<r?-1:r<t?1:0},sum:function(t,e){var o={};return t.reduce(e?function(t,r,n){return o.index=n,t+e.call(o,r)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?pv.map(t,r):t)}},MMCQ=function(){var C=5,I=8-C;function w(t,r,n){return(t<<2*C)+(r<<C)+n}function M(t){var r=[],n=!1;function e(){r.sort(t),n=!0}return{push:function(t){r.push(t),n=!1},peek:function(t){return n||e(),void 0===t&&(t=r.length-1),r[t]},pop:function(){return n||e(),r.pop()},size:function(){return r.length},map:function(t){return r.map(t)},debug:function(){return n||e(),r}}}function _(t,r,n,e,o,a,i){var u=this;u.r1=t,u.r2=r,u.g1=n,u.g2=e,u.b1=o,u.b2=a,u.histo=i}function z(){this.vboxes=new M(function(t,r){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}return _.prototype={volume:function(t){var r=this;return r._volume&&!t||(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(t){var r=this,n=r.histo;if(!r._count_set||t){for(var e,o,a=0,i=r.r1;i<=r.r2;i++)for(e=r.g1;e<=r.g2;e++)for(o=r.b1;o<=r.b2;o++)a+=n[w(i,e,o)]||0;r._count=a,r._count_set=!0}return r._count},copy:function(){var t=this;return new _(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(t){var r=this,n=r.histo;if(!r._avg||t){for(var e,o,a,i=0,u=1<<8-C,c=0,s=0,f=0,h=r.r1;h<=r.r2;h++)for(o=r.g1;o<=r.g2;o++)for(a=r.b1;a<=r.b2;a++)i+=e=n[w(h,o,a)]||0,c+=e*(h+.5)*u,s+=e*(o+.5)*u,f+=e*(a+.5)*u;r._avg=i?[~~(c/i),~~(s/i),~~(f/i)]:[~~(u*(r.r1+r.r2+1)/2),~~(u*(r.g1+r.g2+1)/2),~~(u*(r.b1+r.b2+1)/2)]}return r._avg},contains:function(t){var r=this,n=t[0]>>I;return gval=t[1]>>I,bval=t[2]>>I,n>=r.r1&&n<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},z.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,n=0;n<r.size();n++)if(r.peek(n).vbox.contains(t))return r.peek(n).color;return this.nearest(t)},nearest:function(t){for(var r,n,e,o=this.vboxes,a=0;a<o.size();a++)((n=Math.sqrt(Math.pow(t[0]-o.peek(a).color[0],2)+Math.pow(t[1]-o.peek(a).color[1],2)+Math.pow(t[2]-o.peek(a).color[2],2)))<r||void 0===r)&&(r=n,e=o.peek(a).color);return e},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return pv.naturalOrder(pv.sum(t.color),pv.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,r=t[n].color;251<r[0]&&251<r[1]&&251<r[2]&&(t[n].color=[255,255,255])}},{quantize:function(t,r){if(!t.length||r<2||256<r)return!1;var n,e,o,a,u=(m=t,a=new Array(1<<3*C),m.forEach(function(t){n=t[0]>>I,e=t[1]>>I,o=t[2]>>I,o=w(n,e,o),a[o]=(a[o]||0)+1}),a);u.forEach(function(){0});var i,c,s,f,h,v,p,g,l,m=(m=u,g=v=f=1e6,l=p=h=0,t.forEach(function(t){i=t[0]>>I,c=t[1]>>I,s=t[2]>>I,i<f?f=i:h<i&&(h=i),c<v?v=c:p<c&&(p=c),s<g?g=s:l<s&&(l=s)}),new _(f,h,v,p,g,l,m)),b=new M(function(t,r){return pv.naturalOrder(t.count(),r.count())});function d(t,r){for(var n,e=1,o=0;o<1e3;)if((n=t.pop()).count()){var a=function(t,s){if(s.count()){var r=s.r2-s.r1+1,n=s.g2-s.g1+1,e=s.b2-s.b1+1,e=pv.max([r,n,e]);if(1==s.count())return[s.copy()];var f,o,a,i,h=0,v=[],p=[];if(e==r)for(f=s.r1;f<=s.r2;f++){for(i=0,o=s.g1;o<=s.g2;o++)for(a=s.b1;a<=s.b2;a++)i+=t[w(f,o,a)]||0;h+=i,v[f]=h}else if(e==n)for(f=s.g1;f<=s.g2;f++){for(i=0,o=s.r1;o<=s.r2;o++)for(a=s.b1;a<=s.b2;a++)i+=t[w(o,f,a)]||0;h+=i,v[f]=h}else for(f=s.b1;f<=s.b2;f++){for(i=0,o=s.r1;o<=s.r2;o++)for(a=s.g1;a<=s.g2;a++)i+=t[w(o,a,f)]||0;h+=i,v[f]=h}return v.forEach(function(t,r){p[r]=h-t}),u(e==r?"r":e==n?"g":"b")}function u(t){var r,n,e,o,a,i=t+"1",u=t+"2",c=0;for(f=s[i];f<=s[u];f++)if(v[f]>h/2){for(e=s.copy(),o=s.copy(),a=(r=f-s[i])<=(n=s[u]-f)?Math.min(s[u]-1,~~(f+n/2)):Math.max(s[i],~~(f-1-r/2));!v[a];)a++;for(c=p[a];!c&&v[a-1];)c=p[--a];return e[u]=a,o[i]=e[u]+1,[e,o]}}}(u,n),i=a[0],a=a[1];if(!i)return;if(t.push(i),a&&(t.push(a),e++),r<=e)return;if(1e3<o++)return}else t.push(n),o++}b.push(m),d(b,.75*r);for(var x=new M(function(t,r){return pv.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});b.size();)x.push(b.pop());d(x,r-x.size());for(var y=new z;x.size();)y.push(x.pop());return y}}}();