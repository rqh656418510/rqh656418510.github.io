"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,n){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.quicklink={})}(void 0,function(e){function o(t){return new Promise(function(e,n,r){(r=new XMLHttpRequest).open("GET",t,r.withCredentials=!0),r.onload=function(){(200===r.status?e:n)()},r.send()})}var n,i=(n=document.createElement("link")).relList&&n.relList.supports&&n.relList.supports("prefetch")?function(t){return new Promise(function(e,n,r){(r=document.createElement("link")).rel="prefetch",r.href=t,r.onload=e,r.onerror=n,document.head.appendChild(r)})}:o,d=window.requestIdleCallback||function(e){var n=Date.now();return setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-n))}})},1)},p=new Set,h=new Set,m=!1;function c(e){if(e){if(e.saveData)return new Error("Save-Data is enabled");if(/2g/.test(e.effectiveType))return new Error("network conditions are poor")}return!0}function w(e,n,r){var t=c(navigator.connection);return t instanceof Error?Promise.reject(new Error("Cannot prefetch, "+t.message)):(0<h.size&&!m&&console.warn("[Warning] You are using both prefetching and prerendering on the same document"),Promise.all([].concat(e).map(function(e){if(!p.has(e))return p.add(e),(n?function(e){return window.fetch?fetch(e,{credentials:"include"}):o(e)}:i)(new URL(e,location.href).toString())})))}function y(e,n){var r=c(navigator.connection);if(r instanceof Error)return Promise.reject(new Error("Cannot prerender, "+r.message));if(!HTMLScriptElement.supports("speculationrules"))return w(e),Promise.reject(new Error("This browser does not support the speculation rules API. Falling back to prefetch."));if(document.querySelector('script[type="speculationrules"]'))return Promise.reject(new Error("Speculation Rules is already defined and cannot be altered."));for(var t=0,o=[].concat(e);t<o.length;t+=1){var i=o[t];if(window.location.origin!==new URL(i,window.location.href).origin)return Promise.reject(new Error("Only same origin URLs are allowed: "+i));h.add(i)}0<p.size&&!m&&console.warn("[Warning] You are using both prefetching and prerendering on the same document");e=function(e){var n=document.createElement("script");n.type="speculationrules",n.text='{"prerender":[{"source": "list","urls": ["'+Array.from(e).join('","')+'"]}]}';try{document.head.appendChild(n)}catch(e){return e}return!0}(h);return!0===e?Promise.resolve():Promise.reject(e)}e.listen=function(o){if(o=o||{},window.IntersectionObserver){var e=function(e){e=(e=o.throttle||1/0)||1;var n=[],r=0;function t(){r<e&&0<n.length&&(n.shift()(),r++)}return[function(e){1<n.push(e)||t()},function(){r--,t()}]}(0),r=e[0],t=e[1],i=o.limit||1/0,n=o.origins||[location.hostname],c=o.ignores||[],u=o.delay||0,s=[],e=o.timeoutFn||d,a="function"==typeof o.hrefFn&&o.hrefFn,f=o.prerender||!1;m=o.prerenderAndPrefetch||!1;var l=new IntersectionObserver(function(e){e.forEach(function(e){var n;e.isIntersecting?(s.push((e=e.target).href),n=function(){-1!==s.indexOf(e.href)&&(l.unobserve(e),(m||f)&&h.size<1?y(a?a(e):e.href).catch(function(e){if(!o.onError)throw e;o.onError(e)}):p.size<i&&!f&&r(function(){w(a?a(e):e.href,o.priority).then(t).catch(function(e){t(),o.onError&&o.onError(e)})}))},u?setTimeout(n,u):n()):-1<(n=s.indexOf((e=e.target).href))&&s.splice(n)})},{threshold:o.threshold||0});return e(function(){(o.el||document).querySelectorAll("a").forEach(function(e){n.length&&!n.includes(e.hostname)||function n(r,e){return Array.isArray(e)?e.some(function(e){return n(r,e)}):(e.test||e).call(e,r.href,r)}(e,c)||l.observe(e)})},{timeout:o.timeout||2e3}),function(){p.clear(),l.disconnect()}}},e.prefetch=w,e.prerender=y});