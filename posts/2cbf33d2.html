<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><meta name="description" content="本文主要介绍 MyBatis-Plus 的入门教程内容，包括逻辑删除、通用枚举、SQL 注入器、自动填充处理器等内容。"><meta property="og:type" content="article"><meta property="og:title" content="MyBatis-Plus 入门教程之四"><meta property="og:url" content="https://www.techgrow.cn/posts/2cbf33d2.html"><meta property="og:site_name" content="Clay 的技术空间"><meta property="og:description" content="本文主要介绍 MyBatis-Plus 的入门教程内容，包括逻辑删除、通用枚举、SQL 注入器、自动填充处理器等内容。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-07-11T15:12:41.000Z"><meta property="article:modified_time" content="2022-09-09T15:12:41.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="ORM"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.techgrow.cn/posts/2cbf33d2.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/2cbf33d2.html","path":"posts/2cbf33d2.html","title":"MyBatis-Plus 入门教程之四"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>MyBatis-Plus 入门教程之四 | Clay 的技术空间</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay 的技术空间" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/app/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay 的技术空间</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">用进废退 | 艺不压身</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>搜索</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>读书笔记</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>评论管理</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%BA%B2"><span class="nav-text">大纲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E"><span class="nav-text">版本说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MyBatis-Plus-%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4"><span class="nav-text">MyBatis-Plus 逻辑删除</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4%E4%BB%8B%E7%BB%8D"><span class="nav-text">逻辑删除介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">逻辑删除使用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="nav-text">创建数据库表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0-TableLogic-%E6%B3%A8%E8%A7%A3"><span class="nav-text">添加 @TableLogic 注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E6%94%B9%E9%A1%B9%E7%9B%AE%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">更改项目的配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Spring-XML-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">Spring XML 配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SpringBoot-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">SpringBoot 配置文件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Junit-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81"><span class="nav-text">Junit 单元测试代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E5%88%A0%E9%99%A4%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="nav-text">逻辑删除常见问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MyBatis-Plus-%E9%80%9A%E7%94%A8%E6%9E%9A%E4%B8%BE"><span class="nav-text">MyBatis-Plus 通用枚举</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E6%9E%9A%E4%B8%BE%E4%BB%8B%E7%BB%8D"><span class="nav-text">通用枚举介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E6%9E%9A%E4%B8%BE%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">通用枚举使用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8-1"><span class="nav-text">创建数据库表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0-EnumValue-%E6%B3%A8%E8%A7%A3"><span class="nav-text">添加 @EnumValue 注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%9E%9A%E4%B8%BE%E5%8C%85%E6%89%AB%E6%8F%8F"><span class="nav-text">配置枚举包扫描</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B1%80%E9%83%A8%E6%96%B9%E5%BC%8F"><span class="nav-text">局部方式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Spring-XML-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="nav-text">Spring XML 配置文件</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SpringBoot-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-1"><span class="nav-text">SpringBoot 配置文件</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E6%96%B9%E5%BC%8F"><span class="nav-text">全局方式</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Spring-XML-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-2"><span class="nav-text">Spring XML 配置文件</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#SpringBoot-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-2"><span class="nav-text">SpringBoot 配置文件</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%80%9A%E8%BF%87-MybatisPlusPropertiesCustomizer-%E8%87%AA%E5%AE%9A%E4%B9%89"><span class="nav-text">通过 MybatisPlusPropertiesCustomizer 自定义</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Junit-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81-1"><span class="nav-text">Junit 单元测试代码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E6%9E%9A%E4%B8%BE%E5%80%BC%E4%B8%BA%E5%89%8D%E7%AB%AF%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-text">序列化枚举值为前端返回值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MyBatis-Plus-SQL-%E6%B3%A8%E5%85%A5%E5%99%A8"><span class="nav-text">MyBatis-Plus SQL 注入器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-%E6%B3%A8%E5%85%A5%E5%99%A8%E4%BB%8B%E7%BB%8D"><span class="nav-text">SQL 注入器介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SQL-%E6%B3%A8%E5%85%A5%E5%99%A8%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">SQL 注入器使用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-Mapper-%E6%8E%A5%E5%8F%A3"><span class="nav-text">定义 Mapper 接口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%96%B9%E6%B3%95%E7%B1%BB"><span class="nav-text">定义方法类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-SQL-%E6%B3%A8%E5%85%A5%E5%99%A8"><span class="nav-text">定义 SQL 注入器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%85%A5-SQL-%E6%B3%A8%E5%85%A5%E5%99%A8"><span class="nav-text">注入 SQL 注入器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Spring-XML-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-3"><span class="nav-text">Spring XML 配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SpringBoot-%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="nav-text">SpringBoot 配置类</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Junit-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81-2"><span class="nav-text">Junit 单元测试代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MyBatis-Plus-%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86%E5%99%A8"><span class="nav-text">MyBatis-Plus 自动填充处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86%E5%99%A8%E4%BB%8B%E7%BB%8D"><span class="nav-text">自动填充处理器介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E7%AD%96%E7%95%A5%E8%AF%B4%E6%98%8E"><span class="nav-text">自动填充策略说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86%E5%99%A8%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">自动填充处理器使用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0-TableField-%E6%B3%A8%E8%A7%A3"><span class="nav-text">添加 @TableField 注解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86%E5%99%A8"><span class="nav-text">定义自动填充处理器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A8%E5%85%A5%E8%87%AA%E5%8A%A8%E5%A1%AB%E5%85%85%E5%A4%84%E7%90%86%E5%99%A8"><span class="nav-text">注入自动填充处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Spring-XML-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-4"><span class="nav-text">Spring XML 配置文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SpringBoot-%E9%85%8D%E7%BD%AE%E7%B1%BB-1"><span class="nav-text">SpringBoot 配置类</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Junit-%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81-3"><span class="nav-text">Junit 单元测试代码</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">567</span> <span class="site-state-item-name">文章</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">51</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub → https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail → mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap → /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/2cbf33d2.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay 的技术空间"><meta itemprop="description" content="专注于 Java 后端、分布式、微服务、云原生、数据库、系统架构、大数据、云计算、虚拟化、人工智能学习的技术博客。"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="MyBatis-Plus 入门教程之四 | Clay 的技术空间"><meta itemprop="description" content="本文主要介绍 MyBatis-Plus 的入门教程内容，包括逻辑删除、通用枚举、SQL 注入器、自动填充处理器等内容。"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> MyBatis-Plus 入门教程之四</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-07-11 23:12:41" itemprop="dateCreated datePublished" datetime="2019-07-11T23:12:41+08:00">2019-07-11</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-09-09 23:12:41" itemprop="dateModified" datetime="2022-09-09T23:12:41+08:00">2022-09-09</time></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">评论数：</span><a title="waline" href="/posts/2cbf33d2.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/2cbf33d2.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>4.3k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 ≈</span> <span>4 分钟</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h2><ul><li><a href="/posts/ed9df8e6.html">MyBatis-Plus 入门教程之一</a></li><li><a href="/posts/3fd3ab84.html">MyBatis-Plus 入门教程之二</a></li><li><a href="/posts/7d8f3d89.html">MyBatis-Plus 入门教程之三</a></li><li><a href="/posts/2cbf33d2.html">MyBatis-Plus 入门教程之四</a></li><li><a href="/posts/c5f15a9c.html">MyBatis-Plus 入门教程之五</a></li><li><a href="/posts/315d5197.html">MyBatis-Plus 入门教程之六</a></li><li><a href="/posts/2aa6fbd1.html">MyBatis-Plus 入门教程之七</a></li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="版本说明"><a href="#版本说明" class="headerlink" title="版本说明"></a>版本说明</h3><p>本文的教程内容是基于 MyBatis-Plus <code>3.5.2</code> 版本编写的，若你使用的是 <code>2.x</code> 或其他版本，可能会有部分知识点、案例代码不兼容，一切以 MyBatis-Plus 官方文档为准。</p><h2 id="MyBatis-Plus-逻辑删除"><a href="#MyBatis-Plus-逻辑删除" class="headerlink" title="MyBatis-Plus 逻辑删除"></a>MyBatis-Plus 逻辑删除</h2><h3 id="逻辑删除介绍"><a href="#逻辑删除介绍" class="headerlink" title="逻辑删除介绍"></a>逻辑删除介绍</h3><ul><li><p>只对自动注入的 SQL 生效</p><ul><li>插入：没有任何限制</li><li>删除：会转变为 SQL 更新语句，例如：<code>update user set deleted = 1 where id = 1 and deleted = 0</code></li><li>查找：会追加 <code>where</code> 条件过滤掉已删除的数据，且使用 <code>wrapper.entity</code> 生成的 <code>where</code> 条件会忽略该字段，例如：<code>select id, name, deleted from user where deleted = 0</code></li><li>更新：会追加 <code>where</code> 条件防止更新到已删除的数据，且使用 <code>wrapper.entity</code> 生成的 <code>where</code> 条件会忽略该字段，例如：<code>update user set age = 23 where id = 1 and deleted = 0</code></li></ul></li><li><p>字段类型支持说明</p><ul><li>支持所有数据类型（推荐使用 <code>Integer</code>、<code>Boolean</code>、<code>LocalDateTime</code> 数据类型）</li><li>如果数据库表字段使用 <code>datetime</code>，逻辑未删除值和已删除值支持配置为字符串 <code>null</code>，另一个值支持配置为函数来获取值（例如 <code>now()</code>）</li></ul></li></ul><span id="more"></span><div class="admonition note"><p class="admonition-title">提示</p><ul><li>逻辑删除是为了方便数据恢复和保护数据本身价值的一种方案，但实际就是删除<br></li><li>如果业务上需要频繁将数据查出来显示，那么就不应使用逻辑删除，而是应该以一个状态去表示数据记录的状态<br></li></ul></div><h3 id="逻辑删除使用案例"><a href="#逻辑删除使用案例" class="headerlink" title="逻辑删除使用案例"></a>逻辑删除使用案例</h3><p>本节所需的案例代码，可以直接从 <a target="_blank" rel="external nofollow" href="https://github.com/rqh656418510/mybatis-code/tree/main/mybatis-plus-study">GitHub</a> 下载对应章节 <code>mybatis-plus-lesson-10</code>。</p><div class="admonition note"><p class="admonition-title">逻辑删除的配置步骤</p><p>1、在实体类的属性上添加 <code>@TableLogic</code> 注解<br> 2、使用 Spring XML 配置文件或者 SpringBoot 配置文件的任意一种方式来配置 MyBatis-Plus 的逻辑删除<br></p></div><h4 id="创建数据库表"><a href="#创建数据库表" class="headerlink" title="创建数据库表"></a>创建数据库表</h4><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_department` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `deleted` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入表数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_department(id, name, deleted) <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">'开发部门'</span>, <span class="number">0</span>), (<span class="number">2</span>, <span class="string">'测试部门'</span>, <span class="number">0</span>), (<span class="number">3</span>, <span class="string">'产品部'</span>, <span class="number">1</span>);</span><br></pre></td></tr></tbody></table></figure><h4 id="添加-TableLogic-注解"><a href="#添加-TableLogic-注解" class="headerlink" title="添加 @TableLogic 注解"></a>添加 <code>@TableLogic</code> 注解</h4><p>在实体类的属性上添加 <code>@TableLogic</code> 注解</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Department</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@TableLogic</span></span><br><span class="line">	<span class="keyword">private</span> Integer deleted;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="更改项目的配置文件"><a href="#更改项目的配置文件" class="headerlink" title="更改项目的配置文件"></a>更改项目的配置文件</h4><h5 id="Spring-XML-配置文件"><a href="#Spring-XML-配置文件" class="headerlink" title="Spring XML 配置文件"></a>Spring XML 配置文件</h5><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"globalConfig"</span> <span class="attr">ref</span>=<span class="string">"globalConfig"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"globalConfig"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.core.config.GlobalConfig"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dbConfig"</span> <span class="attr">ref</span>=<span class="string">"dbConfig"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dbConfig"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.core.config.GlobalConfig.DbConfig"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 全局逻辑删除的实体属性名（since 3.3.0，配置后实体类属性可以不单独配置 @TableLogic 注解）--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;property name="logicDeleteField" value="deleted" /&gt; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 逻辑已删除值（默认为 1）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logicDeleteValue"</span> <span class="attr">value</span>=<span class="string">"1"</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 逻辑未删除值（默认为 0）--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"logicNotDeleteValue"</span> <span class="attr">value</span>=<span class="string">"0"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h5 id="SpringBoot-配置文件"><a href="#SpringBoot-配置文件" class="headerlink" title="SpringBoot 配置文件"></a>SpringBoot 配置文件</h5><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="comment"># logic-delete-field: deleted             # 全局逻辑删除的实体属性名（since 3.3.0，配置后实体类属性可以不单独配置 @TableLogic 注解）</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span>                     <span class="comment"># 逻辑已删除值（默认为 1）</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span>                 <span class="comment"># 逻辑未删除值（默认为 0）</span></span><br></pre></td></tr></tbody></table></figure><h4 id="Junit-单元测试代码"><a href="#Junit-单元测试代码" class="headerlink" title="Junit 单元测试代码"></a>Junit 单元测试代码</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Mapper 接口 </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DepartmentMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Department</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Junit 测试代码</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusApplicationTest</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> DepartmentMapper deptMapper;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">()</span> </span>{</span><br><span class="line">		List&lt;Department&gt; list = deptMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">		list.forEach(System.out::println);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">selectByWrapper</span><span class="params">()</span> </span>{</span><br><span class="line">		QueryWrapper&lt;Department&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">		wrapper.like(<span class="string">"name"</span>, <span class="string">"测试"</span>);</span><br><span class="line">		List&lt;Department&gt; list = deptMapper.selectList(wrapper);</span><br><span class="line">		list.forEach(System.out::println);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delete</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">int</span> deleteResult = deptMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">		System.out.println(<span class="string">"deleteResult: "</span> + (deleteResult &gt; <span class="number">0</span>));</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>{</span><br><span class="line">		Department department = <span class="keyword">new</span> Department();</span><br><span class="line">		department.setName(<span class="string">"行政部"</span>);</span><br><span class="line">		department.setId(<span class="number">1L</span>);</span><br><span class="line">		<span class="keyword">int</span> updateResult = deptMapper.updateById(department);</span><br><span class="line">		System.out.println(<span class="string">"updateResult: "</span> + (updateResult &gt; <span class="number">0</span>));</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>执行上面的测试代码后，控制台输出的日志信息如下：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">==&gt;  Preparing: SELECT id,name,deleted FROM t_department WHERE deleted=0</span><br><span class="line">==&gt; Parameters: </span><br><span class="line">&lt;==    Columns: id, name, deleted</span><br><span class="line">&lt;==        Row: 1, 开发部门, 0</span><br><span class="line">&lt;==        Row: 2, 测试部门, 0</span><br><span class="line">&lt;==      Total: 2</span><br><span class="line"></span><br><span class="line">==&gt;  Preparing: SELECT id,name,deleted FROM t_department WHERE deleted=0 AND (name LIKE ?)</span><br><span class="line">==&gt; Parameters: %测试%(String)</span><br><span class="line">&lt;==    Columns: id, name, deleted</span><br><span class="line">&lt;==        Row: 2, 测试部门, 0</span><br><span class="line">&lt;==      Total: 1</span><br><span class="line"></span><br><span class="line">==&gt;  Preparing: UPDATE t_department SET deleted=1 WHERE id=? AND deleted=0</span><br><span class="line">==&gt; Parameters: 1(Long)</span><br><span class="line">&lt;==    Updates: 1</span><br><span class="line"></span><br><span class="line">==&gt;  Preparing: UPDATE t_department SET name=? WHERE id=? AND deleted=0</span><br><span class="line">==&gt; Parameters: 行政部(String), 1(Long)</span><br><span class="line">&lt;==    Updates: 0</span><br></pre></td></tr></tbody></table></figure><h3 id="逻辑删除常见问题"><a href="#逻辑删除常见问题" class="headerlink" title="逻辑删除常见问题"></a>逻辑删除常见问题</h3><blockquote><p>如何插入数据？</p></blockquote><ul><li>字段在数据库定义默认值（推荐）</li><li><code>insert</code> 前自己 <code>set</code> 值</li><li>使用 <a target="_blank" rel="external nofollow" href="https://baomidou.com/pages/4c6bcf/">自动填充处理器</a></li></ul><blockquote><p>删除接口自动填充处理器失效</p></blockquote><ul><li>1、使用 <code>deleteById</code> 方法（推荐）</li><li>2、使用 <code>update</code> 方法，即 <code>UpdateWrapper.set(column, value)</code>（推荐）</li><li>3、使用 <code>update</code> 方法，即 <code>UpdateWrapper.setSql("column=value")</code></li><li>4、使用 <a href="/pages/42ea4a/">Sql 注入器</a> 注入 <code>com.baomidou.mybatisplus.extension.injector.methods.LogicDeleteByIdWithFill</code>（3.5.0 版本已废弃，推荐使用 <code>deleteById</code>）</li></ul><h2 id="MyBatis-Plus-通用枚举"><a href="#MyBatis-Plus-通用枚举" class="headerlink" title="MyBatis-Plus 通用枚举"></a>MyBatis-Plus 通用枚举</h2><h3 id="通用枚举介绍"><a href="#通用枚举介绍" class="headerlink" title="通用枚举介绍"></a>通用枚举介绍</h3><p>数据库表中有些字段的值是固定的，例如性别（男或女），此时可以使用 MyBatis-Plus 的通用枚举来实现，这样可以让 MyBatis 更优雅地使用枚举属性。</p><h3 id="通用枚举使用案例"><a href="#通用枚举使用案例" class="headerlink" title="通用枚举使用案例"></a>通用枚举使用案例</h3><p>本节所需的案例代码，可以直接从 <a target="_blank" rel="external nofollow" href="https://github.com/rqh656418510/mybatis-code/tree/main/mybatis-plus-study">GitHub</a> 下载对应章节 <code>mybatis-plus-lesson-11</code>。</p><div class="admonition note"><p class="admonition-title">通用枚举的配置步骤</p><p>1、在枚举类的属性上添加 <code>@EnumValue</code> 注解，或者让枚举类实现 <code>IEnum</code> 接口<br> 2、MyBatis-Plus <code>3.5.2</code> 以下的版本，需要配置枚举包扫描（局部方式），或者更改 MyBatis 默认使用的 <code>EnumTypeHandler</code> 枚举类型处理器（全局方式）<br></p></div><h4 id="创建数据库表-1"><a href="#创建数据库表-1" class="headerlink" title="创建数据库表"></a>创建数据库表</h4><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据库表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `t_admin` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `type` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 插入表数据</span></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_admin(id, name, type) <span class="keyword">values</span>(<span class="number">1</span>, <span class="string">'Alex'</span>, <span class="number">1</span>);</span><br></pre></td></tr></tbody></table></figure><h4 id="添加-EnumValue-注解"><a href="#添加-EnumValue-注解" class="headerlink" title="添加 @EnumValue 注解"></a>添加 @EnumValue 注解</h4><p>在枚举类的属性上添加 <code>@EnumValue</code> 注解，MyBatis-Plus 在插入数据时，会将拥有 <code>@EnumValue</code> 注解的属性的值保存到数据库表里。</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">AdminType</span> </span>{</span><br><span class="line"></span><br><span class="line">	ROOT(<span class="number">0</span>, <span class="string">"Root"</span>), ADMIN(<span class="number">1</span>, <span class="string">"Admin"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@EnumValue</span></span><br><span class="line">	<span class="keyword">private</span> Integer value;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String description;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getValue</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.description;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">AdminType</span><span class="params">(Integer value, String description)</span> </span>{</span><br><span class="line">		<span class="keyword">this</span>.value = value;</span><br><span class="line">		<span class="keyword">this</span>.description = description;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>或者让枚举类实现 <code>IEnum</code> 接口，然后重写 <code>getValue()</code> 方法</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">AdminType</span> <span class="keyword">implements</span> <span class="title">IEnum</span>&lt;<span class="title">Integer</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">	ROOT(<span class="number">0</span>, <span class="string">"Root"</span>), ADMIN(<span class="number">1</span>, <span class="string">"Admin"</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer value;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String description;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getValue</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getDescription</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">this</span>.description;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">private</span> <span class="title">AdminType</span><span class="params">(Integer value, String description)</span> </span>{</span><br><span class="line">		<span class="keyword">this</span>.value = value;</span><br><span class="line">		<span class="keyword">this</span>.description = description;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="配置枚举包扫描"><a href="#配置枚举包扫描" class="headerlink" title="配置枚举包扫描"></a>配置枚举包扫描</h4><p>值得一提的是，从 MyBatis-Plus <code>3.5.2</code> 版本开始，无需手动配置枚举包扫描。</p><h5 id="局部方式"><a href="#局部方式" class="headerlink" title="局部方式"></a>局部方式</h5><p>当使用以下的方式配置枚举包扫描后，MyBatis-Plus 提供的 <code>MybatisSqlSessionFactoryBean</code> 会自动扫描包内合法的枚举类（使用了 <code>@EnumValue</code> 注解或者实现了 <code>IEnum</code> 接口），分别为这些枚举类注册使用 <code>MybatisEnumTypeHandler</code>。换句话说，只有指定包下的枚举类会使用新的 <code>TypeHandler</code>。其他包下，或者包内没有做相关改造的枚举类，仍然会使用 MyBatis 默认提供的 <code>DefaultEnumTypeHandler</code>。</p><h6 id="Spring-XML-配置文件-1"><a href="#Spring-XML-配置文件-1" class="headerlink" title="Spring XML 配置文件"></a>Spring XML 配置文件</h6><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.spring.MybatisSqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 枚举包扫描，支持通配符 * 或者 ; 分割 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"typeEnumsPackage"</span> <span class="attr">value</span>=<span class="string">"com.clay.mybatis.enums"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h6 id="SpringBoot-配置文件-1"><a href="#SpringBoot-配置文件-1" class="headerlink" title="SpringBoot 配置文件"></a>SpringBoot 配置文件</h6><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="comment"># 枚举包扫描，支持通配符 * 或者 ; 分割</span></span><br><span class="line">  <span class="attr">typeEnumsPackage:</span> <span class="string">com.clay.mybatis.enums</span></span><br></pre></td></tr></tbody></table></figure><h5 id="全局方式"><a href="#全局方式" class="headerlink" title="全局方式"></a>全局方式</h5><p>此方式用来全局更改 MyBatis 默认使用的 <code>EnumTypeHandler</code> 枚举类型处理器。</p><h6 id="Spring-XML-配置文件-2"><a href="#Spring-XML-配置文件-2" class="headerlink" title="Spring XML 配置文件"></a>Spring XML 配置文件</h6><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configuration"</span> <span class="attr">ref</span>=<span class="string">"configuration"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"configuration"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.core.MybatisConfiguration"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 更改 MyBatis 的 DefaultEnumTypeHandler --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultEnumTypeHandler"</span> <span class="attr">value</span>=<span class="string">"com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><h6 id="SpringBoot-配置文件-2"><a href="#SpringBoot-配置文件-2" class="headerlink" title="SpringBoot 配置文件"></a>SpringBoot 配置文件</h6><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">    <span class="comment"># 更改 MyBatis 的 DefaultEnumTypeHandler</span></span><br><span class="line">    <span class="attr">configuration:</span></span><br><span class="line">        <span class="attr">default-enum-type-handler:</span> <span class="string">com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler</span></span><br></pre></td></tr></tbody></table></figure><h6 id="通过-MybatisPlusPropertiesCustomizer-自定义"><a href="#通过-MybatisPlusPropertiesCustomizer-自定义" class="headerlink" title="通过 MybatisPlusPropertiesCustomizer 自定义"></a>通过 MybatisPlusPropertiesCustomizer 自定义</h6><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan("com.clay.mybatis.dao")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MybatisPlusPropertiesCustomizer <span class="title">mybatisPlusPropertiesCustomizer</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> properties -&gt; {</span><br><span class="line">            GlobalConfig globalConfig = properties.getGlobalConfig();</span><br><span class="line">            globalConfig.setBanner(<span class="keyword">false</span>);</span><br><span class="line">            MybatisConfiguration configuration = <span class="keyword">new</span> MybatisConfiguration();</span><br><span class="line">            <span class="comment">// 更改 MyBatis 的 DefaultEnumTypeHandler</span></span><br><span class="line">            configuration.setDefaultEnumTypeHandler(MybatisEnumTypeHandler.class);</span><br><span class="line">            properties.setConfiguration(configuration);</span><br><span class="line">        };</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="Junit-单元测试代码-1"><a href="#Junit-单元测试代码-1" class="headerlink" title="Junit 单元测试代码"></a>Junit 单元测试代码</h4><ul><li>实体类</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Admin</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> AdminType type;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>Mapper 接口</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AdminMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Admin</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>Junit 单元测试</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusApplicationTest</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> AdminMapper adminMapper;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>{</span><br><span class="line">		Admin admin = <span class="keyword">new</span> Admin();</span><br><span class="line">		admin.setName(<span class="string">"David"</span>);</span><br><span class="line">		admin.setType(AdminType.ROOT);</span><br><span class="line">		adminMapper.insert(admin);</span><br><span class="line">		System.out.println(admin);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">select</span><span class="params">()</span> </span>{</span><br><span class="line">		Admin admin = adminMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">		System.out.println(admin);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>执行上面的测试代码后，MyBatis-Plus 发出的 SQL 语句如下：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">==&gt;  Preparing: INSERT INTO t_admin ( name, type ) VALUES ( ?, ? )</span><br><span class="line">==&gt; Parameters: David(String), 0(Integer)</span><br><span class="line">&lt;==    Updates: 1</span><br><span class="line"></span><br><span class="line">==&gt;  Preparing: SELECT id,name,type FROM t_admin WHERE id=?</span><br><span class="line">==&gt; Parameters: 1(Long)</span><br><span class="line">&lt;==    Columns: id, name, type</span><br><span class="line">&lt;==        Row: 1, Alex, 1</span><br><span class="line">&lt;==      Total: 1</span><br></pre></td></tr></tbody></table></figure><h3 id="序列化枚举值为前端返回值"><a href="#序列化枚举值为前端返回值" class="headerlink" title="序列化枚举值为前端返回值"></a>序列化枚举值为前端返回值</h3><ul><li><a target="_blank" rel="external nofollow" href="https://baomidou.com/pages/8390a4/#%E5%A6%82%E4%BD%95%E5%BA%8F%E5%88%97%E5%8C%96%E6%9E%9A%E4%B8%BE%E5%80%BC%E4%B8%BA%E5%89%8D%E7%AB%AF%E8%BF%94%E5%9B%9E%E5%80%BC">如何序列化枚举值为前端返回值？</a></li></ul><h2 id="MyBatis-Plus-SQL-注入器"><a href="#MyBatis-Plus-SQL-注入器" class="headerlink" title="MyBatis-Plus SQL 注入器"></a>MyBatis-Plus SQL 注入器</h2><h3 id="SQL-注入器介绍"><a href="#SQL-注入器介绍" class="headerlink" title="SQL 注入器介绍"></a>SQL 注入器介绍</h3><p>Mybatis-Plus 的 SQL 注入器（<code>SqlInjector</code>）可以自定义各种 SQL 语句，并注入到 MyBatis 全局中，这相当于自定义 Mybatis-Plus 自动注入的方法（例如通用的 CRUD 方法）。之前需要在 SQL 映射文件中配置的 SQL 语句，现在可以通过扩展 <code>SqlInjector</code> 来加载到 MyBatis 环境。在 MyBatis-Plus 中自定义自己的通用方法，可以实现接口 <code>ISqlInjector</code>，也可以继承抽象类 <code>AbstractSqlInjector</code>，或者继承默认实现类 <code>DefaultSqlInjector</code> 来注入通用方法。<strong>SQL 注入器的作用是可以在 Mapper 层自定义通用方法，然后将 SQL 模板自动注入到 MyBatis-Plus 中，这样就可以不用在 SQL 映射文件中重复编写 SQL 语句。</strong></p><div class="admonition note"><p class="admonition-title">注入器和自定义 Mapper 方法 + 编写 SQL 映射文件的区别</p><p>使用 SQL 注入器，通常是使用自定义 Mapper（如 CustomBaseMapper）接口继承 <code>BaseMapper</code> 接口，我们自定义的通用方法就写在 CustomBaseMapper 里。然后我们业务相关的 Mapper 继承 CustomBaseMapper 后，就可以直接使用自定义的通用方法了。这一切只需要我们自定义一个 SQL 模板，注入到 MyBatis-Plus 即可，而不是换一张表就得重新编写一次 SQL 映射文件。</p></div><h3 id="SQL-注入器使用案例"><a href="#SQL-注入器使用案例" class="headerlink" title="SQL 注入器使用案例"></a>SQL 注入器使用案例</h3><div class="admonition note"><p class="admonition-title">提示</p><p>本节所需的案例代码，可以直接从 <a target="_blank" rel="external nofollow" href="https://github.com/rqh656418510/mybatis-code/tree/main/mybatis-plus-study">GitHub</a> 下载对应章节 <code>mybatis-plus-lesson-14</code>。</p></div><h4 id="定义-Mapper-接口"><a href="#定义-Mapper-接口" class="headerlink" title="定义 Mapper 接口"></a>定义 Mapper 接口</h4><p>定义 Mapper 接口（继承自 <code>BaseMapper</code>），新增自定义的通用方法，以后其他业务 Mapper 都可以继承自这个 <code>CustomBaseMapper</code> 接口</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CustomBaseMapper</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">T</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">	<span class="function">List&lt;T&gt; <span class="title">findAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="定义方法类"><a href="#定义方法类" class="headerlink" title="定义方法类"></a>定义方法类</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FindAll</span> <span class="keyword">extends</span> <span class="title">AbstractMethod</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> MappedStatement <span class="title">injectMappedStatement</span><span class="params">(Class&lt;?&gt; mapperClass, Class&lt;?&gt; modelClass, TableInfo tableInfo)</span> </span>{</span><br><span class="line">		<span class="comment">// 执行的 SQL 语句</span></span><br><span class="line">		String sql = <span class="string">"select * from "</span> + tableInfo.getTableName();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 方法名称，必须与 Mapper 接口中的方法名一致</span></span><br><span class="line">		String method = <span class="string">"findAll"</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 添加 MappedStatement（作用相当于编写 SQL 映射文件）</span></span><br><span class="line">		SqlSource sqlSource = languageDriver.createSqlSource(configuration, sql, modelClass);</span><br><span class="line">		MappedStatement mappedStatement = <span class="keyword">this</span>.addSelectMappedStatementForOther(mapperClass, method, sqlSource, modelClass);</span><br><span class="line">		<span class="keyword">return</span> mappedStatement;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="定义-SQL-注入器"><a href="#定义-SQL-注入器" class="headerlink" title="定义 SQL 注入器"></a>定义 SQL 注入器</h4><p>定义 SQL 注入器，将自定义的通用方法注入到 MyBatis-Plus 全局中</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomSqlInjector</span> <span class="keyword">extends</span> <span class="title">DefaultSqlInjector</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;AbstractMethod&gt; <span class="title">getMethodList</span><span class="params">(Class&lt;?&gt; mapperClass, TableInfo tableInfo)</span> </span>{</span><br><span class="line">		<span class="comment">// 获取父类中方法的集合</span></span><br><span class="line">		List&lt;AbstractMethod&gt; methodList = <span class="keyword">super</span>.getMethodList(mapperClass, tableInfo);</span><br><span class="line">		<span class="comment">// 添加自定义的通用方法</span></span><br><span class="line">		methodList.add(<span class="keyword">new</span> FindAll());</span><br><span class="line">		<span class="keyword">return</span> methodList;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="注入-SQL-注入器"><a href="#注入-SQL-注入器" class="headerlink" title="注入 SQL 注入器"></a>注入 SQL 注入器</h4><h5 id="Spring-XML-配置文件-3"><a href="#Spring-XML-配置文件-3" class="headerlink" title="Spring XML 配置文件"></a>Spring XML 配置文件</h5><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"globalConfig"</span> <span class="attr">ref</span>=<span class="string">"globalConfig"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"globalConfig"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.core.config.GlobalConfig"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 注入 SQL 注入器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlInjector"</span> <span class="attr">ref</span>=<span class="string">"customSqlInjector"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 自定义的 SQL 注入器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"customSqlInjector"</span> <span class="attr">class</span>=<span class="string">"com.clay.mybatis.injector.CustomSqlInjector"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure><h5 id="SpringBoot-配置类"><a href="#SpringBoot-配置类" class="headerlink" title="SpringBoot 配置类"></a>SpringBoot 配置类</h5><p>定义 SpringBoot 配置类，将 SQL 注入器注入 Spring 容器中</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan("com.clay.mybatis.dao")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> CustomSqlInjector <span class="title">customSqlInjector</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> CustomSqlInjector();</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="Junit-单元测试代码-2"><a href="#Junit-单元测试代码-2" class="headerlink" title="Junit 单元测试代码"></a>Junit 单元测试代码</h4><ul><li>定义业务 Mapper 接口，继承自 <code>CustomBaseMapper</code></li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmployeeMapper</span> <span class="keyword">extends</span> <span class="title">CustomBaseMapper</span>&lt;<span class="title">Employee</span>&gt; </span>{</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>Junit 测试代码</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusApplicationTest</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">findAll</span><span class="params">()</span> </span>{</span><br><span class="line">		List&lt;Employee&gt; list = employeeMapper.findAll();</span><br><span class="line">		list.forEach(System.out::println);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>执行上面的测试代码，控制台输出的日志信息如下：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">==&gt;  Preparing: select * from t_employee</span><br><span class="line">==&gt; Parameters: </span><br><span class="line">&lt;==    Columns: id, last_name, gender, email, age</span><br><span class="line">&lt;==        Row: 1, Jim, 1, jim@gmail.com, 26</span><br><span class="line">&lt;==        Row: 2, Peter, 1, peter@gmail.com, 29</span><br><span class="line">&lt;==        Row: 3, David, 1, david@gmail.com, 28</span><br><span class="line">&lt;==        Row: 4, Tom, 1, tom@gmail.com, 25</span><br><span class="line">&lt;==      Total: 4</span><br><span class="line"></span><br><span class="line">Employee [id=1, lastName=Jim, gender=1, email=jim@gmail.com, age=26]</span><br><span class="line">Employee [id=2, lastName=Peter, gender=1, email=peter@gmail.com, age=29]</span><br><span class="line">Employee [id=3, lastName=David, gender=1, email=david@gmail.com, age=28]</span><br><span class="line">Employee [id=4, lastName=Tom, gender=1, email=tom@gmail.com, age=25]</span><br></pre></td></tr></tbody></table></figure><p><code>EmployeeMapper</code> 接口继承自 <code>CustomBaseMapper</code> 接口，拥有了 <code>findAll</code> 方法；由于 <code>CustomSqlInjector</code> SQL 注入器的存在，会自动将 SQL 模板注入到 MyBatis-Plus 中，这样即使不在 SQL 映射文件中编写 SQL 语句，也能执行对应的 SQL 语句。</p><h2 id="MyBatis-Plus-自动填充处理器"><a href="#MyBatis-Plus-自动填充处理器" class="headerlink" title="MyBatis-Plus 自动填充处理器"></a>MyBatis-Plus 自动填充处理器</h2><h3 id="自动填充处理器介绍"><a href="#自动填充处理器介绍" class="headerlink" title="自动填充处理器介绍"></a>自动填充处理器介绍</h3><p><strong>MyBatis-Plus 自动填充处理器的工作原理：在插入或者更新数据库表数据之前，直接给 <code>Entity</code> 的属性设置值。</strong>实现自动填充功能的核心对象是 <code>MetaObjectHandler</code> 接口和 <code>MetaObject</code> 类，其中的 <code>MetaObject</code> 是 MyBatis 提供的一个用于更加方便、更加优雅地访问对象的属性，并给对象的属性设置值的一个对象。<code>MetaObject</code> 还会用于包装对象，支持对 Object 、Map、Collection 等对象进行包装。本质上 <code>MetaObject</code> 获取对象的属性值或者是给对象的属性设置值，最终是要通过 <code>Reflector（反射器）</code> 获取到属性的对应方法的 <code>Invoker</code> 对象，然后执行 <code>invoke</code> 方法。</p><div class="admonition note"><p class="admonition-title">自动填充处理器的常用用途</p><p>自动填充处理器通常用于对公共字段进行填充，例如数据库表中的创建时间（<code>create_time</code>）以及修改时间（<code>update_time</code>）字段，使用它的好处是可以统一对这些公共字段进行处理，避免编写重复的代码。</p></div><h3 id="自动填充策略说明"><a href="#自动填充策略说明" class="headerlink" title="自动填充策略说明"></a>自动填充策略说明</h3><ul><li>使用方法：<code>@TableField(fill = FieldFill.INSERT)</code></li></ul><table><thead><tr><th>值</th><th>描述</th></tr></thead><tbody><tr><td> DEFAULT</td><td> 默认不处理</td></tr><tr><td> INSERT</td><td> 插入时填充字段</td></tr><tr><td> UPDATE</td><td> 更新时填充字段</td></tr><tr><td> INSERT_UPDATE</td><td> 插入和更新时填充字段</td></tr></tbody></table><h3 id="自动填充处理器使用案例"><a href="#自动填充处理器使用案例" class="headerlink" title="自动填充处理器使用案例"></a>自动填充处理器使用案例</h3><p>本节所需的案例代码，可以直接从 <a target="_blank" rel="external nofollow" href="https://github.com/rqh656418510/mybatis-code/tree/main/mybatis-plus-study">GitHub</a> 下载对应章节 <code>mybatis-plus-lesson-15</code>。</p><div class="admonition note"><p class="admonition-title">自动填充处理器的实现步骤</p><ul><li>1、在需要填充的实体类属性上添加注解，例如 <code>@TableFile(fill = FieldFill.INSERT)</code></li><li>2、实现 <code>MetaObjectHandler</code> 接口，自定义自动填充处理器</li><li> 3、将自定义填充处理器注入到 MyBatis-Plus 全局中</li></ul></div><h4 id="添加-TableField-注解"><a href="#添加-TableField-注解" class="headerlink" title="添加 @TableField 注解"></a>添加 @TableField 注解</h4><p>在实体类的属性上添加 <code>@TableField</code> 注解，并通过注解的 <code>fill</code> 属性指定填充策略</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">	<span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">	...</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h4 id="定义自动填充处理器"><a href="#定义自动填充处理器" class="headerlink" title="定义自动填充处理器"></a>定义自动填充处理器</h4><p>实现 <code>MetaObjectHandler</code> 接口，定义自动填充处理器类</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 插入操作，自动填充</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>{</span><br><span class="line">		Object fieldValue = getFieldValByName(<span class="string">"gender"</span>, metaObject);</span><br><span class="line">		<span class="keyword">if</span> (fieldValue == <span class="keyword">null</span>) {</span><br><span class="line">			System.out.println(<span class="string">"******* 插入操作满足自动填充条件 *******"</span>);</span><br><span class="line">			<span class="keyword">this</span>.setFieldValByName(<span class="string">"gender"</span>, <span class="string">"1"</span>, metaObject);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 更新操作，自动填充</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>{</span><br><span class="line">		Object fieldValue = getFieldValByName(<span class="string">"gender"</span>, metaObject);</span><br><span class="line">		<span class="keyword">if</span> (fieldValue == <span class="keyword">null</span>) {</span><br><span class="line">			System.out.println(<span class="string">"******* 更新操作满足自动填充条件 *******"</span>);</span><br><span class="line">			<span class="keyword">this</span>.setFieldValByName(<span class="string">"gender"</span>, <span class="string">"1"</span>, metaObject);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="注入自动填充处理器"><a href="#注入自动填充处理器" class="headerlink" title="注入自动填充处理器"></a>注入自动填充处理器</h4><h5 id="Spring-XML-配置文件-4"><a href="#Spring-XML-配置文件-4" class="headerlink" title="Spring XML 配置文件"></a>Spring XML 配置文件</h5><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"globalConfig"</span> <span class="attr">ref</span>=<span class="string">"globalConfig"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"globalConfig"</span> <span class="attr">class</span>=<span class="string">"com.baomidou.mybatisplus.core.config.GlobalConfig"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 注入自动填充处理器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"metaObjectHandler"</span> <span class="attr">ref</span>=<span class="string">"customMetaObjectHandler"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 自定义的自动填充处理器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"customMetaObjectHandler"</span> <span class="attr">class</span>=<span class="string">"com.clay.mybatis.handler.CustomMetaObjectHandler"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure><h5 id="SpringBoot-配置类-1"><a href="#SpringBoot-配置类-1" class="headerlink" title="SpringBoot 配置类"></a>SpringBoot 配置类</h5><p>定义 SpringBoot 配置类，将自动填充处理器注入 Spring 容器中</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan("com.clay.mybatis.dao")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MybatisPlusConfig</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> CustomMetaObjectHandler <span class="title">customMetaObjectHandler</span><span class="params">()</span> </span>{</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> CustomMetaObjectHandler();</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="Junit-单元测试代码-3"><a href="#Junit-单元测试代码-3" class="headerlink" title="Junit 单元测试代码"></a>Junit 单元测试代码</h4><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusApplicationTest</span> </span>{</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> EmployeeMapper employeeMapper;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">()</span> </span>{</span><br><span class="line">		Employee employee = <span class="keyword">new</span> Employee();</span><br><span class="line">		employee.setEmail(<span class="string">"clion@gmail.com"</span>);</span><br><span class="line">		employee.setLastName(<span class="string">"Clion"</span>);</span><br><span class="line">		employee.setAge(<span class="number">26</span>);</span><br><span class="line">		employeeMapper.insert(employee);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">()</span> </span>{</span><br><span class="line">		Employee employee = <span class="keyword">new</span> Employee();</span><br><span class="line">		employee.setId(<span class="number">1L</span>);</span><br><span class="line">		employee.setEmail(<span class="string">"empty@gmai.com"</span>);</span><br><span class="line">		employeeMapper.updateById(employee);</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>执行上面的测试代码，控制台输出的日志信息如下：</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">******* 插入操作满足自动填充条件 *******</span><br><span class="line">==&gt;  Preparing: <span class="function">INSERT INTO <span class="title">t_employee</span> <span class="params">( last_name, gender, email, age )</span> <span class="title">VALUES</span> <span class="params">( ?, ?, ?, ? )</span></span></span><br><span class="line"><span class="function"></span>==&gt; Parameters: Clion(String), <span class="number">1</span>(String), clion<span class="meta">@gmail</span>.com(String), <span class="number">26</span>(Integer)</span><br><span class="line">&lt;==    Updates: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">******* 更新操作满足自动填充条件 *******</span><br><span class="line">==&gt;  Preparing: UPDATE t_employee SET gender=?, email=? WHERE id=?</span><br><span class="line">==&gt; Parameters: <span class="number">1</span>(String), empty<span class="meta">@gmai</span>.com(String), <span class="number">1</span>(Long)</span><br><span class="line">&lt;==    Updates: <span class="number">1</span></span><br></pre></td></tr></tbody></table></figure><p>观察上面的输出结果，可以发现执行插入和更新操作之前，当实体类的 <code>gender</code> 属性为 <code>NULL</code> 时，其值会被自动填充。</p><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"全栈技术驿站",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>支持一根棒棒糖！</div> <button> 赞赏</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay 微信"> <span>微信</span></div><div> <img src="/img/pay_zfb.png" alt="Clay 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Clay</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.techgrow.cn/posts/2cbf33d2.html" title="MyBatis-Plus 入门教程之四">https://www.techgrow.cn/posts/2cbf33d2.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">欢迎添加博主微信，请备注 "博客"，届时会邀请您加入百人微信群</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/ORM/" rel="tag"><i class="fa fa-tag"></i> ORM</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/a6aa7529.html" rel="prev" title="数据库读写分离解决方案介绍"><i class="fa fa-angle-left"></i> 数据库读写分离解决方案介绍</a></div><div class="post-nav-item"> <a href="/posts/42b280ec.html" rel="next" title="HTML 开发随笔">HTML 开发随笔<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright © 2018 – <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title="站点总字数">1.3m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>站点阅读时长 ≈</span> <span title="站点阅读时长">19:27</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" 年 "+s+" 日 "+d+" 小时 "+l+" 分钟 "+u+" 秒 "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">粤 ICP 备 19024664 号</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">粤公网安备 44011302004035 号</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"/lib/mermaid/dist/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/app/api/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，非法请求来源！");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，上传过于频繁！");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，系统内部出错！");
        } else {
          alert("图片上传失败，无法获取UploadToken，未知Http响应状态码！");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("图片上传失败，无法获取UploadToken，未知错误！");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"支持匿名评论啦，若希望及时收到博主的反馈，建议登录评论或者在上方的邮箱输入框留下邮箱地址哦 (๑•̀ㅂ•́)و✧"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/app/api/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/2cbf33d2.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>