<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><meta name="description" content="本文主要介绍如何使用Nacos作为配置中心，包括安装Nacos Server、Nacos配置入门、Nacos配置管理模型等。"><meta property="og:type" content="article"><meta property="og:title" content="Nacos 入门教程 - 配置管理基础篇"><meta property="og:url" content="https://www.techgrow.cn/posts/ab6959cb.html"><meta property="og:site_name" content="Clay 的技术空间"><meta property="og:description" content="本文主要介绍如何使用Nacos作为配置中心，包括安装Nacos Server、Nacos配置入门、Nacos配置管理模型等。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/config-server-vs-4.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/spring-cloud-alibaba-ecology.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-server-web-ui.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-add-config.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nas-web-click-add-button.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-web-add-config.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-web-select-config.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-data-model.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-data-model-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-namespace.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-namespace-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-create-namespace.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-create-namespace-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-create-namespace-3.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-export-configs.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-inport-configs.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-clone-configs.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-clone-configs-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-config-history.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-config-rollback.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/12/nacos-listener.png"><meta property="article:published_time" content="2020-12-01T13:12:19.000Z"><meta property="article:modified_time" content="2020-12-01T13:12:19.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="微服务"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2020/12/config-server-vs-4.png"><link rel="canonical" href="https://www.techgrow.cn/posts/ab6959cb.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/ab6959cb.html","path":"posts/ab6959cb.html","title":"Nacos 入门教程 - 配置管理基础篇"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Nacos 入门教程 - 配置管理基础篇 | Clay 的技术空间</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay 的技术空间" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay 的技术空间</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">用进废退 | 艺不压身</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>搜索</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>读书笔记</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>评论管理</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%BA%B2"><span class="nav-text">大纲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%80%E6%9C%AF%E8%B5%84%E6%BA%90"><span class="nav-text">技术资源</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E4%BB%8B%E7%BB%8D"><span class="nav-text">配置中心介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83"><span class="nav-text">什么是配置中心</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E6%B5%81%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%AF%B9%E6%AF%94"><span class="nav-text">主流配置中心对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E7%AE%80%E4%BB%8B"><span class="nav-text">Nacos 简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E6%A6%82%E8%BF%B0"><span class="nav-text">Nacos 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E5%8A%9F%E8%83%BD"><span class="nav-text">Nacos 功能</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E7%89%B9%E6%80%A7"><span class="nav-text">Nacos 特性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E7%94%9F%E6%80%81%E5%9B%BE"><span class="nav-text">Nacos 生态图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E5%AE%89%E8%A3%85"><span class="nav-text">Nacos 安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-Nacos"><span class="nav-text">安装 Nacos</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="nav-text">安装环境准备</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85"><span class="nav-text">通过源码编译安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E4%B8%8B%E8%BD%BD%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8C%85%E5%AE%89%E8%A3%85"><span class="nav-text">通过下载二进制包安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87-Docker-%E9%95%9C%E5%83%8F%E5%BF%AB%E9%80%9F%E5%AE%89%E8%A3%85"><span class="nav-text">通过 Docker 镜像快速安装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BF%E9%97%AE-Nacos-%E7%9A%84-Web-%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="nav-text">访问 Nacos 的 Web 控制台</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Open-API-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%B5%8B%E8%AF%95"><span class="nav-text">Open API 配置管理测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E9%83%A8-MySQL-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%94%AF%E6%8C%81%EF%BC%88%E6%8C%81%E4%B9%85%E5%8C%96%E9%85%8D%E7%BD%AE%EF%BC%89"><span class="nav-text">外部 MySQL 数据库支持（持久化配置）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E9%85%8D%E7%BD%AE%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">Nacos 配置入门案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E7%82%B9%E5%87%BB%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AE%E6%8C%89%E9%92%AE"><span class="nav-text">第一步：点击新增配置按钮</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E6%96%B0%E5%A2%9E%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="nav-text">第二步：新增配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%9F%A5%E8%AF%A2%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="nav-text">第三步：查询配置信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E8%B0%83%E7%94%A8-Java-API-%E8%8E%B7%E5%8F%96-Nacos-%E7%9A%84%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF"><span class="nav-text">第四步：调用 Java API 获取 Nacos 的配置信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E5%9F%BA%E7%A1%80"><span class="nav-text">Nacos 配置管理基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%A8%A1%E5%9E%8B"><span class="nav-text">Nacos 配置管理模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Nacos-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%A6%82%E5%BF%B5"><span class="nav-text">Nacos 配置管理概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Nacos-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="nav-text">Nacos 配置管理最佳实践</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4%E7%AE%A1%E7%90%86"><span class="nav-text">Nacos 命名空间管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Namespace-%E9%9A%94%E7%A6%BB%E8%AE%BE%E8%AE%A1"><span class="nav-text">Namespace 隔离设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Nacos-%E5%88%9B%E5%BB%BA%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="nav-text">Nacos 创建命名空间</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E5%B8%B8%E8%A7%81%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E6%93%8D%E4%BD%9C"><span class="nav-text">Nacos 常见配置管理操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9B%86%E5%AF%BC%E5%87%BA"><span class="nav-text">配置集导出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9B%86%E5%AF%BC%E5%85%A5"><span class="nav-text">配置集导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9B%86%E5%85%8B%E9%9A%86"><span class="nav-text">配置集克隆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%86%E5%8F%B2%E7%89%88%E6%9C%AC"><span class="nav-text">历史版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%91%E5%90%AC%E6%9F%A5%E8%AF%A2"><span class="nav-text">监听查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E7%AE%A1%E7%90%86"><span class="nav-text">登录管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E7%99%BB%E5%BD%95%E5%8A%9F%E8%83%BD"><span class="nav-text">关闭登录功能</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">676</span> <span class="site-state-item-name">文章</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">53</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub → https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail → mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap → /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/ab6959cb.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay 的技术空间"><meta itemprop="description" content="专注于 Java 后端、分布式、微服务、云原生、数据库、系统架构、大数据、云计算、虚拟化、人工智能学习的技术博客。"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Nacos 入门教程 - 配置管理基础篇 | Clay 的技术空间"><meta itemprop="description" content="本文主要介绍如何使用Nacos作为配置中心，包括安装Nacos Server、Nacos配置入门、Nacos配置管理模型等。"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Nacos 入门教程 - 配置管理基础篇</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-12-01 21:12:19" itemprop="dateCreated datePublished" datetime="2020-12-01T21:12:19+08:00">2020-12-01</time></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">评论数：</span><a title="waline" href="/posts/ab6959cb.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/ab6959cb.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>4.8k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 ≈</span> <span>4 分钟</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h2><ul><li><a href="/posts/f9da4c12.html">Nacos 入门教程 - 服务发现基础篇</a></li><li><a href="/posts/ab6959cb.html">Nacos 入门教程 - 配置管理基础篇</a></li><li><a href="/posts/35766a62.html">Nacos 入门教程 - 配置管理中级篇</a></li><li><a href="/posts/cc563108.html">Nacos 入门教程 - 配置管理高级篇</a></li></ul><h2 id="技术资源"><a href="#技术资源" class="headerlink" title="技术资源"></a>技术资源</h2><ul><li><a target="_blank" rel="external nofollow" href="https://nacos.io/">Nacos 官方网站</a></li><li><a target="_blank" rel="external nofollow" href="https://github.com/alibaba/nacos">Nacos GitHub 项目</a></li><li><a target="_blank" rel="external nofollow" href="https://spring-cloud-alibaba-group.github.io/github-pages/2022/en-us/2022.0.0.0-RC2.html">Spring Cloud Alibaba 官方英文文档</a></li><li><a target="_blank" rel="external nofollow" href="https://spring-cloud-alibaba-group.github.io/github-pages/2022/zh-cn/2022.0.0.0-RC2.html">Spring Cloud Alibaba 官方中文文档</a></li></ul><span id="more"></span><h2 id="配置中心介绍"><a href="#配置中心介绍" class="headerlink" title="配置中心介绍"></a>配置中心介绍</h2><h3 id="什么是配置中心"><a href="#什么是配置中心" class="headerlink" title="什么是配置中心"></a>什么是配置中心</h3><p>在集中式开发时代，配置文件已经基本足够了，因为那时配置的管理通常不会成为一个很大的问题。但是在互联网时代，应用都是分布式系统，部署在 N 台服务器上，想要去线上一台台地重启机器肯定不靠谱，并且维护成本也很高，所以配置中心应运而生。配置中心被用作集中管理不同环境（Dev、Test、Stage、Prod）和不同集群配置，以及在修改配置后将实时动态推送到应用上进行刷新。配置中心应具备的功能如下：</p><ul><li>Open API</li><li> 业务无关性</li><li>高可用集群</li><li>配置生效监控</li><li>配合灰度与更新</li><li>一致性 K-V 存储</li><li>统一配置实时推送</li><li>配置全局恢复、备份与历史</li></ul><h3 id="主流配置中心对比"><a href="#主流配置中心对比" class="headerlink" title="主流配置中心对比"></a>主流配置中心对比</h3><ul><li>Spring Cloud Config、Netflix Archaius、Apollo、Disconf（已停止维护） <a href="../../../asset/2020/05/config-server-vs.png">对比图一</a></li><li> Spring Cloud Config、Netflix Archaius、Apollo、Disconf（已停止维护） <a href="../../../asset/2020/05/config-server-vs-2.png">对比图二</a></li></ul><p><img data-src="../../../asset/2020/12/config-server-vs-4.png" alt="config-server-vs-4"></p><h2 id="Nacos-简介"><a href="#Nacos-简介" class="headerlink" title="Nacos 简介"></a>Nacos 简介</h2><h3 id="Nacos-概述"><a href="#Nacos-概述" class="headerlink" title="Nacos 概述"></a>Nacos 概述</h3><p>Nacos 是构建以 “服务” 为中心的现代应用架构 (例如微服务范式、云原生范式) 的服务基础设施，可以更敏捷和容易地构建、交付和管理微服务平台。Nacos 提供了一组简单易用的特性集，致力于快速实现动态服务发现、服务配置、服务元数据及流量管理。更多资料可参考：<a target="_blank" rel="external nofollow" href="https://github.com/alibaba/nacos">Nacos 项目</a>、<a target="_blank" rel="external nofollow" href="https://nacos.io/zh-cn/">Nacos 官网</a>、<a target="_blank" rel="external nofollow" href="https://nacos.io/zh-cn/docs/what-is-nacos.html">Nacos 官方中文文档</a>、<a target="_blank" rel="external nofollow" href="https://github.com/nacos-group/nacos-examples">Nacos 官方示例代码</a>、<a target="_blank" rel="external nofollow" href="https://nacos.io/zh-cn/blog/index.html">Nacos 官方博客</a></p><h3 id="Nacos-功能"><a href="#Nacos-功能" class="headerlink" title="Nacos 功能"></a>Nacos 功能</h3><p><strong>动态配置服务</strong></p><p>动态配置服务能够以中心化、外部化和动态化的方式管理所有环境的配置。动态配置消除了配置变更时重新部署应用和服务的需要。配置中心化管理让实现无状态服务更简单，也让按需弹性扩展服务更容易。</p><p><strong>服务发现与服务健康监测</strong></p><p>动态服务发现对以服务为中心的（例如微服务和云原生）应用架构方式非常关键。Nacos 支持 DNS-Based 和 RPC-Based（Dubbo、gRPC） 模式的服务发现。Nacos 也提供实时健康检查，以防止将请求发往不健康的主机或服务实例。借助 Nacos，可以更容易地为服务实现断路器。</p><p><strong>动态 DNS 服务</strong></p><p>通过支持权重路由，动态 DNS 服务能够轻松实现中间层负载均衡、更灵活的路由策略、流量控制以及简单数据中心内网的简单 DNS 解析服务。动态 DNS 服务还能更容易地实现以 DNS 协议为基础的服务发现，以消除耦合到厂商私有服务发现 API 上的风险。</p><p><strong>服务及其元数据管理</strong></p><p>Nacos 能从微服务平台建设的视角管理数据中心的所有服务及元数据，包括管理服务的描述、生命周期、服务的静态依赖分析、服务的健康状态、服务的流量管理、路由及安全策略、服务的 SLA 以及最首要的 metrics 统计数据。</p><h3 id="Nacos-特性"><a href="#Nacos-特性" class="headerlink" title="Nacos 特性"></a>Nacos 特性</h3><p><strong>易于使用</strong></p><ul><li>动态配置管理、服务发现和动态的一站式解决方案</li><li> 20 多种开箱即用的以服务为中心的架构特性</li><li>基本符合生产要求的轻量级易用控制台</li></ul><p><strong>生产等级</strong></p><ul><li>脱胎于历经阿里巴巴 10 年生产验证的内部产品</li><li>支持具有数百万服务的大规模场景</li><li>具备企业级 SLA 的开源产品</li></ul><p><strong>更适应云架构</strong></p><ul><li>无缝支持 Kubernetes 和 Spring Cloud</li><li> 在主流公共云上更容易部署和运行（例如阿里云和 AWS）</li><li>多租户和多环境支持</li></ul><p><strong>丰富的应用场景</strong></p><ul><li>支持限流、大促销预案和异地多活</li><li>直接支持或稍作扩展即可支持大量有用的互联网应用场景</li><li>流量调度和服务治理</li></ul><h3 id="Nacos-生态图"><a href="#Nacos-生态图" class="headerlink" title="Nacos 生态图"></a>Nacos 生态图</h3><p>如 Nacos 生态图所示，Nacos 无缝支持一些主流的开源生态，包括 Spring Cloud、Apache Dubbo、Dubbo Mesh、gRPC、Kubernetes 、CNCF 等。</p><p><img data-src="../../../asset/2020/12/spring-cloud-alibaba-ecology.png" alt="spring-cloud-alibaba-ecology"></p><h2 id="Nacos-安装"><a href="#Nacos-安装" class="headerlink" title="Nacos 安装"></a>Nacos 安装</h2><h3 id="安装-Nacos"><a href="#安装-Nacos" class="headerlink" title="安装 Nacos"></a>安装 Nacos</h3><h4 id="安装环境准备"><a href="#安装环境准备" class="headerlink" title="安装环境准备"></a>安装环境准备</h4><p>Nacos 依赖 Java 环境运行，因此需要提前安装并配置 JDK，如果是从源码开始构建并运行 Nacos，还需要为此配置 Maven 环境，Nacos 依赖的软件环境如下：</p><ul><li>64 Bit OS，支持 Unix/Linux/Mac/Windows</li><li>64 Bit JDK 1.8+</li><li>Maven 3.2.x+</li><li>Nacos 1.4.0</li></ul><h4 id="通过源码编译安装"><a href="#通过源码编译安装" class="headerlink" title="通过源码编译安装"></a>通过源码编译安装</h4><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取源码</span></span><br><span class="line"><span class="keyword">$ git</span> <span class="built_in">clone</span> git@github.com:alibaba/nacos.git</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入源码目录</span></span><br><span class="line"><span class="keyword">$ cd</span> nacos</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译打包</span></span><br><span class="line"><span class="keyword">$ mvn</span><span class="params"> -Prelease</span>-nacos clean install<span class="params"> -U</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者指定编译时跳过测试</span></span><br><span class="line"><span class="keyword">$ mvn</span><span class="params"> -Prelease</span>-nacos clean install<span class="params"> -U</span><span class="params"> -f</span> pom.xml<span class="params"> -Dmaven</span>.<span class="built_in">test</span>.skip=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入编译后的bin目录</span></span><br><span class="line"><span class="keyword">$ cd</span> distribution/target/nacos-server-1.4.0/nacos/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单机模式下启动Nacos服务，默认端口为8848，默认使用内置数据源</span></span><br><span class="line"><span class="keyword">$ sh</span> startup.sh<span class="params"> -m</span> standalone</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看Nacos的进程状态</span></span><br><span class="line"><span class="keyword">$ ps</span><span class="params"> -aux</span>|grep nacos</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看Nacos的端口状态</span></span><br><span class="line"><span class="keyword">$ netstat</span><span class="params"> -anp</span>|grep 8848</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭Nacos服务</span></span><br><span class="line"><span class="keyword">$ sh</span> shutdown.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提示： Nacos启动的日志文件路径为： nacos/distribution/target/nacos-server-1.4.0/nacos/logs/start.out</span></span><br></pre></td></tr></tbody></table></figure><h4 id="通过下载二进制包安装"><a href="#通过下载二进制包安装" class="headerlink" title="通过下载二进制包安装"></a>通过下载二进制包安装</h4><p>Nacos 下载地址点<a target="_blank" rel="external nofollow" href="https://github.com/alibaba/nacos/releases">这里</a>，下载后解压即可运行。</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压</span></span><br><span class="line"><span class="keyword">$ tar</span><span class="params"> -xvf</span> nacos-server-1.4.0.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入bin目录</span></span><br><span class="line"><span class="keyword">$ cd</span> nacos/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单机模式下启动Nacos服务，默认端口为8848，默认使用内置数据源</span></span><br><span class="line"><span class="keyword">$ sh</span> startup.sh<span class="params"> -m</span> standalone</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看Nacos的进程状态</span></span><br><span class="line"><span class="keyword">$ ps</span><span class="params"> -aux</span>|grep nacos</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看Nacos的端口状态</span></span><br><span class="line"><span class="keyword">$ netstat</span><span class="params"> -anp</span>|grep 8848</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭Nacos服务</span></span><br><span class="line"><span class="keyword">$ sh</span> shutdown.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提示： Nacos启动的日志文件路径为： nacos/logs/start.out</span></span><br></pre></td></tr></tbody></table></figure><h4 id="通过-Docker-镜像快速安装"><a href="#通过-Docker-镜像快速安装" class="headerlink" title="通过 Docker 镜像快速安装"></a>通过 Docker 镜像快速安装</h4><ul><li><a href="/posts/1326ecd9.html">Docker 安装单机版的 Nacos 与 MySQL 8</a></li></ul><h3 id="访问-Nacos-的-Web-控制台"><a href="#访问-Nacos-的-Web-控制台" class="headerlink" title="访问 Nacos 的 Web 控制台"></a>访问 Nacos 的 Web 控制台</h3><p>浏览器访问 <code>http://127.0.0.1:8848/nacos</code>，默认登录的用户名和密码为 <code>nacos/nacos</code>。</p><p><img data-src="../../../asset/2020/12/nacos-server-web-ui.png" alt="nacos-server-web-ui"></p><h3 id="Open-API-配置管理测试"><a href="#Open-API-配置管理测试" class="headerlink" title="Open API 配置管理测试"></a>Open API 配置管理测试</h3><p>Nacos 启动成功后，可通过 Nacos 提供的 HTTP API 验证 Nacos 服务运行是否正常。</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 新增配置信息到Nacos</span></span><br><span class="line"><span class="keyword">$ curl</span><span class="params"> -X</span> POST <span class="string">"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=HelloWorld"</span></span><br><span class="line"><span class="literal">true</span></span><br></pre></td></tr></tbody></table></figure><p>刷新 Nacos 的 Web 控制台，可以看到刚新增的配置信息如下：</p><p><img data-src="../../../asset/2020/12/nacos-add-config.png" alt="nacos-add-config"></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从Nacos获取配置信息</span></span><br><span class="line"><span class="keyword">$ curl</span><span class="params"> -X</span> GET <span class="string">"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test"</span></span><br><span class="line">HelloWorld</span><br></pre></td></tr></tbody></table></figure><h3 id="外部-MySQL-数据库支持（持久化配置）"><a href="#外部-MySQL-数据库支持（持久化配置）" class="headerlink" title="外部 MySQL 数据库支持（持久化配置）"></a>外部 MySQL 数据库支持（持久化配置）</h3><p>单机模式下 Nacos 默认使用嵌入式数据库 <code>derby</code> 来存储数据，若想使用外部 MySQL 数据库存储 Nacos 的数据，需要进行以下操作：</p><ul><li>安装 MySQL 5.6.5+</li><li> 下载 Nacos Server 的二进制安装包并解压</li><li>创建数据库 <code>nacos_config</code>，执行 SQL 初始化脚本，数据库初始化脚本的路径为：<code>${nacos-home}/conf/nacos-mysql.sql</code></li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 创建数据库</span><br><span class="line">mysql&gt; create database nacos_config default character set utf8;</span><br><span class="line"></span><br><span class="line"># 切换数据库</span><br><span class="line">mysql&gt; use nacos_config;</span><br><span class="line"></span><br><span class="line"># 执行SQL初始化脚本</span><br><span class="line">mysql&gt; source ${nacos-home}/conf/nacos-mysql.sql;</span><br><span class="line"></span><br><span class="line"># 查看数据库表</span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+------------------------+</span><br><span class="line">| Tables_in_nacos_config |</span><br><span class="line">+------------------------+</span><br><span class="line">| config_info            |</span><br><span class="line">| config_info_aggr       |</span><br><span class="line">| config_info_beta       |</span><br><span class="line">| config_info_tag        |</span><br><span class="line">| config_tags_relation   |</span><br><span class="line">| group_capacity         |</span><br><span class="line">| his_config_info        |</span><br><span class="line">| permissions            |</span><br><span class="line">| roles                  |</span><br><span class="line">| tenant_capacity        |</span><br><span class="line">| tenant_info            |</span><br><span class="line">| users                  |</span><br><span class="line">+------------------------+</span><br><span class="line">12 rows in set (0.00 sec)</span><br></pre></td></tr></tbody></table></figure><ul><li>修改 <code>${nacos-home}/conf/application.properties</code> 配置文件，增加支持 MySQL 数据源的配置信息（目前只支持 MySQL），并添加 MySQL 数据库的 URL、用户名、密码，最后重新启动 Nacos 服务即可，配置示例如下：</li></ul><figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.datasource.platform</span>=<span class="string">mysql</span></span><br><span class="line"></span><br><span class="line"><span class="meta">db.num</span>=<span class="string">1</span></span><br><span class="line"><span class="meta">db.url.0</span>=<span class="string">jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true&amp;useUnicode=true&amp;useSSL=false&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="meta">db.user</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">db.password</span>=<span class="string">123456</span></span><br></pre></td></tr></tbody></table></figure><ul><li>若希望使用 Nacos Server 内置的数据源（嵌入式数据库），可以使用 <code>-p embedded</code> 参数来启动 Nacos Server</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sh startup.sh<span class="params"> -p</span> embedded</span><br></pre></td></tr></tbody></table></figure><h2 id="Nacos-配置入门案例"><a href="#Nacos-配置入门案例" class="headerlink" title="Nacos 配置入门案例"></a>Nacos 配置入门案例</h2><h3 id="第一步：点击新增配置按钮"><a href="#第一步：点击新增配置按钮" class="headerlink" title="第一步：点击新增配置按钮"></a>第一步：点击新增配置按钮</h3><p>浏览器访问 <code>http://127.0.0.1:8848/nacos</code>，打开 Nacos 的 Web 控制台，并找到菜单 <code>配置管理</code> &gt; <code>配置列表</code>，然后点击 <code>新增</code> 按钮：</p><p><img data-src="../../../asset/2020/12/nas-web-click-add-button.png" alt="![nas-web-click-add-button](../../../asset/2020/12/nas-web-click-add-button.png)"></p><h3 id="第二步：新增配置信息"><a href="#第二步：新增配置信息" class="headerlink" title="第二步：新增配置信息"></a>第二步：新增配置信息</h3><p>在新增配置信息的表单里，填写如下的内容，然后点击 <code>发布</code> 按钮即可。特别注意的是，DataId 默认是以 <code>properties</code> 作为默认的文件扩展名。</p><p><img data-src="../../../asset/2020/12/nacos-web-add-config.png" alt="nacos-web-add-config"></p><h3 id="第三步：查询配置信息"><a href="#第三步：查询配置信息" class="headerlink" title="第三步：查询配置信息"></a>第三步：查询配置信息</h3><p><img data-src="../../../asset/2020/12/nacos-web-select-config.png" alt="nacos-web-select-config"></p><h3 id="第四步：调用-Java-API-获取-Nacos-的配置信息"><a href="#第四步：调用-Java-API-获取-Nacos-的配置信息" class="headerlink" title="第四步：调用 Java API 获取 Nacos 的配置信息"></a>第四步：调用 Java API 获取 Nacos 的配置信息</h3><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.nacos<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nacos-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.NacosFactory;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.config.ConfigService;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.exception.NacosException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 从Nacos读取配置信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> clay</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NacosDemoApplicaton</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NacosException </span>{</span><br><span class="line">        String serverAddr = <span class="string">"127.0.0.1:8848"</span>;</span><br><span class="line">        String dataId = <span class="string">"nacos_simple_demo.yaml"</span>;</span><br><span class="line">        String group = <span class="string">"DEFAULT_GROUP"</span>;</span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.put(<span class="string">"serverAddr"</span>, serverAddr);</span><br><span class="line">        ConfigService configService = NacosFactory.createConfigService(properties);</span><br><span class="line">        String content = configService.getConfig(dataId, group, <span class="number">1000</span>);</span><br><span class="line">        System.out.println(content);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>程序运行输出结果如下：</p><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">common:</span><br><span class="line">    config: something</span><br></pre></td></tr></tbody></table></figure><h2 id="Nacos-配置管理基础"><a href="#Nacos-配置管理基础" class="headerlink" title="Nacos 配置管理基础"></a>Nacos 配置管理基础</h2><h3 id="Nacos-配置管理模型"><a href="#Nacos-配置管理模型" class="headerlink" title="Nacos 配置管理模型"></a>Nacos 配置管理模型</h3><h4 id="Nacos-配置管理概念"><a href="#Nacos-配置管理概念" class="headerlink" title="Nacos 配置管理概念"></a>Nacos 配置管理概念</h4><p>对于 Nacos 的配置管理，是通过 Namespace、Group、Data ID 来定位到一个配置集。</p><p><img data-src="../../../asset/2020/12/nacos-data-model.png" alt="nacos-data-model"></p><p><strong>配置项</strong></p><p>配置集中包含的一个个配置内容就是配置项。它代表一个具体的可配置的参数与其值域，通常以 <code>key=value</code> 的形式存在。例如经常配置系统的日志输出级别（logLevel=INFO|WARN|ERROR） 就是一个配置项。</p><p><strong>配置集（Data ID）</strong></p><p>在系统中，一个配置文件通常就是一个配置集，一个配置集可以包含了系统的各种配置信息，例如一个配置集可能包含了数据源、线程池、日志级别等配置项。每个配置集都可以定义一个有意义的名称，就是配置集的 ID，即 Data ID。</p><p><strong>配置分组（Group）</strong></p><p>配置分组是对配置集进行分组，通过一个有意义的字符串（如 Buy 或 Trade ）来表示，不同的配置分组下可以有相同的配置集（Data ID）。当在 Nacos 上创建一个配置时，如果未填写配置分组的名称，则配置分组的名称默认采用 <code>DEFAULT_GROUP</code>。配置分组的常见场景：可用于区分不同的项目或应用，例如：学生管理系统的配置集可以定义一个 Group 为：STUDENT_GROUP。</p><p><strong>命名空间（Namespace）</strong></p><p>命名空间可用于进行不同环境的配置隔离。例如可以隔离开发环境、测试环境和生产环境，因为它们的配置可能各不相同，或者是隔离不同的用户，不同的开发人员使用同一个 Nacos 管理各自的配置，可通过 Namespace 隔离。当在 Nacos 上创建一个配置时，如果未填写命名空间的名称，则命名空间的名称默认为 <code>public</code>。不同的命名空间下，可以存在相同名称的配置分组（Group） 或 配置集。</p><h4 id="Nacos-配置管理最佳实践"><a href="#Nacos-配置管理最佳实践" class="headerlink" title="Nacos 配置管理最佳实践"></a>Nacos 配置管理最佳实践</h4><p>Nacos 抽象定义了 Namespace、Group、Data ID 的概念，具体这几个概念代表什么，取决于把它们看成什么，这里推荐一种用法，如下图：</p><ul><li>Namespace ：代表不同环境，如开发、测试、生产环境</li><li> Group：代表某项目，如 XX 医疗项目、XX 电商项目、XX 校园项目</li><li> DataId：每个项目下往往有若干个工程，每个配置集（DataId）是一个工程的主配置文件</li></ul><p><img data-src="../../../asset/2020/12/nacos-data-model-2.png" alt="nacos-data-model-2"></p><div class="admonition note"><p class="admonition-title">Namespace 与 Group 的其他最佳实践</p><p>除了上面介绍的一种最佳实践方法外，还可以为每个微服务创建自己的 <code>namespace</code> 进行隔离，然后利用 <code>group</code> 来区分 Dev、Beta、Prod 等环境。</p></div><h3 id="Nacos-命名空间管理"><a href="#Nacos-命名空间管理" class="headerlink" title="Nacos 命名空间管理"></a>Nacos 命名空间管理</h3><h4 id="Namespace-隔离设计"><a href="#Namespace-隔离设计" class="headerlink" title="Namespace 隔离设计"></a>Namespace 隔离设计</h4><p>Namespace 的设计是 Nacos 基于此做多环境以及多租户（多个用户共同使用 Nacos）数据（配置和服务）隔离的。从一个租户 (用户）的角度来看，如果有多套不同的环境，那么这个时候可以根据指定的环境来创建不同的 Namespace，以此来实现多环境的隔离。例如可能有开发、测试和生产三个不同的环境，那么使用一套 Nacos 集群可以分别建以下三个不同的 Namespace，如下图所示：</p><p><img data-src="../../../asset/2020/12/nacos-namespace.png" alt="nacos-namespace"></p><p>从多个租户（用户）的角度来看，每个租户（用户）可能会有自己的 Namespace，每个租户（用户）的配置数据以及注册的服务数据都会归属到自己的 Namespace 下，以此来实现多租户间的数据隔离。例如超级管理员分配了三个租户（用户），分别为张三、李四和王五。分配好了之后，各租户用自己的账户名和密码登录后，创建自己的命名空间。如下图所示：</p><p><img data-src="../../../asset/2020/12/nacos-namespace-2.png" alt="nacos-namespace-2"></p><h4 id="Nacos-创建命名空间"><a href="#Nacos-创建命名空间" class="headerlink" title="Nacos 创建命名空间"></a>Nacos 创建命名空间</h4><p>第一步：菜单栏选中<code>命名空间</code>，然后点击页面上的<code>新建命名空间</code>按钮</p><p><img data-src="../../../asset/2020/12/nacos-create-namespace.png" alt="nacos-create-namespace"></p><p>第二步：在表单内填写必要的命名空间信息，然后点击<code>确定</code>按钮提交</p><p><img data-src="../../../asset/2020/12/nacos-create-namespace-2.png" alt="nacos-create-namespace-2"></p><p>第三步：菜单栏选中<code>配置管理</code> &gt; <code>配置列表</code>，可以通过 Tab 按钮切换到不同的命名空间，接着就可以在对应的命名空间下新增配置信息</p><p><img data-src="../../../asset/2020/12/nacos-create-namespace-3.png" alt="nacos-create-namespace-3"></p><p><strong>代码示例</strong></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.nacos<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>nacos-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.NacosFactory;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.config.ConfigService;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.exception.NacosException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 从Nacos读取特定命名空间下的配置信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> clay</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NacosDemoApplicaton</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NacosException </span>{</span><br><span class="line">        String serverAddr = <span class="string">"127.0.0.1:8848"</span>;</span><br><span class="line">        String namespace = <span class="string">"7ec71a71-6ee5-4f87-a387-0d29d9e8fe51"</span>;</span><br><span class="line">        String group = <span class="string">"DEFAULT_GROUP"</span>;</span><br><span class="line">        String dataId = <span class="string">"nacos_simple_demo.yaml"</span>;</span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.put(<span class="string">"serverAddr"</span>, serverAddr);</span><br><span class="line">        properties.put(<span class="string">"namespace"</span>, namespace);</span><br><span class="line">        ConfigService configService = NacosFactory.createConfigService(properties);</span><br><span class="line">        String content = configService.getConfig(dataId, group, <span class="number">1000</span>);</span><br><span class="line">        System.out.println(content);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="Nacos-常见配置管理操作"><a href="#Nacos-常见配置管理操作" class="headerlink" title="Nacos 常见配置管理操作"></a>Nacos 常见配置管理操作</h2><h3 id="配置集导出"><a href="#配置集导出" class="headerlink" title="配置集导出"></a>配置集导出</h3><p>勾选若干配置集，点击<code>导出选中的配置</code>按钮，即可自动下载一个压缩包，压缩包内包含了选中配置集所转换的配置文件。</p><p><img data-src="../../../asset/2020/12/nacos-export-configs.png" alt="nacos-export-configs"></p><h3 id="配置集导入"><a href="#配置集导入" class="headerlink" title="配置集导入"></a>配置集导入</h3><p>点击右上角的<code>导入配置</code>按钮，选择之前导出的配置文件压缩包，可以将压缩包内的文件恢复为 Nacos 配置集。</p><p><img data-src="../../../asset/2020/12/nacos-inport-configs.png" alt="nacos-inport-configs"></p><h3 id="配置集克隆"><a href="#配置集克隆" class="headerlink" title="配置集克隆"></a>配置集克隆</h3><p>勾选若干配置集，点击<code>克隆</code>按钮，可以将选中的配置集批量复制到指定的命名空间内。</p><p><img data-src="../../../asset/2020/12/nacos-clone-configs.png" alt="nacos-clone-configs"></p><p><img data-src="../../../asset/2020/12/nacos-clone-configs-2.png" alt="nacos-clone-configs-2"></p><h3 id="历史版本"><a href="#历史版本" class="headerlink" title="历史版本"></a>历史版本</h3><p>Nacos 通过提供配置版本管理及其一键回滚能力，帮助用户改错配置的时候能够快速回滚，降低微服务系统在配置管理上的可用性风险。</p><p><img data-src="../../../asset/2020/12/nacos-config-history.png" alt="nacos-config-history"></p><p><img data-src="../../../asset/2020/12/nacos-config-rollback.png" alt="nacos-config-rollback"></p><h3 id="监听查询"><a href="#监听查询" class="headerlink" title="监听查询"></a>监听查询</h3><p>Nacos 提供配置订阅者（即监听者）查询能力，同时提供客户端当前配置的 MD5 校验值，以便帮助用户更好的检查服务器的配置变更是否推送到 Nacos 客户端，其中 Nacos 客户端监听的示例代码如下：</p><p><img data-src="../../../asset/2020/12/nacos-listener.png" alt="nacos-listener"></p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.NacosFactory;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.config.ConfigService;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.config.listener.Listener;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.nacos.api.exception.NacosException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.Executor;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Nacos客户端监听服务器的配置信息是否变更</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> clay</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NacosDemoApplicaton</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NacosException, IOException </span>{</span><br><span class="line">        String serverAddr = <span class="string">"127.0.0.1:8848"</span>;</span><br><span class="line">        String group = <span class="string">"DEFAULT_GROUP"</span>;</span><br><span class="line">        String dataId = <span class="string">"nacos_simple_demo.yaml"</span>;</span><br><span class="line">        Properties properties = <span class="keyword">new</span> Properties();</span><br><span class="line">        properties.put(<span class="string">"serverAddr"</span>, serverAddr);</span><br><span class="line">        ConfigService configService = NacosFactory.createConfigService(properties);</span><br><span class="line">        String content = configService.getConfig(dataId, group, <span class="number">1000</span>);</span><br><span class="line">        System.out.println(content);</span><br><span class="line"></span><br><span class="line">        configService.addListener(dataId, group, <span class="keyword">new</span> Listener() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> Executor <span class="title">getExecutor</span><span class="params">()</span> </span>{</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">receiveConfigInfo</span><span class="params">(String configInfo)</span> </span>{</span><br><span class="line">                System.out.println(configInfo);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">        System.in.read();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="登录管理"><a href="#登录管理" class="headerlink" title="登录管理"></a>登录管理</h3><p>Nacos 支持简单的登录功能，默认用户名 / 密码为： <code>nacos/nacos</code>，</p><p><strong>生成密码</strong></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.security<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-security-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 由于采用BCrypt加密方法在每次生成密码时会加随机盐，因此生成的密码每次都可能不一样</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> clay</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PasswordEncoderUtil</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>{</span><br><span class="line">        String password = <span class="keyword">new</span> BCryptPasswordEncoder().encode(<span class="string">"123456"</span>);</span><br><span class="line">        System.out.println(password);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><strong>创建登录用户</strong></p><p>当 Nacos 使用 MySQL 数据库存储数据时，可以使用以下 SQL 来创建新用户，其中密码就是上面通过 Java 代码生成的字符串。同理，若需要更改旧用户的登录密码，只需要通过 SQL 更新对应的数据库表数据即可，这里不再累述。</p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (username, password, enabled) <span class="keyword">VALUES</span> (<span class="string">'admin'</span>,<span class="string">'$2a$10$kCRcD31fYzYUhfvCSUqQ9u/IAKbq4yTWi1z3l6kTrKL5exGSNbSUK'</span>, <span class="literal">TRUE</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> roles (username, role) <span class="keyword">VALUES</span> (<span class="string">'admin'</span>, <span class="string">'ROLE_ADMIN'</span>);</span><br></pre></td></tr></tbody></table></figure><h3 id="关闭登录功能"><a href="#关闭登录功能" class="headerlink" title="关闭登录功能"></a>关闭登录功能</h3><p>由于部分公司自己开发控制台，不希望被 Nacos 的安全 Filter 拦截。因此 Nacos 支持定制关闭登录功能，只需要找到配置文件 <code>${nacos-home}/conf/application.properties</code>，替换以下内容即可，最后重启 Nacos 服务使更改生效。<strong>特别注意，以下更改只适合 Nacos 1.2.0 以下的版本。</strong></p><figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">spring.security.enabled</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">management.security</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">security.basic.enabled</span>=<span class="string">false</span></span><br><span class="line"><span class="meta">nacos.security.ignore.urls</span>=<span class="string">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># nacos.security.ignore.urls=/,/error,/**/*.css,/**/*.js,/**/*.html,/**/*.map,/**/*.svg,/**/*.png,/**/*.ico,/console-fe/public/**,/v1/auth/**,/v1/console/health/**,/actuator/**,/v1/console/server/**</span></span><br></pre></td></tr></tbody></table></figure><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"全栈技术驿站",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>支持一根棒棒糖！</div> <button> 赞赏</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay 微信"> <span>微信</span></div><div> <img src="/img/pay_zfb.png" alt="Clay 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Clay</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.techgrow.cn/posts/ab6959cb.html" title="Nacos 入门教程 - 配置管理基础篇">https://www.techgrow.cn/posts/ab6959cb.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">欢迎添加博主微信，请备注 "博客"，届时会邀请您加入百人微信群</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag"><i class="fa fa-tag"></i> 微服务</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/97d0a561.html" rel="prev" title="Spring Cloud Alibaba 新一代微服务解决方案"><i class="fa fa-angle-left"></i> Spring Cloud Alibaba 新一代微服务解决方案</a></div><div class="post-nav-item"> <a href="/posts/e173757f.html" rel="next" title="Linux 安装 RTL8812AU 无线 USB 网卡驱动">Linux 安装 RTL8812AU 无线 USB 网卡驱动<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright © 2018 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title="站点总字数">1.7m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>站点阅读时长 ≈</span> <span title="站点阅读时长">25:38</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" 年 "+s+" 日 "+d+" 小时 "+l+" 分钟 "+u+" 秒 "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">粤ICP备 19024664号-1</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">粤公网安备 44011302004035号</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"/lib/mermaid/dist/mermaid.min.js","integrity":"sha256-stuqcu2FrjYCXDOytWFA5SoUE/r3nkp6gTglzNSlavU="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/api/oss/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，非法请求来源！");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，上传过于频繁！");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，系统内部出错！");
        } else {
          alert("图片上传失败，无法获取UploadToken，未知Http响应状态码！");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("图片上传失败，无法获取UploadToken，未知错误！");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"支持匿名评论啦，若希望及时收到博主的反馈，建议登录评论或者在上方的邮箱输入框留下邮箱地址哦 (๑•̀ㅂ•́)و✧"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/api/oss/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/ab6959cb.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>