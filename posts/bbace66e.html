<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><meta name="description" content="本文主要介绍 Dubbo 的入门教程。"><meta property="og:type" content="article"><meta property="og:title" content="Dubbo2 巩固教程之五"><meta property="og:url" content="https://www.techgrow.cn/posts/bbace66e.html"><meta property="og:site_name" content="Clay 的技术空间"><meta property="og:description" content="本文主要介绍 Dubbo 的入门教程。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/11/dubbo-principle-1.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/11/dubbo-principle-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/11/dubbo-principle-3.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/11/dubbo-principle-4.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/11/dubbo-principle-5.png"><meta property="article:published_time" content="2019-09-25T15:42:35.000Z"><meta property="article:modified_time" content="2025-09-25T15:42:35.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="微服务"><meta property="article:tag" content="分布式"><meta property="article:tag" content="RPC"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2025/11/dubbo-principle-1.png"><link rel="canonical" href="https://www.techgrow.cn/posts/bbace66e.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/bbace66e.html","path":"posts/bbace66e.html","title":"Dubbo2 巩固教程之五"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Dubbo2 巩固教程之五 | Clay 的技术空间</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay 的技术空间" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script>
  (function () {

  // 防止 Pjax 重复绑定事件
  if (window.__moonMenuCodeExpandBound) {
    return;
  }
  window.__moonMenuCodeExpandBound = true;

  const STORAGE_KEY = 'moon_menu_code_fold';

  /* ===============================
   * 1. 设置 moon-menu 按钮的 title
   * =============================== */
  (function bindMoonMenuTitles() {
    const items = [
      { selector: '#moon-menu-item-code',        title: '展开 / 折叠代码块' },
      { selector: '#moon-menu-item-back2top',    title: '回到页面顶部' },
      { selector: '#moon-menu-item-back2bottom', title: '回到页面底部' }
    ];

    let allReady = true;

    items.forEach(item => {
      const el = document.querySelector(item.selector);
      if (!el) {
        allReady = false;
        return;
      }
      el.setAttribute('title', item.title);
    });

    if (!allReady) {
      setTimeout(bindMoonMenuTitles, 100);
    }
  })();

  /* =================================
   * 2. 页面首次加载：代码块恢复展开或折叠状态
   * ================================= */
  function applyStoredCodeState() {
    const containers = document.querySelectorAll('.code-container');
    if (!containers.length) {
      return;
    }

    const state = localStorage.getItem(STORAGE_KEY);
    if (!state) {
      return;
    }

    containers.forEach(container => {
      if (state === 'expanded') {
        // 展开代码块
        container.classList.remove('highlight-fold');
      } else if (state === 'folded') {
        // 折叠代码块
        container.classList.add('highlight-fold');
      }
    });
  }

  // 等代码块出现后，再恢复展开或折叠状态
  function waitAndApplyState() {
    const containers = document.querySelectorAll('.code-container');

    if (!containers.length) {
      setTimeout(waitAndApplyState, 100);
      return;
    }

    applyStoredCodeState();
  }

  // 页面首次加载时恢复状态
  waitAndApplyState();
  
  // Pjax 切换页面后，必须重新恢复状态
  document.addEventListener('pjax:complete', function () {
    waitAndApplyState();
  });

  /* ===============================
   * 3. 点击按钮：切换状态并保存
   * =============================== */
  document.addEventListener('click', function (e) {
    const codeMenu = e.target.closest('#moon-menu-item-code');
    if (!codeMenu) {
      return;
    }

    toggleAllCodeBlocks();
  });

  // 展开或折叠代码块
  function toggleAllCodeBlocks() {
    const containers = document.querySelectorAll('.code-container');
    if (!containers.length) {
      return;
    }

    // 只要存在折叠的代码块，就认为当前是折叠状态
    const hasFolded = Array.from(containers).some(c => {
      return c.classList.contains('highlight-fold');
    });

    containers.forEach(container => {
      if (hasFolded) {
        // 展开代码块
        container.classList.remove('highlight-fold');
      } else {
        // 折叠代码块
        container.classList.add('highlight-fold');
      }
    });

    // 记录展开或折叠状态
    localStorage.setItem(
      STORAGE_KEY,
      hasFolded ? 'expanded' : 'folded'
    );
  }

})();
</script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay 的技术空间</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">用进废退 | 艺不压身</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>搜索</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>读书笔记</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>评论管理</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%BA%B2"><span class="nav-text">大纲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90"><span class="nav-text">学习资源</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3"><span class="nav-text">Dubbo 深入理解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Dubbo-%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99"><span class="nav-text">Dubbo 设计原则</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E6%95%B4%E4%BD%93%E6%9E%B6%E6%9E%84"><span class="nav-text">Dubbo 的整体架构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E5%8A%9F%E8%83%BD%E6%80%A7%E9%9C%80%E6%B1%82"><span class="nav-text">Dubbo 的功能性需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E9%9D%9E%E5%8A%9F%E8%83%BD%E6%80%A7%E9%9C%80%E6%B1%82"><span class="nav-text">Dubbo 的非功能性需求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E5%BE%AE%E6%A0%B8%E5%BF%83%E6%8F%92%E4%BB%B6%E5%BC%8F%E8%AE%BE%E8%AE%A1"><span class="nav-text">Dubbo 的微核心插件式设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E7%BB%84%E5%90%88%E5%BC%8F%E6%89%A9%E5%B1%95%E8%AE%BE%E8%AE%A1"><span class="nav-text">Dubbo 的组合式扩展设计</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%A9%E5%85%85%E5%BC%8F%E6%89%A9%E5%B1%95%E4%B8%8E%E5%A2%9E%E9%87%8F%E5%BC%8F%E6%89%A9%E5%B1%95"><span class="nav-text">扩充式扩展与增量式扩展</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%9B%E5%8C%96%E5%BC%8F%E6%89%A9%E5%B1%95%E4%B8%8E%E7%BB%84%E5%90%88%E5%BC%8F%E6%89%A9%E5%B1%95"><span class="nav-text">泛化式扩展与组合式扩展</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E6%9C%80%E5%A4%A7%E5%8C%96%E5%A4%8D%E7%94%A8%E8%AE%BE%E8%AE%A1"><span class="nav-text">Dubbo 的最大化复用设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E5%85%A8%E7%AE%A1%E9%81%93%E5%BC%8F%E8%AE%BE%E8%AE%A1"><span class="nav-text">Dubbo 的全管道式设计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E5%A4%96%E9%83%A8%E6%9C%80%E5%B0%91%E6%A6%82%E5%BF%B5"><span class="nav-text">Dubbo 的外部最少概念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dubbo-%E7%9A%84%E5%8D%81%E5%B1%82%E6%95%B4%E4%BD%93%E8%AE%BE%E8%AE%A1"><span class="nav-text">Dubbo 的十层整体设计</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">797</span> <span class="site-state-item-name">文章</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">56</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub → https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail → mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap → /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/bbace66e.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay 的技术空间"><meta itemprop="description" content="专注于 Java 后端、分布式、微服务、云原生、数据库、系统架构、大数据、云计算、虚拟化、人工智能学习的技术博客。"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Dubbo2 巩固教程之五 | Clay 的技术空间"><meta itemprop="description" content="本文主要介绍 Dubbo 的入门教程。"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Dubbo2 巩固教程之五</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-09-25 23:42:35" itemprop="dateCreated datePublished" datetime="2019-09-25T23:42:35+08:00">2019-09-25</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2025-09-25 23:42:35" itemprop="dateModified" datetime="2025-09-25T23:42:35+08:00">2025-09-25</time></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">评论数：</span><a title="waline" href="/posts/bbace66e.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/bbace66e.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>5.9k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 ≈</span> <span>5 分钟</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h2><ul><li><a href="/posts/ef04d10a.html">Dubbo 2 巩固教程之一</a>、<a href="/posts/b6d5fbb8.html">Dubbo 2 巩固教程之二</a>、<a href="/posts/ea9ce835.html">Dubbo 2 巩固教程之三</a></li><li><a href="/posts/a64e842b.html">Dubbo 2 巩固教程之四</a>、<a href="/posts/bbace66e.html">Dubbo 2 巩固教程之五</a>、<a href="/posts/a49012b.html">Dubbo 2 巩固教程之六</a></li><li><a href="/posts/bdb52e6d.html">Dubbo 2 巩固教程之七</a></li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="学习资源"><a href="#学习资源" class="headerlink" title="学习资源"></a>学习资源</h3><ul><li><a target="_blank" rel="external nofollow" href="https://github.com/apache/incubator-dubbo/">Dubbo 官方项目（GitHub）</a></li><li><a target="_blank" rel="external nofollow" href="https://github.com/apache/dubbo-samples">Dubbo 官方案例（GitHub）</a></li><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/docsv2.7/">Dubbo 官方文档（2.7 版本）</a></li><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/docs/">Dubbo 官方文档（快照版本）</a></li><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/overview/">Dubbo 官方文档（最新版本）</a></li></ul><span id="more"></span><h2 id="Dubbo-深入理解"><a href="#Dubbo-深入理解" class="headerlink" title="Dubbo 深入理解"></a>Dubbo 深入理解</h2><h3 id="Dubbo-设计原则"><a href="#Dubbo-设计原则" class="headerlink" title="Dubbo 设计原则"></a>Dubbo 设计原则</h3><h4 id="Dubbo-的整体架构"><a href="#Dubbo-的整体架构" class="headerlink" title="Dubbo 的整体架构"></a>Dubbo 的整体架构</h4><p>Dubbo 中存在四大组件：</p><ul><li><strong>Provider：</strong> 服务提供者。</li><li><strong>Consumer：</strong> 服务消费者。</li><li><strong>Registry：</strong> 服务注册与发现的中心，提供目录服务，也称为服务注册中心。</li><li><strong>Monitor：</strong> 统计服务的调用次数、调用时间等信息的监控服务，并可以对服务设置权限、降级处理等，称为服务管控中心。</li></ul><p><img data-src="../../../asset/2025/11/dubbo-principle-1.png"></p><h4 id="Dubbo-的功能性需求"><a href="#Dubbo-的功能性需求" class="headerlink" title="Dubbo 的功能性需求"></a>Dubbo 的功能性需求</h4><p><img data-src="../../../asset/2025/11/dubbo-principle-2.png"></p><h4 id="Dubbo-的非功能性需求"><a href="#Dubbo-的非功能性需求" class="headerlink" title="Dubbo 的非功能性需求"></a>Dubbo 的非功能性需求</h4><ul><li><p>Dubbo 发展之初遇到的问题</p><ul><li>随着 Dubbo 在阿里内部使用越来越火热，堆积的需求也越来越多，Dubbo 项目组人手不足。</li><li>Dubbo 项目外的人员希望也能加入进来丰富 Dubbo 生态，进行功能扩展开放，开闭原则（OCP）应声而出。</li></ul></li><li><p>Dubbo 的非功能性需求：开放扩展</p><ul><li>Dubbo 需要留一些扩展点，让项目参与者尽量黑盒扩展，而不是白盒的修改代码，否则分支、质量、合并、冲突都会很难管理。</li></ul></li></ul><h4 id="Dubbo-的微核心插件式设计"><a href="#Dubbo-的微核心插件式设计" class="headerlink" title="Dubbo 的微核心插件式设计"></a>Dubbo 的微核心插件式设计</h4><ul><li>Dubbo 是如何做到优雅的开放扩展<ul><li>微核心 + 插件式，平等对待第三方<ul><li>由一个插件生命周期管理容器构成微核心，核心不包括任何功能，这样可以确保所有功能都能被替换。</li><li>框架作者能做到的功能，扩展者也一定要能做到，以保证平等对待第三方。</li><li>因此，框架自身的功能也要用插件的方式实现，不能有任何硬编码。</li></ul></li><li>首先需要做的是统一扩展点的加载方式</li><li>然后考虑采用什么样的扩展点加载方式<ul><li>采用微核心 + 插件式架构。通常微核心会采用 Factory、IoC、OSGi 等方式管理插件生命周期。</li><li>Dubbo 最初曾考虑使用 Spring IoC 或自己实现一个 IoC 容器，但最终选择了采用 Factory 方式管理插件，并曾经使用 JDK 的 SPI 机制来实现 Factory。</li><li>因此，Dubbo 中曾有一个已被废弃的 <code>@Extension</code> 注解，最终被自己实现的 SPI 机制取代，也就是现在使用的 <code>@SPI</code> 注解。</li></ul></li></ul></li></ul><div class="admonition note"><p class="admonition-title">Dubbo 的基本设计原则</p><ul><li>采用 Microkernel + Plugin（微核心 + 插件）模式，Microkernel 只负责组装 Plugin，而 Dubbo 自身的功能也是通过扩展点实现的，也就是 Dubbo 的所有功能点都可被用户自定义扩展所替换。</li><li>采用 URL 作为配置信息的统一格式，所有扩展点都通过传递 URL 携带配置信息。</li></ul></div><h4 id="Dubbo-的组合式扩展设计"><a href="#Dubbo-的组合式扩展设计" class="headerlink" title="Dubbo 的组合式扩展设计"></a>Dubbo 的组合式扩展设计</h4><p>Dubbo 采用了组合式扩展：核心最小化（<code>Protocol + Invoker + Exporter</code>），其他能力通过分层与组合的方式添加。</p><h5 id="扩充式扩展与增量式扩展"><a href="#扩充式扩展与增量式扩展" class="headerlink" title="扩充式扩展与增量式扩展"></a>扩充式扩展与增量式扩展</h5><p>在对一个原有的功能设计扩展方案时，常见有两类扩展方式：</p><ul><li><p>扩充式扩展：</p><ul><li>在原有实现上做增强，让新旧功能共用同一套代码路径。</li><li>新功能通过在原逻辑内 “兼容” 方式实现。</li><li>旧功能也会受到新逻辑影响，即使不需要，也会额外承担开销。</li></ul></li><li><p>增量式扩展：</p><ul><li>原功能保持简单、保持原有代码路径不变。</li><li>新功能以独立实现新增，不入侵旧逻辑。</li><li>使用者按需选择使用旧实现或新实现，互不干扰。</li></ul></li><li><p>举例，扩展一个 OSGI 序列化功能，要求功能明确，把流转成对象，对象转成流。</p><ul><li>扩充式扩展的做法：<ul><li>在原有序列化逻辑内部增加对 OSGi 序列化的支持。</li><li>无论是否需要 OSGi，都要先把 Stream 转成 <code>byte[]</code>，才能满足新逻辑的处理流程。</li><li>最终结果：<ul><li>新功能很容易实现，因为复用了旧逻辑。</li><li>但旧场景本来不需要额外的 <code>byte[]</code> 中间转换，却被迫付出了额外成本（性能损耗、内存占用增加等）。</li></ul></li><li>存在问题：<ul><li>旧功能为新功能背负了不必要的成本。</li></ul></li></ul></li><li>增量式扩展的做法：<ul><li>保留非 OSGi 的序列化代码，不改动、不增加额外中间步骤。</li><li>单独新增一个 OSGi 序列化实现，内部按 OSGi 规范自行处理。</li><li>若使用 OSGi 场景，则直接注入 / 依赖此实现即可。</li><li>实现好处：<ul><li>旧功能不变，成本不变，新功能独立，互不影响。</li></ul></li></ul></li></ul></li></ul><table><thead><tr><th>扩展方式</th><th>特点</th><th>代价</th><th>适用场景</th></tr></thead><tbody><tr><td>扩充式扩展</td><td>在原逻辑内兼容新功能，新旧走同一代码路径</td><td>旧功能被连带影响，性能可能下降</td><td>新功能非常轻量、对旧逻辑影响极小</td></tr><tr><td>增量式扩展</td><td>新旧逻辑独立实现，互不影响</td><td>需要维护多套实现</td><td>新功能对旧功能影响较大、开销较大，或不想污染旧逻辑</td></tr></tbody></table><h5 id="泛化式扩展与组合式扩展"><a href="#泛化式扩展与组合式扩展" class="headerlink" title="泛化式扩展与组合式扩展"></a>泛化式扩展与组合式扩展</h5><p>在设计一个可扩展系统时，常见有两类扩展思路：</p><ul><li><p>泛化式扩展</p><ul><li>定义：<ul><li>扩展点不断抽象化、泛化，将不同功能的要求都往同一个概念里塞。</li><li>本质是取所有功能的并集：新功能加入时，需要扩充原有抽象，使其能容纳更多概念。</li></ul></li><li>缺点：<ul><li>容易让扩展点逐渐臃肿。</li><li>新功能侵入原有核心模型，使系统越来越复杂。</li><li>许多 “非核心功能” 会被迫纳入核心抽象。</li></ul></li></ul></li><li><p>组合式扩展</p><ul><li>定义：<ul><li>将功能按职责正交拆分。</li><li>本质是取所有功能的交集，扩展点保持最小交集（最小必要抽象）。</li><li>新功能总是基于旧功能之上实现，通过组合、包装、链式调用等方式叠加，而不是修改核心抽象。</li></ul></li><li>优点：<ul><li>核心模型保持简洁稳定。</li><li>扩展功能彼此独立、可插拔。</li><li>系统不会因为扩展点膨胀而复杂化。</li></ul></li></ul></li></ul><table><thead><tr><th>扩展方式</th><th>特点</th><th>问题 / 优点</th></tr></thead><tbody><tr><td>泛化式扩展</td><td>抽象不断膨胀，取所有功能并集</td><td>模型臃肿，核心功能被污染</td></tr><tr><td>组合式扩展</td><td>抽象保持极简，通过包装 / 组合扩展</td><td>稳定、高内聚、可插拔、清晰分层</td></tr></tbody></table><ul><li>泛化式扩展存在的问题（以 Dubbo 为例）<ul><li>在 Dubbo 中，如果选择泛化式扩展的做法，就会尝试把各种周边能力都塞进一个 “核心模型” 里，例如：<ul><li>路由器（Router）</li><li>集群容错（Cluster）</li><li>负载均衡（LoadBalance）</li><li>服务发布者（Exporter）</li><li>服务订阅者（Directory）</li></ul></li><li>一旦把它们都视为 “核心功能”，结果就是：<ul><li>核心抽象过度膨胀</li><li>层次不清晰</li><li>新功能必须入侵原核心框架</li></ul></li><li> Dubbo 的做法是采用组合式扩展：核心极简 + 分层组合<ul><li> Dubbo 的真正核心抽象并不包括上述能力</li><li> Dubbo 的核心包括三部分：<ul><li>Invoker<ul><li> 代表一个可调用体</li><li>是 Dubbo 的最小执行单元</li><li>类似 “函数指针”，统一抽象了调用逻辑</li></ul></li><li> Protocol<ul><li> 负责远程通信的协议栈</li><li>决定如何导出服务、如何引用服务</li></ul></li><li> Exporter<ul><li><code>Protocol.export()</code> 的结果</li><li>表示一个已经发布出去的、可被消费的服务</li></ul></li></ul></li><li>由此 Dubbo 形成两个主要层次：<ul><li>协议层（Protocol Layer）<ul><li>负责通信协议、序列化、网络传输等</li><li>核心抽象非常稳定：<code>Protocol + Invoker + Exporter</code></li></ul></li><li>路由层（Router Layer）<ul><li>在协议层之上进行组合式增强</li><li>路由、负载均衡、容错等都属于这一层</li><li>非核心能力都通过组合 Invoker 的方式增强，例如：<ul><li>Router → 过滤或选择部分 Invoker</li><li>LoadBalance → 根据负载均衡策略选择一个 Invoker</li><li>Cluster → 封装多 Invoker 提供集群能力</li><li> Filter → 链式增强一个 Invoker</li></ul></li><li> 因此，这些（路由、负载均衡、容错等）都不是 Dubbo 的核心，而是路由层的扩展能力</li></ul></li></ul></li></ul></li></ul></li></ul><div class="admonition note"><p class="admonition-title">总结</p><p><strong>Dubbo 的设计哲学是典型的组合式扩展：核心最小化（<code>Protocol + Invoker + Exporter</code>），其他能力通过分层与组合的方式添加。</strong></p></div><h4 id="Dubbo-的最大化复用设计"><a href="#Dubbo-的最大化复用设计" class="headerlink" title="Dubbo 的最大化复用设计"></a>Dubbo 的最大化复用设计</h4><ul><li>每个扩展点只封装一个变化因子</li><li>比如：想扩展 RPC 协议，可能只是想更换一种通信传输方式（比如，将 Netty 替换为 Mina），其他的都复用。需要将协议拆解如下：</li></ul><p><img data-src="../../../asset/2025/11/dubbo-principle-3.png"></p><h4 id="Dubbo-的全管道式设计"><a href="#Dubbo-的全管道式设计" class="headerlink" title="Dubbo 的全管道式设计"></a>Dubbo 的全管道式设计</h4><p>Dubbo 采用了截面拦截（AOP 风格），而非模板方法（Template Method）设计模式。</p><ul><li><p>模板方法设计模式的局限</p><ul><li>模板方法通常用于代码复用：<ul><li>将公共逻辑抽取到父类的模板方法中；</li><li>将可变逻辑抽象为钩子方法，由子类实现。</li></ul></li><li>但在 Framework 场景中，当 “公共逻辑” 本身非常复杂、包含大量功能点、并且新能力持续增加时：<ul><li>父类会变得臃肿；</li><li>模板方法的结构会被扩展需求不断侵入；</li><li>覆盖点过多、难以维护；</li><li>扩展性差，一旦修改会影响所有子类。</li></ul></li><li>因此，模板方法不适合承担 Dubbo 这种需要大量、可插拔扩展点的系统。</li></ul></li><li><p>Dubbo 采用截面拦截</p><ul><li>Dubbo 将公共逻辑抽取出来，通过 <code>Wrapper + Filter</code> 的方式进行组合扩展：<ul><li>每个扩展点实现一个独立的 Filter；</li><li>Filter 在 Invoker 外层形成调用链（Pipeline）；</li><li>责任链模式保证扩展能力可插拔、可按需组合；</li><li>Wrapper（如 <code>Protocol$Adaptive</code>）负责将扩展链编织到 Invoker 调用中。</li></ul></li><li>这种架构类似 AOP：扩展功能作为 “切面” 附加在 Invoker 调用前后，而不需要修改核心逻辑。</li></ul></li><li><p>Dubbo 中哪些功能是通过截面拦截实现的？</p><ul><li>在 Dubbo 中，许多功能都属于对 Invoker 调用的增强，而非核心逻辑，可以通过截面拦截实现：<ul><li><code>local</code> 本地调用</li><li><code>mock</code> 服务降级</li><li><code>generic</code> 泛化调用</li><li><code>echo</code> 回声测试</li><li><code>token</code> 令牌校验</li><li><code>accesslog</code> 访问日志</li><li><code>monitor</code> 调用统计</li><li><code>count</code> 统计计数</li><li><code>limit</code> 限流</li></ul></li><li>上面这些都不是由 Invoker 继承自父类获得的功能，而是通过独立的 Filter（例如限流的 <code>LimitFilter</code>），以调用链方式进行扩展。</li><li>为什么 Dubbo 不把这些功能放在 Invoker 的父类中？原因很简单：<ul><li>这会让父类极度臃肿，维护困难；</li><li>每加入一个新功能就要改父类，扩展困难；</li><li>父类逻辑会被功能点挤满，失去核心职责；</li><li>不同功能之间耦合严重，测试成本高；</li><li>无法做到 “按需添加” 扩展。</li></ul></li></ul></li></ul><h4 id="Dubbo-的外部最少概念"><a href="#Dubbo-的外部最少概念" class="headerlink" title="Dubbo 的外部最少概念"></a>Dubbo 的外部最少概念</h4><ul><li>一致性概念模型：<ul><li>保持尽可能少的概念，有助于理解，对于开放的系统尤其重要。</li><li>另外，各接口都使用一致的概念模型，能相互指引，并减少模型转换。</li></ul></li></ul><p><img data-src="../../../asset/2025/11/dubbo-principle-4.png"></p><h4 id="Dubbo-的十层整体设计"><a href="#Dubbo-的十层整体设计" class="headerlink" title="Dubbo 的十层整体设计"></a>Dubbo 的十层整体设计</h4><p><img data-src="../../../asset/2025/11/dubbo-principle-5.png"></p><p>Dubbo 整体架构设计图（如上所示）的说明：</p><ul><li>图中左边淡蓝背景的为服务消费方使用的接口，右边淡绿色背景的为服务提供方使用的接口，位于中轴线上的为双方都用到的接口。</li><li>图中从下至上分为十层，各层均为单向依赖，右边的黑色箭头代表层之间的依赖关系，每一层都可以剥离上层被复用，其中，Service 和 Config 层为 API，其它各层均为 SPI。</li><li>图中绿色小块的为扩展接口，蓝色小块为实现类，图中只显示用于关联各层的实现类。</li><li>图中蓝色虚线为初始化过程，即启动时组装链，红色实线为方法调用过程，即运行时调时链，紫色三角箭头为继承，可以把子类看作父类的同一个节点，线上的文字为调用的方法。</li></ul><p>Dubbo 的整体架构可以分为 10 层，从上到下依次是：</p><ul><li>(1) <strong>Service 层</strong>：接口层，给服务提供者和服务消费者来实现的（留给开发人员来实现）。</li><li>(2) <strong>Config 配置层</strong>：对外配置接口，以 <code>ServiceConfig</code>、<code>ReferenceConfig</code> 为中心，可以直接初始化配置类，也可以通过 Spring 解析配置生成配置类。</li><li>(3) <strong>Proxy 服务代理层</strong>：服务接口透明代理，生成服务的客户端 Stub 和服务器端 Skeleton， 以 <code>ServiceProxy</code> 为中心，扩展接口为 <code>ProxyFactory</code>。</li><li>(4) <strong>Registry 注册中心层</strong>：封装服务地址的注册与发现，以服务 URL 为中心，扩展接口为 <code>RegistryFactory</code>、<code>Registry</code>、<code>RegistryService</code>。</li><li>(5) <strong>Cluster 路由层</strong>：封装多个提供者的路由及负载均衡，并桥接注册中心，以 <code>Invoker</code> 为中心，扩展接口为 <code>Cluster</code>、<code>Directory</code>、<code>Router</code>、<code>LoadBalance</code>。</li><li>(6) <strong>Monitor 监控层</strong>：RPC 调用次数和调用时间监控，以 <code>Statistics</code> 为中心，扩展接口为 <code>MonitorFactory</code>、<code>Monitor</code>、<code>MonitorService</code>。</li><li>(7) <strong>Protocol 远程调用层</strong>：封装 RPC 调用，以 <code>Invocation</code> 和 <code>Result</code> 为中心，扩展接口为 <code>Protocol</code>、<code>Invoker</code>、<code>Exporter</code>。</li><li>(8) <strong>Exchange 信息交换层</strong>：封装请求响应模式，同步转异步，以 <code>Request</code> 和 <code>Response</code> 为中心，扩展接口为 <code>Exchanger</code>、<code>ExchangeChannel</code>、<code>ExchangeClient</code>、<code>ExchangeServer</code>。</li><li>(9) <strong>Transport 网络传输层</strong>：抽象 Mina 和 Netty 为统一接口，以 <code>Message</code> 为中心，扩展接口为 <code>Channel</code>、<code>Transporter</code>、<code>Client</code>、<code>Server</code>、<code>Codec</code>。</li><li>(10) <strong>Serialize 数据序列化层</strong>：可复用的一些工具，扩展接口为 <code>Serialization</code>、<code>ObjectInput</code>、<code>ObjectOutput</code>、<code>ThreadPool</code>。</li></ul><p>在 Dubbo 的十层整体设计中，各层之间的关系如下：</p><ul><li>(1) 在 RPC 中，Protocol 是核心层，也就是只要有 Protocol + Invoker + Exporter 就可以完成非透明的 RPC 调用，然后在 Invoker 的主过程上 Filter 拦截点。</li><li>(2) 上图中的 Consumer 和 Provider 是抽象概念，只是想让看图者更直观的了解哪些类分属于客户端与服务器端，不用 Client 和 Server 的原因是：Dubbo 在很多场景下都使用 Provider、Consumer、Registry、Monitor 来划分逻辑拓普节点，保持统一概念。</li><li>(3) Cluster 是外围概念，所以 Cluster 的目的是将多个 Invoker 伪装成一个 Invoker，这样其它人只要关注 Protocol 层的 Invoker 即可，加上 Cluster 或者去掉 Cluster 对其它层都不会造成影响，因为只有一个提供者时，是不需要 Cluster 的。</li><li>(4) Proxy 层封装了所有接口的透明化代理，而在其它层都以 Invoker 为中心，只有到了暴露给用户使用时，才会使用 Proxy 将 Invoker 转成接口，或者将接口实现转成 Invoker，也就是去掉 Proxy 层 RPC 是可以 Run 的，只是不那么透明，不那么看起来像调本地服务一样调远程服务。</li><li>(5) Remoting 实现是 Dubbo 协议的实现，如果选择 RMI 协议，整个 Remoting 都不会用上的。Remoting 的内部划分为 Transport 传输层和 Exchange 信息交换层，Transport 层只负责单向消息传输，是对 Mina、Netty、Grizzly 的抽象，它也可以扩展为 UDP 传输，而 Exchange 层是在传输层之上封装了 Request 和 Response 语义。</li><li>(6) Registry 和 Monitor 实际上不算一层，而是一个独立的节点，只是为了全局概览，用层的方式画在一起。</li></ul><div class="admonition note"><p class="admonition-title">Dubbo 官方文档</p><ul><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/docsv2.7/dev/design/">Dubbo 官方文档（2.7 版本）- 框架设计</a>，<a href="../../../asset/2025/11/dubbo2-docs-framework-design.png">附文档截图</a></li></ul></div><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"全栈技术驿站",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>支持一根棒棒糖！</div> <button> 赞赏</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay 微信"> <span>微信</span></div><div> <img src="/img/pay_zfb.png" alt="Clay 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Clay</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.techgrow.cn/posts/bbace66e.html" title="Dubbo2 巩固教程之五">https://www.techgrow.cn/posts/bbace66e.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">欢迎添加博主微信，请备注 "博客"，届时会邀请您加入百人微信群</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag"><i class="fa fa-tag"></i> 微服务</a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag"><i class="fa fa-tag"></i> 分布式</a><a href="/tags/RPC/" rel="tag"><i class="fa fa-tag"></i> RPC</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/a49012b.html" rel="prev" title="Dubbo2 巩固教程之六"><i class="fa fa-angle-left"></i> Dubbo2 巩固教程之六</a></div><div class="post-nav-item"> <a href="/posts/5bd408ba.html" rel="next" title="Fedora30 构建 Flatpak 应用">Fedora30 构建 Flatpak 应用<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright © 2018 – <span itemprop="copyrightYear">2026</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title="站点总字数">2.4m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>站点阅读时长 ≈</span> <span title="站点阅读时长">35:48</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" 年 "+s+" 日 "+d+" 小时 "+l+" 分钟 "+u+" 秒 "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">粤ICP备 19024664号-1</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">粤公网安备 44011302004035号</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"/lib/mathjax/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/api/oss/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，非法请求来源！");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，上传过于频繁！");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，系统内部出错！");
        } else {
          alert("图片上传失败，无法获取UploadToken，未知Http响应状态码！");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("图片上传失败，无法获取UploadToken，未知错误！");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"支持匿名评论啦，若希望及时收到博主的反馈，建议登录评论或者在上方的邮箱输入框留下邮箱地址哦 (๑•̀ㅂ•́)و✧"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/api/oss/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/bbace66e.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div><div id="moon-menu-item-code" class="moon-menu-item"><i class="fa-solid fa-code"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>