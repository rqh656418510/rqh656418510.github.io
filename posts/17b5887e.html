<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><meta name="description" content="本文主要介绍 Dubbo 3 的入门教程。"><meta property="og:type" content="article"><meta property="og:title" content="Dubbo 3 入门教程之一"><meta property="og:url" content="https://www.techgrow.cn/posts/17b5887e.html"><meta property="og:site_name" content="Clay 的技术空间"><meta property="og:description" content="本文主要介绍 Dubbo 3 的入门教程。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-10.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-11.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-12.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-13.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-14.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo3-config-1.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo3-config-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo3-config-3.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-7.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo3-config-5.png"><meta property="article:published_time" content="2022-09-29T15:42:35.000Z"><meta property="article:modified_time" content="2022-09-29T15:42:35.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="微服务"><meta property="article:tag" content="分布式"><meta property="article:tag" content="RPC"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-config-10.png"><link rel="canonical" href="https://www.techgrow.cn/posts/17b5887e.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/17b5887e.html","path":"posts/17b5887e.html","title":"Dubbo 3 入门教程之一"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Dubbo 3 入门教程之一 | Clay 的技术空间</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay 的技术空间" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay 的技术空间</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">用进废退 | 艺不压身</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>搜索</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>读书笔记</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>评论管理</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%BA%B2"><span class="nav-text">大纲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%BA%90"><span class="nav-text">学习资源</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo-%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83"><span class="nav-text">Dubbo 注册中心</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E7%B1%BB%E5%9E%8B"><span class="nav-text">注册中心类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E6%B3%A8%E5%86%8C"><span class="nav-text">多注册中心注册</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo-%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">Dubbo 线程模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B6%88%E8%B4%B9%E7%AB%AF%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">消费端线程模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E4%BE%9B%E7%AB%AF%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B"><span class="nav-text">提供端线程模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0%E9%9A%94%E7%A6%BB%E5%AE%9E%E7%8E%B0"><span class="nav-text">线程池隔离实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E7%A8%8B%E6%B1%A0%E7%8A%B6%E6%80%81%E5%AF%BC%E5%87%BA"><span class="nav-text">线程池状态导出</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo-%E9%85%8D%E7%BD%AE%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B"><span class="nav-text">Dubbo 配置加载流程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B"><span class="nav-text">加载流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E8%A6%86%E7%9B%96"><span class="nav-text">属性覆盖</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E9%85%8D%E7%BD%AE%E6%BA%90"><span class="nav-text">不同配置源</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%90%8C%E9%85%8D%E7%BD%AE%E6%BA%90"><span class="nav-text">相同配置源</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E5%8C%96%E9%85%8D%E7%BD%AE"><span class="nav-text">外部化配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E5%8C%96%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E"><span class="nav-text">外部化配置说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E9%83%A8%E5%8C%96%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8"><span class="nav-text">外部化配置使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E8%A1%8C%E5%8A%A0%E8%BD%BD%E5%A4%96%E9%83%A8%E5%8C%96%E9%85%8D%E7%BD%AE"><span class="nav-text">自行加载外部化配置</span></a></li></ol></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">741</span> <span class="site-state-item-name">文章</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">53</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub → https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail → mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap → /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/17b5887e.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay 的技术空间"><meta itemprop="description" content="专注于 Java 后端、分布式、微服务、云原生、数据库、系统架构、大数据、云计算、虚拟化、人工智能学习的技术博客。"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Dubbo 3 入门教程之一 | Clay 的技术空间"><meta itemprop="description" content="本文主要介绍 Dubbo 3 的入门教程。"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Dubbo 3 入门教程之一</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2022-09-29 23:42:35" itemprop="dateCreated datePublished" datetime="2022-09-29T23:42:35+08:00">2022-09-29</time></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">评论数：</span><a title="waline" href="/posts/17b5887e.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/17b5887e.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>4.6k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 ≈</span> <span>4 分钟</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h2><ul><li><a href="/posts/17b5887e.html">Dubbo 3 入门教程之一</a></li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="学习资源"><a href="#学习资源" class="headerlink" title="学习资源"></a>学习资源</h3><ul><li><a target="_blank" rel="external nofollow" href="https://github.com/apache/incubator-dubbo/">Dubbo 官方项目</a></li><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/">Dubbo 官方文档</a></li><li><a target="_blank" rel="external nofollow" href="https://github.com/apache/dubbo-samples">Dubbo 官方案例</a></li></ul><span id="more"></span><h2 id="Dubbo-注册中心"><a href="#Dubbo-注册中心" class="headerlink" title="Dubbo 注册中心"></a>Dubbo 注册中心</h2><div class="admonition note"><p class="admonition-title">Dubbo 官方文档</p><ul><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/registry/">Dubbo 官方文档 - 注册中心与服务发现</a></li></ul></div><h3 id="注册中心类型"><a href="#注册中心类型" class="headerlink" title="注册中心类型"></a>注册中心类型</h3><ul><li>Dubbo 目前支持的主流注册中心包括（不限于）：</li></ul><table><thead><tr><th>注册中心</th><th>说明</th></tr></thead><tbody><tr><td> Zookeeper</td><td>Dubbo 最早、最常用的注册中心实现，基于树形节点结构存储服务信息，具备良好的数据一致性与可靠的 Watch 机制。</td></tr><tr><td>Nacos</td><td> 阿里巴巴开源的服务发现与配置管理平台，支持动态注册与配置推送，适合微服务与云原生场景。</td></tr><tr><td>Consul</td><td>HashiCorp 开源的基于 Go 的服务发现与配置系统，支持多数据中心与 KV 存储，Dubbo 可通过 Consul 实现跨语言注册。</td></tr><tr><td>Etcd</td><td>CoreOS 开源的基于 Go 的高可用分布式键值存储，使用 Raft 协议保证一致性，常用于云原生和 Kubernetes 环境下的配置共享、服务发现与协调。</td></tr><tr><td>Redis</td><td> 轻量级的注册中心实现，利用 Redis 的发布 / 订阅机制进行服务发现，适合测试或小规模集群。</td></tr><tr><td>Multicast</td><td>Multicast 注册中心不需要启动任何中心节点，只要广播地址一样，就可以互相发现。</td></tr></tbody></table><ul><li>Dubbo 默认支持 ZooKeeper 与 Nacos 作为注册中心，同时还支持 Kubernetes、Mesh 体系的服务发现。</li><li>Dubbo 扩展生态提供了 Consul、Etcd、Redis、Multicast 等注册中心的扩展实现。</li><li>通过 Dubbo SPI 扩展机制，用户还可以将更多的注册中心实现到 Dubbo 生态。</li><li>Dubbo 支持在一个应用中指定多个注册中心，并将服务根据注册中心分组，这样做使得服务分组管理或服务迁移变得更容易。</li></ul><h3 id="多注册中心注册"><a href="#多注册中心注册" class="headerlink" title="多注册中心注册"></a>多注册中心注册</h3><ul><li>Dubbo 支持同一个服务向多个注册中心同时注册，或者不同的服务分别注册到不同的注册中心上去，甚至可以同时引用注册在不同注册中心上的同名服务。</li></ul><blockquote><p>多注册中心的使用</p></blockquote><ul><li>同一个服务注册到不同的注册中心。比如：中文站有些服务来不及在青岛部署，只在杭州部署，而青岛的其它应用需要引用此服务，就可以将青岛的服务同时注册到两个注册中心，具体配置如下图所示：</li></ul><p><img data-src="../../../asset/2025/09/dubbo-config-10.png"></p><ul><li>不同的服务注册到不同的注册中心。比如：CRM 系统中有些服务是专门为国际站设计的，有些服务是专门为中文站设计的，具体配置如下图所示：</li></ul><p><img data-src="../../../asset/2025/09/dubbo-config-11.png"></p><ul><li>单独引用不同注册中心的服务。比如：CRM 系统中需要同时调用中文站和国际站的 PC2 服务，而 PC2 服务在中文站和国际站均有部署，接口及版本号都一样，但连接的数据库不一样，具体配置如下图所示：</li></ul><p><img data-src="../../../asset/2025/09/dubbo-config-12.png"></p><ul><li>同时引用不同注册中心的同名服务，可以使用竖号分隔多个不同注册中心地址。比如：CRM 系统中需要同时调用中文站和国际站的 Pay 服务，而 Pay 服务在中文站和国际站均有部署，接口及版本号都一样，连接的数据库也一样，具体配置如下图所示：</li></ul><p><img data-src="../../../asset/2025/09/dubbo-config-13.png"></p><blockquote><p>一个服务多个注册中心的应用场景</p></blockquote><p><img data-src="../../../asset/2025/09/dubbo-config-14.png"></p><h2 id="Dubbo-线程模型"><a href="#Dubbo-线程模型" class="headerlink" title="Dubbo 线程模型"></a>Dubbo 线程模型</h2><div class="admonition note"><p class="admonition-title">Dubbo 官方文档</p><ul><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/docs/advanced/thread-model/">Dubbo 官方文档（2.x）- 线程模型</a></li><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/docsv2.7/dev/source/service-invoking-process/#2321-%E7%BA%BF%E7%A8%8B%E6%B4%BE%E5%8F%91%E6%A8%A1%E5%9E%8B">Dubbo 官方文档（2.7）- 线程模型</a></li><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/framework/threading-model/">Dubbo 官方文档（最新）- 线程模型</a></li></ul></div><h3 id="消费端线程模型"><a href="#消费端线程模型" class="headerlink" title="消费端线程模型"></a>消费端线程模型</h3><h3 id="提供端线程模型"><a href="#提供端线程模型" class="headerlink" title="提供端线程模型"></a>提供端线程模型</h3><h3 id="线程池隔离实现"><a href="#线程池隔离实现" class="headerlink" title="线程池隔离实现"></a>线程池隔离实现</h3><blockquote><p>线程池隔离的介绍</p></blockquote><ul><li><p>核心概念</p><ul><li>Dubbo 服务提供端除了可以通过 <code>&lt;dubbo:protocol name="dubbo" port="20880" dispatcher="all" threadpool="fixed" threads="100"/&gt;</code> 的配置方式实现线程池隔离。</li><li>Dubbo 3 还有一种新的线程池管理方式，使得提供者应用内各个服务的线程池隔离开来，互相独立，某个服务的线程池资源耗尽不会影响其他正常服务。支持线程池可配置化，由用户手动指定，详细介绍请看<a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/framework/threading-model/#%E7%BA%BF%E7%A8%8B%E6%B1%A0%E9%9A%94%E7%A6%BB"><strong>官方文档</strong></a>。</li><li>使用线程池隔离来确保 Dubbo 用于调用远程方法的线程与微服务用于执行其任务的线程是分开的。可以通过防止线程阻塞或相互竞争来帮助提高系统的性能和稳定性。目前可以以 API、XML、Annotation 的方式进行配置。</li></ul></li><li><p>配置参数</p><ul><li><code>ApplicationConfig</code> 新增了 <code>executor-management-mode</code> 参数，配置值为 <code>default</code> 和 <code>isolation</code>，默认为 <code>default</code>。<ul><li><code>executor-management-mode = default</code> 使用原有<strong>以协议端口为粒度、服务间共享</strong>的线程池管理方式。</li><li><code>executor-management-mode = isolation</code> 使用新增的<strong>以服务三元组为粒度、服务间隔离</strong>的线程池管理方式。</li></ul></li><li><code>ServiceConfig</code> 新增了 <code>executor</code> 参数，<strong>用以服务间隔离的线程池，可以由用户配置化、提供自己实现的线程池</strong>；若没有指定，则会根据协议配置 (ProtocolConfig) 信息构建默认的线程池用以服务隔离。<ul><li><code>ServiceConfig</code> 新增的 <code>executor</code> 配置参数，只有在 <code>ApplicationConfig</code> 中指定 <code>executor-management-mode = isolation</code> 时才会生效。</li></ul></li></ul></li></ul><blockquote><p>线程池隔离的使用</p></blockquote><ul><li>原生 API 配置方式</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="comment">// provider app</span></span><br><span class="line">    DubboBootstrap providerBootstrap = DubboBootstrap.newInstance();</span><br><span class="line"></span><br><span class="line">    ServiceConfig serviceConfig1 = <span class="keyword">new</span> ServiceConfig();</span><br><span class="line">    serviceConfig1.setInterface(DemoService.class);</span><br><span class="line">    serviceConfig1.setRef(<span class="keyword">new</span> DemoServiceImpl());</span><br><span class="line">    serviceConfig1.setVersion(version1);</span><br><span class="line">    <span class="comment">// set executor1 for serviceConfig1, max threads is 10</span></span><br><span class="line">    NamedThreadFactory threadFactory1 = <span class="keyword">new</span> NamedThreadFactory(<span class="string">"DemoService-executor"</span>);</span><br><span class="line">    ExecutorService executor1 = Executors.newFixedThreadPool(<span class="number">10</span>, threadFactory1);</span><br><span class="line">    serviceConfig1.setExecutor(executor1);</span><br><span class="line"></span><br><span class="line">    ServiceConfig serviceConfig2 = <span class="keyword">new</span> ServiceConfig();</span><br><span class="line">    serviceConfig2.setInterface(HelloService.class);</span><br><span class="line">    serviceConfig2.setRef(<span class="keyword">new</span> HelloServiceImpl());</span><br><span class="line">    serviceConfig2.setVersion(version2);</span><br><span class="line">    <span class="comment">// set executor2 for serviceConfig2, max threads is 100</span></span><br><span class="line">    NamedThreadFactory threadFactory2 = <span class="keyword">new</span> NamedThreadFactory(<span class="string">"HelloService-executor"</span>);</span><br><span class="line">    ExecutorService executor2 = Executors.newFixedThreadPool(<span class="number">100</span>, threadFactory2);</span><br><span class="line">    serviceConfig2.setExecutor(executor2);</span><br><span class="line"></span><br><span class="line">    ServiceConfig serviceConfig3 = <span class="keyword">new</span> ServiceConfig();</span><br><span class="line">    serviceConfig3.setInterface(HelloService.class);</span><br><span class="line">    serviceConfig3.setRef(<span class="keyword">new</span> HelloServiceImpl());</span><br><span class="line">    serviceConfig3.setVersion(version3);</span><br><span class="line">    <span class="comment">// Because executor is not set for serviceConfig3, the default executor of serviceConfig3 is built using</span></span><br><span class="line">    <span class="comment">// the threadpool parameter of the protocolConfig ( FixedThreadpool , max threads is 200)</span></span><br><span class="line">    serviceConfig3.setExecutor(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// It takes effect only if [executor-management-mode=isolation] is configured</span></span><br><span class="line">    ApplicationConfig applicationConfig = <span class="keyword">new</span> ApplicationConfig(<span class="string">"provider-app"</span>);</span><br><span class="line">    applicationConfig.setExecutorManagementMode(<span class="string">"isolation"</span>);</span><br><span class="line"></span><br><span class="line">    providerBootstrap</span><br><span class="line">    .application(applicationConfig)</span><br><span class="line">    .registry(registryConfig)</span><br><span class="line">    <span class="comment">// export with tri and dubbo protocol</span></span><br><span class="line">    .protocol(<span class="keyword">new</span> ProtocolConfig(<span class="string">"tri"</span>, <span class="number">20001</span>))</span><br><span class="line">    .protocol(<span class="keyword">new</span> ProtocolConfig(<span class="string">"dubbo"</span>, <span class="number">20002</span>))</span><br><span class="line">    .service(serviceConfig1)</span><br><span class="line">    .service(serviceConfig2)</span><br><span class="line">    .service(serviceConfig3);</span><br><span class="line"></span><br><span class="line">    providerBootstrap.start();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>XML 配置方式</li></ul><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:dubbo</span>=<span class="string">"http://dubbo.apache.org/schema/dubbo"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.3.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">       http://dubbo.apache.org/schema/dubbo http://dubbo.apache.org/schema/dubbo/dubbo.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- <span class="doctag">NOTE:</span> we need config executor-management-mode="isolation" --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"demo-provider"</span> <span class="attr">executor-management-mode</span>=<span class="string">"isolation"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:config-center</span> <span class="attr">address</span>=<span class="string">"zookeeper://127.0.0.1:2181"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:metadata-report</span> <span class="attr">address</span>=<span class="string">"zookeeper://127.0.0.1:2181"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">id</span>=<span class="string">"registry1"</span> <span class="attr">address</span>=<span class="string">"zookeeper://127.0.0.1:2181?registry-type=service"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">"dubbo"</span> <span class="attr">port</span>=<span class="string">"-1"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">"tri"</span> <span class="attr">port</span>=<span class="string">"-1"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- expose three service with dubbo and tri protocol--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"demoServiceV1"</span> <span class="attr">class</span>=<span class="string">"org.apache.dubbo.config.spring.impl.DemoServiceImpl"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloServiceV2"</span> <span class="attr">class</span>=<span class="string">"org.apache.dubbo.config.spring.impl.HelloServiceImpl"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloServiceV3"</span> <span class="attr">class</span>=<span class="string">"org.apache.dubbo.config.spring.impl.HelloServiceImpl"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- customized thread pool --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"executor-demo-service"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.apache.dubbo.config.spring.isolation.spring.support.DemoServiceExecutor"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"executor-hello-service"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">"org.apache.dubbo.config.spring.isolation.spring.support.HelloServiceExecutor"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- this service use [executor="executor-demo-service"] as isolated thread pool--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">executor</span>=<span class="string">"executor-demo-service"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">interface</span>=<span class="string">"org.apache.dubbo.config.spring.api.DemoService"</span> <span class="attr">version</span>=<span class="string">"1.0.0"</span> <span class="attr">group</span>=<span class="string">"Group1"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">timeout</span>=<span class="string">"3000"</span> <span class="attr">ref</span>=<span class="string">"demoServiceV1"</span> <span class="attr">registry</span>=<span class="string">"registry1"</span> <span class="attr">protocol</span>=<span class="string">"dubbo,tri"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- this service use [executor="executor-hello-service"] as isolated thread pool--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">executor</span>=<span class="string">"executor-hello-service"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">interface</span>=<span class="string">"org.apache.dubbo.config.spring.api.HelloService"</span> <span class="attr">version</span>=<span class="string">"2.0.0"</span> <span class="attr">group</span>=<span class="string">"Group2"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">timeout</span>=<span class="string">"5000"</span> <span class="attr">ref</span>=<span class="string">"helloServiceV2"</span> <span class="attr">registry</span>=<span class="string">"registry1"</span> <span class="attr">protocol</span>=<span class="string">"dubbo,tri"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- not set executor for this service, the default executor built using threadpool parameter of the protocolConfig --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"org.apache.dubbo.config.spring.api.HelloService"</span> <span class="attr">version</span>=<span class="string">"3.0.0"</span> <span class="attr">group</span>=<span class="string">"Group3"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">timeout</span>=<span class="string">"5000"</span> <span class="attr">ref</span>=<span class="string">"helloServiceV3"</span> <span class="attr">registry</span>=<span class="string">"registry1"</span> <span class="attr">protocol</span>=<span class="string">"dubbo,tri"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><ul><li>注解配置方式</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableDubbo(scanBasePackages = "org.apache.dubbo.config.spring.isolation.spring.annotation.provider")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProviderConfiguration</span> </span>{</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RegistryConfig <span class="title">registryConfig</span><span class="params">()</span> </span>{</span><br><span class="line">        RegistryConfig registryConfig = <span class="keyword">new</span> RegistryConfig();</span><br><span class="line">        registryConfig.setAddress(<span class="string">"zookeeper://127.0.0.1:2181"</span>);</span><br><span class="line">        <span class="keyword">return</span> registryConfig;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// <span class="doctag">NOTE:</span> we need config executor-management-mode="isolation"</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ApplicationConfig <span class="title">applicationConfig</span><span class="params">()</span> </span>{</span><br><span class="line">        ApplicationConfig applicationConfig = <span class="keyword">new</span> ApplicationConfig(<span class="string">"provider-app"</span>);</span><br><span class="line"></span><br><span class="line">        applicationConfig.setExecutorManagementMode(<span class="string">"isolation"</span>);</span><br><span class="line">        <span class="keyword">return</span> applicationConfig;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// expose services with dubbo protocol</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProtocolConfig <span class="title">dubbo</span><span class="params">()</span> </span>{</span><br><span class="line">        ProtocolConfig protocolConfig = <span class="keyword">new</span> ProtocolConfig(<span class="string">"dubbo"</span>);</span><br><span class="line">        <span class="keyword">return</span> protocolConfig;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// expose services with tri protocol</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ProtocolConfig <span class="title">tri</span><span class="params">()</span> </span>{</span><br><span class="line">        ProtocolConfig protocolConfig = <span class="keyword">new</span> ProtocolConfig(<span class="string">"tri"</span>);</span><br><span class="line">        <span class="keyword">return</span> protocolConfig;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// customized thread pool</span></span><br><span class="line">    <span class="meta">@Bean("executor-demo-service")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">demoServiceExecutor</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DemoServiceExecutor();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// customized thread pool</span></span><br><span class="line">    <span class="meta">@Bean("executor-hello-service")</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Executor <span class="title">helloServiceExecutor</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> HelloServiceExecutor();</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>自定义的线程池和服务实现</li></ul><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// customized thread pool</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceExecutor</span> <span class="keyword">extends</span> <span class="title">ThreadPoolExecutor</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">DemoServiceExecutor</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">10</span>, <span class="number">10</span>, <span class="number">60</span>, TimeUnit.SECONDS, <span class="keyword">new</span> LinkedBlockingDeque&lt;&gt;(),</span><br><span class="line">            <span class="keyword">new</span> NamedThreadFactory(<span class="string">"DemoServiceExecutor"</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// customized thread pool</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServiceExecutor</span> <span class="keyword">extends</span> <span class="title">ThreadPoolExecutor</span> </span>{</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HelloServiceExecutor</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">super</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">60</span>, TimeUnit.SECONDS, <span class="keyword">new</span> LinkedBlockingDeque&lt;&gt;(),</span><br><span class="line">            <span class="keyword">new</span> NamedThreadFactory(<span class="string">"HelloServiceExecutor"</span>));</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// "executor-hello-service" is beanName</span></span><br><span class="line"><span class="meta">@DubboService(executor = "executor-demo-service", version = "1.0.0", group = "Group1")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoServiceImplV1</span> <span class="keyword">implements</span> <span class="title">DemoService</span> </span>{</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">sayName</span><span class="params">(String name)</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"server name"</span>;</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> Box <span class="title">getBox</span><span class="params">()</span> </span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not set executor for this service, the default executor built using threadpool parameter of the protocolConfig</span></span><br><span class="line"><span class="meta">@DubboService(version = "3.0.0", group = "Group3")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServiceImplV2</span> <span class="keyword">implements</span> <span class="title">HelloService</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(HelloServiceImplV2.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"server hello"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DubboService(executor = "executor-hello-service", version = "2.0.0", group = "Group2")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServiceImplV3</span> <span class="keyword">implements</span> <span class="title">HelloService</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger logger = LoggerFactory.getLogger(HelloServiceImplV3.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">sayHello</span><span class="params">(String name)</span> </span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"server hello"</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h3 id="线程池状态导出"><a href="#线程池状态导出" class="headerlink" title="线程池状态导出"></a>线程池状态导出</h3><blockquote><p>概念介绍</p></blockquote><ul><li>Dubbo 可以通过 <code>Jstack</code> 自动导出线程堆栈来保留现场，方便排查问题。</li><li>Dubbo 线程池状态的默认导出策略：<ul><li>导出开关：默认打开</li><li>导出路径：<code>user.home</code> 标识的用户主目录</li><li>导出间隔：最短间隔允许每隔 10 分钟导出一次</li></ul></li><li>当业务线程池满时，往往需要知道线程都在等待哪些资源、条件，以找到系统的瓶颈点或异常点。</li></ul><blockquote><p>配置方式</p></blockquote><ul><li>导出开关</li></ul><figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dubbo.properties</span></span><br><span class="line"><span class="meta">dubbo.application.dump.enable</span>=<span class="string">true</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"demo-provider"</span> <span class="attr">dump-enable</span>=<span class="string">"false"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dubbo:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-springboot-demo-provider</span></span><br><span class="line">    <span class="attr">dump-enable:</span> <span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure><ul><li>导出路径</li></ul><figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dubbo.properties</span></span><br><span class="line"><span class="meta">dubbo.application.dump.directory</span>=<span class="string">/tmp</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"demo-provider"</span> <span class="attr">dump-directory</span>=<span class="string">"/tmp"</span>/&gt;</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dubbo:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">dubbo-springboot-demo-provider</span></span><br><span class="line">    <span class="attr">dump-directory:</span> <span class="string">/tmp</span></span><br></pre></td></tr></tbody></table></figure><h2 id="Dubbo-配置加载流程"><a href="#Dubbo-配置加载流程" class="headerlink" title="Dubbo 配置加载流程"></a>Dubbo 配置加载流程</h2><div class="admonition note"><p class="admonition-title">Dubbo 官方文档</p><p>更多关于 Dubbo 配置加载的介绍请看 <a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/config/principle/">Dubbo 官方文档 - 配置加载流程</a>。</p></div><h3 id="加载流程"><a href="#加载流程" class="headerlink" title="加载流程"></a>加载流程</h3><p>Dubbo 的配置加载大概分为两个阶段：</p><ul><li>第一阶段为 DubboBootstrap 初始化之前，在 Spring Context 启动时解析处理 XML 配置 / 注解配置 / Java-Config 或者是执行 API 配置代码，创建 Config Bean 并且加入到 ConfigManager 中。</li><li>第二阶段为 DubboBootstrap 初始化过程，从配置中心读取外部配置，依次处理实例级属性配置和应用级属性配置，最后刷新所有配置实例的属性，也就是属性覆盖。</li></ul><p><img data-src="../../../asset/2025/09/dubbo3-config-1.png"></p><h3 id="属性覆盖"><a href="#属性覆盖" class="headerlink" title="属性覆盖"></a>属性覆盖</h3><p>发生属性覆盖可能有两种情况，并且二者可能是会同时发生的：</p><ul><li>不同配置源配置了相同的配置项</li><li>相同配置源，但在不同层次指定了相同的配置项</li></ul><h4 id="不同配置源"><a href="#不同配置源" class="headerlink" title="不同配置源"></a>不同配置源</h4><p>Dubbo 3 的配置来源和优先级高低如下所示，<strong>优先级高的会覆盖优先级低的</strong>。</p><table><thead><tr><th>优先级</th><th>配置来源</th><th>说明</th></tr></thead><tbody><tr><td> 1</td><td>JVM System Properties（<code>-D</code> 参数）</td><td>优先级最高，通过 JVM 启动参数指定，适合部署或临时覆盖配置，例如：<code>-Ddubbo.protocol.port=20890</code></td></tr><tr><td>2</td><td>System Environment（系统环境变量）</td><td>JVM 进程的环境变量配置，例如通过操作系统的 <code>export</code> 或 <code>set</code> 命令设置</td></tr><tr><td> 3</td><td>Externalized Configuration（外部化配置）</td><td>从远端的配置中心读取配置，例如 Apollo、Nacos、Zookeeper 等</td></tr><tr><td> 4</td><td>Application Configuration（应用属性配置）</td><td>从 Spring 应用的 Environment 中提取以 <code>dubbo</code> 开头的属性集</td></tr><tr><td> 5</td><td>API / XML / 注解配置</td><td>通过原生 API、XML 或注解形式直接编写的配置，属于用户直接定义的配置来源</td></tr><tr><td> 6</td><td>Classpath 配置文件（<code>dubbo.properties</code>）</td><td>优先级最低，从 Classpath 中读取 <code>dubbo.properties</code> 文件，作为默认或兜底配置</td></tr></tbody></table><p><img data-src="../../../asset/2025/09/dubbo3-config-2.png"></p><div class="admonition warning"><p class="admonition-title">关于 dubbo.properties 配置文件</p><ul><li>如果在 Classpath 下存在多个 <code>dubbo.properties</code> 文件，比如，两个 Jar 包都各自包含了 <code>dubbo.properties</code>，Dubbo 将随机选择一个配置文件进行加载，并且打印错误日志。</li><li>Dubbo 可以自动加载 Classpath 根目录下的 <code>dubbo.properties</code>，但是用户同样可以使用 JVM 参数来指定 Properties 配置文件的路径，比如 <code>-Ddubbo.properties.file=xxx.properties</code>。</li></ul></div><h4 id="相同配置源"><a href="#相同配置源" class="headerlink" title="相同配置源"></a>相同配置源</h4><p>属性覆盖是指用配置的属性值覆盖 Config Bean 实例的属性，类似 Spring 的 <code>PropertyOverrideConfigurer</code> 的作用，但与 <code>PropertyOverrideConfigurer</code> 的不同之处是，Dubbo 的属性覆盖有多个匹配格式，优先级从高到低依次是：</p><figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1. 指定id的实例级配置</span></span><br><span class="line"><span class="meta">dubbo.{config-type}s.{config-id}.{config-item}</span>=<span class="string">{config-item-value}</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#2. 指定name的实例级配置</span></span><br><span class="line"><span class="meta">dubbo.{config-type}s.{config-name}.{config-item}</span>=<span class="string">{config-item-value}</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#3. 应用级配置（单数配置）</span></span><br><span class="line"><span class="meta">dubbo.{config-type}.{config-item}</span>=<span class="string">{config-item-value}</span></span><br></pre></td></tr></tbody></table></figure><p>属性覆盖处理流程如下图所示，按照优先级从高到低依次查找，如果找到此前缀开头的属性，则选定使用这个前缀提取属性，忽略后面的配置。</p><p><img data-src="../../../asset/2025/09/dubbo3-config-3.png"></p><h3 id="外部化配置"><a href="#外部化配置" class="headerlink" title="外部化配置"></a>外部化配置</h3><div class="admonition note"><p class="admonition-title">Dubbo 官方文档</p><ul><li><a target="_blank" rel="external nofollow" href="https://dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/config-center/">Dubbo 官方文档 - 配置中心</a></li></ul></div><h4 id="外部化配置说明"><a href="#外部化配置说明" class="headerlink" title="外部化配置说明"></a>外部化配置说明</h4><ul><li>Dubbo 外部化配置和其他本地配置在内容和格式上并没有任何区别，可以简单理解为 <code>dubbo.properties</code> 的外部化存储，配置中心更适合将一些公共配置（如注册中心、元数据中心等配置）抽取出来，以便做集中管理。</li><li>Dubbo 外部化配置的主要目的是实现配置的集中式管理，支持的成熟配置系统有：ZooKeeper、Apollo、Nacos、Etcd、Consul，而 Dubbo 做的主要是支持这些配置系统正常工作，让集成更加方便。</li><li>举个例子：当 Dubbo 使用 Apollo、Nacos 等配置中心后，可以将以下全局配置（比如注册中心地址、元数据中心地址、协议、QOS 等）统一存储在配置中心，这样应用在本地就不再需要配置。</li></ul><figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将注册中心地址、元数据中心地址、协议、QOS 等配置存储在配置中心（如 Nacos），这样可以做到统一管理、减少开发侧感知</span></span><br><span class="line"></span><br><span class="line"><span class="meta">dubbo.application.qos.qosEnable</span>=<span class="string">true</span></span><br><span class="line"><span class="meta">dubbo.application.qos.port</span>=<span class="string">33333</span></span><br><span class="line"></span><br><span class="line"><span class="meta">dubbo.registry.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br><span class="line"><span class="meta">dubbo.registry.simplified</span>=<span class="string">true</span></span><br><span class="line"></span><br><span class="line"><span class="meta">dubbo.metadata-report.address</span>=<span class="string">zookeeper://127.0.0.1:2181</span></span><br><span class="line"></span><br><span class="line"><span class="meta">dubbo.protocol.name</span>=<span class="string">dubbo</span></span><br><span class="line"><span class="meta">dubbo.protocol.port</span>=<span class="string">20880</span></span><br></pre></td></tr></tbody></table></figure><ul><li><p>优先级：外部化配置默认比本地配置拥有更高的优先级，因此这里配置的内容会覆盖本地配置值。</p></li><li><p>作用域：外部化配置有全局和应用两个级别，全局配置是所有应用共享的，应用级配置是由每个应用自己维护且只对自身可见的。当前已支持的扩展实现有 Zookeeper、Apollo、Nacos 等。</p></li><li><p>当 Dubbo 使用 ZooKeeper 作为配置中心时，ZooKeeper 中的数据存储结构如下图所示：</p></li></ul><p><img data-src="../../../asset/2025/09/dubbo-config-7.png"></p><h4 id="外部化配置使用"><a href="#外部化配置使用" class="headerlink" title="外部化配置使用"></a>外部化配置使用</h4><p>Dubbo 外部化配置的使用步骤如下：</p><ul><li><p>(1) 增加 <code>config-center</code> 配置（用于指定配置中心地址），比如：<code>&lt;dubbo:config-center address="nacos://127.0.0.1:8848"/&gt;</code></p></li><li><p>(2) 在相应的配置中心（Zookeeper、Nacos 等）增加全局配置项（如下图所示，以 Nacos 为例）</p><ul><li>开启外部化配置后，<code>registry</code>、<code>metadata-report</code>、<code>protocol</code>、<code>qos</code> 等全局范围的配置理论上都不再需要在应用中配置，应用开发侧专注业务服务配置，一些全局共享的全局配置转而由运维人员统一配置在远端配置中心。</li><li>这样能做到的效果就是，应用只需要关心：<ul><li>服务暴露、订阅服务；</li><li>配置中心地址当部署到不同的环境时，其他配置就能自动的被从对应的配置中心读取到。</li></ul></li><li>举例来说，每个应用中 Dubbo 相关的全局配置只要有以下内容可能就足够了，其余的都托管给相应环境下的配置中心：<figure class="highlight yml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">dubbo</span></span><br><span class="line"><span class="string">application</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">demo</span></span><br><span class="line"><span class="string">config-center</span></span><br><span class="line">    <span class="attr">address:</span> <span class="string">nacos://127.0.0.1:8848</span></span><br></pre></td></tr></tbody></table></figure></li></ul><p> <img data-src="../../../asset/2025/09/dubbo3-config-5.png"></p></li></ul><h4 id="自行加载外部化配置"><a href="#自行加载外部化配置" class="headerlink" title="自行加载外部化配置"></a>自行加载外部化配置</h4><p>所谓 Dubbo 对配置中心的支持，本质上就是将 <code>.properties</code> 从远端拉取到本地，然后和本地的配置做一次融合。理论上只要 Dubbo 框架能拿到需要的配置就可以正常的启动，它并不关心这些配置是自己加载到的还是应用直接塞给它的，所以 Dubbo 还提供了以下 API，让用户将自己组织好的配置塞给 Dubbo 框架（配置加载的过程是用户自己完成的），这样 Dubbo 框架就不再直接和 Apollo 或 Zookeeper 做读取配置交互。</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 应用自行加载配置</span></span><br><span class="line">Map&lt;String, String&gt; dubboConfigurations = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">dubboConfigurations.put(<span class="string">"dubbo.registry.address"</span>, <span class="string">"zookeeper://127.0.0.1:2181"</span>);</span><br><span class="line">dubboConfigurations.put(<span class="string">"dubbo.registry.simplified"</span>, <span class="string">"true"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将组织好的配置塞给Dubbo框架</span></span><br><span class="line">ConfigCenterConfig configCenter = <span class="keyword">new</span> ConfigCenterConfig();</span><br><span class="line">configCenter.setExternalConfig(dubboConfigurations);</span><br></pre></td></tr></tbody></table></figure><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"全栈技术驿站",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>支持一根棒棒糖！</div> <button> 赞赏</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay 微信"> <span>微信</span></div><div> <img src="/img/pay_zfb.png" alt="Clay 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Clay</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.techgrow.cn/posts/17b5887e.html" title="Dubbo 3 入门教程之一">https://www.techgrow.cn/posts/17b5887e.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">欢迎添加博主微信，请备注 "博客"，届时会邀请您加入百人微信群</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag"><i class="fa fa-tag"></i> 微服务</a><a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag"><i class="fa fa-tag"></i> 分布式</a><a href="/tags/RPC/" rel="tag"><i class="fa fa-tag"></i> RPC</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/50c7d080.html" rel="prev" title="Kafka 入门教程之七"><i class="fa fa-angle-left"></i> Kafka 入门教程之七</a></div><div class="post-nav-item"> <a href="/posts/bc19d204.html" rel="next" title="VuePress 渲染 Mermaid 绘图">VuePress 渲染 Mermaid 绘图<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright © 2018 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title="站点总字数">2.1m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>站点阅读时长 ≈</span> <span title="站点阅读时长">31:13</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" 年 "+s+" 日 "+d+" 小时 "+l+" 分钟 "+u+" 秒 "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">粤ICP备 19024664号-1</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">粤公网安备 44011302004035号</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/api/oss/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，非法请求来源！");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，上传过于频繁！");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，系统内部出错！");
        } else {
          alert("图片上传失败，无法获取UploadToken，未知Http响应状态码！");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("图片上传失败，无法获取UploadToken，未知错误！");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"支持匿名评论啦，若希望及时收到博主的反馈，建议登录评论或者在上方的邮箱输入框留下邮箱地址哦 (๑•̀ㅂ•́)و✧"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/api/oss/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/17b5887e.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>