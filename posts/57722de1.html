<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.12.2","exturl":false,"sidebar":{"position":"left","width":300,"display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script><meta name="description" content="æœ¬æ–‡ä¸»è¦ä»‹ç» Nacos 2.0 çš„æ•´ä½“æ¶æ„ã€æ€§èƒ½æå‡ï¼Œä»¥åŠ Nacos çš„ç”Ÿæ€åŠ 2.X ç‰ˆæœ¬çš„åç»­è§„åˆ’ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€"><meta property="og:url" content="https://www.techgrow.cn/posts/57722de1.html"><meta property="og:site_name" content="Clay çš„æŠ€æœ¯åšå®¢"><meta property="og:description" content="æœ¬æ–‡ä¸»è¦ä»‹ç» Nacos 2.0 çš„æ•´ä½“æ¶æ„ã€æ€§èƒ½æå‡ï¼Œä»¥åŠ Nacos çš„ç”Ÿæ€åŠ 2.X ç‰ˆæœ¬çš„åç»­è§„åˆ’ã€‚"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-1.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-2.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-3.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-4.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-5.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-6.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-7.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-8.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-9.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-10.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-11.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-12.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-13.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade-14.png"><meta property="article:published_time" content="2021-04-02T13:33:28.000Z"><meta property="article:modified_time" content="2021-04-02T13:33:28.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="å¾®æœåŠ¡"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2021/04/nacos-upgrade.png"><link rel="canonical" href="https://www.techgrow.cn/posts/57722de1.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/57722de1.html","path":"posts/57722de1.html","title":"Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€ | Clay çš„æŠ€æœ¯åšå®¢</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn:9360"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay çš„æŠ€æœ¯åšå®¢" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax>!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><script data-ad-client="ca-pub-4014850419768221" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/app/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt></div><div class="headband"></div><main class="main"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay çš„æŠ€æœ¯åšå®¢</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">ç”¨è¿›åºŸé€€ | è‰ºä¸å‹èº«</p></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>å‹é“¾</a></li><li class="menu-item menu-item-openplatform"><a href="https://docs.techgrow.cn/v1/" rel="external nofollow" target="_blank"><i class="fa fa-toolbox fa-fw"></i>å¼€æ”¾å¹³å°</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn:9360/ui/login?lng=zh-cn" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>è¯„è®ºç®¡ç†</a></li></ul></nav></div><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview"> ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E7%AE%80%E4%BB%8B"><span class="nav-text">Nacos ç®€ä»‹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-2-0-%E6%9E%B6%E6%9E%84"><span class="nav-text">Nacos 2.0 æ¶æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-0-%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E5%8D%87%E7%BA%A7%E4%B8%80%E8%87%B4%E6%80%A7%E6%A8%A1%E5%9E%8B"><span class="nav-text">Nacos 2.0 æœåŠ¡å‘ç°å‡çº§ä¸€è‡´æ€§æ¨¡å‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-0-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E5%8D%87%E7%BA%A7%E9%80%9A%E4%BF%A1%E6%9C%BA%E5%88%B6"><span class="nav-text">Nacos 2.0 é…ç½®ç®¡ç†å‡çº§é€šä¿¡æœºåˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-0-%E6%9E%B6%E6%9E%84%E4%BC%98%E5%8A%BF"><span class="nav-text">Nacos 2.0 æ¶æ„ä¼˜åŠ¿</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-2-0-%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87"><span class="nav-text">Nacos 2.0 æ€§èƒ½æå‡</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-0-%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E7%9A%84%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87"><span class="nav-text">Nacos 2.0 æœåŠ¡å‘ç°çš„æ€§èƒ½æå‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-0-%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86%E7%9A%84%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87"><span class="nav-text">Nacos 2.0 é…ç½®ç®¡ç†çš„æ€§èƒ½æå‡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-0-%E6%80%A7%E8%83%BD%E7%BB%93%E8%AE%BA"><span class="nav-text">Nacos 2.0 æ€§èƒ½ç»“è®º</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Nacos-%E7%94%9F%E6%80%81%E5%8F%8A-2-X-%E5%90%8E%E7%BB%AD%E8%A7%84%E5%88%92"><span class="nav-text">Nacos ç”Ÿæ€åŠ 2.X åç»­è§„åˆ’</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-%E7%94%9F%E6%80%81%E5%9C%A8%E9%98%BF%E9%87%8C%E7%9A%84%E5%AE%9E%E8%B7%B5"><span class="nav-text">Nacos ç”Ÿæ€åœ¨é˜¿é‡Œçš„å®è·µ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nacos-2-X-%E7%9A%84%E8%A7%84%E5%88%92"><span class="nav-text">Nacos 2.X çš„è§„åˆ’</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-text">æ€»ç»“</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap site-overview-item animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">371</span> <span class="site-state-item-name">æ–‡ç« </span></a></div><div class="site-state-item site-state-tags"> <a href="/tags"><span class="site-state-item-count">41</span> <span class="site-state-item-name">æ ‡ç­¾</span></a></div></nav></div><div class="links-of-author site-overview-item animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail â†’ mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS â†’ &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap â†’ &#x2F;sitemap.xml"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside><div class="sidebar-dimmer"></div></header><div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="external nofollow" target="_blank"><svg width="80" height="80" viewbox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/57722de1.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay çš„æŠ€æœ¯åšå®¢"><meta itemprop="description" content="ä¸“æ³¨äº Javaã€å‰ç«¯ã€ç§»åŠ¨ç«¯ã€å¾®æœåŠ¡ã€åˆ†å¸ƒå¼ç³»ç»Ÿã€æ•°æ®åº“ã€ç³»ç»Ÿæ¶æ„ã€äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®ã€äº‘è®¡ç®—ã€ç‰©è”ç½‘ã€è™šæ‹ŸåŒ–å­¦ä¹ çš„æŠ€æœ¯åšå®¢ã€‚"></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€ | Clay çš„æŠ€æœ¯åšå®¢"><meta itemprop="description" content="æœ¬æ–‡ä¸»è¦ä»‹ç» Nacos 2.0 çš„æ•´ä½“æ¶æ„ã€æ€§èƒ½æå‡ï¼Œä»¥åŠ Nacos çš„ç”Ÿæ€åŠ 2.X ç‰ˆæœ¬çš„åç»­è§„åˆ’ã€‚"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2021-04-02 21:33:28" itemprop="dateCreated datePublished" datetime="2021-04-02T21:33:28+08:00">2021-04-02</time></span><span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span><a title="waline" href="/posts/57722de1.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/57722de1.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>3.5k</span></span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span> <span>3 åˆ†é’Ÿ</span></span></div></div></header><div class="post-body" itemprop="articleBody"><div id="readmore-container"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç»§ Nacos 1.0 å‘å¸ƒä»¥æ¥ï¼ŒNacos è¿…é€Ÿè¢«æˆåƒä¸Šä¸‡å®¶ä¼ä¸šé‡‡ç”¨ï¼Œå¹¶æ„å»ºèµ·å¼ºå¤§çš„ç”Ÿæ€ã€‚ä½†æ˜¯éšç€ç”¨æˆ·æ·±å…¥ä½¿ç”¨ï¼Œé€æ¸æš´éœ²ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œå› æ­¤å¯åŠ¨äº† Nacos 2.0 çš„éš”ä»£äº§å“è®¾è®¡ï¼Œæ—¶éš”åŠå¹´ç»ˆäºå°†å…¶å…¨éƒ¨å®ç°ï¼Œå®æµ‹æ€§èƒ½æå‡ 10 å€ï¼Œç›¸ä¿¡èƒ½æ»¡è¶³æ‰€æœ‰ç”¨æˆ·çš„æ€§èƒ½éœ€æ±‚ã€‚</p><h2 id="Nacos-ç®€ä»‹"><a href="#Nacos-ç®€ä»‹" class="headerlink" title="Nacos ç®€ä»‹"></a>Nacos ç®€ä»‹</h2><p><a target="_blank" rel="external nofollow" href="https://nacos.io/zh-cn/">Nacos</a> æ˜¯ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚å®ƒå­µåŒ–äºé˜¿é‡Œå·´å·´ï¼Œæˆé•¿äºåå¹´åŒåä¸€çš„æ´ªå³°è€ƒéªŒï¼Œæ²‰æ·€äº†ç®€å•æ˜“ç”¨ã€ç¨³å®šå¯é ã€æ€§èƒ½å“è¶Šçš„æ ¸å¿ƒç«äº‰åŠ›ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade.png" alt="nacos-upgrade"></p><span id="more"></span><h2 id="Nacos-2-0-æ¶æ„"><a href="#Nacos-2-0-æ¶æ„" class="headerlink" title="Nacos 2.0 æ¶æ„"></a>Nacos 2.0 æ¶æ„</h2><p>2021 å¹´ 03 æœˆ 30 æ—¥ï¼ŒNacos 2.0 æ­£å¼å¯¹å¤–å‘å¸ƒã€‚å…¨æ–°çš„ 2.0 æ¶æ„ä¸ä»…å°†æ€§èƒ½å¤§å¹…æå‡ 10 å€ï¼Œè€Œä¸”å†…æ ¸è¿›è¡Œäº†åˆ†å±‚æŠ½è±¡ï¼Œå¹¶ä¸”å®ç°æ’ä»¶æ‰©å±•æœºåˆ¶ã€‚Nacos 2.0 æ¶æ„å±‚æ¬¡å¦‚ä¸‹å›¾ï¼Œå®ƒç›¸æ¯” Nacos 1.X çš„æœ€ä¸»è¦å˜åŒ–æ˜¯ï¼š</p><ul><li>é€šä¿¡å±‚ç»Ÿä¸€åˆ° <code>gRPC</code> åè®®ï¼ŒåŒæ—¶å®Œå–„äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„æµé‡æ§åˆ¶å’Œè´Ÿè½½å‡è¡¡èƒ½åŠ›ï¼Œæå‡çš„æ•´ä½“ååã€‚</li><li>å°†å­˜å‚¨å’Œä¸€è‡´æ€§æ¨¡å‹åšäº†å……åˆ†æŠ½è±¡åˆ†å±‚ï¼Œæ¶æ„æ›´ç®€å•æ¸…æ™°ï¼Œä»£ç æ›´åŠ å¥å£®ï¼Œæ€§èƒ½æ›´åŠ å¼ºæ‚ã€‚</li><li>è®¾è®¡äº†å¯æ‹“å±•çš„æ¥å£ï¼Œæå‡äº†é›†æˆèƒ½åŠ›ï¼Œå¦‚è®©ç”¨æˆ·æ‰©å±•å®ç°å„è‡ªçš„å®‰å…¨æœºåˆ¶ã€‚</li></ul><p><img data-src="../../../asset/2021/04/nacos-upgrade-1.png" alt="nacos-upgrade-1"></p><h3 id="Nacos-2-0-æœåŠ¡å‘ç°å‡çº§ä¸€è‡´æ€§æ¨¡å‹"><a href="#Nacos-2-0-æœåŠ¡å‘ç°å‡çº§ä¸€è‡´æ€§æ¨¡å‹" class="headerlink" title="Nacos 2.0 æœåŠ¡å‘ç°å‡çº§ä¸€è‡´æ€§æ¨¡å‹"></a>Nacos 2.0 æœåŠ¡å‘ç°å‡çº§ä¸€è‡´æ€§æ¨¡å‹</h3><p>Nacos 2.0&nbsp;æ¶æ„ä¸‹çš„æœåŠ¡å‘ç°ï¼Œå®¢æˆ·ç«¯é€šè¿‡ gRPCï¼Œå‘èµ·æ³¨å†ŒæœåŠ¡æˆ–è®¢é˜…æœåŠ¡çš„è¯·æ±‚ã€‚æœåŠ¡ç«¯ä½¿ç”¨ Client å¯¹è±¡æ¥è®°å½•è¯¥å®¢æˆ·ç«¯ä½¿ç”¨ gRPC è¿æ¥å‘å¸ƒäº†å“ªäº›æœåŠ¡ï¼Œåˆè®¢é˜…äº†å“ªäº›æœåŠ¡ï¼Œå¹¶å°†è¯¥ Client è¿›è¡ŒæœåŠ¡é—´åŒæ­¥ã€‚ç”±äºå®é™…çš„ä½¿ç”¨ä¹ æƒ¯æ˜¯æœåŠ¡åˆ°å®¢æˆ·ç«¯çš„æ˜ å°„ï¼Œå³æœåŠ¡ä¸‹æœ‰å“ªäº›å®¢æˆ·ç«¯å®ä¾‹ï¼›å› æ­¤ 2.0 çš„æœåŠ¡ç«¯ä¼šé€šè¿‡æ„å»ºç´¢å¼•å’Œå…ƒæ•°æ®ï¼Œå¿«é€Ÿç”Ÿæˆç±»ä¼¼ 1.X ä¸­çš„ Service ä¿¡æ¯ï¼Œå¹¶å°† Service çš„æ•°æ®é€šè¿‡ &nbsp;gRPC Stream è¿›è¡Œæ¨é€ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-2.png" alt="nacos-upgrade-2"></p><h3 id="Nacos-2-0-é…ç½®ç®¡ç†å‡çº§é€šä¿¡æœºåˆ¶"><a href="#Nacos-2-0-é…ç½®ç®¡ç†å‡çº§é€šä¿¡æœºåˆ¶" class="headerlink" title="Nacos 2.0 é…ç½®ç®¡ç†å‡çº§é€šä¿¡æœºåˆ¶"></a>Nacos 2.0 é…ç½®ç®¡ç†å‡çº§é€šä¿¡æœºåˆ¶</h3><p>é…ç½®ç®¡ç†ä¹‹å‰ç”¨ Http1.1 çš„ Keep Alive æ¨¡å¼ 30s å‘ä¸€ä¸ªå¿ƒè·³æ¨¡æ‹Ÿé•¿é“¾æ¥ï¼Œåè®®éš¾ä»¥ç†è§£ï¼Œå†…å­˜æ¶ˆè€—å¤§ï¼Œæ¨é€æ€§èƒ½å¼±ï¼Œå› æ­¤ 2.0 é€šè¿‡ gRPC å½»åº•è§£å†³è¿™äº›é—®é¢˜ï¼Œå†…å­˜æ¶ˆè€—å¤§é‡é™ä½ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-3.png" alt="nacos-upgrade-3"></p><h3 id="Nacos-2-0-æ¶æ„ä¼˜åŠ¿"><a href="#Nacos-2-0-æ¶æ„ä¼˜åŠ¿" class="headerlink" title="Nacos 2.0 æ¶æ„ä¼˜åŠ¿"></a>Nacos 2.0 æ¶æ„ä¼˜åŠ¿</h3><p> Nacos 2.0 å¤§å¹…é™ä½äº†èµ„æºæ¶ˆè€—ï¼Œæå‡ååæ€§èƒ½ï¼Œä¼˜åŒ–å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯äº¤äº’ï¼Œå¯¹ç”¨æˆ·æ›´åŠ å‹å¥½ï¼›è™½ç„¶å¯è§‚æµ‹æ€§ç•¥å¾®ä¸‹é™ï¼Œä½†æ˜¯æ•´ä½“æ€§ä»·æ¯”éå¸¸é«˜ã€‚</p><p> <img data-src="../../../asset/2021/04/nacos-upgrade-4.png" alt="nacos-upgrade-4"></p><h2 id="Nacos-2-0-æ€§èƒ½æå‡"><a href="#Nacos-2-0-æ€§èƒ½æå‡" class="headerlink" title="Nacos 2.0 æ€§èƒ½æå‡"></a>Nacos 2.0 æ€§èƒ½æå‡</h2><p>ç”±äº Nacos ç”±æœåŠ¡å‘ç°å’Œé…ç½®ç®¡ç†ä¸¤å¤§æ¨¡å—æ„æˆï¼Œä¸šåŠ¡æ¨¡å‹ç•¥æœ‰å·®å¼‚ï¼Œå› æ­¤ä¸‹é¢åˆ†åˆ«ä»‹ç»ä¸€ä¸‹å…·ä½“å‹æµ‹æŒ‡æ ‡ã€‚</p><h3 id="Nacos-2-0-æœåŠ¡å‘ç°çš„æ€§èƒ½æå‡"><a href="#Nacos-2-0-æœåŠ¡å‘ç°çš„æ€§èƒ½æå‡" class="headerlink" title="Nacos 2.0 æœåŠ¡å‘ç°çš„æ€§èƒ½æå‡"></a>Nacos 2.0 æœåŠ¡å‘ç°çš„æ€§èƒ½æå‡</h3><p>æœåŠ¡å‘ç°åœºæ™¯ä¸»è¦å…³æ³¨å®¢æˆ·ç«¯æ•°ï¼ŒæœåŠ¡æ•°å®ä¾‹æ•°ï¼ŒåŠæœåŠ¡è®¢é˜…è€…æ•°åœ¨å¤§è§„æ¨¡åœºæ™¯ä¸‹ï¼ŒæœåŠ¡ç«¯åœ¨åŒæ­¥ï¼Œæ¨é€åŠç¨³å®šçŠ¶æ€æ—¶çš„æ€§èƒ½è¡¨ç°ã€‚åŒæ—¶è¿˜å…³æ³¨åœ¨æœ‰å¤§é‡æœåŠ¡åœ¨è¿›è¡Œä¸Šä¸‹çº¿æ—¶ï¼Œç³»ç»Ÿçš„æ€§èƒ½è¡¨ç°ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-5.png" alt="nacos-upgrade-5"></p><ul><li>å®¹é‡åŠç¨³å®šçŠ¶æ€æµ‹è¯•</li></ul><p>è¯¥åœºæ™¯ä¸»è¦å…³æ³¨éšç€æœåŠ¡è§„æ¨¡å’Œå®¢æˆ·ç«¯å®ä¾‹è§„æ¨¡ä¸Šæ¶¨ï¼Œç³»ç»Ÿæ€§èƒ½è¡¨ç°ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-6.png" alt="nacos-upgrade-6"></p><p>å¯ä»¥çœ‹åˆ° 2.0.0 ç‰ˆæœ¬åœ¨ 10W çº§å®¢æˆ·ç«¯è§„æ¨¡ä¸‹ï¼Œèƒ½å¤Ÿç¨³å®šçš„æ”¯æ’‘ï¼Œåœ¨è¾¾åˆ°ç¨³å®šçŠ¶æ€åï¼ŒCPU çš„æŸè€—éå¸¸ä½ã€‚è™½ç„¶åœ¨æœ€åˆçš„å¤§é‡æ³¨å†Œé˜¶æ®µï¼Œç”±äºå­˜åœ¨ç¬æ—¶çš„å¤§é‡æ³¨å†Œå’Œæ¨é€ï¼Œå› æ­¤æœ‰ä¸€å®šçš„æ¨é€è¶…æ—¶ï¼Œä½†æ˜¯ä¼šåœ¨é‡è¯•åæ¨é€æˆåŠŸï¼Œä¸ä¼šå½±å“æ•°æ®ä¸€è‡´æ€§ã€‚åè§‚ 1.X ç‰ˆæœ¬ï¼Œåœ¨ 10Wã€5W çº§å®¢æˆ·ç«¯ä¸‹ï¼ŒæœåŠ¡ç«¯å®Œå…¨å¤„äº Full GC çŠ¶æ€ï¼Œæ¨é€å®Œå…¨å¤±è´¥ï¼Œé›†ç¾¤ä¸å¯ç”¨ï¼›åœ¨ 2W å®¢æˆ·ç«¯è§„æ¨¡ä¸‹ï¼Œè™½ç„¶æœåŠ¡ç«¯è¿è¡ŒçŠ¶æ€æ­£å¸¸ï¼Œä½†ç”±äºå¿ƒè·³å¤„ç†ä¸åŠæ—¶ï¼Œå¤§é‡æœåŠ¡åœ¨æ‘˜é™¤å’Œæ³¨å†Œé˜¶æ®µåå¤è¿›è¡Œï¼Œå› æ­¤è¾¾ä¸åˆ°ç¨³å®šçŠ¶æ€ï¼ŒCPU ä¸€ç›´å¾ˆé«˜ã€‚1.2W å®¢æˆ·ç«¯è§„æ¨¡ä¸‹ï¼Œå¯ä»¥ç¨³å®šè¿è¡Œï¼Œä½†ç¨³æ€æ—¶ CPU æ¶ˆè€—æ˜¯æ›´å¤§è§„æ¨¡ä¸‹ 2.0 çš„ 3 å€ä»¥ä¸Šã€‚</p><ul><li>é¢‘ç¹å˜æ›´æµ‹è¯•</li></ul><p>è¯¥åœºæ™¯ä¸»è¦å…³æ³¨ä¸šåŠ¡å¤§è§„æ¨¡å‘å¸ƒï¼ŒæœåŠ¡é¢‘ç¹æ¨é€æ¡ä»¶ä¸‹ï¼Œä¸åŒç‰ˆæœ¬çš„ååå’Œå¤±è´¥ç‡ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-7.png" alt="nacos-upgrade-7"></p><p>é¢‘ç¹å˜æ›´æ—¶ï¼Œ2.0 å’Œ 1.X åœ¨è¾¾åˆ°ç¨³å®šçŠ¶æ€åï¼Œå‡èƒ½ç¨³å®šæ”¯æ’‘ï¼Œå…¶ä¸­ 2.0 ç”±äºä¸å†æœ‰ç¬æ—¶çš„æ¨é€é£æš´ï¼Œå› æ­¤æ¨é€å¤±è´¥ç‡å½’ 0ï¼Œè€Œ 1.X çš„ UDP æ¨é€çš„ä¸ç¨³å®šæ€§å¯¼è‡´äº†æœ‰æå°éƒ¨åˆ†æ¨é€å‡ºç°äº†è¶…æ—¶ï¼Œéœ€è¦é‡è¯•æ¨é€ã€‚</p><h3 id="Nacos-2-0-é…ç½®ç®¡ç†çš„æ€§èƒ½æå‡"><a href="#Nacos-2-0-é…ç½®ç®¡ç†çš„æ€§èƒ½æå‡" class="headerlink" title="Nacos 2.0 é…ç½®ç®¡ç†çš„æ€§èƒ½æå‡"></a>Nacos 2.0 é…ç½®ç®¡ç†çš„æ€§èƒ½æå‡</h3><p>ç”±äºé…ç½®æ˜¯å°‘å†™å¤šè¯»åœºæ™¯ï¼Œæ‰€ä»¥ç“¶é¢ˆä¸»è¦åœ¨å•å°ç›‘å¬çš„å®¢æˆ·ç«¯æ•°é‡ä»¥åŠé…ç½®çš„æ¨é€è·å–ä¸Šï¼Œå› æ­¤é…ç½®ç®¡ç†çš„å‹æµ‹æ€§èƒ½ä¸»è¦é›†ä¸­äºå•å°æœåŠ¡ç«¯çš„è¿æ¥å®¹é‡ä»¥åŠå¤§é‡æ¨é€çš„æ¯”è¾ƒã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-8.png" alt="nacos-upgrade-8"></p><ul><li>Nacos 2.0 è¿æ¥å®¹é‡æµ‹è¯•</li></ul><p>è¯¥åœºæ™¯ä¸»è¦å…³æ³¨ä¸åŒå®¢æˆ·ç«¯è§„æ¨¡ä¸‹çš„ç³»ç»Ÿå‹åŠ›ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-9.png" alt="nacos-upgrade-9"></p><p>Nacos 2.0 æœ€é«˜å•æœºèƒ½å¤Ÿæ”¯æ’‘ 4.2w ä¸ªé…ç½®å®¢æˆ·ç«¯è¿æ¥ï¼Œåœ¨è¿æ¥å»ºç«‹çš„é˜¶æ®µï¼Œæœ‰å¤§é‡è®¢é˜…è¯·æ±‚éœ€è¦å¤„ç†ï¼Œå› æ­¤ CPU æ¶ˆè€—è¾ƒé«˜ï¼Œä½†è¾¾åˆ°ç¨³æ€åï¼ŒCPU çš„æ¶ˆè€—ä¼šå˜å¾—å¾ˆä½ï¼Œå‡ ä¹æ²¡æœ‰æ¶ˆè€—ã€‚åè§‚ Nacos 1.Xï¼Œåœ¨å®¢æˆ·ç«¯ 6000 æ—¶ï¼Œç¨³å®šçŠ¶æ€çš„ CPU ä¸€ç›´å¾ˆé«˜ï¼Œä¸” GC é¢‘ç¹ï¼Œä¸»è¦åŸå› æ˜¯é•¿è½®è®­æ˜¯é€šè¿‡ hold è¯·æ±‚æ¥ä¿æŒè¿æ¥ï¼Œæ¯ 30s éœ€è¦å›ä¸€æ¬¡ Response å¹¶ä¸”é‡æ–°å‘èµ·è¿æ¥å’Œè¯·æ±‚ã€‚éœ€è¦åšå¤§é‡çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ŒåŒæ—¶è¿˜éœ€è¦æŒæœ‰æ‰€æœ‰ Request å’Œ Responseã€‚å½“è§„æ¨¡è¾¾åˆ° 1.2w å®¢æˆ·ç«¯æ—¶ï¼Œå·²ç»æ— æ³•è¾¾åˆ°ç¨³æ€ï¼Œæ‰€ä»¥æ— æ³•æ”¯æ’‘è¿™ä¸ªé‡çº§çš„å®¢æˆ·ç«¯æ•°ã€‚</p><ul><li>Nacos 2.0 é¢‘ç¹æ¨é€æµ‹è¯•</li></ul><p>è¯¥åœºæ™¯å…³æ³¨ä¸åŒæ¨é€è§„æ¨¡ä¸‹çš„ç³»ç»Ÿè¡¨ç°ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-10.png" alt="nacos-upgrade-10"></p><p>åœ¨é¢‘ç¹å˜æ›´çš„åœºæ™¯ï¼Œä¸¤ä¸ªç‰ˆæœ¬éƒ½å¤„äº 6000 ä¸ªå®¢æˆ·ç«¯è¿æ¥ä¸­ã€‚æ˜æ˜¾å¯ä»¥å‘ç° 2.0 ç‰ˆæœ¬çš„æ€§èƒ½æŸè€—è¦è¿œä½äº 1.X ç‰ˆæœ¬ã€‚åœ¨ 3000tps çš„æ¨é€åœºæ™¯ä¸‹ï¼Œä¼˜åŒ–ç¨‹åº¦çº¦ä¼˜åŒ–äº† 3 å€ã€‚</p><h3 id="Nacos-2-0-æ€§èƒ½ç»“è®º"><a href="#Nacos-2-0-æ€§èƒ½ç»“è®º" class="headerlink" title="Nacos 2.0 æ€§èƒ½ç»“è®º"></a>Nacos 2.0 æ€§èƒ½ç»“è®º</h3><ul><li>é’ˆå¯¹æœåŠ¡å‘ç°åœºæ™¯ï¼ŒNacos 2.0 èƒ½å¤Ÿåœ¨ 10W çº§è§„æ¨¡ä¸‹ï¼Œç¨³å®šè¿è¡Œï¼›ç›¸æ¯” Nacos 1.X ç‰ˆæœ¬çš„ 1.2W è§„æ¨¡ï¼Œæå‡çº¦ 10 å€ã€‚</li><li>é’ˆå¯¹é…ç½®ç®¡ç†åœºæ™¯ï¼ŒNacos 2.0 å•æœºæœ€é«˜èƒ½å¤Ÿæ”¯æ’‘ 4.2W ä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼›ç›¸æ¯” Nacos 1.Xï¼Œæå‡äº† 7 å€ï¼Œä¸”æ¨é€æ—¶çš„æ€§èƒ½æ˜æ˜¾å¥½äº 1.Xã€‚</li></ul><p><img data-src="../../../asset/2021/04/nacos-upgrade-11.png" alt="nacos-upgrade-11"></p><h2 id="Nacos-ç”Ÿæ€åŠ-2-X-åç»­è§„åˆ’"><a href="#Nacos-ç”Ÿæ€åŠ-2-X-åç»­è§„åˆ’" class="headerlink" title="Nacos ç”Ÿæ€åŠ 2.X åç»­è§„åˆ’"></a>Nacos ç”Ÿæ€åŠ 2.X åç»­è§„åˆ’</h2><p>éšç€ Nacos ä¸‰å¹´çš„å‘å±•ï¼Œå‡ ä¹æ”¯æŒäº†æ‰€æœ‰çš„ RPC æ¡†æ¶å’Œå¾®æœåŠ¡ç”Ÿæ€ï¼Œå¹¶ä¸”å¼•é¢†äº‘åŸç”Ÿå¾®æœåŠ¡ç”Ÿæ€å‘å±•ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-12.png" alt="nacos-upgrade-12"></p><p>Nacos æ˜¯æ•´ä¸ªå¾®æœåŠ¡ç”Ÿæ€ä¸­éå¸¸æ ¸å¿ƒçš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥æ— ç¼å’Œ K8s æœåŠ¡å‘ç°ä½“ç³»äº’é€šï¼Œé€šè¿‡ MCP/XDS åè®®ä¸ Istio é€šä¿¡ï¼Œå°† Nacos æœåŠ¡ä¸‹å‘ Sidecarï¼›åŒæ ·ä¹Ÿå¯ä»¥å’Œ CoreDNS è”åˆï¼Œå°† Nacos æœåŠ¡é€šè¿‡åŸŸåæ¨¡å¼æš´éœ²ç»™ä¸‹æ¸¸è°ƒç”¨ã€‚Nacos ç›®å‰å·²ç»å’Œå„ç±»å¾®æœåŠ¡ RPC æ¡†æ¶èåˆè¿›è¡ŒæœåŠ¡å‘ç°ï¼›å¦å¤–å¯ä»¥ååŠ©é«˜å¯ç”¨æ¡†æ¶ Sentinel è¿›è¡Œå„ç±»ç®¡ç†è§„åˆ™çš„æ§åˆ¶å’Œä¸‹å‘ã€‚</p><p>å¦‚æœåªä½¿ç”¨ RPC æ¡†æ¶ï¼Œæœ‰æ—¶å€™å¹¶ä¸è¶³å¤Ÿç®€å•ï¼Œå› ä¸ºéƒ¨åˆ† RPC æ¡†æ¶æ¯”å¦‚ gRPC å’Œ Thriftï¼Œè¿˜éœ€è¦è‡ªè¡Œå¯åŠ¨ Server å¹¶å‘ŠçŸ¥ Client è¯¥è°ƒç”¨å“ªä¸ª IPã€‚è¿™æ—¶å€™å°±éœ€è¦å’Œåº”ç”¨æ¡†æ¶è¿›è¡Œèåˆï¼Œæ¯”å¦‚ SCAã€Dapr ç­‰ï¼›å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ Envoy Sidecar æ¥è¿›è¡Œæµé‡æ§åˆ¶ï¼Œåº”ç”¨å±‚çš„ RPC å°±ä¸éœ€è¦çŸ¥é“æœåŠ¡ çš„ IP åˆ—è¡¨äº†ã€‚æœ€åï¼ŒNacos è¿˜å¯ä»¥å’Œå„ç±»å¾®æœåŠ¡ç½‘å…³æ‰“é€šï¼Œå®ç°æ¥å…¥å±‚çš„åˆ†å‘å’Œå¾®æœåŠ¡è°ƒç”¨ã€‚</p><h3 id="Nacos-ç”Ÿæ€åœ¨é˜¿é‡Œçš„å®è·µ"><a href="#Nacos-ç”Ÿæ€åœ¨é˜¿é‡Œçš„å®è·µ" class="headerlink" title="Nacos ç”Ÿæ€åœ¨é˜¿é‡Œçš„å®è·µ"></a>Nacos ç”Ÿæ€åœ¨é˜¿é‡Œçš„å®è·µ</h3><p>ç›®å‰ Nacos å·²ç»å®Œæˆäº†è‡ªç ”ã€å¼€æºã€å•†ä¸šåŒ–ä¸‰ä½ä¸€ä½“çš„å»ºè®¾ï¼Œé˜¿é‡Œå†…éƒ¨çš„é’‰é’‰ã€è€ƒæ‹‰ã€é¥¿äº†ä¹ˆã€ä¼˜é…·ç­‰ä¸šåŠ¡åŸŸå·²ç»å…¨éƒ¨é‡‡ç”¨äº‘äº§å“ MSE ä¸­çš„ Nacos æœåŠ¡ï¼Œå¹¶ä¸”ä¸é˜¿é‡Œå’Œäº‘åŸç”Ÿçš„æŠ€æœ¯æ ˆæ— ç¼æ•´åˆã€‚ä¸‹é¢ä»¥é’‰é’‰ä¸ºä¾‹ç®€å•åšä¸€ä¸‹ä»‹ç»ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-13.png" alt="nacos-upgrade-13"></p><p>Nacos è¿è¡Œåœ¨å¾®æœåŠ¡å¼•æ“ MSEï¼ˆå…¨æ‰˜ç®¡çš„ Nacos é›†ç¾¤ï¼‰ä¸Šï¼Œè¿›è¡Œç»´æŠ¤å’Œå¤šé›†ç¾¤ç®¡ç†ï¼›ä¸šåŠ¡çš„å„ç±» Dubbo3 æˆ– HSF æœåŠ¡åœ¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡ Dubbo3 è‡ªèº«æ³¨å†Œåˆ° Nacos é›†ç¾¤ä¸­ï¼›ç„¶å Nacos é€šè¿‡ MCP åè®®å°†æœåŠ¡ä¿¡æ¯åŒæ­¥åˆ° Istio å’Œ Ingress-Envoy ç½‘å…³ã€‚</p><p>ç”¨æˆ·æµé‡ä»åŒ—å‘è¿›å…¥é›†å›¢çš„ VPC ç½‘ç»œä¸­ï¼Œå…ˆé€šè¿‡ä¸€ä¸ªç»Ÿä¸€æ¥å…¥ Ingress-Tengine ç½‘å…³ï¼Œä»–å¯ä»¥å°†åŸŸåè§£æå¹¶è·¯ç”±åˆ°ä¸åŒçš„æœºæˆ¿ã€å•å…ƒç­‰ã€‚æœ¬å‘¨ä¹ŸåŒæ­¥æ›´æ–°äº† Tengine 2.3.3 ç‰ˆæœ¬ï¼Œå†…æ ¸å‡çº§åˆ° Nginx Core 1.18.0 ï¼Œæ”¯æŒ Dubbo åè®® ï¼Œæ”¯æŒ DTLSv1 å’Œ DTLSv1.2ï¼Œæ”¯æŒ Prometheus æ ¼å¼ï¼Œä»è€Œæå‡é˜¿é‡Œäº‘å¾®æœåŠ¡ç”Ÿæ€å®Œæ•´æ€§ã€å®‰å…¨æ€§ã€å¯è§‚æµ‹æ€§ã€‚</p><p>é€šè¿‡ç»Ÿä¸€æ¥å…¥å±‚ç½‘å…³åï¼Œç”¨æˆ·è¯·æ±‚ä¼šé€šè¿‡ Ingress-Envoy å¾®æœåŠ¡ç½‘å…³ï¼Œè½¬å‘åˆ°å¯¹åº”çš„å¾®æœåŠ¡ä¸­ï¼Œå¹¶è¿›è¡Œè°ƒç”¨ã€‚å¦‚æœéœ€è¦è°ƒç”¨åˆ°å…¶ä»–ç½‘ç»œåŸŸçš„æœåŠ¡ï¼Œä¼šé€šè¿‡ Ingress-Envoy å¾®æœåŠ¡ç½‘å…³å°†æµé‡å¯¼å…¥åˆ°å¯¹åº”çš„ VPC ç½‘ç»œä¸­ï¼Œä»è€Œæ‰“é€šä¸åŒå®‰å…¨åŸŸã€ç½‘ç»œåŸŸå’Œä¸šåŠ¡åŸŸçš„æœåŠ¡ã€‚</p><p>å¾®æœåŠ¡ä¹‹é—´çš„ç›¸äº’è°ƒç”¨ï¼Œä¼šé€šè¿‡ Envoy Sidecar æˆ–ä¼ ç»Ÿçš„å¾®æœåŠ¡è‡ªè®¢é˜…çš„æ–¹å¼è¿›è¡Œã€‚æœ€ç»ˆï¼Œç”¨æˆ·è¯·æ±‚åœ¨å„ä¸ªå¾®æœåŠ¡çš„äº’ç›¸è°ƒç”¨ä¸­ï¼Œå®Œæˆåå¹¶è¿”å›ç»™ç”¨æˆ·ã€‚</p><h3 id="Nacos-2-X-çš„è§„åˆ’"><a href="#Nacos-2-X-çš„è§„åˆ’" class="headerlink" title="Nacos 2.X çš„è§„åˆ’"></a>Nacos 2.X çš„è§„åˆ’</h3><p>Nacos 2.X å°†åœ¨ 2.0 è§£å†³æ€§èƒ½é—®é¢˜çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡æ’ä»¶åŒ–å®ç°æ–°çš„åŠŸèƒ½å¹¶æ”¹é€ å¤§é‡æ—§åŠŸèƒ½ï¼Œä½¿å¾— Nacos èƒ½å¤Ÿæ›´æ–¹ä¾¿ï¼Œæ›´æ˜“äºæ‹“å±•ã€‚</p><p><img data-src="../../../asset/2021/04/nacos-upgrade-14.png" alt="nacos-upgrade-14"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>Nacos 2.0 ä½œä¸ºä¸€ä¸ªè·¨ä»£ç‰ˆæœ¬ï¼Œå½»åº•è§£å†³äº† Nacos 1.X çš„æ€§èƒ½é—®é¢˜ï¼Œå°†æ€§èƒ½æå‡äº† 10 å€ã€‚å¹¶ä¸”é€šè¿‡æŠ½è±¡å’Œåˆ†å±‚è®©æ¶æ„æ›´åŠ ç®€å•ï¼Œé€šè¿‡æ’ä»¶åŒ–æ›´å¥½çš„æ‰©å±•ï¼Œè®© Nacos èƒ½å¤Ÿæ”¯æŒæ›´å¤šåœºæ™¯ï¼Œèåˆæ›´å¹¿ç”Ÿæ€ã€‚ç›¸ä¿¡ Nacos2.X åœ¨åç»­ç‰ˆæœ¬è¿­ä»£åï¼Œä¼šæ›´åŠ æ˜“ç”¨ï¼Œè§£å†³æ›´å¤šå¾®æœåŠ¡é—®é¢˜ï¼Œå¹¶å‘ç€ Mesh åŒ–è¿›è¡Œæ›´æ·±å…¥åœ°æ¢ç´¢ã€‚</p><ul><li>Nacosï¼š<a target="_blank" rel="external nofollow" href="https://nacos.io/zh-cn">https://nacos.io/zh-cn</a></li><li>Nacos Githubï¼š<a target="_blank" rel="external nofollow" href="https://github.com/alibaba/nacos">https://github.com/alibaba/nacos</a></li></ul></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script>var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i);if(!isMobile)try{var plugin=new ReadmorePlugin;plugin.init({id:"readmore-container",blogId:"96641-5333172926158-056",name:"å…¨æ ˆæŠ€æœ¯é©¿ç«™",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",lockToc:"yes",type:"hexo",random:"0.9",interval:"30",expires:"365",height:"auto"})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>åšæŒåŸåˆ›æŠ€æœ¯åˆ†äº«ï¼Œæ‚¨çš„æ”¯æŒå°†é¼“åŠ±æˆ‘ç»§ç»­åˆ›ä½œï¼</div> <button> èµèµ</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay å¾®ä¿¡"> <span>å¾®ä¿¡</span></div><div> <img src="/img/pay_zfb.png" alt="Clay æ”¯ä»˜å®"> <span>æ”¯ä»˜å®</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Clay</li><li class="post-copyright-link"> <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://www.techgrow.cn/posts/57722de1.html" title="Nacos 2.0 å‘å¸ƒï¼Œæ€§èƒ½æå‡ 10 å€">https://www.techgrow.cn/posts/57722de1.html</a></li><li class="post-copyright-license"> <strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">æ¬¢è¿åŠ å…¥å¾®ä¿¡ç¾¤</span><br> <img src="/img/wx-group-qr-technology.png"></div></div></div><div class="post-tags"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag"><i class="fa fa-tag"></i> å¾®æœåŠ¡</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/fef9e726.html" rel="prev" title="Hexo Next ä¸»é¢˜è¯¦ç»†é…ç½®ä¹‹äºŒ"><i class="fa fa-chevron-left"></i> Hexo Next ä¸»é¢˜è¯¦ç»†é…ç½®ä¹‹äºŒ</a></div><div class="post-nav-item"> <a href="/posts/4da97727.html" rel="next" title="Docker åŸºäº Gitolite æ­å»º Git æœåŠ¡å™¨">Docker åŸºäº Gitolite æ­å»º Git æœåŠ¡å™¨<i class="fa fa-chevron-right"></i></a></div></div><div style="text-align:center"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-4014850419768221" data-ad-slot="7586134725" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright &copy; 2018 â€“ <span itemprop="copyrightYear">2022</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">723k</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">10:57</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" å¹´ "+s+" æ—¥ "+d+" å°æ—¶ "+l+" åˆ†é’Ÿ "+u+" ç§’ "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="æ€»è®¿å®¢é‡"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="æ€»è®¿é—®é‡"><span id="busuanzi_value_site_pv"></span></span></span></div><div class="beian"> <span><img src="/img/gonganbeian.png" alt></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">ç²¤ICPå¤‡19024664å·</a></span></div></div></footer><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-3NkoLDrmHLTYj7csHIZSr0MHAFTXth7Ua/DDt4MRUAg=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-tu9j5pBilBQrWSDePOOajCUdz6hWsid/lBNzK4KgEPM="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"/lib/mermaid/dist/mermaid.min.js","integrity":"sha256-TIYL00Rhw/8WaoUhYTLX9SKIEFdXxg+yMWSLVUbhiLg="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://unpkg.com/qiniu-js@3.3.1/dist/qiniu.min.js"></script><script>
    var qiniu_domain = "https://qiniu.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/app/api/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œéæ³•è¯·æ±‚æ¥æºï¼");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œä¸Šä¼ è¿‡äºé¢‘ç¹ï¼");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œç³»ç»Ÿå†…éƒ¨å‡ºé”™ï¼");
        } else {
          alert("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼ŒæœªçŸ¥Httpå“åº”çŠ¶æ€ç ï¼");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼ŒæœªçŸ¥é”™è¯¯ï¼");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn:9360","cssUrl":"https://unpkg.com/@waline/client@2.5.1/dist/waline.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://unpkg.com/@waline/client@2.5.1/dist/waline.js","locale":{"placeholder":"æ”¯æŒåŒ¿åè¯„è®ºå•¦ï¼Œè‹¥å¸Œæœ›åŠæ—¶æ”¶åˆ°åšä¸»çš„åé¦ˆï¼Œå»ºè®®ç™»å½•è¯„è®ºæˆ–è€…åœ¨ä¸Šæ–¹çš„é‚®ç®±è¾“å…¥æ¡†ç•™ä¸‹é‚®ç®±åœ°å€å“¦ (à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§"},"dark":"body.darkmode--activated","emoji":["https://unpkg.com/@waline/emojis@1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://qiniu.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/app/api/qiniu/token/upload","el":"#waline","comment":true,"path":"/posts/57722de1.html"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@2.5.1/dist/waline.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>