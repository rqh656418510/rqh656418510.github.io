<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><meta name="description" content="本文主要介绍 ElasticSearch 的入门教程，包括 ElasticSearch 的介绍、基础检索操作等。"><meta property="og:type" content="article"><meta property="og:title" content="ElasticSearch 入门教程 - 基础篇之一"><meta property="og:url" content="https://www.techgrow.cn/posts/5ab118a5.html"><meta property="og:site_name" content="Clay 的技术空间"><meta property="og:description" content="本文主要介绍 ElasticSearch 的入门教程，包括 ElasticSearch 的介绍、基础检索操作等。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2019/07/elasticsearch-architecture.png"><meta property="article:published_time" content="2019-07-23T12:23:21.000Z"><meta property="article:modified_time" content="2022-12-08T12:23:21.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="搜索引擎"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2019/07/elasticsearch-architecture.png"><link rel="canonical" href="https://www.techgrow.cn/posts/5ab118a5.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/5ab118a5.html","path":"posts/5ab118a5.html","title":"ElasticSearch 入门教程 - 基础篇之一"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>ElasticSearch 入门教程 - 基础篇之一 | Clay 的技术空间</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay 的技术空间" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay 的技术空间</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">用进废退 | 艺不压身</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>搜索</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>读书笔记</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>评论管理</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E7%BA%B2"><span class="nav-text">大纲</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E"><span class="nav-text">版本说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ElasticSearch-%E4%BB%8B%E7%BB%8D"><span class="nav-text">ElasticSearch 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ElasticSearch-%E6%A6%82%E8%BF%B0"><span class="nav-text">ElasticSearch 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ElasticSearch-%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="nav-text">ElasticSearch 基础概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ElasticSearch-%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84"><span class="nav-text">ElasticSearch 基本架构</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ElasticSearch-%E5%9F%BA%E7%A1%80%E6%A3%80%E7%B4%A2%E6%93%8D%E4%BD%9C"><span class="nav-text">ElasticSearch 基础检索操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E6%A3%80%E7%B4%A2%E6%93%8D%E4%BD%9C"><span class="nav-text">节点检索操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%96%B0%E5%A2%9E%E6%93%8D%E4%BD%9C"><span class="nav-text">数据新增操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2%E6%93%8D%E4%BD%9C"><span class="nav-text">数据查询操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E6%93%8D%E4%BD%9C"><span class="nav-text">数据更新操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F"><span class="nav-text">第一种更新方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F"><span class="nav-text">第二种更新方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F"><span class="nav-text">第三种更新方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E7%A7%8D%E6%9B%B4%E6%96%B0%E6%96%B9%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">三种更新方式的使用场景</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C"><span class="nav-text">数据删除操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bulk-%E6%89%B9%E9%87%8F-API"><span class="nav-text">Bulk 批量 API</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F"><span class="nav-text">语法格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E6%96%B0%E5%A2%9E%E6%93%8D%E4%BD%9C%E7%9A%84%E6%A1%88%E4%BE%8B"><span class="nav-text">批量新增操作的案例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%B9%E9%87%8F%E5%A4%8D%E6%9D%82%E6%93%8D%E4%BD%9C%E7%9A%84%E6%A1%88%E4%BE%8B"><span class="nav-text">批量复杂操作的案例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ElasticSearch-%E6%96%87%E6%A1%A3%E8%B5%84%E6%BA%90"><span class="nav-text">ElasticSearch 文档资源</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">747</span> <span class="site-state-item-name">文章</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">53</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub → https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail → mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap → /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/5ab118a5.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay 的技术空间"><meta itemprop="description" content="专注于 Java 后端、分布式、微服务、云原生、数据库、系统架构、大数据、云计算、虚拟化、人工智能学习的技术博客。"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="ElasticSearch 入门教程 - 基础篇之一 | Clay 的技术空间"><meta itemprop="description" content="本文主要介绍 ElasticSearch 的入门教程，包括 ElasticSearch 的介绍、基础检索操作等。"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> ElasticSearch 入门教程 - 基础篇之一</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2019-07-23 20:23:21" itemprop="dateCreated datePublished" datetime="2019-07-23T20:23:21+08:00">2019-07-23</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-12-08 20:23:21" itemprop="dateModified" datetime="2022-12-08T20:23:21+08:00">2022-12-08</time></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">评论数：</span><a title="waline" href="/posts/5ab118a5.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/5ab118a5.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>3.6k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 ≈</span> <span>3 分钟</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="大纲"><a href="#大纲" class="headerlink" title="大纲"></a>大纲</h2><ul><li><a href="/posts/5ab118a5.html">ElasticSearch 入门教程 - 基础篇之一</a></li><li><a href="/posts/e049279f.html">ElasticSearch 入门教程 - 基础篇之二</a></li><li><a href="/posts/a215b192.html">ElasticSearch 入门教程 - 基础篇之三</a></li></ul><h2 id="版本说明"><a href="#版本说明" class="headerlink" title="版本说明"></a>版本说明</h2><table><thead><tr><th>软件</th><th>版本</th><th>描述</th></tr></thead><tbody><tr><td> ElasticSearch</td><td>7.4.2</td><td>ElasticSearch 的版本</td></tr><tr><td> Curl</td><td>7.29.0</td><td>Curl 的版本</td></tr></tbody></table><h2 id="ElasticSearch-介绍"><a href="#ElasticSearch-介绍" class="headerlink" title="ElasticSearch 介绍"></a>ElasticSearch 介绍</h2><h3 id="ElasticSearch-概述"><a href="#ElasticSearch-概述" class="headerlink" title="ElasticSearch 概述"></a>ElasticSearch 概述</h3><p>ElasticSearch 是基于 RESTful 标准的高扩展高可用的实时数据分析的全文搜索工具。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful 接口。ElasticSearch 是在 Lucene 的基础上用 Java 开发的，并作为 Apache 许可条款下的开放源码发布，是当前流行的企业级搜索引擎。Elasticsearch 在云计算中，拥有实时搜索、稳定、可靠、快速、安装使用方便等优势。构建在全文检索开源软件 Lucene 之上的 Elasticsearch，不仅能对海量规模的数据完成分布式索引与检索，还能提供数据聚合分析的功能。</p><span id="more"></span><h3 id="ElasticSearch-基础概念"><a href="#ElasticSearch-基础概念" class="headerlink" title="ElasticSearch 基础概念"></a>ElasticSearch 基础概念</h3><ul><li>Index - 类似于 MySQL 数据库中的 database</li><li>Type - 类似于 MySQL 数据库中的 table，ES 中可以在 Index 中建立 Type，通过 Mapping 进行映射</li><li> Document - 由于 ES 存储的数据是文档类型的，一条数据对应一个文档，相当于 MySQL 数据库中的一行数据 row</li><li>Field - ES 中一个文档中可以有多个字段，相当于 MySQL 数据库一行可以有多列</li><li> Mapping - 可以理解为 MySQL 或者 Solr 中对应的 schema，只不过有些时候 ES 中的 Mapping 增加了动态识别功能，实际生产环境上不建议使用，最好还是开始就制定好了对应的 schema</li><li>Indexed - 名义上的索引建立，MySQL 中一般会对经常使用的列增加相应的索引用于提高查询速度，而在 ES 中默认都是会加上索引的，除非特殊制定不建立索引只是进行存储用于展示，这个需要根据具体的需求和业务进行设定</li><li> Query DSL - 类似于 MySQL 的 SQL 语句，只不过在 ES 中是使用的 JSON 格式的查询语句，即 QueryDSL</li></ul><blockquote><p>值得一提的是，从 ES 7 及以上版本开始，<code>Type</code> 的概念已经被官方移除。</p></blockquote><div class="admonition note"><p class="admonition-title">提示</p><ul><li>ElasticSearch 的官网可以 <a target="_blank" rel="external nofollow" href="https://www.elastic.co/cn/what-is/elasticsearch">点击这里</a> 查看。<br></li><li>Elasticsearch 的基础概念图可以 <a href="../../../asset/2022/12/elasticsearch-basic-concepts.png">点击这里</a> 查看。<br></li></ul></div><h3 id="ElasticSearch-基本架构"><a href="#ElasticSearch-基本架构" class="headerlink" title="ElasticSearch 基本架构"></a>ElasticSearch 基本架构</h3><p><img data-src="../../../asset/2019/07/elasticsearch-architecture.png" alt="elasticsearch-architecture"></p><ul><li>Gateway 层：ES 用来存储索引文件的一个文件系统且它支持很多类型，例如：本地磁盘、共享存储（做 Snapshot 的时候需要用到）、Hadoop 的 HDFS 分布式存储、亚马逊的 S3。它的主要职责是用来对数据进行长持久化以及整个集群重启之后可以通过 Gateway 重新恢复数据。</li><li>Distributed Lucene Directory：Gateway 上层就是一个 Lucene 的分布式框架，Lucene 是做检索的，但是它是一个单机的搜索引擎，像这种 ES 分布式搜索引擎系统，虽然底层用 Lucene，但是需要在每个节点上都运行 Lucene 进行相应的索引、查询以及更新，所以需要做成一个分布式的运行框架来满足业务的需要。</li><li>四大模块组件：Districted Lucene Directory 之上就是一些 ES 的模块，Index Module 是索引模块，就是对数据建立索引也就是通常所说的建立一些倒排索引等；Search Module 是搜索模块，就是对数据进行查询搜索；Mapping 模块是数据映射与解析模块，就是你的数据的每个字段可以根据你建立的表结构通过 Mapping 进行映射解析，如果没有建立表结构，ES 就会根据数据类型推测数据结构之后自己生成一个 Mapping，然后都是根据这个 Mapping 进行解析数据；River 模块在 ES2.0 之后应该是被取消了，它的意思表示是第三方插件，例如可以通过一些自定义的脚本将传统的数据库（MySQL）等数据源通过格式化转换后直接同步到 ES 集群里，这个 River 大部分是自己写的，写出来的东西质量参差不齐，将这些东西集成到 ES 中会引发很多内部 Bug，严重影响了 ES 的正常应用，所以在 ES2.0 之后考虑将其去掉。</li><li>Discovery、Scripting：ES 四大模块组件之上有 Discovery 模块：ES 是一个集群包含很多节点，很多节点需要互相发现对方，然后组成一个集群包括选主的，这些 ES 都是用的 Discovery 模块，默认使用的是 Zen，也可是使用 EC2；ES 查询还可以支撑多种 Script 即脚本语言，包括 Mvel、JS、Python 等。</li><li>Transport 协议层：再上一层就是 ES 的通讯接口 Transport，支持的也比较多：Thrift、Memcached 以及 Http，默认的是 Http，JMX 就是 Java 的一个远程监控管理框架，因为 ES 是通过 Java 实现的。</li><li>RESTful 接口层：最上层就是 ES 暴露出来的访问接口，官方推荐的方案就是这种 RESTful 接口，直接发送 Http 请求，方便后续使用 Nginx 做代理、分发包括可能后续会做权限的管理，通过 Http 很容易做这方面的管理。如果使用 Java 客户端它是直接调用 Api，在做负载均衡以及权限管理还是不太好做。</li></ul><h2 id="ElasticSearch-基础检索操作"><a href="#ElasticSearch-基础检索操作" class="headerlink" title="ElasticSearch 基础检索操作"></a>ElasticSearch 基础检索操作</h2><h3 id="节点检索操作"><a href="#节点检索操作" class="headerlink" title="节点检索操作"></a>节点检索操作</h3><ul><li>查看 ES 的所有节点</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET http://127.0.0.1:9200/_cat/nodes</span><br></pre></td></tr></tbody></table></figure><ul><li>查看 ES 的健康状况</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET http://127.0.0.1:9200/_cat/health</span><br></pre></td></tr></tbody></table></figure><ul><li>查看 ES 的主节点</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET http://127.0.0.1:9200/_cat/master</span><br></pre></td></tr></tbody></table></figure><ul><li>查看 ES 的所有索引</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET http://127.0.0.1:9200/_cat/indices</span><br></pre></td></tr></tbody></table></figure><h3 id="数据新增操作"><a href="#数据新增操作" class="headerlink" title="数据新增操作"></a>数据新增操作</h3><p>往 ES 新增一条数据，需要说明新增在哪个索引的哪个类型下，指定用哪个唯一标识（可选）。例如，下面的命令都是在 <code>customer</code> 索引下的 <code>external</code> 类型下新增数据。</p><ul><li>POST 可以是新增操作，也可以是更新操作。如果不指定 ID，会自动生成 ID，即永远是新增操作。如果指定 ID，且该 ID 对应的数据已存在，则会更新这条数据，并递增版本号</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Post 操作，不指定 ID</span></span><br><span class="line">curl -X POST -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external -d <span class="string">'{"name": "Jim"}'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Post 操作，指定 ID</span></span><br><span class="line">curl -X POST -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2 -d <span class="string">'{"name": "Jim"}'</span></span><br></pre></td></tr></tbody></table></figure><ul><li>PUT 可以是新增操作，也可以是更新操作，但必须指定 ID。由于 PUT 需要指定 ID，一般都用来做更新操作，不指定 ID 会报错</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PUT 操作，必须指定 ID</span></span><br><span class="line">curl -X PUT -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2 -d <span class="string">'{"name": "Jim"}'</span></span><br></pre></td></tr></tbody></table></figure><div class="admonition note"><p class="admonition-title">提示</p><ul><li>往 ES 新增数据时，可以使用 POST，也可以使用 PUT</li><li> 无论是 POST 还是 PUT 操作，只要 ID 对应的数据不存在，第一次执行就是新增操作，第二次执行就是更新操作</li></ul></div><h3 id="数据查询操作"><a href="#数据查询操作" class="headerlink" title="数据查询操作"></a>数据查询操作</h3><p>从 ES 查询一条数据，需要说明在哪个索引的哪个类型下，指定用哪个唯一标识来查询。</p><ul><li>查询在 <code>customer</code> 索引下的 <code>external</code> 类型下的 2 号数据</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X GET -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2</span><br></pre></td></tr></tbody></table></figure><ul><li>返回的 JSON 结果</li></ul><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="attr">"_index"</span>: <span class="string">"customer"</span>,       <span class="comment">// 在哪个索引下</span></span><br><span class="line">    <span class="attr">"_type"</span>: <span class="string">"external"</span>,        <span class="comment">// 在哪个类型下</span></span><br><span class="line">    <span class="attr">"_id"</span>: <span class="string">"1"</span>,                 <span class="comment">// 唯一标识</span></span><br><span class="line">    <span class="attr">"_version"</span>: <span class="number">12</span>,             <span class="comment">// 版本号</span></span><br><span class="line">    <span class="attr">"_seq_no"</span>: <span class="number">1</span>,               <span class="comment">// 并发控制字段，每次更新都会递增一，用来做乐观锁</span></span><br><span class="line">    <span class="attr">"_primary_term"</span>: <span class="number">1</span>,         <span class="comment">// 同上，控制主分片重新分配，如重启，就会变化</span></span><br><span class="line">    <span class="attr">"found"</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">"_source"</span>: {                <span class="comment">// 真正的数据内容</span></span><br><span class="line">        <span class="attr">"name"</span>: <span class="string">"Jim"</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>多线程并发更新数据时，需要携带 <code>if_seq_no</code> 和 <code>if_primary_term</code> 参数来更新</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2?if_seq_no=1&amp;if_primary_term=1 -d <span class="string">'{"name": "Jim"}'</span></span><br></pre></td></tr></tbody></table></figure><h3 id="数据更新操作"><a href="#数据更新操作" class="headerlink" title="数据更新操作"></a>数据更新操作</h3><h4 id="第一种更新方式"><a href="#第一种更新方式" class="headerlink" title="第一种更新方式"></a>第一种更新方式</h4><ul><li>使用 POST 操作，并结合 <code>_update</code> 路径一起使用，此方式会对比原始的数据，如果与原始数据一样，则什么都不会做，<code>_version</code> 与 <code>_seq_no</code> 也都不会改变</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2/_update -d <span class="string">'{"doc": {"name": "Jim"}}'</span></span><br></pre></td></tr></tbody></table></figure><div class="admonition warning"><p class="admonition-title">特别注意</p><p>POST 操作结合 <code>_update</code> 路径一起使用时，更新的 JSON 数据必须包裹在 <code>doc</code> 字段内，例如：<code>{"doc": {"name": "Jim"}}</code></p></div><h4 id="第二种更新方式"><a href="#第二种更新方式" class="headerlink" title="第二种更新方式"></a>第二种更新方式</h4><ul><li>使用 POST 操作，总会将数据重新保存，并递增 <code>version</code> 版本号</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2 -d <span class="string">'{"name": "Jim"}'</span></span><br></pre></td></tr></tbody></table></figure><h4 id="第三种更新方式"><a href="#第三种更新方式" class="headerlink" title="第三种更新方式"></a>第三种更新方式</h4><ul><li>使用 PUT 操作，总会将数据重新保存，并递增 <code>version</code> 版本号</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2 -d <span class="string">'{"name": "Jim"}'</span></span><br></pre></td></tr></tbody></table></figure><h4 id="三种更新方式的使用场景"><a href="#三种更新方式的使用场景" class="headerlink" title="三种更新方式的使用场景"></a>三种更新方式的使用场景</h4><ul><li>对于高并发的更新，建议使用第二或者第三种方式（不带 <code>_update</code> 路径）</li><li>对于高并发的查询，且偶尔更新的操作，建议使用第一种方式（带 <code>_update</code> 路径）</li></ul><div class="admonition note"><p class="admonition-title">提示</p><p>上述三种方式，都支持在更新数据的同时，增加字段属性，如下所示：</p></div><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2/_update -d <span class="string">'{"doc": {"name": "Jim", "age": 18}}'</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2 -d <span class="string">'{"name": "Jim", "age": 18}'</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2 -d <span class="string">'{"name": "Jim", "age": 18}'</span></span><br></pre></td></tr></tbody></table></figure><h3 id="数据删除操作"><a href="#数据删除操作" class="headerlink" title="数据删除操作"></a>数据删除操作</h3><ul><li>删除指定的数据</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X DELETE -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer/external/2</span><br></pre></td></tr></tbody></table></figure><ul><li>删除指定的索引（数据库）</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X DELETE -H <span class="string">"Content-Type: application/json"</span> http://127.0.0.1:9200/customer</span><br></pre></td></tr></tbody></table></figure><div class="admonition note"><p class="admonition-title">提示</p><p>ElasticSerach 不支持删除指定的类型（数据库表）。</p></div><h3 id="Bulk-批量-API"><a href="#Bulk-批量-API" class="headerlink" title="Bulk 批量 API"></a>Bulk 批量 API</h3><p>Bulk API 以此按顺序执行所有的 Action（动作）。如果单个的动作因任何原因而失败，它将继续处理它后面剩余的动作。当 Bulk API 返回执行结果时，它将提供每个动作的状态（与发送的顺序相同），所以可以根据返回结果检测某个动作是不是执行成功。</p><h4 id="语法格式"><a href="#语法格式" class="headerlink" title="语法格式"></a>语法格式</h4><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">{ action: { metadata }}\n</span><br><span class="line">{ request body }\n</span><br><span class="line">{ action: { metadata }}\n</span><br><span class="line">{ request body }\n</span><br></pre></td></tr></tbody></table></figure><h4 id="批量新增操作的案例"><a href="#批量新增操作的案例" class="headerlink" title="批量新增操作的案例"></a>批量新增操作的案例</h4><ul><li>创建 JSON 数据文件（例如 <code>data.json</code>），这里 JSON 数据的末尾必须要有一行空行</li></ul><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">{<span class="attr">"index"</span>:{<span class="attr">"_id"</span>:<span class="string">"1"</span>}}</span><br><span class="line">{<span class="attr">"name"</span>:<span class="string">"John Doe"</span>}</span><br><span class="line">{<span class="attr">"index"</span>:{<span class="attr">"_id"</span>:<span class="string">"2"</span>}}</span><br><span class="line">{<span class="attr">"name"</span>:<span class="string">"Jane Doe"</span>}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><ul><li>使用 Curl 命令并通过 <code>--data-binary</code> 参数指定 JSON 数据文件，这里的文件名必须以 <code>@</code> 开头，否则加载数据文件时会造成空行被忽略</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">'Content-Type:application/json'</span> http://127.0.0.1:9200/customer/external/_bulk --data-binary @data.json</span><br></pre></td></tr></tbody></table></figure><div class="admonition warning"><p class="admonition-title">特别注意</p><ul><li>JSON 数据必须以一行空行结束，否则 ES 无法正常解析请求参数</li><li>使用 CURL 命令加载 JSON 数据文件时，往往会忽略文件末尾的空行，解决方法可以参考 <a target="_blank" rel="external nofollow" href="https://codeleading.com/article/44212532941/">这里</a>。</li></ul></div><h4 id="批量复杂操作的案例"><a href="#批量复杂操作的案例" class="headerlink" title="批量复杂操作的案例"></a>批量复杂操作的案例</h4><ul><li>创建 JSON 数据文件（例如 <code>data.json</code>）</li></ul><figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">{<span class="attr">"delete"</span>:{<span class="attr">"_index"</span>:<span class="string">"website"</span>,<span class="attr">"_type"</span>:<span class="string">"blog"</span>,<span class="attr">"_id"</span>:<span class="string">"123"</span>}}</span><br><span class="line">{<span class="attr">"create"</span>:{<span class="attr">"_index"</span>:<span class="string">"website"</span>,<span class="attr">"_type"</span>:<span class="string">"blog"</span>,<span class="attr">"_id"</span>:<span class="string">"123"</span>}}</span><br><span class="line">{<span class="attr">"title"</span>:<span class="string">"My first blog post"</span>}</span><br><span class="line">{<span class="attr">"index"</span>:{<span class="attr">"_index"</span>:<span class="string">"website"</span>,<span class="attr">"_type"</span>:<span class="string">"blog"</span>}}</span><br><span class="line">{<span class="attr">"title"</span>:<span class="string">"My second blog post"</span>}</span><br><span class="line">{<span class="attr">"update"</span>:{<span class="attr">"_index"</span>:<span class="string">"website"</span>,<span class="attr">"_type"</span>:<span class="string">"blog"</span>,<span class="attr">"_id"</span>:<span class="string">"123"</span>}}</span><br><span class="line">{<span class="attr">"doc"</span>:{<span class="attr">"title"</span>:<span class="string">"My updated blog post"</span>}}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><ul><li>使用 Curl 命令发送批量操作的请求，这里的 URL 路径并没有直接指定 ES 的索引和类型</li></ul><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST -H <span class="string">'Content-Type:application/json'</span> http://127.0.0.1:9200/_bulk --data-binary @data.json</span><br></pre></td></tr></tbody></table></figure><h2 id="ElasticSearch-文档资源"><a href="#ElasticSearch-文档资源" class="headerlink" title="ElasticSearch 文档资源"></a>ElasticSearch 文档资源</h2><ul><li><a target="_blank" rel="external nofollow" href="https://www.elastic.co/guide/index.html">ElasticSearch 官方英文文档</a></li><li><a target="_blank" rel="external nofollow" href="https://www.elastic.co/guide/en/elasticsearch/reference/master/query-dsl.html">ElasticSearch 官方英文手册</a></li><li><a target="_blank" rel="external nofollow" href="http://doc.codingdict.com/elasticsearch/0/">ElasticSearch 非官方中文文档</a></li></ul><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"全栈技术驿站",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>支持一根棒棒糖！</div> <button> 赞赏</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay 微信"> <span>微信</span></div><div> <img src="/img/pay_zfb.png" alt="Clay 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Clay</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.techgrow.cn/posts/5ab118a5.html" title="ElasticSearch 入门教程 - 基础篇之一">https://www.techgrow.cn/posts/5ab118a5.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">欢迎添加博主微信，请备注 "博客"，届时会邀请您加入百人微信群</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E/" rel="tag"><i class="fa fa-tag"></i> 搜索引擎</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/2aa6fbd1.html" rel="prev" title="MyBatis-Plus 入门教程之七"><i class="fa fa-angle-left"></i> MyBatis-Plus 入门教程之七</a></div><div class="post-nav-item"> <a href="/posts/e049279f.html" rel="next" title="ElasticSearch 入门教程 - 基础篇之二">ElasticSearch 入门教程 - 基础篇之二<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright © 2018 – <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title="站点总字数">2.1m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>站点阅读时长 ≈</span> <span title="站点阅读时长">32:11</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" 年 "+s+" 日 "+d+" 小时 "+l+" 分钟 "+u+" 秒 "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">粤ICP备 19024664号-1</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">粤公网安备 44011302004035号</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/api/oss/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，非法请求来源！");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，上传过于频繁！");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，系统内部出错！");
        } else {
          alert("图片上传失败，无法获取UploadToken，未知Http响应状态码！");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("图片上传失败，无法获取UploadToken，未知错误！");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"支持匿名评论啦，若希望及时收到博主的反馈，建议登录评论或者在上方的邮箱输入框留下邮箱地址哦 (๑•̀ㅂ•́)و✧"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/api/oss/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/5ab118a5.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>