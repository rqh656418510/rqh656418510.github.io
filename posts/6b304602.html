<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.18.0","exturl":false,"sidebar":{"position":"left","width":300,"display":"always","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script><meta name="description" content="æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯"><meta property="og:url" content="https://www.techgrow.cn/posts/6b304602.html"><meta property="og:site_name" content="Clay çš„æŠ€æœ¯ç©ºé—´"><meta property="og:description" content="æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯ã€‚"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/03/micro-service-tech.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/03/micro-service-spring-cloud.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/03/register-center-vs.png"><meta property="og:image" content="https://www.techgrow.cn/asset/2020/03/spring-cloud-config-system.png"><meta property="article:published_time" content="2019-06-13T13:43:32.000Z"><meta property="article:modified_time" content="2020-05-07T13:28:30.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="å¾®æœåŠ¡"><meta property="article:tag" content="ç³»ç»Ÿæ¶æ„"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2020/03/micro-service-tech.png"><link rel="canonical" href="https://www.techgrow.cn/posts/6b304602.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/6b304602.html","path":"posts/6b304602.html","title":"æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯ | Clay çš„æŠ€æœ¯ç©ºé—´</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn:9360"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay çš„æŠ€æœ¯ç©ºé—´" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/app/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay çš„æŠ€æœ¯ç©ºé—´</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">ç”¨è¿›åºŸé€€ | è‰ºä¸å‹èº«</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="æœç´¢" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>å‹é“¾</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>è¯»ä¹¦ç¬”è®°</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn:9360/ui/login?lng=zh-cn" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>è¯„è®ºç®¡ç†</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview"> ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%8E%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84"><span class="nav-text">å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="nav-text">å¾®æœåŠ¡çš„æ¦‚è¿°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="nav-text">å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="nav-text">å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%9A%84%E6%A8%A1%E5%9D%97%E6%8B%86%E5%88%86%E7%A4%BA%E4%BE%8B"><span class="nav-text">å¾®æœåŠ¡é¡¹ç›®çš„æ¨¡å—æ‹†åˆ†ç¤ºä¾‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%A0%E7%BB%9F%E9%A1%B9%E7%9B%AE%E4%B8%8E%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%A1%B9%E7%9B%AE%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">ä¼ ç»Ÿé¡¹ç›®ä¸å¾®æœåŠ¡é¡¹ç›®çš„åŒºåˆ«</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E9%80%89%E5%9E%8B"><span class="nav-text">å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆé€‰å‹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%E6%A1%86%E6%9E%B6%E5%AF%B9%E6%AF%94"><span class="nav-text">æœåŠ¡æ²»ç†æ¡†æ¶å¯¹æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E-Dubbo-%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-text">åŸºäº Dubbo çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E-Spring-Cloud-%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="nav-text">åŸºäº Spring Cloud çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0"><span class="nav-text">æœåŠ¡æ³¨å†Œä¸å‘ç°</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83%E5%AF%B9%E6%AF%94"><span class="nav-text">æ³¨å†Œä¸­å¿ƒå¯¹æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ZooKeeper-%E5%9C%A8%E5%88%86%E5%B8%83%E5%BC%8F-%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84%E8%A7%92%E8%89%B2"><span class="nav-text">ZooKeeper åœ¨åˆ†å¸ƒå¼ / å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„è§’è‰²</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%9F%E4%B8%80%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83"><span class="nav-text">ç»Ÿä¸€é…ç½®ä¸­å¿ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Cloud-Config-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E6%9E%B6%E6%9E%84"><span class="nav-text">Spring Cloud Config é…ç½®ä¸­å¿ƒæ¶æ„</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E7%BD%91%E5%85%B3"><span class="nav-text">è·¯ç”±ç½‘å…³</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E7%BD%91%E5%85%B3%E7%9A%84%E6%80%A7%E8%83%BD%E5%AF%B9%E6%AF%94"><span class="nav-text">è·¯ç”±ç½‘å…³çš„æ€§èƒ½å¯¹æ¯”</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Cloud-Gateway-%E4%B8%8E-Zuul-1-x-%E5%AF%B9%E6%AF%94"><span class="nav-text">Spring Cloud Gateway ä¸ Zuul 1.x å¯¹æ¯”</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%82%E9%A1%B9"><span class="nav-text">æ‚é¡¹</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88"><span class="nav-text">åˆ†å¸ƒå¼é”çš„å®ç°æ–¹æ¡ˆ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Nginx-%E5%8A%A8%E6%80%81%E6%9B%B4%E6%96%B0-upstream-%E7%9A%84%E6%96%B9%E6%A1%88"><span class="nav-text">Nginx åŠ¨æ€æ›´æ–° upstream çš„æ–¹æ¡ˆ</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">500</span> <span class="site-state-item-name">æ–‡ç« </span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">47</span> <span class="site-state-item-name">æ ‡ç­¾</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub â†’ https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail â†’ mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS â†’ /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap â†’ /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/6b304602.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay çš„æŠ€æœ¯ç©ºé—´"><meta itemprop="description" content="ä¸“æ³¨äº Javaã€å‰ç«¯ã€ç§»åŠ¨ç«¯ã€å¾®æœåŠ¡ã€åˆ†å¸ƒå¼ç³»ç»Ÿã€æ•°æ®åº“ã€ç³»ç»Ÿæ¶æ„ã€äººå·¥æ™ºèƒ½ã€å¤§æ•°æ®ã€äº‘è®¡ç®—ã€ç‰©è”ç½‘ã€è™šæ‹ŸåŒ–å­¦ä¹ çš„æŠ€æœ¯åšå®¢ã€‚"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯ | Clay çš„æŠ€æœ¯ç©ºé—´"><meta itemprop="description" content="æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯ã€‚"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2019-06-13 21:43:32" itemprop="dateCreated datePublished" datetime="2019-06-13T21:43:32+08:00">2019-06-13</time></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i></span> <span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-05-07 21:28:30" itemprop="dateModified" datetime="2020-05-07T21:28:30+08:00">2020-05-07</time></span><span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span><a title="waline" href="/posts/6b304602.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/6b304602.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>3.9k</span></span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ â‰ˆ</span> <span>4 åˆ†é’Ÿ</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„"><a href="#å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„" class="headerlink" title="å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„"></a>å¾®æœåŠ¡ä¸å¾®æœåŠ¡æ¶æ„</h2><h3 id="å¾®æœåŠ¡çš„æ¦‚è¿°"><a href="#å¾®æœåŠ¡çš„æ¦‚è¿°" class="headerlink" title="å¾®æœåŠ¡çš„æ¦‚è¿°"></a>å¾®æœåŠ¡çš„æ¦‚è¿°</h3><p>å¾®æœåŠ¡ç†è®ºçš„æå‡ºè€…é©¬ä¸ã€‚ç¦å‹’ï¼ˆMartin Fowlerï¼‰ åœ¨å…¶<a target="_blank" rel="external nofollow" href="https://martinfowler.com/articles/microservices.html">åšå®¢</a>ä¸­è¯¦ç»†æè¿°äº†ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ã€‚å¾®æœåŠ¡å¼ºè°ƒçš„æ˜¯æœåŠ¡çš„å¤§å°ï¼Œå®ƒå…³æ³¨çš„æ˜¯æŸä¸€ä¸ªç‚¹ï¼Œæ˜¯å…·ä½“è§£å†³æŸä¸€ä¸ªé—®é¢˜ / æä¾›è½åœ°å¯¹åº”æœåŠ¡çš„ä¸€ä¸ªæœåŠ¡åº”ç”¨ï¼›ç‹­æ„çš„çœ‹ï¼Œå¯ä»¥çœ‹ä½œ Eclipse é‡Œé¢çš„ä¸€ä¸ªä¸ªå¾®æœåŠ¡å·¥ç¨‹ / æˆ–è€… Moduleã€‚</p><h3 id="å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°"><a href="#å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°" class="headerlink" title="å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°"></a>å¾®æœåŠ¡æ¶æ„çš„æ¦‚è¿°</h3><p>å¾®æœåŠ¡æ¶æ„æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼æˆ–è€…è¯´æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œå®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†ä¸ºä¸€ç»„å°æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œåœ¨è‡ªå·±çš„ç‹¬ç«‹è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡é—´é€šä¿¡é‡‡ç”¨è½»é‡çº§é€šä¿¡æœºåˆ¶ (é€šå¸¸æ˜¯åŸºäº HTTP çš„ RESTful API)ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»ºï¼Œå¹¶ä¸”èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€ç±»ç”Ÿäº§ç¯å¢ƒç­‰ã€‚å¦å¤–ï¼Œåº”è¯¥å°½é‡é¿å…ç»Ÿä¸€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€ï¼Œåº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€å·¥å…·å¯¹å…¶è¿›è¡Œæ„å»ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸è½»é‡çº§çš„é›†ä¸­å¼ç®¡ç†æ¥åè°ƒè¿™äº›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™æœåŠ¡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨æŠ€æœ¯ã€‚</p><span id="more"></span><h3 id="å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹"><a href="#å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹"></a>å¾®æœåŠ¡æ¶æ„çš„ä¼˜ç¼ºç‚¹</h3><ul><li><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ˜“äºå¼€å‘å’Œç»´æŠ¤ï¼šä¸€ä¸ªå¾®æœåŠ¡åªä¼šå…³æ³¨ä¸€ä¸ªç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œæ‰€ä»¥å®ƒä¸šåŠ¡æ¸…æ™°ï¼Œä»£ç é‡è¾ƒå°‘</li><li>å•ä¸ªå¾®æœåŠ¡å¯åŠ¨è¾ƒå¿«ï¼šå•ä¸ªå¾®æœåŠ¡ä»£ç é‡è¾ƒå°‘ï¼Œæ‰€ä»¥å¯åŠ¨ä¼šæ¯”è¾ƒå¿«</li><li>ä¸šåŠ¡ä¹‹é—´æ¾è€¦åˆï¼Œæ— è®ºæ˜¯åœ¨å¼€å‘é˜¶æ®µæˆ–è€…éƒ¨ç½²é˜¶æ®µï¼Œä¸åŒçš„æœåŠ¡éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„</li><li>å±€éƒ¨ä¿®æ”¹å®¹æ˜“éƒ¨ç½²ï¼šå•ä½“åº”ç”¨åªè¦æœ‰ä¿®æ”¹ï¼Œå°±å¾—é‡æ–°éƒ¨ç½²æ•´ä¸ªåº”ç”¨ï¼Œå¾®æœåŠ¡è§£å†³äº†è¿™æ ·çš„é—®é¢˜</li><li>æŠ€æœ¯æ ˆä¸å—é™ï¼šåœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œå¯ä»¥ç»“åˆé¡¹ç›®ä¸šåŠ¡åŠå›¢é˜Ÿçš„ç‰¹ç‚¹ï¼Œåˆç†åœ°é€‰æ‹©æŠ€æœ¯æ ˆ</li><li>æŒ‰éœ€ä¼¸ç¼©ï¼šå¯æ ¹æ®éœ€æ±‚ï¼Œå®ç°ç»†ç²’åº¦çš„æ‰©å±•</li></ul></li><li><p>ç¼ºç‚¹ï¼š</p><ul><li>è¿ç»´è¦æ±‚é«˜ï¼šæ›´å¤šçš„æœåŠ¡æ„å‘³ç€æ›´å¤šçš„è¿ç»´æŠ•å…¥</li><li>æŠ€æœ¯å¼€å‘éš¾åº¦é«˜ï¼šæ¶‰åŠåˆ°ç½‘ç»œé€šä¿¡å»¶è¿Ÿã€æœåŠ¡å®¹é”™ã€æ•°æ®ä¸€è‡´æ€§ã€ç³»ç»Ÿé›†æˆæµ‹è¯•ã€æ€§èƒ½ç›‘æ§ç­‰</li><li>åˆ†å¸ƒå¼å›ºæœ‰çš„å¤æ‚æ€§ï¼šä½¿ç”¨å¾®æœåŠ¡æ¶æ„çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç³»ç»Ÿå®¹é”™ï¼Œç½‘ç»œå»¶è¿Ÿï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ç­‰éƒ½ä¼šå¸¦æ¥å·¨å¤§çš„æŒ‘æˆ˜</li><li>æ¥å£è°ƒæ•´æˆæœ¬é«˜ï¼šå¾®æœåŠ¡ä¹‹é—´é€šè¿‡æ¥å£è¿›è¡Œé€šä¿¡ã€‚å¦‚æœä¿®æ”¹æŸä¸€ä¸ªå¾®æœåŠ¡çš„ APIï¼Œå¯èƒ½æ‰€æœ‰ä½¿ç”¨äº†è¯¥æ¥å£çš„å¾®æœåŠ¡éƒ½éœ€è¦åšè°ƒæ•´</li><li>é‡å¤åŠ³åŠ¨ï¼šå¾ˆå¤šæœåŠ¡å¯èƒ½éƒ½ä¼šä½¿ç”¨åˆ°ç›¸åŒçš„åŠŸèƒ½ï¼Œè€Œè¿™ä¸ªåŠŸèƒ½å¹¶æ²¡æœ‰è¾¾åˆ°åˆ†è§£ä¸ºä¸€ä¸ªå¾®æœåŠ¡çš„ç¨‹åº¦ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå¯èƒ½å„ä¸ªæœåŠ¡éƒ½ä¼šå¼€å‘è¿™ä¸€åŠŸèƒ½ï¼Œä»è€Œå¯¼è‡´ä»£ç é‡å¤</li></ul></li></ul><h3 id="å¾®æœåŠ¡é¡¹ç›®çš„æ¨¡å—æ‹†åˆ†ç¤ºä¾‹"><a href="#å¾®æœåŠ¡é¡¹ç›®çš„æ¨¡å—æ‹†åˆ†ç¤ºä¾‹" class="headerlink" title="å¾®æœåŠ¡é¡¹ç›®çš„æ¨¡å—æ‹†åˆ†ç¤ºä¾‹"></a>å¾®æœåŠ¡é¡¹ç›®çš„æ¨¡å—æ‹†åˆ†ç¤ºä¾‹</h3><ul><li>edu-common-parentï¼ˆMaven çˆ¶é…ç½®ï¼‰</li><li>edu-commonï¼ˆå…¬å…±æ¨¡å—ï¼‰</li><li>edu-common-configï¼ˆå…¬å…± Config æ¨¡å—ï¼‰</li><li>edu-common-coreï¼ˆå…¬å…± Core æ¨¡å—ï¼‰</li><li>edu-common-webï¼ˆå…¬å…± Web æ¨¡å—ï¼‰</li><li>edu-facade-userï¼ˆç”¨æˆ·æœåŠ¡æ¥å£ï¼‰</li><li>edu-service-userï¼ˆç”¨æˆ·æœåŠ¡æä¾›è€…ï¼‰</li><li>edu-web-bossï¼ˆç”¨æˆ·æœåŠ¡æ¶ˆè´¹è€…ï¼‰</li></ul><h3 id="ä¼ ç»Ÿé¡¹ç›®ä¸å¾®æœåŠ¡é¡¹ç›®çš„åŒºåˆ«"><a href="#ä¼ ç»Ÿé¡¹ç›®ä¸å¾®æœåŠ¡é¡¹ç›®çš„åŒºåˆ«" class="headerlink" title="ä¼ ç»Ÿé¡¹ç›®ä¸å¾®æœåŠ¡é¡¹ç›®çš„åŒºåˆ«"></a>ä¼ ç»Ÿé¡¹ç›®ä¸å¾®æœåŠ¡é¡¹ç›®çš„åŒºåˆ«</h3><ul><li>ä¼ ç»Ÿçš„ Maven å•æ¨¡å—é¡¹ç›®ï¼Œæœ€ç»ˆä¼šæ‰“åŒ…æˆå•ä¸ª Java æˆ– Web åº”ç”¨</li><li>ä¼ ç»Ÿçš„ Maven å¤šæ¨¡å—é¡¹ç›®ï¼Œå„æ¨¡å—ä¹‹é—´ç›´æ¥é€šè¿‡ Maven ä¾èµ–æ¥å®ç° Java ä»£ç çš„äº’ç›¸è°ƒç”¨ä¸ä»£ç é‡ç”¨ï¼Œæœ€ç»ˆä¼šæ‰“åŒ…æˆå•ä¸ªæˆ–å¤šä¸ª Java æˆ– Web åº”ç”¨ï¼Œè‹¥å¤šä¸ªåº”ç”¨ä¹‹é—´éœ€è¦äº’ç›¸é€šä¿¡ï¼Œåˆ™é‡‡ç”¨ TCP/HTTP ç­‰åè®®ï¼Œå¯æ‰©å±•ä¸ºé›†ç¾¤æ¶æ„ã€‚</li><li>å¾®æœåŠ¡çš„ Maven å¤šæ¨¡å—é¡¹ç›®ï¼Œéƒ¨åˆ†æ¨¡å—ä¹‹é—´é€šè¿‡ Maven ä¾èµ–æ¥å®ç° Java ä»£ç çš„äº’ç›¸è°ƒç”¨ä¸ä»£ç é‡ç”¨ï¼Œä¸€èˆ¬ä¼šå¼•å…¥æ³¨å†Œä¸­å¿ƒæ¥å®ç°æœåŠ¡çš„è‡ªåŠ¨æ³¨å†Œä¸å‘ç°ï¼Œæœ€ç»ˆä¼šæ‰“åŒ…æˆå¤šä¸ª Java æˆ– Web åº”ç”¨ï¼Œå¤šä¸ªåº”ç”¨ä¹‹é—´é€šè¿‡ RPC/RESTful API è¿›è¡Œè°ƒç”¨ã€‚</li></ul><h2 id="å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆé€‰å‹"><a href="#å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆé€‰å‹" class="headerlink" title="å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆé€‰å‹"></a>å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆé€‰å‹</h2><h3 id="æœåŠ¡æ²»ç†æ¡†æ¶å¯¹æ¯”"><a href="#æœåŠ¡æ²»ç†æ¡†æ¶å¯¹æ¯”" class="headerlink" title="æœåŠ¡æ²»ç†æ¡†æ¶å¯¹æ¯”"></a>æœåŠ¡æ²»ç†æ¡†æ¶å¯¹æ¯”</h3><p><img data-src="../../../asset/2020/03/micro-service-tech.png" alt="micro-service-tech"></p><h3 id="åŸºäº-Dubbo-çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ"><a href="#åŸºäº-Dubbo-çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŸºäº Dubbo çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ"></a>åŸºäº Dubbo çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ</h3><p>Dubbo æœªæ¥çš„å®šä½å¹¶ä¸æ˜¯è¦æˆä¸ºä¸€ä¸ªå¾®æœåŠ¡çš„å…¨é¢è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯ä¸“æ³¨äº RPC é¢†åŸŸï¼Œæˆä¸ºå¾®æœåŠ¡ç”Ÿæ€ä½“ç³»ä¸­çš„ä¸€ä¸ªé‡è¦ç»„ä»¶ã€‚è‡³äºå¾®æœåŠ¡åŒ–è¡ç”Ÿå‡ºçš„æœåŠ¡æ²»ç†éœ€æ±‚ï¼ŒDubbo æ­£åœ¨ç§¯æé€‚é…å¼€æºè§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸”å·²ç»å¯åŠ¨ç‹¬ç«‹çš„å¼€æºé¡¹ç›®äºˆä»¥æ”¯æŒã€‚å› æ­¤åŸºäº Dubbo çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆæ˜¯ï¼šDubbo + Nacos + Sentinel + å…¶ä»–ã€‚</p><h3 id="åŸºäº-Spring-Cloud-çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ"><a href="#åŸºäº-Spring-Cloud-çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ" class="headerlink" title="åŸºäº Spring Cloud çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ"></a>åŸºäº Spring Cloud çš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆ</h3><p>SpringCloud çš„æŠ€æœ¯é€‰æ‹©æ€§æ˜¯ä¸­ç«‹çš„ï¼Œå› æ­¤å¯ä»¥éšéœ€æ›´æ¢æ­é…ä½¿ç”¨ï¼ŒåŸºäº SpringCloud çš„å¾®æœåŠ¡è½åœ°è§£å†³æ–¹æ¡ˆå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š</p><p><img data-src="../../../asset/2020/03/micro-service-spring-cloud.png" alt="micro-service-spring-cloud"></p><h2 id="æœåŠ¡æ³¨å†Œä¸å‘ç°"><a href="#æœåŠ¡æ³¨å†Œä¸å‘ç°" class="headerlink" title="æœåŠ¡æ³¨å†Œä¸å‘ç°"></a>æœåŠ¡æ³¨å†Œä¸å‘ç°</h2><h3 id="æ³¨å†Œä¸­å¿ƒå¯¹æ¯”"><a href="#æ³¨å†Œä¸­å¿ƒå¯¹æ¯”" class="headerlink" title="æ³¨å†Œä¸­å¿ƒå¯¹æ¯”"></a>æ³¨å†Œä¸­å¿ƒå¯¹æ¯”</h3><p><img data-src="../../../asset/2020/03/register-center-vs.png" alt="register-center-vs"></p><h3 id="ZooKeeper-åœ¨åˆ†å¸ƒå¼-å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„è§’è‰²"><a href="#ZooKeeper-åœ¨åˆ†å¸ƒå¼-å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„è§’è‰²" class="headerlink" title="ZooKeeper åœ¨åˆ†å¸ƒå¼/å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„è§’è‰²"></a>ZooKeeper åœ¨åˆ†å¸ƒå¼ / å¾®æœåŠ¡ç³»ç»Ÿä¸­çš„è§’è‰²</h3><p>ZooKeeper æ˜¯ä¸€ç§åˆ†å¸ƒå¼ / å¾®æœåŠ¡åè°ƒæœåŠ¡ï¼Œç”¨äºç®¡ç†å¤§å‹ä¸»æœºï¼ŒåŒ…æ‹¬åˆ†å¸ƒå¼é”ã€æœåŠ¡æ³¨å†Œä¸å‘ç°ã€‚å…¶ä¸­ Zookeeper æ˜¯ä¸ºè¯»å¤šå†™å°‘çš„åœºæ™¯æ‰€è®¾è®¡ï¼Œå¹¶ä¸æ˜¯ç”¨æ¥å­˜å‚¨å¤§è§„æ¨¡ä¸šåŠ¡æ•°æ®ï¼Œè€Œæ˜¯ç”¨äºå­˜å‚¨å°‘é‡çš„çŠ¶æ€å’Œé…ç½®ä¿¡æ¯ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®æœ€å¤§ä¸èƒ½è¶…è¿‡ 1MBã€‚</p><h2 id="ç»Ÿä¸€é…ç½®ä¸­å¿ƒ"><a href="#ç»Ÿä¸€é…ç½®ä¸­å¿ƒ" class="headerlink" title="ç»Ÿä¸€é…ç½®ä¸­å¿ƒ"></a>ç»Ÿä¸€é…ç½®ä¸­å¿ƒ</h2><h3 id="Spring-Cloud-Config-é…ç½®ä¸­å¿ƒæ¶æ„"><a href="#Spring-Cloud-Config-é…ç½®ä¸­å¿ƒæ¶æ„" class="headerlink" title="Spring Cloud Config é…ç½®ä¸­å¿ƒæ¶æ„"></a>Spring Cloud Config é…ç½®ä¸­å¿ƒæ¶æ„</h3><p>Spring Cloud Config åŸºäºæ¶ˆæ¯æ€»çº¿çš„æ¶æ„å›¾å¦‚ä¸‹ï¼Œè¯¥æ¶æ„éœ€è¦ä¾èµ–å¤–éƒ¨çš„ MQ ç»„ä»¶ï¼Œå¦‚ Rabbitã€Kafka å®ç°è¿œç¨‹ç¯å¢ƒäº‹ä»¶å˜æ›´é€šçŸ¥ï¼Œå®¢æˆ·ç«¯å®æ—¶é…ç½®å˜æ›´å¯ä»¥åŸºäº Git Hook åŠŸèƒ½å®ç°ã€‚å½“ä¾èµ–çš„æ¶ˆæ¯ç»„ä»¶å‡ºç°é—®é¢˜æ—¶ï¼Œæ­¤æ—¶å¦‚æœ Git ä»“åº“ é…ç½®å‘ç”Ÿäº†å˜æ›´ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†æˆ–æ‰€æœ‰å®¢æˆ·ç«¯å¯èƒ½æ— æ³•è·å–åˆ°æœ€æ–°é…ç½®ï¼Œè¿™æ ·å°±é€ æˆäº†å®¢æˆ·ç«¯åº”ç”¨é…ç½®æ•°æ®æ— æ³•è¾¾åˆ°æœ€ç»ˆä¸€è‡´æ€§ï¼Œè¿›è€Œå¼•èµ·çº¿ä¸Šé—®é¢˜ã€‚æ¶æ„å›¾ä¸­çš„ <code>Self scheduleing refresher</code> å°±æ˜¯ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼Œå®ƒæ˜¯ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œæ‰§è¡Œæ—¶ä¼šåˆ¤æ–­æœ¬åœ°çš„ Git ä»“åº“ç‰ˆæœ¬ä¸è¿œç¨‹ Git ä»“åº“ç‰ˆæœ¬æ˜¯å¦ä¸€è‡´ï¼Œè‹¥ä¸ä¸€è‡´åˆ™ä¼šä»é…ç½®ä¸­å¿ƒè·å–æœ€æ–°é…ç½®è¿›è¡ŒåŠ è½½ï¼Œä¿éšœäº†é…ç½®æœ€ç»ˆä¸€è‡´æ€§ã€‚</p><p><img data-src="../../../asset/2020/03/spring-cloud-config-system.png" alt="spring-cloud-config-system"></p><h2 id="è·¯ç”±ç½‘å…³"><a href="#è·¯ç”±ç½‘å…³" class="headerlink" title="è·¯ç”±ç½‘å…³"></a>è·¯ç”±ç½‘å…³</h2><h3 id="è·¯ç”±ç½‘å…³çš„æ€§èƒ½å¯¹æ¯”"><a href="#è·¯ç”±ç½‘å…³çš„æ€§èƒ½å¯¹æ¯”" class="headerlink" title="è·¯ç”±ç½‘å…³çš„æ€§èƒ½å¯¹æ¯”"></a>è·¯ç”±ç½‘å…³çš„æ€§èƒ½å¯¹æ¯”</h3><ul><li>Spring Cloud Gateway ~ Zuul 2 &lt;&lt; OpenResty ~&lt; Kong &lt;&lt; Directï¼ˆç›´è¿ï¼‰</li><li>Spring Cloud Gatewayã€Zuul 2 çš„æ€§èƒ½å·®ä¸å¤šï¼Œå¤§æ¦‚æ˜¯ç›´è¿çš„ 35%-40%</li><li>OpenRestyã€Kong å·®ä¸å¤šï¼Œå¤§æ¦‚æ˜¯ç›´è¿çš„ 60%-70%</li></ul><p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œåœ¨å¤§å¹¶å‘åœºæ™¯ä¸‹ï¼Œä¾‹å¦‚æ¨¡æ‹Ÿ 200 å¹¶å‘ç”¨æˆ·ã€1000 å¹¶å‘ç”¨æˆ·æ—¶ï¼ŒZuul 2 ä¼šæœ‰å¾ˆå¤§æ¦‚ç‡è¿”å›å‡ºé”™ï¼Œè¿™ä¹Ÿè¯´æ˜ Zuul 2 ç›®å‰è¿˜ä¸æˆç†Ÿã€‚Kong çš„æ€§èƒ½éå¸¸ä¸é”™ï¼Œéå¸¸é€‚åˆåšæµé‡ç½‘å…³ï¼Œå¹¶ä¸”å¯¹äº serviceã€routeã€upstreamã€consumerã€plugins çš„æŠ½è±¡ï¼Œä¹Ÿæ˜¯è‡ªç ”ç½‘å…³å€¼å¾—å€Ÿé‰´çš„ã€‚ä½†å¯¹äºå¤æ‚ç³»ç»Ÿï¼Œä¸å»ºè®®ä¸šåŠ¡ç½‘å…³ç”¨ Kongï¼Œæˆ–è€…æ›´æ˜ç¡®çš„è¯´æ˜¯ä¸å»ºè®®åœ¨ Java æŠ€æœ¯æ ˆçš„ç³»ç»Ÿæ·±åº¦å®šåˆ¶ Kong æˆ– OpenRestyï¼Œä¸»è¦æ˜¯å·¥ç¨‹æ€§æ–¹é¢çš„è€ƒè™‘ã€‚ä¸¾ä¸ªä¾‹å­ï¼šå‡å¦‚æœ‰å¾ˆå¤šä¸ªä¸åŒä¸šåŠ¡çº¿ï¼Œé‰´æƒæ–¹å¼äº”èŠ±å…«é—¨ï¼Œéƒ½æ˜¯ä¸ä¸šåŠ¡å¤šå°‘æœ‰ç‚¹ç›¸å…³çš„ï¼›è¿™æ—¶å¦‚æœæŠŠé‰´æƒåœ¨ç½‘å…³å®ç°ï¼Œå°±éœ€è¦ç»´æŠ¤å¤§é‡çš„ Lua è„šæœ¬ï¼Œå¼•å…¥ä¸€ä¸ªæ–°çš„å¤æ‚æŠ€æœ¯æ ˆæ˜¯ä¸€ä¸ªæˆæœ¬ä¸ä½çš„äº‹æƒ…ã€‚Spring Cloud Gatewayã€Zuul2 å¯¹äº Java æŠ€æœ¯æ ˆæ¥è¯´æ¯”è¾ƒæ–¹ä¾¿ï¼Œå¯ä»¥ä¾èµ–ä¸šåŠ¡ç³»ç»Ÿçš„ä¸€äº› Common ç»„ä»¶ï¼›è€Œä½¿ç”¨ Lua å¼€å‘ä¸æ–¹ä¾¿ï¼Œä¸å…‰æ˜¯è¯­è¨€çš„é—®é¢˜ï¼Œæ›´æ˜¯å¤ç”¨åŸºç¡€è®¾æ–½çš„é—®é¢˜ã€‚å¦å¤–ï¼Œå¯¹äºç½‘å…³ç³»ç»Ÿæ¥è¯´ï¼Œæ€§èƒ½ä¸æ˜¯å·®ä¸€ä¸ªæ•°é‡çº§ï¼Œé—®é¢˜ä¸æ˜¯å¾ˆå¤§ï¼Œå¤šåŠ æœºå™¨å°±å¯ä»¥æå®šã€‚</p><h3 id="Spring-Cloud-Gateway-ä¸-Zuul-1-x-å¯¹æ¯”"><a href="#Spring-Cloud-Gateway-ä¸-Zuul-1-x-å¯¹æ¯”" class="headerlink" title="Spring Cloud Gateway ä¸ Zuul 1.x å¯¹æ¯”"></a>Spring Cloud Gateway ä¸ Zuul 1.x å¯¹æ¯”</h3><ul><li>åº•å±‚å®ç°ï¼šZuul 1.x åŸºäº Servlet 2.5 æ„å»ºï¼Œä½¿ç”¨çš„æ˜¯é˜»å¡çš„ I/O æ¨¡å‹ã€‚Gateway æ˜¯åŸºäº Spring 5.xã€Spring Boot 2.xã€Spring WebFlux å’Œ Project Reactor ç­‰æŠ€æœ¯ï¼Œåº•å±‚ä½¿ç”¨ Netty çš„éé˜»å¡ I/O æ¨¡å‹ã€‚</li><li>é•¿è¿æ¥ï¼šGateway æ”¯æŒé•¿è¿æ¥ï¼Œè€Œ Zuul 1.x ä¸æ”¯æŒé•¿è¿æ¥ï¼ˆå¦‚ WebSocketï¼‰ï¼Œä¸é€‚ç”¨åç«¯æœåŠ¡å“åº”æ…¢æˆ–è€…é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå› ä¸ºçº¿ç¨‹æ•°é‡æ˜¯å›ºå®šï¼ˆæœ‰é™ï¼‰çš„ï¼Œçº¿ç¨‹å®¹æ˜“è¢«è€—å°½ï¼Œå¯¼è‡´æ–°è¯·æ±‚è¢«æ‹’ç»å¤„ç†ã€‚</li><li>é™æµï¼šZuul 1.x éœ€è¦é€šè¿‡ Filter å®ç°é™æµæ‰©å±•ï¼ŒGateway å†…ç½®äº†é™æµè¿‡æ»¤å™¨ã€‚</li><li>æ€§èƒ½ï¼šæ ¹æ®å®˜æ–¹æä¾›çš„åŸºå‡†æµ‹è¯•ï¼ŒSpring Cloud Gateway çš„ RPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰æ˜¯ Zuul 1.x çš„ 1.6 å€ï¼Œå¹³å‡å»¶è¿Ÿæ˜¯ Zuul 1.x çš„ä¸€åŠã€‚</li><li>æŠ€æœ¯æ ˆæ²‰æ·€ï¼šZuul 1.x å¼€æºè¿‘ä¸ƒå¹´ï¼Œç»å—è€ƒéªŒï¼Œç¨³å®šæˆç†Ÿï¼ŒGateway æœªè§å®é™…è½åœ°æ¡ˆä¾‹ï¼ŒGithub ç»Ÿè®¡å¦‚ä¸‹ï¼š</li></ul><table><thead><tr><th>ä»“åº“æ•°é‡</th><th> issues æ•°é‡</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td> Zuul1.x 1007 repositories</td><td>Zuul1.x 88 Open / 2736 Closed</td><td> ç»Ÿè®¡æ—¶é—´æˆªæ­¢ 2019/8/26</td></tr><tr><td>Gateway 102 repositories</td><td>Gateway 135 Open / 850 Closed</td><td> ç»Ÿè®¡æ—¶é—´æˆªæ­¢ 2019/8/26</td></tr></tbody></table><h2 id="æ‚é¡¹"><a href="#æ‚é¡¹" class="headerlink" title="æ‚é¡¹"></a>æ‚é¡¹</h2><h3 id="åˆ†å¸ƒå¼é”çš„å®ç°æ–¹æ¡ˆ"><a href="#åˆ†å¸ƒå¼é”çš„å®ç°æ–¹æ¡ˆ" class="headerlink" title="åˆ†å¸ƒå¼é”çš„å®ç°æ–¹æ¡ˆ"></a>åˆ†å¸ƒå¼é”çš„å®ç°æ–¹æ¡ˆ</h3><ul><li>Redissonï¼šRedis å®˜æ–¹çš„åˆ†å¸ƒå¼é”å®ç°</li><li> Zookeeperï¼šåˆ©ç”¨ Zookeeper çš„é¡ºåºä¸´æ—¶èŠ‚ç‚¹ï¼Œæ¥å®ç°åˆ†å¸ƒå¼é”å’Œç­‰å¾…é˜Ÿåˆ—</li><li> Chubbyï¼šGoogle å…¬å¸å®ç°çš„ç²—ç²’åº¦åˆ†å¸ƒå¼é”æœåŠ¡ï¼Œåº•å±‚åˆ©ç”¨äº† Paxos ä¸€è‡´æ€§ç®—æ³•</li><li> Redisï¼šå’Œ Memcached çš„æ–¹å¼ç±»ä¼¼ï¼Œåˆ©ç”¨ Redis çš„ setnx å‘½ä»¤ï¼Œæ­¤å‘½ä»¤åŒæ ·æ˜¯åŸå­æ€§æ“ä½œï¼Œåªæœ‰åœ¨ key ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æ‰èƒ½ set æˆåŠŸ</li><li> Memcachedï¼šåˆ©ç”¨ Memcached çš„ add å‘½ä»¤ï¼Œæ­¤å‘½ä»¤æ˜¯åŸå­æ€§æ“ä½œï¼Œåªæœ‰åœ¨ key ä¸å­˜åœ¨çš„æƒ…å†µä¸‹æ‰èƒ½ add æˆåŠŸï¼Œä¹Ÿå°±æ„å‘³ç€çº¿ç¨‹å¾—åˆ°äº†é”</li></ul><h3 id="Nginx-åŠ¨æ€æ›´æ–°-upstream-çš„æ–¹æ¡ˆ"><a href="#Nginx-åŠ¨æ€æ›´æ–°-upstream-çš„æ–¹æ¡ˆ" class="headerlink" title="Nginx åŠ¨æ€æ›´æ–° upstream çš„æ–¹æ¡ˆ"></a>Nginx åŠ¨æ€æ›´æ–° upstream çš„æ–¹æ¡ˆ</h3><p>åœ¨ä¸ä½¿ç”¨æœåŠ¡å‘ç°ä¸­é—´ä»¶ï¼ˆå¦‚ Zookeeperã€Eurekaã€Consulï¼‰çš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ä¼ ç»Ÿçš„åŸºäºä»£ç†çš„è´Ÿè½½å‡è¡¡è§£å†³æ–¹æ¡ˆï¼ˆå¦‚ Nginxï¼‰ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹æ–¹æ¡ˆåŠ¨æ€æ›´æ–°æœåŠ¡æä¾›è€…åˆ—è¡¨ã€‚</p><ul><li>æ‰‹å·¥æˆ–è€…é€šè¿‡è„šæœ¬æ–¹å¼ï¼Œåœ¨éƒ¨ç½²çš„æ—¶å€™å»æ›´æ–° Nginx çš„é…ç½®æ–‡ä»¶ï¼Œç„¶å reload</li><li> ä½¿ç”¨ <code>ngx_http_dyups_module</code> æ¨¡å—ï¼Œé€šè¿‡ REST API æ¥åœ¨è¿è¡Œæ—¶ç›´æ¥æ›´æ–° upstream è€Œä¸éœ€è¦ reload</li><li>consul-template + Nginx çš„æ–¹æ¡ˆä¸€ï¼Œé€šè¿‡ consul ç›‘å¬æœåŠ¡å®ä¾‹çš„å˜åŒ–ï¼Œç„¶åæ›´æ–° Nginx çš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ reload å®ç°æœåŠ¡åˆ—è¡¨çš„æ›´æ–°</li><li> consul-template + Nginx çš„æ–¹æ¡ˆäºŒï¼ŒNginx åœ¨è¿è¡Œæ—¶é€šè¿‡ consul è·å–æœåŠ¡åˆ—è¡¨æ¥å®ç°åŠ¨æ€ upstream çš„è·¯ç”±</li><li> OpenResty + Lua çš„æ–¹æ¡ˆï¼Œé€šè¿‡ Lua è„šæœ¬å®ç°åŠ¨æ€ upstream çš„è·¯ç”±</li></ul><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"å…¨æ ˆæŠ€æœ¯é©¿ç«™",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>æ”¯æŒä¸€æ ¹æ£’æ£’ç³–ï¼</div> <button> èµèµ</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay å¾®ä¿¡"> <span>å¾®ä¿¡</span></div><div> <img src="/img/pay_zfb.png" alt="Clay æ”¯ä»˜å®"> <span>æ”¯ä»˜å®</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Clay</li><li class="post-copyright-link"> <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://www.techgrow.cn/posts/6b304602.html" title="æµ…æå¾®æœåŠ¡æ¶æ„æŠ€æœ¯">https://www.techgrow.cn/posts/6b304602.html</a></li><li class="post-copyright-license"> <strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">æ¬¢è¿æ·»åŠ åšä¸»å¾®ä¿¡ï¼Œè¯·å¤‡æ³¨ "åšå®¢"ï¼Œå±Šæ—¶ä¼šé‚€è¯·æ‚¨åŠ å…¥å¾®ä¿¡ç¾¤</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" rel="tag"><i class="fa fa-tag"></i> å¾®æœåŠ¡</a><a href="/tags/%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84/" rel="tag"><i class="fa fa-tag"></i> ç³»ç»Ÿæ¶æ„</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/19b24d.html" rel="prev" title="Spring å¼€å‘éšç¬”"><i class="fa fa-angle-left"></i> Spring å¼€å‘éšç¬”</a></div><div class="post-nav-item"> <a href="/posts/ffb541a9.html" rel="next" title="Centos7 ç”Ÿäº§ç¯å¢ƒå®‰è£… RabbitMQ (å•æœº)">Centos7 ç”Ÿäº§ç¯å¢ƒå®‰è£… RabbitMQ (å•æœº)<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright Â© 2018 â€“ <span itemprop="copyrightYear">2024</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">1.1m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ â‰ˆ</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">16:31</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" å¹´ "+s+" æ—¥ "+d+" å°æ—¶ "+l+" åˆ†é’Ÿ "+u+" ç§’ "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">ç²¤ ICP å¤‡ 19024664 å·</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">ç²¤å…¬ç½‘å®‰å¤‡ 44011302004035 å·</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="æ€»è®¿å®¢é‡"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="æ€»è®¿é—®é‡"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div> <a href="https://github.com/rqh656418510" class="github-corner" title="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" aria-label="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-g2xji1rlE3KsGVClvuxTbcR0Kn2+wtQADSff2Tbb4zA="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"/lib/mermaid/dist/mermaid.min.js","integrity":"sha256-9y71g5Lz/KLsHjB8uXwnkuWDtAMDSzD/HdIbqhJfTAI="}}</script><script src="/js/third-party/tags/mermaid.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://qiniu.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/app/api/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œéæ³•è¯·æ±‚æ¥æºï¼");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œä¸Šä¼ è¿‡äºé¢‘ç¹ï¼");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œç³»ç»Ÿå†…éƒ¨å‡ºé”™ï¼");
        } else {
          alert("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼ŒæœªçŸ¥Httpå“åº”çŠ¶æ€ç ï¼");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼ŒæœªçŸ¥é”™è¯¯ï¼");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn:9360","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"æ”¯æŒåŒ¿åè¯„è®ºå•¦ï¼Œè‹¥å¸Œæœ›åŠæ—¶æ”¶åˆ°åšä¸»çš„åé¦ˆï¼Œå»ºè®®ç™»å½•è¯„è®ºæˆ–è€…åœ¨ä¸Šæ–¹çš„é‚®ç®±è¾“å…¥æ¡†ç•™ä¸‹é‚®ç®±åœ°å€å“¦ (à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://qiniu.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/app/api/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/6b304602.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>