<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script><meta name="description" content="本文主要介绍 Linux 使用内存缓存减少磁盘 I/O，包括 tmpfs、ramfs、Page Cache 的使用。"><meta property="og:type" content="article"><meta property="og:title" content="Linux 使用内存缓存减少磁盘 I/O"><meta property="og:url" content="https://www.techgrow.cn/posts/3d17ec47.html"><meta property="og:site_name" content="Clay 的技术空间"><meta property="og:description" content="本文主要介绍 Linux 使用内存缓存减少磁盘 I/O，包括 tmpfs、ramfs、Page Cache 的使用。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2025-12-30T11:50:21.000Z"><meta property="article:modified_time" content="2025-12-30T11:50:21.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="Linux运维"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://www.techgrow.cn/posts/3d17ec47.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/3d17ec47.html","path":"posts/3d17ec47.html","title":"Linux 使用内存缓存减少磁盘 I/O"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Linux 使用内存缓存减少磁盘 I/O | Clay 的技术空间</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay 的技术空间" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script>
  (function () {

  // 防止 Pjax 重复绑定事件
  if (window.__moonMenuCodeExpandBound) {
    return;
  }
  window.__moonMenuCodeExpandBound = true;

  const STORAGE_KEY = 'moon_menu_code_fold';

  /* ===============================
   * 1. 设置 moon-menu 按钮的 title
   * =============================== */
  (function bindMoonMenuTitles() {
    const items = [
      { selector: '#moon-menu-item-code',        title: '展开 / 折叠代码块' },
      { selector: '#moon-menu-item-back2top',    title: '回到页面顶部' },
      { selector: '#moon-menu-item-back2bottom', title: '回到页面底部' }
    ];

    let allReady = true;

    items.forEach(item => {
      const el = document.querySelector(item.selector);
      if (!el) {
        allReady = false;
        return;
      }
      el.setAttribute('title', item.title);
    });

    if (!allReady) {
      setTimeout(bindMoonMenuTitles, 100);
    }
  })();

  /* =================================
   * 2. 页面首次加载：代码块恢复展开或折叠状态
   * ================================= */
  function applyStoredCodeState() {
    const containers = document.querySelectorAll('.code-container');
    if (!containers.length) {
      return;
    }

    const state = localStorage.getItem(STORAGE_KEY);
    if (!state) {
      return;
    }

    containers.forEach(container => {
      if (state === 'expanded') {
        // 展开代码块
        container.classList.remove('highlight-fold');
      } else if (state === 'folded') {
        // 折叠代码块
        container.classList.add('highlight-fold');
      }
    });
  }

  // 等代码块出现后，再恢复展开或折叠状态
  function waitAndApplyState() {
    const containers = document.querySelectorAll('.code-container');

    if (!containers.length) {
      setTimeout(waitAndApplyState, 100);
      return;
    }

    applyStoredCodeState();
  }

  // 页面首次加载时恢复状态
  waitAndApplyState();
  
  // Pjax 切换页面后，必须重新恢复状态
  document.addEventListener('pjax:complete', function () {
    waitAndApplyState();
  });

  /* ===============================
   * 3. 点击按钮：切换状态并保存
   * =============================== */
  document.addEventListener('click', function (e) {
    const codeMenu = e.target.closest('#moon-menu-item-code');
    if (!codeMenu) {
      return;
    }

    toggleAllCodeBlocks();
  });

  // 展开或折叠代码块
  function toggleAllCodeBlocks() {
    const containers = document.querySelectorAll('.code-container');
    if (!containers.length) {
      return;
    }

    // 只要存在折叠的代码块，就认为当前是折叠状态
    const hasFolded = Array.from(containers).some(c => {
      return c.classList.contains('highlight-fold');
    });

    containers.forEach(container => {
      if (hasFolded) {
        // 展开代码块
        container.classList.remove('highlight-fold');
      } else {
        // 折叠代码块
        container.classList.add('highlight-fold');
      }
    });

    // 记录展开或折叠状态
    localStorage.setItem(
      STORAGE_KEY,
      hasFolded ? 'expanded' : 'folded'
    );
  }

})();
</script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay 的技术空间</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">用进废退 | 艺不压身</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="搜索" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>搜索</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>读书笔记</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>评论管理</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> 文章目录</li><li class="sidebar-nav-overview"> 站点概览</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A3%81%E7%9B%98-I-O-%E8%AF%8A%E6%96%AD%E5%B7%A5%E5%85%B7"><span class="nav-text">磁盘 I/O 诊断工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#iostat"><span class="nav-text">iostat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#iostat-%E5%AE%89%E8%A3%85"><span class="nav-text">iostat 安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#iostat-%E4%BD%BF%E7%94%A8"><span class="nav-text">iostat 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#iotop"><span class="nav-text">iotop</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#iotop-%E5%AE%89%E8%A3%85"><span class="nav-text">iotop 安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#iotop-%E4%BD%BF%E7%94%A8"><span class="nav-text">iotop 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vmstat"><span class="nav-text">vmstat</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#vmstat-%E6%A6%82%E8%BF%B0"><span class="nav-text">vmstat 概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#vmstat-%E4%BD%BF%E7%94%A8"><span class="nav-text">vmstat 使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A3%81%E7%9B%98-I-O-%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88"><span class="nav-text">磁盘 I/O 优化方案</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#tmpfs"><span class="nav-text">tmpfs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#tmpfs-%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="nav-text">tmpfs 的概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tmpfs-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">tmpfs 的使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ramfs"><span class="nav-text">ramfs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ramfs-%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="nav-text">ramfs 的概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ramfs-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">ramfs 的使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Page-Cache"><span class="nav-text">Page Cache</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Page-Cache-%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="nav-text">Page Cache 的概述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Page-Cache-%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">Page Cache 的使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88%E6%80%BB%E7%BB%93"><span class="nav-text">优化方案总结</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">796</span> <span class="site-state-item-name">文章</span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">56</span> <span class="site-state-item-name">标签</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub → https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail → mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS → /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap → /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/3d17ec47.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay 的技术空间"><meta itemprop="description" content="专注于 Java 后端、分布式、微服务、云原生、数据库、系统架构、大数据、云计算、虚拟化、人工智能学习的技术博客。"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Linux 使用内存缓存减少磁盘 I/O | Clay 的技术空间"><meta itemprop="description" content="本文主要介绍 Linux 使用内存缓存减少磁盘 I/O，包括 tmpfs、ramfs、Page Cache 的使用。"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Linux 使用内存缓存减少磁盘 I/O</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建时间：2025-12-30 19:50:21" itemprop="dateCreated datePublished" datetime="2025-12-30T19:50:21+08:00">2025-12-30</time></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">阅读次数：</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">评论数：</span><a title="waline" href="/posts/3d17ec47.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/3d17ec47.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">本文字数：</span> <span>3.9k</span></span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">阅读时长 ≈</span> <span>4 分钟</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在 Linux 系统中，磁盘 I/O 往往是性能瓶颈。当应用程序频繁读取大文件（例如数据库文件、日志文件、多媒体文件）时，系统可能因为 I/O 等待而变得非常卡顿。为了减少磁盘压力、提升性能，Linux 提供了多种利用内存作为缓存的机制，例如：tmpfs、ramfs、Page Cache（页缓存）。本文将详细介绍这些机制的使用方法及区别，并介绍常用的磁盘 I/O 诊断工具。</p><span id="more"></span><h2 id="磁盘-I-O-诊断工具"><a href="#磁盘-I-O-诊断工具" class="headerlink" title="磁盘 I/O 诊断工具"></a>磁盘 I/O 诊断工具</h2><p>在 Linux 下，查看磁盘的吞吐量（每秒读 / 写的数据量）或者负载（IOPS - 每秒读 / 写的请求数），最常用、最直观的工具有下面几种。</p><table><thead><tr><th>工具</th><th>是否需要安装</th><th>能看具体磁盘</th><th>是否推荐</th></tr></thead><tbody><tr><td><code>iostat</code></td><td>需要</td><td>✅</td><td>⭐⭐⭐⭐⭐</td></tr><tr><td><code>iotop</code></td><td>需要</td><td>间接</td><td>⭐⭐⭐⭐</td></tr><tr><td><code>vmstat</code></td><td>不需要</td><td>❌</td><td>⭐⭐⭐</td></tr></tbody></table><h3 id="iostat"><a href="#iostat" class="headerlink" title="iostat"></a>iostat</h3><p><code>iostat</code> 是最快速的磁盘工具（强烈推荐）。</p><h4 id="iostat-安装"><a href="#iostat-安装" class="headerlink" title="iostat 安装"></a>iostat 安装</h4><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword"># CentOS</span> / RHEL</span><br><span class="line">sudo yum install sysstat</span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"># Debian</span> / Ubuntu</span><br><span class="line">sudo apt install sysstat</span><br></pre></td></tr></tbody></table></figure><h4 id="iostat-使用"><a href="#iostat-使用" class="headerlink" title="iostat 使用"></a>iostat 使用</h4><ul><li><code>iostat</code> 的使用</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat<span class="params"> -x</span> 1</span><br></pre></td></tr></tbody></table></figure><ul><li>输出示例如下：</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           3.59    0.02    1.32    0.33    0.00   94.74</span><br><span class="line"></span><br><span class="line">Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util</span><br><span class="line">sdc               0.09     0.67   33.60   14.91  2100.28  1028.30   128.99     0.32    6.53    2.01   16.73   0.43   2.09</span><br><span class="line">sdb               0.00     0.00    0.17    0.00     9.39     0.00   110.24     0.00    6.75    6.75    0.00   4.22   0.07</span><br><span class="line">sda               0.03     0.31    5.14    0.97   403.47    30.99   142.36     0.09   15.25   11.69   34.10   4.71   2.88</span><br></pre></td></tr></tbody></table></figure><ul><li>重点关注字段</li></ul><table><thead><tr><th>字段</th><th>含义</th><th>如何判断</th></tr></thead><tbody><tr><td><code>%util</code></td><td>磁盘忙碌时间百分比</td><td><strong>接近 100% = 磁盘 I/O 被打满（最重要）</strong>，<code>%util</code> 最高的磁盘 = 当前 I/O 压力最大的磁盘</td></tr><tr><td><code>await</code></td><td>平均 I/O 等待时间（ms）</td><td>等待时间高 = I/O 排队严重</td></tr><tr><td><code>r/s</code></td><td>每秒读的次数</td><td>读的频率，高表示随机读多</td></tr><tr><td><code>w/s</code></td><td>每秒写的次数</td><td>写的频率，高表示随机写多</td></tr><tr><td><code>rkB/s</code></td><td>每秒读取的数据量</td><td>读吞吐量，顺序读场景通常很高</td></tr><tr><td><code>wkB/s</code></td><td>每秒写入的数据量</td><td>写吞吐量，顺序写场景通常很高</td></tr></tbody></table><ul><li>其他字段说明</li></ul><table><thead><tr><th>字段</th><th>含义</th><th>如何判断</th></tr></thead><tbody><tr><td><code>rrqm/s</code></td><td>每秒被合并的读请求数</td><td>值高说明内核在合并顺序读</td></tr><tr><td><code>wrqm/s</code></td><td>每秒被合并的写请求数</td><td>值高说明顺序写、写合并效果好</td></tr><tr><td><code>avgrq-sz</code></td><td>平均每次 I/O 请求大小（KB）</td><td>值小（如 &lt; 16KB）多为随机 I/O；值大多为顺序 I/O</td></tr><tr><td><code>avgqu-sz</code></td><td>平均 I/O 队列长度</td><td>值大于 1 则说明开始排队；持续偏大 = 磁盘处理不过来</td></tr><tr><td><code>r_await</code></td><td>读请求平均等待时间（ms）</td><td>读延迟高，说明读取受阻（数据库、随机读场景重点看）</td></tr><tr><td><code>w_await</code></td><td>写请求平均等待时间（ms）</td><td>写延迟高，常见于日志、落盘、fsync 场景</td></tr><tr><td><code>svctm</code></td><td>平均 I/O 服务时间（ms）</td><td>单次 I/O 被磁盘处理的时间（老指标，仅作参考）</td></tr></tbody></table><ul><li>实战判断口诀<ul><li>磁盘是否被打满？<ul><li>看 <code>%util</code></li></ul></li><li>磁盘为什么慢？<ul><li><code>%util</code> + <code>await</code> + <code>avgqu-sz</code></li></ul></li><li>随机 I/O 还是顺序 I/O？<ul><li><code>avgrq-sz</code> + <code>r/s</code> / <code>w/s</code></li></ul></li><li>是读慢还是写慢？<ul><li><code>r_await</code> vs <code>w_await</code></li></ul></li><li>吞吐瓶颈还是 IOPS 瓶颈？<ul><li><code>rkB/s</code> / <code>wkB/s</code> vs <code>r/s</code> / <code>w/s</code></li></ul></li></ul></li></ul><h3 id="iotop"><a href="#iotop" class="headerlink" title="iotop"></a>iotop</h3><p><code>iotop</code> 是磁盘交互式神器（看进程 + 磁盘）。</p><h4 id="iotop-安装"><a href="#iotop-安装" class="headerlink" title="iotop 安装"></a>iotop 安装</h4><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword"># CentOS</span> / RHEL</span><br><span class="line">sudo yum install iotop</span><br><span class="line"><span class="keyword"></span></span><br><span class="line"><span class="keyword"># Debian</span> / Ubuntu</span><br><span class="line">sudo apt install iotop</span><br></pre></td></tr></tbody></table></figure><h4 id="iotop-使用"><a href="#iotop-使用" class="headerlink" title="iotop 使用"></a>iotop 使用</h4><ul><li><code>iotop</code> 的使用（需要 <code>root</code> 权限）</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo iotop</span><br></pre></td></tr></tbody></table></figure><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或者</span></span><br><span class="line"><span class="comment"># -o 只显示有 I/O 的进程</span></span><br><span class="line"><span class="comment"># -p 显示进程而非线程</span></span><br><span class="line"><span class="comment"># -a 累计 I/O</span></span><br><span class="line">sudo iotop<span class="params"> -oPa</span></span><br></pre></td></tr></tbody></table></figure><ul><li>输出示例如下：</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Total DISK READ:  12.34 M/s | Total DISK WRITE: 56.78 M/s</span><br><span class="line">Actual DISK READ: 12.10 M/s | Actual DISK WRITE: 55.90 M/s</span><br><span class="line">  TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN   IO&gt;    COMMAND</span><br><span class="line">12345 be/4  mysql    1.20 M/s    35.60 M/s    0.00 %  92.34 %  mysqld</span><br><span class="line">23456 be/4  root     8.50 M/s     0.00 B/s    0.00 %  48.12 %  tar czf backup.tar.gz</span><br><span class="line">34567 be/4  www-data 0.00 B/s     15.80 M/s   0.00 %  61.45 %  php-fpm</span><br><span class="line">  987 be/4  root     0.00 B/s     2.10 M/s    0.00 %   5.23 %  jbd2/sda1-8</span><br></pre></td></tr></tbody></table></figure><ul><li>字段说明</li></ul><table><thead><tr><th>字段</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td><code>Total DISK READ</code></td><td>总读请求速率</td><td>所有进程发起的磁盘读取速率（总读请求速率）</td></tr><tr><td><code>Total DISK WRITE</code></td><td>总写请求速率</td><td>所有进程发起的磁盘写入速率（总写请求速率）</td></tr><tr><td><code>Actual DISK READ</code></td><td>实际读速率</td><td>实际落盘的磁盘读取速率（受页缓存命中情况影响）</td></tr><tr><td><code>Actual DISK WRITE</code></td><td>实际写速率</td><td>实际落盘的磁盘写入速率（受页缓存、写合并等机制影响）</td></tr><tr><td><code>TID</code></td><td>Thread ID</td><td> 线程 ID（比 PID 更细粒度）</td></tr><tr><td><code>PRIO</code></td><td>I/O 优先级</td><td><code>be</code> = best effort（普通优先级）</td></tr><tr><td><code>USER</code></td><td>进程所属用户</td><td>进程运行的用户</td></tr><tr><td><code>DISK READ</code></td><td>磁盘读取速率</td><td>该进程每秒从磁盘读取的数据量</td></tr><tr><td><code>DISK WRITE</code></td><td>磁盘写入速率</td><td>该进程每秒写入磁盘的数据量</td></tr><tr><td><code>SWAPIN</code></td><td>换页占比</td><td>因内存不足导致的换页 I/O 百分比</td></tr><tr><td><code>IO&gt;</code></td><td>I/O 等待占比</td><td><strong>最重要：进程被磁盘 I/O 阻塞的时间比例</strong></td></tr><tr><td><code>COMMAND</code></td><td>命令名</td><td>进程 / 线程名称</td></tr></tbody></table><ul><li>排查磁盘 I/O 瓶颈时重点关注的字段<ul><li><code>IO&gt;</code>（最重要）<ul><li>举例：<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IO&gt;  92.34 %</span><br></pre></td></tr></tbody></table></figure></li><li>含义：<ul><li>进程 92% 的时间在等磁盘 I/O</li><li> 几乎可以确定：磁盘是瓶颈</li></ul></li><li>判断规则：<ul><li><code>IO&gt; &gt; 30%</code> → I/O 明显慢</li><li><code>IO&gt; &gt; 60%</code> → 严重 I/O 阻塞</li><li><code>IO&gt; &gt; 80%</code> → 磁盘被打爆</li></ul></li></ul></li><li><code>DISK READ / DISK WRITE</code><ul><li>举例：<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DISK WRITE 35.60 M/s</span><br></pre></td></tr></tbody></table></figure></li><li>用来判断：<ul><li>磁盘是读取多，还是写入多</li><li>磁盘是否有异常的大流量进程</li></ul></li><li>特别注意：<ul><li>磁盘吞吐量高 ≠ 磁盘一定慢</li><li>必须结合 <code>IO&gt;</code> 来判断才有意义</li></ul></li></ul></li><li><code>Total / Actual</code> 顶部汇总行（系统级）<ul><li>举例：<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Total DISK READ:  12.34 M/s | Total DISK WRITE: 56.78 M/s</span><br><span class="line">Actual DISK READ: 12.10 M/s | Actual DISK WRITE: 55.90 M/s</span><br></pre></td></tr></tbody></table></figure></li><li>字段：<ul><li><code>Total DISK READ</code>：所有进程发起的磁盘读取速率（总读请求速率）</li><li><code>Total DISK WRITE</code>：所有进程发起的磁盘写入速率（总写请求速率）</li><li><code>Actual DISK READ</code>：实际落盘的磁盘读取速率（受页缓存命中情况影响）</li><li><code>Actual DISK WRITE</code>：实际落盘的磁盘写入速率（受页缓存、写合并等机制影响）</li></ul></li><li><code>Total</code> 与 <code>Actual</code> 两者差距大的可能原因<ul><li> Page Cache（页缓存）命中高</li><li>写请求被缓存 / 合并</li></ul></li></ul></li></ul></li></ul><h3 id="vmstat"><a href="#vmstat" class="headerlink" title="vmstat"></a>vmstat</h3><p><code>vmstat</code> 无需安装，缺点只能看整体的磁盘 I/O 吞吐量，看不到具体的磁盘。</p><h4 id="vmstat-概述"><a href="#vmstat-概述" class="headerlink" title="vmstat 概述"></a>vmstat 概述</h4><ul><li><code>vmstat</code> 适合用来判断的事情</li></ul><table><thead><tr><th>适用场景</th><th>用法</th></tr></thead><tbody><tr><td>是否有磁盘读写行为</td><td>看 <code>bi</code> / <code>bo</code> 是否为 0</td></tr><tr><td> 是否突然爆发 I/O</td><td> 看是否瞬间飙升</td></tr><tr><td>写入型 / 读取型的吞吐量</td><td>对比 <code>bi</code> vs <code>bo</code></td></tr></tbody></table><ul><li><code>vmstat</code> 不适合用来判断的事情</li></ul><table><thead><tr><th>不适用场景</th><th>原因</th></tr></thead><tbody><tr><td>哪块磁盘 I/O 最高</td><td>看不到具体磁盘</td></tr><tr><td>磁盘是否打满</td><td>没有 <code>%util</code></td></tr><tr><td>I/O 是否排队</td><td>没有 <code>await</code></td></tr></tbody></table><h4 id="vmstat-使用"><a href="#vmstat-使用" class="headerlink" title="vmstat 使用"></a>vmstat 使用</h4><ul><li><code>vmstat</code> 的使用</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vmstat 1</span><br></pre></td></tr></tbody></table></figure><ul><li>输出示例如下：</li></ul><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span><br><span class="line"> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span><br><span class="line"> 1  0      0 24642772 6851660 22099404    0    0    50    16  133   71  3  1 95  0  0</span><br><span class="line"> 0  0      0 24644776 6851660 22096364    0    0     0    37 10080 9298  1  0 98  0  0</span><br><span class="line"> 0  0      0 24644308 6851660 22096384    0    0     0   409 3063 8706  1  0 99  0  0</span><br><span class="line"> 0  0      0 24652476 6851660 22096388    0    0     0   226 3145 8780  1  0 99  0  0</span><br><span class="line"> 0  0      0 24640804 6851660 22096400    0    0     0     0 4060 10007  1  1 98  0  0</span><br></pre></td></tr></tbody></table></figure><ul><li><p>重点关注字段</p><ul><li><code>bi</code>（Block In）<ul><li>每秒从块设备读取的数据量（磁盘读流量），单位：KB/s</li><li> 不是针对某一块磁盘，而是所有块设备的读吞吐量总和</li><li><code>bi</code> 高，表示系统正在大量从磁盘读取数据</li></ul></li><li><code>bo</code>（Block Out）<ul><li>每秒写入块设备的数据量（磁盘写流量），单位：KB/s</li><li> 不是针对某一块磁盘，而是所有块设备的写吞吐量总和</li><li><code>bo</code> 高，表现系统正在大量向磁盘写数据</li></ul></li></ul></li><li><p>使用注意事项</p><ul><li><code>vmstat</code> 关注的是「磁盘吞吐量」，而不是「磁盘负载」</li><li><code>bi / bo</code> 高 ≠ 磁盘一定忙</li><li>磁盘顺序读写时：<ul><li><code>bi / bo</code> 很高</li><li>但磁盘可能很轻松</li></ul></li><li>磁盘随机读写时：<ul><li><code>bi / bo</code> 不高</li><li>磁盘却可能被打满</li></ul></li><li>不能用 <code>vmstat</code> 来判断磁盘 I/O 瓶颈<ul><li><code>bi / bo</code> 是全系统汇总值</li><li>只能判断 “有没有磁盘读写”</li><li> 不能判断 “哪个磁盘最忙”</li><li> 不能判断 “某个磁盘是否打满”</li></ul></li></ul></li></ul><h2 id="磁盘-I-O-优化方案"><a href="#磁盘-I-O-优化方案" class="headerlink" title="磁盘 I/O 优化方案"></a>磁盘 I/O 优化方案</h2><h3 id="tmpfs"><a href="#tmpfs" class="headerlink" title="tmpfs"></a>tmpfs</h3><h4 id="tmpfs-的概述"><a href="#tmpfs-的概述" class="headerlink" title="tmpfs 的概述"></a>tmpfs 的概述</h4><ul><li><p><code>tmpfs</code> 是一种基于内存的文件系统：</p><ul><li>文件实际存储在内存 + 交换分区（Swap）中</li><li>支持容量限制（挂载时可指定大小）</li><li>内存不足时，tmpfs 文件可以被交换到 Swap</li><li>tmpfs 的文件内容本质上就是 Page Cache</li><li> 不会导致 OOM（Out of Memory）</li><li>适合存放临时文件、缓存数据</li><li>典型的挂载点：<code>/dev/shm</code>、<code>/run</code></li></ul></li><li><p><code>tmpfs</code> 的主要特点</p><ul><li>支持创建目录（无限层级）</li><li>支持普通文件</li><li>支持符号链接、硬链接</li><li>支持权限、UID/GID</li><li> 支持文件删除（立即释放内存）</li><li>支持调整大小（动态扩缩）</li><li><strong>系统重启后会丢失所有数据</strong></li></ul></li><li><p><code>tmpfs</code> 的适用场景</p><ul><li>程序临时文件</li><li>加速频繁读写的小文件</li><li>构建系统（<code>make</code>、<code>npm</code>、<code>cargo</code> 等）</li><li>OBS、FFmpeg 等读取多媒体文件减少磁盘压力</li></ul></li></ul><h4 id="tmpfs-的使用"><a href="#tmpfs-的使用" class="headerlink" title="tmpfs 的使用"></a>tmpfs 的使用</h4><ul><li>创建挂载点</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir<span class="params"> -p</span> /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><ul><li>挂载 tmpfs</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 比如限制 4GB 容量</span></span><br><span class="line">sudo mount<span class="params"> -t</span> tmpfs<span class="params"> -o</span> size=4G tmpfs /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><ul><li>验证挂载</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df<span class="params"> -h</span> /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><ul><li>开机自动挂载（可选）</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑 fstab 系统配置文件，添加以下配置内容</span></span><br><span class="line">sudo vim /etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="comment"># 挂载 fstab 中所有自动挂载的文件系统，并检测配置是否正确</span></span><br><span class="line">sudo mount<span class="params"> -a</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tmpfs /mnt/ramdisk tmpfs defaults,size=4G 0 0</span><br></pre></td></tr></tbody></table></figure><ul><li>卸载挂载（可选）</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo umount /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><h3 id="ramfs"><a href="#ramfs" class="headerlink" title="ramfs"></a>ramfs</h3><h4 id="ramfs-的概述"><a href="#ramfs-的概述" class="headerlink" title="ramfs 的概述"></a>ramfs 的概述</h4><ul><li><p><code>ramfs</code> 是最简单的内存文件系统：</p><ul><li>数据存储在纯内存中</li><li>没有容量限制</li><li>内存写满后系统不会阻止继续写入，会持续占用内存</li><li>内存耗尽就会 OOM，最终导致系统宕机</li><li>更像一个危险，但读写速度极快的文件系统</li></ul></li><li><p><code>ramfs</code> 的主要特点</p><ul><li>支持创建目录（无限层级）</li><li>支持普通文件</li><li>支持符号链接、硬链接</li><li>支持权限、UID/GID</li><li> 支持文件删除（立即释放内存）</li><li>不支持大小限制（不能设置 Size，容量可无限增长）</li><li>数据页不可回收（不会被内核回收）</li><li>不支持 Swap Out（永远驻留物理内存中）</li><li>容易导致系统 OOM（写入越多，内存占用越多）</li><li><strong>系统重启后会丢失所有数据</strong></li></ul></li><li><p><code>ramfs</code> 的适用场景</p><ul><li>极端场景下的高性能缓存</li><li>只用于开发 / 研究，不建议生产环境使用</li></ul></li></ul><h4 id="ramfs-的使用"><a href="#ramfs-的使用" class="headerlink" title="ramfs 的使用"></a>ramfs 的使用</h4><ul><li>创建挂载点</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir<span class="params"> -p</span> /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><ul><li>挂载 ramfs</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mount<span class="params"> -t</span> ramfs ramfs /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><ul><li>开机自动挂载（可选）</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑 fstab 系统配置文件，添加以下配置内容</span></span><br><span class="line">sudo vim /etc/fstab</span><br><span class="line"></span><br><span class="line"><span class="comment"># 挂载 fstab 中所有自动挂载的文件系统，并检测配置是否正确</span></span><br><span class="line">sudo mount<span class="params"> -a</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ramfs   /mnt/ramdisk   ramfs   defaults   0   0</span><br></pre></td></tr></tbody></table></figure><ul><li>卸载挂载（可选）</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo umount /mnt/ramdisk</span><br></pre></td></tr></tbody></table></figure><div class="admonition warning"><p class="admonition-title">特别注意</p><p>由于 ramfs 没有容量限制，如果程序写入大量数据会导致系统 OOM。</p></div><h3 id="Page-Cache"><a href="#Page-Cache" class="headerlink" title="Page Cache"></a>Page Cache</h3><h4 id="Page-Cache-的概述"><a href="#Page-Cache-的概述" class="headerlink" title="Page Cache 的概述"></a>Page Cache 的概述</h4><p>即使用户不主动使用 tmpfs 或 ramfs 文件系统，Linux 内核本身也会自动利用内存作为 “磁盘缓存”。当用户读取一个文件时：</p><ul><li>内核将数据加载到操作系统的 Page Cache（页缓存）</li><li>下次读取同一个文件时，不再触发磁盘 I/O，直接从内存返回结果</li></ul><h4 id="Page-Cache-的使用"><a href="#Page-Cache-的使用" class="headerlink" title="Page Cache 的使用"></a>Page Cache 的使用</h4><ul><li>将文件写入 Page Cache</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat video.mp4 &gt; /dev/null</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">上述命令会：</span><br><span class="line">- 强制把 `video.mp4` 文件从磁盘加载进内存</span><br><span class="line">- 但不输出任何内容</span><br><span class="line">- 后续程序读取 `video.mp4` 文件会命中缓存，不再产生磁盘 I/O</span><br></pre></td></tr></tbody></table></figure><ul><li>查看缓存使用情况</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看内存使用情况，会看到 buff/cache 部分增大</span></span><br><span class="line">free<span class="params"> -h</span></span><br></pre></td></tr></tbody></table></figure><ul><li>清除缓存（<strong>慎用，仅测试使用</strong>）</li></ul><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将所有文件系统的缓存数据写回磁盘</span></span><br><span class="line">sudo sync</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理页缓存、目录缓存和 inode 缓存</span></span><br><span class="line">sudo sh<span class="params"> -c</span> <span class="string">'echo 3 &gt; /proc/sys/vm/drop_caches'</span></span><br></pre></td></tr></tbody></table></figure><div class="admonition warning"><p class="admonition-title">特别注意</p><p>在 Linux 生产环境中，不建议随意清缓存，否则会影响系统性能。</p></div><h3 id="优化方案总结"><a href="#优化方案总结" class="headerlink" title="优化方案总结"></a>优化方案总结</h3><ul><li><code>tmpfs</code>、<code>ramfs</code>、Page Cache 的优缺点</li></ul><table><thead><tr><th>技术</th><th>优点</th><th>缺点</th><th>适用场景</th></tr></thead><tbody><tr><td> tmpfs</td><td> 快、可限制容量、安全</td><td>占用系统内存</td><td>缓存文件、临时空间、多媒体文件读取</td></tr><tr><td> ramfs</td><td> 极快</td><td>不限容量，OOM 风险高</td><td>测试、高速缓存（不推荐生产环境使用）</td></tr><tr><td>Page Cache</td><td> 自动、透明、无需修改程序</td><td>缓存不可控、可能被挤掉</td><td>文件预加载（热加载）</td></tr></tbody></table><ul><li><code>tmpfs</code> 与 <code>ramfs</code> 的主要区别</li></ul><table><thead><tr><th>特性</th><th> tmpfs</th><th>ramfs</th></tr></thead><tbody><tr><td> 存储位置</td><td>内存 + Swap</td><td> 纯内存（永远不使用 Swap）</td></tr><tr><td>内存限制</td><td>可限制大小（推荐）</td><td>不可限制，体积可无限增长</td></tr><tr><td>系统内存压力大时</td><td>会将部分数据 Swap 出去</td><td>继续占用内存，最终导致系统 OOM</td></tr><tr><td> 默认缓存行为</td><td>文件内容存放在 Page Cache 中，这些页是可回收的，内核在内存压力大时可以回收或 Swap Out</td><td> 文件内容同样存放在 Page Cache 中，但被标记为不可回收，不会 Swap Out，也不会被回收，因此会永久占用物理内存</td></tr><tr><td> OOM 风险</td><td>低（可回收）</td><td>极高（不可回收）</td></tr><tr><td>性能</td><td>与 ramfs 速度差异极小，几乎相同</td><td>比如 tmpfs 略快，但差距可以忽略</td></tr><tr><td>适用场景</td><td>安全缓存、高性能临时存储</td><td>特殊场景、嵌入式、需要可预测行为</td></tr></tbody></table><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"全栈技术驿站",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>支持一根棒棒糖！</div> <button> 赞赏</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay 微信"> <span>微信</span></div><div> <img src="/img/pay_zfb.png" alt="Clay 支付宝"> <span>支付宝</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>本文作者：</strong> Clay</li><li class="post-copyright-link"> <strong>本文链接：</strong> <a href="https://www.techgrow.cn/posts/3d17ec47.html" title="Linux 使用内存缓存减少磁盘 I/O">https://www.techgrow.cn/posts/3d17ec47.html</a></li><li class="post-copyright-license"> <strong>版权声明：</strong> 本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">欢迎添加博主微信，请备注 "博客"，届时会邀请您加入百人微信群</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/Linux%E8%BF%90%E7%BB%B4/" rel="tag"><i class="fa fa-tag"></i> Linux运维</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/54626c2e.html" rel="prev" title="DevOps 的技术选型介绍"><i class="fa fa-angle-left"></i> DevOps 的技术选型介绍</a></div><div class="post-nav-item"> <a href="/posts/860c6c02.html" rel="next" title="近期学习计划">近期学习计划<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright © 2018 – <span itemprop="copyrightYear">2026</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>站点总字数：</span> <span title="站点总字数">2.4m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>站点阅读时长 ≈</span> <span title="站点阅读时长">35:45</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" 年 "+s+" 日 "+d+" 小时 "+l+" 分钟 "+u+" 秒 "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">粤ICP备 19024664号-1</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">粤公网安备 44011302004035号</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"/lib/mathjax/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script><script src="/js/third-party/math/mathjax.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/api/oss/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，非法请求来源！");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，上传过于频繁！");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "图片上传失败，无法获取UploadToken，系统内部出错！");
        } else {
          alert("图片上传失败，无法获取UploadToken，未知Http响应状态码！");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("图片上传失败，无法获取UploadToken，未知错误！");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"支持匿名评论啦，若希望及时收到博主的反馈，建议登录评论或者在上方的邮箱输入框留下邮箱地址哦 (๑•̀ㅂ•́)و✧"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/api/oss/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/3d17ec47.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div><div id="moon-menu-item-code" class="moon-menu-item"><i class="fa-solid fa-code"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>