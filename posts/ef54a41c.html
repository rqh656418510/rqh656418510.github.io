<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.0"><link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico"><link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico"><link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico"><link rel="mask-icon" href="/favicon.ico" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic%7CRoboto+Slab:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext"><link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="/lib/pace-js/themes/blue/pace-theme-minimal.css"><script src="/lib/pace-js/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"www.techgrow.cn","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"flat"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"}}</script><script src="/js/config.js"></script><meta name="description" content="æœ¬æ–‡ä¸»è¦ä»‹ç» Java ä¸ Dubbo çš„ SPI æœºåˆ¶ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="Java ä¸ Dubbo çš„ SPI æœºåˆ¶ä»‹ç»"><meta property="og:url" content="https://www.techgrow.cn/posts/ef54a41c.html"><meta property="og:site_name" content="Clay çš„æŠ€æœ¯ç©ºé—´"><meta property="og:description" content="æœ¬æ–‡ä¸»è¦ä»‹ç» Java ä¸ Dubbo çš„ SPI æœºåˆ¶ã€‚"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-spi-1.png"><meta property="article:published_time" content="2025-10-12T15:42:35.000Z"><meta property="article:modified_time" content="2025-10-12T15:42:35.000Z"><meta property="article:author" content="Clay"><meta property="article:tag" content="RPC"><meta property="article:tag" content="Java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://www.techgrow.cn/asset/2025/09/dubbo-spi-1.png"><link rel="canonical" href="https://www.techgrow.cn/posts/ef54a41c.html"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.techgrow.cn/posts/ef54a41c.html","path":"posts/ef54a41c.html","title":"Java ä¸ Dubbo çš„ SPI æœºåˆ¶ä»‹ç»"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Java ä¸ Dubbo çš„ SPI æœºåˆ¶ä»‹ç» | Clay çš„æŠ€æœ¯ç©ºé—´</title><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-135294383-1"></script><script class="next-config" data-name="google_analytics" type="application/json">{"tracking_id":"UA-135294383-1","only_pageview":false,"measure_protocol_api_secret":null}</script><script src="/js/third-party/analytics/google-analytics.js"></script><script class="next-config" data-name="baidu_analytics" type="application/json">"84c09b30349a65573c5c642ff336969b"</script><script src="/js/third-party/analytics/baidu-analytics.js"></script><link rel="dns-prefetch" href="https://waline.techgrow.cn"><link rel="stylesheet" type="text/css" href="/css/injector/main.css"><link rel="preload" as="style" href="/css/injector/light.css"><link rel="preload" as="style" href="/css/injector/dark.css"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><style>.admonition{margin:1.5625em 0;padding:.6rem;overflow:hidden;font-size:.64rem;page-break-inside:avoid;border-left:.3rem solid #42b983;border-radius:.3rem;box-shadow:0 .1rem .4rem rgba(0,0,0,.05),0 0 .05rem rgba(0,0,0,.1);background-color:#fafafa}p.admonition-title{position:relative;margin:-.6rem -.6rem .8em -.6rem!important;padding:.4rem .6rem .4rem 2.5rem;font-weight:700;background-color:rgba(66,185,131,.1)}.admonition-title::before{position:absolute;top:.9rem;left:1rem;width:12px;height:12px;background-color:#42b983;border-radius:50%;content:' '}.info>.admonition-title,.todo>.admonition-title{background-color:rgba(0,184,212,.1)}.attention>.admonition-title,.caution>.admonition-title,.warning>.admonition-title{background-color:rgba(255,145,0,.1)}.error>.admonition-title,.fail>.admonition-title,.failure>.admonition-title,.missing>.admonition-title{background-color:rgba(255,82,82,.1)}.admonition.info,.admonition.todo{border-color:#00b8d4}.admonition.attention,.admonition.caution,.admonition.warning{border-color:#ff9100}.admonition.error,.admonition.fail,.admonition.failure,.admonition.missing{border-color:#ff5252}.info>.admonition-title::before,.todo>.admonition-title::before{background-color:#00b8d4;border-radius:50%}.attention>.admonition-title::before,.caution>.admonition-title::before,.warning>.admonition-title::before{background-color:#ff9100;border-radius:50%}.error>.admonition-title::before,.fail>.admonition-title::before,.failure>.admonition-title::before,.missing>.admonition-title::before{background-color:#ff5252;border-radius:50%}.admonition>:last-child{margin-bottom:0!important}</style><link rel="alternate" href="/atom.xml" title="Clay çš„æŠ€æœ¯ç©ºé—´" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" class="use-motion"><script src="/lib/jquery/dist/jquery.min.js"></script><script data-pjax="">!function(){var t=window.location.host;if(-1==t.indexOf("127.0.0.1")&&-1==t.indexOf("localhost")){var o=document.createElement("script"),e=window.location.protocol.split(":")[0];o.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(o,n)}}()</script><link rel="stylesheet" href="/lib/aplayer/dist/APlayer.min.css"><div id="aplayer" style="display:none"></div><script src="/lib/aplayer/dist/APlayer.min.js"></script><script src="/lib/aplayer/dist/color-thief.js"></script><script src="/lib/aplayer-init.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js"></script><script>function getTitle(){var t=jQuery("meta[property='og:title']");return t?t.attr("content"):""}function getDesc(){var t=jQuery("meta[property='og:description']");return t?t.attr("content"):""}function randomString(t){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,i="",r=0;r<t;++r)i+=e.charAt(Math.floor(Math.random()*n));return i}function initWx(t){wx.config({debug:!1,appId:t.appId,nonceStr:t.nonceStr,signature:t.signature,timestamp:t.timestamp,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ"]}),wx.ready(function(){wx.onMenuShareTimeline({title:t.title,link:t.link,imgUrl:t.imgUrl,success:function(){}}),wx.onMenuShareAppMessage({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,type:"link",dataUrl:"",success:function(){}}),wx.onMenuShareQQ({title:t.title,desc:t.desc,link:t.link,imgUrl:t.imgUrl,success:function(){},cancel:function(){}})}),wx.error(function(t){})}jQuery(function(){var e=getDesc(),n=getTitle(),i=randomString(16),r=(new Date).getTime(),a=window.location.href,t="https://open.techgrow.cn/api/wechat/js/signature?url="+a+"&noncestr="+i+"&timestamp="+r;jQuery.getJSON(t,function(t){initWx({desc:e,title:n,link:a,nonceStr:i,timestamp:r,signature:t.data,appId:"wx1fcf69355af43d41",imgUrl:"https://www.techgrow.cn/img/wx_share.jpg"})})})</script><div style="display:none"><img src="https://www.techgrow.cn/img/wx_share.jpg" alt=""></div><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">Clay çš„æŠ€æœ¯ç©ºé—´</p><i class="logo-line"></i></a><p class="site-subtitle" itemprop="description">ç”¨è¿›åºŸé€€ | è‰ºä¸å‹èº«</p></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="æœç´¢" role="button"></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-search"><a href="/search" rel="section"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li><li class="menu-item menu-item-links"><a href="/links" rel="section"><i class="fas fa-link fa-fw"></i>å‹é“¾</a></li><li class="menu-item menu-item-readingnotes"><a href="https://www.techgrow.cn/reading/" rel="section"><i class="fa fa-book-open-reader fa-fw"></i>è¯»ä¹¦ç¬”è®°</a></li><li class="menu-item menu-item-commentmanage"><a href="https://waline.techgrow.cn/" rel="external nofollow" target="_blank"><i class="fa fa-comment fa-fw"></i>è¯„è®ºç®¡ç†</a></li></ul></nav></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc"> æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview"> ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-SPI-%E6%9C%BA%E5%88%B6"><span class="nav-text">Java SPI æœºåˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D"><span class="nav-text">æ¦‚å¿µä»‹ç»</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dubbo-SPI-%E6%9C%BA%E5%88%B6"><span class="nav-text">Dubbo SPI æœºåˆ¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A6%82%E5%BF%B5%E4%BB%8B%E7%BB%8D-1"><span class="nav-text">æ¦‚å¿µä»‹ç»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8A%A0%E8%BD%BD%E6%B5%81%E7%A8%8B"><span class="nav-text">åŠ è½½æµç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%B3%A8%E8%A7%A3"><span class="nav-text">æ ¸å¿ƒæ³¨è§£</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="nav-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" alt="Clay" src="/img/head.jpg"></div><div class="site-state-wrap animated"><nav class="site-state"><div class="site-state-item site-state-posts"> <span class="site-state-item-count">759</span> <span class="site-state-item-name">æ–‡ç« </span></div><div class="site-state-item site-state-tags"> <span class="site-state-item-count">54</span> <span class="site-state-item-name">æ ‡ç­¾</span></div></nav></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/rqh656418510" title="GitHub â†’ https://github.com/rqh656418510" rel="external nofollow" target="_blank"><i class="fab fa-github fa-fw"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:rong656418510@gmail.com" title="E-Mail â†’ mailto:rong656418510@gmail.com" rel="external nofollow" target="_blank"><i class="fa fa-envelope fa-fw"></i> E-Mail</a></span><span class="links-of-author-item"><a href="/atom.xml" title="RSS â†’ /atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i> RSS</a></span><span class="links-of-author-item"><a href="/sitemap.xml" title="SiteMap â†’ /sitemap.xml" rel="noopener me"><i class="fa fa-sitemap fa-fw"></i> SiteMap</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope="" itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://www.techgrow.cn/posts/ef54a41c.html"><span hidden="" itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="image" content="/img/head.jpg"><meta itemprop="name" content="Clay"></span><span hidden="" itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Clay çš„æŠ€æœ¯ç©ºé—´"><meta itemprop="description" content="ä¸“æ³¨äº Java åç«¯ã€åˆ†å¸ƒå¼ã€å¾®æœåŠ¡ã€äº‘åŸç”Ÿã€æ•°æ®åº“ã€ç³»ç»Ÿæ¶æ„ã€å¤§æ•°æ®ã€äº‘è®¡ç®—ã€è™šæ‹ŸåŒ–ã€äººå·¥æ™ºèƒ½å­¦ä¹ çš„æŠ€æœ¯åšå®¢ã€‚"></span><span hidden="" itemprop="post" itemscope="" itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Java ä¸ Dubbo çš„ SPI æœºåˆ¶ä»‹ç» | Clay çš„æŠ€æœ¯ç©ºé—´"><meta itemprop="description" content="æœ¬æ–‡ä¸»è¦ä»‹ç» Java ä¸ Dubbo çš„ SPI æœºåˆ¶ã€‚"></span><header class="post-header"><h1 class="post-title" itemprop="name headline"> Java ä¸ Dubbo çš„ SPI æœºåˆ¶ä»‹ç»</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i></span> <span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2025-10-12 23:42:35" itemprop="dateCreated datePublished" datetime="2025-10-12T23:42:35+08:00">2025-10-12</time></span><span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°" id="busuanzi_container_page_pv"><span class="post-meta-item-icon"><i class="far fa-eye"></i></span> <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i></span> <span class="post-meta-item-text">è¯„è®ºæ•°ï¼š</span><a title="waline" href="/posts/ef54a41c.html#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/posts/ef54a41c.html" itemprop="commentCount"></span></a></span><span class="post-meta-item" title="æœ¬æ–‡å­—æ•°"><span class="post-meta-item-icon"><i class="far fa-file-word"></i></span> <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span> <span>3.7k</span></span><span class="post-meta-item" title="é˜…è¯»æ—¶é•¿"><span class="post-meta-item-icon"><i class="far fa-clock"></i></span> <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ â‰ˆ</span> <span>3 åˆ†é’Ÿ</span></span></div></div></header><div class="post-body post-container" itemprop="articleBody" id="readmore-container"><h2 id="Java-SPI-æœºåˆ¶"><a href="#Java-SPI-æœºåˆ¶" class="headerlink" title="Java SPI æœºåˆ¶"></a>Java SPI æœºåˆ¶</h2><h3 id="æ¦‚å¿µä»‹ç»"><a href="#æ¦‚å¿µä»‹ç»" class="headerlink" title="æ¦‚å¿µä»‹ç»"></a>æ¦‚å¿µä»‹ç»</h3><p>Java åŸç”Ÿæ”¯æŒ SPI æœºåˆ¶ï¼Œå…·ä½“ä»‹ç»å¦‚ä¸‹ï¼š</p><ul><li><strong>æ ¸å¿ƒæ¦‚å¿µ</strong><ul><li> SPIï¼ˆService Provider Interfaceï¼‰æ˜¯ä¸€ç§æœåŠ¡å‘ç°æœºåˆ¶ã€‚</li><li>SPI çš„æ ¸å¿ƒæ€æƒ³æ˜¯å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œç”±å¤šä¸ªå®ç°ç±»æä¾›ä¸åŒçš„å®ç°æ–¹å¼ï¼Œåœ¨ç³»ç»Ÿè¿è¡Œæ—¶æ ¹æ®é…ç½®æˆ–è€…é»˜è®¤ç­–ç•¥ï¼ŒåŠ¨æ€åŠ è½½å¹¶ä½¿ç”¨å…·ä½“çš„å®ç°ç±»ã€‚</li><li>SPI çš„æœ¬è´¨æ˜¯å°†æ¥å£å®ç°ç±»çš„å…¨é™å®šåé…ç½®åœ¨æ–‡ä»¶ä¸­ï¼Œå¹¶ç”±æœåŠ¡åŠ è½½å™¨è¯»å–é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½å®ç°ç±»ã€‚è¿™æ ·å°±å¯ä»¥åœ¨è¿è¡Œæ—¶ï¼ŒåŠ¨æ€ä¸ºæ¥å£æ›¿æ¢å®ç°ç±»ã€‚</li></ul></li></ul><span id="more"></span><ul><li><p><strong>å·¥ä½œåŸç†</strong></p><ul><li>(1) æ¥å£ä¸å®ç°ç±»<ul><li>å‡è®¾æœ‰ä¸€ä¸ªæ¥å£ <code>A</code>ï¼Œå®ƒæœ‰å¤šä¸ªå®ç°ç±»ï¼š<code>A -&gt; A1ã€A2ã€A3</code>ã€‚</li></ul></li><li>(2) é…ç½®å®ç°ç±»<ul><li>å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šæ¥å£ <code>A</code> å¯¹åº”ä½¿ç”¨å“ªä¸ªå®ç°ç±»ã€‚</li></ul></li><li>(3) è¿è¡Œæ—¶åŠ è½½<ul><li>ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¼šè¯»å–é…ç½®æ–‡ä»¶ï¼Œæ ¹æ®é…ç½®ä¿¡æ¯æ‰¾åˆ°å¯¹åº”çš„å®ç°ç±»ï¼Œå®ä¾‹åŒ–å¹¶ä½¿ç”¨è¯¥å¯¹è±¡ã€‚</li></ul></li><li>(4) Java åŸç”Ÿ SPI æœºåˆ¶<ul><li> Java åŸç”Ÿ SPI æœºåˆ¶çš„ä½¿ç”¨è¦æ±‚ï¼š<ul><li>åœ¨ <code>resources/META-INF/services/</code> ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªä¸æ¥å£å…¨é™å®šåç›¸åŒçš„æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š<code>resources/META-INF/services/com.example.service.A</code></li><li>æ–‡ä»¶å†…å®¹çš„æ ¼å¼æ˜¯ä¸€è¡Œä¸€ä¸ªå®ç°ç±»çš„å…¨é™å®šåï¼ˆå¯ä»¥æœ‰å¤šè¡Œï¼Œå³æ”¯æŒå¤šä¸ªä¸åŒçš„å®ç°ç±»ï¼‰ï¼Œä¾‹å¦‚ï¼š<code>com.example.service.impl.A1</code>ã€‚</li><li>è¿è¡Œæ—¶é€šè¿‡ <code>ServiceLoader</code> ç­‰å·¥å…·æ‰«æä¾èµ–çš„ Jar åŒ…ï¼Œåœ¨å…¶ä¸­æŸ¥æ‰¾è¯¥æ–‡ä»¶ï¼Œå¹¶åŠ è½½æŒ‡å®šçš„å®ç°ç±»ï¼Œæ¯”å¦‚ï¼š<code>ServiceLoader&lt;HelloService&gt; loader = ServiceLoader.load(HelloService.class);</code></li></ul></li></ul></li></ul></li><li><p><strong>åº”ç”¨åœºæ™¯</strong></p><ul><li>SPI æœºåˆ¶å¸¸ç”¨äºæ’ä»¶å¼æ‰©å±•ã€‚</li><li>æ¯”å¦‚ï¼šå¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ªæ¡†æ¶ï¼Œå¯ä»¥é€šè¿‡ SPI è®©å¤–éƒ¨å¼€å‘è€…ç¼–å†™æ’ä»¶ï¼Œæ‰©å±•æ¡†æ¶çš„åŠŸèƒ½ï¼Œè€Œä¸å¿…ä¿®æ”¹æ¡†æ¶çš„æºç ã€‚</li></ul></li><li><p><strong>å…¸å‹æ¡ˆä¾‹</strong></p><ul><li>JDBC<ul><li>Java æ ‡å‡†åº“åªå®šä¹‰äº†ä¸€å¥— JDBC æ¥å£ï¼Œå¹¶æ²¡æœ‰çœŸæ­£çš„å®ç°ã€‚</li><li>æ•°æ®åº“å‚å•†ï¼ˆå¦‚ MySQLã€Oracleï¼‰ä¼šæä¾›è‡ªå·±çš„å®ç°ï¼Œå¹¶é€šè¿‡ SPI æœºåˆ¶å£°æ˜åœ¨ <code>resources/META-INF/services/</code> ç›®å½•ä¸­ã€‚</li><li>è¿è¡Œæ—¶ï¼ŒJava ä¼šæ ¹æ®é¡¹ç›®å¼•å…¥çš„æ•°æ®åº“é©±åŠ¨ Jar åŒ…ï¼Œè‡ªåŠ¨æ‰¾åˆ°å¯¹åº”çš„ JDBC å®ç°ç±»ã€‚</li></ul></li></ul></li></ul><h2 id="Dubbo-SPI-æœºåˆ¶"><a href="#Dubbo-SPI-æœºåˆ¶" class="headerlink" title="Dubbo SPI æœºåˆ¶"></a>Dubbo SPI æœºåˆ¶</h2><div class="admonition note"><p class="admonition-title">æ‰©å±•é˜…è¯»</p><ul><li><a href="/posts/ea9ce835.html#SPI-%E6%89%A9%E5%B1%95%E6%9C%BA%E5%88%B6">Dubbo æ·±å…¥ç†è§£ - SPI æ‰©å±•æœºåˆ¶</a></li></ul></div><h3 id="æ¦‚å¿µä»‹ç»-1"><a href="#æ¦‚å¿µä»‹ç»-1" class="headerlink" title="æ¦‚å¿µä»‹ç»"></a>æ¦‚å¿µä»‹ç»</h3><p>Dubbo å€Ÿé‰´äº† SPI æ€æƒ³ï¼Œä½†æ²¡æœ‰ç›´æ¥ä½¿ç”¨ Java åŸç”Ÿçš„ SPI æœºåˆ¶ï¼Œè€Œæ˜¯é‡æ–°å®ç°äº†ä¸€å¥—åŠŸèƒ½æ›´å¼ºçš„ SPI æœºåˆ¶ã€‚Dubbo SPI çš„ç›¸å…³é€»è¾‘è¢«å°è£…åœ¨äº† <code>ExtensionLoader</code> ç±»ä¸­ï¼Œé€šè¿‡ <code>ExtensionLoader</code> ç±»å¯ä»¥åŠ è½½æŒ‡å®šçš„å®ç°ç±»ã€‚</p><ul><li><p><strong>å·¥ä½œåŸç†</strong></p><ul><li>(1) æ¥å£å£°æ˜<ul><li>åœ¨ Dubbo ä¸­ï¼Œå¦‚æœæŸä¸ªæ¥å£éœ€è¦æ”¯æŒ SPI æ‰©å±•ï¼Œå°±ä¼šåŠ ä¸Š <code>@SPI</code> æ³¨è§£ï¼Œæ¯”å¦‚ <code>Protocol</code> æ¥å£ï¼š<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¥å£å®šä¹‰</span></span><br><span class="line"><span class="meta">@SPI("dubbo")</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Protocol</span> </span>{</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">int</span> <span class="title">getDefaultPort</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Adaptive</span></span><br><span class="line">   &lt;T&gt; <span class="function">Exporter&lt;T&gt; <span class="title">export</span><span class="params">(Invoker&lt;T&gt; invoker)</span> <span class="keyword">throws</span> RpcException</span>;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Adaptive</span></span><br><span class="line">   &lt;T&gt; <span class="function">Invoker&lt;T&gt; <span class="title">refer</span><span class="params">(Class&lt;T&gt; type, URL url)</span> <span class="keyword">throws</span> RpcException</span>;</span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// åŠ è½½å®ç°ç±»</span></span><br><span class="line">Protocol protocol = ExtensionLoader.getExtensionLoader(Protocol.class).getAdaptiveExtension();</span><br></pre></td></tr></tbody></table></figure></li><li><code>@SPI("dubbo")</code> è¡¨ç¤ºé»˜è®¤å®ç°æ˜¯ <code>dubbo</code>ã€‚</li><li><code>@Adaptive</code> è¡¨ç¤ºè¯¥æ–¹æ³•ä¼šç”Ÿæˆä»£ç†é€»è¾‘ï¼Œè¿è¡Œæ—¶æ ¹æ®å‚æ•°åŠ¨æ€é€‰æ‹©å®ç°ç±»ã€‚</li></ul></li><li>(2) å®ç°ç±»é…ç½®<ul><li> Dubbo åœ¨è‡ªå·± Jar åŒ…ä¸­çš„ <code>resources/META-INF/dubbo/internal/</code> è·¯å¾„ä¸‹æä¾›äº†ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶åæ˜¯æ¥å£çš„å…¨é™å®šåï¼Œæ¯”å¦‚ï¼š<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resources/META-INF/dubbo/internal/com.alibaba.dubbo.rpc.Protocol</span><br></pre></td></tr></tbody></table></figure></li><li>é…ç½®æ–‡ä»¶çš„å†…å®¹æ˜¯ <code>key=å®ç°ç±»çš„å…¨é™å®šå</code>ï¼Œkey å¯¹åº” <code>@SPI</code> æ³¨è§£ä¸­çš„æ‰©å±•åç§°ï¼Œæ¯”å¦‚ï¼š<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dubbo=com.alibaba.dubbo.rpc.protocol.dubbo.DubboProtocol</span><br><span class="line">http=com.alibaba.dubbo.rpc.protocol.http.HttpProtocol</span><br><span class="line">hessian=com.alibaba.dubbo.rpc.protocol.hessian.HessianProtocol</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li>(3) é»˜è®¤å®ç°åŠ è½½<ul><li>å¦‚æœç”¨æˆ·æ²¡æœ‰é…ç½®æ‰©å±•ï¼ŒDubbo ä¼šæ ¹æ® <code>@SPI("dubbo")</code> çš„é»˜è®¤å€¼ <code>dubbo</code>ï¼Œä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½å¯¹åº”çš„å®ç°ç±» <code>DubboProtocol</code>ã€‚</li><li>è¿™ä¹Ÿæ˜¯ Dubbo é»˜è®¤ä½¿ç”¨ Dubbo åè®®ä½œä¸º RPC é€šä¿¡åè®®çš„åŸå› ã€‚</li></ul></li><li>(4) åŠ¨æ€åˆ‡æ¢å®ç°ç±»<ul><li>åœ¨ <code>Protocol</code> æ¥å£ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•åŠ äº† <code>@Adaptive</code> æ³¨è§£ã€‚</li><li>Dubbo ä¼šåœ¨è¿è¡Œæ—¶ç”Ÿæˆä»£ç†ç±»ï¼Œåœ¨ä»£ç†æ–¹æ³•å†…éƒ¨æ ¹æ®ä¼ å…¥çš„ URL å‚æ•°çš„ <code>protocol</code> å€¼å†³å®šä½¿ç”¨å“ªä¸ªå®ç°ç±»ã€‚</li><li>å¦‚æœ URL å‚æ•°ä¸­æ²¡æŒ‡å®šåè®®ï¼Œå°±ç”¨é»˜è®¤çš„ <code>dubbo</code>ï¼›å¦‚æœæŒ‡å®šäº†å…¶ä»–å€¼ï¼ˆå¦‚ <code>http</code>ï¼‰ï¼Œåˆ™åŠ è½½å¯¹åº”çš„å®ç°ç±»ã€‚</li></ul></li></ul></li><li><p><strong>å®ç°ç‰¹ç‚¹</strong></p><ul><li>å¾®å†…æ ¸ + å¯æ’æ‹”ï¼šä¿ç•™ä¸€ä¸ªæ¥å£å’Œå¤šä¸ªå®ç°ï¼Œè¿è¡Œæ—¶å¯æ›¿æ¢ã€‚</li><li>ç»„ä»¶åŒ–ï¼šå¦‚ <code>Protocol</code> è´Ÿè´£ RPC è°ƒç”¨ï¼Œå¯ä»¥æ›¿æ¢ä¸ºè‡ªå®šä¹‰çš„ RPC ç»„ä»¶ã€‚</li><li>åŠ¨æ€æ‰©å±•ï¼šå¯é€šè¿‡ URL å‚æ•°æˆ–é…ç½®æ–‡ä»¶ï¼Œåœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ‡æ¢å®ç°ç±»ã€‚</li><li>å¢å¼ºçš„ SPIï¼šç›¸æ¯” Java åŸç”Ÿçš„ SPI æœºåˆ¶ï¼ŒDubbo çš„å®ç°æ”¯æŒï¼š<ul><li>æ”¯æŒæŒ‡å®šé»˜è®¤çš„å®ç°ç±»ï¼ˆ<code>@SPI</code> æ³¨è§£çš„é»˜è®¤å€¼ï¼‰</li><li>è¿è¡Œæ—¶åŠ¨æ€é€‰æ‹©å®ç°ç±»ï¼ˆ<code>@Adaptive</code>ï¼‰</li><li>æ¥å£å®šä¹‰ï¼ˆæ‰©å±•ç‚¹ï¼‰è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»</li></ul></li></ul></li><li><p><strong>ä½¿ç”¨æ€»ç»“</strong></p><ul><li>Dubbo SPI æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶å¯æ‰©å±•ã€å¯æ›¿æ¢çš„ç»„ä»¶æœºåˆ¶ã€‚</li><li>Dubbo å¤§é‡æ ¸å¿ƒç»„ä»¶ï¼ˆå¦‚ <code>Protocol</code>ã€<code>Cluster</code>ã€<code>Registry</code> ç­‰ï¼‰éƒ½æ˜¯ç”¨è¿™ç§ SPI æœºåˆ¶å®ç°æ‰©å±•çš„ã€‚</li><li>é€šè¿‡ <code>@SPI</code> æ³¨è§£ + é…ç½®æ–‡ä»¶æ¥ç¡®å®šé»˜è®¤çš„å®ç°ç±»ï¼Œé€šè¿‡ <code>@Adaptive</code> æ³¨è§£ + URL å‚æ•°æ¥å®ç°åŠ¨æ€åˆ‡æ¢å®ç°ç±»ã€‚</li><li>Dubbo SPI çš„æ‰©å±•æ–‡ä»¶è·¯å¾„ï¼ˆ<a href="../../../asset/2025/11/dubbo-spi-extension-file.png">ç‚¹å‡»æŸ¥çœ‹æºç å®šä¹‰</a>ï¼‰<ul><li>ä¸ Java SPI çš„ä¸ä¸€æ ·ï¼ŒDubbo SPI æä¾›ç»™å¼€å‘è€…ä½¿ç”¨çš„æ‰©å±•æ–‡ä»¶æ˜¯ <code>resources/META-INF/dubbo/æ¥å£å…¨é™å®šå</code>ï¼Œæ–‡ä»¶å†…å®¹æ˜¯ <code>key=å®ç°ç±»çš„å…¨é™å®šå</code>ï¼›</li><li>Dubbo è‡ªå·±å†…éƒ¨ä½¿ç”¨çš„æ‰©å±•æ–‡ä»¶æ˜¯ <code>resources/META-INF/dubbo/internal/æ¥å£å…¨é™å®šå</code>ï¼Œæ–‡ä»¶å†…å®¹æ˜¯ <code>key=å®ç°ç±»çš„å…¨é™å®šå</code>ï¼›</li></ul></li></ul></li></ul><h3 id="åŠ è½½æµç¨‹"><a href="#åŠ è½½æµç¨‹" class="headerlink" title="åŠ è½½æµç¨‹"></a>åŠ è½½æµç¨‹</h3><p>Dubbo SPI æœºåˆ¶åŠ è½½æ‰©å±•çš„æ ¸å¿ƒæ­¥éª¤ï¼š</p><ul><li>(1) è¯»å–å¹¶è§£æé…ç½®æ–‡ä»¶</li><li> (2) ç¼“å­˜æ‰€æœ‰æ‰©å±•å®ç°ç±»</li><li> (3) åŸºäºç”¨æˆ·æ‰§è¡Œçš„æ‰©å±•åï¼Œå®ä¾‹åŒ–å¯¹åº”çš„æ‰©å±•å®ç°ç±»</li><li> (4) æ‰§è¡Œæ‰©å±•å®ä¾‹å±æ€§çš„ IOC æ³¨å…¥ï¼ˆåŸºäº <code>Setter</code> æ³¨å…¥ï¼‰ï¼Œä»¥åŠå®ä¾‹åŒ–æ‰©å±•çš„åŒ…è£…ç±»ï¼Œå®ç° AOP ç‰¹æ€§</li></ul><p>Dubbo SPI æœºåˆ¶åŠ è½½æ‰©å±•çš„æ•´ä¸ªæµç¨‹ï¼š</p><p><img data-src="../../../asset/2025/09/dubbo-spi-1.png"></p><h3 id="æ ¸å¿ƒæ³¨è§£"><a href="#æ ¸å¿ƒæ³¨è§£" class="headerlink" title="æ ¸å¿ƒæ³¨è§£"></a>æ ¸å¿ƒæ³¨è§£</h3><p>Dubbo SPI æœºåˆ¶æœ‰ä¸¤ä¸ªæ ¸å¿ƒæ³¨è§£ï¼Œåˆ†åˆ«æ˜¯ <code>@Adaptive</code> å’Œ <code>@Activate</code>ã€‚</p><ul><li><strong><code>@Adaptive</code> æ³¨è§£ï¼ˆè‡ªé€‚åº”ï¼‰</strong><ul><li>ä¸»è¦ä½œç”¨<ul><li>è¡¨ç¤ºè¯¥æ‰©å±•ç±»æˆ–æ¥å£æ–¹æ³•éœ€è¦è‡ªé€‚åº”æ‰©å±•ï¼ŒDubbo ä¼šåœ¨è¿è¡Œæ—¶æ ¹æ® URL æˆ–å…¶ä»–æ¡ä»¶åŠ¨æ€é€‰æ‹©å…·ä½“æ‰©å±•å®ç°ã€‚</li></ul></li><li>å¸¸è§ä½¿ç”¨æ–¹å¼<ul><li><code>@Adaptive</code> æ ‡æ³¨åœ¨æ¥å£æ–¹æ³•ä¸Šï¼ˆæœ€å¸¸è§ï¼‰<ul><li>è¡¨ç¤ºç”± Dubbo è‡ªåŠ¨ç”Ÿæˆ <code>Xxx$Adaptive</code> ä»£ç†ç±»</li><li>æ–¹æ³•å†…éƒ¨ä¼šæ ¹æ® URL å‚æ•°åœ¨è¿è¡Œæ—¶é€‰æ‹©å…·ä½“æ‰©å±•å®ç°</li><li>ä½¿ç”¨ä¾‹å­ï¼š<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Protocol</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Adaptive({"protocol", "defaultProtocol"})</span></span><br><span class="line">    <span class="function">Exporter <span class="title">export</span><span class="params">(Invoker invoker)</span></span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><ul><li>å½“ä¸Šé¢è°ƒç”¨ <code>export()</code> æ–¹æ³•æ—¶ï¼ŒDubbo ä¼šæ ¹æ® URL çš„ <code>protocol</code> æˆ– <code>defaultProtocol</code> å‚æ•°å†³å®šä½¿ç”¨å“ªä¸ªåè®®å®ç°</li></ul></li></ul></li><li><code>@Adaptive</code> æ ‡æ³¨åœ¨æ‰©å±•ç±»ä¸Šï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰<ul><li>è¡¨ç¤ºè¯¥æ‰©å±•ç±»æ˜¯ä¸€ä¸ªæ‰‹å·¥ç¼–å†™çš„è‡ªé€‚åº”æ‰©å±•ç±»</li><li> Dubbo å°†ç›´æ¥ä½¿ç”¨è¿™ä¸ªæ‰©å±•ç±»ï¼Œè€Œä¸ä¼šå†è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»</li><li>ä¸€èˆ¬ç”¨äºéå¸¸å¤æ‚çš„åœºæ™¯ï¼Œæ¯”å¦‚éœ€è¦æ‰‹å†™é€»è¾‘æ›¿ä»£ Dubbo è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»</li><li>ç›®å‰ Dubbo ä¸­ä»…æœ‰ä¸¤ä¸ªæ‰©å±•ç±»æ ‡æ³¨äº† <code>@Adaptive</code>ï¼Œåˆ†åˆ«æ˜¯ <code>AdaptiveCompiler</code> å’Œ <code>AdaptiveExtensionFactory</code>ï¼Œè¡¨ç¤ºè¿™äº›æ‰©å±•ç±»çš„åŠ è½½é€»è¾‘ç”±äººå·¥ç¼–ç ï¼ˆé™æ€ç¼–ç ï¼‰å®Œæˆ</li><li>ä½¿ç”¨ä¾‹å­ï¼š<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Adaptive</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomAdaptiveCompiler</span> <span class="keyword">implements</span> <span class="title">Compiler</span> </span>{</span><br><span class="line">  </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Class&lt;?&gt; compile(String code, ClassLoader loader) {</span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰ä»£ç ç¼–è¯‘é€»è¾‘</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul></li></ul></li><li>ä½¿ç”¨æ³¨æ„äº‹é¡¹<ul><li>æ¥å£ä¸Šä¸èƒ½æ ‡æ³¨ <code>@Adaptive</code></li><li>æ¥å£æ–¹æ³•ä¸Šå¯ä»¥æ ‡æ³¨ <code>@Adaptive</code>ï¼Œè¡¨ç¤ºä½¿ç”¨ Dubbo è‡ªåŠ¨ç”Ÿæˆçš„ä»£ç†ç±»ï¼Œé€‚ç”¨å¤§å¤šæ•°åœºæ™¯</li><li>æ‰©å±•ç±»ä¸Šå¯ä»¥æ ‡æ³¨ <code>@Adaptive</code>ï¼Œè¡¨ç¤ºä½¿ç”¨æ‰‹å†™çš„è‡ªé€‚åº”é€»è¾‘ï¼Œé€‚ç”¨ç‰¹æ®Šå¤æ‚åœºæ™¯</li></ul></li></ul></li></ul><hr><ul><li><strong><code>@Activate</code> æ³¨è§£ï¼ˆè‡ªåŠ¨æ¿€æ´»ï¼‰</strong><ul><li>ä¸»è¦ä½œç”¨<ul><li>è¡¨ç¤ºå½“æ‰©å±•ç±»è¢«è‡ªåŠ¨åŠ è½½æ—¶ï¼Œæ»¡è¶³ <code>group</code>ã€<code>value</code>ã€<code>order</code> ç­‰æ¡ä»¶ï¼Œè¯¥æ‰©å±•ä¼šè‡ªåŠ¨åŠ å…¥æ‰©å±•é“¾ï¼Œæ— éœ€æ‰‹åŠ¨åœ¨é…ç½®ä¸­æŒ‡å®šæ‰©å±•åã€‚</li></ul></li><li>å¸¸è§ä½¿ç”¨æ–¹å¼<ul><li><code>@Activate</code> æ ‡æ³¨åœ¨æ‰©å±•ç±»ä¸Šï¼ˆæœ€å¸¸è§ï¼‰<ul><li>æ‰©å±•ç±»åœ¨æ»¡è¶³ Activate æ¡ä»¶æ—¶è‡ªåŠ¨æ¿€æ´»</li><li>ä¸€èˆ¬ç”¨äº Filterã€Routerã€ExporterListenerã€Registry ç­‰æ‰©å±•ç‚¹</li><li>ä½¿ç”¨ä¾‹å­ï¼š<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Activate(group = {"provider"}, order = 10)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyProviderFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Result <span class="title">invoke</span><span class="params">(Invoker&lt;?&gt; invoker, Invocation invocation)</span> </span>{</span><br><span class="line">        <span class="comment">// è‡ªå®šä¹‰è¿‡æ»¤é€»è¾‘</span></span><br><span class="line">        <span class="keyword">return</span> invoker.invoke(invocation);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li><code>@Activate</code> æ ‡æ³¨åœ¨æ¥å£æ–¹æ³•ä¸Šï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰<ul><li>è¡¨ç¤ºè¯¥æ¥å£æ–¹æ³•è¿”å›çš„æ‰©å±•ç±»å®ä¾‹åœ¨è°ƒç”¨æ—¶å¯è‡ªåŠ¨æ¿€æ´»</li><li>å¯ç»“åˆ URL å‚æ•°æˆ– <code>group</code>ã€<code>value</code>ã€<code>order</code> æ¡ä»¶è¿›è¡ŒåŠ¨æ€æ§åˆ¶</li><li>ä½¿ç”¨ä¾‹å­ï¼š<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SomeFactory</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Activate(value = {"feature"}, group = "consumer")</span></span><br><span class="line">    <span class="function">Extension <span class="title">create</span><span class="params">()</span></span>;</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li></ul></li></ul></li><li>å…¸å‹ä½¿ç”¨ <code>@Activate</code> è‡ªåŠ¨æ¿€æ´»çš„æ‰©å±•ç‚¹ï¼ˆæœ€å¸¸è§åœºæ™¯ï¼‰<ul><li>Filter è‡ªåŠ¨ç”Ÿæ•ˆï¼ˆè¿‡æ»¤å™¨ï¼‰</li><li>Router è‡ªåŠ¨ç”Ÿæ•ˆï¼ˆè·¯ç”±ï¼‰</li><li>ExporterListener è‡ªåŠ¨ç”Ÿæ•ˆï¼ˆç›‘å¬æœåŠ¡æš´éœ²ï¼‰</li><li>Registryï¼ˆå¦‚æ³¨å†Œä¸­å¿ƒç›¸å…³ç›‘å¬ã€é€šçŸ¥ï¼‰è‡ªåŠ¨ç”Ÿæ•ˆ</li></ul></li><li>å¯ä½¿ç”¨ <code>@Activate</code> æ¿€æ´»ï¼Œä½†é€šå¸¸æ˜¯é€šè¿‡ URL æŒ‡å®šæˆ–è€…æ˜ç¡®é€‰æ‹©çš„çš„æ‰©å±•ç‚¹<ul><li> Clusterï¼ˆæœ‰äº›è£…é¥°é€»è¾‘å¯èƒ½è‡ªåŠ¨å°è£…ï¼Œä½†å¤šæ•°æ˜¯ç”± Dubbo ä¸»æµç¨‹æ˜¾å¼é€‰æ‹©ï¼‰</li><li>Protocolï¼ˆæ”¯æŒ <code>@Activate</code>ï¼Œä½†è¾ƒå°‘ç”¨äºè‡ªåŠ¨æ¿€æ´»ï¼Œä¸€èˆ¬æ˜¯ URL æˆ–æ˜¾å¼é€‰æ‹©ï¼‰</li><li>ProxyFactoryï¼ˆå¯è‡ªåŠ¨æ¿€æ´»ï¼Œä½†é€šå¸¸é€šè¿‡æŒ‡å®šå®ç°é€‰æ‹©ï¼‰</li></ul></li><li>ä½¿ç”¨æ³¨æ„äº‹é¡¹<ul><li>æ¥å£ä¸Šä¸èƒ½æ ‡æ³¨ <code>@Activate</code></li></ul></li></ul></li></ul><div class="admonition note"><p class="admonition-title">æ€»ç»“</p><ul><li><code>@Adaptive</code>ï¼ˆè‡ªé€‚åº”ï¼‰çš„ä½œç”¨ï¼šè®©æ‰©å±•åœ¨è¿è¡Œæ—¶æ ¹æ® URL æˆ–æ¡ä»¶åŠ¨æ€é€‰æ‹©å…·ä½“æ‰©å±•å®ç°ï¼›æ ‡æ³¨åœ¨æ–¹æ³•ä¸Šï¼Œåˆ™è¡¨ç¤ºç”± Dubbo è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»ï¼›æ ‡æ³¨åœ¨ç±»ä¸Šï¼Œåˆ™è¡¨ç¤ºä½¿ç”¨æ‰‹å†™çš„è‡ªé€‚åº”é€»è¾‘ã€‚</li><li><code>@Activate</code>ï¼ˆè‡ªåŠ¨æ¿€æ´»ï¼‰çš„ä½œç”¨ï¼šè®©æ‰©å±•ç±»åœ¨æ»¡è¶³ Activate æ¡ä»¶æ—¶è‡ªåŠ¨æ¿€æ´»åŠ å…¥è°ƒç”¨é“¾ï¼›å¯ä»¥çœç•¥ï¼Œä½†çœç•¥åä¸ä¼šè‡ªåŠ¨æ¿€æ´»ï¼Œå¿…é¡»é€šè¿‡æ‰©å±•åä¸»åŠ¨åŠ è½½ï¼Œä¾‹å¦‚ï¼š <code>extensionLoader.getExtension("customizedProtocol");</code>ã€‚</li></ul></div><h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/spi/description/">Dubbo å®˜æ–¹æ–‡æ¡£ - éƒ¨åˆ†é‡ç‚¹ SPI ä½¿ç”¨è¯´æ˜</a></li><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/spi/">Dubbo å®˜æ–¹æ–‡æ¡£ - SPI æ’ä»¶æ‰©å±•ç‚¹ä½¿ç”¨æ‰‹å†Œ</a></li><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/docsv2.7/dev/source/dubbo-spi/">Dubbo å®˜æ–¹æ–‡æ¡£ - SPI æºç åˆ†æ</a>ï¼Œ<a href="../../../asset/2025/11/dubbo2-docs-spi-1.png">é™„æ–‡æ¡£æˆªå›¾</a></li><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/reference-manual/architecture/dubbo-spi/">Dubbo å®˜æ–¹æ–‡æ¡£ - æ‰©å±•ç‚¹å¼€å‘æŒ‡å—</a>ï¼Œ<a href="../../../asset/2025/11/dubbo-docs-spi-2.png">é™„æ–‡æ¡£æˆªå›¾</a></li><li><a target="_blank" rel="external nofollow" href="https://cn.dubbo.apache.org/zh-cn/overview/mannual/java-sdk/tasks/extensibility/spi/">Dubbo å®˜æ–¹æ–‡æ¡£ - è‡ªå®šä¹‰ SPI æ‰©å±•çš„åŸºæœ¬æ­¥éª¤</a>ï¼Œ<a href="../../../asset/2025/11/dubbo-docs-spi-3.png">é™„æ–‡æ¡£æˆªå›¾</a></li></ul><div id="readmore-expansion" class="pjax"></div><link rel="stylesheet" type="text/css" href="https://qiniu.techgrow.cn/readmore/dist/hexo.css"><script data-pjax="" src="https://qiniu.techgrow.cn/readmore/dist/readmore.js" type="text/javascript"></script><script data-pjax="">var isMobile=navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i),allowMobile=!1;if(!isMobile||isMobile&&allowMobile)try{var plugin=new ReadmorePlugin;plugin.init({type:"hexo",id:"readmore-container",name:"å…¨æ ˆæŠ€æœ¯é©¿ç«™",blogId:"96641-5333172926158-056",qrcode:"https://www.techgrow.cn/img/wx_mp_qr.png",keyword:"Tech",random:"1",height:"auto",expires:"365",lockToc:"yes",interval:"30",baseUrl:"",execute:"yes",tocSelector:""})}catch(e){console.warn("readmore plugin occurred error: "+e.name+" | "+e.message)}</script></div><footer class="post-footer"><div class="reward-container"><div>æ”¯æŒä¸€æ ¹æ£’æ£’ç³–ï¼</div> <button> èµèµ</button><div class="post-reward"><div> <img src="/img/pay_wx.png" alt="Clay å¾®ä¿¡"> <span>å¾®ä¿¡</span></div><div> <img src="/img/pay_zfb.png" alt="Clay æ”¯ä»˜å®"> <span>æ”¯ä»˜å®</span></div></div></div><div class="post-copyright"><ul><li class="post-copyright-author"> <strong>æœ¬æ–‡ä½œè€…ï¼š</strong> Clay</li><li class="post-copyright-link"> <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong> <a href="https://www.techgrow.cn/posts/ef54a41c.html" title="Java ä¸ Dubbo çš„ SPI æœºåˆ¶ä»‹ç»">https://www.techgrow.cn/posts/ef54a41c.html</a></li><li class="post-copyright-license"> <strong>ç‰ˆæƒå£°æ˜ï¼š</strong> æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank"><i class="fab fa-fw fa-creative-commons"></i> BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div><div class="contactme"><div class="social-list"><div class="social-item"><span class="icon"><i class="fab fa-weixin"></i></span> <span class="label">æ¬¢è¿æ·»åŠ åšä¸»å¾®ä¿¡ï¼Œè¯·å¤‡æ³¨ "åšå®¢"ï¼Œå±Šæ—¶ä¼šé‚€è¯·æ‚¨åŠ å…¥ç™¾äººå¾®ä¿¡ç¾¤</span><br> <img src="/img/wx_account_qr.png"></div></div></div><div class="post-tags"><a href="/tags/RPC/" rel="tag"><i class="fa fa-tag"></i> RPC</a><a href="/tags/Java/" rel="tag"><i class="fa fa-tag"></i> Java</a></div><div class="post-nav"><div class="post-nav-item"><a href="/posts/723af70c.html" rel="prev" title="Kubernetes å…¥é—¨æ•™ç¨‹ä¹‹å…«"><i class="fa fa-angle-left"></i> Kubernetes å…¥é—¨æ•™ç¨‹ä¹‹å…«</a></div><div class="post-nav-item"> <a href="/posts/dbb10768.html" rel="next" title="åŸºäº C++ æ‰‹å†™ Muduo é«˜æ€§èƒ½ç½‘ç»œåº“">åŸºäº C++ æ‰‹å†™ Muduo é«˜æ€§èƒ½ç½‘ç»œåº“<i class="fa fa-angle-right"></i></a></div></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright"> Copyright Â© 2018 â€“ <span itemprop="copyrightYear">2025</span><span class="with-love"><i class="fa fa-heart"></i></span> <span class="author" itemprop="copyrightHolder">Clay</span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-chart-line"></i></span> <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span> <span title="ç«™ç‚¹æ€»å­—æ•°">2.2m</span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-coffee"></i></span> <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ â‰ˆ</span> <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">33:24</span></span></div><div id="site-runtime"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i></span><span id="runtime"></span></div><script language="javascript">function isPC(){for(var e=navigator.userAgent,t=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],n=0;n<t.length;n++)if(0<e.indexOf(t[n]))return!1;return!0}function siteTime(e,t){window.setTimeout("siteTime(openOnPC, start)",1e3);var n=36e5,o=24*n;t=new Date("2018-12-27 08:00:00");var i=new Date,r=(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i-t),a=Math.floor(r/31536e6),s=Math.floor(r/o-365*a),d=Math.floor((r-(365*a+s)*o)/n),l=Math.floor((r-(365*a+s)*o-d*n)/6e4),u=Math.floor((r-(365*a+s)*o-d*n-6e4*l)/1e3);document.getElementById("runtime").innerHTML="Powered by Hexo & Docker | "+a+" å¹´ "+s+" æ—¥ "+d+" å°æ—¶ "+l+" åˆ†é’Ÿ "+u+" ç§’ "}var showOnMobile=!1,openOnPC=isPC(),start=new Date;siteTime(openOnPC,start),openOnPC||showOnMobile||(document.getElementById("site-runtime").style.display="none")</script><div class="beian"> <span><img src="/img/gonganbeian.png" alt=""></span> <span><a href="https://beian.miit.gov.cn/" rel="external nofollow" target="_blank">ç²¤ICPå¤‡ 19024664å·-1</a></span> <span>|&nbsp;</span> <span><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011302004035" rel="external nofollow" target="_blank">ç²¤å…¬ç½‘å®‰å¤‡ 44011302004035å·</a></span></div><div class="busuanzi-count"><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i></span><span class="site-uv" title="æ€»è®¿å®¢é‡"><span id="busuanzi_value_site_uv"></span></span></span><span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i></span><span class="site-pv" title="æ€»è®¿é—®é‡"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer><div class="toggle sidebar-toggle" role="button"><span class="toggle-line"></span><span class="toggle-line"></span><span class="toggle-line"></span></div><div class="sidebar-dimmer"></div> <a href="https://github.com/rqh656418510" class="github-corner" title="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" aria-label="åœ¨ GitHub ä¸Šå…³æ³¨æˆ‘" rel="external nofollow" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"></path><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"></path></svg></a><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script size="200" alpha="0.5" zindex="-1" src="/lib/ribbon.js/dist/ribbon.min.js"></script><script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script><script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script><script src="/lib/lozad/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script><script class="next-config" data-name="pdf" type="application/json">{"object_url":{"url":"/lib/pdfobject/pdfobject.min.js","integrity":"sha256-JJZNsid68vnh3/zyj0lY9BN5ynxVX/12XgOa1TlaYN0="},"url":"/lib/pdf/web/viewer.html"}</script><script src="/js/third-party/tags/pdf.js"></script><script src="/js/third-party/pace.js"></script><script data-pjax="" async="" src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://www.techgrow.cn/lib/darkmode/darkmode@1.5.7.min.js"></script><script>
var options = {
  bottom: '64px',
  right: '30px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#282828',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script><script src="https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js"></script><script>
    var qiniu_domain = "https://oss.techgrow.cn";
    var qiniu_token_url = "https://open.techgrow.cn/api/oss/qiniu/token/upload";
    var qiniu_debug = "true" === "false";

    // date format
    Date.prototype.format = function (fmt) {
      var o = {
        "M+": this.getMonth() + 1,
        "d+": this.getDate(),
        "h+": this.getHours(),
        "m+": this.getMinutes(),
        "s+": this.getSeconds(),
        "q+": Math.floor((this.getMonth() + 3) / 3),
        "S": this.getMilliseconds()
      };
      if (/(y+)/.test(fmt)) {
        fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
      }
      for (var k in o) {
        if (new RegExp("(" + k + ")").test(fmt)) {
          fmt = fmt.replace(
            RegExp.$1,
            (RegExp.$1.length == 1)
              ? (o[k])
              : (("00" + o[k]).substr(("" + o[k]).length))
          );
        }
      }
      return fmt;
    }

    // generate uuid
    function uuid() {
      var s = [];
      var hexDigits = "0123456789abcdef";
      for (var i = 0; i < 36; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
      }
      s[14] = "4";
      s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1);
      s[8] = s[13] = s[18] = s[23] = "-";
      var uuid = s.join("");
      return uuid;
    }

    // sync get request
    function syncGet(url) {
      var xhr = null;
      if (window.XMLHttpRequest) {
        xhr = new XMLHttpRequest();
      } else {
        xhr = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xhr.open('GET', url, false);
      xhr.send();
      return xhr;
    }

    // get upload file path
    function getUploadFilePath() {
      var now = new Date();
      var name = uuid().replace(/-/g, "");
      var nowStr = now.format("/yyyy/MM/dd/");
      return "uploads" + nowStr + name;
    }

    // get qiniu upload token
    function getUploadToken() {
      try {
        var xhr = syncGet(qiniu_token_url);
        var responseStatus = xhr.status;
        var responseJson = JSON.parse(xhr.responseText);
        if (responseStatus === 200) {
          return responseJson.data;
        } else if (responseStatus === 403) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œéæ³•è¯·æ±‚æ¥æºï¼");
        } else if (responseStatus === 429) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œä¸Šä¼ è¿‡äºé¢‘ç¹ï¼");
        } else if (responseStatus === 500) {
          alert(responseJson.msg || "å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼Œç³»ç»Ÿå†…éƒ¨å‡ºé”™ï¼");
        } else {
          alert("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼ŒæœªçŸ¥Httpå“åº”çŠ¶æ€ç ï¼");
        }
      } catch (err) {
        if (qiniu_debug) {
          console.error(err);
        }
        alert("å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œæ— æ³•è·å–UploadTokenï¼ŒæœªçŸ¥é”™è¯¯ï¼");
      }
      return null;
    }

    // qiniu upload image
    async function qiniuUploadImage(file) {
      var image_path = null;
      await uploadImage(file).then(function onFulfilled(res) {
        image_path = res;
      }).catch(function onRejected(err) {
        if (qiniu_debug) {
          console.error(err);
        }
      });
      return image_path;
    }

    // upload image
    function uploadImage(file) {
      return new Promise((resolve, reject) => {
        var config = null;
        var putExtra = null;
        var token = getUploadToken();
        var key = getUploadFilePath();
        // upload init
        var observable = qiniu.upload(file, key, token, putExtra, config);
        // upload start
        observable.subscribe({
          next(res) {
            // upload progress
          },
          error(err) {
            // upload falied
            reject("falied to upload image for qiniu: " + err.name);
          },
          complete(res) {
            // upload successed
            resolve(qiniu_domain + "/" + key);
          }
        });
      });
    }
  </script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"https://waline.techgrow.cn","cssUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css","commentCount":true,"pageview":false,"copyright":false,"allowUploadImage":true,"libUrl":"https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.js","locale":{"placeholder":"æ”¯æŒåŒ¿åè¯„è®ºå•¦ï¼Œè‹¥å¸Œæœ›åŠæ—¶æ”¶åˆ°åšä¸»çš„åé¦ˆï¼Œå»ºè®®ç™»å½•è¯„è®ºæˆ–è€…åœ¨ä¸Šæ–¹çš„é‚®ç®±è¾“å…¥æ¡†ç•™ä¸‹é‚®ç®±åœ°å€å“¦ (à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§"},"dark":"body.darkmode--activated","emoji":["https://www.techgrow.cn/lib/@waline/emojis/1.0.1/weibo"],"meta":["nick","mail","link"],"login":"enable","pageSize":10,"qiniuDebug":false,"qiniuDomain":"https://oss.techgrow.cn","qiniuTokenUrl":"https://open.techgrow.cn/api/oss/qiniu/token/upload","qiniuLibUrl":"https://www.techgrow.cn/lib/qiniu/qiniu@3.3.1.min.js","el":"#waline","comment":true,"path":"/posts/ef54a41c.html"}</script><link rel="stylesheet" href="https://www.techgrow.cn/lib/@waline/client/client@2.5.1.min.css"><script>
document.addEventListener('page:loaded', () => {
  if (!CONFIG.waline.allowUploadImage) {
    CONFIG.waline.imageUploader = false;
  }
  else if (CONFIG.waline.qiniuDomain && CONFIG.waline.qiniuTokenUrl) {
    CONFIG.waline.imageUploader = qiniuUploadImage;
  } else {
   CONFIG.waline.imageUploader = true;
  }
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script><div class="moon-menu"><div class="moon-menu-items"><div id="moon-menu-item-back2bottom" class="moon-menu-item"><i class="fas fa-chevron-down"></i></div><div id="moon-menu-item-back2top" class="moon-menu-item"><i class="fas fa-chevron-up"></i></div></div><div class="moon-menu-button"><svg class="moon-menu-bg"><circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle><circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle></svg><div class="moon-menu-content"><div class="moon-menu-icon"><i class="fas fa-ellipsis-v"></i></div><div class="moon-menu-text"></div></div></div></div><script src="/js/injector.js"></script><div class="comments" id="waline-comments" style="display:none"></div><script>function isMobile(){var i=navigator.userAgent.toLowerCase(),e="ipad"==i.match(/ipad/i),a="iphone os"==i.match(/iphone os/i),o="midp"==i.match(/midp/i),n="rv:1.2.3.4"==i.match(/rv:1.2.3.4/i),r="ucweb"==i.match(/ucweb/i),c="android"==i.match(/android/i),l="windows ce"==i.match(/windows ce/i),d="windows mobile"==i.match(/windows mobile/i);return!!(e||a||o||n||r||c||l||d)}var openOnMobile=isMobile(),showOnMobile=!1,aplayerEnable=!0;jQuery(document).ready(function(){aplayerEnable&&(openOnMobile&&!showOnMobile||jQuery("#aplayer").css("display","block"))}),jQuery(window).on("load",function(){aplayerEnable&&jQuery(".aplayer\\-icon.aplayer\\-icon\\-lrc").trigger("click")})</script></body></html>